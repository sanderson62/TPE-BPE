* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   1
* EL686.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL686.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL686.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL686 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:57:46.
     7*                            VMOD=2.018
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   2
* EL686.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.     TRANSACTION - EXG2
    25*
    26*        THIS PROGRAM IS USED TO INDICATE THE CHECKS BEING
    27*    RELEASED TO PRINT.  EACH RELEASE CONSTITUTES A CONTROL GROUP
    28*    THAT IS REFERENCED BY THE CHECK WRITER (EL687) AND THE CHECK
    29*    PRINT STARTER (EL686).
    30*
    31*    SCREENS     - EL686A - CHECK RELEASE
    32*
    33*    ENTERED BY  - EL671  - REPORT MENU
    34*
    35*    EXIT TO     - EL671  - RESULT OF CLEAR
    36*
    37*    INPUT FILES - ERPYAJ - PENDING PAYMENT AND ADJUSTMENTS
    38*                  ERCHEK - CHECK MAINTENANCE FILE
    39*                  ERCMCK - COMMISSION CHECK MAINTENANCE FILE
    40*                  ELCNTL - CONTROL FILE
    41*
    42*    OUTPUT FILES - ERPYAJ - PENDING PAYMENTS AND ADJUSTMENTS
    43*                   ERCHEK - CHECK MAINTENANCE FILE
    44*                   ELCNTL - CONTROL FILE
    45*                   ERCHKQ - CHECK QUEUE
    46*                   ERCMKQ - COMMISSION CHECK QUEUE
    47*
    48*    COMMAREA    - PASSED.
    49*
    50
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   3
* EL686.cbl
    52 ENVIRONMENT DIVISION.
    53
    54 DATA DIVISION.
    55
    56 WORKING-STORAGE SECTION.
    57 01  DFH-START PIC X(04).
    58
    59 77  FILLER  PIC X(32)  VALUE '********************************'.
    60 77  FILLER  PIC X(32)  VALUE '*    EL686 WORKING STORAGE     *'.
    61 77  FILLER  PIC X(32)  VALUE '************ V/M 2.018 *********'.
    62
    63*    COPY ELCSCTM.
    64******************************************************************
    65*                                                                *
    66*                                                                *
    67*                            ELCSCTM                             *
    68*                            VMOD=2.001                          *
    69*                                                                *
    70*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    71*                                                                *
    72******************************************************************
    73 01  SECURITY-MESSAGE.
    74     12  FILLER                          PIC X(30)
    75            VALUE '** LOGIC SECURITY VIOLATION -'.
    76     12  SM-READ                         PIC X(6).
    77     12  FILLER                          PIC X(5)
    78            VALUE ' PGM='.
    79     12  SM-PGM                          PIC X(6).
    80     12  FILLER                          PIC X(5)
    81            VALUE ' OPR='.
    82     12  SM-PROCESSOR-ID                 PIC X(4).
    83     12  FILLER                          PIC X(6)
    84            VALUE ' TERM='.
    85     12  SM-TERMID                       PIC X(4).
    86     12  FILLER                          PIC XX   VALUE SPACE.
    87     12  SM-JUL-DATE                     PIC 9(5).
    88     12  FILLER                          PIC X    VALUE SPACE.
    89     12  SM-TIME                         PIC 99.99.
    90
    91*    COPY ELCSCRTY.
    92******************************************************************
    93*                                                                *
    94*                                                                *
    95*                            ELCSCRTY                            *
    96*                            VMOD=2.001                          *
    97*                                                                *
    98*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    99*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   100*        SAVED IN PI-SECURITY-ADDRESS.                           *
   101*                                                                *
   102******************************************************************
   103 01  SECURITY-CONTROL.
   104     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   105     12  FILLER                       PIC XX    VALUE 'SC'.
   106     12  SC-CREDIT-CODES.
   107         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   108             20  SC-CREDIT-DISPLAY    PIC X.
   109             20  SC-CREDIT-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   4
* EL686.cbl
   110     12  SC-CLAIMS-CODES.
   111         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   112             20  SC-CLAIMS-DISPLAY    PIC X.
   113             20  SC-CLAIMS-UPDATE     PIC X.
   114 01  FILLER                          COMP-3.
   115     05  WS-NDX                      PIC S9(3)       VALUE ZERO.
   116     05  WS-SEQ-NO                   PIC S9(9)       VALUE ZERO.
   117
   118     05  WS-TIME-WORK                PIC S9(7)       VALUE ZERO.
   119     05  WS-TIME                     REDEFINES
   120         WS-TIME-WORK                PIC S9(3)V9(4).
   121     05  WS-HHMM                     REDEFINES
   122         WS-TIME-WORK                PIC S9(5)V99.
   123
   124     05  WS-ERPYAJ-BROWSE-SW         PIC S9          VALUE +0.
   125         88  WS-ERPYAJ-BROWSE-NOT-STARTED            VALUE +0.
   126         88  WS-ERPYAJ-BROWSE-STARTED                VALUE +1.
   127     05  WS-ERCHEK-BROWSE-SW         PIC S9          VALUE +0.
   128         88  WS-ERCHEK-BROWSE-NOT-STARTED            VALUE +0.
   129         88  WS-ERCHEK-BROWSE-STARTED                VALUE +1.
   130     05  WS-ERCMCK-BROWSE-SW         PIC S9          VALUE +0.
   131         88  WS-ERCMCK-BROWSE-NOT-STARTED            VALUE +0.
   132         88  WS-ERCMCK-BROWSE-STARTED                VALUE +1.
   133
   134     05  WS-RELEASED-COUNT           PIC S9(5)       VALUE ZERO.
   135     05  WS-RELEASED-AMOUNT          PIC S9(9)V99    VALUE ZERO.
   136
   137 01  FILLER                          COMP SYNC.
   138
   139     05  SC-ITEM                     PIC S9(4)       VALUE  +1.
   140     05  WS-INDEX                    PIC S9(4)       VALUE ZERO.
   141     05  WS-ERCHKQ-LENGTH            PIC S9(4)       VALUE +100.
   142     05  WS-ERCMKQ-LENGTH            PIC S9(4)       VALUE +1800.
   143     05  WS-TS-LENGTH                PIC S9(4)       VALUE +1920.
   144
   145     05  WS-CHECK-QUE-COUNTER        PIC S9(8)       VALUE ZERO.
   146     05  WS-CHECK-COUNTER            PIC S9(4)       VALUE +10.
   147
   148     05  WS-JOURNAL-FILE-ID          PIC S9(4)       VALUE +1.
   149     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)       VALUE +773.
   150
   151 01  FILLER.
   152
   153     05  WS-MAPSET-NAME              PIC X(8)      VALUE 'EL686S'.
   154     05  WS-MAP-NAME                 PIC X(8)      VALUE 'EL686A'.
   155
   156     05  FILLER                      REDEFINES
   157         WS-MAP-NAME.
   158         20  FILLER                  PIC XX.
   159         20  WS-MAP-NUMBER           PIC X(6).
   160
   161     05  DEEDIT-FIELD                PIC X(15).
   162     05  DEEDIT-FIELD-V0  REDEFINES
   163         DEEDIT-FIELD                PIC S9(15).
   164
   165     05  QID.
   166         10  QID-TERM                PIC X(4)   VALUE SPACES.
   167         10  FILLER                  PIC X(4)   VALUE '125D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   5
* EL686.cbl
   168
   169     05  TIME-IN                     PIC S9(7).
   170     05  TIME-OUT-R   REDEFINES TIME-IN.
   171         10  FILLER                  PIC X.
   172         10  TIME-OUT                PIC 99V99.
   173         10  FILLER                  PIC X(2).
   174
   175     05  WS-CHECK-NUMBER.
   176         10  FILLER                  PIC X           VALUE ZERO.
   177         10  WS-CHECK-NO             PIC X(6)        VALUE ZERO.
   178
   179     05  WS-CONTROL-FILE-KEY.
   180         10  WS-CFK-COMPANY-ID       PIC X(3)        VALUE SPACES.
   181         10  WS-CFK-RECORD-TYPE      PIC X           VALUE SPACES.
   182         10  FILLER                  PIC XX          VALUE SPACES.
   183         10  WS-CFK-BENEFIT-NO       PIC XX          VALUE SPACES.
   184         10  WS-CFK-SEQUENCE-NO      PIC S9(4)       VALUE ZERO
   185                                     COMP.
   186
   187     05  WS-PENDING-PAYMENTS-KEY.
   188         10  WS-PPK-COMPANY-CD       PIC X.
   189         10  WS-PPK-CARRIER          PIC X.
   190         10  WS-PPK-GROUPING         PIC X(6).
   191         10  WS-PPK-FIN-RESP         PIC X(10).
   192         10  WS-PPK-ACCOUNT          PIC X(10).
   193         10  WS-PPK-FILE-SEQ-NO      PIC S9(8)
   194                                     COMP.
   195         10  WS-PPK-RECORD-TYPE      PIC X.
   196
   197     05  WS-COMCK-MAINT-KEY.
   198         10  WS-CMK-COMPANY-CD       PIC X.
   199         10  WS-CMK-CARRIER          PIC X.
   200         10  WS-CMK-GROUPING         PIC X(6).
   201         10  WS-CMK-PAYEE            PIC X(10).
   202         10  WS-CMK-PAYEE-SEQ        PIC S9(4)      COMP.
   203         10  WS-CMK-SEQUENCE-NO      PIC S9(4)      COMP.
   204
   205     05  WS-CHECK-MAINT-KEY.
   206         10  WS-CHK-COMPANY-CD       PIC X.
   207         10  WS-CHK-CARRIER          PIC X.
   208         10  WS-CHK-GROUPING         PIC X(6).
   209         10  WS-CHK-STATE            PIC XX.
   210         10  WS-CHK-ACCOUNT          PIC X(10).
   211         10  WS-CHK-CERT-EFF-DT      PIC XX.
   212         10  WS-CHK-CERT-NO.
   213             15  WS-CHK-CERT-PRIME   PIC X(10).
   214             15  WS-CHK-CERT-SFX     PIC X.
   215         10  WS-CHK-SEQ-NO           PIC S9(4)
   216                                     COMP.
   217
   218     05  THIS-PGM                    PIC X(8) VALUE 'EL686'.
   219
   220     05  EL001                       PIC X(8) VALUE 'EL001'.
   221     05  EL004                       PIC X(8) VALUE 'EL004'.
   222     05  EL005                       PIC X(8) VALUE 'EL005'.
   223     05  EL010                       PIC X(8) VALUE 'EL010'.
   224     05  EL126                       PIC X(8) VALUE 'EL126'.
   225     05  ELDATCV                     PIC X(8) VALUE 'ELDATCV'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   6
* EL686.cbl
   226
   227     05  WS-ERCHKQ-DSID              PIC X(8) VALUE 'ERCHKQ'.
   228     05  WS-ERCHEK-DSID              PIC X(8) VALUE 'ERCHEK'.
   229     05  WS-ERCMKQ-DSID              PIC X(8) VALUE 'ERCMKQ'.
   230     05  WS-ERCMCK-DSID              PIC X(8) VALUE 'ERCMCK'.
   231     05  WS-ERPYAJ-DSID              PIC X(8) VALUE 'ERPYAJ'.
   232     05  WS-ELCNTL-DSID              PIC X(8) VALUE 'ELCNTL'.
   233
   234     05  WS-JOURNAL-TYPE-ID          PIC XX          VALUE 'EL'.
   235
   236     05  WS-SPACES                   PIC X           VALUE SPACES.
   237
   238     05  WS-TRANS-ID                 PIC X(4)        VALUE 'EXG2'.
   239     05  WS-PRINT-TRANS-ID           PIC X(4)        VALUE 'EXG9'.
   240
   241     05  WS-ERROR-FLAG-AREA.
   242         10  ER-0002                 PIC 9(4)        VALUE 0002.
   243         10  ER-0004                 PIC 9(4)        VALUE 0004.
   244         10  ER-0008                 PIC 9(4)        VALUE 0008.
   245         10  ER-0029                 PIC 9(4)        VALUE 0029.
   246         10  ER-0070                 PIC 9(4)        VALUE 0070.
   247         10  ER-0078                 PIC 9(4)        VALUE 0078.
   248         10  ER-0330                 PIC 9(4)        VALUE 0330.
   249         10  ER-0331                 PIC 9(4)        VALUE 0331.
   250         10  ER-0348                 PIC 9(4)        VALUE 0348.
   251         10  ER-0568                 PIC 9(4)        VALUE 0568.
   252         10  ER-0766                 PIC 9(4)        VALUE 0766.
   253         10  ER-3048                 PIC 9(4)        VALUE 3048.
   254
   255     05  WS-TEXT-MESSAGE-LENGTH      PIC S9(4)       VALUE +70
   256                                     COMP SYNC.
   257
   258     05  WS-TEXT-MESSAGE             PIC X(70)       VALUE SPACES.
   259
   260     05  WS-TOTAL-LINE1.
   261         10  FILLER                  PIC X(14)       VALUE
   262             'CONTROL GROUP'.
   263         10  WS-TL1-CONTROL-GROUP    PIC 9(7)-.
   264         10  WS-TL1-RELEASE          PIC X(20)       VALUE
   265             ' RELEASED'.
   266
   267     05  WS-TOTAL-LINE2.
   268         10  WS-TL1-COUNT            PIC ZZ,ZZ9.
   269         10  FILLER                  PIC X(6)        VALUE
   270             ' CHECK'.
   271         10  WS-TL1-PLURAL           PIC X           VALUE
   272             'S'.
   273         10  FILLER                  PIC X(18)       VALUE
   274             ' IN THE AMOUNT OF'.
   275         10  WS-TL1-AMOUNT           PIC Z,ZZZ,ZZ9.99.
   276
   277     05  WS-TEMP-STORAGE-KEY.
   278         10  WS-TS-TERM-ID           PIC X(4).
   279         10  FILLER                  PIC X(4)        VALUE '685'.
   280
   281     05  WS-TEMP-STORAGE-ITEM        PIC S9(4)       VALUE ZERO
   282                                     COMP SYNC.
   283
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   7
* EL686.cbl
   285*    COPY ELCINTF.
   286******************************************************************
   287*                                                                *
   288*                                                                *
   289*                            ELCINTF.                            *
   290*                            VMOD=2.017                          *
   291*                                                                *
   292*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   293*                                                                *
   294*       LENGTH = 1024                                            *
   295*                                                                *
   296******************************************************************
   297 01  PROGRAM-INTERFACE-BLOCK.
   298     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   299     12  PI-CALLING-PROGRAM              PIC X(8).
   300     12  PI-SAVED-PROGRAM-1              PIC X(8).
   301     12  PI-SAVED-PROGRAM-2              PIC X(8).
   302     12  PI-SAVED-PROGRAM-3              PIC X(8).
   303     12  PI-SAVED-PROGRAM-4              PIC X(8).
   304     12  PI-SAVED-PROGRAM-5              PIC X(8).
   305     12  PI-SAVED-PROGRAM-6              PIC X(8).
   306     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   307     12  PI-COMPANY-ID                   PIC XXX.
   308     12  PI-COMPANY-CD                   PIC X.
   309
   310     12  PI-COMPANY-PASSWORD             PIC X(8).
   311
   312     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   313
   314     12  PI-CONTROL-IN-PROGRESS.
   315         16  PI-CARRIER                  PIC X.
   316         16  PI-GROUPING                 PIC X(6).
   317         16  PI-STATE                    PIC XX.
   318         16  PI-ACCOUNT                  PIC X(10).
   319         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   320                                         PIC X(10).
   321         16  PI-CLAIM-CERT-GRP.
   322             20  PI-CLAIM-NO             PIC X(7).
   323             20  PI-CERT-NO.
   324                 25  PI-CERT-PRIME       PIC X(10).
   325                 25  PI-CERT-SFX         PIC X.
   326             20  PI-CERT-EFF-DT          PIC XX.
   327         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   328             20  PI-PLAN-CODE            PIC X(2).
   329             20  PI-REVISION-NUMBER      PIC X(3).
   330             20  PI-PLAN-EFF-DT          PIC X(2).
   331             20  PI-PLAN-EXP-DT          PIC X(2).
   332             20  FILLER                  PIC X(11).
   333         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   334             20  PI-OE-REFERENCE-1.
   335                 25  PI-OE-REF-1-PRIME   PIC X(18).
   336                 25  PI-OE-REF-1-SUFF    PIC XX.
   337
   338     12  PI-SESSION-IN-PROGRESS          PIC X.
   339         88  CLAIM-SESSION                   VALUE '1'.
   340         88  CREDIT-SESSION                  VALUE '2'.
   341         88  WARRANTY-SESSION                VALUE '3'.
   342         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   8
* EL686.cbl
   343         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   344
   345
   346*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   347
   348     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   349     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   350
   351     12  PI-CREDIT-USER                  PIC X.
   352         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   353         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   354
   355     12  PI-CLAIM-USER                   PIC X.
   356         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   357         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   358
   359     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   360         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   361         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   362         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   363         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   364         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   365
   366     12  PI-PROCESSOR-ID                 PIC X(4).
   367
   368     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   369
   370     12  PI-MEMBER-CAPTION               PIC X(10).
   371
   372     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   373         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   374
   375     12  PI-LIFE-OVERRIDE-L1             PIC X.
   376     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   377     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   378     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   379
   380     12  PI-AH-OVERRIDE-L1               PIC X.
   381     12  PI-AH-OVERRIDE-L2               PIC XX.
   382     12  PI-AH-OVERRIDE-L6               PIC X(6).
   383     12  PI-AH-OVERRIDE-L12              PIC X(12).
   384
   385     12  PI-NEW-SYSTEM                   PIC X(2).
   386
   387     12  PI-PRIMARY-CERT-NO              PIC X(11).
   388     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   389         88  PI-USES-PAID-TO                 VALUE '1'.
   390     12  PI-CRDTCRD-SYSTEM.
   391         16  PI-CRDTCRD-USER             PIC X.
   392             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   393             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   394         16  PI-CC-MONTH-END-DT          PIC XX.
   395     12  PI-PROCESSOR-PRINTER            PIC X(4).
   396
   397     12  PI-OE-REFERENCE-2.
   398         16  PI-OE-REF-2-PRIME           PIC X(10).
   399         16  PI-OE-REF-2-SUFF            PIC X.
   400
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   9
* EL686.cbl
   401     12  PI-REM-TRM-CALC-OPTION          PIC X.
   402
   403     12  PI-LANGUAGE-TYPE                PIC X.
   404             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   405             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   406             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   407
   408     12  PI-POLICY-LINKAGE-IND           PIC X.
   409         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   410         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   411                                                   LOW-VALUES.
   412
   413     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   414     12  PI-CLAIM-PW-SESSION             PIC X(1).
   415         88  PI-CLAIM-CREDIT                 VALUE '1'.
   416         88  PI-CLAIM-CONVEN                 VALUE '2'.
   417     12  FILLER                          PIC X(4).
   418
   419     12  PI-SYSTEM-LEVEL                 PIC X(145).
   420
   421     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   422         PI-SYSTEM-LEVEL.
   423
   424         16  PI-ENTRY-CODES.
   425             20  PI-ENTRY-CD-1           PIC X.
   426             20  PI-ENTRY-CD-2           PIC X.
   427
   428         16  PI-RETURN-CODES.
   429             20  PI-RETURN-CD-1          PIC X.
   430             20  PI-RETURN-CD-2          PIC X.
   431
   432         16  PI-UPDATE-STATUS-SAVE.
   433             20  PI-UPDATE-BY            PIC X(4).
   434             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   435
   436         16  PI-LOWER-CASE-LETTERS       PIC X.
   437             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   438
   439*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   440*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   441*            88  CARRIER-CLM-CNTL            VALUE '2'.
   442
   443         16  PI-CERT-ACCESS-CONTROL      PIC X.
   444             88  ST-ACCNT-CNTL               VALUE ' '.
   445             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   446             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   447             88  ACCNT-CNTL                  VALUE '3'.
   448             88  CARR-ACCNT-CNTL             VALUE '4'.
   449
   450         16  PI-PROCESSOR-CAP-LIST.
   451             20  PI-SYSTEM-CONTROLS.
   452                24 PI-SYSTEM-DISPLAY     PIC X.
   453                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   454                24 PI-SYSTEM-MODIFY      PIC X.
   455                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   456             20  FILLER                  PIC XX.
   457             20  PI-DISPLAY-CAP          PIC X.
   458                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  10
* EL686.cbl
   459             20  PI-MODIFY-CAP           PIC X.
   460                 88  MODIFY-CAP              VALUE 'Y'.
   461             20  PI-MSG-AT-LOGON-CAP     PIC X.
   462                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   463             20  PI-FORCE-CAP            PIC X.
   464                 88  FORCE-CAP               VALUE 'Y'.
   465
   466         16  PI-PROGRAM-CONTROLS.
   467             20  PI-PGM-PRINT-OPT        PIC X.
   468             20  PI-PGM-FORMAT-OPT       PIC X.
   469             20  PI-PGM-PROCESS-OPT      PIC X.
   470             20  PI-PGM-TOTALS-OPT       PIC X.
   471
   472         16  PI-HELP-INTERFACE.
   473             20  PI-LAST-ERROR-NO        PIC X(4).
   474             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   475
   476         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   477             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   478
   479         16  PI-CR-CONTROL-IN-PROGRESS.
   480             20  PI-CR-CARRIER           PIC X.
   481             20  PI-CR-GROUPING          PIC X(6).
   482             20  PI-CR-STATE             PIC XX.
   483             20  PI-CR-ACCOUNT           PIC X(10).
   484             20  PI-CR-FIN-RESP          PIC X(10).
   485             20  PI-CR-TYPE              PIC X.
   486
   487         16  PI-CR-BATCH-NUMBER          PIC X(6).
   488
   489         16  PI-CR-MONTH-END-DT          PIC XX.
   490
   491         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   492             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   493             88  PI-ZERO-CARRIER             VALUE '1'.
   494             88  PI-ZERO-GROUPING            VALUE '2'.
   495             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   496
   497         16  PI-CARRIER-SECURITY         PIC X.
   498             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   499
   500         16  PI-ACCOUNT-SECURITY         PIC X(10).
   501             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   502             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   503
   504         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   505             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   506                                         INDEXED BY PI-ACCESS-NDX
   507                                         PIC X.
   508
   509         16  PI-GA-BILLING-CONTROL       PIC X.
   510             88  PI-GA-BILLING               VALUE '1'.
   511
   512         16  PI-MAIL-PROCESSING          PIC X.
   513             88  PI-MAIL-YES                 VALUE 'Y'.
   514
   515         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   516
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  11
* EL686.cbl
   517         16  PI-AR-SYSTEM.
   518             20  PI-AR-PROCESSING-CNTL   PIC X.
   519                 88  PI-AR-PROCESSING        VALUE 'Y'.
   520             20  PI-AR-SUMMARY-CODE      PIC X(6).
   521             20  PI-AR-MONTH-END-DT      PIC XX.
   522
   523         16  PI-MP-SYSTEM.
   524             20  PI-MORTGAGE-USER            PIC X.
   525                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   526                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   527             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   528                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   529                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   530                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   531                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   532                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   533             20  PI-MP-MONTH-END-DT          PIC XX.
   534             20  PI-MP-REFERENCE-NO.
   535                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   536                 24  PI-MP-REFERENCE-SFX     PIC XX.
   537
   538         16  PI-LABEL-CONTROL            PIC X(01).
   539             88  PI-CREATE-LABELS                    VALUE 'Y'.
   540             88  PI-BYPASS-LABELS                    VALUE 'N'.
   541
   542         16  PI-BILL-GROUPING-CODE       PIC X(01).
   543             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   544
   545         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   546             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   547             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   548
   549         16  FILLER                      PIC X(14).
   550
   551     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   552******************************************************************
   553
   554     12  FILLER                      REDEFINES
   555         PI-PROGRAM-WORK-AREA.
   556             16  FILLER              PIC X.
   557             16  PI-CK-CONTROL-NO    PIC S9(8)      COMP.
   558             16  PI-CURRENT-DATE     PIC X(8).
   559             16  PI-CURRENT-DATE-BIN PIC XX.
   560             16  PI-PROC-SW          PIC S9.
   561                 88  PI-SCREEN-PROCESSED        VALUE +1.
   562             16  PI-CERT-SW          PIC S9.
   563                 88  PI-CERT-NOT-MATCHED        VALUE +0.
   564                 88  PI-CERT-MATCHED            VALUE +1.
   565             16  PI-CHECK-AMOUNT     PIC S9(7)  COMP-3.
   566             16  BIN-EFFDT           PIC XX   OCCURS 15.
   567             16  FILLER              PIC X(589).
   568
   569*    COPY EL686S.
   570 01  EL686AI.
   571     05  FILLER            PIC  X(0012).
   572*    -------------------------------
   573     05  ADATEL PIC S9(0004) COMP.
   574     05  ADATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  12
* EL686.cbl
   575     05  FILLER REDEFINES ADATEF.
   576         10  ADATEA PIC  X(0001).
   577     05  ADATEI PIC  X(0008).
   578*    -------------------------------
   579     05  ATIMEL PIC S9(0004) COMP.
   580     05  ATIMEF PIC  X(0001).
   581     05  FILLER REDEFINES ATIMEF.
   582         10  ATIMEA PIC  X(0001).
   583     05  ATIMEI PIC  X(0005).
   584*    -------------------------------
   585     05  AOPTIONL PIC S9(0004) COMP.
   586     05  AOPTIONF PIC  X(0001).
   587     05  FILLER REDEFINES AOPTIONF.
   588         10  AOPTIONA PIC  X(0001).
   589     05  AOPTIONI PIC  X(0001).
   590*    -------------------------------
   591     05  AAMTL PIC S9(0004) COMP.
   592     05  AAMTF PIC  X(0001).
   593     05  FILLER REDEFINES AAMTF.
   594         10  AAMTA PIC  X(0001).
   595     05  AAMTI PIC  9(7).
   596*    -------------------------------
   597     05  ABYL PIC S9(0004) COMP.
   598     05  ABYF PIC  X(0001).
   599     05  FILLER REDEFINES ABYF.
   600         10  ABYA PIC  X(0001).
   601     05  ABYI PIC  X(0004).
   602*    -------------------------------
   603     05  ACARRL PIC S9(0004) COMP.
   604     05  ACARRF PIC  X(0001).
   605     05  FILLER REDEFINES ACARRF.
   606         10  ACARRA PIC  X(0001).
   607     05  ACARRI PIC  X(0001).
   608*    -------------------------------
   609     05  AGROUPL PIC S9(0004) COMP.
   610     05  AGROUPF PIC  X(0001).
   611     05  FILLER REDEFINES AGROUPF.
   612         10  AGROUPA PIC  X(0001).
   613     05  AGROUPI PIC  X(0006).
   614*    -------------------------------
   615     05  ASTATL PIC S9(0004) COMP.
   616     05  ASTATF PIC  X(0001).
   617     05  FILLER REDEFINES ASTATF.
   618         10  ASTATA PIC  X(0001).
   619     05  ASTATI PIC  X(0002).
   620*    -------------------------------
   621     05  AACCTL PIC S9(0004) COMP.
   622     05  AACCTF PIC  X(0001).
   623     05  FILLER REDEFINES AACCTF.
   624         10  AACCTA PIC  X(0001).
   625     05  AACCTI PIC  X(0010).
   626*    -------------------------------
   627     05  CERTO01L PIC S9(0004) COMP.
   628     05  CERTO01F PIC  X(0001).
   629     05  FILLER REDEFINES CERTO01F.
   630         10  CERTO01A PIC  X(0001).
   631     05  CERTO01I PIC  X(0011).
   632*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  13
* EL686.cbl
   633     05  EFFDT01L PIC S9(0004) COMP.
   634     05  EFFDT01F PIC  X(0001).
   635     05  FILLER REDEFINES EFFDT01F.
   636         10  EFFDT01A PIC  X(0001).
   637     05  EFFDT01I PIC  X(0008).
   638*    -------------------------------
   639     05  CERTO02L PIC S9(0004) COMP.
   640     05  CERTO02F PIC  X(0001).
   641     05  FILLER REDEFINES CERTO02F.
   642         10  CERTO02A PIC  X(0001).
   643     05  CERTO02I PIC  X(0011).
   644*    -------------------------------
   645     05  EFFDT02L PIC S9(0004) COMP.
   646     05  EFFDT02F PIC  X(0001).
   647     05  FILLER REDEFINES EFFDT02F.
   648         10  EFFDT02A PIC  X(0001).
   649     05  EFFDT02I PIC  X(0008).
   650*    -------------------------------
   651     05  CERTO03L PIC S9(0004) COMP.
   652     05  CERTO03F PIC  X(0001).
   653     05  FILLER REDEFINES CERTO03F.
   654         10  CERTO03A PIC  X(0001).
   655     05  CERTO03I PIC  X(0011).
   656*    -------------------------------
   657     05  EFFDT03L PIC S9(0004) COMP.
   658     05  EFFDT03F PIC  X(0001).
   659     05  FILLER REDEFINES EFFDT03F.
   660         10  EFFDT03A PIC  X(0001).
   661     05  EFFDT03I PIC  X(0008).
   662*    -------------------------------
   663     05  CERTO04L PIC S9(0004) COMP.
   664     05  CERTO04F PIC  X(0001).
   665     05  FILLER REDEFINES CERTO04F.
   666         10  CERTO04A PIC  X(0001).
   667     05  CERTO04I PIC  X(0011).
   668*    -------------------------------
   669     05  EFFDT04L PIC S9(0004) COMP.
   670     05  EFFDT04F PIC  X(0001).
   671     05  FILLER REDEFINES EFFDT04F.
   672         10  EFFDT04A PIC  X(0001).
   673     05  EFFDT04I PIC  X(0008).
   674*    -------------------------------
   675     05  CERTO05L PIC S9(0004) COMP.
   676     05  CERTO05F PIC  X(0001).
   677     05  FILLER REDEFINES CERTO05F.
   678         10  CERTO05A PIC  X(0001).
   679     05  CERTO05I PIC  X(0011).
   680*    -------------------------------
   681     05  EFFDT05L PIC S9(0004) COMP.
   682     05  EFFDT05F PIC  X(0001).
   683     05  FILLER REDEFINES EFFDT05F.
   684         10  EFFDT05A PIC  X(0001).
   685     05  EFFDT05I PIC  X(0008).
   686*    -------------------------------
   687     05  CERTO06L PIC S9(0004) COMP.
   688     05  CERTO06F PIC  X(0001).
   689     05  FILLER REDEFINES CERTO06F.
   690         10  CERTO06A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  14
* EL686.cbl
   691     05  CERTO06I PIC  X(0011).
   692*    -------------------------------
   693     05  EFFDT06L PIC S9(0004) COMP.
   694     05  EFFDT06F PIC  X(0001).
   695     05  FILLER REDEFINES EFFDT06F.
   696         10  EFFDT06A PIC  X(0001).
   697     05  EFFDT06I PIC  X(0008).
   698*    -------------------------------
   699     05  CERTO07L PIC S9(0004) COMP.
   700     05  CERTO07F PIC  X(0001).
   701     05  FILLER REDEFINES CERTO07F.
   702         10  CERTO07A PIC  X(0001).
   703     05  CERTO07I PIC  X(0011).
   704*    -------------------------------
   705     05  EFFDT07L PIC S9(0004) COMP.
   706     05  EFFDT07F PIC  X(0001).
   707     05  FILLER REDEFINES EFFDT07F.
   708         10  EFFDT07A PIC  X(0001).
   709     05  EFFDT07I PIC  X(0008).
   710*    -------------------------------
   711     05  CERTO08L PIC S9(0004) COMP.
   712     05  CERTO08F PIC  X(0001).
   713     05  FILLER REDEFINES CERTO08F.
   714         10  CERTO08A PIC  X(0001).
   715     05  CERTO08I PIC  X(0011).
   716*    -------------------------------
   717     05  EFFDT08L PIC S9(0004) COMP.
   718     05  EFFDT08F PIC  X(0001).
   719     05  FILLER REDEFINES EFFDT08F.
   720         10  EFFDT08A PIC  X(0001).
   721     05  EFFDT08I PIC  X(0008).
   722*    -------------------------------
   723     05  CERTO09L PIC S9(0004) COMP.
   724     05  CERTO09F PIC  X(0001).
   725     05  FILLER REDEFINES CERTO09F.
   726         10  CERTO09A PIC  X(0001).
   727     05  CERTO09I PIC  X(0011).
   728*    -------------------------------
   729     05  EFFDT09L PIC S9(0004) COMP.
   730     05  EFFDT09F PIC  X(0001).
   731     05  FILLER REDEFINES EFFDT09F.
   732         10  EFFDT09A PIC  X(0001).
   733     05  EFFDT09I PIC  X(0008).
   734*    -------------------------------
   735     05  CERTO10L PIC S9(0004) COMP.
   736     05  CERTO10F PIC  X(0001).
   737     05  FILLER REDEFINES CERTO10F.
   738         10  CERTO10A PIC  X(0001).
   739     05  CERTO10I PIC  X(0011).
   740*    -------------------------------
   741     05  EFFDT10L PIC S9(0004) COMP.
   742     05  EFFDT10F PIC  X(0001).
   743     05  FILLER REDEFINES EFFDT10F.
   744         10  EFFDT10A PIC  X(0001).
   745     05  EFFDT10I PIC  X(0008).
   746*    -------------------------------
   747     05  CERTO11L PIC S9(0004) COMP.
   748     05  CERTO11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  15
* EL686.cbl
   749     05  FILLER REDEFINES CERTO11F.
   750         10  CERTO11A PIC  X(0001).
   751     05  CERTO11I PIC  X(0011).
   752*    -------------------------------
   753     05  EFFDT11L PIC S9(0004) COMP.
   754     05  EFFDT11F PIC  X(0001).
   755     05  FILLER REDEFINES EFFDT11F.
   756         10  EFFDT11A PIC  X(0001).
   757     05  EFFDT11I PIC  X(0008).
   758*    -------------------------------
   759     05  CERTO12L PIC S9(0004) COMP.
   760     05  CERTO12F PIC  X(0001).
   761     05  FILLER REDEFINES CERTO12F.
   762         10  CERTO12A PIC  X(0001).
   763     05  CERTO12I PIC  X(0011).
   764*    -------------------------------
   765     05  EFFDT12L PIC S9(0004) COMP.
   766     05  EFFDT12F PIC  X(0001).
   767     05  FILLER REDEFINES EFFDT12F.
   768         10  EFFDT12A PIC  X(0001).
   769     05  EFFDT12I PIC  X(0008).
   770*    -------------------------------
   771     05  CERTO13L PIC S9(0004) COMP.
   772     05  CERTO13F PIC  X(0001).
   773     05  FILLER REDEFINES CERTO13F.
   774         10  CERTO13A PIC  X(0001).
   775     05  CERTO13I PIC  X(0011).
   776*    -------------------------------
   777     05  EFFDT13L PIC S9(0004) COMP.
   778     05  EFFDT13F PIC  X(0001).
   779     05  FILLER REDEFINES EFFDT13F.
   780         10  EFFDT13A PIC  X(0001).
   781     05  EFFDT13I PIC  X(0008).
   782*    -------------------------------
   783     05  CERTO14L PIC S9(0004) COMP.
   784     05  CERTO14F PIC  X(0001).
   785     05  FILLER REDEFINES CERTO14F.
   786         10  CERTO14A PIC  X(0001).
   787     05  CERTO14I PIC  X(0011).
   788*    -------------------------------
   789     05  EFFDT14L PIC S9(0004) COMP.
   790     05  EFFDT14F PIC  X(0001).
   791     05  FILLER REDEFINES EFFDT14F.
   792         10  EFFDT14A PIC  X(0001).
   793     05  EFFDT14I PIC  X(0008).
   794*    -------------------------------
   795     05  CERTO15L PIC S9(0004) COMP.
   796     05  CERTO15F PIC  X(0001).
   797     05  FILLER REDEFINES CERTO15F.
   798         10  CERTO15A PIC  X(0001).
   799     05  CERTO15I PIC  X(0011).
   800*    -------------------------------
   801     05  EFFDT15L PIC S9(0004) COMP.
   802     05  EFFDT15F PIC  X(0001).
   803     05  FILLER REDEFINES EFFDT15F.
   804         10  EFFDT15A PIC  X(0001).
   805     05  EFFDT15I PIC  X(0008).
   806*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  16
* EL686.cbl
   807     05  AEMSG1L PIC S9(0004) COMP.
   808     05  AEMSG1F PIC  X(0001).
   809     05  FILLER REDEFINES AEMSG1F.
   810         10  AEMSG1A PIC  X(0001).
   811     05  AEMSG1I PIC  X(0079).
   812*    -------------------------------
   813     05  AEMSG2L PIC S9(0004) COMP.
   814     05  AEMSG2F PIC  X(0001).
   815     05  FILLER REDEFINES AEMSG2F.
   816         10  AEMSG2A PIC  X(0001).
   817     05  AEMSG2I PIC  X(0079).
   818*    -------------------------------
   819     05  APFKL PIC S9(0004) COMP.
   820     05  APFKF PIC  X(0001).
   821     05  FILLER REDEFINES APFKF.
   822         10  APFKA PIC  X(0001).
   823     05  APFKI PIC  9(2).
   824*    -------------------------------
   825     05  ACOMPL PIC S9(0004) COMP.
   826     05  ACOMPF PIC  X(0001).
   827     05  FILLER REDEFINES ACOMPF.
   828         10  ACOMPA PIC  X(0001).
   829     05  ACOMPI PIC  X(0014).
   830*    -------------------------------
   831     05  APF1L PIC S9(0004) COMP.
   832     05  APF1F PIC  X(0001).
   833     05  FILLER REDEFINES APF1F.
   834         10  APF1A PIC  X(0001).
   835     05  APF1I PIC  X(0028).
   836 01  EL686AO REDEFINES EL686AI.
   837     05  FILLER            PIC  X(0012).
   838*    -------------------------------
   839     05  FILLER            PIC  X(0003).
   840     05  ADATEO PIC  X(0008).
   841*    -------------------------------
   842     05  FILLER            PIC  X(0003).
   843     05  ATIMEO PIC  99.99.
   844*    -------------------------------
   845     05  FILLER            PIC  X(0003).
   846     05  AOPTIONO PIC  X(0001).
   847*    -------------------------------
   848     05  FILLER            PIC  X(0003).
   849     05  AAMTO PIC  ZZZ,ZZ9.
   850*    -------------------------------
   851     05  FILLER            PIC  X(0003).
   852     05  ABYO PIC  X(0004).
   853*    -------------------------------
   854     05  FILLER            PIC  X(0003).
   855     05  ACARRO PIC  X(0001).
   856*    -------------------------------
   857     05  FILLER            PIC  X(0003).
   858     05  AGROUPO PIC  X(0006).
   859*    -------------------------------
   860     05  FILLER            PIC  X(0003).
   861     05  ASTATO PIC  X(0002).
   862*    -------------------------------
   863     05  FILLER            PIC  X(0003).
   864     05  AACCTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  17
* EL686.cbl
   865*    -------------------------------
   866     05  FILLER            PIC  X(0003).
   867     05  CERTO01O PIC  X(0011).
   868*    -------------------------------
   869     05  FILLER            PIC  X(0003).
   870     05  EFFDT01O PIC  X(0008).
   871*    -------------------------------
   872     05  FILLER            PIC  X(0003).
   873     05  CERTO02O PIC  X(0011).
   874*    -------------------------------
   875     05  FILLER            PIC  X(0003).
   876     05  EFFDT02O PIC  X(0008).
   877*    -------------------------------
   878     05  FILLER            PIC  X(0003).
   879     05  CERTO03O PIC  X(0011).
   880*    -------------------------------
   881     05  FILLER            PIC  X(0003).
   882     05  EFFDT03O PIC  X(0008).
   883*    -------------------------------
   884     05  FILLER            PIC  X(0003).
   885     05  CERTO04O PIC  X(0011).
   886*    -------------------------------
   887     05  FILLER            PIC  X(0003).
   888     05  EFFDT04O PIC  X(0008).
   889*    -------------------------------
   890     05  FILLER            PIC  X(0003).
   891     05  CERTO05O PIC  X(0011).
   892*    -------------------------------
   893     05  FILLER            PIC  X(0003).
   894     05  EFFDT05O PIC  X(0008).
   895*    -------------------------------
   896     05  FILLER            PIC  X(0003).
   897     05  CERTO06O PIC  X(0011).
   898*    -------------------------------
   899     05  FILLER            PIC  X(0003).
   900     05  EFFDT06O PIC  X(0008).
   901*    -------------------------------
   902     05  FILLER            PIC  X(0003).
   903     05  CERTO07O PIC  X(0011).
   904*    -------------------------------
   905     05  FILLER            PIC  X(0003).
   906     05  EFFDT07O PIC  X(0008).
   907*    -------------------------------
   908     05  FILLER            PIC  X(0003).
   909     05  CERTO08O PIC  X(0011).
   910*    -------------------------------
   911     05  FILLER            PIC  X(0003).
   912     05  EFFDT08O PIC  X(0008).
   913*    -------------------------------
   914     05  FILLER            PIC  X(0003).
   915     05  CERTO09O PIC  X(0011).
   916*    -------------------------------
   917     05  FILLER            PIC  X(0003).
   918     05  EFFDT09O PIC  X(0008).
   919*    -------------------------------
   920     05  FILLER            PIC  X(0003).
   921     05  CERTO10O PIC  X(0011).
   922*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  18
* EL686.cbl
   923     05  FILLER            PIC  X(0003).
   924     05  EFFDT10O PIC  X(0008).
   925*    -------------------------------
   926     05  FILLER            PIC  X(0003).
   927     05  CERTO11O PIC  X(0011).
   928*    -------------------------------
   929     05  FILLER            PIC  X(0003).
   930     05  EFFDT11O PIC  X(0008).
   931*    -------------------------------
   932     05  FILLER            PIC  X(0003).
   933     05  CERTO12O PIC  X(0011).
   934*    -------------------------------
   935     05  FILLER            PIC  X(0003).
   936     05  EFFDT12O PIC  X(0008).
   937*    -------------------------------
   938     05  FILLER            PIC  X(0003).
   939     05  CERTO13O PIC  X(0011).
   940*    -------------------------------
   941     05  FILLER            PIC  X(0003).
   942     05  EFFDT13O PIC  X(0008).
   943*    -------------------------------
   944     05  FILLER            PIC  X(0003).
   945     05  CERTO14O PIC  X(0011).
   946*    -------------------------------
   947     05  FILLER            PIC  X(0003).
   948     05  EFFDT14O PIC  X(0008).
   949*    -------------------------------
   950     05  FILLER            PIC  X(0003).
   951     05  CERTO15O PIC  X(0011).
   952*    -------------------------------
   953     05  FILLER            PIC  X(0003).
   954     05  EFFDT15O PIC  X(0008).
   955*    -------------------------------
   956     05  FILLER            PIC  X(0003).
   957     05  AEMSG1O PIC  X(0079).
   958*    -------------------------------
   959     05  FILLER            PIC  X(0003).
   960     05  AEMSG2O PIC  X(0079).
   961*    -------------------------------
   962     05  FILLER            PIC  X(0003).
   963     05  APFKO PIC  99.
   964*    -------------------------------
   965     05  FILLER            PIC  X(0003).
   966     05  ACOMPO PIC  X(0014).
   967*    -------------------------------
   968     05  FILLER            PIC  X(0003).
   969     05  APF1O PIC  X(0028).
   970*    -------------------------------
   971
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  19
* EL686.cbl
   973*    COPY ELCJPFX.
   974******************************************************************
   975*                                                                *
   976*                                                                *
   977*                            ELCJPFX.                            *
   978*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   979*                            VMOD=2.002                          *
   980*                                                                *
   981*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   982*                                                                *
   983*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   984*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   985*        ELCNTL - CONTROL FILE                                   *
   986*        ELMSTR - CLAIM MASTERS                                  *
   987*        ELTRLR - ACTIVITY TRAILERS                              *
   988*        ELCHKQ - CHECK QUE                                      *
   989******************************************************************
   990 01  JOURNAL-RECORD.
   991     12  JP-USER-ID                  PIC X(4).
   992     12  JP-FILE-ID                  PIC X(8).
   993     12  JP-PROGRAM-ID               PIC X(8).
   994     12  JP-RECORD-TYPE              PIC X.
   995         88 JP-ADD              VALUE 'A'.
   996         88 JP-BEFORE-CHANGE    VALUE 'B'.
   997         88 JP-AFTER-CHANGE     VALUE 'C'.
   998         88 JP-DELETE           VALUE 'D'.
   999         88 JP-GENERIC-DELETE   VALUE 'G'.
  1000         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1001         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1002     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1003     12  JP-RECORD-AREA
  1004
  1005
  1006                PIC X(750).
  1007
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  20
* EL686.cbl
  1009*    COPY ELCEMIB.
  1010******************************************************************
  1011*                                                                *
  1012*                                                                *
  1013*                            ELCEMIB.                            *
  1014*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1015*                            VMOD=2.005                          *
  1016*                                                                *
  1017*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1018*                                                                *
  1019******************************************************************
  1020 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1021     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1022     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1023     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1024     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1025     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1026     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1027     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1028     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1029     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1030         88  EMI-NO-ERRORS                    VALUE '1'.
  1031         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1032         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1033     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1034         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1035     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1036         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1037         88  EMI-AREA1-FULL                   VALUE '2'.
  1038     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1039         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1040         88  EMI-AREA2-FULL                   VALUE '2'.
  1041     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1042         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1043         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1044         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1045         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1046         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1047     12  EMI-ERROR-LINES.
  1048         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1049         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1050         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1051         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1052             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1053                 24  EMI-ERR-NUM         PIC X(4).
  1054                 24  EMI-FILLER          PIC X.
  1055                 24  EMI-SEV             PIC X.
  1056                 24  FILLER              PIC X.
  1057             20  FILLER                  PIC X(02).
  1058     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1059         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1060             20  EMI-ERROR-NUMBER    PIC X(4).
  1061             20  EMI-FILL            PIC X.
  1062             20  EMI-SEVERITY        PIC X.
  1063             20  FILLER              PIC X.
  1064             20  EMI-ERROR-TEXT.
  1065                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1066                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  21
* EL686.cbl
  1067     12  EMI-SEVERITY-SAVE           PIC X.
  1068         88  EMI-NOTE                    VALUE 'N'.
  1069         88  EMI-WARNING                 VALUE 'W'.
  1070         88  EMI-FORCABLE                VALUE 'F'.
  1071         88  EMI-FATAL                   VALUE 'X'.
  1072     12  EMI-MESSAGE-FLAG            PIC X.
  1073         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1074         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1075     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1076     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1077         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1078         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1079         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1080     12  FILLER                      PIC X(137)  VALUE SPACES.
  1081     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1082     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1083     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1084     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1085
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  22
* EL686.cbl
  1087*    COPY ELCDATE.
  1088******************************************************************
  1089*                                                                *
  1090*                                                                *
  1091*                            ELCDATE.                            *
  1092*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1093*                            VMOD=2.003
  1094*                                                                *
  1095*                                                                *
  1096*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1097*                 LENGTH = 200                                   *
  1098******************************************************************
  1099
  1100 01  DATE-CONVERSION-DATA.
  1101     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1102     12  DC-OPTION-CODE                PIC X.
  1103         88  BIN-TO-GREG                VALUE ' '.
  1104         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1105         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1106         88  YMD-GREG-TO-BIN            VALUE '3'.
  1107         88  MDY-GREG-TO-BIN            VALUE '4'.
  1108         88  JULIAN-TO-BIN              VALUE '5'.
  1109         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1110         88  FIND-CENTURY               VALUE '7'.
  1111         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1112         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1113         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1114         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1115         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1116         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1117         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1118         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1119         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1120         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1121         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1122         88  BIN-3-TO-GREG              VALUE 'I'.
  1123         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1124         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1125         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1126         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1127         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1128         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1129         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1130         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1131         88  THREE-CHARACTER-BIN
  1132                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1133         88  GREGORIAN-TO-BIN
  1134                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1135         88  BIN-TO-GREGORIAN
  1136                  VALUES ' ' '1' 'I' '8' 'G'.
  1137         88  JULIAN-TO-BINARY
  1138                  VALUES '5' 'C' 'E' 'F'.
  1139     12  DC-ERROR-CODE                 PIC X.
  1140         88  NO-CONVERSION-ERROR        VALUE ' '.
  1141         88  DATE-CONVERSION-ERROR
  1142                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1143         88  DATE-IS-ZERO               VALUE '1'.
  1144         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  23
* EL686.cbl
  1145         88  DATE-IS-INVALID            VALUE '3'.
  1146         88  DATE1-GREATER-DATE2        VALUE '4'.
  1147         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1148         88  DATE-INVALID-OPTION        VALUE '9'.
  1149         88  INVALID-CENTURY            VALUE 'A'.
  1150         88  ONLY-CENTURY               VALUE 'B'.
  1151         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1152         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1153     12  DC-END-OF-MONTH               PIC X.
  1154         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1155     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1156         88  USE-NORMAL-PROCESS         VALUE ' '.
  1157         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1158         88  ADJUST-UP-100-YRS          VALUE '2'.
  1159     12  FILLER                        PIC X.
  1160     12  DC-CONVERSION-DATES.
  1161         16  DC-BIN-DATE-1             PIC XX.
  1162         16  DC-BIN-DATE-2             PIC XX.
  1163         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1164         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1165                       DC-GREG-DATE-1-EDIT.
  1166             20  DC-EDIT1-MONTH        PIC 99.
  1167             20  SLASH1-1              PIC X.
  1168             20  DC-EDIT1-DAY          PIC 99.
  1169             20  SLASH1-2              PIC X.
  1170             20  DC-EDIT1-YEAR         PIC 99.
  1171         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1172         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1173                     DC-GREG-DATE-2-EDIT.
  1174             20  DC-EDIT2-MONTH        PIC 99.
  1175             20  SLASH2-1              PIC X.
  1176             20  DC-EDIT2-DAY          PIC 99.
  1177             20  SLASH2-2              PIC X.
  1178             20  DC-EDIT2-YEAR         PIC 99.
  1179         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1180         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1181                     DC-GREG-DATE-1-YMD.
  1182             20  DC-YMD-YEAR           PIC 99.
  1183             20  DC-YMD-MONTH          PIC 99.
  1184             20  DC-YMD-DAY            PIC 99.
  1185         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1186         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1187                      DC-GREG-DATE-1-MDY.
  1188             20  DC-MDY-MONTH          PIC 99.
  1189             20  DC-MDY-DAY            PIC 99.
  1190             20  DC-MDY-YEAR           PIC 99.
  1191         16  DC-GREG-DATE-1-ALPHA.
  1192             20  DC-ALPHA-MONTH        PIC X(10).
  1193             20  DC-ALPHA-DAY          PIC 99.
  1194             20  FILLER                PIC XX.
  1195             20  DC-ALPHA-CENTURY.
  1196                 24 DC-ALPHA-CEN-N     PIC 99.
  1197             20  DC-ALPHA-YEAR         PIC 99.
  1198         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1199         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1200         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1201         16  DC-JULIAN-DATE            PIC 9(05).
  1202         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  24
* EL686.cbl
  1203                                       PIC 9(05).
  1204         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1205             20  DC-JULIAN-YEAR        PIC 99.
  1206             20  DC-JULIAN-DAYS        PIC 999.
  1207         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1208         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1209         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1210     12  DATE-CONVERSION-VARIBLES.
  1211         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1212         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1213             20  FILLER                PIC 9(3).
  1214             20  HOLD-CEN-1-CCYY.
  1215                 24  HOLD-CEN-1-CC     PIC 99.
  1216                 24  HOLD-CEN-1-YY     PIC 99.
  1217             20  HOLD-CEN-1-MO         PIC 99.
  1218             20  HOLD-CEN-1-DA         PIC 99.
  1219         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1220             20  HOLD-CEN-1-R-MO       PIC 99.
  1221             20  HOLD-CEN-1-R-DA       PIC 99.
  1222             20  HOLD-CEN-1-R-CCYY.
  1223                 24  HOLD-CEN-1-R-CC   PIC 99.
  1224                 24  HOLD-CEN-1-R-YY   PIC 99.
  1225             20  FILLER                PIC 9(3).
  1226         16  HOLD-CENTURY-1-X.
  1227             20  FILLER                PIC X(3)  VALUE SPACES.
  1228             20  HOLD-CEN-1-X-CCYY.
  1229                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1230                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1231             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1232             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1233         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1234             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1235             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1236             20  HOLD-CEN-1-R-X-CCYY.
  1237                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1238                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1239             20  FILLER                PIC XXX.
  1240         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1241         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1242         16  DC-JULIAN-DATE-1          PIC 9(07).
  1243         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1244             20  DC-JULIAN-1-CCYY.
  1245                 24  DC-JULIAN-1-CC    PIC 99.
  1246                 24  DC-JULIAN-1-YR    PIC 99.
  1247             20  DC-JULIAN-DA-1        PIC 999.
  1248         16  DC-JULIAN-DATE-2          PIC 9(07).
  1249         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1250             20  DC-JULIAN-2-CCYY.
  1251                 24  DC-JULIAN-2-CC    PIC 99.
  1252                 24  DC-JULIAN-2-YR    PIC 99.
  1253             20  DC-JULIAN-DA-2        PIC 999.
  1254         16  DC-GREG-DATE-A-EDIT.
  1255             20  DC-EDITA-MONTH        PIC 99.
  1256             20  SLASHA-1              PIC X VALUE '/'.
  1257             20  DC-EDITA-DAY          PIC 99.
  1258             20  SLASHA-2              PIC X VALUE '/'.
  1259             20  DC-EDITA-CCYY.
  1260                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  25
* EL686.cbl
  1261                 24  DC-EDITA-YEAR     PIC 99.
  1262         16  DC-GREG-DATE-B-EDIT.
  1263             20  DC-EDITB-MONTH        PIC 99.
  1264             20  SLASHB-1              PIC X VALUE '/'.
  1265             20  DC-EDITB-DAY          PIC 99.
  1266             20  SLASHB-2              PIC X VALUE '/'.
  1267             20  DC-EDITB-CCYY.
  1268                 24  DC-EDITB-CENT     PIC 99.
  1269                 24  DC-EDITB-YEAR     PIC 99.
  1270         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1271         16  DC-GREG-DATE-CYMD-R REDEFINES
  1272                              DC-GREG-DATE-CYMD.
  1273             20  DC-CYMD-CEN           PIC 99.
  1274             20  DC-CYMD-YEAR          PIC 99.
  1275             20  DC-CYMD-MONTH         PIC 99.
  1276             20  DC-CYMD-DAY           PIC 99.
  1277         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1278         16  DC-GREG-DATE-MDCY-R REDEFINES
  1279                              DC-GREG-DATE-MDCY.
  1280             20  DC-MDCY-MONTH         PIC 99.
  1281             20  DC-MDCY-DAY           PIC 99.
  1282             20  DC-MDCY-CEN           PIC 99.
  1283             20  DC-MDCY-YEAR          PIC 99.
  1284    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1285        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1286    12  DC-EL310-DATE                  PIC X(21).
  1287    12  FILLER                         PIC X(28).
  1288
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  26
* EL686.cbl
  1290*    COPY ELCLOGOF.
  1291******************************************************************
  1292*                                                                *
  1293*                                                                *
  1294*                            ELCLOGOF.                           *
  1295*                            VMOD=2.001                          *
  1296*                                                                *
  1297*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1298*                                                                *
  1299******************************************************************
  1300 01  CLASIC-LOGOFF.
  1301     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1302     12  LOGOFF-TEXT.
  1303         16  FILLER          PIC X(5)    VALUE SPACES.
  1304         16  LOGOFF-MSG.
  1305             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1306             20  FILLER      PIC X       VALUE SPACES.
  1307             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1308         16  FILLER          PIC X(80)
  1309           VALUE '* YOU ARE NOW LOGGED OFF'.
  1310         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1311         16  FILLER          PIC X       VALUE QUOTE.
  1312         16  LOGOFF-SYS-MSG  PIC X(17)
  1313           VALUE 'S CLAS-IC SYSTEM '.
  1314     12  TEXT-MESSAGES.
  1315         16  UNACCESS-MSG    PIC X(29)
  1316             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1317         16  PGMIDERR-MSG    PIC X(17)
  1318             VALUE 'PROGRAM NOT FOUND'.
  1319
  1320*    COPY ELCATTR.
  1321******************************************************************
  1322*                                                                *
  1323*                            ELCATTR.                            *
  1324*                            VMOD=2.001                          *
  1325*                                                                *
  1326*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1327*                                                                *
  1328*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1329*                                                                *
  1330*                   POS 1   P=PROTECTED                          *
  1331*                           U=UNPROTECTED                        *
  1332*                           S=ASKIP                              *
  1333*                   POS 2   A=ALPHA/NUMERIC                      *
  1334*                           N=NUMERIC                            *
  1335*                   POS 3   N=NORMAL                             *
  1336*                           B=BRIGHT                             *
  1337*                           D=DARK                               *
  1338*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1339*                           OF=MODIFIED DATA TAG OFF             *
  1340*                                                                *
  1341*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1342******************************************************************
  1343 01  ATTRIBUTE-LIST.
  1344     12  AL-PABOF            PIC X       VALUE 'Y'.
  1345     12  AL-PABON            PIC X       VALUE 'Z'.
  1346     12  AL-PADOF            PIC X       VALUE '%'.
  1347     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  27
* EL686.cbl
  1348     12  AL-PANOF            PIC X       VALUE '-'.
  1349     12  AL-PANON            PIC X       VALUE '/'.
  1350     12  AL-SABOF            PIC X       VALUE '8'.
  1351     12  AL-SABON            PIC X       VALUE '9'.
  1352     12  AL-SADOF            PIC X       VALUE '@'.
  1353     12  AL-SADON            PIC X       VALUE QUOTE.
  1354     12  AL-SANOF            PIC X       VALUE '0'.
  1355     12  AL-SANON            PIC X       VALUE '1'.
  1356     12  AL-UABOF            PIC X       VALUE 'H'.
  1357     12  AL-UABON            PIC X       VALUE 'I'.
  1358     12  AL-UADOF            PIC X       VALUE '<'.
  1359     12  AL-UADON            PIC X       VALUE '('.
  1360     12  AL-UANOF            PIC X       VALUE ' '.
  1361     12  AL-UANON            PIC X       VALUE 'A'.
  1362     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1363     12  AL-UNBON            PIC X       VALUE 'R'.
  1364     12  AL-UNDOF            PIC X       VALUE '*'.
  1365     12  AL-UNDON            PIC X       VALUE ')'.
  1366     12  AL-UNNOF            PIC X       VALUE '&'.
  1367     12  AL-UNNON            PIC X       VALUE 'J'.
  1368
  1369*    COPY ELCAID.
  1370******************************************************************
  1371*                                                                *
  1372*                            ELCAID.                             *
  1373*                            VMOD=2.001                          *
  1374*                                                                *
  1375*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1376*                                                                *
  1377*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1378*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1379******************************************************************
  1380
  1381 01  DFHAID.
  1382   02  DFHNULL   PIC  X  VALUE  ' '.
  1383   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1384   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1385   02  DFHPEN    PIC  X  VALUE  '='.
  1386   02  DFHOPID   PIC  X  VALUE  'W'.
  1387   02  DFHPA1    PIC  X  VALUE  '%'.
  1388   02  DFHPA2    PIC  X  VALUE  '>'.
  1389   02  DFHPA3    PIC  X  VALUE  ','.
  1390   02  DFHPF1    PIC  X  VALUE  '1'.
  1391   02  DFHPF2    PIC  X  VALUE  '2'.
  1392   02  DFHPF3    PIC  X  VALUE  '3'.
  1393   02  DFHPF4    PIC  X  VALUE  '4'.
  1394   02  DFHPF5    PIC  X  VALUE  '5'.
  1395   02  DFHPF6    PIC  X  VALUE  '6'.
  1396   02  DFHPF7    PIC  X  VALUE  '7'.
  1397   02  DFHPF8    PIC  X  VALUE  '8'.
  1398   02  DFHPF9    PIC  X  VALUE  '9'.
  1399   02  DFHPF10   PIC  X  VALUE  ':'.
  1400   02  DFHPF11   PIC  X  VALUE  '#'.
  1401   02  DFHPF12   PIC  X  VALUE  '@'.
  1402   02  DFHPF13   PIC  X  VALUE  'A'.
  1403   02  DFHPF14   PIC  X  VALUE  'B'.
  1404   02  DFHPF15   PIC  X  VALUE  'C'.
  1405   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  28
* EL686.cbl
  1406   02  DFHPF17   PIC  X  VALUE  'E'.
  1407   02  DFHPF18   PIC  X  VALUE  'F'.
  1408   02  DFHPF19   PIC  X  VALUE  'G'.
  1409   02  DFHPF20   PIC  X  VALUE  'H'.
  1410   02  DFHPF21   PIC  X  VALUE  'I'.
  1411*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1412   02  DFHPF22   PIC  X  VALUE  '['.
  1413   02  DFHPF23   PIC  X  VALUE  '.'.
  1414   02  DFHPF24   PIC  X  VALUE  '<'.
  1415   02  DFHMSRE   PIC  X  VALUE  'X'.
  1416   02  DFHSTRF   PIC  X  VALUE  'h'.
  1417   02  DFHTRIG   PIC  X  VALUE  '"'.
  1418
  1419 01  FILLER                      REDEFINES
  1420     DFHAID.
  1421
  1422     05  FILLER                      PIC X(8).
  1423
  1424     05  PF-VALUES                   PIC X
  1425         OCCURS 24 TIMES.
  1426
  1427****************************************************************
  1428*
  1429* Copyright (c) 2007 by Clerity Solutions, Inc.
  1430* All rights reserved.
  1431*
  1432****************************************************************
  1433 01  DFHEIV.
  1434   02  DFHEIV0               PIC X(35).
  1435   02  DFHEIV1               PIC X(08).
  1436   02  DFHEIV2               PIC X(08).
  1437   02  DFHEIV3               PIC X(08).
  1438   02  DFHEIV4               PIC X(06).
  1439   02  DFHEIV5               PIC X(04).
  1440   02  DFHEIV6               PIC X(04).
  1441   02  DFHEIV7               PIC X(02).
  1442   02  DFHEIV8               PIC X(02).
  1443   02  DFHEIV9               PIC X(01).
  1444   02  DFHEIV10              PIC S9(7) COMP-3.
  1445   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1446   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1447   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1448   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1449   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1450   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1451   02  DFHEIV17              PIC X(04).
  1452   02  DFHEIV18              PIC X(04).
  1453   02  DFHEIV19              PIC X(04).
  1454   02  DFHEIV20              USAGE IS POINTER.
  1455   02  DFHEIV21              USAGE IS POINTER.
  1456   02  DFHEIV22              USAGE IS POINTER.
  1457   02  DFHEIV23              USAGE IS POINTER.
  1458   02  DFHEIV24              USAGE IS POINTER.
  1459   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1460   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1461   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1462   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1463   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  29
* EL686.cbl
  1464   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1465   02  FILLER                PIC X(02).
  1466   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1467   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1468   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1469   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1470   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1471 LINKAGE  SECTION.
  1472*****************************************************************
  1473*                                                               *
  1474* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1475* All rights reserved.                                          *
  1476*                                                               *
  1477*****************************************************************
  1478 01  dfheiblk.
  1479     02  eibtime          pic s9(7) comp-3.
  1480     02  eibdate          pic s9(7) comp-3.
  1481     02  eibtrnid         pic x(4).
  1482     02  eibtaskn         pic s9(7) comp-3.
  1483     02  eibtrmid         pic x(4).
  1484     02  dfheigdi         pic s9(4) comp.
  1485     02  eibcposn         pic s9(4) comp.
  1486     02  eibcalen         pic s9(4) comp.
  1487     02  eibaid           pic x(1).
  1488     02  eibfiller1       pic x(1).
  1489     02  eibfn            pic x(2).
  1490     02  eibfiller2       pic x(2).
  1491     02  eibrcode         pic x(6).
  1492     02  eibfiller3       pic x(2).
  1493     02  eibds            pic x(8).
  1494     02  eibreqid         pic x(8).
  1495     02  eibrsrce         pic x(8).
  1496     02  eibsync          pic x(1).
  1497     02  eibfree          pic x(1).
  1498     02  eibrecv          pic x(1).
  1499     02  eibsend          pic x(1).
  1500     02  eibatt           pic x(1).
  1501     02  eibeoc           pic x(1).
  1502     02  eibfmh           pic x(1).
  1503     02  eibcompl         pic x(1).
  1504     02  eibsig           pic x(1).
  1505     02  eibconf          pic x(1).
  1506     02  eiberr           pic x(1).
  1507     02  eibrldbk         pic x(1).
  1508     02  eiberrcd         pic x(4).
  1509     02  eibsynrb         pic x(1).
  1510     02  eibnodat         pic x(1).
  1511     02  eibfiller5       pic x(2).
  1512     02  eibresp          pic 9(09) comp.
  1513     02  eibresp2         pic 9(09) comp.
  1514     02  dfheigdj         pic s9(4) comp.
  1515     02  dfheigdk         pic s9(4) comp.
  1516
  1517 01  DFHCOMMAREA                     PIC X(1024).
  1518
  1519*01 PARMLIST                         COMP SYNC.
  1520*    05  FILLER                      PIC S9(9).
  1521*    05  ERCHKQ-POINTER              PIC S9(9).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  30
* EL686.cbl
  1522*    05  ELCNTL-POINTER              PIC S9(9).
  1523*    05  ERPYAJ-POINTER              PIC S9(9).
  1524*    05  ERCHEK-POINTER              PIC S9(9).
  1525*    05  ERCMCK-POINTER              PIC S9(9).
  1526*    05  ERCMKQ-POINTER              PIC S9(9).
  1527
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  31
* EL686.cbl
  1529*    COPY ERCCHKQ.
  1530******************************************************************
  1531*                                                                *
  1532*                                                                *
  1533*                            ERCCHKQ                             *
  1534*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1535*                            VMOD=2.005                          *
  1536*                                                                *
  1537*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  1538*                                                                *
  1539*   FILE TYPE = VSAM,KSDS                                        *
  1540*   RECORD SIZE = 100  RECFORM = FIXED                           *
  1541*                                                                *
  1542*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  1543*       ALTERNATE PATH  = NONE                                   *
  1544*                                                                *
  1545*   LOG = YES                                                    *
  1546*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1547******************************************************************
  1548 01  CHECK-QUE.
  1549     12  CQ-RECORD-ID                PIC XX.
  1550         88  VALID-CQ-ID                     VALUE 'CQ'.
  1551
  1552     12  CQ-CONTROL-PRIMARY.
  1553         16  CQ-COMPANY-CD           PIC X.
  1554         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  1555         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  1556
  1557     12  CQ-ENTRY-TYPE               PIC X.
  1558             88  CHECK-ON-QUE           VALUE 'Q'.
  1559             88  ALIGNMENT-CHECK        VALUE 'A'.
  1560             88  MANUAL-CHECK           VALUE 'M'.
  1561             88  SPOILED-CHECK          VALUE 'S'.
  1562             88  VOIDED-CHECK           VALUE 'V'.
  1563             88  PAYMENT-ABORTED        VALUE 'X'.
  1564
  1565     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  1566
  1567     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  1568         CQ-CREDIT-MASTER-CNTL.
  1569         16  CQ-PYAJ-CARRIER         PIC X.
  1570         16  CQ-PYAJ-GROUPING        PIC X(6).
  1571         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  1572         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  1573         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  1574         16  CQ-PYAJ-REC-TYPE        PIC X.
  1575         16  FILLER                  PIC X(18).
  1576
  1577     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  1578         CQ-CREDIT-MASTER-CNTL.
  1579         16  CQ-CHEK-CARRIER         PIC X.
  1580         16  CQ-CHEK-GROUPING        PIC X(6).
  1581         16  CQ-CHEK-STATE           PIC XX.
  1582         16  CQ-CHEK-ACCOUNT         PIC X(10).
  1583         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  1584         16  CQ-CHEK-CERT-NO.
  1585             20  CQ-CHEK-CERT-PRIME  PIC X(10).
  1586             20  CQ-CHEK-CERT-SFX    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  32
* EL686.cbl
  1587         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  1588         16  CQ-CHEK-FIN-RESP        PIC X(10).
  1589         16  FILLER                  PIC X(06).
  1590
  1591     12  CQ-CHECK-NUMBER             PIC X(7).
  1592     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  1593     12  CQ-PAYMENT-TYPE             PIC X.
  1594             88  CQ-BILLING-CREDIT         VALUE '1'.
  1595             88  CQ-REFUND-PMT             VALUE '2'.
  1596             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  1597     12  CQ-VOID-INDICATOR           PIC X.
  1598             88  CHECK-IS-VOID             VALUE 'V'.
  1599     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  1600     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  1601     12  CQ-CHECK-BY-USER            PIC X(4).
  1602     12  CQ-PRE-NUMBERING-SW         PIC X.
  1603       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  1604       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  1605
  1606     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  1607     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  1608     12  CQ-ACCOUNT-AGENT            PIC X(10).
  1609     12  CQ-CHECK-VOIDED-DT          PIC XX.
  1610
  1611     12  CQ-LETTERS-IND              PIC X.
  1612         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  1613
  1614******************************************************************
  1615
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  33
* EL686.cbl
  1617*    COPY ELCCNTL.
  1618******************************************************************
  1619*                                                                *
  1620*                                                                *
  1621*                            ELCCNTL.                            *
  1622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1623*                            VMOD=2.059                          *
  1624*                                                                *
  1625*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1626*                                                                *
  1627*   FILE TYPE = VSAM,KSDS                                        *
  1628*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1629*                                                                *
  1630*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1631*       ALTERNATE INDEX = NONE                                   *
  1632*                                                                *
  1633*   LOG = YES                                                    *
  1634*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1635******************************************************************
  1636*                   C H A N G E   L O G
  1637*
  1638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1639*-----------------------------------------------------------------
  1640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1641* EFFECTIVE    NUMBER
  1642*-----------------------------------------------------------------
  1643* 082503                   PEMA  ADD BENEFIT GROUP
  1644* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1645* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1646* 092705    2005050300006  PEMA  ADD SPP LEASES
  1647* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1648* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1649* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1650* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1651******************************************************************
  1652*
  1653 01  CONTROL-FILE.
  1654     12  CF-RECORD-ID                       PIC XX.
  1655         88  VALID-CF-ID                        VALUE 'CF'.
  1656
  1657     12  CF-CONTROL-PRIMARY.
  1658         16  CF-COMPANY-ID                  PIC XXX.
  1659         16  CF-RECORD-TYPE                 PIC X.
  1660             88  CF-COMPANY-MASTER              VALUE '1'.
  1661             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1662             88  CF-STATE-MASTER                VALUE '3'.
  1663             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1664             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1665             88  CF-CARRIER-MASTER              VALUE '6'.
  1666             88  CF-MORTALITY-MASTER            VALUE '7'.
  1667             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1668             88  CF-TERMINAL-MASTER             VALUE '9'.
  1669             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1670             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1671             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1672             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1673             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1674             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  34
* EL686.cbl
  1675             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1676             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1677             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1678         16  CF-ACCESS-CD-GENL              PIC X(4).
  1679         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1680             20  CF-PROCESSOR               PIC X(4).
  1681         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1682             20  CF-STATE-CODE              PIC XX.
  1683             20  FILLER                     PIC XX.
  1684         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1685             20  FILLER                     PIC XX.
  1686             20  CF-HI-BEN-IN-REC           PIC XX.
  1687         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1688             20  FILLER                     PIC XXX.
  1689             20  CF-CARRIER-CNTL            PIC X.
  1690         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1691             20  FILLER                     PIC XX.
  1692             20  CF-HI-TYPE-IN-REC          PIC 99.
  1693         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1694             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1695                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1696             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1697             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1698         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1699             20  FILLER                     PIC X.
  1700             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1701         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1702             20  FILLER                     PIC XX.
  1703             20  CF-MORTGAGE-PLAN           PIC XX.
  1704         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1705
  1706     12  CF-LAST-MAINT-DT                   PIC XX.
  1707     12  CF-LAST-MAINT-BY                   PIC X(4).
  1708     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1709
  1710     12  CF-RECORD-BODY                     PIC X(728).
  1711
  1712
  1713****************************************************************
  1714*             COMPANY MASTER RECORD                            *
  1715****************************************************************
  1716
  1717     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1718         16  CF-COMPANY-ADDRESS.
  1719             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1720             20  CF-CL-IN-CARE-OF           PIC X(30).
  1721             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1722             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1723             20  CF-CL-CITY-STATE           PIC X(30).
  1724             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1725             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1726         16  CF-COMPANY-CD                  PIC X.
  1727         16  CF-COMPANY-PASSWORD            PIC X(8).
  1728         16  CF-SECURITY-OPTION             PIC X.
  1729             88  ALL-SECURITY                   VALUE '1'.
  1730             88  COMPANY-VERIFY                 VALUE '2'.
  1731             88  PROCESSOR-VERIFY               VALUE '3'.
  1732             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  35
* EL686.cbl
  1733             88  ALL-BUT-TERM                   VALUE '5'.
  1734         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1735             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1736         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1737             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1738         16  CF-INFORCE-LOCATION            PIC X.
  1739             88  CERTS-ARE-ONLINE               VALUE '1'.
  1740             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1741             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1742         16  CF-LOWER-CASE-LETTERS          PIC X.
  1743         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1744             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1745             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1746             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1747             88  CF-ACCNT-CNTL                  VALUE '3'.
  1748             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1749
  1750         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1751         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1752
  1753         16  CF-LGX-CREDIT-USER             PIC X.
  1754             88  CO-IS-NOT-USER                 VALUE 'N'.
  1755             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1756
  1757         16 CF-CREDIT-CALC-CODES.
  1758             20  CF-CR-REM-TERM-CALC PIC X.
  1759               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1760               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1761               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1762               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1763               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1764               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1765               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1766             20  CF-CR-R78-METHOD           PIC X.
  1767               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1768               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1769
  1770         16  CF-CLAIM-CONTROL-COUNTS.
  1771             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1772                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1773
  1774             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1775                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1776
  1777             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1778                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1779
  1780             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1781                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1782
  1783         16  CF-CURRENT-MONTH-END           PIC XX.
  1784
  1785         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1786             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1787             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1788             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1789             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1790                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  36
* EL686.cbl
  1791                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1792             20  CF-CO-PREM-REJECT-SW       PIC X.
  1793                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1794                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1795             20  CF-CO-REF-REJECT-SW        PIC X.
  1796                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1797                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1798
  1799         16  CF-CO-REPORTING-DT             PIC XX.
  1800         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1801         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1802           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1803           88  CF-CO-MONTH-END                  VALUE '1'.
  1804
  1805         16  CF-LGX-CLAIM-USER              PIC X.
  1806             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1807             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1808
  1809         16  CF-CREDIT-EDIT-CONTROLS.
  1810             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1811             20  CF-MIN-AGE                 PIC 99.
  1812             20  CF-DEFAULT-AGE             PIC 99.
  1813             20  CF-MIN-TERM                PIC S999      COMP-3.
  1814             20  CF-MAX-TERM                PIC S999      COMP-3.
  1815             20  CF-DEFAULT-SEX             PIC X.
  1816             20  CF-JOINT-AGE-INPUT         PIC X.
  1817                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1818             20  CF-BIRTH-DATE-INPUT        PIC X.
  1819                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1820             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1821                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1822                 88  CF-ZERO-CARRIER            VALUE '1'.
  1823                 88  CF-ZERO-GROUPING           VALUE '2'.
  1824                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1825             20  CF-EDIT-SW                 PIC X.
  1826                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1827             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1828             20  CF-CR-PR-METHOD            PIC X.
  1829               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1830               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1831             20  FILLER                     PIC X.
  1832
  1833         16  CF-CREDIT-MISC-CONTROLS.
  1834             20  CF-REIN-TABLE-SW           PIC X.
  1835                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1836             20  CF-COMP-TABLE-SW           PIC X.
  1837                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1838             20  CF-EXPERIENCE-RETENTION-AGE
  1839                                            PIC S9        COMP-3.
  1840             20  CF-CONVERSION-DT           PIC XX.
  1841             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1842             20  CF-RUN-FREQUENCY-SW        PIC X.
  1843                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1844                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1845
  1846             20  CF-CR-CHECK-NO-CONTROL.
  1847                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1848                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  37
* EL686.cbl
  1849                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1850                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1851                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1852                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1853
  1854                 24  CF-CR-CHECK-COUNT       REDEFINES
  1855                     CF-CR-CHECK-COUNTER      PIC X(4).
  1856
  1857                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1858                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1859
  1860                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1861                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1862                 24  CF-MAIL-PROCESSING       PIC X.
  1863                     88  MAIL-PROCESSING          VALUE 'Y'.
  1864
  1865         16  CF-MISC-SYSTEM-CONTROL.
  1866             20  CF-SYSTEM-C                 PIC X.
  1867                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1868             20  CF-SYSTEM-D                 PIC X.
  1869                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1870             20  CF-SOC-SEC-NO-SW            PIC X.
  1871                 88  SOC-SEC-NO-USED             VALUE '1'.
  1872             20  CF-MEMBER-NO-SW             PIC X.
  1873                 88  MEMBER-NO-USED              VALUE '1'.
  1874             20  CF-TAX-ID-NUMBER            PIC X(11).
  1875             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1876             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1877                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1878                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1879                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1880                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1881             20  CF-SYSTEM-E                 PIC X.
  1882                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1883
  1884         16  CF-LGX-LIFE-USER               PIC X.
  1885             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1886             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1887
  1888         16  CF-CR-MONTH-END-DT             PIC XX.
  1889
  1890         16  CF-FILE-MAINT-DATES.
  1891             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1892                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1893             20  CF-LAST-BATCH       REDEFINES
  1894                 CF-LAST-BATCH-NO               PIC X(4).
  1895             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1896             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1897             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1898             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1899             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1900             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1901             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1902             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1903             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1904             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1905
  1906         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  38
* EL686.cbl
  1907         16  FILLER                         PIC X.
  1908
  1909         16  CF-ALT-MORT-CODE               PIC X(4).
  1910         16  CF-MEMBER-CAPTION              PIC X(10).
  1911
  1912         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1913             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1914             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1915             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1916             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1917             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1918
  1919         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1920
  1921         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1922         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1923         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1924         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1925
  1926         16  CF-AH-OVERRIDE-L1              PIC X.
  1927         16  CF-AH-OVERRIDE-L2              PIC XX.
  1928         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1929         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1930
  1931         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1932         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1933
  1934         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1935         16  CF-AR-LAST-EL860-DT            PIC XX.
  1936         16  CF-MP-MONTH-END-DT             PIC XX.
  1937
  1938         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1939         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1940             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1941
  1942         16  CF-AR-MONTH-END-DT             PIC XX.
  1943
  1944         16  CF-CRDTCRD-USER                PIC X.
  1945             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1946             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1947
  1948         16  CF-CC-MONTH-END-DT             PIC XX.
  1949
  1950         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1951
  1952         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1953             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1954             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1955             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1956         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1957         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1958         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1959         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1960             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1961             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1962         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1963         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1964         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  39
* EL686.cbl
  1965             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1966         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1967
  1968         16  CF-CL-ZIP-CODE.
  1969             20  CF-CL-ZIP-PRIME.
  1970                 24  CF-CL-ZIP-1ST          PIC X.
  1971                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1972                 24  FILLER                 PIC X(4).
  1973             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1974         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1975             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1976             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1977             20  FILLER                     PIC XXX.
  1978
  1979         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1980         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1981         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1982         16  CF-CO-OPTION-START-DATE        PIC XX.
  1983         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1984           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1985                                                      '3' '4'.
  1986           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1987           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1988           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1989           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1990           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1991           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1992
  1993         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1994
  1995         16  CF-PAYMENT-APPROVAL-LEVELS.
  1996             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1997             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1998             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1999             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2000             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2001             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2002
  2003         16  CF-END-USER-REPORTING-USER     PIC X.
  2004             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2005             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2006
  2007         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2008             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2009             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2010
  2011         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2012
  2013         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2014         16  FILLER                         PIC X.
  2015
  2016         16  CF-CREDIT-ARCHIVE-CNTL.
  2017             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2018             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2019             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2020
  2021         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2022
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  40
* EL686.cbl
  2023         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2024             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2025             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2026
  2027         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2028             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2029             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2030
  2031         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2032
  2033         16  CF-CO-ACH-ID-CODE              PIC  X.
  2034             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2035             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2036             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2037         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2038         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2039         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2040         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2041         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2042         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2043         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2044         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2045         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2046                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2047         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2048                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2049
  2050         16  CF-CO-OVER-SHORT.
  2051             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2052             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2053
  2054*         16  FILLER                         PIC X(102).
  2055         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2056             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2057             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2058
  2059         16  CF-AH-APPROVAL-DAYS.
  2060             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2061             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2062             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2063             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2064
  2065         16  FILLER                         PIC X(82).
  2066****************************************************************
  2067*             PROCESSOR/USER RECORD                            *
  2068****************************************************************
  2069
  2070     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2071         16  CF-PROCESSOR-NAME              PIC X(30).
  2072         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2073         16  CF-PROCESSOR-TITLE             PIC X(26).
  2074         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2075                 88  MESSAGE-YES                VALUE 'Y'.
  2076                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2077
  2078*****************************************************
  2079****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2080****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  41
* EL686.cbl
  2081****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2082****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2083*****************************************************
  2084
  2085         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2086             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2087             20  CF-APPLICATION-FORCE       PIC X.
  2088             20  CF-INDIVIDUAL-APP.
  2089                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2090                     28  CF-BROWSE-APP      PIC X.
  2091                     28  CF-UPDATE-APP      PIC X.
  2092
  2093         16  CF-CURRENT-TERM-ON             PIC X(4).
  2094         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2095             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2096             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2097             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2098             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2099             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2100             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2101             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2102         16  CF-PROCESSOR-CARRIER           PIC X.
  2103             88  NO-CARRIER-SECURITY            VALUE ' '.
  2104         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2105             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2106         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2107             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2108         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2109             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2110
  2111         16  CF-PROC-SYS-ACCESS-SW.
  2112             20  CF-PROC-CREDIT-CLAIMS-SW.
  2113                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2114                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2115                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2116                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2117             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2118                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2119                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2120             20  CF-PROC-LIFE-GNRLDGR-SW.
  2121                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2122                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2123                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2124                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2125             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2126                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2127                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2128         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2129             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2130             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2131         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2132
  2133         16  CF-APPROVAL-LEVEL                  PIC X.
  2134             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2135             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2136             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2137             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2138
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  42
* EL686.cbl
  2139         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2140
  2141         16  CF-LANGUAGE-TYPE                   PIC X.
  2142             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2143             88  CF-LANG-IS-FR                      VALUE 'F'.
  2144         16  FILLER                             PIC  X(240).
  2145
  2146****************************************************************
  2147*             PROCESSOR/REMINDERS RECORD                       *
  2148****************************************************************
  2149
  2150     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2151         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2152             20  CF-START-REMIND-DT         PIC XX.
  2153             20  CF-END-REMIND-DT           PIC XX.
  2154             20  CF-REMINDER-TEXT           PIC X(50).
  2155         16  FILLER                         PIC X(296).
  2156
  2157
  2158****************************************************************
  2159*             STATE MASTER RECORD                              *
  2160****************************************************************
  2161
  2162     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2163         16  CF-STATE-ABBREVIATION          PIC XX.
  2164         16  CF-STATE-NAME                  PIC X(25).
  2165         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2166         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2167             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2168             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2169             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2170             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2171                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2172                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2173             20  CF-ST-PREM-REJECT-SW       PIC X.
  2174                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2175                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2176             20  CF-ST-REF-REJECT-SW        PIC X.
  2177                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2178                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2179         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2180         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2181         16  CF-ST-REFUND-RULES.
  2182             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2183             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2184             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2185         16  CF-ST-FST-PMT-EXTENSION.
  2186             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2187             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2188                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2189                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2190                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2191                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2192         16  CF-ST-STATE-CALL.
  2193             20  CF-ST-CALL-UNEARNED        PIC X.
  2194             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2195             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2196         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  43
* EL686.cbl
  2197             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2198             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2199         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2200         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2201         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2202         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2203         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2204         16  FILLER                         PIC X.
  2205         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2206             20  CF-ST-BENEFIT-CD           PIC XX.
  2207             20  CF-ST-BENEFIT-KIND         PIC X.
  2208                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2209                 88  CF-ST-AH-KIND              VALUE 'A'.
  2210             20  CF-ST-REM-TERM-CALC        PIC X.
  2211                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2212                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2213                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2214                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2215                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2216                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2217                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2218                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2219
  2220             20  CF-ST-REFUND-CALC          PIC X.
  2221                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2222                 88  ST-REFD-BY-R78             VALUE '1'.
  2223                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2224                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2225                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2226                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2227                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2228                 88  ST-REFD-UTAH               VALUE '7'.
  2229                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2230                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2231                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2232
  2233             20  CF-ST-EARNING-CALC         PIC X.
  2234                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2235                 88  ST-EARN-BY-R78             VALUE '1'.
  2236                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2237                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2238                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2239                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2240                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2241                 88  ST-EARN-MEAN               VALUE '8'.
  2242                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2243
  2244             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2245                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2246                 88  ST-OVRD-BY-R78             VALUE '1'.
  2247                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2248                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2249                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2250                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2251                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2252                 88  ST-OVRD-MEAN               VALUE '8'.
  2253                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2254             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  44
* EL686.cbl
  2255
  2256         16  CF-ST-COMMISSION-CAPS.
  2257             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2258             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2259             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2260             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2261         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2262                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2263
  2264         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2265
  2266         16  CF-ST-STATUTORY-INTEREST.
  2267             20  CF-ST-STAT-DATE-FROM       PIC X.
  2268                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2269                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2270             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2271             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2272             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2273             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2274             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2275
  2276         16  CF-ST-OVER-SHORT.
  2277             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2278             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2279
  2280         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2281
  2282         16  CF-ST-RT-CALC                  PIC X.
  2283
  2284         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2285         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2286         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2287         16  CF-ST-RF-LR-CALC               PIC X.
  2288         16  CF-ST-RF-LL-CALC               PIC X.
  2289         16  CF-ST-RF-LN-CALC               PIC X.
  2290         16  CF-ST-RF-AH-CALC               PIC X.
  2291         16  CF-ST-RF-CP-CALC               PIC X.
  2292*        16  FILLER                         PIC X(206).
  2293*CIDMOD         16  FILLER                         PIC X(192).
  2294         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2295             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2296         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2297         16  FILLER                         PIC X(187).
  2298
  2299****************************************************************
  2300*             BENEFIT MASTER RECORD                            *
  2301****************************************************************
  2302
  2303     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2304         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2305             20  CF-BENEFIT-CODE            PIC XX.
  2306             20  CF-BENEFIT-NUMERIC  REDEFINES
  2307                 CF-BENEFIT-CODE            PIC XX.
  2308             20  CF-BENEFIT-ALPHA           PIC XXX.
  2309             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2310             20  CF-BENEFIT-COMMENT         PIC X(10).
  2311
  2312             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  45
* EL686.cbl
  2313                 88  CF-REDUCING                VALUE 'R'.
  2314                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2315
  2316             20  CF-SPECIAL-CALC-CD         PIC X.
  2317                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2318                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2319                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2320                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2321                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2322                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2323                 88  CF-FARM-PLAN               VALUE 'F'.
  2324                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2325                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2326                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2327                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2328                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2329                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2330                 88  CF-PRUDENTIAL              VALUE 'P'.
  2331                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2332                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2333                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2334                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2335                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2336                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2337
  2338             20  CF-JOINT-INDICATOR         PIC X.
  2339                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2340
  2341*            20  FILLER                     PIC X(12).
  2342             20  FILLER                     PIC X(11).
  2343             20  CF-BENEFIT-CATEGORY        PIC X.
  2344             20  CF-LOAN-TYPE               PIC X(8).
  2345
  2346             20  CF-CO-REM-TERM-CALC        PIC X.
  2347                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2348                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2349                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2350                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2351                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2352
  2353             20  CF-CO-EARNINGS-CALC        PIC X.
  2354                 88  CO-EARN-BY-R78             VALUE '1'.
  2355                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2356                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2357                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2358                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2359                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2360                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2361                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2362
  2363             20  CF-CO-REFUND-CALC          PIC X.
  2364                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2365                 88  CO-REFD-BY-R78             VALUE '1'.
  2366                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2367                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2368                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2369                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2370                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  46
* EL686.cbl
  2371                 88  CO-REFD-MEAN               VALUE '8'.
  2372                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2373                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2374                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2375
  2376             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2377                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2378                 88  CO-OVRD-BY-R78             VALUE '1'.
  2379                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2380                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2381                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2382                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2383                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2384                 88  CO-OVRD-MEAN               VALUE '8'.
  2385                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2386
  2387             20  CF-CO-BEN-I-G-CD           PIC X.
  2388                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2389                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2390                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2391
  2392         16  FILLER                         PIC X(304).
  2393
  2394
  2395****************************************************************
  2396*             CARRIER MASTER RECORD                            *
  2397****************************************************************
  2398
  2399     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2400         16  CF-ADDRESS-DATA.
  2401             20  CF-MAIL-TO-NAME            PIC X(30).
  2402             20  CF-IN-CARE-OF              PIC X(30).
  2403             20  CF-ADDRESS-LINE-1          PIC X(30).
  2404             20  CF-ADDRESS-LINE-2          PIC X(30).
  2405             20  CF-CITY-STATE              PIC X(30).
  2406             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2407             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2408
  2409         16  CF-CLAIM-NO-CONTROL.
  2410             20  CF-CLAIM-NO-METHOD         PIC X.
  2411                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2412                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2413                 88  CLAIM-NO-SEQ               VALUE '3'.
  2414                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2415             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2416                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2417                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2418                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2419
  2420         16  CF-CHECK-NO-CONTROL.
  2421             20  CF-CHECK-NO-METHOD         PIC X.
  2422                 88  CHECK-NO-MANUAL            VALUE '1'.
  2423                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2424                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2425                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2426             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2427                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2428
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  47
* EL686.cbl
  2429         16  CF-DOMICILE-STATE              PIC XX.
  2430
  2431         16  CF-EXPENSE-CONTROLS.
  2432             20  CF-EXPENSE-METHOD          PIC X.
  2433                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2434                 88  DOLLARS-PER-PMT            VALUE '2'.
  2435                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2436                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2437             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2438             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2439
  2440         16  CF-CORRESPONDENCE-CONTROL.
  2441             20  CF-LETTER-RESEND-OPT       PIC X.
  2442                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2443                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2444             20  FILLER                     PIC X(4).
  2445
  2446         16  CF-RESERVE-CONTROLS.
  2447             20  CF-MANUAL-SW               PIC X.
  2448                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2449             20  CF-FUTURE-SW               PIC X.
  2450                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2451             20  CF-PTC-SW                  PIC X.
  2452                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2453             20  CF-IBNR-SW                 PIC X.
  2454                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2455             20  CF-PTC-LF-SW               PIC X.
  2456                 88  CF-LF-PTC-USED             VALUE '1'.
  2457             20  CF-CDT-ACCESS-METHOD       PIC X.
  2458                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2459                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2460                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2461             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2462
  2463         16  CF-CLAIM-CALC-METHOD           PIC X.
  2464             88  360-PLUS-MONTHS                VALUE '1'.
  2465             88  365-PLUS-MONTHS                VALUE '2'.
  2466             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2467             88  360-DAILY                      VALUE '4'.
  2468             88  365-DAILY                      VALUE '5'.
  2469
  2470         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2471         16  FILLER                         PIC X(11).
  2472
  2473         16  CF-LIMIT-AMOUNTS.
  2474             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2475             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2476             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2477             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2478             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2479             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2480             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2481             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2482             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2483             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2484
  2485         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2486         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  48
* EL686.cbl
  2487         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2488
  2489         16  CF-ZIP-CODE.
  2490             20  CF-ZIP-PRIME.
  2491                 24  CF-ZIP-1ST             PIC X.
  2492                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2493                 24  FILLER                 PIC X(4).
  2494             20  CF-ZIP-PLUS4               PIC X(4).
  2495         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2496             20  CF-CAN-POSTAL-1            PIC XXX.
  2497             20  CF-CAN-POSTAL-2            PIC XXX.
  2498             20  FILLER                     PIC XXX.
  2499
  2500         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2501         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2502         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2503
  2504         16  CF-RATING-SWITCH               PIC X.
  2505             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2506             88  CF-NO-RATING                   VALUE 'N'.
  2507
  2508         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2509
  2510         16  CF-CARRIER-OVER-SHORT.
  2511             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2512             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2513
  2514         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2515         16  CF-SECPAY-SWITCH               PIC X.
  2516             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2517             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2518         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2519         16  FILLER                         PIC X(448).
  2520*        16  FILLER                         PIC X(452).
  2521
  2522
  2523****************************************************************
  2524*             MORTALITY MASTER RECORD                          *
  2525****************************************************************
  2526
  2527     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2528         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2529                                INDEXED BY CF-MORT-NDX.
  2530             20  CF-MORT-TABLE              PIC X(5).
  2531             20  CF-MORT-TABLE-TYPE         PIC X.
  2532                 88  CF-MORT-JOINT              VALUE 'J'.
  2533                 88  CF-MORT-SINGLE             VALUE 'S'.
  2534                 88  CF-MORT-COMBINED           VALUE 'C'.
  2535                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2536                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2537             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2538             20  CF-MORT-AGE-METHOD         PIC XX.
  2539                 88  CF-AGE-LAST                VALUE 'AL'.
  2540                 88  CF-AGE-NEAR                VALUE 'AN'.
  2541             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2542             20  CF-MORT-ADJUSTMENT-DIRECTION
  2543                                            PIC X.
  2544                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  49
* EL686.cbl
  2545                 88  CF-PLUS                    VALUE '+'.
  2546             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2547             20  CF-MORT-JOINT-CODE         PIC X.
  2548                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2549             20  CF-MORT-PC-Q               PIC X.
  2550                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2551             20  CF-MORT-TABLE-CODE         PIC X(4).
  2552             20  CF-MORT-COMMENTS           PIC X(15).
  2553             20  FILLER                     PIC X(14).
  2554
  2555         16  FILLER                         PIC X(251).
  2556
  2557
  2558****************************************************************
  2559*             BUSSINESS TYPE MASTER RECORD                     *
  2560****************************************************************
  2561
  2562     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2563* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2564* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2565* AND RECORD 05 IS TYPES 81-99
  2566         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2567             20  CF-BUSINESS-TITLE          PIC  X(19).
  2568             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2569                                            PIC S9V9(4) COMP-3.
  2570             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2571             20  FILLER                     PIC  X.
  2572         16  FILLER                         PIC  X(248).
  2573
  2574
  2575****************************************************************
  2576*             TERMINAL MASTER RECORD                           *
  2577****************************************************************
  2578
  2579     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2580
  2581         16  CF-COMPANY-TERMINALS.
  2582             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2583                                  PIC X(4).
  2584         16  FILLER               PIC X(248).
  2585
  2586
  2587****************************************************************
  2588*             LIFE EDIT MASTER RECORD                          *
  2589****************************************************************
  2590
  2591     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2592         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2593             20  CF-LIFE-CODE-IN            PIC XX.
  2594             20  CF-LIFE-CODE-OUT           PIC XX.
  2595         16  FILLER                         PIC X(248).
  2596
  2597
  2598****************************************************************
  2599*             AH EDIT MASTER RECORD                            *
  2600****************************************************************
  2601
  2602     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  50
* EL686.cbl
  2603         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2604             20  CF-AH-CODE-IN              PIC XXX.
  2605             20  CF-AH-CODE-OUT             PIC XX.
  2606         16  FILLER                         PIC X(248).
  2607
  2608
  2609****************************************************************
  2610*             CREDIBILITY TABLES                               *
  2611****************************************************************
  2612
  2613     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2614         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2615                             INDEXED BY CF-CRDB-NDX.
  2616             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2617             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2618             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2619         16  FILLER                         PIC  X(332).
  2620
  2621
  2622****************************************************************
  2623*             REPORT CUSTOMIZATION RECORD                      *
  2624****************************************************************
  2625
  2626     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2627         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2628             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2629             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2630             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2631**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2632****       A T-TRANSFER.                                   ****
  2633             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2634
  2635         16  FILLER                         PIC XX.
  2636
  2637         16  CF-CARRIER-CNTL-OPT.
  2638             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2639                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2640                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2641             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2642                                            PIC X.
  2643         16  CF-GROUP-CNTL-OPT.
  2644             20  CF-GROUP-OPT-SEQ           PIC 9.
  2645                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2646                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2647             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2648                                            PIC X(6).
  2649         16  CF-STATE-CNTL-OPT.
  2650             20  CF-STATE-OPT-SEQ           PIC 9.
  2651                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2652                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2653             20  CF-STATE-SELECT OCCURS 3 TIMES
  2654                                            PIC XX.
  2655         16  CF-ACCOUNT-CNTL-OPT.
  2656             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2657                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2658                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2659             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2660                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  51
* EL686.cbl
  2661         16  CF-BUS-TYP-CNTL-OPT.
  2662             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2663                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2664                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2665             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2666                                            PIC XX.
  2667         16  CF-LF-TYP-CNTL-OPT.
  2668             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2669                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2670                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2671             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2672                                            PIC XX.
  2673         16  CF-AH-TYP-CNTL-OPT.
  2674             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2675                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2676                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2677             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2678                                            PIC XX.
  2679         16  CF-REPTCD1-CNTL-OPT.
  2680             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2681                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2682                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2683             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2684                                            PIC X(10).
  2685         16  CF-REPTCD2-CNTL-OPT.
  2686             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2687                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2688                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2689             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2690                                            PIC X(10).
  2691         16  CF-USER1-CNTL-OPT.
  2692             20  CF-USER1-OPT-SEQ           PIC 9.
  2693                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2694                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2695             20  CF-USER1-SELECT OCCURS 3 TIMES
  2696                                            PIC X(10).
  2697         16  CF-USER2-CNTL-OPT.
  2698             20  CF-USER2-OPT-SEQ           PIC 9.
  2699                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2700                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2701             20  CF-USER2-SELECT OCCURS 3 TIMES
  2702                                            PIC X(10).
  2703         16  CF-USER3-CNTL-OPT.
  2704             20  CF-USER3-OPT-SEQ           PIC 9.
  2705                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2706                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2707             20  CF-USER3-SELECT OCCURS 3 TIMES
  2708                                            PIC X(10).
  2709         16  CF-USER4-CNTL-OPT.
  2710             20  CF-USER4-OPT-SEQ           PIC 9.
  2711                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2712                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2713             20  CF-USER4-SELECT OCCURS 3 TIMES
  2714                                            PIC X(10).
  2715         16  CF-USER5-CNTL-OPT.
  2716             20  CF-USER5-OPT-SEQ           PIC 9.
  2717                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2718                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  52
* EL686.cbl
  2719             20  CF-USER5-SELECT OCCURS 3 TIMES
  2720                                            PIC X(10).
  2721         16  CF-REINS-CNTL-OPT.
  2722             20  CF-REINS-OPT-SEQ           PIC 9.
  2723                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2724                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2725             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2726                 24  CF-REINS-PRIME         PIC XXX.
  2727                 24  CF-REINS-SUB           PIC XXX.
  2728
  2729         16  CF-AGENT-CNTL-OPT.
  2730             20  CF-AGENT-OPT-SEQ           PIC 9.
  2731                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2732                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2733             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2734                                            PIC X(10).
  2735
  2736         16  FILLER                         PIC X(43).
  2737
  2738         16  CF-LOSS-RATIO-SELECT.
  2739             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2740             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2741         16  CF-ENTRY-DATE-SELECT.
  2742             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2743             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2744         16  CF-EFFECTIVE-DATE-SELECT.
  2745             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2746             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2747
  2748         16  CF-EXCEPTION-LIST-IND          PIC X.
  2749             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2750
  2751         16  FILLER                         PIC X(318).
  2752
  2753****************************************************************
  2754*                  EXCEPTION REPORTING RECORD                  *
  2755****************************************************************
  2756
  2757     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2758         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2759             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2760
  2761         16  CF-COMBINED-LIFE-AH-OPT.
  2762             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2763             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2764             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2765             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2766
  2767         16  CF-LIFE-OPT.
  2768             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2769             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2770             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2771             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2772             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2773             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2774             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2775             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2776             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  53
* EL686.cbl
  2777             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2778
  2779         16  CF-AH-OPT.
  2780             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2781             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2782             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2783             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2784             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2785             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2786             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2787             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2788             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2789             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2790
  2791         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2792             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2793             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2794             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2795
  2796         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2797
  2798         16  FILLER                         PIC X(673).
  2799
  2800
  2801****************************************************************
  2802*             MORTGAGE SYSTEM PLAN RECORD                      *
  2803****************************************************************
  2804
  2805     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2806         16  CF-PLAN-TYPE                   PIC X.
  2807             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2808             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2809             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2810         16  CF-PLAN-ABBREV                 PIC XXX.
  2811         16  CF-PLAN-DESCRIPT               PIC X(10).
  2812         16  CF-PLAN-NOTES                  PIC X(20).
  2813         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2814         16  CF-PLAN-UNDERWRITING.
  2815             20  CF-PLAN-TERM-DATA.
  2816                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2817                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2818             20  CF-PLAN-AGE-DATA.
  2819                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2820                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2821                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2822             20  CF-PLAN-BENEFIT-DATA.
  2823                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2824                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2825                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2826                                            PIC S9(7)V99  COMP-3.
  2827         16  CF-PLAN-POLICY-FORMS.
  2828             20  CF-POLICY-FORM             PIC X(12).
  2829             20  CF-MASTER-APPLICATION      PIC X(12).
  2830             20  CF-MASTER-POLICY           PIC X(12).
  2831         16  CF-PLAN-RATING.
  2832             20  CF-RATE-CODE               PIC X(5).
  2833             20  CF-SEX-RATING              PIC X.
  2834                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  54
* EL686.cbl
  2835                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2836             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2837             20  CF-SUB-STD-TYPE            PIC X.
  2838                 88  CF-PCT-OF-PREM            VALUE '1'.
  2839                 88  CF-PCT-OF-BENE            VALUE '2'.
  2840         16  CF-PLAN-PREM-TOLERANCES.
  2841             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2842             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2843         16  CF-PLAN-PYMT-TOLERANCES.
  2844             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2845             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2846         16  CF-PLAN-MISC-DATA.
  2847             20  FILLER                     PIC X.
  2848             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2849             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2850         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2851         16  CF-PLAN-IND-GRP                PIC X.
  2852             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2853                                                     '1'.
  2854             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2855                                                     '2'.
  2856         16  CF-MIB-SEARCH-SW               PIC X.
  2857             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2858             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2859             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2860             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2861         16  CF-ALPHA-SEARCH-SW             PIC X.
  2862             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2863             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2864             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2865             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2866             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2867             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2868             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2869             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2870             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2871             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2872                                                     'A' 'B' 'C'
  2873                                                     'X' 'Y' 'Z'.
  2874         16  CF-EFF-DT-RULE-SW              PIC X.
  2875             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2876             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2877             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2878             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2879             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2880         16  FILLER                         PIC X(4).
  2881         16  CF-HEALTH-QUESTIONS            PIC X.
  2882             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2883         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2884         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2885         16  CF-PLAN-SNGL-JNT               PIC X.
  2886             88  CF-COMBINED-PLAN              VALUE 'C'.
  2887             88  CF-JNT-PLAN                   VALUE 'J'.
  2888             88  CF-SNGL-PLAN                  VALUE 'S'.
  2889         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2890         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2891         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2892         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  55
* EL686.cbl
  2893         16  CF-RERATE-CNTL                 PIC  X.
  2894             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2895             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2896             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2897             88  CF-AUTO-RECALC                 VALUE '4'.
  2898         16  CF-BENEFIT-TYPE                PIC  X.
  2899             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2900             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2901         16  CF-POLICY-FEE                  PIC S999V99
  2902                                                    COMP-3.
  2903         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2904         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2905         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2906         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2907         16  FILLER                         PIC  X(32).
  2908         16  CF-TERMINATION-FORM            PIC  X(04).
  2909         16  FILLER                         PIC  X(08).
  2910         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2911                                                       COMP-3.
  2912         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2913         16  CF-ISSUE-LETTER                PIC  X(4).
  2914         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2915         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2916             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2917             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2918         16  CF-MP-REFUND-CALC              PIC X.
  2919             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2920             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2921             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2922             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2923             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2924             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2925             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2926             88  CF-MP-REFD-MEAN                VALUE '8'.
  2927         16  CF-ALT-RATE-CODE               PIC  X(5).
  2928
  2929
  2930         16  FILLER                         PIC X(498).
  2931****************************************************************
  2932*             MORTGAGE COMPANY MASTER RECORD                   *
  2933****************************************************************
  2934
  2935     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2936         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2937         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2938             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2939             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2940             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2941             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2942             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2943
  2944         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2945         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2946         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2947         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2948         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2949
  2950         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  56
* EL686.cbl
  2951             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2952         16  CF-MP-RECON-USE-IND            PIC X(1).
  2953             88  CF-MP-USE-RECON             VALUE 'Y'.
  2954         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2955             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2956         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2957             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2958             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2959         16  FILLER                         PIC X(1).
  2960         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2961             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2962         16  CF-MORTG-MIB-VERSION           PIC X.
  2963             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2964             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2965             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2966         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2967             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2968                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2969             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2970                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2971             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2972                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2973             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2974                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2975             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2976                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2977             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2978                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2979         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2980         16  FILLER                         PIC X(7).
  2981         16  CF-MORTG-DESTINATION-SYMBOL.
  2982             20  CF-MORTG-MIB-COMM          PIC X(5).
  2983             20  CF-MORTG-MIB-TERM          PIC X(5).
  2984         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2985             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2986         16  FILLER                         PIC X(03).
  2987         16  CF-MP-CHECK-NO-CONTROL.
  2988             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2989                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2990                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2991                                                ' ' LOW-VALUES.
  2992                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2993                                               VALUE '3'.
  2994         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2995         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2996         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2997             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2998                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2999             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3000                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3001             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3002                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3003             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3004                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3005             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3006                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3007             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3008                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  57
* EL686.cbl
  3009         16  CF-MORTG-BILLING-AREA.
  3010             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3011                                            PIC X.
  3012         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3013         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3014         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3015         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3016             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3017             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3018         16  FILLER                         PIC X.
  3019         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3020             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3021             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3022         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3023         16  FILLER                         PIC X(8).
  3024         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3025         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3026         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3027         16  CF-ACH-COMPANY-ID.
  3028             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3029                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3030                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3031                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3032             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3033         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3034             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3035         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3036             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3037             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3038         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3039         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3040         16  FILLER                         PIC X(536).
  3041
  3042****************************************************************
  3043*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3044****************************************************************
  3045
  3046     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3047         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3048             20  CF-FEMALE-HEIGHT.
  3049                 24  CF-FEMALE-FT           PIC 99.
  3050                 24  CF-FEMALE-IN           PIC 99.
  3051             20  CF-FEMALE-MIN-WT           PIC 999.
  3052             20  CF-FEMALE-MAX-WT           PIC 999.
  3053         16  FILLER                         PIC X(428).
  3054
  3055     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3056         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3057             20  CF-MALE-HEIGHT.
  3058                 24  CF-MALE-FT             PIC 99.
  3059                 24  CF-MALE-IN             PIC 99.
  3060             20  CF-MALE-MIN-WT             PIC 999.
  3061             20  CF-MALE-MAX-WT             PIC 999.
  3062         16  FILLER                         PIC X(428).
  3063******************************************************************
  3064*             AUTOMATIC ACTIVITY RECORD                          *
  3065******************************************************************
  3066     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  58
* EL686.cbl
  3067         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3068             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3069             20  CF-SYS-LETTER-ID           PIC X(04).
  3070             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3071             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3072             20  CF-SYS-RESET-SW            PIC X(01).
  3073             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3074             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3075
  3076         16  FILLER                         PIC X(50).
  3077
  3078         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3079             20  CF-USER-ACTIVE-SW          PIC X(01).
  3080             20  CF-USER-LETTER-ID          PIC X(04).
  3081             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3082             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3083             20  CF-USER-RESET-SW           PIC X(01).
  3084             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3085             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3086             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3087
  3088         16  FILLER                         PIC X(246).
  3089
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  59
* EL686.cbl
  3091*    COPY ERCPYAJ.
  3092******************************************************************
  3093*                                                                *
  3094*                            ERCPYAJ                             *
  3095*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3096*                            VMOD=2.015                          *
  3097*                                                                *
  3098*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  3099*                                                                *
  3100*                                                                *
  3101*   FILE TYPE = VSAM,KSDS                                        *
  3102*   RECORD SIZE = 200  RECFORM = FIXED                           *
  3103*                                                                *
  3104*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  3105*       ALTERNATE PATHS = NONE                                   *
  3106*                                                                *
  3107*   LOG = YES                                                    *
  3108*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3109******************************************************************
  3110******************************************************************
  3111*                   C H A N G E   L O G
  3112*
  3113* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3114*-----------------------------------------------------------------
  3115*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3116* EFFECTIVE    NUMBER
  3117*-----------------------------------------------------------------
  3118* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  3119* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  3120******************************************************************
  3121
  3122 01  PENDING-PAY-ADJ.
  3123     12  PY-RECORD-ID                     PIC XX.
  3124         88  VALID-PY-ID                        VALUE 'PY'.
  3125
  3126     12  PY-CONTROL-PRIMARY.
  3127         16  PY-COMPANY-CD                PIC X.
  3128         16  PY-CARRIER                   PIC X.
  3129         16  PY-GROUPING                  PIC X(6).
  3130         16  PY-FIN-RESP                  PIC X(10).
  3131         16  PY-ACCOUNT                   PIC X(10).
  3132         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  3133                                          PIC X(10).
  3134         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  3135         16  PY-RECORD-TYPE               PIC X.
  3136             88  PY-REMIT-RECEIVED            VALUE 'R'.
  3137             88  PY-DEPOSIT                   VALUE 'D'.
  3138             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  3139             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  3140             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  3141             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  3142             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  3143             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  3144             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  3145             88  PY-FICA-ENTRY                VALUE 'F'.
  3146             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  3147             88  PY-POLICY-FEE                VALUE 'W'.
  3148             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  60
* EL686.cbl
  3149
  3150     12  PY-PYMT-TYPE                     PIC X.
  3151             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  3152             88  PY-REINS-PYMT                VALUE 'R'.
  3153             88  PY-EXP-PYMT                  VALUE 'E'.
  3154
  3155     12  PY-BIL-INV                       PIC X(6).
  3156     12  PY-REF-NO                        PIC X(12).
  3157
  3158     12  PY-LAST-MAINT-DT                 PIC XX.
  3159     12  PY-LAST-MAINT-BY                 PIC X(4).
  3160     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3161
  3162     12  PY-PYADJ-RECORD.
  3163         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  3164         16  PY-ENTRY-COMMENT             PIC X(30).
  3165         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  3166             20  PY-GL-ACCOUNT            PIC X(10).
  3167             20  PY-GL-STATE              PIC X(02).
  3168             20  PY-GL-CANC-SW            PIC X(01).
  3169                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  3170                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  3171             20  PY-GL-COMMENT            PIC X(10).
  3172             20  FILLER      REDEFINES PY-GL-COMMENT.
  3173                 24  PY-GL-CHECK-NO       PIC 9(06).
  3174                 24  FILLER               PIC X(04).
  3175             20  FILLER                   PIC X(07).
  3176         16  PY-SAVE-ACCOUNT              PIC X(10).
  3177         16  PY-SAVE-TYPE                 PIC X(01).
  3178
  3179         16  PY-LETTERS.
  3180             20  PY-LETTER OCCURS 3 TIMES
  3181                           INDEXED BY PY-LET-NDX
  3182                                          PIC X(04).
  3183
  3184         16  PY-ERCOMP-TYPE               PIC X.
  3185             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  3186             88  PY-GA-TYPE                   VALUE 'G'.
  3187             88  PY-BANK-TYPE                 VALUE 'B'.
  3188         16  FILLER                       PIC X(05).
  3189
  3190     12  PY-RECORD-STATUS.
  3191         16  PY-CREDIT-SELECT-DT          PIC XX.
  3192         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  3193         16  PY-BILLED-DATE               PIC XX.
  3194         16  PY-REPORTED-DT               PIC XX.
  3195         16  PY-PMT-APPLIED               PIC X.
  3196             88  PY-ACCOUNT-PMT               VALUE 'A'.
  3197             88  PY-GA-PMT                    VALUE 'G'.
  3198             88  PY-OVWRITE-PMT               VALUE 'O'.
  3199             88  PY-NON-AR-PMT                VALUE 'N'.
  3200         16  FILLER                       PIC X(5).
  3201         16  PY-INPUT-DT                  PIC XX.
  3202         16  PY-CHECK-NUMBER              PIC X(6).
  3203         16  PY-VOID-SW                   PIC X.
  3204             88  PY-CHECK-VOIDED              VALUE 'V'.
  3205         16  PY-CHECK-ORIGIN-SW           PIC X.
  3206             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  61
* EL686.cbl
  3207             88  PY-REFUND-CHECK              VALUE 'R'.
  3208             88  PY-GA-CHECK                  VALUE 'G'.
  3209             88  PY-CHECK-WRITTEN             VALUE 'W'.
  3210             88  PY-CHECK-REVERSAL            VALUE 'V'.
  3211         16  PY-CHECK-WRITTEN-DT          PIC XX.
  3212         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  3213         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  3214         16  PY-BILL-FLAG                 PIC X.
  3215             88  PY-BILLED                    VALUE 'B'.
  3216         16  PY-AR-FLAG                   PIC X.
  3217             88  PY-AR-CYCLE                  VALUE 'C'.
  3218             88  PY-AR-MONTH-END              VALUE 'M'.
  3219         16  PY-AR-DATE                   PIC XX.
  3220
  3221     12  PY-GL-CODES.
  3222         16  PY-GL-DB                     PIC X(14).
  3223         16  PY-GL-CR                     PIC X(14).
  3224         16  PY-GL-FLAG                   PIC X.
  3225         16  PY-GL-DATE                   PIC XX.
  3226
  3227     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  3228     12  FILLER                           PIC X(3).
  3229******************************************************************
  3230
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  62
* EL686.cbl
  3232*    COPY ERCCHEK.
  3233******************************************************************
  3234*                                                                *
  3235*                                                                *
  3236*                            ERCCHEK                             *
  3237*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3238*                            VMOD=2.008                          *
  3239*                                                                *
  3240*   FILE DESCRIPTION = CHECK RECORDS                             *
  3241*                                                                *
  3242*   FILE TYPE = VSAM,KSDS                                        *
  3243*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3244*                                                                *
  3245*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3246*       ALTERNATE INDEX = NONE                                   *
  3247*                                                                *
  3248*   LOG = YES                                                    *
  3249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3250******************************************************************
  3251 01  CHECK-RECORDS.
  3252     12  CH-RECORD-ID                      PIC XX.
  3253         88  VALID-CH-ID                      VALUE 'CH'.
  3254
  3255     12  CH-CONTROL-PRIMARY.
  3256         16  CH-COMPANY-CD                 PIC X.
  3257         16  CH-CARRIER                    PIC X.
  3258         16  CH-GROUPING                   PIC X(6).
  3259         16  CH-STATE                      PIC XX.
  3260         16  CH-ACCOUNT                    PIC X(10).
  3261         16  CH-CERT-EFF-DT                PIC XX.
  3262         16  CH-CERT-NO.
  3263             20  CH-CERT-PRIME             PIC X(10).
  3264             20  CH-CERT-SFX               PIC X.
  3265         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3266
  3267     12  CH-RECORDED-DT                    PIC XX.
  3268     12  CH-RECORDED-BY                    PIC X(4).
  3269     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3270
  3271     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3272     12  CH-CHECK-NO                       PIC X(7).
  3273     12  CH-REASON-FOR-CHECK               PIC X(25).
  3274     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3275     12  CH-OFFLINE-CHECK-IND              PIC X.
  3276         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  3277
  3278     12  CH-PAYEE-INFO.
  3279         16  CH-PAYEE-NAME-1               PIC X(30).
  3280         16  CH-PAYEE-NAME-2               PIC X(30).
  3281         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3282         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3283         16  CH-PAYEE-CITY-ST              PIC X(30).
  3284         16  CH-PAYEE-ZIP-CODE.
  3285             20  CH-PAYEE-ZIP.
  3286                 24  CH-ZIP-PRI-1ST        PIC X.
  3287                     88  CH-CANADIAN-POST-CODE
  3288                                           VALUES 'A' THRU 'Z'.
  3289                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  63
* EL686.cbl
  3290             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3291         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3292             20  CH-CAN-POSTAL-1           PIC XXX.
  3293             20  CH-CAN-POSTAL-2           PIC XXX.
  3294             20  FILLER                    PIC XXX.
  3295
  3296     12  CH-CHECK-STUB-TEXT.
  3297         16  CH-STUB-LINE-1                PIC X(50).
  3298         16  CH-STUB-LINE-2                PIC X(50).
  3299         16  CH-STUB-LINE-3                PIC X(50).
  3300         16  FILLER.
  3301           18  CH-STUB-LINE-4              PIC X(20).
  3302           18  CH-LIENHOLDER-NAME          PIC X(30).
  3303
  3304     12  CH-COMPENSATION-CONTROL.
  3305         16  CH-COMP-CARRIER               PIC X.
  3306         16  CH-COMP-GROUPING              PIC X(6).
  3307         16  CH-COMP-FIN-RESP              PIC X(10).
  3308         16  CH-COMP-ACCOUNT               PIC X(10).
  3309
  3310     12  CH-CREDIT-SELECT-DT               PIC XX.
  3311     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3312     12  CH-PAYEE-CODE                     PIC X(6).
  3313
  3314     12  CH-VOID-DATA.
  3315         20  CH-VOID-DT                    PIC XX.
  3316         20  CH-VOID-BY                    PIC X(4).
  3317         20  CH-VOID-REASON                PIC X(25).
  3318
  3319     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3320             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3321     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3322
  3323     12  CH-CHECK-REFERENCE                PIC X(12).
  3324     12  CH-CHECK-ORIGIN-SW                PIC X.
  3325             88  CH-REFUND-CHECK              VALUE 'R'.
  3326             88  CH-MAINT-CHECK               VALUE 'M'.
  3327
  3328     12  CH-CANC-DT                        PIC XX.
  3329     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3330     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3331
  3332     12  CH-INSURED-NAME                   PIC X(28).
  3333
  3334     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  3335     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  3336
  3337     12  CH-LETTER-TABLE.
  3338         16  CH-LETTERS OCCURS 3 TIMES
  3339                        INDEXED BY CH-LT-NDX
  3340                                           PIC X(04).
  3341
  3342     12  FILLER                            PIC X(07).
  3343
  3344
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  64
* EL686.cbl
  3346*    COPY ERCCMCK.
  3347******************************************************************
  3348*                                                                *
  3349*                                                                *
  3350*                            ERCCMCK                             *
  3351*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3352*                            VMOD=2.012                          *
  3353*                                                                *
  3354*   FILE DESCRIPTION = COMMISSION CHECK RECORDS                  *
  3355*                                                                *
  3356*   FILE TYPE = VSAM,KSDS                                        *
  3357*   RECORD SIZE = 2000   RECFORM = FIXED                         *
  3358*                                                                *
  3359*   BASE CLUSTER NAME = ERCMCK             RKP=2,LEN=26          *
  3360*       ALTERNATE INDEX = NONE                                   *
  3361*                                                                *
  3362*   LOG = NO                                                     *
  3363*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3364******************************************************************
  3365 01  COMM-CHECK-RECORDS.
  3366     12  CK-RECORD-ID                      PIC XX.
  3367         88  VALID-CK-ID                      VALUE 'CK'.
  3368
  3369     12  CK-CONTROL-PRIMARY.
  3370         16  CK-COMPANY-CD                 PIC X.
  3371         16  CK-CSR                        PIC X(4).
  3372         16  CK-CARRIER                    PIC X.
  3373         16  CK-GROUPING                   PIC X(6).
  3374         16  CK-PAYEE                      PIC X(10).
  3375         16  CK-PAYEE-SEQ                  PIC S9(4)     COMP.
  3376         16  CK-SEQUENCE-NO                PIC S9(4)     COMP.
  3377
  3378     12  CK-RECORDED-DT                    PIC XX.
  3379     12  CK-RECORDED-BY                    PIC X(4).
  3380     12  CK-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3381
  3382     12  CK-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3383     12  CK-RECORD-TYPE                    PIC X.
  3384         88  CK-DETAIL                        VALUE 'D'.
  3385         88  CK-TEXT                          VALUE 'T'.
  3386     12  CK-CHECK-NO                       PIC X(6).
  3387     12  CK-CHECK-WRITTEN-DT               PIC XX.
  3388     12  CK-PAYEE-INFO.
  3389         16  CK-PAYEE-NAME                 PIC X(30).
  3390         16  CK-PAYEE-ADDRESS-1            PIC X(30).
  3391         16  CK-PAYEE-ADDRESS-2            PIC X(30).
  3392         16  CK-PAYEE-CITY-ST              PIC X(30).
  3393         16  CK-PAYEE-ZIP-CODE.
  3394             20  CK-PAYEE-ZIP              PIC X(5).
  3395             20  CK-PAYEE-ZIP-EXT          PIC X(4).
  3396
  3397     12  CK-CHECK-STUB-DATA.
  3398         16  CK-CHECK-STUB-INFO  OCCURS  15  TIMES.
  3399             20  CK-STUB-LINE.
  3400                 24  CK-STUB-COMMENT       PIC X(23).
  3401                 24  CK-ACCT-AGENT         PIC X(10).
  3402                 24  CK-INVOICE            PIC X(6).
  3403                 24  CK-REFERENCE          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  65
* EL686.cbl
  3404                 24  CK-LEDGER-NO          PIC X(14).
  3405                 24  CK-DETAIL-AMT         PIC S9(7)V99 COMP-3.
  3406                 24  CK-LAST-MAINT-APPLIED PIC X.
  3407                 24  CK-NON-AR-ITEM        PIC X.
  3408                 24  FILLER                PIC X(19).
  3409
  3410             20  CK-CHECK-WORK-CONTROL.
  3411                  24  CK-CKWK-CSR          PIC X(4).
  3412                  24  CK-CKWK-CARRIER      PIC X.
  3413                  24  CK-CKWK-GROUPING     PIC X(6).
  3414                  24  CK-CKWK-PAYEE        PIC X(10).
  3415                  24  CK-CKWK-PAYEE-SEQ    PIC S9(4) COMP.
  3416                  24  CK-CKWK-SEQ-NO       PIC S9(4) COMP.
  3417             20  CK-PAYMENT-TYPE           PIC X.
  3418             20  CK-PYAJ-PMT-APPLIED       PIC X.
  3419
  3420     12  CK-CHECK-STUB-TEXT  REDEFINES CK-CHECK-STUB-DATA.
  3421         16  CK-CHECK-TEXT-ITEMS OCCURS 3 TIMES.
  3422             20  CK-STUB-TEXT              PIC X(70).
  3423         16  CK-STUB-FILL-AREA             PIC X(1560).
  3424
  3425     12  CK-CHECK-QUE-CONTROL.
  3426         20  CK-QUE-CONTROL-NUMBER         PIC S9(8) COMP.
  3427         20  CK-QUE-SEQ-NO                 PIC S9(4) COMP.
  3428
  3429     12  CK-CREDIT-SELECT-DT               PIC XX.
  3430     12  CK-CREDIT-ACCEPT-DT               PIC XX.
  3431
  3432     12  CK-VOID-DATA.
  3433         20  CK-VOID-DT                    PIC XX.
  3434         20  CK-VOID-REASON                PIC X(25).
  3435
  3436     12  CK-AR-STATEMENT-DT                PIC XX.
  3437     12  CK-PMT-APPLIED                    PIC X.
  3438     12  CK-ACH-PAYMENT                    PIC X.
  3439          88 PAID-BY-ACH                   VALUE 'P'.
  3440          88 NOT-PAID-BY-ACH               VALUE 'N'.
  3441     12  FILLER                            PIC X(08).
  3442
  3443
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  66
* EL686.cbl
  3445*    COPY ERCCMKQ.
  3446******************************************************************
  3447*                                                                *
  3448*                                                                *
  3449*                            ERCCMKQ                             *
  3450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3451*                            VMOD=2.014                          *
  3452*                                                                *
  3453*   FILE DESCRIPTION = CHECK QUE FILE FOR THE COMMISSION         *
  3454*                      CHECK OF THE CREDIT SYSTEM                *
  3455*                                                                *
  3456*   FILE TYPE = VSAM,KSDS                                        *
  3457*   RECORD SIZE = 1800 RECFORM = FIXED                           *
  3458*                                                                *
  3459*   BASE CLUSTER = ERCMKQ                         RKP=2,LEN=7    *
  3460*       ALTERNATE PATH  = ERCMKQ2  (BY PAYEE CONTRO AND          *
  3461*                                      CONTROL NUMBER)           *
  3462*                                                 RKP=9,LEN=30   *
  3463*                                                                *
  3464*   LOG = NO                                                     *
  3465*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3466******************************************************************
  3467 01  COMMISSION-CHECK-QUE.
  3468     12  MQ-RECORD-ID                PIC XX.
  3469         88  VALID-MQ-ID                     VALUE 'MQ'.
  3470
  3471     12  MQ-CONTROL-PRIMARY.
  3472         16  MQ-COMPANY-CD           PIC X.
  3473         16  MQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  3474         16  MQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  3475
  3476     12  MQ-CONTROL-BY-PAYEE.
  3477         16  MQ-COMPANY-CD-A1        PIC X.
  3478         16  MQ-CSR-A1               PIC X(4).
  3479         16  MQ-CARRIER-A1           PIC X.
  3480         16  MQ-GROUPING-A1          PIC X(6).
  3481         16  MQ-PAYEE-A1             PIC X(10).
  3482         16  MQ-PAYEE-SEQ-A1         PIC S9(4)       COMP.
  3483         16  MQ-CONTROL-NUMBER-A1    PIC S9(8)       COMP.
  3484         16  MQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  3485
  3486     12  MQ-ENTRY-TYPE               PIC X.
  3487             88  CHECK-ON-QUE           VALUE 'Q'.
  3488             88  ALIGNMENT-CHECK        VALUE 'A'.
  3489             88  SPOILED-CHECK          VALUE 'S'.
  3490             88  PAYMENT-ABORTED        VALUE 'X'.
  3491             88  ACH-PAYMENT            VALUE 'P'.
  3492
  3493     12  FILLER                      PIC X(10).
  3494
  3495     12  MQ-CREDIT-CHEK-CNTL.
  3496         16  MQ-CHEK-CSR             PIC X(4).
  3497         16  MQ-CHEK-CARRIER         PIC X.
  3498         16  MQ-CHEK-GROUPING        PIC X(6).
  3499         16  MQ-CHEK-PAYEE           PIC X(10).
  3500         16  MQ-CHEK-PAYEE-SEQ       PIC S9(4)       COMP.
  3501         16  MQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  3502
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  67
* EL686.cbl
  3503     12  FILLER                      PIC X(10).
  3504
  3505     12  MQ-PAYEE-INFO.
  3506         16  MQ-PAYEE-NAME           PIC X(30).
  3507         16  MQ-PAYEE-ADDRESS-1      PIC X(30).
  3508         16  MQ-PAYEE-ADDRESS-2      PIC X(30).
  3509         16  MQ-PAYEE-CITY-ST        PIC X(30).
  3510         16  MQ-PAYEE-ZIP-CODE.
  3511             20  MQ-PAYEE-ZIP.
  3512                 24  FILLER          PIC X(1).
  3513                     88 MQ-PAYEE-CANADIAN-POST-CODE
  3514                                     VALUE 'A' THRU 'Z'.
  3515                 24  FILLER          PIC X(4).
  3516             20  MQ-PAYEE-ZIP-EXT    PIC X(4).
  3517         16  MQ-PAYEE-CANADIAN-POSTAL-CODES
  3518                 REDEFINES MQ-PAYEE-ZIP-CODE.
  3519             20  MQ-PAY-CAN-POSTAL-CD-1
  3520                                     PIC X(3).
  3521             20  MQ-PAY-CAN-POSTAL-CD-2
  3522                                     PIC X(3).
  3523             20  FILLER              PIC X(3).
  3524
  3525     12  MQ-CREDIT-PYAJ-CNTL.
  3526         16  MQ-PYAJ-CARRIER         PIC X.
  3527         16  MQ-PYAJ-GROUPING        PIC X(6).
  3528         16  MQ-PYAJ-FIN-RESP        PIC X(10).
  3529         16  FILLER                  PIC X(6).
  3530
  3531     12  MQ-CHECK-NUMBER             PIC X(6).
  3532     12  MQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  3533     12  MQ-NUMBER-OF-CK-STUBS       PIC S9(3)       COMP-3.
  3534     12  MQ-VOID-DT                  PIC XX.
  3535     12  MQ-TIMES-PRINTED            PIC S9(4)       COMP.
  3536     12  MQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  3537     12  MQ-CHECK-BY-USER            PIC X(4).
  3538     12  MQ-PRE-NUMBERING-SW         PIC X.
  3539       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  3540       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  3541
  3542     12  MQ-CHECK-WRITTEN-DT         PIC XX.
  3543     12  MQ-ACH-WRITTEN-DT REDEFINES  MQ-CHECK-WRITTEN-DT
  3544                                     PIC XX.
  3545     12  MQ-LAST-MAINT-BY            PIC X(4).
  3546     12  MQ-LAST-MAINT-HHMMSS        PIC S9(6)       COMP-3.
  3547     12  MQ-LAST-MAINT-DT            PIC XX.
  3548     12  MQ-CHECK-RELEASE-DT         PIC XX.
  3549     12  MQ-RECORD-TYPE              PIC X.
  3550         88  MQ-DETAIL                     VALUE 'D'.
  3551         88  MQ-TEXT                       VALUE 'T'.
  3552
  3553     12  MQ-DETAIL-INFORMATION.
  3554         16  MQ-DETAIL-INFO        OCCURS 15 TIMES.
  3555             20  MQ-CHECK-STUB-LINE.
  3556                 24  MQ-STUB-COMMENT        PIC X(23).
  3557                 24  MQ-ACCT-AGENT          PIC X(10).
  3558                 24  MQ-INVOICE             PIC X(6).
  3559                 24  MQ-REFERENCE           PIC X(12).
  3560                 24  MQ-LEDGER-NO           PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  68
* EL686.cbl
  3561                 24  MQ-PYAJ-AMT            PIC S9(7)V99 COMP-3.
  3562                 24  MQ-PYAJ-REC-TYPE       PIC X.
  3563                 24  MQ-PYAJ-SEQ            PIC S9(8)    COMP.
  3564                 24  MQ-PAYMENT-TYPE        PIC X.
  3565                 24  MQ-PYAJ-PMT-APPLIED    PIC X.
  3566                 24  MQ-LAST-MAINT-APPLIED  PIC X.
  3567                 24  MQ-NON-AR-ITEM         PIC X.
  3568                 24  FILLER                 PIC X(19).
  3569
  3570     12  MQ-CHECK-STUB-TEXT REDEFINES MQ-DETAIL-INFORMATION.
  3571         16  MQ-CHECK-TEXT-ITEMS   OCCURS 3 TIMES.
  3572             20  MQ-STUB-TEXT        PIC X(70).
  3573         16  MQ-STUB-FILLER          PIC X(1260).
  3574
  3575     12  MQ-CREDIT-SELECT-DATE       PIC XX.
  3576     12  MQ-CREDIT-ACCEPT-DATE       PIC XX.
  3577
  3578     12  MQ-AR-STATEMENT-DT          PIC XX.
  3579     12  MQ-CO-TYPE                  PIC X.
  3580
  3581     12  MQ-STARTING-CHECK-NUMBER    PIC X(06).
  3582     12  FILLER                      PIC X(41).
  3583******************************************************************
  3584
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  69
* EL686.cbl
  3586 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3587                          CONTROL-FILE PENDING-PAY-ADJ
  3588                          CHECK-RECORDS COMM-CHECK-RECORDS
  3589                          COMMISSION-CHECK-QUE.
  3590 0000-DFHEXIT SECTION.
  3591     MOVE '9#                    $   ' TO DFHEIV0.
  3592     MOVE 'EL686' TO DFHEIV1.
  3593     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3594
  3595     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3596
  3597*    NOTE *******************************************************
  3598*         *                                                     *
  3599*         *      ACCESS TO THIS MODULE CAN BE ONLY FROM AN XCTL *
  3600*         *  FROM ANOTHER MODULE.                               *
  3601*         *                                                     *
  3602*         *******************************************************.
  3603
  3604     IF EIBCALEN NOT GREATER THAN ZERO
  3605         MOVE UNACCESS-MSG       TO  LOGOFF-MSG
  3606         GO TO 8300-SEND-TEXT.
  3607
  3608
  3609* EXEC CICS HANDLE CONDITION
  3610*        PGMIDERR   (9600-PGMIDERR)
  3611*        NOTFND     (0140-NOT-FOUND)
  3612*        ENDFILE    (0400-END-OF-SEARCH)
  3613*        ENQBUSY    (0910-ENQ-BUSY)
  3614*        TERMIDERR  (7010-TERMID-ERROR)
  3615*        TRANSIDERR (7020-TRANS-ERROR)
  3616*        ERROR      (9990-ERROR)
  3617*    END-EXEC.
  3618*    MOVE '"$LI'')[\.             ! " #00003604' TO DFHEIV0
  3619     MOVE X'22244C4927295B5C2E202020' TO DFHEIV0(1:12)
  3620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3621     MOVE X'2220233030303033363034' TO DFHEIV0(25:11)
  3622     CALL 'kxdfhei1' USING DFHEIV0
  3623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3624
  3625
  3626     MOVE EIBTRMID               TO  QID-TERM.
  3627     MOVE +2                     TO  EMI-NUMBER-OF-LINES
  3628                                     EMI-SWITCH2.
  3629
  3630     MOVE EIBTIME                TO  WS-TIME-WORK
  3631                                     TIME-IN.
  3632
  3633     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3634         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3635             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  3636             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  3637             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  3638             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  3639             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  3640             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  3641             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  3642             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  3643           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  70
* EL686.cbl
  3644             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  3645             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  3646             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  3647             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  3648             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  3649             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  3650             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  3651             MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  3652       ELSE
  3653         GO TO 0110-PROCESS-INPUT.
  3654
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  71
* EL686.cbl
  3656 0100-INITIALIZE.
  3657
  3658*    NOTE *******************************************************
  3659*         *                                                     *
  3660*         *      INITALIZE THE WORK FIELDS FOR THE PROGRAM      *
  3661*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  3662*         *                                                     *
  3663*         *******************************************************.
  3664
  3665     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA.
  3666     MOVE ZERO                   TO  PI-PROC-SW.
  3667
  3668     MOVE LOW-VALUES             TO  EL686AI.
  3669     MOVE -1                     TO  AOPTIONL.
  3670
  3671     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3672     MOVE '5'                    TO  DC-OPTION-CODE.
  3673     PERFORM 8500-DATE-CONVERSION.
  3674     MOVE DC-BIN-DATE-1          TO  PI-CURRENT-DATE-BIN.
  3675     MOVE DC-GREG-DATE-1-EDIT    TO  PI-CURRENT-DATE.
  3676
  3677     PERFORM 8100-SEND-INITIAL-MAP.
  3678
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  72
* EL686.cbl
  3680 0110-PROCESS-INPUT.
  3681
  3682*    NOTE *******************************************************
  3683*         *                                                     *
  3684*         *      AFTER THE FIRST TIME THROUGH THE PROPER ATTEN- *
  3685*         *  TION KEY USAGE NEEDS TO BE CHECKED FOR VALIDITY    *
  3686*         *  BEFORE ANY FURTHER PROCESSING CAN BE DONE.         *
  3687*         *                                                     *
  3688*         *******************************************************.
  3689
  3690     IF EIBAID EQUAL TO DFHCLEAR
  3691         GO TO 9400-CLEAR.
  3692
  3693     IF EIBAID EQUAL TO (DFHPA1 OR
  3694                         DFHPA2 OR
  3695                         DFHPA3)
  3696         MOVE ER-0008            TO  EMI-ERROR
  3697         MOVE -1                 TO  APFKL
  3698         PERFORM 8200-SEND-DATAONLY.
  3699
  3700
  3701* EXEC CICS RECEIVE
  3702*        INTO   (EL686AI)
  3703*        MAPSET (WS-MAPSET-NAME)
  3704*        MAP    (WS-MAP-NAME) END-EXEC.
  3705     MOVE LENGTH OF
  3706      EL686AI
  3707       TO DFHEIV11
  3708*    MOVE '8"T I  L              ''   #00003688' TO DFHEIV0
  3709     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3710     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3711     MOVE X'2020233030303033363838' TO DFHEIV0(25:11)
  3712     CALL 'kxdfhei1' USING DFHEIV0,
  3713           WS-MAP-NAME,
  3714           EL686AI,
  3715           DFHEIV11,
  3716           WS-MAPSET-NAME,
  3717           DFHEIV99,
  3718           DFHEIV99
  3719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3720
  3721
  3722     IF APFKL IS GREATER THAN ZERO
  3723         IF EIBAID NOT = DFHENTER
  3724             MOVE ER-0004        TO  EMI-ERROR
  3725             MOVE AL-UNBOF       TO  APFKA
  3726             MOVE -1             TO  APFKL
  3727             PERFORM 8200-SEND-DATAONLY
  3728           ELSE
  3729             IF APFKO IS NUMERIC
  3730               AND APFKO IS GREATER THAN ZERO
  3731               AND APFKO IS LESS THAN '25'
  3732                 MOVE PF-VALUES (APFKI)  TO  EIBAID
  3733               ELSE
  3734                 MOVE ER-0029        TO  EMI-ERROR
  3735                 MOVE AL-UNBOF       TO  APFKA
  3736                 MOVE -1             TO  APFKL
  3737                 PERFORM 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  73
* EL686.cbl
  3738
  3739     IF EIBAID IS EQUAL TO DFHPF12
  3740         MOVE EL010              TO  THIS-PGM
  3741         GO TO 9300-XCTL.
  3742
  3743     IF EIBAID IS EQUAL TO DFHPF23
  3744         GO TO 9000-RETURN-CICS.
  3745
  3746     IF EIBAID IS EQUAL TO DFHPF24
  3747         MOVE EL126              TO  THIS-PGM
  3748         GO TO 9300-XCTL.
  3749
  3750     IF EIBAID = DFHPF1 AND
  3751        PI-SCREEN-PROCESSED
  3752          GO TO 0200-PROCESS-CHECK-RELEASE.
  3753
  3754     IF EIBAID NOT = DFHENTER
  3755         MOVE ER-0008            TO  EMI-ERROR
  3756         MOVE -1                 TO  APFKL
  3757         PERFORM 8200-SEND-DATAONLY.
  3758
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  74
* EL686.cbl
  3760
  3761*    NOTE *******************************************************
  3762*         *                                                     *
  3763*         *      OPTION          MEANING                        *
  3764*         *                                                     *
  3765*         *        1         OPTIONS 2 THRU 4                   *
  3766*         *        2         BILLING PAYMENTS                   *
  3767*         *        3         REFUND REIMBURSMENTS               *
  3768*         *        4         MAINTENANCE PAYMENTS               *
  3769*         *                  ACCOUNT RECEIVABLE PAYMENTS        *
  3770*         *                  5 = CHECKS   6 = ACH               *
  3771*         *                                                     *
  3772*         *******************************************************.
  3773
  3774     IF AOPTIONL GREATER ZERO  AND
  3775        AOPTIONI = '1' OR '2' OR '3' OR '4' OR '5' OR '6'
  3776         MOVE AL-UNNON           TO  AOPTIONA
  3777       ELSE
  3778         MOVE -1                 TO  AOPTIONL
  3779         MOVE AL-UNBON           TO  AOPTIONA
  3780         MOVE ER-0330            TO  EMI-ERROR
  3781         PERFORM 9900-ERROR-FORMAT.
  3782
  3783     IF PI-COMPANY-ID = 'POS'
  3784        AND ACARRL NOT GREATER ZERO
  3785             MOVE -1             TO  ACARRL
  3786             MOVE AL-UABOF       TO  ACARRA
  3787             MOVE ER-0568        TO  EMI-ERROR
  3788             PERFORM 9900-ERROR-FORMAT.
  3789
  3790     IF AAMTL GREATER ZERO
  3791
  3792* EXEC CICS BIF DEEDIT
  3793*            FIELD (AAMTI)
  3794*            LENGTH (7)
  3795*       END-EXEC
  3796     MOVE 7
  3797       TO DFHEIV11
  3798*    MOVE '@"L                   #   #00003762' TO DFHEIV0
  3799     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3800     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3801     MOVE X'2020233030303033373632' TO DFHEIV0(25:11)
  3802     CALL 'kxdfhei1' USING DFHEIV0,
  3803           AAMTI,
  3804           DFHEIV11
  3805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3806        IF AAMTI NOT NUMERIC
  3807            MOVE -1             TO  AAMTL
  3808            MOVE AL-UABON       TO  AAMTA
  3809            MOVE ER-0078        TO  EMI-ERROR
  3810            PERFORM 9900-ERROR-FORMAT
  3811         ELSE
  3812            MOVE AAMTI          TO  PI-CHECK-AMOUNT
  3813
  3814            MOVE AL-UANON       TO  AAMTA.
  3815
  3816*    NOTE *******************************************************
  3817*         *                                                     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  75
* EL686.cbl
  3818*         *  CHECK TO SEE THAT THE CERTIFICATE NUMBER HAS       *
  3819*         *  THE EFFECTIVE DATE ENTERED.                        *
  3820*         *                                                     *
  3821*         *******************************************************.
  3822
  3823     IF CERTO01I = SPACES
  3824          MOVE +0               TO CERTO01L.
  3825     IF EFFDT01I = SPACES
  3826          MOVE +0               TO EFFDT01L.
  3827     IF CERTO02I = SPACES
  3828          MOVE +0               TO CERTO02L.
  3829     IF EFFDT02I = SPACES
  3830          MOVE +0               TO EFFDT02L.
  3831     IF CERTO03I = SPACES
  3832          MOVE +0               TO CERTO03L.
  3833     IF EFFDT03I = SPACES
  3834          MOVE +0               TO EFFDT03L.
  3835     IF CERTO04I = SPACES
  3836          MOVE +0               TO CERTO04L.
  3837     IF EFFDT04I = SPACES
  3838          MOVE +0               TO EFFDT04L.
  3839     IF CERTO05I = SPACES
  3840          MOVE +0               TO CERTO05L.
  3841     IF EFFDT05I = SPACES
  3842          MOVE +0               TO EFFDT05L.
  3843     IF CERTO06I = SPACES
  3844          MOVE +0               TO CERTO06L.
  3845     IF EFFDT06I = SPACES
  3846          MOVE +0               TO EFFDT06L.
  3847     IF CERTO07I = SPACES
  3848          MOVE +0               TO CERTO07L.
  3849     IF EFFDT07I = SPACES
  3850          MOVE +0               TO EFFDT07L.
  3851     IF CERTO08I = SPACES
  3852          MOVE +0               TO CERTO08L.
  3853     IF EFFDT08I = SPACES
  3854          MOVE +0               TO EFFDT08L.
  3855     IF CERTO09I = SPACES
  3856          MOVE +0               TO CERTO09L.
  3857     IF EFFDT09I = SPACES
  3858          MOVE +0               TO EFFDT09L.
  3859     IF CERTO10I = SPACES
  3860          MOVE +0               TO CERTO10L.
  3861     IF EFFDT10I = SPACES
  3862          MOVE +0               TO EFFDT10L.
  3863     IF CERTO11I = SPACES
  3864          MOVE +0               TO CERTO11L.
  3865     IF EFFDT11I = SPACES
  3866          MOVE +0               TO EFFDT11L.
  3867     IF CERTO12I = SPACES
  3868          MOVE +0               TO CERTO12L.
  3869     IF EFFDT12I = SPACES
  3870          MOVE +0               TO EFFDT12L.
  3871     IF CERTO13I = SPACES
  3872          MOVE +0               TO CERTO13L.
  3873     IF EFFDT13I = SPACES
  3874          MOVE +0               TO EFFDT13L.
  3875     IF CERTO14I = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  76
* EL686.cbl
  3876          MOVE +0               TO CERTO14L.
  3877     IF EFFDT14I = SPACES
  3878          MOVE +0               TO EFFDT14L.
  3879     IF CERTO15I = SPACES
  3880          MOVE +0               TO CERTO15L.
  3881     IF EFFDT15I = SPACES
  3882          MOVE +0               TO EFFDT15L.
  3883
  3884     IF (CERTO01L     > 0 AND EFFDT01L NOT > 0) OR
  3885        (CERTO01L NOT > 0 AND EFFDT01L     > 0) OR
  3886        (CERTO02L     > 0 AND EFFDT02L NOT > 0) OR
  3887        (CERTO02L NOT > 0 AND EFFDT02L     > 0) OR
  3888        (CERTO03L     > 0 AND EFFDT03L NOT > 0) OR
  3889        (CERTO03L NOT > 0 AND EFFDT03L     > 0) OR
  3890        (CERTO04L     > 0 AND EFFDT04L NOT > 0) OR
  3891        (CERTO04L NOT > 0 AND EFFDT04L     > 0) OR
  3892        (CERTO05L     > 0 AND EFFDT05L NOT > 0) OR
  3893        (CERTO05L NOT > 0 AND EFFDT05L     > 0) OR
  3894        (CERTO06L     > 0 AND EFFDT06L NOT > 0) OR
  3895        (CERTO06L NOT > 0 AND EFFDT06L     > 0) OR
  3896        (CERTO07L     > 0 AND EFFDT07L NOT > 0) OR
  3897        (CERTO07L NOT > 0 AND EFFDT07L     > 0) OR
  3898        (CERTO08L     > 0 AND EFFDT08L NOT > 0) OR
  3899        (CERTO08L NOT > 0 AND EFFDT08L     > 0) OR
  3900        (CERTO09L     > 0 AND EFFDT09L NOT > 0) OR
  3901        (CERTO09L NOT > 0 AND EFFDT09L     > 0) OR
  3902        (CERTO10L     > 0 AND EFFDT10L NOT > 0) OR
  3903        (CERTO10L NOT > 0 AND EFFDT10L     > 0) OR
  3904        (CERTO11L     > 0 AND EFFDT11L NOT > 0) OR
  3905        (CERTO11L NOT > 0 AND EFFDT11L     > 0) OR
  3906        (CERTO12L     > 0 AND EFFDT12L NOT > 0) OR
  3907        (CERTO12L NOT > 0 AND EFFDT12L     > 0) OR
  3908        (CERTO13L     > 0 AND EFFDT13L NOT > 0) OR
  3909        (CERTO13L NOT > 0 AND EFFDT13L     > 0) OR
  3910        (CERTO14L     > 0 AND EFFDT14L NOT > 0) OR
  3911        (CERTO14L NOT > 0 AND EFFDT14L     > 0) OR
  3912        (CERTO15L     > 0 AND EFFDT15L NOT > 0) OR
  3913        (CERTO15L NOT > 0 AND EFFDT15L     > 0)
  3914         MOVE ER-0766            TO EMI-ERROR
  3915         MOVE -1                 TO CERTO01L
  3916         PERFORM 9900-ERROR-FORMAT.
  3917
  3918     IF EFFDT01L GREATER ZERO
  3919         MOVE EFFDT01I                 TO  DEEDIT-FIELD
  3920         PERFORM 8600-DEEDIT
  3921         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3922         MOVE '4'                      TO  DC-OPTION-CODE
  3923         PERFORM 8500-DATE-CONVERSION
  3924         IF DATE-CONVERSION-ERROR
  3925             MOVE ER-0348              TO  EMI-ERROR
  3926             MOVE -1                   TO  EFFDT01L
  3927             MOVE AL-UABON             TO  EFFDT01A
  3928             PERFORM 9900-ERROR-FORMAT
  3929           ELSE
  3930             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT01I
  3931             MOVE AL-UANON             TO  EFFDT01A
  3932             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (1).
  3933
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  77
* EL686.cbl
  3934     IF EFFDT02L GREATER ZERO
  3935         MOVE EFFDT02I                 TO  DEEDIT-FIELD
  3936         PERFORM 8600-DEEDIT
  3937         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3938         MOVE '4'                      TO  DC-OPTION-CODE
  3939         PERFORM 8500-DATE-CONVERSION
  3940         IF DATE-CONVERSION-ERROR
  3941             MOVE ER-0348              TO  EMI-ERROR
  3942             MOVE -1                   TO  EFFDT02L
  3943             MOVE AL-UABON             TO  EFFDT02A
  3944             PERFORM 9900-ERROR-FORMAT
  3945           ELSE
  3946             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT02I
  3947             MOVE AL-UANON             TO  EFFDT02A
  3948             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (2).
  3949
  3950     IF EFFDT03L GREATER ZERO
  3951         MOVE EFFDT03I                 TO  DEEDIT-FIELD
  3952         PERFORM 8600-DEEDIT
  3953         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3954         MOVE '4'                      TO  DC-OPTION-CODE
  3955         PERFORM 8500-DATE-CONVERSION
  3956         IF DATE-CONVERSION-ERROR
  3957             MOVE ER-0348              TO  EMI-ERROR
  3958             MOVE -1                   TO  EFFDT03L
  3959             MOVE AL-UABON             TO  EFFDT03A
  3960             PERFORM 9900-ERROR-FORMAT
  3961           ELSE
  3962             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT03I
  3963             MOVE AL-UANON             TO  EFFDT03A
  3964             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (3).
  3965
  3966     IF EFFDT04L GREATER ZERO
  3967         MOVE EFFDT04I                 TO  DEEDIT-FIELD
  3968         PERFORM 8600-DEEDIT
  3969         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3970         MOVE '4'                      TO  DC-OPTION-CODE
  3971         PERFORM 8500-DATE-CONVERSION
  3972         IF DATE-CONVERSION-ERROR
  3973             MOVE ER-0348              TO  EMI-ERROR
  3974             MOVE -1                   TO  EFFDT04L
  3975             MOVE AL-UABON             TO  EFFDT04A
  3976             PERFORM 9900-ERROR-FORMAT
  3977           ELSE
  3978             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT04I
  3979             MOVE AL-UANON             TO  EFFDT04A
  3980             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (4).
  3981
  3982     IF EFFDT05L GREATER ZERO
  3983         MOVE EFFDT05I                 TO  DEEDIT-FIELD
  3984         PERFORM 8600-DEEDIT
  3985         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3986         MOVE '4'                      TO  DC-OPTION-CODE
  3987         PERFORM 8500-DATE-CONVERSION
  3988         IF DATE-CONVERSION-ERROR
  3989             MOVE ER-0348              TO  EMI-ERROR
  3990             MOVE -1                   TO  EFFDT05L
  3991             MOVE AL-UABON             TO  EFFDT05A
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  78
* EL686.cbl
  3992             PERFORM 9900-ERROR-FORMAT
  3993           ELSE
  3994             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT05I
  3995             MOVE AL-UANON             TO  EFFDT05A
  3996             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (5).
  3997
  3998     IF EFFDT06L GREATER ZERO
  3999         MOVE EFFDT06I                 TO  DEEDIT-FIELD
  4000         PERFORM 8600-DEEDIT
  4001         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4002         MOVE '4'                      TO  DC-OPTION-CODE
  4003         PERFORM 8500-DATE-CONVERSION
  4004         IF DATE-CONVERSION-ERROR
  4005             MOVE ER-0348              TO  EMI-ERROR
  4006             MOVE -1                   TO  EFFDT06L
  4007             MOVE AL-UABON             TO  EFFDT06A
  4008             PERFORM 9900-ERROR-FORMAT
  4009           ELSE
  4010             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT06I
  4011             MOVE AL-UANON             TO  EFFDT06A
  4012             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (6).
  4013
  4014     IF EFFDT07L GREATER ZERO
  4015         MOVE EFFDT07I                 TO  DEEDIT-FIELD
  4016         PERFORM 8600-DEEDIT
  4017         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4018         MOVE '4'                      TO  DC-OPTION-CODE
  4019         PERFORM 8500-DATE-CONVERSION
  4020         IF DATE-CONVERSION-ERROR
  4021             MOVE ER-0348              TO  EMI-ERROR
  4022             MOVE -1                   TO  EFFDT07L
  4023             MOVE AL-UABON             TO  EFFDT07A
  4024             PERFORM 9900-ERROR-FORMAT
  4025           ELSE
  4026             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT07I
  4027             MOVE AL-UANON             TO  EFFDT07A
  4028             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (7).
  4029
  4030     IF EFFDT08L GREATER ZERO
  4031         MOVE EFFDT08I                 TO  DEEDIT-FIELD
  4032         PERFORM 8600-DEEDIT
  4033         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4034         MOVE '4'                      TO  DC-OPTION-CODE
  4035         PERFORM 8500-DATE-CONVERSION
  4036         IF DATE-CONVERSION-ERROR
  4037             MOVE ER-0348              TO  EMI-ERROR
  4038             MOVE -1                   TO  EFFDT08L
  4039             MOVE AL-UABON             TO  EFFDT08A
  4040             PERFORM 9900-ERROR-FORMAT
  4041           ELSE
  4042             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT08I
  4043             MOVE AL-UANON             TO  EFFDT08A
  4044             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (8).
  4045
  4046     IF EFFDT09L GREATER ZERO
  4047         MOVE EFFDT09I                 TO  DEEDIT-FIELD
  4048         PERFORM 8600-DEEDIT
  4049         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  79
* EL686.cbl
  4050         MOVE '4'                      TO  DC-OPTION-CODE
  4051         PERFORM 8500-DATE-CONVERSION
  4052         IF DATE-CONVERSION-ERROR
  4053             MOVE ER-0348              TO  EMI-ERROR
  4054             MOVE -1                   TO  EFFDT09L
  4055             MOVE AL-UABON             TO  EFFDT09A
  4056             PERFORM 9900-ERROR-FORMAT
  4057           ELSE
  4058             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT09I
  4059             MOVE AL-UANON             TO  EFFDT09A
  4060             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (9).
  4061
  4062     IF EFFDT10L GREATER ZERO
  4063         MOVE EFFDT10I                 TO  DEEDIT-FIELD
  4064         PERFORM 8600-DEEDIT
  4065         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4066         MOVE '4'                      TO  DC-OPTION-CODE
  4067         PERFORM 8500-DATE-CONVERSION
  4068         IF DATE-CONVERSION-ERROR
  4069             MOVE ER-0348              TO  EMI-ERROR
  4070             MOVE -1                   TO  EFFDT10L
  4071             MOVE AL-UABON             TO  EFFDT10A
  4072             PERFORM 9900-ERROR-FORMAT
  4073           ELSE
  4074             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT10I
  4075             MOVE AL-UANON             TO  EFFDT10A
  4076             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (10).
  4077
  4078     IF EFFDT11L GREATER ZERO
  4079         MOVE EFFDT11I                 TO  DEEDIT-FIELD
  4080         PERFORM 8600-DEEDIT
  4081         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4082         MOVE '4'                      TO  DC-OPTION-CODE
  4083         PERFORM 8500-DATE-CONVERSION
  4084         IF DATE-CONVERSION-ERROR
  4085             MOVE ER-0348              TO  EMI-ERROR
  4086             MOVE -1                   TO  EFFDT11L
  4087             MOVE AL-UABON             TO  EFFDT11A
  4088             PERFORM 9900-ERROR-FORMAT
  4089           ELSE
  4090             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT11I
  4091             MOVE AL-UANON             TO  EFFDT11A
  4092             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (11).
  4093
  4094     IF EFFDT12L GREATER ZERO
  4095         MOVE EFFDT12I                 TO  DEEDIT-FIELD
  4096         PERFORM 8600-DEEDIT
  4097         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4098         MOVE '4'                      TO  DC-OPTION-CODE
  4099         PERFORM 8500-DATE-CONVERSION
  4100         IF DATE-CONVERSION-ERROR
  4101             MOVE ER-0348              TO  EMI-ERROR
  4102             MOVE -1                   TO  EFFDT12L
  4103             MOVE AL-UABON             TO  EFFDT12A
  4104             PERFORM 9900-ERROR-FORMAT
  4105           ELSE
  4106             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT12I
  4107             MOVE AL-UANON             TO  EFFDT12A
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  80
* EL686.cbl
  4108             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (12).
  4109
  4110     IF EFFDT13L GREATER ZERO
  4111         MOVE EFFDT13I                 TO  DEEDIT-FIELD
  4112         PERFORM 8600-DEEDIT
  4113         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4114         MOVE '4'                      TO  DC-OPTION-CODE
  4115         PERFORM 8500-DATE-CONVERSION
  4116         IF DATE-CONVERSION-ERROR
  4117             MOVE ER-0348              TO  EMI-ERROR
  4118             MOVE -1                   TO  EFFDT13L
  4119             MOVE AL-UABON             TO  EFFDT13A
  4120             PERFORM 9900-ERROR-FORMAT
  4121           ELSE
  4122             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT13I
  4123             MOVE AL-UANON             TO  EFFDT13A
  4124             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (13).
  4125
  4126     IF EFFDT14L GREATER ZERO
  4127         MOVE EFFDT14I                 TO  DEEDIT-FIELD
  4128         PERFORM 8600-DEEDIT
  4129         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4130         MOVE '4'                      TO  DC-OPTION-CODE
  4131         PERFORM 8500-DATE-CONVERSION
  4132         IF DATE-CONVERSION-ERROR
  4133             MOVE ER-0348              TO  EMI-ERROR
  4134             MOVE -1                   TO  EFFDT14L
  4135             MOVE AL-UABON             TO  EFFDT14A
  4136             PERFORM 9900-ERROR-FORMAT
  4137           ELSE
  4138             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT14I
  4139             MOVE AL-UANON             TO  EFFDT14A
  4140             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (14).
  4141
  4142     IF EFFDT15L GREATER ZERO
  4143         MOVE EFFDT15I                 TO  DEEDIT-FIELD
  4144         PERFORM 8600-DEEDIT
  4145         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4146         MOVE '4'                      TO  DC-OPTION-CODE
  4147         PERFORM 8500-DATE-CONVERSION
  4148         IF DATE-CONVERSION-ERROR
  4149             MOVE ER-0348              TO  EMI-ERROR
  4150             MOVE -1                   TO  EFFDT15L
  4151             MOVE AL-UABON             TO  EFFDT15A
  4152             PERFORM 9900-ERROR-FORMAT
  4153           ELSE
  4154             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT15I
  4155             MOVE AL-UANON             TO  EFFDT15A
  4156             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (15).
  4157
  4158     IF EMI-ERROR NOT = ZERO
  4159         MOVE +0                     TO PI-PROC-SW
  4160         PERFORM 8200-SEND-DATAONLY
  4161      ELSE
  4162         GO TO 0200-PROCESS-CHECK-RELEASE.
  4163
  4164 0140-NOT-FOUND.
  4165
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  81
* EL686.cbl
  4166     MOVE ER-0331                TO  EMI-ERROR.
  4167     PERFORM 8200-SEND-DATAONLY.
  4168
  4169 0200-PROCESS-CHECK-RELEASE.
  4170
  4171*    NOTE *******************************************************
  4172*         *                                                     *
  4173*         *      OBTAIN EXCLUSIVE CONTROL OF THE CHECK QUEUE    *
  4174*         *  DATASET DURING THE GENERATION OF THE CHECK QUEUE   *
  4175*         *  RECORDS.                                           *
  4176*         *                                                     *
  4177*         *******************************************************.
  4178
  4179******  ACTUAL CHECK RELEASE WILL NOT TAKE PLACE
  4180******         UNLESS PF1 WAS PRESSED
  4181
  4182     IF EIBAID = DFHPF1
  4183
  4184* EXEC CICS ENQ
  4185*            RESOURCE (WS-ERCHKQ-DSID)
  4186*            LENGTH   (11)
  4187*        END-EXEC
  4188     MOVE 11
  4189       TO DFHEIV11
  4190*    MOVE '2$L                   $   #00004143' TO DFHEIV0
  4191     MOVE X'32244C202020202020202020' TO DFHEIV0(1:12)
  4192     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4193     MOVE X'2020233030303034313433' TO DFHEIV0(25:11)
  4194     CALL 'kxdfhei1' USING DFHEIV0,
  4195           WS-ERCHKQ-DSID,
  4196           DFHEIV11,
  4197           DFHEIV99
  4198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4199
  4200* EXEC CICS ENQ
  4201*            RESOURCE (WS-ERCMKQ-DSID)
  4202*            LENGTH   (11)
  4203*        END-EXEC.
  4204     MOVE 11
  4205       TO DFHEIV11
  4206*    MOVE '2$L                   $   #00004147' TO DFHEIV0
  4207     MOVE X'32244C202020202020202020' TO DFHEIV0(1:12)
  4208     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4209     MOVE X'2020233030303034313437' TO DFHEIV0(25:11)
  4210     CALL 'kxdfhei1' USING DFHEIV0,
  4211           WS-ERCMKQ-DSID,
  4212           DFHEIV11,
  4213           DFHEIV99
  4214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4215
  4216
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  82
* EL686.cbl
  4218*    NOTE *******************************************************
  4219*         *                                                     *
  4220*         *      GET THE CONTROL GROUP NUMBER FROM THE COMPANY  *
  4221*         *  CONTROL RECORD OF THE CONTROL FILE.                *
  4222*         *                                                     *
  4223*         *******************************************************.
  4224
  4225     MOVE SPACES                 TO  WS-CONTROL-FILE-KEY.
  4226
  4227     MOVE PI-COMPANY-ID          TO  WS-CFK-COMPANY-ID.
  4228     MOVE '1'                    TO  WS-CFK-RECORD-TYPE.
  4229     MOVE ZERO                   TO  WS-CFK-SEQUENCE-NO.
  4230
  4231     IF EIBAID = DFHPF1
  4232
  4233* EXEC CICS READ UPDATE
  4234*            DATASET (WS-ELCNTL-DSID)
  4235*            RIDFLD  (WS-CONTROL-FILE-KEY)
  4236*            SET     (ADDRESS OF CONTROL-FILE)
  4237*        END-EXEC
  4238*    MOVE '&"S        EU         (   #00004167' TO DFHEIV0
  4239     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4240     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4241     MOVE X'2020233030303034313637' TO DFHEIV0(25:11)
  4242     CALL 'kxdfhei1' USING DFHEIV0,
  4243           WS-ELCNTL-DSID,
  4244           DFHEIV20,
  4245           DFHEIV99,
  4246           WS-CONTROL-FILE-KEY,
  4247           DFHEIV99,
  4248           DFHEIV99,
  4249           DFHEIV99
  4250     SET ADDRESS OF CONTROL-FILE TO
  4251         DFHEIV20
  4252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4253      ELSE
  4254
  4255* EXEC CICS READ
  4256*            DATASET (WS-ELCNTL-DSID)
  4257*            RIDFLD  (WS-CONTROL-FILE-KEY)
  4258*            SET     (ADDRESS OF CONTROL-FILE)
  4259*        END-EXEC.
  4260*    MOVE '&"S        E          (   #00004173' TO DFHEIV0
  4261     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4262     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4263     MOVE X'2020233030303034313733' TO DFHEIV0(25:11)
  4264     CALL 'kxdfhei1' USING DFHEIV0,
  4265           WS-ELCNTL-DSID,
  4266           DFHEIV20,
  4267           DFHEIV99,
  4268           WS-CONTROL-FILE-KEY,
  4269           DFHEIV99,
  4270           DFHEIV99,
  4271           DFHEIV99
  4272     SET ADDRESS OF CONTROL-FILE TO
  4273         DFHEIV20
  4274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4275
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  83
* EL686.cbl
  4276
  4277     ADD +1                      TO  CF-CR-CHECK-QUE-COUNTER.
  4278
  4279     IF CR-QUE-COUNT-RESET
  4280         MOVE +1                 TO  CF-CR-CHECK-QUE-COUNTER.
  4281
  4282     MOVE CF-CR-CHECK-QUE-COUNTER  TO  WS-CHECK-QUE-COUNTER
  4283                                       PI-CK-CONTROL-NO.
  4284
  4285     MOVE WS-ELCNTL-DSID         TO  JP-FILE-ID.
  4286     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4287     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  4288
  4289     IF EIBAID = DFHPF1
  4290
  4291* EXEC CICS REWRITE
  4292*            DATASET (WS-ELCNTL-DSID)
  4293*            FROM    (CONTROL-FILE)
  4294*        END-EXEC
  4295     MOVE LENGTH OF
  4296      CONTROL-FILE
  4297       TO DFHEIV11
  4298*    MOVE '&& L                  %   #00004192' TO DFHEIV0
  4299     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4300     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4301     MOVE X'2020233030303034313932' TO DFHEIV0(25:11)
  4302     CALL 'kxdfhei1' USING DFHEIV0,
  4303           WS-ELCNTL-DSID,
  4304           CONTROL-FILE,
  4305           DFHEIV11,
  4306           DFHEIV99
  4307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4308         PERFORM 8400-LOG-JOURNAL-RECORD.
  4309
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  84
* EL686.cbl
  4311*    NOTE *******************************************************
  4312*         *                                                     *
  4313*         *      GET STORAGE FOR WRITING OF THE CHECK QUEUE     *
  4314*         *  RECORDS.                                           *
  4315*         *                                                     *
  4316*         *******************************************************.
  4317
  4318     IF  AOPTIONI     = '5' OR '6'
  4319
  4320* EXEC CICS GETMAIN
  4321*            SET (ADDRESS OF COMMISSION-CHECK-QUE)
  4322*            LENGTH (WS-ERCMKQ-LENGTH)
  4323*            INITIMG (WS-SPACES) END-EXEC
  4324*    MOVE ',"IL                  $   #00004207' TO DFHEIV0
  4325     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4326     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4327     MOVE X'2020233030303034323037' TO DFHEIV0(25:11)
  4328     CALL 'kxdfhei1' USING DFHEIV0,
  4329           DFHEIV20,
  4330           WS-ERCMKQ-LENGTH,
  4331           WS-SPACES
  4332     SET ADDRESS OF COMMISSION-CHECK-QUE TO
  4333         DFHEIV20
  4334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4335         COMPUTE WS-SEQ-NO = WS-TIME-WORK  *  10
  4336         MOVE AOPTIONI  TO  PI-PGM-PRINT-OPT
  4337         GO TO 0280-OPTION-5
  4338     ELSE
  4339
  4340* EXEC CICS GETMAIN
  4341*            SET (ADDRESS OF CHECK-QUE)
  4342*            LENGTH (WS-ERCHKQ-LENGTH)
  4343*            INITIMG (WS-SPACES) END-EXEC.
  4344*    MOVE ',"IL                  $   #00004215' TO DFHEIV0
  4345     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4346     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4347     MOVE X'2020233030303034323135' TO DFHEIV0(25:11)
  4348     CALL 'kxdfhei1' USING DFHEIV0,
  4349           DFHEIV20,
  4350           WS-ERCHKQ-LENGTH,
  4351           WS-SPACES
  4352     SET ADDRESS OF CHECK-QUE TO
  4353         DFHEIV20
  4354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4355
  4356
  4357     IF AOPTIONI EQUAL '1' OR '2'
  4358         NEXT SENTENCE
  4359     ELSE
  4360         GO TO 0260-END-OF-ERPYAJ.
  4361
  4362*    NOTE *******************************************************
  4363*         *                                                     *
  4364*         *      BROWSE THE PENDING PAYMENTS AND ADJUSTMENTS    *
  4365*         *  FILE FOR PAYMENTS PENDING.                         *
  4366*         *                                                     *
  4367*         *      WHEN A PAYMENT IS PENDING, GENERATE A CHECK    *
  4368*         *  QUEUE RECORD FOR RELEASE.                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  85
* EL686.cbl
  4369*         *                                                     *
  4370*         *******************************************************.
  4371
  4372     MOVE LOW-VALUES             TO  WS-PENDING-PAYMENTS-KEY.
  4373     MOVE PI-COMPANY-CD          TO  WS-PPK-COMPANY-CD.
  4374
  4375 0225-STARTBR-ERPYAJ.
  4376
  4377     IF WS-ERPYAJ-BROWSE-NOT-STARTED
  4378
  4379* EXEC CICS STARTBR
  4380*            DATASET (WS-ERPYAJ-DSID)
  4381*            RIDFLD  (WS-PENDING-PAYMENTS-KEY)
  4382*            GTEQ
  4383*            END-EXEC.
  4384     MOVE 0
  4385       TO DFHEIV11
  4386*    MOVE '&,         G          &   #00004241' TO DFHEIV0
  4387     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4388     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4389     MOVE X'2020233030303034323431' TO DFHEIV0(25:11)
  4390     CALL 'kxdfhei1' USING DFHEIV0,
  4391           WS-ERPYAJ-DSID,
  4392           WS-PENDING-PAYMENTS-KEY,
  4393           DFHEIV99,
  4394           DFHEIV11,
  4395           DFHEIV99
  4396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4397
  4398
  4399     MOVE +1 TO WS-ERPYAJ-BROWSE-SW.
  4400
  4401
  4402* EXEC CICS HANDLE CONDITION
  4403*        ENDFILE    (0260-END-OF-ERPYAJ)
  4404*        END-EXEC.
  4405*    MOVE '"$''                   ! # #00004249' TO DFHEIV0
  4406     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  4407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4408     MOVE X'2320233030303034323439' TO DFHEIV0(25:11)
  4409     CALL 'kxdfhei1' USING DFHEIV0
  4410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4411
  4412
  4413 0250-READNEXT-ERPYAJ.
  4414
  4415
  4416* EXEC CICS READNEXT
  4417*        DATASET (WS-ERPYAJ-DSID)
  4418*        RIDFLD  (WS-PENDING-PAYMENTS-KEY)
  4419*        SET     (ADDRESS OF PENDING-PAY-ADJ) END-EXEC.
  4420     MOVE 0
  4421       TO DFHEIV11
  4422*    MOVE '&.S                   )   #00004255' TO DFHEIV0
  4423     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4424     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4425     MOVE X'2020233030303034323535' TO DFHEIV0(25:11)
  4426     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  86
* EL686.cbl
  4427           WS-ERPYAJ-DSID,
  4428           DFHEIV20,
  4429           DFHEIV99,
  4430           WS-PENDING-PAYMENTS-KEY,
  4431           DFHEIV99,
  4432           DFHEIV11,
  4433           DFHEIV99,
  4434           DFHEIV99
  4435     SET ADDRESS OF PENDING-PAY-ADJ TO
  4436         DFHEIV20
  4437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4438
  4439
  4440     IF WS-PPK-COMPANY-CD EQUAL PI-COMPANY-CD
  4441         NEXT SENTENCE
  4442     ELSE
  4443         IF AOPTIONI EQUAL '1'
  4444             GO TO 0260-END-OF-ERPYAJ
  4445         ELSE
  4446             GO TO 0400-END-OF-SEARCH.
  4447
  4448     IF ACARRL GREATER ZERO
  4449         IF PY-CARRIER NOT = ACARRI
  4450            GO TO 0250-READNEXT-ERPYAJ.
  4451
  4452     IF AGROUPL GREATER ZERO
  4453        IF PY-GROUPING NOT = AGROUPI
  4454            GO TO 0250-READNEXT-ERPYAJ.
  4455
  4456     IF ABYL GREATER ZERO
  4457        IF PY-LAST-MAINT-BY NOT = ABYI
  4458            GO TO 0250-READNEXT-ERPYAJ.
  4459
  4460     IF AAMTL GREATER ZERO
  4461         IF PY-ENTRY-AMT LESS PI-CHECK-AMOUNT
  4462             NEXT SENTENCE
  4463           ELSE
  4464             GO TO 0250-READNEXT-ERPYAJ.
  4465
  4466     IF  PY-CHARGE-TO-AGENT
  4467          IF PY-BILLING-CHECK OR
  4468             PY-GA-CHECK
  4469             NEXT SENTENCE
  4470          ELSE
  4471             GO TO 0250-READNEXT-ERPYAJ
  4472     ELSE
  4473          GO TO 0250-READNEXT-ERPYAJ.
  4474
  4475     IF PY-CHECK-QUE-CONTROL  EQUAL ZEROS AND
  4476        PY-CHECK-QUE-SEQUENCE EQUAL ZEROS
  4477         NEXT SENTENCE
  4478     ELSE
  4479         GO TO 0250-READNEXT-ERPYAJ.
  4480
  4481*    NOTE *******************************************************
  4482*         *                                                     *
  4483*         *      THE PAYMENT TRAILER HAS MET ALL OF THE         *
  4484*         *  QUALIFICATIONS FOR THIS CHECK RELEASE, NOW         *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  87
* EL686.cbl
  4485*         *  GENERATE A CHECK QUEUE RECORD.                     *
  4486*         *                                                     *
  4487*         *******************************************************.
  4488
  4489     ADD +1                      TO  WS-RELEASED-COUNT.
  4490     ADD PY-ENTRY-AMT            TO  WS-RELEASED-AMOUNT.
  4491
  4492     IF EIBAID NOT = DFHPF1
  4493         GO TO 0250-READNEXT-ERPYAJ.
  4494
  4495     IF WS-ERPYAJ-BROWSE-STARTED
  4496
  4497* EXEC CICS ENDBR
  4498*            DATASET (WS-ERPYAJ-DSID)
  4499*            END-EXEC
  4500     MOVE 0
  4501       TO DFHEIV11
  4502*    MOVE '&2                    $   #00004316' TO DFHEIV0
  4503     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4504     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4505     MOVE X'2020233030303034333136' TO DFHEIV0(25:11)
  4506     CALL 'kxdfhei1' USING DFHEIV0,
  4507           WS-ERPYAJ-DSID,
  4508           DFHEIV11,
  4509           DFHEIV99
  4510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4511         MOVE +0 TO WS-ERPYAJ-BROWSE-SW.
  4512
  4513
  4514* EXEC CICS READ UPDATE
  4515*        DATASET (WS-ERPYAJ-DSID)
  4516*        RIDFLD  (WS-PENDING-PAYMENTS-KEY)
  4517*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  4518*    END-EXEC.
  4519*    MOVE '&"S        EU         (   #00004321' TO DFHEIV0
  4520     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4521     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4522     MOVE X'2020233030303034333231' TO DFHEIV0(25:11)
  4523     CALL 'kxdfhei1' USING DFHEIV0,
  4524           WS-ERPYAJ-DSID,
  4525           DFHEIV20,
  4526           DFHEIV99,
  4527           WS-PENDING-PAYMENTS-KEY,
  4528           DFHEIV99,
  4529           DFHEIV99,
  4530           DFHEIV99
  4531     SET ADDRESS OF PENDING-PAY-ADJ TO
  4532         DFHEIV20
  4533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4534
  4535
  4536     MOVE SPACES                 TO  CHECK-QUE.
  4537     MOVE 'CQ'                   TO  CQ-RECORD-ID.
  4538     MOVE PY-COMPANY-CD          TO  CQ-COMPANY-CD.
  4539     MOVE WS-CHECK-QUE-COUNTER   TO  CQ-CONTROL-NUMBER
  4540                                     PY-CHECK-QUE-CONTROL
  4541     MOVE WS-CHECK-COUNTER       TO  CQ-SEQUENCE-NUMBER
  4542                                     PY-CHECK-QUE-SEQUENCE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  88
* EL686.cbl
  4543     ADD +1                      TO  WS-CHECK-COUNTER.
  4544     MOVE 'Q'                    TO  CQ-ENTRY-TYPE.
  4545     MOVE PY-CARRIER             TO  CQ-PYAJ-CARRIER.
  4546     MOVE PY-GROUPING            TO  CQ-PYAJ-GROUPING.
  4547     MOVE PY-FIN-RESP            TO  CQ-PYAJ-FIN-RESP.
  4548     MOVE PY-ACCOUNT             TO  CQ-PYAJ-ACCOUNT.
  4549     MOVE PY-FILE-SEQ-NO         TO  CQ-PYAJ-SEQ.
  4550     MOVE PY-RECORD-TYPE         TO  CQ-PYAJ-REC-TYPE.
  4551     MOVE PY-ENTRY-AMT           TO  CQ-CHECK-AMOUNT.
  4552     MOVE SPACES                 TO  WS-CHECK-NUMBER.
  4553     MOVE PY-CHECK-NUMBER        TO  WS-CHECK-NO.
  4554     MOVE WS-CHECK-NUMBER        TO  CQ-CHECK-NUMBER.
  4555     MOVE '1'                    TO  CQ-PAYMENT-TYPE.
  4556     MOVE ZERO                   TO  CQ-TIMES-PRINTED
  4557                                     CQ-PRINT-AT-HHMM.
  4558     MOVE PI-CURRENT-DATE-BIN    TO  CQ-CHECK-WRITTEN-DT.
  4559     MOVE PY-REPORTED-DT         TO  CQ-CHECK-BY-USER.
  4560     MOVE +6860                  TO  CQ-LAST-UPDATED-BY.
  4561     MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4562     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4563     MOVE WS-ERCHKQ-DSID         TO  JP-FILE-ID.
  4564
  4565
  4566* EXEC CICS WRITE
  4567*        DATASET (WS-ERCHKQ-DSID)
  4568*        FROM    (CHECK-QUE)
  4569*        RIDFLD  (CQ-CONTROL-PRIMARY) END-EXEC.
  4570     MOVE LENGTH OF
  4571      CHECK-QUE
  4572       TO DFHEIV11
  4573*    MOVE '&$ L                  ''   #00004356' TO DFHEIV0
  4574     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4575     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4576     MOVE X'2020233030303034333536' TO DFHEIV0(25:11)
  4577     CALL 'kxdfhei1' USING DFHEIV0,
  4578           WS-ERCHKQ-DSID,
  4579           CHECK-QUE,
  4580           DFHEIV11,
  4581           CQ-CONTROL-PRIMARY,
  4582           DFHEIV99,
  4583           DFHEIV99
  4584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4585
  4586
  4587     PERFORM 8400-LOG-JOURNAL-RECORD.
  4588
  4589     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4590
  4591     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4592     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4593     MOVE WS-ERPYAJ-DSID            TO  JP-FILE-ID.
  4594
  4595
  4596* EXEC CICS REWRITE
  4597*        DATASET (WS-ERPYAJ-DSID)
  4598*        FROM    (PENDING-PAY-ADJ) END-EXEC.
  4599     MOVE LENGTH OF
  4600      PENDING-PAY-ADJ
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  89
* EL686.cbl
  4601       TO DFHEIV11
  4602*    MOVE '&& L                  %   #00004369' TO DFHEIV0
  4603     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4604     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4605     MOVE X'2020233030303034333639' TO DFHEIV0(25:11)
  4606     CALL 'kxdfhei1' USING DFHEIV0,
  4607           WS-ERPYAJ-DSID,
  4608           PENDING-PAY-ADJ,
  4609           DFHEIV11,
  4610           DFHEIV99
  4611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4612
  4613
  4614     PERFORM 8400-LOG-JOURNAL-RECORD.
  4615
  4616     GO TO 0225-STARTBR-ERPYAJ.
  4617
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  90
* EL686.cbl
  4619
  4620 0260-END-OF-ERPYAJ.
  4621
  4622     IF AOPTIONI EQUAL '1' OR '3' OR '4'
  4623         NEXT SENTENCE
  4624     ELSE
  4625         GO TO 0400-END-OF-SEARCH.
  4626
  4627     IF WS-ERPYAJ-BROWSE-STARTED
  4628
  4629* EXEC CICS ENDBR
  4630*            DATASET (WS-ERPYAJ-DSID)
  4631*            END-EXEC
  4632     MOVE 0
  4633       TO DFHEIV11
  4634*    MOVE '&2                    $   #00004387' TO DFHEIV0
  4635     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4636     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4637     MOVE X'2020233030303034333837' TO DFHEIV0(25:11)
  4638     CALL 'kxdfhei1' USING DFHEIV0,
  4639           WS-ERPYAJ-DSID,
  4640           DFHEIV11,
  4641           DFHEIV99
  4642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4643         MOVE +0 TO WS-ERPYAJ-BROWSE-SW.
  4644
  4645*    NOTE *******************************************************
  4646*         *                                                     *
  4647*         *      BROWSE THE CHECK-MAINTENANCE FILE FOR ANY      *
  4648*         *  PENDING PAYMENTS FOR RELEASE                       *
  4649*         *                                                     *
  4650*         *      WHEN A PAYMENT IS PENDING, GENERATE A CHECK    *
  4651*         *  QUEUE RECORD FOR RELEASE.                          *
  4652*         *                                                     *
  4653*         *******************************************************.
  4654
  4655     MOVE LOW-VALUES             TO  WS-CHECK-MAINT-KEY.
  4656     MOVE PI-COMPANY-CD          TO  WS-CHK-COMPANY-CD.
  4657
  4658 0265-STARTBR-ERCHEK.
  4659
  4660     IF WS-ERCHEK-BROWSE-NOT-STARTED
  4661
  4662* EXEC CICS STARTBR
  4663*            DATASET (WS-ERCHEK-DSID)
  4664*            RIDFLD  (WS-CHECK-MAINT-KEY)
  4665*            GTEQ
  4666*            END-EXEC.
  4667     MOVE 0
  4668       TO DFHEIV11
  4669*    MOVE '&,         G          &   #00004408' TO DFHEIV0
  4670     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4671     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4672     MOVE X'2020233030303034343038' TO DFHEIV0(25:11)
  4673     CALL 'kxdfhei1' USING DFHEIV0,
  4674           WS-ERCHEK-DSID,
  4675           WS-CHECK-MAINT-KEY,
  4676           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  91
* EL686.cbl
  4677           DFHEIV11,
  4678           DFHEIV99
  4679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4680
  4681
  4682     MOVE +1 TO WS-ERCHEK-BROWSE-SW.
  4683
  4684
  4685* EXEC CICS HANDLE CONDITION
  4686*        ENDFILE    (0400-END-OF-SEARCH)
  4687*        END-EXEC.
  4688*    MOVE '"$''                   ! $ #00004416' TO DFHEIV0
  4689     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  4690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4691     MOVE X'2420233030303034343136' TO DFHEIV0(25:11)
  4692     CALL 'kxdfhei1' USING DFHEIV0
  4693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4694
  4695
  4696 0270-READNEXT-ERCHEK.
  4697
  4698
  4699* EXEC CICS READNEXT
  4700*        DATASET (WS-ERCHEK-DSID)
  4701*        RIDFLD  (WS-CHECK-MAINT-KEY)
  4702*        SET     (ADDRESS OF CHECK-RECORDS) END-EXEC.
  4703     MOVE 0
  4704       TO DFHEIV11
  4705*    MOVE '&.S                   )   #00004422' TO DFHEIV0
  4706     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4707     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4708     MOVE X'2020233030303034343232' TO DFHEIV0(25:11)
  4709     CALL 'kxdfhei1' USING DFHEIV0,
  4710           WS-ERCHEK-DSID,
  4711           DFHEIV20,
  4712           DFHEIV99,
  4713           WS-CHECK-MAINT-KEY,
  4714           DFHEIV99,
  4715           DFHEIV11,
  4716           DFHEIV99,
  4717           DFHEIV99
  4718     SET ADDRESS OF CHECK-RECORDS TO
  4719         DFHEIV20
  4720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4721
  4722
  4723     IF WS-CHK-COMPANY-CD NOT = PI-COMPANY-CD
  4724         GO TO 0400-END-OF-SEARCH.
  4725
  4726     IF ACARRL GREATER ZERO
  4727         IF CH-CARRIER NOT = ACARRI
  4728             GO TO 0270-READNEXT-ERCHEK.
  4729
  4730     IF AGROUPL GREATER ZERO
  4731        IF CH-GROUPING NOT = AGROUPI
  4732            GO TO 0270-READNEXT-ERCHEK.
  4733
  4734     IF ASTATL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  92
* EL686.cbl
  4735        IF CH-STATE NOT = ASTATI
  4736            GO TO 0270-READNEXT-ERCHEK.
  4737
  4738     IF AACCTL GREATER ZERO
  4739        IF CH-ACCOUNT NOT = AACCTI
  4740            GO TO 0270-READNEXT-ERCHEK.
  4741
  4742     IF ABYL  GREATER ZERO
  4743        IF CH-RECORDED-BY NOT = ABYI
  4744            GO TO 0270-READNEXT-ERCHEK.
  4745
  4746     IF AAMTL GREATER ZERO
  4747        IF CH-AMOUNT-PAID LESS PI-CHECK-AMOUNT
  4748             NEXT SENTENCE
  4749           ELSE
  4750             GO TO 0270-READNEXT-ERCHEK.
  4751
  4752     MOVE ZERO               TO PI-CERT-SW.
  4753
  4754     IF ZERO = CERTO01L AND CERTO02L AND CERTO03L AND
  4755               CERTO04L AND CERTO05L AND CERTO06L AND
  4756               CERTO07L AND CERTO08L AND CERTO09L AND
  4757               CERTO10L AND CERTO11L AND CERTO12L AND
  4758               CERTO13L AND CERTO14L AND CERTO15L
  4759          MOVE +1           TO PI-CERT-SW
  4760       ELSE
  4761     IF CERTO01I       = CH-CERT-NO     AND
  4762        BIN-EFFDT (1)  = CH-CERT-EFF-DT
  4763          MOVE +1           TO PI-CERT-SW
  4764      ELSE
  4765     IF CERTO02I       = CH-CERT-NO     AND
  4766        BIN-EFFDT (2)  = CH-CERT-EFF-DT
  4767          MOVE +1           TO PI-CERT-SW
  4768      ELSE
  4769     IF CERTO03I       = CH-CERT-NO     AND
  4770        BIN-EFFDT (3)  = CH-CERT-EFF-DT
  4771          MOVE +1           TO PI-CERT-SW
  4772      ELSE
  4773     IF CERTO04I       = CH-CERT-NO     AND
  4774        BIN-EFFDT (4)  = CH-CERT-EFF-DT
  4775          MOVE +1           TO PI-CERT-SW
  4776      ELSE
  4777     IF CERTO05I       = CH-CERT-NO     AND
  4778        BIN-EFFDT (5)  = CH-CERT-EFF-DT
  4779          MOVE +1           TO PI-CERT-SW
  4780      ELSE
  4781     IF CERTO06I       = CH-CERT-NO     AND
  4782        BIN-EFFDT (6)  = CH-CERT-EFF-DT
  4783          MOVE +1           TO PI-CERT-SW
  4784      ELSE
  4785     IF CERTO07I       = CH-CERT-NO     AND
  4786        BIN-EFFDT (7)  = CH-CERT-EFF-DT
  4787          MOVE +1           TO PI-CERT-SW
  4788      ELSE
  4789     IF CERTO08I       = CH-CERT-NO     AND
  4790        BIN-EFFDT (8)  = CH-CERT-EFF-DT
  4791          MOVE +1           TO PI-CERT-SW
  4792      ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  93
* EL686.cbl
  4793     IF CERTO09I       = CH-CERT-NO     AND
  4794        BIN-EFFDT (9)  = CH-CERT-EFF-DT
  4795          MOVE +1           TO PI-CERT-SW
  4796      ELSE
  4797     IF CERTO10I       = CH-CERT-NO     AND
  4798        BIN-EFFDT (10) = CH-CERT-EFF-DT
  4799          MOVE +1           TO PI-CERT-SW
  4800      ELSE
  4801     IF CERTO11I       = CH-CERT-NO     AND
  4802        BIN-EFFDT (11) = CH-CERT-EFF-DT
  4803          MOVE +1           TO PI-CERT-SW
  4804      ELSE
  4805     IF CERTO12I       = CH-CERT-NO     AND
  4806        BIN-EFFDT (12) = CH-CERT-EFF-DT
  4807          MOVE +1           TO PI-CERT-SW
  4808      ELSE
  4809     IF CERTO13I       = CH-CERT-NO     AND
  4810        BIN-EFFDT (13) = CH-CERT-EFF-DT
  4811          MOVE +1           TO PI-CERT-SW
  4812      ELSE
  4813     IF CERTO14I       = CH-CERT-NO     AND
  4814        BIN-EFFDT (14) = CH-CERT-EFF-DT
  4815          MOVE +1           TO PI-CERT-SW
  4816      ELSE
  4817     IF CERTO15I       = CH-CERT-NO     AND
  4818        BIN-EFFDT (15) = CH-CERT-EFF-DT
  4819          MOVE +1           TO PI-CERT-SW.
  4820
  4821     IF PI-CERT-NOT-MATCHED
  4822         GO TO 0270-READNEXT-ERCHEK.
  4823
  4824     IF CH-MAINT-CHECK
  4825         IF AOPTIONI EQUAL '1' OR '4'
  4826             NEXT SENTENCE
  4827         ELSE
  4828             GO TO 0270-READNEXT-ERCHEK.
  4829
  4830     IF CH-REFUND-CHECK
  4831         IF AOPTIONI EQUAL '1' OR '3'
  4832             NEXT SENTENCE
  4833         ELSE
  4834             GO TO 0270-READNEXT-ERCHEK.
  4835
  4836     IF CH-CHECK-QUE-CONTROL  EQUAL ZEROS AND
  4837        CH-CHECK-QUE-SEQUENCE EQUAL ZEROS
  4838         NEXT SENTENCE
  4839     ELSE
  4840         GO TO 0270-READNEXT-ERCHEK.
  4841
  4842*    NOTE *******************************************************
  4843*         *                                                     *
  4844*         *      THE CHECK MAINT TRAILER HAS MET ALL OF THE     *
  4845*         *  QUALIFICATIONS FOR THIS CHECK RELEASE, NOW         *
  4846*         *  GENERATE A CHECK QUEUE RECORD.                     *
  4847*         *                                                     *
  4848*         *******************************************************.
  4849
  4850     IF CH-VOID-DT = LOW-VALUES  AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  94
* EL686.cbl
  4851       NOT MANUAL-CHECK-WRITTEN
  4852         ADD +1                  TO  WS-RELEASED-COUNT
  4853         ADD CH-AMOUNT-PAID      TO  WS-RELEASED-AMOUNT.
  4854
  4855     IF EIBAID NOT = DFHPF1
  4856         GO TO 0270-READNEXT-ERCHEK.
  4857
  4858     IF WS-ERCHEK-BROWSE-STARTED
  4859
  4860* EXEC CICS ENDBR
  4861*            DATASET (WS-ERCHEK-DSID)
  4862*            END-EXEC
  4863     MOVE 0
  4864       TO DFHEIV11
  4865*    MOVE '&2                    $   #00004563' TO DFHEIV0
  4866     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4867     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4868     MOVE X'2020233030303034353633' TO DFHEIV0(25:11)
  4869     CALL 'kxdfhei1' USING DFHEIV0,
  4870           WS-ERCHEK-DSID,
  4871           DFHEIV11,
  4872           DFHEIV99
  4873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4874         MOVE +0 TO WS-ERCHEK-BROWSE-SW.
  4875
  4876
  4877* EXEC CICS READ UPDATE
  4878*        DATASET (WS-ERCHEK-DSID)
  4879*        RIDFLD  (WS-CHECK-MAINT-KEY)
  4880*        SET     (ADDRESS OF CHECK-RECORDS) END-EXEC.
  4881*    MOVE '&"S        EU         (   #00004568' TO DFHEIV0
  4882     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4883     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4884     MOVE X'2020233030303034353638' TO DFHEIV0(25:11)
  4885     CALL 'kxdfhei1' USING DFHEIV0,
  4886           WS-ERCHEK-DSID,
  4887           DFHEIV20,
  4888           DFHEIV99,
  4889           WS-CHECK-MAINT-KEY,
  4890           DFHEIV99,
  4891           DFHEIV99,
  4892           DFHEIV99
  4893     SET ADDRESS OF CHECK-RECORDS TO
  4894         DFHEIV20
  4895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4896
  4897
  4898     MOVE SPACES                 TO  CHECK-QUE.
  4899     MOVE 'CQ'                   TO  CQ-RECORD-ID.
  4900     MOVE CH-COMPANY-CD          TO  CQ-COMPANY-CD.
  4901     MOVE WS-CHECK-QUE-COUNTER   TO  CQ-CONTROL-NUMBER
  4902                                     CH-CHECK-QUE-CONTROL.
  4903     MOVE WS-CHECK-COUNTER       TO  CQ-SEQUENCE-NUMBER
  4904                                     CH-CHECK-QUE-SEQUENCE.
  4905     ADD +1                      TO  WS-CHECK-COUNTER.
  4906     MOVE 'Q'                    TO  CQ-ENTRY-TYPE.
  4907     MOVE ZERO                   TO  CQ-TIMES-PRINTED
  4908                                     CQ-PRINT-AT-HHMM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  95
* EL686.cbl
  4909     MOVE PI-CURRENT-DATE-BIN    TO  CQ-CHECK-WRITTEN-DT.
  4910     IF MANUAL-CHECK-WRITTEN
  4911         MOVE 'M'                TO  CQ-ENTRY-TYPE
  4912         MOVE +1                 TO  CQ-TIMES-PRINTED
  4913         MOVE CH-CHECK-NO        TO  CQ-CHECK-NUMBER
  4914         MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  4915     MOVE LOW-VALUES             TO  CQ-CHECK-VOIDED-DT.
  4916     IF CH-VOID-DT NOT = LOW-VALUES
  4917         MOVE 'V'                TO  CQ-ENTRY-TYPE
  4918                                     CQ-VOID-INDICATOR
  4919         MOVE CH-VOID-DT         TO  CQ-CHECK-VOIDED-DT.
  4920     MOVE CH-CARRIER             TO  CQ-CHEK-CARRIER.
  4921     MOVE CH-GROUPING            TO  CQ-CHEK-GROUPING.
  4922     MOVE CH-STATE               TO  CQ-CHEK-STATE.
  4923     MOVE CH-ACCOUNT             TO  CQ-CHEK-ACCOUNT.
  4924     MOVE CH-SEQUENCE-NO         TO  CQ-CHEK-SEQ-NO.
  4925     MOVE CH-CERT-EFF-DT         TO  CQ-CHEK-CERT-EFF-DT.
  4926     MOVE CH-CERT-NO             TO  CQ-CHEK-CERT-NO.
  4927     MOVE CH-COMP-FIN-RESP       TO  CQ-CHEK-FIN-RESP.
  4928     MOVE CH-CHECK-NO            TO  CQ-CHECK-NUMBER.
  4929
  4930     IF CH-REFUND-CHECK
  4931         MOVE '2'                TO  CQ-PAYMENT-TYPE
  4932     ELSE
  4933         MOVE '3'                TO  CQ-PAYMENT-TYPE.
  4934
  4935     MOVE CH-AMOUNT-PAID         TO  CQ-CHECK-AMOUNT.
  4936     MOVE CH-RECORDED-BY         TO  CQ-CHECK-BY-USER.
  4937     MOVE +6860                  TO  CQ-LAST-UPDATED-BY.
  4938     MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4939     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4940     MOVE WS-ERCHKQ-DSID         TO  JP-FILE-ID.
  4941
  4942
  4943* EXEC CICS WRITE
  4944*        DATASET (WS-ERCHKQ-DSID)
  4945*        FROM    (CHECK-QUE)
  4946*        RIDFLD  (CQ-CONTROL-PRIMARY) END-EXEC.
  4947     MOVE LENGTH OF
  4948      CHECK-QUE
  4949       TO DFHEIV11
  4950*    MOVE '&$ L                  ''   #00004617' TO DFHEIV0
  4951     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4952     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4953     MOVE X'2020233030303034363137' TO DFHEIV0(25:11)
  4954     CALL 'kxdfhei1' USING DFHEIV0,
  4955           WS-ERCHKQ-DSID,
  4956           CHECK-QUE,
  4957           DFHEIV11,
  4958           CQ-CONTROL-PRIMARY,
  4959           DFHEIV99,
  4960           DFHEIV99
  4961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4962
  4963
  4964     PERFORM 8400-LOG-JOURNAL-RECORD.
  4965
  4966     MOVE CHECK-RECORDS          TO  JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  96
* EL686.cbl
  4967     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4968     MOVE WS-ERCHEK-DSID         TO  JP-FILE-ID.
  4969
  4970
  4971* EXEC CICS REWRITE
  4972*        DATASET (WS-ERCHEK-DSID)
  4973*        FROM    (CHECK-RECORDS) END-EXEC.
  4974     MOVE LENGTH OF
  4975      CHECK-RECORDS
  4976       TO DFHEIV11
  4977*    MOVE '&& L                  %   #00004628' TO DFHEIV0
  4978     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4979     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4980     MOVE X'2020233030303034363238' TO DFHEIV0(25:11)
  4981     CALL 'kxdfhei1' USING DFHEIV0,
  4982           WS-ERCHEK-DSID,
  4983           CHECK-RECORDS,
  4984           DFHEIV11,
  4985           DFHEIV99
  4986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4987
  4988
  4989     PERFORM 8400-LOG-JOURNAL-RECORD.
  4990
  4991     GO TO 0265-STARTBR-ERCHEK.
  4992
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  97
* EL686.cbl
  4994
  4995 0280-OPTION-5.
  4996
  4997     IF PI-PROCESSOR-ID  =  'LGXX'
  4998         GO TO 0281-CONTINUE.
  4999
  5000
  5001* EXEC CICS READQ TS
  5002*        QUEUE  (QID)
  5003*        INTO   (SECURITY-CONTROL)
  5004*        LENGTH (SC-COMM-LENGTH)
  5005*        ITEM   (SC-ITEM)
  5006*    END-EXEC.
  5007*    MOVE '*$II   L              ''   #00004643' TO DFHEIV0
  5008     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5010     MOVE X'2020233030303034363433' TO DFHEIV0(25:11)
  5011     CALL 'kxdfhei1' USING DFHEIV0,
  5012           QID,
  5013           SECURITY-CONTROL,
  5014           SC-COMM-LENGTH,
  5015           SC-ITEM,
  5016           DFHEIV99,
  5017           DFHEIV99
  5018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5019
  5020
  5021     MOVE SC-CREDIT-DISPLAY (7)  TO PI-DISPLAY-CAP.
  5022     MOVE SC-CREDIT-UPDATE  (7)  TO PI-MODIFY-CAP.
  5023
  5024     IF NOT MODIFY-CAP
  5025         MOVE 'READ'             TO  SM-READ
  5026         PERFORM 9995-SECURITY-VIOLATION
  5027         MOVE ER-0070            TO EMI-ERROR
  5028         PERFORM 9900-ERROR-FORMAT
  5029         GO TO 8100-SEND-INITIAL-MAP.
  5030
  5031 0281-CONTINUE.
  5032     MOVE LOW-VALUES             TO  WS-COMCK-MAINT-KEY.
  5033     MOVE PI-COMPANY-CD          TO  WS-CMK-COMPANY-CD.
  5034
  5035 0285-STARTBR-ERCMCK.
  5036
  5037
  5038* EXEC CICS STARTBR
  5039*        DATASET (WS-ERCMCK-DSID)
  5040*        RIDFLD  (WS-COMCK-MAINT-KEY)
  5041*        GTEQ
  5042*    END-EXEC.
  5043     MOVE 0
  5044       TO DFHEIV11
  5045*    MOVE '&,         G          &   #00004666' TO DFHEIV0
  5046     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5047     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5048     MOVE X'2020233030303034363636' TO DFHEIV0(25:11)
  5049     CALL 'kxdfhei1' USING DFHEIV0,
  5050           WS-ERCMCK-DSID,
  5051           WS-COMCK-MAINT-KEY,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  98
* EL686.cbl
  5052           DFHEIV99,
  5053           DFHEIV11,
  5054           DFHEIV99
  5055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5056
  5057
  5058     MOVE +1  TO  WS-ERCMCK-BROWSE-SW.
  5059
  5060
  5061* EXEC CICS HANDLE CONDITION
  5062*        ENDFILE    (0400-END-OF-SEARCH)
  5063*        END-EXEC.
  5064*    MOVE '"$''                   ! % #00004674' TO DFHEIV0
  5065     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  5066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5067     MOVE X'2520233030303034363734' TO DFHEIV0(25:11)
  5068     CALL 'kxdfhei1' USING DFHEIV0
  5069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5070
  5071
  5072 0290-READNEXT-ERCMCK.
  5073
  5074
  5075* EXEC CICS READNEXT
  5076*        DATASET (WS-ERCMCK-DSID)
  5077*        RIDFLD  (WS-COMCK-MAINT-KEY)
  5078*        SET     (ADDRESS OF COMM-CHECK-RECORDS) END-EXEC.
  5079     MOVE 0
  5080       TO DFHEIV11
  5081*    MOVE '&.S                   )   #00004680' TO DFHEIV0
  5082     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5083     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5084     MOVE X'2020233030303034363830' TO DFHEIV0(25:11)
  5085     CALL 'kxdfhei1' USING DFHEIV0,
  5086           WS-ERCMCK-DSID,
  5087           DFHEIV20,
  5088           DFHEIV99,
  5089           WS-COMCK-MAINT-KEY,
  5090           DFHEIV99,
  5091           DFHEIV11,
  5092           DFHEIV99,
  5093           DFHEIV99
  5094     SET ADDRESS OF COMM-CHECK-RECORDS TO
  5095         DFHEIV20
  5096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5097
  5098
  5099     IF WS-CMK-COMPANY-CD NOT = PI-COMPANY-CD
  5100         GO TO 0400-END-OF-SEARCH.
  5101
  5102     IF ACARRL GREATER ZERO
  5103         IF CK-CARRIER NOT = ACARRI
  5104             GO TO 0290-READNEXT-ERCMCK.
  5105
  5106     IF AGROUPL GREATER ZERO
  5107         IF CK-GROUPING NOT = AGROUPI
  5108             GO TO 0290-READNEXT-ERCMCK.
  5109
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  99
* EL686.cbl
  5110     IF ABYL GREATER ZERO
  5111         IF CK-RECORDED-BY NOT = ABYI
  5112             GO TO 0290-READNEXT-ERCMCK.
  5113
  5114     IF AAMTL GREATER ZERO
  5115         IF CK-AMOUNT-PAID LESS PI-CHECK-AMOUNT
  5116             NEXT SENTENCE
  5117           ELSE
  5118             GO TO 0290-READNEXT-ERCMCK.
  5119
  5120     IF CK-VOID-DT NOT = LOW-VALUES
  5121         GO TO 0290-READNEXT-ERCMCK.
  5122
  5123     IF CK-QUE-CONTROL-NUMBER  EQUAL ZEROS AND
  5124        CK-QUE-SEQ-NO          EQUAL ZEROS
  5125            NEXT SENTENCE
  5126     ELSE
  5127         GO TO 0290-READNEXT-ERCMCK.
  5128
  5129*    NOTE *******************************************************
  5130*         *                                                     *
  5131*         *      THE CHECK MAINT TRAILER HAS MET ALL OF THE     *
  5132*         *  QUALIFICATIONS FOR THIS CHECK RELEASE, NOW         *
  5133*         *  GENERATE A CHECK QUEUE RECORD.                     *
  5134*         *                                                     *
  5135*         *******************************************************.
  5136
  5137     IF AOPTIONI  IS EQUAL TO '6'
  5138        IF CK-ACH-PAYMENT IS EQUAL TO 'P'
  5139           CONTINUE
  5140        ELSE
  5141           GO TO 0290-READNEXT-ERCMCK.
  5142
  5143     IF AOPTIONI  IS EQUAL TO '5'
  5144        IF CK-ACH-PAYMENT IS EQUAL TO 'P'
  5145           GO TO 0290-READNEXT-ERCMCK
  5146        ELSE
  5147           CONTINUE.
  5148
  5149     IF NOT CK-TEXT
  5150         ADD +1                  TO  WS-RELEASED-COUNT.
  5151     ADD CK-AMOUNT-PAID          TO  WS-RELEASED-AMOUNT.
  5152
  5153     IF EIBAID NOT = DFHPF1
  5154         GO TO 0290-READNEXT-ERCMCK.
  5155
  5156
  5157* EXEC CICS ENDBR
  5158*        DATASET (WS-ERCMCK-DSID)
  5159*        END-EXEC.
  5160     MOVE 0
  5161       TO DFHEIV11
  5162*    MOVE '&2                    $   #00004742' TO DFHEIV0
  5163     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5164     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5165     MOVE X'2020233030303034373432' TO DFHEIV0(25:11)
  5166     CALL 'kxdfhei1' USING DFHEIV0,
  5167           WS-ERCMCK-DSID,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 100
* EL686.cbl
  5168           DFHEIV11,
  5169           DFHEIV99
  5170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5171
  5172
  5173     MOVE +0  TO  WS-ERCMCK-BROWSE-SW.
  5174
  5175
  5176* EXEC CICS READ UPDATE
  5177*        DATASET (WS-ERCMCK-DSID)
  5178*        RIDFLD  (WS-COMCK-MAINT-KEY)
  5179*        SET     (ADDRESS OF COMM-CHECK-RECORDS) END-EXEC.
  5180*    MOVE '&"S        EU         (   #00004748' TO DFHEIV0
  5181     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5182     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5183     MOVE X'2020233030303034373438' TO DFHEIV0(25:11)
  5184     CALL 'kxdfhei1' USING DFHEIV0,
  5185           WS-ERCMCK-DSID,
  5186           DFHEIV20,
  5187           DFHEIV99,
  5188           WS-COMCK-MAINT-KEY,
  5189           DFHEIV99,
  5190           DFHEIV99,
  5191           DFHEIV99
  5192     SET ADDRESS OF COMM-CHECK-RECORDS TO
  5193         DFHEIV20
  5194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5195
  5196
  5197     MOVE SPACES                 TO  COMMISSION-CHECK-QUE.
  5198     MOVE 'MQ'                   TO  MQ-RECORD-ID.
  5199     MOVE CK-COMPANY-CD          TO  MQ-COMPANY-CD
  5200                                     MQ-COMPANY-CD-A1.
  5201     MOVE WS-CHECK-QUE-COUNTER   TO  MQ-CONTROL-NUMBER
  5202                                     CK-QUE-CONTROL-NUMBER
  5203                                     MQ-CONTROL-NUMBER-A1.
  5204     MOVE WS-CHECK-COUNTER       TO  MQ-SEQUENCE-NUMBER
  5205                                     CK-QUE-SEQ-NO
  5206                                     MQ-SEQUENCE-NUMBER-A1.
  5207     ADD +1                      TO  WS-CHECK-COUNTER.
  5208
  5209     IF AOPTIONI  IS EQUAL TO '6'
  5210        MOVE CK-ACH-PAYMENT      TO  MQ-ENTRY-TYPE
  5211     ELSE
  5212        MOVE 'Q'                 TO  MQ-ENTRY-TYPE.
  5213
  5214     MOVE CK-CSR                 TO  MQ-CHEK-CSR
  5215                                     MQ-CSR-A1.
  5216     MOVE CK-CARRIER             TO  MQ-CHEK-CARRIER
  5217                                     MQ-CARRIER-A1.
  5218     MOVE CK-GROUPING            TO  MQ-CHEK-GROUPING
  5219                                     MQ-GROUPING-A1.
  5220     MOVE CK-PAYEE               TO  MQ-CHEK-PAYEE
  5221                                     MQ-PAYEE-A1.
  5222     MOVE CK-PAYEE-SEQ           TO  MQ-CHEK-PAYEE-SEQ
  5223                                     MQ-PAYEE-SEQ-A1.
  5224     MOVE CK-SEQUENCE-NO         TO  MQ-CHEK-SEQ-NO.
  5225     MOVE CK-CHECK-NO            TO  MQ-CHECK-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 101
* EL686.cbl
  5226     MOVE CK-RECORD-TYPE         TO  MQ-RECORD-TYPE.
  5227     MOVE CK-PAYEE-INFO          TO  MQ-PAYEE-INFO.
  5228     MOVE ZERO                   TO  MQ-TIMES-PRINTED
  5229                                     MQ-PRINT-AT-HHMM.
  5230     MOVE CK-AMOUNT-PAID         TO  MQ-CHECK-AMOUNT.
  5231     MOVE PI-CURRENT-DATE-BIN    TO  MQ-CHECK-RELEASE-DT.
  5232     MOVE CK-RECORDED-BY         TO  MQ-CHECK-BY-USER.
  5233     MOVE EIBTIME                TO  MQ-LAST-MAINT-HHMMSS.
  5234     MOVE PI-CURRENT-DATE-BIN    TO  MQ-LAST-MAINT-DT.
  5235     MOVE 'E686'                 TO  MQ-LAST-MAINT-BY.
  5236     MOVE CK-AR-STATEMENT-DT     TO  MQ-AR-STATEMENT-DT.
  5237     MOVE LOW-VALUES             TO  MQ-CHECK-WRITTEN-DT
  5238                                     MQ-VOID-DT.
  5239     MOVE COMMISSION-CHECK-QUE   TO  JP-RECORD-AREA.
  5240     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5241     MOVE WS-ERCMKQ-DSID         TO  JP-FILE-ID.
  5242     MOVE +1                     TO  WS-NDX.
  5243
  5244 0290-LOOP.
  5245
  5246     IF WS-NDX GREATER THAN 15
  5247         GO TO 0300-LOOP-EXIT.
  5248
  5249     IF CK-TEXT
  5250         MOVE CK-STUB-TEXT (WS-NDX)  TO   MQ-STUB-TEXT (WS-NDX)
  5251         ADD  +1                     TO   WS-NDX
  5252         GO TO 0290-LOOP.
  5253
  5254     IF CK-STUB-LINE (WS-NDX) = SPACES
  5255         MOVE SPACES TO MQ-CHECK-STUB-LINE (WS-NDX)
  5256         MOVE ZEROS TO MQ-PYAJ-AMT (WS-NDX)
  5257                       MQ-PYAJ-SEQ (WS-NDX)
  5258         ADD +1     TO WS-NDX
  5259         GO TO 0290-LOOP.
  5260
  5261     MOVE CK-STUB-COMMENT (WS-NDX)    TO
  5262                    MQ-STUB-COMMENT  (WS-NDX).
  5263     MOVE CK-ACCT-AGENT (WS-NDX)      TO
  5264                    MQ-ACCT-AGENT  (WS-NDX).
  5265     MOVE CK-INVOICE (WS-NDX)    TO   MQ-INVOICE (WS-NDX).
  5266     MOVE CK-REFERENCE (WS-NDX)  TO   MQ-REFERENCE (WS-NDX).
  5267     MOVE CK-LEDGER-NO (WS-NDX)  TO   MQ-LEDGER-NO (WS-NDX).
  5268     MOVE ZEROS                  TO   MQ-PYAJ-AMT (WS-NDX).
  5269     IF CK-DETAIL-AMT (WS-NDX) NUMERIC
  5270         MOVE CK-DETAIL-AMT (WS-NDX)
  5271                                 TO   MQ-PYAJ-AMT (WS-NDX).
  5272     MOVE CK-PAYMENT-TYPE (WS-NDX)
  5273                                 TO   MQ-PAYMENT-TYPE (WS-NDX).
  5274     MOVE CK-PAYMENT-TYPE (WS-NDX)
  5275                                 TO   MQ-PYAJ-REC-TYPE (WS-NDX).
  5276     MOVE CK-LAST-MAINT-APPLIED (WS-NDX)
  5277                            TO   MQ-LAST-MAINT-APPLIED (WS-NDX).
  5278
  5279     MOVE CK-NON-AR-ITEM (WS-NDX) TO  MQ-NON-AR-ITEM (WS-NDX).
  5280
  5281     MOVE 'C'                    TO   MQ-PYAJ-REC-TYPE (WS-NDX).
  5282
  5283     MOVE CK-PYAJ-PMT-APPLIED (WS-NDX)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 102
* EL686.cbl
  5284                                 TO   MQ-PYAJ-PMT-APPLIED (WS-NDX)
  5285     MOVE WS-SEQ-NO              TO   MQ-PYAJ-SEQ (WS-NDX).
  5286     ADD  +1                     TO   WS-SEQ-NO
  5287                                      WS-NDX.
  5288
  5289     GO TO 0290-LOOP.
  5290
  5291 0300-LOOP-EXIT.
  5292
  5293
  5294* EXEC CICS WRITE
  5295*        DATASET (WS-ERCMKQ-DSID)
  5296*        FROM    (COMMISSION-CHECK-QUE)
  5297*        RIDFLD  (MQ-CONTROL-PRIMARY) END-EXEC.
  5298     MOVE LENGTH OF
  5299      COMMISSION-CHECK-QUE
  5300       TO DFHEIV11
  5301*    MOVE '&$ L                  ''   #00004849' TO DFHEIV0
  5302     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5303     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5304     MOVE X'2020233030303034383439' TO DFHEIV0(25:11)
  5305     CALL 'kxdfhei1' USING DFHEIV0,
  5306           WS-ERCMKQ-DSID,
  5307           COMMISSION-CHECK-QUE,
  5308           DFHEIV11,
  5309           MQ-CONTROL-PRIMARY,
  5310           DFHEIV99,
  5311           DFHEIV99
  5312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5313
  5314
  5315     PERFORM 8400-LOG-JOURNAL-RECORD.
  5316
  5317     MOVE COMM-CHECK-RECORDS        TO  JP-RECORD-AREA.
  5318     MOVE 'C'                       TO  JP-RECORD-TYPE.
  5319     MOVE WS-ERCMCK-DSID            TO  JP-FILE-ID.
  5320
  5321
  5322* EXEC CICS REWRITE
  5323*        DATASET (WS-ERCMCK-DSID)
  5324*        FROM    (COMM-CHECK-RECORDS) END-EXEC.
  5325     MOVE LENGTH OF
  5326      COMM-CHECK-RECORDS
  5327       TO DFHEIV11
  5328*    MOVE '&& L                  %   #00004860' TO DFHEIV0
  5329     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5330     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5331     MOVE X'2020233030303034383630' TO DFHEIV0(25:11)
  5332     CALL 'kxdfhei1' USING DFHEIV0,
  5333           WS-ERCMCK-DSID,
  5334           COMM-CHECK-RECORDS,
  5335           DFHEIV11,
  5336           DFHEIV99
  5337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5338
  5339
  5340     PERFORM 8400-LOG-JOURNAL-RECORD.
  5341
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 103
* EL686.cbl
  5342     GO TO 0285-STARTBR-ERCMCK.
  5343
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 104
* EL686.cbl
  5345 0400-END-OF-SEARCH.
  5346
  5347     IF WS-ERPYAJ-BROWSE-STARTED
  5348
  5349* EXEC CICS ENDBR
  5350*            DATASET (WS-ERPYAJ-DSID)
  5351*            END-EXEC.
  5352     MOVE 0
  5353       TO DFHEIV11
  5354*    MOVE '&2                    $   #00004872' TO DFHEIV0
  5355     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5356     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5357     MOVE X'2020233030303034383732' TO DFHEIV0(25:11)
  5358     CALL 'kxdfhei1' USING DFHEIV0,
  5359           WS-ERPYAJ-DSID,
  5360           DFHEIV11,
  5361           DFHEIV99
  5362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5363
  5364
  5365     IF WS-ERCHEK-BROWSE-STARTED
  5366
  5367* EXEC CICS ENDBR
  5368*            DATASET (WS-ERCHEK-DSID)
  5369*            END-EXEC.
  5370     MOVE 0
  5371       TO DFHEIV11
  5372*    MOVE '&2                    $   #00004877' TO DFHEIV0
  5373     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5375     MOVE X'2020233030303034383737' TO DFHEIV0(25:11)
  5376     CALL 'kxdfhei1' USING DFHEIV0,
  5377           WS-ERCHEK-DSID,
  5378           DFHEIV11,
  5379           DFHEIV99
  5380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5381
  5382
  5383     IF WS-ERCMCK-BROWSE-STARTED
  5384
  5385* EXEC CICS ENDBR
  5386*            DATASET (WS-ERCMCK-DSID)
  5387*            END-EXEC.
  5388     MOVE 0
  5389       TO DFHEIV11
  5390*    MOVE '&2                    $   #00004882' TO DFHEIV0
  5391     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5392     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5393     MOVE X'2020233030303034383832' TO DFHEIV0(25:11)
  5394     CALL 'kxdfhei1' USING DFHEIV0,
  5395           WS-ERCMCK-DSID,
  5396           DFHEIV11,
  5397           DFHEIV99
  5398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5399
  5400
  5401     MOVE WS-CHECK-QUE-COUNTER   TO  WS-TL1-CONTROL-GROUP.
  5402     MOVE WS-RELEASED-COUNT      TO  WS-TL1-COUNT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 105
* EL686.cbl
  5403     MOVE WS-RELEASED-AMOUNT     TO  WS-TL1-AMOUNT.
  5404
  5405     IF WS-RELEASED-COUNT GREATER 1
  5406         MOVE 'S'                TO  WS-TL1-PLURAL
  5407      ELSE
  5408         MOVE ' '                TO  WS-TL1-PLURAL.
  5409
  5410     IF EIBAID = DFHPF1
  5411         MOVE LOW-VALUES         TO EL686AI
  5412         MOVE 'RELEASED'         TO WS-TL1-RELEASE
  5413       ELSE
  5414        IF WS-RELEASED-COUNT GREATER ZERO
  5415            MOVE 'TO BE RELEASED'   TO WS-TL1-RELEASE
  5416          ELSE
  5417            MOVE +0                 TO PI-PROC-SW
  5418            MOVE -1                 TO AOPTIONL
  5419            MOVE ER-3048            TO EMI-ERROR
  5420            PERFORM 8200-SEND-DATAONLY.
  5421
  5422     MOVE WS-TOTAL-LINE1         TO  EMI-MESSAGE-AREA (1).
  5423     MOVE WS-TOTAL-LINE2         TO  EMI-MESSAGE-AREA (2).
  5424
  5425     IF EIBAID = DFHPF1
  5426         PERFORM 7000-PRINT-CHECKS-WAITING
  5427         GO TO 0100-INITIALIZE
  5428       ELSE
  5429         MOVE +1                 TO PI-PROC-SW
  5430         MOVE -1                 TO AOPTIONL
  5431         MOVE AL-UNBON           TO AOPTIONA
  5432                                    AAMTA
  5433         MOVE AL-UABON  TO ABYA ACARRA AGROUPA ASTATA AACCTA
  5434                           CERTO01A EFFDT01A CERTO02A EFFDT02A
  5435                           CERTO03A EFFDT03A CERTO04A EFFDT04A
  5436                           CERTO05A EFFDT05A CERTO06A EFFDT06A
  5437                           CERTO07A EFFDT07A CERTO08A EFFDT08A
  5438                           CERTO09A EFFDT09A CERTO10A EFFDT10A
  5439                           CERTO11A EFFDT11A CERTO12A EFFDT12A
  5440                           CERTO13A EFFDT13A CERTO14A EFFDT14A
  5441                           CERTO15A EFFDT15A
  5442         PERFORM 8200-SEND-DATAONLY.
  5443
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 106
* EL686.cbl
  5445 0910-ENQ-BUSY.
  5446
  5447*    NOTE *******************************************************
  5448*         *                                                     *
  5449*         *      IF ONE OF THE OTHER PROGRAMS (EL176 OR EL177)  *
  5450*         *  HAS EXCLUSIVE CONTROL OF THE CHECK QUEUE DSID,     *
  5451*         *  SEND A MESSAGE TO THE OPERATOR TO WAIT A FEW       *
  5452*         *  MOMENTS AND TRY AGAIN.                             *
  5453*         *                                                     *
  5454*         *******************************************************.
  5455
  5456     MOVE +395                   TO  EMI-ERROR.
  5457     MOVE -1                     TO  AOPTIONL.
  5458     PERFORM 8200-SEND-DATAONLY.
  5459
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 107
* EL686.cbl
  5461 7000-PRINT-CHECKS-WAITING SECTION.
  5462
  5463     MOVE SPACES                 TO  WS-CONTROL-FILE-KEY.
  5464
  5465     MOVE PI-COMPANY-ID          TO WS-CFK-COMPANY-ID.
  5466     MOVE '1'                    TO WS-CFK-RECORD-TYPE.
  5467     MOVE ZEROS                  TO WS-CFK-SEQUENCE-NO.
  5468
  5469
  5470* EXEC CICS READ
  5471*         DATASET   (WS-ELCNTL-DSID)
  5472*         SET       (ADDRESS OF CONTROL-FILE)
  5473*         RIDFLD    (WS-CONTROL-FILE-KEY) END-EXEC.
  5474*    MOVE '&"S        E          (   #00004954' TO DFHEIV0
  5475     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5476     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5477     MOVE X'2020233030303034393534' TO DFHEIV0(25:11)
  5478     CALL 'kxdfhei1' USING DFHEIV0,
  5479           WS-ELCNTL-DSID,
  5480           DFHEIV20,
  5481           DFHEIV99,
  5482           WS-CONTROL-FILE-KEY,
  5483           DFHEIV99,
  5484           DFHEIV99,
  5485           DFHEIV99
  5486     SET ADDRESS OF CONTROL-FILE TO
  5487         DFHEIV20
  5488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5489
  5490
  5491     IF PI-COMPANY-ID = 'DMD' OR 'CID'
  5492         MOVE CF-FORMS-PRINTER-ID  TO  PI-PROCESSOR-PRINTER
  5493*        MOVE EIBTRMID       TO CF-FORMS-PRINTER-ID
  5494
  5495* EXEC CICS START
  5496*             TRANSID    (WS-PRINT-TRANS-ID)
  5497*             FROM       (PROGRAM-INTERFACE-BLOCK)
  5498*             LENGTH     (PI-COMM-LENGTH)
  5499*             TERMID     (CF-FORMS-PRINTER-ID)
  5500*        END-EXEC
  5501*    MOVE '0( LF                 0   #00004962' TO DFHEIV0
  5502     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5503     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  5504     MOVE X'2020233030303034393632' TO DFHEIV0(25:11)
  5505     CALL 'kxdfhei1' USING DFHEIV0,
  5506           DFHEIV99,
  5507           WS-PRINT-TRANS-ID,
  5508           DFHEIV99,
  5509           PROGRAM-INTERFACE-BLOCK,
  5510           PI-COMM-LENGTH,
  5511           DFHEIV99,
  5512           DFHEIV99,
  5513           DFHEIV99,
  5514           DFHEIV99,
  5515           DFHEIV99,
  5516           DFHEIV99,
  5517           DFHEIV99,
  5518           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 108
* EL686.cbl
  5519           DFHEIV99,
  5520           DFHEIV99
  5521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5522     ELSE
  5523
  5524* EXEC CICS START
  5525*             TRANSID    (WS-PRINT-TRANS-ID)
  5526*             FROM       (PROGRAM-INTERFACE-BLOCK)
  5527*             LENGTH     (PI-COMM-LENGTH)
  5528*             TERMID     (CF-FORMS-PRINTER-ID)
  5529*        END-EXEC.
  5530*    MOVE '0( LFT                0   #00004969' TO DFHEIV0
  5531     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  5532     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  5533     MOVE X'2020233030303034393639' TO DFHEIV0(25:11)
  5534     CALL 'kxdfhei1' USING DFHEIV0,
  5535           DFHEIV99,
  5536           WS-PRINT-TRANS-ID,
  5537           DFHEIV99,
  5538           PROGRAM-INTERFACE-BLOCK,
  5539           PI-COMM-LENGTH,
  5540           CF-FORMS-PRINTER-ID,
  5541           DFHEIV99,
  5542           DFHEIV99,
  5543           DFHEIV99,
  5544           DFHEIV99,
  5545           DFHEIV99,
  5546           DFHEIV99,
  5547           DFHEIV99,
  5548           DFHEIV99,
  5549           DFHEIV99
  5550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5551
  5552
  5553     GO TO 7090-EXIT.
  5554
  5555 7010-TERMID-ERROR.
  5556
  5557     MOVE 0412                   TO EMI-ERROR.
  5558     MOVE -1                     TO APFKL.
  5559     PERFORM 8200-SEND-DATAONLY.
  5560
  5561 7020-TRANS-ERROR.
  5562
  5563     MOVE 0413                   TO EMI-ERROR.
  5564     MOVE -1                     TO APFKL.
  5565     PERFORM 8200-SEND-DATAONLY.
  5566
  5567 7090-EXIT.
  5568     EXIT.
  5569
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 109
* EL686.cbl
  5571 8100-SEND-INITIAL-MAP SECTION.
  5572
  5573     MOVE EIBTIME                TO  WS-TIME-WORK.
  5574
  5575     MOVE PI-CURRENT-DATE        TO  ADATEO.
  5576     MOVE WS-TIME                TO  ATIMEO.
  5577     MOVE EMI-MESSAGE-AREA (1)   TO AEMSG1O.
  5578     MOVE EMI-MESSAGE-AREA (2)   TO AEMSG2O.
  5579
  5580
  5581* EXEC CICS SEND
  5582*        FROM   (EL686AI)
  5583*        MAPSET (WS-MAPSET-NAME)
  5584*        MAP    (WS-MAP-NAME)
  5585*        CURSOR ERASE END-EXEC.
  5586     MOVE LENGTH OF
  5587      EL686AI
  5588       TO DFHEIV12
  5589     MOVE -1
  5590       TO DFHEIV11
  5591*    MOVE '8$     CT  E    H L F ,   #00005003' TO DFHEIV0
  5592     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5593     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5594     MOVE X'2020233030303035303033' TO DFHEIV0(25:11)
  5595     CALL 'kxdfhei1' USING DFHEIV0,
  5596           WS-MAP-NAME,
  5597           EL686AI,
  5598           DFHEIV12,
  5599           WS-MAPSET-NAME,
  5600           DFHEIV99,
  5601           DFHEIV99,
  5602           DFHEIV99,
  5603           DFHEIV11,
  5604           DFHEIV99,
  5605           DFHEIV99,
  5606           DFHEIV99
  5607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5608
  5609
  5610     PERFORM 9100-RETURN-TRAN.
  5611
  5612 8100-EXIT.
  5613     EXIT.
  5614
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 110
* EL686.cbl
  5616 8200-SEND-DATAONLY SECTION.
  5617
  5618     IF EMI-ERROR = ZERO
  5619         MOVE AL-PABOF           TO APF1A
  5620         MOVE AL-PADOF           TO ACOMPA
  5621      ELSE
  5622         PERFORM 9900-ERROR-FORMAT
  5623         MOVE AL-PADOF           TO APF1A
  5624         MOVE AL-PABOF           TO ACOMPA.
  5625
  5626     MOVE EIBTIME                TO  WS-TIME-WORK.
  5627
  5628     MOVE PI-CURRENT-DATE        TO ADATEO.
  5629     MOVE WS-TIME                TO ATIMEO.
  5630     MOVE EMI-MESSAGE-AREA (1)   TO AEMSG1O.
  5631     MOVE EMI-MESSAGE-AREA (2)   TO AEMSG2O.
  5632
  5633
  5634* EXEC CICS SEND DATAONLY
  5635*        FROM   (EL686AI)
  5636*        MAPSET (WS-MAPSET-NAME)
  5637*        MAP    (WS-MAP-NAME)
  5638*        CURSOR END-EXEC.
  5639     MOVE LENGTH OF
  5640      EL686AI
  5641       TO DFHEIV12
  5642     MOVE -1
  5643       TO DFHEIV11
  5644*    MOVE '8$D    CT       H L F ,   #00005032' TO DFHEIV0
  5645     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5646     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5647     MOVE X'2020233030303035303332' TO DFHEIV0(25:11)
  5648     CALL 'kxdfhei1' USING DFHEIV0,
  5649           WS-MAP-NAME,
  5650           EL686AI,
  5651           DFHEIV12,
  5652           WS-MAPSET-NAME,
  5653           DFHEIV99,
  5654           DFHEIV99,
  5655           DFHEIV99,
  5656           DFHEIV11,
  5657           DFHEIV99,
  5658           DFHEIV99,
  5659           DFHEIV99
  5660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5661
  5662
  5663     PERFORM 9100-RETURN-TRAN.
  5664
  5665 8200-EXIT.
  5666     EXIT.
  5667
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 111
* EL686.cbl
  5669 8300-SEND-TEXT SECTION.
  5670
  5671
  5672* EXEC CICS SEND TEXT
  5673*        FROM   (LOGOFF-TEXT)
  5674*        LENGTH (LOGOFF-LENGTH)
  5675*        ERASE  FREEKB END-EXEC.
  5676*    MOVE '8&      T  E F  H   F -   #00005046' TO DFHEIV0
  5677     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5678     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5679     MOVE X'2020233030303035303436' TO DFHEIV0(25:11)
  5680     CALL 'kxdfhei1' USING DFHEIV0,
  5681           LOGOFF-TEXT,
  5682           LOGOFF-LENGTH,
  5683           DFHEIV99,
  5684           DFHEIV99,
  5685           DFHEIV99,
  5686           DFHEIV99,
  5687           DFHEIV99,
  5688           DFHEIV99,
  5689           DFHEIV99,
  5690           DFHEIV99,
  5691           DFHEIV99,
  5692           DFHEIV99
  5693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5694
  5695
  5696
  5697* EXEC CICS RETURN
  5698*        END-EXEC.
  5699*    MOVE '.(                    &   #00005051' TO DFHEIV0
  5700     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5701     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5702     MOVE X'2020233030303035303531' TO DFHEIV0(25:11)
  5703     CALL 'kxdfhei1' USING DFHEIV0,
  5704           DFHEIV99,
  5705           DFHEIV99,
  5706           DFHEIV99,
  5707           DFHEIV99,
  5708           DFHEIV99
  5709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5710
  5711
  5712 8300-EXIT.
  5713     EXIT.
  5714
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 112
* EL686.cbl
  5716 8400-LOG-JOURNAL-RECORD SECTION.
  5717
  5718     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5719     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5720
  5721*    EXEC CICS JOURNAL
  5722*        JFILEID (PI-JOURNAL-FILE-ID)
  5723*        JTYPEID (WS-JOURNAL-TYPE-ID)
  5724*        FROM    (JOURNAL-RECORD)
  5725*        LENGTH  (WS-JOURNAL-RECORD-LENGTH) END-EXEC.
  5726
  5727 8400-EXIT.
  5728     EXIT.
  5729
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 113
* EL686.cbl
  5731 8500-DATE-CONVERSION SECTION.
  5732
  5733
  5734* EXEC CICS LINK
  5735*        PROGRAM  (ELDATCV)
  5736*        COMMAREA (DATE-CONVERSION-DATA)
  5737*        LENGTH   (DC-COMM-LENGTH) END-EXEC.
  5738*    MOVE '."C                   ''   #00005075' TO DFHEIV0
  5739     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5740     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5741     MOVE X'2020233030303035303735' TO DFHEIV0(25:11)
  5742     CALL 'kxdfhei1' USING DFHEIV0,
  5743           ELDATCV,
  5744           DATE-CONVERSION-DATA,
  5745           DC-COMM-LENGTH,
  5746           DFHEIV99,
  5747           DFHEIV99,
  5748           DFHEIV99
  5749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5750
  5751
  5752 8500-EXIT.
  5753     EXIT.
  5754
  5755 8600-DEEDIT  SECTION.
  5756
  5757* EXEC CICS  BIF DEEDIT
  5758*        FIELD   (DEEDIT-FIELD)
  5759*        LENGTH  (15)
  5760*    END-EXEC.
  5761     MOVE 15
  5762       TO DFHEIV11
  5763*    MOVE '@"L                   #   #00005084' TO DFHEIV0
  5764     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5765     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5766     MOVE X'2020233030303035303834' TO DFHEIV0(25:11)
  5767     CALL 'kxdfhei1' USING DFHEIV0,
  5768           DEEDIT-FIELD,
  5769           DFHEIV11
  5770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5771
  5772
  5773 8600-EXIT.
  5774     EXIT.
  5775
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 114
* EL686.cbl
  5777 9000-RETURN-CICS SECTION.
  5778
  5779     MOVE EL005                  TO  THIS-PGM.
  5780     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5781     PERFORM 9300-XCTL.
  5782
  5783 9000-EXIT.
  5784     EXIT.
  5785
  5786 9100-RETURN-TRAN SECTION.
  5787
  5788     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5789     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5790
  5791
  5792* EXEC CICS RETURN
  5793*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  5794*        LENGTH   (PI-COMM-LENGTH)
  5795*        TRANSID  (WS-TRANS-ID) END-EXEC.
  5796*    MOVE '.(CT                  &   #00005107' TO DFHEIV0
  5797     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5798     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5799     MOVE X'2020233030303035313037' TO DFHEIV0(25:11)
  5800     CALL 'kxdfhei1' USING DFHEIV0,
  5801           WS-TRANS-ID,
  5802           PROGRAM-INTERFACE-BLOCK,
  5803           PI-COMM-LENGTH,
  5804           DFHEIV99,
  5805           DFHEIV99
  5806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5807
  5808
  5809 9100-EXIT.
  5810     EXIT.
  5811
  5812 9300-XCTL SECTION.
  5813
  5814     MOVE DFHENTER               TO  EIBAID.
  5815
  5816
  5817* EXEC CICS XCTL
  5818*        PROGRAM  (THIS-PGM)
  5819*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  5820*        LENGTH   (PI-COMM-LENGTH) END-EXEC.
  5821*    MOVE '.$C                   $   #00005119' TO DFHEIV0
  5822     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5823     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5824     MOVE X'2020233030303035313139' TO DFHEIV0(25:11)
  5825     CALL 'kxdfhei1' USING DFHEIV0,
  5826           THIS-PGM,
  5827           PROGRAM-INTERFACE-BLOCK,
  5828           PI-COMM-LENGTH
  5829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5830
  5831
  5832 9300-EXIT.
  5833     EXIT.
  5834
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 115
* EL686.cbl
  5836 9400-CLEAR SECTION.
  5837
  5838     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  5839     PERFORM 9300-XCTL.
  5840
  5841 9400-EXIT.
  5842     EXIT.
  5843
  5844 9600-PGMIDERR SECTION.
  5845
  5846
  5847* EXEC CICS HANDLE CONDITION
  5848*        PGMIDERR (8300-SEND-TEXT) END-EXEC.
  5849*    MOVE '"$L                   ! & #00005138' TO DFHEIV0
  5850     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5852     MOVE X'2620233030303035313338' TO DFHEIV0(25:11)
  5853     CALL 'kxdfhei1' USING DFHEIV0
  5854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5855
  5856
  5857     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM.
  5858
  5859     MOVE EL005                  TO  THIS-PGM
  5860                                     LOGOFF-PGM.
  5861     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5862
  5863     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  5864     PERFORM 9300-XCTL.
  5865
  5866 9600-EXIT.
  5867     EXIT.
  5868
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 116
* EL686.cbl
  5870 9900-ERROR-FORMAT SECTION.
  5871
  5872
  5873* EXEC CICS LINK
  5874*        PROGRAM  (EL001)
  5875*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  5876*        LENGTH   (EMI-COMM-LENGTH) END-EXEC.
  5877*    MOVE '."C                   ''   #00005156' TO DFHEIV0
  5878     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5879     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5880     MOVE X'2020233030303035313536' TO DFHEIV0(25:11)
  5881     CALL 'kxdfhei1' USING DFHEIV0,
  5882           EL001,
  5883           ERROR-MESSAGE-INTERFACE-BLOCK,
  5884           EMI-COMM-LENGTH,
  5885           DFHEIV99,
  5886           DFHEIV99,
  5887           DFHEIV99
  5888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5889
  5890
  5891 9900-EXIT.
  5892     EXIT.
  5893
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 117
* EL686.cbl
  5895 9990-ERROR SECTION.
  5896
  5897     MOVE DFHEIBLK TO EMI-LINE1.
  5898
  5899* EXEC CICS LINK
  5900*        PROGRAM  (EL004)
  5901*        COMMAREA (EMI-LINE1)
  5902*        LENGTH   (72) END-EXEC.
  5903     MOVE 72
  5904       TO DFHEIV11
  5905*    MOVE '."C                   ''   #00005168' TO DFHEIV0
  5906     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5907     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5908     MOVE X'2020233030303035313638' TO DFHEIV0(25:11)
  5909     CALL 'kxdfhei1' USING DFHEIV0,
  5910           EL004,
  5911           EMI-LINE1,
  5912           DFHEIV11,
  5913           DFHEIV99,
  5914           DFHEIV99,
  5915           DFHEIV99
  5916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5917
  5918     MOVE -1 TO APFKL.
  5919     PERFORM 8200-SEND-DATAONLY.
  5920     GO TO 9100-RETURN-TRAN.
  5921
  5922 9990-EXIT.
  5923     EXIT.
  5924
  5925 9995-SECURITY-VIOLATION.
  5926*    COPY ELCSCTP.
  5927******************************************************************
  5928*                                                                *
  5929*                            ELCSCTP                             *
  5930*                            VMOD=2.001                          *
  5931*                                                                *
  5932*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5933******************************************************************
  5934
  5935
  5936     MOVE EIBDATE          TO SM-JUL-DATE.
  5937     MOVE EIBTRMID         TO SM-TERMID.
  5938     MOVE THIS-PGM         TO SM-PGM.
  5939     MOVE EIBTIME          TO TIME-IN.
  5940     MOVE TIME-OUT         TO SM-TIME.
  5941     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5942
  5943
  5944* EXEC CICS LINK
  5945*         PROGRAM  ('EL003')
  5946*         COMMAREA (SECURITY-MESSAGE)
  5947*         LENGTH   (80)
  5948*    END-EXEC.
  5949     MOVE 'EL003' TO DFHEIV1
  5950     MOVE 80
  5951       TO DFHEIV11
  5952*    MOVE '."C                   ''   #00005197' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 118
* EL686.cbl
  5953     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5954     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5955     MOVE X'2020233030303035313937' TO DFHEIV0(25:11)
  5956     CALL 'kxdfhei1' USING DFHEIV0,
  5957           DFHEIV1,
  5958           SECURITY-MESSAGE,
  5959           DFHEIV11,
  5960           DFHEIV99,
  5961           DFHEIV99,
  5962           DFHEIV99
  5963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5964
  5965
  5966******************************************************************
  5967
  5968
  5969 9995-EXIT.
  5970     EXIT.
  5971
  5972 9999-LAST-PARAGRAPH SECTION.
  5973
  5974
  5975* GOBACK.
  5976     MOVE '9%                    "   ' TO DFHEIV0
  5977     MOVE 'EL686' TO DFHEIV1
  5978     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5979     GOBACK.
  5980
  5981
  5982 9999-DFHBACK SECTION.
  5983     MOVE '9%                    "   ' TO DFHEIV0
  5984     MOVE 'EL686' TO DFHEIV1
  5985     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5986     GOBACK.
  5987 9999-DFHEXIT.
  5988     IF DFHEIGDJ EQUAL 0001
  5989         NEXT SENTENCE
  5990     ELSE IF DFHEIGDJ EQUAL 2
  5991         GO TO 9600-PGMIDERR,
  5992               0140-NOT-FOUND,
  5993               0400-END-OF-SEARCH,
  5994               0910-ENQ-BUSY,
  5995               7010-TERMID-ERROR,
  5996               7020-TRANS-ERROR,
  5997               9990-ERROR
  5998         DEPENDING ON DFHEIGDI
  5999     ELSE IF DFHEIGDJ EQUAL 3
  6000         GO TO 0260-END-OF-ERPYAJ
  6001         DEPENDING ON DFHEIGDI
  6002     ELSE IF DFHEIGDJ EQUAL 4
  6003         GO TO 0400-END-OF-SEARCH
  6004         DEPENDING ON DFHEIGDI
  6005     ELSE IF DFHEIGDJ EQUAL 5
  6006         GO TO 0400-END-OF-SEARCH
  6007         DEPENDING ON DFHEIGDI
  6008     ELSE IF DFHEIGDJ EQUAL 6
  6009         GO TO 8300-SEND-TEXT
  6010         DEPENDING ON DFHEIGDI.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 119
* EL686.cbl
  6011     MOVE '9%                    "   ' TO DFHEIV0
  6012     MOVE 'EL686' TO DFHEIV1
  6013     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6014     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        5252     Code:       15482
