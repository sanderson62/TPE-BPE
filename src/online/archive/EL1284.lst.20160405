* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page   1
* EL1284.cbl
* Options: int("EL1284.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1284.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1284.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1284.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL1284.
     4*
     5*AUTHOR.           LOGIC,INC.
     6*                  DALLAS,TEXAS.
     7
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page   2
* EL1284.cbl
    14*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    16*            *                                                   *
    17*            *****************************************************
    18*
    19*REMARKS.     TRANSACTION - EXXG - CLAIM MEMO MAINTENANCE.
    20*
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 010416   2015072900002   TANA  NEW CLAIM MEMO SCREEN
    30******************************************************************
    31*
    32 ENVIRONMENT DIVISION.
    33
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page   3
* EL1284.cbl
    35 DATA DIVISION.
    36 WORKING-STORAGE SECTION.
    37 01  DFH-START PIC X(04).
    38 77  FILLER  PIC X(32)  VALUE '********************************'.
    39 77  FILLER  PIC X(32)  VALUE '*     EL1284 WORKING STORAGE   *'.
    40 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.005 ***********'.
    41
    42*    COPY ELCSCTM.
    43******************************************************************
    44*                                                                *
    45*                                                                *
    46*                            ELCSCTM                             *
    47*                            VMOD=2.001                          *
    48*                                                                *
    49*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    50*                                                                *
    51******************************************************************
    52 01  SECURITY-MESSAGE.
    53     12  FILLER                          PIC X(30)
    54            VALUE '** LOGIC SECURITY VIOLATION -'.
    55     12  SM-READ                         PIC X(6).
    56     12  FILLER                          PIC X(5)
    57            VALUE ' PGM='.
    58     12  SM-PGM                          PIC X(6).
    59     12  FILLER                          PIC X(5)
    60            VALUE ' OPR='.
    61     12  SM-PROCESSOR-ID                 PIC X(4).
    62     12  FILLER                          PIC X(6)
    63            VALUE ' TERM='.
    64     12  SM-TERMID                       PIC X(4).
    65     12  FILLER                          PIC XX   VALUE SPACE.
    66     12  SM-JUL-DATE                     PIC 9(5).
    67     12  FILLER                          PIC X    VALUE SPACE.
    68     12  SM-TIME                         PIC 99.99.
    69
    70*    COPY ELCSCRTY.
    71******************************************************************
    72*                                                                *
    73*                                                                *
    74*                            ELCSCRTY                            *
    75*                            VMOD=2.001                          *
    76*                                                                *
    77*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    78*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    79*        SAVED IN PI-SECURITY-ADDRESS.                           *
    80*                                                                *
    81******************************************************************
    82 01  SECURITY-CONTROL.
    83     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    84     12  FILLER                       PIC XX    VALUE 'SC'.
    85     12  SC-CREDIT-CODES.
    86         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    87             20  SC-CREDIT-DISPLAY    PIC X.
    88             20  SC-CREDIT-UPDATE     PIC X.
    89     12  SC-CLAIMS-CODES.
    90         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    91             20  SC-CLAIMS-DISPLAY    PIC X.
    92             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page   4
* EL1284.cbl
    93
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page   5
* EL1284.cbl
    95 01  STANDARD-AREAS.
    96     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
    97     12  MAP-NAME                PIC X(8)    VALUE 'EL1284A'.
    98     12  MAPSET-NAME             PIC X(8)    VALUE 'EL1284S '.
    99     12  SCRN-NUMBER             PIC X(4)    VALUE '128D'.
   100     12  TRANS-ID                PIC X(4)    VALUE 'EXXG'.
   101     12  THIS-PGM                PIC X(8)    VALUE 'EL1284'.
   102     12  PGM-NAME                PIC X(8).
   103     12  PGM-EL1276              PIC X(8)    VALUE 'EL1276'.
   104
   105     12  ELMEMO-FILE-ID          PIC X(8)    VALUE 'ELMEMO'.
   106     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   107     12  QID.
   108         16  QID-TERM            PIC X(4).
   109         16  FILLER              PIC X(4)    VALUE '128D'.
   110     12  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   111     12  SC-ITEM                 PIC S9(4)   COMP VALUE +1.
   112     12  WS-LINE                 PIC 9(3)    VALUE 0.
   113     12  WS-BLANK-LINES          PIC S9(4)   COMP VALUE +0.
   114
   115 01  WORK-AREA.
   116     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   117     12  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   118
   119     12  ELMEMO-LENGTH           PIC S9(4)   COMP VALUE +132.
   120     12  ELMEMO-KEY-LENGTH       PIC S9(4)   COMP VALUE +23.
   121     12  ELMEMO-START-LENGTH     PIC S9(4)   COMP VALUE +21.
   122     12  ELMEMO-KEY.
   123         16  ELMEMO-PARTIAL-KEY.
   124             20 ELMEMO-COMPANY-CD    PIC X.
   125             20 ELMEMO-RECORD-TYPE   PIC X.
   126             20 ELMEMO-CARRIER       PIC X.
   127             20 ELMEMO-CLAIM-NO      PIC  X(7).
   128             20 ELMEMO-CERT-NO.
   129                25 ELMEMO-CERT-PRIME PIC X(10).
   130                25 ELMEMO-CERT-SFX   PIC X.
   131         16 ELMEMO-SEQ           PIC S9(4) COMP.
   132     12  SV-PRIOR-KEY.
   133         20 SV-COMPANY-CD            PIC X.
   134         20 SV-RECORD-TYPE           PIC X.
   135         20 SV-CARRIER               PIC X.
   136         20 SV-CLAIM-NO              PIC  X(7).
   137         20 SV-CERT-NO.
   138            25 SV-CERT-PRIME         PIC X(10).
   139            25 SV-CERT-SFX           PIC X(1).
   140     12  ELCERT-KEY.
   141         16  ELCERT-COMPANY-CD        PIC X.
   142         16  ELCERT-CARRIER           PIC X.
   143         16  ELCERT-GROUPING          PIC X(6).
   144         16  ELCERT-STATE             PIC XX.
   145         16  ELCERT-ACCOUNT           PIC X(10).
   146         16  ELCERT-EFF-DT            PIC XX.
   147         16  ELCERT-CERT-NO.
   148             20  ELCERT-CERT-PRIME    PIC X(10).
   149             20  ELCERT-CERT-SFX      PIC X.
   150
   151     12  TIME-IN                 PIC S9(7).
   152     12  TIME-SPLIT REDEFINES TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page   6
* EL1284.cbl
   153         16  FILLER              PIC X.
   154         16  TIME-OUT            PIC 99V99.
   155         16  FILLER              PIC X(2).
   156     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   157     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   158     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   159     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   160     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   161     12  MAX-LINES               PIC 999     VALUE 300.
   162     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 10.
   163     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   164     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   165     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   166     12  ROLL-COUNTER            PIC S999    VALUE +0 COMP-3.
   167     12  TEMP-CURR-LINE          PIC S9(3)   COMP-3.
   168     12  WS-SUB                  PIC S9(3)   COMP-3.
   169     12  WS-SUB1                 PIC S9(3)   COMP-3.
   170     12  WS-ERASE-EOF            PIC X       VALUE X'80'.
   171     12  DEEDIT-DATE-INPUT.
   172         16  FILLER              PIC XX.
   173         16  DEEDIT-DATE         PIC X(6).
   174     12  WS-CURSOR-SET           PIC X       VALUE 'N'.
   175         88 CURSOR-SET                       VALUE 'Y'.
   176     12  WS-SCREEN-LINE          PIC X       VALUE 'N'.
   177         88 SCREEN-LINE-FOUND                VALUE 'Y'.
   178
   179     12  ELMSTR-KEY.
   180         16  MSTR-COMP-CD    PIC X.
   181         16  MSTR-CARRIER    PIC X.
   182         16  MSTR-CLAIM-NO   PIC X(7).
   183         16  MSTR-CERT-NO.
   184             20  MSTR-CERT-NO-PRIME  PIC X(10).
   185             20  MSTR-CERT-NO-SUFX   PIC X.
   186 01  COMP-LENGTHS.
   187     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   188     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   189     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   190     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   191     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   192     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   193     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   194     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   195     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   196     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   197     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   198     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   199     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   200     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page   7
* EL1284.cbl
   202 01  ERROR-MESSAGES.
   203     12  ER-0000             PIC X(04)       VALUE '0000'.
   204     12  ER-0004             PIC X(04)       VALUE '0004'.
   205     12  ER-0006             PIC X(04)       VALUE '0006'.
   206     12  ER-0008             PIC X(04)       VALUE '0008'.
   207     12  ER-0023             PIC X(04)       VALUE '0023'.
   208     12  ER-0029             PIC X(04)       VALUE '0029'.
   209     12  ER-0030             PIC X(04)       VALUE '0030'.
   210     12  ER-0031             PIC X(04)       VALUE '0031'.
   211     12  ER-0032             PIC X(04)       VALUE '0032'.
   212     12  ER-0033             PIC X(04)       VALUE '0033'.
   213     12  ER-0041             PIC X(04)       VALUE '0041'.
   214     12  ER-0044             PIC X(04)       VALUE '0044'.
   215     12  ER-0045             PIC X(04)       VALUE '0045'.
   216     12  ER-0046             PIC X(04)       VALUE '0046'.
   217     12  ER-0047             PIC X(04)       VALUE '0047'.
   218     12  ER-0048             PIC X(04)       VALUE '0048'.
   219     12  ER-0049             PIC X(04)       VALUE '0049'.
   220     12  ER-0050             PIC X(04)       VALUE '0050'.
   221     12  ER-0051             PIC X(04)       VALUE '0051'.
   222     12  ER-0066             PIC X(04)       VALUE '0066'.
   223     12  ER-0067             PIC X(04)       VALUE '0067'.
   224     12  ER-0069             PIC X(04)       VALUE '0069'.
   225     12  ER-0070             PIC X(04)       VALUE '0070'.
   226     12  ER-0140             PIC X(04)       VALUE '0140'.
   227     12  ER-0314             PIC X(04)       VALUE '0314'.
   228     12  ER-2954             PIC X(04)       VALUE '2954'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page   8
* EL1284.cbl
   230*                       COPY ELCLOGOF.
   231******************************************************************
   232*                                                                *
   233*                                                                *
   234*                            ELCLOGOF.                           *
   235*                            VMOD=2.001                          *
   236*                                                                *
   237*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   238*                                                                *
   239******************************************************************
   240 01  CLASIC-LOGOFF.
   241     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   242     12  LOGOFF-TEXT.
   243         16  FILLER          PIC X(5)    VALUE SPACES.
   244         16  LOGOFF-MSG.
   245             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   246             20  FILLER      PIC X       VALUE SPACES.
   247             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   248         16  FILLER          PIC X(80)
   249           VALUE '* YOU ARE NOW LOGGED OFF'.
   250         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   251         16  FILLER          PIC X       VALUE QUOTE.
   252         16  LOGOFF-SYS-MSG  PIC X(17)
   253           VALUE 'S CLAS-IC SYSTEM '.
   254     12  TEXT-MESSAGES.
   255         16  UNACCESS-MSG    PIC X(29)
   256             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   257         16  PGMIDERR-MSG    PIC X(17)
   258             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page   9
* EL1284.cbl
   260*                       COPY ELCAID.
   261******************************************************************
   262*                                                                *
   263*                            ELCAID.                             *
   264*                            VMOD=2.001                          *
   265*                                                                *
   266*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   267*                                                                *
   268*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   269*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   270******************************************************************
   271
   272 01  DFHAID.
   273   02  DFHNULL   PIC  X  VALUE  ' '.
   274   02  DFHENTER  PIC  X  VALUE  QUOTE.
   275   02  DFHCLEAR  PIC  X  VALUE  '_'.
   276   02  DFHPEN    PIC  X  VALUE  '='.
   277   02  DFHOPID   PIC  X  VALUE  'W'.
   278   02  DFHPA1    PIC  X  VALUE  '%'.
   279   02  DFHPA2    PIC  X  VALUE  '>'.
   280   02  DFHPA3    PIC  X  VALUE  ','.
   281   02  DFHPF1    PIC  X  VALUE  '1'.
   282   02  DFHPF2    PIC  X  VALUE  '2'.
   283   02  DFHPF3    PIC  X  VALUE  '3'.
   284   02  DFHPF4    PIC  X  VALUE  '4'.
   285   02  DFHPF5    PIC  X  VALUE  '5'.
   286   02  DFHPF6    PIC  X  VALUE  '6'.
   287   02  DFHPF7    PIC  X  VALUE  '7'.
   288   02  DFHPF8    PIC  X  VALUE  '8'.
   289   02  DFHPF9    PIC  X  VALUE  '9'.
   290   02  DFHPF10   PIC  X  VALUE  ':'.
   291   02  DFHPF11   PIC  X  VALUE  '#'.
   292   02  DFHPF12   PIC  X  VALUE  '@'.
   293   02  DFHPF13   PIC  X  VALUE  'A'.
   294   02  DFHPF14   PIC  X  VALUE  'B'.
   295   02  DFHPF15   PIC  X  VALUE  'C'.
   296   02  DFHPF16   PIC  X  VALUE  'D'.
   297   02  DFHPF17   PIC  X  VALUE  'E'.
   298   02  DFHPF18   PIC  X  VALUE  'F'.
   299   02  DFHPF19   PIC  X  VALUE  'G'.
   300   02  DFHPF20   PIC  X  VALUE  'H'.
   301   02  DFHPF21   PIC  X  VALUE  'I'.
   302*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   303   02  DFHPF22   PIC  X  VALUE  '['.
   304   02  DFHPF23   PIC  X  VALUE  '.'.
   305   02  DFHPF24   PIC  X  VALUE  '<'.
   306   02  DFHMSRE   PIC  X  VALUE  'X'.
   307   02  DFHSTRF   PIC  X  VALUE  'h'.
   308   02  DFHTRIG   PIC  X  VALUE  '"'.
   309 01  FILLER  REDEFINES DFHAID.
   310     12  FILLER                  PIC X(8).
   311     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  10
* EL1284.cbl
   313*                       COPY ELCEMIB.
   314******************************************************************
   315*                                                                *
   316*                                                                *
   317*                            ELCEMIB.                            *
   318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   319*                            VMOD=2.005                          *
   320*                                                                *
   321*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   322*                                                                *
   323******************************************************************
   324 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   325     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   326     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   327     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   328     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   329     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   330     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   331     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   332     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   333     12  EMI-SWITCH1             PIC X        VALUE '1'.
   334         88  EMI-NO-ERRORS                    VALUE '1'.
   335         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   336         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   337     12  EMI-SWITCH2             PIC X        VALUE '1'.
   338         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   339     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   340         88  EMI-AREA1-EMPTY                  VALUE '1'.
   341         88  EMI-AREA1-FULL                   VALUE '2'.
   342     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   343         88  EMI-AREA2-EMPTY                  VALUE '1'.
   344         88  EMI-AREA2-FULL                   VALUE '2'.
   345     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   346         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   347         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   348         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   349         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   350         88  EMI-BYPASS-FATALS                VALUE 'X'.
   351     12  EMI-ERROR-LINES.
   352         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   353         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   354         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   355         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   356             20  EMI-ERR-CODES OCCURS 10 TIMES.
   357                 24  EMI-ERR-NUM         PIC X(4).
   358                 24  EMI-FILLER          PIC X.
   359                 24  EMI-SEV             PIC X.
   360                 24  FILLER              PIC X.
   361             20  FILLER                  PIC X(02).
   362     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   363         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   364             20  EMI-ERROR-NUMBER    PIC X(4).
   365             20  EMI-FILL            PIC X.
   366             20  EMI-SEVERITY        PIC X.
   367             20  FILLER              PIC X.
   368             20  EMI-ERROR-TEXT.
   369                 24  EMI-TEXT-VARIABLE   PIC X(10).
   370                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  11
* EL1284.cbl
   371     12  EMI-SEVERITY-SAVE           PIC X.
   372         88  EMI-NOTE                    VALUE 'N'.
   373         88  EMI-WARNING                 VALUE 'W'.
   374         88  EMI-FORCABLE                VALUE 'F'.
   375         88  EMI-FATAL                   VALUE 'X'.
   376     12  EMI-MESSAGE-FLAG            PIC X.
   377         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   378         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   379     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   380     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   381         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   382         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   383         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   384     12  emi-claim-no                pic x(7).
   385     12  emi-claim-type              pic x(6).
   386     12  FILLER                      PIC X(124)  VALUE SPACES.
   387     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   388     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   389     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   390     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  12
* EL1284.cbl
   392*                       COPY ELCINTF.
   393******************************************************************
   394*                                                                *
   395*                                                                *
   396*                            ELCINTF.                            *
   397*                            VMOD=2.017                          *
   398*                                                                *
   399*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   400*                                                                *
   401*       LENGTH = 1024                                            *
   402*                                                                *
   403******************************************************************
   404*                   C H A N G E   L O G
   405*
   406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   407*-----------------------------------------------------------------
   408*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   409* EFFECTIVE    NUMBER
   410*-----------------------------------------------------------------
   411* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   412******************************************************************
   413 01  PROGRAM-INTERFACE-BLOCK.
   414     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   415     12  PI-CALLING-PROGRAM              PIC X(8).
   416     12  PI-SAVED-PROGRAM-1              PIC X(8).
   417     12  PI-SAVED-PROGRAM-2              PIC X(8).
   418     12  PI-SAVED-PROGRAM-3              PIC X(8).
   419     12  PI-SAVED-PROGRAM-4              PIC X(8).
   420     12  PI-SAVED-PROGRAM-5              PIC X(8).
   421     12  PI-SAVED-PROGRAM-6              PIC X(8).
   422     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   423     12  PI-COMPANY-ID                   PIC XXX.
   424     12  PI-COMPANY-CD                   PIC X.
   425
   426     12  PI-COMPANY-PASSWORD             PIC X(8).
   427
   428     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   429
   430     12  PI-CONTROL-IN-PROGRESS.
   431         16  PI-CARRIER                  PIC X.
   432         16  PI-GROUPING                 PIC X(6).
   433         16  PI-STATE                    PIC XX.
   434         16  PI-ACCOUNT                  PIC X(10).
   435         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   436                                         PIC X(10).
   437         16  PI-CLAIM-CERT-GRP.
   438             20  PI-CLAIM-NO             PIC X(7).
   439             20  PI-CERT-NO.
   440                 25  PI-CERT-PRIME       PIC X(10).
   441                 25  PI-CERT-SFX         PIC X.
   442             20  PI-CERT-EFF-DT          PIC XX.
   443         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   444             20  PI-PLAN-CODE            PIC X(2).
   445             20  PI-REVISION-NUMBER      PIC X(3).
   446             20  PI-PLAN-EFF-DT          PIC X(2).
   447             20  PI-PLAN-EXP-DT          PIC X(2).
   448             20  FILLER                  PIC X(11).
   449         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  13
* EL1284.cbl
   450             20  PI-OE-REFERENCE-1.
   451                 25  PI-OE-REF-1-PRIME   PIC X(18).
   452                 25  PI-OE-REF-1-SUFF    PIC XX.
   453
   454     12  PI-SESSION-IN-PROGRESS          PIC X.
   455         88  CLAIM-SESSION                   VALUE '1'.
   456         88  CREDIT-SESSION                  VALUE '2'.
   457         88  WARRANTY-SESSION                VALUE '3'.
   458         88  MORTGAGE-SESSION                VALUE '4'.
   459         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   460
   461
   462*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   463
   464     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   465     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   466
   467     12  PI-CREDIT-USER                  PIC X.
   468         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   469         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   470
   471     12  PI-CLAIM-USER                   PIC X.
   472         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   473         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   474
   475     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   476         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   477         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   478         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   479         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   480         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   481
   482     12  PI-PROCESSOR-ID                 PIC X(4).
   483
   484     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   485
   486     12  PI-MEMBER-CAPTION               PIC X(10).
   487
   488     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   489         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   490
   491     12  PI-LIFE-OVERRIDE-L1             PIC X.
   492     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   493     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   494     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   495
   496     12  PI-AH-OVERRIDE-L1               PIC X.
   497     12  PI-AH-OVERRIDE-L2               PIC XX.
   498     12  PI-AH-OVERRIDE-L6               PIC X(6).
   499     12  PI-AH-OVERRIDE-L12              PIC X(12).
   500
   501     12  PI-NEW-SYSTEM                   PIC X(2).
   502
   503     12  PI-PRIMARY-CERT-NO              PIC X(11).
   504     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   505         88  PI-USES-PAID-TO                 VALUE '1'.
   506     12  PI-CRDTCRD-SYSTEM.
   507         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  14
* EL1284.cbl
   508             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   509             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   510         16  PI-CC-MONTH-END-DT          PIC XX.
   511     12  PI-PROCESSOR-PRINTER            PIC X(4).
   512
   513     12  PI-OE-REFERENCE-2.
   514         16  PI-OE-REF-2-PRIME           PIC X(10).
   515         16  PI-OE-REF-2-SUFF            PIC X.
   516
   517     12  PI-REM-TRM-CALC-OPTION          PIC X.
   518
   519     12  PI-LANGUAGE-TYPE                PIC X.
   520             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   521             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   522             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   523
   524     12  PI-POLICY-LINKAGE-IND           PIC X.
   525         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   526         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   527                                                   LOW-VALUES.
   528
   529     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   530     12  PI-CLAIM-PW-SESSION             PIC X(1).
   531         88  PI-CLAIM-CREDIT                 VALUE '1'.
   532         88  PI-CLAIM-CONVEN                 VALUE '2'.
   533
   534     12  PI-PROCESSOR-CSR-IND            PIC X.
   535         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   536         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   537
   538     12  FILLER                          PIC X(3).
   539
   540     12  PI-SYSTEM-LEVEL                 PIC X(145).
   541
   542     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   543         PI-SYSTEM-LEVEL.
   544
   545         16  PI-ENTRY-CODES.
   546             20  PI-ENTRY-CD-1           PIC X.
   547             20  PI-ENTRY-CD-2           PIC X.
   548
   549         16  PI-RETURN-CODES.
   550             20  PI-RETURN-CD-1          PIC X.
   551             20  PI-RETURN-CD-2          PIC X.
   552
   553         16  PI-UPDATE-STATUS-SAVE.
   554             20  PI-UPDATE-BY            PIC X(4).
   555             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   556
   557         16  PI-LOWER-CASE-LETTERS       PIC X.
   558             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   559
   560*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   561*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   562*            88  CARRIER-CLM-CNTL            VALUE '2'.
   563
   564         16  PI-CERT-ACCESS-CONTROL      PIC X.
   565             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  15
* EL1284.cbl
   566             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   567             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   568             88  ACCNT-CNTL                  VALUE '3'.
   569             88  CARR-ACCNT-CNTL             VALUE '4'.
   570
   571         16  PI-PROCESSOR-CAP-LIST.
   572             20  PI-SYSTEM-CONTROLS.
   573                24 PI-SYSTEM-DISPLAY     PIC X.
   574                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   575                24 PI-SYSTEM-MODIFY      PIC X.
   576                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   577             20  FILLER                  PIC XX.
   578             20  PI-DISPLAY-CAP          PIC X.
   579                 88  DISPLAY-CAP             VALUE 'Y'.
   580             20  PI-MODIFY-CAP           PIC X.
   581                 88  MODIFY-CAP              VALUE 'Y'.
   582             20  PI-MSG-AT-LOGON-CAP     PIC X.
   583                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   584             20  PI-FORCE-CAP            PIC X.
   585                 88  FORCE-CAP               VALUE 'Y'.
   586
   587         16  PI-PROGRAM-CONTROLS.
   588             20  PI-PGM-PRINT-OPT        PIC X.
   589             20  PI-PGM-FORMAT-OPT       PIC X.
   590             20  PI-PGM-PROCESS-OPT      PIC X.
   591             20  PI-PGM-TOTALS-OPT       PIC X.
   592
   593         16  PI-HELP-INTERFACE.
   594             20  PI-LAST-ERROR-NO        PIC X(4).
   595             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   596
   597         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   598             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   599
   600         16  PI-CR-CONTROL-IN-PROGRESS.
   601             20  PI-CR-CARRIER           PIC X.
   602             20  PI-CR-GROUPING          PIC X(6).
   603             20  PI-CR-STATE             PIC XX.
   604             20  PI-CR-ACCOUNT           PIC X(10).
   605             20  PI-CR-FIN-RESP          PIC X(10).
   606             20  PI-CR-TYPE              PIC X.
   607
   608         16  PI-CR-BATCH-NUMBER          PIC X(6).
   609
   610         16  PI-CR-MONTH-END-DT          PIC XX.
   611
   612         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   613             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   614             88  PI-ZERO-CARRIER             VALUE '1'.
   615             88  PI-ZERO-GROUPING            VALUE '2'.
   616             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   617
   618         16  PI-CARRIER-SECURITY         PIC X.
   619             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   620
   621         16  PI-ACCOUNT-SECURITY         PIC X(10).
   622             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   623             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  16
* EL1284.cbl
   624
   625         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   626             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   627                                         INDEXED BY PI-ACCESS-NDX
   628                                         PIC X.
   629
   630         16  PI-GA-BILLING-CONTROL       PIC X.
   631             88  PI-GA-BILLING               VALUE '1'.
   632
   633         16  PI-MAIL-PROCESSING          PIC X.
   634             88  PI-MAIL-YES                 VALUE 'Y'.
   635
   636         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   637
   638         16  PI-AR-SYSTEM.
   639             20  PI-AR-PROCESSING-CNTL   PIC X.
   640                 88  PI-AR-PROCESSING        VALUE 'Y'.
   641             20  PI-AR-SUMMARY-CODE      PIC X(6).
   642             20  PI-AR-MONTH-END-DT      PIC XX.
   643
   644         16  PI-MP-SYSTEM.
   645             20  PI-MORTGAGE-USER            PIC X.
   646                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   647                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   648             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   649                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   650                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   651                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   652                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   653                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   654             20  PI-MP-MONTH-END-DT          PIC XX.
   655             20  PI-MP-REFERENCE-NO.
   656                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   657                 24  PI-MP-REFERENCE-SFX     PIC XX.
   658
   659         16  PI-LABEL-CONTROL            PIC X(01).
   660             88  PI-CREATE-LABELS                    VALUE 'Y'.
   661             88  PI-BYPASS-LABELS                    VALUE 'N'.
   662
   663         16  PI-BILL-GROUPING-CODE       PIC X(01).
   664             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   665
   666         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   667             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   668             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   669
   670         16  FILLER                      PIC X(14).
   671
   672     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   673******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  17
* EL1284.cbl
   675     12  PI-EL1284-AREA    REDEFINES PI-PROGRAM-WORK-AREA.
   676         16  FILLER              PIC X(318).
   677         16  PI-TOTAL-LINES      PIC S9(3).
   678         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   679         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   680         16  PI-UPDATE-SW        PIC X.
   681             88  PI-CHANGES-MADE             VALUE '1'.
   682         16  PI-LONG-HLTH-APP    PIC  X(01).
   683         16  PI-REWRITE          PIC  X(01).
   684         16  PI-CHKCOVG          PIC  X(01).
   685         16  PI-MR-RELEASE-DATE  PIC  X(08).
   686         16  PI-BILLING-NOTES-EXIST PIC X.
   687         16  PI-CERT-NOTES-EXIST    PIC X.
   688         16  PI-CLAIM-NOTES-EXIST   PIC X.
   689         16  PI-SET-NOTE-CHANGE  PIC X.
   690             88 PI-CHANGE-IN-NOTE-TYPE       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  18
* EL1284.cbl
   692*                          COPY ELCATTR.
   693******************************************************************
   694*                                                                *
   695*                            ELCATTR.                            *
   696*                            VMOD=2.001                          *
   697*                                                                *
   698*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   699*                                                                *
   700*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   701*                                                                *
   702*                   POS 1   P=PROTECTED                          *
   703*                           U=UNPROTECTED                        *
   704*                           S=ASKIP                              *
   705*                   POS 2   A=ALPHA/NUMERIC                      *
   706*                           N=NUMERIC                            *
   707*                   POS 3   N=NORMAL                             *
   708*                           B=BRIGHT                             *
   709*                           D=DARK                               *
   710*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   711*                           OF=MODIFIED DATA TAG OFF             *
   712*                                                                *
   713*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   714******************************************************************
   715 01  ATTRIBUTE-LIST.
   716     12  AL-PABOF            PIC X       VALUE 'Y'.
   717     12  AL-PABON            PIC X       VALUE 'Z'.
   718     12  AL-PADOF            PIC X       VALUE '%'.
   719     12  AL-PADON            PIC X       VALUE '_'.
   720     12  AL-PANOF            PIC X       VALUE '-'.
   721     12  AL-PANON            PIC X       VALUE '/'.
   722     12  AL-SABOF            PIC X       VALUE '8'.
   723     12  AL-SABON            PIC X       VALUE '9'.
   724     12  AL-SADOF            PIC X       VALUE '@'.
   725     12  AL-SADON            PIC X       VALUE QUOTE.
   726     12  AL-SANOF            PIC X       VALUE '0'.
   727     12  AL-SANON            PIC X       VALUE '1'.
   728     12  AL-UABOF            PIC X       VALUE 'H'.
   729     12  AL-UABON            PIC X       VALUE 'I'.
   730     12  AL-UADOF            PIC X       VALUE '<'.
   731     12  AL-UADON            PIC X       VALUE '('.
   732     12  AL-UANOF            PIC X       VALUE ' '.
   733     12  AL-UANON            PIC X       VALUE 'A'.
   734     12  AL-UNBOF            PIC X       VALUE 'Q'.
   735     12  AL-UNBON            PIC X       VALUE 'R'.
   736     12  AL-UNDOF            PIC X       VALUE '*'.
   737     12  AL-UNDON            PIC X       VALUE ')'.
   738     12  AL-UNNOF            PIC X       VALUE '&'.
   739     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  19
* EL1284.cbl
   741*                          COPY ELCDATE.
   742******************************************************************
   743*                                                                *
   744*                                                                *
   745*                            ELCDATE.                            *
   746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   747*                            VMOD=2.003
   748*                                                                *
   749*                                                                *
   750*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   751*                 LENGTH = 200                                   *
   752******************************************************************
   753
   754 01  DATE-CONVERSION-DATA.
   755     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   756     12  DC-OPTION-CODE                PIC X.
   757         88  BIN-TO-GREG                VALUE ' '.
   758         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   759         88  EDIT-GREG-TO-BIN           VALUE '2'.
   760         88  YMD-GREG-TO-BIN            VALUE '3'.
   761         88  MDY-GREG-TO-BIN            VALUE '4'.
   762         88  JULIAN-TO-BIN              VALUE '5'.
   763         88  BIN-PLUS-ELAPSED           VALUE '6'.
   764         88  FIND-CENTURY               VALUE '7'.
   765         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   766         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   767         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   768         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   769         88  JULIAN-TO-BIN-3            VALUE 'C'.
   770         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   771         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   772         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   773         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   774         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   775         88  CHECK-LEAP-YEAR            VALUE 'H'.
   776         88  BIN-3-TO-GREG              VALUE 'I'.
   777         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   778         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   779         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   780         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   781         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   782         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   783         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   784         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   785         88  THREE-CHARACTER-BIN
   786                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   787         88  GREGORIAN-TO-BIN
   788                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   789         88  BIN-TO-GREGORIAN
   790                  VALUES ' ' '1' 'I' '8' 'G'.
   791         88  JULIAN-TO-BINARY
   792                  VALUES '5' 'C' 'E' 'F'.
   793     12  DC-ERROR-CODE                 PIC X.
   794         88  NO-CONVERSION-ERROR        VALUE ' '.
   795         88  DATE-CONVERSION-ERROR
   796                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   797         88  DATE-IS-ZERO               VALUE '1'.
   798         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  20
* EL1284.cbl
   799         88  DATE-IS-INVALID            VALUE '3'.
   800         88  DATE1-GREATER-DATE2        VALUE '4'.
   801         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   802         88  DATE-INVALID-OPTION        VALUE '9'.
   803         88  INVALID-CENTURY            VALUE 'A'.
   804         88  ONLY-CENTURY               VALUE 'B'.
   805         88  ONLY-LEAP-YEAR             VALUE 'C'.
   806         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   807     12  DC-END-OF-MONTH               PIC X.
   808         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   809     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   810         88  USE-NORMAL-PROCESS         VALUE ' '.
   811         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   812         88  ADJUST-UP-100-YRS          VALUE '2'.
   813     12  FILLER                        PIC X.
   814     12  DC-CONVERSION-DATES.
   815         16  DC-BIN-DATE-1             PIC XX.
   816         16  DC-BIN-DATE-2             PIC XX.
   817         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   818         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   819                       DC-GREG-DATE-1-EDIT.
   820             20  DC-EDIT1-MONTH        PIC 99.
   821             20  SLASH1-1              PIC X.
   822             20  DC-EDIT1-DAY          PIC 99.
   823             20  SLASH1-2              PIC X.
   824             20  DC-EDIT1-YEAR         PIC 99.
   825         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   826         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   827                     DC-GREG-DATE-2-EDIT.
   828             20  DC-EDIT2-MONTH        PIC 99.
   829             20  SLASH2-1              PIC X.
   830             20  DC-EDIT2-DAY          PIC 99.
   831             20  SLASH2-2              PIC X.
   832             20  DC-EDIT2-YEAR         PIC 99.
   833         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   834         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   835                     DC-GREG-DATE-1-YMD.
   836             20  DC-YMD-YEAR           PIC 99.
   837             20  DC-YMD-MONTH          PIC 99.
   838             20  DC-YMD-DAY            PIC 99.
   839         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   840         16  DC-GREG-DATE-1-MDY-R REDEFINES
   841                      DC-GREG-DATE-1-MDY.
   842             20  DC-MDY-MONTH          PIC 99.
   843             20  DC-MDY-DAY            PIC 99.
   844             20  DC-MDY-YEAR           PIC 99.
   845         16  DC-GREG-DATE-1-ALPHA.
   846             20  DC-ALPHA-MONTH        PIC X(10).
   847             20  DC-ALPHA-DAY          PIC 99.
   848             20  FILLER                PIC XX.
   849             20  DC-ALPHA-CENTURY.
   850                 24 DC-ALPHA-CEN-N     PIC 99.
   851             20  DC-ALPHA-YEAR         PIC 99.
   852         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   853         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   854         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   855         16  DC-JULIAN-DATE            PIC 9(05).
   856         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  21
* EL1284.cbl
   857                                       PIC 9(05).
   858         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   859             20  DC-JULIAN-YEAR        PIC 99.
   860             20  DC-JULIAN-DAYS        PIC 999.
   861         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   862         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   863         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   864     12  DATE-CONVERSION-VARIBLES.
   865         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   866         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   867             20  FILLER                PIC 9(3).
   868             20  HOLD-CEN-1-CCYY.
   869                 24  HOLD-CEN-1-CC     PIC 99.
   870                 24  HOLD-CEN-1-YY     PIC 99.
   871             20  HOLD-CEN-1-MO         PIC 99.
   872             20  HOLD-CEN-1-DA         PIC 99.
   873         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   874             20  HOLD-CEN-1-R-MO       PIC 99.
   875             20  HOLD-CEN-1-R-DA       PIC 99.
   876             20  HOLD-CEN-1-R-CCYY.
   877                 24  HOLD-CEN-1-R-CC   PIC 99.
   878                 24  HOLD-CEN-1-R-YY   PIC 99.
   879             20  FILLER                PIC 9(3).
   880         16  HOLD-CENTURY-1-X.
   881             20  FILLER                PIC X(3)  VALUE SPACES.
   882             20  HOLD-CEN-1-X-CCYY.
   883                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   884                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   885             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   886             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   887         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   888             20  HOLD-CEN-1-R-X-MO     PIC XX.
   889             20  HOLD-CEN-1-R-X-DA     PIC XX.
   890             20  HOLD-CEN-1-R-X-CCYY.
   891                 24  HOLD-CEN-1-R-X-CC PIC XX.
   892                 24  HOLD-CEN-1-R-X-YY PIC XX.
   893             20  FILLER                PIC XXX.
   894         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   895         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   896         16  DC-JULIAN-DATE-1          PIC 9(07).
   897         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   898             20  DC-JULIAN-1-CCYY.
   899                 24  DC-JULIAN-1-CC    PIC 99.
   900                 24  DC-JULIAN-1-YR    PIC 99.
   901             20  DC-JULIAN-DA-1        PIC 999.
   902         16  DC-JULIAN-DATE-2          PIC 9(07).
   903         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   904             20  DC-JULIAN-2-CCYY.
   905                 24  DC-JULIAN-2-CC    PIC 99.
   906                 24  DC-JULIAN-2-YR    PIC 99.
   907             20  DC-JULIAN-DA-2        PIC 999.
   908         16  DC-GREG-DATE-A-EDIT.
   909             20  DC-EDITA-MONTH        PIC 99.
   910             20  SLASHA-1              PIC X VALUE '/'.
   911             20  DC-EDITA-DAY          PIC 99.
   912             20  SLASHA-2              PIC X VALUE '/'.
   913             20  DC-EDITA-CCYY.
   914                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  22
* EL1284.cbl
   915                 24  DC-EDITA-YEAR     PIC 99.
   916         16  DC-GREG-DATE-B-EDIT.
   917             20  DC-EDITB-MONTH        PIC 99.
   918             20  SLASHB-1              PIC X VALUE '/'.
   919             20  DC-EDITB-DAY          PIC 99.
   920             20  SLASHB-2              PIC X VALUE '/'.
   921             20  DC-EDITB-CCYY.
   922                 24  DC-EDITB-CENT     PIC 99.
   923                 24  DC-EDITB-YEAR     PIC 99.
   924         16  DC-GREG-DATE-CYMD         PIC 9(08).
   925         16  DC-GREG-DATE-CYMD-R REDEFINES
   926                              DC-GREG-DATE-CYMD.
   927             20  DC-CYMD-CEN           PIC 99.
   928             20  DC-CYMD-YEAR          PIC 99.
   929             20  DC-CYMD-MONTH         PIC 99.
   930             20  DC-CYMD-DAY           PIC 99.
   931         16  DC-GREG-DATE-MDCY         PIC 9(08).
   932         16  DC-GREG-DATE-MDCY-R REDEFINES
   933                              DC-GREG-DATE-MDCY.
   934             20  DC-MDCY-MONTH         PIC 99.
   935             20  DC-MDCY-DAY           PIC 99.
   936             20  DC-MDCY-CEN           PIC 99.
   937             20  DC-MDCY-YEAR          PIC 99.
   938    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   939        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   940    12  DC-EL310-DATE                  PIC X(21).
   941    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  23
* EL1284.cbl
   943*                          COPY EL1284S.
   944 01  EL1284AI.
   945     05  FILLER            PIC  X(0012).
   946*    -------------------------------
   947     05  DATEL PIC S9(0004) COMP.
   948     05  DATEF PIC  X(0001).
   949     05  FILLER REDEFINES DATEF.
   950         10  DATEA PIC  X(0001).
   951     05  DATEI PIC  X(0008).
   952*    -------------------------------
   953     05  TIMEL PIC S9(0004) COMP.
   954     05  TIMEF PIC  X(0001).
   955     05  FILLER REDEFINES TIMEF.
   956         10  TIMEA PIC  X(0001).
   957     05  TIMEI PIC  X(0005).
   958*    -------------------------------
   959     05  CMPNYIDL PIC S9(0004) COMP.
   960     05  CMPNYIDF PIC  X(0001).
   961     05  FILLER REDEFINES CMPNYIDF.
   962         10  CMPNYIDA PIC  X(0001).
   963     05  CMPNYIDI PIC  X(0003).
   964*    -------------------------------
   965     05  USERIDL PIC S9(0004) COMP.
   966     05  USERIDF PIC  X(0001).
   967     05  FILLER REDEFINES USERIDF.
   968         10  USERIDA PIC  X(0001).
   969     05  USERIDI PIC  X(0004).
   970*    -------------------------------
   971     05  CLAIMNOL PIC S9(0004) COMP.
   972     05  CLAIMNOF PIC  X(0001).
   973     05  FILLER REDEFINES CLAIMNOF.
   974         10  CLAIMNOA PIC  X(0001).
   975     05  CLAIMNOI PIC  X(0007).
   976*    -------------------------------
   977     05  TYPEL PIC S9(0004) COMP.
   978     05  TYPEF PIC  X(0001).
   979     05  FILLER REDEFINES TYPEF.
   980         10  TYPEA PIC  X(0001).
   981     05  TYPEI PIC  X(0006).
   982*    -------------------------------
   983     05  CARRL PIC S9(0004) COMP.
   984     05  CARRF PIC  X(0001).
   985     05  FILLER REDEFINES CARRF.
   986         10  CARRA PIC  X(0001).
   987     05  CARRI PIC  X(0001).
   988*    -------------------------------
   989     05  CERTNOL PIC S9(0004) COMP.
   990     05  CERTNOF PIC  X(0001).
   991     05  FILLER REDEFINES CERTNOF.
   992         10  CERTNOA PIC  X(0001).
   993     05  CERTNOI PIC  X(0011).
   994*    -------------------------------
   995     05  FSTNMEL PIC S9(0004) COMP.
   996     05  FSTNMEF PIC  X(0001).
   997     05  FILLER REDEFINES FSTNMEF.
   998         10  FSTNMEA PIC  X(0001).
   999     05  FSTNMEI PIC  X(0012).
  1000*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  24
* EL1284.cbl
  1001     05  LASTNMEL PIC S9(0004) COMP.
  1002     05  LASTNMEF PIC  X(0001).
  1003     05  FILLER REDEFINES LASTNMEF.
  1004         10  LASTNMEA PIC  X(0001).
  1005     05  LASTNMEI PIC  X(0015).
  1006*    -------------------------------
  1007     05  TOTL PIC S9(0004) COMP.
  1008     05  TOTF PIC  X(0001).
  1009     05  FILLER REDEFINES TOTF.
  1010         10  TOTA PIC  X(0001).
  1011     05  TOTI PIC  X(0003).
  1012*    -------------------------------
  1013     05  LNGHLAPL PIC S9(0004) COMP.
  1014     05  LNGHLAPF PIC  X(0001).
  1015     05  FILLER REDEFINES LNGHLAPF.
  1016         10  LNGHLAPA PIC  X(0001).
  1017     05  LNGHLAPI PIC  X(0001).
  1018*    -------------------------------
  1019     05  REWRITEL PIC S9(0004) COMP.
  1020     05  REWRITEF PIC  X(0001).
  1021     05  FILLER REDEFINES REWRITEF.
  1022         10  REWRITEA PIC  X(0001).
  1023     05  REWRITEI PIC  X(0001).
  1024*    -------------------------------
  1025     05  CHKCOVGL PIC S9(0004) COMP.
  1026     05  CHKCOVGF PIC  X(0001).
  1027     05  FILLER REDEFINES CHKCOVGF.
  1028         10  CHKCOVGA PIC  X(0001).
  1029     05  CHKCOVGI PIC  X(0001).
  1030*    -------------------------------
  1031     05  MRRELDTL PIC S9(0004) COMP.
  1032     05  MRRELDTF PIC  X(0001).
  1033     05  FILLER REDEFINES MRRELDTF.
  1034         10  MRRELDTA PIC  X(0001).
  1035     05  MRRELDTI PIC  X(0008).
  1036*    -------------------------------
  1037     05  LN1L PIC S9(0004) COMP.
  1038     05  LN1F PIC  X(0001).
  1039     05  FILLER REDEFINES LN1F.
  1040         10  LN1A PIC  X(0001).
  1041     05  LN1I PIC  X(0003).
  1042*    -------------------------------
  1043     05  FNLINE1L PIC S9(0004) COMP.
  1044     05  FNLINE1F PIC  X(0001).
  1045     05  FILLER REDEFINES FNLINE1F.
  1046         10  FNLINE1A PIC  X(0001).
  1047     05  FNLINE1I PIC  X(0063).
  1048*    -------------------------------
  1049     05  MTBY1L PIC S9(0004) COMP.
  1050     05  MTBY1F PIC  X(0001).
  1051     05  FILLER REDEFINES MTBY1F.
  1052         10  MTBY1A PIC  X(0001).
  1053     05  MTBY1I PIC  X(0004).
  1054*    -------------------------------
  1055     05  MTDT1L PIC S9(0004) COMP.
  1056     05  MTDT1F PIC  X(0001).
  1057     05  FILLER REDEFINES MTDT1F.
  1058         10  MTDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  25
* EL1284.cbl
  1059     05  MTDT1I PIC  X(0006).
  1060*    -------------------------------
  1061     05  LN2L PIC S9(0004) COMP.
  1062     05  LN2F PIC  X(0001).
  1063     05  FILLER REDEFINES LN2F.
  1064         10  LN2A PIC  X(0001).
  1065     05  LN2I PIC  X(0003).
  1066*    -------------------------------
  1067     05  FNLINE2L PIC S9(0004) COMP.
  1068     05  FNLINE2F PIC  X(0001).
  1069     05  FILLER REDEFINES FNLINE2F.
  1070         10  FNLINE2A PIC  X(0001).
  1071     05  FNLINE2I PIC  X(0063).
  1072*    -------------------------------
  1073     05  MTBY2L PIC S9(0004) COMP.
  1074     05  MTBY2F PIC  X(0001).
  1075     05  FILLER REDEFINES MTBY2F.
  1076         10  MTBY2A PIC  X(0001).
  1077     05  MTBY2I PIC  X(0004).
  1078*    -------------------------------
  1079     05  MTDT2L PIC S9(0004) COMP.
  1080     05  MTDT2F PIC  X(0001).
  1081     05  FILLER REDEFINES MTDT2F.
  1082         10  MTDT2A PIC  X(0001).
  1083     05  MTDT2I PIC  X(0006).
  1084*    -------------------------------
  1085     05  LN3L PIC S9(0004) COMP.
  1086     05  LN3F PIC  X(0001).
  1087     05  FILLER REDEFINES LN3F.
  1088         10  LN3A PIC  X(0001).
  1089     05  LN3I PIC  X(0003).
  1090*    -------------------------------
  1091     05  FNLINE3L PIC S9(0004) COMP.
  1092     05  FNLINE3F PIC  X(0001).
  1093     05  FILLER REDEFINES FNLINE3F.
  1094         10  FNLINE3A PIC  X(0001).
  1095     05  FNLINE3I PIC  X(0063).
  1096*    -------------------------------
  1097     05  MTBY3L PIC S9(0004) COMP.
  1098     05  MTBY3F PIC  X(0001).
  1099     05  FILLER REDEFINES MTBY3F.
  1100         10  MTBY3A PIC  X(0001).
  1101     05  MTBY3I PIC  X(0004).
  1102*    -------------------------------
  1103     05  MTDT3L PIC S9(0004) COMP.
  1104     05  MTDT3F PIC  X(0001).
  1105     05  FILLER REDEFINES MTDT3F.
  1106         10  MTDT3A PIC  X(0001).
  1107     05  MTDT3I PIC  X(0006).
  1108*    -------------------------------
  1109     05  LN4L PIC S9(0004) COMP.
  1110     05  LN4F PIC  X(0001).
  1111     05  FILLER REDEFINES LN4F.
  1112         10  LN4A PIC  X(0001).
  1113     05  LN4I PIC  X(0003).
  1114*    -------------------------------
  1115     05  FNLINE4L PIC S9(0004) COMP.
  1116     05  FNLINE4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  26
* EL1284.cbl
  1117     05  FILLER REDEFINES FNLINE4F.
  1118         10  FNLINE4A PIC  X(0001).
  1119     05  FNLINE4I PIC  X(0063).
  1120*    -------------------------------
  1121     05  MTBY4L PIC S9(0004) COMP.
  1122     05  MTBY4F PIC  X(0001).
  1123     05  FILLER REDEFINES MTBY4F.
  1124         10  MTBY4A PIC  X(0001).
  1125     05  MTBY4I PIC  X(0004).
  1126*    -------------------------------
  1127     05  MTDT4L PIC S9(0004) COMP.
  1128     05  MTDT4F PIC  X(0001).
  1129     05  FILLER REDEFINES MTDT4F.
  1130         10  MTDT4A PIC  X(0001).
  1131     05  MTDT4I PIC  X(0006).
  1132*    -------------------------------
  1133     05  LN5L PIC S9(0004) COMP.
  1134     05  LN5F PIC  X(0001).
  1135     05  FILLER REDEFINES LN5F.
  1136         10  LN5A PIC  X(0001).
  1137     05  LN5I PIC  X(0003).
  1138*    -------------------------------
  1139     05  FNLINE5L PIC S9(0004) COMP.
  1140     05  FNLINE5F PIC  X(0001).
  1141     05  FILLER REDEFINES FNLINE5F.
  1142         10  FNLINE5A PIC  X(0001).
  1143     05  FNLINE5I PIC  X(0063).
  1144*    -------------------------------
  1145     05  MTBY5L PIC S9(0004) COMP.
  1146     05  MTBY5F PIC  X(0001).
  1147     05  FILLER REDEFINES MTBY5F.
  1148         10  MTBY5A PIC  X(0001).
  1149     05  MTBY5I PIC  X(0004).
  1150*    -------------------------------
  1151     05  MTDT5L PIC S9(0004) COMP.
  1152     05  MTDT5F PIC  X(0001).
  1153     05  FILLER REDEFINES MTDT5F.
  1154         10  MTDT5A PIC  X(0001).
  1155     05  MTDT5I PIC  X(0006).
  1156*    -------------------------------
  1157     05  LN6L PIC S9(0004) COMP.
  1158     05  LN6F PIC  X(0001).
  1159     05  FILLER REDEFINES LN6F.
  1160         10  LN6A PIC  X(0001).
  1161     05  LN6I PIC  X(0003).
  1162*    -------------------------------
  1163     05  FNLINE6L PIC S9(0004) COMP.
  1164     05  FNLINE6F PIC  X(0001).
  1165     05  FILLER REDEFINES FNLINE6F.
  1166         10  FNLINE6A PIC  X(0001).
  1167     05  FNLINE6I PIC  X(0063).
  1168*    -------------------------------
  1169     05  MTBY6L PIC S9(0004) COMP.
  1170     05  MTBY6F PIC  X(0001).
  1171     05  FILLER REDEFINES MTBY6F.
  1172         10  MTBY6A PIC  X(0001).
  1173     05  MTBY6I PIC  X(0004).
  1174*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  27
* EL1284.cbl
  1175     05  MTDT6L PIC S9(0004) COMP.
  1176     05  MTDT6F PIC  X(0001).
  1177     05  FILLER REDEFINES MTDT6F.
  1178         10  MTDT6A PIC  X(0001).
  1179     05  MTDT6I PIC  X(0006).
  1180*    -------------------------------
  1181     05  LN7L PIC S9(0004) COMP.
  1182     05  LN7F PIC  X(0001).
  1183     05  FILLER REDEFINES LN7F.
  1184         10  LN7A PIC  X(0001).
  1185     05  LN7I PIC  X(0003).
  1186*    -------------------------------
  1187     05  FNLINE7L PIC S9(0004) COMP.
  1188     05  FNLINE7F PIC  X(0001).
  1189     05  FILLER REDEFINES FNLINE7F.
  1190         10  FNLINE7A PIC  X(0001).
  1191     05  FNLINE7I PIC  X(0063).
  1192*    -------------------------------
  1193     05  MTBY7L PIC S9(0004) COMP.
  1194     05  MTBY7F PIC  X(0001).
  1195     05  FILLER REDEFINES MTBY7F.
  1196         10  MTBY7A PIC  X(0001).
  1197     05  MTBY7I PIC  X(0004).
  1198*    -------------------------------
  1199     05  MTDT7L PIC S9(0004) COMP.
  1200     05  MTDT7F PIC  X(0001).
  1201     05  FILLER REDEFINES MTDT7F.
  1202         10  MTDT7A PIC  X(0001).
  1203     05  MTDT7I PIC  X(0006).
  1204*    -------------------------------
  1205     05  LN8L PIC S9(0004) COMP.
  1206     05  LN8F PIC  X(0001).
  1207     05  FILLER REDEFINES LN8F.
  1208         10  LN8A PIC  X(0001).
  1209     05  LN8I PIC  X(0003).
  1210*    -------------------------------
  1211     05  FNLINE8L PIC S9(0004) COMP.
  1212     05  FNLINE8F PIC  X(0001).
  1213     05  FILLER REDEFINES FNLINE8F.
  1214         10  FNLINE8A PIC  X(0001).
  1215     05  FNLINE8I PIC  X(0063).
  1216*    -------------------------------
  1217     05  MTBY8L PIC S9(0004) COMP.
  1218     05  MTBY8F PIC  X(0001).
  1219     05  FILLER REDEFINES MTBY8F.
  1220         10  MTBY8A PIC  X(0001).
  1221     05  MTBY8I PIC  X(0004).
  1222*    -------------------------------
  1223     05  MTDT8L PIC S9(0004) COMP.
  1224     05  MTDT8F PIC  X(0001).
  1225     05  FILLER REDEFINES MTDT8F.
  1226         10  MTDT8A PIC  X(0001).
  1227     05  MTDT8I PIC  X(0006).
  1228*    -------------------------------
  1229     05  LN9L PIC S9(0004) COMP.
  1230     05  LN9F PIC  X(0001).
  1231     05  FILLER REDEFINES LN9F.
  1232         10  LN9A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  28
* EL1284.cbl
  1233     05  LN9I PIC  X(0003).
  1234*    -------------------------------
  1235     05  FNLINE9L PIC S9(0004) COMP.
  1236     05  FNLINE9F PIC  X(0001).
  1237     05  FILLER REDEFINES FNLINE9F.
  1238         10  FNLINE9A PIC  X(0001).
  1239     05  FNLINE9I PIC  X(0063).
  1240*    -------------------------------
  1241     05  MTBY9L PIC S9(0004) COMP.
  1242     05  MTBY9F PIC  X(0001).
  1243     05  FILLER REDEFINES MTBY9F.
  1244         10  MTBY9A PIC  X(0001).
  1245     05  MTBY9I PIC  X(0004).
  1246*    -------------------------------
  1247     05  MTDT9L PIC S9(0004) COMP.
  1248     05  MTDT9F PIC  X(0001).
  1249     05  FILLER REDEFINES MTDT9F.
  1250         10  MTDT9A PIC  X(0001).
  1251     05  MTDT9I PIC  X(0006).
  1252*    -------------------------------
  1253     05  LN10L PIC S9(0004) COMP.
  1254     05  LN10F PIC  X(0001).
  1255     05  FILLER REDEFINES LN10F.
  1256         10  LN10A PIC  X(0001).
  1257     05  LN10I PIC  X(0003).
  1258*    -------------------------------
  1259     05  FNLIN10L PIC S9(0004) COMP.
  1260     05  FNLIN10F PIC  X(0001).
  1261     05  FILLER REDEFINES FNLIN10F.
  1262         10  FNLIN10A PIC  X(0001).
  1263     05  FNLIN10I PIC  X(0063).
  1264*    -------------------------------
  1265     05  MTBY10L PIC S9(0004) COMP.
  1266     05  MTBY10F PIC  X(0001).
  1267     05  FILLER REDEFINES MTBY10F.
  1268         10  MTBY10A PIC  X(0001).
  1269     05  MTBY10I PIC  X(0004).
  1270*    -------------------------------
  1271     05  MTDT10L PIC S9(0004) COMP.
  1272     05  MTDT10F PIC  X(0001).
  1273     05  FILLER REDEFINES MTDT10F.
  1274         10  MTDT10A PIC  X(0001).
  1275     05  MTDT10I PIC  X(0006).
  1276*    -------------------------------
  1277     05  ERRMSGBL PIC S9(0004) COMP.
  1278     05  ERRMSGBF PIC  X(0001).
  1279     05  FILLER REDEFINES ERRMSGBF.
  1280         10  ERRMSGBA PIC  X(0001).
  1281     05  ERRMSGBI PIC  X(0072).
  1282*    -------------------------------
  1283     05  FUNCTL PIC S9(0004) COMP.
  1284     05  FUNCTF PIC  X(0001).
  1285     05  FILLER REDEFINES FUNCTF.
  1286         10  FUNCTA PIC  X(0001).
  1287     05  FUNCTI PIC  X(0001).
  1288*    -------------------------------
  1289     05  LINE1L PIC S9(0004) COMP.
  1290     05  LINE1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  29
* EL1284.cbl
  1291     05  FILLER REDEFINES LINE1F.
  1292         10  LINE1A PIC  X(0001).
  1293     05  LINE1I PIC  999.
  1294*    -------------------------------
  1295     05  LINE2L PIC S9(0004) COMP.
  1296     05  LINE2F PIC  X(0001).
  1297     05  FILLER REDEFINES LINE2F.
  1298         10  LINE2A PIC  X(0001).
  1299     05  LINE2I PIC  999.
  1300*    -------------------------------
  1301     05  PFENTERL PIC S9(0004) COMP.
  1302     05  PFENTERF PIC  X(0001).
  1303     05  FILLER REDEFINES PFENTERF.
  1304         10  PFENTERA PIC  X(0001).
  1305     05  PFENTERI PIC  99.
  1306*    -------------------------------
  1307     05  PF6NOTEL PIC S9(0004) COMP.
  1308     05  PF6NOTEF PIC  X(0001).
  1309     05  FILLER REDEFINES PF6NOTEF.
  1310         10  PF6NOTEA PIC  X(0001).
  1311     05  PF6NOTEI PIC  X(0017).
  1312 01  EL1284AO REDEFINES EL1284AI.
  1313     05  FILLER            PIC  X(0012).
  1314*    -------------------------------
  1315     05  FILLER            PIC  X(0003).
  1316     05  DATEO PIC  X(0008).
  1317*    -------------------------------
  1318     05  FILLER            PIC  X(0003).
  1319     05  TIMEO PIC  99.99.
  1320*    -------------------------------
  1321     05  FILLER            PIC  X(0003).
  1322     05  CMPNYIDO PIC  X(0003).
  1323*    -------------------------------
  1324     05  FILLER            PIC  X(0003).
  1325     05  USERIDO PIC  X(0004).
  1326*    -------------------------------
  1327     05  FILLER            PIC  X(0003).
  1328     05  CLAIMNOO PIC  X(0007).
  1329*    -------------------------------
  1330     05  FILLER            PIC  X(0003).
  1331     05  TYPEO PIC  X(0006).
  1332*    -------------------------------
  1333     05  FILLER            PIC  X(0003).
  1334     05  CARRO PIC  X(0001).
  1335*    -------------------------------
  1336     05  FILLER            PIC  X(0003).
  1337     05  CERTNOO PIC  X(0011).
  1338*    -------------------------------
  1339     05  FILLER            PIC  X(0003).
  1340     05  FSTNMEO PIC  X(0012).
  1341*    -------------------------------
  1342     05  FILLER            PIC  X(0003).
  1343     05  LASTNMEO PIC  X(0015).
  1344*    -------------------------------
  1345     05  FILLER            PIC  X(0003).
  1346     05  TOTO PIC  ZZ9.
  1347*    -------------------------------
  1348     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  30
* EL1284.cbl
  1349     05  LNGHLAPO PIC  X(0001).
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(0003).
  1352     05  REWRITEO PIC  X(0001).
  1353*    -------------------------------
  1354     05  FILLER            PIC  X(0003).
  1355     05  CHKCOVGO PIC  X(0001).
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(0003).
  1358     05  MRRELDTO PIC  X(0008).
  1359*    -------------------------------
  1360     05  FILLER            PIC  X(0003).
  1361     05  LN1O PIC  ZZ9.
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(0003).
  1364     05  FNLINE1O PIC  X(0063).
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(0003).
  1367     05  MTBY1O PIC  X(0004).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(0003).
  1370     05  MTDT1O PIC  X(0006).
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(0003).
  1373     05  LN2O PIC  ZZ9.
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(0003).
  1376     05  FNLINE2O PIC  X(0063).
  1377*    -------------------------------
  1378     05  FILLER            PIC  X(0003).
  1379     05  MTBY2O PIC  X(0004).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(0003).
  1382     05  MTDT2O PIC  X(0006).
  1383*    -------------------------------
  1384     05  FILLER            PIC  X(0003).
  1385     05  LN3O PIC  ZZ9.
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(0003).
  1388     05  FNLINE3O PIC  X(0063).
  1389*    -------------------------------
  1390     05  FILLER            PIC  X(0003).
  1391     05  MTBY3O PIC  X(0004).
  1392*    -------------------------------
  1393     05  FILLER            PIC  X(0003).
  1394     05  MTDT3O PIC  X(0006).
  1395*    -------------------------------
  1396     05  FILLER            PIC  X(0003).
  1397     05  LN4O PIC  ZZ9.
  1398*    -------------------------------
  1399     05  FILLER            PIC  X(0003).
  1400     05  FNLINE4O PIC  X(0063).
  1401*    -------------------------------
  1402     05  FILLER            PIC  X(0003).
  1403     05  MTBY4O PIC  X(0004).
  1404*    -------------------------------
  1405     05  FILLER            PIC  X(0003).
  1406     05  MTDT4O PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  31
* EL1284.cbl
  1407*    -------------------------------
  1408     05  FILLER            PIC  X(0003).
  1409     05  LN5O PIC  ZZ9.
  1410*    -------------------------------
  1411     05  FILLER            PIC  X(0003).
  1412     05  FNLINE5O PIC  X(0063).
  1413*    -------------------------------
  1414     05  FILLER            PIC  X(0003).
  1415     05  MTBY5O PIC  X(0004).
  1416*    -------------------------------
  1417     05  FILLER            PIC  X(0003).
  1418     05  MTDT5O PIC  X(0006).
  1419*    -------------------------------
  1420     05  FILLER            PIC  X(0003).
  1421     05  LN6O PIC  ZZ9.
  1422*    -------------------------------
  1423     05  FILLER            PIC  X(0003).
  1424     05  FNLINE6O PIC  X(0063).
  1425*    -------------------------------
  1426     05  FILLER            PIC  X(0003).
  1427     05  MTBY6O PIC  X(0004).
  1428*    -------------------------------
  1429     05  FILLER            PIC  X(0003).
  1430     05  MTDT6O PIC  X(0006).
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(0003).
  1433     05  LN7O PIC  ZZ9.
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  FNLINE7O PIC  X(0063).
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  MTBY7O PIC  X(0004).
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  MTDT7O PIC  X(0006).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
  1445     05  LN8O PIC  ZZ9.
  1446*    -------------------------------
  1447     05  FILLER            PIC  X(0003).
  1448     05  FNLINE8O PIC  X(0063).
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
  1451     05  MTBY8O PIC  X(0004).
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  MTDT8O PIC  X(0006).
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  LN9O PIC  ZZ9.
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  FNLINE9O PIC  X(0063).
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  MTBY9O PIC  X(0004).
  1464*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  32
* EL1284.cbl
  1465     05  FILLER            PIC  X(0003).
  1466     05  MTDT9O PIC  X(0006).
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  LN10O PIC  ZZ9.
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  FNLIN10O PIC  X(0063).
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  MTBY10O PIC  X(0004).
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  MTDT10O PIC  X(0006).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  ERRMSGBO PIC  X(0072).
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
  1484     05  FUNCTO PIC  X(0001).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  LINE1O PIC  X(0003).
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  LINE2O PIC  X(0003).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  PFENTERO PIC  X(0002).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  PF6NOTEO PIC  X(0017).
  1497*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  33
* EL1284.cbl
  1499*01  EL1284R REDEFINES EL1284AI.
  1500 66 GROUP2  RENAMES LN1L THRU MTDT10I.
  1501 01  EL1284R.
  1502*    12  FILLER                  PIC X(202).
  1503     12  SC-ALL-LINES.
  1504      14 SC-LINES OCCURS 10 TIMES INDEXED BY SC-INDX.
  1505         16  SC-LINL             PIC S9(4)   COMP.
  1506         16  SC-LINA             PIC X.
  1507         16  SC-LIN              PIC ZZ9.
  1508         16  SC-TEXTL            PIC S9(4)   COMP.
  1509         16  SC-TEXTA            PIC X.
  1510         16  SC-TEXT             PIC X(63).
  1511         16  SC-MTBYL            PIC S9(4)   COMP.
  1512         16  SC-MTBYA            PIC X.
  1513         16  SC-MTBY             PIC X(4).
  1514         16  SC-MTDTL            PIC S9(4)   COMP.
  1515         16  SC-MTDTA            PIC X.
  1516         16  SC-MTDT             PIC X(6).
  1517*    12  FILLER                  PIC X(116).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  34
* EL1284.cbl
  1519 01  RECORD-TABLE                PIC X(21900) VALUE SPACES.
  1520 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1521     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3650).
  1522 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1523     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  1524         16  REC-TEXT                    PIC X(63).
  1525         16  REC-LAST-MAINT-BY           PIC XXXX.
  1526         16  REC-LAST-MAINT-DT           PIC XX.
  1527         16  REC-LAST-MAINT-HHMMSS       PIC S9(7) COMP-3.
  1528
  1529 01  TS-WORK-AREA                        PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  35
* EL1284.cbl
  1531*        COPY ELCMSTR.
  1532******************************************************************
  1533*                                                                *
  1534*                            ELCMSTR.                            *
  1535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1536*                            VMOD=2.012                          *
  1537*                                                                *
  1538*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1539*                                                                *
  1540*   FILE TYPE = VSAM,KSDS                                        *
  1541*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1542*                                                                *
  1543*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1544*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1545*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1546*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1547*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1548*                                                 RKP=75,LEN=21  *
  1549*                                                                *
  1550*   **** NOTE ****                                               *
  1551*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1552*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1553*                                                                *
  1554*   LOG = YES                                                    *
  1555*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1556******************************************************************
  1557*                   C H A N G E   L O G
  1558*
  1559* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1560*-----------------------------------------------------------------
  1561*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1562* EFFECTIVE    NUMBER
  1563*-----------------------------------------------------------------
  1564* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1565* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1566* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1567* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1568* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1569******************************************************************
  1570 01  CLAIM-MASTER.
  1571     12  CL-RECORD-ID                PIC XX.
  1572         88  VALID-CL-ID         VALUE 'CL'.
  1573
  1574     12  CL-CONTROL-PRIMARY.
  1575         16  CL-COMPANY-CD           PIC X.
  1576         16  CL-CARRIER              PIC X.
  1577         16  CL-CLAIM-NO             PIC X(7).
  1578         16  CL-CERT-NO.
  1579             20  CL-CERT-PRIME       PIC X(10).
  1580             20  CL-CERT-SFX         PIC X.
  1581
  1582     12  CL-CONTROL-BY-NAME.
  1583         16  CL-COMPANY-CD-A1        PIC X.
  1584         16  CL-INSURED-LAST-NAME    PIC X(15).
  1585         16  CL-INSURED-NAME.
  1586             20  CL-INSURED-1ST-NAME PIC X(12).
  1587             20  CL-INSURED-MID-INIT PIC X.
  1588
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  36
* EL1284.cbl
  1589     12  CL-CONTROL-BY-SSN.
  1590         16  CL-COMPANY-CD-A2        PIC X.
  1591         16  CL-SOC-SEC-NO.
  1592             20  CL-SSN-STATE        PIC XX.
  1593             20  CL-SSN-ACCOUNT      PIC X(6).
  1594             20  CL-SSN-LN3          PIC X(3).
  1595
  1596     12  CL-CONTROL-BY-CERT-NO.
  1597         16  CL-COMPANY-CD-A4        PIC X.
  1598         16  CL-CERT-NO-A4.
  1599             20  CL-CERT-A4-PRIME    PIC X(10).
  1600             20  CL-CERT-A4-SFX      PIC X.
  1601
  1602     12  CL-CONTROL-BY-CCN.
  1603         16  CL-COMPANY-CD-A5        PIC X.
  1604         16  CL-CCN-A5.
  1605             20  CL-CCN.
  1606                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1607                 24  CL-CCN-PRIME-A5 PIC X(12).
  1608             20  CL-CCN-FILLER-A5    PIC X(4).
  1609
  1610     12  CL-INSURED-PROFILE-DATA.
  1611         16  CL-INSURED-BIRTH-DT     PIC XX.
  1612         16  CL-INSURED-SEX-CD       PIC X.
  1613             88  INSURED-IS-MALE        VALUE 'M'.
  1614             88  INSURED-IS-FEMALE      VALUE 'F'.
  1615             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1616         16  CL-INSURED-OCC-CD       PIC X(6).
  1617         16  FILLER                  PIC X(5).
  1618
  1619     12  CL-PROCESSING-INFO.
  1620         16  CL-PROCESSOR-ID         PIC X(4).
  1621         16  CL-CLAIM-STATUS         PIC X.
  1622             88  CLAIM-IS-OPEN          VALUE 'O'.
  1623             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1624         16  CL-CLAIM-TYPE           PIC X.
  1625*            88  AH-CLAIM               VALUE 'A'.
  1626*            88  LIFE-CLAIM             VALUE 'L'.
  1627*            88  PROPERTY-CLAIM         VALUE 'P'.
  1628*            88  IUI-CLAIM              VALUE 'I'.
  1629*            88  GAP-CLAIM              VALUE 'G'.
  1630*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1631         16  CL-CLAIM-PREM-TYPE      PIC X.
  1632             88  SINGLE-PREMIUM         VALUE '1'.
  1633             88  O-B-COVERAGE           VALUE '2'.
  1634             88  OPEN-END-COVERAGE      VALUE '3'.
  1635         16  CL-INCURRED-DT          PIC XX.
  1636         16  CL-REPORTED-DT          PIC XX.
  1637         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1638         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1639         16  CL-LAST-PMT-DT          PIC XX.
  1640         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1641         16  CL-PAID-THRU-DT         PIC XX.
  1642         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1643         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1644         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1645         16  CL-PMT-CALC-METHOD      PIC X.
  1646             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  37
* EL1284.cbl
  1647             88  CL-365-DAY-YR          VALUE '2'.
  1648             88  CL-FULL-MONTHS         VALUE '3'.
  1649         16  CL-CAUSE-CD             PIC X(6).
  1650
  1651         16  CL-PRIME-CERT-NO.
  1652             20  CL-PRIME-CERT-PRIME PIC X(10).
  1653             20  CL-PRIME-CERT-SFX   PIC X.
  1654
  1655         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1656             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1657             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1658
  1659         16  CL-MICROFILM-NO         PIC X(10).
  1660         16  FILLER REDEFINES CL-MICROFILM-NO.
  1661             20  CL-BENEFIT-PERIOD   PIC 99.
  1662             20  FILLER              PIC X(8).
  1663         16  CL-PROG-FORM-TYPE       PIC X.
  1664         16  CL-LAST-ADD-ON-DT       PIC XX.
  1665
  1666         16  CL-LAST-REOPEN-DT       PIC XX.
  1667         16  CL-LAST-CLOSE-DT        PIC XX.
  1668         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1669             88  FINAL-PAID             VALUE '1'.
  1670             88  CLAIM-DENIED           VALUE '2'.
  1671             88  AUTO-CLOSE             VALUE '3'.
  1672             88  MANUAL-CLOSE           VALUE '4'.
  1673             88  BENEFITS-CHANGED       VALUE 'C'.
  1674             88  SETUP-ERRORS           VALUE 'E'.
  1675         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1676         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1677         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1678             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1679         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1680         16  FILLER                  PIC X.
  1681
  1682     12  CL-CERTIFICATE-DATA.
  1683         16  CL-CERT-ORIGIN          PIC X.
  1684             88  CERT-WAS-ONLINE        VALUE '1'.
  1685             88  CERT-WAS-CREATED       VALUE '2'.
  1686             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1687         16  CL-CERT-KEY-DATA.
  1688             20  CL-CERT-CARRIER     PIC X.
  1689             20  CL-CERT-GROUPING    PIC X(6).
  1690             20  CL-CERT-STATE       PIC XX.
  1691             20  CL-CERT-ACCOUNT.
  1692                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1693                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1694             20  CL-CERT-EFF-DT      PIC XX.
  1695
  1696     12  CL-STATUS-CONTROLS.
  1697         16  CL-PRIORITY-CD          PIC X.
  1698             88  CONFIDENTIAL-DATA      VALUE '8'.
  1699             88  HIGHEST-PRIORITY       VALUE '9'.
  1700         16  CL-SUPV-ATTN-CD         PIC X.
  1701             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1702             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1703         16  CL-PURGED-DT            PIC XX.
  1704         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  38
* EL1284.cbl
  1705         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1706         16  CL-NEXT-RESEND-DT       PIC XX.
  1707         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1708         16  CL-CRITICAL-PERIOD      PIC 99.
  1709*        16  FILLER                  PIC XX.
  1710         16  CL-LAST-MAINT-DT        PIC XX.
  1711         16  CL-LAST-MAINT-USER      PIC X(4).
  1712         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1713         16  CL-LAST-MAINT-TYPE      PIC X.
  1714             88  CLAIM-SET-UP           VALUE ' '.
  1715             88  PAYMENT-MADE           VALUE '1'.
  1716             88  LETTER-SENT            VALUE '2'.
  1717             88  MASTER-WAS-ALTERED     VALUE '3'.
  1718             88  MASTER-WAS-RESTORED    VALUE '4'.
  1719             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1720             88  FILE-CONVERTED         VALUE '6'.
  1721             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1722             88  ERROR-CORRECTION       VALUE 'E'.
  1723         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1724         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1725         16  CL-BENEFICIARY          PIC X(10).
  1726         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1727         16  CL-DENIAL-TYPE          PIC X.
  1728             88  CL-TYPE-DENIAL          VALUE '1'.
  1729             88  CL-TYPE-RESCISSION      VALUE '2'.
  1730             88  CL-TYPE-REFORMATION     VALUE '3'.
  1731             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1732             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1733         16  filler                  pic x(5).
  1734*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1735*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1736*        16  CL-RTW-DT               PIC XX.
  1737
  1738     12  CL-TRAILER-CONTROLS.
  1739         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1740             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1741             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1742             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1743         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1744         16  FILLER                  PIC XX.
  1745         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1746         16  CL-ADDRESS-TRAILER-CNT.
  1747             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1748                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1749             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1750                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1751             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1752                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1753             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1754                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1755             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1756                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1757             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1758                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1759             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1760                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1761
  1762     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  39
* EL1284.cbl
  1763         16  CL-CV-REFNO-PRIME       PIC X(18).
  1764         16  CL-CV-REFNO-SFX         PIC XX.
  1765
  1766     12  CL-FILE-LOCATION            PIC X(4).
  1767
  1768     12  CL-PROCESS-ERRORS.
  1769         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1770             88  NO-FATAL-ERRORS        VALUE ZERO.
  1771         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1772             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1773
  1774     12  CL-PRODUCT-CD               PIC X.
  1775
  1776     12  CL-CURRENT-KEY-DATA.
  1777         16  CL-CURRENT-CARRIER      PIC X.
  1778         16  CL-CURRENT-GROUPING     PIC X(6).
  1779         16  CL-CURRENT-STATE        PIC XX.
  1780         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1781
  1782     12  CL-ASSOCIATES               PIC X.
  1783         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1784         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1785         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1786         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1787
  1788     12  CL-ACTIVITY-CODE            PIC 99.
  1789     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1790     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1791
  1792     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1793     12  CL-LAG-REPORT-CODE          PIC 9.
  1794     12  CL-LOAN-TYPE                PIC XX.
  1795     12  CL-LEGAL-STATE              PIC XX.
  1796
  1797     12  CL-YESNOSW                  PIC X.
  1798     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1799         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1800         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1801         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1802     12  cl-insured-type             pic x.
  1803         88  cl-claim-on-primary         value 'P'.
  1804         88  cl-claim-on-co-borrower     value 'C'.
  1805     12  cl-benefit-expiration-dt    PIC XX.
  1806****************************************************************
  1807*
  1808* Copyright (c) 2007 by Clerity Solutions, Inc.
  1809* All rights reserved.
  1810*
  1811****************************************************************
  1812 01  DFHEIV.
  1813   02  DFHEIV0               PIC X(35).
  1814   02  DFHEIV1               PIC X(08).
  1815   02  DFHEIV2               PIC X(08).
  1816   02  DFHEIV3               PIC X(08).
  1817   02  DFHEIV4               PIC X(06).
  1818   02  DFHEIV5               PIC X(04).
  1819   02  DFHEIV6               PIC X(04).
  1820   02  DFHEIV7               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  40
* EL1284.cbl
  1821   02  DFHEIV8               PIC X(02).
  1822   02  DFHEIV9               PIC X(01).
  1823   02  DFHEIV10              PIC S9(7) COMP-3.
  1824   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1825   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1826   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1827   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1828   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1829   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1830   02  DFHEIV17              PIC X(04).
  1831   02  DFHEIV18              PIC X(04).
  1832   02  DFHEIV19              PIC X(04).
  1833   02  DFHEIV20              USAGE IS POINTER.
  1834   02  DFHEIV21              USAGE IS POINTER.
  1835   02  DFHEIV22              USAGE IS POINTER.
  1836   02  DFHEIV23              USAGE IS POINTER.
  1837   02  DFHEIV24              USAGE IS POINTER.
  1838   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1839   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1840   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1841   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1842   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1843   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1844   02  FILLER                PIC X(02).
  1845   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1846   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1847   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1848   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1849   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1850 LINKAGE  SECTION.
  1851*****************************************************************
  1852*                                                               *
  1853* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1854* All rights reserved.                                          *
  1855*                                                               *
  1856*****************************************************************
  1857 01  dfheiblk.
  1858     02  eibtime          pic s9(7) comp-3.
  1859     02  eibdate          pic s9(7) comp-3.
  1860     02  eibtrnid         pic x(4).
  1861     02  eibtaskn         pic s9(7) comp-3.
  1862     02  eibtrmid         pic x(4).
  1863     02  dfheigdi         pic s9(4) comp.
  1864     02  eibcposn         pic s9(4) comp.
  1865     02  eibcalen         pic s9(4) comp.
  1866     02  eibaid           pic x(1).
  1867     02  eibfiller1       pic x(1).
  1868     02  eibfn            pic x(2).
  1869     02  eibfiller2       pic x(2).
  1870     02  eibrcode         pic x(6).
  1871     02  eibfiller3       pic x(2).
  1872     02  eibds            pic x(8).
  1873     02  eibreqid         pic x(8).
  1874     02  eibrsrce         pic x(8).
  1875     02  eibsync          pic x(1).
  1876     02  eibfree          pic x(1).
  1877     02  eibrecv          pic x(1).
  1878     02  eibsend          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  41
* EL1284.cbl
  1879     02  eibatt           pic x(1).
  1880     02  eibeoc           pic x(1).
  1881     02  eibfmh           pic x(1).
  1882     02  eibcompl         pic x(1).
  1883     02  eibsig           pic x(1).
  1884     02  eibconf          pic x(1).
  1885     02  eiberr           pic x(1).
  1886     02  eibrldbk         pic x(1).
  1887     02  eiberrcd         pic x(4).
  1888     02  eibsynrb         pic x(1).
  1889     02  eibnodat         pic x(1).
  1890     02  eibfiller5       pic x(2).
  1891     02  eibresp          pic 9(09) comp.
  1892     02  eibresp2         pic 9(09) comp.
  1893     02  dfheigdj         pic s9(4) comp.
  1894     02  dfheigdk         pic s9(4) comp.
  1895 01  DFHCOMMAREA                 PIC X(1500).
  1896
  1897*        COPY ELCMEMO.
  1898******************************************************************
  1899*                                                                *
  1900*                                                                *
  1901*                           ELCMEMO.                             *
  1902*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE           *
  1903*                                                                *
  1904*                                                                *
  1905*   FILE DESCRIPTION = CLAIM MEMO NOTES                          *
  1906*                                                                *
  1907*   FILE TYPE = VSAM,KSDS                                        *
  1908*   RECORD SIZE = 132    RECFORM = FIXED                         *
  1909*                                                                *
  1910*   BASE CLUSTER NAME = ELMEMO             RKP=2,LEN=23          *
  1911*       ALTERNATE INDEX = NONE                                   *
  1912*                                                                *
  1913*   LOG = YES                                                    *
  1914*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1915******************************************************************
  1916 01  CLAIM-MEMO-FILE.
  1917     12  MM-RECORD-ID                  PIC  XX.
  1918         88  VALID-MM-ID                    VALUE 'MM'.
  1919     12  MM-CONTROL-PRIMARY.
  1920       16  MM-COMPANY-CD               PIC  X.
  1921       16  MM-RECORD-TYPE              PIC  X.
  1922           88  MM-HDR-REC                   VALUE '1'.
  1923           88  MM-DETAIL-REC                VALUE '2'.
  1924       16  MM-CARRIER                  PIC  X.
  1925       16  MM-CLAIM-NO                 PIC  X(7).
  1926       16  MM-CERT-NO.
  1927           20  MM-CERT-PRIME           PIC  X(10).
  1928           20  MM-CERT-SFX             PIC  X.
  1929       16  MM-PAYMENT-SEQ-NO           PIC  S9(4)  COMP.
  1930
  1931   12  MM-CLAIM-MEMO                   PIC  X(63).
  1932   12  MM-HEADER-INFO REDEFINES MM-CLAIM-MEMO.
  1933       16  MM-LONG-HEALTH-APP          PIC  X(01).
  1934       16  MM-REWRITE-IND              PIC  X(01).
  1935       16  MM-CHECKED-OTHER-COVG       PIC  X(01).
  1936       16  MM-MR-RELEASED-FROM-DATE    PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  42
* EL1284.cbl
  1937   12  FILLER                          PIC  X(34).
  1938
  1939   12  MM-LAST-MAINT-DT                PIC  XX.
  1940   12  MM-LAST-MAINT-BY                PIC  X(4).
  1941   12  MM-LAST-MAINT-HHMMSS            PIC  S9(6) COMP-3.
  1942
  1943*        COPY ELCCERT.
  1944******************************************************************
  1945*                                                                *
  1946*                            ELCCERT.                            *
  1947*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1948*                            VMOD=2.013                          *
  1949*                                                                *
  1950*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1951*                                                                *
  1952*   FILE TYPE = VSAM,KSDS                                        *
  1953*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1954*                                                                *
  1955*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1956*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1957*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1958*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1959*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1960*                                                                *
  1961*   LOG = YES                                                    *
  1962*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1963******************************************************************
  1964*                   C H A N G E   L O G
  1965*
  1966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1967*-----------------------------------------------------------------
  1968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1969* EFFECTIVE    NUMBER
  1970*-----------------------------------------------------------------
  1971* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1972* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1973* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1974* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1975* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1976* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1977* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1978* 032612  CR2011110200001  PEMA  AHL CHANGES
  1979* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1980******************************************************************
  1981
  1982 01  CERTIFICATE-MASTER.
  1983     12  CM-RECORD-ID                      PIC XX.
  1984         88  VALID-CM-ID                      VALUE 'CM'.
  1985
  1986     12  CM-CONTROL-PRIMARY.
  1987         16  CM-COMPANY-CD                 PIC X.
  1988         16  CM-CARRIER                    PIC X.
  1989         16  CM-GROUPING.
  1990             20  CM-GROUPING-PREFIX        PIC X(3).
  1991             20  CM-GROUPING-PRIME         PIC X(3).
  1992         16  CM-STATE                      PIC XX.
  1993         16  CM-ACCOUNT.
  1994             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  43
* EL1284.cbl
  1995             20  CM-ACCOUNT-PRIME          PIC X(6).
  1996         16  CM-CERT-EFF-DT                PIC XX.
  1997         16  CM-CERT-NO.
  1998             20  CM-CERT-PRIME             PIC X(10).
  1999             20  CM-CERT-SFX               PIC X.
  2000
  2001     12  CM-CONTROL-BY-NAME.
  2002         16  CM-COMPANY-CD-A1              PIC X.
  2003         16  CM-INSURED-LAST-NAME          PIC X(15).
  2004         16  CM-INSURED-INITIALS.
  2005             20  CM-INSURED-INITIAL1       PIC X.
  2006             20  CM-INSURED-INITIAL2       PIC X.
  2007
  2008     12  CM-CONTROL-BY-SSN.
  2009         16  CM-COMPANY-CD-A2              PIC X.
  2010         16  CM-SOC-SEC-NO.
  2011             20  CM-SSN-STATE              PIC XX.
  2012             20  CM-SSN-ACCOUNT            PIC X(6).
  2013             20  CM-SSN-LN3.
  2014                 25  CM-INSURED-INITIALS-A2.
  2015                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2016                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2017                 25 CM-PART-LAST-NAME-A2         PIC X.
  2018
  2019     12  CM-CONTROL-BY-CERT-NO.
  2020         16  CM-COMPANY-CD-A4              PIC X.
  2021         16  CM-CERT-NO-A4                 PIC X(11).
  2022
  2023     12  CM-CONTROL-BY-MEMB.
  2024         16  CM-COMPANY-CD-A5              PIC X.
  2025         16  CM-MEMBER-NO.
  2026             20  CM-MEMB-STATE             PIC XX.
  2027             20  CM-MEMB-ACCOUNT           PIC X(6).
  2028             20  CM-MEMB-LN4.
  2029                 25  CM-INSURED-INITIALS-A5.
  2030                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2031                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2032                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2033
  2034     12  CM-INSURED-PROFILE-DATA.
  2035         16  CM-INSURED-FIRST-NAME.
  2036             20  CM-INSURED-1ST-INIT       PIC X.
  2037             20  FILLER                    PIC X(9).
  2038         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2039         16  CM-INSURED-SEX                PIC X.
  2040             88  CM-SEX-MALE                  VALUE 'M'.
  2041             88  CM-SEX-FEMAL                 VALUE 'F'.
  2042         16  CM-INSURED-JOINT-AGE          PIC 99.
  2043         16  CM-JOINT-INSURED-NAME.
  2044             20  CM-JT-LAST-NAME           PIC X(15).
  2045             20  CM-JT-FIRST-NAME.
  2046                 24  CM-JT-1ST-INIT        PIC X.
  2047                 24  FILLER                PIC X(9).
  2048             20  CM-JT-INITIAL             PIC X.
  2049
  2050     12  CM-LIFE-DATA.
  2051         16  CM-LF-BENEFIT-CD              PIC XX.
  2052         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  44
* EL1284.cbl
  2053         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2054         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2055         16  CM-LF-DEV-CODE                PIC XXX.
  2056         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2057         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2058         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2059         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2060         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2061         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2062         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2063         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2064         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2065         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2066         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2067         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2068         16  cm-temp-epiq                  pic xx.
  2069             88  EPIQ-CLASS                  value 'EQ'.
  2070*        16  FILLER                        PIC XX.
  2071
  2072     12  CM-AH-DATA.
  2073         16  CM-AH-BENEFIT-CD              PIC XX.
  2074         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2075         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2076         16  CM-AH-DEV-CODE                PIC XXX.
  2077         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2078         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2079         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2080         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2081         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2082         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2083         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2084         16  CM-AH-PAID-THRU-DT            PIC XX.
  2085             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2086         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2087         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2088         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2089         16  FILLER                        PIC X.
  2090
  2091     12  CM-LOAN-INFORMATION.
  2092         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2093         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2094                                           PIC S9(5)V99  COMP-3.
  2095         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2096         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2097         16  CM-PAY-FREQUENCY              PIC S99.
  2098         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2099         16  CM-RATE-CLASS                 PIC XX.
  2100         16  CM-BENEFICIARY                PIC X(25).
  2101         16  CM-POLICY-FORM-NO             PIC X(12).
  2102         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2103         16  CM-LAST-ADD-ON-DT             PIC XX.
  2104         16  CM-DEDUCTIBLE-AMOUNTS.
  2105             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2106             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2107         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2108             20  CM-RESIDENT-STATE         PIC XX.
  2109             20  CM-RATE-CODE              PIC X(4).
  2110             20  FILLER                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  45
* EL1284.cbl
  2111         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2112             20  CM-LOAN-OFFICER           PIC X(5).
  2113             20  FILLER                    PIC XXX.
  2114         16  CM-CSR-CODE                   PIC XXX.
  2115         16  CM-UNDERWRITING-CODE          PIC X.
  2116             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2117         16  CM-POST-CARD-IND              PIC X.
  2118         16  CM-NH-INTERFACE-SW            PIC X.
  2119         16  CM-PREMIUM-TYPE               PIC X.
  2120             88  CM-SING-PRM                  VALUE '1'.
  2121             88  CM-O-B-COVERAGE              VALUE '2'.
  2122             88  CM-OPEN-END                  VALUE '3'.
  2123         16  CM-IND-GRP-TYPE               PIC X.
  2124             88  CM-INDIVIDUAL                VALUE 'I'.
  2125             88  CM-GROUP                     VALUE 'G'.
  2126         16  CM-SKIP-CODE                  PIC X.
  2127             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2128             88  SKIP-JULY                    VALUE '1'.
  2129             88  SKIP-AUGUST                  VALUE '2'.
  2130             88  SKIP-SEPTEMBER               VALUE '3'.
  2131             88  SKIP-JULY-AUG                VALUE '4'.
  2132             88  SKIP-AUG-SEPT                VALUE '5'.
  2133             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2134             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2135             88  SKIP-JUNE                    VALUE '8'.
  2136             88  SKIP-JUNE-JULY               VALUE '9'.
  2137             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2138             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2139         16  CM-PAYMENT-MODE               PIC X.
  2140             88  PAY-MONTHLY                  VALUE SPACE.
  2141             88  PAY-WEEKLY                   VALUE '1'.
  2142             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2143             88  PAY-BI-WEEKLY                VALUE '3'.
  2144             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2145         16  CM-LOAN-NUMBER                PIC X(8).
  2146         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2147         16  CM-OLD-LOF                    PIC XXX.
  2148*        16  CM-LOAN-OFFICER               PIC XXX.
  2149         16  CM-REIN-TABLE                 PIC XXX.
  2150         16  CM-SPECIAL-REIN-CODE          PIC X.
  2151         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2152         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2153         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2154
  2155     12  CM-STATUS-DATA.
  2156         16  CM-ENTRY-STATUS               PIC X.
  2157         16  CM-ENTRY-DT                   PIC XX.
  2158
  2159         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2160         16  CM-LF-CANCEL-DT               PIC XX.
  2161         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2162
  2163         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2164         16  CM-LF-DEATH-DT                PIC XX.
  2165         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2166
  2167         16  CM-LF-CURRENT-STATUS          PIC X.
  2168             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  46
* EL1284.cbl
  2169                                                'M' '4' '5' '9'.
  2170             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2171             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2172             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2173             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2174             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2175             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2176             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2177             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2178             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2179             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2180             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2181             88  CM-LF-DECLINED               VALUE 'D'.
  2182             88  CM-LF-VOIDED                 VALUE 'V'.
  2183
  2184         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2185         16  CM-AH-CANCEL-DT               PIC XX.
  2186         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2187
  2188         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2189         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2190         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2191
  2192         16  CM-AH-CURRENT-STATUS          PIC X.
  2193             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2194                                                'M' '4' '5' '9'.
  2195             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2196             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2197             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2198             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2199             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2200             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2201             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2202             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2203             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2204             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2205             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2206             88  CM-AH-DECLINED               VALUE 'D'.
  2207             88  CM-AH-VOIDED                 VALUE 'V'.
  2208
  2209         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2210             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2211             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2212             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2213         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2214
  2215         16  CM-ENTRY-BATCH                PIC X(6).
  2216         16  CM-LF-EXIT-BATCH              PIC X(6).
  2217         16  CM-AH-EXIT-BATCH              PIC X(6).
  2218         16  CM-LAST-MONTH-END             PIC XX.
  2219
  2220     12  CM-NOTE-SW                        PIC X.
  2221         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2222         88  CERT-NOTES-PRESENT               VALUE '1'.
  2223         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2224         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2225         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2226         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  47
* EL1284.cbl
  2227         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2228         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2229     12  CM-COMP-EXCP-SW                   PIC X.
  2230         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2231         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2232     12  CM-INSURED-ADDRESS-SW             PIC X.
  2233         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2234         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2235
  2236*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2237     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2238     12  FILLER                            PIC X.
  2239
  2240*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2241     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2242     12  FILLER                            PIC X.
  2243*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2244     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2245
  2246     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2247         88  CERT-ADDED-BATCH                 VALUE ' '.
  2248         88  CERT-ADDED-ONLINE                VALUE '1'.
  2249         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2250         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2251         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2252     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2253         88  CERT-AS-LOADED                   VALUE ' '.
  2254         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2255         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2256         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2257         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2258         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2259         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2260         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2261
  2262     12  CM-ACCOUNT-COMM-PCTS.
  2263         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2264         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2265
  2266     12  CM-USER-FIELD                     PIC X.
  2267     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2268     12  CM-CLP-STATE                      PIC XX.
  2269     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2270     12  CM-USER-RESERVED                  PIC XXX.
  2271     12  FILLER REDEFINES CM-USER-RESERVED.
  2272         16  CM-AH-CLASS-CD                PIC XX.
  2273         16  F                             PIC X.
  2274******************************************************************
  2275 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MEMO-FILE
  2276                          CERTIFICATE-MASTER.
  2277 0000-DFHEXIT SECTION.
  2278     MOVE '9#                    $   ' TO DFHEIV0.
  2279     MOVE 'EL1284' TO DFHEIV1.
  2280     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2281
  2282     MOVE EIBTRMID               TO QID-TERM.
  2283     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2284     MOVE '5'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  48
* EL1284.cbl
  2285     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2286     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  2287     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  2288
  2289     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK
  2290     IF EIBCALEN = ZEROS
  2291         GO TO 8800-UNAUTHORIZED-ACCESS
  2292     END-IF.
  2293
  2294*    IF PI-CALLING-PROGRAM NOT = THIS-PGM AND PGM-EL1276
  2295*        PERFORM 4900-SET-NOTES-FLAG THRU 4900-EXIT
  2296*        IF CLAIM-SESSION
  2297*            SET PI-CLAIM-NOTE TO TRUE
  2298*        ELSE
  2299*            SET PI-CERT-NOTE TO TRUE
  2300*        END-IF
  2301*    END-IF.
  2302
  2303*    IF PI-CALLING-PROGRAM = PGM-EL1276
  2304*        MOVE THIS-PGM           TO PI-CALLING-PROGRAM
  2305*        MOVE 'N'                TO PI-PF5-PRESSED
  2306*        MOVE 'N'                TO PI-PF6-PRESSED
  2307*    END-IF.
  2308
  2309     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2310        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2311           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2312           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2313           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2314           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2315           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2316           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2317           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2318           MOVE THIS-PGM TO PI-CALLING-PROGRAM
  2319        ELSE
  2320           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2321           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2322           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2323           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2324           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2325           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2326           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2327           MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2328        END-IF
  2329     END-IF.
  2330
  2331 1000-START.
  2332     MOVE 'N' TO WS-CURSOR-SET
  2333
  2334     MOVE LOW-VALUES TO EL1284AI
  2335                        EL1284R
  2336     MOVE SPACES                 TO  ELMEMO-KEY
  2337                                     ELCERT-KEY.
  2338
  2339     MOVE PI-COMPANY-CD          TO  ELMEMO-COMPANY-CD
  2340                                     ELCERT-COMPANY-CD.
  2341     MOVE PI-CARRIER             TO  ELMEMO-CARRIER
  2342                                     ELCERT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  49
* EL1284.cbl
  2343     MOVE PI-CLAIM-NO            TO  ELMEMO-CLAIM-NO
  2344     MOVE PI-CERT-PRIME          TO  ELMEMO-CERT-PRIME
  2345                                     ELCERT-CERT-PRIME.
  2346     MOVE PI-CERT-SFX            TO  ELMEMO-CERT-SFX
  2347                                     ELCERT-CERT-SFX.
  2348     MOVE ZEROS                  TO  ELMEMO-RECORD-TYPE
  2349     MOVE ZEROS                  TO  ELMEMO-SEQ.
  2350     MOVE ELMEMO-PARTIAL-KEY     TO  SV-PRIOR-KEY.
  2351
  2352     IF EIBTRNID NOT = TRANS-ID
  2353        INITIALIZE PI-EL1284-AREA
  2354        MOVE '0'                 TO  PI-UPDATE-SW
  2355        IF PI-PROCESSOR-ID NOT = 'LGXX'
  2356
  2357* EXEC CICS READQ TS
  2358*                    QUEUE (PI-SECURITY-TEMP-STORE-ID)
  2359*                    INTO (SECURITY-CONTROL)
  2360*                    LENGTH (SC-COMM-LENGTH)
  2361*                    ITEM  (SC-ITEM)
  2362*           END-EXEC
  2363*    MOVE '*$II   L              ''   #00002352' TO DFHEIV0
  2364     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2365     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2366     MOVE X'2020233030303032333532' TO DFHEIV0(25:11)
  2367     CALL 'kxdfhei1' USING DFHEIV0,
  2368           PI-SECURITY-TEMP-STORE-ID,
  2369           SECURITY-CONTROL,
  2370           SC-COMM-LENGTH,
  2371           SC-ITEM,
  2372           DFHEIV99,
  2373           DFHEIV99
  2374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2375          MOVE SC-CREDIT-DISPLAY (32) TO PI-DISPLAY-CAP
  2376          MOVE SC-CREDIT-UPDATE (32)  TO PI-MODIFY-CAP
  2377        END-IF
  2378     END-IF.
  2379
  2380     IF NOT DISPLAY-CAP
  2381         MOVE 'READ'             TO  SM-READ
  2382         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2383         MOVE ER-0070            TO  EMI-ERROR
  2384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2385         GO TO 8100-SEND-INITIAL-MAP
  2386     END-IF.
  2387
  2388
  2389* EXEC CICS HANDLE AID
  2390*         CLEAR(9400-CLEAR)
  2391*    END-EXEC.
  2392*    MOVE '"&=                  V! " #00002371' TO DFHEIV0
  2393     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  2394     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2395     MOVE X'2220233030303032333731' TO DFHEIV0(25:11)
  2396     CALL 'kxdfhei1' USING DFHEIV0
  2397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2398
  2399
  2400
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  50
* EL1284.cbl
  2401* EXEC CICS HANDLE CONDITION
  2402*         ERROR(9990-ABEND)
  2403*         PGMIDERR(9600-PGMID-ERROR)
  2404*    END-EXEC.
  2405*    MOVE '"$.L                  ! # #00002375' TO DFHEIV0
  2406     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  2407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2408     MOVE X'2320233030303032333735' TO DFHEIV0(25:11)
  2409     CALL 'kxdfhei1' USING DFHEIV0
  2410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2411
  2412
  2413     IF EIBTRNID NOT = TRANS-ID
  2414         GO TO 7000-BUILD-TABLE
  2415     END-IF.
  2416
  2417     IF PI-CHANGE-IN-NOTE-TYPE
  2418         GO TO 7000-BUILD-TABLE
  2419     END-IF.
  2420
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  51
* EL1284.cbl
  2422 2000-RECEIVE.
  2423     IF EIBAID = DFHPA1 OR
  2424        EIBAID = DFHPA2 OR
  2425        EIBAID = DFHPA3
  2426           MOVE ER-0008 TO EMI-ERROR
  2427           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2428           GO TO 8200-SEND-DATAONLY
  2429     END-IF.
  2430
  2431
  2432* EXEC CICS RECEIVE
  2433*         MAP(MAP-NAME)
  2434*         MAPSET(MAPSET-NAME)
  2435*         INTO(EL1284AI)
  2436*    END-EXEC.
  2437     MOVE LENGTH OF
  2438      EL1284AI
  2439       TO DFHEIV11
  2440*    MOVE '8"T I  L              ''   #00002398' TO DFHEIV0
  2441     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2442     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2443     MOVE X'2020233030303032333938' TO DFHEIV0(25:11)
  2444     CALL 'kxdfhei1' USING DFHEIV0,
  2445           MAP-NAME,
  2446           EL1284AI,
  2447           DFHEIV11,
  2448           MAPSET-NAME,
  2449           DFHEIV99,
  2450           DFHEIV99
  2451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2452
  2453     MOVE GROUP2 TO EL1284R.
  2454
  2455     IF PFENTERL = ZEROS
  2456        GO TO 2001-CHECK-PFKEYS
  2457     END-IF.
  2458
  2459     IF EIBAID NOT = DFHENTER
  2460        MOVE ER-0004             TO EMI-ERROR
  2461        GO TO 2002-INPUT-ERROR
  2462     END-IF.
  2463
  2464     IF PFENTERI NUMERIC AND
  2465        (PFENTERI > 00 AND  < 25)
  2466        MOVE PF-VALUES (PFENTERI) TO EIBAID
  2467     ELSE
  2468        MOVE ER-0029 TO EMI-ERROR
  2469        GO TO 2002-INPUT-ERROR
  2470     END-IF.
  2471
  2472 2001-CHECK-PFKEYS.
  2473     IF EIBAID = DFHPF23
  2474        GO TO 9000-RETURN-CICS
  2475     END-IF.
  2476
  2477     IF EIBAID = DFHPF24
  2478        GO TO 9200-RETURN-MAIN-MENU
  2479     END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  52
* EL1284.cbl
  2480
  2481     IF EIBAID = DFHPF12
  2482        GO TO 9500-PF12
  2483     END-IF.
  2484
  2485     IF FUNCTL NOT = ZEROS AND EIBAID NOT = DFHENTER
  2486        IF FUNCTI = 'A' OR = SPACES
  2487           NEXT SENTENCE
  2488        ELSE
  2489           MOVE ER-0050          TO EMI-ERROR
  2490           MOVE -1 TO FUNCTL
  2491           MOVE AL-UABON TO FUNCTA PFENTERA
  2492           GO TO 2002-INPUT-ERROR
  2493        END-IF
  2494     END-IF.
  2495
  2496     IF EIBAID = DFHPF1
  2497        MOVE NUM-LINES-PER-SCREEN TO ROLL-COUNTER
  2498        GO TO 7400-PAGE-ROUTINE
  2499     END-IF.
  2500
  2501     IF EIBAID = DFHPF2
  2502        SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  2503        GO TO 7400-PAGE-ROUTINE
  2504     END-IF.
  2505
  2506     IF EIBAID = DFHPF3
  2507        MOVE 5                   TO ROLL-COUNTER
  2508        GO TO 7400-PAGE-ROUTINE
  2509     END-IF.
  2510
  2511     IF EIBAID = DFHPF4
  2512        MOVE -5                  TO ROLL-COUNTER
  2513        GO TO 7400-PAGE-ROUTINE
  2514     END-IF.
  2515
  2516     IF EIBAID = DFHENTER
  2517        GO TO 2003-EDIT-DATA
  2518     END-IF.
  2519
  2520     MOVE ER-0029                TO EMI-ERROR.
  2521
  2522 2002-INPUT-ERROR.
  2523     MOVE -1                     TO PFENTERL
  2524     MOVE AL-UNBON               TO PFENTERA
  2525     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2526     GO TO 8200-SEND-DATAONLY.
  2527
  2528 2003-EDIT-DATA.
  2529
  2530     IF FUNCTI = 'L'
  2531         NEXT SENTENCE
  2532     ELSE
  2533         IF NOT MODIFY-CAP
  2534             MOVE 'UPDATE'       TO  SM-READ
  2535             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2536             MOVE ER-0070        TO  EMI-ERROR
  2537             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  53
* EL1284.cbl
  2538             GO TO 8100-SEND-INITIAL-MAP
  2539         END-IF
  2540     END-IF.
  2541     PERFORM 2010-EDIT-CHECK.
  2542
  2543     IF FUNCTL = ZEROS OR FUNCTI = SPACES
  2544        GO TO 4000-CHANGE-ROUTINE
  2545     END-IF.
  2546
  2547     IF (FUNCTI = 'S' OR = 'D' OR = 'Q' OR
  2548                = 'I' OR = 'A' OR = 'L')
  2549         NEXT SENTENCE
  2550     ELSE
  2551         MOVE ER-0023            TO EMI-ERROR
  2552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2553         MOVE AL-UABON           TO FUNCTA
  2554         MOVE -1                 TO FUNCTL
  2555         GO TO 8200-SEND-DATAONLY
  2556     END-IF.
  2557
  2558     IF FUNCTI = 'D'  OR = 'I' OR = 'L'
  2559        PERFORM 2500-LINE-CHECK THRU 2599-EXIT
  2560     ELSE
  2561        IF LINE1L NOT = ZEROS OR
  2562           LINE2L NOT = ZEROS
  2563           MOVE ER-0030          TO EMI-ERROR
  2564           MOVE -1               TO LINE1L
  2565           MOVE AL-UNBON         TO LINE1A LINE2A
  2566           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2567           GO TO 8200-SEND-DATAONLY
  2568        END-IF
  2569     END-IF.
  2570
  2571     IF FUNCTI = 'A'
  2572        GO TO 5000-ADD-NEW-LINES
  2573     END-IF.
  2574     IF FUNCTI = 'Q'
  2575        GO TO 9410-RETURN
  2576     END-IF.
  2577     IF FUNCTI = 'S'
  2578        GO TO 4500-SAVE-DATA
  2579     END-IF.
  2580     IF PI-TOTAL-LINES = 0
  2581        MOVE ER-0048             TO EMI-ERROR
  2582        MOVE -1                  TO FUNCTL
  2583        MOVE AL-UNBON            TO FUNCTA
  2584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2585        GO TO 8200-SEND-DATAONLY
  2586     END-IF.
  2587     IF FUNCTI = 'L'
  2588        GO TO 5500-LOOKUP
  2589     END-IF.
  2590     IF FUNCTI = 'D'
  2591        GO TO 3000-DELETE-LINES
  2592     END-IF.
  2593
  2594     GO TO 3500-INSERT-LINES.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  54
* EL1284.cbl
  2596 2010-EDIT-CHECK.
  2597*
  2598     IF LNGHLAPL > 0
  2599        MOVE LNGHLAPI TO  PI-LONG-HLTH-APP
  2600        MOVE '1'      TO PI-UPDATE-SW
  2601     ELSE
  2602        IF LNGHLAPA = WS-ERASE-EOF
  2603           MOVE SPACES TO PI-LONG-HLTH-APP
  2604           MOVE '1'    TO PI-UPDATE-SW
  2605        END-IF
  2606        MOVE PI-LONG-HLTH-APP TO LNGHLAPI
  2607     END-IF.
  2608*
  2609     IF LNGHLAPI > SPACE
  2610        IF LNGHLAPI = 'N' OR 'Y'
  2611           CONTINUE
  2612        ELSE
  2613           MOVE -1                     TO LNGHLAPL
  2614           MOVE AL-UABON               TO LNGHLAPA
  2615           MOVE ER-0046                TO EMI-ERROR
  2616           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2617           GO TO 8200-SEND-DATAONLY
  2618        END-IF
  2619     END-IF.
  2620*
  2621     IF REWRITEL > 0
  2622        MOVE REWRITEI TO PI-REWRITE
  2623        MOVE '1'      TO PI-UPDATE-SW
  2624     ELSE
  2625        IF REWRITEA = WS-ERASE-EOF
  2626           MOVE SPACES TO PI-REWRITE
  2627           MOVE '1'    TO PI-UPDATE-SW
  2628        END-IF
  2629        MOVE PI-REWRITE TO REWRITEI
  2630     END-IF
  2631*
  2632     IF REWRITEI > SPACE
  2633        IF REWRITEI = 'N' OR 'Y'
  2634           CONTINUE
  2635        ELSE
  2636           MOVE -1                     TO REWRITEL
  2637           MOVE AL-UABON               TO REWRITEA
  2638           MOVE ER-0046                TO EMI-ERROR
  2639           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2640           GO TO 8200-SEND-DATAONLY
  2641        END-IF
  2642     END-IF.
  2643*
  2644     IF CHKCOVGL > 0
  2645        MOVE CHKCOVGI TO PI-CHKCOVG
  2646        MOVE '1'      TO PI-UPDATE-SW
  2647     ELSE
  2648        IF CHKCOVGA = WS-ERASE-EOF
  2649           MOVE SPACES TO PI-CHKCOVG
  2650           MOVE '1'    TO PI-UPDATE-SW
  2651        END-IF
  2652        MOVE PI-CHKCOVG TO CHKCOVGI
  2653     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  55
* EL1284.cbl
  2654*
  2655     IF CHKCOVGI > SPACE
  2656        IF CHKCOVGI = 'N' OR 'Y'
  2657           CONTINUE
  2658        ELSE
  2659           MOVE -1                     TO CHKCOVGL
  2660           MOVE AL-UABON               TO CHKCOVGA
  2661           MOVE ER-0046                TO EMI-ERROR
  2662           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2663           GO TO 8200-SEND-DATAONLY
  2664        END-IF
  2665     END-IF.
  2666*
  2667     IF MRRELDTL > 0
  2668        MOVE MRRELDTI TO PI-MR-RELEASE-DATE
  2669        MOVE '1'      TO PI-UPDATE-SW
  2670     ELSE
  2671        IF MRRELDTA = WS-ERASE-EOF
  2672           MOVE SPACES TO PI-MR-RELEASE-DATE
  2673           MOVE '1'    TO PI-UPDATE-SW
  2674        END-IF
  2675        MOVE PI-MR-RELEASE-DATE TO MRRELDTI
  2676     END-IF.
  2677*
  2678 2500-LINE-CHECK.
  2679     IF LINE1L = ZEROS AND
  2680        LINE2L = ZEROS
  2681        MOVE ER-0069             TO EMI-ERROR
  2682        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2683        MOVE -1                  TO LINE1L
  2684        GO TO 8200-SEND-DATAONLY
  2685     END-IF.
  2686
  2687     IF LINE1L NOT = ZEROS
  2688        IF LINE1I = ZERO AND FUNCTI EQUAL 'L'
  2689            MOVE 1               TO LINE1I
  2690        END-IF
  2691        IF LINE1I = ZERO AND FUNCTI EQUAL 'D'
  2692           MOVE ER-0049          TO EMI-ERROR
  2693           MOVE AL-UNBON         TO LINE1A
  2694           MOVE -1               TO LINE1L
  2695           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2696           GO TO 8200-SEND-DATAONLY
  2697        END-IF
  2698        IF LINE1I NOT NUMERIC OR
  2699           LINE1I > PI-TOTAL-LINES
  2700           MOVE ER-0031          TO EMI-ERROR
  2701           MOVE AL-UNBON         TO LINE1A
  2702           MOVE -1               TO LINE1L
  2703           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2704           GO TO 8200-SEND-DATAONLY
  2705        ELSE
  2706           IF LINE2L = ZEROS
  2707              MOVE 1             TO LINE2I
  2708              IF FUNCTI = 'I'
  2709                  GO TO 2510-MAX-CHECK
  2710              ELSE
  2711                  NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  56
* EL1284.cbl
  2712              END-IF
  2713           ELSE
  2714              IF FUNCTI = 'I'
  2715                 GO TO 2510-MAX-CHECK
  2716              ELSE
  2717                 IF LINE2I NOT NUMERIC
  2718                    MOVE AL-UNBON TO LINE2A
  2719                    MOVE ER-0032  TO EMI-ERROR
  2720                    MOVE -1       TO LINE2L
  2721                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2722                    GO TO 8200-SEND-DATAONLY
  2723                 ELSE
  2724                    NEXT SENTENCE
  2725                 END-IF
  2726              END-IF
  2727           END-IF
  2728        END-IF
  2729     ELSE
  2730        IF LINE2L = ZEROS
  2731           NEXT SENTENCE
  2732        ELSE
  2733           MOVE -1               TO LINE2L
  2734           MOVE ER-0041          TO EMI-ERROR
  2735           MOVE AL-UNBON         TO LINE2A
  2736           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2737           GO TO 8200-SEND-DATAONLY
  2738        END-IF
  2739     END-IF.
  2740     GO TO 2599-EXIT.
  2741 2510-MAX-CHECK.
  2742     IF LINE2I NOT NUMERIC
  2743        MOVE -1                  TO LINE2L
  2744        MOVE ER-0032             TO EMI-ERROR
  2745        MOVE AL-UNBON            TO LINE2A
  2746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2747        GO TO 8200-SEND-DATAONLY
  2748     ELSE
  2749        COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  2750        IF ROLL-COUNTER GREATER THAN MAX-LINES
  2751           MOVE -1               TO LINE2L
  2752           MOVE ER-0044          TO EMI-ERROR
  2753           MOVE AL-UNBON         TO LINE2A
  2754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2755           GO TO 8200-SEND-DATAONLY
  2756        END-IF
  2757     END-IF.
  2758 2599-EXIT.
  2759      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  57
* EL1284.cbl
  2761 3000-DELETE-LINES.
  2762     IF LINE2L = ZEROS AND LINE2I = 1
  2763        MOVE LINE1I              TO LINE2I
  2764     END-IF.
  2765
  2766     IF LINE2I > PI-TOTAL-LINES OR < LINE1I
  2767        MOVE ER-0049             TO EMI-ERROR
  2768        MOVE AL-UNBON            TO LINE2A
  2769        MOVE -1                  TO LINE2L
  2770        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2771        GO TO 8200-SEND-DATAONLY
  2772     END-IF.
  2773
  2774     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2775     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2776             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2777             SC-INDX > NUM-LINES-PER-SCREEN
  2778     SET TB-INDX TO LINE1I.
  2779
  2780     IF NOT EMI-NO-ERRORS
  2781        GO TO 8200-SEND-DATAONLY
  2782     END-IF.
  2783
  2784     SET TB-INDX TO LINE1I
  2785     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1.
  2786
  2787     IF LINE2I NOT = PI-TOTAL-LINES
  2788        SET TB-INDX1 TO LINE2I
  2789        SET TB-INDX1 UP BY 1
  2790        PERFORM 3100-DELETE-TABLE-ENTRIES
  2791                UNTIL TB-INDX1 > PI-TOTAL-LINES
  2792     END-IF.
  2793
  2794     PERFORM 3150-BLANK-TABLE-ENTRIES
  2795             ROLL-COUNTER TIMES.
  2796     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES.
  2797
  2798     IF PI-CURRENT-LINE > PI-TOTAL-LINES
  2799        MOVE PI-TOTAL-LINES      TO PI-CURRENT-LINE
  2800        SUBTRACT 1 FROM PI-CURRENT-LINE
  2801     END-IF.
  2802
  2803     SET TB-INDX  TO PI-CURRENT-LINE
  2804     MOVE LOW-VALUES             TO EL1284AI
  2805                                    EL1284R
  2806
  2807     PERFORM 7800-MOVE-SAVE-TO-MAP.
  2808     IF PI-CURRENT-LINE > ZERO
  2809         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2810             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2811             SC-INDX > NUM-LINES-PER-SCREEN
  2812         PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT
  2813     END-IF.
  2814
  2815     MOVE '1'                    TO PI-UPDATE-SW.
  2816     IF PI-TOTAL-LINES = ZEROS
  2817        MOVE ZEROS               TO PI-CURRENT-LINE
  2818     END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  58
* EL1284.cbl
  2819     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  59
* EL1284.cbl
  2821
  2822 3100-DELETE-TABLE-ENTRIES.
  2823     MOVE REC-ENT (TB-INDX1)     TO REC-ENT (TB-INDX)
  2824     SET TB-INDX TB-INDX1 UP BY 1.
  2825
  2826 3150-BLANK-TABLE-ENTRIES.
  2827     MOVE SPACES               TO REC-ENT (TB-INDX).
  2828     MOVE SAVE-BIN-DATE        TO REC-LAST-MAINT-DT (TB-INDX).
  2829     MOVE EIBTIME              TO REC-LAST-MAINT-HHMMSS (TB-INDX).
  2830     MOVE PI-PROCESSOR-ID      TO REC-LAST-MAINT-BY (TB-INDX).
  2831     SET TB-INDX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  60
* EL1284.cbl
  2833 3500-INSERT-LINES.
  2834
  2835     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2836     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2837             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2838             SC-INDX > NUM-LINES-PER-SCREEN.
  2839
  2840     IF NOT EMI-NO-ERRORS
  2841        GO TO 8200-SEND-DATAONLY
  2842     END-IF.
  2843
  2844     SET TB-INDX TO PI-TOTAL-LINES.
  2845     ADD LINE2I TO PI-TOTAL-LINES.
  2846     SET TB-INDX1 TO PI-TOTAL-LINES.
  2847     PERFORM 3600-INSERT-TABLE-ENTRIES
  2848             UNTIL TB-INDX = LINE1I.
  2849     SET TB-INDX UP BY 1.
  2850
  2851     IF LINE1I EQUAL ZERO
  2852         SET PI-CURRENT-LINE TO 1
  2853     ELSE
  2854         SET PI-CURRENT-LINE TO LINE1I
  2855     END-IF.
  2856
  2857     COMPUTE ROLL-COUNTER = PI-CURRENT-LINE +
  2858                            NUM-LINES-PER-SCREEN.
  2859     IF TB-INDX NOT LESS THAN ROLL-COUNTER OR
  2860                    LESS THAN PI-CURRENT-LINE
  2861        SET SC-INDX TO 1
  2862        SET SC-INDX DOWN BY 1
  2863     ELSE
  2864        SET ROLL-COUNTER TO TB-INDX
  2865        COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE
  2866                  + 1
  2867        SET SC-INDX TO ROLL-COUNTER
  2868     END-IF.
  2869
  2870     PERFORM 3150-BLANK-TABLE-ENTRIES LINE2I TIMES.
  2871     SET TB-INDX TO PI-CURRENT-LINE.
  2872     MOVE LOW-VALUES             TO EL1284AI
  2873                                    EL1284R
  2874
  2875     IF SC-INDX NOT = ZERO
  2876        MOVE -1 TO SC-TEXTL (SC-INDX)
  2877        SET CURSOR-SET TO TRUE
  2878     END-IF.
  2879
  2880     PERFORM 7800-MOVE-SAVE-TO-MAP.
  2881     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2882            VARYING SC-INDX FROM 1 BY 1 UNTIL
  2883            SC-INDX > NUM-LINES-PER-SCREEN.
  2884     PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT.
  2885     MOVE '1'                    TO PI-UPDATE-SW.
  2886     GO TO 8100-SEND-INITIAL-MAP.
  2887
  2888 3600-INSERT-TABLE-ENTRIES.
  2889     MOVE REC-ENT (TB-INDX)      TO REC-ENT (TB-INDX1).
  2890     SET TB-INDX TB-INDX1 DOWN BY 1.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  61
* EL1284.cbl
  2892
  2893 4000-CHANGE-ROUTINE.
  2894     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2895     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2896             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2897             SC-INDX > NUM-LINES-PER-SCREEN.
  2898
  2899     IF NOT EMI-NO-ERRORS
  2900        GO TO 8200-SEND-DATAONLY
  2901     END-IF.
  2902
  2903     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2904     MOVE SPACES                 TO ERRMSGBO.
  2905     GO TO 8200-SEND-DATAONLY.
  2906
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  62
* EL1284.cbl
  2908 4500-SAVE-DATA.
  2909     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2910     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2911             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2912             SC-INDX > NUM-LINES-PER-SCREEN.
  2913     IF NOT EMI-NO-ERRORS
  2914        GO TO 8200-SEND-DATAONLY
  2915     END-IF.
  2916
  2917
  2918* EXEC CICS HANDLE CONDITION
  2919*         NOTFND(4610-ENDBR)
  2920*         NOTOPEN(6000-NOT-OPEN)
  2921*         ENDFILE(4610-ENDBR)
  2922*    END-EXEC.
  2923*    MOVE '"$IJ''                 ! $ #00002867' TO DFHEIV0
  2924     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  2925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2926     MOVE X'2420233030303032383637' TO DFHEIV0(25:11)
  2927     CALL 'kxdfhei1' USING DFHEIV0
  2928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2929
  2930
  2931 4610-LOOP.
  2932
  2933* EXEC CICS READ
  2934*        DATASET (ELMEMO-FILE-ID)
  2935*        RIDFLD  (ELMEMO-KEY)
  2936*        SET     (ADDRESS OF CLAIM-MEMO-FILE)
  2937*        GTEQ
  2938*    END-EXEC.
  2939*    MOVE '&"S        G          (   #00002874' TO DFHEIV0
  2940     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2942     MOVE X'2020233030303032383734' TO DFHEIV0(25:11)
  2943     CALL 'kxdfhei1' USING DFHEIV0,
  2944           ELMEMO-FILE-ID,
  2945           DFHEIV20,
  2946           DFHEIV99,
  2947           ELMEMO-KEY,
  2948           DFHEIV99,
  2949           DFHEIV99,
  2950           DFHEIV99
  2951     SET ADDRESS OF CLAIM-MEMO-FILE TO
  2952         DFHEIV20
  2953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2954
  2955
  2956     MOVE MM-CONTROL-PRIMARY     TO ELMEMO-KEY.
  2957
  2958     IF ELMEMO-PARTIAL-KEY NOT = SV-PRIOR-KEY
  2959         MOVE SV-PRIOR-KEY       TO ELMEMO-PARTIAL-KEY
  2960         GO TO 4610-ENDBR
  2961     END-IF.
  2962
  2963
  2964* EXEC CICS DELETE
  2965*        DATASET (ELMEMO-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  63
* EL1284.cbl
  2966*        RIDFLD  (ELMEMO-KEY)
  2967*    END-EXEC.
  2968*    MOVE '&(  R                 &   #00002888' TO DFHEIV0
  2969     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  2970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2971     MOVE X'2020233030303032383838' TO DFHEIV0(25:11)
  2972     CALL 'kxdfhei1' USING DFHEIV0,
  2973           ELMEMO-FILE-ID,
  2974           ELMEMO-KEY,
  2975           DFHEIV99,
  2976           DFHEIV99,
  2977           DFHEIV99
  2978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2979
  2980
  2981     GO TO 4610-LOOP.
  2982 4610-ENDBR.
  2983
  2984* EXEC CICS GETMAIN
  2985*         LENGTH(ELMEMO-LENGTH)
  2986*         SET(ADDRESS OF CLAIM-MEMO-FILE)
  2987*         INITIMG(GETMAIN-SPACE)
  2988*    END-EXEC.
  2989*    MOVE ',"IL                  $   #00002895' TO DFHEIV0
  2990     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2991     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2992     MOVE X'2020233030303032383935' TO DFHEIV0(25:11)
  2993     CALL 'kxdfhei1' USING DFHEIV0,
  2994           DFHEIV20,
  2995           ELMEMO-LENGTH,
  2996           GETMAIN-SPACE
  2997     SET ADDRESS OF CLAIM-MEMO-FILE TO
  2998         DFHEIV20
  2999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3000
  3001     PERFORM 4650-WRITE-HEADER THRU 4650-EXIT.
  3002
  3003     MOVE 1                      TO  ELMEMO-SEQ.
  3004     MOVE ZERO                   TO  WS-BLANK-LINES.
  3005
  3006     PERFORM 4700-WRITE-FILE THRU 4799-EXIT
  3007             VARYING TB-INDX FROM 1 BY 1 UNTIL
  3008             TB-INDX > PI-TOTAL-LINES.
  3009
  3010     SUBTRACT WS-BLANK-LINES FROM PI-TOTAL-LINES.
  3011
  3012     GO TO 9410-RETURN.
  3013 4650-WRITE-HEADER.
  3014
  3015     MOVE SPACES                 TO  CLAIM-MEMO-FILE.
  3016     MOVE ZERO                   TO  ELMEMO-SEQ.
  3017     MOVE ELMEMO-KEY             TO  MM-CONTROL-PRIMARY.
  3018     MOVE  'MM'                  TO  MM-RECORD-ID.
  3019     MOVE REC-TEXT (TB-INDX)     TO  MM-CLAIM-MEMO
  3020     MOVE LNGHLAPI               TO MM-LONG-HEALTH-APP
  3021     MOVE REWRITEI               TO MM-REWRITE-IND
  3022     MOVE CHKCOVGI               TO MM-CHECKED-OTHER-COVG
  3023     IF MRRELDTI > SPACES
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  64
* EL1284.cbl
  3024        MOVE MRRELDTI               TO DEEDIT-DATE-INPUT
  3025
  3026* EXEC CICS BIF DEEDIT
  3027*           FIELD    (DEEDIT-DATE-INPUT)
  3028*           LENGTH   (DATE-LENGTH)
  3029*       END-EXEC
  3030*    MOVE '@"L                   #   #00002924' TO DFHEIV0
  3031     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3032     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3033     MOVE X'2020233030303032393234' TO DFHEIV0(25:11)
  3034     CALL 'kxdfhei1' USING DFHEIV0,
  3035           DEEDIT-DATE-INPUT,
  3036           DATE-LENGTH
  3037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3038        MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  3039        MOVE '4'            TO DC-OPTION-CODE
  3040        PERFORM PERFORM 9700-LINK-DATE-CONVERT
  3041        IF NOT DATE-CONVERSION-ERROR
  3042            MOVE DC-BIN-DATE-1      TO MM-MR-RELEASED-FROM-DATE
  3043*           MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  3044*           MOVE AL-UANON           TO INCA
  3045*           MOVE DC-GREG-DATE-1-EDIT TO INCO
  3046        ELSE
  3047            MOVE -1         TO MRRELDTL
  3048            MOVE ER-0314    TO EMI-ERROR
  3049            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3050            GO TO 8200-SEND-DATAONLY
  3051        END-IF
  3052     END-IF.
  3053*        MOVE AL-UABON   TO INCA
  3054*        MOVE -1         TO INCL
  3055*        MOVE 'X'        TO ERROR-SWITCH.
  3056
  3057* EXEC CICS WRITE
  3058*         DATASET(ELMEMO-FILE-ID)
  3059*         FROM(CLAIM-MEMO-FILE)
  3060*         RIDFLD(ELMEMO-KEY)
  3061*    END-EXEC.
  3062     MOVE LENGTH OF
  3063      CLAIM-MEMO-FILE
  3064       TO DFHEIV11
  3065*    MOVE '&$ L                  ''   #00002946' TO DFHEIV0
  3066     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3067     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3068     MOVE X'2020233030303032393436' TO DFHEIV0(25:11)
  3069     CALL 'kxdfhei1' USING DFHEIV0,
  3070           ELMEMO-FILE-ID,
  3071           CLAIM-MEMO-FILE,
  3072           DFHEIV11,
  3073           ELMEMO-KEY,
  3074           DFHEIV99,
  3075           DFHEIV99
  3076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3077
  3078 4650-EXIT.
  3079      EXIT.
  3080
  3081 4700-WRITE-FILE.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  65
* EL1284.cbl
  3082     IF REC-TEXT (TB-INDX)  EQUAL SPACES
  3083         ADD +1                  TO  WS-BLANK-LINES
  3084         GO TO 4799-EXIT
  3085     END-IF.
  3086
  3087     MOVE SPACES                 TO  CLAIM-MEMO-FILE.
  3088     ADD 1                       TO  ELMEMO-SEQ.
  3089     MOVE ELMEMO-KEY             TO  MM-CONTROL-PRIMARY.
  3090     MOVE  'MM'                  TO  MM-RECORD-ID.
  3091     MOVE REC-TEXT (TB-INDX)     TO  MM-CLAIM-MEMO
  3092     MOVE REC-LAST-MAINT-BY (TB-INDX)
  3093                                 TO  MM-LAST-MAINT-BY
  3094     MOVE REC-LAST-MAINT-HHMMSS (TB-INDX)
  3095                                 TO  MM-LAST-MAINT-HHMMSS.
  3096     MOVE REC-LAST-MAINT-DT (TB-INDX)
  3097                                 TO  MM-LAST-MAINT-DT.
  3098
  3099
  3100* EXEC CICS WRITE
  3101*         DATASET(ELMEMO-FILE-ID)
  3102*         FROM(CLAIM-MEMO-FILE)
  3103*         RIDFLD(ELMEMO-KEY)
  3104*    END-EXEC.
  3105     MOVE LENGTH OF
  3106      CLAIM-MEMO-FILE
  3107       TO DFHEIV11
  3108*    MOVE '&$ L                  ''   #00002972' TO DFHEIV0
  3109     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3110     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3111     MOVE X'2020233030303032393732' TO DFHEIV0(25:11)
  3112     CALL 'kxdfhei1' USING DFHEIV0,
  3113           ELMEMO-FILE-ID,
  3114           CLAIM-MEMO-FILE,
  3115           DFHEIV11,
  3116           ELMEMO-KEY,
  3117           DFHEIV99,
  3118           DFHEIV99
  3119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3120
  3121 4799-EXIT.
  3122      EXIT.
  3123
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  66
* EL1284.cbl
  3125
  3126 4900-SET-NOTES-FLAG.
  3127
  3128
  3129* EXEC CICS HANDLE CONDITION
  3130*        NOTFND   (4900-EXIT)
  3131*    END-EXEC.
  3132*    MOVE '"$I                   ! % #00002984' TO DFHEIV0
  3133     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3135     MOVE X'2520233030303032393834' TO DFHEIV0(25:11)
  3136     CALL 'kxdfhei1' USING DFHEIV0
  3137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3138
  3139
  3140     MOVE SPACES                 TO  ELCERT-KEY.
  3141     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  3142     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  3143     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  3144     MOVE PI-STATE               TO  ELCERT-STATE.
  3145     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  3146     MOVE PI-CERT-EFF-DT         TO  ELCERT-EFF-DT.
  3147     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  3148     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  3149
  3150
  3151* EXEC CICS READ
  3152*    EQUAL
  3153*    DATASET   (ELCERT-FILE-ID)
  3154*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  3155*    RIDFLD    (ELCERT-KEY)
  3156*    END-EXEC.
  3157*    MOVE '&"S        E          (   #00002998' TO DFHEIV0
  3158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3160     MOVE X'2020233030303032393938' TO DFHEIV0(25:11)
  3161     CALL 'kxdfhei1' USING DFHEIV0,
  3162           ELCERT-FILE-ID,
  3163           DFHEIV20,
  3164           DFHEIV99,
  3165           ELCERT-KEY,
  3166           DFHEIV99,
  3167           DFHEIV99,
  3168           DFHEIV99
  3169     SET ADDRESS OF CERTIFICATE-MASTER TO
  3170         DFHEIV20
  3171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3172
  3173
  3174*    MOVE 'N'                    TO PI-BILLING-NOTES-EXIST
  3175*                                   PI-CERT-NOTES-EXIST
  3176*                                   PI-CLAIM-NOTES-EXIST.
  3177*    IF CM-NOTE-SW EQUAL '2' OR '3' OR '6' OR '7'
  3178*         MOVE 'Y'               TO PI-BILLING-NOTES-EXIST
  3179*    END-IF.
  3180*    IF CM-NOTE-SW EQUAL '1' OR '3' OR '5' OR '7'
  3181*         MOVE 'Y'               TO PI-CERT-NOTES-EXIST
  3182*    END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  67
* EL1284.cbl
  3183*    IF CM-NOTE-SW EQUAL '4' OR '5' OR '6' OR '7'
  3184*         MOVE 'Y'               TO PI-CLAIM-NOTES-EXIST
  3185*    END-IF.
  3186
  3187
  3188 4900-EXIT.
  3189      EXIT.
  3190
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  68
* EL1284.cbl
  3192 5000-ADD-NEW-LINES.
  3193     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3194     MOVE 'N'                    TO WS-SCREEN-LINE.
  3195     MOVE 1                      TO WS-SUB.
  3196     MOVE ZERO                   TO WS-SUB1.
  3197     PERFORM VARYING SC-INDX FROM NUM-LINES-PER-SCREEN BY -1
  3198             UNTIL SCREEN-LINE-FOUND OR SC-INDX < 1
  3199         IF SC-TEXT (SC-INDX) >  SPACES
  3200             SET WS-SUB          TO SC-INDX
  3201             MOVE 'Y'            TO WS-SCREEN-LINE
  3202         END-IF
  3203     END-PERFORM.
  3204     IF PI-TOTAL-LINES = 0
  3205         MOVE 1                  TO WS-SUB1
  3206     ELSE
  3207         MOVE 2                  TO WS-SUB1
  3208     END-IF.
  3209     PERFORM VARYING SC-INDX FROM WS-SUB1 BY 1
  3210             UNTIL SC-INDX GREATER THAN WS-SUB
  3211         IF SC-TEXTL (SC-INDX) EQUAL ZEROS
  3212             MOVE 1      TO SC-TEXTL (SC-INDX)
  3213             MOVE SPACES TO SC-TEXT (SC-INDX)
  3214             MOVE LOW-VALUES TO SC-MTBY (SC-INDX)
  3215                                SC-MTDT (SC-INDX)
  3216         END-IF
  3217     END-PERFORM.
  3218     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3219             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3220             SC-INDX > NUM-LINES-PER-SCREEN.
  3221
  3222     IF NOT EMI-NO-ERRORS
  3223        GO TO 8200-SEND-DATAONLY
  3224     END-IF.
  3225
  3226     MOVE PI-TOTAL-LINES         TO  PI-CURRENT-LINE.
  3227     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3228     MOVE LOW-VALUES             TO  EL1284AI
  3229                                     EL1284R
  3230     PERFORM 7800-MOVE-SAVE-TO-MAP.
  3231     SET TB-INDX TO PI-CURRENT-LINE.
  3232     MOVE 'A'                    TO FUNCTI.
  3233     MOVE -1                     TO  SC-TEXTL (2).
  3234     SET CURSOR-SET TO TRUE
  3235     MOVE AL-UANON               TO  FUNCTA.
  3236     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3237             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3238             SC-INDX > NUM-LINES-PER-SCREEN.
  3239     MOVE '1'                    TO PI-UPDATE-SW.
  3240     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  69
* EL1284.cbl
  3242 5500-LOOKUP.
  3243     PERFORM 7500-READ-TS THRU 7599-EXIT.
  3244     SET TB-INDX TO PI-CURRENT-LINE.
  3245     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3246             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3247             SC-INDX > NUM-LINES-PER-SCREEN.
  3248
  3249     IF NOT EMI-NO-ERRORS
  3250        GO TO 8200-SEND-DATAONLY
  3251     END-IF.
  3252
  3253     MOVE LINE1I                 TO  PI-CURRENT-LINE.
  3254     SET TB-INDX                 TO PI-CURRENT-LINE.
  3255     MOVE LOW-VALUES             TO  EL1284AI
  3256                                     EL1284R
  3257     PERFORM 7800-MOVE-SAVE-TO-MAP.
  3258     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3259             VARYING SC-INDX FROM 1 BY 1
  3260             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3261     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3262     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  70
* EL1284.cbl
  3264 6000-NOT-OPEN.
  3265     MOVE ER-2954                TO  EMI-ERROR.
  3266     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3267
  3268     IF EIBAID = DFHCLEAR
  3269         GO TO 9410-RETURN
  3270     ELSE
  3271         GO TO 8100-SEND-INITIAL-MAP
  3272     END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  71
* EL1284.cbl
  3274 7000-BUILD-TABLE.
  3275
  3276     SET TB-INDX TO 1.
  3277     MOVE ZEROS                  TO  PI-TOTAL-LINES
  3278                                     PI-CURRENT-LINE
  3279                                     PI-TEMP-STOR-ITEMS
  3280                                     PI-UPDATE-SW.
  3281     MOVE LOW-VALUES             TO  EL1284AI
  3282                                     EL1284R
  3283
  3284****IF TEMP STORAGE EXISTS, DELETE IT.
  3285     IF PI-CHANGE-IN-NOTE-TYPE
  3286         MOVE 'N' TO PI-SET-NOTE-CHANGE
  3287     ELSE
  3288         PERFORM 7500-READ-TS THRU 7599-EXIT
  3289     END-IF.
  3290
  3291     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  3292        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  3293     END-IF.
  3294
  3295
  3296* EXEC CICS HANDLE CONDITION
  3297*         NOTFND(7010-ENDBR)
  3298*         NOTOPEN(6000-NOT-OPEN)
  3299*         ENDFILE(7010-ENDBR)
  3300*    END-EXEC.
  3301*    MOVE '"$IJ''                 ! & #00003126' TO DFHEIV0
  3302     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3304     MOVE X'2620233030303033313236' TO DFHEIV0(25:11)
  3305     CALL 'kxdfhei1' USING DFHEIV0
  3306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3307
  3308
  3309
  3310* EXEC CICS STARTBR
  3311*         DATASET(ELMEMO-FILE-ID)
  3312*         RIDFLD(ELMEMO-KEY)
  3313*         KEYLENGTH(ELMEMO-START-LENGTH)
  3314*         GENERIC
  3315*         GTEQ
  3316*    END-EXEC.
  3317     MOVE 0
  3318       TO DFHEIV11
  3319*    MOVE '&,   KG    G          &   #00003132' TO DFHEIV0
  3320     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3321     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3322     MOVE X'2020233030303033313332' TO DFHEIV0(25:11)
  3323     CALL 'kxdfhei1' USING DFHEIV0,
  3324           ELMEMO-FILE-ID,
  3325           ELMEMO-KEY,
  3326           ELMEMO-START-LENGTH,
  3327           DFHEIV11,
  3328           DFHEIV99
  3329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3330
  3331
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  72
* EL1284.cbl
  3332 7001-LOOP.
  3333
  3334* EXEC CICS READNEXT
  3335*         SET(ADDRESS OF CLAIM-MEMO-FILE)
  3336*         DATASET(ELMEMO-FILE-ID)
  3337*         RIDFLD(ELMEMO-KEY)
  3338*    END-EXEC.
  3339     MOVE 0
  3340       TO DFHEIV11
  3341*    MOVE '&.S                   )   #00003141' TO DFHEIV0
  3342     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3343     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3344     MOVE X'2020233030303033313431' TO DFHEIV0(25:11)
  3345     CALL 'kxdfhei1' USING DFHEIV0,
  3346           ELMEMO-FILE-ID,
  3347           DFHEIV20,
  3348           DFHEIV99,
  3349           ELMEMO-KEY,
  3350           DFHEIV99,
  3351           DFHEIV11,
  3352           DFHEIV99,
  3353           DFHEIV99
  3354     SET ADDRESS OF CLAIM-MEMO-FILE TO
  3355         DFHEIV20
  3356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3357
  3358
  3359     IF MM-COMPANY-CD NOT = SV-COMPANY-CD
  3360         GO TO 7010-ENDBR
  3361     END-IF.
  3362
  3363     IF (MM-CARRIER = SV-CARRIER)
  3364        AND (MM-CERT-NO = SV-CERT-NO)
  3365        AND (MM-CLAIM-NO = SV-CLAIM-NO)
  3366        AND (MM-RECORD-TYPE = SV-RECORD-TYPE)
  3367        IF MM-PAYMENT-SEQ-NO = ZERO
  3368           MOVE MM-LONG-HEALTH-APP TO LNGHLAPO
  3369                                      PI-LONG-HLTH-APP
  3370           MOVE MM-REWRITE-IND TO REWRITEO
  3371                                  PI-REWRITE
  3372           MOVE MM-CHECKED-OTHER-COVG TO CHKCOVGO
  3373                                         PI-CHKCOVG
  3374           MOVE MM-MR-RELEASED-FROM-DATE TO DC-BIN-DATE-1
  3375           MOVE ' '                    TO DC-OPTION-CODE
  3376           PERFORM 9700-LINK-DATE-CONVERT
  3377           IF DC-EDIT1-MONTH > ZERO
  3378              MOVE DC-GREG-DATE-1-EDIT    TO MRRELDTO
  3379                                             PI-MR-RELEASE-DATE
  3380           END-IF
  3381        ELSE
  3382           MOVE MM-CLAIM-MEMO TO REC-TEXT (TB-INDX)
  3383           MOVE MM-LAST-MAINT-BY TO REC-LAST-MAINT-BY (TB-INDX)
  3384           MOVE MM-LAST-MAINT-DT TO REC-LAST-MAINT-DT (TB-INDX)
  3385           MOVE MM-LAST-MAINT-HHMMSS TO
  3386                          REC-LAST-MAINT-HHMMSS (TB-INDX)
  3387           SET TB-INDX UP BY 1
  3388        END-IF
  3389        GO TO 7001-LOOP
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  73
* EL1284.cbl
  3390     END-IF.
  3391 7010-ENDBR.
  3392     IF TB-INDX = 1
  3393         MOVE ER-0006            TO EMI-ERROR
  3394         MOVE 'A'                TO FUNCTI
  3395         MOVE -1                 TO SC-TEXTL (1)
  3396         MOVE AL-UANON           TO FUNCTA
  3397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3398         MOVE ZEROS              TO PI-TOTAL-LINES
  3399         GO TO 8100-SEND-INITIAL-MAP
  3400     END-IF.
  3401
  3402
  3403* EXEC CICS ENDBR
  3404*         DATASET(ELMEMO-FILE-ID)
  3405*    END-EXEC.
  3406     MOVE 0
  3407       TO DFHEIV11
  3408*    MOVE '&2                    $   #00003190' TO DFHEIV0
  3409     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3411     MOVE X'2020233030303033313930' TO DFHEIV0(25:11)
  3412     CALL 'kxdfhei1' USING DFHEIV0,
  3413           ELMEMO-FILE-ID,
  3414           DFHEIV11,
  3415           DFHEIV99
  3416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3417
  3418
  3419     SET TB-INDX DOWN BY 1.
  3420     SET PI-TOTAL-LINES TO TB-INDX.
  3421     MOVE 1                      TO PI-CURRENT-LINE.
  3422
  3423 7050-FORMAT-LINES.
  3424     SET TB-INDX TO PI-CURRENT-LINE.
  3425     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3426             VARYING SC-INDX FROM 1
  3427             BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3428     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3429     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  74
* EL1284.cbl
  3431 7100-FORMAT-SCREEN.
  3432     IF TB-INDX > PI-TOTAL-LINES
  3433        IF FUNCTI NOT = 'A'
  3434           MOVE AL-PANON         TO SC-TEXTA (SC-INDX)
  3435        END-IF
  3436     END-IF.
  3437
  3438     IF TB-INDX > PI-TOTAL-LINES
  3439         GO TO 7100-EXIT
  3440     END-IF.
  3441
  3442     SET WS-LINE TO TB-INDX.
  3443     MOVE WS-LINE TO SC-LIN (SC-INDX).
  3444     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  3445     MOVE REC-LAST-MAINT-BY (TB-INDX) TO SC-MTBY (SC-INDX).
  3446     MOVE REC-LAST-MAINT-DT (TB-INDX) TO DC-BIN-DATE-1.
  3447     MOVE ' '                    TO DC-OPTION-CODE.
  3448     PERFORM 9700-LINK-DATE-CONVERT.
  3449     MOVE DC-GREG-DATE-1-MDY     TO SC-MTDT (SC-INDX).
  3450     SET ROLL-COUNTER TO TB-INDX.
  3451
  3452     IF NOT MODIFY-CAP
  3453         MOVE AL-PANOF           TO SC-TEXTA (SC-INDX)
  3454         SET TB-INDX UP BY 1
  3455         GO TO 7100-EXIT
  3456     END-IF.
  3457
  3458     SET TB-INDX UP BY 1.
  3459
  3460 7100-EXIT.
  3461      EXIT.
  3462
  3463 7200-PUT-TEMP-STOR.
  3464     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3465     SET TS-INDX TO 1.
  3466     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
  3467     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  3468             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
  3469             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
  3470 7249-EXIT.
  3471      EXIT.
  3472 7250-DELETE-TEMP-STOR.
  3473
  3474* EXEC CICS HANDLE CONDITION
  3475*         QIDERR(7299-EXIT)
  3476*    END-EXEC.
  3477*    MOVE '"$N                   ! '' #00003248' TO DFHEIV0
  3478     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3480     MOVE X'2720233030303033323438' TO DFHEIV0(25:11)
  3481     CALL 'kxdfhei1' USING DFHEIV0
  3482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3483
  3484
  3485* EXEC CICS DELETEQ TS
  3486*         QUEUE(QID)
  3487*    END-EXEC.
  3488*    MOVE '*&                    #   #00003251' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  75
* EL1284.cbl
  3489     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3490     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3491     MOVE X'2020233030303033323531' TO DFHEIV0(25:11)
  3492     CALL 'kxdfhei1' USING DFHEIV0,
  3493           QID,
  3494           DFHEIV99
  3495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3496
  3497 7299-EXIT.
  3498     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  76
* EL1284.cbl
  3500 7300-WRITE-TS.
  3501     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
  3502     SET TS-INDX UP BY 1.
  3503     ADD 1 TO PI-TEMP-STOR-ITEMS.
  3504
  3505* EXEC CICS WRITEQ TS
  3506*         FROM(TS-WORK-AREA)
  3507*         QUEUE(QID)
  3508*         LENGTH(TS-LENGTH)
  3509*         ITEM(PI-TEMP-STOR-ITEMS)
  3510*    END-EXEC.
  3511*    MOVE '*" I                  ''   #00003261' TO DFHEIV0
  3512     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  3513     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3514     MOVE X'2020233030303033323631' TO DFHEIV0(25:11)
  3515     CALL 'kxdfhei1' USING DFHEIV0,
  3516           QID,
  3517           TS-WORK-AREA,
  3518           TS-LENGTH,
  3519           PI-TEMP-STOR-ITEMS,
  3520           DFHEIV99,
  3521           DFHEIV99
  3522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3523
  3524 7399-EXIT.
  3525     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  77
* EL1284.cbl
  3527 7400-PAGE-ROUTINE.
  3528
  3529     IF PFENTERL NOT = ZEROS
  3530        MOVE -1                  TO PFENTERL
  3531        ELSE
  3532        MOVE -1                  TO FUNCTL
  3533     END-IF.
  3534
  3535     IF PI-TOTAL-LINES = 0
  3536        MOVE ER-0047             TO EMI-ERROR
  3537        MOVE -1                  TO FUNCTL
  3538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3539        GO TO 8200-SEND-DATAONLY
  3540     END-IF.
  3541
  3542     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
  3543
  3544     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3545        MOVE ER-0067             TO EMI-ERROR
  3546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3547        MOVE 1 TO TEMP-CURR-LINE
  3548     END-IF.
  3549
  3550     IF TEMP-CURR-LINE GREATER THAN PI-TOTAL-LINES
  3551        MOVE ER-0066             TO EMI-ERROR
  3552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3553        COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  3554                               - NUM-LINES-PER-SCREEN
  3555        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3556           MOVE 1                TO TEMP-CURR-LINE
  3557        END-IF
  3558     END-IF.
  3559
  3560     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3561     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3562             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3563             SC-INDX > NUM-LINES-PER-SCREEN.
  3564
  3565     IF EMI-ERROR = ER-0066 OR = ER-0067 OR = ZEROS
  3566        NEXT SENTENCE
  3567     ELSE
  3568        GO TO 8200-SEND-DATAONLY
  3569     END-IF.
  3570
  3571     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
  3572     SET TB-INDX TO PI-CURRENT-LINE.
  3573     MOVE LOW-VALUES             TO EL1284AI
  3574                                    EL1284R
  3575     PERFORM 7800-MOVE-SAVE-TO-MAP.
  3576     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3577             VARYING SC-INDX FROM 1 BY 1
  3578             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3579     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3580     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  78
* EL1284.cbl
  3582
  3583 7450-SET-INDX.
  3584     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  3585        SET TB-INDX TO 1
  3586     ELSE
  3587        PERFORM 7500-READ-TS THRU 7599-EXIT
  3588        IF PI-CURRENT-LINE = 0
  3589           SET TB-INDX TO 1
  3590        ELSE
  3591           SET TB-INDX TO PI-CURRENT-LINE
  3592        END-IF
  3593     END-IF.
  3594 7450-EXIT.
  3595      EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  79
* EL1284.cbl
  3597 7500-READ-TS.
  3598
  3599* EXEC CICS HANDLE CONDITION
  3600*         QIDERR(7590-TS-QIDERR)
  3601*         ITEMERR(7585-QID-ITEMERR)
  3602*    END-EXEC.
  3603*    MOVE '"$N<                  ! ( #00003341' TO DFHEIV0
  3604     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  3605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3606     MOVE X'2820233030303033333431' TO DFHEIV0(25:11)
  3607     CALL 'kxdfhei1' USING DFHEIV0
  3608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3609
  3610     SET TS-INDX TO 1.
  3611     MOVE 1                      TO QID-ITEM.
  3612 7501-LOOP.
  3613
  3614* EXEC CICS READQ TS
  3615*         INTO(TS-WORK-AREA)
  3616*         QUEUE(QID)
  3617*         LENGTH(TS-LENGTH)
  3618*         ITEM(QID-ITEM)
  3619*    END-EXEC.
  3620*    MOVE '*$II   L              ''   #00003348' TO DFHEIV0
  3621     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3622     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3623     MOVE X'2020233030303033333438' TO DFHEIV0(25:11)
  3624     CALL 'kxdfhei1' USING DFHEIV0,
  3625           QID,
  3626           TS-WORK-AREA,
  3627           TS-LENGTH,
  3628           QID-ITEM,
  3629           DFHEIV99,
  3630           DFHEIV99
  3631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3632
  3633     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
  3634     SET TS-INDX UP BY 1.
  3635     ADD 1 TO QID-ITEM.
  3636     GO TO 7501-LOOP.
  3637
  3638 7585-QID-ITEMERR.
  3639     IF EIBTRNID NOT = TRANS-ID
  3640        SUBTRACT 1 FROM QID-ITEM
  3641        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS
  3642     END-IF.
  3643     GO TO 7599-EXIT.
  3644
  3645 7590-TS-QIDERR.
  3646     IF EIBTRNID = TRANS-ID
  3647        AND EIBAID = DFHCLEAR
  3648           GO TO 9410-RETURN
  3649     END-IF.
  3650     IF EIBTRNID = TRANS-ID
  3651        MOVE ER-0033             TO EMI-ERROR
  3652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3653        GO TO 8100-SEND-INITIAL-MAP
  3654     END-IF.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  80
* EL1284.cbl
  3655
  3656 7599-EXIT.
  3657      EXIT.
  3658
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  81
* EL1284.cbl
  3660 7600-UPDATE-TABLE-FROM-SCREEN.
  3661
  3662     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3663         IF TB-INDX NOT > PI-TOTAL-LINES
  3664             PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3665             SET TB-INDX UP BY 1
  3666         ELSE
  3667             IF PI-TOTAL-LINES = MAX-LINES
  3668                 MOVE ER-0051    TO EMI-ERROR
  3669                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3670                 GO TO 8200-SEND-DATAONLY
  3671             ELSE
  3672                 PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3673                 SET TB-INDX UP BY 1
  3674                 ADD 1 TO PI-TOTAL-LINES
  3675             END-IF
  3676         END-IF
  3677     ELSE
  3678        IF TB-INDX NOT > PI-TOTAL-LINES
  3679           SET TB-INDX UP BY 1
  3680        END-IF
  3681     END-IF.
  3682
  3683 7699-EXIT.
  3684      EXIT.
  3685
  3686 7700-MOVE-DATA.
  3687     MOVE '1'                    TO PI-UPDATE-SW.
  3688
  3689     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3690        MOVE SC-TEXT (SC-INDX)  TO REC-TEXT (TB-INDX)
  3691        MOVE PI-PROCESSOR-ID    TO REC-LAST-MAINT-BY (TB-INDX)
  3692        MOVE EIBTIME            TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  3693        MOVE SAVE-BIN-DATE      TO REC-LAST-MAINT-DT (TB-INDX)
  3694     END-IF.
  3695
  3696 7700-EXIT.
  3697      EXIT.
  3698 7800-MOVE-SAVE-TO-MAP.
  3699     MOVE PI-LONG-HLTH-APP TO LNGHLAPI
  3700     MOVE PI-REWRITE TO REWRITEI
  3701     MOVE PI-CHKCOVG TO CHKCOVGI
  3702     MOVE PI-MR-RELEASE-DATE TO MRRELDTI.
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  82
* EL1284.cbl
  3704 8100-SEND-INITIAL-MAP.
  3705     MOVE SAVE-DATE              TO DATEO.
  3706     MOVE EIBTIME                TO TIME-IN.
  3707     MOVE TIME-OUT               TO TIMEO.
  3708     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3709     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3710     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGBO.
  3711     MOVE PI-CARRIER             TO CARRO
  3712*    MOVE PI-GROUPING            TO FGROUPO.
  3713*    MOVE PI-STATE               TO FSTO.
  3714*    MOVE PI-ACCOUNT             TO FACOUNTO.
  3715     MOVE PI-CERT-NO             TO CERTNOO
  3716     MOVE PI-CLAIM-NO            TO CLAIMNOO
  3717*    MOVE PI-CERT-SFX            TO FCRTSFXO.
  3718*
  3719     PERFORM 8150-READ-CLAIM.
  3720*
  3721     MOVE  ' '                   TO DC-OPTION-CODE.
  3722     MOVE PI-CERT-EFF-DT         TO DC-BIN-DATE-1.
  3723     PERFORM 9700-LINK-DATE-CONVERT.
  3724*    MOVE DC-GREG-DATE-1-EDIT    TO FEFFDTO.
  3725     MOVE PI-TOTAL-LINES         TO TOTO.
  3726*    IF PI-CLAIM-NOTE
  3727*        MOVE SCR-CLAIM-NOTE-TYPE TO FTYPEO
  3728*        MOVE SCR-PF6-CERT        TO PF6NOTEO
  3729*        MOVE SCR-CERT-YN         TO FTYPEYNO
  3730*        IF PI-CERT-NOTES-EXIST = 'Y'
  3731*            MOVE 'YES'           TO FCERTYNO
  3732*        ELSE
  3733*            MOVE 'NO '           TO FCERTYNO
  3734*        END-IF
  3735*    ELSE
  3736*        MOVE SCR-CERT-NOTE-TYPE TO FTYPEO
  3737*        MOVE SCR-PF6-CLAIM      TO PF6NOTEO
  3738*        MOVE SCR-CLAIM-YN       TO FTYPEYNO
  3739*        IF PI-CLAIM-NOTES-EXIST = 'Y'
  3740*            MOVE 'YES'           TO FCERTYNO
  3741*        ELSE
  3742*            MOVE 'NO '           TO FCERTYNO
  3743*        END-IF
  3744*    END-IF.
  3745*    IF PI-BILLING-NOTES-EXIST = 'Y'
  3746*        MOVE 'YES'           TO FBILLYNO
  3747*    ELSE
  3748*        MOVE 'NO '           TO FBILLYNO
  3749*    END-IF
  3750
  3751     MOVE EL1284R TO GROUP2.
  3752     IF NOT CURSOR-SET
  3753        MOVE -1                     TO LNGHLAPL
  3754     END-IF
  3755
  3756
  3757* EXEC CICS SEND
  3758*         MAP(MAP-NAME)
  3759*         MAPSET(MAPSET-NAME)
  3760*         FROM(EL1284AO)
  3761*         ERASE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  83
* EL1284.cbl
  3762*         CURSOR
  3763*    END-EXEC.
  3764     MOVE LENGTH OF
  3765      EL1284AO
  3766       TO DFHEIV12
  3767     MOVE -1
  3768       TO DFHEIV11
  3769*    MOVE '8$     CT  E    H L F ,   #00003477' TO DFHEIV0
  3770     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3771     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3772     MOVE X'2020233030303033343737' TO DFHEIV0(25:11)
  3773     CALL 'kxdfhei1' USING DFHEIV0,
  3774           MAP-NAME,
  3775           EL1284AO,
  3776           DFHEIV12,
  3777           MAPSET-NAME,
  3778           DFHEIV99,
  3779           DFHEIV99,
  3780           DFHEIV99,
  3781           DFHEIV11,
  3782           DFHEIV99,
  3783           DFHEIV99,
  3784           DFHEIV99
  3785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3786
  3787
  3788     GO TO 9100-RETURN-TRAN.
  3789
  3790 8150-READ-CLAIM.
  3791
  3792* EXEC CICS HANDLE CONDITION
  3793*        NOTFND   (8150-NOT-FOUND)
  3794*    END-EXEC.
  3795*    MOVE '"$I                   ! ) #00003488' TO DFHEIV0
  3796     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3798     MOVE X'2920233030303033343838' TO DFHEIV0(25:11)
  3799     CALL 'kxdfhei1' USING DFHEIV0
  3800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3801
  3802     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  3803     MOVE PI-CARRIER             TO MSTR-CARRIER.
  3804     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  3805     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  3806
  3807
  3808* EXEC CICS READ
  3809*        UPDATE
  3810*        DATASET   ('ELMSTR')
  3811*        RIDFLD    (ELMSTR-KEY)
  3812*        INTO      (CLAIM-MASTER)
  3813*    END-EXEC.
  3814     MOVE LENGTH OF
  3815      CLAIM-MASTER
  3816       TO DFHEIV11
  3817     MOVE 'ELMSTR' TO DFHEIV1
  3818*    MOVE '&"IL       EU         (   #00003496' TO DFHEIV0
  3819     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  84
* EL1284.cbl
  3820     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3821     MOVE X'2020233030303033343936' TO DFHEIV0(25:11)
  3822     CALL 'kxdfhei1' USING DFHEIV0,
  3823           DFHEIV1,
  3824           CLAIM-MASTER,
  3825           DFHEIV11,
  3826           ELMSTR-KEY,
  3827           DFHEIV99,
  3828           DFHEIV99,
  3829           DFHEIV99
  3830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3831
  3832     EVALUATE TRUE
  3833        WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  3834           MOVE PI-AH-OVERRIDE-L6
  3835                                 TO TYPEO
  3836        WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  3837           MOVE PI-LIFE-OVERRIDE-L6
  3838                                 TO TYPEO
  3839        WHEN CL-CLAIM-TYPE = 'I'
  3840           MOVE '  IU  '         TO TYPEO
  3841        WHEN CL-CLAIM-TYPE = 'G'
  3842           MOVE ' GAP  '         TO TYPEO
  3843        WHEN CL-CLAIM-TYPE = 'F'
  3844           MOVE ' FAM  '         TO TYPEO
  3845     END-EVALUATE.
  3846     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
  3847     MOVE CL-INSURED-LAST-NAME   TO LASTNMEO.
  3848 8150-NOT-FOUND.
  3849     MOVE SPACES    TO TYPEO.
  3850*
  3851 8200-SEND-DATAONLY.
  3852     MOVE EIBTIME                TO TIME-IN.
  3853     MOVE TIME-OUT               TO TIMEO.
  3854     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3855     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3856     MOVE PI-TOTAL-LINES         TO TOTO.
  3857     MOVE EL1284R TO GROUP2.
  3858
  3859     IF NOT EMI-NO-ERRORS
  3860        MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO
  3861     ELSE
  3862        MOVE -1                  TO FUNCTL
  3863     END-IF.
  3864
  3865
  3866* EXEC CICS SEND
  3867*         MAP(MAP-NAME)
  3868*         MAPSET(MAPSET-NAME)
  3869*         FROM(EL1284AO)
  3870*         DATAONLY
  3871*         CURSOR
  3872*    END-EXEC.
  3873     MOVE LENGTH OF
  3874      EL1284AO
  3875       TO DFHEIV12
  3876     MOVE -1
  3877       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  85
* EL1284.cbl
  3878*    MOVE '8$D    CT       H L F ,   #00003535' TO DFHEIV0
  3879     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3880     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3881     MOVE X'2020233030303033353335' TO DFHEIV0(25:11)
  3882     CALL 'kxdfhei1' USING DFHEIV0,
  3883           MAP-NAME,
  3884           EL1284AO,
  3885           DFHEIV12,
  3886           MAPSET-NAME,
  3887           DFHEIV99,
  3888           DFHEIV99,
  3889           DFHEIV99,
  3890           DFHEIV11,
  3891           DFHEIV99,
  3892           DFHEIV99,
  3893           DFHEIV99
  3894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3895
  3896
  3897     GO TO 9100-RETURN-TRAN.
  3898
  3899 8300-SEND-TEXT.
  3900
  3901* EXEC CICS SEND TEXT
  3902*         FROM(LOGOFF-TEXT)
  3903*         ERASE
  3904*         FREEKB
  3905*         LENGTH(LOGOFF-LENGTH)
  3906*    END-EXEC.
  3907*    MOVE '8&      T  E F  H   F -   #00003546' TO DFHEIV0
  3908     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3909     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3910     MOVE X'2020233030303033353436' TO DFHEIV0(25:11)
  3911     CALL 'kxdfhei1' USING DFHEIV0,
  3912           LOGOFF-TEXT,
  3913           LOGOFF-LENGTH,
  3914           DFHEIV99,
  3915           DFHEIV99,
  3916           DFHEIV99,
  3917           DFHEIV99,
  3918           DFHEIV99,
  3919           DFHEIV99,
  3920           DFHEIV99,
  3921           DFHEIV99,
  3922           DFHEIV99,
  3923           DFHEIV99
  3924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3925
  3926
  3927     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3928
  3929
  3930* EXEC CICS RETURN
  3931*    END-EXEC.
  3932*    MOVE '.(                    ''   #00003555' TO DFHEIV0
  3933     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3934     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3935     MOVE X'2020233030303033353535' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  86
* EL1284.cbl
  3936     CALL 'kxdfhei1' USING DFHEIV0,
  3937           DFHEIV99,
  3938           DFHEIV99,
  3939           DFHEIV99,
  3940           DFHEIV99,
  3941           DFHEIV99,
  3942           DFHEIV99
  3943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3944
  3945
  3946 8800-UNAUTHORIZED-ACCESS.
  3947     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3948     GO TO 8300-SEND-TEXT.
  3949
  3950 9000-RETURN-CICS.
  3951     IF PI-CHANGES-MADE
  3952        MOVE ER-0045             TO EMI-ERROR
  3953        MOVE -1                  TO FUNCTL
  3954        MOVE SPACES              TO PFENTERO
  3955        MOVE AL-UNNOF            TO PFENTERA
  3956        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3957        GO TO 8200-SEND-DATAONLY
  3958     END-IF.
  3959
  3960     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3961     MOVE XCTL-005               TO PGM-NAME.
  3962     GO TO 9300-XCTL.
  3963
  3964 9100-RETURN-TRAN.
  3965     MOVE SCRN-NUMBER            TO PI-CURRENT-SCREEN-NO.
  3966     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3967
  3968* EXEC CICS RETURN
  3969*         TRANSID(TRANS-ID)
  3970*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3971*         LENGTH(PI-COMM-LENGTH)
  3972*    END-EXEC.
  3973*    MOVE '.(CT                  ''   #00003579' TO DFHEIV0
  3974     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3975     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3976     MOVE X'2020233030303033353739' TO DFHEIV0(25:11)
  3977     CALL 'kxdfhei1' USING DFHEIV0,
  3978           TRANS-ID,
  3979           PROGRAM-INTERFACE-BLOCK,
  3980           PI-COMM-LENGTH,
  3981           DFHEIV99,
  3982           DFHEIV99,
  3983           DFHEIV99
  3984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3985
  3986
  3987
  3988 9200-RETURN-MAIN-MENU.
  3989     IF PI-CHANGES-MADE
  3990        MOVE -1                  TO FUNCTL
  3991        MOVE SPACES              TO PFENTERO
  3992        MOVE AL-UNNOF            TO PFENTERA
  3993        MOVE ER-0045             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  87
* EL1284.cbl
  3994        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3995        GO TO 8200-SEND-DATAONLY
  3996     END-IF.
  3997
  3998     MOVE XCTL-126               TO PGM-NAME.
  3999
  4000 9300-XCTL.
  4001     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4002
  4003* EXEC CICS XCTL
  4004*         PROGRAM  (PGM-NAME)
  4005*         COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4006*         LENGTH   (PI-COMM-LENGTH)
  4007*    END-EXEC.
  4008*    MOVE '.$C                   %   #00003600' TO DFHEIV0
  4009     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4010     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4011     MOVE X'2020233030303033363030' TO DFHEIV0(25:11)
  4012     CALL 'kxdfhei1' USING DFHEIV0,
  4013           PGM-NAME,
  4014           PROGRAM-INTERFACE-BLOCK,
  4015           PI-COMM-LENGTH,
  4016           DFHEIV99
  4017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4018
  4019
  4020 9400-CLEAR.
  4021
  4022     IF PI-CHANGES-MADE
  4023         MOVE ER-0045            TO EMI-ERROR
  4024         MOVE -1                 TO FUNCTL
  4025         SET CURSOR-SET TO TRUE
  4026         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4027         PERFORM 7800-MOVE-SAVE-TO-MAP
  4028         IF PI-CURRENT-LINE GREATER THAN ZERO
  4029             PERFORM 7500-READ-TS THRU 7599-EXIT
  4030             SET TB-INDX TO PI-CURRENT-LINE
  4031             PERFORM 7100-FORMAT-SCREEN  THRU  7100-EXIT
  4032                 VARYING SC-INDX FROM 1 BY 1 UNTIL
  4033                 SC-INDX GREATER NUM-LINES-PER-SCREEN
  4034         END-IF
  4035         GO TO 8100-SEND-INITIAL-MAP
  4036     END-IF.
  4037
  4038 9410-RETURN.
  4039*    IF PF5-PRESSED
  4040*        MOVE PGM-EL1276           TO PGM-NAME
  4041*    ELSE
  4042*        IF PF6-PRESSED
  4043*            IF PI-CLAIM-NOTE
  4044*                SET PI-CERT-NOTE  TO TRUE
  4045*            ELSE
  4046*                SET PI-CLAIM-NOTE TO TRUE
  4047*            END-IF
  4048*            SET PI-CHANGE-IN-NOTE-TYPE TO TRUE
  4049*            MOVE 'N'              TO PI-PF6-PRESSED
  4050*            GO TO 1000-START
  4051*        ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  88
* EL1284.cbl
  4052             MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
  4053*        END-IF
  4054*    END-IF.
  4055     GO TO 9300-XCTL.
  4056
  4057 9500-PF12.
  4058     IF PI-CHANGES-MADE
  4059        MOVE -1                  TO FUNCTL
  4060        MOVE SPACES              TO PFENTERO
  4061        MOVE AL-UNNOF            TO PFENTERA
  4062        MOVE ER-0045             TO EMI-ERROR
  4063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4064        GO TO 8200-SEND-DATAONLY
  4065     END-IF.
  4066
  4067     MOVE 'EL010'                TO PGM-NAME.
  4068     GO TO 9300-XCTL.
  4069
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  89
* EL1284.cbl
  4071
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  90
* EL1284.cbl
  4073 9600-PGMID-ERROR.
  4074
  4075* EXEC CICS HANDLE CONDITION
  4076*         PGMIDERR(8300-SEND-TEXT)
  4077*    END-EXEC.
  4078*    MOVE '"$L                   ! * #00003660' TO DFHEIV0
  4079     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4081     MOVE X'2A20233030303033363630' TO DFHEIV0(25:11)
  4082     CALL 'kxdfhei1' USING DFHEIV0
  4083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4084
  4085
  4086     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  4087     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  4088     MOVE XCTL-005               TO  PGM-NAME.
  4089     MOVE PGM-NAME               TO  LOGOFF-PGM.
  4090     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  4091
  4092     GO TO 9300-XCTL.
  4093
  4094 9700-LINK-DATE-CONVERT.
  4095
  4096     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4097
  4098* EXEC CICS LINK
  4099*        PROGRAM    (PGM-NAME)
  4100*        COMMAREA   (DATE-CONVERSION-DATA)
  4101*        LENGTH     (DC-COMM-LENGTH)
  4102*    END-EXEC.
  4103*    MOVE '."C                   (   #00003675' TO DFHEIV0
  4104     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4106     MOVE X'2020233030303033363735' TO DFHEIV0(25:11)
  4107     CALL 'kxdfhei1' USING DFHEIV0,
  4108           PGM-NAME,
  4109           DATE-CONVERSION-DATA,
  4110           DC-COMM-LENGTH,
  4111           DFHEIV99,
  4112           DFHEIV99,
  4113           DFHEIV99,
  4114           DFHEIV99
  4115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4116
  4117
  4118 9700-EXIT.
  4119     EXIT.
  4120
  4121 9900-ERROR-FORMAT.
  4122     IF NOT EMI-ERRORS-COMPLETE
  4123        MOVE LINK-001            TO  PGM-NAME
  4124
  4125* EXEC CICS LINK
  4126*            PROGRAM(PGM-NAME)
  4127*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4128*            LENGTH(EMI-COMM-LENGTH)
  4129*       END-EXEC
  4130*    MOVE '."C                   (   #00003687' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  91
* EL1284.cbl
  4131     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4132     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4133     MOVE X'2020233030303033363837' TO DFHEIV0(25:11)
  4134     CALL 'kxdfhei1' USING DFHEIV0,
  4135           PGM-NAME,
  4136           ERROR-MESSAGE-INTERFACE-BLOCK,
  4137           EMI-COMM-LENGTH,
  4138           DFHEIV99,
  4139           DFHEIV99,
  4140           DFHEIV99,
  4141           DFHEIV99
  4142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4143     END-IF.
  4144 9900-EXIT.
  4145     EXIT.
  4146
  4147 9990-ABEND.
  4148     MOVE LINK-004               TO  PGM-NAME.
  4149     MOVE DFHEIBLK               TO  EMI-LINE1.
  4150
  4151
  4152* EXEC CICS LINK
  4153*        PROGRAM   (PGM-NAME)
  4154*        COMMAREA  (EMI-LINE1)
  4155*        LENGTH    (72)
  4156*    END-EXEC.
  4157     MOVE 72
  4158       TO DFHEIV11
  4159*    MOVE '."C                   (   #00003700' TO DFHEIV0
  4160     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4162     MOVE X'2020233030303033373030' TO DFHEIV0(25:11)
  4163     CALL 'kxdfhei1' USING DFHEIV0,
  4164           PGM-NAME,
  4165           EMI-LINE1,
  4166           DFHEIV11,
  4167           DFHEIV99,
  4168           DFHEIV99,
  4169           DFHEIV99,
  4170           DFHEIV99
  4171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4172
  4173
  4174     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGBO.
  4175     MOVE -1                     TO  FUNCTL.
  4176
  4177     GO TO 8100-SEND-INITIAL-MAP.
  4178
  4179
  4180* GOBACK.
  4181     MOVE '9%                    "   ' TO DFHEIV0
  4182     MOVE 'EL1284' TO DFHEIV1
  4183     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4184     GOBACK.
  4185
  4186 9995-SECURITY-VIOLATION.
  4187*                                COPY ELCSCTP.
  4188******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  92
* EL1284.cbl
  4189*                                                                *
  4190*                            ELCSCTP                             *
  4191*                            VMOD=2.001                          *
  4192*                                                                *
  4193*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4194******************************************************************
  4195
  4196
  4197     MOVE EIBDATE          TO SM-JUL-DATE.
  4198     MOVE EIBTRMID         TO SM-TERMID.
  4199     MOVE THIS-PGM         TO SM-PGM.
  4200     MOVE EIBTIME          TO TIME-IN.
  4201     MOVE TIME-OUT         TO SM-TIME.
  4202     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4203
  4204
  4205* EXEC CICS LINK
  4206*         PROGRAM  ('EL003')
  4207*         COMMAREA (SECURITY-MESSAGE)
  4208*         LENGTH   (80)
  4209*    END-EXEC.
  4210     MOVE 'EL003' TO DFHEIV1
  4211     MOVE 80
  4212       TO DFHEIV11
  4213*    MOVE '."C                   (   #00003731' TO DFHEIV0
  4214     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4215     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4216     MOVE X'2020233030303033373331' TO DFHEIV0(25:11)
  4217     CALL 'kxdfhei1' USING DFHEIV0,
  4218           DFHEIV1,
  4219           SECURITY-MESSAGE,
  4220           DFHEIV11,
  4221           DFHEIV99,
  4222           DFHEIV99,
  4223           DFHEIV99,
  4224           DFHEIV99
  4225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4226
  4227
  4228******************************************************************
  4229
  4230
  4231 9995-EXIT.
  4232     EXIT.
  4233
  4234 9999-DFHBACK SECTION.
  4235     MOVE '9%                    "   ' TO DFHEIV0
  4236     MOVE 'EL1284' TO DFHEIV1
  4237     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4238     GOBACK.
  4239 9999-DFHEXIT.
  4240     IF DFHEIGDJ EQUAL 0001
  4241         NEXT SENTENCE
  4242     ELSE IF DFHEIGDJ EQUAL 2
  4243         GO TO 9400-CLEAR
  4244         DEPENDING ON DFHEIGDI
  4245     ELSE IF DFHEIGDJ EQUAL 3
  4246         GO TO 9990-ABEND,
* Micro Focus Server Express         V5.1 revision 000 28-Jan-16 10:04 Page  93
* EL1284.cbl
  4247               9600-PGMID-ERROR
  4248         DEPENDING ON DFHEIGDI
  4249     ELSE IF DFHEIGDJ EQUAL 4
  4250         GO TO 4610-ENDBR,
  4251               6000-NOT-OPEN,
  4252               4610-ENDBR
  4253         DEPENDING ON DFHEIGDI
  4254     ELSE IF DFHEIGDJ EQUAL 5
  4255         GO TO 4900-EXIT
  4256         DEPENDING ON DFHEIGDI
  4257     ELSE IF DFHEIGDJ EQUAL 6
  4258         GO TO 7010-ENDBR,
  4259               6000-NOT-OPEN,
  4260               7010-ENDBR
  4261         DEPENDING ON DFHEIGDI
  4262     ELSE IF DFHEIGDJ EQUAL 7
  4263         GO TO 7299-EXIT
  4264         DEPENDING ON DFHEIGDI
  4265     ELSE IF DFHEIGDJ EQUAL 8
  4266         GO TO 7590-TS-QIDERR,
  4267               7585-QID-ITEMERR
  4268         DEPENDING ON DFHEIGDI
  4269     ELSE IF DFHEIGDJ EQUAL 9
  4270         GO TO 8150-NOT-FOUND
  4271         DEPENDING ON DFHEIGDI
  4272     ELSE IF DFHEIGDJ EQUAL 10
  4273         GO TO 8300-SEND-TEXT
  4274         DEPENDING ON DFHEIGDI.
  4275     MOVE '9%                    "   ' TO DFHEIV0
  4276     MOVE 'EL1284' TO DFHEIV1
  4277     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4278     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       31624     Code:       12584
