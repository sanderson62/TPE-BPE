* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page   1
* EL1278.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL1278.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page   2
* EL1278.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
    47******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page   3
* EL1278.cbl
    49 ENVIRONMENT DIVISION.
    50 DATA DIVISION.
    51 WORKING-STORAGE SECTION.
    52 01  DFH-START PIC X(04).
    53 77  FILLER  PIC  X(32) VALUE '********************************'.
    54 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    55 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    56 77  S1                          PIC S999 COMP-3 VALUE +0.
    57 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    58
    59*                            COPY ELCSCTM.
    60******************************************************************
    61*                                                                *
    62*                                                                *
    63*                            ELCSCTM                             *
    64*                            VMOD=2.001                          *
    65*                                                                *
    66*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    67*                                                                *
    68******************************************************************
    69 01  SECURITY-MESSAGE.
    70     12  FILLER                          PIC X(30)
    71            VALUE '** LOGIC SECURITY VIOLATION -'.
    72     12  SM-READ                         PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' PGM='.
    75     12  SM-PGM                          PIC X(6).
    76     12  FILLER                          PIC X(5)
    77            VALUE ' OPR='.
    78     12  SM-PROCESSOR-ID                 PIC X(4).
    79     12  FILLER                          PIC X(6)
    80            VALUE ' TERM='.
    81     12  SM-TERMID                       PIC X(4).
    82     12  FILLER                          PIC XX   VALUE SPACE.
    83     12  SM-JUL-DATE                     PIC 9(5).
    84     12  FILLER                          PIC X    VALUE SPACE.
    85     12  SM-TIME                         PIC 99.99.
    86
    87
    88*                            COPY ELCSCRTY.
    89******************************************************************
    90*                                                                *
    91*                                                                *
    92*                            ELCSCRTY                            *
    93*                            VMOD=2.001                          *
    94*                                                                *
    95*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    96*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    97*        SAVED IN PI-SECURITY-ADDRESS.                           *
    98*                                                                *
    99******************************************************************
   100 01  SECURITY-CONTROL.
   101     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   102     12  FILLER                       PIC XX    VALUE 'SC'.
   103     12  SC-CREDIT-CODES.
   104         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   105             20  SC-CREDIT-DISPLAY    PIC X.
   106             20  SC-CREDIT-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page   4
* EL1278.cbl
   107     12  SC-CLAIMS-CODES.
   108         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   109             20  SC-CLAIMS-DISPLAY    PIC X.
   110             20  SC-CLAIMS-UPDATE     PIC X.
   111
   112 01  FILLER          COMP-3.
   113     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   114     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   115     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   116     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   117     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   118     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   119     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   120     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   121     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   122
   123 01  WS-DATE-AREA.
   124     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   125     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
   126     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   127     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   128     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   129     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   130
   131 01  STANDARD-AREAS.
   132     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   133     12  SUB3                    PIC S9(04) COMP VALUE +0.
   134     12  SUB4                    PIC S9(04) COMP VALUE +0.
   135     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   136     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   137     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   138     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   139     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   140     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   141     12  PGM-NAME                PIC  X(08).
   142     12  TIME-IN                 PIC S9(07).
   143     12  TIME-OUT-R  REDEFINES  TIME-IN.
   144         16  FILLER              PIC  X(01).
   145         16  TIME-OUT            PIC  9(02)V99.
   146         16  FILLER              PIC  X(02).
   147     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   148     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   149     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   150     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   151     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   152     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   153     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   154     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
   155     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   156     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   157     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   158     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   159     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   160     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   161     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERNOTE'.
   162     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   163     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   164         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page   5
* EL1278.cbl
   165     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   166         88  BROWSE-STARTED                      VALUE 'Y'.
   167     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   168         88  FORM-FOUND                          VALUE 'Y'.
   169     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   170         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   171     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   172         88  WS-REDUCING                         VALUE 'R'.
   173         88  WS-LEVEL                            VALUE 'L'  'P'.
   174     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   175         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   176     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   177         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   178     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   179     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   180         'CLAIM PMTS'.
   181     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   182         'ITD REFUND'.
   183     12  WS-ACCESS.
   184         16  FILLER              PIC  X(02).
   185         16  WS-BEN-CD           PIC  X(02).
   186     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   187     12  WS-LOOKUP-TYPE          PIC  X(01).
   188     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   189     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   190     12  WS-CALC-CD              PIC  X(01).
   191     12  DEEDIT-FIELD            PIC  X(15).
   192     12  DEEDIT-FIELD-V0  REDEFINES
   193         DEEDIT-FIELD            PIC S9(15).
   194     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   195     12  RETURN-FROM             PIC  X(08).
   196     12  QID.
   197         16  QID-TERM            PIC  X(04).
   198         16  FILLER              PIC  X(04)      VALUE '127H'.
   199     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   200         88  FIRST-ENTRY                         VALUE 'Y'.
   201     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   202         88  CERT-FOUND                          VALUE 'Y'.
   203         88  CERT-NOT-FOUND                      VALUE 'N'.
   204     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   205         88  CNTL-FOUND                          VALUE 'Y'.
   206         88  CNTL-NOT-FOUND                      VALUE 'N'.
   207     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
   208         88  BEN-FOUND                           VALUE 'Y'.
   209     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   210         88  STATE-FOUND                         VALUE 'Y'.
   211     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   212         88  ST-BEN-FOUND                        VALUE 'Y'.
   213     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   214         88  ACCT-FOUND                          VALUE 'Y'.
   215     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   216         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   217     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   218                                                 VALUE ZERO.
   219         88  BENEFIT-FOUND                       VALUE +1.
   220     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   221                                                 VALUE ZERO.
   222     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page   6
* EL1278.cbl
   223                                                 VALUE ZERO.
   224     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   225     12  WS-SUB1                 PIC S99    COMP.
   226     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   227     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   228     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   229     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   230     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   231     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   232     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   233     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   234     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   235     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   236     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   237     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   238     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   239     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   240     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   241     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   242     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   243     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   244     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   245     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   246     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   247     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   248     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   249     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   250     12  ERROR-MESSAGES.
   251         16  ER-0000             PIC  X(04)      VALUE '0000'.
   252         16  ER-0004             PIC  X(04)      VALUE '0004'.
   253         16  ER-0008             PIC  X(04)      VALUE '0008'.
   254         16  ER-0028             PIC  X(04)      VALUE '0028'.
   255         16  ER-0029             PIC  X(04)      VALUE '0029'.
   256         16  ER-0070             PIC  X(04)      VALUE '0070'.
   257         16  ER-0214             PIC  X(04)      VALUE '0214'.
   258         16  ER-0681             PIC  X(04)      VALUE '0681'.
   259         16  ER-0682             PIC  X(04)      VALUE '0682'.
   260         16  ER-0683             PIC  X(04)      VALUE '0683'.
   261         16  ER-0684             PIC  X(04)      VALUE '0684'.
   262         16  ER-2227             PIC  X(04)      VALUE '2227'.
   263         16  ER-2601             PIC  X(04)      VALUE '2601'.
   264         16  ER-2616             PIC  X(04)      VALUE '2616'.
   265         16  ER-2617             PIC  X(04)      VALUE '2617'.
   266         16  ER-2619             PIC  X(04)      VALUE '2619'.
   267         16  ER-2740             PIC  X(04)      VALUE '2740'.
   268         16  ER-2756             PIC  X(04)      VALUE '2756'.
   269         16  ER-2768             PIC  X(04)      VALUE '2768'.
   270         16  ER-2774             PIC  X(04)      VALUE '2774'.
   271         16  ER-2775             PIC  X(04)      VALUE '2775'.
   272         16  ER-2965             PIC  X(04)      VALUE '2965'.
   273         16  ER-2966             PIC  X(04)      VALUE '2966'.
   274         16  ER-2967             PIC  X(04)      VALUE '2967'.
   275         16  ER-2968             PIC  X(04)      VALUE '2968'.
   276         16  ER-2969             PIC  X(04)      VALUE '2969'.
   277         16  ER-3037             PIC  X(04)      VALUE '3037'.
   278         16  ER-3038             PIC  X(04)      VALUE '3038'.
   279         16  ER-3039             PIC  X(04)      VALUE '3039'.
   280         16  ER-3780             PIC  X(04)      VALUE '3780'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page   7
* EL1278.cbl
   281         16  ER-3781             PIC  X(04)      VALUE '3781'.
   282         16  ER-8160             PIC  X(04)      VALUE '8160'.
   283         16  ER-8161             PIC  X(04)      VALUE '8161'.
   284     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   285     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   286     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   287     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   288
   289     12  WS-RESPONSE             PIC S9(8)       COMP.
   290         88  WS-RESP-NORMAL                      VALUE +00.
   291         88  WS-RESP-NOTFND                      VALUE +13.
   292         88  WS-RESP-DUPKEY                      VALUE +15.
   293         88  WS-RESP-NOTOPEN                     VALUE +19.
   294         88  WS-RESP-ENDFILE                     VALUE +20.
   295
   296 01  WS-SAVE-ALLOWABLE-BENEFIT.
   297     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   298     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   299     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   300     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
   301     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   302     16  FILLER                    PIC XX.
   303
   304 01  WS-CAN-QUOTE-NOTE.
   305     12  WS-CN-DT-QUOTED         PIC  X(09).
   306     12  FILLER                  PIC  X(10)      VALUE
   307         'RF QUOTE: '.
   308     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   309     12  FILLER                  PIC  X(4)       VALUE
   310         ' LF '.
   311     12  WS-CN-LF-REF-METH       PIC  X.
   312     12  FILLER                  PIC  X          VALUE ','.
   313     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   314     12  FILLER                  PIC  X(5)       VALUE
   315         ' AH '.
   316     12  WS-CN-AH-REF-METH       PIC  X.
   317     12  FILLER                  PIC  XX         VALUE ','.
   318     12  FILLER                  PIC  X(6)       VALUE
   319         'TOTAL '.
   320     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   321     12  FILLER                  PIC  X(01)      VALUE ' '.
   322     12  WS-CN-CANCEL-DT         PIC  X(08).
   323     12  FILLER                  PIC  X(01)      VALUE ';'.
   324     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   325
   326 01  WS-CM-CONTROL-PRIMARY.
   327     12  WS-CM-COMPANY-CD        PIC  X(01).
   328     12  WS-CM-CARRIER           PIC  X(01).
   329     12  WS-CM-GROUPING          PIC  X(06).
   330     12  WS-CM-STATE             PIC  X(02).
   331     12  WS-CM-ACCOUNT           PIC  X(10).
   332     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   333     12  WS-CM-CERT-NO.
   334         16  WS-CM-CERT-PRIME    PIC  X(10).
   335         16  WS-CM-CERT-SFX      PIC  X(01).
   336
   337 01  WS-MA-CONTROL-PRIMARY.
   338     12  WS-MA-COMPANY-CD        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page   8
* EL1278.cbl
   339     12  WS-MA-CARRIER           PIC  X(01).
   340     12  WS-MA-GROUPING          PIC  X(06).
   341     12  WS-MA-STATE             PIC  X(02).
   342     12  WS-MA-ACCOUNT           PIC  X(10).
   343     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   344     12  WS-MA-CERT-NO.
   345         16  WS-MA-CERT-PRIME    PIC  X(10).
   346         16  WS-MA-CERT-SFX      PIC  X(01).
   347 01  WS-CF-CONTROL-PRIMARY.
   348     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   349     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   350*        88  COMPANY-MASTER                      VALUE '1'.
   351*        88  STATE-MASTER                        VALUE '3'.
   352*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   353*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   354     12  WS-CF-ACCESS.
   355         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   356         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   357             20  FILLER          PIC  X(01).
   358             20  WS-CF-CARRIER   PIC  X(01).
   359     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   360
   361 01  WS-AM-CONTROL-PRIMARY.
   362     12  WS-AM-COMPANY-CD        PIC  X(01).
   363     12  WS-AM-CARRIER           PIC  X(01).
   364     12  WS-AM-GROUPING          PIC  X(06).
   365     12  WS-AM-STATE             PIC  X(02).
   366     12  WS-AM-ACCOUNT           PIC  X(10).
   367     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   368     12  WS-AM-FILLER            PIC  X(04).
   369
   370 01  WS-CN-CONTROL-PRIMARY.
   371     12  WS-CN-COMPANY-CD        PIC  X(01).
   372     12  WS-CN-CARRIER           PIC  X(01).
   373     12  WS-CN-GROUPING          PIC  X(06).
   374     12  WS-CN-STATE             PIC  X(02).
   375     12  WS-CN-ACCOUNT           PIC  X(10).
   376     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   377     12  WS-CN-CERT-NO.
   378         16  WS-CN-CERT-PRIME    PIC  X(10).
   379         16  WS-CN-CERT-SFX      PIC  X.
   380
   381 01  WS-FO-CONTROL-PRIMARY.
   382     12  WS-FO-COMPANY-CD        PIC  X(01).
   383     12  WS-FO-STATE             PIC  X(02).
   384     12  WS-FO-FORM-ID           PIC  X(12).
   385     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page   9
* EL1278.cbl
   387*                            COPY ELCDATE.
   388******************************************************************
   389*                                                                *
   390*                                                                *
   391*                            ELCDATE.                            *
   392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   393*                            VMOD=2.003
   394*                                                                *
   395*                                                                *
   396*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   397*                 LENGTH = 200                                   *
   398******************************************************************
   399
   400 01  DATE-CONVERSION-DATA.
   401     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   402     12  DC-OPTION-CODE                PIC X.
   403         88  BIN-TO-GREG                VALUE ' '.
   404         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   405         88  EDIT-GREG-TO-BIN           VALUE '2'.
   406         88  YMD-GREG-TO-BIN            VALUE '3'.
   407         88  MDY-GREG-TO-BIN            VALUE '4'.
   408         88  JULIAN-TO-BIN              VALUE '5'.
   409         88  BIN-PLUS-ELAPSED           VALUE '6'.
   410         88  FIND-CENTURY               VALUE '7'.
   411         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   412         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   413         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   414         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   415         88  JULIAN-TO-BIN-3            VALUE 'C'.
   416         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   417         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   418         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   419         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   420         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   421         88  CHECK-LEAP-YEAR            VALUE 'H'.
   422         88  BIN-3-TO-GREG              VALUE 'I'.
   423         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   424         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   425         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   426         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   427         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   428         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   429         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   430         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   431         88  THREE-CHARACTER-BIN
   432                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   433         88  GREGORIAN-TO-BIN
   434                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   435         88  BIN-TO-GREGORIAN
   436                  VALUES ' ' '1' 'I' '8' 'G'.
   437         88  JULIAN-TO-BINARY
   438                  VALUES '5' 'C' 'E' 'F'.
   439     12  DC-ERROR-CODE                 PIC X.
   440         88  NO-CONVERSION-ERROR        VALUE ' '.
   441         88  DATE-CONVERSION-ERROR
   442                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   443         88  DATE-IS-ZERO               VALUE '1'.
   444         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  10
* EL1278.cbl
   445         88  DATE-IS-INVALID            VALUE '3'.
   446         88  DATE1-GREATER-DATE2        VALUE '4'.
   447         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   448         88  DATE-INVALID-OPTION        VALUE '9'.
   449         88  INVALID-CENTURY            VALUE 'A'.
   450         88  ONLY-CENTURY               VALUE 'B'.
   451         88  ONLY-LEAP-YEAR             VALUE 'C'.
   452         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   453     12  DC-END-OF-MONTH               PIC X.
   454         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   455     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   456         88  USE-NORMAL-PROCESS         VALUE ' '.
   457         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   458         88  ADJUST-UP-100-YRS          VALUE '2'.
   459     12  FILLER                        PIC X.
   460     12  DC-CONVERSION-DATES.
   461         16  DC-BIN-DATE-1             PIC XX.
   462         16  DC-BIN-DATE-2             PIC XX.
   463         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   464         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   465                       DC-GREG-DATE-1-EDIT.
   466             20  DC-EDIT1-MONTH        PIC 99.
   467             20  SLASH1-1              PIC X.
   468             20  DC-EDIT1-DAY          PIC 99.
   469             20  SLASH1-2              PIC X.
   470             20  DC-EDIT1-YEAR         PIC 99.
   471         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   472         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   473                     DC-GREG-DATE-2-EDIT.
   474             20  DC-EDIT2-MONTH        PIC 99.
   475             20  SLASH2-1              PIC X.
   476             20  DC-EDIT2-DAY          PIC 99.
   477             20  SLASH2-2              PIC X.
   478             20  DC-EDIT2-YEAR         PIC 99.
   479         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   480         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   481                     DC-GREG-DATE-1-YMD.
   482             20  DC-YMD-YEAR           PIC 99.
   483             20  DC-YMD-MONTH          PIC 99.
   484             20  DC-YMD-DAY            PIC 99.
   485         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   486         16  DC-GREG-DATE-1-MDY-R REDEFINES
   487                      DC-GREG-DATE-1-MDY.
   488             20  DC-MDY-MONTH          PIC 99.
   489             20  DC-MDY-DAY            PIC 99.
   490             20  DC-MDY-YEAR           PIC 99.
   491         16  DC-GREG-DATE-1-ALPHA.
   492             20  DC-ALPHA-MONTH        PIC X(10).
   493             20  DC-ALPHA-DAY          PIC 99.
   494             20  FILLER                PIC XX.
   495             20  DC-ALPHA-CENTURY.
   496                 24 DC-ALPHA-CEN-N     PIC 99.
   497             20  DC-ALPHA-YEAR         PIC 99.
   498         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   499         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   500         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   501         16  DC-JULIAN-DATE            PIC 9(05).
   502         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  11
* EL1278.cbl
   503                                       PIC 9(05).
   504         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   505             20  DC-JULIAN-YEAR        PIC 99.
   506             20  DC-JULIAN-DAYS        PIC 999.
   507         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   508         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   509         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   510     12  DATE-CONVERSION-VARIBLES.
   511         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   512         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   513             20  FILLER                PIC 9(3).
   514             20  HOLD-CEN-1-CCYY.
   515                 24  HOLD-CEN-1-CC     PIC 99.
   516                 24  HOLD-CEN-1-YY     PIC 99.
   517             20  HOLD-CEN-1-MO         PIC 99.
   518             20  HOLD-CEN-1-DA         PIC 99.
   519         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   520             20  HOLD-CEN-1-R-MO       PIC 99.
   521             20  HOLD-CEN-1-R-DA       PIC 99.
   522             20  HOLD-CEN-1-R-CCYY.
   523                 24  HOLD-CEN-1-R-CC   PIC 99.
   524                 24  HOLD-CEN-1-R-YY   PIC 99.
   525             20  FILLER                PIC 9(3).
   526         16  HOLD-CENTURY-1-X.
   527             20  FILLER                PIC X(3)  VALUE SPACES.
   528             20  HOLD-CEN-1-X-CCYY.
   529                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   530                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   531             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   532             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   533         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   534             20  HOLD-CEN-1-R-X-MO     PIC XX.
   535             20  HOLD-CEN-1-R-X-DA     PIC XX.
   536             20  HOLD-CEN-1-R-X-CCYY.
   537                 24  HOLD-CEN-1-R-X-CC PIC XX.
   538                 24  HOLD-CEN-1-R-X-YY PIC XX.
   539             20  FILLER                PIC XXX.
   540         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   541         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   542         16  DC-JULIAN-DATE-1          PIC 9(07).
   543         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   544             20  DC-JULIAN-1-CCYY.
   545                 24  DC-JULIAN-1-CC    PIC 99.
   546                 24  DC-JULIAN-1-YR    PIC 99.
   547             20  DC-JULIAN-DA-1        PIC 999.
   548         16  DC-JULIAN-DATE-2          PIC 9(07).
   549         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   550             20  DC-JULIAN-2-CCYY.
   551                 24  DC-JULIAN-2-CC    PIC 99.
   552                 24  DC-JULIAN-2-YR    PIC 99.
   553             20  DC-JULIAN-DA-2        PIC 999.
   554         16  DC-GREG-DATE-A-EDIT.
   555             20  DC-EDITA-MONTH        PIC 99.
   556             20  SLASHA-1              PIC X VALUE '/'.
   557             20  DC-EDITA-DAY          PIC 99.
   558             20  SLASHA-2              PIC X VALUE '/'.
   559             20  DC-EDITA-CCYY.
   560                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  12
* EL1278.cbl
   561                 24  DC-EDITA-YEAR     PIC 99.
   562         16  DC-GREG-DATE-B-EDIT.
   563             20  DC-EDITB-MONTH        PIC 99.
   564             20  SLASHB-1              PIC X VALUE '/'.
   565             20  DC-EDITB-DAY          PIC 99.
   566             20  SLASHB-2              PIC X VALUE '/'.
   567             20  DC-EDITB-CCYY.
   568                 24  DC-EDITB-CENT     PIC 99.
   569                 24  DC-EDITB-YEAR     PIC 99.
   570         16  DC-GREG-DATE-CYMD         PIC 9(08).
   571         16  DC-GREG-DATE-CYMD-R REDEFINES
   572                              DC-GREG-DATE-CYMD.
   573             20  DC-CYMD-CEN           PIC 99.
   574             20  DC-CYMD-YEAR          PIC 99.
   575             20  DC-CYMD-MONTH         PIC 99.
   576             20  DC-CYMD-DAY           PIC 99.
   577         16  DC-GREG-DATE-MDCY         PIC 9(08).
   578         16  DC-GREG-DATE-MDCY-R REDEFINES
   579                              DC-GREG-DATE-MDCY.
   580             20  DC-MDCY-MONTH         PIC 99.
   581             20  DC-MDCY-DAY           PIC 99.
   582             20  DC-MDCY-CEN           PIC 99.
   583             20  DC-MDCY-YEAR          PIC 99.
   584    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   585        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   586    12  DC-EL310-DATE                  PIC X(21).
   587    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  13
* EL1278.cbl
   589*                            COPY ELCLOGOF.
   590******************************************************************
   591*                                                                *
   592*                                                                *
   593*                            ELCLOGOF.                           *
   594*                            VMOD=2.001                          *
   595*                                                                *
   596*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   597*                                                                *
   598******************************************************************
   599 01  CLASIC-LOGOFF.
   600     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   601     12  LOGOFF-TEXT.
   602         16  FILLER          PIC X(5)    VALUE SPACES.
   603         16  LOGOFF-MSG.
   604             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   605             20  FILLER      PIC X       VALUE SPACES.
   606             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   607         16  FILLER          PIC X(80)
   608           VALUE '* YOU ARE NOW LOGGED OFF'.
   609         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   610         16  FILLER          PIC X       VALUE QUOTE.
   611         16  LOGOFF-SYS-MSG  PIC X(17)
   612           VALUE 'S CLAS-IC SYSTEM '.
   613     12  TEXT-MESSAGES.
   614         16  UNACCESS-MSG    PIC X(29)
   615             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   616         16  PGMIDERR-MSG    PIC X(17)
   617             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  14
* EL1278.cbl
   619*                            COPY ELCATTR.
   620******************************************************************
   621*                                                                *
   622*                            ELCATTR.                            *
   623*                            VMOD=2.001                          *
   624*                                                                *
   625*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   626*                                                                *
   627*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   628*                                                                *
   629*                   POS 1   P=PROTECTED                          *
   630*                           U=UNPROTECTED                        *
   631*                           S=ASKIP                              *
   632*                   POS 2   A=ALPHA/NUMERIC                      *
   633*                           N=NUMERIC                            *
   634*                   POS 3   N=NORMAL                             *
   635*                           B=BRIGHT                             *
   636*                           D=DARK                               *
   637*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   638*                           OF=MODIFIED DATA TAG OFF             *
   639*                                                                *
   640*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   641******************************************************************
   642 01  ATTRIBUTE-LIST.
   643     12  AL-PABOF            PIC X       VALUE 'Y'.
   644     12  AL-PABON            PIC X       VALUE 'Z'.
   645     12  AL-PADOF            PIC X       VALUE '%'.
   646     12  AL-PADON            PIC X       VALUE '_'.
   647     12  AL-PANOF            PIC X       VALUE '-'.
   648     12  AL-PANON            PIC X       VALUE '/'.
   649     12  AL-SABOF            PIC X       VALUE '8'.
   650     12  AL-SABON            PIC X       VALUE '9'.
   651     12  AL-SADOF            PIC X       VALUE '@'.
   652     12  AL-SADON            PIC X       VALUE QUOTE.
   653     12  AL-SANOF            PIC X       VALUE '0'.
   654     12  AL-SANON            PIC X       VALUE '1'.
   655     12  AL-UABOF            PIC X       VALUE 'H'.
   656     12  AL-UABON            PIC X       VALUE 'I'.
   657     12  AL-UADOF            PIC X       VALUE '<'.
   658     12  AL-UADON            PIC X       VALUE '('.
   659     12  AL-UANOF            PIC X       VALUE ' '.
   660     12  AL-UANON            PIC X       VALUE 'A'.
   661     12  AL-UNBOF            PIC X       VALUE 'Q'.
   662     12  AL-UNBON            PIC X       VALUE 'R'.
   663     12  AL-UNDOF            PIC X       VALUE '*'.
   664     12  AL-UNDON            PIC X       VALUE ')'.
   665     12  AL-UNNOF            PIC X       VALUE '&'.
   666     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  15
* EL1278.cbl
   668*                            COPY ELCEMIB.
   669******************************************************************
   670*                                                                *
   671*                                                                *
   672*                            ELCEMIB.                            *
   673*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   674*                            VMOD=2.005                          *
   675*                                                                *
   676*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   677*                                                                *
   678******************************************************************
   679 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   680     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   681     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   682     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   683     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   684     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   685     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   686     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   687     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   688     12  EMI-SWITCH1             PIC X        VALUE '1'.
   689         88  EMI-NO-ERRORS                    VALUE '1'.
   690         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   691         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   692     12  EMI-SWITCH2             PIC X        VALUE '1'.
   693         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   694     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   695         88  EMI-AREA1-EMPTY                  VALUE '1'.
   696         88  EMI-AREA1-FULL                   VALUE '2'.
   697     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   698         88  EMI-AREA2-EMPTY                  VALUE '1'.
   699         88  EMI-AREA2-FULL                   VALUE '2'.
   700     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   701         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   702         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   703         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   704         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   705         88  EMI-BYPASS-FATALS                VALUE 'X'.
   706     12  EMI-ERROR-LINES.
   707         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   708         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   709         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   710         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   711             20  EMI-ERR-CODES OCCURS 10 TIMES.
   712                 24  EMI-ERR-NUM         PIC X(4).
   713                 24  EMI-FILLER          PIC X.
   714                 24  EMI-SEV             PIC X.
   715                 24  FILLER              PIC X.
   716             20  FILLER                  PIC X(02).
   717     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   718         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   719             20  EMI-ERROR-NUMBER    PIC X(4).
   720             20  EMI-FILL            PIC X.
   721             20  EMI-SEVERITY        PIC X.
   722             20  FILLER              PIC X.
   723             20  EMI-ERROR-TEXT.
   724                 24  EMI-TEXT-VARIABLE   PIC X(10).
   725                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  16
* EL1278.cbl
   726     12  EMI-SEVERITY-SAVE           PIC X.
   727         88  EMI-NOTE                    VALUE 'N'.
   728         88  EMI-WARNING                 VALUE 'W'.
   729         88  EMI-FORCABLE                VALUE 'F'.
   730         88  EMI-FATAL                   VALUE 'X'.
   731     12  EMI-MESSAGE-FLAG            PIC X.
   732         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   733         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   734     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   735     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   736         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   737         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   738         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   739     12  FILLER                      PIC X(137)  VALUE SPACES.
   740     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   741     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   742     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   743     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  17
* EL1278.cbl
   745*                            COPY ELCINTF.
   746******************************************************************
   747*                                                                *
   748*                                                                *
   749*                            ELCINTF.                            *
   750*                            VMOD=2.017                          *
   751*                                                                *
   752*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   753*                                                                *
   754*       LENGTH = 1024                                            *
   755*                                                                *
   756******************************************************************
   757 01  PROGRAM-INTERFACE-BLOCK.
   758     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   759     12  PI-CALLING-PROGRAM              PIC X(8).
   760     12  PI-SAVED-PROGRAM-1              PIC X(8).
   761     12  PI-SAVED-PROGRAM-2              PIC X(8).
   762     12  PI-SAVED-PROGRAM-3              PIC X(8).
   763     12  PI-SAVED-PROGRAM-4              PIC X(8).
   764     12  PI-SAVED-PROGRAM-5              PIC X(8).
   765     12  PI-SAVED-PROGRAM-6              PIC X(8).
   766     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   767     12  PI-COMPANY-ID                   PIC XXX.
   768     12  PI-COMPANY-CD                   PIC X.
   769
   770     12  PI-COMPANY-PASSWORD             PIC X(8).
   771
   772     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   773
   774     12  PI-CONTROL-IN-PROGRESS.
   775         16  PI-CARRIER                  PIC X.
   776         16  PI-GROUPING                 PIC X(6).
   777         16  PI-STATE                    PIC XX.
   778         16  PI-ACCOUNT                  PIC X(10).
   779         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   780                                         PIC X(10).
   781         16  PI-CLAIM-CERT-GRP.
   782             20  PI-CLAIM-NO             PIC X(7).
   783             20  PI-CERT-NO.
   784                 25  PI-CERT-PRIME       PIC X(10).
   785                 25  PI-CERT-SFX         PIC X.
   786             20  PI-CERT-EFF-DT          PIC XX.
   787         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   788             20  PI-PLAN-CODE            PIC X(2).
   789             20  PI-REVISION-NUMBER      PIC X(3).
   790             20  PI-PLAN-EFF-DT          PIC X(2).
   791             20  PI-PLAN-EXP-DT          PIC X(2).
   792             20  FILLER                  PIC X(11).
   793         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   794             20  PI-OE-REFERENCE-1.
   795                 25  PI-OE-REF-1-PRIME   PIC X(18).
   796                 25  PI-OE-REF-1-SUFF    PIC XX.
   797
   798     12  PI-SESSION-IN-PROGRESS          PIC X.
   799         88  CLAIM-SESSION                   VALUE '1'.
   800         88  CREDIT-SESSION                  VALUE '2'.
   801         88  WARRANTY-SESSION                VALUE '3'.
   802         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  18
* EL1278.cbl
   803         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   804
   805
   806*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   807
   808     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   809     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   810
   811     12  PI-CREDIT-USER                  PIC X.
   812         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   813         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   814
   815     12  PI-CLAIM-USER                   PIC X.
   816         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   817         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   818
   819     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   820         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   821         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   822         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   823         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   824         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   825
   826     12  PI-PROCESSOR-ID                 PIC X(4).
   827
   828     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   829
   830     12  PI-MEMBER-CAPTION               PIC X(10).
   831
   832     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   833         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   834
   835     12  PI-LIFE-OVERRIDE-L1             PIC X.
   836     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   837     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   838     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   839
   840     12  PI-AH-OVERRIDE-L1               PIC X.
   841     12  PI-AH-OVERRIDE-L2               PIC XX.
   842     12  PI-AH-OVERRIDE-L6               PIC X(6).
   843     12  PI-AH-OVERRIDE-L12              PIC X(12).
   844
   845     12  PI-NEW-SYSTEM                   PIC X(2).
   846
   847     12  PI-PRIMARY-CERT-NO              PIC X(11).
   848     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   849         88  PI-USES-PAID-TO                 VALUE '1'.
   850     12  PI-CRDTCRD-SYSTEM.
   851         16  PI-CRDTCRD-USER             PIC X.
   852             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   853             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   854         16  PI-CC-MONTH-END-DT          PIC XX.
   855     12  PI-PROCESSOR-PRINTER            PIC X(4).
   856
   857     12  PI-OE-REFERENCE-2.
   858         16  PI-OE-REF-2-PRIME           PIC X(10).
   859         16  PI-OE-REF-2-SUFF            PIC X.
   860
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  19
* EL1278.cbl
   861     12  PI-REM-TRM-CALC-OPTION          PIC X.
   862
   863     12  PI-LANGUAGE-TYPE                PIC X.
   864             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   865             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   866             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   867
   868     12  PI-POLICY-LINKAGE-IND           PIC X.
   869         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   870         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   871                                                   LOW-VALUES.
   872
   873     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   874     12  PI-CLAIM-PW-SESSION             PIC X(1).
   875         88  PI-CLAIM-CREDIT                 VALUE '1'.
   876         88  PI-CLAIM-CONVEN                 VALUE '2'.
   877     12  FILLER                          PIC X(4).
   878
   879     12  PI-SYSTEM-LEVEL                 PIC X(145).
   880
   881     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   882         PI-SYSTEM-LEVEL.
   883
   884         16  PI-ENTRY-CODES.
   885             20  PI-ENTRY-CD-1           PIC X.
   886             20  PI-ENTRY-CD-2           PIC X.
   887
   888         16  PI-RETURN-CODES.
   889             20  PI-RETURN-CD-1          PIC X.
   890             20  PI-RETURN-CD-2          PIC X.
   891
   892         16  PI-UPDATE-STATUS-SAVE.
   893             20  PI-UPDATE-BY            PIC X(4).
   894             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   895
   896         16  PI-LOWER-CASE-LETTERS       PIC X.
   897             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   898
   899*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   900*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   901*            88  CARRIER-CLM-CNTL            VALUE '2'.
   902
   903         16  PI-CERT-ACCESS-CONTROL      PIC X.
   904             88  ST-ACCNT-CNTL               VALUE ' '.
   905             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   906             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   907             88  ACCNT-CNTL                  VALUE '3'.
   908             88  CARR-ACCNT-CNTL             VALUE '4'.
   909
   910         16  PI-PROCESSOR-CAP-LIST.
   911             20  PI-SYSTEM-CONTROLS.
   912                24 PI-SYSTEM-DISPLAY     PIC X.
   913                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   914                24 PI-SYSTEM-MODIFY      PIC X.
   915                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   916             20  FILLER                  PIC XX.
   917             20  PI-DISPLAY-CAP          PIC X.
   918                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  20
* EL1278.cbl
   919             20  PI-MODIFY-CAP           PIC X.
   920                 88  MODIFY-CAP              VALUE 'Y'.
   921             20  PI-MSG-AT-LOGON-CAP     PIC X.
   922                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   923             20  PI-FORCE-CAP            PIC X.
   924                 88  FORCE-CAP               VALUE 'Y'.
   925
   926         16  PI-PROGRAM-CONTROLS.
   927             20  PI-PGM-PRINT-OPT        PIC X.
   928             20  PI-PGM-FORMAT-OPT       PIC X.
   929             20  PI-PGM-PROCESS-OPT      PIC X.
   930             20  PI-PGM-TOTALS-OPT       PIC X.
   931
   932         16  PI-HELP-INTERFACE.
   933             20  PI-LAST-ERROR-NO        PIC X(4).
   934             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   935
   936         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   937             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   938
   939         16  PI-CR-CONTROL-IN-PROGRESS.
   940             20  PI-CR-CARRIER           PIC X.
   941             20  PI-CR-GROUPING          PIC X(6).
   942             20  PI-CR-STATE             PIC XX.
   943             20  PI-CR-ACCOUNT           PIC X(10).
   944             20  PI-CR-FIN-RESP          PIC X(10).
   945             20  PI-CR-TYPE              PIC X.
   946
   947         16  PI-CR-BATCH-NUMBER          PIC X(6).
   948
   949         16  PI-CR-MONTH-END-DT          PIC XX.
   950
   951         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   952             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   953             88  PI-ZERO-CARRIER             VALUE '1'.
   954             88  PI-ZERO-GROUPING            VALUE '2'.
   955             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   956
   957         16  PI-CARRIER-SECURITY         PIC X.
   958             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   959
   960         16  PI-ACCOUNT-SECURITY         PIC X(10).
   961             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   962             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   963
   964         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   965             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   966                                         INDEXED BY PI-ACCESS-NDX
   967                                         PIC X.
   968
   969         16  PI-GA-BILLING-CONTROL       PIC X.
   970             88  PI-GA-BILLING               VALUE '1'.
   971
   972         16  PI-MAIL-PROCESSING          PIC X.
   973             88  PI-MAIL-YES                 VALUE 'Y'.
   974
   975         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   976
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  21
* EL1278.cbl
   977         16  PI-AR-SYSTEM.
   978             20  PI-AR-PROCESSING-CNTL   PIC X.
   979                 88  PI-AR-PROCESSING        VALUE 'Y'.
   980             20  PI-AR-SUMMARY-CODE      PIC X(6).
   981             20  PI-AR-MONTH-END-DT      PIC XX.
   982
   983         16  PI-MP-SYSTEM.
   984             20  PI-MORTGAGE-USER            PIC X.
   985                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   986                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   987             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   988                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   989                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   990                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   991                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   992                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   993             20  PI-MP-MONTH-END-DT          PIC XX.
   994             20  PI-MP-REFERENCE-NO.
   995                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   996                 24  PI-MP-REFERENCE-SFX     PIC XX.
   997
   998         16  PI-LABEL-CONTROL            PIC X(01).
   999             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1000             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1001
  1002         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1003             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1004
  1005         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1006             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1007             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1008
  1009         16  FILLER                      PIC X(14).
  1010
  1011     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1012******************************************************************
  1013     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1014         16  FILLER                PIC  X(500).
  1015         16  PI-PEND-SW            PIC  X(01).
  1016         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1017         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1018         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1019         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1020         16  PI-EARNING-METHOD-LF  PIC  X.
  1021         16  PI-EARNING-METHOD-AH  PIC  X.
  1022         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1023         16  PI-LF-REFUND-METH     PIC  X.
  1024         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1025         16  PI-AH-REFUND-METH     PIC  X.
  1026         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1027         16  PI-MODIFY-CERT-CAP    PIC  X.
  1028             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1029         16  FILLER                PIC  X(99).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  22
* EL1278.cbl
  1031*                            COPY ELCAID.
  1032******************************************************************
  1033*                                                                *
  1034*                            ELCAID.                             *
  1035*                            VMOD=2.001                          *
  1036*                                                                *
  1037*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1038*                                                                *
  1039*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1040*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1041******************************************************************
  1042
  1043 01  DFHAID.
  1044   02  DFHNULL   PIC  X  VALUE  ' '.
  1045   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1046   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1047   02  DFHPEN    PIC  X  VALUE  '='.
  1048   02  DFHOPID   PIC  X  VALUE  'W'.
  1049   02  DFHPA1    PIC  X  VALUE  '%'.
  1050   02  DFHPA2    PIC  X  VALUE  '>'.
  1051   02  DFHPA3    PIC  X  VALUE  ','.
  1052   02  DFHPF1    PIC  X  VALUE  '1'.
  1053   02  DFHPF2    PIC  X  VALUE  '2'.
  1054   02  DFHPF3    PIC  X  VALUE  '3'.
  1055   02  DFHPF4    PIC  X  VALUE  '4'.
  1056   02  DFHPF5    PIC  X  VALUE  '5'.
  1057   02  DFHPF6    PIC  X  VALUE  '6'.
  1058   02  DFHPF7    PIC  X  VALUE  '7'.
  1059   02  DFHPF8    PIC  X  VALUE  '8'.
  1060   02  DFHPF9    PIC  X  VALUE  '9'.
  1061   02  DFHPF10   PIC  X  VALUE  ':'.
  1062   02  DFHPF11   PIC  X  VALUE  '#'.
  1063   02  DFHPF12   PIC  X  VALUE  '@'.
  1064   02  DFHPF13   PIC  X  VALUE  'A'.
  1065   02  DFHPF14   PIC  X  VALUE  'B'.
  1066   02  DFHPF15   PIC  X  VALUE  'C'.
  1067   02  DFHPF16   PIC  X  VALUE  'D'.
  1068   02  DFHPF17   PIC  X  VALUE  'E'.
  1069   02  DFHPF18   PIC  X  VALUE  'F'.
  1070   02  DFHPF19   PIC  X  VALUE  'G'.
  1071   02  DFHPF20   PIC  X  VALUE  'H'.
  1072   02  DFHPF21   PIC  X  VALUE  'I'.
  1073*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1074   02  DFHPF22   PIC  X  VALUE  '['.
  1075   02  DFHPF23   PIC  X  VALUE  '.'.
  1076   02  DFHPF24   PIC  X  VALUE  '<'.
  1077   02  DFHMSRE   PIC  X  VALUE  'X'.
  1078   02  DFHSTRF   PIC  X  VALUE  'h'.
  1079   02  DFHTRIG   PIC  X  VALUE  '"'.
  1080
  1081 01  FILLER  REDEFINES  DFHAID.
  1082     12  FILLER                  PIC  X(08).
  1083     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  23
* EL1278.cbl
  1085*                            COPY EL1278S.
  1086 01  EL127HI.
  1087     05  FILLER            PIC  X(0012).
  1088*    -------------------------------
  1089     05  HDATEL PIC S9(0004) COMP.
  1090     05  HDATEF PIC  X(0001).
  1091     05  FILLER REDEFINES HDATEF.
  1092         10  HDATEA PIC  X(0001).
  1093     05  HDATEI PIC  X(0008).
  1094*    -------------------------------
  1095     05  HTIMEL PIC S9(0004) COMP.
  1096     05  HTIMEF PIC  X(0001).
  1097     05  FILLER REDEFINES HTIMEF.
  1098         10  HTIMEA PIC  X(0001).
  1099     05  HTIMEI PIC  999V99.
  1100*    -------------------------------
  1101     05  CMPNYIDL PIC S9(0004) COMP.
  1102     05  CMPNYIDF PIC  X(0001).
  1103     05  FILLER REDEFINES CMPNYIDF.
  1104         10  CMPNYIDA PIC  X(0001).
  1105     05  CMPNYIDI PIC  X(0003).
  1106*    -------------------------------
  1107     05  USERIDL PIC S9(0004) COMP.
  1108     05  USERIDF PIC  X(0001).
  1109     05  FILLER REDEFINES USERIDF.
  1110         10  USERIDA PIC  X(0001).
  1111     05  USERIDI PIC  X(0004).
  1112*    -------------------------------
  1113     05  HCARIERL PIC S9(0004) COMP.
  1114     05  HCARIERF PIC  X(0001).
  1115     05  FILLER REDEFINES HCARIERF.
  1116         10  HCARIERA PIC  X(0001).
  1117     05  HCARIERI PIC  X(0001).
  1118*    -------------------------------
  1119     05  HGROUPL PIC S9(0004) COMP.
  1120     05  HGROUPF PIC  X(0001).
  1121     05  FILLER REDEFINES HGROUPF.
  1122         10  HGROUPA PIC  X(0001).
  1123     05  HGROUPI PIC  X(0006).
  1124*    -------------------------------
  1125     05  HSTATEL PIC S9(0004) COMP.
  1126     05  HSTATEF PIC  X(0001).
  1127     05  FILLER REDEFINES HSTATEF.
  1128         10  HSTATEA PIC  X(0001).
  1129     05  HSTATEI PIC  X(0002).
  1130*    -------------------------------
  1131     05  HACCTNOL PIC S9(0004) COMP.
  1132     05  HACCTNOF PIC  X(0001).
  1133     05  FILLER REDEFINES HACCTNOF.
  1134         10  HACCTNOA PIC  X(0001).
  1135     05  HACCTNOI PIC  X(0010).
  1136*    -------------------------------
  1137     05  HEFFDTL PIC S9(0004) COMP.
  1138     05  HEFFDTF PIC  X(0001).
  1139     05  FILLER REDEFINES HEFFDTF.
  1140         10  HEFFDTA PIC  X(0001).
  1141     05  HEFFDTI PIC  X(0008).
  1142*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  24
* EL1278.cbl
  1143     05  HCERTNOL PIC S9(0004) COMP.
  1144     05  HCERTNOF PIC  X(0001).
  1145     05  FILLER REDEFINES HCERTNOF.
  1146         10  HCERTNOA PIC  X(0001).
  1147     05  HCERTNOI PIC  X(0010).
  1148*    -------------------------------
  1149     05  HCRTSFXL PIC S9(0004) COMP.
  1150     05  HCRTSFXF PIC  X(0001).
  1151     05  FILLER REDEFINES HCRTSFXF.
  1152         10  HCRTSFXA PIC  X(0001).
  1153     05  HCRTSFXI PIC  X(0001).
  1154*    -------------------------------
  1155     05  HLNAMEL PIC S9(0004) COMP.
  1156     05  HLNAMEF PIC  X(0001).
  1157     05  FILLER REDEFINES HLNAMEF.
  1158         10  HLNAMEA PIC  X(0001).
  1159     05  HLNAMEI PIC  X(0015).
  1160*    -------------------------------
  1161     05  HFNAMEL PIC S9(0004) COMP.
  1162     05  HFNAMEF PIC  X(0001).
  1163     05  FILLER REDEFINES HFNAMEF.
  1164         10  HFNAMEA PIC  X(0001).
  1165     05  HFNAMEI PIC  X(0010).
  1166*    -------------------------------
  1167     05  HINITL PIC S9(0004) COMP.
  1168     05  HINITF PIC  X(0001).
  1169     05  FILLER REDEFINES HINITF.
  1170         10  HINITA PIC  X(0001).
  1171     05  HINITI PIC  X(0001).
  1172*    -------------------------------
  1173     05  HPCYNL PIC S9(0004) COMP.
  1174     05  HPCYNF PIC  X(0001).
  1175     05  FILLER REDEFINES HPCYNF.
  1176         10  HPCYNA PIC  X(0001).
  1177     05  HPCYNI PIC  X(0001).
  1178*    -------------------------------
  1179     05  PMTHDL PIC S9(0004) COMP.
  1180     05  PMTHDF PIC  X(0001).
  1181     05  FILLER REDEFINES PMTHDF.
  1182         10  PMTHDA PIC  X(0001).
  1183     05  PMTHDI PIC  X(0010).
  1184*    -------------------------------
  1185     05  CNCDTHDL PIC S9(0004) COMP.
  1186     05  CNCDTHDF PIC  X(0001).
  1187     05  FILLER REDEFINES CNCDTHDF.
  1188         10  CNCDTHDA PIC  X(0001).
  1189     05  CNCDTHDI PIC  X(0007).
  1190*    -------------------------------
  1191     05  HLKINDL PIC S9(0004) COMP.
  1192     05  HLKINDF PIC  X(0001).
  1193     05  FILLER REDEFINES HLKINDF.
  1194         10  HLKINDA PIC  X(0001).
  1195     05  HLKINDI PIC  X(0002).
  1196*    -------------------------------
  1197     05  HLCDL PIC S9(0004) COMP.
  1198     05  HLCDF PIC  X(0001).
  1199     05  FILLER REDEFINES HLCDF.
  1200         10  HLCDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  25
* EL1278.cbl
  1201     05  HLCDI PIC  X(0002).
  1202*    -------------------------------
  1203     05  HLEDESCL PIC S9(0004) COMP.
  1204     05  HLEDESCF PIC  X(0001).
  1205     05  FILLER REDEFINES HLEDESCF.
  1206         10  HLEDESCA PIC  X(0001).
  1207     05  HLEDESCI PIC  X(0003).
  1208*    -------------------------------
  1209     05  HLTERML PIC S9(0004) COMP.
  1210     05  HLTERMF PIC  X(0001).
  1211     05  FILLER REDEFINES HLTERMF.
  1212         10  HLTERMA PIC  X(0001).
  1213     05  HLTERMI PIC  9(3).
  1214*    -------------------------------
  1215     05  HLREML PIC S9(0004) COMP.
  1216     05  HLREMF PIC  X(0001).
  1217     05  FILLER REDEFINES HLREMF.
  1218         10  HLREMA PIC  X(0001).
  1219     05  HLREMI PIC  X(0003).
  1220*    -------------------------------
  1221     05  HLPREML PIC S9(0004) COMP.
  1222     05  HLPREMF PIC  X(0001).
  1223     05  FILLER REDEFINES HLPREMF.
  1224         10  HLPREMA PIC  X(0001).
  1225     05  HLPREMI PIC  X(0011).
  1226*    -------------------------------
  1227     05  HLITDRL PIC S9(0004) COMP.
  1228     05  HLITDRF PIC  X(0001).
  1229     05  FILLER REDEFINES HLITDRF.
  1230         10  HLITDRA PIC  X(0001).
  1231     05  HLITDRI PIC  X(0011).
  1232*    -------------------------------
  1233     05  HLREFNDL PIC S9(0004) COMP.
  1234     05  HLREFNDF PIC  X(0001).
  1235     05  FILLER REDEFINES HLREFNDF.
  1236         10  HLREFNDA PIC  X(0001).
  1237     05  HLREFNDI PIC  X(0011).
  1238*    -------------------------------
  1239     05  HLCANCL PIC S9(0004) COMP.
  1240     05  HLCANCF PIC  X(0001).
  1241     05  FILLER REDEFINES HLCANCF.
  1242         10  HLCANCA PIC  X(0001).
  1243     05  HLCANCI PIC  X(0008).
  1244*    -------------------------------
  1245     05  HLCAL1L PIC S9(0004) COMP.
  1246     05  HLCAL1F PIC  X(0001).
  1247     05  FILLER REDEFINES HLCAL1F.
  1248         10  HLCAL1A PIC  X(0001).
  1249     05  HLCAL1I PIC  X(0001).
  1250*    -------------------------------
  1251     05  HLCALCL PIC S9(0004) COMP.
  1252     05  HLCALCF PIC  X(0001).
  1253     05  FILLER REDEFINES HLCALCF.
  1254         10  HLCALCA PIC  X(0001).
  1255     05  HLCALCI PIC  X(0012).
  1256*    -------------------------------
  1257     05  HAKINDL PIC S9(0004) COMP.
  1258     05  HAKINDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  26
* EL1278.cbl
  1259     05  FILLER REDEFINES HAKINDF.
  1260         10  HAKINDA PIC  X(0001).
  1261     05  HAKINDI PIC  X(0002).
  1262*    -------------------------------
  1263     05  HACDL PIC S9(0004) COMP.
  1264     05  HACDF PIC  X(0001).
  1265     05  FILLER REDEFINES HACDF.
  1266         10  HACDA PIC  X(0001).
  1267     05  HACDI PIC  X(0002).
  1268*    -------------------------------
  1269     05  HAEDESCL PIC S9(0004) COMP.
  1270     05  HAEDESCF PIC  X(0001).
  1271     05  FILLER REDEFINES HAEDESCF.
  1272         10  HAEDESCA PIC  X(0001).
  1273     05  HAEDESCI PIC  X(0003).
  1274*    -------------------------------
  1275     05  HATERML PIC S9(0004) COMP.
  1276     05  HATERMF PIC  X(0001).
  1277     05  FILLER REDEFINES HATERMF.
  1278         10  HATERMA PIC  X(0001).
  1279     05  HATERMI PIC  9(3).
  1280*    -------------------------------
  1281     05  HAREML PIC S9(0004) COMP.
  1282     05  HAREMF PIC  X(0001).
  1283     05  FILLER REDEFINES HAREMF.
  1284         10  HAREMA PIC  X(0001).
  1285     05  HAREMI PIC  X(0003).
  1286*    -------------------------------
  1287     05  HAPREML PIC S9(0004) COMP.
  1288     05  HAPREMF PIC  X(0001).
  1289     05  FILLER REDEFINES HAPREMF.
  1290         10  HAPREMA PIC  X(0001).
  1291     05  HAPREMI PIC  X(0011).
  1292*    -------------------------------
  1293     05  HAITDRL PIC S9(0004) COMP.
  1294     05  HAITDRF PIC  X(0001).
  1295     05  FILLER REDEFINES HAITDRF.
  1296         10  HAITDRA PIC  X(0001).
  1297     05  HAITDRI PIC  X(0011).
  1298*    -------------------------------
  1299     05  HAREFNDL PIC S9(0004) COMP.
  1300     05  HAREFNDF PIC  X(0001).
  1301     05  FILLER REDEFINES HAREFNDF.
  1302         10  HAREFNDA PIC  X(0001).
  1303     05  HAREFNDI PIC  X(0011).
  1304*    -------------------------------
  1305     05  HACANCL PIC S9(0004) COMP.
  1306     05  HACANCF PIC  X(0001).
  1307     05  FILLER REDEFINES HACANCF.
  1308         10  HACANCA PIC  X(0001).
  1309     05  HACANCI PIC  X(0008).
  1310*    -------------------------------
  1311     05  HACAL1L PIC S9(0004) COMP.
  1312     05  HACAL1F PIC  X(0001).
  1313     05  FILLER REDEFINES HACAL1F.
  1314         10  HACAL1A PIC  X(0001).
  1315     05  HACAL1I PIC  X(0001).
  1316*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  27
* EL1278.cbl
  1317     05  HACALCL PIC S9(0004) COMP.
  1318     05  HACALCF PIC  X(0001).
  1319     05  FILLER REDEFINES HACALCF.
  1320         10  HACALCA PIC  X(0001).
  1321     05  HACALCI PIC  X(0012).
  1322*    -------------------------------
  1323     05  TOPREML PIC S9(0004) COMP.
  1324     05  TOPREMF PIC  X(0001).
  1325     05  FILLER REDEFINES TOPREMF.
  1326         10  TOPREMA PIC  X(0001).
  1327     05  TOPREMI PIC  X(0011).
  1328*    -------------------------------
  1329     05  TOITDRL PIC S9(0004) COMP.
  1330     05  TOITDRF PIC  X(0001).
  1331     05  FILLER REDEFINES TOITDRF.
  1332         10  TOITDRA PIC  X(0001).
  1333     05  TOITDRI PIC  X(0011).
  1334*    -------------------------------
  1335     05  TORFNDL PIC S9(0004) COMP.
  1336     05  TORFNDF PIC  X(0001).
  1337     05  FILLER REDEFINES TORFNDF.
  1338         10  TORFNDA PIC  X(0001).
  1339     05  TORFNDI PIC  X(0011).
  1340*    -------------------------------
  1341     05  HLREDL PIC S9(0004) COMP.
  1342     05  HLREDF PIC  X(0001).
  1343     05  FILLER REDEFINES HLREDF.
  1344         10  HLREDA PIC  X(0001).
  1345     05  HLREDI PIC  X(0014).
  1346*    -------------------------------
  1347     05  HERMSG1L PIC S9(0004) COMP.
  1348     05  HERMSG1F PIC  X(0001).
  1349     05  FILLER REDEFINES HERMSG1F.
  1350         10  HERMSG1A PIC  X(0001).
  1351     05  HERMSG1I PIC  X(0079).
  1352*    -------------------------------
  1353     05  HERMSG2L PIC S9(0004) COMP.
  1354     05  HERMSG2F PIC  X(0001).
  1355     05  FILLER REDEFINES HERMSG2F.
  1356         10  HERMSG2A PIC  X(0001).
  1357     05  HERMSG2I PIC  X(0079).
  1358*    -------------------------------
  1359     05  HPFKEYL PIC S9(0004) COMP.
  1360     05  HPFKEYF PIC  X(0001).
  1361     05  FILLER REDEFINES HPFKEYF.
  1362         10  HPFKEYA PIC  X(0001).
  1363     05  HPFKEYI PIC  99.
  1364*    -------------------------------
  1365     05  PFKEY11L PIC S9(0004) COMP.
  1366     05  PFKEY11F PIC  X(0001).
  1367     05  FILLER REDEFINES PFKEY11F.
  1368         10  PFKEY11A PIC  X(0001).
  1369     05  PFKEY11I PIC  X(0021).
  1370 01  EL127HO REDEFINES EL127HI.
  1371     05  FILLER            PIC  X(0012).
  1372*    -------------------------------
  1373     05  FILLER            PIC  X(0003).
  1374     05  HDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  28
* EL1278.cbl
  1375*    -------------------------------
  1376     05  FILLER            PIC  X(0003).
  1377     05  HTIMEO PIC  99.99.
  1378*    -------------------------------
  1379     05  FILLER            PIC  X(0003).
  1380     05  CMPNYIDO PIC  X(0003).
  1381*    -------------------------------
  1382     05  FILLER            PIC  X(0003).
  1383     05  USERIDO PIC  X(0004).
  1384*    -------------------------------
  1385     05  FILLER            PIC  X(0003).
  1386     05  HCARIERO PIC  X(0001).
  1387*    -------------------------------
  1388     05  FILLER            PIC  X(0003).
  1389     05  HGROUPO PIC  X(0006).
  1390*    -------------------------------
  1391     05  FILLER            PIC  X(0003).
  1392     05  HSTATEO PIC  X(0002).
  1393*    -------------------------------
  1394     05  FILLER            PIC  X(0003).
  1395     05  HACCTNOO PIC  X(0010).
  1396*    -------------------------------
  1397     05  FILLER            PIC  X(0003).
  1398     05  HEFFDTO PIC  X(0008).
  1399*    -------------------------------
  1400     05  FILLER            PIC  X(0003).
  1401     05  HCERTNOO PIC  X(0010).
  1402*    -------------------------------
  1403     05  FILLER            PIC  X(0003).
  1404     05  HCRTSFXO PIC  X(0001).
  1405*    -------------------------------
  1406     05  FILLER            PIC  X(0003).
  1407     05  HLNAMEO PIC  X(0015).
  1408*    -------------------------------
  1409     05  FILLER            PIC  X(0003).
  1410     05  HFNAMEO PIC  X(0010).
  1411*    -------------------------------
  1412     05  FILLER            PIC  X(0003).
  1413     05  HINITO PIC  X(0001).
  1414*    -------------------------------
  1415     05  FILLER            PIC  X(0003).
  1416     05  HPCYNO PIC  X(0001).
  1417*    -------------------------------
  1418     05  FILLER            PIC  X(0003).
  1419     05  PMTHDO PIC  X(0010).
  1420*    -------------------------------
  1421     05  FILLER            PIC  X(0003).
  1422     05  CNCDTHDO PIC  X(0007).
  1423*    -------------------------------
  1424     05  FILLER            PIC  X(0003).
  1425     05  HLKINDO PIC  X(0002).
  1426*    -------------------------------
  1427     05  FILLER            PIC  X(0003).
  1428     05  HLCDO PIC  X(0002).
  1429*    -------------------------------
  1430     05  FILLER            PIC  X(0003).
  1431     05  HLEDESCO PIC  X(0003).
  1432*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  29
* EL1278.cbl
  1433     05  FILLER            PIC  X(0003).
  1434     05  HLTERMO PIC  ZZ9.
  1435*    -------------------------------
  1436     05  FILLER            PIC  X(0003).
  1437     05  HLREMO PIC  ZZ9.
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(0003).
  1440     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1441*    -------------------------------
  1442     05  FILLER            PIC  X(0003).
  1443     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(0003).
  1446     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1447*    -------------------------------
  1448     05  FILLER            PIC  X(0003).
  1449     05  HLCANCO PIC  X(0008).
  1450*    -------------------------------
  1451     05  FILLER            PIC  X(0003).
  1452     05  HLCAL1O PIC  X(0001).
  1453*    -------------------------------
  1454     05  FILLER            PIC  X(0003).
  1455     05  HLCALCO PIC  X(0012).
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(0003).
  1458     05  HAKINDO PIC  X(0002).
  1459*    -------------------------------
  1460     05  FILLER            PIC  X(0003).
  1461     05  HACDO PIC  X(0002).
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  HAEDESCO PIC  X(0003).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  HATERMO PIC  ZZ9.
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  HAREMO PIC  ZZ9.
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  HACANCO PIC  X(0008).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  HACAL1O PIC  X(0001).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
  1488     05  HACALCO PIC  X(0012).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  30
* EL1278.cbl
  1491     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  HERMSG1O PIC  X(0079).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  HERMSG2O PIC  X(0079).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  HPFKEYO PIC  99.
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  PFKEY11O PIC  X(0021).
  1513*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  31
* EL1278.cbl
  1515*                            COPY ELCCALC.
  1516******************************************************************
  1517*                                                                *
  1518*                           ELCCALC.                            *
  1519*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1520*                            VMOD=2.025                          *
  1521*                                                                *
  1522*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1523*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1524*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1525*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1526*                                                                *
  1527*  PASSED TO ELRTRM                                              *
  1528*  -----------------                                             *
  1529*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1530*  ORIGINAL TERM                                                 *
  1531*  BEGINNING DATE                                                *
  1532*  ENDING DATE                                                   *
  1533*  COMPANY I.D.                                                  *
  1534*  ACCOUNT MASTER USER FIELD                                     *
  1535*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1536*  FREE LOOK DAYS                                                *
  1537*                                                                *
  1538*  RETURNED FROM ELRTRM                                          *
  1539*  ---------------------                                         *
  1540*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1541*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1542*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1543*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1544*----------------------------------------------------------------*
  1545*  PASSED TO ELRAMT                                              *
  1546*  ----------------                                              *
  1547*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1548*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1549*  ORIGINAL AMOUNT                                               *
  1550*  ALTERNATE BENEFIT (BALLON)                                    *
  1551*  A.P.R. - NET PAY ONLY                                         *
  1552*  METHOD
  1553*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1554*  COMPANY I.D.                                                  *
  1555*  BENEFIT TYPE                                                  *
  1556*                                                                *
  1557*  RETURNED FROM ELRAMT                                          *
  1558*  --------------------                                          *
  1559*  REMAINING AMOUNT 1 - CURRENT                                  *
  1560*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1561*  REMAINING AMOUNT FACTOR
  1562*----------------------------------------------------------------*
  1563*  PASSED TO ELRESV                                              *
  1564*  -----------------                                             *
  1565*  CERTIFICATE EFFECTIVE DATE                                    *
  1566*  VALUATION DATE                                                *
  1567*  PAID THRU DATE                                                *
  1568*  BENEFIT                                                       *
  1569*  INCURRED DATE                                                 *
  1570*  REPORTED DATE                                                 *
  1571*  ISSUE AGE                                                     *
  1572*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  32
* EL1278.cbl
  1573*  CDT PERCENT                                                   *
  1574*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1575* *CLAIM TYPE (LIFE, A/H)                                        *
  1576* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1577* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1578*                                                                *
  1579*  RETURNED FROM ELRESV                                          *
  1580*  --------------------                                          *
  1581*  CDT TABLE USED                                                *
  1582*  CDT FACTOR USED                                               *
  1583*  PAY TO CURRENT RESERVE                                        *
  1584*  I.B.N.R. - A/H ONLY                                           *
  1585*  FUTURE (ACCRUED) AH ONLY                                      *
  1586*----------------------------------------------------------------*
  1587*  PASSED TO ELRATE                                              *
  1588*  ----------------                                              *
  1589*  CERT ISSUE DATE                                               *
  1590*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1591*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1592*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1593*  STATE CODE (CLIENT DEFINED)                                   *
  1594*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1595*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1596*  DEVIATION CODE                                                *
  1597*  ISSUE AGE                                                     *
  1598*  ORIGINAL BENEFIT AMOUNT                                       *
  1599*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1600*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1601*  BENEFIT KIND (LIFE OR A/H)                                    *
  1602*  A.P.R.                                                        *
  1603*  METHOD
  1604*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1605*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1606*  COMPANY I.D. (3 CHARACTER)                                    *
  1607*  BENEFIT CODE                                                  *
  1608*  BENEFIT OVERRIDE CODE                                         *
  1609*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1610*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1611*  JOINT INDICATOR (CSL ONLY)                                    *
  1612*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1613*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1614*                                                                *
  1615*  RETURNED FROM ELRATE                                          *
  1616*  --------------------                                          *
  1617*  CALCULATED PREMIUM                                            *
  1618*  PREMIUM RATE                                                  *
  1619*  MORTALITY CODE                                                *
  1620*  MAX ATTAINED AGE                                              *
  1621*  MAX AGE                                                       *
  1622*  MAX TERM                                                      *
  1623*  MAX MONTHLY BENEFIT                                           *
  1624*  MAX TOTAL BENIFIT                                             *
  1625*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1626*----------------------------------------------------------------*
  1627*  PASSED TO ELRFND                                              *
  1628*  ----------------                                              *
  1629*  CERT ISSUE DATE                                               *
  1630*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  33
* EL1278.cbl
  1631*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1632*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1633*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1634*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1635*  STATE CODE (CLIENT DEFINED)                                   *
  1636*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1637*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1638*  DEVIATION CODE                                                *
  1639*  ISSUE AGE                                                     *
  1640*  ORIGINAL BENEFIT AMOUNT                                       *
  1641*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1642*  PROCESS TYPE (CANCEL)                                         *
  1643*  BENEFIT KIND (LIFE OR A/H)                                    *
  1644*  A.P.R.                                                        *
  1645*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1646*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1647*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1648*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1649*  COMPANY I.D. (3 CHARACTER)                                    *
  1650*  BENEFIT CODE                                                  *
  1651*  BENEFIT OVERRIDE CODE                                         *
  1652*                                                                *
  1653*  RETURNED FROM ELRFND                                          *
  1654*  --------------------                                          *
  1655*  CALCULATED REFUND                                             *
  1656*----------------------------------------------------------------*
  1657*  PASSED TO ELEARN                                              *
  1658*  ----------------                                              *
  1659*  CERT ISSUE DATE                                               *
  1660*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1661*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1662*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1663*  STATE CODE (CLIENT DEFINED)                                   *
  1664*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1665*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1666*  DEVIATION CODE                                                *
  1667*  ISSUE AGE                                                     *
  1668*  ORIGINAL BENEFIT AMOUNT                                       *
  1669*  BENEFIT KIND (LIFE OR A/H)                                    *
  1670*  A.P.R.                                                        *
  1671*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1672*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1673*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1674*  COMPANY I.D. (3 CHARACTER)                                    *
  1675*  BENEFIT CODE                                                  *
  1676*  BENEFIT OVERRIDE CODE                                         *
  1677*                                                                *
  1678*  RETURNED FROM ELEARN                                          *
  1679*  --------------------                                          *
  1680*  INDICATED  EARNINGS                                           *
  1681*----------------------------------------------------------------*
  1682*                 LENGTH = 450                                   *
  1683*                                                                *
  1684******************************************************************
  1685******************************************************************
  1686*                   C H A N G E   L O G
  1687*
  1688* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  34
* EL1278.cbl
  1689*-----------------------------------------------------------------
  1690*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1691* EFFECTIVE    NUMBER
  1692*-----------------------------------------------------------------
  1693* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1694* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1695* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1696* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1697* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1698* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1699* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1700******************************************************************
  1701
  1702 01  CALCULATION-PASS-AREA.
  1703     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1704                                     COMP.
  1705
  1706     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1707       88  NO-CP-ERROR                             VALUE ZERO.
  1708       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1709                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1710       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1711       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1712       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1713       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1714       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1715       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1716       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1717       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1718       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1719       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1720       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1721       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1722       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1723       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1724       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1725       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1726       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1727
  1728     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1729       88  NO-CP-ERROR-2                           VALUE ZERO.
  1730***********************  INPUT AREAS ****************************
  1731
  1732     12  CP-CALCULATION-AREA.
  1733         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1734         16  CP-CERT-EFF-DT        PIC XX.
  1735         16  CP-VALUATION-DT       PIC XX.
  1736         16  CP-PAID-THRU-DT       PIC XX.
  1737         16  CP-BENEFIT-TYPE       PIC X.
  1738           88  CP-AH                               VALUE 'A' 'D'
  1739                                                   'I' 'U'.
  1740           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1741           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1742         16  CP-INCURRED-DT        PIC XX.
  1743         16  CP-REPORTED-DT        PIC XX.
  1744         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1745         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1746         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  35
* EL1278.cbl
  1747                                     COMP-3.
  1748         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1749                                     COMP-3.
  1750         16  CP-CDT-METHOD         PIC X.
  1751           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1752           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1753           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1754         16  CP-CLAIM-TYPE         PIC X.
  1755           88  CP-AH-CLAIM                         VALUE 'A'.
  1756           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1757         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1758                                     COMP-3.
  1759         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1760                                     COMP-3.
  1761         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1762                                     COMP-3.
  1763         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1764                                     COMP-3.
  1765         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1766                                     COMP-3.
  1767         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1768                                     COMP-3.
  1769         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1770                                     COMP-3.
  1771         16  CP-REM-TERM-METHOD    PIC X.
  1772           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1773           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1774           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1775           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1776           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1777           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1778           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1779         16  CP-EARNING-METHOD     PIC X.
  1780           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1781           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1782           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1783           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1784           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1785           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1786           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1787           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1788           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1789           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1790           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1791           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1792         16  CP-PROCESS-TYPE       PIC X.
  1793           88  CP-CLAIM                            VALUE '1'.
  1794           88  CP-CANCEL                           VALUE '2'.
  1795           88  CP-ISSUE                            VALUE '3'.
  1796         16  CP-SPECIAL-CALC-CD    PIC X.
  1797           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1798           88  CP-1-MTH-INTEREST               VALUE ' '.
  1799           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1800           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1801           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1802           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1803           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1804           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  36
* EL1278.cbl
  1805           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1806           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1807           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1808           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1809           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1810           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1811           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1812           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1813           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1814           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1815                                                     'W' 'X'.
  1816           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1817           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1818           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1819           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1820           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1821           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1822           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1823           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1824           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1825           88  CP-CSL-METH-1                   VALUE '5'.
  1826           88  CP-CSL-METH-2                   VALUE '6'.
  1827           88  CP-CSL-METH-3                   VALUE '7'.
  1828           88  CP-CSL-METH-4                   VALUE '8'.
  1829
  1830         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1831                                     COMP-3.
  1832         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1833         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1834         16  CP-STATE              PIC XX          VALUE SPACE.
  1835         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1836         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1837           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1838               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1839         16  CP-R78-OPTION         PIC X.
  1840           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1841           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1842
  1843         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1844         16  CP-IBNR-RESERVE-SW    PIC X.
  1845         16  CP-CLAIM-STATUS       PIC X.
  1846         16  CP-RATE-FILE          PIC X.
  1847         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1848                                     COMP-3.
  1849
  1850         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1851         16  CP-AH-OVERRIDE-CODE   PIC X.
  1852
  1853         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1854                                     COMP-3.
  1855         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1856                                     COMP-3.
  1857         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1858                                     COMP-3.
  1859         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1860                                     COMP-3.
  1861
  1862         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  37
* EL1278.cbl
  1863         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1864         16  CP-EXT-DAYS-CALC      PIC X.
  1865           88  CP-EXT-NO-CHG                   VALUE ' '.
  1866           88  CP-EXT-CHG-LF                   VALUE '1'.
  1867           88  CP-EXT-CHG-AH                   VALUE '2'.
  1868           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1869         16  CP-DOMICILE-STATE     PIC XX.
  1870         16  CP-CARRIER            PIC X.
  1871         16  CP-REIN-FLAG          PIC X.
  1872         16  CP-REM-TRM-CALC-OPTION PIC X.
  1873           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1874                      '2' '3' '4' '5'.
  1875           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1876           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1877           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1878           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1879           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1880           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1881           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1882           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1883         16  CP-SIG-SWITCH         PIC X.
  1884         16  CP-RATING-METHOD      PIC X.
  1885           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1886           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1887           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1888           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1889           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1890           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1891           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1892           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1893           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1894         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1895                                     COMP-3.
  1896         16  CP-BEN-CATEGORY       PIC X.
  1897         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1898         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1899                                   PIC S99V9(5) COMP-3.
  1900         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1901         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1902                                   PIC S99V9(5) COMP-3.
  1903         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1904         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1905         16  CP-EXPIRE-DT          PIC XX.
  1906         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1907         16  FILLER                PIC X(35).
  1908*        16  FILLER                PIC X(50).
  1909
  1910***************    OUTPUT FROM ELRESV   ************************
  1911
  1912         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1913
  1914         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1915                                     COMP-3.
  1916         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1917                                     COMP-3.
  1918         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1919                                     COMP-3.
  1920         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  38
* EL1278.cbl
  1921                                     COMP-3.
  1922         16  FILLER                PIC X(09).
  1923***************    OUTPUT FROM ELRTRM   *************************
  1924
  1925         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1926                                     COMP-3.
  1927         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1928                                     COMP-3.
  1929         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1930                                     COMP-3.
  1931         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1932                                     COMP-3.
  1933         16  FILLER                PIC X(12).
  1934
  1935***************    OUTPUT FROM ELRAMT   *************************
  1936
  1937         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1938                                     COMP-3.
  1939         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1940                                     COMP-3.
  1941         16  FILLER                PIC X(12).
  1942
  1943***************    OUTPUT FROM ELRATE   *************************
  1944
  1945         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1946                                     COMP-3.
  1947         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1948                                     COMP-3.
  1949         16  CP-MORTALITY-CODE     PIC X(4).
  1950         16  CP-RATE-EDIT-FLAG     PIC X.
  1951             88  CP-RATES-NEED-APR                  VALUE '1'.
  1952         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1953                                     COMP-3.
  1954         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1955         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1956         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1957                                   PIC S9(7)V99 COMP-3.
  1958         16  FILLER                PIC X(07).
  1959
  1960***************    OUTPUT FROM ELRFND   *************************
  1961
  1962         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1963                                     COMP-3.
  1964         16  CP-REFUND-TYPE-USED   PIC X.
  1965           88  CP-R-AS-R78                         VALUE '1'.
  1966           88  CP-R-AS-PRORATA                     VALUE '2'.
  1967           88  CP-R-AS-CALIF                       VALUE '3'.
  1968           88  CP-R-AS-TEXAS                       VALUE '4'.
  1969           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1970           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1971           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1972           88  CP-R-AS-MEAN                        VALUE '8'.
  1973           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1974           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1975           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1976         16  FILLER                PIC X(12).
  1977
  1978***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  39
* EL1278.cbl
  1979
  1980         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1981                                     COMP-3.
  1982         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1983                                     COMP-3.
  1984         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1985                                     COMP-3.
  1986         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1987                                     COMP-3.
  1988         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1989                                     COMP-3.
  1990         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1991                                     COMP-3.
  1992         16  CP-EARNING-TYPE-USED  PIC X.
  1993           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1994           88  CP-E-AS-R78                         VALUE '1'.
  1995           88  CP-E-AS-PRORATA                     VALUE '2'.
  1996           88  CP-E-AS-TEXAS                       VALUE '4'.
  1997           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1998           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1999           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2000           88  CP-E-AS-MEAN                        VALUE '8'.
  2001           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2002         16  FILLER                PIC X(12).
  2003
  2004***************    OUTPUT FROM ELPMNT   *************************
  2005
  2006         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2007                                     COMP-3.
  2008         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2009                                     COMP-3.
  2010         16  FILLER                PIC X(12).
  2011
  2012***************   MISC WORK AREAS    *****************************
  2013         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2014                                     COMP-3.
  2015         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2016                                     COMP-3.
  2017         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2018                                     COMP-3.
  2019         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2020                                     COMP-3.
  2021         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2022                                     COMP-3.
  2023         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2024                                     COMP-3.
  2025         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2026             88  OPEN-RATE-FILE                   VALUE 'O'.
  2027             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2028             88  IO-ERROR                         VALUE 'E'.
  2029
  2030         16  CP-FIRST-PAY-DATE     PIC XX.
  2031
  2032         16  CP-JOINT-INDICATOR    PIC X.
  2033
  2034         16  CP-RESERVE-REMAINING-TERM
  2035                                   PIC S9(4)V9    VALUE ZERO
  2036                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  40
* EL1278.cbl
  2037
  2038         16  CP-INSURED-BIRTH-DT   PIC XX.
  2039
  2040         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2041                                     COMP-3.
  2042
  2043         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2044                                     COMP-3.
  2045
  2046         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2047                                     COMP-3.
  2048
  2049         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2050                                     COMP-3.
  2051
  2052         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2053                                     COMP-3.
  2054
  2055         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2056                                     COMP-3.
  2057
  2058         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2059                                     COMP-3.
  2060
  2061         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2062             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2063
  2064         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2065                                     COMP-3.
  2066         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2067                                     COMP-3.
  2068         16  FILLER                PIC X(17).
  2069******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  41
* EL1278.cbl
  2071*                            COPY ERCNOTE.
  2072******************************************************************
  2073*                                                                *
  2074*                                                                *
  2075*                            ERCNOTE                             *
  2076*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2077*                            VMOD=2.003                          *
  2078*                                                                *
  2079*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2080*                                                                *
  2081*        FILE TYPE= VSAM,KSDS                                    *
  2082*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2083*                                                                *
  2084*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2085*                                                                *
  2086*        LOG = YES                                               *
  2087*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2088*                                                                *
  2089******************************************************************
  2090*                   C H A N G E   L O G
  2091*
  2092* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2093*-----------------------------------------------------------------
  2094*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2095* EFFECTIVE    NUMBER
  2096*-----------------------------------------------------------------
  2097* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2098*                                FILE WILL CONTAIN BILLING NOTES O
  2099******************************************************************
  2100
  2101 01  CERTIFICATE-NOTE.
  2102     12  CN-RECORD-ID                PIC  XX.
  2103         88  VALID-CN-ID                  VALUE 'CN'.
  2104
  2105     12  CN-CONTROL-PRIMARY.
  2106         16  CN-COMPANY-CD           PIC X.
  2107         16  CN-CARRIER              PIC X.
  2108         16  CN-GROUPING.
  2109             20 CN-GROUPING-PREFIX   PIC XXX.
  2110             20 CN-GROUPING-PRIME    PIC XXX.
  2111         16  CN-STATE                PIC XX.
  2112         16  CN-ACCOUNT.
  2113             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2114             20 CN-ACCOUNT-PRIME     PIC X(6).
  2115         16  CN-CERT-EFF-DT          PIC XX.
  2116         16  CN-CERT-NO.
  2117             20  CN-CERT-PRIME       PIC X(10).
  2118             20  CN-CERT-SFX         PIC X.
  2119
  2120     12  CN-BILLING-START-LINE-NO    PIC 99.
  2121     12  CN-BILLING-END-LINE-NO      PIC 99.
  2122
  2123     12  CN-LINES.
  2124         16  CN-LINE OCCURS 10       PIC X(77).
  2125
  2126     12  CN-LAST-MAINT-DT            PIC XX.
  2127     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2128     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  42
* EL1278.cbl
  2129     12  FILLER                      PIC X(6).
  2130******************************************************************
  2131
  2132****************************************************************
  2133*
  2134* Copyright (c) 2007 by Clerity Solutions, Inc.
  2135* All rights reserved.
  2136*
  2137****************************************************************
  2138 01  DFHEIV.
  2139   02  DFHEIV0               PIC X(35).
  2140   02  DFHEIV1               PIC X(08).
  2141   02  DFHEIV2               PIC X(08).
  2142   02  DFHEIV3               PIC X(08).
  2143   02  DFHEIV4               PIC X(06).
  2144   02  DFHEIV5               PIC X(04).
  2145   02  DFHEIV6               PIC X(04).
  2146   02  DFHEIV7               PIC X(02).
  2147   02  DFHEIV8               PIC X(02).
  2148   02  DFHEIV9               PIC X(01).
  2149   02  DFHEIV10              PIC S9(7) COMP-3.
  2150   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2151   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2152   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2153   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2154   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2155   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2156   02  DFHEIV17              PIC X(04).
  2157   02  DFHEIV18              PIC X(04).
  2158   02  DFHEIV19              PIC X(04).
  2159   02  DFHEIV20              USAGE IS POINTER.
  2160   02  DFHEIV21              USAGE IS POINTER.
  2161   02  DFHEIV22              USAGE IS POINTER.
  2162   02  DFHEIV23              USAGE IS POINTER.
  2163   02  DFHEIV24              USAGE IS POINTER.
  2164   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2165   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2166   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2167   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2168   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2169   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2170   02  FILLER                PIC X(02).
  2171   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2172   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2173   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2174   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2175   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2176 LINKAGE  SECTION.
  2177*****************************************************************
  2178*                                                               *
  2179* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2180* All rights reserved.                                          *
  2181*                                                               *
  2182*****************************************************************
  2183 01  dfheiblk.
  2184     02  eibtime          pic s9(7) comp-3.
  2185     02  eibdate          pic s9(7) comp-3.
  2186     02  eibtrnid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  43
* EL1278.cbl
  2187     02  eibtaskn         pic s9(7) comp-3.
  2188     02  eibtrmid         pic x(4).
  2189     02  dfheigdi         pic s9(4) comp.
  2190     02  eibcposn         pic s9(4) comp.
  2191     02  eibcalen         pic s9(4) comp.
  2192     02  eibaid           pic x(1).
  2193     02  eibfiller1       pic x(1).
  2194     02  eibfn            pic x(2).
  2195     02  eibfiller2       pic x(2).
  2196     02  eibrcode         pic x(6).
  2197     02  eibfiller3       pic x(2).
  2198     02  eibds            pic x(8).
  2199     02  eibreqid         pic x(8).
  2200     02  eibrsrce         pic x(8).
  2201     02  eibsync          pic x(1).
  2202     02  eibfree          pic x(1).
  2203     02  eibrecv          pic x(1).
  2204     02  eibsend          pic x(1).
  2205     02  eibatt           pic x(1).
  2206     02  eibeoc           pic x(1).
  2207     02  eibfmh           pic x(1).
  2208     02  eibcompl         pic x(1).
  2209     02  eibsig           pic x(1).
  2210     02  eibconf          pic x(1).
  2211     02  eiberr           pic x(1).
  2212     02  eibrldbk         pic x(1).
  2213     02  eiberrcd         pic x(4).
  2214     02  eibsynrb         pic x(1).
  2215     02  eibnodat         pic x(1).
  2216     02  eibfiller5       pic x(2).
  2217     02  eibresp          pic 9(09) comp.
  2218     02  eibresp2         pic 9(09) comp.
  2219     02  dfheigdj         pic s9(4) comp.
  2220     02  dfheigdk         pic s9(4) comp.
  2221
  2222 01  DFHCOMMAREA                 PIC  X(1024).
  2223
  2224*01 PARMLIST .
  2225*    12  FILLER                  PIC S9(08)      COMP.
  2226*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2227*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2228*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2229*                            COPY ELCCNTL.
  2230******************************************************************
  2231*                                                                *
  2232*                                                                *
  2233*                            ELCCNTL.                            *
  2234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2235*                            VMOD=2.059                          *
  2236*                                                                *
  2237*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2238*                                                                *
  2239*   FILE TYPE = VSAM,KSDS                                        *
  2240*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2241*                                                                *
  2242*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2243*       ALTERNATE INDEX = NONE                                   *
  2244*                                                                *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  44
* EL1278.cbl
  2245*   LOG = YES                                                    *
  2246*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2247******************************************************************
  2248*                   C H A N G E   L O G
  2249*
  2250* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2251*-----------------------------------------------------------------
  2252*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2253* EFFECTIVE    NUMBER
  2254*-----------------------------------------------------------------
  2255* 082503                   PEMA  ADD BENEFIT GROUP
  2256* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2257* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2258* 092705    2005050300006  PEMA  ADD SPP LEASES
  2259* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2260* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2261* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2262* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2263******************************************************************
  2264*
  2265 01  CONTROL-FILE.
  2266     12  CF-RECORD-ID                       PIC XX.
  2267         88  VALID-CF-ID                        VALUE 'CF'.
  2268
  2269     12  CF-CONTROL-PRIMARY.
  2270         16  CF-COMPANY-ID                  PIC XXX.
  2271         16  CF-RECORD-TYPE                 PIC X.
  2272             88  CF-COMPANY-MASTER              VALUE '1'.
  2273             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2274             88  CF-STATE-MASTER                VALUE '3'.
  2275             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2276             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2277             88  CF-CARRIER-MASTER              VALUE '6'.
  2278             88  CF-MORTALITY-MASTER            VALUE '7'.
  2279             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2280             88  CF-TERMINAL-MASTER             VALUE '9'.
  2281             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2282             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2283             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2284             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2285             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2286             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2287             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2288             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2289             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2290         16  CF-ACCESS-CD-GENL              PIC X(4).
  2291         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2292             20  CF-PROCESSOR               PIC X(4).
  2293         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2294             20  CF-STATE-CODE              PIC XX.
  2295             20  FILLER                     PIC XX.
  2296         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2297             20  FILLER                     PIC XX.
  2298             20  CF-HI-BEN-IN-REC           PIC XX.
  2299         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2300             20  FILLER                     PIC XXX.
  2301             20  CF-CARRIER-CNTL            PIC X.
  2302         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  45
* EL1278.cbl
  2303             20  FILLER                     PIC XX.
  2304             20  CF-HI-TYPE-IN-REC          PIC 99.
  2305         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2306             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2307                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2308             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2309             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2310         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2311             20  FILLER                     PIC X.
  2312             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2313         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2314             20  FILLER                     PIC XX.
  2315             20  CF-MORTGAGE-PLAN           PIC XX.
  2316         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2317
  2318     12  CF-LAST-MAINT-DT                   PIC XX.
  2319     12  CF-LAST-MAINT-BY                   PIC X(4).
  2320     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2321
  2322     12  CF-RECORD-BODY                     PIC X(728).
  2323
  2324
  2325****************************************************************
  2326*             COMPANY MASTER RECORD                            *
  2327****************************************************************
  2328
  2329     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2330         16  CF-COMPANY-ADDRESS.
  2331             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2332             20  CF-CL-IN-CARE-OF           PIC X(30).
  2333             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2334             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2335             20  CF-CL-CITY-STATE           PIC X(30).
  2336             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2337             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2338         16  CF-COMPANY-CD                  PIC X.
  2339         16  CF-COMPANY-PASSWORD            PIC X(8).
  2340         16  CF-SECURITY-OPTION             PIC X.
  2341             88  ALL-SECURITY                   VALUE '1'.
  2342             88  COMPANY-VERIFY                 VALUE '2'.
  2343             88  PROCESSOR-VERIFY               VALUE '3'.
  2344             88  NO-SECURITY                    VALUE '4'.
  2345             88  ALL-BUT-TERM                   VALUE '5'.
  2346         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2347             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2348         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2349             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2350         16  CF-INFORCE-LOCATION            PIC X.
  2351             88  CERTS-ARE-ONLINE               VALUE '1'.
  2352             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2353             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2354         16  CF-LOWER-CASE-LETTERS          PIC X.
  2355         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2356             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2357             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2358             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2359             88  CF-ACCNT-CNTL                  VALUE '3'.
  2360             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  46
* EL1278.cbl
  2361
  2362         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2363         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2364
  2365         16  CF-LGX-CREDIT-USER             PIC X.
  2366             88  CO-IS-NOT-USER                 VALUE 'N'.
  2367             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2368
  2369         16 CF-CREDIT-CALC-CODES.
  2370             20  CF-CR-REM-TERM-CALC PIC X.
  2371               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2372               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2373               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2374               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2375               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2376               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2377               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2378             20  CF-CR-R78-METHOD           PIC X.
  2379               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2380               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2381
  2382         16  CF-CLAIM-CONTROL-COUNTS.
  2383             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2384                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2385
  2386             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2387                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2388
  2389             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2390                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2391
  2392             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2393                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2394
  2395         16  CF-CURRENT-MONTH-END           PIC XX.
  2396
  2397         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2398             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2399             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2400             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2401             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2402                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2403                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2404             20  CF-CO-PREM-REJECT-SW       PIC X.
  2405                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2406                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2407             20  CF-CO-REF-REJECT-SW        PIC X.
  2408                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2409                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2410
  2411         16  CF-CO-REPORTING-DT             PIC XX.
  2412         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2413         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2414           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2415           88  CF-CO-MONTH-END                  VALUE '1'.
  2416
  2417         16  CF-LGX-CLAIM-USER              PIC X.
  2418             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  47
* EL1278.cbl
  2419             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2420
  2421         16  CF-CREDIT-EDIT-CONTROLS.
  2422             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2423             20  CF-MIN-AGE                 PIC 99.
  2424             20  CF-DEFAULT-AGE             PIC 99.
  2425             20  CF-MIN-TERM                PIC S999      COMP-3.
  2426             20  CF-MAX-TERM                PIC S999      COMP-3.
  2427             20  CF-DEFAULT-SEX             PIC X.
  2428             20  CF-JOINT-AGE-INPUT         PIC X.
  2429                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2430             20  CF-BIRTH-DATE-INPUT        PIC X.
  2431                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2432             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2433                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2434                 88  CF-ZERO-CARRIER            VALUE '1'.
  2435                 88  CF-ZERO-GROUPING           VALUE '2'.
  2436                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2437             20  CF-EDIT-SW                 PIC X.
  2438                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2439             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2440             20  CF-CR-PR-METHOD            PIC X.
  2441               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2442               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2443             20  FILLER                     PIC X.
  2444
  2445         16  CF-CREDIT-MISC-CONTROLS.
  2446             20  CF-REIN-TABLE-SW           PIC X.
  2447                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2448             20  CF-COMP-TABLE-SW           PIC X.
  2449                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2450             20  CF-EXPERIENCE-RETENTION-AGE
  2451                                            PIC S9        COMP-3.
  2452             20  CF-CONVERSION-DT           PIC XX.
  2453             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2454             20  CF-RUN-FREQUENCY-SW        PIC X.
  2455                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2456                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2457
  2458             20  CF-CR-CHECK-NO-CONTROL.
  2459                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2460                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2461                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2462                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2463                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2464                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2465
  2466                 24  CF-CR-CHECK-COUNT       REDEFINES
  2467                     CF-CR-CHECK-COUNTER      PIC X(4).
  2468
  2469                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2470                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2471
  2472                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2473                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2474                 24  CF-MAIL-PROCESSING       PIC X.
  2475                     88  MAIL-PROCESSING          VALUE 'Y'.
  2476
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  48
* EL1278.cbl
  2477         16  CF-MISC-SYSTEM-CONTROL.
  2478             20  CF-SYSTEM-C                 PIC X.
  2479                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2480             20  CF-SYSTEM-D                 PIC X.
  2481                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2482             20  CF-SOC-SEC-NO-SW            PIC X.
  2483                 88  SOC-SEC-NO-USED             VALUE '1'.
  2484             20  CF-MEMBER-NO-SW             PIC X.
  2485                 88  MEMBER-NO-USED              VALUE '1'.
  2486             20  CF-TAX-ID-NUMBER            PIC X(11).
  2487             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2488             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2489                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2490                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2491                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2492                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2493             20  CF-SYSTEM-E                 PIC X.
  2494                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2495
  2496         16  CF-LGX-LIFE-USER               PIC X.
  2497             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2498             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2499
  2500         16  CF-CR-MONTH-END-DT             PIC XX.
  2501
  2502         16  CF-FILE-MAINT-DATES.
  2503             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2504                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2505             20  CF-LAST-BATCH       REDEFINES
  2506                 CF-LAST-BATCH-NO               PIC X(4).
  2507             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2508             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2509             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2510             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2511             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2512             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2513             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2514             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2515             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2516             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2517
  2518         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2519         16  FILLER                         PIC X.
  2520
  2521         16  CF-ALT-MORT-CODE               PIC X(4).
  2522         16  CF-MEMBER-CAPTION              PIC X(10).
  2523
  2524         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2525             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2526             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2527             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2528             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2529             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2530
  2531         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2532
  2533         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2534         16  CF-LIFE-OVERRIDE-L2            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  49
* EL1278.cbl
  2535         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2536         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2537
  2538         16  CF-AH-OVERRIDE-L1              PIC X.
  2539         16  CF-AH-OVERRIDE-L2              PIC XX.
  2540         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2541         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2542
  2543         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2544         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2545
  2546         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2547         16  CF-AR-LAST-EL860-DT            PIC XX.
  2548         16  CF-MP-MONTH-END-DT             PIC XX.
  2549
  2550         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2551         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2552             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2553
  2554         16  CF-AR-MONTH-END-DT             PIC XX.
  2555
  2556         16  CF-CRDTCRD-USER                PIC X.
  2557             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2558             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2559
  2560         16  CF-CC-MONTH-END-DT             PIC XX.
  2561
  2562         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2563
  2564         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2565             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2566             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2567             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2568         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2569         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2570         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2571         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2572             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2573             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2574         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2575         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2576         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2577             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2578         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2579
  2580         16  CF-CL-ZIP-CODE.
  2581             20  CF-CL-ZIP-PRIME.
  2582                 24  CF-CL-ZIP-1ST          PIC X.
  2583                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2584                 24  FILLER                 PIC X(4).
  2585             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2586         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2587             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2588             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2589             20  FILLER                     PIC XXX.
  2590
  2591         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2592         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  50
* EL1278.cbl
  2593         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2594         16  CF-CO-OPTION-START-DATE        PIC XX.
  2595         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2596           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2597                                                      '3' '4'.
  2598           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2599           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2600           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2601           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2602           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2603           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2604
  2605         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2606
  2607         16  CF-PAYMENT-APPROVAL-LEVELS.
  2608             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2609             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2610             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2611             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2612             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2613             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2614
  2615         16  CF-END-USER-REPORTING-USER     PIC X.
  2616             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2617             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2618
  2619         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2620             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2621             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2622
  2623         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2624
  2625         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2626         16  FILLER                         PIC X.
  2627
  2628         16  CF-CREDIT-ARCHIVE-CNTL.
  2629             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2630             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2631             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2632
  2633         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2634
  2635         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2636             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2637             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2638
  2639         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2640             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2641             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2642
  2643         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2644
  2645         16  CF-CO-ACH-ID-CODE              PIC  X.
  2646             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2647             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2648             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2649         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2650         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  51
* EL1278.cbl
  2651         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2652         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2653         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2654         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2655         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2656         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2657         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2658                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2659         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2660                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2661
  2662         16  CF-CO-OVER-SHORT.
  2663             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2664             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2665
  2666*         16  FILLER                         PIC X(102).
  2667         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2668             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2669             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2670
  2671         16  CF-AH-APPROVAL-DAYS.
  2672             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2673             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2674             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2675             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2676
  2677         16  FILLER                         PIC X(82).
  2678****************************************************************
  2679*             PROCESSOR/USER RECORD                            *
  2680****************************************************************
  2681
  2682     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2683         16  CF-PROCESSOR-NAME              PIC X(30).
  2684         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2685         16  CF-PROCESSOR-TITLE             PIC X(26).
  2686         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2687                 88  MESSAGE-YES                VALUE 'Y'.
  2688                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2689
  2690*****************************************************
  2691****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2692****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2693****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2694****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2695*****************************************************
  2696
  2697         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2698             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2699             20  CF-APPLICATION-FORCE       PIC X.
  2700             20  CF-INDIVIDUAL-APP.
  2701                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2702                     28  CF-BROWSE-APP      PIC X.
  2703                     28  CF-UPDATE-APP      PIC X.
  2704
  2705         16  CF-CURRENT-TERM-ON             PIC X(4).
  2706         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2707             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2708             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  52
* EL1278.cbl
  2709             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2710             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2711             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2712             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2713             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2714         16  CF-PROCESSOR-CARRIER           PIC X.
  2715             88  NO-CARRIER-SECURITY            VALUE ' '.
  2716         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2717             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2718         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2719             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2720         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2721             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2722
  2723         16  CF-PROC-SYS-ACCESS-SW.
  2724             20  CF-PROC-CREDIT-CLAIMS-SW.
  2725                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2726                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2727                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2728                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2729             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2730                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2731                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2732             20  CF-PROC-LIFE-GNRLDGR-SW.
  2733                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2734                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2735                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2736                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2737             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2738                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2739                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2740         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2741             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2742             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2743         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2744
  2745         16  CF-APPROVAL-LEVEL                  PIC X.
  2746             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2747             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2748             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2749             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2750
  2751         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2752
  2753         16  CF-LANGUAGE-TYPE                   PIC X.
  2754             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2755             88  CF-LANG-IS-FR                      VALUE 'F'.
  2756         16  FILLER                             PIC  X(240).
  2757
  2758****************************************************************
  2759*             PROCESSOR/REMINDERS RECORD                       *
  2760****************************************************************
  2761
  2762     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2763         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2764             20  CF-START-REMIND-DT         PIC XX.
  2765             20  CF-END-REMIND-DT           PIC XX.
  2766             20  CF-REMINDER-TEXT           PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  53
* EL1278.cbl
  2767         16  FILLER                         PIC X(296).
  2768
  2769
  2770****************************************************************
  2771*             STATE MASTER RECORD                              *
  2772****************************************************************
  2773
  2774     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2775         16  CF-STATE-ABBREVIATION          PIC XX.
  2776         16  CF-STATE-NAME                  PIC X(25).
  2777         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2778         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2779             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2780             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2781             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2782             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2783                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2784                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2785             20  CF-ST-PREM-REJECT-SW       PIC X.
  2786                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2787                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2788             20  CF-ST-REF-REJECT-SW        PIC X.
  2789                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2790                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2791         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2792         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2793         16  CF-ST-REFUND-RULES.
  2794             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2795             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2796             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2797         16  CF-ST-FST-PMT-EXTENSION.
  2798             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2799             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2800                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2801                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2802                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2803                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2804         16  CF-ST-STATE-CALL.
  2805             20  CF-ST-CALL-UNEARNED        PIC X.
  2806             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2807             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2808         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2809             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2810             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2811         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2812         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2813         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2814         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2815         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2816         16  FILLER                         PIC X.
  2817         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2818             20  CF-ST-BENEFIT-CD           PIC XX.
  2819             20  CF-ST-BENEFIT-KIND         PIC X.
  2820                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2821                 88  CF-ST-AH-KIND              VALUE 'A'.
  2822             20  CF-ST-REM-TERM-CALC        PIC X.
  2823                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2824                 88  ST-EARN-AFTER-15TH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  54
* EL1278.cbl
  2825                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2826                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2827                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2828                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2829                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2830                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2831
  2832             20  CF-ST-REFUND-CALC          PIC X.
  2833                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2834                 88  ST-REFD-BY-R78             VALUE '1'.
  2835                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2836                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2837                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2838                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2839                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2840                 88  ST-REFD-UTAH               VALUE '7'.
  2841                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2842                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2843                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2844
  2845             20  CF-ST-EARNING-CALC         PIC X.
  2846                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2847                 88  ST-EARN-BY-R78             VALUE '1'.
  2848                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2849                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2850                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2851                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2852                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2853                 88  ST-EARN-MEAN               VALUE '8'.
  2854                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2855
  2856             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2857                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2858                 88  ST-OVRD-BY-R78             VALUE '1'.
  2859                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2860                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2861                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2862                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2863                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2864                 88  ST-OVRD-MEAN               VALUE '8'.
  2865                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2866             20  FILLER                     PIC X.
  2867
  2868         16  CF-ST-COMMISSION-CAPS.
  2869             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2870             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2871             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2872             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2873         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2874                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2875
  2876         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2877
  2878         16  CF-ST-STATUTORY-INTEREST.
  2879             20  CF-ST-STAT-DATE-FROM       PIC X.
  2880                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2881                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2882             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  55
* EL1278.cbl
  2883             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2884             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2885             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2886             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2887
  2888         16  CF-ST-OVER-SHORT.
  2889             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2890             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2891
  2892         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2893
  2894         16  CF-ST-RT-CALC                  PIC X.
  2895
  2896         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2897         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2898         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2899         16  CF-ST-RF-LR-CALC               PIC X.
  2900         16  CF-ST-RF-LL-CALC               PIC X.
  2901         16  CF-ST-RF-LN-CALC               PIC X.
  2902         16  CF-ST-RF-AH-CALC               PIC X.
  2903         16  CF-ST-RF-CP-CALC               PIC X.
  2904*        16  FILLER                         PIC X(206).
  2905*CIDMOD         16  FILLER                         PIC X(192).
  2906         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2907             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2908         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2909         16  FILLER                         PIC X(187).
  2910
  2911****************************************************************
  2912*             BENEFIT MASTER RECORD                            *
  2913****************************************************************
  2914
  2915     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2916         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2917             20  CF-BENEFIT-CODE            PIC XX.
  2918             20  CF-BENEFIT-NUMERIC  REDEFINES
  2919                 CF-BENEFIT-CODE            PIC XX.
  2920             20  CF-BENEFIT-ALPHA           PIC XXX.
  2921             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2922             20  CF-BENEFIT-COMMENT         PIC X(10).
  2923
  2924             20  CF-LF-COVERAGE-TYPE        PIC X.
  2925                 88  CF-REDUCING                VALUE 'R'.
  2926                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2927
  2928             20  CF-SPECIAL-CALC-CD         PIC X.
  2929                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2930                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2931                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2932                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2933                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2934                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2935                 88  CF-FARM-PLAN               VALUE 'F'.
  2936                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2937                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2938                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2939                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2940                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  56
* EL1278.cbl
  2941                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2942                 88  CF-PRUDENTIAL              VALUE 'P'.
  2943                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2944                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2945                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2946                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2947                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2948                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2949
  2950             20  CF-JOINT-INDICATOR         PIC X.
  2951                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2952
  2953*            20  FILLER                     PIC X(12).
  2954             20  FILLER                     PIC X(11).
  2955             20  CF-BENEFIT-CATEGORY        PIC X.
  2956             20  CF-LOAN-TYPE               PIC X(8).
  2957
  2958             20  CF-CO-REM-TERM-CALC        PIC X.
  2959                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2960                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2961                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2962                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2963                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2964
  2965             20  CF-CO-EARNINGS-CALC        PIC X.
  2966                 88  CO-EARN-BY-R78             VALUE '1'.
  2967                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2968                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2969                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2970                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2971                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2972                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2973                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2974
  2975             20  CF-CO-REFUND-CALC          PIC X.
  2976                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2977                 88  CO-REFD-BY-R78             VALUE '1'.
  2978                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2979                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2980                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2981                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2982                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2983                 88  CO-REFD-MEAN               VALUE '8'.
  2984                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2985                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2986                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2987
  2988             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2989                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2990                 88  CO-OVRD-BY-R78             VALUE '1'.
  2991                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2992                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2993                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2994                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2995                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2996                 88  CO-OVRD-MEAN               VALUE '8'.
  2997                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2998
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  57
* EL1278.cbl
  2999             20  CF-CO-BEN-I-G-CD           PIC X.
  3000                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3001                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3002                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3003
  3004         16  FILLER                         PIC X(304).
  3005
  3006
  3007****************************************************************
  3008*             CARRIER MASTER RECORD                            *
  3009****************************************************************
  3010
  3011     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3012         16  CF-ADDRESS-DATA.
  3013             20  CF-MAIL-TO-NAME            PIC X(30).
  3014             20  CF-IN-CARE-OF              PIC X(30).
  3015             20  CF-ADDRESS-LINE-1          PIC X(30).
  3016             20  CF-ADDRESS-LINE-2          PIC X(30).
  3017             20  CF-CITY-STATE              PIC X(30).
  3018             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3019             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3020
  3021         16  CF-CLAIM-NO-CONTROL.
  3022             20  CF-CLAIM-NO-METHOD         PIC X.
  3023                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3024                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3025                 88  CLAIM-NO-SEQ               VALUE '3'.
  3026                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3027             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3028                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3029                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3030                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3031
  3032         16  CF-CHECK-NO-CONTROL.
  3033             20  CF-CHECK-NO-METHOD         PIC X.
  3034                 88  CHECK-NO-MANUAL            VALUE '1'.
  3035                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3036                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3037                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3038             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3039                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3040
  3041         16  CF-DOMICILE-STATE              PIC XX.
  3042
  3043         16  CF-EXPENSE-CONTROLS.
  3044             20  CF-EXPENSE-METHOD          PIC X.
  3045                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3046                 88  DOLLARS-PER-PMT            VALUE '2'.
  3047                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3048                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3049             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3050             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3051
  3052         16  CF-CORRESPONDENCE-CONTROL.
  3053             20  CF-LETTER-RESEND-OPT       PIC X.
  3054                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3055                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3056             20  FILLER                     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  58
* EL1278.cbl
  3057
  3058         16  CF-RESERVE-CONTROLS.
  3059             20  CF-MANUAL-SW               PIC X.
  3060                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3061             20  CF-FUTURE-SW               PIC X.
  3062                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3063             20  CF-PTC-SW                  PIC X.
  3064                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3065             20  CF-IBNR-SW                 PIC X.
  3066                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3067             20  CF-PTC-LF-SW               PIC X.
  3068                 88  CF-LF-PTC-USED             VALUE '1'.
  3069             20  CF-CDT-ACCESS-METHOD       PIC X.
  3070                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3071                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3072                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3073             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3074
  3075         16  CF-CLAIM-CALC-METHOD           PIC X.
  3076             88  360-PLUS-MONTHS                VALUE '1'.
  3077             88  365-PLUS-MONTHS                VALUE '2'.
  3078             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3079             88  360-DAILY                      VALUE '4'.
  3080             88  365-DAILY                      VALUE '5'.
  3081
  3082         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3083         16  FILLER                         PIC X(11).
  3084
  3085         16  CF-LIMIT-AMOUNTS.
  3086             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3087             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3088             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3089             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3090             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3091             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3092             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3093             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3094             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3095             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3096
  3097         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3098         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3099         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3100
  3101         16  CF-ZIP-CODE.
  3102             20  CF-ZIP-PRIME.
  3103                 24  CF-ZIP-1ST             PIC X.
  3104                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3105                 24  FILLER                 PIC X(4).
  3106             20  CF-ZIP-PLUS4               PIC X(4).
  3107         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3108             20  CF-CAN-POSTAL-1            PIC XXX.
  3109             20  CF-CAN-POSTAL-2            PIC XXX.
  3110             20  FILLER                     PIC XXX.
  3111
  3112         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3113         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3114         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  59
* EL1278.cbl
  3115
  3116         16  CF-RATING-SWITCH               PIC X.
  3117             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3118             88  CF-NO-RATING                   VALUE 'N'.
  3119
  3120         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3121
  3122         16  CF-CARRIER-OVER-SHORT.
  3123             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3124             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3125
  3126         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3127         16  CF-SECPAY-SWITCH               PIC X.
  3128             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3129             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3130         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3131         16  FILLER                         PIC X(448).
  3132*        16  FILLER                         PIC X(452).
  3133
  3134
  3135****************************************************************
  3136*             MORTALITY MASTER RECORD                          *
  3137****************************************************************
  3138
  3139     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3140         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3141                                INDEXED BY CF-MORT-NDX.
  3142             20  CF-MORT-TABLE              PIC X(5).
  3143             20  CF-MORT-TABLE-TYPE         PIC X.
  3144                 88  CF-MORT-JOINT              VALUE 'J'.
  3145                 88  CF-MORT-SINGLE             VALUE 'S'.
  3146                 88  CF-MORT-COMBINED           VALUE 'C'.
  3147                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3148                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3149             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3150             20  CF-MORT-AGE-METHOD         PIC XX.
  3151                 88  CF-AGE-LAST                VALUE 'AL'.
  3152                 88  CF-AGE-NEAR                VALUE 'AN'.
  3153             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3154             20  CF-MORT-ADJUSTMENT-DIRECTION
  3155                                            PIC X.
  3156                 88  CF-MINUS                   VALUE '-'.
  3157                 88  CF-PLUS                    VALUE '+'.
  3158             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3159             20  CF-MORT-JOINT-CODE         PIC X.
  3160                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3161             20  CF-MORT-PC-Q               PIC X.
  3162                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3163             20  CF-MORT-TABLE-CODE         PIC X(4).
  3164             20  CF-MORT-COMMENTS           PIC X(15).
  3165             20  FILLER                     PIC X(14).
  3166
  3167         16  FILLER                         PIC X(251).
  3168
  3169
  3170****************************************************************
  3171*             BUSSINESS TYPE MASTER RECORD                     *
  3172****************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  60
* EL1278.cbl
  3173
  3174     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3175* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3176* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3177* AND RECORD 05 IS TYPES 81-99
  3178         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3179             20  CF-BUSINESS-TITLE          PIC  X(19).
  3180             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3181                                            PIC S9V9(4) COMP-3.
  3182             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3183             20  FILLER                     PIC  X.
  3184         16  FILLER                         PIC  X(248).
  3185
  3186
  3187****************************************************************
  3188*             TERMINAL MASTER RECORD                           *
  3189****************************************************************
  3190
  3191     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3192
  3193         16  CF-COMPANY-TERMINALS.
  3194             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3195                                  PIC X(4).
  3196         16  FILLER               PIC X(248).
  3197
  3198
  3199****************************************************************
  3200*             LIFE EDIT MASTER RECORD                          *
  3201****************************************************************
  3202
  3203     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3204         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3205             20  CF-LIFE-CODE-IN            PIC XX.
  3206             20  CF-LIFE-CODE-OUT           PIC XX.
  3207         16  FILLER                         PIC X(248).
  3208
  3209
  3210****************************************************************
  3211*             AH EDIT MASTER RECORD                            *
  3212****************************************************************
  3213
  3214     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3215         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3216             20  CF-AH-CODE-IN              PIC XXX.
  3217             20  CF-AH-CODE-OUT             PIC XX.
  3218         16  FILLER                         PIC X(248).
  3219
  3220
  3221****************************************************************
  3222*             CREDIBILITY TABLES                               *
  3223****************************************************************
  3224
  3225     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3226         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3227                             INDEXED BY CF-CRDB-NDX.
  3228             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3229             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3230             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  61
* EL1278.cbl
  3231         16  FILLER                         PIC  X(332).
  3232
  3233
  3234****************************************************************
  3235*             REPORT CUSTOMIZATION RECORD                      *
  3236****************************************************************
  3237
  3238     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3239         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3240             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3241             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3242             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3243**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3244****       A T-TRANSFER.                                   ****
  3245             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3246
  3247         16  FILLER                         PIC XX.
  3248
  3249         16  CF-CARRIER-CNTL-OPT.
  3250             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3251                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3252                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3253             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3254                                            PIC X.
  3255         16  CF-GROUP-CNTL-OPT.
  3256             20  CF-GROUP-OPT-SEQ           PIC 9.
  3257                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3258                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3259             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3260                                            PIC X(6).
  3261         16  CF-STATE-CNTL-OPT.
  3262             20  CF-STATE-OPT-SEQ           PIC 9.
  3263                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3264                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3265             20  CF-STATE-SELECT OCCURS 3 TIMES
  3266                                            PIC XX.
  3267         16  CF-ACCOUNT-CNTL-OPT.
  3268             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3269                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3270                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3271             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3272                                            PIC X(10).
  3273         16  CF-BUS-TYP-CNTL-OPT.
  3274             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3275                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3276                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3277             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3278                                            PIC XX.
  3279         16  CF-LF-TYP-CNTL-OPT.
  3280             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3281                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3282                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3283             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3284                                            PIC XX.
  3285         16  CF-AH-TYP-CNTL-OPT.
  3286             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3287                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3288                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  62
* EL1278.cbl
  3289             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3290                                            PIC XX.
  3291         16  CF-REPTCD1-CNTL-OPT.
  3292             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3293                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3294                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3295             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3296                                            PIC X(10).
  3297         16  CF-REPTCD2-CNTL-OPT.
  3298             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3299                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3300                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3301             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3302                                            PIC X(10).
  3303         16  CF-USER1-CNTL-OPT.
  3304             20  CF-USER1-OPT-SEQ           PIC 9.
  3305                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3306                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3307             20  CF-USER1-SELECT OCCURS 3 TIMES
  3308                                            PIC X(10).
  3309         16  CF-USER2-CNTL-OPT.
  3310             20  CF-USER2-OPT-SEQ           PIC 9.
  3311                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3312                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3313             20  CF-USER2-SELECT OCCURS 3 TIMES
  3314                                            PIC X(10).
  3315         16  CF-USER3-CNTL-OPT.
  3316             20  CF-USER3-OPT-SEQ           PIC 9.
  3317                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3318                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3319             20  CF-USER3-SELECT OCCURS 3 TIMES
  3320                                            PIC X(10).
  3321         16  CF-USER4-CNTL-OPT.
  3322             20  CF-USER4-OPT-SEQ           PIC 9.
  3323                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3324                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3325             20  CF-USER4-SELECT OCCURS 3 TIMES
  3326                                            PIC X(10).
  3327         16  CF-USER5-CNTL-OPT.
  3328             20  CF-USER5-OPT-SEQ           PIC 9.
  3329                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3330                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3331             20  CF-USER5-SELECT OCCURS 3 TIMES
  3332                                            PIC X(10).
  3333         16  CF-REINS-CNTL-OPT.
  3334             20  CF-REINS-OPT-SEQ           PIC 9.
  3335                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3336                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3337             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3338                 24  CF-REINS-PRIME         PIC XXX.
  3339                 24  CF-REINS-SUB           PIC XXX.
  3340
  3341         16  CF-AGENT-CNTL-OPT.
  3342             20  CF-AGENT-OPT-SEQ           PIC 9.
  3343                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3344                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3345             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3346                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  63
* EL1278.cbl
  3347
  3348         16  FILLER                         PIC X(43).
  3349
  3350         16  CF-LOSS-RATIO-SELECT.
  3351             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3352             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3353         16  CF-ENTRY-DATE-SELECT.
  3354             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3355             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3356         16  CF-EFFECTIVE-DATE-SELECT.
  3357             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3358             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3359
  3360         16  CF-EXCEPTION-LIST-IND          PIC X.
  3361             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3362
  3363         16  FILLER                         PIC X(318).
  3364
  3365****************************************************************
  3366*                  EXCEPTION REPORTING RECORD                  *
  3367****************************************************************
  3368
  3369     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3370         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3371             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3372
  3373         16  CF-COMBINED-LIFE-AH-OPT.
  3374             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3375             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3376             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3377             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3378
  3379         16  CF-LIFE-OPT.
  3380             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3381             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3382             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3383             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3384             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3385             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3386             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3387             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3388             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3389             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3390
  3391         16  CF-AH-OPT.
  3392             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3393             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3394             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3395             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3396             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3397             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3398             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3399             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3400             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3401             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3402
  3403         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3404             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  64
* EL1278.cbl
  3405             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3406             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3407
  3408         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3409
  3410         16  FILLER                         PIC X(673).
  3411
  3412
  3413****************************************************************
  3414*             MORTGAGE SYSTEM PLAN RECORD                      *
  3415****************************************************************
  3416
  3417     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3418         16  CF-PLAN-TYPE                   PIC X.
  3419             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3420             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3421             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3422         16  CF-PLAN-ABBREV                 PIC XXX.
  3423         16  CF-PLAN-DESCRIPT               PIC X(10).
  3424         16  CF-PLAN-NOTES                  PIC X(20).
  3425         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3426         16  CF-PLAN-UNDERWRITING.
  3427             20  CF-PLAN-TERM-DATA.
  3428                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3429                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3430             20  CF-PLAN-AGE-DATA.
  3431                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3432                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3433                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3434             20  CF-PLAN-BENEFIT-DATA.
  3435                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3436                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3437                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3438                                            PIC S9(7)V99  COMP-3.
  3439         16  CF-PLAN-POLICY-FORMS.
  3440             20  CF-POLICY-FORM             PIC X(12).
  3441             20  CF-MASTER-APPLICATION      PIC X(12).
  3442             20  CF-MASTER-POLICY           PIC X(12).
  3443         16  CF-PLAN-RATING.
  3444             20  CF-RATE-CODE               PIC X(5).
  3445             20  CF-SEX-RATING              PIC X.
  3446                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3447                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3448             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3449             20  CF-SUB-STD-TYPE            PIC X.
  3450                 88  CF-PCT-OF-PREM            VALUE '1'.
  3451                 88  CF-PCT-OF-BENE            VALUE '2'.
  3452         16  CF-PLAN-PREM-TOLERANCES.
  3453             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3454             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3455         16  CF-PLAN-PYMT-TOLERANCES.
  3456             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3457             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3458         16  CF-PLAN-MISC-DATA.
  3459             20  FILLER                     PIC X.
  3460             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3461             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3462         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  65
* EL1278.cbl
  3463         16  CF-PLAN-IND-GRP                PIC X.
  3464             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3465                                                     '1'.
  3466             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3467                                                     '2'.
  3468         16  CF-MIB-SEARCH-SW               PIC X.
  3469             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3470             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3471             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3472             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3473         16  CF-ALPHA-SEARCH-SW             PIC X.
  3474             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3475             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3476             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3477             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3478             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3479             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3480             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3481             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3482             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3483             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3484                                                     'A' 'B' 'C'
  3485                                                     'X' 'Y' 'Z'.
  3486         16  CF-EFF-DT-RULE-SW              PIC X.
  3487             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3488             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3489             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3490             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3491             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3492         16  FILLER                         PIC X(4).
  3493         16  CF-HEALTH-QUESTIONS            PIC X.
  3494             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3495         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3496         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3497         16  CF-PLAN-SNGL-JNT               PIC X.
  3498             88  CF-COMBINED-PLAN              VALUE 'C'.
  3499             88  CF-JNT-PLAN                   VALUE 'J'.
  3500             88  CF-SNGL-PLAN                  VALUE 'S'.
  3501         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3502         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3503         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3504         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3505         16  CF-RERATE-CNTL                 PIC  X.
  3506             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3507             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3508             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3509             88  CF-AUTO-RECALC                 VALUE '4'.
  3510         16  CF-BENEFIT-TYPE                PIC  X.
  3511             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3512             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3513         16  CF-POLICY-FEE                  PIC S999V99
  3514                                                    COMP-3.
  3515         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3516         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3517         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3518         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3519         16  FILLER                         PIC  X(32).
  3520         16  CF-TERMINATION-FORM            PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  66
* EL1278.cbl
  3521         16  FILLER                         PIC  X(08).
  3522         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3523                                                       COMP-3.
  3524         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3525         16  CF-ISSUE-LETTER                PIC  X(4).
  3526         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3527         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3528             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3529             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3530         16  CF-MP-REFUND-CALC              PIC X.
  3531             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3532             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3533             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3534             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3535             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3536             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3537             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3538             88  CF-MP-REFD-MEAN                VALUE '8'.
  3539         16  CF-ALT-RATE-CODE               PIC  X(5).
  3540
  3541
  3542         16  FILLER                         PIC X(498).
  3543****************************************************************
  3544*             MORTGAGE COMPANY MASTER RECORD                   *
  3545****************************************************************
  3546
  3547     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3548         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3549         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3550             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3551             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3552             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3553             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3554             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3555
  3556         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3557         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3558         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3559         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3560         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3561
  3562         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3563             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3564         16  CF-MP-RECON-USE-IND            PIC X(1).
  3565             88  CF-MP-USE-RECON             VALUE 'Y'.
  3566         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3567             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3568         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3569             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3570             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3571         16  FILLER                         PIC X(1).
  3572         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3573             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3574         16  CF-MORTG-MIB-VERSION           PIC X.
  3575             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3576             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3577             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3578         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  67
* EL1278.cbl
  3579             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3580                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3581             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3582                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3583             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3584                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3585             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3586                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3587             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3588                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3589             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3590                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3591         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3592         16  FILLER                         PIC X(7).
  3593         16  CF-MORTG-DESTINATION-SYMBOL.
  3594             20  CF-MORTG-MIB-COMM          PIC X(5).
  3595             20  CF-MORTG-MIB-TERM          PIC X(5).
  3596         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3597             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3598         16  FILLER                         PIC X(03).
  3599         16  CF-MP-CHECK-NO-CONTROL.
  3600             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3601                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3602                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3603                                                ' ' LOW-VALUES.
  3604                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3605                                               VALUE '3'.
  3606         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3607         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3608         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3609             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3610                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3611             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3612                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3613             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3614                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3615             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3616                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3617             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3618                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3619             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3620                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3621         16  CF-MORTG-BILLING-AREA.
  3622             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3623                                            PIC X.
  3624         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3625         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3626         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3627         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3628             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3629             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3630         16  FILLER                         PIC X.
  3631         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3632             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3633             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3634         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3635         16  FILLER                         PIC X(8).
  3636         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  68
* EL1278.cbl
  3637         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3638         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3639         16  CF-ACH-COMPANY-ID.
  3640             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3641                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3642                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3643                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3644             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3645         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3646             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3647         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3648             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3649             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3650         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3651         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3652         16  FILLER                         PIC X(536).
  3653
  3654****************************************************************
  3655*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3656****************************************************************
  3657
  3658     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3659         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3660             20  CF-FEMALE-HEIGHT.
  3661                 24  CF-FEMALE-FT           PIC 99.
  3662                 24  CF-FEMALE-IN           PIC 99.
  3663             20  CF-FEMALE-MIN-WT           PIC 999.
  3664             20  CF-FEMALE-MAX-WT           PIC 999.
  3665         16  FILLER                         PIC X(428).
  3666
  3667     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3668         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3669             20  CF-MALE-HEIGHT.
  3670                 24  CF-MALE-FT             PIC 99.
  3671                 24  CF-MALE-IN             PIC 99.
  3672             20  CF-MALE-MIN-WT             PIC 999.
  3673             20  CF-MALE-MAX-WT             PIC 999.
  3674         16  FILLER                         PIC X(428).
  3675******************************************************************
  3676*             AUTOMATIC ACTIVITY RECORD                          *
  3677******************************************************************
  3678     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3679         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3680             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3681             20  CF-SYS-LETTER-ID           PIC X(04).
  3682             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3683             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3684             20  CF-SYS-RESET-SW            PIC X(01).
  3685             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3686             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3687
  3688         16  FILLER                         PIC X(50).
  3689
  3690         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3691             20  CF-USER-ACTIVE-SW          PIC X(01).
  3692             20  CF-USER-LETTER-ID          PIC X(04).
  3693             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3694             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  69
* EL1278.cbl
  3695             20  CF-USER-RESET-SW           PIC X(01).
  3696             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3697             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3698             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3699
  3700         16  FILLER                         PIC X(246).
  3701*                            COPY ERCACCT.
  3702******************************************************************
  3703*                                                                *
  3704*                                                                *
  3705*                            ERCACCT                             *
  3706*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3707*                            VMOD=2.031                          *
  3708*                                                                *
  3709*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3710*                                                                *
  3711*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3712*   VSAM ACCOUNT MASTER FILES.                                   *
  3713*                                                                *
  3714*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3715*                                                                *
  3716*   FILE TYPE = VSAM,KSDS                                        *
  3717*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3718*                                                                *
  3719*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3720*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3721*                                                                *
  3722*   LOG = NO                                                     *
  3723*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3724*                                                                *
  3725*                                                                *
  3726******************************************************************
  3727*                   C H A N G E   L O G
  3728*
  3729* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3730*-----------------------------------------------------------------
  3731*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3732* EFFECTIVE    NUMBER
  3733*-----------------------------------------------------------------
  3734* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3735* 092705    2005050300006  PEMA  ADD SPP LEASES
  3736* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3737* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3738* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3739******************************************************************
  3740
  3741 01  ACCOUNT-MASTER.
  3742     12  AM-RECORD-ID                      PIC XX.
  3743         88  VALID-AM-ID                      VALUE 'AM'.
  3744
  3745     12  AM-CONTROL-PRIMARY.
  3746         16  AM-COMPANY-CD                 PIC X.
  3747         16  AM-MSTR-CNTRL.
  3748             20  AM-CONTROL-A.
  3749                 24  AM-CARRIER            PIC X.
  3750                 24  AM-GROUPING.
  3751                     28 AM-GROUPING-PREFIX PIC XXX.
  3752                     28 AM-GROUPING-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  70
* EL1278.cbl
  3753                 24  AM-STATE              PIC XX.
  3754                 24  AM-ACCOUNT.
  3755                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3756                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3757             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3758                                           PIC X(19).
  3759             20  AM-CNTRL-B.
  3760                 24  AM-EXPIRATION-DT      PIC XX.
  3761                 24  FILLER                PIC X(4).
  3762             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3763                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3764
  3765     12  AM-CONTROL-BY-VAR-GRP.
  3766         16  AM-COMPANY-CD-A1              PIC X.
  3767         16  AM-VG-CARRIER                 PIC X.
  3768         16  AM-VG-GROUPING                PIC X(6).
  3769         16  AM-VG-STATE                   PIC XX.
  3770         16  AM-VG-ACCOUNT                 PIC X(10).
  3771         16  AM-VG-DATE.
  3772             20  AM-VG-EXPIRATION-DT       PIC XX.
  3773             20  FILLER                    PIC X(4).
  3774         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3775                                           PIC 9(11)      COMP-3.
  3776     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3777         16  FILLER                        PIC X(10).
  3778         16  AM-VG-KEY3.
  3779             20  AM-VG3-ACCOUNT            PIC X(10).
  3780             20  AM-VG3-EXP-DT             PIC XX.
  3781         16  FILLER                        PIC X(4).
  3782     12  AM-MAINT-INFORMATION.
  3783         16  AM-LAST-MAINT-DT              PIC XX.
  3784         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3785         16  AM-LAST-MAINT-USER            PIC X(4).
  3786         16  FILLER                        PIC XX.
  3787
  3788     12  AM-EFFECTIVE-DT                   PIC XX.
  3789     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3790
  3791     12  AM-PREV-DATES  COMP-3.
  3792         16  AM-PREV-EXP-DT                PIC 9(11).
  3793         16  AM-PREV-EFF-DT                PIC 9(11).
  3794
  3795     12  AM-REPORT-CODE-1                  PIC X(10).
  3796     12  AM-REPORT-CODE-2                  PIC X(10).
  3797
  3798     12  AM-CITY-CODE                      PIC X(4).
  3799     12  AM-COUNTY-PARISH                  PIC X(6).
  3800
  3801     12  AM-NAME                           PIC X(30).
  3802     12  AM-PERSON                         PIC X(30).
  3803     12  AM-ADDRS                          PIC X(30).
  3804     12  AM-CITY.
  3805         16  AM-ADDR-CITY                  PIC X(28).
  3806         16  AM-ADDR-STATE                 PIC XX.
  3807     12  AM-ZIP.
  3808         16  AM-ZIP-PRIME.
  3809             20  AM-ZIP-PRI-1ST            PIC X.
  3810                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  71
* EL1278.cbl
  3811             20  FILLER                    PIC X(4).
  3812         16  AM-ZIP-PLUS4                  PIC X(4).
  3813     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3814         16  AM-CAN-POSTAL-1               PIC XXX.
  3815         16  AM-CAN-POSTAL-2               PIC XXX.
  3816         16  FILLER                        PIC XXX.
  3817     12  AM-TEL-NO.
  3818         16  AM-AREA-CODE                  PIC 999.
  3819         16  AM-TEL-PRE                    PIC 999.
  3820         16  AM-TEL-NBR                    PIC 9(4).
  3821     12  AM-TEL-LOC                        PIC X.
  3822         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3823         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3824
  3825     12  AM-COMM-STRUCTURE.
  3826         16  AM-DEFN-1.
  3827             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3828                 24  AM-AGT.
  3829                     28  AM-AGT-PREFIX     PIC X(4).
  3830                     28  AM-AGT-PRIME      PIC X(6).
  3831                 24  AM-COM-TYP            PIC X.
  3832                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3833                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3834                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3835                 24  AM-RECALC-LV-INDIC    PIC X.
  3836                 24  AM-RETRO-LV-INDIC     PIC X.
  3837                 24  AM-GL-CODES           PIC X.
  3838                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3839                 24  FILLER                PIC X(01).
  3840         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3841             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3842                 24  FILLER                PIC X(11).
  3843                 24  AM-L-COMA             PIC XXX.
  3844                 24  AM-J-COMA             PIC XXX.
  3845                 24  AM-A-COMA             PIC XXX.
  3846                 24  FILLER                PIC X(6).
  3847
  3848     12  AM-COMM-CHANGE-STATUS             PIC X.
  3849         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3850
  3851     12  AM-CSR-CODE                       PIC X(4).
  3852
  3853     12  AM-BILLING-STATUS                 PIC X.
  3854         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3855         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3856     12  AM-AUTO-REFUND-SW                 PIC X.
  3857         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3858         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3859     12  AM-GPCD                           PIC 99.
  3860     12  AM-IG                             PIC X.
  3861         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3862         88  AM-HAS-GROUP                     VALUE '2'.
  3863     12  AM-STATUS                         PIC X.
  3864         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3865         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3866         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3867         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3868         88  AM-ACCOUNT-FROZEN                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  72
* EL1278.cbl
  3869     12  AM-REMIT-TO                       PIC 99.
  3870     12  AM-ID-NO                          PIC X(11).
  3871
  3872     12  AM-CAL-TABLE                      PIC XX.
  3873     12  AM-LF-DEVIATION                   PIC XXX.
  3874     12  AM-AH-DEVIATION                   PIC XXX.
  3875     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3876     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3877     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3878     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3879     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3880     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3881
  3882     12  AM-USER-FIELDS.
  3883         16  AM-FLD-1                      PIC XX.
  3884         16  AM-FLD-2                      PIC XX.
  3885         16  AM-FLD-3                      PIC XX.
  3886         16  AM-FLD-4                      PIC XX.
  3887         16  AM-FLD-5                      PIC XX.
  3888
  3889     12  AM-1ST-PROD-DATE.
  3890         16  AM-1ST-PROD-YR                PIC XX.
  3891         16  AM-1ST-PROD-MO                PIC XX.
  3892         16  AM-1ST-PROD-DA                PIC XX.
  3893     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3894     12  AM-CERTS-PURGED-DATE.
  3895         16  AM-PUR-YR                     PIC XX.
  3896         16  AM-PUR-MO                     PIC XX.
  3897         16  AM-PUR-DA                     PIC XX.
  3898     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3899     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3900     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3901     12  AM-INACTIVE-DATE.
  3902         16  AM-INA-MO                     PIC 99.
  3903         16  AM-INA-DA                     PIC 99.
  3904         16  AM-INA-YR                     PIC 99.
  3905     12  AM-AR-HI-CERT-DATE                PIC XX.
  3906
  3907     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3908     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3909
  3910     12  AM-OB-PAYMENT-MODE                PIC X.
  3911         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3912         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3913         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3914         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3915
  3916     12  AM-AH-ONLY-INDICATOR              PIC X.
  3917         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3918         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3919
  3920     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3921
  3922     12  AM-OVER-SHORT.
  3923         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3924         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3925
  3926     12  AM-DCC-PRODUCT-CODE               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  73
* EL1278.cbl
  3927     12  AM-DCC-CLP-STATE                  PIC XX.
  3928
  3929     12  AM-RECALC-COMM                    PIC X.
  3930     12  AM-RECALC-REIN                    PIC X.
  3931
  3932     12  AM-REI-TABLE                      PIC XXX.
  3933     12  AM-REI-ET-LF                      PIC X.
  3934     12  AM-REI-ET-AH                      PIC X.
  3935     12  AM-REI-PE-LF                      PIC X.
  3936     12  AM-REI-PE-AH                      PIC X.
  3937     12  AM-REI-PRT-ST                     PIC X.
  3938     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3939     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3940     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3941     12  AM-REI-GROUP-A                    PIC X(6).
  3942     12  AM-REI-MORT                       PIC X(4).
  3943     12  AM-REI-PRT-OW                     PIC X.
  3944     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3945     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3946     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3947     12  AM-REI-GROUP-B                    PIC X(6).
  3948
  3949     12  AM-TRUST-TYPE                     PIC X(2).
  3950
  3951     12  AM-EMPLOYER-STMT-USED             PIC X.
  3952     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3953
  3954     12  AM-STD-AH-TYPE                    PIC XX.
  3955     12  AM-EARN-METHODS.
  3956         16  AM-EARN-METHOD-R              PIC X.
  3957             88 AM-REF-RL-R78                 VALUE 'R'.
  3958             88 AM-REF-RL-PR                  VALUE 'P'.
  3959             88 AM-REF-RL-MEAN                VALUE 'M'.
  3960             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3961         16  AM-EARN-METHOD-L              PIC X.
  3962             88 AM-REF-LL-R78                 VALUE 'R'.
  3963             88 AM-REF-LL-PR                  VALUE 'P'.
  3964             88 AM-REF-LL-MEAN                VALUE 'M'.
  3965             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3966         16  AM-EARN-METHOD-A              PIC X.
  3967             88 AM-REF-AH-R78                 VALUE 'R'.
  3968             88 AM-REF-AH-PR                  VALUE 'P'.
  3969             88 AM-REF-AH-MEAN                VALUE 'M'.
  3970             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3971             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3972             88 AM-REF-AH-NET                 VALUE 'N'.
  3973
  3974     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3975     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3976     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3977
  3978     12  AM-RET-Y-N                        PIC X.
  3979     12  AM-RET-P-E                        PIC X.
  3980     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3981     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3982     12  AM-RET-GRP                        PIC X(6).
  3983     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3984         16  AM-POOL-PRIME                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  74
* EL1278.cbl
  3985         16  AM-POOL-SUB                   PIC XXX.
  3986     12  AM-RETRO-EARNINGS.
  3987         16  AM-RET-EARN-R                 PIC X.
  3988         16  AM-RET-EARN-L                 PIC X.
  3989         16  AM-RET-EARN-A                 PIC X.
  3990     12  AM-RET-ST-TAX-USE                 PIC X.
  3991         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3992         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3993     12  AM-RETRO-BEG-EARNINGS.
  3994         16  AM-RET-BEG-EARN-R             PIC X.
  3995         16  AM-RET-BEG-EARN-L             PIC X.
  3996         16  AM-RET-BEG-EARN-A             PIC X.
  3997     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3998     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3999
  4000     12  AM-USER-SELECT-OPTIONS.
  4001         16  AM-USER-SELECT-1              PIC X(10).
  4002         16  AM-USER-SELECT-2              PIC X(10).
  4003         16  AM-USER-SELECT-3              PIC X(10).
  4004         16  AM-USER-SELECT-4              PIC X(10).
  4005         16  AM-USER-SELECT-5              PIC X(10).
  4006
  4007     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4008
  4009     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4010
  4011     12  AM-RPT045A-SWITCH                 PIC X.
  4012         88  RPT045A-OFF                   VALUE 'N'.
  4013
  4014     12  AM-INSURANCE-LIMITS.
  4015         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4016         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4017
  4018     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4019         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4020
  4021     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4022         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4023         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4024
  4025     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4026
  4027     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4028     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4029     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4030     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4031     12  FILLER                            PIC X(5).
  4032     12  AM-REPORT-CODE-3                  PIC X(10).
  4033*    12  FILLER                            PIC X(22).
  4034
  4035     12  AM-RESERVE-DATE.
  4036         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4037         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4038         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4039
  4040     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4041     12  AM-NOTIFICATION-TYPES.
  4042         16  AM-NOTIF-OF-LETTERS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  75
* EL1278.cbl
  4043         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4044         16  AM-NOTIF-OF-REPORTS           PIC X.
  4045         16  AM-NOTIF-OF-STATUS            PIC X.
  4046
  4047     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4048         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4049         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4050         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4051         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4052
  4053     12  AM-BENEFIT-CONTROLS.
  4054         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4055             20  AM-BENEFIT-CODE           PIC XX.
  4056             20  AM-BENEFIT-TYPE           PIC X.
  4057             20  AM-BENEFIT-REVISION       PIC XXX.
  4058             20  AM-BENEFIT-REM-TERM       PIC X.
  4059             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4060             20  FILLER                    PIC XX.
  4061         16  FILLER                        PIC X(80).
  4062
  4063     12  AM-TRANSFER-DATA.
  4064         16  AM-TRANSFERRED-FROM.
  4065             20  AM-TRNFROM-CARRIER        PIC X.
  4066             20  AM-TRNFROM-GROUPING.
  4067                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4068                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4069             20  AM-TRNFROM-STATE          PIC XX.
  4070             20  AM-TRNFROM-ACCOUNT.
  4071                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4072                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4073             20  AM-TRNFROM-DTE            PIC XX.
  4074         16  AM-TRANSFERRED-TO.
  4075             20  AM-TRNTO-CARRIER          PIC X.
  4076             20  AM-TRNTO-GROUPING.
  4077                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4078                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4079             20  AM-TRNTO-STATE            PIC XX.
  4080             20  AM-TRNTO-ACCOUNT.
  4081                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4082                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4083             20  AM-TRNTO-DTE              PIC XX.
  4084         16  FILLER                        PIC X(10).
  4085
  4086     12  AM-SAVED-REMIT-TO                 PIC 99.
  4087
  4088     12  AM-COMM-STRUCTURE-SAVED.
  4089         16  AM-DEFN-1-SAVED.
  4090             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4091                 24  AM-AGT-SV             PIC X(10).
  4092                 24  AM-COM-TYP-SV         PIC X.
  4093                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4094                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4095                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4096                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4097                 24  FILLER                PIC X.
  4098                 24  AM-GL-CODES-SV        PIC X.
  4099                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4100                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  76
* EL1278.cbl
  4101         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4102             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4103                 24  FILLER                PIC X(11).
  4104                 24  AM-L-COMA-SV          PIC XXX.
  4105                 24  AM-J-COMA-SV          PIC XXX.
  4106                 24  AM-A-COMA-SV          PIC XXX.
  4107                 24  FILLER                PIC X(6).
  4108
  4109     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4110         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4111            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4112            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4113            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4114
  4115     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4116     12  FILLER                            PIC X(120).
  4117
  4118     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4119         16  AM-CONTROL-NAME               PIC X(30).
  4120         16  AM-EXECUTIVE-ONE.
  4121             20  AM-EXEC1-NAME             PIC X(15).
  4122             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4123                                                          COMP-3.
  4124             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4125                                                          COMP-3.
  4126         16  AM-EXECUTIVE-TWO.
  4127             20  AM-EXEC2-NAME             PIC X(15).
  4128             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4129                                                          COMP-3.
  4130             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4131                                                          COMP-3.
  4132
  4133     12  AM-RETRO-ADDITIONAL-DATA.
  4134         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4135         16  AM-RETRO-PREM-P-E             PIC X.
  4136         16  AM-RETRO-CLMS-P-I             PIC X.
  4137         16  AM-RETRO-RET-BRACKET-LF.
  4138             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4139                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4140                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4141             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4142                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4143                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4144             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4145                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4146                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4147         16  AM-RETRO-RET-BRACKET-AH.
  4148             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4149                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4150                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4151                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4152             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4153                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4154                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4155             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4156                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4157                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4158
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  77
* EL1278.cbl
  4159     12  AM-COMMENTS.
  4160         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4161
  4162     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4163         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4164         16  AM-FLI-BILLING-CODE           PIC X.
  4165         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4166         16  AM-FLI-UNITED-IDENT           PIC X.
  4167         16  AM-FLI-INTEREST-LOST-DATA.
  4168             20  AM-FLI-BANK-NO            PIC X(5).
  4169             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4170             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4171             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4172         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4173             20  AM-FLI-AGT                PIC X(9).
  4174             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4175             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4176         16  FILLER                        PIC X(102).
  4177
  4178     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4179         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4180             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4181             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4182             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4183             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4184             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4185         16  FILLER                          PIC X(10).
  4186******************************************************************
  4187*                            COPY ELCCERT.
  4188******************************************************************
  4189*                                                                *
  4190*                            ELCCERT.                            *
  4191*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4192*                            VMOD=2.013                          *
  4193*                                                                *
  4194*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4195*                                                                *
  4196*   FILE TYPE = VSAM,KSDS                                        *
  4197*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4198*                                                                *
  4199*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4200*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4201*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4202*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4203*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4204*                                                                *
  4205*   LOG = YES                                                    *
  4206*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4207******************************************************************
  4208*                   C H A N G E   L O G
  4209*
  4210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4211*-----------------------------------------------------------------
  4212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4213* EFFECTIVE    NUMBER
  4214*-----------------------------------------------------------------
  4215* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4216* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  78
* EL1278.cbl
  4217* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4218* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4219* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4220* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4221* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4222******************************************************************
  4223
  4224 01  CERTIFICATE-MASTER.
  4225     12  CM-RECORD-ID                      PIC XX.
  4226         88  VALID-CM-ID                      VALUE 'CM'.
  4227
  4228     12  CM-CONTROL-PRIMARY.
  4229         16  CM-COMPANY-CD                 PIC X.
  4230         16  CM-CARRIER                    PIC X.
  4231         16  CM-GROUPING.
  4232             20  CM-GROUPING-PREFIX        PIC X(3).
  4233             20  CM-GROUPING-PRIME         PIC X(3).
  4234         16  CM-STATE                      PIC XX.
  4235         16  CM-ACCOUNT.
  4236             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4237             20  CM-ACCOUNT-PRIME          PIC X(6).
  4238         16  CM-CERT-EFF-DT                PIC XX.
  4239         16  CM-CERT-NO.
  4240             20  CM-CERT-PRIME             PIC X(10).
  4241             20  CM-CERT-SFX               PIC X.
  4242
  4243     12  CM-CONTROL-BY-NAME.
  4244         16  CM-COMPANY-CD-A1              PIC X.
  4245         16  CM-INSURED-LAST-NAME          PIC X(15).
  4246         16  CM-INSURED-INITIALS.
  4247             20  CM-INSURED-INITIAL1       PIC X.
  4248             20  CM-INSURED-INITIAL2       PIC X.
  4249
  4250     12  CM-CONTROL-BY-SSN.
  4251         16  CM-COMPANY-CD-A2              PIC X.
  4252         16  CM-SOC-SEC-NO.
  4253             20  CM-SSN-STATE              PIC XX.
  4254             20  CM-SSN-ACCOUNT            PIC X(6).
  4255             20  CM-SSN-LN3.
  4256                 25  CM-INSURED-INITIALS-A2.
  4257                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4258                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4259                 25 CM-PART-LAST-NAME-A2         PIC X.
  4260
  4261     12  CM-CONTROL-BY-CERT-NO.
  4262         16  CM-COMPANY-CD-A4              PIC X.
  4263         16  CM-CERT-NO-A4                 PIC X(11).
  4264
  4265     12  CM-CONTROL-BY-MEMB.
  4266         16  CM-COMPANY-CD-A5              PIC X.
  4267         16  CM-MEMBER-NO.
  4268             20  CM-MEMB-STATE             PIC XX.
  4269             20  CM-MEMB-ACCOUNT           PIC X(6).
  4270             20  CM-MEMB-LN4.
  4271                 25  CM-INSURED-INITIALS-A5.
  4272                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4273                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4274                 25 CM-PART-LAST-NAME-A5         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  79
* EL1278.cbl
  4275
  4276     12  CM-INSURED-PROFILE-DATA.
  4277         16  CM-INSURED-FIRST-NAME.
  4278             20  CM-INSURED-1ST-INIT       PIC X.
  4279             20  FILLER                    PIC X(9).
  4280         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4281         16  CM-INSURED-SEX                PIC X.
  4282             88  CM-SEX-MALE                  VALUE 'M'.
  4283             88  CM-SEX-FEMAL                 VALUE 'F'.
  4284         16  CM-INSURED-JOINT-AGE          PIC 99.
  4285         16  CM-JOINT-INSURED-NAME.
  4286             20  CM-JT-LAST-NAME           PIC X(15).
  4287             20  CM-JT-FIRST-NAME.
  4288                 24  CM-JT-1ST-INIT        PIC X.
  4289                 24  FILLER                PIC X(9).
  4290             20  CM-JT-INITIAL             PIC X.
  4291
  4292     12  CM-LIFE-DATA.
  4293         16  CM-LF-BENEFIT-CD              PIC XX.
  4294         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4295         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4296         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4297         16  CM-LF-DEV-CODE                PIC XXX.
  4298         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4299         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4300         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4301         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4302         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4303         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4304         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4305         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4306         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4307         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4308         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4309         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4310         16  FILLER                        PIC XX.
  4311
  4312     12  CM-AH-DATA.
  4313         16  CM-AH-BENEFIT-CD              PIC XX.
  4314         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4315         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4316         16  CM-AH-DEV-CODE                PIC XXX.
  4317         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4318         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4319         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4320         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4321         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4322         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4323         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4324         16  CM-AH-PAID-THRU-DT            PIC XX.
  4325             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4326         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4327         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4328         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4329         16  FILLER                        PIC X.
  4330
  4331     12  CM-LOAN-INFORMATION.
  4332         16  CM-LIVES                      PIC S9(7)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  80
* EL1278.cbl
  4333         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4334         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4335         16  CM-PAY-FREQUENCY              PIC S99.
  4336         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4337         16  CM-RATE-CLASS                 PIC XX.
  4338         16  CM-BENEFICIARY                PIC X(25).
  4339         16  CM-POLICY-FORM-NO             PIC X(12).
  4340         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4341         16  CM-LAST-ADD-ON-DT             PIC XX.
  4342         16  CM-DEDUCTIBLE-AMOUNTS.
  4343             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4344             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4345         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4346             20  CM-RESIDENT-STATE         PIC XX.
  4347             20  CM-RATE-CODE              PIC X(4).
  4348             20  FILLER                    PIC XX.
  4349         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4350             20  CM-LOAN-OFFICER           PIC X(5).
  4351             20  FILLER                    PIC XXX.
  4352         16  CM-CSR-CODE                   PIC XXX.
  4353         16  CM-UNDERWRITING-CODE          PIC X.
  4354             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4355         16  CM-POST-CARD-IND              PIC X.
  4356         16  CM-NH-INTERFACE-SW            PIC X.
  4357         16  CM-PREMIUM-TYPE               PIC X.
  4358             88  CM-SING-PRM                  VALUE '1'.
  4359             88  CM-O-B-COVERAGE              VALUE '2'.
  4360             88  CM-OPEN-END                  VALUE '3'.
  4361         16  CM-IND-GRP-TYPE               PIC X.
  4362             88  CM-INDIVIDUAL                VALUE 'I'.
  4363             88  CM-GROUP                     VALUE 'G'.
  4364         16  CM-SKIP-CODE                  PIC X.
  4365             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4366             88  SKIP-JULY                    VALUE '1'.
  4367             88  SKIP-AUGUST                  VALUE '2'.
  4368             88  SKIP-SEPTEMBER               VALUE '3'.
  4369             88  SKIP-JULY-AUG                VALUE '4'.
  4370             88  SKIP-AUG-SEPT                VALUE '5'.
  4371             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4372             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4373             88  SKIP-JUNE                    VALUE '8'.
  4374             88  SKIP-JUNE-JULY               VALUE '9'.
  4375             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4376             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4377         16  CM-PAYMENT-MODE               PIC X.
  4378             88  PAY-MONTHLY                  VALUE SPACE.
  4379             88  PAY-WEEKLY                   VALUE '1'.
  4380             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4381             88  PAY-BI-WEEKLY                VALUE '3'.
  4382             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4383         16  CM-LOAN-NUMBER                PIC X(8).
  4384         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4385         16  CM-OLD-LOF                    PIC XXX.
  4386*        16  CM-LOAN-OFFICER               PIC XXX.
  4387         16  CM-REIN-TABLE                 PIC XXX.
  4388         16  CM-SPECIAL-REIN-CODE          PIC X.
  4389         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4390         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  81
* EL1278.cbl
  4391         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4392
  4393     12  CM-STATUS-DATA.
  4394         16  CM-ENTRY-STATUS               PIC X.
  4395         16  CM-ENTRY-DT                   PIC XX.
  4396
  4397         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4398         16  CM-LF-CANCEL-DT               PIC XX.
  4399         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4400
  4401         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4402         16  CM-LF-DEATH-DT                PIC XX.
  4403         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4404
  4405         16  CM-LF-CURRENT-STATUS          PIC X.
  4406             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4407                                                'M' '4' '5' '9'.
  4408             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4409             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4410             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4411             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4412             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4413             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4414             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4415             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4416             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4417             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4418             88  CM-LF-DECLINED               VALUE 'D'.
  4419             88  CM-LF-VOIDED                 VALUE 'V'.
  4420
  4421         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4422         16  CM-AH-CANCEL-DT               PIC XX.
  4423         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4424
  4425         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4426         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4427         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4428
  4429         16  CM-AH-CURRENT-STATUS          PIC X.
  4430             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4431                                                'M' '4' '5' '9'.
  4432             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4433             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4434             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4435             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4436             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4437             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4438             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4439             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4440             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4441             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4442             88  CM-AH-DECLINED               VALUE 'D'.
  4443             88  CM-AH-VOIDED                 VALUE 'V'.
  4444
  4445         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4446             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4447             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4448             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  82
* EL1278.cbl
  4449         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4450
  4451         16  CM-ENTRY-BATCH                PIC X(6).
  4452         16  CM-LF-EXIT-BATCH              PIC X(6).
  4453         16  CM-AH-EXIT-BATCH              PIC X(6).
  4454         16  CM-LAST-MONTH-END             PIC XX.
  4455
  4456     12  CM-NOTE-SW                        PIC X.
  4457         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4458         88  CERT-NOTES-PRESENT               VALUE '1'.
  4459         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4460         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4461         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4462         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4463         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4464         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4465     12  CM-COMP-EXCP-SW                   PIC X.
  4466         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4467         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4468     12  CM-INSURED-ADDRESS-SW             PIC X.
  4469         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4470         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4471
  4472*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4473     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4474     12  FILLER                            PIC X.
  4475
  4476*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4477     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4478     12  FILLER                            PIC X.
  4479*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4480     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4481
  4482     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4483         88  CERT-ADDED-BATCH                 VALUE ' '.
  4484         88  CERT-ADDED-ONLINE                VALUE '1'.
  4485         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4486         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4487         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4488     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4489         88  CERT-AS-LOADED                   VALUE ' '.
  4490         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4491         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4492         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4493         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4494         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4495         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4496         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4497
  4498     12  CM-ACCOUNT-COMM-PCTS.
  4499         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4500         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4501
  4502     12  CM-USER-FIELD                     PIC X.
  4503     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4504     12  CM-CLP-STATE                      PIC XX.
  4505     12  CM-USER-RESERVED                  PIC XXX.
  4506******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  83
* EL1278.cbl
  4507*                            COPY ERCMAIL.
  4508******************************************************************
  4509*                                                                *
  4510*                                                                *
  4511*                            ERCMAIL                             *
  4512*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4513*                            VMOD=2.003                          *
  4514*                                                                *
  4515*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  4516*                                                                *
  4517*   FILE TYPE = VSAM,KSDS                                        *
  4518*   RECORD SIZE = 374   RECFORM = FIX                            *
  4519*                                                                *
  4520*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  4521*   ALTERNATE PATH    = NOT USED                                 *
  4522*                                                                *
  4523*   LOG = YES                                                    *
  4524*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4525******************************************************************
  4526*                   C H A N G E   L O G
  4527*
  4528* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4529*-----------------------------------------------------------------
  4530*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4531* EFFECTIVE    NUMBER
  4532*-----------------------------------------------------------------
  4533* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4534* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4535* 111108                   PEMA  ADD CRED BENE ADDR2
  4536******************************************************************
  4537
  4538 01  MAILING-DATA.
  4539     12  MA-RECORD-ID                      PIC XX.
  4540         88  VALID-MA-ID                       VALUE 'MA'.
  4541
  4542     12  MA-CONTROL-PRIMARY.
  4543         16  MA-COMPANY-CD                 PIC X.
  4544         16  MA-CARRIER                    PIC X.
  4545         16  MA-GROUPING.
  4546             20  MA-GROUPING-PREFIX        PIC XXX.
  4547             20  MA-GROUPING-PRIME         PIC XXX.
  4548         16  MA-STATE                      PIC XX.
  4549         16  MA-ACCOUNT.
  4550             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4551             20  MA-ACCOUNT-PRIME          PIC X(6).
  4552         16  MA-CERT-EFF-DT                PIC XX.
  4553         16  MA-CERT-NO.
  4554             20  MA-CERT-PRIME             PIC X(10).
  4555             20  MA-CERT-SFX               PIC X.
  4556
  4557     12  FILLER                            PIC XX.
  4558
  4559     12  MA-ACCESS-CONTROL.
  4560         16  MA-SOURCE-SYSTEM              PIC XX.
  4561             88  MA-FROM-CREDIT                VALUE 'CR'.
  4562             88  MA-FROM-VSI                   VALUE 'VS'.
  4563             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4564             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  84
* EL1278.cbl
  4565         16  MA-RECORD-ADD-DT              PIC XX.
  4566         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4567         16  MA-LAST-MAINT-DT              PIC XX.
  4568         16  MA-LAST-MAINT-BY              PIC XXXX.
  4569         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4570
  4571     12  MA-PROFILE-INFO.
  4572         16  MA-QUALIFY-CODE-1             PIC XX.
  4573         16  MA-QUALIFY-CODE-2             PIC XX.
  4574         16  MA-QUALIFY-CODE-3             PIC XX.
  4575         16  MA-QUALIFY-CODE-4             PIC XX.
  4576         16  MA-QUALIFY-CODE-5             PIC XX.
  4577
  4578         16  MA-INSURED-LAST-NAME          PIC X(15).
  4579         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4580         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4581         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4582         16  MA-INSURED-BIRTH-DT           PIC XX.
  4583         16  MA-INSURED-SEX                PIC X.
  4584             88  MA-SEX-MALE                   VALUE 'M'.
  4585             88  MA-SEX-FEMALE                 VALUE 'F'.
  4586         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4587
  4588         16  MA-ADDRESS-CORRECTED          PIC X.
  4589         16  MA-JOINT-BIRTH-DT             PIC XX.
  4590*        16  FILLER                        PIC X(12).
  4591
  4592         16  MA-ADDRESS-LINE-1             PIC X(30).
  4593         16  MA-ADDRESS-LINE-2             PIC X(30).
  4594         16  MA-CITY-STATE.
  4595             20  MA-CITY                   PIC X(28).
  4596             20  MA-ADDR-STATE             PIC XX.
  4597         16  MA-ZIP.
  4598             20  MA-ZIP-CODE.
  4599                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4600                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4601                 24  FILLER                PIC X(4).
  4602             20  MA-ZIP-PLUS4              PIC X(4).
  4603         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4604             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4605             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4606             20  FILLER                    PIC X(3).
  4607
  4608         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4609
  4610         16  FILLER                        PIC XXX.
  4611*        16  FILLER                        PIC X(10).
  4612
  4613     12  MA-CRED-BENE-INFO.
  4614         16  MA-CRED-BENE-NAME                 PIC X(25).
  4615         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4616         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4617         16  MA-CRED-BENE-CTYST.
  4618             20  MA-CRED-BENE-CITY             PIC X(28).
  4619             20  MA-CRED-BENE-STATE            PIC XX.
  4620         16  MA-CRED-BENE-ZIP.
  4621             20  MA-CB-ZIP-CODE.
  4622                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  85
* EL1278.cbl
  4623                     88  MA-CB-CANADIAN-POST-CODE
  4624                                           VALUE 'A' THRU 'Z'.
  4625                 24  FILLER                    PIC X(4).
  4626             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4627         16  MA-CB-CANADIAN-POSTAL-CODE
  4628                            REDEFINES MA-CRED-BENE-ZIP.
  4629             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4630             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4631             20  FILLER                        PIC X(3).
  4632     12  MA-POST-CARD-MAIL-DATA.
  4633         16  MA-MAIL-DATA OCCURS 7.
  4634             20  MA-MAIL-TYPE              PIC X.
  4635                 88  MA-12MO-MAILING           VALUE '1'.
  4636                 88  MA-EXP-MAILING            VALUE '2'.
  4637             20  MA-MAIL-STATUS            PIC X.
  4638                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4639                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4640                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4641             20  MA-MAIL-DATE              PIC XX.
  4642     12  FILLER                            PIC XX.
  4643     12  FILLER                            PIC XX.
  4644*    12  FILLER                            PIC X(30).
  4645******************************************************************
  4646*                            COPY ERCFORM.
  4647******************************************************************
  4648*                                                                *
  4649*                                                                *
  4650*                            ERCFORM.                            *
  4651*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4652*                            VMOD=2.003                          *
  4653*                                                                *
  4654*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  4655*                                                                *
  4656*    FILE TYPE = VSAM,KSDS                                       *
  4657*    RECORD SIZE = 500  RECFORM = FIXED                          *
  4658*                                                                *
  4659*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  4660*                                                                *
  4661*    LOG = YES                                                   *
  4662*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4663******************************************************************
  4664 01  FORM-MASTER.
  4665    12  FO-RECORD-ID                 PIC X(02).
  4666        88  VALID-FO-ID                  VALUE 'FO'.
  4667
  4668    12  FO-CONTROL-PRIMARY.
  4669        16  FO-COMPANY-CD            PIC X(01).
  4670        16  FO-STATE                 PIC X(02).
  4671        16  FO-FORM-ID               PIC X(12).
  4672        16  FO-FORM-EXP-DT           PIC X(02).
  4673
  4674    12  FO-POLICY-FORM-DATA.
  4675        16  FO-IND-GRP-CD            PIC X(01).
  4676        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  4677        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  4678        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  4679        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  4680        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  86
* EL1278.cbl
  4681        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  4682        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  4683        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  4684        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  4685        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  4686        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  4687        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  4688        16  FO-DIS-DEF-TYPE          PIC 9(02).
  4689        16  FO-DISMEMBERMENT-CD      PIC X(01).
  4690        16  FO-APP-CERT-USE-CD       PIC X(01).
  4691
  4692    12  FILLER                       PIC X(29).
  4693
  4694    12  FO-FORM-PLAN-TABLE.
  4695        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  4696            20  FO-PLAN-TYPE         PIC X(01).
  4697            20  FO-PLAN-ID           PIC X(02).
  4698            20  FO-PLAN-TERM         PIC 9(03).
  4699            20  FO-PLAN-REFUND-METHOD
  4700                                     PIC X.
  4701
  4702    12  FILLER                       PIC X(30).
  4703
  4704    12  FO-COMMENTS-AREA.
  4705        16  FO-COMMENT-LINE-1        PIC X(78).
  4706
  4707    12  FILLER                       PIC X(20).
  4708
  4709    12  FO-MAINT-INFORMATION.
  4710        16  FO-LAST-MAINT-DT         PIC X(02).
  4711        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  4712        16  FO-LAST-MAINT-BY         PIC X(04).
  4713*                            COPY ELCMSTR.
  4714******************************************************************
  4715*                                                                *
  4716*                            ELCMSTR.                            *
  4717*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4718*                            VMOD=2.012                          *
  4719*                                                                *
  4720*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  4721*                                                                *
  4722*   FILE TYPE = VSAM,KSDS                                        *
  4723*   RECORD SIZE = 350  RECFORM = FIXED                           *
  4724*                                                                *
  4725*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  4726*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  4727*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  4728*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  4729*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  4730*                                                 RKP=75,LEN=21  *
  4731*                                                                *
  4732*   **** NOTE ****                                               *
  4733*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  4734*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  4735*                                                                *
  4736*   LOG = YES                                                    *
  4737*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4738******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  87
* EL1278.cbl
  4739*                   C H A N G E   L O G
  4740*
  4741* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4742*-----------------------------------------------------------------
  4743*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4744* EFFECTIVE    NUMBER
  4745*-----------------------------------------------------------------
  4746* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4747* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  4748******************************************************************
  4749 01  CLAIM-MASTER.
  4750     12  CL-RECORD-ID                PIC XX.
  4751         88  VALID-CL-ID         VALUE 'CL'.
  4752
  4753     12  CL-CONTROL-PRIMARY.
  4754         16  CL-COMPANY-CD           PIC X.
  4755         16  CL-CARRIER              PIC X.
  4756         16  CL-CLAIM-NO             PIC X(7).
  4757         16  CL-CERT-NO.
  4758             20  CL-CERT-PRIME       PIC X(10).
  4759             20  CL-CERT-SFX         PIC X.
  4760
  4761     12  CL-CONTROL-BY-NAME.
  4762         16  CL-COMPANY-CD-A1        PIC X.
  4763         16  CL-INSURED-LAST-NAME    PIC X(15).
  4764         16  CL-INSURED-NAME.
  4765             20  CL-INSURED-1ST-NAME PIC X(12).
  4766             20  CL-INSURED-MID-INIT PIC X.
  4767
  4768     12  CL-CONTROL-BY-SSN.
  4769         16  CL-COMPANY-CD-A2        PIC X.
  4770         16  CL-SOC-SEC-NO.
  4771             20  CL-SSN-STATE        PIC XX.
  4772             20  CL-SSN-ACCOUNT      PIC X(6).
  4773             20  CL-SSN-LN3          PIC X(3).
  4774
  4775     12  CL-CONTROL-BY-CERT-NO.
  4776         16  CL-COMPANY-CD-A4        PIC X.
  4777         16  CL-CERT-NO-A4.
  4778             20  CL-CERT-A4-PRIME    PIC X(10).
  4779             20  CL-CERT-A4-SFX      PIC X.
  4780
  4781     12  CL-CONTROL-BY-CCN.
  4782         16  CL-COMPANY-CD-A5        PIC X.
  4783         16  CL-CCN-A5.
  4784             20  CL-CCN.
  4785                 24  CL-CCN-PREFIX-A5 PIC X(4).
  4786                 24  CL-CCN-PRIME-A5 PIC X(12).
  4787             20  CL-CCN-FILLER-A5    PIC X(4).
  4788
  4789     12  CL-INSURED-PROFILE-DATA.
  4790         16  CL-INSURED-BIRTH-DT     PIC XX.
  4791         16  CL-INSURED-SEX-CD       PIC X.
  4792             88  INSURED-IS-MALE        VALUE 'M'.
  4793             88  INSURED-IS-FEMALE      VALUE 'F'.
  4794             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  4795         16  CL-INSURED-OCC-CD       PIC X(6).
  4796         16  FILLER                  PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  88
* EL1278.cbl
  4797
  4798     12  CL-PROCESSING-INFO.
  4799         16  CL-PROCESSOR-ID         PIC X(4).
  4800         16  CL-CLAIM-STATUS         PIC X.
  4801             88  CLAIM-IS-OPEN          VALUE 'O'.
  4802             88  CLAIM-IS-CLOSED        VALUE 'C'.
  4803         16  CL-CLAIM-TYPE           PIC X.
  4804*            88  AH-CLAIM               VALUE 'A'.
  4805*            88  LIFE-CLAIM             VALUE 'L'.
  4806*            88  PROPERTY-CLAIM         VALUE 'P'.
  4807*            88  IUI-CLAIM              VALUE 'I'.
  4808*            88  GAP-CLAIM              VALUE 'G'.
  4809         16  CL-CLAIM-PREM-TYPE      PIC X.
  4810             88  SINGLE-PREMIUM         VALUE '1'.
  4811             88  O-B-COVERAGE           VALUE '2'.
  4812             88  OPEN-END-COVERAGE      VALUE '3'.
  4813         16  CL-INCURRED-DT          PIC XX.
  4814         16  CL-REPORTED-DT          PIC XX.
  4815         16  CL-FILE-ESTABLISH-DT    PIC XX.
  4816         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  4817         16  CL-LAST-PMT-DT          PIC XX.
  4818         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  4819         16  CL-PAID-THRU-DT         PIC XX.
  4820         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  4821         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  4822         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  4823         16  CL-PMT-CALC-METHOD      PIC X.
  4824             88  CL-360-DAY-YR          VALUE '1'.
  4825             88  CL-365-DAY-YR          VALUE '2'.
  4826             88  CL-FULL-MONTHS         VALUE '3'.
  4827         16  CL-CAUSE-CD             PIC X(6).
  4828
  4829         16  CL-PRIME-CERT-NO.
  4830             20  CL-PRIME-CERT-PRIME PIC X(10).
  4831             20  CL-PRIME-CERT-SFX   PIC X.
  4832
  4833         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  4834             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  4835             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  4836
  4837         16  CL-MICROFILM-NO         PIC X(10).
  4838         16  CL-PROG-FORM-TYPE       PIC X.
  4839         16  CL-LAST-ADD-ON-DT       PIC XX.
  4840
  4841         16  CL-LAST-REOPEN-DT       PIC XX.
  4842         16  CL-LAST-CLOSE-DT        PIC XX.
  4843         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4844             88  FINAL-PAID             VALUE '1'.
  4845             88  CLAIM-DENIED           VALUE '2'.
  4846             88  AUTO-CLOSE             VALUE '3'.
  4847             88  MANUAL-CLOSE           VALUE '4'.
  4848             88  BENEFITS-CHANGED       VALUE 'C'.
  4849             88  SETUP-ERRORS           VALUE 'E'.
  4850         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4851         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4852         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4853             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4854         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  89
* EL1278.cbl
  4855         16  FILLER                  PIC X.
  4856
  4857     12  CL-CERTIFICATE-DATA.
  4858         16  CL-CERT-ORIGIN          PIC X.
  4859             88  CERT-WAS-ONLINE        VALUE '1'.
  4860             88  CERT-WAS-CREATED       VALUE '2'.
  4861             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4862         16  CL-CERT-KEY-DATA.
  4863             20  CL-CERT-CARRIER     PIC X.
  4864             20  CL-CERT-GROUPING    PIC X(6).
  4865             20  CL-CERT-STATE       PIC XX.
  4866             20  CL-CERT-ACCOUNT.
  4867                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4868                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4869             20  CL-CERT-EFF-DT      PIC XX.
  4870
  4871     12  CL-STATUS-CONTROLS.
  4872         16  CL-PRIORITY-CD          PIC X.
  4873             88  CONFIDENTIAL-DATA      VALUE '8'.
  4874             88  HIGHEST-PRIORITY       VALUE '9'.
  4875         16  CL-SUPV-ATTN-CD         PIC X.
  4876             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4877             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4878         16  CL-PURGED-DT            PIC XX.
  4879         16  CL-RESTORED-DT          PIC XX.
  4880         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4881         16  CL-NEXT-RESEND-DT       PIC XX.
  4882         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4883         16  FILLER                  PIC XX.
  4884         16  CL-LAST-MAINT-DT        PIC XX.
  4885         16  CL-LAST-MAINT-USER      PIC X(4).
  4886         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4887         16  CL-LAST-MAINT-TYPE      PIC X.
  4888             88  CLAIM-SET-UP           VALUE ' '.
  4889             88  PAYMENT-MADE           VALUE '1'.
  4890             88  LETTER-SENT            VALUE '2'.
  4891             88  MASTER-WAS-ALTERED     VALUE '3'.
  4892             88  MASTER-WAS-RESTORED    VALUE '4'.
  4893             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4894             88  FILE-CONVERTED         VALUE '6'.
  4895             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4896             88  ERROR-CORRECTION       VALUE 'E'.
  4897         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4898         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4899         16  CL-BENEFICIARY          PIC X(10).
  4900         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4901         16  CL-DENIAL-TYPE          PIC X.
  4902             88  CL-TYPE-DENIAL          VALUE '1'.
  4903             88  CL-TYPE-RESCISSION      VALUE '2'.
  4904             88  CL-TYPE-REFORMATION     VALUE '3'.
  4905             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4906             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4907         16  FILLER                  PIC X(5).
  4908
  4909     12  CL-TRAILER-CONTROLS.
  4910         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4911             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4912             88  CL-LAST-TRL-AVAIL      VALUE +100.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  90
* EL1278.cbl
  4913             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4914         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4915         16  FILLER                  PIC XX.
  4916         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4917         16  CL-ADDRESS-TRAILER-CNT.
  4918             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4919                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4920             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4921                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4922             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4923                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4924             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4925                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4926             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4927                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4928             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4929                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4930             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4931                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4932
  4933     12  CL-CV-REFERENCE-NO.
  4934         16  CL-CV-REFNO-PRIME       PIC X(18).
  4935         16  CL-CV-REFNO-SFX         PIC XX.
  4936
  4937     12  CL-FILE-LOCATION            PIC X(4).
  4938
  4939     12  CL-PROCESS-ERRORS.
  4940         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4941             88  NO-FATAL-ERRORS        VALUE ZERO.
  4942         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4943             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4944
  4945     12  CL-PRODUCT-CD               PIC X.
  4946
  4947     12  CL-CURRENT-KEY-DATA.
  4948         16  CL-CURRENT-CARRIER      PIC X.
  4949         16  CL-CURRENT-GROUPING     PIC X(6).
  4950         16  CL-CURRENT-STATE        PIC XX.
  4951         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4952
  4953     12  CL-ASSOCIATES               PIC X.
  4954         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4955         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4956         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4957         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4958
  4959     12  CL-ACTIVITY-CODE            PIC 99.
  4960     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4961     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4962
  4963     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4964     12  CL-LAG-REPORT-CODE          PIC 9.
  4965     12  CL-LOAN-TYPE                PIC XX.
  4966     12  CL-LEGAL-STATE              PIC XX.
  4967
  4968*    12  FILLER                      PIC X(5).
  4969     12  CL-YESNOSW                  PIC X.
  4970     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  91
* EL1278.cbl
  4971 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  4972                          ACCOUNT-MASTER CERTIFICATE-MASTER
  4973                          MAILING-DATA FORM-MASTER CLAIM-MASTER.
  4974 0000-DFHEXIT SECTION.
  4975     MOVE '9#                    $   ' TO DFHEIV0.
  4976     MOVE 'EL1278' TO DFHEIV1.
  4977     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4978*    SERVICE RELOAD PARMLIST.
  4979
  4980     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4981     MOVE '5'                    TO  DC-OPTION-CODE.
  4982
  4983     PERFORM 9600-DATE-LINK.
  4984
  4985     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4986     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4987     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4988     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  4989     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  4990     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  4991     MOVE EIBTRMID               TO  QID-TERM.
  4992
  4993     IF EIBCALEN  IS EQUAL TO  ZERO
  4994         GO TO 8700-UNAUTHORIZED-ACCESS.
  4995
  4996     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  4997         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  4998             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4999             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5000             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5001             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5002             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5003             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5004             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5005             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5006         ELSE
  5007             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5008             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5009             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5010             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5011             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5012             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5013             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5014             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5015             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5016
  5017     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5018         GO TO 9300-CLEAR.
  5019
  5020     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5021         NEXT SENTENCE
  5022     ELSE
  5023
  5024* EXEC CICS READQ TS
  5025*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5026*            INTO    (SECURITY-CONTROL)
  5027*            LENGTH  (SC-COMM-LENGTH)
  5028*            ITEM    (SC-ITEM)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  92
* EL1278.cbl
  5029*        END-EXEC
  5030*    MOVE '*$II   L              ''   #00005019' TO DFHEIV0
  5031     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5032     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5033     MOVE X'2020233030303035303139' TO DFHEIV0(25:11)
  5034     CALL 'kxdfhei1' USING DFHEIV0,
  5035           PI-SECURITY-TEMP-STORE-ID,
  5036           SECURITY-CONTROL,
  5037           SC-COMM-LENGTH,
  5038           SC-ITEM,
  5039           DFHEIV99,
  5040           DFHEIV99
  5041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5042         MOVE SC-CREDIT-DISPLAY (33)
  5043                                 TO  PI-DISPLAY-CAP
  5044         MOVE SC-CREDIT-UPDATE  (33)
  5045                                 TO  PI-MODIFY-CAP
  5046         MOVE SC-CREDIT-UPDATE  (32)
  5047                                 TO  PI-MODIFY-CERT-CAP
  5048         IF NOT  DISPLAY-CAP
  5049             MOVE 'READ'         TO  SM-READ
  5050             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5051             MOVE ER-0070        TO  EMI-ERROR
  5052             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5053             GO TO 8100-SEND-INITIAL-MAP.
  5054
  5055     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5056         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5057         MOVE LOW-VALUES         TO  EL127HI
  5058         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5059                                     PI-LF-CANCEL-DATE
  5060                                     WS-AH-CANCEL-DATE
  5061                                     PI-AH-CANCEL-DATE
  5062         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5063                                     PI-LF-CANCEL-DATE-ED
  5064                                     WS-AH-CANCEL-DATE-ED
  5065                                     PI-AH-CANCEL-DATE-ED
  5066         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5067                                     PI-EARNING-METHOD-AH
  5068         PERFORM 0500-FORMAT-SCREEN
  5069         GO TO 8100-SEND-INITIAL-MAP.
  5070
  5071     IF NOT  MODIFY-CAP
  5072         MOVE 'UPDATE'           TO  SM-READ
  5073         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5074         MOVE ER-0070            TO  EMI-ERROR
  5075         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5076         GO TO 8100-SEND-INITIAL-MAP.
  5077
  5078
  5079* EXEC CICS HANDLE CONDITION
  5080*        PGMIDERR  (9500-PGMID-ERROR)
  5081*        ERROR     (9900-ABEND)
  5082*    END-EXEC.
  5083*    MOVE '"$L.                  ! " #00005061' TO DFHEIV0
  5084     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5086     MOVE X'2220233030303035303631' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  93
* EL1278.cbl
  5087     CALL 'kxdfhei1' USING DFHEIV0
  5088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5089
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  94
* EL1278.cbl
  5091 0200-RECEIVE.
  5092     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5093         MOVE ER-0008            TO  EMI-ERROR
  5094         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5095         MOVE -1                 TO  HLCANCL
  5096         GO TO 8200-SEND-DATAONLY.
  5097
  5098
  5099* EXEC CICS RECEIVE
  5100*        MAP     (MAP-NAME)
  5101*        MAPSET  (MAPSET-NAME)
  5102*        INTO    (EL127HI)
  5103*    END-EXEC.
  5104     MOVE LENGTH OF
  5105      EL127HI
  5106       TO DFHEIV11
  5107*    MOVE '8"T I  L              ''   #00005073' TO DFHEIV0
  5108     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5110     MOVE X'2020233030303035303733' TO DFHEIV0(25:11)
  5111     CALL 'kxdfhei1' USING DFHEIV0,
  5112           MAP-NAME,
  5113           EL127HI,
  5114           DFHEIV11,
  5115           MAPSET-NAME,
  5116           DFHEIV99,
  5117           DFHEIV99
  5118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5119
  5120
  5121     IF HPFKEYL  IS EQUAL TO  ZERO
  5122         GO TO 0300-CHECK-PFKEYS.
  5123
  5124     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  5125         MOVE ER-0004            TO  EMI-ERROR
  5126         GO TO 0320-INPUT-ERROR.
  5127
  5128     IF HPFKEYI NUMERIC
  5129         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  5130             MOVE PF-VALUES (HPFKEYI)
  5131                                 TO  EIBAID
  5132         ELSE
  5133             MOVE ER-0029        TO  EMI-ERROR
  5134             GO TO 0320-INPUT-ERROR.
  5135
  5136 0300-CHECK-PFKEYS.
  5137     IF EIBAID  IS EQUAL TO  DFHPF23
  5138         GO TO 8800-PF23.
  5139
  5140     IF EIBAID  IS EQUAL TO  DFHPF24
  5141         GO TO 9100-RETURN-MAIN-MENU.
  5142
  5143     IF EIBAID  IS EQUAL TO  DFHPF11 AND
  5144         PI-COMPANY-ID = 'NCL'
  5145         GO TO 1700-WRITE-CERT-NOTE.
  5146
  5147     IF EIBAID  IS EQUAL TO  DFHPF12
  5148         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  95
* EL1278.cbl
  5149
  5150     IF EIBAID  IS EQUAL TO  DFHENTER
  5151         GO TO 0400-EDIT-INPUT-DATA.
  5152
  5153     MOVE ER-0029                TO  EMI-ERROR.
  5154
  5155 0320-INPUT-ERROR.
  5156     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5157
  5158     MOVE AL-UNBON               TO  HPFKEYA.
  5159
  5160     IF HPFKEYL  IS EQUAL TO  ZERO
  5161         MOVE -1                 TO  HLCANCL
  5162     ELSE
  5163         MOVE -1                 TO  HPFKEYL.
  5164
  5165     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  96
* EL1278.cbl
  5167 0400-EDIT-INPUT-DATA.
  5168     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  5169                                     WS-NEW-LF-CANCEL-SW.
  5170
  5171     IF (HPCYNL > 0)
  5172        AND (HPCYNI = 'Y' OR 'N')
  5173        PERFORM 1800-READ-ELCERT-UPDATE
  5174                                 THRU 1800-EXIT
  5175        IF WS-RESP-NORMAL
  5176           MOVE HPCYNI           TO CM-POST-CARD-IND
  5177           PERFORM 1810-REWRITE-ELCERT
  5178                                 THRU 1810-EXIT
  5179        END-IF
  5180     END-IF
  5181     IF HLCAL1L GREATER ZERO
  5182         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  5183
  5184     IF HLCANCL  IS EQUAL TO  ZERO
  5185       AND HACANCL  IS EQUAL TO  ZERO
  5186         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5187         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5188         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5189         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5190         GO TO 0420-CHECK-ERRORS.
  5191
  5192     IF HLCANCL  IS EQUAL TO  ZERO
  5193         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5194         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5195         GO TO 0410-CHECK-AH-DATE.
  5196
  5197     MOVE AL-UNNON               TO  HLCANCA.
  5198     MOVE HLCANCI                TO  DEEDIT-FIELD.
  5199     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  5200
  5201     PERFORM 8600-DEEDIT.
  5202
  5203     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5204     MOVE '4'                    TO  DC-OPTION-CODE.
  5205
  5206     PERFORM 9600-DATE-LINK.
  5207
  5208     IF DATE-CONVERSION-ERROR
  5209         MOVE -1                 TO  HLCANCL
  5210         MOVE AL-UABON           TO  HLCANCA
  5211         MOVE ER-2227            TO  EMI-ERROR
  5212         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5213     ELSE
  5214        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5215           MOVE -1               TO  HACANCL
  5216           MOVE AL-UABON         TO  HACANCA
  5217           MOVE ER-2774          TO  EMI-ERROR
  5218           PERFORM 9700-ERROR-FORMAT
  5219                                 THRU  9799-EXIT
  5220        ELSE
  5221           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  5222                                    PI-LF-CANCEL-DATE
  5223           MOVE DC-GREG-DATE-1-EDIT
  5224                                 TO HLCANCO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  97
* EL1278.cbl
  5225                                    WS-LF-CANCEL-DATE-ED
  5226                                    PI-LF-CANCEL-DATE-ED
  5227        END-IF
  5228     END-IF
  5229     .
  5230 0410-CHECK-AH-DATE.
  5231     IF HACAL1L GREATER ZERO
  5232         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  5233
  5234     IF HACANCL  IS EQUAL TO  ZERO
  5235         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5236         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5237         GO TO 0420-CHECK-ERRORS.
  5238
  5239     MOVE AL-UNNON               TO  HACANCA.
  5240     MOVE HACANCI                TO  DEEDIT-FIELD.
  5241     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  5242
  5243     PERFORM 8600-DEEDIT.
  5244
  5245     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5246     MOVE '4'                    TO  DC-OPTION-CODE.
  5247
  5248     PERFORM 9600-DATE-LINK.
  5249
  5250     IF DATE-CONVERSION-ERROR
  5251         MOVE -1                 TO  HACANCL
  5252         MOVE AL-UABON           TO  HACANCA
  5253         MOVE ER-2227            TO  EMI-ERROR
  5254         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5255     ELSE
  5256        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5257           MOVE -1               TO  HACANCL
  5258           MOVE AL-UABON         TO  HACANCA
  5259           MOVE ER-2775          TO  EMI-ERROR
  5260           PERFORM 9700-ERROR-FORMAT
  5261                                 THRU  9799-EXIT
  5262        ELSE
  5263           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  5264                                    PI-AH-CANCEL-DATE
  5265           MOVE DC-GREG-DATE-1-EDIT
  5266                                 TO HACANCO
  5267                                    WS-AH-CANCEL-DATE-ED
  5268                                    PI-AH-CANCEL-DATE-ED
  5269        END-IF
  5270     END-IF
  5271     .
  5272 0420-CHECK-ERRORS.
  5273     IF EMI-ERROR  IS EQUAL TO  ZEROS
  5274         NEXT SENTENCE
  5275     ELSE
  5276         GO TO 8200-SEND-DATAONLY.
  5277
  5278     PERFORM 0500-FORMAT-SCREEN.
  5279
  5280     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  98
* EL1278.cbl
  5282 0500-FORMAT-SCREEN  SECTION.
  5283     MOVE LOW-VALUES             TO  EL127HO.
  5284     MOVE PI-CARRIER             TO  HCARIERO.
  5285     MOVE PI-GROUPING            TO  HGROUPO.
  5286     MOVE PI-STATE               TO  HSTATEO.
  5287     MOVE PI-ACCOUNT             TO  HACCTNOO.
  5288     MOVE ' '                    TO  DC-OPTION-CODE.
  5289     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5290
  5291     PERFORM 9600-DATE-LINK.
  5292
  5293     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  5294     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  5295     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  5296
  5297 0510-GET-CERT.
  5298     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  5299     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  5300     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  5301     MOVE PI-STATE               TO  WS-CM-STATE.
  5302     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  5303     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  5304     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  5305     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  5306
  5307     PERFORM 0900-READ-CERT-FILE.
  5308
  5309     IF CERT-NOT-FOUND
  5310         MOVE -1                 TO  HLCANCL
  5311         MOVE AL-SANON           TO  HLCANCA
  5312         MOVE ER-0214            TO  EMI-ERROR
  5313         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5314         GO TO 8100-SEND-INITIAL-MAP.
  5315
  5316     .
  5317 0510-SKIP-CLAIM-CHECK.
  5318     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  5319     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  5320     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  5321     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  5322
  5323* EXEC CICS READ
  5324*        DATASET  (ERMAIL-ID)
  5325*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  5326*        SET      (ADDRESS OF MAILING-DATA)
  5327*        RESP     (WS-RESPONSE)
  5328*    END-EXEC.
  5329*    MOVE '&"S        E          (  N#00005280' TO DFHEIV0
  5330     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5332     MOVE X'204E233030303035323830' TO DFHEIV0(25:11)
  5333     CALL 'kxdfhei1' USING DFHEIV0,
  5334           ERMAIL-ID,
  5335           DFHEIV20,
  5336           DFHEIV99,
  5337           WS-MA-CONTROL-PRIMARY,
  5338           DFHEIV99,
  5339           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page  99
* EL1278.cbl
  5340           DFHEIV99
  5341     SET ADDRESS OF MAILING-DATA TO
  5342         DFHEIV20
  5343     MOVE EIBRESP  TO WS-RESPONSE
  5344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5345
  5346     IF WS-RESP-NORMAL
  5347        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5348           (S1 > +7)
  5349           OR (MA-MAIL-STATUS (S1) = '1')
  5350        END-PERFORM
  5351        IF S1 > +7
  5352           MOVE AL-SANOF         TO HPCYNA
  5353        END-IF
  5354     END-IF
  5355     IF CM-POST-CARD-IND = 'Y'
  5356        MOVE 'Y'                 TO HPCYNO
  5357     ELSE
  5358        MOVE 'N'                 TO HPCYNO
  5359     END-IF
  5360     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  5361        OR (NOT CERT-AS-LOADED)
  5362        MOVE AL-SANOF            TO HPCYNA
  5363     END-IF
  5364*    IF (CERT-ADDED-BATCH)
  5365*       CONTINUE
  5366*    ELSE
  5367*       MOVE AL-SANOF            TO HPCYNA
  5368*    END-IF
  5369     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5370     MOVE '5'                    TO  DC-OPTION-CODE.
  5371
  5372     PERFORM 9600-DATE-LINK.
  5373
  5374     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  5375     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5376     MOVE '1'                    TO  DC-OPTION-CODE.
  5377
  5378     PERFORM 9600-DATE-LINK.
  5379
  5380     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  5381
  5382     MOVE ZEROS TO WS-TOT-ITDR.
  5383     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  5384
  5385 0510-CHECK-LF-STATUS.
  5386
  5387     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  5388         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  5389                                    PI-LF-CANCEL-DATE
  5390         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  5391                                    PI-LF-CANCEL-DATE-ED
  5392                                    PI-LF-REFUND-METH
  5393         MOVE ZEROS              TO PI-LF-REFUND-AMT
  5394         GO TO 0510-CHECK-AH-STATUS.
  5395
  5396     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  5397        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 100
* EL1278.cbl
  5398          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  5399          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  5400          IF FIRST-ENTRY
  5401              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  5402              MOVE SPACES               TO DC-OPTION-CODE
  5403              PERFORM 9600-DATE-LINK
  5404              IF NOT DATE-CONVERSION-ERROR
  5405                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  5406                                            PI-LF-CANCEL-DATE-ED
  5407                                            WS-LF-CANCEL-DATE-ED
  5408                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  5409                                            WS-LF-CANCEL-DATE.
  5410
  5411     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  5412        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  5413          MOVE WS-PMT-DESCRIP       TO PMTHDO
  5414          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  5415          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  5416        IF FIRST-ENTRY
  5417            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  5418            MOVE SPACES               TO DC-OPTION-CODE
  5419            PERFORM 9600-DATE-LINK
  5420            IF NOT DATE-CONVERSION-ERROR
  5421                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  5422                                          PI-LF-CANCEL-DATE-ED
  5423                                          WS-LF-CANCEL-DATE-ED
  5424                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  5425                                          WS-LF-CANCEL-DATE.
  5426
  5427 0510-CHECK-AH-STATUS.
  5428
  5429     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  5430         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  5431                                    PI-AH-CANCEL-DATE
  5432         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  5433                                    PI-AH-CANCEL-DATE-ED
  5434                                    PI-AH-REFUND-METH
  5435         MOVE ZEROS              TO PI-AH-REFUND-AMT
  5436         GO TO 0510-CONT.
  5437
  5438     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  5439        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  5440          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  5441          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  5442        IF FIRST-ENTRY
  5443            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  5444            MOVE SPACES               TO DC-OPTION-CODE
  5445            PERFORM 9600-DATE-LINK
  5446            IF NOT DATE-CONVERSION-ERROR
  5447                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  5448                                            PI-AH-CANCEL-DATE-ED
  5449                                            WS-AH-CANCEL-DATE-ED
  5450                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  5451                                            WS-AH-CANCEL-DATE.
  5452
  5453     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  5454        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  5455          MOVE WS-PMT-DESCRIP       TO PMTHDO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 101
* EL1278.cbl
  5456          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  5457          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  5458         IF FIRST-ENTRY
  5459             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  5460             MOVE SPACES               TO DC-OPTION-CODE
  5461             PERFORM 9600-DATE-LINK
  5462             IF NOT DATE-CONVERSION-ERROR
  5463                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  5464                                            PI-AH-CANCEL-DATE-ED
  5465                                            WS-AH-CANCEL-DATE-ED
  5466                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  5467                                            WS-AH-CANCEL-DATE.
  5468
  5469     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  5470         MOVE 'CANC DT'              TO  CNCDTHDO
  5471         GO TO 0510-CONT.
  5472
  5473     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  5474         MOVE 'DTH DT '              TO  CNCDTHDO
  5475         IF FIRST-ENTRY
  5476             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  5477             MOVE ' '                TO  DC-OPTION-CODE
  5478             PERFORM 9600-DATE-LINK
  5479             IF NOT DATE-CONVERSION-ERROR
  5480                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  5481                                             PI-AH-CANCEL-DATE-ED
  5482                                             WS-AH-CANCEL-DATE-ED
  5483                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  5484                                             WS-AH-CANCEL-DATE.
  5485
  5486 0510-CONT.
  5487
  5488     IF WS-TOT-ITDR GREATER THAN ZEROS
  5489         MOVE WS-TOT-ITDR TO TOITDRO.
  5490
  5491 0520-GET-COMPANY-RECORD.
  5492     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  5493     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  5494     MOVE SPACES                 TO  WS-CF-ACCESS.
  5495     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  5496
  5497     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  5498
  5499     IF CNTL-NOT-FOUND
  5500         MOVE -1                 TO  HLCANCL
  5501         MOVE AL-SANON           TO  HLCANCA
  5502         MOVE ER-2616            TO  EMI-ERROR
  5503         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5504         GO TO 8100-SEND-INITIAL-MAP.
  5505
  5506     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  5507       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  5508         MOVE CF-LIFE-OVERRIDE-L1
  5509                                 TO  WS-CF-LIFE-OVERRIDE-L1
  5510         MOVE CF-LIFE-OVERRIDE-L2
  5511                                 TO  WS-CF-LIFE-OVERRIDE-L2
  5512         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  5513         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 102
* EL1278.cbl
  5514         MOVE CF-CR-REM-TERM-CALC
  5515                                 TO  WS-CF-CR-REM-TERM-CALC
  5516         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  5517         IF CF-DEFAULT-APR NUMERIC
  5518             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  5519             GO TO 0525-GET-LF-BENEFIT
  5520         ELSE
  5521             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  5522             GO TO 0525-GET-LF-BENEFIT.
  5523
  5524     MOVE -1                     TO  HLCANCL.
  5525     MOVE AL-SANON               TO  HLCANCA.
  5526     MOVE ER-2616                TO  EMI-ERROR.
  5527
  5528     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5529
  5530     GO TO 8100-SEND-INITIAL-MAP.
  5531
  5532 0525-GET-LF-BENEFIT.
  5533
  5534     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5535        GO TO 0527-GET-AH-BENEFIT
  5536     END-IF
  5537
  5538     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  5539     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  5540                                     HLCDO.
  5541     MOVE WS-CF-LIFE-OVERRIDE-L2
  5542                                 TO  HLKINDO.
  5543
  5544     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  5545
  5546     IF BENEFIT-FOUND
  5547         NEXT SENTENCE
  5548     ELSE
  5549         MOVE -1                 TO  HLCDL
  5550         MOVE AL-SANON           TO  HLCDA
  5551         MOVE ER-0028            TO  EMI-ERROR
  5552         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5553         GO TO 8100-SEND-INITIAL-MAP.
  5554
  5555     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  5556         MOVE AL-UNNOF           TO  HLTERMA.
  5557
  5558*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  5559     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  5560                                 TO  WS-CF-LF-COVERAGE-TYPE.
  5561
  5562     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  5563         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  5564                                 TO  WS-LF-CO-REM-TERM-CALC.
  5565
  5566     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  5567         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  5568                                 TO  WS-LF-CO-EARNINGS-CALC
  5569                                     WS-LF-CO-REFUND-CALC.
  5570
  5571     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 103
* EL1278.cbl
  5572         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  5573                                 TO  WS-LF-SPECIAL-CALC-CD.
  5574
  5575     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  5576         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  5577                                 TO  WS-LF-CO-REFUND-CALC.
  5578
  5579 0527-GET-AH-BENEFIT.
  5580
  5581     IF CM-AH-BENEFIT-CD = '00' OR '  '
  5582        GO TO 0530-GET-STATE-RECORD
  5583     END-IF
  5584
  5585     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  5586     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  5587                                     HACDO.
  5588     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  5589
  5590     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  5591
  5592     IF BENEFIT-FOUND
  5593         NEXT SENTENCE
  5594     ELSE
  5595         MOVE -1                 TO  HACDL
  5596         MOVE AL-SANON           TO  HACDA
  5597         MOVE ER-0028            TO  EMI-ERROR
  5598         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5599         GO TO 8100-SEND-INITIAL-MAP.
  5600
  5601     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  5602         MOVE AL-UNNOF           TO  HATERMA.
  5603
  5604*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  5605
  5606     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  5607         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  5608                                 TO  WS-AH-CO-REM-TERM-CALC.
  5609
  5610     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  5611         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  5612                                 TO  WS-AH-CO-EARNINGS-CALC
  5613                                     WS-AH-CO-REFUND-CALC.
  5614
  5615     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  5616         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  5617                                 TO  WS-AH-SPECIAL-CALC-CD.
  5618
  5619     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  5620         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  5621                                 TO  WS-AH-CO-REFUND-CALC.
  5622     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  5623        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  5624                                 TO WS-AH-BEN-CATEGORY
  5625     END-IF
  5626     .
  5627 0530-GET-STATE-RECORD.
  5628     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  5629     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 104
* EL1278.cbl
  5630     MOVE CM-STATE               TO  WS-CF-ACCESS.
  5631     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  5632
  5633     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  5634
  5635     IF CNTL-NOT-FOUND
  5636         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  5637                                     WS-LF-ST-REM-TERM-CALC
  5638         MOVE 'N'                TO  WS-STATE-RECORD-SW
  5639         GO TO 0560-FIND-ACCOUNT.
  5640
  5641     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  5642       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  5643       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  5644         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  5645     ELSE
  5646         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  5647                                     WS-LF-ST-REM-TERM-CALC
  5648         MOVE 'N'                TO  WS-STATE-RECORD-SW
  5649         GO TO 0560-FIND-ACCOUNT.
  5650
  5651     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  5652     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  5653
  5654     IF CM-LF-BENEFIT-CD  = '00'
  5655         GO TO 0550-GET-AH-BEN-IN-STATE.
  5656
  5657 0540-GET-LF-BEN-IN-STATE.
  5658     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  5659     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  5660
  5661     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  5662     IF CF-ST-RT-CALC NOT = SPACES
  5663        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  5664     END-IF
  5665
  5666     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5667        IF CF-ST-RF-LR-CALC > '0'
  5668           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  5669        END-IF
  5670        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5671           IF CF-ST-RF-LN-CALC > '0'
  5672              MOVE CF-ST-RF-LN-CALC
  5673                                 TO WS-LF-ST-REFUND-CALC
  5674           END-IF
  5675        END-IF
  5676     ELSE
  5677        IF CF-ST-RF-LL-CALC > '0'
  5678           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  5679        END-IF
  5680     END-IF
  5681
  5682     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  5683
  5684     IF NO-BENEFIT-FOUND
  5685*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  5686         GO TO 0550-GET-AH-BEN-IN-STATE.
  5687
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 105
* EL1278.cbl
  5688     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  5689         MOVE CF-ST-REM-TERM-CALC (SUB3)
  5690                                 TO  WS-LF-ST-REM-TERM-CALC.
  5691
  5692     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  5693         MOVE CF-ST-REFUND-CALC (SUB3)
  5694                                 TO  WS-LF-ST-REFUND-CALC.
  5695
  5696 0550-GET-AH-BEN-IN-STATE.
  5697     IF CM-AH-BENEFIT-CD  = '00'
  5698         GO TO 0560-FIND-ACCOUNT.
  5699
  5700     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  5701     IF CF-ST-RT-CALC NOT = SPACES
  5702        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  5703     END-IF
  5704
  5705     IF CF-ST-RF-AH-CALC > '0'
  5706        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  5707     END-IF
  5708     IF WS-AH-SPECIAL-CALC-CD = 'C'
  5709        IF CF-ST-RF-CP-CALC > '0'
  5710           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  5711        END-IF
  5712     END-IF
  5713
  5714     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  5715     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  5716
  5717     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  5718
  5719     IF NO-BENEFIT-FOUND
  5720*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  5721         GO TO 0560-FIND-ACCOUNT.
  5722
  5723     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  5724         MOVE CF-ST-REM-TERM-CALC (SUB3)
  5725                                 TO  WS-AH-ST-REM-TERM-CALC.
  5726
  5727     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  5728         MOVE CF-ST-REFUND-CALC (SUB3)
  5729                                 TO  WS-AH-ST-REFUND-CALC.
  5730
  5731 0560-FIND-ACCOUNT.
  5732     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  5733     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  5734     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  5735     MOVE CM-STATE               TO  WS-AM-STATE.
  5736     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  5737     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  5738     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  5739
  5740     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  5741
  5742     IF ACCT-FOUND
  5743         NEXT SENTENCE
  5744     ELSE
  5745         GO TO 0585-NO-ACCT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 106
* EL1278.cbl
  5746
  5747 0570-READ-NEXT-RANGE.
  5748     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  5749
  5750     IF ACCT-FOUND
  5751         NEXT SENTENCE
  5752     ELSE
  5753         GO TO 0580-ACCT-NOT-FOUND.
  5754
  5755     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  5756       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  5757       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  5758       AND CM-STATE  IS EQUAL TO  AM-STATE
  5759       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  5760         NEXT SENTENCE
  5761     ELSE
  5762         GO TO 0580-ACCT-NOT-FOUND.
  5763
  5764     MOVE 'X'                    TO  DATE-RANGE-SW.
  5765
  5766     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
  5767         MOVE 'X'                TO  DATE-RANGE-SW
  5768         GO TO 0580-ACCT-NOT-FOUND.
  5769
  5770     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  5771         GO TO 0570-READ-NEXT-RANGE.
  5772
  5773     MOVE ' '                    TO  DATE-RANGE-SW.
  5774     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  5775
  5776     GO TO 0590-SET-ACCOUNT.
  5777
  5778 0580-ACCT-NOT-FOUND.
  5779     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  5780         MOVE ER-2601            TO  EMI-ERROR
  5781     ELSE
  5782         MOVE ER-2619            TO  EMI-ERROR.
  5783
  5784     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  5785
  5786     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5787
  5788 0585-NO-ACCT.
  5789     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  5790     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  5791                                     WS-AM-EARN-METHOD-R
  5792                                     WS-AM-EARN-METHOD-A
  5793                                     WS-LF-AM-REM-TERM-CALC
  5794                                     WS-AH-AM-REM-TERM-CALC.
  5795
  5796     GO TO 0600-CHECK-FOR-LIFE.
  5797
  5798 0590-SET-ACCOUNT.
  5799******************************************************************
  5800******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  5801******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  5802******* METHODS.
  5803******************************************************************
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 107
* EL1278.cbl
  5804     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  5805     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
  5806     IF PI-COMPANY-ID EQUAL TO 'NCL'
  5807          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  5808                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  5809                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  5810                  IF FORM-FOUND
  5811                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  5812******************************************************************
  5813
  5814     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  5815     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  5816                                     WS-AM-EARN-METHOD-R
  5817                                     WS-AM-EARN-METHOD-A.
  5818
  5819*    EVALUATE AM-EARN-METHOD-R
  5820*       WHEN 'R'
  5821*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  5822*       WHEN 'P'
  5823*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  5824*       WHEN 'C'
  5825*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  5826*       WHEN 'A'
  5827*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  5828*       WHEN 'M'
  5829*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  5830*       WHEN 'S'
  5831*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  5832*    END-EVALUATE.
  5833
  5834*    EVALUATE AM-EARN-METHOD-L
  5835*       WHEN 'R'
  5836*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  5837*       WHEN 'P'
  5838*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  5839*       WHEN 'C'
  5840*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  5841*       WHEN 'A'
  5842*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  5843*       WHEN 'M'
  5844*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  5845*       WHEN 'S'
  5846*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  5847*    END-EVALUATE.
  5848
  5849*    EVALUATE AM-EARN-METHOD-A
  5850*       WHEN 'R'
  5851*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  5852*       WHEN 'P'
  5853*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  5854*       WHEN 'C'
  5855*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  5856*       WHEN 'A'
  5857*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  5858*       WHEN 'M'
  5859*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  5860*       WHEN 'N'
  5861*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 108
* EL1278.cbl
  5862*       WHEN 'S'
  5863*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
  5864*    END-EVALUATE.
  5865
  5866     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  5867                                     WS-TOT-LF-PREM
  5868                                     WS-TOT-AH-RFND
  5869                                     WS-TOT-LF-RFND.
  5870
  5871 0600-CHECK-FOR-LIFE.
  5872     IF CM-LF-BENEFIT-CD  = '00'
  5873         GO TO 0640-AH-BENEFIT.
  5874
  5875 0610-GET-LIFE-BENEFIT.
  5876
  5877     IF ACCT-FOUND
  5878         MOVE +1                 TO SUB3
  5879         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  5880     .
  5881 0620-GET-REM-TERM.
  5882     MOVE WS-CF-LIFE-OVERRIDE-L1
  5883                                 TO  CP-LIFE-OVERRIDE-CODE.
  5884     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5885     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5886     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  5887     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  5888     MOVE CM-STATE               TO  CP-STATE.
  5889     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5890     MOVE WS-CF-LF-COVERAGE-TYPE
  5891                                 TO  CP-BENEFIT-TYPE.
  5892     MOVE WS-KIND                TO  HLEDESCO.
  5893     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5894     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  5895     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  5896     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5897     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  5898     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5899     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5900     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  5901     MOVE WS-CF-CR-REM-TERM-CALC
  5902                                 TO  CP-REM-TERM-METHOD.
  5903
  5904     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  5905         MOVE WS-LF-CO-REM-TERM-CALC
  5906                                 TO  CP-REM-TERM-METHOD.
  5907
  5908     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  5909         MOVE WS-LF-ST-REM-TERM-CALC
  5910                                 TO  CP-REM-TERM-METHOD.
  5911
  5912     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  5913         MOVE WS-LF-AM-REM-TERM-CALC
  5914                                 TO  CP-REM-TERM-METHOD.
  5915
  5916     IF (PI-COMPANY-ID = 'CID')
  5917        AND (CP-STATE-STD-ABBRV = 'WI')
  5918        MOVE '7'                 TO CP-REM-TERM-METHOD
  5919        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 109
* EL1278.cbl
  5920     END-IF
  5921     IF (PI-COMPANY-ID = 'CID')
  5922        AND (CP-STATE-STD-ABBRV = 'MO')
  5923        AND (CM-CERT-EFF-DT >= X'9B41')
  5924        AND (CM-CERT-EFF-DT <= X'A2FB')
  5925        MOVE '7'                 TO CP-REM-TERM-METHOD
  5926        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5927     END-IF
  5928     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  5929                                     CP-ORIGINAL-TERM
  5930                                     CP-LOAN-TERM.
  5931
  5932     IF CP-TRUNCATED-LIFE
  5933         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5934
  5935     IF CP-TERM-IS-DAYS
  5936         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  5937             MOVE CM-LF-TERM-IN-DAYS
  5938                                 TO  CP-TERM-OR-EXT-DAYS
  5939         ELSE
  5940             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  5941     ELSE
  5942         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5943             MOVE CM-PMT-EXTENSION-DAYS
  5944                                 TO  CP-TERM-OR-EXT-DAYS
  5945         ELSE
  5946             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5947
  5948*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  5949     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  5950     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  5951     MOVE CM-STATE               TO  WS-CF-ACCESS.
  5952     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  5953
  5954
  5955* EXEC CICS READ
  5956*        DATASET  (ELCNTL-ID)
  5957*        SET      (ADDRESS OF CONTROL-FILE)
  5958*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  5959*        RESP     (WS-RESPONSE)
  5960*    END-EXEC.
  5961*    MOVE '&"S        E          (  N#00005894' TO DFHEIV0
  5962     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5964     MOVE X'204E233030303035383934' TO DFHEIV0(25:11)
  5965     CALL 'kxdfhei1' USING DFHEIV0,
  5966           ELCNTL-ID,
  5967           DFHEIV20,
  5968           DFHEIV99,
  5969           WS-CF-CONTROL-PRIMARY,
  5970           DFHEIV99,
  5971           DFHEIV99,
  5972           DFHEIV99
  5973     SET ADDRESS OF CONTROL-FILE TO
  5974         DFHEIV20
  5975     MOVE EIBRESP  TO WS-RESPONSE
  5976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5977
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 110
* EL1278.cbl
  5978
  5979     IF WS-RESP-NOTOPEN
  5980         MOVE ER-2617            TO  EMI-ERROR
  5981         GO TO 0320-INPUT-ERROR.
  5982
  5983     IF WS-RESP-NOTFND
  5984         MOVE ZERO               TO  CP-FREE-LOOK
  5985     ELSE
  5986         MOVE CF-ST-FREE-LOOK-PERIOD
  5987                                 TO CP-FREE-LOOK.
  5988
  5989     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5990        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5991        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5992     END-IF
  5993
  5994     PERFORM 0700-LINK-REM-TERM  THRU  0749-EXIT.
  5995
  5996     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5997        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5998        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5999        COMPUTE CP-REMAINING-TERM-1 =
  6000                CP-REMAINING-TERM-1 - +1
  6001        COMPUTE CP-REMAINING-TERM-2 =
  6002                CP-REMAINING-TERM-2 - +1
  6003     END-IF
  6004
  6005     IF CP-REMAINING-TERM-1 NEGATIVE
  6006        MOVE ZEROS               TO CP-REMAINING-TERM-1
  6007     END-IF
  6008     IF CP-REMAINING-TERM-2 NEGATIVE
  6009        MOVE ZEROS               TO CP-REMAINING-TERM-2
  6010     END-IF
  6011     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  6012
  6013*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  6014*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  6015
  6016     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  6017         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  6018             MOVE ER-0681        TO  EMI-ERROR
  6019             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6020
  6021     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  6022         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  6023             MOVE ER-0682        TO  EMI-ERROR
  6024             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6025
  6026 0630-CONTINUE-LIFE.
  6027
  6028     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6029        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6030        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6031     ELSE
  6032        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  6033     END-IF
  6034
  6035     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 111
* EL1278.cbl
  6036     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6037     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6038
  6039     PERFORM 0750-LINK-REM-AMOUNT THRU 0799-EXIT.
  6040
  6041     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  6042
  6043     COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  6044                             + CM-LF-ALT-PREMIUM-AMT.
  6045
  6046     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6047                                     WS-TOT-LF-PREM.
  6048
  6049     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6050        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6051        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6052     ELSE
  6053        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6054     END-IF
  6055
  6056     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6057     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6058
  6059     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  6060         MOVE WS-LF-ST-REFUND-CALC
  6061                                 TO  CP-EARNING-METHOD.
  6062
  6063     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  6064         MOVE WS-LF-FO-REFUND-CALC
  6065                                 TO  CP-EARNING-METHOD.
  6066
  6067     IF CP-RATING-METHOD = '4'
  6068        MOVE '4'                 TO CP-EARNING-METHOD
  6069     END-IF
  6070*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6071*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  6072*            MOVE WS-AM-EARN-METHOD-R
  6073*                                TO  CP-EARNING-METHOD
  6074*        END-IF
  6075*    ELSE
  6076*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  6077*            MOVE WS-AM-EARN-METHOD-L
  6078*                                TO  CP-EARNING-METHOD.
  6079
  6080     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6081     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6082     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6083                                     CP-RATING-BENEFIT-AMT.
  6084     IF CP-STATE-STD-ABBRV = 'OR'
  6085         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6086                                         CM-LF-ALT-BENEFIT-AMT.
  6087****   N O T E   ****
  6088*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6089*      THE OH HARD CODING IN ELCRFNDP
  6090
  6091     IF PI-COMPANY-ID = 'CID'
  6092        IF CP-STATE-STD-ABBRV = 'OH'
  6093           MOVE WS-LF-CO-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 112
* EL1278.cbl
  6094                                 TO CP-EARNING-METHOD
  6095        END-IF
  6096     END-IF
  6097
  6098****   N O T E   ****
  6099
  6100     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6101     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6102     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  6103     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6104     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6105
  6106     IF CP-EARN-AS-NET-PAY
  6107         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  6108            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  6109                MOVE WS-CF-DEFAULT-APR
  6110                                 TO  CP-LOAN-APR
  6111                MOVE ER-3780     TO  EMI-ERROR
  6112                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6113            ELSE
  6114                MOVE ER-3781     TO  EMI-ERROR
  6115                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6116
  6117*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  6118*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  6119*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  6120*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  6121*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  6122*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  6123*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6124*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  6125*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6126*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  6127*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  6128*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  6129*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  6130*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6131*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  6132*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  6133*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  6134     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6135     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  6136
  6137     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  6138
  6139     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  6140
  6141     IF CP-ERROR-RATE-IS-ZERO
  6142       OR CP-ERROR-RATE-NOT-FOUND
  6143         MOVE ER-2740            TO  EMI-ERROR
  6144         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6145
  6146     IF CP-ERROR-RATE-FILE-NOTOPEN
  6147         MOVE ER-2617            TO  EMI-ERROR
  6148         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6149
  6150     MOVE ZEROS                  TO  WS-CALC-REFUND.
  6151     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 113
* EL1278.cbl
  6152                                     WS-TOT-LF-RFND
  6153                                     PI-LF-REFUND-AMT.
  6154     MOVE CP-REMAINING-AMT       TO  HLREDO.
  6155
  6156     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  6157
  6158     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  6159         GO TO 0640-AH-BENEFIT.
  6160
  6161*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  6162*        ADD +1                  TO  CP-REMAINING-TERM
  6163*                                    CP-ORIGINAL-TERM.
  6164
  6165     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6166     MOVE '2'                    TO  CP-EARNING-METHOD
  6167                                     CP-RATING-METHOD.
  6168     IF PI-COMPANY-ID = 'CID'
  6169        IF (CP-STATE-STD-ABBRV = 'MN')
  6170           AND (CM-CERT-EFF-DT > X'A4FF')
  6171           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6172           MOVE '5'              TO CP-EARNING-METHOD
  6173           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6174        END-IF
  6175     END-IF
  6176     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6177                                     CP-REMAINING-BENEFIT
  6178                                     CP-RATING-BENEFIT-AMT.
  6179     IF CP-STATE-STD-ABBRV = 'OR'
  6180         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6181                                         CM-LF-ALT-BENEFIT-AMT.
  6182     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6183     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6184
  6185     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  6186
  6187     IF CP-ERROR-RATE-IS-ZERO
  6188       OR CP-ERROR-RATE-NOT-FOUND
  6189         MOVE ER-2740            TO  EMI-ERROR
  6190         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6191
  6192     IF CP-ERROR-RATE-FILE-NOTOPEN
  6193         MOVE ER-2617            TO  EMI-ERROR
  6194         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6195
  6196     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  6197
  6198     MOVE WS-CALC-REFUND         TO  HLREFNDO
  6199                                     WS-TOT-LF-RFND
  6200                                     PI-LF-REFUND-AMT.
  6201
  6202     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  6203
  6204 0640-AH-BENEFIT.
  6205     IF CM-AH-BENEFIT-CD = '00'
  6206         GO TO 0680-CONTINUE.
  6207
  6208 0650-GET-AH-BENEFIT.
  6209     IF ACCT-FOUND
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 114
* EL1278.cbl
  6210         MOVE +1                 TO SUB3
  6211         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  6212     .
  6213 0660-GET-REM-TERM.
  6214     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  6215     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6216     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6217     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  6218     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  6219*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6220     MOVE WS-KIND                TO  HAEDESCO.
  6221     MOVE CM-STATE               TO  CP-STATE.
  6222     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6223     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6224     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6225     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6226     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  6227     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6228     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6229     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  6230     MOVE WS-CF-CR-REM-TERM-CALC
  6231                                 TO  CP-REM-TERM-METHOD.
  6232
  6233     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  6234         MOVE WS-AH-CO-REM-TERM-CALC
  6235                                 TO  CP-REM-TERM-METHOD.
  6236
  6237     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  6238         MOVE WS-AH-ST-REM-TERM-CALC
  6239                                 TO  CP-REM-TERM-METHOD.
  6240
  6241     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  6242         MOVE WS-AH-AM-REM-TERM-CALC
  6243                                 TO  CP-REM-TERM-METHOD.
  6244     IF (PI-COMPANY-ID = 'CID')
  6245        AND (CP-STATE-STD-ABBRV = 'WI')
  6246        MOVE '7'                 TO CP-REM-TERM-METHOD
  6247        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6248     END-IF
  6249     IF (PI-COMPANY-ID = 'CID')
  6250        AND (CP-STATE-STD-ABBRV = 'MO')
  6251        AND (CM-CERT-EFF-DT >= X'9B41')
  6252        AND (CM-CERT-EFF-DT <= X'A2FB')
  6253        MOVE '7'                 TO CP-REM-TERM-METHOD
  6254        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6255     END-IF
  6256
  6257     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  6258                                     CP-ORIGINAL-TERM
  6259                                     CP-LOAN-TERM.
  6260
  6261     IF  NOT  CP-TERM-IS-DAYS
  6262         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6263             MOVE CM-PMT-EXTENSION-DAYS
  6264                                 TO  CP-TERM-OR-EXT-DAYS
  6265         ELSE
  6266             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6267
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 115
* EL1278.cbl
  6268*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  6269     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6270     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6271     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6272     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6273
  6274
  6275* EXEC CICS READ
  6276*        DATASET  (ELCNTL-ID)
  6277*        SET      (ADDRESS OF CONTROL-FILE)
  6278*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6279*        RESP     (WS-RESPONSE)
  6280*    END-EXEC.
  6281*    MOVE '&"S        E          (  N#00006196' TO DFHEIV0
  6282     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6284     MOVE X'204E233030303036313936' TO DFHEIV0(25:11)
  6285     CALL 'kxdfhei1' USING DFHEIV0,
  6286           ELCNTL-ID,
  6287           DFHEIV20,
  6288           DFHEIV99,
  6289           WS-CF-CONTROL-PRIMARY,
  6290           DFHEIV99,
  6291           DFHEIV99,
  6292           DFHEIV99
  6293     SET ADDRESS OF CONTROL-FILE TO
  6294         DFHEIV20
  6295     MOVE EIBRESP  TO WS-RESPONSE
  6296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6297
  6298
  6299     IF WS-RESP-NOTOPEN
  6300         MOVE ER-2617            TO  EMI-ERROR
  6301         GO TO 0320-INPUT-ERROR.
  6302
  6303     IF WS-RESP-NOTFND
  6304         MOVE ZERO               TO CP-FREE-LOOK
  6305     ELSE
  6306         MOVE CF-ST-FREE-LOOK-PERIOD
  6307                                 TO CP-FREE-LOOK.
  6308
  6309     PERFORM 0700-LINK-REM-TERM  THRU  0749-EXIT.
  6310
  6311     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  6312
  6313     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  6314         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  6315             MOVE ER-0683        TO  EMI-ERROR
  6316             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6317
  6318     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  6319         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  6320             MOVE ER-0684        TO  EMI-ERROR
  6321             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6322
  6323 0670-CONTINUE-AH.
  6324     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  6325                                     WS-TOT-AH-PREM.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 116
* EL1278.cbl
  6326     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  6327
  6328     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  6329         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  6330
  6331     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  6332     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6333     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6334
  6335     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  6336         MOVE WS-AH-ST-REFUND-CALC
  6337                                 TO  CP-EARNING-METHOD.
  6338
  6339     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  6340         MOVE WS-AH-FO-REFUND-CALC
  6341                                 TO  CP-EARNING-METHOD.
  6342
  6343*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  6344*        MOVE WS-AM-EARN-METHOD-A
  6345*                                TO  CP-EARNING-METHOD.
  6346
  6347     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6348     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6349     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6350                                     CP-RATING-BENEFIT-AMT.
  6351     IF CP-STATE-STD-ABBRV = 'OR'
  6352         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6353                                         CM-AH-ORIG-TERM.
  6354     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6355     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6356     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6357     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6358     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6359     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6360
  6361     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6362     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6363     MOVE ' '                    TO  DC-OPTION-CODE.
  6364
  6365     PERFORM 9600-DATE-LINK.
  6366
  6367     IF CP-STATE-STD-ABBRV = 'OH'
  6368        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  6369         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  6370           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  6371           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6372             MOVE '6'            TO  CP-EARNING-METHOD
  6373         END-IF
  6374        END-IF
  6375        IF PI-COMPANY-ID = 'CID'
  6376           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6377                           LOW-VALUES)
  6378              IF CP-CRITICAL-PERIOD
  6379                 MOVE '2'       TO CP-EARNING-METHOD
  6380              ELSE
  6381                 MOVE '6'       TO CP-EARNING-METHOD
  6382              END-IF
  6383           ELSE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 117
* EL1278.cbl
  6384              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6385                 MOVE '2'       TO CP-EARNING-METHOD
  6386              ELSE
  6387                 IF ((CM-LF-ORIG-TERM > 60) AND
  6388                    (CM-RATE-CLASS NOT = 'L '))
  6389                               OR
  6390                    (WS-LF-CO-EARNINGS-CALC = '5')
  6391                    IF CP-CRITICAL-PERIOD
  6392                       MOVE '2'  TO CP-EARNING-METHOD
  6393                    ELSE
  6394                       MOVE '6'  TO CP-EARNING-METHOD
  6395                    END-IF
  6396                 ELSE
  6397                    MOVE '1'     TO CP-EARNING-METHOD
  6398                 END-IF
  6399              END-IF
  6400           END-IF
  6401        END-IF
  6402     END-IF
  6403
  6404     IF CP-STATE-STD-ABBRV = 'VA'
  6405       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  6406         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  6407            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  6408                MOVE '6'            TO  CP-EARNING-METHOD
  6409            ELSE
  6410                MOVE '1'            TO  CP-EARNING-METHOD.
  6411
  6412     IF CP-EARN-AS-NET-PAY
  6413         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  6414            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  6415                MOVE WS-CF-DEFAULT-APR
  6416                                 TO  CP-LOAN-APR
  6417                MOVE ER-3780     TO  EMI-ERROR
  6418                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6419            ELSE
  6420                MOVE ER-3781     TO  EMI-ERROR
  6421                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6422     IF PI-COMPANY-ID = 'DCC'
  6423        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6424           AND (CP-EARNING-METHOD NOT = 'G')
  6425           MOVE 'S'              TO CP-EARNING-METHOD
  6426        END-IF
  6427     END-IF
  6428
  6429     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  6430
  6431     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  6432
  6433     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  6434
  6435     IF CP-ERROR-RATE-IS-ZERO
  6436       OR CP-ERROR-RATE-NOT-FOUND
  6437         MOVE ER-2740            TO  EMI-ERROR
  6438         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6439
  6440     IF CP-ERROR-RATE-FILE-NOTOPEN
  6441         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 118
* EL1278.cbl
  6442         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6443
  6444     MOVE ZEROS                  TO  WS-CALC-REFUND.
  6445     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  6446                                     WS-TOT-AH-RFND
  6447                                     PI-AH-REFUND-AMT.
  6448
  6449     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  6450
  6451     MOVE AL-UANON               TO  HACANCA.
  6452
  6453 0680-CONTINUE.
  6454     IF BROWSE-STARTED
  6455         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  6456         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  6457
  6458     IF CM-LF-BENEFIT-CD = '00'
  6459         MOVE -1                 TO  HACANCL
  6460     ELSE
  6461         MOVE -1                 TO  HLCANCL.
  6462
  6463     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  6464                           WS-TOT-PREM.
  6465     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  6466                           WS-TOT-RFND.
  6467
  6468     MOVE WS-TOT-PREM            TO  TOPREMO.
  6469     MOVE WS-TOT-RFND            TO  TORFNDO.
  6470
  6471 0699-EXIT.
  6472     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 119
* EL1278.cbl
  6474 0700-LINK-REM-TERM SECTION.
  6475
  6476* EXEC CICS LINK
  6477*        PROGRAM   (ELRTRM-ID)
  6478*        COMMAREA  (CALCULATION-PASS-AREA)
  6479*        LENGTH    (CP-COMM-LENGTH)
  6480*    END-EXEC.
  6481*    MOVE '."C                   ''   #00006379' TO DFHEIV0
  6482     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6483     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6484     MOVE X'2020233030303036333739' TO DFHEIV0(25:11)
  6485     CALL 'kxdfhei1' USING DFHEIV0,
  6486           ELRTRM-ID,
  6487           CALCULATION-PASS-AREA,
  6488           CP-COMM-LENGTH,
  6489           DFHEIV99,
  6490           DFHEIV99,
  6491           DFHEIV99
  6492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6493
  6494
  6495 0749-EXIT.
  6496     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 120
* EL1278.cbl
  6498 0750-LINK-REM-AMOUNT SECTION.
  6499
  6500* EXEC CICS LINK
  6501*        PROGRAM   (ELRAMT-ID)
  6502*        COMMAREA  (CALCULATION-PASS-AREA)
  6503*        LENGTH    (CP-COMM-LENGTH)
  6504*    END-EXEC.
  6505*    MOVE '."C                   ''   #00006389' TO DFHEIV0
  6506     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6507     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6508     MOVE X'2020233030303036333839' TO DFHEIV0(25:11)
  6509     CALL 'kxdfhei1' USING DFHEIV0,
  6510           ELRAMT-ID,
  6511           CALCULATION-PASS-AREA,
  6512           CP-COMM-LENGTH,
  6513           DFHEIV99,
  6514           DFHEIV99,
  6515           DFHEIV99
  6516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6517
  6518
  6519 0799-EXIT.
  6520     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 121
* EL1278.cbl
  6522 0800-LINK-REFUND SECTION.
  6523     IF CP-AH
  6524       IF PI-EARNING-METHOD-AH NOT = SPACES
  6525         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  6526        ELSE
  6527         NEXT SENTENCE
  6528      ELSE
  6529       IF PI-EARNING-METHOD-LF NOT = SPACES
  6530         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  6531
  6532
  6533* EXEC CICS LINK
  6534*        PROGRAM   (ELRFND-ID)
  6535*        COMMAREA  (CALCULATION-PASS-AREA)
  6536*        LENGTH    (CP-COMM-LENGTH)
  6537*    END-EXEC.
  6538*    MOVE '."C                   ''   #00006408' TO DFHEIV0
  6539     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6540     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6541     MOVE X'2020233030303036343038' TO DFHEIV0(25:11)
  6542     CALL 'kxdfhei1' USING DFHEIV0,
  6543           ELRFND-ID,
  6544           CALCULATION-PASS-AREA,
  6545           CP-COMM-LENGTH,
  6546           DFHEIV99,
  6547           DFHEIV99,
  6548           DFHEIV99
  6549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6550
  6551
  6552 0899-EXIT.
  6553     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 122
* EL1278.cbl
  6555 0900-READ-CERT-FILE  SECTION.
  6556
  6557* EXEC CICS HANDLE CONDITION
  6558*        NOTFND  (0910-NOT-FOUND)
  6559*    END-EXEC.
  6560*    MOVE '"$I                   ! # #00006418' TO DFHEIV0
  6561     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6562     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6563     MOVE X'2320233030303036343138' TO DFHEIV0(25:11)
  6564     CALL 'kxdfhei1' USING DFHEIV0
  6565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6566
  6567
  6568
  6569* EXEC CICS READ
  6570*        DATASET  (ELCERT-ID)
  6571*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  6572*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  6573*    END-EXEC.
  6574*    MOVE '&"S        E          (   #00006422' TO DFHEIV0
  6575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6576     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6577     MOVE X'2020233030303036343232' TO DFHEIV0(25:11)
  6578     CALL 'kxdfhei1' USING DFHEIV0,
  6579           ELCERT-ID,
  6580           DFHEIV20,
  6581           DFHEIV99,
  6582           WS-CM-CONTROL-PRIMARY,
  6583           DFHEIV99,
  6584           DFHEIV99,
  6585           DFHEIV99
  6586     SET ADDRESS OF CERTIFICATE-MASTER TO
  6587         DFHEIV20
  6588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6589
  6590
  6591*    SERVICE RELOAD CERTIFICATE-MASTER.
  6592
  6593     GO TO 0999-EXIT.
  6594
  6595 0910-NOT-FOUND.
  6596     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  6597
  6598 0999-EXIT.
  6599     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 123
* EL1278.cbl
  6601 1000-READ-CONTROL  SECTION.
  6602
  6603* EXEC CICS HANDLE CONDITION
  6604*        NOTFND   (1010-NOTFND)
  6605*        NOTOPEN  (1020-NOTOPEN)
  6606*    END-EXEC.
  6607*    MOVE '"$IJ                  ! $ #00006439' TO DFHEIV0
  6608     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  6609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6610     MOVE X'2420233030303036343339' TO DFHEIV0(25:11)
  6611     CALL 'kxdfhei1' USING DFHEIV0
  6612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6613
  6614
  6615
  6616* EXEC CICS READ
  6617*        DATASET  (ELCNTL-ID)
  6618*        SET      (ADDRESS OF CONTROL-FILE)
  6619*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6620*        GTEQ
  6621*    END-EXEC.
  6622*    MOVE '&"S        G          (   #00006444' TO DFHEIV0
  6623     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6625     MOVE X'2020233030303036343434' TO DFHEIV0(25:11)
  6626     CALL 'kxdfhei1' USING DFHEIV0,
  6627           ELCNTL-ID,
  6628           DFHEIV20,
  6629           DFHEIV99,
  6630           WS-CF-CONTROL-PRIMARY,
  6631           DFHEIV99,
  6632           DFHEIV99,
  6633           DFHEIV99
  6634     SET ADDRESS OF CONTROL-FILE TO
  6635         DFHEIV20
  6636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6637
  6638
  6639*    SERVICE RELOAD CONTROL-FILE.
  6640
  6641     GO TO 1099-EXIT.
  6642
  6643 1010-NOTFND.
  6644     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  6645
  6646     GO TO 1099-EXIT.
  6647
  6648 1020-NOTOPEN.
  6649     MOVE ER-2617                TO  EMI-ERROR.
  6650
  6651     GO TO 0320-INPUT-ERROR.
  6652
  6653 1099-EXIT.
  6654     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 124
* EL1278.cbl
  6656 1100-FIND-BENEFIT-IN-STATE  SECTION.
  6657     MOVE 'N'                    TO  BEN-SEARCH-SW.
  6658
  6659     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  6660         VARYING  SUB3  FROM  1  BY  1
  6661             UNTIL  ((SUB3  IS GREATER THAN  50)
  6662               OR ((CF-ST-BENEFIT-CD (SUB3)
  6663                      IS EQUAL TO  WS-BEN-CD)
  6664               AND (WS-LOOKUP-TYPE
  6665                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  6666
  6667     IF SUB3  IS NOT EQUAL TO  51
  6668         MOVE 'Y'                TO  BEN-SEARCH-SW.
  6669
  6670     GO TO 1199-EXIT.
  6671
  6672 1110-BENEFIT-DUMMY.
  6673
  6674 1119-EXIT.
  6675     EXIT.
  6676
  6677 1199-EXIT.
  6678     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 125
* EL1278.cbl
  6680 1200-START-ACCOUNT-MASTER  SECTION.
  6681
  6682* EXEC CICS HANDLE CONDITION
  6683*        NOTFND   (1290-ACCT-NOT-FOUND)
  6684*        ENDFILE  (1290-ACCT-NOT-FOUND)
  6685*    END-EXEC.
  6686*    MOVE '"$I''                  ! % #00006493' TO DFHEIV0
  6687     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6688     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6689     MOVE X'2520233030303036343933' TO DFHEIV0(25:11)
  6690     CALL 'kxdfhei1' USING DFHEIV0
  6691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6692
  6693
  6694     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  6695
  6696
  6697* EXEC CICS STARTBR
  6698*        DATASET  (ERACCT-ID)
  6699*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  6700*        GTEQ
  6701*    END-EXEC.
  6702     MOVE 0
  6703       TO DFHEIV11
  6704*    MOVE '&,         G          &   #00006500' TO DFHEIV0
  6705     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6706     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6707     MOVE X'2020233030303036353030' TO DFHEIV0(25:11)
  6708     CALL 'kxdfhei1' USING DFHEIV0,
  6709           ERACCT-ID,
  6710           WS-AM-CONTROL-PRIMARY,
  6711           DFHEIV99,
  6712           DFHEIV11,
  6713           DFHEIV99
  6714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6715
  6716
  6717     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  6718     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6719
  6720     GO TO 1299-EXIT.
  6721
  6722 1290-ACCT-NOT-FOUND.
  6723     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  6724
  6725 1299-EXIT.
  6726     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 126
* EL1278.cbl
  6728 1300-READ-ACCOUNT-MASTER  SECTION.
  6729
  6730* EXEC CICS HANDLE CONDITION
  6731*        NOTFND   (0580-ACCT-NOT-FOUND)
  6732*        ENDFILE  (0580-ACCT-NOT-FOUND)
  6733*    END-EXEC.
  6734*    MOVE '"$I''                  ! & #00006518' TO DFHEIV0
  6735     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6736     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6737     MOVE X'2620233030303036353138' TO DFHEIV0(25:11)
  6738     CALL 'kxdfhei1' USING DFHEIV0
  6739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6740
  6741
  6742
  6743* EXEC CICS READNEXT
  6744*        DATASET  (ERACCT-ID)
  6745*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6746*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  6747*    END-EXEC.
  6748     MOVE 0
  6749       TO DFHEIV11
  6750*    MOVE '&.S                   )   #00006523' TO DFHEIV0
  6751     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6752     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6753     MOVE X'2020233030303036353233' TO DFHEIV0(25:11)
  6754     CALL 'kxdfhei1' USING DFHEIV0,
  6755           ERACCT-ID,
  6756           DFHEIV20,
  6757           DFHEIV99,
  6758           WS-AM-CONTROL-PRIMARY,
  6759           DFHEIV99,
  6760           DFHEIV11,
  6761           DFHEIV99,
  6762           DFHEIV99
  6763     SET ADDRESS OF ACCOUNT-MASTER TO
  6764         DFHEIV20
  6765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6766
  6767
  6768*    SERVICE RELOAD ACCOUNT-MASTER.
  6769
  6770 1399-EXIT.
  6771     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 127
* EL1278.cbl
  6773 1400-GET-REFUND-TYPE  SECTION.
  6774     IF LIFE-REFUND-SEARCH
  6775         NEXT SENTENCE
  6776     ELSE
  6777         GO TO 1410-AH-REFUND-TYPE.
  6778
  6779     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  6780         MOVE SPACES             TO  HLCALCO
  6781                                     HLCAL1O
  6782         GO TO 1499-EXIT.
  6783
  6784     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  6785
  6786     EVALUATE TRUE
  6787        WHEN CP-R-AS-R78
  6788           MOVE 'RULE 78'          TO  HLCALCO
  6789        WHEN  CP-R-AS-PRORATA
  6790           MOVE 'PRO RATA'         TO  HLCALCO
  6791        WHEN CP-R-AS-CALIF
  6792           MOVE 'CALIF'            TO  HLCALCO
  6793        WHEN CP-R-AS-TEXAS
  6794           MOVE 'IRREG'            TO  HLCALCO
  6795        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  6796           MOVE 'UTAH'             TO  HLCALCO
  6797        WHEN CP-R-AS-FARM-PLAN
  6798           MOVE 'FARM PLAN'        TO  HLCALCO
  6799        WHEN CP-R-AS-NET-PAY
  6800           MOVE 'NET PAY'          TO  HLCALCO
  6801        WHEN CP-R-AS-ANTICIPATION
  6802           MOVE 'ANTICIPATION'     TO  HLCALCO
  6803        WHEN CP-R-AS-MEAN
  6804           MOVE 'MEAN'             TO  HLCALCO
  6805        WHEN CP-R-AS-SUM-OF-DIGITS
  6806           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  6807     END-EVALUATE.
  6808
  6809     GO TO 1499-EXIT.
  6810
  6811 1410-AH-REFUND-TYPE.
  6812     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  6813         MOVE SPACES             TO  HACALCO
  6814                                     HACAL1O
  6815         GO TO 1499-EXIT.
  6816
  6817     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  6818
  6819     EVALUATE TRUE
  6820        WHEN CP-R-AS-R78
  6821           MOVE 'RULE 78'          TO  HACALCO
  6822        WHEN CP-R-AS-PRORATA
  6823           MOVE 'PRO RATA'         TO  HACALCO
  6824        WHEN CP-REFUND-TYPE-USED = '3'
  6825           MOVE 'CALIF'            TO  HACALCO
  6826        WHEN CP-R-AS-TEXAS
  6827           MOVE 'IRREG'            TO  HACALCO
  6828        WHEN CP-R-AS-FARM-PLAN
  6829           MOVE 'FARM PLAN'        TO  HACALCO
  6830        WHEN CP-R-AS-NET-PAY
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 128
* EL1278.cbl
  6831           MOVE 'NET PAY'          TO  HACALCO
  6832        WHEN CP-R-AS-ANTICIPATION
  6833           MOVE 'ANTICIPATION'     TO  HACALCO
  6834        WHEN CP-R-AS-MEAN
  6835           MOVE 'MEAN'             TO  HACALCO
  6836        WHEN CP-R-AS-SUM-OF-DIGITS
  6837           MOVE 'SUM OF DIGIT'     TO  HACALCO
  6838        WHEN CP-GAP-ACTUARIAL
  6839           MOVE 'SP ACTUARIAL'     TO HACALCO
  6840     END-EVALUATE.
  6841         GO TO 1499-EXIT.
  6842
  6843 1499-EXIT.
  6844     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 129
* EL1278.cbl
  6846 1500-END-BROWSE  SECTION.
  6847     IF BROWSE-STARTED
  6848
  6849* EXEC CICS ENDBR
  6850*            DATASET  (ERACCT-ID)
  6851*        END-EXEC.
  6852     MOVE 0
  6853       TO DFHEIV11
  6854*    MOVE '&2                    $   #00006609' TO DFHEIV0
  6855     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6856     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6857     MOVE X'2020233030303036363039' TO DFHEIV0(25:11)
  6858     CALL 'kxdfhei1' USING DFHEIV0,
  6859           ERACCT-ID,
  6860           DFHEIV11,
  6861           DFHEIV99
  6862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6863
  6864
  6865 1599-EXIT.
  6866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 130
* EL1278.cbl
  6868 1600-LOCATE-BENEFIT  SECTION.
  6869
  6870* EXEC CICS HANDLE CONDITION
  6871*        NOTFND  (1699-EXIT)
  6872*    END-EXEC.
  6873*    MOVE '"$I                   ! '' #00006617' TO DFHEIV0
  6874     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6875     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6876     MOVE X'2720233030303036363137' TO DFHEIV0(25:11)
  6877     CALL 'kxdfhei1' USING DFHEIV0
  6878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6879
  6880
  6881     MOVE SPACES                 TO  WS-KIND.
  6882     MOVE ZERO                   TO  WS-NOT-FOUND.
  6883     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6884     MOVE SPACES                 TO  WS-CF-STATE.
  6885     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  6886
  6887
  6888* EXEC CICS READ
  6889*        DATASET  (ELCNTL-ID)
  6890*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6891*        SET      (ADDRESS OF CONTROL-FILE)
  6892*        GTEQ
  6893*    END-EXEC.
  6894*    MOVE '&"S        G          (   #00006627' TO DFHEIV0
  6895     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6897     MOVE X'2020233030303036363237' TO DFHEIV0(25:11)
  6898     CALL 'kxdfhei1' USING DFHEIV0,
  6899           ELCNTL-ID,
  6900           DFHEIV20,
  6901           DFHEIV99,
  6902           WS-CF-CONTROL-PRIMARY,
  6903           DFHEIV99,
  6904           DFHEIV99,
  6905           DFHEIV99
  6906     SET ADDRESS OF CONTROL-FILE TO
  6907         DFHEIV20
  6908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6909
  6910
  6911*    SERVICE RELOAD CONTROL-FILE.
  6912
  6913     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  6914       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  6915         GO TO 1699-EXIT.
  6916
  6917     MOVE +1                     TO  WS-INDEX.
  6918
  6919 1610-LOOKUP-BENEFIT.
  6920     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  6921         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  6922                                 TO  WS-KIND
  6923         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6924                                 TO  WS-CALC-CD
  6925         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 131
* EL1278.cbl
  6926                                 TO  WS-BENEFIT-DESCRIP
  6927         MOVE +1                 TO  WS-NOT-FOUND
  6928         GO TO 1699-EXIT.
  6929
  6930     IF CF-BENEFIT-CODE (WS-INDEX)
  6931             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  6932         GO TO 1699-EXIT.
  6933
  6934     IF WS-INDEX  IS LESS THAN  +8
  6935         ADD +1                  TO  WS-INDEX
  6936         GO TO 1610-LOOKUP-BENEFIT.
  6937
  6938 1699-EXIT.
  6939     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 132
* EL1278.cbl
  6941 1700-WRITE-CERT-NOTE      SECTION.
  6942
  6943     IF NOT MODIFY-CERT-CAP
  6944         MOVE 'UPDATE'           TO  SM-READ
  6945         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  6946         MOVE ER-0070            TO  EMI-ERROR
  6947         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6948         GO TO 8200-SEND-DATAONLY.
  6949
  6950**MOVE CANCEL QUOTE NOTE INFO
  6951     IF PI-LF-REFUND-AMT NUMERIC
  6952        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  6953        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  6954     ELSE
  6955        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  6956                                    PI-LF-REFUND-AMT
  6957        MOVE SPACE               TO WS-CN-LF-REF-METH
  6958                                    PI-LF-REFUND-METH.
  6959
  6960     IF PI-AH-REFUND-AMT NUMERIC
  6961        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  6962        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  6963     ELSE
  6964        MOVE ZERO                TO WS-CN-AH-AMT-RF
  6965                                    PI-AH-REFUND-AMT
  6966        MOVE SPACE               TO WS-CN-AH-REF-METH
  6967                                    PI-AH-REFUND-METH.
  6968
  6969     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  6970                                   PI-AH-REFUND-AMT.
  6971
  6972     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  6973
  6974     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  6975     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  6976     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  6977        MOVE PI-LF-CANCEL-DATE-ED
  6978                                 TO WS-CN-CANCEL-DT
  6979     ELSE
  6980        MOVE PI-AH-CANCEL-DATE-ED
  6981                                 TO WS-CN-CANCEL-DT.
  6982** READ ERNOTE FILE
  6983     MOVE PI-CARRIER             TO WS-CN-CARRIER.
  6984     MOVE PI-GROUPING            TO WS-CN-GROUPING.
  6985     MOVE PI-STATE               TO WS-CN-STATE.
  6986     MOVE PI-ACCOUNT             TO WS-CN-ACCOUNT.
  6987     MOVE PI-CERT-PRIME          TO WS-CN-CERT-PRIME.
  6988     MOVE PI-CERT-SFX            TO WS-CN-CERT-SFX.
  6989     MOVE PI-CERT-EFF-DT         TO WS-CN-CERT-EFF-DT.
  6990     MOVE PI-COMPANY-CD          TO WS-CN-COMPANY-CD.
  6991     MOVE SPACES                 TO CERTIFICATE-NOTE.
  6992
  6993
  6994* EXEC CICS READ
  6995*        EQUAL
  6996*        DATASET  (ERNOTE-ID)
  6997*        INTO     (CERTIFICATE-NOTE)
  6998*        RIDFLD   (WS-CN-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 133
* EL1278.cbl
  6999*        RESP     (WS-RESPONSE)
  7000*        UPDATE
  7001*    END-EXEC.
  7002     MOVE LENGTH OF
  7003      CERTIFICATE-NOTE
  7004       TO DFHEIV11
  7005*    MOVE '&"IL       EU         (  N#00006716' TO DFHEIV0
  7006     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7007     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7008     MOVE X'204E233030303036373136' TO DFHEIV0(25:11)
  7009     CALL 'kxdfhei1' USING DFHEIV0,
  7010           ERNOTE-ID,
  7011           CERTIFICATE-NOTE,
  7012           DFHEIV11,
  7013           WS-CN-CONTROL-PRIMARY,
  7014           DFHEIV99,
  7015           DFHEIV99,
  7016           DFHEIV99
  7017     MOVE EIBRESP  TO WS-RESPONSE
  7018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7019
  7020
  7021     IF WS-RESP-NOTFND
  7022         GO TO 1750-WRITE-NOTE.
  7023
  7024     MOVE +0                     TO WS-SUB1.
  7025
  7026 1710-BUILD-NOTE-LINE.
  7027     ADD +1                      TO WS-SUB1.
  7028
  7029     IF WS-SUB1 GREATER 10
  7030        MOVE ER-8161            TO  EMI-ERROR
  7031        PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7032        GO TO 8200-SEND-DATAONLY.
  7033
  7034     IF CN-LINE (WS-SUB1) GREATER SPACES
  7035        GO TO 1710-BUILD-NOTE-LINE
  7036     ELSE
  7037        MOVE WS-CAN-QUOTE-NOTE   TO CN-LINE (WS-SUB1).
  7038
  7039     MOVE PI-PROCESSOR-ID        TO CN-LAST-MAINT-USER.
  7040     MOVE EIBTIME                TO CN-LAST-MAINT-HHMMSS.
  7041     MOVE SAVE-BIN-DATE          TO CN-LAST-MAINT-DT.
  7042
  7043
  7044* EXEC CICS REWRITE
  7045*        FROM      (CERTIFICATE-NOTE)
  7046*        DATASET   (ERNOTE-ID)
  7047*    END-EXEC.
  7048     MOVE LENGTH OF
  7049      CERTIFICATE-NOTE
  7050       TO DFHEIV11
  7051*    MOVE '&& L                  %   #00006747' TO DFHEIV0
  7052     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7053     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7054     MOVE X'2020233030303036373437' TO DFHEIV0(25:11)
  7055     CALL 'kxdfhei1' USING DFHEIV0,
  7056           ERNOTE-ID,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 134
* EL1278.cbl
  7057           CERTIFICATE-NOTE,
  7058           DFHEIV11,
  7059           DFHEIV99
  7060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7061
  7062
  7063     MOVE ER-8160                TO EMI-ERROR.
  7064     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7065     GO TO 8200-SEND-DATAONLY.
  7066
  7067 1750-WRITE-NOTE.
  7068
  7069     MOVE SPACES                 TO CERTIFICATE-NOTE.
  7070     MOVE 'CN'                   TO CN-RECORD-ID.
  7071     MOVE PI-CARRIER             TO CN-CARRIER.
  7072     MOVE PI-GROUPING            TO CN-GROUPING.
  7073     MOVE PI-STATE               TO CN-STATE.
  7074     MOVE PI-ACCOUNT             TO CN-ACCOUNT.
  7075     MOVE PI-CERT-PRIME          TO CN-CERT-PRIME.
  7076     MOVE PI-CERT-SFX            TO CN-CERT-SFX.
  7077     MOVE PI-CERT-EFF-DT         TO CN-CERT-EFF-DT.
  7078     MOVE PI-COMPANY-CD          TO CN-COMPANY-CD.
  7079     MOVE ZEROS                  TO CN-BILLING-START-LINE-NO.
  7080     MOVE ZEROS                  TO CN-BILLING-END-LINE-NO.
  7081
  7082     MOVE ZERO                   TO WS-SUB1.
  7083 1760-BUILD-NOTE-LINES.
  7084     ADD +1                      TO WS-SUB1.
  7085
  7086     IF WS-SUB1 GREATER +10
  7087        GO TO 1770-WRITE-NEW-NOTE.
  7088
  7089     IF WS-SUB1 EQUAL +1
  7090        MOVE WS-CAN-QUOTE-NOTE   TO CN-LINE (WS-SUB1)
  7091     ELSE
  7092        MOVE SPACES              TO CN-LINE (WS-SUB1).
  7093
  7094     GO TO 1760-BUILD-NOTE-LINES.
  7095
  7096 1770-WRITE-NEW-NOTE.
  7097
  7098     MOVE PI-PROCESSOR-ID        TO CN-LAST-MAINT-USER.
  7099     MOVE EIBTIME                TO CN-LAST-MAINT-HHMMSS.
  7100     MOVE SAVE-BIN-DATE          TO CN-LAST-MAINT-DT.
  7101
  7102
  7103* EXEC CICS WRITE
  7104*        FROM      (CERTIFICATE-NOTE)
  7105*        DATASET   (ERNOTE-ID)
  7106*        RIDFLD    (CN-CONTROL-PRIMARY)
  7107*    END-EXEC.
  7108     MOVE LENGTH OF
  7109      CERTIFICATE-NOTE
  7110       TO DFHEIV11
  7111*    MOVE '&$ L                  ''   #00006791' TO DFHEIV0
  7112     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7114     MOVE X'2020233030303036373931' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 135
* EL1278.cbl
  7115     CALL 'kxdfhei1' USING DFHEIV0,
  7116           ERNOTE-ID,
  7117           CERTIFICATE-NOTE,
  7118           DFHEIV11,
  7119           CN-CONTROL-PRIMARY,
  7120           DFHEIV99,
  7121           DFHEIV99
  7122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7123
  7124
  7125     MOVE ER-8160                TO EMI-ERROR.
  7126     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7127     GO TO 8200-SEND-DATAONLY.
  7128
  7129 1799-EXIT.
  7130     EXIT.
  7131 1800-READ-ELCERT-UPDATE.
  7132     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  7133     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  7134     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  7135     MOVE PI-STATE               TO  WS-CM-STATE.
  7136     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  7137     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  7138     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  7139     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  7140
  7141* EXEC CICS READ
  7142*        UPDATE
  7143*        DATASET  (ELCERT-ID)
  7144*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  7145*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7146*        RESP     (WS-RESPONSE)
  7147*    END-EXEC
  7148*    MOVE '&"S        EU         (  N#00006812' TO DFHEIV0
  7149     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7150     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7151     MOVE X'204E233030303036383132' TO DFHEIV0(25:11)
  7152     CALL 'kxdfhei1' USING DFHEIV0,
  7153           ELCERT-ID,
  7154           DFHEIV20,
  7155           DFHEIV99,
  7156           WS-CM-CONTROL-PRIMARY,
  7157           DFHEIV99,
  7158           DFHEIV99,
  7159           DFHEIV99
  7160     SET ADDRESS OF CERTIFICATE-MASTER TO
  7161         DFHEIV20
  7162     MOVE EIBRESP  TO WS-RESPONSE
  7163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7164     .
  7165 1800-EXIT.
  7166     EXIT.
  7167 1810-REWRITE-ELCERT.
  7168
  7169* EXEC CICS REWRITE
  7170*        FROM      (CERTIFICATE-MASTER)
  7171*        DATASET   (ELCERT-ID)
  7172*        RESP     (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 136
* EL1278.cbl
  7173*    END-EXEC.
  7174     MOVE LENGTH OF
  7175      CERTIFICATE-MASTER
  7176       TO DFHEIV11
  7177*    MOVE '&& L                  %  N#00006823' TO DFHEIV0
  7178     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7179     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7180     MOVE X'204E233030303036383233' TO DFHEIV0(25:11)
  7181     CALL 'kxdfhei1' USING DFHEIV0,
  7182           ELCERT-ID,
  7183           CERTIFICATE-MASTER,
  7184           DFHEIV11,
  7185           DFHEIV99
  7186     MOVE EIBRESP  TO WS-RESPONSE
  7187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7188
  7189     .
  7190 1810-EXIT.
  7191     EXIT.
  7192 5000-GET-LF-AM-REM-TERM.
  7193     MOVE +1                     TO SUB3.
  7194
  7195 5100-GET-LF-AM-REM-TERM.
  7196     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  7197        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  7198           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  7199                         TO WS-SAVE-ALLOWABLE-BENEFIT
  7200           GO TO 5300-MOVE-LF-REM-TERM.
  7201
  7202     IF SUB3 LESS THAN +20
  7203        ADD +1                   TO SUB3
  7204        GO TO 5100-GET-LF-AM-REM-TERM.
  7205
  7206     MOVE +1                     TO SUB3.
  7207
  7208     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  7209         GO TO 5200-EDIT-FOR-NINETY-LF.
  7210
  7211 5100-GET-LF-DMD-AM-REM-TERM.
  7212
  7213     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  7214        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  7215           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  7216                         TO WS-SAVE-ALLOWABLE-BENEFIT
  7217           GO TO 5300-MOVE-LF-REM-TERM.
  7218
  7219     IF SUB3 LESS THAN +30
  7220        ADD +1                   TO SUB3
  7221        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  7222
  7223     MOVE +1                     TO SUB3.
  7224
  7225 5200-EDIT-FOR-NINETY-LF.
  7226
  7227***************************************************************
  7228*                                                             *
  7229*    NINETY BENEFIT PLAN TYPES:                               *
  7230*                                                             *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 137
* EL1278.cbl
  7231*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  7232*      92 = ALL GROUP REDUCING BENEFITS                       *
  7233*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  7234*      94 = ALL GROUP LEVEL BENEFITS                          *
  7235*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  7236*           BENEFIT CONTROLS.                                 *
  7237*      99 = ALL BENEFITS                                      *
  7238*                                                             *
  7239***************************************************************
  7240
  7241     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  7242                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  7243
  7244     IF (AM-BENEFIT-CODE (SUB3) = '99')
  7245       AND
  7246        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7247           GO TO 5300-MOVE-LF-REM-TERM.
  7248
  7249     IF (AM-BENEFIT-CODE (SUB3) = '91')
  7250       AND
  7251        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7252        IF CF-REDUCING (WS-INDEX)
  7253           IF CM-INDIVIDUAL
  7254               GO TO 5300-MOVE-LF-REM-TERM.
  7255
  7256     IF (AM-BENEFIT-CODE (SUB3) = '92')
  7257       AND
  7258        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7259        IF CF-REDUCING (WS-INDEX)
  7260           IF CM-GROUP
  7261               GO TO 5300-MOVE-LF-REM-TERM.
  7262
  7263     IF (AM-BENEFIT-CODE (SUB3) = '93')
  7264       AND
  7265        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7266        IF CF-LEVEL (WS-INDEX)
  7267           IF CM-INDIVIDUAL
  7268               GO TO 5300-MOVE-LF-REM-TERM.
  7269
  7270     IF (AM-BENEFIT-CODE (SUB3) = '94')
  7271       AND
  7272        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7273        IF CF-LEVEL (WS-INDEX)
  7274           IF CM-GROUP
  7275               GO TO 5300-MOVE-LF-REM-TERM.
  7276
  7277     IF (AM-BENEFIT-CODE (SUB3) = '98')
  7278       AND
  7279        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7280            GO TO 5300-MOVE-LF-REM-TERM.
  7281
  7282     IF SUB3 LESS THAN +20
  7283        ADD +1           TO SUB3
  7284          GO TO 5200-EDIT-FOR-NINETY-LF.
  7285
  7286     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  7287
  7288     IF PI-COMPANY-ID NOT EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 138
* EL1278.cbl
  7289         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  7290         GO TO 5900-EXIT.
  7291
  7292     MOVE 1                       TO SUB3.
  7293
  7294 5200-EDIT-FOR-DMD-NINETY-LF.
  7295
  7296     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  7297                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  7298
  7299     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  7300       AND
  7301        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7302           GO TO 5300-MOVE-LF-REM-TERM.
  7303
  7304     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  7305       AND
  7306        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7307        IF CF-REDUCING (WS-INDEX)
  7308           IF CM-INDIVIDUAL
  7309               GO TO 5300-MOVE-LF-REM-TERM.
  7310
  7311     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  7312       AND
  7313        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7314        IF CF-REDUCING (WS-INDEX)
  7315           IF CM-GROUP
  7316               GO TO 5300-MOVE-LF-REM-TERM.
  7317
  7318     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  7319       AND
  7320        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7321        IF CF-LEVEL (WS-INDEX)
  7322           IF CM-INDIVIDUAL
  7323               GO TO 5300-MOVE-LF-REM-TERM.
  7324
  7325     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  7326       AND
  7327        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7328        IF CF-LEVEL (WS-INDEX)
  7329           IF CM-GROUP
  7330               GO TO 5300-MOVE-LF-REM-TERM.
  7331
  7332     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  7333       AND
  7334        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  7335            GO TO 5300-MOVE-LF-REM-TERM.
  7336
  7337     IF SUB3 LESS THAN +30
  7338        ADD +1                   TO SUB3
  7339          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  7340
  7341     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  7342
  7343     GO TO 5900-EXIT.
  7344
  7345 5300-MOVE-LF-REM-TERM.
  7346     MOVE WS-SAVE-BENEFIT-REM-TERM
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 139
* EL1278.cbl
  7347                                 TO WS-LF-AM-REM-TERM-CALC.
  7348
  7349 5900-EXIT.
  7350      EXIT.
  7351
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 140
* EL1278.cbl
  7353
  7354 6000-GET-AH-AM-REM-TERM.
  7355     MOVE +1                     TO SUB3.
  7356
  7357 6100-GET-AH-AM-REM-TERM.
  7358
  7359     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7360        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  7361           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  7362                         TO WS-SAVE-ALLOWABLE-BENEFIT
  7363           GO TO 6300-MOVE-AH-REM-TERM.
  7364
  7365     IF SUB3 LESS THAN +20
  7366        ADD +1                   TO SUB3
  7367        GO TO 6100-GET-AH-AM-REM-TERM.
  7368
  7369     MOVE +1                     TO SUB3.
  7370
  7371     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  7372         GO TO 6200-EDIT-FOR-NINETY-AH.
  7373
  7374 6100-GET-AH-AM-DMD-REM-TERM.
  7375     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7376        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  7377           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  7378                         TO WS-SAVE-ALLOWABLE-BENEFIT
  7379           GO TO 6300-MOVE-AH-REM-TERM.
  7380
  7381     IF SUB3 LESS THAN +30
  7382        ADD +1                   TO SUB3
  7383        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  7384
  7385     MOVE +1                     TO SUB3.
  7386
  7387 6200-EDIT-FOR-NINETY-AH.
  7388
  7389***************************************************************
  7390*                                                             *
  7391*    NINETY BENEFIT PLAN TYPES:                               *
  7392*                                                             *
  7393*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  7394*      92 = ALL GROUP REDUCING BENEFITS.                      *
  7395*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  7396*           BENEFIT CONTROLS.                                 *
  7397*      99 = ALL BENEFITS.                                     *
  7398*                                                             *
  7399***************************************************************
  7400
  7401     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  7402                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  7403
  7404     IF AM-BENEFIT-CODE (SUB3) = '99'
  7405       AND
  7406        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7407           GO TO 6300-MOVE-AH-REM-TERM.
  7408
  7409     IF AM-BENEFIT-CODE (SUB3) = '91'
  7410       AND
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 141
* EL1278.cbl
  7411        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7412           IF CM-INDIVIDUAL
  7413               GO TO 6300-MOVE-AH-REM-TERM.
  7414
  7415     IF AM-BENEFIT-CODE (SUB3) = '92'
  7416       AND
  7417        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7418           IF CM-GROUP
  7419               GO TO 6300-MOVE-AH-REM-TERM.
  7420
  7421     IF AM-BENEFIT-CODE (SUB3) = '98'
  7422       AND
  7423        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7424           GO TO 6300-MOVE-AH-REM-TERM.
  7425
  7426     IF SUB3 LESS THAN +20
  7427        ADD +1                    TO SUB3
  7428        GO TO 6200-EDIT-FOR-NINETY-AH.
  7429
  7430     MOVE +1                      TO SUB3.
  7431
  7432     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  7433         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  7434         GO TO 6900-EXIT.
  7435
  7436 6200-EDIT-FOR-DMD-NINETY-AH.
  7437
  7438     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  7439                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  7440
  7441     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  7442       AND
  7443        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7444           GO TO 6300-MOVE-AH-REM-TERM.
  7445
  7446     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  7447       AND
  7448        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7449           IF CM-INDIVIDUAL
  7450               GO TO 6300-MOVE-AH-REM-TERM.
  7451
  7452     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  7453       AND
  7454        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7455           IF CM-GROUP
  7456               GO TO 6300-MOVE-AH-REM-TERM.
  7457
  7458     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  7459       AND
  7460        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  7461           GO TO 6300-MOVE-AH-REM-TERM.
  7462
  7463     IF SUB3 LESS THAN +30
  7464        ADD +1                   TO SUB3
  7465        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  7466
  7467     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  7468
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 142
* EL1278.cbl
  7469     GO TO 6900-EXIT.
  7470
  7471 6300-MOVE-AH-REM-TERM.
  7472
  7473     MOVE WS-SAVE-BENEFIT-REM-TERM
  7474                                 TO WS-AH-AM-REM-TERM-CALC.
  7475
  7476 6900-EXIT.
  7477      EXIT.
  7478
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 143
* EL1278.cbl
  7480 7000-GET-ERFORM     SECTION.
  7481
  7482* EXEC CICS HANDLE CONDITION
  7483*        NOTFND  (7000-EXIT)
  7484*    END-EXEC.
  7485*    MOVE '"$I                   ! ( #00007120' TO DFHEIV0
  7486     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7488     MOVE X'2820233030303037313230' TO DFHEIV0(25:11)
  7489     CALL 'kxdfhei1' USING DFHEIV0
  7490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7491
  7492
  7493     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  7494     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  7495     MOVE PI-STATE               TO  WS-FO-STATE.
  7496     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  7497     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  7498
  7499
  7500* EXEC CICS READ
  7501*        DATASET  (ERFORM-ID)
  7502*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  7503*        SET      (ADDRESS OF FORM-MASTER)
  7504*        GTEQ
  7505*    END-EXEC.
  7506*    MOVE '&"S        G          (   #00007130' TO DFHEIV0
  7507     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7508     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7509     MOVE X'2020233030303037313330' TO DFHEIV0(25:11)
  7510     CALL 'kxdfhei1' USING DFHEIV0,
  7511           ERFORM-ID,
  7512           DFHEIV20,
  7513           DFHEIV99,
  7514           WS-FO-CONTROL-PRIMARY,
  7515           DFHEIV99,
  7516           DFHEIV99,
  7517           DFHEIV99
  7518     SET ADDRESS OF FORM-MASTER TO
  7519         DFHEIV20
  7520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7521
  7522
  7523     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  7524        PI-STATE          EQUAL FO-STATE      AND
  7525        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  7526         MOVE 'Y'  TO WS-FORM-RECORD-SW
  7527         GO TO 7000-EXIT.
  7528 7000-EXIT.
  7529     EXIT.
  7530 7100-BENEFIT-SEARCH SECTION.
  7531
  7532     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  7533        MOVE +1                  TO  SUB4
  7534        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  7535
  7536     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  7537        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 144
* EL1278.cbl
  7538        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  7539 7100-EXIT.
  7540     EXIT.
  7541 7150-BENEFIT-LIFE-SEARCH.
  7542     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  7543       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  7544         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  7545          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  7546            IF FO-PLAN-REFUND-METHOD (SUB4)
  7547                    IS GREATER THAN SPACES
  7548               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  7549                                    WS-LF-FO-REFUND-CALC
  7550               GO TO 7150-EXIT.
  7551
  7552     IF SUB4 LESS THAN +40
  7553         ADD +1              TO SUB4
  7554         GO TO 7150-BENEFIT-LIFE-SEARCH.
  7555
  7556 7150-EXIT.
  7557     EXIT.
  7558 7250-BENEFIT-AH-SEARCH.
  7559     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  7560       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  7561         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  7562          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  7563            IF FO-PLAN-REFUND-METHOD (SUB4)
  7564                    IS GREATER THAN SPACES
  7565               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  7566                                    WS-AH-FO-REFUND-CALC
  7567               GO TO 7250-EXIT.
  7568
  7569     IF SUB4 LESS THAN +40
  7570         ADD +1              TO SUB4
  7571         GO TO 7250-BENEFIT-AH-SEARCH.
  7572
  7573 7250-EXIT.
  7574     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 145
* EL1278.cbl
  7576
  7577 8100-SEND-INITIAL-MAP  SECTION.
  7578     MOVE SAVE-DATE              TO  HDATEO.
  7579     MOVE EIBTIME                TO  TIME-IN.
  7580     MOVE TIME-OUT               TO  HTIMEO.
  7581     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  7582     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  7583     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  7584     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  7585
  7586     IF CM-LF-BENEFIT-CD = '00'
  7587         MOVE -1                 TO  HACANCL
  7588     ELSE
  7589         MOVE -1                 TO  HLCANCL.
  7590
  7591     IF PI-COMPANY-ID  EQUAL 'NCL'
  7592         MOVE AL-SANOF           TO  PFKEY11A.
  7593
  7594
  7595* EXEC CICS SEND
  7596*        FROM    (EL127HO)
  7597*        MAPSET  (MAPSET-NAME)
  7598*        MAP     (MAP-NAME)
  7599*        CURSOR
  7600*        ERASE
  7601*    END-EXEC.
  7602     MOVE LENGTH OF
  7603      EL127HO
  7604       TO DFHEIV12
  7605     MOVE -1
  7606       TO DFHEIV11
  7607*    MOVE '8$     CT  E    H L F ,   #00007208' TO DFHEIV0
  7608     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7609     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7610     MOVE X'2020233030303037323038' TO DFHEIV0(25:11)
  7611     CALL 'kxdfhei1' USING DFHEIV0,
  7612           MAP-NAME,
  7613           EL127HO,
  7614           DFHEIV12,
  7615           MAPSET-NAME,
  7616           DFHEIV99,
  7617           DFHEIV99,
  7618           DFHEIV99,
  7619           DFHEIV11,
  7620           DFHEIV99,
  7621           DFHEIV99,
  7622           DFHEIV99
  7623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7624
  7625
  7626     GO TO 9000-RETURN-TRAN.
  7627
  7628 8200-SEND-DATAONLY  SECTION.
  7629     IF FIRST-ENTRY
  7630         GO TO 8100-SEND-INITIAL-MAP.
  7631
  7632     MOVE SAVE-DATE              TO  HDATEO.
  7633     MOVE EIBTIME                TO  TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 146
* EL1278.cbl
  7634     MOVE TIME-OUT               TO  HTIMEO.
  7635     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  7636     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  7637     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  7638     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  7639     MOVE -1                     TO  HLCANCL.
  7640
  7641
  7642* EXEC CICS SEND DATAONLY
  7643*        FROM    (EL127HO)
  7644*        MAPSET  (MAPSET-NAME)
  7645*        MAP     (MAP-NAME)
  7646*        CURSOR
  7647*    END-EXEC.
  7648     MOVE LENGTH OF
  7649      EL127HO
  7650       TO DFHEIV12
  7651     MOVE -1
  7652       TO DFHEIV11
  7653*    MOVE '8$D    CT       H L F ,   #00007231' TO DFHEIV0
  7654     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  7655     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7656     MOVE X'2020233030303037323331' TO DFHEIV0(25:11)
  7657     CALL 'kxdfhei1' USING DFHEIV0,
  7658           MAP-NAME,
  7659           EL127HO,
  7660           DFHEIV12,
  7661           MAPSET-NAME,
  7662           DFHEIV99,
  7663           DFHEIV99,
  7664           DFHEIV99,
  7665           DFHEIV11,
  7666           DFHEIV99,
  7667           DFHEIV99,
  7668           DFHEIV99
  7669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7670
  7671
  7672     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 147
* EL1278.cbl
  7674 8300-SEND-TEXT  SECTION.
  7675
  7676* EXEC CICS SEND TEXT
  7677*        FROM    (LOGOFF-TEXT)
  7678*        LENGTH  (LOGOFF-LENGTH)
  7679*        ERASE
  7680*        FREEKB
  7681*    END-EXEC.
  7682*    MOVE '8&      T  E F  H   F -   #00007241' TO DFHEIV0
  7683     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  7684     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  7685     MOVE X'2020233030303037323431' TO DFHEIV0(25:11)
  7686     CALL 'kxdfhei1' USING DFHEIV0,
  7687           LOGOFF-TEXT,
  7688           LOGOFF-LENGTH,
  7689           DFHEIV99,
  7690           DFHEIV99,
  7691           DFHEIV99,
  7692           DFHEIV99,
  7693           DFHEIV99,
  7694           DFHEIV99,
  7695           DFHEIV99,
  7696           DFHEIV99,
  7697           DFHEIV99,
  7698           DFHEIV99
  7699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7700
  7701
  7702
  7703* EXEC CICS RETURN
  7704*    END-EXEC.
  7705*    MOVE '.(                    &   #00007248' TO DFHEIV0
  7706     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7707     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7708     MOVE X'2020233030303037323438' TO DFHEIV0(25:11)
  7709     CALL 'kxdfhei1' USING DFHEIV0,
  7710           DFHEIV99,
  7711           DFHEIV99,
  7712           DFHEIV99,
  7713           DFHEIV99,
  7714           DFHEIV99
  7715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7716
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 148
* EL1278.cbl
  7718 8600-DEEDIT  SECTION.
  7719
  7720* EXEC CICS BIF DEEDIT
  7721*        FIELD   (DEEDIT-FIELD)
  7722*        LENGTH  (15)
  7723*    END-EXEC.
  7724     MOVE 15
  7725       TO DFHEIV11
  7726*    MOVE '@"L                   #   #00007252' TO DFHEIV0
  7727     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7728     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7729     MOVE X'2020233030303037323532' TO DFHEIV0(25:11)
  7730     CALL 'kxdfhei1' USING DFHEIV0,
  7731           DEEDIT-FIELD,
  7732           DFHEIV11
  7733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7734
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 149
* EL1278.cbl
  7736 8700-UNAUTHORIZED-ACCESS  SECTION.
  7737     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  7738
  7739     GO TO 8300-SEND-TEXT.
  7740
  7741 8800-PF23  SECTION.
  7742     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  7743     MOVE XCTL-005               TO  PGM-NAME.
  7744
  7745     GO TO 9200-XCTL.
  7746
  7747 8900-RETURN-CICS  SECTION.
  7748
  7749* EXEC CICS RETURN
  7750*    END-EXEC.
  7751*    MOVE '.(                    &   #00007269' TO DFHEIV0
  7752     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7753     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7754     MOVE X'2020233030303037323639' TO DFHEIV0(25:11)
  7755     CALL 'kxdfhei1' USING DFHEIV0,
  7756           DFHEIV99,
  7757           DFHEIV99,
  7758           DFHEIV99,
  7759           DFHEIV99,
  7760           DFHEIV99
  7761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7762
  7763
  7764 9000-RETURN-TRAN  SECTION.
  7765     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  7766     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  7767
  7768
  7769* EXEC CICS RETURN
  7770*        TRANSID   (TRANS-ID)
  7771*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  7772*        LENGTH    (PI-COMM-LENGTH)
  7773*    END-EXEC.
  7774*    MOVE '.(CT                  &   #00007276' TO DFHEIV0
  7775     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  7776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7777     MOVE X'2020233030303037323736' TO DFHEIV0(25:11)
  7778     CALL 'kxdfhei1' USING DFHEIV0,
  7779           TRANS-ID,
  7780           PROGRAM-INTERFACE-BLOCK,
  7781           PI-COMM-LENGTH,
  7782           DFHEIV99,
  7783           DFHEIV99
  7784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7785
  7786
  7787 9100-RETURN-MAIN-MENU  SECTION.
  7788     MOVE XCTL-126               TO  PGM-NAME.
  7789
  7790     GO TO 9200-XCTL.
  7791
  7792 9200-XCTL  SECTION.
  7793
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 150
* EL1278.cbl
  7794* EXEC CICS XCTL
  7795*        PROGRAM   (PGM-NAME)
  7796*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  7797*        LENGTH    (PI-COMM-LENGTH)
  7798*    END-EXEC.
  7799*    MOVE '.$C                   $   #00007288' TO DFHEIV0
  7800     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7801     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7802     MOVE X'2020233030303037323838' TO DFHEIV0(25:11)
  7803     CALL 'kxdfhei1' USING DFHEIV0,
  7804           PGM-NAME,
  7805           PROGRAM-INTERFACE-BLOCK,
  7806           PI-COMM-LENGTH
  7807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7808
  7809
  7810 9300-CLEAR  SECTION.
  7811     MOVE ' '                    TO  PI-PEND-SW.
  7812     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  7813
  7814     GO TO 9200-XCTL.
  7815
  7816 9400-PF12  SECTION.
  7817     MOVE XCTL-010               TO  PGM-NAME.
  7818
  7819     GO TO 9200-XCTL.
  7820
  7821 9500-PGMID-ERROR  SECTION.
  7822
  7823* EXEC CICS HANDLE CONDITION
  7824*        PGMIDERR  (8300-SEND-TEXT)
  7825*    END-EXEC.
  7826*    MOVE '"$L                   ! ) #00007306' TO DFHEIV0
  7827     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  7828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7829     MOVE X'2920233030303037333036' TO DFHEIV0(25:11)
  7830     CALL 'kxdfhei1' USING DFHEIV0
  7831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7832
  7833
  7834     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  7835     MOVE ' '                    TO  PI-ENTRY-CD-1.
  7836     MOVE XCTL-005               TO  PGM-NAME.
  7837     MOVE PGM-NAME               TO  LOGOFF-PGM.
  7838     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  7839
  7840     GO TO 9200-XCTL.
  7841
  7842 9600-DATE-LINK  SECTION.
  7843     MOVE LINK-ELDATCV           TO  PGM-NAME
  7844
  7845
  7846* EXEC CICS LINK
  7847*        PROGRAM   (PGM-NAME)
  7848*        COMMAREA  (DATE-CONVERSION-DATA)
  7849*        LENGTH    (DC-COMM-LENGTH)
  7850*    END-EXEC.
  7851*    MOVE '."C                   ''   #00007321' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 151
* EL1278.cbl
  7852     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7854     MOVE X'2020233030303037333231' TO DFHEIV0(25:11)
  7855     CALL 'kxdfhei1' USING DFHEIV0,
  7856           PGM-NAME,
  7857           DATE-CONVERSION-DATA,
  7858           DC-COMM-LENGTH,
  7859           DFHEIV99,
  7860           DFHEIV99,
  7861           DFHEIV99
  7862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7863
  7864
  7865
  7866 9700-ERROR-FORMAT  SECTION.
  7867     IF NOT EMI-ERRORS-COMPLETE
  7868         MOVE LINK-001               TO  PGM-NAME
  7869
  7870* EXEC CICS LINK
  7871*            PROGRAM   (PGM-NAME)
  7872*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  7873*            LENGTH    (EMI-COMM-LENGTH)
  7874*        END-EXEC.
  7875*    MOVE '."C                   ''   #00007331' TO DFHEIV0
  7876     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7877     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7878     MOVE X'2020233030303037333331' TO DFHEIV0(25:11)
  7879     CALL 'kxdfhei1' USING DFHEIV0,
  7880           PGM-NAME,
  7881           ERROR-MESSAGE-INTERFACE-BLOCK,
  7882           EMI-COMM-LENGTH,
  7883           DFHEIV99,
  7884           DFHEIV99,
  7885           DFHEIV99
  7886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7887
  7888
  7889 9799-EXIT.
  7890     EXIT.
  7891
  7892 9800-SECURITY-VIOLATION  SECTION.
  7893*                            COPY ELCSCTP.
  7894******************************************************************
  7895*                                                                *
  7896*                            ELCSCTP                             *
  7897*                            VMOD=2.001                          *
  7898*                                                                *
  7899*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  7900******************************************************************
  7901
  7902
  7903     MOVE EIBDATE          TO SM-JUL-DATE.
  7904     MOVE EIBTRMID         TO SM-TERMID.
  7905     MOVE THIS-PGM         TO SM-PGM.
  7906     MOVE EIBTIME          TO TIME-IN.
  7907     MOVE TIME-OUT         TO SM-TIME.
  7908     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  7909
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 152
* EL1278.cbl
  7910
  7911* EXEC CICS LINK
  7912*         PROGRAM  ('EL003')
  7913*         COMMAREA (SECURITY-MESSAGE)
  7914*         LENGTH   (80)
  7915*    END-EXEC.
  7916     MOVE 'EL003' TO DFHEIV1
  7917     MOVE 80
  7918       TO DFHEIV11
  7919*    MOVE '."C                   ''   #00007358' TO DFHEIV0
  7920     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7921     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7922     MOVE X'2020233030303037333538' TO DFHEIV0(25:11)
  7923     CALL 'kxdfhei1' USING DFHEIV0,
  7924           DFHEIV1,
  7925           SECURITY-MESSAGE,
  7926           DFHEIV11,
  7927           DFHEIV99,
  7928           DFHEIV99,
  7929           DFHEIV99
  7930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7931
  7932
  7933******************************************************************
  7934
  7935
  7936 9899-EXIT.
  7937     EXIT.
  7938
  7939 9900-ABEND  SECTION.
  7940     MOVE LINK-004               TO  PGM-NAME.
  7941     MOVE DFHEIBLK               TO  EMI-LINE1.
  7942
  7943
  7944* EXEC CICS LINK
  7945*        PROGRAM   (PGM-NAME)
  7946*        COMMAREA  (EMI-LINE1)
  7947*        LENGTH    (72)
  7948*    END-EXEC.
  7949     MOVE 72
  7950       TO DFHEIV11
  7951*    MOVE '."C                   ''   #00007374' TO DFHEIV0
  7952     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7953     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7954     MOVE X'2020233030303037333734' TO DFHEIV0(25:11)
  7955     CALL 'kxdfhei1' USING DFHEIV0,
  7956           PGM-NAME,
  7957           EMI-LINE1,
  7958           DFHEIV11,
  7959           DFHEIV99,
  7960           DFHEIV99,
  7961           DFHEIV99
  7962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7963
  7964
  7965     MOVE -1                     TO  HLCANCL.
  7966
  7967     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 11:59 Page 153
* EL1278.cbl
  7968
  7969 9999-LAST-PARAGRAPH.
  7970
  7971* GOBACK.
  7972     MOVE '9%                    "   ' TO DFHEIV0
  7973     MOVE 'EL1278' TO DFHEIV1
  7974     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7975     GOBACK.
  7976
  7977 9999-DFHBACK SECTION.
  7978     MOVE '9%                    "   ' TO DFHEIV0
  7979     MOVE 'EL1278' TO DFHEIV1
  7980     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7981     GOBACK.
  7982 9999-DFHEXIT.
  7983     IF DFHEIGDJ EQUAL 0001
  7984         NEXT SENTENCE
  7985     ELSE IF DFHEIGDJ EQUAL 2
  7986         GO TO 9500-PGMID-ERROR,
  7987               9900-ABEND
  7988         DEPENDING ON DFHEIGDI
  7989     ELSE IF DFHEIGDJ EQUAL 3
  7990         GO TO 0910-NOT-FOUND
  7991         DEPENDING ON DFHEIGDI
  7992     ELSE IF DFHEIGDJ EQUAL 4
  7993         GO TO 1010-NOTFND,
  7994               1020-NOTOPEN
  7995         DEPENDING ON DFHEIGDI
  7996     ELSE IF DFHEIGDJ EQUAL 5
  7997         GO TO 1290-ACCT-NOT-FOUND,
  7998               1290-ACCT-NOT-FOUND
  7999         DEPENDING ON DFHEIGDI
  8000     ELSE IF DFHEIGDJ EQUAL 6
  8001         GO TO 0580-ACCT-NOT-FOUND,
  8002               0580-ACCT-NOT-FOUND
  8003         DEPENDING ON DFHEIGDI
  8004     ELSE IF DFHEIGDJ EQUAL 7
  8005         GO TO 1699-EXIT
  8006         DEPENDING ON DFHEIGDI
  8007     ELSE IF DFHEIGDJ EQUAL 8
  8008         GO TO 7000-EXIT
  8009         DEPENDING ON DFHEIGDI
  8010     ELSE IF DFHEIGDJ EQUAL 9
  8011         GO TO 8300-SEND-TEXT
  8012         DEPENDING ON DFHEIGDI.
  8013     MOVE '9%                    "   ' TO DFHEIV0
  8014     MOVE 'EL1278' TO DFHEIV1
  8015     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8016     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        6004     Code:       18564
