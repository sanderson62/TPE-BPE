* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6316.cbl
* Options: int("EL6316.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6316.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6316.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6316.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6316.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6316.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 110410   2007070900001  PEMA  ADD REFORMATIONS AND RESCISSIONS
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 072312   2011022800001  AJRA  NAPERSOFT MISC
    28* 091812 IR2012091400003  AJRA  CHANGE MSG 9999
    29* 101512   2011022800001  AJRA  FIX CLM RESC DEFAULT
    30*-----------------------------------------------------------------
    31*REMARKS.
    32*        TRANSACTION - EXBC - CANCEL CHANGES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6316.cbl
    34 ENVIRONMENT DIVISION.
    35 DATA DIVISION.
    36 WORKING-STORAGE SECTION.
    37 01  DFH-START PIC X(04).
    38 77  FILLER  PIC X(32)  VALUE '********************************'.
    39 77  FILLER  PIC X(32)  VALUE '*    EL6316 WORKING STORAGE    *'.
    40 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    41 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    42 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    43 77  W-ARCH-NUMBER               PIC 9(8) BINARY  VALUE ZEROS.
    44 77  w-prtsw                     pic x  value spaces.
    45 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    46 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    47     88  ACCT-FOUND                 VALUE 'Y'.
    48 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    49 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    50 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    51 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    52 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    53 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    54 77  s1                          pic s999 comp-3 value +0.
    55 77  s2                          pic s999 comp-3 value +0.
    56 77  WS-REASON-SW                PIC X  VALUE ' '.
    57     88  REASONS-FOUND                  VALUE 'Y'.
    58     88  REASONS-NOT-FOUND              VALUE 'N'.
    59 77  WS-STOP-SW                  PIC X  VALUE ' '.
    60     88  I-SAY-TO-STOP      VALUE 'Y'.
    61 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    62     88  NO-CERT-RW                 VALUE 'N'.
    63     88  CERT-RW                    VALUE 'Y'.
    64 77  WS-COMM-LENGTH              PIC 9(4) BINARY.
    65 01  P pointer.
    66 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    67 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    68 01  var-ptr pointer.
    69 01  env-var-len                 pic 9(4)  binary.
    70 01  rc                          pic 9(9)  binary.
    71 01  WS-KIXHOST                  PIC X(10).
    72 01  WS-KIXSYS.
    73     05  WS-KIX-FIL1             PIC X(10).
    74     05  WS-KIX-APPS             PIC X(10).
    75     05  WS-KIX-ENV              PIC X(10).
    76     05  WS-KIX-MYENV            PIC X(10).
    77     05  WS-KIX-SYS              PIC X(10).
    78*    COPY ELCSCTM.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCTM                             *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-MESSAGE.
    89     12  FILLER                          PIC X(30)
    90            VALUE '** LOGIC SECURITY VIOLATION -'.
    91     12  SM-READ                         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6316.cbl
    92     12  FILLER                          PIC X(5)
    93            VALUE ' PGM='.
    94     12  SM-PGM                          PIC X(6).
    95     12  FILLER                          PIC X(5)
    96            VALUE ' OPR='.
    97     12  SM-PROCESSOR-ID                 PIC X(4).
    98     12  FILLER                          PIC X(6)
    99            VALUE ' TERM='.
   100     12  SM-TERMID                       PIC X(4).
   101     12  FILLER                          PIC XX   VALUE SPACE.
   102     12  SM-JUL-DATE                     PIC 9(5).
   103     12  FILLER                          PIC X    VALUE SPACE.
   104     12  SM-TIME                         PIC 99.99.
   105
   106*    COPY ELCSCRTY.
   107******************************************************************
   108*                                                                *
   109*                                                                *
   110*                            ELCSCRTY                            *
   111*                            VMOD=2.001                          *
   112*                                                                *
   113*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   114*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   115*        SAVED IN PI-SECURITY-ADDRESS.                           *
   116*                                                                *
   117******************************************************************
   118 01  SECURITY-CONTROL.
   119     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   120     12  FILLER                       PIC XX    VALUE 'SC'.
   121     12  SC-CREDIT-CODES.
   122         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   123             20  SC-CREDIT-DISPLAY    PIC X.
   124             20  SC-CREDIT-UPDATE     PIC X.
   125     12  SC-CLAIMS-CODES.
   126         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   127             20  SC-CLAIMS-DISPLAY    PIC X.
   128             20  SC-CLAIMS-UPDATE     PIC X.
   129 01 srch-commarea.
   130*                                copy ELCADLTRSPI.
   131******************************************************************
   132*                   C H A N G E   L O G
   133*
   134* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   135*-----------------------------------------------------------------
   136*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   137* EFFECTIVE    NUMBER
   138*-----------------------------------------------------------------
   139* 060611    2011022800001  PEMA  NEW COPYBOOK
   140******************************************************************
   141****************************************
   142*  commarea for NaperSoft On Demand Admin services letters
   143*  (business logic input & output)
   144****************************************
   145     03  BL-INPUT.
   146         05  BL-DATA-SRCE        PIC X.
   147         05  BL-LETTER-ID        PIC XXXX.
   148         05  BL-CARRIER          PIC X.
   149         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6316.cbl
   150         05  BL-STATE            PIC XX.
   151         05  BL-ACCOUNT          PIC X(10).
   152         05  BL-EFF-DT           PIC X(10).
   153         05  BL-CERT-NO          PIC X(11).
   154         05  BL-BATCH-NO         PIC X(6).
   155         05  BL-BATCH-SEQ        PIC 9(8).
   156         05  BL-RESP-NO          PIC X(10).
   157         05  BL-NO-OF-COPIES     PIC 99.
   158         05  BL-PROC-ID          PIC XXXX.
   159         05  BL-COMP-ID          PIC XXX.
   160         05  BL-PRINT-NOW-SW     PIC X.
   161         05  BL-ENC-CD           PIC XXX.
   162         05  BL-RESEND-DT        PIC X(10).
   163         05  BL-FOLLOW-UP-DT     PIC X(10).
   164         05  BL-ARCHIVE-NO       PIC 9(8).
   165         05  BL-FUNC             PIC X(8).
   166         05  BL-COMMENTS         PIC X(70).
   167         05  FILLER REDEFINES BL-COMMENTS.
   168             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   169             10  BL-LETTER-TO-ACCT PIC X.
   170             10  BL-LETTER-TO-BENE PIC X.
   171             10  BL-WRITE-ERARCH   PIC X.
   172                 88  ERARCH-QWS      VALUE 'Q'.
   173                 88  ERARCH-BATCH    VALUE 'B'.
   174                 88  ERARCH-TEMP     VALUE 'T'.
   175             10  BL-PROCESS-TYPE PIC X(07).
   176             10  BL-CERT-FORM-ID PIC X(05).
   177             10  FILLER          PIC X(07).
   178     03  BL-OUTPUT.
   179         05  BL-STATUS                   PIC X.
   180             88  BL-OK                      VALUE "P".
   181             88  BL-FAIL                  VALUE "F".
   182         05  BL-MESSAGE          PIC X(50).
   183     03  BL-RECORD-PASSED-DATA   PIC X(4754).
   184
   185*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   186*                                COPY ELCZREC.
   187******************************************************************
   188*                                                                *
   189*                                                                *
   190*                            ELCZREC.                            *
   191*                                                                *
   192*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   193*                                                                *
   194******************************************************************
   195*-----------------------------------------------------------------
   196*                   C H A N G E   L O G
   197*
   198* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   199*-----------------------------------------------------------------
   200*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   201* EFFECTIVE    NUMBER
   202*-----------------------------------------------------------------
   203* 122011    2011022800001  AJRA  NEW FILE
   204* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   205*-----------------------------------------------------------------
   206 01  W-Z-CONTROL-DATA.
   207     05  W-NUMBER-OF-COPIES      PIC  9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6316.cbl
   208     05  FILLER                  PIC  X.
   209     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   210     05  FILLER                  PIC  X.
   211     05  W-DAYS-TO-RESEND        PIC  999.
   212     05  FILLER                  PIC  X.
   213     05  W-FORM-TO-RESEND        PIC  X(4).
   214     05  FILLER                  PIC  X.
   215     05  W-PROMPT-LETTER         PIC  X.
   216     05  FILLER                  PIC  X.
   217     05  W-ENCLOSURE-CD          PIC  XXX.
   218     05  FILLER                  PIC  X.
   219     05  W-AUTO-CLOSE-IND        PIC  X.
   220     05  FILLER                  PIC  X.
   221     05  W-LETTER-TO-BENE        PIC  X.
   222     05  FILLER                  PIC  X.
   223     05  W-LETTER-TO-ACCT        PIC  X.
   224     05  FILLER                  PIC  X.
   225     05  W-LETTER-TYPE           PIC  X.
   226     05  FILLER                  PIC  X.
   227     05  W-PRINT-CERTIFICATE     PIC  X.
   228     05  FILLER                  PIC  X.
   229     05  W-REFUND-REQUIRED       PIC  X.
   230     05  FILLER                  PIC  X.
   231     05  W-ONBASE-CODE           PIC  XX.
   232     05  FILLER                  PIC  X.
   233     05  W-ACCT-SUMM             PIC  X.
   234     05  FILLER                  PIC  X.
   235     05  W-CSO-SUMM              PIC  X.
   236     05  FILLER                  PIC  X(31).
   237 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   238 01  STANDARD-AREAS.
   239     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   240     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   241                                 PIC  X(08).
   242     12  QID.
   243         16  QID-TERM        PIC X(4)    VALUE SPACES.
   244         16  FILLER          PIC X(4)    VALUE '631I'.
   245     12  TIME-MT                 PIC S9(7).
   246     12  TIME-MT-R  REDEFINES TIME-MT.
   247         16  FILLER              PIC X.
   248         16  TIME-LMT            PIC 99V99.
   249         16  FILLER              PIC X(2).
   250     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   251     12  MAP-LENGTH              PIC 9(4)   VALUE 359 BINARY.
   252     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   253     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   254     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   255     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   256     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   257     12  WS-ELCERT-KEY.
   258         16  W-CERT-COMPANY-CD   PIC X.
   259         16  W-CERT-CARRIER      PIC X.
   260         16  W-CERT-GROUPING     PIC X(6).
   261         16  W-CERT-STATE        PIC XX.
   262         16  W-CERT-ACCOUNT      PIC X(10).
   263         16  W-CERT-CERT-EFF-DT  PIC XX.
   264         16  W-CERT-CERT-PRIME   PIC X(10).
   265         16  W-CERT-CERT-SFX     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6316.cbl
   266     12  WS-ELEOBC-KEY.
   267         16  WS-EOBC-COMPANY-CD  PIC X.
   268         16  WS-EOBC-REC-TYPE    PIC X.
   269         16  WS-EOBC-CODE        PIC X(4).
   270         16  FILLER              PIC X(9).
   271     12  WS-ERNOTE-KEY.
   272         16  W-NOTE-COMPANY-CD   PIC X.
   273         16  W-NOTE-CARRIER      PIC X.
   274         16  W-NOTE-GROUPING     PIC X(6).
   275         16  W-NOTE-STATE        PIC XX.
   276         16  W-NOTE-ACCOUNT      PIC X(10).
   277         16  W-NOTE-CERT-EFF-DT  PIC XX.
   278         16  W-NOTE-CERT-PRIME   PIC X(10).
   279         16  W-NOTE-CERT-SFX     PIC X.
   280     12  ELLETR-KEY.
   281         16  LETR-COMPANY-CD     PIC X.
   282         16  LETR-LETTER-ID      PIC X(4).
   283         16  LETR-FILLER         PIC X(8).
   284         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   285     12  ERPNDB2-KEY.
   286         16  PNDB2-COMPANY-CD    PIC X.
   287         16  PNDB2-CARRIER       PIC X.
   288         16  PNDB2-GROUPING      PIC X(6).
   289         16  PNDB2-STATE         PIC XX.
   290         16  PNDB2-ACCOUNT       PIC X(10).
   291         16  PNDB2-CERT-EFF-DT   PIC XX.
   292         16  PNDB2-CERT-PRIME    PIC X(10).
   293         16  PNDB2-CERT-SFX      PIC X.
   294         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   295         16  PNDB2-RECORD-TYPE   PIC X.
   296     12  ERENDT-KEY.
   297         16  ENDT-COMPANY-CD       PIC X.
   298         16  ENDT-CARRIER          PIC X.
   299         16  ENDT-GROUPING         PIC X(6).
   300         16  ENDT-STATE            PIC XX.
   301         16  ENDT-ACCOUNT          PIC X(10).
   302         16  ENDT-CERT-EFF-DT      PIC XX.
   303         16  ENDT-CERT-PRIME       PIC X(10).
   304         16  ENDT-CERT-SFX         PIC X.
   305         16  ENDT-RECORD-TYPE      PIC X.
   306         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   307     12  ELCRTO-KEY.
   308         16  CRTO-COMPANY-CD     PIC X.
   309         16  CRTO-CARRIER        PIC X.
   310         16  CRTO-GROUPING       PIC X(6).
   311         16  CRTO-STATE          PIC XX.
   312         16  CRTO-ACCOUNT        PIC X(10).
   313         16  CRTO-CERT-EFF-DT    PIC XX.
   314         16  CRTO-CERT-PRIME     PIC X(10).
   315         16  CRTO-CERT-SFX       PIC X.
   316         16  CRTO-RECORD-TYPE    PIC X.
   317         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   318     12  WS-ERMAIL-KEY.
   319         16  MAIL-COMPANY-CD     PIC X.
   320         16  MAIL-CARRIER        PIC X.
   321         16  MAIL-GROUPING       PIC X(6).
   322         16  MAIL-STATE          PIC XX.
   323         16  MAIL-ACCOUNT        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6316.cbl
   324         16  MAIL-CERT-EFF-DT    PIC XX.
   325         16  MAIL-CERT-PRIME     PIC X(10).
   326         16  MAIL-CERT-SFX       PIC X.
   327     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   328     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   329     12  WS-CURRENT-DT.
   330         16  FILLER              PIC X(6)    VALUE SPACES.
   331         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   332     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   333     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   334         88  CANCEL-REC            VALUE 'C'.
   335         88  ISSUE-REC             VALUE 'I'.
   336     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   337     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   338     12  ELCNTL-KEY.
   339         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   340         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   341         16  CNTL-ACCESS.
   342             20  CNTL-STATE      PIC XX    VALUE SPACES.
   343             20  FILLER          PIC X     VALUE SPACES.
   344             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   345         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   346     12  WS-ERACCT-KEY.
   347         16  ACCT-COMPANY-CD     PIC X.
   348         16  ACCT-CARRIER        PIC X.
   349         16  ACCT-GROUPING       PIC X(6).
   350         16  ACCT-STATE          PIC XX.
   351         16  ACCT-ACCOUNT        PIC X(10).
   352         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   353         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   354     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   355     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   356     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   357     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   358     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   359     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   360     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   361     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   362     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   363     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   364     12  WS-RESPONSE             PIC S9(8)   COMP.
   365         88  RESP-NORMAL                  VALUE +00.
   366         88  RESP-NOTFND                  VALUE +13.
   367         88  RESP-DUPREC                  VALUE +14.
   368         88  RESP-DUPKEY                  VALUE +15.
   369         88  RESP-NOTOPEN                 VALUE +19.
   370         88  RESP-ENDFILE                 VALUE +20.
   371     12  MAP-NAME            PIC X(8)    VALUE 'EL631I'.
   372     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6316S'.
   373     12  SCREEN-NUMBER       PIC X(4)    VALUE '631I'.
   374     12  TRANS-ID            PIC X(4)    VALUE 'EXBC'.
   375     12  THIS-PGM            PIC X(8)    VALUE 'EL6316'.
   376     12  PGM-NAME            PIC X(8).
   377     12  TIME-IN             PIC S9(7).
   378     12  TIME-OUT-R  REDEFINES TIME-IN.
   379         16  FILLER          PIC X.
   380         16  TIME-OUT        PIC 99V99.
   381         16  FILLER          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6316.cbl
   382     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   383     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   384     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   385     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   386     12  XCTL-6317           PIC X(8)    VALUE 'EL6317'.
   387     12  XCTL-6318           PIC X(8)    VALUE 'EL6318'.
   388     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   389     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   390     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   391     12  WS-PHONE.
   392         16  WS-PH1              PIC XXX.
   393         16  WS-PH2              PIC XXX.
   394         16  WS-PH3              PIC XXXX.
   395     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   396     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   397     12  WS-CERT-NOTE            PIC X(63).
   398
   399     12  WS-BILLING-NOTE.
   400         16  WS-BN-NOTE          PIC X(25).
   401         16  WS-BN-LTRID         PIC X(4).
   402         16  FILLER              PIC X(3).
   403         16  WS-BN-DATE          PIC X(8).
   404         16  FILLER              PIC X(3).
   405         16  WS-BN-USERID        PIC X(4).
   406         16  FILLER              PIC X(30).
   407     12  NEW-ORIG-REC.
   408         16  NEW-INS-LAST-NAME             PIC X(15).
   409         16  NEW-INS-FIRST-NAME            PIC X(10).
   410         16  NEW-INS-MIDDLE-INIT           PIC X.
   411         16  NEW-INS-AGE                   PIC S999     COMP-3.
   412         16  NEW-JNT-LAST-NAME             PIC X(15).
   413         16  NEW-JNT-FIRST-NAME            PIC X(10).
   414         16  NEW-JNT-MIDDLE-INIT           PIC X.
   415         16  NEW-JNT-AGE                   PIC S999     COMP-3.
   416         16  NEW-LF-BENCD                  PIC XX.
   417         16  NEW-LF-TERM                   PIC S999      COMP-3.
   418         16  NEW-LF-BEN-AMT                PIC S9(9)V99  COMP-3.
   419         16  NEW-LF-PRM-AMT                PIC S9(7)V99  COMP-3.
   420         16  NEW-LF-ALT-BEN-AMT            PIC S9(9)V99  COMP-3.
   421         16  NEW-LF-ALT-PRM-AMT            PIC S9(7)V99  COMP-3.
   422         16  NEW-LF-EXP-DT                 PIC XX.
   423         16  NEW-LF-COMM-PCT               PIC SV9(5)    COMP-3.
   424         16  NEW-LF-CANCEL-DT              PIC XX.
   425         16  NEW-LF-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   426         16  NEW-LF-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   427         16  NEW-AH-BENCD                  PIC XX.
   428         16  NEW-AH-TERM                   PIC S999      COMP-3.
   429         16  NEW-AH-BEN-AMT                PIC S9(9)V99  COMP-3.
   430         16  NEW-AH-PRM-AMT                PIC S9(7)V99  COMP-3.
   431         16  NEW-AH-EXP-DT                 PIC XX.
   432         16  NEW-AH-COMM-PCT               PIC SV9(5)    COMP-3.
   433         16  NEW-AH-CP                     PIC 99.
   434         16  NEW-AH-CANCEL-DT              PIC XX.
   435         16  NEW-AH-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   436         16  NEW-AH-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   437         16  NEW-CRED-BENE-NAME            PIC X(25).
   438         16  NEW-1ST-PMT-DT                PIC XX.
   439         16  FILLER                        PIC X(239).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6316.cbl
   440 01  ERROR-MESSAGES.
   441     12  ER-0000                 PIC X(4)  VALUE '0000'.
   442     12  ER-0004                 PIC X(4)  VALUE '0004'.
   443     12  ER-0008                 PIC X(4)  VALUE '0008'.
   444     12  ER-0023                 PIC X(4)  VALUE '0023'.
   445     12  ER-0029                 PIC X(4)  VALUE '0029'.
   446     12  ER-0068                 PIC X(4)  VALUE '0068'.
   447     12  ER-0132                 PIC X(4)  VALUE '0132'.
   448     12  ER-0142                 PIC X(4)  VALUE '0142'.
   449     12  ER-0148                 PIC X(4)  VALUE '0148'.
   450     12  ER-0215                 PIC X(4)  VALUE '0215'.
   451     12  ER-0280                 PIC X(4)  VALUE '0280'.
   452     12  ER-0348                 PIC X(4)  VALUE '0348'.
   453     12  ER-0419                 PIC X(4)  VALUE '0419'.
   454     12  ER-1101                 PIC X(4)  VALUE '1101'.
   455     12  ER-1236                 PIC X(4)  VALUE '1236'.
   456     12  ER-1818                 PIC X(4)  VALUE '1818'.
   457     12  ER-1820                 PIC X(4)  VALUE '1820'.
   458     12  ER-2056                 PIC X(4)  VALUE '2056'.
   459     12  ER-2079                 PIC X(4)  VALUE '2079'.
   460     12  ER-2208                 PIC X(4)  VALUE '2208'.
   461     12  ER-2209                 PIC X(4)  VALUE '2209'.
   462     12  ER-2237                 PIC X(4)  VALUE '2237'.
   463     12  ER-2238                 PIC X(4)  VALUE '2238'.
   464     12  ER-2253                 PIC X(4)  VALUE '2253'.
   465     12  ER-2619                 PIC X(4)  VALUE '2619'.
   466     12  ER-2651                 PIC X(4)  VALUE '2651'.
   467     12  ER-2784                 PIC X(4)  VALUE '2784'.
   468     12  ER-2785                 PIC X(4)  VALUE '2785'.
   469     12  ER-2786                 PIC X(4)  VALUE '2786'.
   470     12  ER-2791                 PIC X(4)  VALUE '2791'.
   471     12  ER-2845                 PIC X(4)  VALUE '2845'.
   472     12  ER-2848                 PIC X(4)  VALUE '2848'.
   473     12  ER-2851                 PIC X(4)  VALUE '2851'.
   474     12  ER-3829                 PIC X(4)  VALUE '3829'.
   475     12  ER-3830                 PIC X(4)  VALUE '3830'.
   476     12  ER-3833                 PIC X(4)  VALUE '3833'.
   477     12  ER-7638                 PIC X(4)  VALUE '7638'.
   478     12  ER-8888                 PIC X(4)  VALUE '8888'.
   479     12  ER-9999                 PIC X(4)  VALUE '9999'.
   480*    COPY ELCDATE.
   481******************************************************************
   482*                                                                *
   483*                                                                *
   484*                            ELCDATE.                            *
   485*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   486*                            VMOD=2.003
   487*                                                                *
   488*                                                                *
   489*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   490*                 LENGTH = 200                                   *
   491******************************************************************
   492
   493 01  DATE-CONVERSION-DATA.
   494     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   495     12  DC-OPTION-CODE                PIC X.
   496         88  BIN-TO-GREG                VALUE ' '.
   497         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6316.cbl
   498         88  EDIT-GREG-TO-BIN           VALUE '2'.
   499         88  YMD-GREG-TO-BIN            VALUE '3'.
   500         88  MDY-GREG-TO-BIN            VALUE '4'.
   501         88  JULIAN-TO-BIN              VALUE '5'.
   502         88  BIN-PLUS-ELAPSED           VALUE '6'.
   503         88  FIND-CENTURY               VALUE '7'.
   504         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   505         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   506         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   507         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   508         88  JULIAN-TO-BIN-3            VALUE 'C'.
   509         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   510         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   511         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   512         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   513         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   514         88  CHECK-LEAP-YEAR            VALUE 'H'.
   515         88  BIN-3-TO-GREG              VALUE 'I'.
   516         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   517         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   518         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   519         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   520         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   521         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   522         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   523         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   524         88  THREE-CHARACTER-BIN
   525                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   526         88  GREGORIAN-TO-BIN
   527                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   528         88  BIN-TO-GREGORIAN
   529                  VALUES ' ' '1' 'I' '8' 'G'.
   530         88  JULIAN-TO-BINARY
   531                  VALUES '5' 'C' 'E' 'F'.
   532     12  DC-ERROR-CODE                 PIC X.
   533         88  NO-CONVERSION-ERROR        VALUE ' '.
   534         88  DATE-CONVERSION-ERROR
   535                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   536         88  DATE-IS-ZERO               VALUE '1'.
   537         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   538         88  DATE-IS-INVALID            VALUE '3'.
   539         88  DATE1-GREATER-DATE2        VALUE '4'.
   540         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   541         88  DATE-INVALID-OPTION        VALUE '9'.
   542         88  INVALID-CENTURY            VALUE 'A'.
   543         88  ONLY-CENTURY               VALUE 'B'.
   544         88  ONLY-LEAP-YEAR             VALUE 'C'.
   545         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   546     12  DC-END-OF-MONTH               PIC X.
   547         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   548     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   549         88  USE-NORMAL-PROCESS         VALUE ' '.
   550         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   551         88  ADJUST-UP-100-YRS          VALUE '2'.
   552     12  FILLER                        PIC X.
   553     12  DC-CONVERSION-DATES.
   554         16  DC-BIN-DATE-1             PIC XX.
   555         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6316.cbl
   556         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   557         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   558                       DC-GREG-DATE-1-EDIT.
   559             20  DC-EDIT1-MONTH        PIC 99.
   560             20  SLASH1-1              PIC X.
   561             20  DC-EDIT1-DAY          PIC 99.
   562             20  SLASH1-2              PIC X.
   563             20  DC-EDIT1-YEAR         PIC 99.
   564         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   565         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   566                     DC-GREG-DATE-2-EDIT.
   567             20  DC-EDIT2-MONTH        PIC 99.
   568             20  SLASH2-1              PIC X.
   569             20  DC-EDIT2-DAY          PIC 99.
   570             20  SLASH2-2              PIC X.
   571             20  DC-EDIT2-YEAR         PIC 99.
   572         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   573         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   574                     DC-GREG-DATE-1-YMD.
   575             20  DC-YMD-YEAR           PIC 99.
   576             20  DC-YMD-MONTH          PIC 99.
   577             20  DC-YMD-DAY            PIC 99.
   578         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   579         16  DC-GREG-DATE-1-MDY-R REDEFINES
   580                      DC-GREG-DATE-1-MDY.
   581             20  DC-MDY-MONTH          PIC 99.
   582             20  DC-MDY-DAY            PIC 99.
   583             20  DC-MDY-YEAR           PIC 99.
   584         16  DC-GREG-DATE-1-ALPHA.
   585             20  DC-ALPHA-MONTH        PIC X(10).
   586             20  DC-ALPHA-DAY          PIC 99.
   587             20  FILLER                PIC XX.
   588             20  DC-ALPHA-CENTURY.
   589                 24 DC-ALPHA-CEN-N     PIC 99.
   590             20  DC-ALPHA-YEAR         PIC 99.
   591         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   592         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   593         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   594         16  DC-JULIAN-DATE            PIC 9(05).
   595         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   596                                       PIC 9(05).
   597         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   598             20  DC-JULIAN-YEAR        PIC 99.
   599             20  DC-JULIAN-DAYS        PIC 999.
   600         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   601         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   602         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   603     12  DATE-CONVERSION-VARIBLES.
   604         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   605         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   606             20  FILLER                PIC 9(3).
   607             20  HOLD-CEN-1-CCYY.
   608                 24  HOLD-CEN-1-CC     PIC 99.
   609                 24  HOLD-CEN-1-YY     PIC 99.
   610             20  HOLD-CEN-1-MO         PIC 99.
   611             20  HOLD-CEN-1-DA         PIC 99.
   612         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   613             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6316.cbl
   614             20  HOLD-CEN-1-R-DA       PIC 99.
   615             20  HOLD-CEN-1-R-CCYY.
   616                 24  HOLD-CEN-1-R-CC   PIC 99.
   617                 24  HOLD-CEN-1-R-YY   PIC 99.
   618             20  FILLER                PIC 9(3).
   619         16  HOLD-CENTURY-1-X.
   620             20  FILLER                PIC X(3)  VALUE SPACES.
   621             20  HOLD-CEN-1-X-CCYY.
   622                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   623                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   624             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   625             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   626         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   627             20  HOLD-CEN-1-R-X-MO     PIC XX.
   628             20  HOLD-CEN-1-R-X-DA     PIC XX.
   629             20  HOLD-CEN-1-R-X-CCYY.
   630                 24  HOLD-CEN-1-R-X-CC PIC XX.
   631                 24  HOLD-CEN-1-R-X-YY PIC XX.
   632             20  FILLER                PIC XXX.
   633         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   634         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   635         16  DC-JULIAN-DATE-1          PIC 9(07).
   636         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   637             20  DC-JULIAN-1-CCYY.
   638                 24  DC-JULIAN-1-CC    PIC 99.
   639                 24  DC-JULIAN-1-YR    PIC 99.
   640             20  DC-JULIAN-DA-1        PIC 999.
   641         16  DC-JULIAN-DATE-2          PIC 9(07).
   642         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   643             20  DC-JULIAN-2-CCYY.
   644                 24  DC-JULIAN-2-CC    PIC 99.
   645                 24  DC-JULIAN-2-YR    PIC 99.
   646             20  DC-JULIAN-DA-2        PIC 999.
   647         16  DC-GREG-DATE-A-EDIT.
   648             20  DC-EDITA-MONTH        PIC 99.
   649             20  SLASHA-1              PIC X VALUE '/'.
   650             20  DC-EDITA-DAY          PIC 99.
   651             20  SLASHA-2              PIC X VALUE '/'.
   652             20  DC-EDITA-CCYY.
   653                 24  DC-EDITA-CENT     PIC 99.
   654                 24  DC-EDITA-YEAR     PIC 99.
   655         16  DC-GREG-DATE-B-EDIT.
   656             20  DC-EDITB-MONTH        PIC 99.
   657             20  SLASHB-1              PIC X VALUE '/'.
   658             20  DC-EDITB-DAY          PIC 99.
   659             20  SLASHB-2              PIC X VALUE '/'.
   660             20  DC-EDITB-CCYY.
   661                 24  DC-EDITB-CENT     PIC 99.
   662                 24  DC-EDITB-YEAR     PIC 99.
   663         16  DC-GREG-DATE-CYMD         PIC 9(08).
   664         16  DC-GREG-DATE-CYMD-R REDEFINES
   665                              DC-GREG-DATE-CYMD.
   666             20  DC-CYMD-CEN           PIC 99.
   667             20  DC-CYMD-YEAR          PIC 99.
   668             20  DC-CYMD-MONTH         PIC 99.
   669             20  DC-CYMD-DAY           PIC 99.
   670         16  DC-GREG-DATE-MDCY         PIC 9(08).
   671         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6316.cbl
   672                              DC-GREG-DATE-MDCY.
   673             20  DC-MDCY-MONTH         PIC 99.
   674             20  DC-MDCY-DAY           PIC 99.
   675             20  DC-MDCY-CEN           PIC 99.
   676             20  DC-MDCY-YEAR          PIC 99.
   677    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   678        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   679    12  DC-EL310-DATE                  PIC X(21).
   680    12  FILLER                         PIC X(28).
   681*    COPY ELCLOGOF.
   682******************************************************************
   683*                                                                *
   684*                                                                *
   685*                            ELCLOGOF.                           *
   686*                            VMOD=2.001                          *
   687*                                                                *
   688*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   689*                                                                *
   690******************************************************************
   691 01  CLASIC-LOGOFF.
   692     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   693     12  LOGOFF-TEXT.
   694         16  FILLER          PIC X(5)    VALUE SPACES.
   695         16  LOGOFF-MSG.
   696             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   697             20  FILLER      PIC X       VALUE SPACES.
   698             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   699         16  FILLER          PIC X(80)
   700           VALUE '* YOU ARE NOW LOGGED OFF'.
   701         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   702         16  FILLER          PIC X       VALUE QUOTE.
   703         16  LOGOFF-SYS-MSG  PIC X(17)
   704           VALUE 'S CLAS-IC SYSTEM '.
   705     12  TEXT-MESSAGES.
   706         16  UNACCESS-MSG    PIC X(29)
   707             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   708         16  PGMIDERR-MSG    PIC X(17)
   709             VALUE 'PROGRAM NOT FOUND'.
   710*    COPY ELCATTR.
   711******************************************************************
   712*                                                                *
   713*                            ELCATTR.                            *
   714*                            VMOD=2.001                          *
   715*                                                                *
   716*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   717*                                                                *
   718*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   719*                                                                *
   720*                   POS 1   P=PROTECTED                          *
   721*                           U=UNPROTECTED                        *
   722*                           S=ASKIP                              *
   723*                   POS 2   A=ALPHA/NUMERIC                      *
   724*                           N=NUMERIC                            *
   725*                   POS 3   N=NORMAL                             *
   726*                           B=BRIGHT                             *
   727*                           D=DARK                               *
   728*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   729*                           OF=MODIFIED DATA TAG OFF             *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6316.cbl
   730*                                                                *
   731*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   732******************************************************************
   733 01  ATTRIBUTE-LIST.
   734     12  AL-PABOF            PIC X       VALUE 'Y'.
   735     12  AL-PABON            PIC X       VALUE 'Z'.
   736     12  AL-PADOF            PIC X       VALUE '%'.
   737     12  AL-PADON            PIC X       VALUE '_'.
   738     12  AL-PANOF            PIC X       VALUE '-'.
   739     12  AL-PANON            PIC X       VALUE '/'.
   740     12  AL-SABOF            PIC X       VALUE '8'.
   741     12  AL-SABON            PIC X       VALUE '9'.
   742     12  AL-SADOF            PIC X       VALUE '@'.
   743     12  AL-SADON            PIC X       VALUE QUOTE.
   744     12  AL-SANOF            PIC X       VALUE '0'.
   745     12  AL-SANON            PIC X       VALUE '1'.
   746     12  AL-UABOF            PIC X       VALUE 'H'.
   747     12  AL-UABON            PIC X       VALUE 'I'.
   748     12  AL-UADOF            PIC X       VALUE '<'.
   749     12  AL-UADON            PIC X       VALUE '('.
   750     12  AL-UANOF            PIC X       VALUE ' '.
   751     12  AL-UANON            PIC X       VALUE 'A'.
   752     12  AL-UNBOF            PIC X       VALUE 'Q'.
   753     12  AL-UNBON            PIC X       VALUE 'R'.
   754     12  AL-UNDOF            PIC X       VALUE '*'.
   755     12  AL-UNDON            PIC X       VALUE ')'.
   756     12  AL-UNNOF            PIC X       VALUE '&'.
   757     12  AL-UNNON            PIC X       VALUE 'J'.
   758*    COPY ELCEMIB.
   759******************************************************************
   760*                                                                *
   761*                                                                *
   762*                            ELCEMIB.                            *
   763*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   764*                            VMOD=2.005                          *
   765*                                                                *
   766*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   767*                                                                *
   768******************************************************************
   769 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   770     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   771     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   772     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   773     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   774     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   775     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   776     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   777     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   778     12  EMI-SWITCH1             PIC X        VALUE '1'.
   779         88  EMI-NO-ERRORS                    VALUE '1'.
   780         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   781         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   782     12  EMI-SWITCH2             PIC X        VALUE '1'.
   783         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   784     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   785         88  EMI-AREA1-EMPTY                  VALUE '1'.
   786         88  EMI-AREA1-FULL                   VALUE '2'.
   787     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6316.cbl
   788         88  EMI-AREA2-EMPTY                  VALUE '1'.
   789         88  EMI-AREA2-FULL                   VALUE '2'.
   790     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   791         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   792         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   793         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   794         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   795         88  EMI-BYPASS-FATALS                VALUE 'X'.
   796     12  EMI-ERROR-LINES.
   797         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   798         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   799         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   800         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   801             20  EMI-ERR-CODES OCCURS 10 TIMES.
   802                 24  EMI-ERR-NUM         PIC X(4).
   803                 24  EMI-FILLER          PIC X.
   804                 24  EMI-SEV             PIC X.
   805                 24  FILLER              PIC X.
   806             20  FILLER                  PIC X(02).
   807     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   808         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   809             20  EMI-ERROR-NUMBER    PIC X(4).
   810             20  EMI-FILL            PIC X.
   811             20  EMI-SEVERITY        PIC X.
   812             20  FILLER              PIC X.
   813             20  EMI-ERROR-TEXT.
   814                 24  EMI-TEXT-VARIABLE   PIC X(10).
   815                 24  FILLER          PIC X(55).
   816     12  EMI-SEVERITY-SAVE           PIC X.
   817         88  EMI-NOTE                    VALUE 'N'.
   818         88  EMI-WARNING                 VALUE 'W'.
   819         88  EMI-FORCABLE                VALUE 'F'.
   820         88  EMI-FATAL                   VALUE 'X'.
   821     12  EMI-MESSAGE-FLAG            PIC X.
   822         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   823         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   824     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   825     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   826         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   827         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   828         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   829     12  FILLER                      PIC X(137)  VALUE SPACES.
   830     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   831     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   832     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   833     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   834*    COPY ELCTEXT.
   835******************************************************************
   836*                                                                *
   837*                                                                *
   838*                            ELCTEXT.                            *
   839*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   840*                            VMOD=2.008                          *
   841*                                                                *
   842*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   843*                                     FORM LETTERS,              *
   844*                                     CERT FORM DISPLAY.
   845*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6316.cbl
   846*   FILE TYPE = VSAM,KSDS                                        *
   847*   RECORD SIZE = 100   RECFORM = FIXED                          *
   848*                                                                *
   849*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   850*       ALTERNATE INDEX = NONE                                   *
   851*                                                                *
   852*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   853*       ALTERNATE INDEX = NONE                                   *
   854*                                                                *
   855*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   856*       ALTERNATE INDEX = NONE                                   *
   857*                                                                *
   858*   LOG = NO                                                     *
   859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   860******************************************************************
   861 01  TEXT-FILES.
   862     12  TEXT-FILE-ID                PIC XX.
   863         88  FORMS-FILE-TEXT            VALUE 'TF'.
   864         88  LETTER-FILE-TEXT           VALUE 'TL'.
   865         88  HELP-FILE-TEXT             VALUE 'TH'.
   866
   867     12  TX-CONTROL-PRIMARY.
   868         16  TX-COMPANY-CD           PIC X.
   869             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   870         16  TX-ACCESS-CD-GENL       PIC X(12).
   871
   872         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   873             20  TX-LETTER-NO        PIC X(4).
   874             20  FILLER              PIC X(8).
   875
   876         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   877             20  TX-FORM-NO          PIC X(12).
   878
   879         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   880             20  TX-HELP-TYPE        PIC X.
   881                 88  HELP-FOR-GENERAL   VALUE ' '.
   882                 88  HELP-BY-SCREEN     VALUE 'S'.
   883                 88  HELP-BY-ERROR      VALUE 'E'.
   884             20  TX-SCREEN-OR-ERROR  PIC X(4).
   885                 88  GENERAL-INFO-HELP  VALUE '0000'.
   886             20  TX-HELP-FOR-COMPANY  PIC XXX.
   887                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   888             20  FILLER              PIC X(4).
   889
   890         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   891
   892     12  TX-PROCESS-CONTROL          PIC XX.
   893         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   894
   895     12  TX-TEXT-LINE                PIC X(70).
   896
   897     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   898         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   899         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   900         88  TX-VALID-FORM-SQUEEZE-VALUE
   901                                        VALUE 'Y' ' '.
   902
   903     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6316.cbl
   904         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   905         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   906         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   907         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   908         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   909         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   910         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   911                                              'K' 'N' ' '
   912                                              'Z'.
   913
   914     12  TX-ARCHIVE-SW               PIC X.
   915         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   916         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   917         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   918
   919     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   920     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   921
   922     12  TX-BSR-CODE                 PIC X.
   923         88  TX-BSR-LETTER              VALUE 'B'.
   924         88  TX-NON-BSR-LETTER          VALUE ' '.
   925
   926     12  FILLER                      PIC X.
   927*****************************************************************
   928*    COPY ELCINTF.
   929******************************************************************
   930*                                                                *
   931*                                                                *
   932*                            ELCINTF.                            *
   933*                            VMOD=2.017                          *
   934*                                                                *
   935*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   936*                                                                *
   937*       LENGTH = 1024                                            *
   938*                                                                *
   939******************************************************************
   940*                   C H A N G E   L O G
   941*
   942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   943*-----------------------------------------------------------------
   944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   945* EFFECTIVE    NUMBER
   946*-----------------------------------------------------------------
   947* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   948******************************************************************
   949 01  PROGRAM-INTERFACE-BLOCK.
   950     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   951     12  PI-CALLING-PROGRAM              PIC X(8).
   952     12  PI-SAVED-PROGRAM-1              PIC X(8).
   953     12  PI-SAVED-PROGRAM-2              PIC X(8).
   954     12  PI-SAVED-PROGRAM-3              PIC X(8).
   955     12  PI-SAVED-PROGRAM-4              PIC X(8).
   956     12  PI-SAVED-PROGRAM-5              PIC X(8).
   957     12  PI-SAVED-PROGRAM-6              PIC X(8).
   958     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   959     12  PI-COMPANY-ID                   PIC XXX.
   960     12  PI-COMPANY-CD                   PIC X.
   961
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6316.cbl
   962     12  PI-COMPANY-PASSWORD             PIC X(8).
   963
   964     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   965
   966     12  PI-CONTROL-IN-PROGRESS.
   967         16  PI-CARRIER                  PIC X.
   968         16  PI-GROUPING                 PIC X(6).
   969         16  PI-STATE                    PIC XX.
   970         16  PI-ACCOUNT                  PIC X(10).
   971         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   972                                         PIC X(10).
   973         16  PI-CLAIM-CERT-GRP.
   974             20  PI-CLAIM-NO             PIC X(7).
   975             20  PI-CERT-NO.
   976                 25  PI-CERT-PRIME       PIC X(10).
   977                 25  PI-CERT-SFX         PIC X.
   978             20  PI-CERT-EFF-DT          PIC XX.
   979         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   980             20  PI-PLAN-CODE            PIC X(2).
   981             20  PI-REVISION-NUMBER      PIC X(3).
   982             20  PI-PLAN-EFF-DT          PIC X(2).
   983             20  PI-PLAN-EXP-DT          PIC X(2).
   984             20  FILLER                  PIC X(11).
   985         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   986             20  PI-OE-REFERENCE-1.
   987                 25  PI-OE-REF-1-PRIME   PIC X(18).
   988                 25  PI-OE-REF-1-SUFF    PIC XX.
   989
   990     12  PI-SESSION-IN-PROGRESS          PIC X.
   991         88  CLAIM-SESSION                   VALUE '1'.
   992         88  CREDIT-SESSION                  VALUE '2'.
   993         88  WARRANTY-SESSION                VALUE '3'.
   994         88  MORTGAGE-SESSION                VALUE '4'.
   995         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   996
   997
   998*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   999
  1000     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1001     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1002
  1003     12  PI-CREDIT-USER                  PIC X.
  1004         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1005         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1006
  1007     12  PI-CLAIM-USER                   PIC X.
  1008         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1009         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1010
  1011     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1012         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1013         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1014         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1015         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1016         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1017
  1018     12  PI-PROCESSOR-ID                 PIC X(4).
  1019
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6316.cbl
  1020     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1021
  1022     12  PI-MEMBER-CAPTION               PIC X(10).
  1023
  1024     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1025         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1026
  1027     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1028     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1029     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1030     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1031
  1032     12  PI-AH-OVERRIDE-L1               PIC X.
  1033     12  PI-AH-OVERRIDE-L2               PIC XX.
  1034     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1035     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1036
  1037     12  PI-NEW-SYSTEM                   PIC X(2).
  1038
  1039     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1040     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1041         88  PI-USES-PAID-TO                 VALUE '1'.
  1042     12  PI-CRDTCRD-SYSTEM.
  1043         16  PI-CRDTCRD-USER             PIC X.
  1044             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1045             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1046         16  PI-CC-MONTH-END-DT          PIC XX.
  1047     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1048
  1049     12  PI-OE-REFERENCE-2.
  1050         16  PI-OE-REF-2-PRIME           PIC X(10).
  1051         16  PI-OE-REF-2-SUFF            PIC X.
  1052
  1053     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1054
  1055     12  PI-LANGUAGE-TYPE                PIC X.
  1056             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1057             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1058             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1059
  1060     12  PI-POLICY-LINKAGE-IND           PIC X.
  1061         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1062         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1063                                                   LOW-VALUES.
  1064
  1065     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1066     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1067         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1068         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1069
  1070     12  PI-PROCESSOR-CSR-IND            PIC X.
  1071         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1072         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1073
  1074     12  FILLER                          PIC X(3).
  1075
  1076     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1077
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6316.cbl
  1078     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1079         PI-SYSTEM-LEVEL.
  1080
  1081         16  PI-ENTRY-CODES.
  1082             20  PI-ENTRY-CD-1           PIC X.
  1083             20  PI-ENTRY-CD-2           PIC X.
  1084
  1085         16  PI-RETURN-CODES.
  1086             20  PI-RETURN-CD-1          PIC X.
  1087             20  PI-RETURN-CD-2          PIC X.
  1088
  1089         16  PI-UPDATE-STATUS-SAVE.
  1090             20  PI-UPDATE-BY            PIC X(4).
  1091             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1092
  1093         16  PI-LOWER-CASE-LETTERS       PIC X.
  1094             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1095
  1096*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1097*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1098*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1099
  1100         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1101             88  ST-ACCNT-CNTL               VALUE ' '.
  1102             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1103             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1104             88  ACCNT-CNTL                  VALUE '3'.
  1105             88  CARR-ACCNT-CNTL             VALUE '4'.
  1106
  1107         16  PI-PROCESSOR-CAP-LIST.
  1108             20  PI-SYSTEM-CONTROLS.
  1109                24 PI-SYSTEM-DISPLAY     PIC X.
  1110                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1111                24 PI-SYSTEM-MODIFY      PIC X.
  1112                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1113             20  FILLER                  PIC XX.
  1114             20  PI-DISPLAY-CAP          PIC X.
  1115                 88  DISPLAY-CAP             VALUE 'Y'.
  1116             20  PI-MODIFY-CAP           PIC X.
  1117                 88  MODIFY-CAP              VALUE 'Y'.
  1118             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1119                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1120             20  PI-FORCE-CAP            PIC X.
  1121                 88  FORCE-CAP               VALUE 'Y'.
  1122
  1123         16  PI-PROGRAM-CONTROLS.
  1124             20  PI-PGM-PRINT-OPT        PIC X.
  1125             20  PI-PGM-FORMAT-OPT       PIC X.
  1126             20  PI-PGM-PROCESS-OPT      PIC X.
  1127             20  PI-PGM-TOTALS-OPT       PIC X.
  1128
  1129         16  PI-HELP-INTERFACE.
  1130             20  PI-LAST-ERROR-NO        PIC X(4).
  1131             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1132
  1133         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1134             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1135
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6316.cbl
  1136         16  PI-CR-CONTROL-IN-PROGRESS.
  1137             20  PI-CR-CARRIER           PIC X.
  1138             20  PI-CR-GROUPING          PIC X(6).
  1139             20  PI-CR-STATE             PIC XX.
  1140             20  PI-CR-ACCOUNT           PIC X(10).
  1141             20  PI-CR-FIN-RESP          PIC X(10).
  1142             20  PI-CR-TYPE              PIC X.
  1143
  1144         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1145
  1146         16  PI-CR-MONTH-END-DT          PIC XX.
  1147
  1148         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1149             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1150             88  PI-ZERO-CARRIER             VALUE '1'.
  1151             88  PI-ZERO-GROUPING            VALUE '2'.
  1152             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1153
  1154         16  PI-CARRIER-SECURITY         PIC X.
  1155             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1156
  1157         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1158             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1159             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1160
  1161         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1162             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1163                                         INDEXED BY PI-ACCESS-NDX
  1164                                         PIC X.
  1165
  1166         16  PI-GA-BILLING-CONTROL       PIC X.
  1167             88  PI-GA-BILLING               VALUE '1'.
  1168
  1169         16  PI-MAIL-PROCESSING          PIC X.
  1170             88  PI-MAIL-YES                 VALUE 'Y'.
  1171
  1172         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1173
  1174         16  PI-AR-SYSTEM.
  1175             20  PI-AR-PROCESSING-CNTL   PIC X.
  1176                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1177             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1178             20  PI-AR-MONTH-END-DT      PIC XX.
  1179
  1180         16  PI-MP-SYSTEM.
  1181             20  PI-MORTGAGE-USER            PIC X.
  1182                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1183                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1184             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1185                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1186                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1187                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1188                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1189                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1190             20  PI-MP-MONTH-END-DT          PIC XX.
  1191             20  PI-MP-REFERENCE-NO.
  1192                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1193                 24  PI-MP-REFERENCE-SFX     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6316.cbl
  1194
  1195         16  PI-LABEL-CONTROL            PIC X(01).
  1196             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1197             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1198
  1199         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1200             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1201
  1202         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1203             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1204             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1205
  1206         16  FILLER                      PIC X(14).
  1207
  1208     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1209******************************************************************
  1210     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1211        16  PI-ISS-CAN-SW           PIC X.
  1212        16  PI-ERENDT-KEY.
  1213            20  PI-ENDT-COMPANY-CD  PIC X.
  1214            20  PI-ENDT-CARRIER     PIC X.
  1215            20  PI-ENDT-GROUPING    PIC X(6).
  1216            20  PI-ENDT-STATE       PIC XX.
  1217            20  PI-ENDT-ACCOUNT     PIC X(10).
  1218            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1219            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1220            20  PI-ENDT-CERT-SFX    PIC X.
  1221            20  PI-ENDT-RECORD-TYPE PIC X.
  1222            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1223        16  PI-ELCRTO-KEY.
  1224            20  PI-CRTO-COMPANY-CD  PIC X.
  1225            20  PI-CRTO-CARRIER     PIC X.
  1226            20  PI-CRTO-GROUPING    PIC X(6).
  1227            20  PI-CRTO-STATE       PIC XX.
  1228            20  PI-CRTO-ACCOUNT     PIC X(10).
  1229            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1230            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1231            20  PI-CRTO-CERT-SFX    PIC X.
  1232            20  PI-CRTO-RECORD-TYPE PIC X.
  1233            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1234        16  PI-ERPNDB-KEY           PIC X(11).
  1235        16  PI-DOCUMENT-PROCESSED   PIC X.
  1236            88  PI-VERI-PROCESSED      VALUE 'V'.
  1237            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1238        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1239        16  PI-RES-REF-CLM-TYPE     PIC X.
  1240        16  PI-CLM-RESC-IND         PIC X.
  1241            88  PI-CLM-RESCISSION      VALUE 'Y'.
  1242        16  PI-CLEAR-ERROR-SW       PIC X.
  1243            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1244        16  PI-PRTSW-ENTERED        PIC X.
  1245        16  PI-LTRID-ENTERED        PIC X(4).
  1246        16  PI-REASONS-ENTERED      PIC X(84).
  1247        16  PI-CERTNT1-ENTERED      PIC X(63).
  1248        16  PI-CERTNT2-ENTERED      PIC X(63).
  1249        16  FILLER                  PIC X(20).
  1250        16  PI-FINALIZED-IND        PIC X.
  1251        16  FILLER                  PIC X(280).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6316.cbl
  1252    12  FILLER                      PIC X(276).
  1253*    COPY ELCAID.
  1254******************************************************************
  1255*                                                                *
  1256*                            ELCAID.                             *
  1257*                            VMOD=2.001                          *
  1258*                                                                *
  1259*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1260*                                                                *
  1261*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1262*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1263******************************************************************
  1264
  1265 01  DFHAID.
  1266   02  DFHNULL   PIC  X  VALUE  ' '.
  1267   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1268   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1269   02  DFHPEN    PIC  X  VALUE  '='.
  1270   02  DFHOPID   PIC  X  VALUE  'W'.
  1271   02  DFHPA1    PIC  X  VALUE  '%'.
  1272   02  DFHPA2    PIC  X  VALUE  '>'.
  1273   02  DFHPA3    PIC  X  VALUE  ','.
  1274   02  DFHPF1    PIC  X  VALUE  '1'.
  1275   02  DFHPF2    PIC  X  VALUE  '2'.
  1276   02  DFHPF3    PIC  X  VALUE  '3'.
  1277   02  DFHPF4    PIC  X  VALUE  '4'.
  1278   02  DFHPF5    PIC  X  VALUE  '5'.
  1279   02  DFHPF6    PIC  X  VALUE  '6'.
  1280   02  DFHPF7    PIC  X  VALUE  '7'.
  1281   02  DFHPF8    PIC  X  VALUE  '8'.
  1282   02  DFHPF9    PIC  X  VALUE  '9'.
  1283   02  DFHPF10   PIC  X  VALUE  ':'.
  1284   02  DFHPF11   PIC  X  VALUE  '#'.
  1285   02  DFHPF12   PIC  X  VALUE  '@'.
  1286   02  DFHPF13   PIC  X  VALUE  'A'.
  1287   02  DFHPF14   PIC  X  VALUE  'B'.
  1288   02  DFHPF15   PIC  X  VALUE  'C'.
  1289   02  DFHPF16   PIC  X  VALUE  'D'.
  1290   02  DFHPF17   PIC  X  VALUE  'E'.
  1291   02  DFHPF18   PIC  X  VALUE  'F'.
  1292   02  DFHPF19   PIC  X  VALUE  'G'.
  1293   02  DFHPF20   PIC  X  VALUE  'H'.
  1294   02  DFHPF21   PIC  X  VALUE  'I'.
  1295*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1296   02  DFHPF22   PIC  X  VALUE  '['.
  1297   02  DFHPF23   PIC  X  VALUE  '.'.
  1298   02  DFHPF24   PIC  X  VALUE  '<'.
  1299   02  DFHMSRE   PIC  X  VALUE  'X'.
  1300   02  DFHSTRF   PIC  X  VALUE  'h'.
  1301   02  DFHTRIG   PIC  X  VALUE  '"'.
  1302 01  FILLER    REDEFINES DFHAID.
  1303     12  FILLER              PIC X(8).
  1304     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1305*   COPY EL6316S.
  1306 01  EL631II.
  1307     05  FILLER            PIC  X(0012).
  1308*    -------------------------------
  1309     05  DATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6316.cbl
  1310     05  DATEF PIC  X(0001).
  1311     05  FILLER REDEFINES DATEF.
  1312         10  DATEA PIC  X(0001).
  1313     05  DATEI PIC  X(0008).
  1314*    -------------------------------
  1315     05  TIMEL PIC S9(0004) COMP.
  1316     05  TIMEF PIC  X(0001).
  1317     05  FILLER REDEFINES TIMEF.
  1318         10  TIMEA PIC  X(0001).
  1319     05  TIMEI PIC  X(0005).
  1320*    -------------------------------
  1321     05  PROCIDL PIC S9(0004) COMP.
  1322     05  PROCIDF PIC  X(0001).
  1323     05  FILLER REDEFINES PROCIDF.
  1324         10  PROCIDA PIC  X(0001).
  1325     05  PROCIDI PIC  X(0004).
  1326*    -------------------------------
  1327     05  HOSTL PIC S9(0004) COMP.
  1328     05  HOSTF PIC  X(0001).
  1329     05  FILLER REDEFINES HOSTF.
  1330         10  HOSTA PIC  X(0001).
  1331     05  HOSTI PIC  X(0009).
  1332*    -------------------------------
  1333     05  SYSL PIC S9(0004) COMP.
  1334     05  SYSF PIC  X(0001).
  1335     05  FILLER REDEFINES SYSF.
  1336         10  SYSA PIC  X(0001).
  1337     05  SYSI PIC  X(0005).
  1338*    -------------------------------
  1339     05  COMPANYL PIC S9(0004) COMP.
  1340     05  COMPANYF PIC  X(0001).
  1341     05  FILLER REDEFINES COMPANYF.
  1342         10  COMPANYA PIC  X(0001).
  1343     05  COMPANYI PIC  X(0003).
  1344*    -------------------------------
  1345     05  DATASORL PIC S9(0004) COMP.
  1346     05  DATASORF PIC  X(0001).
  1347     05  FILLER REDEFINES DATASORF.
  1348         10  DATASORA PIC  X(0001).
  1349     05  DATASORI PIC  X(0001).
  1350*    -------------------------------
  1351     05  BATCHNOL PIC S9(0004) COMP.
  1352     05  BATCHNOF PIC  X(0001).
  1353     05  FILLER REDEFINES BATCHNOF.
  1354         10  BATCHNOA PIC  X(0001).
  1355     05  BATCHNOI PIC  X(0006).
  1356*    -------------------------------
  1357     05  BSEQNOL PIC S9(0004) COMP.
  1358     05  BSEQNOF PIC  X(0001).
  1359     05  FILLER REDEFINES BSEQNOF.
  1360         10  BSEQNOA PIC  X(0001).
  1361     05  BSEQNOI PIC  X(0008).
  1362*    -------------------------------
  1363     05  ARCHNOL PIC S9(0004) COMP.
  1364     05  ARCHNOF PIC  X(0001).
  1365     05  FILLER REDEFINES ARCHNOF.
  1366         10  ARCHNOA PIC  X(0001).
  1367     05  ARCHNOI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6316.cbl
  1368*    -------------------------------
  1369     05  PRTSWL PIC S9(0004) COMP.
  1370     05  PRTSWF PIC  X(0001).
  1371     05  FILLER REDEFINES PRTSWF.
  1372         10  PRTSWA PIC  X(0001).
  1373     05  PRTSWI PIC  X(0001).
  1374*    -------------------------------
  1375     05  CARRL PIC S9(0004) COMP.
  1376     05  CARRF PIC  X(0001).
  1377     05  FILLER REDEFINES CARRF.
  1378         10  CARRA PIC  X(0001).
  1379     05  CARRI PIC  X(0001).
  1380*    -------------------------------
  1381     05  GROUPL PIC S9(0004) COMP.
  1382     05  GROUPF PIC  X(0001).
  1383     05  FILLER REDEFINES GROUPF.
  1384         10  GROUPA PIC  X(0001).
  1385     05  GROUPI PIC  X(0006).
  1386*    -------------------------------
  1387     05  STATEL PIC S9(0004) COMP.
  1388     05  STATEF PIC  X(0001).
  1389     05  FILLER REDEFINES STATEF.
  1390         10  STATEA PIC  X(0001).
  1391     05  STATEI PIC  X(0002).
  1392*    -------------------------------
  1393     05  ACCTL PIC S9(0004) COMP.
  1394     05  ACCTF PIC  X(0001).
  1395     05  FILLER REDEFINES ACCTF.
  1396         10  ACCTA PIC  X(0001).
  1397     05  ACCTI PIC  X(0010).
  1398*    -------------------------------
  1399     05  EFFDTL PIC S9(0004) COMP.
  1400     05  EFFDTF PIC  X(0001).
  1401     05  FILLER REDEFINES EFFDTF.
  1402         10  EFFDTA PIC  X(0001).
  1403     05  EFFDTI PIC  X(0008).
  1404*    -------------------------------
  1405     05  CERTNOL PIC S9(0004) COMP.
  1406     05  CERTNOF PIC  X(0001).
  1407     05  FILLER REDEFINES CERTNOF.
  1408         10  CERTNOA PIC  X(0001).
  1409     05  CERTNOI PIC  X(0010).
  1410*    -------------------------------
  1411     05  CRTSFXL PIC S9(0004) COMP.
  1412     05  CRTSFXF PIC  X(0001).
  1413     05  FILLER REDEFINES CRTSFXF.
  1414         10  CRTSFXA PIC  X(0001).
  1415     05  CRTSFXI PIC  X(0001).
  1416*    -------------------------------
  1417     05  LTRIDL PIC S9(0004) COMP.
  1418     05  LTRIDF PIC  X(0001).
  1419     05  FILLER REDEFINES LTRIDF.
  1420         10  LTRIDA PIC  X(0001).
  1421     05  LTRIDI PIC  X(0004).
  1422*    -------------------------------
  1423     05  SEQNOL PIC S9(0004) COMP.
  1424     05  SEQNOF PIC  X(0001).
  1425     05  FILLER REDEFINES SEQNOF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6316.cbl
  1426         10  SEQNOA PIC  X(0001).
  1427     05  SEQNOI PIC  X(0006).
  1428*    -------------------------------
  1429     05  FNAMEL PIC S9(0004) COMP.
  1430     05  FNAMEF PIC  X(0001).
  1431     05  FILLER REDEFINES FNAMEF.
  1432         10  FNAMEA PIC  X(0001).
  1433     05  FNAMEI PIC  X(0010).
  1434*    -------------------------------
  1435     05  MINITL PIC S9(0004) COMP.
  1436     05  MINITF PIC  X(0001).
  1437     05  FILLER REDEFINES MINITF.
  1438         10  MINITA PIC  X(0001).
  1439     05  MINITI PIC  X(0001).
  1440*    -------------------------------
  1441     05  LNAMEL PIC S9(0004) COMP.
  1442     05  LNAMEF PIC  X(0001).
  1443     05  FILLER REDEFINES LNAMEF.
  1444         10  LNAMEA PIC  X(0001).
  1445     05  LNAMEI PIC  X(0015).
  1446*    -------------------------------
  1447     05  OLFDTL PIC S9(0004) COMP.
  1448     05  OLFDTF PIC  X(0001).
  1449     05  FILLER REDEFINES OLFDTF.
  1450         10  OLFDTA PIC  X(0001).
  1451     05  OLFDTI PIC  X(0008).
  1452*    -------------------------------
  1453     05  OLFAMTL PIC S9(0004) COMP.
  1454     05  OLFAMTF PIC  X(0001).
  1455     05  FILLER REDEFINES OLFAMTF.
  1456         10  OLFAMTA PIC  X(0001).
  1457     05  OLFAMTI PIC  X(0012).
  1458*    -------------------------------
  1459     05  OAHDTL PIC S9(0004) COMP.
  1460     05  OAHDTF PIC  X(0001).
  1461     05  FILLER REDEFINES OAHDTF.
  1462         10  OAHDTA PIC  X(0001).
  1463     05  OAHDTI PIC  X(0008).
  1464*    -------------------------------
  1465     05  OAHAMTL PIC S9(0004) COMP.
  1466     05  OAHAMTF PIC  X(0001).
  1467     05  FILLER REDEFINES OAHAMTF.
  1468         10  OAHAMTA PIC  X(0001).
  1469     05  OAHAMTI PIC  X(0012).
  1470*    -------------------------------
  1471     05  NLFDTL PIC S9(0004) COMP.
  1472     05  NLFDTF PIC  X(0001).
  1473     05  FILLER REDEFINES NLFDTF.
  1474         10  NLFDTA PIC  X(0001).
  1475     05  NLFDTI PIC  X(0008).
  1476*    -------------------------------
  1477     05  NLFAMTL PIC S9(0004) COMP.
  1478     05  NLFAMTF PIC  X(0001).
  1479     05  FILLER REDEFINES NLFAMTF.
  1480         10  NLFAMTA PIC  X(0001).
  1481     05  NLFAMTI PIC  X(0012).
  1482*    -------------------------------
  1483     05  NAHDTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6316.cbl
  1484     05  NAHDTF PIC  X(0001).
  1485     05  FILLER REDEFINES NAHDTF.
  1486         10  NAHDTA PIC  X(0001).
  1487     05  NAHDTI PIC  X(0008).
  1488*    -------------------------------
  1489     05  NAHAMTL PIC S9(0004) COMP.
  1490     05  NAHAMTF PIC  X(0001).
  1491     05  FILLER REDEFINES NAHAMTF.
  1492         10  NAHAMTA PIC  X(0001).
  1493     05  NAHAMTI PIC  X(0012).
  1494*    -------------------------------
  1495     05  INPDTL PIC S9(0004) COMP.
  1496     05  INPDTF PIC  X(0001).
  1497     05  FILLER REDEFINES INPDTF.
  1498         10  INPDTA PIC  X(0001).
  1499     05  INPDTI PIC  X(0008).
  1500*    -------------------------------
  1501     05  PROCDTL PIC S9(0004) COMP.
  1502     05  PROCDTF PIC  X(0001).
  1503     05  FILLER REDEFINES PROCDTF.
  1504         10  PROCDTA PIC  X(0001).
  1505     05  PROCDTI PIC  X(0008).
  1506*    -------------------------------
  1507     05  LFCOMML PIC S9(0004) COMP.
  1508     05  LFCOMMF PIC  X(0001).
  1509     05  FILLER REDEFINES LFCOMMF.
  1510         10  LFCOMMA PIC  X(0001).
  1511     05  LFCOMMI PIC  X(0006).
  1512*    -------------------------------
  1513     05  AHCOMML PIC S9(0004) COMP.
  1514     05  AHCOMMF PIC  X(0001).
  1515     05  FILLER REDEFINES AHCOMMF.
  1516         10  AHCOMMA PIC  X(0001).
  1517     05  AHCOMMI PIC  X(0006).
  1518*    -------------------------------
  1519     05  RCD01L PIC S9(0004) COMP.
  1520     05  RCD01F PIC  X(0001).
  1521     05  FILLER REDEFINES RCD01F.
  1522         10  RCD01A PIC  X(0001).
  1523     05  RCD01I PIC  X(0004).
  1524*    -------------------------------
  1525     05  RCD02L PIC S9(0004) COMP.
  1526     05  RCD02F PIC  X(0001).
  1527     05  FILLER REDEFINES RCD02F.
  1528         10  RCD02A PIC  X(0001).
  1529     05  RCD02I PIC  X(0004).
  1530*    -------------------------------
  1531     05  RCD03L PIC S9(0004) COMP.
  1532     05  RCD03F PIC  X(0001).
  1533     05  FILLER REDEFINES RCD03F.
  1534         10  RCD03A PIC  X(0001).
  1535     05  RCD03I PIC  X(0004).
  1536*    -------------------------------
  1537     05  RCD04L PIC S9(0004) COMP.
  1538     05  RCD04F PIC  X(0001).
  1539     05  FILLER REDEFINES RCD04F.
  1540         10  RCD04A PIC  X(0001).
  1541     05  RCD04I PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6316.cbl
  1542*    -------------------------------
  1543     05  RCD05L PIC S9(0004) COMP.
  1544     05  RCD05F PIC  X(0001).
  1545     05  FILLER REDEFINES RCD05F.
  1546         10  RCD05A PIC  X(0001).
  1547     05  RCD05I PIC  X(0004).
  1548*    -------------------------------
  1549     05  RCD06L PIC S9(0004) COMP.
  1550     05  RCD06F PIC  X(0001).
  1551     05  FILLER REDEFINES RCD06F.
  1552         10  RCD06A PIC  X(0001).
  1553     05  RCD06I PIC  X(0004).
  1554*    -------------------------------
  1555     05  RCD07L PIC S9(0004) COMP.
  1556     05  RCD07F PIC  X(0001).
  1557     05  FILLER REDEFINES RCD07F.
  1558         10  RCD07A PIC  X(0001).
  1559     05  RCD07I PIC  X(0004).
  1560*    -------------------------------
  1561     05  RCD08L PIC S9(0004) COMP.
  1562     05  RCD08F PIC  X(0001).
  1563     05  FILLER REDEFINES RCD08F.
  1564         10  RCD08A PIC  X(0001).
  1565     05  RCD08I PIC  X(0004).
  1566*    -------------------------------
  1567     05  RCD09L PIC S9(0004) COMP.
  1568     05  RCD09F PIC  X(0001).
  1569     05  FILLER REDEFINES RCD09F.
  1570         10  RCD09A PIC  X(0001).
  1571     05  RCD09I PIC  X(0004).
  1572*    -------------------------------
  1573     05  RCD10L PIC S9(0004) COMP.
  1574     05  RCD10F PIC  X(0001).
  1575     05  FILLER REDEFINES RCD10F.
  1576         10  RCD10A PIC  X(0001).
  1577     05  RCD10I PIC  X(0004).
  1578*    -------------------------------
  1579     05  RCD11L PIC S9(0004) COMP.
  1580     05  RCD11F PIC  X(0001).
  1581     05  FILLER REDEFINES RCD11F.
  1582         10  RCD11A PIC  X(0001).
  1583     05  RCD11I PIC  X(0004).
  1584*    -------------------------------
  1585     05  RCD12L PIC S9(0004) COMP.
  1586     05  RCD12F PIC  X(0001).
  1587     05  FILLER REDEFINES RCD12F.
  1588         10  RCD12A PIC  X(0001).
  1589     05  RCD12I PIC  X(0004).
  1590*    -------------------------------
  1591     05  CRTNT1L PIC S9(0004) COMP.
  1592     05  CRTNT1F PIC  X(0001).
  1593     05  FILLER REDEFINES CRTNT1F.
  1594         10  CRTNT1A PIC  X(0001).
  1595     05  CRTNT1I PIC  X(0063).
  1596*    -------------------------------
  1597     05  CRTNT2L PIC S9(0004) COMP.
  1598     05  CRTNT2F PIC  X(0001).
  1599     05  FILLER REDEFINES CRTNT2F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6316.cbl
  1600         10  CRTNT2A PIC  X(0001).
  1601     05  CRTNT2I PIC  X(0063).
  1602*    -------------------------------
  1603     05  ERRMSGL PIC S9(0004) COMP.
  1604     05  ERRMSGF PIC  X(0001).
  1605     05  FILLER REDEFINES ERRMSGF.
  1606         10  ERRMSGA PIC  X(0001).
  1607     05  ERRMSGI PIC  X(0075).
  1608*    -------------------------------
  1609     05  PFENTRL PIC S9(0004) COMP.
  1610     05  PFENTRF PIC  X(0001).
  1611     05  FILLER REDEFINES PFENTRF.
  1612         10  PFENTRA PIC  X(0001).
  1613     05  PFENTRI PIC  9(2).
  1614 01  EL631IO REDEFINES EL631II.
  1615     05  FILLER            PIC  X(0012).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  DATEO PIC  X(0008).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  TIMEO PIC  99.99.
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
  1624     05  PROCIDO PIC  X(0004).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  HOSTO PIC  X(0009).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  SYSO PIC  X(0005).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  COMPANYO PIC  X(0003).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  DATASORO PIC  X(0001).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  BATCHNOO PIC  X(0006).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  BSEQNOO PIC  X(0008).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  ARCHNOO PIC  X(0008).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  PRTSWO PIC  X(0001).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  CARRO PIC  X(0001).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  GROUPO PIC  X(0006).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  STATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6316.cbl
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  ACCTO PIC  X(0010).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  EFFDTO PIC  X(0008).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  CERTNOO PIC  X(0010).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  CRTSFXO PIC  X(0001).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  LTRIDO PIC  X(0004).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  SEQNOO PIC  999999.
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  FNAMEO PIC  X(0010).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  MINITO PIC  X(0001).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  LNAMEO PIC  X(0015).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  OLFDTO PIC  X(0008).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  OLFAMTO PIC  Z,ZZZ,999.99.
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  OAHDTO PIC  X(0008).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  OAHAMTO PIC  Z,ZZZ,999.99.
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  NLFDTO PIC  X(0008).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  NLFAMTO PIC  Z,ZZZ,999.99.
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  NAHDTO PIC  X(0008).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  NAHAMTO PIC  Z,ZZZ,999.99.
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  INPDTO PIC  X(0008).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  PROCDTO PIC  X(0008).
  1715*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6316.cbl
  1716     05  FILLER            PIC  X(0003).
  1717     05  LFCOMMO PIC  .99999.
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  AHCOMMO PIC  .99999.
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  RCD01O PIC  X(0004).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  RCD02O PIC  X(0004).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  RCD03O PIC  X(0004).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  RCD04O PIC  X(0004).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  RCD05O PIC  X(0004).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  RCD06O PIC  X(0004).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  RCD07O PIC  X(0004).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  RCD08O PIC  X(0004).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  RCD09O PIC  X(0004).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  RCD10O PIC  X(0004).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  RCD11O PIC  X(0004).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  RCD12O PIC  X(0004).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  CRTNT1O PIC  X(0063).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  CRTNT2O PIC  X(0063).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  ERRMSGO PIC  X(0075).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  PFENTRO PIC  X(0002).
  1769*    -------------------------------
  1770 01  FILLER REDEFINES EL631II.
  1771     12  FILLER                   PIC X(357).
  1772     12  REASONCDS.
  1773         16  FILLER OCCURS 12.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6316.cbl
  1774             20  REACDL       PIC S9(4) COMP.
  1775             20  REACDA       PIC X.
  1776             20  REACD-IN     PIC X(4).
  1777     12  FILLER               PIC X(215).
  1778****************************************************************
  1779*
  1780* Copyright (c) 2007 by Clerity Solutions, Inc.
  1781* All rights reserved.
  1782*
  1783****************************************************************
  1784 01  DFHEIV.
  1785   02  DFHEIV0               PIC X(35).
  1786   02  DFHEIV1               PIC X(08).
  1787   02  DFHEIV2               PIC X(08).
  1788   02  DFHEIV3               PIC X(08).
  1789   02  DFHEIV4               PIC X(06).
  1790   02  DFHEIV5               PIC X(04).
  1791   02  DFHEIV6               PIC X(04).
  1792   02  DFHEIV7               PIC X(02).
  1793   02  DFHEIV8               PIC X(02).
  1794   02  DFHEIV9               PIC X(01).
  1795   02  DFHEIV10              PIC S9(7) COMP-3.
  1796   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1797   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1798   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1799   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1800   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1801   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1802   02  DFHEIV17              PIC X(04).
  1803   02  DFHEIV18              PIC X(04).
  1804   02  DFHEIV19              PIC X(04).
  1805   02  DFHEIV20              USAGE IS POINTER.
  1806   02  DFHEIV21              USAGE IS POINTER.
  1807   02  DFHEIV22              USAGE IS POINTER.
  1808   02  DFHEIV23              USAGE IS POINTER.
  1809   02  DFHEIV24              USAGE IS POINTER.
  1810   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1811   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1812   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1813   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1814   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1815   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1816   02  FILLER                PIC X(02).
  1817   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1818   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1819   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1820   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1821   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1822 LINKAGE  SECTION.
  1823*****************************************************************
  1824*                                                               *
  1825* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1826* All rights reserved.                                          *
  1827*                                                               *
  1828*****************************************************************
  1829 01  dfheiblk.
  1830     02  eibtime          pic s9(7) comp-3.
  1831     02  eibdate          pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6316.cbl
  1832     02  eibtrnid         pic x(4).
  1833     02  eibtaskn         pic s9(7) comp-3.
  1834     02  eibtrmid         pic x(4).
  1835     02  dfheigdi         pic s9(4) comp.
  1836     02  eibcposn         pic s9(4) comp.
  1837     02  eibcalen         pic s9(4) comp.
  1838     02  eibaid           pic x(1).
  1839     02  eibfiller1       pic x(1).
  1840     02  eibfn            pic x(2).
  1841     02  eibfiller2       pic x(2).
  1842     02  eibrcode         pic x(6).
  1843     02  eibfiller3       pic x(2).
  1844     02  eibds            pic x(8).
  1845     02  eibreqid         pic x(8).
  1846     02  eibrsrce         pic x(8).
  1847     02  eibsync          pic x(1).
  1848     02  eibfree          pic x(1).
  1849     02  eibrecv          pic x(1).
  1850     02  eibsend          pic x(1).
  1851     02  eibatt           pic x(1).
  1852     02  eibeoc           pic x(1).
  1853     02  eibfmh           pic x(1).
  1854     02  eibcompl         pic x(1).
  1855     02  eibsig           pic x(1).
  1856     02  eibconf          pic x(1).
  1857     02  eiberr           pic x(1).
  1858     02  eibrldbk         pic x(1).
  1859     02  eiberrcd         pic x(4).
  1860     02  eibsynrb         pic x(1).
  1861     02  eibnodat         pic x(1).
  1862     02  eibfiller5       pic x(2).
  1863     02  eibresp          pic 9(09) comp.
  1864     02  eibresp2         pic 9(09) comp.
  1865     02  dfheigdj         pic s9(4) comp.
  1866     02  dfheigdk         pic s9(4) comp.
  1867 01  DFHCOMMAREA                 PIC X(1300).
  1868 01  var  pic x(30).
  1869*                                COPY ERCACCT.
  1870******************************************************************
  1871*                                                                *
  1872*                                                                *
  1873*                            ERCACCT                             *
  1874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1875*                            VMOD=2.031                          *
  1876*                                                                *
  1877*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1878*                                                                *
  1879*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1880*   VSAM ACCOUNT MASTER FILES.                                   *
  1881*                                                                *
  1882*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1883*                                                                *
  1884*   FILE TYPE = VSAM,KSDS                                        *
  1885*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1886*                                                                *
  1887*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1888*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1889*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6316.cbl
  1890*   LOG = NO                                                     *
  1891*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1892*                                                                *
  1893*                                                                *
  1894******************************************************************
  1895*                   C H A N G E   L O G
  1896*
  1897* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1898*-----------------------------------------------------------------
  1899*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1900* EFFECTIVE    NUMBER
  1901*-----------------------------------------------------------------
  1902* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1903* 092705    2005050300006  PEMA  ADD SPP LEASES
  1904* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1905* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1906* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1907* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1908* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1909******************************************************************
  1910
  1911 01  ACCOUNT-MASTER.
  1912     12  AM-RECORD-ID                      PIC XX.
  1913         88  VALID-AM-ID                      VALUE 'AM'.
  1914
  1915     12  AM-CONTROL-PRIMARY.
  1916         16  AM-COMPANY-CD                 PIC X.
  1917         16  AM-MSTR-CNTRL.
  1918             20  AM-CONTROL-A.
  1919                 24  AM-CARRIER            PIC X.
  1920                 24  AM-GROUPING.
  1921                     28 AM-GROUPING-PREFIX PIC XXX.
  1922                     28 AM-GROUPING-PRIME  PIC XXX.
  1923                 24  AM-STATE              PIC XX.
  1924                 24  AM-ACCOUNT.
  1925                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1926                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1927             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1928                                           PIC X(19).
  1929             20  AM-CNTRL-B.
  1930                 24  AM-EXPIRATION-DT      PIC XX.
  1931                 24  FILLER                PIC X(4).
  1932             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1933                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1934
  1935     12  AM-CONTROL-BY-VAR-GRP.
  1936         16  AM-COMPANY-CD-A1              PIC X.
  1937         16  AM-VG-CARRIER                 PIC X.
  1938         16  AM-VG-GROUPING                PIC X(6).
  1939         16  AM-VG-STATE                   PIC XX.
  1940         16  AM-VG-ACCOUNT                 PIC X(10).
  1941         16  AM-VG-DATE.
  1942             20  AM-VG-EXPIRATION-DT       PIC XX.
  1943             20  FILLER                    PIC X(4).
  1944         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1945                                           PIC 9(11)      COMP-3.
  1946     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1947         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6316.cbl
  1948         16  AM-VG-KEY3.
  1949             20  AM-VG3-ACCOUNT            PIC X(10).
  1950             20  AM-VG3-EXP-DT             PIC XX.
  1951         16  FILLER                        PIC X(4).
  1952     12  AM-MAINT-INFORMATION.
  1953         16  AM-LAST-MAINT-DT              PIC XX.
  1954         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1955         16  AM-LAST-MAINT-USER            PIC X(4).
  1956         16  FILLER                        PIC XX.
  1957
  1958     12  AM-EFFECTIVE-DT                   PIC XX.
  1959     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1960
  1961     12  AM-PREV-DATES  COMP-3.
  1962         16  AM-PREV-EXP-DT                PIC 9(11).
  1963         16  AM-PREV-EFF-DT                PIC 9(11).
  1964
  1965     12  AM-REPORT-CODE-1                  PIC X(10).
  1966     12  AM-REPORT-CODE-2                  PIC X(10).
  1967
  1968     12  AM-CITY-CODE                      PIC X(4).
  1969     12  AM-COUNTY-PARISH                  PIC X(6).
  1970
  1971     12  AM-NAME                           PIC X(30).
  1972     12  AM-PERSON                         PIC X(30).
  1973     12  AM-ADDRS                          PIC X(30).
  1974     12  AM-CITY.
  1975         16  AM-ADDR-CITY                  PIC X(28).
  1976         16  AM-ADDR-STATE                 PIC XX.
  1977     12  AM-ZIP.
  1978         16  AM-ZIP-PRIME.
  1979             20  AM-ZIP-PRI-1ST            PIC X.
  1980                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1981             20  FILLER                    PIC X(4).
  1982         16  AM-ZIP-PLUS4                  PIC X(4).
  1983     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1984         16  AM-CAN-POSTAL-1               PIC XXX.
  1985         16  AM-CAN-POSTAL-2               PIC XXX.
  1986         16  FILLER                        PIC XXX.
  1987     12  AM-TEL-NO.
  1988         16  AM-AREA-CODE                  PIC 999.
  1989         16  AM-TEL-PRE                    PIC 999.
  1990         16  AM-TEL-NBR                    PIC 9(4).
  1991     12  AM-TEL-LOC                        PIC X.
  1992         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1993         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1994
  1995     12  AM-COMM-STRUCTURE.
  1996         16  AM-DEFN-1.
  1997             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1998                 24  AM-AGT.
  1999                     28  AM-AGT-PREFIX     PIC X(4).
  2000                     28  AM-AGT-PRIME      PIC X(6).
  2001                 24  AM-COM-TYP            PIC X.
  2002                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2003                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2004                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2005                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6316.cbl
  2006                 24  AM-RETRO-LV-INDIC     PIC X.
  2007                 24  AM-GL-CODES           PIC X.
  2008                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2009                 24  FILLER                PIC X(01).
  2010         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2011             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2012                 24  FILLER                PIC X(11).
  2013                 24  AM-L-COMA             PIC XXX.
  2014                 24  AM-J-COMA             PIC XXX.
  2015                 24  AM-A-COMA             PIC XXX.
  2016                 24  FILLER                PIC X(6).
  2017
  2018     12  AM-COMM-CHANGE-STATUS             PIC X.
  2019         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2020
  2021     12  AM-CSR-CODE                       PIC X(4).
  2022
  2023     12  AM-BILLING-STATUS                 PIC X.
  2024         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2025         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2026     12  AM-AUTO-REFUND-SW                 PIC X.
  2027         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2028         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2029     12  AM-GPCD                           PIC 99.
  2030     12  AM-IG                             PIC X.
  2031         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2032         88  AM-HAS-GROUP                     VALUE '2'.
  2033     12  AM-STATUS                         PIC X.
  2034         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2035         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2036         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2037         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2038         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2039         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2040     12  AM-REMIT-TO                       PIC 99.
  2041     12  AM-ID-NO                          PIC X(11).
  2042
  2043     12  AM-CAL-TABLE                      PIC XX.
  2044     12  AM-LF-DEVIATION                   PIC XXX.
  2045     12  AM-AH-DEVIATION                   PIC XXX.
  2046     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2047     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2048     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2049     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2050     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2051     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2052
  2053     12  AM-USER-FIELDS.
  2054         16  AM-FLD-1                      PIC XX.
  2055         16  AM-FLD-2                      PIC XX.
  2056         16  AM-FLD-3                      PIC XX.
  2057         16  AM-FLD-4                      PIC XX.
  2058         16  AM-FLD-5                      PIC XX.
  2059
  2060     12  AM-1ST-PROD-DATE.
  2061         16  AM-1ST-PROD-YR                PIC XX.
  2062         16  AM-1ST-PROD-MO                PIC XX.
  2063         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6316.cbl
  2064     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2065     12  AM-CERTS-PURGED-DATE.
  2066         16  AM-PUR-YR                     PIC XX.
  2067         16  AM-PUR-MO                     PIC XX.
  2068         16  AM-PUR-DA                     PIC XX.
  2069     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2070     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2071     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2072     12  AM-INACTIVE-DATE.
  2073         16  AM-INA-MO                     PIC 99.
  2074         16  AM-INA-DA                     PIC 99.
  2075         16  AM-INA-YR                     PIC 99.
  2076     12  AM-AR-HI-CERT-DATE                PIC XX.
  2077
  2078     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2079     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2080
  2081     12  AM-OB-PAYMENT-MODE                PIC X.
  2082         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2083         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2084         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2085         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2086
  2087     12  AM-AH-ONLY-INDICATOR              PIC X.
  2088         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2089         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2090
  2091     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2092
  2093     12  AM-OVER-SHORT.
  2094         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2095         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2096
  2097     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2098     12  AM-DCC-CLP-STATE                  PIC XX.
  2099
  2100     12  AM-RECALC-COMM                    PIC X.
  2101     12  AM-RECALC-REIN                    PIC X.
  2102
  2103     12  AM-REI-TABLE                      PIC XXX.
  2104     12  AM-REI-ET-LF                      PIC X.
  2105     12  AM-REI-ET-AH                      PIC X.
  2106     12  AM-REI-PE-LF                      PIC X.
  2107     12  AM-REI-PE-AH                      PIC X.
  2108     12  AM-REI-PRT-ST                     PIC X.
  2109     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2110     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2111     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2112     12  AM-REI-GROUP-A                    PIC X(6).
  2113     12  AM-REI-MORT                       PIC X(4).
  2114     12  AM-REI-PRT-OW                     PIC X.
  2115     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2116     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2117     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2118     12  AM-REI-GROUP-B                    PIC X(6).
  2119
  2120     12  AM-TRUST-TYPE                     PIC X(2).
  2121
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6316.cbl
  2122     12  AM-EMPLOYER-STMT-USED             PIC X.
  2123     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2124
  2125     12  AM-STD-AH-TYPE                    PIC XX.
  2126     12  AM-EARN-METHODS.
  2127         16  AM-EARN-METHOD-R              PIC X.
  2128             88 AM-REF-RL-R78                 VALUE 'R'.
  2129             88 AM-REF-RL-PR                  VALUE 'P'.
  2130             88 AM-REF-RL-MEAN                VALUE 'M'.
  2131             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2132         16  AM-EARN-METHOD-L              PIC X.
  2133             88 AM-REF-LL-R78                 VALUE 'R'.
  2134             88 AM-REF-LL-PR                  VALUE 'P'.
  2135             88 AM-REF-LL-MEAN                VALUE 'M'.
  2136             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2137         16  AM-EARN-METHOD-A              PIC X.
  2138             88 AM-REF-AH-R78                 VALUE 'R'.
  2139             88 AM-REF-AH-PR                  VALUE 'P'.
  2140             88 AM-REF-AH-MEAN                VALUE 'M'.
  2141             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2142             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2143             88 AM-REF-AH-NET                 VALUE 'N'.
  2144
  2145     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2146     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2147     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2148
  2149     12  AM-RET-Y-N                        PIC X.
  2150     12  AM-RET-P-E                        PIC X.
  2151     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2152     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2153     12  AM-RET-GRP                        PIC X(6).
  2154     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2155         16  AM-POOL-PRIME                 PIC XXX.
  2156         16  AM-POOL-SUB                   PIC XXX.
  2157     12  AM-RETRO-EARNINGS.
  2158         16  AM-RET-EARN-R                 PIC X.
  2159         16  AM-RET-EARN-L                 PIC X.
  2160         16  AM-RET-EARN-A                 PIC X.
  2161     12  AM-RET-ST-TAX-USE                 PIC X.
  2162         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2163         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2164     12  AM-RETRO-BEG-EARNINGS.
  2165         16  AM-RET-BEG-EARN-R             PIC X.
  2166         16  AM-RET-BEG-EARN-L             PIC X.
  2167         16  AM-RET-BEG-EARN-A             PIC X.
  2168     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2169     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2170
  2171     12  AM-USER-SELECT-OPTIONS.
  2172         16  AM-USER-SELECT-1              PIC X(10).
  2173         16  AM-USER-SELECT-2              PIC X(10).
  2174         16  AM-USER-SELECT-3              PIC X(10).
  2175         16  AM-USER-SELECT-4              PIC X(10).
  2176         16  AM-USER-SELECT-5              PIC X(10).
  2177
  2178     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2179
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6316.cbl
  2180     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2181
  2182     12  AM-RPT045A-SWITCH                 PIC X.
  2183         88  RPT045A-OFF                   VALUE 'N'.
  2184
  2185     12  AM-INSURANCE-LIMITS.
  2186         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2187         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2188
  2189     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2190         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2191
  2192     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2193         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2194         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2195
  2196     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2197
  2198     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2199     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2200     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2201     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2202     12  AM-DCC-UEF-STATE                  PIC XX.
  2203     12  FILLER                            PIC XXX.
  2204     12  AM-REPORT-CODE-3                  PIC X(10).
  2205*    12  FILLER                            PIC X(22).
  2206
  2207     12  AM-RESERVE-DATE.
  2208         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2209         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2210         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2211
  2212     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2213     12  AM-NOTIFICATION-TYPES.
  2214         16  AM-NOTIF-OF-LETTERS           PIC X.
  2215         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2216         16  AM-NOTIF-OF-REPORTS           PIC X.
  2217         16  AM-NOTIF-OF-STATUS            PIC X.
  2218
  2219     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2220         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2221         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2222         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2223         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2224
  2225     12  AM-BENEFIT-CONTROLS.
  2226         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2227             20  AM-BENEFIT-CODE           PIC XX.
  2228             20  AM-BENEFIT-TYPE           PIC X.
  2229             20  AM-BENEFIT-REVISION       PIC XXX.
  2230             20  AM-BENEFIT-REM-TERM       PIC X.
  2231             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2232             20  FILLER                    PIC XX.
  2233         16  FILLER                        PIC X(80).
  2234
  2235     12  AM-TRANSFER-DATA.
  2236         16  AM-TRANSFERRED-FROM.
  2237             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6316.cbl
  2238             20  AM-TRNFROM-GROUPING.
  2239                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2240                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2241             20  AM-TRNFROM-STATE          PIC XX.
  2242             20  AM-TRNFROM-ACCOUNT.
  2243                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2244                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2245             20  AM-TRNFROM-DTE            PIC XX.
  2246         16  AM-TRANSFERRED-TO.
  2247             20  AM-TRNTO-CARRIER          PIC X.
  2248             20  AM-TRNTO-GROUPING.
  2249                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2250                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2251             20  AM-TRNTO-STATE            PIC XX.
  2252             20  AM-TRNTO-ACCOUNT.
  2253                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2254                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2255             20  AM-TRNTO-DTE              PIC XX.
  2256         16  FILLER                        PIC X(10).
  2257
  2258     12  AM-SAVED-REMIT-TO                 PIC 99.
  2259
  2260     12  AM-COMM-STRUCTURE-SAVED.
  2261         16  AM-DEFN-1-SAVED.
  2262             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2263                 24  AM-AGT-SV             PIC X(10).
  2264                 24  AM-COM-TYP-SV         PIC X.
  2265                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2266                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2267                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2268                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2269                 24  FILLER                PIC X.
  2270                 24  AM-GL-CODES-SV        PIC X.
  2271                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2272                 24  FILLER                PIC X.
  2273         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2274             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2275                 24  FILLER                PIC X(11).
  2276                 24  AM-L-COMA-SV          PIC XXX.
  2277                 24  AM-J-COMA-SV          PIC XXX.
  2278                 24  AM-A-COMA-SV          PIC XXX.
  2279                 24  FILLER                PIC X(6).
  2280
  2281     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2282         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2283            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2284            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2285            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2286
  2287     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2288     12  FILLER                            PIC X(120).
  2289
  2290     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2291         16  AM-CONTROL-NAME               PIC X(30).
  2292         16  AM-EXECUTIVE-ONE.
  2293             20  AM-EXEC1-NAME             PIC X(15).
  2294             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2295                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6316.cbl
  2296             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2297                                                          COMP-3.
  2298         16  AM-EXECUTIVE-TWO.
  2299             20  AM-EXEC2-NAME             PIC X(15).
  2300             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2301                                                          COMP-3.
  2302             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2303                                                          COMP-3.
  2304
  2305     12  AM-RETRO-ADDITIONAL-DATA.
  2306         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2307         16  AM-RETRO-PREM-P-E             PIC X.
  2308         16  AM-RETRO-CLMS-P-I             PIC X.
  2309         16  AM-RETRO-RET-BRACKET-LF.
  2310             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2311                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2312                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2313             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2314                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2315                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2316             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2317                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2318                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2319         16  AM-RETRO-RET-BRACKET-AH.
  2320             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2321                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2322                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2323                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2324             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2325                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2326                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2327             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2328                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2329                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2330
  2331     12  AM-COMMENTS.
  2332         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2333
  2334     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2335         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2336         16  AM-FLI-BILLING-CODE           PIC X.
  2337         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2338         16  AM-FLI-UNITED-IDENT           PIC X.
  2339         16  AM-FLI-INTEREST-LOST-DATA.
  2340             20  AM-FLI-BANK-NO            PIC X(5).
  2341             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2342             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2343             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2344         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2345             20  AM-FLI-AGT                PIC X(9).
  2346             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2347             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2348         16  FILLER                        PIC X(102).
  2349
  2350     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2351         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2352             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2353             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6316.cbl
  2354             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2355             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2356             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2357         16  FILLER                          PIC X(10).
  2358******************************************************************
  2359*                                COPY ELCCNTL.
  2360******************************************************************
  2361*                                                                *
  2362*                                                                *
  2363*                            ELCCNTL.                            *
  2364*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2365*                            VMOD=2.059                          *
  2366*                                                                *
  2367*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2368*                                                                *
  2369*   FILE TYPE = VSAM,KSDS                                        *
  2370*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2371*                                                                *
  2372*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2373*       ALTERNATE INDEX = NONE                                   *
  2374*                                                                *
  2375*   LOG = YES                                                    *
  2376*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2377******************************************************************
  2378*                   C H A N G E   L O G
  2379*
  2380* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2381*-----------------------------------------------------------------
  2382*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2383* EFFECTIVE    NUMBER
  2384*-----------------------------------------------------------------
  2385* 082503                   PEMA  ADD BENEFIT GROUP
  2386* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2387* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2388* 092705    2005050300006  PEMA  ADD SPP LEASES
  2389* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2390* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2391* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2392* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2393* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2394* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2395******************************************************************
  2396*
  2397 01  CONTROL-FILE.
  2398     12  CF-RECORD-ID                       PIC XX.
  2399         88  VALID-CF-ID                        VALUE 'CF'.
  2400
  2401     12  CF-CONTROL-PRIMARY.
  2402         16  CF-COMPANY-ID                  PIC XXX.
  2403         16  CF-RECORD-TYPE                 PIC X.
  2404             88  CF-COMPANY-MASTER              VALUE '1'.
  2405             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2406             88  CF-STATE-MASTER                VALUE '3'.
  2407             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2408             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2409             88  CF-CARRIER-MASTER              VALUE '6'.
  2410             88  CF-MORTALITY-MASTER            VALUE '7'.
  2411             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6316.cbl
  2412             88  CF-TERMINAL-MASTER             VALUE '9'.
  2413             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2414             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2415             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2416             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2417             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2418             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2419             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2420             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2421             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2422         16  CF-ACCESS-CD-GENL              PIC X(4).
  2423         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2424             20  CF-PROCESSOR               PIC X(4).
  2425         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2426             20  CF-STATE-CODE              PIC XX.
  2427             20  FILLER                     PIC XX.
  2428         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2429             20  FILLER                     PIC XX.
  2430             20  CF-HI-BEN-IN-REC           PIC XX.
  2431         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2432             20  FILLER                     PIC XXX.
  2433             20  CF-CARRIER-CNTL            PIC X.
  2434         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2435             20  FILLER                     PIC XX.
  2436             20  CF-HI-TYPE-IN-REC          PIC 99.
  2437         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2438             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2439                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2440             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2441             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2442         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2443             20  FILLER                     PIC X.
  2444             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2445         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2446             20  FILLER                     PIC XX.
  2447             20  CF-MORTGAGE-PLAN           PIC XX.
  2448         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2449
  2450     12  CF-LAST-MAINT-DT                   PIC XX.
  2451     12  CF-LAST-MAINT-BY                   PIC X(4).
  2452     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2453
  2454     12  CF-RECORD-BODY                     PIC X(728).
  2455
  2456
  2457****************************************************************
  2458*             COMPANY MASTER RECORD                            *
  2459****************************************************************
  2460
  2461     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2462         16  CF-COMPANY-ADDRESS.
  2463             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2464             20  CF-CL-IN-CARE-OF           PIC X(30).
  2465             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2466             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2467             20  CF-CL-CITY-STATE           PIC X(30).
  2468             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2469             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6316.cbl
  2470         16  CF-COMPANY-CD                  PIC X.
  2471         16  CF-COMPANY-PASSWORD            PIC X(8).
  2472         16  CF-SECURITY-OPTION             PIC X.
  2473             88  ALL-SECURITY                   VALUE '1'.
  2474             88  COMPANY-VERIFY                 VALUE '2'.
  2475             88  PROCESSOR-VERIFY               VALUE '3'.
  2476             88  NO-SECURITY                    VALUE '4'.
  2477             88  ALL-BUT-TERM                   VALUE '5'.
  2478         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2479             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2480         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2481             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2482         16  CF-INFORCE-LOCATION            PIC X.
  2483             88  CERTS-ARE-ONLINE               VALUE '1'.
  2484             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2485             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2486         16  CF-LOWER-CASE-LETTERS          PIC X.
  2487         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2488             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2489             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2490             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2491             88  CF-ACCNT-CNTL                  VALUE '3'.
  2492             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2493
  2494         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2495         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2496
  2497         16  CF-LGX-CREDIT-USER             PIC X.
  2498             88  CO-IS-NOT-USER                 VALUE 'N'.
  2499             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2500
  2501         16 CF-CREDIT-CALC-CODES.
  2502             20  CF-CR-REM-TERM-CALC PIC X.
  2503               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2504               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2505               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2506               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2507               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2508               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2509               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2510             20  CF-CR-R78-METHOD           PIC X.
  2511               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2512               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2513
  2514         16  CF-CLAIM-CONTROL-COUNTS.
  2515             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2516                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2517
  2518             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2519                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2520
  2521             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2522                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2523
  2524             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2525                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2526
  2527         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6316.cbl
  2528
  2529         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2530             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2531             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2532             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2533             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2534                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2535                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2536             20  CF-CO-PREM-REJECT-SW       PIC X.
  2537                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2538                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2539             20  CF-CO-REF-REJECT-SW        PIC X.
  2540                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2541                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2542
  2543         16  CF-CO-REPORTING-DT             PIC XX.
  2544         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2545         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2546           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2547           88  CF-CO-MONTH-END                  VALUE '1'.
  2548
  2549         16  CF-LGX-CLAIM-USER              PIC X.
  2550             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2551             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2552
  2553         16  CF-CREDIT-EDIT-CONTROLS.
  2554             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2555             20  CF-MIN-AGE                 PIC 99.
  2556             20  CF-DEFAULT-AGE             PIC 99.
  2557             20  CF-MIN-TERM                PIC S999      COMP-3.
  2558             20  CF-MAX-TERM                PIC S999      COMP-3.
  2559             20  CF-DEFAULT-SEX             PIC X.
  2560             20  CF-JOINT-AGE-INPUT         PIC X.
  2561                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2562             20  CF-BIRTH-DATE-INPUT        PIC X.
  2563                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2564             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2565                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2566                 88  CF-ZERO-CARRIER            VALUE '1'.
  2567                 88  CF-ZERO-GROUPING           VALUE '2'.
  2568                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2569             20  CF-EDIT-SW                 PIC X.
  2570                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2571             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2572             20  CF-CR-PR-METHOD            PIC X.
  2573               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2574               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2575             20  FILLER                     PIC X.
  2576
  2577         16  CF-CREDIT-MISC-CONTROLS.
  2578             20  CF-REIN-TABLE-SW           PIC X.
  2579                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2580             20  CF-COMP-TABLE-SW           PIC X.
  2581                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2582             20  CF-EXPERIENCE-RETENTION-AGE
  2583                                            PIC S9        COMP-3.
  2584             20  CF-CONVERSION-DT           PIC XX.
  2585             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6316.cbl
  2586             20  CF-RUN-FREQUENCY-SW        PIC X.
  2587                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2588                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2589
  2590             20  CF-CR-CHECK-NO-CONTROL.
  2591                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2592                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2593                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2594                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2595                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2596                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2597
  2598                 24  CF-CR-CHECK-COUNT       REDEFINES
  2599                     CF-CR-CHECK-COUNTER      PIC X(4).
  2600
  2601                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2602                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2603
  2604                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2605                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2606                 24  CF-MAIL-PROCESSING       PIC X.
  2607                     88  MAIL-PROCESSING          VALUE 'Y'.
  2608
  2609         16  CF-MISC-SYSTEM-CONTROL.
  2610             20  CF-SYSTEM-C                 PIC X.
  2611                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2612             20  CF-SYSTEM-D                 PIC X.
  2613                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2614             20  CF-SOC-SEC-NO-SW            PIC X.
  2615                 88  SOC-SEC-NO-USED             VALUE '1'.
  2616             20  CF-MEMBER-NO-SW             PIC X.
  2617                 88  MEMBER-NO-USED              VALUE '1'.
  2618             20  CF-TAX-ID-NUMBER            PIC X(11).
  2619             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2620             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2621                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2622                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2623                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2624                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2625             20  CF-SYSTEM-E                 PIC X.
  2626                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2627
  2628         16  CF-LGX-LIFE-USER               PIC X.
  2629             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2630             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2631
  2632         16  CF-CR-MONTH-END-DT             PIC XX.
  2633
  2634         16  CF-FILE-MAINT-DATES.
  2635             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2636                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2637             20  CF-LAST-BATCH       REDEFINES
  2638                 CF-LAST-BATCH-NO               PIC X(4).
  2639             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2640             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2641             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2642             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2643             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6316.cbl
  2644             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2645             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2646             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2647             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2648             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2649
  2650         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2651         16  FILLER                         PIC X.
  2652
  2653         16  CF-ALT-MORT-CODE               PIC X(4).
  2654         16  CF-MEMBER-CAPTION              PIC X(10).
  2655
  2656         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2657             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2658             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2659             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2660             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2661             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2662
  2663         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2664
  2665         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2666         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2667         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2668         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2669
  2670         16  CF-AH-OVERRIDE-L1              PIC X.
  2671         16  CF-AH-OVERRIDE-L2              PIC XX.
  2672         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2673         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2674
  2675         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2676         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2677
  2678         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2679         16  CF-AR-LAST-EL860-DT            PIC XX.
  2680         16  CF-MP-MONTH-END-DT             PIC XX.
  2681
  2682         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2683         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2684             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2685
  2686         16  CF-AR-MONTH-END-DT             PIC XX.
  2687
  2688         16  CF-CRDTCRD-USER                PIC X.
  2689             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2690             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2691
  2692         16  CF-CC-MONTH-END-DT             PIC XX.
  2693
  2694         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2695
  2696         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2697             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2698             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2699             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2700         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2701         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6316.cbl
  2702         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2703         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2704             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2705             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2706         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2707         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2708         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2709             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2710         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2711
  2712         16  CF-CL-ZIP-CODE.
  2713             20  CF-CL-ZIP-PRIME.
  2714                 24  CF-CL-ZIP-1ST          PIC X.
  2715                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2716                 24  FILLER                 PIC X(4).
  2717             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2718         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2719             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2720             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2721             20  FILLER                     PIC XXX.
  2722
  2723         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2724         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2725         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2726         16  CF-CO-OPTION-START-DATE        PIC XX.
  2727         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2728           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2729                                                      '3' '4'.
  2730           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2731           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2732           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2733           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2734           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2735           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2736
  2737         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2738
  2739         16  CF-PAYMENT-APPROVAL-LEVELS.
  2740             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2741             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2742             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2743             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2744             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2745             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2746
  2747         16  CF-END-USER-REPORTING-USER     PIC X.
  2748             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2749             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2750
  2751         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2752             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2753             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2754
  2755         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2756
  2757         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2758         16  FILLER                         PIC X.
  2759
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6316.cbl
  2760         16  CF-CREDIT-ARCHIVE-CNTL.
  2761             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2762             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2763             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2764
  2765         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2766
  2767         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2768             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2769             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2770
  2771         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2772             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2773             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2774
  2775         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2776
  2777         16  CF-CO-ACH-ID-CODE              PIC  X.
  2778             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2779             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2780             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2781         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2782         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2783         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2784         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2785         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2786         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2787         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2788         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2789         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2790                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2791         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2792                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2793
  2794         16  CF-CO-OVER-SHORT.
  2795             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2796             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2797
  2798*         16  FILLER                         PIC X(102).
  2799         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2800             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2801             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2802
  2803         16  CF-AH-APPROVAL-DAYS.
  2804             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2805             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2806             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2807             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2808
  2809         16  FILLER                         PIC X(82).
  2810****************************************************************
  2811*             PROCESSOR/USER RECORD                            *
  2812****************************************************************
  2813
  2814     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2815         16  CF-PROCESSOR-NAME              PIC X(30).
  2816         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2817         16  CF-PROCESSOR-TITLE             PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6316.cbl
  2818         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2819                 88  MESSAGE-YES                VALUE 'Y'.
  2820                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2821
  2822*****************************************************
  2823****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2824****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2825****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2826****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2827*****************************************************
  2828
  2829         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2830             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2831             20  CF-APPLICATION-FORCE       PIC X.
  2832             20  CF-INDIVIDUAL-APP.
  2833                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2834                     28  CF-BROWSE-APP      PIC X.
  2835                     28  CF-UPDATE-APP      PIC X.
  2836
  2837         16  CF-CURRENT-TERM-ON             PIC X(4).
  2838         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2839             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2840             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2841             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2842             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2843             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2844             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2845             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2846         16  CF-PROCESSOR-CARRIER           PIC X.
  2847             88  NO-CARRIER-SECURITY            VALUE ' '.
  2848         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2849             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2850         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2851             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2852         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2853             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2854
  2855         16  CF-PROC-SYS-ACCESS-SW.
  2856             20  CF-PROC-CREDIT-CLAIMS-SW.
  2857                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2858                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2859                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2860                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2861             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2862                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2863                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2864             20  CF-PROC-LIFE-GNRLDGR-SW.
  2865                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2866                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2867                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2868                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2869             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2870                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2871                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2872         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2873             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2874             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2875         16  CF-PROCESSOR-PRINTER               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6316.cbl
  2876
  2877         16  CF-APPROVAL-LEVEL                  PIC X.
  2878             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2879             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2880             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2881             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2882
  2883         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2884
  2885         16  CF-LANGUAGE-TYPE                   PIC X.
  2886             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2887             88  CF-LANG-IS-FR                      VALUE 'F'.
  2888
  2889         16  CF-CSR-IND                         PIC X.
  2890         16  FILLER                             PIC X(239).
  2891
  2892****************************************************************
  2893*             PROCESSOR/REMINDERS RECORD                       *
  2894****************************************************************
  2895
  2896     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2897         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2898             20  CF-START-REMIND-DT         PIC XX.
  2899             20  CF-END-REMIND-DT           PIC XX.
  2900             20  CF-REMINDER-TEXT           PIC X(50).
  2901         16  FILLER                         PIC X(296).
  2902
  2903
  2904****************************************************************
  2905*             STATE MASTER RECORD                              *
  2906****************************************************************
  2907
  2908     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2909         16  CF-STATE-ABBREVIATION          PIC XX.
  2910         16  CF-STATE-NAME                  PIC X(25).
  2911         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2912         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2913             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2914             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2915             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2916             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2917                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2918                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2919             20  CF-ST-PREM-REJECT-SW       PIC X.
  2920                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2921                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2922             20  CF-ST-REF-REJECT-SW        PIC X.
  2923                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2924                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2925         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2926         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2927         16  CF-ST-REFUND-RULES.
  2928             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2929             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2930             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2931         16  CF-ST-FST-PMT-EXTENSION.
  2932             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2933             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6316.cbl
  2934                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2935                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2936                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2937                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2938         16  CF-ST-STATE-CALL.
  2939             20  CF-ST-CALL-UNEARNED        PIC X.
  2940             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2941             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2942         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2943             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2944             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2945         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2946         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2947         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2948         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2949         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2950         16  FILLER                         PIC X.
  2951         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2952             20  CF-ST-BENEFIT-CD           PIC XX.
  2953             20  CF-ST-BENEFIT-KIND         PIC X.
  2954                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2955                 88  CF-ST-AH-KIND              VALUE 'A'.
  2956             20  CF-ST-REM-TERM-CALC        PIC X.
  2957                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2958                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2959                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2960                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2961                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2962                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2963                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2964                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2965
  2966             20  CF-ST-REFUND-CALC          PIC X.
  2967                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2968                 88  ST-REFD-BY-R78             VALUE '1'.
  2969                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2970                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2971                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2972                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2973                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2974                 88  ST-REFD-UTAH               VALUE '7'.
  2975                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2976                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2977                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2978
  2979             20  CF-ST-EARNING-CALC         PIC X.
  2980                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2981                 88  ST-EARN-BY-R78             VALUE '1'.
  2982                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2983                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2984                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2985                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2986                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2987                 88  ST-EARN-MEAN               VALUE '8'.
  2988                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2989
  2990             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2991                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6316.cbl
  2992                 88  ST-OVRD-BY-R78             VALUE '1'.
  2993                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2994                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2995                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2996                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2997                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2998                 88  ST-OVRD-MEAN               VALUE '8'.
  2999                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3000             20  FILLER                     PIC X.
  3001
  3002         16  CF-ST-COMMISSION-CAPS.
  3003             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3004             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3005             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3006             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3007         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3008                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3009
  3010         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3011
  3012         16  CF-ST-STATUTORY-INTEREST.
  3013             20  CF-ST-STAT-DATE-FROM       PIC X.
  3014                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3015                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3016             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3017             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3018             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3019             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3020             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3021
  3022         16  CF-ST-OVER-SHORT.
  3023             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3024             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3025
  3026         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3027
  3028         16  CF-ST-RT-CALC                  PIC X.
  3029
  3030         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3031         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3032         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3033         16  CF-ST-RF-LR-CALC               PIC X.
  3034         16  CF-ST-RF-LL-CALC               PIC X.
  3035         16  CF-ST-RF-LN-CALC               PIC X.
  3036         16  CF-ST-RF-AH-CALC               PIC X.
  3037         16  CF-ST-RF-CP-CALC               PIC X.
  3038*        16  FILLER                         PIC X(206).
  3039*CIDMOD         16  FILLER                         PIC X(192).
  3040         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3041             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3042         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3043         16  CF-ST-VFY-2ND-BENE             PIC X.
  3044         16  FILLER                         PIC X(186).
  3045
  3046****************************************************************
  3047*             BENEFIT MASTER RECORD                            *
  3048****************************************************************
  3049
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6316.cbl
  3050     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3051         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3052             20  CF-BENEFIT-CODE            PIC XX.
  3053             20  CF-BENEFIT-NUMERIC  REDEFINES
  3054                 CF-BENEFIT-CODE            PIC XX.
  3055             20  CF-BENEFIT-ALPHA           PIC XXX.
  3056             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3057             20  CF-BENEFIT-COMMENT         PIC X(10).
  3058
  3059             20  CF-LF-COVERAGE-TYPE        PIC X.
  3060                 88  CF-REDUCING                VALUE 'R'.
  3061                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3062
  3063             20  CF-SPECIAL-CALC-CD         PIC X.
  3064                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3065                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3066                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3067                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3068                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3069                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3070                 88  CF-FARM-PLAN               VALUE 'F'.
  3071                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3072                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3073                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3074                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3075                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3076                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3077                 88  CF-PRUDENTIAL              VALUE 'P'.
  3078                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3079                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3080                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3081                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3082                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3083                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3084
  3085             20  CF-JOINT-INDICATOR         PIC X.
  3086                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3087
  3088*            20  FILLER                     PIC X(12).
  3089             20  FILLER                     PIC X(11).
  3090             20  CF-BENEFIT-CATEGORY        PIC X.
  3091             20  CF-LOAN-TYPE               PIC X(8).
  3092
  3093             20  CF-CO-REM-TERM-CALC        PIC X.
  3094                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3095                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3096                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3097                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3098                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3099
  3100             20  CF-CO-EARNINGS-CALC        PIC X.
  3101                 88  CO-EARN-BY-R78             VALUE '1'.
  3102                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3103                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3104                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3105                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3106                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3107                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6316.cbl
  3108                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3109
  3110             20  CF-CO-REFUND-CALC          PIC X.
  3111                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3112                 88  CO-REFD-BY-R78             VALUE '1'.
  3113                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3114                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3115                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3116                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3117                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3118                 88  CO-REFD-MEAN               VALUE '8'.
  3119                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3120                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3121                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3122
  3123             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3124                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3125                 88  CO-OVRD-BY-R78             VALUE '1'.
  3126                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3127                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3128                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3129                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3130                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3131                 88  CO-OVRD-MEAN               VALUE '8'.
  3132                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3133
  3134             20  CF-CO-BEN-I-G-CD           PIC X.
  3135                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3136                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3137                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3138
  3139         16  FILLER                         PIC X(304).
  3140
  3141
  3142****************************************************************
  3143*             CARRIER MASTER RECORD                            *
  3144****************************************************************
  3145
  3146     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3147         16  CF-ADDRESS-DATA.
  3148             20  CF-MAIL-TO-NAME            PIC X(30).
  3149             20  CF-IN-CARE-OF              PIC X(30).
  3150             20  CF-ADDRESS-LINE-1          PIC X(30).
  3151             20  CF-ADDRESS-LINE-2          PIC X(30).
  3152             20  CF-CITY-STATE              PIC X(30).
  3153             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3154             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3155
  3156         16  CF-CLAIM-NO-CONTROL.
  3157             20  CF-CLAIM-NO-METHOD         PIC X.
  3158                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3159                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3160                 88  CLAIM-NO-SEQ               VALUE '3'.
  3161                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3162             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3163                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3164                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3165                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6316.cbl
  3166
  3167         16  CF-CHECK-NO-CONTROL.
  3168             20  CF-CHECK-NO-METHOD         PIC X.
  3169                 88  CHECK-NO-MANUAL            VALUE '1'.
  3170                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3171                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3172                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3173             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3174                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3175
  3176         16  CF-DOMICILE-STATE              PIC XX.
  3177
  3178         16  CF-EXPENSE-CONTROLS.
  3179             20  CF-EXPENSE-METHOD          PIC X.
  3180                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3181                 88  DOLLARS-PER-PMT            VALUE '2'.
  3182                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3183                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3184             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3185             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3186
  3187         16  CF-CORRESPONDENCE-CONTROL.
  3188             20  CF-LETTER-RESEND-OPT       PIC X.
  3189                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3190                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3191             20  FILLER                     PIC X(4).
  3192
  3193         16  CF-RESERVE-CONTROLS.
  3194             20  CF-MANUAL-SW               PIC X.
  3195                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3196             20  CF-FUTURE-SW               PIC X.
  3197                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3198             20  CF-PTC-SW                  PIC X.
  3199                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3200             20  CF-IBNR-SW                 PIC X.
  3201                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3202             20  CF-PTC-LF-SW               PIC X.
  3203                 88  CF-LF-PTC-USED             VALUE '1'.
  3204             20  CF-CDT-ACCESS-METHOD       PIC X.
  3205                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3206                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3207                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3208             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3209
  3210         16  CF-CLAIM-CALC-METHOD           PIC X.
  3211             88  360-PLUS-MONTHS                VALUE '1'.
  3212             88  365-PLUS-MONTHS                VALUE '2'.
  3213             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3214             88  360-DAILY                      VALUE '4'.
  3215             88  365-DAILY                      VALUE '5'.
  3216
  3217         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3218         16  FILLER                         PIC X(11).
  3219
  3220         16  CF-LIMIT-AMOUNTS.
  3221             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3222             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3223             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6316.cbl
  3224             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3225             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3226             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3227             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3228             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3229             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3230             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3231
  3232         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3233         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3234         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3235
  3236         16  CF-ZIP-CODE.
  3237             20  CF-ZIP-PRIME.
  3238                 24  CF-ZIP-1ST             PIC X.
  3239                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3240                 24  FILLER                 PIC X(4).
  3241             20  CF-ZIP-PLUS4               PIC X(4).
  3242         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3243             20  CF-CAN-POSTAL-1            PIC XXX.
  3244             20  CF-CAN-POSTAL-2            PIC XXX.
  3245             20  FILLER                     PIC XXX.
  3246
  3247         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3248         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3249         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3250
  3251         16  CF-RATING-SWITCH               PIC X.
  3252             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3253             88  CF-NO-RATING                   VALUE 'N'.
  3254
  3255         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3256
  3257         16  CF-CARRIER-OVER-SHORT.
  3258             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3259             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3260
  3261         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3262         16  CF-SECPAY-SWITCH               PIC X.
  3263             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3264             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3265         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3266         16  FILLER                         PIC X(448).
  3267*        16  FILLER                         PIC X(452).
  3268
  3269
  3270****************************************************************
  3271*             MORTALITY MASTER RECORD                          *
  3272****************************************************************
  3273
  3274     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3275         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3276                                INDEXED BY CF-MORT-NDX.
  3277             20  CF-MORT-TABLE              PIC X(5).
  3278             20  CF-MORT-TABLE-TYPE         PIC X.
  3279                 88  CF-MORT-JOINT              VALUE 'J'.
  3280                 88  CF-MORT-SINGLE             VALUE 'S'.
  3281                 88  CF-MORT-COMBINED           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6316.cbl
  3282                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3283                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3284             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3285             20  CF-MORT-AGE-METHOD         PIC XX.
  3286                 88  CF-AGE-LAST                VALUE 'AL'.
  3287                 88  CF-AGE-NEAR                VALUE 'AN'.
  3288             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3289             20  CF-MORT-ADJUSTMENT-DIRECTION
  3290                                            PIC X.
  3291                 88  CF-MINUS                   VALUE '-'.
  3292                 88  CF-PLUS                    VALUE '+'.
  3293             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3294             20  CF-MORT-JOINT-CODE         PIC X.
  3295                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3296             20  CF-MORT-PC-Q               PIC X.
  3297                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3298             20  CF-MORT-TABLE-CODE         PIC X(4).
  3299             20  CF-MORT-COMMENTS           PIC X(15).
  3300             20  FILLER                     PIC X(14).
  3301
  3302         16  FILLER                         PIC X(251).
  3303
  3304
  3305****************************************************************
  3306*             BUSSINESS TYPE MASTER RECORD                     *
  3307****************************************************************
  3308
  3309     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3310* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3311* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3312* AND RECORD 05 IS TYPES 81-99
  3313         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3314             20  CF-BUSINESS-TITLE          PIC  X(19).
  3315             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3316                                            PIC S9V9(4) COMP-3.
  3317             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3318             20  FILLER                     PIC  X.
  3319         16  FILLER                         PIC  X(248).
  3320
  3321
  3322****************************************************************
  3323*             TERMINAL MASTER RECORD                           *
  3324****************************************************************
  3325
  3326     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3327
  3328         16  CF-COMPANY-TERMINALS.
  3329             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3330                                  PIC X(4).
  3331         16  FILLER               PIC X(248).
  3332
  3333
  3334****************************************************************
  3335*             LIFE EDIT MASTER RECORD                          *
  3336****************************************************************
  3337
  3338     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3339         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6316.cbl
  3340             20  CF-LIFE-CODE-IN            PIC XX.
  3341             20  CF-LIFE-CODE-OUT           PIC XX.
  3342         16  FILLER                         PIC X(248).
  3343
  3344
  3345****************************************************************
  3346*             AH EDIT MASTER RECORD                            *
  3347****************************************************************
  3348
  3349     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3350         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3351             20  CF-AH-CODE-IN              PIC XXX.
  3352             20  CF-AH-CODE-OUT             PIC XX.
  3353         16  FILLER                         PIC X(248).
  3354
  3355
  3356****************************************************************
  3357*             CREDIBILITY TABLES                               *
  3358****************************************************************
  3359
  3360     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3361         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3362                             INDEXED BY CF-CRDB-NDX.
  3363             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3364             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3365             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3366         16  FILLER                         PIC  X(332).
  3367
  3368
  3369****************************************************************
  3370*             REPORT CUSTOMIZATION RECORD                      *
  3371****************************************************************
  3372
  3373     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3374         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3375             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3376             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3377             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3378**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3379****       A T-TRANSFER.                                   ****
  3380             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3381
  3382         16  FILLER                         PIC XX.
  3383
  3384         16  CF-CARRIER-CNTL-OPT.
  3385             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3386                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3387                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3388             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3389                                            PIC X.
  3390         16  CF-GROUP-CNTL-OPT.
  3391             20  CF-GROUP-OPT-SEQ           PIC 9.
  3392                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3393                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3394             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3395                                            PIC X(6).
  3396         16  CF-STATE-CNTL-OPT.
  3397             20  CF-STATE-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6316.cbl
  3398                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3399                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3400             20  CF-STATE-SELECT OCCURS 3 TIMES
  3401                                            PIC XX.
  3402         16  CF-ACCOUNT-CNTL-OPT.
  3403             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3404                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3405                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3406             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3407                                            PIC X(10).
  3408         16  CF-BUS-TYP-CNTL-OPT.
  3409             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3410                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3411                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3412             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3413                                            PIC XX.
  3414         16  CF-LF-TYP-CNTL-OPT.
  3415             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3416                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3417                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3418             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3419                                            PIC XX.
  3420         16  CF-AH-TYP-CNTL-OPT.
  3421             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3422                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3423                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3424             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3425                                            PIC XX.
  3426         16  CF-REPTCD1-CNTL-OPT.
  3427             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3428                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3429                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3430             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3431                                            PIC X(10).
  3432         16  CF-REPTCD2-CNTL-OPT.
  3433             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3434                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3435                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3436             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3437                                            PIC X(10).
  3438         16  CF-USER1-CNTL-OPT.
  3439             20  CF-USER1-OPT-SEQ           PIC 9.
  3440                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3441                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3442             20  CF-USER1-SELECT OCCURS 3 TIMES
  3443                                            PIC X(10).
  3444         16  CF-USER2-CNTL-OPT.
  3445             20  CF-USER2-OPT-SEQ           PIC 9.
  3446                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3447                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3448             20  CF-USER2-SELECT OCCURS 3 TIMES
  3449                                            PIC X(10).
  3450         16  CF-USER3-CNTL-OPT.
  3451             20  CF-USER3-OPT-SEQ           PIC 9.
  3452                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3453                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3454             20  CF-USER3-SELECT OCCURS 3 TIMES
  3455                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6316.cbl
  3456         16  CF-USER4-CNTL-OPT.
  3457             20  CF-USER4-OPT-SEQ           PIC 9.
  3458                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3459                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3460             20  CF-USER4-SELECT OCCURS 3 TIMES
  3461                                            PIC X(10).
  3462         16  CF-USER5-CNTL-OPT.
  3463             20  CF-USER5-OPT-SEQ           PIC 9.
  3464                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3465                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3466             20  CF-USER5-SELECT OCCURS 3 TIMES
  3467                                            PIC X(10).
  3468         16  CF-REINS-CNTL-OPT.
  3469             20  CF-REINS-OPT-SEQ           PIC 9.
  3470                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3471                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3472             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3473                 24  CF-REINS-PRIME         PIC XXX.
  3474                 24  CF-REINS-SUB           PIC XXX.
  3475
  3476         16  CF-AGENT-CNTL-OPT.
  3477             20  CF-AGENT-OPT-SEQ           PIC 9.
  3478                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3479                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3480             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3481                                            PIC X(10).
  3482
  3483         16  FILLER                         PIC X(43).
  3484
  3485         16  CF-LOSS-RATIO-SELECT.
  3486             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3487             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3488         16  CF-ENTRY-DATE-SELECT.
  3489             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3490             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3491         16  CF-EFFECTIVE-DATE-SELECT.
  3492             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3493             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3494
  3495         16  CF-EXCEPTION-LIST-IND          PIC X.
  3496             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3497
  3498         16  FILLER                         PIC X(318).
  3499
  3500****************************************************************
  3501*                  EXCEPTION REPORTING RECORD                  *
  3502****************************************************************
  3503
  3504     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3505         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3506             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3507
  3508         16  CF-COMBINED-LIFE-AH-OPT.
  3509             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3510             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3511             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3512             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3513
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6316.cbl
  3514         16  CF-LIFE-OPT.
  3515             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3516             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3517             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3518             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3519             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3520             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3521             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3522             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3523             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3524             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3525
  3526         16  CF-AH-OPT.
  3527             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3528             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3529             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3530             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3531             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3532             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3533             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3534             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3535             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3536             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3537
  3538         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3539             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3540             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3541             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3542
  3543         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3544
  3545         16  FILLER                         PIC X(673).
  3546
  3547
  3548****************************************************************
  3549*             MORTGAGE SYSTEM PLAN RECORD                      *
  3550****************************************************************
  3551
  3552     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3553         16  CF-PLAN-TYPE                   PIC X.
  3554             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3555             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3556             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3557         16  CF-PLAN-ABBREV                 PIC XXX.
  3558         16  CF-PLAN-DESCRIPT               PIC X(10).
  3559         16  CF-PLAN-NOTES                  PIC X(20).
  3560         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3561         16  CF-PLAN-UNDERWRITING.
  3562             20  CF-PLAN-TERM-DATA.
  3563                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3564                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3565             20  CF-PLAN-AGE-DATA.
  3566                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3567                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3568                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3569             20  CF-PLAN-BENEFIT-DATA.
  3570                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3571                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6316.cbl
  3572                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3573                                            PIC S9(7)V99  COMP-3.
  3574         16  CF-PLAN-POLICY-FORMS.
  3575             20  CF-POLICY-FORM             PIC X(12).
  3576             20  CF-MASTER-APPLICATION      PIC X(12).
  3577             20  CF-MASTER-POLICY           PIC X(12).
  3578         16  CF-PLAN-RATING.
  3579             20  CF-RATE-CODE               PIC X(5).
  3580             20  CF-SEX-RATING              PIC X.
  3581                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3582                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3583             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3584             20  CF-SUB-STD-TYPE            PIC X.
  3585                 88  CF-PCT-OF-PREM            VALUE '1'.
  3586                 88  CF-PCT-OF-BENE            VALUE '2'.
  3587         16  CF-PLAN-PREM-TOLERANCES.
  3588             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3589             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3590         16  CF-PLAN-PYMT-TOLERANCES.
  3591             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3592             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3593         16  CF-PLAN-MISC-DATA.
  3594             20  FILLER                     PIC X.
  3595             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3596             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3597         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3598         16  CF-PLAN-IND-GRP                PIC X.
  3599             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3600                                                     '1'.
  3601             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3602                                                     '2'.
  3603         16  CF-MIB-SEARCH-SW               PIC X.
  3604             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3605             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3606             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3607             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3608         16  CF-ALPHA-SEARCH-SW             PIC X.
  3609             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3610             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3611             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3612             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3613             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3614             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3615             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3616             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3617             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3618             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3619                                                     'A' 'B' 'C'
  3620                                                     'X' 'Y' 'Z'.
  3621         16  CF-EFF-DT-RULE-SW              PIC X.
  3622             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3623             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3624             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3625             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3626             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3627         16  FILLER                         PIC X(4).
  3628         16  CF-HEALTH-QUESTIONS            PIC X.
  3629             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6316.cbl
  3630         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3631         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3632         16  CF-PLAN-SNGL-JNT               PIC X.
  3633             88  CF-COMBINED-PLAN              VALUE 'C'.
  3634             88  CF-JNT-PLAN                   VALUE 'J'.
  3635             88  CF-SNGL-PLAN                  VALUE 'S'.
  3636         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3637         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3638         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3639         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3640         16  CF-RERATE-CNTL                 PIC  X.
  3641             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3642             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3643             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3644             88  CF-AUTO-RECALC                 VALUE '4'.
  3645         16  CF-BENEFIT-TYPE                PIC  X.
  3646             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3647             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3648         16  CF-POLICY-FEE                  PIC S999V99
  3649                                                    COMP-3.
  3650         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3651         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3652         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3653         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3654         16  FILLER                         PIC  X(32).
  3655         16  CF-TERMINATION-FORM            PIC  X(04).
  3656         16  FILLER                         PIC  X(08).
  3657         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3658                                                       COMP-3.
  3659         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3660         16  CF-ISSUE-LETTER                PIC  X(4).
  3661         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3662         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3663             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3664             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3665         16  CF-MP-REFUND-CALC              PIC X.
  3666             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3667             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3668             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3669             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3670             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3671             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3672             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3673             88  CF-MP-REFD-MEAN                VALUE '8'.
  3674         16  CF-ALT-RATE-CODE               PIC  X(5).
  3675
  3676
  3677         16  FILLER                         PIC X(498).
  3678****************************************************************
  3679*             MORTGAGE COMPANY MASTER RECORD                   *
  3680****************************************************************
  3681
  3682     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3683         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3684         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3685             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3686             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3687             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6316.cbl
  3688             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3689             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3690
  3691         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3692         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3693         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3694         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3695         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3696
  3697         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3698             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3699         16  CF-MP-RECON-USE-IND            PIC X(1).
  3700             88  CF-MP-USE-RECON             VALUE 'Y'.
  3701         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3702             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3703         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3704             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3705             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3706         16  FILLER                         PIC X(1).
  3707         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3708             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3709         16  CF-MORTG-MIB-VERSION           PIC X.
  3710             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3711             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3712             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3713         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3714             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3715                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3716             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3717                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3718             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3719                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3720             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3721                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3722             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3723                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3724             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3725                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3726         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3727         16  FILLER                         PIC X(7).
  3728         16  CF-MORTG-DESTINATION-SYMBOL.
  3729             20  CF-MORTG-MIB-COMM          PIC X(5).
  3730             20  CF-MORTG-MIB-TERM          PIC X(5).
  3731         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3732             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3733         16  FILLER                         PIC X(03).
  3734         16  CF-MP-CHECK-NO-CONTROL.
  3735             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3736                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3737                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3738                                                ' ' LOW-VALUES.
  3739                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3740                                               VALUE '3'.
  3741         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3742         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3743         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3744             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3745                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6316.cbl
  3746             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3747                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3748             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3749                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3750             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3751                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3752             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3753                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3754             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3755                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3756         16  CF-MORTG-BILLING-AREA.
  3757             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3758                                            PIC X.
  3759         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3760         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3761         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3762         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3763             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3764             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3765         16  FILLER                         PIC X.
  3766         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3767             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3768             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3769         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3770         16  FILLER                         PIC X(8).
  3771         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3772         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3773         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3774         16  CF-ACH-COMPANY-ID.
  3775             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3776                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3777                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3778                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3779             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3780         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3781             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3782         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3783             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3784             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3785         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3786         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3787         16  FILLER                         PIC X(536).
  3788
  3789****************************************************************
  3790*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3791****************************************************************
  3792
  3793     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3794         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3795             20  CF-FEMALE-HEIGHT.
  3796                 24  CF-FEMALE-FT           PIC 99.
  3797                 24  CF-FEMALE-IN           PIC 99.
  3798             20  CF-FEMALE-MIN-WT           PIC 999.
  3799             20  CF-FEMALE-MAX-WT           PIC 999.
  3800         16  FILLER                         PIC X(428).
  3801
  3802     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3803         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6316.cbl
  3804             20  CF-MALE-HEIGHT.
  3805                 24  CF-MALE-FT             PIC 99.
  3806                 24  CF-MALE-IN             PIC 99.
  3807             20  CF-MALE-MIN-WT             PIC 999.
  3808             20  CF-MALE-MAX-WT             PIC 999.
  3809         16  FILLER                         PIC X(428).
  3810******************************************************************
  3811*             AUTOMATIC ACTIVITY RECORD                          *
  3812******************************************************************
  3813     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3814         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3815             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3816             20  CF-SYS-LETTER-ID           PIC X(04).
  3817             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3818             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3819             20  CF-SYS-RESET-SW            PIC X(01).
  3820             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3821             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3822
  3823         16  FILLER                         PIC X(50).
  3824
  3825         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3826             20  CF-USER-ACTIVE-SW          PIC X(01).
  3827             20  CF-USER-LETTER-ID          PIC X(04).
  3828             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3829             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3830             20  CF-USER-RESET-SW           PIC X(01).
  3831             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3832             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3833             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3834
  3835         16  FILLER                         PIC X(246).
  3836*                                COPY ERCPNDB.
  3837******************************************************************
  3838*                                                                *
  3839*                                                                *
  3840*                            ERCPNDB.                            *
  3841*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3842*                            VMOD=2.025                          *
  3843*                                                                *
  3844*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3845*                                                                *
  3846******************************************************************
  3847*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3848*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3849******************************************************************
  3850*                                                                *
  3851*                                                                *
  3852*   FILE TYPE = VSAM,KSDS                                        *
  3853*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3854*                                                                *
  3855*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3856*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3857*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3858*                                                 RKP=13,LEN=36  *
  3859*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3860*                                      AND CHG-SEQ.)             *
  3861*                                                RKP=49,LEN=11   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6316.cbl
  3862*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3863*                                      AND CHG-SEQ.)             *
  3864*                                                RKP=60,LEN=15   *
  3865*                                                                *
  3866*   LOG = NO                                                     *
  3867*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3868******************************************************************
  3869******************************************************************
  3870*                   C H A N G E   L O G
  3871*
  3872* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3873*-----------------------------------------------------------------
  3874*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3875* EFFECTIVE    NUMBER
  3876*-----------------------------------------------------------------
  3877* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3878* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3879* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3880* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3881* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3882* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3883* 032306                   PEMA  ADD BOW LOAN NUMBER
  3884* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3885* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3886* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3887* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3888* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3889* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3890* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3891* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3892******************************************************************
  3893
  3894 01  PENDING-BUSINESS.
  3895     12  PB-RECORD-ID                     PIC XX.
  3896         88  VALID-PB-ID                        VALUE 'PB'.
  3897
  3898     12  PB-CONTROL-PRIMARY.
  3899         16  PB-COMPANY-CD                PIC X.
  3900         16  PB-ENTRY-BATCH               PIC X(6).
  3901         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3902         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3903
  3904     12  PB-CONTROL-BY-ACCOUNT.
  3905         16  PB-COMPANY-CD-A1             PIC X.
  3906         16  PB-CARRIER                   PIC X.
  3907         16  PB-GROUPING.
  3908             20  PB-GROUPING-PREFIX       PIC XXX.
  3909             20  PB-GROUPING-PRIME        PIC XXX.
  3910         16  PB-STATE                     PIC XX.
  3911         16  PB-ACCOUNT.
  3912             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3913             20  PB-ACCOUNT-PRIME         PIC X(6).
  3914         16  PB-CERT-EFF-DT               PIC XX.
  3915         16  PB-CERT-NO.
  3916             20  PB-CERT-PRIME            PIC X(10).
  3917             20  PB-CERT-SFX              PIC X.
  3918         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3919
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6316.cbl
  3920         16  PB-RECORD-TYPE               PIC X.
  3921             88  PB-MAILING-DATA                VALUE '0'.
  3922             88  PB-ISSUE                       VALUE '1'.
  3923             88  PB-CANCELLATION                VALUE '2'.
  3924             88  PB-BATCH-TRAILER               VALUE '9'.
  3925
  3926     12  PB-CONTROL-BY-ORIG-BATCH.
  3927         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3928         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3929         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3930         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3931
  3932     12  PB-CONTROL-BY-CSR.
  3933         16  PB-CSR-COMPANY-CD            PIC X.
  3934         16  PB-CSR-ID                    PIC X(4).
  3935         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3936         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3937         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3938******************************************************************
  3939*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3940******************************************************************
  3941
  3942     12  PB-LAST-MAINT-DT                 PIC XX.
  3943     12  PB-LAST-MAINT-BY                 PIC X(4).
  3944     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3945
  3946     12  PB-RECORD-BODY                   PIC X(375).
  3947
  3948     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3949         16  PB-CERT-ORIGIN               PIC X.
  3950             88  CLASIC-CREATED-CERT         VALUE '1'.
  3951         16  PB-I-NAME.
  3952             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3953             20  PB-I-INSURED-FIRST-NAME.
  3954                 24  PB-I-INSURED-1ST-INIT PIC X.
  3955                 24  FILLER                PIC X(9).
  3956             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3957         16  PB-I-AGE                     PIC S99   COMP-3.
  3958         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3959         16  PB-I-BIRTHDAY                PIC XX.
  3960         16  PB-I-INSURED-SEX             PIC X.
  3961             88  PB-SEX-MALE     VALUE 'M'.
  3962             88  PB-SEX-FEMALE   VALUE 'F'.
  3963
  3964         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3965         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3966         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3967         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3968         16  PB-I-SKIP-CODE               PIC X.
  3969             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3970             88  PB-SKIP-JULY              VALUE '1'.
  3971             88  PB-SKIP-AUGUST            VALUE '2'.
  3972             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3973             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3974             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3975             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3976             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3977             88  PB-SKIP-JUNE              VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6316.cbl
  3978             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3979             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3980             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3981         16  PB-I-TERM-TYPE               PIC X.
  3982             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3983             88  PB-PAID-WEEKLY            VALUE 'W'.
  3984             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3985             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3986             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3987         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3988         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3989         16  PB-I-DATA-ENTRY-SW           PIC X.
  3990             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3991             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3992             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3993             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3994         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3995         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3996*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3997         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3998         16  FILLER                       PIC X.
  3999
  4000         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4001             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4002             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4003                                                   '90' THRU '99'.
  4004         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4005                                          PIC XX.
  4006         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4007         16  PB-I-AMOUNT-FINANCED REDEFINES
  4008                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4009         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4010         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4011                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4012         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4013         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4014         16  PB-I-CLP-AMOUNT REDEFINES
  4015                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4016         16  PB-I-LF-CALC-FLAG            PIC X.
  4017             88 PB-COMP-LF-PREM               VALUE '?'.
  4018         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4019         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4020         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4021         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4022         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4023         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4024         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4025         16  PB-I-LF-ABBR                 PIC XXX.
  4026         16  PB-I-LF-INPUT-CD             PIC XX.
  4027
  4028         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4029             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4030             88  PB-INVALID-AH               VALUE '  ' '00'
  4031                                                   '90' THRU '99'.
  4032         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4033         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4034         16  PB-I-AH-CALC-FLAG            PIC X.
  4035             88 PB-COMP-AH-PREM                  VALUE '?'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6316.cbl
  4036         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4037         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4038         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4039         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4040         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4041         16  PB-I-AH-ABBR                 PIC XXX.
  4042         16  PB-I-AH-INPUT-CD             PIC XXX.
  4043
  4044         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4045         16  PB-I-REIN-TABLE              PIC XXX.
  4046         16  PB-I-BUSINESS-TYPE           PIC 99.
  4047         16  PB-I-INDV-GRP-CD             PIC X.
  4048         16  PB-I-MORT-CODE.
  4049             20  PB-I-TABLE               PIC X.
  4050             20  PB-I-INTEREST            PIC XX.
  4051             20  PB-I-MORT-TYP            PIC X.
  4052         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4053         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4054         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4055         16  PB-I-INDV-GRP-OVRD           PIC X.
  4056         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4057         16  PB-I-SIG-SW                  PIC X.
  4058             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4059         16  PB-I-RATE-CLASS              PIC XX.
  4060         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4061         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4062         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4063         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4064         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4065         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4066         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4067         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4068         16  PB-I-OB-FLAG                 PIC X.
  4069             88  PB-I-OB                      VALUE 'B'.
  4070             88  PB-I-SUMMARY                 VALUE 'Z'.
  4071         16  PB-I-ENTRY-STATUS            PIC X.
  4072             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4073                                              'M' '5' '9' '2'.
  4074             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4075             88  PB-I-POLICY-PENDING          VALUE '2'.
  4076             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4077             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4078             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4079             88  PB-I-REIN-ONLY               VALUE '9'.
  4080             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4081             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4082             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4083             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4084         16  PB-I-INT-CODE                PIC X.
  4085             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4086             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4087         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4088         16  PB-I-SOC-SEC-NO              PIC X(11).
  4089         16  PB-I-MEMBER-NO               PIC X(12).
  4090         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4091*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4092         16  PB-I-OLD-LOF                 PIC XXX.
  4093         16  PB-I-LF-EXPIRE-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6316.cbl
  4094         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4095         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4096         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4097         16  PB-I-LIFE-INDICATOR          PIC X.
  4098             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4099         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4100         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4101                                          PIC S9(5)V99    COMP-3.
  4102         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4103             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4104             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4105         16  PB-I-1ST-PMT-DT              PIC XX.
  4106         16  PB-I-JOINT-INSURED.
  4107             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4108             20 PB-I-JOINT-FIRST-NAME.
  4109                24  PB-I-JOINT-FIRST-INIT PIC X.
  4110                24  FILLER                PIC X(9).
  4111             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4112*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4113         16  PB-I-BENEFICIARY-NAME.
  4114             20  PB-I-BANK-NUMBER         PIC X(10).
  4115             20  FILLER                   PIC X(15).
  4116         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4117         16  PB-I-REFERENCE               PIC X(12).
  4118         16  FILLER REDEFINES PB-I-REFERENCE.
  4119             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4120             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4121             20  PB-I-CLP-STATE           PIC XX.
  4122         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4123             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4124             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4125             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4126         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4127         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4128         16  PB-I-RESIDENT-STATE          PIC XX.
  4129         16  PB-I-RATE-CODE               PIC X(4).
  4130         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4131         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4132         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4133         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4134         16  PB-I-BANK-NOCHRGB            PIC 99.
  4135         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4136         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4137
  4138     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4139         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4140             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4141         16  PB-C-CANCEL-ORIGIN           PIC X.
  4142             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4143         16  PB-C-LF-CANCEL-DT            PIC XX.
  4144         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4145         16  PB-C-LF-CALC-REQ             PIC X.
  4146             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4147         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4148         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4149         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4150             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4151         16  PB-C-AH-CANCEL-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6316.cbl
  4152         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4153         16  PB-C-AH-CALC-REQ             PIC X.
  4154             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4155         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4156         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4157         16  PB-C-LAST-NAME               PIC X(15).
  4158         16  PB-C-REFUND-SW               PIC X.
  4159             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4160             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4161         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4162         16  PB-C-PAYEE-CODE              PIC X(6).
  4163         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4164         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4165         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4166         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4167         16  PB-C-REFERENCE               PIC X(12).
  4168         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4169         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4170         16  PB-C-POST-CARD-IND           PIC X.
  4171         16  PB-C-CANCEL-REASON           PIC X.
  4172         16  PB-C-REF-INTERFACE-SW        PIC X.
  4173         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4174         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4175         16  FILLER                       PIC X(01).
  4176*        16  FILLER                       PIC X(18).
  4177         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4178*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4179         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4180         16  PB-CANCELED-CERT-DATA.
  4181             20  PB-CI-INSURED-NAME.
  4182                 24  PB-CI-LAST-NAME      PIC X(15).
  4183                 24  PB-CI-INITIALS       PIC XX.
  4184             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4185             20  PB-CI-INSURED-SEX        PIC X.
  4186             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4187             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4188             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4189             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4190             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4191             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4192             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4193             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4194             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4195             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4196             20  PB-CI-RATE-CLASS         PIC XX.
  4197             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4198             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4199             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4200             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4201             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4202             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4203             20  PB-CI-LF-ABBR            PIC X(3).
  4204             20  PB-CI-AH-ABBR            PIC X(3).
  4205             20  PB-CI-OB-FLAG            PIC X.
  4206                 88  PB-CI-OB                VALUE 'B'.
  4207             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4208                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4209                                           'M' '4' '5' '9' '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6316.cbl
  4210                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4211                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4212                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4213                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4214                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4215                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4216                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4217                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4218                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4219                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4220                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4221                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4222             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4223                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4224                                           'M' '4' '5' '9' '2'.
  4225                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4226                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4227                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4228                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4229                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4230                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4231                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4232                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4233                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4234                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4235                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4236                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4237             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4238             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4239             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4240             20  PB-CI-MEMBER-NO          PIC X(12).
  4241             20  PB-CI-INT-CODE           PIC X.
  4242                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4243                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4244             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4245             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4246             20  PB-CI-COMP-EXCP-SW       PIC X.
  4247                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4248                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4249             20  PB-CI-ENTRY-STATUS       PIC X.
  4250             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4251             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4252             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4253             20  PB-CI-DEATH-DT           PIC XX.
  4254             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4255             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4256             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4257             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4258             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4259             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4260             20  PB-CI-ENTRY-DT              PIC XX.
  4261             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4262             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4263             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4264             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4265             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4266             20  PB-CI-OLD-LOF               PIC XXX.
  4267*            20  PB-CI-LOAN-OFFICER          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6316.cbl
  4268             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4269             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4270             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4271             20  PB-CI-INDV-GRP-CD           PIC X.
  4272             20  PB-CI-BENEFICIARY-NAME.
  4273                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4274                 24  FILLER                  PIC X(15).
  4275             20  PB-CI-NOTE-SW               PIC X.
  4276             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4277             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4278             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4279             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4280             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4281             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4282             20  PB-CI-FIRST-NAME            PIC X(10).
  4283             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4284
  4285         16  FILLER                       PIC X(13).
  4286*032306  16  FILLER                       PIC X(27).
  4287*        16  FILLER                       PIC X(46).
  4288
  4289     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4290         16  FILLER                       PIC X(10).
  4291         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4292         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4293         16  PB-M-INSURED-MID-INIT        PIC X.
  4294         16  PB-M-INSURED-AGE             PIC 99.
  4295         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4296         16  PB-M-INSURED-SEX             PIC X.
  4297         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4298         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4299         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4300         16  PB-M-INSURED-CITY-STATE.
  4301             20  PB-M-INSURED-CITY        PIC X(28).
  4302             20  PB-M-INSURED-STATE       PIC XX.
  4303         16  PB-M-INSURED-ZIP-CODE.
  4304             20  PB-M-INSURED-ZIP-PRIME.
  4305                 24  PB-M-INSURED-ZIP-1   PIC X.
  4306                     88  PB-M-CANADIAN-POST-CODE
  4307                                             VALUE 'A' THRU 'Z'.
  4308                 24  FILLER               PIC X(4).
  4309             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4310         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4311                                        PB-M-INSURED-ZIP-CODE.
  4312             20  PM-M-INS-CAN-POST1       PIC XXX.
  4313             20  PM-M-INS-CAN-POST2       PIC XXX.
  4314             20  FILLER                   PIC XXX.
  4315         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4316         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4317         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4318         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4319         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4320         16  PB-M-CRED-BENE-CITYST.
  4321             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4322             20  PB-M-CRED-BENE-STATE     PIC XX.
  4323         16  FILLER                       PIC X(92).
  4324
  4325     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6316.cbl
  4326         16  FILLER                       PIC X(10).
  4327         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4328         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4329         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4330         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4331         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4332         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4333         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4334         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4335         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4336         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4337         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4338         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4339         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4340         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4341         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4342         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4343         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4344         16  PB-ACCOUNT-NAME              PIC X(30).
  4345         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4346         16  PB-REFERENCE                 PIC X(12).
  4347         16  PB-B-RECEIVED-DT             PIC XX.
  4348         16  FILLER                       PIC X(234).
  4349
  4350     12  PB-RECORD-STATUS.
  4351         16  PB-CREDIT-SELECT-DT          PIC XX.
  4352         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4353         16  PB-BILLED-DT                 PIC XX.
  4354         16  PB-BILLING-STATUS            PIC X.
  4355             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4356             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4357             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4358         16  PB-RECORD-BILL               PIC X.
  4359             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4360             88  PB-RECORD-RETURNED           VALUE 'R'.
  4361             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4362             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4363             88  PB-OVERRIDE-AH               VALUE 'A'.
  4364             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4365         16  PB-BATCH-ENTRY               PIC X.
  4366             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4367             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4368             88  PB-REISSUED-CERT             VALUE 'E'.
  4369             88  PB-MONTHLY-CERT              VALUE 'M'.
  4370             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4371             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4372             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4373         16  PB-FORCE-CODE                PIC X.
  4374             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4375             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4376             88  PB-CANCEL-FORCE              VALUE '8'.
  4377             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4378             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4379             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4380             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4381             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4382             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4383             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6316.cbl
  4384         16  PB-FATAL-FLAG                PIC X.
  4385             88  PB-FATAL-ERRORS              VALUE 'X'.
  4386         16  PB-FORCE-ER-CD               PIC X.
  4387             88  PB-FORCE-ERRORS              VALUE 'F'.
  4388             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4389         16  PB-WARN-ER-CD                PIC X.
  4390             88  PB-WARNING-ERRORS            VALUE 'W'.
  4391         16  FILLER                       PIC X.
  4392         16  PB-OUT-BAL-CD                PIC X.
  4393             88  PB-OUT-OF-BAL                VALUE 'O'.
  4394         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4395         16  PB-AH-OVERRIDE-L1            PIC X.
  4396         16  PB-INPUT-DT                  PIC XX.
  4397         16  PB-INPUT-BY                  PIC X(4).
  4398         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4399         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4400         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4401         16  PB-LF-EARNING-METHOD         PIC X.
  4402         16  PB-AH-EARNING-METHOD         PIC X.
  4403         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4404         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4405         16  PB-REIN-CD                   PIC XXX.
  4406         16  PB-LF-REFUND-TYPE            PIC X.
  4407         16  PB-AH-REFUND-TYPE            PIC X.
  4408         16  PB-ACCT-EFF-DT               PIC XX.
  4409         16  PB-ACCT-EXP-DT               PIC XX.
  4410         16  PB-COMPANY-ID                PIC X(3).
  4411         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4412         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4413         16  PB-SV-CARRIER                PIC X.
  4414         16  PB-SV-GROUPING               PIC X(6).
  4415         16  PB-SV-STATE                  PIC XX.
  4416         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4417         16  PB-GA-BILLING-INFO.
  4418             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4419                                          PIC XX.
  4420         16  PB-SV-REMIT-TO  REDEFINES
  4421             PB-GA-BILLING-INFO           PIC X(10).
  4422         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4423         16  PB-I-LOAN-OFFICER            PIC X(5).
  4424         16  PB-I-VIN                     PIC X(17).
  4425
  4426         16  FILLER                       PIC X(04).
  4427         16  IMNET-BYPASS-SW              PIC X.
  4428
  4429******************************************************************
  4430*                COMMON EDIT ERRORS                              *
  4431******************************************************************
  4432
  4433     12  PB-COMMON-ERRORS.
  4434         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4435                                           PIC S9(4)     COMP.
  4436
  4437******************************************************************
  4438*                                COPY ELCCERT.
  4439******************************************************************
  4440*                                                                *
  4441*                            ELCCERT.                            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6316.cbl
  4442*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4443*                            VMOD=2.013                          *
  4444*                                                                *
  4445*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4446*                                                                *
  4447*   FILE TYPE = VSAM,KSDS                                        *
  4448*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4449*                                                                *
  4450*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4451*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4452*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4453*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4454*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4455*                                                                *
  4456*   LOG = YES                                                    *
  4457*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4458******************************************************************
  4459*                   C H A N G E   L O G
  4460*
  4461* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4462*-----------------------------------------------------------------
  4463*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4464* EFFECTIVE    NUMBER
  4465*-----------------------------------------------------------------
  4466* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4467* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4468* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4469* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4470* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4471* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4472* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4473* 032612  CR2011110200001  PEMA  AHL CHANGES
  4474******************************************************************
  4475
  4476 01  CERTIFICATE-MASTER.
  4477     12  CM-RECORD-ID                      PIC XX.
  4478         88  VALID-CM-ID                      VALUE 'CM'.
  4479
  4480     12  CM-CONTROL-PRIMARY.
  4481         16  CM-COMPANY-CD                 PIC X.
  4482         16  CM-CARRIER                    PIC X.
  4483         16  CM-GROUPING.
  4484             20  CM-GROUPING-PREFIX        PIC X(3).
  4485             20  CM-GROUPING-PRIME         PIC X(3).
  4486         16  CM-STATE                      PIC XX.
  4487         16  CM-ACCOUNT.
  4488             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4489             20  CM-ACCOUNT-PRIME          PIC X(6).
  4490         16  CM-CERT-EFF-DT                PIC XX.
  4491         16  CM-CERT-NO.
  4492             20  CM-CERT-PRIME             PIC X(10).
  4493             20  CM-CERT-SFX               PIC X.
  4494
  4495     12  CM-CONTROL-BY-NAME.
  4496         16  CM-COMPANY-CD-A1              PIC X.
  4497         16  CM-INSURED-LAST-NAME          PIC X(15).
  4498         16  CM-INSURED-INITIALS.
  4499             20  CM-INSURED-INITIAL1       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6316.cbl
  4500             20  CM-INSURED-INITIAL2       PIC X.
  4501
  4502     12  CM-CONTROL-BY-SSN.
  4503         16  CM-COMPANY-CD-A2              PIC X.
  4504         16  CM-SOC-SEC-NO.
  4505             20  CM-SSN-STATE              PIC XX.
  4506             20  CM-SSN-ACCOUNT            PIC X(6).
  4507             20  CM-SSN-LN3.
  4508                 25  CM-INSURED-INITIALS-A2.
  4509                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4510                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4511                 25 CM-PART-LAST-NAME-A2         PIC X.
  4512
  4513     12  CM-CONTROL-BY-CERT-NO.
  4514         16  CM-COMPANY-CD-A4              PIC X.
  4515         16  CM-CERT-NO-A4                 PIC X(11).
  4516
  4517     12  CM-CONTROL-BY-MEMB.
  4518         16  CM-COMPANY-CD-A5              PIC X.
  4519         16  CM-MEMBER-NO.
  4520             20  CM-MEMB-STATE             PIC XX.
  4521             20  CM-MEMB-ACCOUNT           PIC X(6).
  4522             20  CM-MEMB-LN4.
  4523                 25  CM-INSURED-INITIALS-A5.
  4524                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4525                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4526                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4527
  4528     12  CM-INSURED-PROFILE-DATA.
  4529         16  CM-INSURED-FIRST-NAME.
  4530             20  CM-INSURED-1ST-INIT       PIC X.
  4531             20  FILLER                    PIC X(9).
  4532         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4533         16  CM-INSURED-SEX                PIC X.
  4534             88  CM-SEX-MALE                  VALUE 'M'.
  4535             88  CM-SEX-FEMAL                 VALUE 'F'.
  4536         16  CM-INSURED-JOINT-AGE          PIC 99.
  4537         16  CM-JOINT-INSURED-NAME.
  4538             20  CM-JT-LAST-NAME           PIC X(15).
  4539             20  CM-JT-FIRST-NAME.
  4540                 24  CM-JT-1ST-INIT        PIC X.
  4541                 24  FILLER                PIC X(9).
  4542             20  CM-JT-INITIAL             PIC X.
  4543
  4544     12  CM-LIFE-DATA.
  4545         16  CM-LF-BENEFIT-CD              PIC XX.
  4546         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4547         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4548         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4549         16  CM-LF-DEV-CODE                PIC XXX.
  4550         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4551         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4552         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4553         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4554         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4555         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4556         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4557         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6316.cbl
  4558         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4559         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4560         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4561         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4562         16  FILLER                        PIC XX.
  4563
  4564     12  CM-AH-DATA.
  4565         16  CM-AH-BENEFIT-CD              PIC XX.
  4566         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4567         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4568         16  CM-AH-DEV-CODE                PIC XXX.
  4569         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4570         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4571         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4572         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4573         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4574         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4575         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4576         16  CM-AH-PAID-THRU-DT            PIC XX.
  4577             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4578         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4579         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4580         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4581         16  FILLER                        PIC X.
  4582
  4583     12  CM-LOAN-INFORMATION.
  4584         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4585         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4586                                           PIC S9(5)V99  COMP-3.
  4587         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4588         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4589         16  CM-PAY-FREQUENCY              PIC S99.
  4590         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4591         16  CM-RATE-CLASS                 PIC XX.
  4592         16  CM-BENEFICIARY                PIC X(25).
  4593         16  CM-POLICY-FORM-NO             PIC X(12).
  4594         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4595         16  CM-LAST-ADD-ON-DT             PIC XX.
  4596         16  CM-DEDUCTIBLE-AMOUNTS.
  4597             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4598             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4599         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4600             20  CM-RESIDENT-STATE         PIC XX.
  4601             20  CM-RATE-CODE              PIC X(4).
  4602             20  FILLER                    PIC XX.
  4603         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4604             20  CM-LOAN-OFFICER           PIC X(5).
  4605             20  FILLER                    PIC XXX.
  4606         16  CM-CSR-CODE                   PIC XXX.
  4607         16  CM-UNDERWRITING-CODE          PIC X.
  4608             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4609         16  CM-POST-CARD-IND              PIC X.
  4610         16  CM-NH-INTERFACE-SW            PIC X.
  4611         16  CM-PREMIUM-TYPE               PIC X.
  4612             88  CM-SING-PRM                  VALUE '1'.
  4613             88  CM-O-B-COVERAGE              VALUE '2'.
  4614             88  CM-OPEN-END                  VALUE '3'.
  4615         16  CM-IND-GRP-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6316.cbl
  4616             88  CM-INDIVIDUAL                VALUE 'I'.
  4617             88  CM-GROUP                     VALUE 'G'.
  4618         16  CM-SKIP-CODE                  PIC X.
  4619             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4620             88  SKIP-JULY                    VALUE '1'.
  4621             88  SKIP-AUGUST                  VALUE '2'.
  4622             88  SKIP-SEPTEMBER               VALUE '3'.
  4623             88  SKIP-JULY-AUG                VALUE '4'.
  4624             88  SKIP-AUG-SEPT                VALUE '5'.
  4625             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4626             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4627             88  SKIP-JUNE                    VALUE '8'.
  4628             88  SKIP-JUNE-JULY               VALUE '9'.
  4629             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4630             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4631         16  CM-PAYMENT-MODE               PIC X.
  4632             88  PAY-MONTHLY                  VALUE SPACE.
  4633             88  PAY-WEEKLY                   VALUE '1'.
  4634             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4635             88  PAY-BI-WEEKLY                VALUE '3'.
  4636             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4637         16  CM-LOAN-NUMBER                PIC X(8).
  4638         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4639         16  CM-OLD-LOF                    PIC XXX.
  4640*        16  CM-LOAN-OFFICER               PIC XXX.
  4641         16  CM-REIN-TABLE                 PIC XXX.
  4642         16  CM-SPECIAL-REIN-CODE          PIC X.
  4643         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4644         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4645         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4646
  4647     12  CM-STATUS-DATA.
  4648         16  CM-ENTRY-STATUS               PIC X.
  4649         16  CM-ENTRY-DT                   PIC XX.
  4650
  4651         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4652         16  CM-LF-CANCEL-DT               PIC XX.
  4653         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4654
  4655         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4656         16  CM-LF-DEATH-DT                PIC XX.
  4657         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4658
  4659         16  CM-LF-CURRENT-STATUS          PIC X.
  4660             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4661                                                'M' '4' '5' '9'.
  4662             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4663             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4664             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4665             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4666             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4667             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4668             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4669             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4670             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4671             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4672             88  CM-LF-DECLINED               VALUE 'D'.
  4673             88  CM-LF-VOIDED                 VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6316.cbl
  4674
  4675         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4676         16  CM-AH-CANCEL-DT               PIC XX.
  4677         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4678
  4679         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4680         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4681         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4682
  4683         16  CM-AH-CURRENT-STATUS          PIC X.
  4684             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4685                                                'M' '4' '5' '9'.
  4686             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4687             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4688             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4689             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4690             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4691             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4692             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4693             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4694             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4695             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4696             88  CM-AH-DECLINED               VALUE 'D'.
  4697             88  CM-AH-VOIDED                 VALUE 'V'.
  4698
  4699         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4700             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4701             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4702             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4703         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4704
  4705         16  CM-ENTRY-BATCH                PIC X(6).
  4706         16  CM-LF-EXIT-BATCH              PIC X(6).
  4707         16  CM-AH-EXIT-BATCH              PIC X(6).
  4708         16  CM-LAST-MONTH-END             PIC XX.
  4709
  4710     12  CM-NOTE-SW                        PIC X.
  4711         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4712         88  CERT-NOTES-PRESENT               VALUE '1'.
  4713         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4714         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4715         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4716         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4717         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4718         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4719     12  CM-COMP-EXCP-SW                   PIC X.
  4720         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4721         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4722     12  CM-INSURED-ADDRESS-SW             PIC X.
  4723         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4724         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4725
  4726*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4727     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4728     12  FILLER                            PIC X.
  4729
  4730*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4731     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6316.cbl
  4732     12  FILLER                            PIC X.
  4733*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4734     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4735
  4736     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4737         88  CERT-ADDED-BATCH                 VALUE ' '.
  4738         88  CERT-ADDED-ONLINE                VALUE '1'.
  4739         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4740         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4741         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4742     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4743         88  CERT-AS-LOADED                   VALUE ' '.
  4744         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4745         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4746         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4747         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4748         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4749         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4750         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4751
  4752     12  CM-ACCOUNT-COMM-PCTS.
  4753         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4754         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4755
  4756     12  CM-USER-FIELD                     PIC X.
  4757     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4758     12  CM-CLP-STATE                      PIC XX.
  4759     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4760     12  CM-USER-RESERVED                  PIC XXX.
  4761     12  FILLER REDEFINES CM-USER-RESERVED.
  4762         16  CM-AH-CLASS-CD                PIC XX.
  4763         16  F                             PIC X.
  4764******************************************************************
  4765*                                COPY ELCCRTO.
  4766******************************************************************
  4767*                                                                *
  4768*                            ELCCRTO.                            *
  4769*                                                                *
  4770*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4771*                                                                *
  4772*   FILE TYPE = VSAM,KSDS                                        *
  4773*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4774*                                                                *
  4775*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4776*                                                                *
  4777*   LOG = YES                                                    *
  4778*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4779******************************************************************
  4780*                   C H A N G E   L O G
  4781*
  4782* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4783*-----------------------------------------------------------------
  4784*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4785* EFFECTIVE    NUMBER
  4786*-----------------------------------------------------------------
  4787* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4788* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4789* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6316.cbl
  4790******************************************************************
  4791 01  ORIGINAL-CERTIFICATE.
  4792     12  OC-RECORD-ID                      PIC XX.
  4793         88  VALID-OC-ID                      VALUE 'OC'.
  4794     12  OC-CONTROL-PRIMARY.
  4795         16  OC-COMPANY-CD                 PIC X.
  4796         16  OC-CARRIER                    PIC X.
  4797         16  OC-GROUPING                   PIC X(6).
  4798         16  OC-STATE                      PIC XX.
  4799         16  OC-ACCOUNT                    PIC X(10).
  4800         16  OC-CERT-EFF-DT                PIC XX.
  4801         16  OC-CERT-NO.
  4802             20  OC-CERT-PRIME             PIC X(10).
  4803             20  OC-CERT-SFX               PIC X.
  4804         16  OC-RECORD-TYPE                PIC X.
  4805         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4806     12  OC-LAST-MAINT-DT                  PIC XX.
  4807     12  OC-LAST-MAINT-BY                  PIC X(4).
  4808     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4809     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4810     12  FILLER                            PIC X(49).
  4811     12  OC-ORIG-REC.
  4812         16  OC-INS-LAST-NAME              PIC X(15).
  4813         16  OC-INS-FIRST-NAME             PIC X(10).
  4814         16  OC-INS-MIDDLE-INIT            PIC X.
  4815         16  OC-INS-AGE                    PIC S999     COMP-3.
  4816         16  OC-JNT-LAST-NAME              PIC X(15).
  4817         16  OC-JNT-FIRST-NAME             PIC X(10).
  4818         16  OC-JNT-MIDDLE-INIT            PIC X.
  4819         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4820         16  OC-LF-BENCD                   PIC XX.
  4821         16  OC-LF-TERM                    PIC S999      COMP-3.
  4822         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4823         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4824         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4825         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4826         16  OC-LF-EXP-DT                  PIC XX.
  4827         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4828         16  OC-LF-CANCEL-DT               PIC XX.
  4829         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4830         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4831         16  OC-AH-BENCD                   PIC XX.
  4832         16  OC-AH-TERM                    PIC S999      COMP-3.
  4833         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4834         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4835         16  OC-AH-EXP-DT                  PIC XX.
  4836         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4837         16  OC-AH-CP                      PIC 99.
  4838         16  OC-AH-CANCEL-DT               PIC XX.
  4839         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4840         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4841         16  OC-CRED-BENE-NAME             PIC X(25).
  4842         16  OC-1ST-PMT-DT                 PIC XX.
  4843         16  FILLER                        PIC X(215).
  4844
  4845     12  FILLER                            PIC X(50).
  4846******************************************************************
  4847*                                COPY ERCENDT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6316.cbl
  4848******************************************************************
  4849*                                                                *
  4850*                                                                *
  4851*                            ERCENDT.                            *
  4852*                            VMOD=2.001                          *
  4853*                                                                *
  4854*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4855*                                                                *
  4856*   FILE TYPE = VSAM,KSDS                                        *
  4857*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4858*                                                                *
  4859*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4860*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4861*                                                                *
  4862*   LOG = NO                                                     *
  4863*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4864******************************************************************
  4865*-----------------------------------------------------------------
  4866*                   C H A N G E   L O G
  4867*
  4868* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4869*-----------------------------------------------------------------
  4870*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4871* EFFECTIVE    NUMBER
  4872*-----------------------------------------------------------------
  4873* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4874*                                WITH OPEN CLAIMS
  4875* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4876*-----------------------------------------------------------------
  4877 01  ENDORSEMENT-RECORD.
  4878     12  EN-RECORD-ID                PIC XX.
  4879         88  VALID-EN-ID                VALUE 'EN'.
  4880     12  EN-CONTROL-PRIMARY.
  4881         16  EN-COMPANY-CD           PIC X.
  4882         16  EN-CARRIER              PIC X.
  4883         16  EN-GROUPING             PIC X(6).
  4884         16  EN-STATE                PIC XX.
  4885         16  EN-ACCOUNT              PIC X(10).
  4886         16  EN-CERT-EFF-DT          PIC XX.
  4887         16  EN-CERT-NO.
  4888             20  EN-CERT-PRIME       PIC X(10).
  4889             20  EN-CERT-SFX         PIC X.
  4890         16  EN-REC-TYPE             PIC X.
  4891             88  EN-ISSUE               VALUE 'I'.
  4892             88  EN-CANCELLATION        VALUE 'C'.
  4893         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4894     12  EN-CONTROL-BY-ARCH-NO.
  4895         16  EN-COMPANY-CD-A1              PIC X.
  4896         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4897     12  EN-LAST-MAINT-DT            PIC XX.
  4898     12  EN-LAST-MAINT-BY            PIC X(4).
  4899     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4900     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4901     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4902         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4903         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4904         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4905         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6316.cbl
  4906         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4907         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4908         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4909         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4910         16  EN-LF-ORIG-BENCD        PIC XX.
  4911         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4912         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4913         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4914         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4915         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4916         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4917*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4918         16  EN-ORIG-CRED-BENE       PIC X(25).
  4919         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4920         16  FILLER                  PIC X.
  4921         16  EN-AH-ORIG-BENCD        PIC XX.
  4922         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4923         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4924         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4925         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4926*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4927*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4928         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4929         16  F                       PIC X(09).
  4930         16  EN-AH-ORIG-CP           PIC 99.
  4931         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4932         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4933         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4934         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4935         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4936         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4937         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4938         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4939         16  EN-LF-NEW-BENCD         PIC XX.
  4940         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4941         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4942         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4943         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4944         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4945         16  EN-LF-NEW-EXP-DT        PIC XX.
  4946         16  EN-NEW-CRED-BENE        PIC X(25).
  4947         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4948         16  FILLER                  PIC X.
  4949         16  EN-AH-NEW-BENCD         PIC XX.
  4950         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  4951         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4952         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4953         16  EN-AH-NEW-EXP-DT        PIC XX.
  4954*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  4955*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  4956*        16  F                       PIC X(12).
  4957         16  EN-AH-NEW-CP            PIC 99.
  4958         16  EN-SIG-SW               PIC X.
  4959         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4960         16  FILLER                  PIC X(37).
  4961     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4962         16  EN-LF-ORIG-REF-DT       PIC XX.
  4963         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6316.cbl
  4964         16  EN-AH-ORIG-REF-DT       PIC XX.
  4965         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4966         16  EN-LF-NEW-REF-DT        PIC XX.
  4967         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4968         16  EN-AH-NEW-REF-DT        PIC XX.
  4969         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4970         16  EN-FLAG-CERT            PIC X.
  4971         16  EN-INS-LAST-NAME        PIC X(15).
  4972         16  EN-INS-FIRST-NAME       PIC X(10).
  4973         16  EN-INS-MIDDLE-INIT      PIC X.
  4974         16  FILLER                  PIC X(274).
  4975     12  EN-MONEY-SW             PIC X.
  4976     12  EN-HEALTH-APP           PIC X.
  4977     12  EN-VOUCHER-SW           PIC X.
  4978     12  EN-PAYEE                PIC X(14).
  4979     12  EN-INPUT-DT             PIC XX.
  4980     12  EN-PROCESS-DT           PIC XX.
  4981     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  4982     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  4983     12  EN-REASON-CODES.
  4984         16  F OCCURS 12.
  4985             20  EN-REASON-CODE  PIC X(4).
  4986     12  EN-TEMPLATE-USED        PIC X(8).
  4987     12  EN-DOCU-TYPE            PIC X.
  4988         88  EN-VERI-DOCU          VALUE 'V'.
  4989         88  EN-GCE-DOCU           VALUE 'G'.
  4990         88  EN-CANC-DOCU          VALUE 'C'.
  4991     12  EN-COMMENTS1            PIC X(13).
  4992     12  EN-COMMENTS2            PIC X(70).
  4993     12  EN-COMM-CHGBK           PIC X.
  4994         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  4995         88  EN-CHG-ACCT           VALUE 'Y'.
  4996     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  4997     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  4998     12  EN-BATCH-NUMBER         PIC X(6).
  4999     12  EN-ACCT-SUMM            PIC X.
  5000     12  EN-CSO-SUMM             PIC X.
  5001     12  FILLER                  PIC X(13).
  5002******************************************************************
  5003*                                COPY ERCNOTE.
  5004******************************************************************
  5005*                                                                *
  5006*                                                                *
  5007*                            ERCNOTE                             *
  5008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5009*                            VMOD=2.003                          *
  5010*                                                                *
  5011*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5012*                                                                *
  5013*        FILE TYPE= VSAM,KSDS                                    *
  5014*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5015*                                                                *
  5016*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5017*                                                                *
  5018*        LOG = YES                                               *
  5019*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5020*                                                                *
  5021******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6316.cbl
  5022*                   C H A N G E   L O G
  5023*
  5024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5025*-----------------------------------------------------------------
  5026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5027* EFFECTIVE    NUMBER
  5028*-----------------------------------------------------------------
  5029* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5030*                                FILE WILL CONTAIN BILLING NOTES O
  5031******************************************************************
  5032
  5033 01  CERTIFICATE-NOTE.
  5034     12  CN-RECORD-ID                PIC  XX.
  5035         88  VALID-CN-ID                  VALUE 'CN'.
  5036
  5037     12  CN-CONTROL-PRIMARY.
  5038         16  CN-COMPANY-CD           PIC X.
  5039         16  CN-CARRIER              PIC X.
  5040         16  CN-GROUPING.
  5041             20 CN-GROUPING-PREFIX   PIC XXX.
  5042             20 CN-GROUPING-PRIME    PIC XXX.
  5043         16  CN-STATE                PIC XX.
  5044         16  CN-ACCOUNT.
  5045             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5046             20 CN-ACCOUNT-PRIME     PIC X(6).
  5047         16  CN-CERT-EFF-DT          PIC XX.
  5048         16  CN-CERT-NO.
  5049             20  CN-CERT-PRIME       PIC X(10).
  5050             20  CN-CERT-SFX         PIC X.
  5051
  5052     12  CN-BILLING-START-LINE-NO    PIC 99.
  5053     12  CN-BILLING-END-LINE-NO      PIC 99.
  5054
  5055     12  CN-LINES.
  5056         16  CN-LINE OCCURS 10       PIC X(77).
  5057
  5058     12  CN-LAST-MAINT-DT            PIC XX.
  5059     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5060     12  CN-LAST-MAINT-USER          PIC X(4).
  5061     12  FILLER                      PIC X(6).
  5062******************************************************************
  5063*                                COPY ERCMAIL.
  5064******************************************************************
  5065*                                                                *
  5066*                                                                *
  5067*                            ERCMAIL                             *
  5068*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5069*                            VMOD=2.003                          *
  5070*                                                                *
  5071*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5072*                                                                *
  5073*   FILE TYPE = VSAM,KSDS                                        *
  5074*   RECORD SIZE = 374   RECFORM = FIX                            *
  5075*                                                                *
  5076*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5077*   ALTERNATE PATH    = NOT USED                                 *
  5078*                                                                *
  5079*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6316.cbl
  5080*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5081******************************************************************
  5082*                   C H A N G E   L O G
  5083*
  5084* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5085*-----------------------------------------------------------------
  5086*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5087* EFFECTIVE    NUMBER
  5088*-----------------------------------------------------------------
  5089* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5090* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5091* 111108                   PEMA  ADD CRED BENE ADDR2
  5092******************************************************************
  5093
  5094 01  MAILING-DATA.
  5095     12  MA-RECORD-ID                      PIC XX.
  5096         88  VALID-MA-ID                       VALUE 'MA'.
  5097
  5098     12  MA-CONTROL-PRIMARY.
  5099         16  MA-COMPANY-CD                 PIC X.
  5100         16  MA-CARRIER                    PIC X.
  5101         16  MA-GROUPING.
  5102             20  MA-GROUPING-PREFIX        PIC XXX.
  5103             20  MA-GROUPING-PRIME         PIC XXX.
  5104         16  MA-STATE                      PIC XX.
  5105         16  MA-ACCOUNT.
  5106             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5107             20  MA-ACCOUNT-PRIME          PIC X(6).
  5108         16  MA-CERT-EFF-DT                PIC XX.
  5109         16  MA-CERT-NO.
  5110             20  MA-CERT-PRIME             PIC X(10).
  5111             20  MA-CERT-SFX               PIC X.
  5112
  5113     12  FILLER                            PIC XX.
  5114
  5115     12  MA-ACCESS-CONTROL.
  5116         16  MA-SOURCE-SYSTEM              PIC XX.
  5117             88  MA-FROM-CREDIT                VALUE 'CR'.
  5118             88  MA-FROM-VSI                   VALUE 'VS'.
  5119             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5120             88  MA-FROM-OTHER                 VALUE 'OT'.
  5121         16  MA-RECORD-ADD-DT              PIC XX.
  5122         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5123         16  MA-LAST-MAINT-DT              PIC XX.
  5124         16  MA-LAST-MAINT-BY              PIC XXXX.
  5125         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5126
  5127     12  MA-PROFILE-INFO.
  5128         16  MA-QUALIFY-CODE-1             PIC XX.
  5129         16  MA-QUALIFY-CODE-2             PIC XX.
  5130         16  MA-QUALIFY-CODE-3             PIC XX.
  5131         16  MA-QUALIFY-CODE-4             PIC XX.
  5132         16  MA-QUALIFY-CODE-5             PIC XX.
  5133
  5134         16  MA-INSURED-LAST-NAME          PIC X(15).
  5135         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5136         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5137         16  MA-INSURED-ISSUE-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6316.cbl
  5138         16  MA-INSURED-BIRTH-DT           PIC XX.
  5139         16  MA-INSURED-SEX                PIC X.
  5140             88  MA-SEX-MALE                   VALUE 'M'.
  5141             88  MA-SEX-FEMALE                 VALUE 'F'.
  5142         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5143
  5144         16  MA-ADDRESS-CORRECTED          PIC X.
  5145         16  MA-JOINT-BIRTH-DT             PIC XX.
  5146*        16  FILLER                        PIC X(12).
  5147
  5148         16  MA-ADDRESS-LINE-1             PIC X(30).
  5149         16  MA-ADDRESS-LINE-2             PIC X(30).
  5150         16  MA-CITY-STATE.
  5151             20  MA-CITY                   PIC X(28).
  5152             20  MA-ADDR-STATE             PIC XX.
  5153         16  MA-ZIP.
  5154             20  MA-ZIP-CODE.
  5155                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5156                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5157                 24  FILLER                PIC X(4).
  5158             20  MA-ZIP-PLUS4              PIC X(4).
  5159         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5160             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5161             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5162             20  FILLER                    PIC X(3).
  5163
  5164         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5165
  5166         16  FILLER                        PIC XXX.
  5167*        16  FILLER                        PIC X(10).
  5168
  5169     12  MA-CRED-BENE-INFO.
  5170         16  MA-CRED-BENE-NAME                 PIC X(25).
  5171         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5172         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5173         16  MA-CRED-BENE-CTYST.
  5174             20  MA-CRED-BENE-CITY             PIC X(28).
  5175             20  MA-CRED-BENE-STATE            PIC XX.
  5176         16  MA-CRED-BENE-ZIP.
  5177             20  MA-CB-ZIP-CODE.
  5178                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5179                     88  MA-CB-CANADIAN-POST-CODE
  5180                                           VALUE 'A' THRU 'Z'.
  5181                 24  FILLER                    PIC X(4).
  5182             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5183         16  MA-CB-CANADIAN-POSTAL-CODE
  5184                            REDEFINES MA-CRED-BENE-ZIP.
  5185             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5186             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5187             20  FILLER                        PIC X(3).
  5188     12  MA-POST-CARD-MAIL-DATA.
  5189         16  MA-MAIL-DATA OCCURS 7.
  5190             20  MA-MAIL-TYPE              PIC X.
  5191                 88  MA-12MO-MAILING           VALUE '1'.
  5192                 88  MA-EXP-MAILING            VALUE '2'.
  5193             20  MA-MAIL-STATUS            PIC X.
  5194                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5195                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6316.cbl
  5196                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5197             20  MA-MAIL-DATE              PIC XX.
  5198     12  FILLER                            PIC XX.
  5199     12  FILLER                            PIC XX.
  5200*    12  FILLER                            PIC X(30).
  5201******************************************************************
  5202*                                COPY ERCCNOT.
  5203******************************************************************
  5204*                                                                *
  5205*                            ERCCNOT                             *
  5206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5207*                            VMOD=2.003                          *
  5208*                                                                *
  5209*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5210*                                                                *
  5211*        FILE TYPE= VSAM,KSDS                                    *
  5212*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5213*                                                                *
  5214*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5215*                                                                *
  5216*        LOG = YES                                               *
  5217*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5218*                                                                *
  5219******************************************************************
  5220*                   C H A N G E   L O G
  5221*
  5222* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5223*-----------------------------------------------------------------
  5224*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5225* EFFECTIVE    NUMBER
  5226*-----------------------------------------------------------------
  5227* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5228******************************************************************
  5229
  5230 01  CERT-NOTE-FILE.
  5231     12  CZ-RECORD-ID                PIC  XX.
  5232         88  VALID-CZ-ID                  VALUE 'CZ'.
  5233
  5234     12  CZ-CONTROL-PRIMARY.
  5235         16  CZ-COMPANY-CD           PIC X.
  5236         16  CZ-CARRIER              PIC X.
  5237         16  CZ-GROUPING.
  5238             20 CZ-GROUPING-PREFIX   PIC XXX.
  5239             20 CZ-GROUPING-PRIME    PIC XXX.
  5240         16  CZ-STATE                PIC XX.
  5241         16  CZ-ACCOUNT.
  5242             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5243             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5244         16  CZ-CERT-EFF-DT          PIC XX.
  5245         16  CZ-CERT-NO.
  5246             20  CZ-CERT-PRIME       PIC X(10).
  5247             20  CZ-CERT-SFX         PIC X.
  5248         16  CZ-RECORD-TYPE          PIC X.
  5249             88  CERT-NOTE           VALUE '1'.
  5250             88  CLAIM-CERT-NOTE     VALUE '2'.
  5251         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5252
  5253     12  CZ-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6316.cbl
  5254     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5255     12  CZ-LAST-MAINT-USER          PIC X(4).
  5256
  5257     12  CZ-NOTE-INFORMATION.
  5258         16  CZ-NOTE                 PIC X(63).
  5259         16  FILLER                  PIC X(39).
  5260******************************************************************
  5261*                                COPY ELCEOBC.
  5262******************************************************************
  5263*                                                                *
  5264*                                                                *
  5265*                            ELCEOBC                             *
  5266*                            VMOD=2.001                          *
  5267*                                                                *
  5268*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5269*                                                                *
  5270*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5271*   VSAM EOB CODE TABLE                                          *
  5272*                                                                *
  5273*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5274*                                                                *
  5275*   FILE TYPE = VSAM,KSDS                                        *
  5276*   RECORD SIZE = 350   RECFORM = FIX                            *
  5277*                                                                *
  5278*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5279*                                                                *
  5280*   LOG = NO                                                     *
  5281*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5282*                                                                *
  5283*                                                                *
  5284******************************************************************
  5285*                   C H A N G E   L O G
  5286*
  5287* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5288*-----------------------------------------------------------------
  5289*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5290* EFFECTIVE    NUMBER
  5291*-----------------------------------------------------------------
  5292* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5293* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5294******************************************************************
  5295 01  EOB-CODES.
  5296     12  EO-RECORD-ID                      PIC XX.
  5297         88  VALID-DN-ID                      VALUE 'EO'.
  5298     12  EO-CONTROL-PRIMARY.
  5299         16  EO-COMPANY-CD                 PIC X.
  5300         16  EO-RECORD-TYPE                PIC X.
  5301             88  EO-EOB-RECS                  VALUE '1'.
  5302             88  EO-VERIF-RECS                VALUE '2'.
  5303             88  EO-GCE-RECS                  VALUE '3'.
  5304         16  EO-EOB-CODE                   PIC X(4).
  5305         16  FILLER                        PIC X(9).
  5306     12  EO-MAINT-INFORMATION.
  5307         16  EO-LAST-MAINT-DT              PIC XX.
  5308         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5309         16  EO-LAST-MAINT-USER            PIC X(4).
  5310         16  FILLER                        PIC XX.
  5311     12  EO-DESCRIPTION                    PIC X(275).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6316.cbl
  5312     12  FILLER                            PIC X(46).
  5313******************************************************************
  5314 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5315                          ACCOUNT-MASTER CONTROL-FILE
  5316                          PENDING-BUSINESS CERTIFICATE-MASTER
  5317                          ORIGINAL-CERTIFICATE
  5318                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5319                          MAILING-DATA CERT-NOTE-FILE EOB-CODES.
  5320 0000-DFHEXIT SECTION.
  5321     MOVE '9#                    $   ' TO DFHEIV0.
  5322     MOVE 'EL6316' TO DFHEIV1.
  5323     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5324     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5325     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5326     MOVE '5'                    TO DC-OPTION-CODE
  5327     PERFORM 9700-DATE-LINK
  5328     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT
  5329     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT
  5330     MOVE EIBTRMID               TO QID-TERM
  5331     IF EIBCALEN = 0
  5332        GO TO 8800-UNAUTHORIZED-ACCESS
  5333     END-IF
  5334     DISPLAY ' ENDORSE LENGTH  '
  5335                FUNCTION LENGTH(ENDORSEMENT-RECORD)
  5336     move function length(EL631II) TO MAP-LENGTH
  5337     DISPLAY ' MAP LENGTH      ' MAP-LENGTH
  5338     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5339        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5340           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5341           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5342           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5343           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5344           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5345           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5346           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5347           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5348           MOVE LOW-VALUES             TO EL631II
  5349           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5350           GO TO 0350-DISPLAY-COMMON-DATA
  5351        END-IF
  5352     END-IF
  5353     IF PI-CALLING-PROGRAM = 'EL614'
  5354        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5355                                 TO WS-PASSED-REASON-CODES
  5356        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5357        IF WS-PASSED-REASON-CODES NOT = SPACES
  5358           MOVE 'Y'                TO WS-SET-CODES-MDT
  5359        ELSE
  5360           MOVE 'N'                TO WS-SET-CODES-MDT
  5361        END-IF
  5362        PERFORM 0610-RECOVER-TEMP-STORAGE
  5363                                 THRU 0610-EXIT
  5364        GO TO 0350-DISPLAY-COMMON-DATA
  5365     END-IF
  5366     IF EIBAID = DFHCLEAR
  5367        IF PI-CLEAR-ERROR
  5368           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5369           MOVE ER-3833           TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6316.cbl
  5370           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5371           GO TO 0350-DISPLAY-COMMON-DATA
  5372        ELSE
  5373           GO TO 9400-CLEAR
  5374        END-IF
  5375     END-IF
  5376     .
  5377 0200-RECEIVE.
  5378     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5379        MOVE ER-0008             TO EMI-ERROR
  5380        PERFORM 9900-ERROR-FORMAT
  5381                                 THRU 9900-EXIT
  5382        MOVE -1                  TO PFENTRL
  5383        GO TO 8100-SEND-INITIAL-MAP
  5384     END-IF
  5385
  5386* EXEC CICS RECEIVE
  5387*        MAP      (MAP-NAME)
  5388*        MAPSET   (MAPSET-NAME)
  5389*        INTO     (EL631II)
  5390*    END-EXEC
  5391     MOVE LENGTH OF
  5392      EL631II
  5393       TO DFHEIV11
  5394*    MOVE '8"T I  L              ''   #00005381' TO DFHEIV0
  5395     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5396     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5397     MOVE X'2020233030303035333831' TO DFHEIV0(25:11)
  5398     CALL 'kxdfhei1' USING DFHEIV0,
  5399           MAP-NAME,
  5400           EL631II,
  5401           DFHEIV11,
  5402           MAPSET-NAME,
  5403           DFHEIV99,
  5404           DFHEIV99
  5405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5406     IF PFENTRL = 0
  5407         GO TO 0300-CHECK-PFKEYS
  5408     END-IF
  5409     IF EIBAID NOT = DFHENTER
  5410         MOVE ER-0004            TO EMI-ERROR
  5411         GO TO 0320-INPUT-ERROR
  5412     END-IF
  5413     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5414        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5415     ELSE
  5416        MOVE ER-0029            TO EMI-ERROR
  5417        GO TO 0320-INPUT-ERROR
  5418     END-IF
  5419     .
  5420 0300-CHECK-PFKEYS.
  5421     IF EIBAID = DFHPF1
  5422        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5423        PERFORM 0520-ERENDT-STARTBR
  5424                                 THRU 0520-EXIT
  5425        PERFORM 0510-ERENDT-READNEXT
  5426                                 THRU 0510-EXIT
  5427        IF ERENDT-KEY = PI-PREV-ERENDT-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6316.cbl
  5428            PERFORM 0510-ERENDT-READNEXT
  5429                                 THRU 0510-EXIT
  5430        END-IF
  5431        IF (RESP-NORMAL) AND
  5432         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5433           PERFORM 0390-BUILD-FROM-ERENDT
  5434                                 THRU 0390-EXIT
  5435           MOVE ER-0000          TO EMI-ERROR
  5436           PERFORM 9900-ERROR-FORMAT
  5437                                 THRU 9900-EXIT
  5438           GO TO 8100-SEND-INITIAL-MAP
  5439        ELSE
  5440           MOVE ER-2237          TO EMI-ERROR
  5441           MOVE -1               TO CARRL
  5442           PERFORM 9900-ERROR-FORMAT
  5443                                 THRU 9900-EXIT
  5444           GO TO 8200-SEND-DATAONLY
  5445        END-IF
  5446     END-IF
  5447     IF EIBAID = DFHPF2
  5448        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5449        PERFORM 0520-ERENDT-STARTBR
  5450                                 THRU 0520-EXIT
  5451        PERFORM 0510-ERENDT-READNEXT
  5452                                 THRU 0510-EXIT
  5453        PERFORM 0530-ERENDT-READPREV
  5454                                 THRU 0530-EXIT
  5455        PERFORM 0530-ERENDT-READPREV
  5456                                 THRU 0530-EXIT
  5457        IF (RESP-NORMAL) AND
  5458         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5459           PERFORM 0390-BUILD-FROM-ERENDT
  5460                                 THRU 0390-EXIT
  5461           MOVE ER-0000          TO EMI-ERROR
  5462           PERFORM 9900-ERROR-FORMAT
  5463                                 THRU 9900-EXIT
  5464           GO TO 8100-SEND-INITIAL-MAP
  5465        ELSE
  5466           GO TO 0350-DISPLAY-COMMON-DATA
  5467           MOVE ER-2238          TO EMI-ERROR
  5468           PERFORM 9900-ERROR-FORMAT
  5469                                 THRU 9900-EXIT
  5470           MOVE -1               TO CARRL
  5471           GO TO 8200-SEND-DATAONLY
  5472        END-IF
  5473     END-IF
  5474     IF EIBAID = DFHPF3
  5475        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5476        PERFORM 0600-CREATE-TEMP-STORAGE
  5477                                 THRU 0600-EXIT
  5478        MOVE 'EL614'             TO PGM-NAME
  5479        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5480        MOVE +1                  TO S2
  5481        PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5482           IF REACD-IN (S1) NOT = SPACES AND LOW-VALUES
  5483              MOVE REACD-IN (S1) TO PI-PROGRAM-WORK-AREA (S2:4)
  5484              ADD +5 TO S2
  5485           END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6316.cbl
  5486        END-PERFORM
  5487        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5488        GO TO 9300-XCTL
  5489     END-IF
  5490     IF EIBAID = DFHPF4 OR DFHPF8
  5491        GO TO 1000-FINALIZE
  5492     END-IF
  5493     IF EIBAID = DFHPF23
  5494        IF PI-CLEAR-ERROR
  5495           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5496           MOVE ER-3833           TO EMI-ERROR
  5497           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5498           GO TO 0350-DISPLAY-COMMON-DATA
  5499        ELSE
  5500           GO TO 8810-PF23
  5501        END-IF
  5502     END-IF
  5503     IF EIBAID = DFHPF24
  5504        IF PI-CLEAR-ERROR
  5505           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5506           MOVE ER-3833           TO EMI-ERROR
  5507           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5508           GO TO 0350-DISPLAY-COMMON-DATA
  5509        ELSE
  5510           GO TO 9200-RETURN-MAIN-MENU
  5511        END-IF
  5512     END-IF
  5513     IF EIBAID = DFHPF12
  5514        GO TO 9500-PF12
  5515     END-IF
  5516     IF EIBAID = DFHENTER
  5517        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5518        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5519        IF EMI-NO-ERRORS
  5520           GO TO 0350-DISPLAY-COMMON-DATA
  5521        ELSE
  5522           GO TO 8200-SEND-DATAONLY
  5523        END-IF
  5524     END-IF
  5525     MOVE ER-0029                TO EMI-ERROR
  5526     .
  5527 0320-INPUT-ERROR.
  5528     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5529     MOVE AL-UNBON               TO PFENTRA
  5530     MOVE -1                     TO PFENTRL
  5531     GO TO 8200-SEND-DATAONLY
  5532     .
  5533 0325-EDIT-SCREEN.
  5534     IF PRTSWL > ZEROS
  5535        IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5536*          move prtswi to w-prtsw
  5537*          MOVE AL-UANON         TO PRTSWA
  5538*          IF PRTSWI = ' '
  5539              MOVE 'P'         TO PRTSWI
  5540*          END-IF
  5541*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5542        END-IF
  5543     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6316.cbl
  5544     IF LTRIDL > ZEROS
  5545        AND LTRIDI > SPACES
  5546        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5547        MOVE LTRIDI              TO LETR-LETTER-ID
  5548                                    PI-LTRID-ENTERED
  5549        MOVE SPACES              TO LETR-FILLER
  5550        MOVE 1                   TO LETR-SEQ-NO
  5551
  5552* EXEC CICS READ
  5553*           DATASET   ('ELLETR')
  5554*           INTO      (TEXT-FILES)
  5555*           RIDFLD    (ELLETR-KEY)
  5556*           RESP      (WS-RESPONSE)
  5557*       END-EXEC
  5558     MOVE LENGTH OF
  5559      TEXT-FILES
  5560       TO DFHEIV11
  5561     MOVE 'ELLETR' TO DFHEIV1
  5562*    MOVE '&"IL       E          (  N#00005531' TO DFHEIV0
  5563     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5565     MOVE X'204E233030303035353331' TO DFHEIV0(25:11)
  5566     CALL 'kxdfhei1' USING DFHEIV0,
  5567           DFHEIV1,
  5568           TEXT-FILES,
  5569           DFHEIV11,
  5570           ELLETR-KEY,
  5571           DFHEIV99,
  5572           DFHEIV99,
  5573           DFHEIV99
  5574     MOVE EIBRESP  TO WS-RESPONSE
  5575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5576        IF RESP-NORMAL
  5577           MOVE AL-UANON         TO LTRIDA
  5578           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5579              MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5580           ELSE
  5581              MOVE SPACES        TO W-Z-CONTROL-DATA
  5582           END-IF
  5583        ELSE
  5584           MOVE ER-1236          TO EMI-ERROR
  5585           MOVE -1               TO LTRIDL
  5586           MOVE AL-UABON         TO LTRIDA
  5587           PERFORM 9900-ERROR-FORMAT
  5588                                 THRU 9900-EXIT
  5589        END-IF
  5590     ELSE
  5591        MOVE ER-1236          TO EMI-ERROR
  5592        MOVE -1               TO LTRIDL
  5593        MOVE AL-UABON         TO LTRIDA
  5594        PERFORM 9900-ERROR-FORMAT
  5595                                 THRU 9900-EXIT
  5596     END-IF
  5597     SET REASONS-NOT-FOUND TO TRUE
  5598     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5599        IF REACDL (S1) = +4 OR
  5600          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5601              MOVE AL-SANON     TO REACDA (S1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6316.cbl
  5602              SET REASONS-FOUND TO TRUE
  5603        END-IF
  5604     END-PERFORM
  5605
  5606     IF REASONS-NOT-FOUND
  5607        MOVE ER-1820             TO EMI-ERROR
  5608        MOVE -1                  TO PFENTRL
  5609        PERFORM 9900-ERROR-FORMAT
  5610                                 THRU 9900-EXIT
  5611     ELSE
  5612        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5613     END-IF
  5614
  5615     IF CRTNT1L > ZEROS
  5616        IF CRTNT1I > SPACES
  5617           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5618        END-IF
  5619     END-IF
  5620
  5621     IF CRTNT2L > ZEROS
  5622        IF CRTNT2I > SPACES
  5623           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5624        END-IF
  5625     END-IF
  5626
  5627     .
  5628 0325-EXIT.
  5629     EXIT.
  5630 0350-DISPLAY-COMMON-DATA.
  5631     display ' made it to 0350 '
  5632     PERFORM 0360-CHECK-PENDING THRU 0360-EXIT
  5633     IF PI-LTRID-ENTERED > SPACES
  5634        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5635        MOVE AL-UANON            TO LTRIDA
  5636        MOVE +4                  TO LTRIDL
  5637     ELSE
  5638        IF PI-CLM-RESCISSION
  5639            MOVE 'CLRC'          TO LTRIDI
  5640                                    PI-LTRID-ENTERED
  5641            MOVE +4              TO LTRIDL
  5642            MOVE AL-UANON        TO LTRIDA
  5643        END-IF
  5644     END-IF
  5645
  5646     SET REASONS-NOT-FOUND TO TRUE
  5647     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5648     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5649        IF REACDL (S1) = +4 OR
  5650          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5651              MOVE AL-SANON      TO REACDA (S1)
  5652              MOVE +4            TO REACDL (S1)
  5653              SET REASONS-FOUND  TO TRUE
  5654        END-IF
  5655     END-PERFORM
  5656
  5657     IF REASONS-NOT-FOUND
  5658         IF PI-CLM-RESCISSION
  5659            MOVE 'CRNA'          TO REACD-IN (1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6316.cbl
  5660            MOVE AL-SANON        TO REACDA (1)
  5661            MOVE +4              TO REACDL (1)
  5662            SET REASONS-FOUND    TO TRUE
  5663        END-IF
  5664     END-IF
  5665
  5666     IF PI-CERTNT1-ENTERED > SPACES
  5667        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5668        MOVE AL-UANON            TO CRTNT1A
  5669        MOVE +63                 TO CRTNT1L
  5670     END-IF
  5671
  5672     IF PI-CERTNT2-ENTERED > SPACES
  5673        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5674        MOVE AL-UANON            TO CRTNT2A
  5675        MOVE +63                 TO CRTNT2L
  5676     END-IF
  5677
  5678     GO TO 8100-SEND-INITIAL-MAP
  5679     .
  5680 0350-EXIT.
  5681     EXIT.
  5682 0360-CHECK-PENDING.
  5683     display ' made it to 0360 '
  5684     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  5685     MOVE PI-CARRIER             TO CRTO-CARRIER
  5686     MOVE PI-GROUPING            TO CRTO-GROUPING
  5687     MOVE PI-STATE               TO CRTO-STATE
  5688     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  5689     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  5690     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  5691     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  5692     MOVE 'I'                    TO CRTO-RECORD-TYPE
  5693     MOVE ZEROS                  TO CRTO-SEQ-NO
  5694     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  5695     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  5696     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  5697     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  5698     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  5699     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  5700      display 'response ' ws-response
  5701      display 'pi-elcrto-key ' pi-elcrto-key
  5702      display 'oc key ' oc-control-primary
  5703     IF RESP-NORMAL
  5704       IF (PI-ELCRTO-KEY (1:33) =
  5705              OC-CONTROL-PRIMARY (1:33))
  5706          DISPLAY 'CRTO RESP NORMAL '
  5707          MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  5708          PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  5709          PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  5710          IF RESP-NORMAL
  5711             MOVE PB-CONTROL-PRIMARY TO PI-ERPNDB-KEY
  5712             PERFORM 0380-BUILD-FROM-ERPNDB THRU 0380-EXIT
  5713          END-IF
  5714       ELSE
  5715          MOVE ER-3829           TO EMI-ERROR
  5716          PERFORM 9900-ERROR-FORMAT
  5717                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6316.cbl
  5718          MOVE -1                TO CARRL
  5719          GO TO 8100-SEND-INITIAL-MAP
  5720       END-IF
  5721     ELSE
  5722        MOVE ER-3829             TO EMI-ERROR
  5723        PERFORM 9900-ERROR-FORMAT
  5724                                 THRU 9900-EXIT
  5725        MOVE -1                  TO CARRL
  5726        GO TO 8100-SEND-INITIAL-MAP
  5727     END-IF
  5728     .
  5729 0360-EXIT.
  5730     EXIT.
  5731 0361-MOVE-CRTO-TO-SCREEN.
  5732     display ' made it to 0361 '
  5733     MOVE OC-LF-CANCEL-DT          TO DC-BIN-DATE-1
  5734     MOVE ' '                      TO DC-OPTION-CODE
  5735     PERFORM 9700-DATE-LINK
  5736     IF NO-CONVERSION-ERROR
  5737        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  5738     END-IF
  5739     MOVE OC-AH-CANCEL-DT          TO DC-BIN-DATE-1
  5740     MOVE ' '                      TO DC-OPTION-CODE
  5741     PERFORM 9700-DATE-LINK
  5742     IF NO-CONVERSION-ERROR
  5743        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  5744     END-IF
  5745     MOVE OC-LF-CANCEL-AMT         TO OLFAMTO
  5746     MOVE OC-AH-CANCEL-AMT         TO OAHAMTO
  5747     .
  5748 0361-EXIT.
  5749     EXIT.
  5750 0362-READ-ELCRTO.
  5751     display ' made it to 0362 '
  5752
  5753* EXEC CICS READ
  5754*        DATASET   (WS-ELCRTO-FILE-ID)
  5755*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5756*        RIDFLD    (ELCRTO-KEY)
  5757*        GTEQ
  5758*        RESP      (WS-RESPONSE)
  5759*    END-EXEC
  5760*    MOVE '&"S        G          (  N#00005713' TO DFHEIV0
  5761     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5762     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5763     MOVE X'204E233030303035373133' TO DFHEIV0(25:11)
  5764     CALL 'kxdfhei1' USING DFHEIV0,
  5765           WS-ELCRTO-FILE-ID,
  5766           DFHEIV20,
  5767           DFHEIV99,
  5768           ELCRTO-KEY,
  5769           DFHEIV99,
  5770           DFHEIV99,
  5771           DFHEIV99
  5772     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5773         DFHEIV20
  5774     MOVE EIBRESP  TO WS-RESPONSE
  5775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6316.cbl
  5776     .
  5777 0362-EXIT.
  5778     EXIT.
  5779 0363-READ-ELCRTO-UPD.
  5780     display ' made it to 0363 '
  5781
  5782* EXEC CICS READ
  5783*        DATASET   (WS-ELCRTO-FILE-ID)
  5784*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5785*        RIDFLD    (ELCRTO-KEY)
  5786*        UPDATE
  5787*        RESP      (WS-RESPONSE)
  5788*    END-EXEC
  5789*    MOVE '&"S        EU         (  N#00005725' TO DFHEIV0
  5790     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5791     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5792     MOVE X'204E233030303035373235' TO DFHEIV0(25:11)
  5793     CALL 'kxdfhei1' USING DFHEIV0,
  5794           WS-ELCRTO-FILE-ID,
  5795           DFHEIV20,
  5796           DFHEIV99,
  5797           ELCRTO-KEY,
  5798           DFHEIV99,
  5799           DFHEIV99,
  5800           DFHEIV99
  5801     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5802         DFHEIV20
  5803     MOVE EIBRESP  TO WS-RESPONSE
  5804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5805     .
  5806 0363-EXIT.
  5807     EXIT.
  5808
  5809 0364-MOVE-ZERO-TO-SCREEN.
  5810
  5811     MOVE ZEROS    TO OLFDTO
  5812                      OAHDTO
  5813                      OLFAMTO
  5814                      OAHAMTO.
  5815
  5816 0364-EXIT.
  5817     EXIT.
  5818
  5819 0365-READ-ERENDT.
  5820
  5821* EXEC CICS READ
  5822*        DATASET   (WS-ERENDT-FILE-ID)
  5823*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  5824*        RIDFLD    (ERENDT-KEY)
  5825*        RESP      (WS-RESPONSE)
  5826*    END-EXEC
  5827*    MOVE '&"S        E          (  N#00005747' TO DFHEIV0
  5828     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5829     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5830     MOVE X'204E233030303035373437' TO DFHEIV0(25:11)
  5831     CALL 'kxdfhei1' USING DFHEIV0,
  5832           WS-ERENDT-FILE-ID,
  5833           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6316.cbl
  5834           DFHEIV99,
  5835           ERENDT-KEY,
  5836           DFHEIV99,
  5837           DFHEIV99,
  5838           DFHEIV99
  5839     SET ADDRESS OF ENDORSEMENT-RECORD TO
  5840         DFHEIV20
  5841     MOVE EIBRESP  TO WS-RESPONSE
  5842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5843     .
  5844 0365-EXIT.
  5845     EXIT.
  5846 0370-READ-ERPNDB.
  5847     display ' made it to 0370 '
  5848     MOVE PI-COMPANY-CD          TO PNDB2-COMPANY-CD
  5849     MOVE PI-CRTO-CARRIER        TO PNDB2-CARRIER
  5850     MOVE PI-CRTO-GROUPING       TO PNDB2-GROUPING
  5851     MOVE PI-CRTO-STATE          TO PNDB2-STATE
  5852     MOVE PI-CRTO-ACCOUNT        TO PNDB2-ACCOUNT
  5853     MOVE PI-CRTO-CERT-PRIME     TO PNDB2-CERT-PRIME
  5854     MOVE PI-CRTO-CERT-SFX       TO PNDB2-CERT-SFX
  5855     MOVE PI-CRTO-CERT-EFF-DT    TO PNDB2-CERT-EFF-DT
  5856     MOVE +0                     TO PNDB2-CHG-SEQ-NO
  5857     MOVE '2'                    TO PNDB2-RECORD-TYPE
  5858
  5859* EXEC CICS READ
  5860*        DATASET   (WS-ERPNDB2-FILE-ID)
  5861*        SET       (ADDRESS OF PENDING-BUSINESS)
  5862*        RIDFLD    (ERPNDB2-KEY)
  5863*        RESP      (WS-RESPONSE)
  5864*    END-EXEC
  5865*    MOVE '&"S        E          (  N#00005768' TO DFHEIV0
  5866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5868     MOVE X'204E233030303035373638' TO DFHEIV0(25:11)
  5869     CALL 'kxdfhei1' USING DFHEIV0,
  5870           WS-ERPNDB2-FILE-ID,
  5871           DFHEIV20,
  5872           DFHEIV99,
  5873           ERPNDB2-KEY,
  5874           DFHEIV99,
  5875           DFHEIV99,
  5876           DFHEIV99
  5877     SET ADDRESS OF PENDING-BUSINESS TO
  5878         DFHEIV20
  5879     MOVE EIBRESP  TO WS-RESPONSE
  5880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5881     .
  5882 0370-EXIT.
  5883     EXIT.
  5884 0380-BUILD-FROM-ERPNDB.
  5885     display ' made it to 0380 '
  5886     MOVE PB-CARRIER             TO CARRO
  5887     MOVE PB-GROUPING            TO GROUPO
  5888     MOVE PB-STATE               TO STATEO
  5889     MOVE PB-ACCOUNT             TO ACCTO
  5890     MOVE PB-CERT-PRIME          TO CERTNOO
  5891     MOVE PB-CERT-SFX            TO CRTSFXO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL6316.cbl
  5892     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  5893     MOVE ' '                    TO DC-OPTION-CODE
  5894     PERFORM 9700-DATE-LINK
  5895     IF NO-CONVERSION-ERROR
  5896        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5897     END-IF
  5898     MOVE PB-CI-LAST-NAME        TO LNAMEO
  5899     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  5900     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  5901     MOVE PB-C-LF-CANCEL-DT        TO DC-BIN-DATE-1
  5902     MOVE ' '                      TO DC-OPTION-CODE
  5903     PERFORM 9700-DATE-LINK
  5904     IF NO-CONVERSION-ERROR
  5905        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  5906     END-IF
  5907     MOVE PB-C-AH-CANCEL-DT        TO DC-BIN-DATE-1
  5908     MOVE ' '                      TO DC-OPTION-CODE
  5909     PERFORM 9700-DATE-LINK
  5910     IF NO-CONVERSION-ERROR
  5911        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  5912     END-IF
  5913     MOVE PB-C-LF-CANCEL-AMT       TO NLFAMTO
  5914     MOVE PB-C-AH-CANCEL-AMT       TO NAHAMTO
  5915     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  5916        MOVE PB-CI-LIFE-COMMISSION
  5917                              TO LFCOMMO
  5918*       MOVE AL-UNNON         TO LFCOMMA
  5919     END-IF
  5920     IF PB-CI-AH-COMMISSION NOT = ZEROS
  5921        MOVE PB-CI-AH-COMMISSION
  5922                              TO AHCOMMO
  5923*       MOVE AL-UNNON         TO AHCOMMA
  5924     END-IF
  5925     MOVE ER-2785                TO EMI-ERROR
  5926     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  5927     .
  5928 0380-EXIT.
  5929     EXIT.
  5930 0390-BUILD-FROM-ERENDT.
  5931     MOVE LOW-VALUES             TO EL631II
  5932*    move PI-PRTSW-ENTERED       to prtswo
  5933     IF PI-CERTNT1-ENTERED > SPACES
  5934        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5935        MOVE AL-UANON            TO CRTNT1A
  5936        MOVE +63                 TO CRTNT1L
  5937     END-IF
  5938
  5939     IF PI-CERTNT2-ENTERED > SPACES
  5940        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5941        MOVE AL-UANON            TO CRTNT2A
  5942        MOVE +63                 TO CRTNT2L
  5943     END-IF
  5944     MOVE PI-COMPANY-CD          TO PI-ENDT-COMPANY-CD
  5945     MOVE EN-CARRIER             TO PI-ENDT-CARRIER
  5946     MOVE EN-GROUPING            TO PI-ENDT-GROUPING
  5947     MOVE EN-STATE               TO PI-ENDT-STATE
  5948     MOVE EN-ACCOUNT             TO PI-ENDT-ACCOUNT
  5949     MOVE EN-CERT-PRIME          TO PI-ENDT-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL6316.cbl
  5950     MOVE EN-CERT-SFX            TO PI-ENDT-CERT-SFX
  5951     MOVE EN-CERT-EFF-DT         TO PI-ENDT-CERT-EFF-DT
  5952     MOVE EN-REC-TYPE            TO PI-ENDT-RECORD-TYPE
  5953     MOVE EN-SEQ-NO              TO PI-ENDT-SEQ-NO
  5954     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  5955     MOVE EN-CARRIER             TO CARRO
  5956     MOVE EN-GROUPING            TO GROUPO
  5957     MOVE EN-STATE               TO STATEO
  5958     MOVE EN-ACCOUNT             TO ACCTO
  5959     MOVE EN-CERT-PRIME          TO CERTNOO
  5960     MOVE EN-CERT-SFX            TO CRTSFXO
  5961     MOVE EN-SEQ-NO              TO SEQNOO
  5962     MOVE EN-TEMPLATE-USED       TO LTRIDO
  5963     PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  5964     MOVE PB-CI-LAST-NAME        TO LNAMEO
  5965     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  5966     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  5967     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  5968        MOVE PB-CI-LIFE-COMMISSION TO LFCOMMO
  5969     END-IF
  5970     IF PB-CI-AH-COMMISSION NOT = ZEROS
  5971        MOVE PB-CI-AH-COMMISSION TO AHCOMMO
  5972     END-IF
  5973     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5974        IF EN-REASON-CODE (S1) NOT = SPACES
  5975           MOVE EN-REASON-CODE (S1) TO REACD-IN (S1)
  5976           MOVE AL-SANON         TO REACDA (S1)
  5977           MOVE +4               TO REACDL (S1)
  5978        END-IF
  5979     END-PERFORM
  5980     MOVE EN-CERT-EFF-DT         TO DC-BIN-DATE-1
  5981     MOVE ' '                    TO DC-OPTION-CODE
  5982     PERFORM 9700-DATE-LINK
  5983     IF NO-CONVERSION-ERROR
  5984        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5985     END-IF
  5986     IF EN-PROCESS-DT NOT = SPACES AND LOW-VALUES
  5987        MOVE EN-PROCESS-DT       TO DC-BIN-DATE-1
  5988        MOVE ' '                 TO DC-OPTION-CODE
  5989        PERFORM 9700-DATE-LINK
  5990        IF NO-CONVERSION-ERROR
  5991           MOVE DC-GREG-DATE-1-EDIT
  5992                                 TO PROCDTO
  5993        END-IF
  5994     END-IF
  5995     IF EN-INPUT-DT NOT = SPACES AND LOW-VALUES
  5996        MOVE EN-INPUT-DT         TO DC-BIN-DATE-1
  5997        MOVE ' '                 TO DC-OPTION-CODE
  5998        PERFORM 9700-DATE-LINK
  5999        IF NO-CONVERSION-ERROR
  6000           MOVE DC-GREG-DATE-1-EDIT
  6001                                 TO INPDTO
  6002        END-IF
  6003     END-IF
  6004     MOVE EN-LF-ORIG-REF-DT        TO DC-BIN-DATE-1
  6005     MOVE ' '                      TO DC-OPTION-CODE
  6006     PERFORM 9700-DATE-LINK
  6007     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL6316.cbl
  6008        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6009     END-IF
  6010     MOVE EN-LF-ORIG-REF-AMT       TO OLFAMTO
  6011     MOVE EN-AH-ORIG-REF-DT        TO DC-BIN-DATE-1
  6012     MOVE ' '                      TO DC-OPTION-CODE
  6013     PERFORM 9700-DATE-LINK
  6014     IF NO-CONVERSION-ERROR
  6015        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6016     END-IF
  6017     MOVE EN-AH-ORIG-REF-AMT       TO OAHAMTO
  6018     MOVE EN-LF-NEW-REF-DT         TO DC-BIN-DATE-1
  6019     MOVE ' '                      TO DC-OPTION-CODE
  6020     PERFORM 9700-DATE-LINK
  6021     IF NO-CONVERSION-ERROR
  6022        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6023     END-IF
  6024     MOVE EN-LF-NEW-REF-AMT        TO NLFAMTO
  6025     MOVE EN-AH-NEW-REF-DT         TO DC-BIN-DATE-1
  6026     MOVE ' '                      TO DC-OPTION-CODE
  6027     PERFORM 9700-DATE-LINK
  6028     IF NO-CONVERSION-ERROR
  6029        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6030     END-IF
  6031     MOVE EN-AH-NEW-REF-AMT        TO NAHAMTO
  6032     MOVE EN-ARCHIVE-NO            TO ARCHNOO
  6033     .
  6034 0390-EXIT.
  6035     EXIT.
  6036 0400-ADD-ERENDT.
  6037     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6038
  6039* EXEC CICS GETMAIN
  6040*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6041*         LENGTH   (ERENDT-LENGTH)
  6042*         INITIMG  (GETMAIN-SPACE)
  6043*    END-EXEC
  6044*    MOVE ',"IL                  $   #00005931' TO DFHEIV0
  6045     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6046     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6047     MOVE X'2020233030303035393331' TO DFHEIV0(25:11)
  6048     CALL 'kxdfhei1' USING DFHEIV0,
  6049           DFHEIV20,
  6050           ERENDT-LENGTH,
  6051           GETMAIN-SPACE
  6052     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6053         DFHEIV20
  6054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6055     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6056     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6057     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6058     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6059                                    EN-INPUT-DT
  6060     MOVE OC-LF-CANCEL-DT        TO EN-LF-ORIG-REF-DT
  6061     MOVE OC-AH-CANCEL-DT        TO EN-AH-ORIG-REF-DT
  6062     MOVE OC-LF-CANCEL-AMT       TO EN-LF-ORIG-REF-AMT
  6063     MOVE OC-AH-CANCEL-AMT       TO EN-AH-ORIG-REF-AMT
  6064
  6065     MOVE OC-LF-ITD-CANCEL-AMT   TO NEW-LF-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL6316.cbl
  6066     MOVE OC-AH-ITD-CANCEL-AMT   TO NEW-AH-ITD-CANCEL-AMT
  6067
  6068     MOVE OC-INS-LAST-NAME       TO EN-INS-LAST-NAME
  6069     MOVE OC-INS-FIRST-NAME      TO EN-INS-FIRST-NAME
  6070     MOVE OC-INS-MIDDLE-INIT     TO EN-INS-MIDDLE-INIT
  6071
  6072* EXEC CICS READ
  6073*        DATASET   (WS-ERPNDB-FILE-ID)
  6074*        SET       (ADDRESS OF PENDING-BUSINESS)
  6075*        RIDFLD    (PI-ERPNDB-KEY)
  6076*        RESP      (WS-RESPONSE)
  6077*    END-EXEC
  6078*    MOVE '&"S        E          (  N#00005952' TO DFHEIV0
  6079     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6081     MOVE X'204E233030303035393532' TO DFHEIV0(25:11)
  6082     CALL 'kxdfhei1' USING DFHEIV0,
  6083           WS-ERPNDB-FILE-ID,
  6084           DFHEIV20,
  6085           DFHEIV99,
  6086           PI-ERPNDB-KEY,
  6087           DFHEIV99,
  6088           DFHEIV99,
  6089           DFHEIV99
  6090     SET ADDRESS OF PENDING-BUSINESS TO
  6091         DFHEIV20
  6092     MOVE EIBRESP  TO WS-RESPONSE
  6093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6094     IF NOT RESP-NORMAL
  6095        GO TO 0400-EXIT
  6096     END-IF
  6097     MOVE PB-C-LF-CANCEL-DT      TO EN-LF-NEW-REF-DT
  6098                                    NEW-LF-CANCEL-DT
  6099     MOVE PB-C-AH-CANCEL-DT      TO EN-AH-NEW-REF-DT
  6100                                    NEW-AH-CANCEL-DT
  6101     MOVE PB-C-LF-CANCEL-AMT     TO EN-LF-NEW-REF-AMT
  6102                                    NEW-LF-CANCEL-AMT
  6103     MOVE PB-C-AH-CANCEL-AMT     TO EN-AH-NEW-REF-AMT
  6104                                    NEW-AH-CANCEL-AMT
  6105     MOVE PB-CI-LIFE-COMMISSION  TO EN-LF-COMMISSION
  6106     MOVE PB-CI-AH-COMMISSION    TO EN-AH-COMMISSION
  6107     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6108     MOVE 'C'                    TO EN-DOCU-TYPE
  6109     MOVE 'Y'                    TO EN-MONEY-SW
  6110     MOVE PB-ENTRY-BATCH         TO EN-BATCH-NUMBER
  6111     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6112     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6113     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6114        IF REACD-IN (S1) NOT = LOW-VALUES
  6115           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6116        END-IF
  6117     END-PERFORM
  6118     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6119
  6120     IF ACCT-FOUND
  6121        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  6122        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
  6123        IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL6316.cbl
  6124           MOVE PB-C-LF-CANCEL-DT
  6125                                 TO DC-BIN-DATE-2
  6126        END-IF
  6127        MOVE '1'                 TO DC-OPTION-CODE
  6128        PERFORM 9700-DATE-LINK
  6129        IF NO-CONVERSION-ERROR
  6130           MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  6131           IF DC-ODD-DAYS-OVER > +1
  6132              ADD +1          TO WS-DIFF
  6133           END-IF
  6134        ELSE
  6135            MOVE +0           TO WS-DIFF
  6136        END-IF
  6137     ELSE
  6138        MOVE +0           TO WS-DIFF
  6139     END-IF
  6140
  6141     COMPUTE WS-DUE-BORROWER = (EN-LF-NEW-REF-AMT
  6142         + EN-AH-NEW-REF-AMT)
  6143
  6144     IF (WS-CHGBACK = 99)
  6145         OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  6146          MOVE WS-DUE-BORROWER TO EN-CSO-PORTION
  6147          MOVE ZEROS           TO EN-ACCT-PORTION
  6148          MOVE 'N'             TO EN-COMM-CHGBK
  6149     ELSE
  6150         COMPUTE EN-ACCT-PORTION = (EN-LF-NEW-REF-AMT
  6151                 * EN-LF-COMMISSION) +
  6152                (EN-AH-NEW-REF-AMT * EN-AH-COMMISSION)
  6153         COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER
  6154                 - EN-ACCT-PORTION
  6155         MOVE 'Y'                TO EN-COMM-CHGBK
  6156     END-IF
  6157     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6158     .
  6159 0400-EXIT.
  6160     EXIT.
  6161 0410-INIT-ERENDT.
  6162     MOVE OC-CONTROL-PRIMARY (1:33) TO ERENDT-KEY (1:33)
  6163     MOVE 'C'                    TO ENDT-RECORD-TYPE
  6164     MOVE ZEROS                  TO ENDT-SEQ-NO
  6165
  6166* EXEC CICS READ
  6167*        DATASET    (WS-ERENDT-FILE-ID)
  6168*        RIDFLD     (ERENDT-KEY)
  6169*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6170*        RESP       (WS-RESPONSE)
  6171*        GTEQ
  6172*    END-EXEC
  6173*    MOVE '&"S        G          (  N#00006029' TO DFHEIV0
  6174     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6176     MOVE X'204E233030303036303239' TO DFHEIV0(25:11)
  6177     CALL 'kxdfhei1' USING DFHEIV0,
  6178           WS-ERENDT-FILE-ID,
  6179           DFHEIV20,
  6180           DFHEIV99,
  6181           ERENDT-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL6316.cbl
  6182           DFHEIV99,
  6183           DFHEIV99,
  6184           DFHEIV99
  6185     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6186         DFHEIV20
  6187     MOVE EIBRESP  TO WS-RESPONSE
  6188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6189     IF RESP-NORMAL
  6190        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
  6191        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6192     ELSE
  6193        MOVE +4096               TO WS-SEQ-NO
  6194     END-IF
  6195     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6196     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6197     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6198     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6199     MOVE WS-CURRENT-BIN-DT      TO EN-PROCESS-DT
  6200     MOVE 'C'                    TO EN-REC-TYPE
  6201     INITIALIZE EN-CANCEL-RECORD
  6202     MOVE ZEROS TO EN-CSO-PORTION EN-ACCT-PORTION
  6203     MOVE LOW-VALUES             TO EN-LF-ORIG-REF-DT
  6204                                    EN-AH-ORIG-REF-DT
  6205                                    EN-LF-NEW-REF-DT
  6206                                    EN-AH-NEW-REF-DT
  6207     .
  6208 0410-EXIT.
  6209     EXIT.
  6210 0420-UPDATE-ELCRTO.
  6211     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6212     IF RESP-NORMAL
  6213        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6214                                    OC-LAST-MAINT-DT
  6215        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6216        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6217
  6218* EXEC CICS REWRITE
  6219*          FROM     (ORIGINAL-CERTIFICATE)
  6220*          DATASET  ('ELCRTO')
  6221*       END-EXEC
  6222     MOVE LENGTH OF
  6223      ORIGINAL-CERTIFICATE
  6224       TO DFHEIV11
  6225     MOVE 'ELCRTO' TO DFHEIV1
  6226*    MOVE '&& L                  %   #00006064' TO DFHEIV0
  6227     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6228     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6229     MOVE X'2020233030303036303634' TO DFHEIV0(25:11)
  6230     CALL 'kxdfhei1' USING DFHEIV0,
  6231           DFHEIV1,
  6232           ORIGINAL-CERTIFICATE,
  6233           DFHEIV11,
  6234           DFHEIV99
  6235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6236     END-IF
  6237     .
  6238 0420-EXIT.
  6239     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL6316.cbl
  6240
  6241 0425-ADD-NEW-ELCRTO.
  6242     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6243     MOVE 'OC'                   TO OC-RECORD-ID
  6244     MOVE PI-ELCRTO-KEY          TO OC-CONTROL-PRIMARY
  6245     SUBTRACT +1                 FROM OC-KEY-SEQ-NO
  6246     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6247     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6248     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6249     MOVE NEW-INS-FIRST-NAME     TO OC-INS-FIRST-NAME
  6250     MOVE NEW-INS-MIDDLE-INIT    TO OC-INS-MIDDLE-INIT
  6251     MOVE NEW-INS-LAST-NAME      TO OC-INS-LAST-NAME
  6252     MOVE NEW-INS-AGE            TO OC-INS-AGE
  6253     MOVE NEW-JNT-FIRST-NAME     TO OC-JNT-FIRST-NAME
  6254     MOVE NEW-JNT-MIDDLE-INIT    TO OC-JNT-MIDDLE-INIT
  6255     MOVE NEW-JNT-LAST-NAME      TO OC-JNT-LAST-NAME
  6256     MOVE NEW-JNT-AGE            TO OC-JNT-AGE
  6257     MOVE NEW-LF-BENCD           TO OC-LF-BENCD
  6258     MOVE NEW-LF-BEN-AMT         TO OC-LF-BEN-AMT
  6259     MOVE NEW-LF-PRM-AMT         TO OC-LF-PRM-AMT
  6260     MOVE NEW-LF-ALT-BEN-AMT     TO OC-LF-ALT-BEN-AMT
  6261     MOVE NEW-LF-ALT-PRM-AMT     TO OC-LF-ALT-PRM-AMT
  6262     MOVE NEW-LF-TERM            TO OC-LF-TERM
  6263     MOVE NEW-LF-EXP-DT          TO OC-LF-EXP-DT
  6264     MOVE NEW-LF-COMM-PCT        TO OC-LF-COMM-PCT
  6265     MOVE NEW-LF-CANCEL-DT       TO OC-LF-CANCEL-DT
  6266     MOVE NEW-LF-CANCEL-AMT      TO OC-LF-CANCEL-AMT
  6267     MOVE NEW-AH-BENCD           TO OC-AH-BENCD
  6268     MOVE NEW-AH-BEN-AMT         TO OC-AH-BEN-AMT
  6269     MOVE NEW-AH-PRM-AMT         TO OC-AH-PRM-AMT
  6270     MOVE NEW-AH-TERM            TO OC-AH-TERM
  6271     MOVE NEW-AH-EXP-DT          TO OC-AH-EXP-DT
  6272     MOVE NEW-AH-CP              TO OC-AH-CP
  6273     MOVE NEW-AH-COMM-PCT        TO OC-AH-COMM-PCT
  6274     MOVE NEW-AH-CANCEL-DT       TO OC-AH-CANCEL-DT
  6275     MOVE NEW-AH-CANCEL-AMT      TO OC-AH-CANCEL-AMT
  6276     MOVE NEW-CRED-BENE-NAME     TO OC-CRED-BENE-NAME
  6277     MOVE NEW-1ST-PMT-DT         TO OC-1ST-PMT-DT
  6278     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6279     .
  6280 0425-WRITE-ELCRTO.
  6281
  6282
  6283* EXEC CICS WRITE
  6284*       DATASET   ('ELCRTO')
  6285*       FROM      (ORIGINAL-CERTIFICATE)
  6286*       RIDFLD    (OC-CONTROL-PRIMARY)
  6287*       RESP      (WS-RESPONSE)
  6288*    END-EXEC
  6289     MOVE LENGTH OF
  6290      ORIGINAL-CERTIFICATE
  6291       TO DFHEIV11
  6292     MOVE 'ELCRTO' TO DFHEIV1
  6293*    MOVE '&$ L                  ''  N#00006114' TO DFHEIV0
  6294     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6295     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6296     MOVE X'204E233030303036313134' TO DFHEIV0(25:11)
  6297     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL6316.cbl
  6298           DFHEIV1,
  6299           ORIGINAL-CERTIFICATE,
  6300           DFHEIV11,
  6301           OC-CONTROL-PRIMARY,
  6302           DFHEIV99,
  6303           DFHEIV99
  6304     MOVE EIBRESP  TO WS-RESPONSE
  6305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6306
  6307     display ' just wrote new crto ' ws-response
  6308     IF RESP-DUPKEY
  6309        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6310        GO TO 0425-WRITE-ELCRTO
  6311     ELSE
  6312        IF NOT RESP-NORMAL
  6313           MOVE -1               TO LTRIDL
  6314           MOVE ER-3830          TO EMI-ERROR
  6315           PERFORM 9900-ERROR-FORMAT
  6316                                 THRU 9900-EXIT
  6317        ELSE
  6318           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6319        END-IF
  6320     END-IF
  6321
  6322     .
  6323 0425-EXIT.
  6324     EXIT.
  6325
  6326 0426-ADD-CERT-NOTES.
  6327
  6328
  6329* EXEC CICS GETMAIN
  6330*         SET      (ADDRESS OF CERT-NOTE-FILE)
  6331*         LENGTH   (ERCNOT-LENGTH)
  6332*         INITIMG  (GETMAIN-SPACE)
  6333*    END-EXEC
  6334*    MOVE ',"IL                  $   #00006142' TO DFHEIV0
  6335     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6336     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6337     MOVE X'2020233030303036313432' TO DFHEIV0(25:11)
  6338     CALL 'kxdfhei1' USING DFHEIV0,
  6339           DFHEIV20,
  6340           ERCNOT-LENGTH,
  6341           GETMAIN-SPACE
  6342     SET ADDRESS OF CERT-NOTE-FILE TO
  6343         DFHEIV20
  6344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6345
  6346     MOVE LOW-VALUES TO WS-CERT-NOTE
  6347     IF PI-CERTNT1-ENTERED > SPACES
  6348         MOVE PI-CERTNT1-ENTERED TO WS-CERT-NOTE
  6349         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6350     END-IF
  6351
  6352     MOVE LOW-VALUES TO WS-CERT-NOTE
  6353     IF PI-CERTNT2-ENTERED > SPACES
  6354         MOVE PI-CERTNT2-ENTERED TO WS-CERT-NOTE
  6355         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL6316.cbl
  6356     END-IF
  6357
  6358     .
  6359 0426-EXIT.
  6360     EXIT.
  6361
  6362 0430-WRITE-ERENDT.
  6363     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6364     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6365     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6366
  6367* EXEC CICS WRITE
  6368*         DATASET   (WS-ERENDT-FILE-ID)
  6369*         FROM      (ENDORSEMENT-RECORD)
  6370*         RIDFLD    (EN-CONTROL-PRIMARY)
  6371*         RESP      (WS-RESPONSE)
  6372*    END-EXEC
  6373     MOVE LENGTH OF
  6374      ENDORSEMENT-RECORD
  6375       TO DFHEIV11
  6376*    MOVE '&$ L                  ''  N#00006168' TO DFHEIV0
  6377     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6378     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6379     MOVE X'204E233030303036313638' TO DFHEIV0(25:11)
  6380     CALL 'kxdfhei1' USING DFHEIV0,
  6381           WS-ERENDT-FILE-ID,
  6382           ENDORSEMENT-RECORD,
  6383           DFHEIV11,
  6384           EN-CONTROL-PRIMARY,
  6385           DFHEIV99,
  6386           DFHEIV99
  6387     MOVE EIBRESP  TO WS-RESPONSE
  6388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6389     IF RESP-NORMAL
  6390        MOVE 'C'                 TO PI-DOCUMENT-PROCESSED
  6391        display ' good write erendt '
  6392        IF EIBAID = DFHPF4
  6393           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6394           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6395           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6396           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6397        END-IF
  6398     ELSE
  6399        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6400        MOVE -1                  TO LTRIDL
  6401        MOVE ER-0132             TO EMI-ERROR
  6402        MOVE AL-UABON            TO LTRIDA
  6403        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6404     END-IF
  6405     .
  6406 0430-EXIT.
  6407     EXIT.
  6408 0440-ADD-BILLING-NOTE.
  6409     DISPLAY 'ADD BILLING NOTE'
  6410
  6411* EXEC CICS GETMAIN
  6412*         SET      (ADDRESS OF EOB-CODES)
  6413*         LENGTH   (ELEOBC-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL6316.cbl
  6414*         INITIMG  (GETMAIN-SPACE)
  6415*    END-EXEC
  6416*    MOVE ',"IL                  $   #00006195' TO DFHEIV0
  6417     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6418     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6419     MOVE X'2020233030303036313935' TO DFHEIV0(25:11)
  6420     CALL 'kxdfhei1' USING DFHEIV0,
  6421           DFHEIV20,
  6422           ELEOBC-LENGTH,
  6423           GETMAIN-SPACE
  6424     SET ADDRESS OF EOB-CODES TO
  6425         DFHEIV20
  6426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6427
  6428     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6429     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6430     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6431
  6432
  6433* EXEC CICS STARTBR
  6434*        DATASET   ('ELEOBC')
  6435*        RIDFLD    (WS-ELEOBC-KEY)
  6436*        GTEQ
  6437*        RESP      (WS-RESPONSE)
  6438*    END-EXEC
  6439     MOVE 'ELEOBC' TO DFHEIV1
  6440     MOVE 0
  6441       TO DFHEIV11
  6442*    MOVE '&,         G          &  N#00006205' TO DFHEIV0
  6443     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6444     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6445     MOVE X'204E233030303036323035' TO DFHEIV0(25:11)
  6446     CALL 'kxdfhei1' USING DFHEIV0,
  6447           DFHEIV1,
  6448           WS-ELEOBC-KEY,
  6449           DFHEIV99,
  6450           DFHEIV11,
  6451           DFHEIV99
  6452     MOVE EIBRESP  TO WS-RESPONSE
  6453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6454
  6455     IF NOT RESP-NORMAL
  6456        GO TO 0440-EXIT
  6457     END-IF
  6458      .
  6459 0440-READNEXT-ELEOBC.
  6460
  6461
  6462* EXEC CICS READNEXT
  6463*       INTO    (EOB-CODES)
  6464*       DATASET ('ELEOBC')
  6465*       RIDFLD  (WS-ELEOBC-KEY)
  6466*       RESP    (WS-RESPONSE)
  6467*    END-EXEC
  6468     MOVE LENGTH OF
  6469      EOB-CODES
  6470       TO DFHEIV12
  6471     MOVE 'ELEOBC' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL6316.cbl
  6472     MOVE 0
  6473       TO DFHEIV11
  6474*    MOVE '&.IL                  )  N#00006218' TO DFHEIV0
  6475     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6476     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6477     MOVE X'204E233030303036323138' TO DFHEIV0(25:11)
  6478     CALL 'kxdfhei1' USING DFHEIV0,
  6479           DFHEIV1,
  6480           EOB-CODES,
  6481           DFHEIV12,
  6482           WS-ELEOBC-KEY,
  6483           DFHEIV99,
  6484           DFHEIV11,
  6485           DFHEIV99,
  6486           DFHEIV99
  6487     MOVE EIBRESP  TO WS-RESPONSE
  6488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6489
  6490     IF RESP-NORMAL
  6491         IF EO-RECORD-TYPE NOT = '5'
  6492             GO TO 0440-EXIT
  6493         END-IF
  6494     ELSE
  6495         GO TO 0440-EXIT
  6496     END-IF
  6497
  6498     IF EO-RECORD-TYPE = '5' AND
  6499        EO-EOB-CODE = PI-LTRID-ENTERED
  6500           CONTINUE
  6501     ELSE
  6502         GO TO 0440-READNEXT-ELEOBC
  6503     END-IF
  6504
  6505     DISPLAY 'FOUND BILL NOTE ' EOB-CODES
  6506     MOVE SPACES TO WS-BILLING-NOTE
  6507     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6508     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6509     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6510     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6511
  6512
  6513* EXEC CICS GETMAIN
  6514*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  6515*         LENGTH   (ERNOTE-LENGTH)
  6516*         INITIMG  (GETMAIN-SPACE)
  6517*    END-EXEC
  6518*    MOVE ',"IL                  $   #00006247' TO DFHEIV0
  6519     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6520     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6521     MOVE X'2020233030303036323437' TO DFHEIV0(25:11)
  6522     CALL 'kxdfhei1' USING DFHEIV0,
  6523           DFHEIV20,
  6524           ERNOTE-LENGTH,
  6525           GETMAIN-SPACE
  6526     SET ADDRESS OF CERTIFICATE-NOTE TO
  6527         DFHEIV20
  6528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6529
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL6316.cbl
  6530     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  6531
  6532
  6533* EXEC CICS READ
  6534*       DATASET    (WS-ERNOTE-FILE-ID)
  6535*       RIDFLD     (WS-ERNOTE-KEY)
  6536*       INTO       (CERTIFICATE-NOTE)
  6537*       RESP       (WS-RESPONSE)
  6538*       UPDATE
  6539*    END-EXEC
  6540     MOVE LENGTH OF
  6541      CERTIFICATE-NOTE
  6542       TO DFHEIV11
  6543*    MOVE '&"IL       EU         (  N#00006255' TO DFHEIV0
  6544     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6545     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6546     MOVE X'204E233030303036323535' TO DFHEIV0(25:11)
  6547     CALL 'kxdfhei1' USING DFHEIV0,
  6548           WS-ERNOTE-FILE-ID,
  6549           CERTIFICATE-NOTE,
  6550           DFHEIV11,
  6551           WS-ERNOTE-KEY,
  6552           DFHEIV99,
  6553           DFHEIV99,
  6554           DFHEIV99
  6555     MOVE EIBRESP  TO WS-RESPONSE
  6556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6557
  6558     IF RESP-NORMAL
  6559       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  6560          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  6561       END-IF
  6562       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  6563          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  6564       END-IF
  6565       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6566           (NOTE-SUB > +10) OR
  6567           (CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE)
  6568       END-PERFORM
  6569       IF CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE
  6570
  6571* EXEC CICS UNLOCK
  6572*           DATASET    (WS-ERNOTE-FILE-ID)
  6573*        END-EXEC
  6574*    MOVE '&*                    #   #00006275' TO DFHEIV0
  6575     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6576     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6577     MOVE X'2020233030303036323735' TO DFHEIV0(25:11)
  6578     CALL 'kxdfhei1' USING DFHEIV0,
  6579           WS-ERNOTE-FILE-ID,
  6580           DFHEIV99
  6581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6582       ELSE
  6583         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6584           (NOTE-SUB > +10) OR
  6585           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  6586         END-PERFORM
  6587         IF (NOTE-SUB < +11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL6316.cbl
  6588           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  6589              NOTE-SUB <= CN-BILLING-END-LINE-NO
  6590                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6591           ELSE
  6592             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  6593              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  6594                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  6595                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  6596             ELSE
  6597               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  6598                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  6599                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6600                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  6601               ELSE
  6602                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  6603                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  6604                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  6605                                       CN-BILLING-START-LINE-NO
  6606                 ELSE
  6607                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  6608                 END-IF
  6609               END-IF
  6610             END-IF
  6611           END-IF
  6612           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6613           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6614           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6615
  6616* EXEC CICS REWRITE
  6617*             DATASET    (WS-ERNOTE-FILE-ID)
  6618*             FROM       (CERTIFICATE-NOTE)
  6619*             RESP       (WS-RESPONSE)
  6620*          END-EXEC
  6621     MOVE LENGTH OF
  6622      CERTIFICATE-NOTE
  6623       TO DFHEIV11
  6624*    MOVE '&& L                  %  N#00006311' TO DFHEIV0
  6625     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6626     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6627     MOVE X'204E233030303036333131' TO DFHEIV0(25:11)
  6628     CALL 'kxdfhei1' USING DFHEIV0,
  6629           WS-ERNOTE-FILE-ID,
  6630           CERTIFICATE-NOTE,
  6631           DFHEIV11,
  6632           DFHEIV99
  6633     MOVE EIBRESP  TO WS-RESPONSE
  6634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6635           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6636         END-IF
  6637       END-IF
  6638     ELSE
  6639        MOVE SPACES              TO CERTIFICATE-NOTE
  6640        MOVE 'CN'                TO CN-RECORD-ID
  6641        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  6642                                     WS-ERNOTE-KEY
  6643        MOVE 01                  TO CN-BILLING-START-LINE-NO
  6644                                    CN-BILLING-END-LINE-NO
  6645        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL6316.cbl
  6646        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6647        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6648        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6649
  6650* EXEC CICS WRITE
  6651*          DATASET    (WS-ERNOTE-FILE-ID)
  6652*          FROM       (CERTIFICATE-NOTE)
  6653*          RIDFLD     (WS-ERNOTE-KEY)
  6654*          RESP       (WS-RESPONSE)
  6655*       END-EXEC
  6656     MOVE LENGTH OF
  6657      CERTIFICATE-NOTE
  6658       TO DFHEIV11
  6659*    MOVE '&$ L                  ''  N#00006330' TO DFHEIV0
  6660     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6661     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6662     MOVE X'204E233030303036333330' TO DFHEIV0(25:11)
  6663     CALL 'kxdfhei1' USING DFHEIV0,
  6664           WS-ERNOTE-FILE-ID,
  6665           CERTIFICATE-NOTE,
  6666           DFHEIV11,
  6667           WS-ERNOTE-KEY,
  6668           DFHEIV99,
  6669           DFHEIV99
  6670     MOVE EIBRESP  TO WS-RESPONSE
  6671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6672
  6673        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6674     END-IF
  6675
  6676     .
  6677 0440-EXIT.
  6678     EXIT.
  6679
  6680
  6681 0442-SQUEEZE-IT-IN.
  6682
  6683     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  6684        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  6685           NOTE-SUB = +10
  6686           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  6687           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  6688             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  6689             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  6690             MOVE +9 TO NOTE-SUB
  6691           END-IF
  6692        END-PERFORM
  6693     ELSE
  6694        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  6695           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  6696             UNTIL NOTE-SUB = +1
  6697             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  6698             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  6699                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  6700                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  6701                MOVE +2          TO NOTE-SUB
  6702             END-IF
  6703           END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL6316.cbl
  6704        END-IF
  6705     END-IF
  6706
  6707     .
  6708 0442-EXIT.
  6709     EXIT.
  6710
  6711 0445-CERTIFICATE-UPDATE.
  6712    display 'billing note written, updating cert'
  6713     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  6714     IF RESP-NORMAL
  6715        EVALUATE CM-NOTE-SW
  6716           WHEN '2'
  6717           WHEN '3'
  6718           WHEN '6'
  6719           WHEN '7'
  6720              SET NO-CERT-RW     TO TRUE
  6721           WHEN ' '
  6722              MOVE '2'           TO CM-NOTE-SW
  6723           WHEN '1'
  6724              MOVE '3'           TO CM-NOTE-SW
  6725           WHEN '4'
  6726              MOVE '6'           TO CM-NOTE-SW
  6727           WHEN '5'
  6728              MOVE '7'           TO CM-NOTE-SW
  6729        END-EVALUATE
  6730     END-IF
  6731     IF NOT NO-CERT-RW
  6732        PERFORM 1810-REWRITE-ELCERT
  6733                                 THRU 1810-EXIT
  6734     ELSE
  6735
  6736* EXEC CICS UNLOCK
  6737*          DATASET    (WS-ELCERT-FILE-ID)
  6738*       END-EXEC
  6739*    MOVE '&*                    #   #00006399' TO DFHEIV0
  6740     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6741     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6742     MOVE X'2020233030303036333939' TO DFHEIV0(25:11)
  6743     CALL 'kxdfhei1' USING DFHEIV0,
  6744           WS-ELCERT-FILE-ID,
  6745           DFHEIV99
  6746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6747     END-IF
  6748
  6749     .
  6750 0445-EXIT.
  6751     EXIT.
  6752
  6753 0450-GET-ERACCT.
  6754     DISPLAY ' MADE IT TO 0450 '
  6755     MOVE ' '                    TO WS-ERACCT-SW
  6756     MOVE ZEROS                  TO WS-CHGBACK
  6757                                    WS-CSO-PORTION
  6758                                    WS-ACCT-PORTION
  6759                                    WS-DIFF
  6760     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  6761     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL6316.cbl
  6762        DISPLAY ' GOOD STARTBR '
  6763        PERFORM 0470-READNEXT-ERACCT
  6764                                 THRU 0470-EXIT
  6765     END-IF
  6766     IF RESP-NORMAL
  6767        DISPLAY ' GOOD READNEXT '
  6768        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  6769           IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  6770              AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  6771              DISPLAY ' SETTING ACCT FOUND TO TRUE '
  6772              SET ACCT-FOUND TO TRUE
  6773           ELSE
  6774              PERFORM 0470-READNEXT-ERACCT
  6775                                 THRU 0470-EXIT
  6776              IF RESP-NORMAL
  6777                 IF AM-CONTROL-PRIMARY (1:20)
  6778                    = EN-CONTROL-PRIMARY (1:20)
  6779                    IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  6780                       AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  6781                       DISPLAY ' SETTING ACCT FOUND TO TRUE '
  6782                       SET ACCT-FOUND TO TRUE
  6783                    END-IF
  6784                 END-IF
  6785              END-IF
  6786           END-IF
  6787        END-IF
  6788     END-IF
  6789     IF ACCT-FOUND
  6790        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6791           (AM-COM-TYP (S1) = 'C' OR 'D')
  6792           OR (S1 > +10)
  6793        END-PERFORM
  6794        IF S1 < +11
  6795           MOVE AM-COMM-CHARGEBACK (S1)
  6796                                 TO WS-CHGBACK
  6797        END-IF
  6798     END-IF
  6799
  6800* EXEC CICS ENDBR
  6801*        DATASET     ('ERACCT')
  6802*    END-EXEC.
  6803     MOVE 'ERACCT' TO DFHEIV1
  6804     MOVE 0
  6805       TO DFHEIV11
  6806*    MOVE '&2                    $   #00006454' TO DFHEIV0
  6807     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6808     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6809     MOVE X'2020233030303036343534' TO DFHEIV0(25:11)
  6810     CALL 'kxdfhei1' USING DFHEIV0,
  6811           DFHEIV1,
  6812           DFHEIV11,
  6813           DFHEIV99
  6814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6815
  6816    .
  6817 0450-EXIT.
  6818     EXIT.
  6819 0460-STARTBR-ERACCT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL6316.cbl
  6820     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  6821     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  6822     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  6823
  6824* EXEC CICS STARTBR
  6825*        DATASET   ('ERACCT')
  6826*        RIDFLD    (WS-ERACCT-KEY)
  6827*        GTEQ
  6828*        RESP      (WS-RESPONSE)
  6829*    END-EXEC
  6830     MOVE 'ERACCT' TO DFHEIV1
  6831     MOVE 0
  6832       TO DFHEIV11
  6833*    MOVE '&,         G          &  N#00006464' TO DFHEIV0
  6834     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6835     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6836     MOVE X'204E233030303036343634' TO DFHEIV0(25:11)
  6837     CALL 'kxdfhei1' USING DFHEIV0,
  6838           DFHEIV1,
  6839           WS-ERACCT-KEY,
  6840           DFHEIV99,
  6841           DFHEIV11,
  6842           DFHEIV99
  6843     MOVE EIBRESP  TO WS-RESPONSE
  6844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6845     .
  6846 0460-EXIT.
  6847     EXIT.
  6848 0470-READNEXT-ERACCT.
  6849
  6850* EXEC CICS READNEXT
  6851*       SET      (ADDRESS OF ACCOUNT-MASTER)
  6852*       DATASET ('ERACCT')
  6853*       RIDFLD  (WS-ERACCT-KEY)
  6854*       RESP    (WS-RESPONSE)
  6855*    END-EXEC
  6856     MOVE 'ERACCT' TO DFHEIV1
  6857     MOVE 0
  6858       TO DFHEIV11
  6859*    MOVE '&.S                   )  N#00006474' TO DFHEIV0
  6860     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6861     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6862     MOVE X'204E233030303036343734' TO DFHEIV0(25:11)
  6863     CALL 'kxdfhei1' USING DFHEIV0,
  6864           DFHEIV1,
  6865           DFHEIV20,
  6866           DFHEIV99,
  6867           WS-ERACCT-KEY,
  6868           DFHEIV99,
  6869           DFHEIV11,
  6870           DFHEIV99,
  6871           DFHEIV99
  6872     SET ADDRESS OF ACCOUNT-MASTER TO
  6873         DFHEIV20
  6874     MOVE EIBRESP  TO WS-RESPONSE
  6875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6876     .
  6877 0470-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL6316.cbl
  6878     EXIT.
  6879 0491-ERNOTE-READ-UPDATE.
  6880
  6881* EXEC CICS READ
  6882*       UPDATE
  6883*       DATASET    (WS-ERNOTE-FILE-ID)
  6884*       RIDFLD     (WS-ERNOTE-KEY)
  6885*       SET        (ADDRESS OF CERTIFICATE-NOTE)
  6886*       RESP       (WS-RESPONSE)
  6887*    END-EXEC
  6888*    MOVE '&"S        EU         (  N#00006484' TO DFHEIV0
  6889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6890     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6891     MOVE X'204E233030303036343834' TO DFHEIV0(25:11)
  6892     CALL 'kxdfhei1' USING DFHEIV0,
  6893           WS-ERNOTE-FILE-ID,
  6894           DFHEIV20,
  6895           DFHEIV99,
  6896           WS-ERNOTE-KEY,
  6897           DFHEIV99,
  6898           DFHEIV99,
  6899           DFHEIV99
  6900     SET ADDRESS OF CERTIFICATE-NOTE TO
  6901         DFHEIV20
  6902     MOVE EIBRESP  TO WS-RESPONSE
  6903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6904     .
  6905 0491-EXIT.
  6906     EXIT.
  6907 0492-REWRITE-ERNOTE.
  6908     MOVE 'E631'              TO CN-LAST-MAINT-USER
  6909     MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6910     MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6911
  6912* EXEC CICS REWRITE
  6913*       DATASET    (WS-ERNOTE-FILE-ID)
  6914*       FROM       (CERTIFICATE-NOTE)
  6915*       RESP       (WS-RESPONSE)
  6916*    END-EXEC
  6917     MOVE LENGTH OF
  6918      CERTIFICATE-NOTE
  6919       TO DFHEIV11
  6920*    MOVE '&& L                  %  N#00006498' TO DFHEIV0
  6921     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6922     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6923     MOVE X'204E233030303036343938' TO DFHEIV0(25:11)
  6924     CALL 'kxdfhei1' USING DFHEIV0,
  6925           WS-ERNOTE-FILE-ID,
  6926           CERTIFICATE-NOTE,
  6927           DFHEIV11,
  6928           DFHEIV99
  6929     MOVE EIBRESP  TO WS-RESPONSE
  6930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6931     .
  6932 0492-EXIT.
  6933     EXIT.
  6934 0493-SQUEEZE-ERNOTE.
  6935     IF CN-BILLING-START-LINE-NO > 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL6316.cbl
  6936         MOVE CN-BILLING-START-LINE-NO TO NOTE-SUB
  6937     ELSE
  6938         MOVE +1                 TO NOTE-SUB
  6939     END-IF.
  6940
  6941     PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  6942        (NOTE-SUB > +9)
  6943        IF CN-LINE (NOTE-SUB) = SPACES
  6944           MOVE CN-LINE (NOTE-SUB + +1)
  6945                                 TO CN-LINE (NOTE-SUB)
  6946           MOVE SPACES           TO CN-LINE (NOTE-SUB + +1)
  6947        END-IF
  6948     END-PERFORM
  6949     .
  6950 0493-EXIT.
  6951     EXIT.
  6952 0500-ERENDT-READ-GTEQ.
  6953
  6954* EXEC CICS READ
  6955*        DATASET    (WS-ERENDT-FILE-ID)
  6956*        RIDFLD     (ERENDT-KEY)
  6957*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6958*        RESP       (WS-RESPONSE)
  6959*        GTEQ
  6960*    END-EXEC
  6961*    MOVE '&"S        G          (  N#00006525' TO DFHEIV0
  6962     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6964     MOVE X'204E233030303036353235' TO DFHEIV0(25:11)
  6965     CALL 'kxdfhei1' USING DFHEIV0,
  6966           WS-ERENDT-FILE-ID,
  6967           DFHEIV20,
  6968           DFHEIV99,
  6969           ERENDT-KEY,
  6970           DFHEIV99,
  6971           DFHEIV99,
  6972           DFHEIV99
  6973     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6974         DFHEIV20
  6975     MOVE EIBRESP  TO WS-RESPONSE
  6976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6977     IF NOT RESP-NORMAL
  6978        MOVE ER-2237             TO EMI-ERROR
  6979        PERFORM 9900-ERROR-FORMAT
  6980                                 THRU 9900-EXIT
  6981        MOVE -1                  TO CARRL
  6982        GO TO 8200-SEND-DATAONLY
  6983     END-IF
  6984     .
  6985 0500-EXIT.
  6986     EXIT.
  6987 0510-ERENDT-READNEXT.
  6988
  6989* EXEC CICS READNEXT
  6990*       DATASET    (WS-ERENDT-FILE-ID)
  6991*       RIDFLD     (ERENDT-KEY)
  6992*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6993*       RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL6316.cbl
  6994*    END-EXEC
  6995     MOVE 0
  6996       TO DFHEIV11
  6997*    MOVE '&.S                   )  N#00006543' TO DFHEIV0
  6998     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6999     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7000     MOVE X'204E233030303036353433' TO DFHEIV0(25:11)
  7001     CALL 'kxdfhei1' USING DFHEIV0,
  7002           WS-ERENDT-FILE-ID,
  7003           DFHEIV20,
  7004           DFHEIV99,
  7005           ERENDT-KEY,
  7006           DFHEIV99,
  7007           DFHEIV11,
  7008           DFHEIV99,
  7009           DFHEIV99
  7010     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7011         DFHEIV20
  7012     MOVE EIBRESP  TO WS-RESPONSE
  7013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7014     IF NOT RESP-NORMAL
  7015        MOVE ER-2237             TO EMI-ERROR
  7016        PERFORM 9900-ERROR-FORMAT
  7017                                 THRU 9900-EXIT
  7018        MOVE -1                  TO CARRL
  7019        GO TO 8200-SEND-DATAONLY
  7020     END-IF
  7021     .
  7022 0510-EXIT.
  7023     EXIT.
  7024 0520-ERENDT-STARTBR.
  7025
  7026* EXEC CICS STARTBR
  7027*       DATASET    (WS-ERENDT-FILE-ID)
  7028*       RIDFLD     (ERENDT-KEY)
  7029*       RESP       (WS-RESPONSE)
  7030*    END-EXEC
  7031     MOVE 0
  7032       TO DFHEIV11
  7033*    MOVE '&,         G          &  N#00006560' TO DFHEIV0
  7034     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7035     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7036     MOVE X'204E233030303036353630' TO DFHEIV0(25:11)
  7037     CALL 'kxdfhei1' USING DFHEIV0,
  7038           WS-ERENDT-FILE-ID,
  7039           ERENDT-KEY,
  7040           DFHEIV99,
  7041           DFHEIV11,
  7042           DFHEIV99
  7043     MOVE EIBRESP  TO WS-RESPONSE
  7044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7045     IF NOT RESP-NORMAL
  7046        MOVE ER-2237             TO EMI-ERROR
  7047        PERFORM 9900-ERROR-FORMAT
  7048                                 THRU 9900-EXIT
  7049        MOVE -1                  TO CARRL
  7050        GO TO 8200-SEND-DATAONLY
  7051     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL6316.cbl
  7052     .
  7053 0520-EXIT.
  7054     EXIT.
  7055 0530-ERENDT-READPREV.
  7056
  7057* EXEC CICS READPREV
  7058*       DATASET    (WS-ERENDT-FILE-ID)
  7059*       RIDFLD     (ERENDT-KEY)
  7060*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7061*       RESP       (WS-RESPONSE)
  7062*    END-EXEC
  7063     MOVE 0
  7064       TO DFHEIV11
  7065*    MOVE '&0S                   )  N#00006576' TO DFHEIV0
  7066     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7067     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7068     MOVE X'204E233030303036353736' TO DFHEIV0(25:11)
  7069     CALL 'kxdfhei1' USING DFHEIV0,
  7070           WS-ERENDT-FILE-ID,
  7071           DFHEIV20,
  7072           DFHEIV99,
  7073           ERENDT-KEY,
  7074           DFHEIV99,
  7075           DFHEIV11,
  7076           DFHEIV99,
  7077           DFHEIV99
  7078     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7079         DFHEIV20
  7080     MOVE EIBRESP  TO WS-RESPONSE
  7081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7082     IF NOT RESP-NORMAL
  7083        MOVE ER-2238             TO EMI-ERROR
  7084        PERFORM 9900-ERROR-FORMAT
  7085                                 THRU 9900-EXIT
  7086        MOVE -1                  TO CARRL
  7087        GO TO 8200-SEND-DATAONLY
  7088     END-IF
  7089     .
  7090 0530-EXIT.
  7091     EXIT.
  7092 0600-CREATE-TEMP-STORAGE.
  7093
  7094* EXEC CICS WRITEQ TS
  7095*        QUEUE (QID)
  7096*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7097*        LENGTH(PI-COMM-LENGTH)
  7098*    END-EXEC
  7099*    MOVE '*"                    ''   #00006593' TO DFHEIV0
  7100     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7101     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7102     MOVE X'2020233030303036353933' TO DFHEIV0(25:11)
  7103     CALL 'kxdfhei1' USING DFHEIV0,
  7104           QID,
  7105           PROGRAM-INTERFACE-BLOCK,
  7106           PI-COMM-LENGTH,
  7107           DFHEIV99,
  7108           DFHEIV99,
  7109           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL6316.cbl
  7110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7111     display ' about to write map ' el631ii
  7112
  7113* EXEC CICS WRITEQ TS
  7114*        QUEUE (QID)
  7115*        FROM  (EL631II)
  7116*        LENGTH(MAP-LENGTH)
  7117*    END-EXEC.
  7118*    MOVE '*"                    ''   #00006599' TO DFHEIV0
  7119     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7120     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7121     MOVE X'2020233030303036353939' TO DFHEIV0(25:11)
  7122     CALL 'kxdfhei1' USING DFHEIV0,
  7123           QID,
  7124           EL631II,
  7125           MAP-LENGTH,
  7126           DFHEIV99,
  7127           DFHEIV99,
  7128           DFHEIV99
  7129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7130
  7131 0600-EXIT.
  7132      EXIT.
  7133 0610-RECOVER-TEMP-STORAGE.
  7134
  7135* EXEC CICS READQ TS
  7136*        QUEUE (QID)
  7137*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7138*        LENGTH(PI-COMM-LENGTH)
  7139*    END-EXEC
  7140*    MOVE '*$I    L              ''   #00006607' TO DFHEIV0
  7141     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7142     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7143     MOVE X'2020233030303036363037' TO DFHEIV0(25:11)
  7144     CALL 'kxdfhei1' USING DFHEIV0,
  7145           QID,
  7146           PROGRAM-INTERFACE-BLOCK,
  7147           PI-COMM-LENGTH,
  7148           DFHEIV99,
  7149           DFHEIV99,
  7150           DFHEIV99
  7151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7152
  7153* EXEC CICS READQ TS
  7154*        QUEUE (QID)
  7155*        INTO  (EL631II)
  7156*        LENGTH(MAP-LENGTH)
  7157*    END-EXEC
  7158*    MOVE '*$I    L              ''   #00006612' TO DFHEIV0
  7159     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7160     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7161     MOVE X'2020233030303036363132' TO DFHEIV0(25:11)
  7162     CALL 'kxdfhei1' USING DFHEIV0,
  7163           QID,
  7164           EL631II,
  7165           MAP-LENGTH,
  7166           DFHEIV99,
  7167           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL6316.cbl
  7168           DFHEIV99
  7169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7170     display ' map ' EL631II
  7171     PERFORM 0620-DELETE-TS THRU 0620-EXIT
  7172     MOVE AL-UANON            TO LTRIDA
  7173     IF WS-SET-CODES-MDT = 'Y'
  7174        move +1                  to s2
  7175        perform varying s1 from +1 by +5 until s1 > +60
  7176           MOVE WS-PASSED-REASON-CODES (s1:4)
  7177                                 TO reacd-in (s2)
  7178           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7179               MOVE AL-SANON     TO REACDA (S2)
  7180               MOVE +4           TO REACDL (S2)
  7181           END-IF
  7182           add +1                to s2
  7183        end-perform
  7184        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7185     END-IF
  7186
  7187     IF CRTNT1I > SPACES
  7188         MOVE AL-UANON       TO CRTNT1A
  7189     END-IF
  7190
  7191     IF CRTNT2I > SPACES
  7192         MOVE AL-UANON       TO CRTNT2A
  7193     END-IF
  7194     .
  7195 0610-EXIT.
  7196      EXIT.
  7197 0620-DELETE-TS.
  7198
  7199* EXEC CICS DELETEQ TS
  7200*        QUEUE(QID)
  7201*    END-EXEC
  7202*    MOVE '*&                    #   #00006645' TO DFHEIV0
  7203     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7204     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7205     MOVE X'2020233030303036363435' TO DFHEIV0(25:11)
  7206     CALL 'kxdfhei1' USING DFHEIV0,
  7207           QID,
  7208           DFHEIV99
  7209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7210     .
  7211 0620-EXIT.
  7212      EXIT.
  7213 1000-FINALIZE.
  7214     PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  7215     IF NOT EMI-NO-ERRORS
  7216        GO TO 8200-SEND-DATAONLY
  7217     END-IF
  7218     display ' made it to 1000 '
  7219     set P to address of KIXSYS
  7220     CALL "getenv" using by value P returning var-ptr
  7221     if var-ptr = null then
  7222        display ' kixsys not set '
  7223     else
  7224        set address of var to var-ptr
  7225        move 0 to env-var-len
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL6316.cbl
  7226        inspect var tallying env-var-len
  7227          for characters before X'00'
  7228*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  7229        unstring var (1:env-var-len) delimited by '/'
  7230           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  7231              WS-KIX-SYS
  7232        end-unstring
  7233*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  7234*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  7235     end-if
  7236     set P to address of KIXHOST
  7237     CALL "getenv" using by value P returning var-ptr
  7238     if var-ptr = null then
  7239        display ' kixhost not set '
  7240     else
  7241        set address of var to var-ptr
  7242        move 0 to env-var-len
  7243        inspect var tallying env-var-len
  7244          for characters before X'00'
  7245*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  7246        MOVE var(1:env-var-len)  to ws-kixhost
  7247        DISPLAY ' WS KIX HOST ' WS-KIXhost
  7248     end-if
  7249     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  7250     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  7251     IF RESP-NORMAL
  7252        AND (PI-ELCRTO-KEY (1:33) =
  7253              OC-CONTROL-PRIMARY (1:33))
  7254           DISPLAY ' RESP NORMAL AND = '
  7255           MOVE OC-ORIG-REC         TO NEW-ORIG-REC
  7256           PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  7257           PERFORM 1100-CALL-NS-BUS-LOGIC
  7258                                    THRU 1100-EXIT
  7259           IF BL-OK
  7260              CONTINUE
  7261           ELSE
  7262              MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  7263              MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  7264              MOVE -1               TO CARRL
  7265           END-IF
  7266     ELSE
  7267        MOVE ER-3829             TO EMI-ERROR
  7268        PERFORM 9900-ERROR-FORMAT
  7269                                 THRU 9900-EXIT
  7270        MOVE -1                  TO CARRL
  7271        GO TO 8100-SEND-INITIAL-MAP
  7272     END-IF
  7273     PERFORM 0390-BUILD-FROM-ERENDT THRU 0390-EXIT
  7274     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  7275                                 TO SYSO
  7276     MOVE WS-KIXHOST             TO HOSTO
  7277     MOVE PI-COMPANY-ID          TO COMPANYO
  7278     MOVE PI-PROCESSOR-ID        TO PROCIDO
  7279     MOVE '4'                    TO DATASORO
  7280     MOVE BL-BATCH-NO            TO BATCHNOO
  7281     MOVE BL-BATCH-SEQ           TO BSEQNOO
  7282     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  7283*    MOVE -1                     TO PRTSWL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL6316.cbl
  7284*    MOVE AL-UANON               TO PRTSWA
  7285     IF EIBAID = DFHPF4
  7286        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  7287        MOVE ER-0280             TO EMI-ERROR
  7288        PERFORM 9900-ERROR-FORMAT
  7289                                 THRU 9900-EXIT
  7290        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  7291        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7292        MOVE 'Y'                 TO PI-FINALIZED-IND
  7293        GO TO 9400-CLEAR
  7294     ELSE
  7295        MOVE ER-1818             TO EMI-ERROR
  7296        PERFORM 9900-ERROR-FORMAT
  7297                                 THRU 9900-EXIT
  7298     END-IF
  7299     GO TO 8100-SEND-INITIAL-MAP
  7300     .
  7301 1000-EXIT.
  7302     EXIT.
  7303 1100-CALL-NS-BUS-LOGIC.
  7304     DISPLAY ' MADE IT TO 1100 ' w-arch-number
  7305     MOVE SPACES                 TO BL-INPUT
  7306     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7307     MOVE '4'                    TO BL-DATA-SRCE
  7308     MOVE PB-CARRIER             TO BL-CARRIER
  7309     MOVE PB-GROUPING            TO BL-GROUP
  7310     MOVE PB-STATE               TO BL-STATE
  7311     MOVE PB-ACCOUNT             TO BL-ACCOUNT
  7312     IF PB-CERT-EFF-DT NOT = LOW-VALUES
  7313        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  7314        MOVE ' '                 TO DC-OPTION-CODE
  7315        PERFORM 9700-date-link
  7316        IF NO-CONVERSION-ERROR
  7317           MOVE DC-GREG-DATE-B-EDIT
  7318                                 TO BL-EFF-DT
  7319        END-IF
  7320     END-IF
  7321     MOVE PB-CERT-NO             TO BL-CERT-NO
  7322     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO
  7323     MOVE PB-BATCH-SEQ-NO        TO BL-BATCH-SEQ
  7324     MOVE SPACES                 TO BL-RESP-NO
  7325     MOVE LTRIDI                 TO BL-LETTER-ID
  7326     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7327     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7328*    MOVE 'ALWA'                 TO BL-PROC-ID
  7329     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7330     IF EIBAID = DFHPF4
  7331        MOVE 'B'                 TO BL-WRITE-ERARCH
  7332     ELSE
  7333        MOVE 'T'                 TO BL-WRITE-ERARCH
  7334     END-IF
  7335     MOVE SPACES                 TO BL-CERT-FORM-ID
  7336     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7337        IF REACD-IN (S1) NOT = LOW-VALUES
  7338           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  7339        END-IF
  7340     END-PERFORM
  7341    DISPLAY ' ABOUT TO LINK TO NSRASBL '
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL6316.cbl
  7342     DISPLAY ' BL INPUT ' BL-INPUT
  7343*****************************************
  7344* Invoke the LETTER business logic
  7345*****************************************
  7346     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  7347     display ' srch commarea ' srch-commarea
  7348     display ' length ' ws-comm-length
  7349
  7350* exec cics link
  7351*       program('NSRASBL')
  7352*       commarea(srch-commarea)
  7353*       LENGTH  (WS-COMM-LENGTH)
  7354*    end-exec.
  7355     MOVE 'NSRASBL' TO DFHEIV1
  7356*    MOVE '."C                   ''   #00006787' TO DFHEIV0
  7357     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7358     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7359     MOVE X'2020233030303036373837' TO DFHEIV0(25:11)
  7360     CALL 'kxdfhei1' USING DFHEIV0,
  7361           DFHEIV1,
  7362           srch-commarea,
  7363           WS-COMM-LENGTH,
  7364           DFHEIV99,
  7365           DFHEIV99,
  7366           DFHEIV99
  7367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7368
  7369     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7370        BL-MESSAGE
  7371     .
  7372 1100-EXIT.
  7373     EXIT.
  7374 1500-GET-ARCH-NO.
  7375     display ' made it to 1500 '
  7376     MOVE SPACES                 TO ELCNTL-KEY
  7377     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7378     MOVE '1'                    TO CNTL-REC-TYPE
  7379     MOVE ZEROS                  TO CNTL-SEQ
  7380
  7381* EXEC CICS READ
  7382*         DATASET    (WS-ELCNTL-FILE-ID)
  7383*         SET        (ADDRESS OF CONTROL-FILE)
  7384*         RIDFLD     (ELCNTL-KEY)
  7385*         UPDATE
  7386*         RESP       (WS-RESPONSE)
  7387*    END-EXEC
  7388*    MOVE '&"S        EU         (  N#00006803' TO DFHEIV0
  7389     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7390     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7391     MOVE X'204E233030303036383033' TO DFHEIV0(25:11)
  7392     CALL 'kxdfhei1' USING DFHEIV0,
  7393           WS-ELCNTL-FILE-ID,
  7394           DFHEIV20,
  7395           DFHEIV99,
  7396           ELCNTL-KEY,
  7397           DFHEIV99,
  7398           DFHEIV99,
  7399           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL6316.cbl
  7400     SET ADDRESS OF CONTROL-FILE TO
  7401         DFHEIV20
  7402     MOVE EIBRESP  TO WS-RESPONSE
  7403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7404     IF RESP-NORMAL
  7405        display ' good read elcntl '
  7406        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7407           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7408        END-IF
  7409        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7410        MOVE CF-CREDIT-LAST-ARCH-NUM
  7411                                 TO W-ARCH-NUMBER
  7412        display ' new arch number ' w-arch-number
  7413
  7414* EXEC CICS REWRITE
  7415*          FROM      (CONTROL-FILE)
  7416*          DATASET   (WS-ELCNTL-FILE-ID)
  7417*       END-EXEC
  7418     MOVE LENGTH OF
  7419      CONTROL-FILE
  7420       TO DFHEIV11
  7421*    MOVE '&& L                  %   #00006819' TO DFHEIV0
  7422     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7423     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7424     MOVE X'2020233030303036383139' TO DFHEIV0(25:11)
  7425     CALL 'kxdfhei1' USING DFHEIV0,
  7426           WS-ELCNTL-FILE-ID,
  7427           CONTROL-FILE,
  7428           DFHEIV11,
  7429           DFHEIV99
  7430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7431     END-IF
  7432     .
  7433 1500-EXIT.
  7434     EXIT.
  7435
  7436
  7437 1700-WRITE-CERT-NOTE      SECTION.
  7438
  7439     display 'made it to 1700-'
  7440     MOVE 'CZ'                   TO CERT-NOTE-FILE
  7441     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  7442     MOVE PI-CRTO-CARRIER        TO CZ-CARRIER
  7443     MOVE PI-CRTO-GROUPING       TO CZ-GROUPING
  7444     MOVE PI-CRTO-STATE          TO CZ-STATE
  7445     MOVE PI-CRTO-ACCOUNT        TO CZ-ACCOUNT
  7446     MOVE PI-CRTO-CERT-EFF-DT    TO CZ-CERT-EFF-DT
  7447     MOVE PI-CRTO-CERT-PRIME     TO CZ-CERT-PRIME
  7448     MOVE PI-CRTO-CERT-SFX       TO CZ-CERT-SFX
  7449     MOVE '1'                    TO CZ-RECORD-TYPE
  7450     MOVE +1                     TO CZ-NOTE-SEQUENCE
  7451
  7452     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  7453     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  7454     MOVE WS-CURRENT-BIN-DT      TO CZ-LAST-MAINT-DT
  7455     MOVE WS-CERT-NOTE           TO CZ-NOTE
  7456
  7457     MOVE ' '                    TO WS-STOP-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL6316.cbl
  7458    display 'about to write cert note ' cert-note-file
  7459     PERFORM UNTIL I-SAY-TO-STOP
  7460
  7461* EXEC CICS WRITE
  7462*           FROM      (CERT-NOTE-FILE)
  7463*           DATASET   (WS-ERCNOT-FILE-ID)
  7464*           RIDFLD    (CZ-CONTROL-PRIMARY)
  7465*           RESP      (WS-RESPONSE)
  7466*       END-EXEC
  7467     MOVE LENGTH OF
  7468      CERT-NOTE-FILE
  7469       TO DFHEIV11
  7470*    MOVE '&$ L                  ''  N#00006852' TO DFHEIV0
  7471     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7472     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7473     MOVE X'204E233030303036383532' TO DFHEIV0(25:11)
  7474     CALL 'kxdfhei1' USING DFHEIV0,
  7475           WS-ERCNOT-FILE-ID,
  7476           CERT-NOTE-FILE,
  7477           DFHEIV11,
  7478           CZ-CONTROL-PRIMARY,
  7479           DFHEIV99,
  7480           DFHEIV99
  7481     MOVE EIBRESP  TO WS-RESPONSE
  7482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7483        IF RESP-DUPREC
  7484           ADD +1                TO CZ-NOTE-SEQUENCE
  7485        ELSE
  7486           SET I-SAY-TO-STOP     TO TRUE
  7487        END-IF
  7488     END-PERFORM
  7489
  7490     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7491     IF RESP-NORMAL
  7492        EVALUATE CM-NOTE-SW
  7493           WHEN '1'
  7494           WHEN '3'
  7495           WHEN '5'
  7496           WHEN '7'
  7497              SET NO-CERT-RW     TO TRUE
  7498           WHEN ' '
  7499              MOVE '1'           TO CM-NOTE-SW
  7500           WHEN '2'
  7501              MOVE '3'           TO CM-NOTE-SW
  7502           WHEN '4'
  7503              MOVE '5'           TO CM-NOTE-SW
  7504           WHEN '6'
  7505              MOVE '7'           TO CM-NOTE-SW
  7506        END-EVALUATE
  7507     END-IF
  7508     IF NOT NO-CERT-RW
  7509        PERFORM 1810-REWRITE-ELCERT
  7510                                 THRU 1810-EXIT
  7511     ELSE
  7512
  7513* EXEC CICS UNLOCK
  7514*          DATASET    (WS-ELCERT-FILE-ID)
  7515*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL6316.cbl
  7516*    MOVE '&*                    #   #00006887' TO DFHEIV0
  7517     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7518     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7519     MOVE X'2020233030303036383837' TO DFHEIV0(25:11)
  7520     CALL 'kxdfhei1' USING DFHEIV0,
  7521           WS-ELCERT-FILE-ID,
  7522           DFHEIV99
  7523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7524     END-IF
  7525
  7526     .
  7527 1799-EXIT.
  7528     EXIT.
  7529
  7530 1800-READ-ELCERT-UPDATE.
  7531
  7532     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7533     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7534     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7535     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7536     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7537     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7538     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7539     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7540
  7541
  7542* EXEC CICS READ
  7543*        UPDATE
  7544*        DATASET  (WS-ELCERT-FILE-ID)
  7545*        RIDFLD   (WS-ELCERT-KEY)
  7546*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7547*        RESP     (WS-RESPONSE)
  7548*    END-EXEC
  7549*    MOVE '&"S        EU         (  N#00006907' TO DFHEIV0
  7550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7551     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7552     MOVE X'204E233030303036393037' TO DFHEIV0(25:11)
  7553     CALL 'kxdfhei1' USING DFHEIV0,
  7554           WS-ELCERT-FILE-ID,
  7555           DFHEIV20,
  7556           DFHEIV99,
  7557           WS-ELCERT-KEY,
  7558           DFHEIV99,
  7559           DFHEIV99,
  7560           DFHEIV99
  7561     SET ADDRESS OF CERTIFICATE-MASTER TO
  7562         DFHEIV20
  7563     MOVE EIBRESP  TO WS-RESPONSE
  7564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7565
  7566     .
  7567 1800-EXIT.
  7568     EXIT.
  7569
  7570 1810-REWRITE-ELCERT.
  7571
  7572
  7573* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL6316.cbl
  7574*        FROM     (CERTIFICATE-MASTER)
  7575*        DATASET  (WS-ELCERT-FILE-ID)
  7576*        RESP     (WS-RESPONSE)
  7577*    END-EXEC.
  7578     MOVE LENGTH OF
  7579      CERTIFICATE-MASTER
  7580       TO DFHEIV11
  7581*    MOVE '&& L                  %  N#00006921' TO DFHEIV0
  7582     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7583     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7584     MOVE X'204E233030303036393231' TO DFHEIV0(25:11)
  7585     CALL 'kxdfhei1' USING DFHEIV0,
  7586           WS-ELCERT-FILE-ID,
  7587           CERTIFICATE-MASTER,
  7588           DFHEIV11,
  7589           DFHEIV99
  7590     MOVE EIBRESP  TO WS-RESPONSE
  7591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7592
  7593
  7594     .
  7595 1810-EXIT.
  7596     EXIT.
  7597
  7598 8100-SEND-INITIAL-MAP.
  7599     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7600     MOVE '5'                    TO DC-OPTION-CODE.
  7601     PERFORM 9700-DATE-LINK.
  7602     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7603     MOVE EIBTIME                TO TIME-IN.
  7604     MOVE TIME-OUT               TO TIMEO.
  7605     MOVE -1                     TO LTRIDL
  7606*    MOVE AL-UANON               TO PRTSWA
  7607     IF PI-PROCESSOR-IS-CSR-SUPER
  7608        perform varying s1 from +1 by +1 until
  7609           s1 > +12
  7610           MOVE AL-UANON            TO reacda (s1)
  7611        end-perform
  7612     END-IF
  7613     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  7614
  7615* EXEC CICS SEND
  7616*        MAP      (MAP-NAME)
  7617*        MAPSET   (MAPSET-NAME)
  7618*        FROM     (EL631IO)
  7619*        ERASE
  7620*        CURSOR
  7621*    END-EXEC.
  7622     MOVE LENGTH OF
  7623      EL631IO
  7624       TO DFHEIV12
  7625     MOVE -1
  7626       TO DFHEIV11
  7627*    MOVE '8$     CT  E    H L F ,   #00006947' TO DFHEIV0
  7628     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7629     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7630     MOVE X'2020233030303036393437' TO DFHEIV0(25:11)
  7631     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL6316.cbl
  7632           MAP-NAME,
  7633           EL631IO,
  7634           DFHEIV12,
  7635           MAPSET-NAME,
  7636           DFHEIV99,
  7637           DFHEIV99,
  7638           DFHEIV99,
  7639           DFHEIV11,
  7640           DFHEIV99,
  7641           DFHEIV99,
  7642           DFHEIV99
  7643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7644
  7645     GO TO 9100-RETURN-TRAN.
  7646 8200-SEND-DATAONLY.
  7647     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7648     MOVE '5'                    TO DC-OPTION-CODE.
  7649     PERFORM 9700-DATE-LINK.
  7650     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7651     MOVE EIBTIME                TO TIME-IN.
  7652     MOVE TIME-OUT               TO TIMEO.
  7653     MOVE -1                     TO PFENTRL
  7654     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
  7655
  7656* EXEC CICS SEND
  7657*        MAP      (MAP-NAME)
  7658*        MAPSET   (MAPSET-NAME)
  7659*        FROM     (EL631IO)
  7660*        DATAONLY
  7661*        ERASEAUP
  7662*        CURSOR
  7663*    END-EXEC.
  7664     MOVE LENGTH OF
  7665      EL631IO
  7666       TO DFHEIV12
  7667     MOVE -1
  7668       TO DFHEIV11
  7669*    MOVE '8$D    CT  A    H L F ,   #00006964' TO DFHEIV0
  7670     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  7671     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7672     MOVE X'2020233030303036393634' TO DFHEIV0(25:11)
  7673     CALL 'kxdfhei1' USING DFHEIV0,
  7674           MAP-NAME,
  7675           EL631IO,
  7676           DFHEIV12,
  7677           MAPSET-NAME,
  7678           DFHEIV99,
  7679           DFHEIV99,
  7680           DFHEIV99,
  7681           DFHEIV11,
  7682           DFHEIV99,
  7683           DFHEIV99,
  7684           DFHEIV99
  7685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7686
  7687     GO TO 9100-RETURN-TRAN.
  7688 8300-SEND-TEXT.
  7689
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL6316.cbl
  7690* EXEC CICS SEND TEXT
  7691*        FROM     (LOGOFF-TEXT)
  7692*        LENGTH   (LOGOFF-LENGTH)
  7693*        ERASE
  7694*        FREEKB
  7695*    END-EXEC.
  7696*    MOVE '8&      T  E F  H   F -   #00006974' TO DFHEIV0
  7697     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  7698     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  7699     MOVE X'2020233030303036393734' TO DFHEIV0(25:11)
  7700     CALL 'kxdfhei1' USING DFHEIV0,
  7701           LOGOFF-TEXT,
  7702           LOGOFF-LENGTH,
  7703           DFHEIV99,
  7704           DFHEIV99,
  7705           DFHEIV99,
  7706           DFHEIV99,
  7707           DFHEIV99,
  7708           DFHEIV99,
  7709           DFHEIV99,
  7710           DFHEIV99,
  7711           DFHEIV99,
  7712           DFHEIV99
  7713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7714
  7715
  7716* EXEC CICS RETURN
  7717*    END-EXEC.
  7718*    MOVE '.(                    &   #00006980' TO DFHEIV0
  7719     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7720     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7721     MOVE X'2020233030303036393830' TO DFHEIV0(25:11)
  7722     CALL 'kxdfhei1' USING DFHEIV0,
  7723           DFHEIV99,
  7724           DFHEIV99,
  7725           DFHEIV99,
  7726           DFHEIV99,
  7727           DFHEIV99
  7728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7729
  7730 8800-UNAUTHORIZED-ACCESS.
  7731     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  7732     GO TO 8300-SEND-TEXT.
  7733 8810-PF23.
  7734     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  7735     MOVE XCTL-005               TO PGM-NAME.
  7736     GO TO 9300-XCTL.
  7737 9000-RETURN-CICS.
  7738
  7739* EXEC CICS RETURN
  7740*    END-EXEC.
  7741*    MOVE '.(                    &   #00006990' TO DFHEIV0
  7742     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7743     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7744     MOVE X'2020233030303036393930' TO DFHEIV0(25:11)
  7745     CALL 'kxdfhei1' USING DFHEIV0,
  7746           DFHEIV99,
  7747           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL6316.cbl
  7748           DFHEIV99,
  7749           DFHEIV99,
  7750           DFHEIV99
  7751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7752
  7753 9100-RETURN-TRAN.
  7754     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  7755     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  7756
  7757* EXEC CICS RETURN
  7758*        TRANSID    (TRANS-ID)
  7759*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7760*        LENGTH     (1300)
  7761*    END-EXEC.
  7762     MOVE 1300
  7763       TO DFHEIV11
  7764*    MOVE '.(CT                  &   #00006995' TO DFHEIV0
  7765     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  7766     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7767     MOVE X'2020233030303036393935' TO DFHEIV0(25:11)
  7768     CALL 'kxdfhei1' USING DFHEIV0,
  7769           TRANS-ID,
  7770           PROGRAM-INTERFACE-BLOCK,
  7771           DFHEIV11,
  7772           DFHEIV99,
  7773           DFHEIV99
  7774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7775
  7776 9200-RETURN-MAIN-MENU.
  7777     MOVE XCTL-626               TO PGM-NAME.
  7778     GO TO 9300-XCTL.
  7779 9300-XCTL.
  7780
  7781* EXEC CICS XCTL
  7782*        PROGRAM    (PGM-NAME)
  7783*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7784*        LENGTH     (1300)
  7785*    END-EXEC.
  7786     MOVE 1300
  7787       TO DFHEIV11
  7788*    MOVE '.$C                   $   #00007004' TO DFHEIV0
  7789     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7790     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7791     MOVE X'2020233030303037303034' TO DFHEIV0(25:11)
  7792     CALL 'kxdfhei1' USING DFHEIV0,
  7793           PGM-NAME,
  7794           PROGRAM-INTERFACE-BLOCK,
  7795           DFHEIV11
  7796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7797
  7798 9400-CLEAR.
  7799     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  7800
  7801* EXEC CICS XCTL
  7802*        PROGRAM    (PGM-NAME)
  7803*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7804*        LENGTH     (1300)
  7805*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL6316.cbl
  7806     MOVE 1300
  7807       TO DFHEIV11
  7808*    MOVE '.$C                   $   #00007011' TO DFHEIV0
  7809     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7810     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7811     MOVE X'2020233030303037303131' TO DFHEIV0(25:11)
  7812     CALL 'kxdfhei1' USING DFHEIV0,
  7813           PGM-NAME,
  7814           PROGRAM-INTERFACE-BLOCK,
  7815           DFHEIV11
  7816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7817
  7818 9500-PF12.
  7819     MOVE XCTL-010               TO PGM-NAME.
  7820     GO TO 9300-XCTL.
  7821 9600-PGMID-ERROR.
  7822
  7823* EXEC CICS HANDLE CONDITION
  7824*        PGMIDERR    (8300-SEND-TEXT)
  7825*    END-EXEC.
  7826*    MOVE '"$L                   ! " #00007020' TO DFHEIV0
  7827     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  7828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7829     MOVE X'2220233030303037303230' TO DFHEIV0(25:11)
  7830     CALL 'kxdfhei1' USING DFHEIV0
  7831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7832
  7833     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  7834     MOVE ' '                    TO PI-ENTRY-CD-1.
  7835     MOVE XCTL-005               TO PGM-NAME.
  7836     MOVE PGM-NAME               TO LOGOFF-PGM.
  7837     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  7838     GO TO 9300-XCTL.
  7839 9700-DATE-LINK.
  7840     MOVE LINK-ELDATCV           TO PGM-NAME.
  7841
  7842* EXEC CICS LINK
  7843*        PROGRAM    (PGM-NAME)
  7844*        COMMAREA   (DATE-CONVERSION-DATA)
  7845*        LENGTH     (DC-COMM-LENGTH)
  7846*    END-EXEC.
  7847*    MOVE '."C                   ''   #00007031' TO DFHEIV0
  7848     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7850     MOVE X'2020233030303037303331' TO DFHEIV0(25:11)
  7851     CALL 'kxdfhei1' USING DFHEIV0,
  7852           PGM-NAME,
  7853           DATE-CONVERSION-DATA,
  7854           DC-COMM-LENGTH,
  7855           DFHEIV99,
  7856           DFHEIV99,
  7857           DFHEIV99
  7858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7859
  7860 9900-ERROR-FORMAT.
  7861     IF NOT EMI-ERRORS-COMPLETE
  7862        MOVE LINK-001            TO PGM-NAME
  7863
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL6316.cbl
  7864* EXEC CICS LINK
  7865*           PROGRAM    (PGM-NAME)
  7866*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  7867*           LENGTH     (EMI-COMM-LENGTH)
  7868*       END-EXEC
  7869*    MOVE '."C                   ''   #00007039' TO DFHEIV0
  7870     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7871     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7872     MOVE X'2020233030303037303339' TO DFHEIV0(25:11)
  7873     CALL 'kxdfhei1' USING DFHEIV0,
  7874           PGM-NAME,
  7875           ERROR-MESSAGE-INTERFACE-BLOCK,
  7876           EMI-COMM-LENGTH,
  7877           DFHEIV99,
  7878           DFHEIV99,
  7879           DFHEIV99
  7880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7881     END-IF
  7882     .
  7883 9900-EXIT.
  7884     EXIT.
  7885 9990-ABEND.
  7886     MOVE LINK-004               TO PGM-NAME.
  7887     MOVE DFHEIBLK               TO EMI-LINE1.
  7888
  7889* EXEC CICS LINK
  7890*        PROGRAM   (PGM-NAME)
  7891*        COMMAREA  (EMI-LINE1)
  7892*        LENGTH    (72)
  7893*    END-EXEC.
  7894     MOVE 72
  7895       TO DFHEIV11
  7896*    MOVE '."C                   ''   #00007051' TO DFHEIV0
  7897     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7898     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7899     MOVE X'2020233030303037303531' TO DFHEIV0(25:11)
  7900     CALL 'kxdfhei1' USING DFHEIV0,
  7901           PGM-NAME,
  7902           EMI-LINE1,
  7903           DFHEIV11,
  7904           DFHEIV99,
  7905           DFHEIV99,
  7906           DFHEIV99
  7907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7908
  7909     GO TO 8200-SEND-DATAONLY.
  7910
  7911* GOBACK.
  7912     MOVE '9%                    "   ' TO DFHEIV0
  7913     MOVE 'EL6316' TO DFHEIV1
  7914     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7915     GOBACK.
  7916 9995-SECURITY-VIOLATION.
  7917*                            COPY ELCSCTP.
  7918******************************************************************
  7919*                                                                *
  7920*                            ELCSCTP                             *
  7921*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL6316.cbl
  7922*                                                                *
  7923*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  7924******************************************************************
  7925
  7926
  7927     MOVE EIBDATE          TO SM-JUL-DATE.
  7928     MOVE EIBTRMID         TO SM-TERMID.
  7929     MOVE THIS-PGM         TO SM-PGM.
  7930     MOVE EIBTIME          TO TIME-IN.
  7931     MOVE TIME-OUT         TO SM-TIME.
  7932     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  7933
  7934
  7935* EXEC CICS LINK
  7936*         PROGRAM  ('EL003')
  7937*         COMMAREA (SECURITY-MESSAGE)
  7938*         LENGTH   (80)
  7939*    END-EXEC.
  7940     MOVE 'EL003' TO DFHEIV1
  7941     MOVE 80
  7942       TO DFHEIV11
  7943*    MOVE '."C                   ''   #00007076' TO DFHEIV0
  7944     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7945     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7946     MOVE X'2020233030303037303736' TO DFHEIV0(25:11)
  7947     CALL 'kxdfhei1' USING DFHEIV0,
  7948           DFHEIV1,
  7949           SECURITY-MESSAGE,
  7950           DFHEIV11,
  7951           DFHEIV99,
  7952           DFHEIV99,
  7953           DFHEIV99
  7954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7955
  7956
  7957******************************************************************
  7958
  7959 9995-EXIT.
  7960     EXIT.
  7961
  7962 9999-DFHBACK SECTION.
  7963     MOVE '9%                    "   ' TO DFHEIV0
  7964     MOVE 'EL6316' TO DFHEIV1
  7965     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7966     GOBACK.
  7967 9999-DFHEXIT.
  7968     IF DFHEIGDJ EQUAL 0001
  7969         NEXT SENTENCE
  7970     ELSE IF DFHEIGDJ EQUAL 2
  7971         GO TO 8300-SEND-TEXT
  7972         DEPENDING ON DFHEIGDI.
  7973     MOVE '9%                    "   ' TO DFHEIV0
  7974     MOVE 'EL6316' TO DFHEIV1
  7975     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7976     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL6316.cbl
* Total Messages:     0
* Data:       11016     Code:       17385
