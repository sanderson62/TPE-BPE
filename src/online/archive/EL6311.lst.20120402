* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page   1
* EL6311.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL6311.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page   2
* EL6311.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53******************************************************************
    54
    55 ENVIRONMENT DIVISION.
    56
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page   3
* EL6311.cbl
    58 DATA DIVISION.
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    62 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    63 77  FILLER  PIC X(32)  VALUE '********************************'.
    64 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    65 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    66 77  A1                          PIC S999 COMP-3 VALUE +0.
    67 77  N1                          PIC S999 COMP-3 VALUE +0.
    68 77  N2                          PIC S999 COMP-3 VALUE +0.
    69 77  N3                          PIC S999 COMP-3 VALUE +0.
    70 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    71 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    72 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    73     88  REVERSAL                    VALUE 'Y'.
    74 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    75 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    76 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    77 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    78
    79*    COPY ELCSCTM.
    80******************************************************************
    81*                                                                *
    82*                                                                *
    83*                            ELCSCTM                             *
    84*                            VMOD=2.001                          *
    85*                                                                *
    86*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-MESSAGE.
    90     12  FILLER                          PIC X(30)
    91            VALUE '** LOGIC SECURITY VIOLATION -'.
    92     12  SM-READ                         PIC X(6).
    93     12  FILLER                          PIC X(5)
    94            VALUE ' PGM='.
    95     12  SM-PGM                          PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' OPR='.
    98     12  SM-PROCESSOR-ID                 PIC X(4).
    99     12  FILLER                          PIC X(6)
   100            VALUE ' TERM='.
   101     12  SM-TERMID                       PIC X(4).
   102     12  FILLER                          PIC XX   VALUE SPACE.
   103     12  SM-JUL-DATE                     PIC 9(5).
   104     12  FILLER                          PIC X    VALUE SPACE.
   105     12  SM-TIME                         PIC 99.99.
   106
   107
   108*    COPY ELCSCRTY.
   109******************************************************************
   110*                                                                *
   111*                                                                *
   112*                            ELCSCRTY                            *
   113*                            VMOD=2.001                          *
   114*                                                                *
   115*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page   4
* EL6311.cbl
   116*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   117*        SAVED IN PI-SECURITY-ADDRESS.                           *
   118*                                                                *
   119******************************************************************
   120 01  SECURITY-CONTROL.
   121     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   122     12  FILLER                       PIC XX    VALUE 'SC'.
   123     12  SC-CREDIT-CODES.
   124         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   125             20  SC-CREDIT-DISPLAY    PIC X.
   126             20  SC-CREDIT-UPDATE     PIC X.
   127     12  SC-CLAIMS-CODES.
   128         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   129             20  SC-CLAIMS-DISPLAY    PIC X.
   130             20  SC-CLAIMS-UPDATE     PIC X.
   131
   132 01  WS-VA-NO-COMM-MESS.
   133     12  FILLER                  PIC X(41) VALUE
   134        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   135 01  WS-OC-MESSAGE.
   136     12  FILLER                  PIC X(43) VALUE
   137        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   138     12  WS-OC-DIS-AMT           PIC -----9.99.
   139     12  FILLER                  PIC X(4) VALUE ' ON '.
   140     12  WS-OC-DATE              PIC X(10).
   141 01  WS-DATE-AREA.
   142     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   143     12  WS-CURRENT-DT.
   144         16  FILLER              PIC X(6)    VALUE SPACES.
   145         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   146     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   147     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   148     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   149
   150 01  STANDARD-AREAS.
   151     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   152     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   153     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   154     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   155     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   156     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   157     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   158     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   159     12  PGM-NAME                PIC X(8).
   160     12  TIME-IN                 PIC S9(7).
   161     12  TIME-OUT-R  REDEFINES TIME-IN.
   162         16  FILLER              PIC X.
   163         16  TIME-OUT            PIC 99V99.
   164         16  FILLER              PIC XX.
   165     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   166     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   167     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   168     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   169     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   170     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   171     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   172     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   173     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page   5
* EL6311.cbl
   174     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   175     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   176     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   177     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   178     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   179     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   180     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   181     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   182     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   183     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   184     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   185     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   186     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   187     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   188     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   189     12  FILE-ID                 PIC X(8).
   190     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   191     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   192     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   193     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   194     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   195     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   196     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   197     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   198     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   199     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   200     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   201     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   202
   203     01  WS-PASS-AREA.
   204         05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +585.
   205         05  WS-PENDING-REC      PIC X(585).
   206
   207******************************************************************
   208*                                                                *
   209*              A C C E S S   K E Y S                             *
   210*                                                                *
   211******************************************************************
   212
   213 01  ACCESS-KEYS.
   214     12  ERPYAJ-KEY.
   215         16  ERPYAJ-COMPANY-CD       PIC X.
   216         16  ERPYAJ-CARRIER          PIC X.
   217         16  ERPYAJ-GROUPING         PIC X(6).
   218         16  ERPYAJ-FIN-RESP         PIC X(10).
   219         16  ERPYAJ-ACCOUNT          PIC X(10).
   220         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   221         16  ERPYAJ-TYPE             PIC X.
   222     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   223     12  ELCERT-KEY.
   224         16  ELCERT-COMPANY-CD       PIC X.
   225         16  ELCERT-CARRIER          PIC X.
   226         16  ELCERT-GROUPING         PIC X(6).
   227         16  ELCERT-STATE            PIC XX.
   228         16  ELCERT-ACCOUNT          PIC X(10).
   229         16  ELCERT-CERT-EFF-DT      PIC XX.
   230         16  ELCERT-CERT-NO.
   231             20  ELCERT-CERT-PRIME   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page   6
* EL6311.cbl
   232             20  ELCERT-CERT-SFX     PIC X.
   233
   234     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   235     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   236
   237     12  ERPNDB-KEY.
   238         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   239         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   240         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   241         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   242             ERPNDB-BATCH-SEQ-NO     PIC XX.
   243         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   244
   245     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   246     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   247
   248     12  ERPNDM-KEY.
   249         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   250         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   251         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   252         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   253
   254*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   255     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   256*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   257     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   258
   259     12  ERPNDB-ALT-KEY.
   260         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   261         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   262         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   263         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   264         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   265         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   266         16  ERPNDB-CERT-NO.
   267             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   268             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   269         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   270         16  ERPNDB-RECORD-TYPE      PIC X.
   271
   272      12  ERPNDB-CSR-KEY.
   273          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   274          20  ERPNDB-CSR-ID                PIC X(4).
   275          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   276          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   277          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   278
   279     12  ERNOTE-KEY.
   280         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   281         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   282         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   283         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   284         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   285         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   286         16  ERNOTE-CERT-NO.
   287             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   288             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   289
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page   7
* EL6311.cbl
   290     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   291     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   292
   293     12  ERCNOT-KEY.
   294         16  ERCNOT-PART-KEY.
   295             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   296             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   297             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   298             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   299             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   300             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   301             20  ERCNOT-CERT-NO.
   302                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   303                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   304         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   305         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   306
   307     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   308     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   309
   310     12  ERMAIL-KEY.
   311         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   312         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   313         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   314         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   315         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   316         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   317         16  ERMAIL-CERT-NO.
   318             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   319             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   320
   321     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   322     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   323
   324     12  ERRQST-KEY.
   325         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   326         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   327
   328     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   329     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   330
   331     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   332
   333     12  ERLOFC-KEY.
   334         16  ERLOFC-COMPANY-CD          PIC  X.
   335         16  ERLOFC-CARRIER             PIC  X.
   336         16  ERLOFC-GROUPING            PIC  X(6).
   337         16  ERLOFC-STATE               PIC  XX.
   338         16  ERLOFC-ACCOUNT             PIC  X(10).
   339         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   340*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   341
   342     12  ERACCT-KEY.
   343         16  ERACCT-COMPANY-CD          PIC  X.
   344         16  ERACCT-CARRIER             PIC  X.
   345         16  ERACCT-GROUPING            PIC  X(6).
   346         16  ERACCT-STATE               PIC  XX.
   347         16  ERACCT-ACCOUNT             PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page   8
* EL6311.cbl
   348         16  ERACCT-EXP-DT.
   349             20  ERACCT-DT              PIC  XX.
   350             20  ERACCT-FILL            PIC  X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page   9
* EL6311.cbl
   352
   353******************************************************************
   354*                                                                *
   355*            G E N E R A L   W O R K   A R E A                   *
   356*                                                                *
   357******************************************************************
   358
   359 01  WORK-AREA.
   360     12  WS-RESPONSE             PIC S9(8)   COMP.
   361         88  RESP-NORMAL                  VALUE +00.
   362         88  RESP-NOTFND                  VALUE +13.
   363         88  RESP-DUPREC                  VALUE +14.
   364         88  RESP-DUPKEY                  VALUE +15.
   365         88  RESP-NOTOPEN                 VALUE +19.
   366         88  RESP-ENDFILE                 VALUE +20.
   367     12  DEEDIT-FIELD            PIC X(15).
   368     12  FILLER          REDEFINES DEEDIT-FIELD.
   369         16  FILLER              PIC X(4).
   370         16  DEEDIT-FIELD-X11    PIC X(11).
   371     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   372                                 PIC S9(15).
   373     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   374                                 PIC S9(13)V99.
   375     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   376                                 PIC S9(11)V9999.
   377     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   378     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   379     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   380         16  WS-CALC-TERM-WHOLE  PIC S999.
   381         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   382
   383     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   384     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   385         16  WS-HR-MINS          PIC 99V99.
   386         16  FILLER              PIC XX.
   387
   388     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   389     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   390
   391     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   392     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   393
   394     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   395     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   396     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   397     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   398     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   399     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   400     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   401
   402     12  QID.
   403         16  QID-TERM            PIC X(4).
   404         16  FILLER              PIC X(4)    VALUE '607B'.
   405
   406     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   407         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   408
   409     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  10
* EL6311.cbl
   410         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   411
   412     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   413         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'.
   414
   415     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   416
   417     12  WS-NUMERIC-SW           PIC X.
   418        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   419
   420     12  WS-EDIT-CSO-FIELD.
   421         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   422                                 PIC X.
   423
   424     12  WS-SAVE-INPUT-FIELDS.
   425         16  WS-BAGE             PIC 99       VALUE ZERO.
   426*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   427         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   428         16  FILLER REDEFINES WS-BAPR.
   429             20  WS-APR-WHOLE-NUM    PIC 99.
   430             20  WS-APR-DEC          PIC 9999.
   431         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   432         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   433
   434         16  WS-B-COVERAGE OCCURS 2 TIMES.
   435             20  WS-TERM-IN-DAYS-SW  PIC X.
   436                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   437             20  WS-BTERM        PIC 999       COMP-3.
   438             20  WS-BALT-TERM    PIC 999       COMP-3.
   439             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   440             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   441             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   442             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   443             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   444             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   445
   446         16  WS-C-FIELDS COMP-3.
   447             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   448             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   449             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   450
   451         16  WS-D-FIELDS COMP-3.
   452             20  WS-DRISS        PIC S9(5)    VALUE +0.
   453             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   454             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   455             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   456             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   457             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   458
   459     12  WS-SAVE-BIRTH-DATE.
   460         16  FILLER              PIC X(4)   VALUE SPACES.
   461         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   462
   463     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   464     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   465     12  FILLER REDEFINES WS-WORK-BIN-RED.
   466         16  FILLER              PIC X(02).
   467         16  WS-WORK-BIN-DT      PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  11
* EL6311.cbl
   468     12  WS-SW-1                 PIC X     VALUE SPACE.
   469     12  WS-SW-2                 PIC X     VALUE SPACE.
   470     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   471         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   472     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   473         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   474
   475     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   476     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   477     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   478     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   479     12  WS-CONVERTED-CANCEL-DATES.
   480         16  WS-CONVERTED-CANDT1                  PIC XX.
   481         16  WS-CONVERTED-CANDT2                  PIC XX.
   482
   483     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   484
   485     12  WS-REC-FOUND-SW         PIC X.
   486         88  RECORD-NOT-FOUND    VALUE 'N'.
   487
   488     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   489         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   490         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   491
   492     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   493         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   494         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   495
   496     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   497         88  BROWSE-STARTED      VALUE 'Y'.
   498
   499     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   500         88  FIRST-TIME          VALUE 'Y'.
   501
   502     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   503         88  FIRST-ENTRY         VALUE 'Y'.
   504
   505     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   506         88  REC-BILLED          VALUE 'Y'.
   507
   508     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   509         88  NO-CURSOR-SET       VALUE +0.
   510         88  CURSOR-SET          VALUE +1.
   511
   512     12  WS-ERR-SW               PIC X.
   513         88  STD-ERRORS          VALUE 'S'.
   514         88  TRN-ERRORS          VALUE 'T'.
   515
   516     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   517         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   518
   519     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   520         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   521
   522     12  WS-ERR-CODE.
   523         16  FILLER              PIC 99.
   524         16  WS-ERROR-SUB        PIC 99.
   525
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  12
* EL6311.cbl
   526     12  WS-DATE-WORK.
   527         16  WS-WORK-MM          PIC XX.
   528         16  WS-WORK-DD          PIC XX.
   529         16  WS-WORK-YY          PIC XX.
   530
   531     12  WS-MM-YY.
   532         16  WS-MM               PIC XX.
   533         16  FILLER              PIC X     VALUE '/'.
   534         16  WS-YY               PIC XX.
   535
   536     12  WS-CERT-EFF-DT          PIC XX.
   537
   538     12  WS-MEMBER-NO            PIC X(12).
   539     12  FILLER  REDEFINES  WS-MEMBER-NO.
   540         16  WS-MEMBER-NO-1-8    PIC 9(8).
   541         16  FILLER              PIC X(4).
   542
   543     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   544
   545     12  WS-ERPNDB-ALT-KEY.
   546         16  WS-PB-COMPANY-CD-A1         PIC X.
   547         16  WS-PB-CARRIER               PIC X.
   548         16  WS-PB-GROUPING              PIC X(6).
   549         16  WS-PB-STATE                 PIC XX.
   550         16  WS-PB-ACCOUNT               PIC X(10).
   551         16  WS-PB-CERT-EFF-DT           PIC XX.
   552         16  WS-PB-CERT-NO.
   553             20  WS-PB-CERT-PRIME        PIC X(10).
   554             20  WS-PB-CERT-SFX          PIC X.
   555         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   556         16  WS-PB-RECORD-TYPE           PIC X.
   557
   558     12  WS-SHOW-SAVE-AREAS.
   559         16  WS-NEW-CERT-NO.
   560             20  WS-NEW-PRIME    PIC X(10).
   561             20  WS-NEW-SUFFIX   PIC X.
   562         16  WS-NEW-CERT-EFF-DT  PIC XX.
   563         16  WS-NEW-RECORD-TYPE  PIC X.
   564         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   565             88   SHOW-RECORD            VALUE 'Y'.
   566
   567     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   568
   569     12  WS-BATCH-NO.
   570         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   571         16  FILLER              PIC X(5) VALUE SPACES.
   572
   573     12  WS-FIRST-NAME.
   574         16  WS-1ST-INIT         PIC X.
   575         16  FILLER              PIC X(9).
   576
   577     12  WS-INITIALS.
   578         16  WS-INITIAL-1        PIC X.
   579         16  WS-INITIAL-2        PIC X.
   580
   581     12  WS-C-HDG.
   582         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   583         16  FILLER              PIC X(4) VALUE '-REF'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  13
* EL6311.cbl
   584
   585     12  WS-D-PREM-HDG.
   586         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   587         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   588
   589     12  WS-D-REFUND-HDG.
   590         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   591         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   592
   593     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   594
   595     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   596     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   597     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   598     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   599     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   600     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   601     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   602
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  14
* EL6311.cbl
   604
   605******************************************************************
   606*                                                                *
   607*                 B A T C H   T O T A L S                        *
   608*                                                                *
   609******************************************************************
   610
   611     12  WS-BATCH-RECORD.
   612         16  FILLER                       PIC X(10).
   613         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   614         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   615         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   616         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   617         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   618         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   619         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   620         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   621         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   622         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   623         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   624         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   625         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   626         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   627         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   628         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   629         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   630         16  WS-ACCOUNT-NAME              PIC X(30).
   631         16  FILLER                       PIC X.
   632         16  WS-REFERENCE                 PIC X(12).
   633         16  FILLER                       PIC X(197).
   634
   635     12  WS-BATCH-TOTALS.
   636         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   637         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   638         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   639         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   640         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   641         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   642         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   643         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   644         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   645         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   646         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   647         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   648         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   649         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   650         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   651         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   652         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   653         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   654         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   655
   656     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   657
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  15
* EL6311.cbl
   659
   660******************************************************************
   661*                                                                *
   662*                E R R O R   M E S S A G E S                     *
   663*                                                                *
   664******************************************************************
   665
   666 01  ERROR-MESSAGES.
   667     12  ER-0004                 PIC  9(4) VALUE 0004.
   668     12  ER-0008                 PIC  9(4) VALUE 0008.
   669     12  ER-0023                 PIC  9(4) VALUE 0023.
   670     12  ER-0029                 PIC  9(4) VALUE 0029.
   671     12  ER-0033                 PIC  9(4) VALUE 0033.
   672     12  ER-0070                 PIC  9(4) VALUE 0070.
   673     12  ER-0220                 PIC  9(4) VALUE 0220.
   674     12  ER-0248                 PIC  9(4) VALUE 0248.
   675     12  ER-0348                 PIC  9(4) VALUE 0348.
   676     12  ER-0582                 PIC  9(4) VALUE 0582.
   677     12  ER-0877                 PIC  9(4) VALUE 0877.
   678     12  ER-1570                 PIC  9(4) VALUE 1570.
   679     12  ER-1575                 PIC  9(4) VALUE 1575.
   680     12  ER-2129                 PIC  9(4) VALUE 2129.
   681     12  ER-2188                 PIC  9(4) VALUE 2188.
   682     12  ER-2192                 PIC  9(4) VALUE 2192.
   683     12  ER-2196                 PIC  9(4) VALUE 2196.
   684     12  ER-2197                 PIC  9(4) VALUE 2197.
   685     12  ER-2198                 PIC  9(4) VALUE 2198.
   686     12  ER-2200                 PIC  9(4) VALUE 2200.
   687     12  ER-2212                 PIC  9(4) VALUE 2212.
   688     12  ER-2218                 PIC  9(4) VALUE 2218.
   689     12  ER-2220                 PIC  9(4) VALUE 2220.
   690     12  ER-2222                 PIC  9(4) VALUE 2222.
   691     12  ER-2223                 PIC  9(4) VALUE 2223.
   692     12  ER-2224                 PIC  9(4) VALUE 2224.
   693     12  ER-2225                 PIC  9(4) VALUE 2225.
   694     12  ER-2226                 PIC  9(4) VALUE 2226.
   695     12  ER-2227                 PIC  9(4) VALUE 2227.
   696     12  ER-2228                 PIC  9(4) VALUE 2228.
   697     12  ER-2240                 PIC  9(4) VALUE 2240.
   698     12  ER-2241                 PIC  9(4) VALUE 2241.
   699     12  ER-2242                 PIC  9(4) VALUE 2242.
   700     12  ER-2243                 PIC  9(4) VALUE 2243.
   701     12  ER-2244                 PIC  9(4) VALUE 2244.
   702     12  ER-2245                 PIC  9(4) VALUE 2245.
   703     12  ER-2246                 PIC  9(4) VALUE 2246.
   704     12  ER-2247                 PIC  9(4) VALUE 2247.
   705     12  ER-2251                 PIC  9(4) VALUE 2251.
   706     12  ER-2252                 PIC  9(4) VALUE 2252.
   707     12  ER-2253                 PIC  9(4) VALUE 2253.
   708     12  ER-2254                 PIC  9(4) VALUE 2254.
   709     12  ER-2255                 PIC  9(4) VALUE 2255.
   710     12  ER-2256                 PIC  9(4) VALUE 2256.
   711     12  ER-2257                 PIC  9(4) VALUE 2257.
   712     12  ER-2258                 PIC  9(4) VALUE 2258.
   713     12  ER-2259                 PIC  9(4) VALUE 2259.
   714     12  ER-2260                 PIC  9(4) VALUE 2260.
   715     12  ER-2261                 PIC  9(4) VALUE 2261.
   716     12  ER-2287                 PIC  9(4) VALUE 2287.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  16
* EL6311.cbl
   717     12  ER-2336                 PIC  9(4) VALUE 2336.
   718     12  ER-2337                 PIC  9(4) VALUE 2337.
   719     12  ER-2437                 PIC  9(4) VALUE 2437.
   720     12  ER-2471                 PIC  9(4) VALUE 2471.
   721     12  ER-2530                 PIC  9(4) VALUE 2530.
   722     12  ER-2531                 PIC  9(4) VALUE 2531.
   723     12  ER-2532                 PIC  9(4) VALUE 2532.
   724     12  ER-2533                 PIC  9(4) VALUE 2533.
   725     12  ER-2547                 PIC  9(4) VALUE 2547.
   726     12  ER-2591                 PIC  9(4) VALUE 2591.
   727     12  ER-2592                 PIC  9(4) VALUE 2592.
   728     12  ER-2593                 PIC  9(4) VALUE 2593.
   729     12  ER-2600                 PIC  9(4) VALUE 2600.
   730     12  ER-2601                 PIC  9(4) VALUE 2601.
   731     12  ER-2604                 PIC  9(4) VALUE 2604.
   732     12  ER-2605                 PIC  9(4) VALUE 2605.
   733     12  ER-2606                 PIC  9(4) VALUE 2606.
   734     12  ER-2607                 PIC  9(4) VALUE 2607.
   735     12  ER-2622                 PIC  9(4) VALUE 2622.
   736     12  ER-2625                 PIC  9(4) VALUE 2625.
   737     12  ER-2626                 PIC  9(4) VALUE 2626.
   738     12  ER-2627                 PIC  9(4) VALUE 2627.
   739     12  ER-2628                 PIC  9(4) VALUE 2628.
   740     12  ER-2629                 PIC  9(4) VALUE 2629.
   741     12  ER-2630                 PIC  9(4) VALUE 2630.
   742     12  ER-2631                 PIC  9(4) VALUE 2631.
   743     12  ER-2632                 PIC  9(4) VALUE 2632.
   744     12  ER-2633                 PIC  9(4) VALUE 2633.
   745     12  ER-2634                 PIC  9(4) VALUE 2634.
   746     12  ER-2635                 PIC  9(4) VALUE 2635.
   747     12  ER-2636                 PIC  9(4) VALUE 2636.
   748     12  ER-2639                 PIC  9(4) VALUE 2639.
   749     12  ER-2640                 PIC  9(4) VALUE 2640.
   750     12  ER-2647                 PIC  9(4) VALUE 2647.
   751     12  ER-2648                 PIC  9(4) VALUE 2648.
   752     12  ER-2649                 PIC  9(4) VALUE 2649.
   753     12  ER-2650                 PIC  9(4) VALUE 2650.
   754     12  ER-2653                 PIC  9(4) VALUE 2653.
   755     12  ER-2654                 PIC  9(4) VALUE 2654.
   756     12  ER-2655                 PIC  9(4) VALUE 2655.
   757     12  ER-2656                 PIC  9(4) VALUE 2656.
   758     12  ER-2657                 PIC  9(4) VALUE 2657.
   759     12  ER-2660                 PIC  9(4) VALUE 2660.
   760     12  ER-2662                 PIC  9(4) VALUE 2662.
   761     12  ER-2663                 PIC  9(4) VALUE 2663.
   762     12  ER-2664                 PIC  9(4) VALUE 2664.
   763     12  ER-2667                 PIC  9(4) VALUE 2667.
   764     12  ER-2668                 PIC  9(4) VALUE 2668.
   765     12  ER-2669                 PIC  9(4) VALUE 2669.
   766     12  ER-2670                 PIC  9(4) VALUE 2670.
   767     12  ER-2671                 PIC  9(4) VALUE 2671.
   768     12  ER-2672                 PIC  9(4) VALUE 2672.
   769     12  ER-2673                 PIC  9(4) VALUE 2673.
   770     12  ER-2677                 PIC  9(4) VALUE 2677.
   771     12  ER-2678                 PIC  9(4) VALUE 2678.
   772     12  ER-2679                 PIC  9(4) VALUE 2679.
   773     12  ER-2680                 PIC  9(4) VALUE 2680.
   774     12  ER-2681                 PIC  9(4) VALUE 2681.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  17
* EL6311.cbl
   775     12  ER-2682                 PIC  9(4) VALUE 2682.
   776     12  ER-2683                 PIC  9(4) VALUE 2683.
   777     12  ER-2684                 PIC  9(4) VALUE 2684.
   778     12  ER-2686                 PIC  9(4) VALUE 2686.
   779     12  ER-2689                 PIC  9(4) VALUE 2689.
   780     12  ER-2690                 PIC  9(4) VALUE 2690.
   781     12  ER-2693                 PIC  9(4) VALUE 2693.
   782     12  ER-2695                 PIC  9(4) VALUE 2695.
   783     12  ER-2701                 PIC  9(4) VALUE 2701.
   784     12  ER-2720                 PIC  9(4) VALUE 2720.
   785     12  ER-2709                 PIC  9(4) VALUE 2709.
   786     12  ER-2704                 PIC  9(4) VALUE 2704.
   787     12  ER-2725                 PIC  9(4) VALUE 2725.
   788     12  ER-2726                 PIC  9(4) VALUE 2726.
   789     12  ER-2728                 PIC  9(4) VALUE 2728.
   790     12  ER-2729                 PIC  9(4) VALUE 2729.
   791     12  ER-2731                 PIC  9(4) VALUE 2731.
   792     12  ER-2732                 PIC  9(4) VALUE 2732.
   793     12  ER-2733                 PIC  9(4) VALUE 2733.
   794     12  ER-2735                 PIC  9(4) VALUE 2735.
   795     12  ER-2738                 PIC  9(4) VALUE 2738.
   796     12  ER-2742                 PIC  9(4) VALUE 2742.
   797     12  ER-2743                 PIC  9(4) VALUE 2743.
   798     12  ER-2744                 PIC  9(4) VALUE 2744.
   799     12  ER-2747                 PIC  9(4) VALUE 2747.
   800     12  ER-2749                 PIC  9(4) VALUE 2749.
   801     12  ER-2753                 PIC  9(4) VALUE 2753.
   802     12  ER-2755                 PIC  9(4) VALUE 2755.
   803     12  ER-2757                 PIC  9(4) VALUE 2757.
   804     12  ER-2771                 PIC  9(4) VALUE 2771.
   805     12  ER-2774                 PIC  9(4) VALUE 2774.
   806     12  ER-2775                 PIC  9(4) VALUE 2775.
   807     12  ER-2776                 PIC  9(4) VALUE 2776.
   808     12  ER-2777                 PIC  9(4) VALUE 2777.
   809     12  ER-2794                 PIC  9(4) VALUE 2794.
   810     12  ER-2799                 PIC  9(4) VALUE 2799.
   811     12  ER-2900                 PIC  9(4) VALUE 2900.
   812     12  ER-2902                 PIC  9(4) VALUE 2902.
   813     12  ER-2945                 PIC  9(4) VALUE 2945.
   814     12  ER-3006                 PIC  9(4) VALUE 3006.
   815     12  ER-3224                 PIC  9(4) VALUE 3224.
   816     12  ER-4005                 PIC  9(4) VALUE 4005.
   817     12  ER-7401                 PIC  9(4) VALUE 7401.
   818     12  ER-7402                 PIC  9(4) VALUE 7402.
   819     12  ER-7403                 PIC  9(4) VALUE 7403.
   820     12  ER-7404                 PIC  9(4) VALUE 7404.
   821     12  ER-7423                 PIC  9(4) VALUE 7423.
   822     12  ER-7424                 PIC  9(4) VALUE 7424.
   823     12  ER-7433                 PIC  9(4) VALUE 7433.
   824     12  ER-7450                 PIC  9(4) VALUE 7450.
   825     12  ER-7451                 PIC  9(4) VALUE 7451.
   826     12  ER-7530                 PIC  9(4) VALUE 7530.
   827     12  ER-7573                 PIC  9(4) VALUE 7573.
   828     12  ER-7631                 PIC  9(4) VALUE 7631.
   829     12  ER-7632                 PIC  9(4) VALUE 7632.
   830     12  ER-7633                 PIC  9(4) VALUE 7633.
   831     12  ER-7574                 PIC  9(4) VALUE 7574.
   832     12  ER-7997                 PIC  9(4) VALUE 7997.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  18
* EL6311.cbl
   833     12  ER-7998                 PIC  9(4) VALUE 7998.
   834     12  ER-8148                 PIC  9(4) VALUE 8148.
   835     12  ER-9841                 PIC  9(4) VALUE 9841.
   836
   837*                                COPY ERCACCT.
   838******************************************************************
   839*                                                                *
   840*                                                                *
   841*                            ERCACCT                             *
   842*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   843*                            VMOD=2.031                          *
   844*                                                                *
   845*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   846*                                                                *
   847*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   848*   VSAM ACCOUNT MASTER FILES.                                   *
   849*                                                                *
   850*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   851*                                                                *
   852*   FILE TYPE = VSAM,KSDS                                        *
   853*   RECORD SIZE = 2000  RECFORM = FIX                            *
   854*                                                                *
   855*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   856*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   857*                                                                *
   858*   LOG = NO                                                     *
   859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   860*                                                                *
   861*                                                                *
   862******************************************************************
   863*                   C H A N G E   L O G
   864*
   865* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   866*-----------------------------------------------------------------
   867*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   868* EFFECTIVE    NUMBER
   869*-----------------------------------------------------------------
   870* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   871* 092705    2005050300006  PEMA  ADD SPP LEASES
   872* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   873* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   874* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   875******************************************************************
   876
   877 01  ACCOUNT-MASTER.
   878     12  AM-RECORD-ID                      PIC XX.
   879         88  VALID-AM-ID                      VALUE 'AM'.
   880
   881     12  AM-CONTROL-PRIMARY.
   882         16  AM-COMPANY-CD                 PIC X.
   883         16  AM-MSTR-CNTRL.
   884             20  AM-CONTROL-A.
   885                 24  AM-CARRIER            PIC X.
   886                 24  AM-GROUPING.
   887                     28 AM-GROUPING-PREFIX PIC XXX.
   888                     28 AM-GROUPING-PRIME  PIC XXX.
   889                 24  AM-STATE              PIC XX.
   890                 24  AM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  19
* EL6311.cbl
   891                     28  AM-ACCOUNT-PREFIX PIC X(4).
   892                     28  AM-ACCOUNT-PRIME  PIC X(6).
   893             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   894                                           PIC X(19).
   895             20  AM-CNTRL-B.
   896                 24  AM-EXPIRATION-DT      PIC XX.
   897                 24  FILLER                PIC X(4).
   898             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   899                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   900
   901     12  AM-CONTROL-BY-VAR-GRP.
   902         16  AM-COMPANY-CD-A1              PIC X.
   903         16  AM-VG-CARRIER                 PIC X.
   904         16  AM-VG-GROUPING                PIC X(6).
   905         16  AM-VG-STATE                   PIC XX.
   906         16  AM-VG-ACCOUNT                 PIC X(10).
   907         16  AM-VG-DATE.
   908             20  AM-VG-EXPIRATION-DT       PIC XX.
   909             20  FILLER                    PIC X(4).
   910         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   911                                           PIC 9(11)      COMP-3.
   912     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   913         16  FILLER                        PIC X(10).
   914         16  AM-VG-KEY3.
   915             20  AM-VG3-ACCOUNT            PIC X(10).
   916             20  AM-VG3-EXP-DT             PIC XX.
   917         16  FILLER                        PIC X(4).
   918     12  AM-MAINT-INFORMATION.
   919         16  AM-LAST-MAINT-DT              PIC XX.
   920         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   921         16  AM-LAST-MAINT-USER            PIC X(4).
   922         16  FILLER                        PIC XX.
   923
   924     12  AM-EFFECTIVE-DT                   PIC XX.
   925     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   926
   927     12  AM-PREV-DATES  COMP-3.
   928         16  AM-PREV-EXP-DT                PIC 9(11).
   929         16  AM-PREV-EFF-DT                PIC 9(11).
   930
   931     12  AM-REPORT-CODE-1                  PIC X(10).
   932     12  AM-REPORT-CODE-2                  PIC X(10).
   933
   934     12  AM-CITY-CODE                      PIC X(4).
   935     12  AM-COUNTY-PARISH                  PIC X(6).
   936
   937     12  AM-NAME                           PIC X(30).
   938     12  AM-PERSON                         PIC X(30).
   939     12  AM-ADDRS                          PIC X(30).
   940     12  AM-CITY.
   941         16  AM-ADDR-CITY                  PIC X(28).
   942         16  AM-ADDR-STATE                 PIC XX.
   943     12  AM-ZIP.
   944         16  AM-ZIP-PRIME.
   945             20  AM-ZIP-PRI-1ST            PIC X.
   946                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   947             20  FILLER                    PIC X(4).
   948         16  AM-ZIP-PLUS4                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  20
* EL6311.cbl
   949     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   950         16  AM-CAN-POSTAL-1               PIC XXX.
   951         16  AM-CAN-POSTAL-2               PIC XXX.
   952         16  FILLER                        PIC XXX.
   953     12  AM-TEL-NO.
   954         16  AM-AREA-CODE                  PIC 999.
   955         16  AM-TEL-PRE                    PIC 999.
   956         16  AM-TEL-NBR                    PIC 9(4).
   957     12  AM-TEL-LOC                        PIC X.
   958         88  AM-TEL-AT-HOME                   VALUE 'H'.
   959         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   960
   961     12  AM-COMM-STRUCTURE.
   962         16  AM-DEFN-1.
   963             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   964                 24  AM-AGT.
   965                     28  AM-AGT-PREFIX     PIC X(4).
   966                     28  AM-AGT-PRIME      PIC X(6).
   967                 24  AM-COM-TYP            PIC X.
   968                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   969                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   970                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   971                 24  AM-RECALC-LV-INDIC    PIC X.
   972                 24  AM-RETRO-LV-INDIC     PIC X.
   973                 24  AM-GL-CODES           PIC X.
   974                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   975                 24  FILLER                PIC X(01).
   976         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   977             20  AM-COM-TBLS        OCCURS 10 TIMES.
   978                 24  FILLER                PIC X(11).
   979                 24  AM-L-COMA             PIC XXX.
   980                 24  AM-J-COMA             PIC XXX.
   981                 24  AM-A-COMA             PIC XXX.
   982                 24  FILLER                PIC X(6).
   983
   984     12  AM-COMM-CHANGE-STATUS             PIC X.
   985         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   986
   987     12  AM-CSR-CODE                       PIC X(4).
   988
   989     12  AM-BILLING-STATUS                 PIC X.
   990         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   991         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   992     12  AM-AUTO-REFUND-SW                 PIC X.
   993         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   994         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   995     12  AM-GPCD                           PIC 99.
   996     12  AM-IG                             PIC X.
   997         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   998         88  AM-HAS-GROUP                     VALUE '2'.
   999     12  AM-STATUS                         PIC X.
  1000         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1001         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1002         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1003         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1004         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1005     12  AM-REMIT-TO                       PIC 99.
  1006     12  AM-ID-NO                          PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  21
* EL6311.cbl
  1007
  1008     12  AM-CAL-TABLE                      PIC XX.
  1009     12  AM-LF-DEVIATION                   PIC XXX.
  1010     12  AM-AH-DEVIATION                   PIC XXX.
  1011     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1012     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1013     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1014     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1015     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1016     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1017
  1018     12  AM-USER-FIELDS.
  1019         16  AM-FLD-1                      PIC XX.
  1020         16  AM-FLD-2                      PIC XX.
  1021         16  AM-FLD-3                      PIC XX.
  1022         16  AM-FLD-4                      PIC XX.
  1023         16  AM-FLD-5                      PIC XX.
  1024
  1025     12  AM-1ST-PROD-DATE.
  1026         16  AM-1ST-PROD-YR                PIC XX.
  1027         16  AM-1ST-PROD-MO                PIC XX.
  1028         16  AM-1ST-PROD-DA                PIC XX.
  1029     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1030     12  AM-CERTS-PURGED-DATE.
  1031         16  AM-PUR-YR                     PIC XX.
  1032         16  AM-PUR-MO                     PIC XX.
  1033         16  AM-PUR-DA                     PIC XX.
  1034     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1035     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1036     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1037     12  AM-INACTIVE-DATE.
  1038         16  AM-INA-MO                     PIC 99.
  1039         16  AM-INA-DA                     PIC 99.
  1040         16  AM-INA-YR                     PIC 99.
  1041     12  AM-AR-HI-CERT-DATE                PIC XX.
  1042
  1043     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1044     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1045
  1046     12  AM-OB-PAYMENT-MODE                PIC X.
  1047         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1048         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1049         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1050         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1051
  1052     12  AM-AH-ONLY-INDICATOR              PIC X.
  1053         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1054         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1055
  1056     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1057
  1058     12  AM-OVER-SHORT.
  1059         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1060         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1061
  1062     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1063     12  AM-DCC-CLP-STATE                  PIC XX.
  1064
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  22
* EL6311.cbl
  1065     12  AM-RECALC-COMM                    PIC X.
  1066     12  AM-RECALC-REIN                    PIC X.
  1067
  1068     12  AM-REI-TABLE                      PIC XXX.
  1069     12  AM-REI-ET-LF                      PIC X.
  1070     12  AM-REI-ET-AH                      PIC X.
  1071     12  AM-REI-PE-LF                      PIC X.
  1072     12  AM-REI-PE-AH                      PIC X.
  1073     12  AM-REI-PRT-ST                     PIC X.
  1074     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1075     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1076     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1077     12  AM-REI-GROUP-A                    PIC X(6).
  1078     12  AM-REI-MORT                       PIC X(4).
  1079     12  AM-REI-PRT-OW                     PIC X.
  1080     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1081     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1082     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1083     12  AM-REI-GROUP-B                    PIC X(6).
  1084
  1085     12  AM-TRUST-TYPE                     PIC X(2).
  1086
  1087     12  AM-EMPLOYER-STMT-USED             PIC X.
  1088     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1089
  1090     12  AM-STD-AH-TYPE                    PIC XX.
  1091     12  AM-EARN-METHODS.
  1092         16  AM-EARN-METHOD-R              PIC X.
  1093             88 AM-REF-RL-R78                 VALUE 'R'.
  1094             88 AM-REF-RL-PR                  VALUE 'P'.
  1095             88 AM-REF-RL-MEAN                VALUE 'M'.
  1096             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1097         16  AM-EARN-METHOD-L              PIC X.
  1098             88 AM-REF-LL-R78                 VALUE 'R'.
  1099             88 AM-REF-LL-PR                  VALUE 'P'.
  1100             88 AM-REF-LL-MEAN                VALUE 'M'.
  1101             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1102         16  AM-EARN-METHOD-A              PIC X.
  1103             88 AM-REF-AH-R78                 VALUE 'R'.
  1104             88 AM-REF-AH-PR                  VALUE 'P'.
  1105             88 AM-REF-AH-MEAN                VALUE 'M'.
  1106             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1107             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1108             88 AM-REF-AH-NET                 VALUE 'N'.
  1109
  1110     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1111     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1112     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1113
  1114     12  AM-RET-Y-N                        PIC X.
  1115     12  AM-RET-P-E                        PIC X.
  1116     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1117     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1118     12  AM-RET-GRP                        PIC X(6).
  1119     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1120         16  AM-POOL-PRIME                 PIC XXX.
  1121         16  AM-POOL-SUB                   PIC XXX.
  1122     12  AM-RETRO-EARNINGS.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  23
* EL6311.cbl
  1123         16  AM-RET-EARN-R                 PIC X.
  1124         16  AM-RET-EARN-L                 PIC X.
  1125         16  AM-RET-EARN-A                 PIC X.
  1126     12  AM-RET-ST-TAX-USE                 PIC X.
  1127         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1128         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1129     12  AM-RETRO-BEG-EARNINGS.
  1130         16  AM-RET-BEG-EARN-R             PIC X.
  1131         16  AM-RET-BEG-EARN-L             PIC X.
  1132         16  AM-RET-BEG-EARN-A             PIC X.
  1133     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1134     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1135
  1136     12  AM-USER-SELECT-OPTIONS.
  1137         16  AM-USER-SELECT-1              PIC X(10).
  1138         16  AM-USER-SELECT-2              PIC X(10).
  1139         16  AM-USER-SELECT-3              PIC X(10).
  1140         16  AM-USER-SELECT-4              PIC X(10).
  1141         16  AM-USER-SELECT-5              PIC X(10).
  1142
  1143     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1144
  1145     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1146
  1147     12  AM-RPT045A-SWITCH                 PIC X.
  1148         88  RPT045A-OFF                   VALUE 'N'.
  1149
  1150     12  AM-INSURANCE-LIMITS.
  1151         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1152         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1153
  1154     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1155         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1156
  1157     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1158         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1159         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1160
  1161     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1162
  1163     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1164     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1165     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1166     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1167     12  FILLER                            PIC X(5).
  1168     12  AM-REPORT-CODE-3                  PIC X(10).
  1169*    12  FILLER                            PIC X(22).
  1170
  1171     12  AM-RESERVE-DATE.
  1172         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1173         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1174         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1175
  1176     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1177     12  AM-NOTIFICATION-TYPES.
  1178         16  AM-NOTIF-OF-LETTERS           PIC X.
  1179         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1180         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  24
* EL6311.cbl
  1181         16  AM-NOTIF-OF-STATUS            PIC X.
  1182
  1183     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1184         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1185         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1186         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1187         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1188
  1189     12  AM-BENEFIT-CONTROLS.
  1190         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1191             20  AM-BENEFIT-CODE           PIC XX.
  1192             20  AM-BENEFIT-TYPE           PIC X.
  1193             20  AM-BENEFIT-REVISION       PIC XXX.
  1194             20  AM-BENEFIT-REM-TERM       PIC X.
  1195             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1196             20  FILLER                    PIC XX.
  1197         16  FILLER                        PIC X(80).
  1198
  1199     12  AM-TRANSFER-DATA.
  1200         16  AM-TRANSFERRED-FROM.
  1201             20  AM-TRNFROM-CARRIER        PIC X.
  1202             20  AM-TRNFROM-GROUPING.
  1203                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1204                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1205             20  AM-TRNFROM-STATE          PIC XX.
  1206             20  AM-TRNFROM-ACCOUNT.
  1207                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1208                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1209             20  AM-TRNFROM-DTE            PIC XX.
  1210         16  AM-TRANSFERRED-TO.
  1211             20  AM-TRNTO-CARRIER          PIC X.
  1212             20  AM-TRNTO-GROUPING.
  1213                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1214                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1215             20  AM-TRNTO-STATE            PIC XX.
  1216             20  AM-TRNTO-ACCOUNT.
  1217                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1218                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1219             20  AM-TRNTO-DTE              PIC XX.
  1220         16  FILLER                        PIC X(10).
  1221
  1222     12  AM-SAVED-REMIT-TO                 PIC 99.
  1223
  1224     12  AM-COMM-STRUCTURE-SAVED.
  1225         16  AM-DEFN-1-SAVED.
  1226             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1227                 24  AM-AGT-SV             PIC X(10).
  1228                 24  AM-COM-TYP-SV         PIC X.
  1229                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1230                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1231                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1232                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1233                 24  FILLER                PIC X.
  1234                 24  AM-GL-CODES-SV        PIC X.
  1235                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1236                 24  FILLER                PIC X.
  1237         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1238             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  25
* EL6311.cbl
  1239                 24  FILLER                PIC X(11).
  1240                 24  AM-L-COMA-SV          PIC XXX.
  1241                 24  AM-J-COMA-SV          PIC XXX.
  1242                 24  AM-A-COMA-SV          PIC XXX.
  1243                 24  FILLER                PIC X(6).
  1244
  1245     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1246         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1247            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1248            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1249            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1250
  1251     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1252     12  FILLER                            PIC X(120).
  1253
  1254     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1255         16  AM-CONTROL-NAME               PIC X(30).
  1256         16  AM-EXECUTIVE-ONE.
  1257             20  AM-EXEC1-NAME             PIC X(15).
  1258             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1259                                                          COMP-3.
  1260             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1261                                                          COMP-3.
  1262         16  AM-EXECUTIVE-TWO.
  1263             20  AM-EXEC2-NAME             PIC X(15).
  1264             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1265                                                          COMP-3.
  1266             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1267                                                          COMP-3.
  1268
  1269     12  AM-RETRO-ADDITIONAL-DATA.
  1270         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1271         16  AM-RETRO-PREM-P-E             PIC X.
  1272         16  AM-RETRO-CLMS-P-I             PIC X.
  1273         16  AM-RETRO-RET-BRACKET-LF.
  1274             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1275                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1276                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1277             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1278                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1279                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1280             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1281                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1282                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1283         16  AM-RETRO-RET-BRACKET-AH.
  1284             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1285                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1286                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1287                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1288             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1289                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1290                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1291             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1292                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1293                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1294
  1295     12  AM-COMMENTS.
  1296         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  26
* EL6311.cbl
  1297
  1298     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1299         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1300         16  AM-FLI-BILLING-CODE           PIC X.
  1301         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1302         16  AM-FLI-UNITED-IDENT           PIC X.
  1303         16  AM-FLI-INTEREST-LOST-DATA.
  1304             20  AM-FLI-BANK-NO            PIC X(5).
  1305             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1306             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1307             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1308         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1309             20  AM-FLI-AGT                PIC X(9).
  1310             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1311             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1312         16  FILLER                        PIC X(102).
  1313
  1314     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1315         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1316             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1317             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1318             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1319             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1320             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1321         16  FILLER                          PIC X(10).
  1322******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  27
* EL6311.cbl
  1324*    COPY ELCDATE.
  1325******************************************************************
  1326*                                                                *
  1327*                                                                *
  1328*                            ELCDATE.                            *
  1329*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1330*                            VMOD=2.003
  1331*                                                                *
  1332*                                                                *
  1333*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1334*                 LENGTH = 200                                   *
  1335******************************************************************
  1336
  1337 01  DATE-CONVERSION-DATA.
  1338     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1339     12  DC-OPTION-CODE                PIC X.
  1340         88  BIN-TO-GREG                VALUE ' '.
  1341         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1342         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1343         88  YMD-GREG-TO-BIN            VALUE '3'.
  1344         88  MDY-GREG-TO-BIN            VALUE '4'.
  1345         88  JULIAN-TO-BIN              VALUE '5'.
  1346         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1347         88  FIND-CENTURY               VALUE '7'.
  1348         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1349         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1350         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1351         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1352         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1353         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1354         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1355         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1356         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1357         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1358         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1359         88  BIN-3-TO-GREG              VALUE 'I'.
  1360         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1361         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1362         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1363         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1364         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1365         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1366         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1367         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1368         88  THREE-CHARACTER-BIN
  1369                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1370         88  GREGORIAN-TO-BIN
  1371                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1372         88  BIN-TO-GREGORIAN
  1373                  VALUES ' ' '1' 'I' '8' 'G'.
  1374         88  JULIAN-TO-BINARY
  1375                  VALUES '5' 'C' 'E' 'F'.
  1376     12  DC-ERROR-CODE                 PIC X.
  1377         88  NO-CONVERSION-ERROR        VALUE ' '.
  1378         88  DATE-CONVERSION-ERROR
  1379                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1380         88  DATE-IS-ZERO               VALUE '1'.
  1381         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  28
* EL6311.cbl
  1382         88  DATE-IS-INVALID            VALUE '3'.
  1383         88  DATE1-GREATER-DATE2        VALUE '4'.
  1384         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1385         88  DATE-INVALID-OPTION        VALUE '9'.
  1386         88  INVALID-CENTURY            VALUE 'A'.
  1387         88  ONLY-CENTURY               VALUE 'B'.
  1388         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1389         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1390     12  DC-END-OF-MONTH               PIC X.
  1391         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1392     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1393         88  USE-NORMAL-PROCESS         VALUE ' '.
  1394         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1395         88  ADJUST-UP-100-YRS          VALUE '2'.
  1396     12  FILLER                        PIC X.
  1397     12  DC-CONVERSION-DATES.
  1398         16  DC-BIN-DATE-1             PIC XX.
  1399         16  DC-BIN-DATE-2             PIC XX.
  1400         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1401         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1402                       DC-GREG-DATE-1-EDIT.
  1403             20  DC-EDIT1-MONTH        PIC 99.
  1404             20  SLASH1-1              PIC X.
  1405             20  DC-EDIT1-DAY          PIC 99.
  1406             20  SLASH1-2              PIC X.
  1407             20  DC-EDIT1-YEAR         PIC 99.
  1408         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1409         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1410                     DC-GREG-DATE-2-EDIT.
  1411             20  DC-EDIT2-MONTH        PIC 99.
  1412             20  SLASH2-1              PIC X.
  1413             20  DC-EDIT2-DAY          PIC 99.
  1414             20  SLASH2-2              PIC X.
  1415             20  DC-EDIT2-YEAR         PIC 99.
  1416         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1417         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1418                     DC-GREG-DATE-1-YMD.
  1419             20  DC-YMD-YEAR           PIC 99.
  1420             20  DC-YMD-MONTH          PIC 99.
  1421             20  DC-YMD-DAY            PIC 99.
  1422         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1423         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1424                      DC-GREG-DATE-1-MDY.
  1425             20  DC-MDY-MONTH          PIC 99.
  1426             20  DC-MDY-DAY            PIC 99.
  1427             20  DC-MDY-YEAR           PIC 99.
  1428         16  DC-GREG-DATE-1-ALPHA.
  1429             20  DC-ALPHA-MONTH        PIC X(10).
  1430             20  DC-ALPHA-DAY          PIC 99.
  1431             20  FILLER                PIC XX.
  1432             20  DC-ALPHA-CENTURY.
  1433                 24 DC-ALPHA-CEN-N     PIC 99.
  1434             20  DC-ALPHA-YEAR         PIC 99.
  1435         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1436         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1437         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1438         16  DC-JULIAN-DATE            PIC 9(05).
  1439         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  29
* EL6311.cbl
  1440                                       PIC 9(05).
  1441         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1442             20  DC-JULIAN-YEAR        PIC 99.
  1443             20  DC-JULIAN-DAYS        PIC 999.
  1444         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1445         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1446         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1447     12  DATE-CONVERSION-VARIBLES.
  1448         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1449         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1450             20  FILLER                PIC 9(3).
  1451             20  HOLD-CEN-1-CCYY.
  1452                 24  HOLD-CEN-1-CC     PIC 99.
  1453                 24  HOLD-CEN-1-YY     PIC 99.
  1454             20  HOLD-CEN-1-MO         PIC 99.
  1455             20  HOLD-CEN-1-DA         PIC 99.
  1456         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1457             20  HOLD-CEN-1-R-MO       PIC 99.
  1458             20  HOLD-CEN-1-R-DA       PIC 99.
  1459             20  HOLD-CEN-1-R-CCYY.
  1460                 24  HOLD-CEN-1-R-CC   PIC 99.
  1461                 24  HOLD-CEN-1-R-YY   PIC 99.
  1462             20  FILLER                PIC 9(3).
  1463         16  HOLD-CENTURY-1-X.
  1464             20  FILLER                PIC X(3)  VALUE SPACES.
  1465             20  HOLD-CEN-1-X-CCYY.
  1466                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1467                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1468             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1469             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1470         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1471             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1472             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1473             20  HOLD-CEN-1-R-X-CCYY.
  1474                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1475                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1476             20  FILLER                PIC XXX.
  1477         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1478         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1479         16  DC-JULIAN-DATE-1          PIC 9(07).
  1480         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1481             20  DC-JULIAN-1-CCYY.
  1482                 24  DC-JULIAN-1-CC    PIC 99.
  1483                 24  DC-JULIAN-1-YR    PIC 99.
  1484             20  DC-JULIAN-DA-1        PIC 999.
  1485         16  DC-JULIAN-DATE-2          PIC 9(07).
  1486         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1487             20  DC-JULIAN-2-CCYY.
  1488                 24  DC-JULIAN-2-CC    PIC 99.
  1489                 24  DC-JULIAN-2-YR    PIC 99.
  1490             20  DC-JULIAN-DA-2        PIC 999.
  1491         16  DC-GREG-DATE-A-EDIT.
  1492             20  DC-EDITA-MONTH        PIC 99.
  1493             20  SLASHA-1              PIC X VALUE '/'.
  1494             20  DC-EDITA-DAY          PIC 99.
  1495             20  SLASHA-2              PIC X VALUE '/'.
  1496             20  DC-EDITA-CCYY.
  1497                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  30
* EL6311.cbl
  1498                 24  DC-EDITA-YEAR     PIC 99.
  1499         16  DC-GREG-DATE-B-EDIT.
  1500             20  DC-EDITB-MONTH        PIC 99.
  1501             20  SLASHB-1              PIC X VALUE '/'.
  1502             20  DC-EDITB-DAY          PIC 99.
  1503             20  SLASHB-2              PIC X VALUE '/'.
  1504             20  DC-EDITB-CCYY.
  1505                 24  DC-EDITB-CENT     PIC 99.
  1506                 24  DC-EDITB-YEAR     PIC 99.
  1507         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1508         16  DC-GREG-DATE-CYMD-R REDEFINES
  1509                              DC-GREG-DATE-CYMD.
  1510             20  DC-CYMD-CEN           PIC 99.
  1511             20  DC-CYMD-YEAR          PIC 99.
  1512             20  DC-CYMD-MONTH         PIC 99.
  1513             20  DC-CYMD-DAY           PIC 99.
  1514         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1515         16  DC-GREG-DATE-MDCY-R REDEFINES
  1516                              DC-GREG-DATE-MDCY.
  1517             20  DC-MDCY-MONTH         PIC 99.
  1518             20  DC-MDCY-DAY           PIC 99.
  1519             20  DC-MDCY-CEN           PIC 99.
  1520             20  DC-MDCY-YEAR          PIC 99.
  1521    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1522        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1523    12  DC-EL310-DATE                  PIC X(21).
  1524    12  FILLER                         PIC X(28).
  1525
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  31
* EL6311.cbl
  1527*    COPY ELCLOGOF.
  1528******************************************************************
  1529*                                                                *
  1530*                                                                *
  1531*                            ELCLOGOF.                           *
  1532*                            VMOD=2.001                          *
  1533*                                                                *
  1534*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1535*                                                                *
  1536******************************************************************
  1537 01  CLASIC-LOGOFF.
  1538     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1539     12  LOGOFF-TEXT.
  1540         16  FILLER          PIC X(5)    VALUE SPACES.
  1541         16  LOGOFF-MSG.
  1542             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1543             20  FILLER      PIC X       VALUE SPACES.
  1544             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1545         16  FILLER          PIC X(80)
  1546           VALUE '* YOU ARE NOW LOGGED OFF'.
  1547         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1548         16  FILLER          PIC X       VALUE QUOTE.
  1549         16  LOGOFF-SYS-MSG  PIC X(17)
  1550           VALUE 'S CLAS-IC SYSTEM '.
  1551     12  TEXT-MESSAGES.
  1552         16  UNACCESS-MSG    PIC X(29)
  1553             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1554         16  PGMIDERR-MSG    PIC X(17)
  1555             VALUE 'PROGRAM NOT FOUND'.
  1556
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  32
* EL6311.cbl
  1558*    COPY ELCATTR.
  1559******************************************************************
  1560*                                                                *
  1561*                            ELCATTR.                            *
  1562*                            VMOD=2.001                          *
  1563*                                                                *
  1564*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1565*                                                                *
  1566*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1567*                                                                *
  1568*                   POS 1   P=PROTECTED                          *
  1569*                           U=UNPROTECTED                        *
  1570*                           S=ASKIP                              *
  1571*                   POS 2   A=ALPHA/NUMERIC                      *
  1572*                           N=NUMERIC                            *
  1573*                   POS 3   N=NORMAL                             *
  1574*                           B=BRIGHT                             *
  1575*                           D=DARK                               *
  1576*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1577*                           OF=MODIFIED DATA TAG OFF             *
  1578*                                                                *
  1579*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1580******************************************************************
  1581 01  ATTRIBUTE-LIST.
  1582     12  AL-PABOF            PIC X       VALUE 'Y'.
  1583     12  AL-PABON            PIC X       VALUE 'Z'.
  1584     12  AL-PADOF            PIC X       VALUE '%'.
  1585     12  AL-PADON            PIC X       VALUE '_'.
  1586     12  AL-PANOF            PIC X       VALUE '-'.
  1587     12  AL-PANON            PIC X       VALUE '/'.
  1588     12  AL-SABOF            PIC X       VALUE '8'.
  1589     12  AL-SABON            PIC X       VALUE '9'.
  1590     12  AL-SADOF            PIC X       VALUE '@'.
  1591     12  AL-SADON            PIC X       VALUE QUOTE.
  1592     12  AL-SANOF            PIC X       VALUE '0'.
  1593     12  AL-SANON            PIC X       VALUE '1'.
  1594     12  AL-UABOF            PIC X       VALUE 'H'.
  1595     12  AL-UABON            PIC X       VALUE 'I'.
  1596     12  AL-UADOF            PIC X       VALUE '<'.
  1597     12  AL-UADON            PIC X       VALUE '('.
  1598     12  AL-UANOF            PIC X       VALUE ' '.
  1599     12  AL-UANON            PIC X       VALUE 'A'.
  1600     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1601     12  AL-UNBON            PIC X       VALUE 'R'.
  1602     12  AL-UNDOF            PIC X       VALUE '*'.
  1603     12  AL-UNDON            PIC X       VALUE ')'.
  1604     12  AL-UNNOF            PIC X       VALUE '&'.
  1605     12  AL-UNNON            PIC X       VALUE 'J'.
  1606
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  33
* EL6311.cbl
  1608*    COPY ELCEMIB.
  1609******************************************************************
  1610*                                                                *
  1611*                                                                *
  1612*                            ELCEMIB.                            *
  1613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1614*                            VMOD=2.005                          *
  1615*                                                                *
  1616*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1617*                                                                *
  1618******************************************************************
  1619 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1620     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1621     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1622     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1623     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1624     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1625     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1626     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1627     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1628     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1629         88  EMI-NO-ERRORS                    VALUE '1'.
  1630         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1631         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1632     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1633         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1634     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1635         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1636         88  EMI-AREA1-FULL                   VALUE '2'.
  1637     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1638         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1639         88  EMI-AREA2-FULL                   VALUE '2'.
  1640     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1641         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1642         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1643         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1644         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1645         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1646     12  EMI-ERROR-LINES.
  1647         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1648         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1649         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1650         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1651             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1652                 24  EMI-ERR-NUM         PIC X(4).
  1653                 24  EMI-FILLER          PIC X.
  1654                 24  EMI-SEV             PIC X.
  1655                 24  FILLER              PIC X.
  1656             20  FILLER                  PIC X(02).
  1657     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1658         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1659             20  EMI-ERROR-NUMBER    PIC X(4).
  1660             20  EMI-FILL            PIC X.
  1661             20  EMI-SEVERITY        PIC X.
  1662             20  FILLER              PIC X.
  1663             20  EMI-ERROR-TEXT.
  1664                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1665                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  34
* EL6311.cbl
  1666     12  EMI-SEVERITY-SAVE           PIC X.
  1667         88  EMI-NOTE                    VALUE 'N'.
  1668         88  EMI-WARNING                 VALUE 'W'.
  1669         88  EMI-FORCABLE                VALUE 'F'.
  1670         88  EMI-FATAL                   VALUE 'X'.
  1671     12  EMI-MESSAGE-FLAG            PIC X.
  1672         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1673         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1674     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1675     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1676         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1677         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1678         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1679     12  FILLER                      PIC X(137)  VALUE SPACES.
  1680     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1681     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1682     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1683     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1684
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  35
* EL6311.cbl
  1686*    COPY ELCINTF.
  1687******************************************************************
  1688*                                                                *
  1689*                                                                *
  1690*                            ELCINTF.                            *
  1691*                            VMOD=2.017                          *
  1692*                                                                *
  1693*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1694*                                                                *
  1695*       LENGTH = 1024                                            *
  1696*                                                                *
  1697******************************************************************
  1698 01  PROGRAM-INTERFACE-BLOCK.
  1699     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1700     12  PI-CALLING-PROGRAM              PIC X(8).
  1701     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1702     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1703     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1704     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1705     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1706     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1707     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1708     12  PI-COMPANY-ID                   PIC XXX.
  1709     12  PI-COMPANY-CD                   PIC X.
  1710
  1711     12  PI-COMPANY-PASSWORD             PIC X(8).
  1712
  1713     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1714
  1715     12  PI-CONTROL-IN-PROGRESS.
  1716         16  PI-CARRIER                  PIC X.
  1717         16  PI-GROUPING                 PIC X(6).
  1718         16  PI-STATE                    PIC XX.
  1719         16  PI-ACCOUNT                  PIC X(10).
  1720         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1721                                         PIC X(10).
  1722         16  PI-CLAIM-CERT-GRP.
  1723             20  PI-CLAIM-NO             PIC X(7).
  1724             20  PI-CERT-NO.
  1725                 25  PI-CERT-PRIME       PIC X(10).
  1726                 25  PI-CERT-SFX         PIC X.
  1727             20  PI-CERT-EFF-DT          PIC XX.
  1728         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1729             20  PI-PLAN-CODE            PIC X(2).
  1730             20  PI-REVISION-NUMBER      PIC X(3).
  1731             20  PI-PLAN-EFF-DT          PIC X(2).
  1732             20  PI-PLAN-EXP-DT          PIC X(2).
  1733             20  FILLER                  PIC X(11).
  1734         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1735             20  PI-OE-REFERENCE-1.
  1736                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1737                 25  PI-OE-REF-1-SUFF    PIC XX.
  1738
  1739     12  PI-SESSION-IN-PROGRESS          PIC X.
  1740         88  CLAIM-SESSION                   VALUE '1'.
  1741         88  CREDIT-SESSION                  VALUE '2'.
  1742         88  WARRANTY-SESSION                VALUE '3'.
  1743         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  36
* EL6311.cbl
  1744         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1745
  1746
  1747*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1748
  1749     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1750     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1751
  1752     12  PI-CREDIT-USER                  PIC X.
  1753         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1754         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1755
  1756     12  PI-CLAIM-USER                   PIC X.
  1757         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1758         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1759
  1760     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1761         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1762         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1763         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1764         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1765         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1766
  1767     12  PI-PROCESSOR-ID                 PIC X(4).
  1768
  1769     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1770
  1771     12  PI-MEMBER-CAPTION               PIC X(10).
  1772
  1773     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1774         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1775
  1776     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1777     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1778     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1779     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1780
  1781     12  PI-AH-OVERRIDE-L1               PIC X.
  1782     12  PI-AH-OVERRIDE-L2               PIC XX.
  1783     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1784     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1785
  1786     12  PI-NEW-SYSTEM                   PIC X(2).
  1787
  1788     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1789     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1790         88  PI-USES-PAID-TO                 VALUE '1'.
  1791     12  PI-CRDTCRD-SYSTEM.
  1792         16  PI-CRDTCRD-USER             PIC X.
  1793             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1794             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1795         16  PI-CC-MONTH-END-DT          PIC XX.
  1796     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1797
  1798     12  PI-OE-REFERENCE-2.
  1799         16  PI-OE-REF-2-PRIME           PIC X(10).
  1800         16  PI-OE-REF-2-SUFF            PIC X.
  1801
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  37
* EL6311.cbl
  1802     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1803
  1804     12  PI-LANGUAGE-TYPE                PIC X.
  1805             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1806             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1807             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1808
  1809     12  PI-POLICY-LINKAGE-IND           PIC X.
  1810         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1811         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1812                                                   LOW-VALUES.
  1813
  1814     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1815     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1816         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1817         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1818     12  FILLER                          PIC X(4).
  1819
  1820     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1821
  1822     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1823         PI-SYSTEM-LEVEL.
  1824
  1825         16  PI-ENTRY-CODES.
  1826             20  PI-ENTRY-CD-1           PIC X.
  1827             20  PI-ENTRY-CD-2           PIC X.
  1828
  1829         16  PI-RETURN-CODES.
  1830             20  PI-RETURN-CD-1          PIC X.
  1831             20  PI-RETURN-CD-2          PIC X.
  1832
  1833         16  PI-UPDATE-STATUS-SAVE.
  1834             20  PI-UPDATE-BY            PIC X(4).
  1835             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1836
  1837         16  PI-LOWER-CASE-LETTERS       PIC X.
  1838             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1839
  1840*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1841*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1842*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1843
  1844         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1845             88  ST-ACCNT-CNTL               VALUE ' '.
  1846             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1847             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1848             88  ACCNT-CNTL                  VALUE '3'.
  1849             88  CARR-ACCNT-CNTL             VALUE '4'.
  1850
  1851         16  PI-PROCESSOR-CAP-LIST.
  1852             20  PI-SYSTEM-CONTROLS.
  1853                24 PI-SYSTEM-DISPLAY     PIC X.
  1854                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1855                24 PI-SYSTEM-MODIFY      PIC X.
  1856                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1857             20  FILLER                  PIC XX.
  1858             20  PI-DISPLAY-CAP          PIC X.
  1859                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  38
* EL6311.cbl
  1860             20  PI-MODIFY-CAP           PIC X.
  1861                 88  MODIFY-CAP              VALUE 'Y'.
  1862             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1863                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1864             20  PI-FORCE-CAP            PIC X.
  1865                 88  FORCE-CAP               VALUE 'Y'.
  1866
  1867         16  PI-PROGRAM-CONTROLS.
  1868             20  PI-PGM-PRINT-OPT        PIC X.
  1869             20  PI-PGM-FORMAT-OPT       PIC X.
  1870             20  PI-PGM-PROCESS-OPT      PIC X.
  1871             20  PI-PGM-TOTALS-OPT       PIC X.
  1872
  1873         16  PI-HELP-INTERFACE.
  1874             20  PI-LAST-ERROR-NO        PIC X(4).
  1875             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1876
  1877         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1878             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1879
  1880         16  PI-CR-CONTROL-IN-PROGRESS.
  1881             20  PI-CR-CARRIER           PIC X.
  1882             20  PI-CR-GROUPING          PIC X(6).
  1883             20  PI-CR-STATE             PIC XX.
  1884             20  PI-CR-ACCOUNT           PIC X(10).
  1885             20  PI-CR-FIN-RESP          PIC X(10).
  1886             20  PI-CR-TYPE              PIC X.
  1887
  1888         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1889
  1890         16  PI-CR-MONTH-END-DT          PIC XX.
  1891
  1892         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1893             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1894             88  PI-ZERO-CARRIER             VALUE '1'.
  1895             88  PI-ZERO-GROUPING            VALUE '2'.
  1896             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1897
  1898         16  PI-CARRIER-SECURITY         PIC X.
  1899             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1900
  1901         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1902             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1903             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1904
  1905         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1906             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1907                                         INDEXED BY PI-ACCESS-NDX
  1908                                         PIC X.
  1909
  1910         16  PI-GA-BILLING-CONTROL       PIC X.
  1911             88  PI-GA-BILLING               VALUE '1'.
  1912
  1913         16  PI-MAIL-PROCESSING          PIC X.
  1914             88  PI-MAIL-YES                 VALUE 'Y'.
  1915
  1916         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1917
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  39
* EL6311.cbl
  1918         16  PI-AR-SYSTEM.
  1919             20  PI-AR-PROCESSING-CNTL   PIC X.
  1920                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1921             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1922             20  PI-AR-MONTH-END-DT      PIC XX.
  1923
  1924         16  PI-MP-SYSTEM.
  1925             20  PI-MORTGAGE-USER            PIC X.
  1926                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1927                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1928             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1929                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1930                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1931                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1932                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1933                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1934             20  PI-MP-MONTH-END-DT          PIC XX.
  1935             20  PI-MP-REFERENCE-NO.
  1936                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1937                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1938
  1939         16  PI-LABEL-CONTROL            PIC X(01).
  1940             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1941             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1942
  1943         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1944             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1945
  1946         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1947             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1948             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1949
  1950         16  FILLER                      PIC X(14).
  1951
  1952     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1953******************************************************************
  1954
  1955     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1956*    COPY ELC631PI.
  1957******************************************************************
  1958*                                                                *
  1959*                                                                *
  1960*                            ELC631PI                            *
  1961*                            VMOD=2.012                          *
  1962*                                                                *
  1963*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1964*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  1965*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1966*                                                                *
  1967*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1968*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  1969*    BETWEEN PROGRAMS.                                           *
  1970*                                                                *
  1971*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1972*                                                                *
  1973*               EL631 - EL6311 - EL6312 - EL6313                 *
  1974*                                                                *
  1975******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  40
* EL6311.cbl
  1976
  1977         16  PI-631-DATA.
  1978             20  PI-ERPNDB-KEY.
  1979                 24  PI-PB-COMPANY-CD     PIC X.
  1980                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  1981                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  1982                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  1983
  1984             20  PI-ERPNDB-ALT-KEY.
  1985                 24  PI-PB-COMPANY-CD-A1  PIC X.
  1986                 24  PI-PB-CARRIER        PIC X.
  1987                 24  PI-PB-GROUPING       PIC X(6).
  1988                 24  PI-PB-STATE          PIC XX.
  1989                 24  PI-PB-ACCOUNT        PIC X(10).
  1990                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1991                 24  PI-PB-CERT-NO.
  1992                     28  PI-PB-CERT-PRIME PIC X(10).
  1993                     28  PI-PB-CERT-SFX   PIC X.
  1994                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1995                 24  PI-PB-RECORD-TYPE    PIC X.
  1996
  1997             20  PI-ERPNDB-CSR-KEY.
  1998                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1999                 24  PI-PB-CSR-ID             PIC X(4).
  2000                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2001                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2002                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2003
  2004             20  PI-BROWSE-TYPE               PIC X.
  2005                 88  PI-FILE-BROWSE             VALUE ' '.
  2006                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2007                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2008                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2009                 88  PI-CSR-BROWSE              VALUE '4'.
  2010
  2011             20  PI-MAINT-FUNCTION            PIC X.
  2012                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2013                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2014                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2015                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2016                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2017                 88  PI-PF5-FUNCTION            VALUE '5'.
  2018                 88  PI-PF6-FUNCTION            VALUE '6'.
  2019
  2020             20  PI-FILE-SWITCHES.
  2021                 24  PI-ALL-ISSUES-SW         PIC X.
  2022                     88  ALL-ISSUES             VALUE 'Y'.
  2023                 24  PI-ALL-CANCELS-SW        PIC X.
  2024                     88  ALL-CANCELS            VALUE 'Y'.
  2025                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2026                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2027                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2028                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2029                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2030                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2031                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2032                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2033                 24  PI-HOLD-REC-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  41
* EL6311.cbl
  2034                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2035                 24  PI-CHANGE-REC-SW         PIC X.
  2036                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2037                 24  PI-CHK-REQ-REC-SW        PIC X.
  2038                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2039                 24  PI-ISSUE-WARNING-SW      PIC X.
  2040                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2041                 24  PI-CANCEL-WARNING-SW     PIC X.
  2042                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2043             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2044                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2045             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2046                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2047
  2048             20  PI-MAP-NAME                  PIC X(8).
  2049
  2050             20  PI-CURSOR                    PIC S9(4) COMP.
  2051
  2052             20  PI-PREV-ALT-KEY              PIC X(36).
  2053             20  PI-PREV-CSR-KEY              PIC X(15).
  2054             20  PI-PREV-KEY.
  2055                 24  PI-PREV-COMPANY-CD       PIC X.
  2056                 24  PI-PREV-BATCH            PIC X(6).
  2057                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2058                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2059             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2060             20  PI-BROWSE-SW                 PIC X.
  2061                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2062                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2063             20  PI-SV-CARRIER                PIC X.
  2064             20  PI-SV-GROUPING               PIC X(6).
  2065             20  PI-SV-STATE                  PIC XX.
  2066             20  PI-EDIT-SW                   PIC X.
  2067             20  PI-DISPLAY-SW                PIC XX.
  2068                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2069                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2070             20  PI-CRITERIA-DATA             PIC X(350).
  2071             20  PI-BMODE                     PIC X.
  2072             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2073             20  PI-BPMTS                     PIC S999     COMP-3.
  2074             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2075             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2076             20  FILLER                       PIC X(7).
  2077
  2078         16  FILLER             PIC X(94).
  2079
  2080 01  W-LETTER-COMMUNICATION-AREAS.
  2081*    COPY ELC1042.
  2082******************************************************************
  2083*                                                                *
  2084*                                                                *
  2085*                           ELC1042                              *
  2086*                            VMOD=2.002                          *
  2087*                                                                *
  2088*    NOTE                                                        *
  2089*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2090*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2091*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  42
* EL6311.cbl
  2092*        TO THESE PROGRAMS.                                      *
  2093*                                                                *
  2094*    NOTE                                                        *
  2095*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2096*        USE ONLY!                                               *
  2097*                                                                *
  2098******************************************************************
  2099
  2100         16  PI-1042-WA.
  2101             20  PI-ACTION       PIC  X(01).
  2102                 88 PI-SHOW-MODE           VALUE '1'.
  2103                 88 PI-CLEAR-MODE          VALUE '2'.
  2104                 88 PI-CREATE-MODE         VALUE '3'.
  2105             20  PI-COMM-CONTROL PIC  X(12).
  2106             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2107             20  PI-EOF-SW       PIC  X(01).
  2108                 88  PI-FILE-EOF           VALUE 'Y'.
  2109             20  PI-FILETYP      PIC  X(01).
  2110             20  PI-FORM-SQUEEZE-CONTROL
  2111                                 PIC  X(01).
  2112                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2113                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2114             20  PI-LAST-CONTROL PIC  X(12).
  2115             20  PI-TEMP-STOR-ITEMS
  2116                                 PIC S9(04) COMP.
  2117             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2118             20  PI-UPDATE-SW    PIC  9(01).
  2119                 88 ANY-UPDATES            VALUE 1.
  2120             20  PI-104-SCREEN-SENT-IND
  2121                                 PIC  X(01).
  2122                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2123                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2124             20  PI-1042-SCREEN-SENT-IND
  2125                                 PIC  X(01).
  2126                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2127                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2128             20  PI-1042-ARCHIVE-IND
  2129                                 PIC  X(01).
  2130                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2131             20  FILLER          PIC  X(29).
  2132*    COPY ELC689PI.
  2133******************************************************************
  2134*                                                                *
  2135*                            ELC689PI                            *
  2136*                            VMOD=2.003                          *
  2137*                                                                *
  2138*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2139*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2140*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2141*                                                                *
  2142*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2143*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2144*    BETWEEN PROGRAMS.                                           *
  2145*                                                                *
  2146*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2147*                                                                *
  2148*               EL631 - EL689  - EL6891 - EL6892                 *
  2149*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  43
* EL6311.cbl
  2150******************************************************************
  2151*                   C H A N G E   L O G
  2152*
  2153* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2154*-----------------------------------------------------------------
  2155*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2156* EFFECTIVE    NUMBER
  2157*-----------------------------------------------------------------
  2158* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2159* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2160* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2161******************************************************************
  2162
  2163
  2164         16  PI-689-WORK-AREA.
  2165             20  PI-689-ALT-PRINTER-ID
  2166                                 PIC  X(04).
  2167             20  PI-689-ARCHIVE-NUMBER
  2168                                 PIC  9(08).
  2169             20  PI-689-ARCHIVE-SW
  2170                                 PIC  X(01).
  2171                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2172             20  PI-689-DATA-SOURCE
  2173                                 PIC  X(01).
  2174                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2175                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2176                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2177                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2178                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2179             20  PI-689-ERROR-IND
  2180                                 PIC  X(01).
  2181                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2182             20  PI-689-ERROR    PIC  9(04).
  2183                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2184                 88  PI-689-FATAL-ERROR
  2185                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2186                            0042 0047 0051 0066 0067 0070
  2187                            0168 0169 0174 0175 0176 0177 0179
  2188                            0180 0181 0182 0184 0185 0189 0190
  2189                            0191
  2190                            0215 0279 0280
  2191                            0412 0413 0454
  2192                            0533 0537
  2193                            2055 2114 2208 2209 2216 2232 2369
  2194                            2398 2433 2908 2999
  2195                            3000 3770 3771 3775
  2196                            7250 7365 7367 7368 7369 7370 7371
  2197                            7272 7373 7374 7376 7377 7378 7379
  2198                            7381 7388 7390 7393 7395 7396 7398
  2199                            9095 9096 9281 9298 9299 9320 9327
  2200                            9426 9427.
  2201                 88  PI-689-STOP-ERROR
  2202                     VALUES 0004 0008 0013 0023 0029 0033
  2203                            0042 0047 0066 0067 0070
  2204                            0168 0169 0174 0175 0176 0177
  2205                            0181 0182 0184 0185 0189 0190
  2206                            0279 0280
  2207                            0412 0413 0454
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  44
* EL6311.cbl
  2208                            2055 2208 2209 2216 2232
  2209                            2398 2999
  2210                            3000 3770 3771 3775
  2211                            7250 7365 7369 7370 7371
  2212                            7272 7373 7374 7376 7377 7378 7379
  2213                            7381 7388 7390 7393 7396 7398
  2214                            9095 9096 9299 9320 9426.
  2215             20  PI-689-FOLLOW-UP-DATE
  2216                                 PIC  X(02).
  2217             20  PI-689-FORM-NUMBER
  2218                                 PIC  X(04).
  2219             20  PI-689-LABEL-SOURCE
  2220                                 PIC X(01).
  2221                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2222                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2223                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2224                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2225                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2226                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2227                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2228             20  PI-689-NUMBER-COPIES
  2229                                 PIC  9(01).
  2230             20  PI-689-NUMBER-LABEL-LINES
  2231                                 PIC  9(01).
  2232             20  PI-689-NUMBER-TEXT-RECORDS
  2233                                 PIC  9(03).
  2234             20  PI-689-PRINT-ORDER-SW
  2235                                 PIC  X(01).
  2236                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2237                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2238                 88  PI-689-PRINT-LATER     VALUE '3'.
  2239                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2240             20  PI-689-PRINT-RESTRICTION
  2241                                 PIC  X(01).
  2242                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2243                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2244                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2245             20  PI-689-PRINT-SW PIC  X(01).
  2246                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2247             20  PI-689-RESEND-DATE-1
  2248                                 PIC  X(02).
  2249             20  PI-689-RESEND-LETR-1
  2250                                 PIC X(4).
  2251             20  PI-689-TEMP-STOR-ID
  2252                                 PIC  X(08).
  2253             20  PI-689-USE-SCREEN-IND
  2254                                 PIC  X(01).
  2255                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2256             20  PI-689-ARCH-POINTER
  2257                                 PIC S9(08) COMP.
  2258                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2259             20  PI-689-ARCT-POINTER
  2260                                 PIC S9(08) COMP.
  2261                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2262             20  PI-689-VARIABLE-DATA-GRP.
  2263                 24  PI-689-VARIABLE-DATA-1
  2264                                 PIC  X(30).
  2265                 24  PI-689-VARIABLE-DATA-2
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  45
* EL6311.cbl
  2266                                 PIC  X(30).
  2267                 24  PI-689-VARIABLE-DATA-3
  2268                                 PIC  X(30).
  2269                 24  PI-689-VARIABLE-DATA-4
  2270                                 PIC  X(30).
  2271
  2272         16  PI-689-KEY-DATA-FIELDS.
  2273             20  PI-689-ACCOUNT  PIC  X(10).
  2274             20  PI-689-CARRIER  PIC  X(01).
  2275             20  PI-689-CERT-NO.
  2276                 24  PI-689-CERT-PRIME
  2277                                 PIC  X(10).
  2278                 24  PI-689-CERT-SFX
  2279                                 PIC  X(01).
  2280             20  PI-689-CHG-SEQ-NO
  2281                                 PIC S9(04)    COMP.
  2282             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2283                                 PIC  X(02).
  2284             20  PI-689-ENTRY-BATCH
  2285                                 PIC  X(06).
  2286             20  PI-689-EFF-DATE PIC  X(02).
  2287             20  PI-689-EXP-DATE PIC  X(02).
  2288             20  PI-689-GROUPING PIC  X(06).
  2289             20  PI-689-RESP-PERSON
  2290                                 PIC  X(10).
  2291             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2292             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2293                                 PIC  X(04).
  2294             20  PI-689-STATE    PIC  X(02).
  2295             20  PI-689-TYPE     PIC  X(01).
  2296             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2297             20  PI-689-ALT-SEQ-NO
  2298                                 PIC S9(04)    COMP.
  2299         16  PI-689-DATE-EDIT    PIC  X(08).
  2300         16  PI-689-FOLLOW-UP-EDIT
  2301                                 PIC  X(08).
  2302         16  PI-689-RESEND1-EDIT PIC  X(08).
  2303         16  PI-689-SEQ-EDIT     PIC  X(08).
  2304         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2305         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2306             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2307         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2308         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  46
* EL6311.cbl
  2310
  2311******************************************************************
  2312*                                                                *
  2313*         P A S S   A R E A   F O R   E D I T                    *
  2314*                                                                *
  2315******************************************************************
  2316
  2317 01  PASSED-RECORD.
  2318     12  RECORD-SAVE                  PIC X(585).
  2319* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2320*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2321*                    BY  WK-CURRENT-DATE.
  2322******************************************************************
  2323*                                                                *
  2324*                                                                *
  2325*                             ELC50W1                            *
  2326*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2327*                            VMOD=2.004                          *
  2328*                                                                *
  2329*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2330*                                                                *
  2331*                                                                *
  2332******************************************************************
  2333
  2334     12  WK-WORK-AREA.
  2335         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2336         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2337         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2338         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2339         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2340         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2341         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2342         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2343         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2344         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2345         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2346         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2347         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2348         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  2349         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2350         16  WK-CREDIT-EDIT-CONTROLS.
  2351             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2352             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2353             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2354             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2355             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2356             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2357         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2358         16  WK-SAVE-REIN-DATA.
  2359             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2360             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2361             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2362         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2363             88  ENTRY-FROM-EL6311       VALUE '6'.
  2364         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2365         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2366     12  WK-RECORD-ADDRESSES.
  2367         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  47
* EL6311.cbl
  2368         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2369         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2370         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2371         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2372         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2373         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2374         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2375     12  WK-OVER-SHORT-AREA.
  2376         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2377         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2378         16  FILLER                   PIC X(6) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  48
* EL6311.cbl
  2380
  2381*    COPY ELCEDITC.
  2382******************************************************************
  2383*                                                                *
  2384*                                                                *
  2385*                            ELCEDITC                            *
  2386*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2387*                            VMOD=2.012                          *
  2388*                                                                *
  2389*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2390*                     EL6313, EL050 AND EL517.                   *
  2391*                                                                *
  2392******************************************************************
  2393******************************************************************
  2394*                   C H A N G E   L O G
  2395*
  2396* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2397*-----------------------------------------------------------------
  2398*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2399* EFFECTIVE    NUMBER
  2400*-----------------------------------------------------------------
  2401* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2402******************************************************************
  2403
  2404     12  EDIT-CRITERIA-DATA.
  2405         16  EC-CO-MONTH-END-DT       PIC XX.
  2406         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2407         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2408         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2409         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2410         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2411         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2412         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2413         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2414         16  EC-CO-REM-TERM-CALC      PIC X.
  2415               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2416               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2417               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2418               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2419
  2420         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2421               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2422               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2423               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2424               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2425               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2426               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2427               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2428               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2429               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2430               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2431
  2432         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  2433               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  2434               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  2435               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  2436               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  2437               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  49
* EL6311.cbl
  2438               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  2439               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  2440               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  2441
  2442         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  2443                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  2444                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  2445
  2446         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  2447                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  2448                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  2449                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  2450                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  2451                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  2452                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  2453                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  2454                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  2455
  2456         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  2457               88  EC-BR-REDUCING                   VALUE 'R'.
  2458               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  2459
  2460         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  2461         16  EC-BR-LF-DESC             PIC X(10).
  2462         16  EC-BR-AH-DESC             PIC X(10).
  2463         16  EC-BR-LF-COMMENT          PIC X(10).
  2464         16  EC-BR-AH-COMMENT          PIC X(10).
  2465
  2466         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  2467               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  2468               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  2469               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  2470               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  2471
  2472         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  2473               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  2474               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  2475               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  2476               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  2477
  2478         16  EC-BR-LF-REFUND-CALC      PIC X.
  2479                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  2480                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  2481                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  2482                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  2483                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  2484                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  2485                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  2486
  2487         16  EC-BR-AH-REFUND-CALC      PIC X.
  2488                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  2489                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  2490                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  2491                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  2492                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  2493                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  2494                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  2495                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  50
* EL6311.cbl
  2496
  2497         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  2498                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  2499                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  2500                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  2501
  2502         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  2503                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  2504                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  2505                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  2506
  2507         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  2508         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2509         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2510         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2511
  2512         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  2513         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  2514                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  2515                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  2516                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  2517                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  2518
  2519         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  2520               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  2521               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  2522               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  2523               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  2524               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  2525
  2526         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  2527               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  2528               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  2529               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  2530               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  2531               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  2532
  2533         16  EC-ST-LF-REFUND-CALC      PIC X.
  2534                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  2535                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  2536                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  2537                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  2538                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  2539                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  2540                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  2541                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  2542
  2543         16  EC-ST-AH-REFUND-CALC      PIC X.
  2544                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  2545                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  2546                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  2547                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  2548                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  2549                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  2550                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  2551                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  2552
  2553         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  51
* EL6311.cbl
  2554         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  2555         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  2556         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  2557         16  EC-AM-EXPIRATION-DT       PIC XX.
  2558         16  EC-AM-EFFECTIVE-DT        PIC XX.
  2559         16  EC-AM-CLASS-CD            PIC XX.
  2560         16  EC-AM-LF-DEVIATION        PIC XXX.
  2561         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  2562         16  EC-AM-AH-DEVIATION        PIC XXX.
  2563         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  2564         16  EC-AM-PHONE-NO            PIC X(10).
  2565
  2566         16  EC-AM-LF-REFUND-CALC      PIC X.
  2567                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  2568                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  2569                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  2570                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  2571                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  2572                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  2573                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  2574
  2575         16  EC-AM-AH-REFUND-CALC      PIC X.
  2576                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  2577                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  2578                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  2579                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  2580                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  2581                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  2582                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  2583
  2584         16  EC-AM-BEN-I-G-CD          PIC X.
  2585                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  2586                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  2587                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  2588
  2589         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  2590         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  2591         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  2592         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  2593         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  2594         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  2595         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  2596         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  2597         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  2598
  2599         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  2600         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  2601         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  2602         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  2603         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  2604         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  2605         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  2606         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  2607         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  2608         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  2609         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  2610         16  EC-RT-LF-NSP-ST           PIC XX.
  2611         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  52
* EL6311.cbl
  2612         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  2613         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  2614
  2615         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  2616             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  2617                                             'M' '5' '9' '2'.
  2618             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  2619             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  2620             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  2621             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  2622             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  2623             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  2624             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  2625             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  2626             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  2627             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  2628
  2629         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  2630             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  2631                                             'M' '5' '9' '2'.
  2632             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  2633             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  2634             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  2635             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  2636             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  2637             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  2638             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  2639             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  2640             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  2641             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  2642
  2643         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  2644         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  2645         16  EC-CM-LF-CANCEL-DT        PIC XX.
  2646         16  EC-CM-AH-CANCEL-DT        PIC XX.
  2647         16  EC-CM-DEATH-DT            PIC XX.
  2648
  2649*DMD CUSTOM CODING FIELDS BELOW
  2650*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  2651         16  EC-BR-DMD-RATING-SW       PIC X.
  2652                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  2653                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  2654                 88  NO-DMD-RATING               VALUE 'N'.
  2655
  2656         16  EC-NEW-CERT               PIC X(11).
  2657         16  EC-NEW-STATE              PIC XX.
  2658         16  FILLER                    PIC X.
  2659*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  2660         16  OVER-SHORT-EDIT-FIELDS.
  2661             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  2662             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  2663             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  2664             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  2665             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  2666             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  2667             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  2668             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  2669             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  53
* EL6311.cbl
  2670         16  FILLER                    PIC X(71).
  2671
  2672******************************************************************
  2673
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  54
* EL6311.cbl
  2675
  2676*    COPY ELCJPFX.
  2677******************************************************************
  2678*                                                                *
  2679*                                                                *
  2680*                            ELCJPFX.                            *
  2681*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2682*                            VMOD=2.002                          *
  2683*                                                                *
  2684*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2685*                                                                *
  2686*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2687*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2688*        ELCNTL - CONTROL FILE                                   *
  2689*        ELMSTR - CLAIM MASTERS                                  *
  2690*        ELTRLR - ACTIVITY TRAILERS                              *
  2691*        ELCHKQ - CHECK QUE                                      *
  2692******************************************************************
  2693 01  JOURNAL-RECORD.
  2694     12  JP-USER-ID                  PIC X(4).
  2695     12  JP-FILE-ID                  PIC X(8).
  2696     12  JP-PROGRAM-ID               PIC X(8).
  2697     12  JP-RECORD-TYPE              PIC X.
  2698         88 JP-ADD              VALUE 'A'.
  2699         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2700         88 JP-AFTER-CHANGE     VALUE 'C'.
  2701         88 JP-DELETE           VALUE 'D'.
  2702         88 JP-GENERIC-DELETE   VALUE 'G'.
  2703         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2704         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2705     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2706     12  JP-RECORD-AREA
  2707
  2708
  2709                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  55
* EL6311.cbl
  2711*    COPY ELCAID.
  2712******************************************************************
  2713*                                                                *
  2714*                            ELCAID.                             *
  2715*                            VMOD=2.001                          *
  2716*                                                                *
  2717*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2718*                                                                *
  2719*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2720*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2721******************************************************************
  2722
  2723 01  DFHAID.
  2724   02  DFHNULL   PIC  X  VALUE  ' '.
  2725   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2726   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2727   02  DFHPEN    PIC  X  VALUE  '='.
  2728   02  DFHOPID   PIC  X  VALUE  'W'.
  2729   02  DFHPA1    PIC  X  VALUE  '%'.
  2730   02  DFHPA2    PIC  X  VALUE  '>'.
  2731   02  DFHPA3    PIC  X  VALUE  ','.
  2732   02  DFHPF1    PIC  X  VALUE  '1'.
  2733   02  DFHPF2    PIC  X  VALUE  '2'.
  2734   02  DFHPF3    PIC  X  VALUE  '3'.
  2735   02  DFHPF4    PIC  X  VALUE  '4'.
  2736   02  DFHPF5    PIC  X  VALUE  '5'.
  2737   02  DFHPF6    PIC  X  VALUE  '6'.
  2738   02  DFHPF7    PIC  X  VALUE  '7'.
  2739   02  DFHPF8    PIC  X  VALUE  '8'.
  2740   02  DFHPF9    PIC  X  VALUE  '9'.
  2741   02  DFHPF10   PIC  X  VALUE  ':'.
  2742   02  DFHPF11   PIC  X  VALUE  '#'.
  2743   02  DFHPF12   PIC  X  VALUE  '@'.
  2744   02  DFHPF13   PIC  X  VALUE  'A'.
  2745   02  DFHPF14   PIC  X  VALUE  'B'.
  2746   02  DFHPF15   PIC  X  VALUE  'C'.
  2747   02  DFHPF16   PIC  X  VALUE  'D'.
  2748   02  DFHPF17   PIC  X  VALUE  'E'.
  2749   02  DFHPF18   PIC  X  VALUE  'F'.
  2750   02  DFHPF19   PIC  X  VALUE  'G'.
  2751   02  DFHPF20   PIC  X  VALUE  'H'.
  2752   02  DFHPF21   PIC  X  VALUE  'I'.
  2753*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2754   02  DFHPF22   PIC  X  VALUE  '['.
  2755   02  DFHPF23   PIC  X  VALUE  '.'.
  2756   02  DFHPF24   PIC  X  VALUE  '<'.
  2757   02  DFHMSRE   PIC  X  VALUE  'X'.
  2758   02  DFHSTRF   PIC  X  VALUE  'h'.
  2759   02  DFHTRIG   PIC  X  VALUE  '"'.
  2760
  2761 01  FILLER    REDEFINES DFHAID.
  2762     12  FILLER              PIC X(8).
  2763     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  2764
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  56
* EL6311.cbl
  2766*    COPY EL6311S.
  2767 01  EL631BI.
  2768     05  FILLER            PIC  X(0012).
  2769*    -------------------------------
  2770     05  BDATEL PIC S9(0004) COMP.
  2771     05  BDATEF PIC  X(0001).
  2772     05  FILLER REDEFINES BDATEF.
  2773         10  BDATEA PIC  X(0001).
  2774     05  BDATEI PIC  X(0008).
  2775*    -------------------------------
  2776     05  BTIMEL PIC S9(0004) COMP.
  2777     05  BTIMEF PIC  X(0001).
  2778     05  FILLER REDEFINES BTIMEF.
  2779         10  BTIMEA PIC  X(0001).
  2780     05  BTIMEI PIC  X(0005).
  2781*    -------------------------------
  2782     05  BNCERTLL PIC S9(0004) COMP.
  2783     05  BNCERTLF PIC  X(0001).
  2784     05  FILLER REDEFINES BNCERTLF.
  2785         10  BNCERTLA PIC  X(0001).
  2786     05  BNCERTLI PIC  X(0008).
  2787*    -------------------------------
  2788     05  BNCERTL PIC S9(0004) COMP.
  2789     05  BNCERTF PIC  X(0001).
  2790     05  FILLER REDEFINES BNCERTF.
  2791         10  BNCERTA PIC  X(0001).
  2792     05  BNCERTI PIC  X(0011).
  2793*    -------------------------------
  2794     05  BNSTATLL PIC S9(0004) COMP.
  2795     05  BNSTATLF PIC  X(0001).
  2796     05  FILLER REDEFINES BNSTATLF.
  2797         10  BNSTATLA PIC  X(0001).
  2798     05  BNSTATLI PIC  X(0009).
  2799*    -------------------------------
  2800     05  BNSTATL PIC S9(0004) COMP.
  2801     05  BNSTATF PIC  X(0001).
  2802     05  FILLER REDEFINES BNSTATF.
  2803         10  BNSTATA PIC  X(0001).
  2804     05  BNSTATI PIC  X(0002).
  2805*    -------------------------------
  2806     05  BCHGTL PIC S9(0004) COMP.
  2807     05  BCHGTF PIC  X(0001).
  2808     05  FILLER REDEFINES BCHGTF.
  2809         10  BCHGTA PIC  X(0001).
  2810     05  BCHGTI PIC  X(0004).
  2811*    -------------------------------
  2812     05  BCHGL PIC S9(0004) COMP.
  2813     05  BCHGF PIC  X(0001).
  2814     05  FILLER REDEFINES BCHGF.
  2815         10  BCHGA PIC  X(0001).
  2816     05  BCHGI PIC  X(0004).
  2817*    -------------------------------
  2818     05  BMAINTL PIC S9(0004) COMP.
  2819     05  BMAINTF PIC  X(0001).
  2820     05  FILLER REDEFINES BMAINTF.
  2821         10  BMAINTA PIC  X(0001).
  2822     05  BMAINTI PIC  X(0001).
  2823*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  57
* EL6311.cbl
  2824     05  BMANTBYL PIC S9(0004) COMP.
  2825     05  BMANTBYF PIC  X(0001).
  2826     05  FILLER REDEFINES BMANTBYF.
  2827         10  BMANTBYA PIC  X(0001).
  2828     05  BMANTBYI PIC  X(0004).
  2829*    -------------------------------
  2830     05  BCHGHDGL PIC S9(0004) COMP.
  2831     05  BCHGHDGF PIC  X(0001).
  2832     05  FILLER REDEFINES BCHGHDGF.
  2833         10  BCHGHDGA PIC  X(0001).
  2834     05  BCHGHDGI PIC  X(0003).
  2835*    -------------------------------
  2836     05  BMANTDTL PIC S9(0004) COMP.
  2837     05  BMANTDTF PIC  X(0001).
  2838     05  FILLER REDEFINES BMANTDTF.
  2839         10  BMANTDTA PIC  X(0001).
  2840     05  BMANTDTI PIC  X(0008).
  2841*    -------------------------------
  2842     05  BMANTATL PIC S9(0004) COMP.
  2843     05  BMANTATF PIC  X(0001).
  2844     05  FILLER REDEFINES BMANTATF.
  2845         10  BMANTATA PIC  X(0001).
  2846     05  BMANTATI PIC  X(0005).
  2847*    -------------------------------
  2848     05  BCSRL PIC S9(0004) COMP.
  2849     05  BCSRF PIC  X(0001).
  2850     05  FILLER REDEFINES BCSRF.
  2851         10  BCSRA PIC  X(0001).
  2852     05  BCSRI PIC  X(0004).
  2853*    -------------------------------
  2854     05  BBATCHL PIC S9(0004) COMP.
  2855     05  BBATCHF PIC  X(0001).
  2856     05  FILLER REDEFINES BBATCHF.
  2857         10  BBATCHA PIC  X(0001).
  2858     05  BBATCHI PIC  X(0006).
  2859*    -------------------------------
  2860     05  BSEQL PIC S9(0004) COMP.
  2861     05  BSEQF PIC  X(0001).
  2862     05  FILLER REDEFINES BSEQF.
  2863         10  BSEQA PIC  X(0001).
  2864     05  BSEQI PIC  X(0004).
  2865*    -------------------------------
  2866     05  BMOENDTL PIC S9(0004) COMP.
  2867     05  BMOENDTF PIC  X(0001).
  2868     05  FILLER REDEFINES BMOENDTF.
  2869         10  BMOENDTA PIC  X(0001).
  2870     05  BMOENDTI PIC  X(0008).
  2871*    -------------------------------
  2872     05  BCARRL PIC S9(0004) COMP.
  2873     05  BCARRF PIC  X(0001).
  2874     05  FILLER REDEFINES BCARRF.
  2875         10  BCARRA PIC  X(0001).
  2876     05  BCARRI PIC  X(0001).
  2877*    -------------------------------
  2878     05  BGROUPL PIC S9(0004) COMP.
  2879     05  BGROUPF PIC  X(0001).
  2880     05  FILLER REDEFINES BGROUPF.
  2881         10  BGROUPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  58
* EL6311.cbl
  2882     05  BGROUPI PIC  X(0006).
  2883*    -------------------------------
  2884     05  BSTATEL PIC S9(0004) COMP.
  2885     05  BSTATEF PIC  X(0001).
  2886     05  FILLER REDEFINES BSTATEF.
  2887         10  BSTATEA PIC  X(0001).
  2888     05  BSTATEI PIC  X(0002).
  2889*    -------------------------------
  2890     05  BACCTL PIC S9(0004) COMP.
  2891     05  BACCTF PIC  X(0001).
  2892     05  FILLER REDEFINES BACCTF.
  2893         10  BACCTA PIC  X(0001).
  2894     05  BACCTI PIC  X(0010).
  2895*    -------------------------------
  2896     05  BVINHL PIC S9(0004) COMP.
  2897     05  BVINHF PIC  X(0001).
  2898     05  FILLER REDEFINES BVINHF.
  2899         10  BVINHA PIC  X(0001).
  2900     05  BVINHI PIC  X(0004).
  2901*    -------------------------------
  2902     05  BVINL PIC S9(0004) COMP.
  2903     05  BVINF PIC  X(0001).
  2904     05  FILLER REDEFINES BVINF.
  2905         10  BVINA PIC  X(0001).
  2906     05  BVINI PIC  X(0017).
  2907*    -------------------------------
  2908     05  BREFHDGL PIC S9(0004) COMP.
  2909     05  BREFHDGF PIC  X(0001).
  2910     05  FILLER REDEFINES BREFHDGF.
  2911         10  BREFHDGA PIC  X(0001).
  2912     05  BREFHDGI PIC  X(0004).
  2913*    -------------------------------
  2914     05  BREFL PIC S9(0004) COMP.
  2915     05  BREFF PIC  X(0001).
  2916     05  FILLER REDEFINES BREFF.
  2917         10  BREFA PIC  X(0001).
  2918     05  BREFI PIC  X(0012).
  2919*    -------------------------------
  2920     05  BMICRNOL PIC S9(0004) COMP.
  2921     05  BMICRNOF PIC  X(0001).
  2922     05  FILLER REDEFINES BMICRNOF.
  2923         10  BMICRNOA PIC  X(0001).
  2924     05  BMICRNOI PIC  9(9).
  2925*    -------------------------------
  2926     05  BCERTNOL PIC S9(0004) COMP.
  2927     05  BCERTNOF PIC  X(0001).
  2928     05  FILLER REDEFINES BCERTNOF.
  2929         10  BCERTNOA PIC  X(0001).
  2930     05  BCERTNOI PIC  X(0010).
  2931*    -------------------------------
  2932     05  BSUFIXL PIC S9(0004) COMP.
  2933     05  BSUFIXF PIC  X(0001).
  2934     05  FILLER REDEFINES BSUFIXF.
  2935         10  BSUFIXA PIC  X(0001).
  2936     05  BSUFIXI PIC  X(0001).
  2937*    -------------------------------
  2938     05  BEFFDTL PIC S9(0004) COMP.
  2939     05  BEFFDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  59
* EL6311.cbl
  2940     05  FILLER REDEFINES BEFFDTF.
  2941         10  BEFFDTA PIC  X(0001).
  2942     05  BEFFDTI PIC  X(0008).
  2943*    -------------------------------
  2944     05  BLSTNML PIC S9(0004) COMP.
  2945     05  BLSTNMF PIC  X(0001).
  2946     05  FILLER REDEFINES BLSTNMF.
  2947         10  BLSTNMA PIC  X(0001).
  2948     05  BLSTNMI PIC  X(0015).
  2949*    -------------------------------
  2950     05  B1STNML PIC S9(0004) COMP.
  2951     05  B1STNMF PIC  X(0001).
  2952     05  FILLER REDEFINES B1STNMF.
  2953         10  B1STNMA PIC  X(0001).
  2954     05  B1STNMI PIC  X(0010).
  2955*    -------------------------------
  2956     05  BINITL PIC S9(0004) COMP.
  2957     05  BINITF PIC  X(0001).
  2958     05  FILLER REDEFINES BINITF.
  2959         10  BINITA PIC  X(0001).
  2960     05  BINITI PIC  X(0001).
  2961*    -------------------------------
  2962     05  BSEXL PIC S9(0004) COMP.
  2963     05  BSEXF PIC  X(0001).
  2964     05  FILLER REDEFINES BSEXF.
  2965         10  BSEXA PIC  X(0001).
  2966     05  BSEXI PIC  X(0001).
  2967*    -------------------------------
  2968     05  BAGEL PIC S9(0004) COMP.
  2969     05  BAGEF PIC  X(0001).
  2970     05  FILLER REDEFINES BAGEF.
  2971         10  BAGEA PIC  X(0001).
  2972     05  BAGEI PIC  X(0002).
  2973*    -------------------------------
  2974     05  BBIRTHL PIC S9(0004) COMP.
  2975     05  BBIRTHF PIC  X(0001).
  2976     05  FILLER REDEFINES BBIRTHF.
  2977         10  BBIRTHA PIC  X(0001).
  2978     05  BBIRTHI PIC  X(0008).
  2979*    -------------------------------
  2980     05  B1STPMTL PIC S9(0004) COMP.
  2981     05  B1STPMTF PIC  X(0001).
  2982     05  FILLER REDEFINES B1STPMTF.
  2983         10  B1STPMTA PIC  X(0001).
  2984     05  B1STPMTI PIC  X(0008).
  2985*    -------------------------------
  2986     05  BDAYSL PIC S9(0004) COMP.
  2987     05  BDAYSF PIC  X(0001).
  2988     05  FILLER REDEFINES BDAYSF.
  2989         10  BDAYSA PIC  X(0001).
  2990     05  BDAYSI PIC  X(0003).
  2991*    -------------------------------
  2992     05  BLNTRML PIC S9(0004) COMP.
  2993     05  BLNTRMF PIC  X(0001).
  2994     05  FILLER REDEFINES BLNTRMF.
  2995         10  BLNTRMA PIC  X(0001).
  2996     05  BLNTRMI PIC  X(0003).
  2997*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  60
* EL6311.cbl
  2998     05  BLNOFCRL PIC S9(0004) COMP.
  2999     05  BLNOFCRF PIC  X(0001).
  3000     05  FILLER REDEFINES BLNOFCRF.
  3001         10  BLNOFCRA PIC  X(0001).
  3002     05  BLNOFCRI PIC  X(0005).
  3003*    -------------------------------
  3004     05  BMODEL PIC S9(0004) COMP.
  3005     05  BMODEF PIC  X(0001).
  3006     05  FILLER REDEFINES BMODEF.
  3007         10  BMODEA PIC  X(0001).
  3008     05  BMODEI PIC  X(0001).
  3009*    -------------------------------
  3010     05  BFREQL PIC S9(0004) COMP.
  3011     05  BFREQF PIC  X(0001).
  3012     05  FILLER REDEFINES BFREQF.
  3013         10  BFREQA PIC  X(0001).
  3014     05  BFREQI PIC  X(0002).
  3015*    -------------------------------
  3016     05  BPMTSL PIC S9(0004) COMP.
  3017     05  BPMTSF PIC  X(0001).
  3018     05  FILLER REDEFINES BPMTSF.
  3019         10  BPMTSA PIC  X(0001).
  3020     05  BPMTSI PIC  999.
  3021*    -------------------------------
  3022     05  BPMTAMTL PIC S9(0004) COMP.
  3023     05  BPMTAMTF PIC  X(0001).
  3024     05  FILLER REDEFINES BPMTAMTF.
  3025         10  BPMTAMTA PIC  X(0001).
  3026     05  BPMTAMTI PIC  9(7)V99.
  3027*    -------------------------------
  3028     05  BAPRL PIC S9(0004) COMP.
  3029     05  BAPRF PIC  X(0001).
  3030     05  FILLER REDEFINES BAPRF.
  3031         10  BAPRA PIC  X(0001).
  3032     05  BAPRI PIC  X(7).
  3033*    -------------------------------
  3034     05  BLIVESL PIC S9(0004) COMP.
  3035     05  BLIVESF PIC  X(0001).
  3036     05  FILLER REDEFINES BLIVESF.
  3037         10  BLIVESA PIC  X(0001).
  3038     05  BLIVESI PIC  X(0009).
  3039*    -------------------------------
  3040     05  BMEMCAPL PIC S9(0004) COMP.
  3041     05  BMEMCAPF PIC  X(0001).
  3042     05  FILLER REDEFINES BMEMCAPF.
  3043         10  BMEMCAPA PIC  X(0001).
  3044     05  BMEMCAPI PIC  X(0011).
  3045*    -------------------------------
  3046     05  BORIGHDL PIC S9(0004) COMP.
  3047     05  BORIGHDF PIC  X(0001).
  3048     05  FILLER REDEFINES BORIGHDF.
  3049         10  BORIGHDA PIC  X(0001).
  3050     05  BORIGHDI PIC  X(0009).
  3051*    -------------------------------
  3052     05  DMDBILL PIC S9(0004) COMP.
  3053     05  DMDBILF PIC  X(0001).
  3054     05  FILLER REDEFINES DMDBILF.
  3055         10  DMDBILA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  61
* EL6311.cbl
  3056     05  DMDBILI PIC  X(0006).
  3057*    -------------------------------
  3058     05  BFORCEL PIC S9(0004) COMP.
  3059     05  BFORCEF PIC  X(0001).
  3060     05  FILLER REDEFINES BFORCEF.
  3061         10  BFORCEA PIC  X(0001).
  3062     05  BFORCEI PIC  X(0001).
  3063*    -------------------------------
  3064     05  BENTRYL PIC S9(0004) COMP.
  3065     05  BENTRYF PIC  X(0001).
  3066     05  FILLER REDEFINES BENTRYF.
  3067         10  BENTRYA PIC  X(0001).
  3068     05  BENTRYI PIC  X(0001).
  3069*    -------------------------------
  3070     05  BREINL PIC S9(0004) COMP.
  3071     05  BREINF PIC  X(0001).
  3072     05  FILLER REDEFINES BREINF.
  3073         10  BREINA PIC  X(0001).
  3074     05  BREINI PIC  X(0001).
  3075*    -------------------------------
  3076     05  BBILCDL PIC S9(0004) COMP.
  3077     05  BBILCDF PIC  X(0001).
  3078     05  FILLER REDEFINES BBILCDF.
  3079         10  BBILCDA PIC  X(0001).
  3080     05  BBILCDI PIC  X(0001).
  3081*    -------------------------------
  3082     05  BUNWRITL PIC S9(0004) COMP.
  3083     05  BUNWRITF PIC  X(0001).
  3084     05  FILLER REDEFINES BUNWRITF.
  3085         10  BUNWRITA PIC  X(0001).
  3086     05  BUNWRITI PIC  X(0001).
  3087*    -------------------------------
  3088     05  BSKPCDL PIC S9(0004) COMP.
  3089     05  BSKPCDF PIC  X(0001).
  3090     05  FILLER REDEFINES BSKPCDF.
  3091         10  BSKPCDA PIC  X(0001).
  3092     05  BSKPCDI PIC  X(0001).
  3093*    -------------------------------
  3094     05  BINDGRPL PIC S9(0004) COMP.
  3095     05  BINDGRPF PIC  X(0001).
  3096     05  FILLER REDEFINES BINDGRPF.
  3097         10  BINDGRPA PIC  X(0001).
  3098     05  BINDGRPI PIC  X(0001).
  3099*    -------------------------------
  3100     05  BSIGL PIC S9(0004) COMP.
  3101     05  BSIGF PIC  X(0001).
  3102     05  FILLER REDEFINES BSIGF.
  3103         10  BSIGA PIC  X(0001).
  3104     05  BSIGI PIC  X(0001).
  3105*    -------------------------------
  3106     05  BRTCLSL PIC S9(0004) COMP.
  3107     05  BRTCLSF PIC  X(0001).
  3108     05  FILLER REDEFINES BRTCLSF.
  3109         10  BRTCLSA PIC  X(0001).
  3110     05  BRTCLSI PIC  X(0002).
  3111*    -------------------------------
  3112     05  BCHGCNTL PIC S9(0004) COMP.
  3113     05  BCHGCNTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  62
* EL6311.cbl
  3114     05  FILLER REDEFINES BCHGCNTF.
  3115         10  BCHGCNTA PIC  X(0001).
  3116     05  BCHGCNTI PIC  X(0003).
  3117*    -------------------------------
  3118     05  BMEMBERL PIC S9(0004) COMP.
  3119     05  BMEMBERF PIC  X(0001).
  3120     05  FILLER REDEFINES BMEMBERF.
  3121         10  BMEMBERA PIC  X(0001).
  3122     05  BMEMBERI PIC  X(0012).
  3123*    -------------------------------
  3124     05  BORGNOL PIC S9(0004) COMP.
  3125     05  BORGNOF PIC  X(0001).
  3126     05  FILLER REDEFINES BORGNOF.
  3127         10  BORGNOA PIC  X(0001).
  3128     05  BORGNOI PIC  X(0006).
  3129*    -------------------------------
  3130     05  BORGSEQL PIC S9(0004) COMP.
  3131     05  BORGSEQF PIC  X(0001).
  3132     05  FILLER REDEFINES BORGSEQF.
  3133         10  BORGSEQA PIC  X(0001).
  3134     05  BORGSEQI PIC  X(0004).
  3135*    -------------------------------
  3136     05  BBILLEDL PIC S9(0004) COMP.
  3137     05  BBILLEDF PIC  X(0001).
  3138     05  FILLER REDEFINES BBILLEDF.
  3139         10  BBILLEDA PIC  X(0001).
  3140     05  BBILLEDI PIC  9(9).
  3141*    -------------------------------
  3142     05  BKIND1L PIC S9(0004) COMP.
  3143     05  BKIND1F PIC  X(0001).
  3144     05  FILLER REDEFINES BKIND1F.
  3145         10  BKIND1A PIC  X(0001).
  3146     05  BKIND1I PIC  X(0002).
  3147*    -------------------------------
  3148     05  BTYPE1L PIC S9(0004) COMP.
  3149     05  BTYPE1F PIC  X(0001).
  3150     05  FILLER REDEFINES BTYPE1F.
  3151         10  BTYPE1A PIC  X(0001).
  3152     05  BTYPE1I PIC  X(0003).
  3153*    -------------------------------
  3154     05  BTERM1L PIC S9(0004) COMP.
  3155     05  BTERM1F PIC  X(0001).
  3156     05  FILLER REDEFINES BTERM1F.
  3157         10  BTERM1A PIC  X(0001).
  3158     05  BTERM1I PIC  X(0003).
  3159*    -------------------------------
  3160     05  BBEN1L PIC S9(0004) COMP.
  3161     05  BBEN1F PIC  X(0001).
  3162     05  FILLER REDEFINES BBEN1F.
  3163         10  BBEN1A PIC  X(0001).
  3164     05  BBEN1I PIC  X(0012).
  3165*    -------------------------------
  3166     05  BPREM1L PIC S9(0004) COMP.
  3167     05  BPREM1F PIC  X(0001).
  3168     05  FILLER REDEFINES BPREM1F.
  3169         10  BPREM1A PIC  X(0001).
  3170     05  BPREM1I PIC  X(0011).
  3171*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  63
* EL6311.cbl
  3172     05  BEXPIR1L PIC S9(0004) COMP.
  3173     05  BEXPIR1F PIC  X(0001).
  3174     05  FILLER REDEFINES BEXPIR1F.
  3175         10  BEXPIR1A PIC  X(0001).
  3176     05  BEXPIR1I PIC  X(0008).
  3177*    -------------------------------
  3178     05  BCP1L PIC S9(0004) COMP.
  3179     05  BCP1F PIC  X(0001).
  3180     05  FILLER REDEFINES BCP1F.
  3181         10  BCP1A PIC  X(0001).
  3182     05  BCP1I PIC  X(0002).
  3183*    -------------------------------
  3184     05  BALTBN1L PIC S9(0004) COMP.
  3185     05  BALTBN1F PIC  X(0001).
  3186     05  FILLER REDEFINES BALTBN1F.
  3187         10  BALTBN1A PIC  X(0001).
  3188     05  BALTBN1I PIC  X(0012).
  3189*    -------------------------------
  3190     05  BALTPR1L PIC S9(0004) COMP.
  3191     05  BALTPR1F PIC  X(0001).
  3192     05  FILLER REDEFINES BALTPR1F.
  3193         10  BALTPR1A PIC  X(0001).
  3194     05  BALTPR1I PIC  X(0011).
  3195*    -------------------------------
  3196     05  BBNCD1L PIC S9(0004) COMP.
  3197     05  BBNCD1F PIC  X(0001).
  3198     05  FILLER REDEFINES BBNCD1F.
  3199         10  BBNCD1A PIC  X(0001).
  3200     05  BBNCD1I PIC  X(0003).
  3201*    -------------------------------
  3202     05  BCPRM1L PIC S9(0004) COMP.
  3203     05  BCPRM1F PIC  X(0001).
  3204     05  FILLER REDEFINES BCPRM1F.
  3205         10  BCPRM1A PIC  X(0001).
  3206     05  BCPRM1I PIC  X(0011).
  3207*    -------------------------------
  3208     05  BCAPRM1L PIC S9(0004) COMP.
  3209     05  BCAPRM1F PIC  X(0001).
  3210     05  FILLER REDEFINES BCAPRM1F.
  3211         10  BCAPRM1A PIC  X(0001).
  3212     05  BCAPRM1I PIC  X(0011).
  3213*    -------------------------------
  3214     05  BENABR1L PIC S9(0004) COMP.
  3215     05  BENABR1F PIC  X(0001).
  3216     05  FILLER REDEFINES BENABR1F.
  3217         10  BENABR1A PIC  X(0001).
  3218     05  BENABR1I PIC  X(0005).
  3219*    -------------------------------
  3220     05  BDIFF1L PIC S9(0004) COMP.
  3221     05  BDIFF1F PIC  X(0001).
  3222     05  FILLER REDEFINES BDIFF1F.
  3223         10  BDIFF1A PIC  X(0001).
  3224     05  BDIFF1I PIC  X(0011).
  3225*    -------------------------------
  3226     05  BBILIT1L PIC S9(0004) COMP.
  3227     05  BBILIT1F PIC  X(0001).
  3228     05  FILLER REDEFINES BBILIT1F.
  3229         10  BBILIT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  64
* EL6311.cbl
  3230     05  BBILIT1I PIC  X(0008).
  3231*    -------------------------------
  3232     05  BADIFF1L PIC S9(0004) COMP.
  3233     05  BADIFF1F PIC  X(0001).
  3234     05  FILLER REDEFINES BADIFF1F.
  3235         10  BADIFF1A PIC  X(0001).
  3236     05  BADIFF1I PIC  X(0011).
  3237*    -------------------------------
  3238     05  BKIND2L PIC S9(0004) COMP.
  3239     05  BKIND2F PIC  X(0001).
  3240     05  FILLER REDEFINES BKIND2F.
  3241         10  BKIND2A PIC  X(0001).
  3242     05  BKIND2I PIC  X(0002).
  3243*    -------------------------------
  3244     05  BTYPE2L PIC S9(0004) COMP.
  3245     05  BTYPE2F PIC  X(0001).
  3246     05  FILLER REDEFINES BTYPE2F.
  3247         10  BTYPE2A PIC  X(0001).
  3248     05  BTYPE2I PIC  X(0003).
  3249*    -------------------------------
  3250     05  BTERM2L PIC S9(0004) COMP.
  3251     05  BTERM2F PIC  X(0001).
  3252     05  FILLER REDEFINES BTERM2F.
  3253         10  BTERM2A PIC  X(0001).
  3254     05  BTERM2I PIC  X(0003).
  3255*    -------------------------------
  3256     05  BBEN2L PIC S9(0004) COMP.
  3257     05  BBEN2F PIC  X(0001).
  3258     05  FILLER REDEFINES BBEN2F.
  3259         10  BBEN2A PIC  X(0001).
  3260     05  BBEN2I PIC  X(0012).
  3261*    -------------------------------
  3262     05  BPREM2L PIC S9(0004) COMP.
  3263     05  BPREM2F PIC  X(0001).
  3264     05  FILLER REDEFINES BPREM2F.
  3265         10  BPREM2A PIC  X(0001).
  3266     05  BPREM2I PIC  X(0011).
  3267*    -------------------------------
  3268     05  BEXPIR2L PIC S9(0004) COMP.
  3269     05  BEXPIR2F PIC  X(0001).
  3270     05  FILLER REDEFINES BEXPIR2F.
  3271         10  BEXPIR2A PIC  X(0001).
  3272     05  BEXPIR2I PIC  X(0008).
  3273*    -------------------------------
  3274     05  BCP2L PIC S9(0004) COMP.
  3275     05  BCP2F PIC  X(0001).
  3276     05  FILLER REDEFINES BCP2F.
  3277         10  BCP2A PIC  X(0001).
  3278     05  BCP2I PIC  X(0002).
  3279*    -------------------------------
  3280     05  BALTBN2L PIC S9(0004) COMP.
  3281     05  BALTBN2F PIC  X(0001).
  3282     05  FILLER REDEFINES BALTBN2F.
  3283         10  BALTBN2A PIC  X(0001).
  3284     05  BALTBN2I PIC  X(0012).
  3285*    -------------------------------
  3286     05  BALTPR2L PIC S9(0004) COMP.
  3287     05  BALTPR2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  65
* EL6311.cbl
  3288     05  FILLER REDEFINES BALTPR2F.
  3289         10  BALTPR2A PIC  X(0001).
  3290     05  BALTPR2I PIC  X(0011).
  3291*    -------------------------------
  3292     05  BBNCD2L PIC S9(0004) COMP.
  3293     05  BBNCD2F PIC  X(0001).
  3294     05  FILLER REDEFINES BBNCD2F.
  3295         10  BBNCD2A PIC  X(0001).
  3296     05  BBNCD2I PIC  X(0003).
  3297*    -------------------------------
  3298     05  BCPRM2L PIC S9(0004) COMP.
  3299     05  BCPRM2F PIC  X(0001).
  3300     05  FILLER REDEFINES BCPRM2F.
  3301         10  BCPRM2A PIC  X(0001).
  3302     05  BCPRM2I PIC  X(0011).
  3303*    -------------------------------
  3304     05  BCAPRM2L PIC S9(0004) COMP.
  3305     05  BCAPRM2F PIC  X(0001).
  3306     05  FILLER REDEFINES BCAPRM2F.
  3307         10  BCAPRM2A PIC  X(0001).
  3308     05  BCAPRM2I PIC  X(0011).
  3309*    -------------------------------
  3310     05  BENABR2L PIC S9(0004) COMP.
  3311     05  BENABR2F PIC  X(0001).
  3312     05  FILLER REDEFINES BENABR2F.
  3313         10  BENABR2A PIC  X(0001).
  3314     05  BENABR2I PIC  X(0005).
  3315*    -------------------------------
  3316     05  BDIFF2L PIC S9(0004) COMP.
  3317     05  BDIFF2F PIC  X(0001).
  3318     05  FILLER REDEFINES BDIFF2F.
  3319         10  BDIFF2A PIC  X(0001).
  3320     05  BDIFF2I PIC  X(0011).
  3321*    -------------------------------
  3322     05  BBILIT2L PIC S9(0004) COMP.
  3323     05  BBILIT2F PIC  X(0001).
  3324     05  FILLER REDEFINES BBILIT2F.
  3325         10  BBILIT2A PIC  X(0001).
  3326     05  BBILIT2I PIC  X(0008).
  3327*    -------------------------------
  3328     05  BADIFF2L PIC S9(0004) COMP.
  3329     05  BADIFF2F PIC  X(0001).
  3330     05  FILLER REDEFINES BADIFF2F.
  3331         10  BADIFF2A PIC  X(0001).
  3332     05  BADIFF2I PIC  X(0011).
  3333*    -------------------------------
  3334     05  BERMSG1L PIC S9(0004) COMP.
  3335     05  BERMSG1F PIC  X(0001).
  3336     05  FILLER REDEFINES BERMSG1F.
  3337         10  BERMSG1A PIC  X(0001).
  3338     05  BERMSG1I PIC  X(0078).
  3339*    -------------------------------
  3340     05  BERMSG2L PIC S9(0004) COMP.
  3341     05  BERMSG2F PIC  X(0001).
  3342     05  FILLER REDEFINES BERMSG2F.
  3343         10  BERMSG2A PIC  X(0001).
  3344     05  BERMSG2I PIC  X(0078).
  3345*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  66
* EL6311.cbl
  3346     05  BERMSG3L PIC S9(0004) COMP.
  3347     05  BERMSG3F PIC  X(0001).
  3348     05  FILLER REDEFINES BERMSG3F.
  3349         10  BERMSG3A PIC  X(0001).
  3350     05  BERMSG3I PIC  X(0078).
  3351*    -------------------------------
  3352     05  BPFENTRL PIC S9(0004) COMP.
  3353     05  BPFENTRF PIC  X(0001).
  3354     05  FILLER REDEFINES BPFENTRF.
  3355         10  BPFENTRA PIC  X(0001).
  3356     05  BPFENTRI PIC  9(2).
  3357*    -------------------------------
  3358     05  BPF5HDRL PIC S9(0004) COMP.
  3359     05  BPF5HDRF PIC  X(0001).
  3360     05  FILLER REDEFINES BPF5HDRF.
  3361         10  BPF5HDRA PIC  X(0001).
  3362     05  BPF5HDRI PIC  X(0005).
  3363*    -------------------------------
  3364     05  BPF4HDRL PIC S9(0004) COMP.
  3365     05  BPF4HDRF PIC  X(0001).
  3366     05  FILLER REDEFINES BPF4HDRF.
  3367         10  BPF4HDRA PIC  X(0001).
  3368     05  BPF4HDRI PIC  X(0013).
  3369 01  EL631BO REDEFINES EL631BI.
  3370     05  FILLER            PIC  X(0012).
  3371*    -------------------------------
  3372     05  FILLER            PIC  X(0003).
  3373     05  BDATEO PIC  X(0008).
  3374*    -------------------------------
  3375     05  FILLER            PIC  X(0003).
  3376     05  BTIMEO PIC  99.99.
  3377*    -------------------------------
  3378     05  FILLER            PIC  X(0003).
  3379     05  BNCERTLO PIC  X(0008).
  3380*    -------------------------------
  3381     05  FILLER            PIC  X(0003).
  3382     05  BNCERTO PIC  X(0011).
  3383*    -------------------------------
  3384     05  FILLER            PIC  X(0003).
  3385     05  BNSTATLO PIC  X(0009).
  3386*    -------------------------------
  3387     05  FILLER            PIC  X(0003).
  3388     05  BNSTATO PIC  X(0002).
  3389*    -------------------------------
  3390     05  FILLER            PIC  X(0003).
  3391     05  BCHGTO PIC  X(0004).
  3392*    -------------------------------
  3393     05  FILLER            PIC  X(0003).
  3394     05  BCHGO PIC  ZZZ9.
  3395*    -------------------------------
  3396     05  FILLER            PIC  X(0003).
  3397     05  BMAINTO PIC  X(0001).
  3398*    -------------------------------
  3399     05  FILLER            PIC  X(0003).
  3400     05  BMANTBYO PIC  X(0004).
  3401*    -------------------------------
  3402     05  FILLER            PIC  X(0003).
  3403     05  BCHGHDGO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  67
* EL6311.cbl
  3404*    -------------------------------
  3405     05  FILLER            PIC  X(0003).
  3406     05  BMANTDTO PIC  X(0008).
  3407*    -------------------------------
  3408     05  FILLER            PIC  X(0003).
  3409     05  BMANTATO PIC  99.99.
  3410*    -------------------------------
  3411     05  FILLER            PIC  X(0003).
  3412     05  BCSRO PIC  X(0004).
  3413*    -------------------------------
  3414     05  FILLER            PIC  X(0003).
  3415     05  BBATCHO PIC  X(0006).
  3416*    -------------------------------
  3417     05  FILLER            PIC  X(0003).
  3418     05  BSEQO PIC  X(0004).
  3419*    -------------------------------
  3420     05  FILLER            PIC  X(0003).
  3421     05  BMOENDTO PIC  X(0008).
  3422*    -------------------------------
  3423     05  FILLER            PIC  X(0003).
  3424     05  BCARRO PIC  X(0001).
  3425*    -------------------------------
  3426     05  FILLER            PIC  X(0003).
  3427     05  BGROUPO PIC  X(0006).
  3428*    -------------------------------
  3429     05  FILLER            PIC  X(0003).
  3430     05  BSTATEO PIC  X(0002).
  3431*    -------------------------------
  3432     05  FILLER            PIC  X(0003).
  3433     05  BACCTO PIC  X(0010).
  3434*    -------------------------------
  3435     05  FILLER            PIC  X(0003).
  3436     05  BVINHO PIC  X(0004).
  3437*    -------------------------------
  3438     05  FILLER            PIC  X(0003).
  3439     05  BVINO PIC  X(0017).
  3440*    -------------------------------
  3441     05  FILLER            PIC  X(0003).
  3442     05  BREFHDGO PIC  X(0004).
  3443*    -------------------------------
  3444     05  FILLER            PIC  X(0003).
  3445     05  BREFO PIC  X(0012).
  3446*    -------------------------------
  3447     05  FILLER            PIC  X(0003).
  3448     05  BMICRNOO PIC  999999999.
  3449*    -------------------------------
  3450     05  FILLER            PIC  X(0003).
  3451     05  BCERTNOO PIC  X(0010).
  3452*    -------------------------------
  3453     05  FILLER            PIC  X(0003).
  3454     05  BSUFIXO PIC  X(0001).
  3455*    -------------------------------
  3456     05  FILLER            PIC  X(0003).
  3457     05  BEFFDTO PIC  X(0008).
  3458*    -------------------------------
  3459     05  FILLER            PIC  X(0003).
  3460     05  BLSTNMO PIC  X(0015).
  3461*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  68
* EL6311.cbl
  3462     05  FILLER            PIC  X(0003).
  3463     05  B1STNMO PIC  X(0010).
  3464*    -------------------------------
  3465     05  FILLER            PIC  X(0003).
  3466     05  BINITO PIC  X(0001).
  3467*    -------------------------------
  3468     05  FILLER            PIC  X(0003).
  3469     05  BSEXO PIC  X(0001).
  3470*    -------------------------------
  3471     05  FILLER            PIC  X(0003).
  3472     05  BAGEO PIC  X(0002).
  3473*    -------------------------------
  3474     05  FILLER            PIC  X(0003).
  3475     05  BBIRTHO PIC  X(0008).
  3476*    -------------------------------
  3477     05  FILLER            PIC  X(0003).
  3478     05  B1STPMTO PIC  X(0008).
  3479*    -------------------------------
  3480     05  FILLER            PIC  X(0003).
  3481     05  BDAYSO PIC  X(0003).
  3482*    -------------------------------
  3483     05  FILLER            PIC  X(0003).
  3484     05  BLNTRMO PIC  X(0003).
  3485*    -------------------------------
  3486     05  FILLER            PIC  X(0003).
  3487     05  BLNOFCRO PIC  X(0005).
  3488*    -------------------------------
  3489     05  FILLER            PIC  X(0003).
  3490     05  BMODEO PIC  X(0001).
  3491*    -------------------------------
  3492     05  FILLER            PIC  X(0003).
  3493     05  BFREQO PIC  X(0002).
  3494*    -------------------------------
  3495     05  FILLER            PIC  X(0003).
  3496     05  BPMTSO PIC  X(0003).
  3497*    -------------------------------
  3498     05  FILLER            PIC  X(0003).
  3499     05  BPMTAMTO PIC  ZZZZZ9.99.
  3500*    -------------------------------
  3501     05  FILLER            PIC  X(0003).
  3502     05  BAPRO PIC  99.9999.
  3503*    -------------------------------
  3504     05  FILLER            PIC  X(0003).
  3505     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  3506*    -------------------------------
  3507     05  FILLER            PIC  X(0003).
  3508     05  BMEMCAPO PIC  X(0011).
  3509*    -------------------------------
  3510     05  FILLER            PIC  X(0003).
  3511     05  BORIGHDO PIC  X(0009).
  3512*    -------------------------------
  3513     05  FILLER            PIC  X(0003).
  3514     05  DMDBILO PIC  X(0006).
  3515*    -------------------------------
  3516     05  FILLER            PIC  X(0003).
  3517     05  BFORCEO PIC  X(0001).
  3518*    -------------------------------
  3519     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  69
* EL6311.cbl
  3520     05  BENTRYO PIC  X(0001).
  3521*    -------------------------------
  3522     05  FILLER            PIC  X(0003).
  3523     05  BREINO PIC  X(0001).
  3524*    -------------------------------
  3525     05  FILLER            PIC  X(0003).
  3526     05  BBILCDO PIC  X(0001).
  3527*    -------------------------------
  3528     05  FILLER            PIC  X(0003).
  3529     05  BUNWRITO PIC  X(0001).
  3530*    -------------------------------
  3531     05  FILLER            PIC  X(0003).
  3532     05  BSKPCDO PIC  X(0001).
  3533*    -------------------------------
  3534     05  FILLER            PIC  X(0003).
  3535     05  BINDGRPO PIC  X(0001).
  3536*    -------------------------------
  3537     05  FILLER            PIC  X(0003).
  3538     05  BSIGO PIC  X(0001).
  3539*    -------------------------------
  3540     05  FILLER            PIC  X(0003).
  3541     05  BRTCLSO PIC  X(0002).
  3542*    -------------------------------
  3543     05  FILLER            PIC  X(0003).
  3544     05  BCHGCNTO PIC  X(0003).
  3545*    -------------------------------
  3546     05  FILLER            PIC  X(0003).
  3547     05  BMEMBERO PIC  X(0012).
  3548*    -------------------------------
  3549     05  FILLER            PIC  X(0003).
  3550     05  BORGNOO PIC  X(0006).
  3551*    -------------------------------
  3552     05  FILLER            PIC  X(0003).
  3553     05  BORGSEQO PIC  X(0004).
  3554*    -------------------------------
  3555     05  FILLER            PIC  X(0003).
  3556     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  3557*    -------------------------------
  3558     05  FILLER            PIC  X(0003).
  3559     05  BKIND1O PIC  X(0002).
  3560*    -------------------------------
  3561     05  FILLER            PIC  X(0003).
  3562     05  BTYPE1O PIC  X(0003).
  3563*    -------------------------------
  3564     05  FILLER            PIC  X(0003).
  3565     05  BTERM1O PIC  X(0003).
  3566*    -------------------------------
  3567     05  FILLER            PIC  X(0003).
  3568     05  BBEN1O PIC  X(0012).
  3569*    -------------------------------
  3570     05  FILLER            PIC  X(0003).
  3571     05  BPREM1O PIC  X(0011).
  3572*    -------------------------------
  3573     05  FILLER            PIC  X(0003).
  3574     05  BEXPIR1O PIC  X(0008).
  3575*    -------------------------------
  3576     05  FILLER            PIC  X(0003).
  3577     05  BCP1O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  70
* EL6311.cbl
  3578*    -------------------------------
  3579     05  FILLER            PIC  X(0003).
  3580     05  BALTBN1O PIC  X(0012).
  3581*    -------------------------------
  3582     05  FILLER            PIC  X(0003).
  3583     05  BALTPR1O PIC  X(0011).
  3584*    -------------------------------
  3585     05  FILLER            PIC  X(0003).
  3586     05  BBNCD1O PIC  X(0003).
  3587*    -------------------------------
  3588     05  FILLER            PIC  X(0003).
  3589     05  BCPRM1O PIC  X(0011).
  3590*    -------------------------------
  3591     05  FILLER            PIC  X(0003).
  3592     05  BCAPRM1O PIC  X(0011).
  3593*    -------------------------------
  3594     05  FILLER            PIC  X(0003).
  3595     05  BENABR1O PIC  X(0005).
  3596*    -------------------------------
  3597     05  FILLER            PIC  X(0003).
  3598     05  BDIFF1O PIC  X(0011).
  3599*    -------------------------------
  3600     05  FILLER            PIC  X(0003).
  3601     05  BBILIT1O PIC  X(0008).
  3602*    -------------------------------
  3603     05  FILLER            PIC  X(0003).
  3604     05  BADIFF1O PIC  X(0011).
  3605*    -------------------------------
  3606     05  FILLER            PIC  X(0003).
  3607     05  BKIND2O PIC  X(0002).
  3608*    -------------------------------
  3609     05  FILLER            PIC  X(0003).
  3610     05  BTYPE2O PIC  X(0003).
  3611*    -------------------------------
  3612     05  FILLER            PIC  X(0003).
  3613     05  BTERM2O PIC  X(0003).
  3614*    -------------------------------
  3615     05  FILLER            PIC  X(0003).
  3616     05  BBEN2O PIC  X(0012).
  3617*    -------------------------------
  3618     05  FILLER            PIC  X(0003).
  3619     05  BPREM2O PIC  X(0011).
  3620*    -------------------------------
  3621     05  FILLER            PIC  X(0003).
  3622     05  BEXPIR2O PIC  X(0008).
  3623*    -------------------------------
  3624     05  FILLER            PIC  X(0003).
  3625     05  BCP2O PIC  X(0002).
  3626*    -------------------------------
  3627     05  FILLER            PIC  X(0003).
  3628     05  BALTBN2O PIC  X(0012).
  3629*    -------------------------------
  3630     05  FILLER            PIC  X(0003).
  3631     05  BALTPR2O PIC  X(0011).
  3632*    -------------------------------
  3633     05  FILLER            PIC  X(0003).
  3634     05  BBNCD2O PIC  X(0003).
  3635*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  71
* EL6311.cbl
  3636     05  FILLER            PIC  X(0003).
  3637     05  BCPRM2O PIC  X(0011).
  3638*    -------------------------------
  3639     05  FILLER            PIC  X(0003).
  3640     05  BCAPRM2O PIC  X(0011).
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  BENABR2O PIC  X(0005).
  3644*    -------------------------------
  3645     05  FILLER            PIC  X(0003).
  3646     05  BDIFF2O PIC  X(0011).
  3647*    -------------------------------
  3648     05  FILLER            PIC  X(0003).
  3649     05  BBILIT2O PIC  X(0008).
  3650*    -------------------------------
  3651     05  FILLER            PIC  X(0003).
  3652     05  BADIFF2O PIC  X(0011).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  BERMSG1O PIC  X(0078).
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  BERMSG2O PIC  X(0078).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  BERMSG3O PIC  X(0078).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  BPFENTRO PIC  X(0002).
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  BPF5HDRO PIC  X(0005).
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  BPF4HDRO PIC  X(0013).
  3671*    -------------------------------
  3672 01  EL631CI REDEFINES EL631BI.
  3673     05  FILLER            PIC  X(0012).
  3674*    -------------------------------
  3675     05  CDATEL PIC S9(0004) COMP.
  3676     05  CDATEF PIC  X(0001).
  3677     05  FILLER REDEFINES CDATEF.
  3678         10  CDATEA PIC  X(0001).
  3679     05  CDATEI PIC  X(0008).
  3680*    -------------------------------
  3681     05  CTIMEL PIC S9(0004) COMP.
  3682     05  CTIMEF PIC  X(0001).
  3683     05  FILLER REDEFINES CTIMEF.
  3684         10  CTIMEA PIC  X(0001).
  3685     05  CTIMEI PIC  X(0005).
  3686*    -------------------------------
  3687     05  CCHGTL PIC S9(0004) COMP.
  3688     05  CCHGTF PIC  X(0001).
  3689     05  FILLER REDEFINES CCHGTF.
  3690         10  CCHGTA PIC  X(0001).
  3691     05  CCHGTI PIC  X(0004).
  3692*    -------------------------------
  3693     05  CCHGL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  72
* EL6311.cbl
  3694     05  CCHGF PIC  X(0001).
  3695     05  FILLER REDEFINES CCHGF.
  3696         10  CCHGA PIC  X(0001).
  3697     05  CCHGI PIC  X(0004).
  3698*    -------------------------------
  3699     05  CMAINTL PIC S9(0004) COMP.
  3700     05  CMAINTF PIC  X(0001).
  3701     05  FILLER REDEFINES CMAINTF.
  3702         10  CMAINTA PIC  X(0001).
  3703     05  CMAINTI PIC  X(0001).
  3704*    -------------------------------
  3705     05  CMANTBYL PIC S9(0004) COMP.
  3706     05  CMANTBYF PIC  X(0001).
  3707     05  FILLER REDEFINES CMANTBYF.
  3708         10  CMANTBYA PIC  X(0001).
  3709     05  CMANTBYI PIC  X(0004).
  3710*    -------------------------------
  3711     05  CCHGHDGL PIC S9(0004) COMP.
  3712     05  CCHGHDGF PIC  X(0001).
  3713     05  FILLER REDEFINES CCHGHDGF.
  3714         10  CCHGHDGA PIC  X(0001).
  3715     05  CCHGHDGI PIC  X(0003).
  3716*    -------------------------------
  3717     05  CMANTDTL PIC S9(0004) COMP.
  3718     05  CMANTDTF PIC  X(0001).
  3719     05  FILLER REDEFINES CMANTDTF.
  3720         10  CMANTDTA PIC  X(0001).
  3721     05  CMANTDTI PIC  X(0008).
  3722*    -------------------------------
  3723     05  CMANTATL PIC S9(0004) COMP.
  3724     05  CMANTATF PIC  X(0001).
  3725     05  FILLER REDEFINES CMANTATF.
  3726         10  CMANTATA PIC  X(0001).
  3727     05  CMANTATI PIC  X(0005).
  3728*    -------------------------------
  3729     05  CCSRL PIC S9(0004) COMP.
  3730     05  CCSRF PIC  X(0001).
  3731     05  FILLER REDEFINES CCSRF.
  3732         10  CCSRA PIC  X(0001).
  3733     05  CCSRI PIC  X(0004).
  3734*    -------------------------------
  3735     05  CBATCHL PIC S9(0004) COMP.
  3736     05  CBATCHF PIC  X(0001).
  3737     05  FILLER REDEFINES CBATCHF.
  3738         10  CBATCHA PIC  X(0001).
  3739     05  CBATCHI PIC  X(0006).
  3740*    -------------------------------
  3741     05  CSEQL PIC S9(0004) COMP.
  3742     05  CSEQF PIC  X(0001).
  3743     05  FILLER REDEFINES CSEQF.
  3744         10  CSEQA PIC  X(0001).
  3745     05  CSEQI PIC  X(0004).
  3746*    -------------------------------
  3747     05  CMOENDTL PIC S9(0004) COMP.
  3748     05  CMOENDTF PIC  X(0001).
  3749     05  FILLER REDEFINES CMOENDTF.
  3750         10  CMOENDTA PIC  X(0001).
  3751     05  CMOENDTI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  73
* EL6311.cbl
  3752*    -------------------------------
  3753     05  CCARRL PIC S9(0004) COMP.
  3754     05  CCARRF PIC  X(0001).
  3755     05  FILLER REDEFINES CCARRF.
  3756         10  CCARRA PIC  X(0001).
  3757     05  CCARRI PIC  X(0001).
  3758*    -------------------------------
  3759     05  CGROUPL PIC S9(0004) COMP.
  3760     05  CGROUPF PIC  X(0001).
  3761     05  FILLER REDEFINES CGROUPF.
  3762         10  CGROUPA PIC  X(0001).
  3763     05  CGROUPI PIC  X(0006).
  3764*    -------------------------------
  3765     05  CSTATEL PIC S9(0004) COMP.
  3766     05  CSTATEF PIC  X(0001).
  3767     05  FILLER REDEFINES CSTATEF.
  3768         10  CSTATEA PIC  X(0001).
  3769     05  CSTATEI PIC  X(0002).
  3770*    -------------------------------
  3771     05  CACCTL PIC S9(0004) COMP.
  3772     05  CACCTF PIC  X(0001).
  3773     05  FILLER REDEFINES CACCTF.
  3774         10  CACCTA PIC  X(0001).
  3775     05  CACCTI PIC  X(0010).
  3776*    -------------------------------
  3777     05  CORIGHDL PIC S9(0004) COMP.
  3778     05  CORIGHDF PIC  X(0001).
  3779     05  FILLER REDEFINES CORIGHDF.
  3780         10  CORIGHDA PIC  X(0001).
  3781     05  CORIGHDI PIC  X(0011).
  3782*    -------------------------------
  3783     05  CORGNOL PIC S9(0004) COMP.
  3784     05  CORGNOF PIC  X(0001).
  3785     05  FILLER REDEFINES CORGNOF.
  3786         10  CORGNOA PIC  X(0001).
  3787     05  CORGNOI PIC  X(0006).
  3788*    -------------------------------
  3789     05  CORGSEQL PIC S9(0004) COMP.
  3790     05  CORGSEQF PIC  X(0001).
  3791     05  FILLER REDEFINES CORGSEQF.
  3792         10  CORGSEQA PIC  X(0001).
  3793     05  CORGSEQI PIC  X(0004).
  3794*    -------------------------------
  3795     05  CREFHDGL PIC S9(0004) COMP.
  3796     05  CREFHDGF PIC  X(0001).
  3797     05  FILLER REDEFINES CREFHDGF.
  3798         10  CREFHDGA PIC  X(0001).
  3799     05  CREFHDGI PIC  X(0010).
  3800*    -------------------------------
  3801     05  CREFL PIC S9(0004) COMP.
  3802     05  CREFF PIC  X(0001).
  3803     05  FILLER REDEFINES CREFF.
  3804         10  CREFA PIC  X(0001).
  3805     05  CREFI PIC  X(0012).
  3806*    -------------------------------
  3807     05  CNHINTL PIC S9(0004) COMP.
  3808     05  CNHINTF PIC  X(0001).
  3809     05  FILLER REDEFINES CNHINTF.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  74
* EL6311.cbl
  3810         10  CNHINTA PIC  X(0001).
  3811     05  CNHINTI PIC  9(7)V99.
  3812*    -------------------------------
  3813     05  CCERTNOL PIC S9(0004) COMP.
  3814     05  CCERTNOF PIC  X(0001).
  3815     05  FILLER REDEFINES CCERTNOF.
  3816         10  CCERTNOA PIC  X(0001).
  3817     05  CCERTNOI PIC  X(0010).
  3818*    -------------------------------
  3819     05  CSUFIXL PIC S9(0004) COMP.
  3820     05  CSUFIXF PIC  X(0001).
  3821     05  FILLER REDEFINES CSUFIXF.
  3822         10  CSUFIXA PIC  X(0001).
  3823     05  CSUFIXI PIC  X(0001).
  3824*    -------------------------------
  3825     05  CEFFDTL PIC S9(0004) COMP.
  3826     05  CEFFDTF PIC  X(0001).
  3827     05  FILLER REDEFINES CEFFDTF.
  3828         10  CEFFDTA PIC  X(0001).
  3829     05  CEFFDTI PIC  X(0008).
  3830*    -------------------------------
  3831     05  CLSTNML PIC S9(0004) COMP.
  3832     05  CLSTNMF PIC  X(0001).
  3833     05  FILLER REDEFINES CLSTNMF.
  3834         10  CLSTNMA PIC  X(0001).
  3835     05  CLSTNMI PIC  X(0015).
  3836*    -------------------------------
  3837     05  CPCYNL PIC S9(0004) COMP.
  3838     05  CPCYNF PIC  X(0001).
  3839     05  FILLER REDEFINES CPCYNF.
  3840         10  CPCYNA PIC  X(0001).
  3841     05  CPCYNI PIC  X(0001).
  3842*    -------------------------------
  3843     05  CINAMEL PIC S9(0004) COMP.
  3844     05  CINAMEF PIC  X(0001).
  3845     05  FILLER REDEFINES CINAMEF.
  3846         10  CINAMEA PIC  X(0001).
  3847     05  CINAMEI PIC  X(0015).
  3848*    -------------------------------
  3849     05  CINITSL PIC S9(0004) COMP.
  3850     05  CINITSF PIC  X(0001).
  3851     05  FILLER REDEFINES CINITSF.
  3852         10  CINITSA PIC  X(0001).
  3853     05  CINITSI PIC  X(0010).
  3854*    -------------------------------
  3855     05  CKIND1L PIC S9(0004) COMP.
  3856     05  CKIND1F PIC  X(0001).
  3857     05  FILLER REDEFINES CKIND1F.
  3858         10  CKIND1A PIC  X(0001).
  3859     05  CKIND1I PIC  X(0002).
  3860*    -------------------------------
  3861     05  CCANDT1L PIC S9(0004) COMP.
  3862     05  CCANDT1F PIC  X(0001).
  3863     05  FILLER REDEFINES CCANDT1F.
  3864         10  CCANDT1A PIC  X(0001).
  3865     05  CCANDT1I PIC  X(0008).
  3866*    -------------------------------
  3867     05  CREFND1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  75
* EL6311.cbl
  3868     05  CREFND1F PIC  X(0001).
  3869     05  FILLER REDEFINES CREFND1F.
  3870         10  CREFND1A PIC  X(0001).
  3871     05  CREFND1I PIC  S9(9)V99.
  3872*    -------------------------------
  3873     05  CMTHD1L PIC S9(0004) COMP.
  3874     05  CMTHD1F PIC  X(0001).
  3875     05  FILLER REDEFINES CMTHD1F.
  3876         10  CMTHD1A PIC  X(0001).
  3877     05  CMTHD1I PIC  X(0001).
  3878*    -------------------------------
  3879     05  CKIND2L PIC S9(0004) COMP.
  3880     05  CKIND2F PIC  X(0001).
  3881     05  FILLER REDEFINES CKIND2F.
  3882         10  CKIND2A PIC  X(0001).
  3883     05  CKIND2I PIC  X(0002).
  3884*    -------------------------------
  3885     05  CCANDT2L PIC S9(0004) COMP.
  3886     05  CCANDT2F PIC  X(0001).
  3887     05  FILLER REDEFINES CCANDT2F.
  3888         10  CCANDT2A PIC  X(0001).
  3889     05  CCANDT2I PIC  X(0008).
  3890*    -------------------------------
  3891     05  CREFND2L PIC S9(0004) COMP.
  3892     05  CREFND2F PIC  X(0001).
  3893     05  FILLER REDEFINES CREFND2F.
  3894         10  CREFND2A PIC  X(0001).
  3895     05  CREFND2I PIC  S9(9)V99.
  3896*    -------------------------------
  3897     05  CMTHD2L PIC S9(0004) COMP.
  3898     05  CMTHD2F PIC  X(0001).
  3899     05  FILLER REDEFINES CMTHD2F.
  3900         10  CMTHD2A PIC  X(0001).
  3901     05  CMTHD2I PIC  X(0001).
  3902*    -------------------------------
  3903     05  CLIVESL PIC S9(0004) COMP.
  3904     05  CLIVESF PIC  X(0001).
  3905     05  FILLER REDEFINES CLIVESF.
  3906         10  CLIVESA PIC  X(0001).
  3907     05  CLIVESI PIC  X(0003).
  3908*    -------------------------------
  3909     05  CFORCEL PIC S9(0004) COMP.
  3910     05  CFORCEF PIC  X(0001).
  3911     05  FILLER REDEFINES CFORCEF.
  3912         10  CFORCEA PIC  X(0001).
  3913     05  CFORCEI PIC  X(0001).
  3914*    -------------------------------
  3915     05  CBILCDL PIC S9(0004) COMP.
  3916     05  CBILCDF PIC  X(0001).
  3917     05  FILLER REDEFINES CBILCDF.
  3918         10  CBILCDA PIC  X(0001).
  3919     05  CBILCDI PIC  X(0001).
  3920*    -------------------------------
  3921     05  CCRFND1L PIC S9(0004) COMP.
  3922     05  CCRFND1F PIC  X(0001).
  3923     05  FILLER REDEFINES CCRFND1F.
  3924         10  CCRFND1A PIC  X(0001).
  3925     05  CCRFND1I PIC  X(0011).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  76
* EL6311.cbl
  3926*    -------------------------------
  3927     05  CCRFND2L PIC S9(0004) COMP.
  3928     05  CCRFND2F PIC  X(0001).
  3929     05  FILLER REDEFINES CCRFND2F.
  3930         10  CCRFND2A PIC  X(0001).
  3931     05  CCRFND2I PIC  X(0011).
  3932*    -------------------------------
  3933     05  CBILIT1L PIC S9(0004) COMP.
  3934     05  CBILIT1F PIC  X(0001).
  3935     05  FILLER REDEFINES CBILIT1F.
  3936         10  CBILIT1A PIC  X(0001).
  3937     05  CBILIT1I PIC  X(0008).
  3938*    -------------------------------
  3939     05  CDRFND1L PIC S9(0004) COMP.
  3940     05  CDRFND1F PIC  X(0001).
  3941     05  FILLER REDEFINES CDRFND1F.
  3942         10  CDRFND1A PIC  X(0001).
  3943     05  CDRFND1I PIC  X(0011).
  3944*    -------------------------------
  3945     05  CBILIT2L PIC S9(0004) COMP.
  3946     05  CBILIT2F PIC  X(0001).
  3947     05  FILLER REDEFINES CBILIT2F.
  3948         10  CBILIT2A PIC  X(0001).
  3949     05  CBILIT2I PIC  X(0008).
  3950*    -------------------------------
  3951     05  CDRFND2L PIC S9(0004) COMP.
  3952     05  CDRFND2F PIC  X(0001).
  3953     05  FILLER REDEFINES CDRFND2F.
  3954         10  CDRFND2A PIC  X(0001).
  3955     05  CDRFND2I PIC  X(0011).
  3956*    -------------------------------
  3957     05  CCANTXTL PIC S9(0004) COMP.
  3958     05  CCANTXTF PIC  X(0001).
  3959     05  FILLER REDEFINES CCANTXTF.
  3960         10  CCANTXTA PIC  X(0001).
  3961     05  CCANTXTI PIC  X(0005).
  3962*    -------------------------------
  3963     05  CCANFEEL PIC S9(0004) COMP.
  3964     05  CCANFEEF PIC  X(0001).
  3965     05  FILLER REDEFINES CCANFEEF.
  3966         10  CCANFEEA PIC  X(0001).
  3967     05  CCANFEEI PIC  X(0002).
  3968*    -------------------------------
  3969     05  CTERM1L PIC S9(0004) COMP.
  3970     05  CTERM1F PIC  X(0001).
  3971     05  FILLER REDEFINES CTERM1F.
  3972         10  CTERM1A PIC  X(0001).
  3973     05  CTERM1I PIC  X(0003).
  3974*    -------------------------------
  3975     05  CRTERM1L PIC S9(0004) COMP.
  3976     05  CRTERM1F PIC  X(0001).
  3977     05  FILLER REDEFINES CRTERM1F.
  3978         10  CRTERM1A PIC  X(0001).
  3979     05  CRTERM1I PIC  X(0003).
  3980*    -------------------------------
  3981     05  CPREM1L PIC S9(0004) COMP.
  3982     05  CPREM1F PIC  X(0001).
  3983     05  FILLER REDEFINES CPREM1F.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  77
* EL6311.cbl
  3984         10  CPREM1A PIC  X(0001).
  3985     05  CPREM1I PIC  X(0011).
  3986*    -------------------------------
  3987     05  CTERM2L PIC S9(0004) COMP.
  3988     05  CTERM2F PIC  X(0001).
  3989     05  FILLER REDEFINES CTERM2F.
  3990         10  CTERM2A PIC  X(0001).
  3991     05  CTERM2I PIC  X(0003).
  3992*    -------------------------------
  3993     05  CRTERM2L PIC S9(0004) COMP.
  3994     05  CRTERM2F PIC  X(0001).
  3995     05  FILLER REDEFINES CRTERM2F.
  3996         10  CRTERM2A PIC  X(0001).
  3997     05  CRTERM2I PIC  X(0003).
  3998*    -------------------------------
  3999     05  CPREM2L PIC S9(0004) COMP.
  4000     05  CPREM2F PIC  X(0001).
  4001     05  FILLER REDEFINES CPREM2F.
  4002         10  CPREM2A PIC  X(0001).
  4003     05  CPREM2I PIC  X(0011).
  4004*    -------------------------------
  4005     05  CENTRDTL PIC S9(0004) COMP.
  4006     05  CENTRDTF PIC  X(0001).
  4007     05  FILLER REDEFINES CENTRDTF.
  4008         10  CENTRDTA PIC  X(0001).
  4009     05  CENTRDTI PIC  X(0008).
  4010*    -------------------------------
  4011     05  CPAYEEL PIC S9(0004) COMP.
  4012     05  CPAYEEF PIC  X(0001).
  4013     05  FILLER REDEFINES CPAYEEF.
  4014         10  CPAYEEA PIC  X(0001).
  4015     05  CPAYEEI PIC  X(0006).
  4016*    -------------------------------
  4017     05  CRFNDSWL PIC S9(0004) COMP.
  4018     05  CRFNDSWF PIC  X(0001).
  4019     05  FILLER REDEFINES CRFNDSWF.
  4020         10  CRFNDSWA PIC  X(0001).
  4021     05  CRFNDSWI PIC  X(0003).
  4022*    -------------------------------
  4023     05  CLFHDGL PIC S9(0004) COMP.
  4024     05  CLFHDGF PIC  X(0001).
  4025     05  FILLER REDEFINES CLFHDGF.
  4026         10  CLFHDGA PIC  X(0001).
  4027     05  CLFHDGI PIC  X(0006).
  4028*    -------------------------------
  4029     05  CAHHDGL PIC S9(0004) COMP.
  4030     05  CAHHDGF PIC  X(0001).
  4031     05  FILLER REDEFINES CAHHDGF.
  4032         10  CAHHDGA PIC  X(0001).
  4033     05  CAHHDGI PIC  X(0006).
  4034*    -------------------------------
  4035     05  CENTDTL PIC S9(0004) COMP.
  4036     05  CENTDTF PIC  X(0001).
  4037     05  FILLER REDEFINES CENTDTF.
  4038         10  CENTDTA PIC  X(0001).
  4039     05  CENTDTI PIC  X(0008).
  4040*    -------------------------------
  4041     05  CENTBYL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  78
* EL6311.cbl
  4042     05  CENTBYF PIC  X(0001).
  4043     05  FILLER REDEFINES CENTBYF.
  4044         10  CENTBYA PIC  X(0001).
  4045     05  CENTBYI PIC  X(0004).
  4046*    -------------------------------
  4047     05  CCHGCNTL PIC S9(0004) COMP.
  4048     05  CCHGCNTF PIC  X(0001).
  4049     05  FILLER REDEFINES CCHGCNTF.
  4050         10  CCHGCNTA PIC  X(0001).
  4051     05  CCHGCNTI PIC  X(0003).
  4052*    -------------------------------
  4053     05  CLFREFNL PIC S9(0004) COMP.
  4054     05  CLFREFNF PIC  X(0001).
  4055     05  FILLER REDEFINES CLFREFNF.
  4056         10  CLFREFNA PIC  X(0001).
  4057     05  CLFREFNI PIC  X(0006).
  4058*    -------------------------------
  4059     05  CAHREFNL PIC S9(0004) COMP.
  4060     05  CAHREFNF PIC  X(0001).
  4061     05  FILLER REDEFINES CAHREFNF.
  4062         10  CAHREFNA PIC  X(0001).
  4063     05  CAHREFNI PIC  X(0006).
  4064*    -------------------------------
  4065     05  CREINCDL PIC S9(0004) COMP.
  4066     05  CREINCDF PIC  X(0001).
  4067     05  FILLER REDEFINES CREINCDF.
  4068         10  CREINCDA PIC  X(0001).
  4069     05  CREINCDI PIC  X(0003).
  4070*    -------------------------------
  4071     05  CAEFFDTL PIC S9(0004) COMP.
  4072     05  CAEFFDTF PIC  X(0001).
  4073     05  FILLER REDEFINES CAEFFDTF.
  4074         10  CAEFFDTA PIC  X(0001).
  4075     05  CAEFFDTI PIC  X(0008).
  4076*    -------------------------------
  4077     05  CAEXPDTL PIC S9(0004) COMP.
  4078     05  CAEXPDTF PIC  X(0001).
  4079     05  FILLER REDEFINES CAEXPDTF.
  4080         10  CAEXPDTA PIC  X(0001).
  4081     05  CAEXPDTI PIC  X(0008).
  4082*    -------------------------------
  4083     05  COMMLFL PIC S9(0004) COMP.
  4084     05  COMMLFF PIC  X(0001).
  4085     05  FILLER REDEFINES COMMLFF.
  4086         10  COMMLFA PIC  X(0001).
  4087     05  COMMLFI PIC  X(0006).
  4088*    -------------------------------
  4089     05  COMMAHL PIC S9(0004) COMP.
  4090     05  COMMAHF PIC  X(0001).
  4091     05  FILLER REDEFINES COMMAHF.
  4092         10  COMMAHA PIC  X(0001).
  4093     05  COMMAHI PIC  X(0006).
  4094*    -------------------------------
  4095     05  CERMSG1L PIC S9(0004) COMP.
  4096     05  CERMSG1F PIC  X(0001).
  4097     05  FILLER REDEFINES CERMSG1F.
  4098         10  CERMSG1A PIC  X(0001).
  4099     05  CERMSG1I PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  79
* EL6311.cbl
  4100*    -------------------------------
  4101     05  CERMSG2L PIC S9(0004) COMP.
  4102     05  CERMSG2F PIC  X(0001).
  4103     05  FILLER REDEFINES CERMSG2F.
  4104         10  CERMSG2A PIC  X(0001).
  4105     05  CERMSG2I PIC  X(0078).
  4106*    -------------------------------
  4107     05  CERMSG3L PIC S9(0004) COMP.
  4108     05  CERMSG3F PIC  X(0001).
  4109     05  FILLER REDEFINES CERMSG3F.
  4110         10  CERMSG3A PIC  X(0001).
  4111     05  CERMSG3I PIC  X(0078).
  4112*    -------------------------------
  4113     05  CPFENTRL PIC S9(0004) COMP.
  4114     05  CPFENTRF PIC  X(0001).
  4115     05  FILLER REDEFINES CPFENTRF.
  4116         10  CPFENTRA PIC  X(0001).
  4117     05  CPFENTRI PIC  9(2).
  4118*    -------------------------------
  4119     05  CPF5HDRL PIC S9(0004) COMP.
  4120     05  CPF5HDRF PIC  X(0001).
  4121     05  FILLER REDEFINES CPF5HDRF.
  4122         10  CPF5HDRA PIC  X(0001).
  4123     05  CPF5HDRI PIC  X(0005).
  4124*    -------------------------------
  4125     05  CPF4HDRL PIC S9(0004) COMP.
  4126     05  CPF4HDRF PIC  X(0001).
  4127     05  FILLER REDEFINES CPF4HDRF.
  4128         10  CPF4HDRA PIC  X(0001).
  4129     05  CPF4HDRI PIC  X(0013).
  4130 01  EL631CO REDEFINES EL631BI.
  4131     05  FILLER            PIC  X(0012).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  CDATEO PIC  X(0008).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  CTIMEO PIC  99.99.
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  CCHGTO PIC  X(0004).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  CCHGO PIC  ZZZ9.
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  CMAINTO PIC  X(0001).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  CMANTBYO PIC  X(0004).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  CCHGHDGO PIC  X(0003).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  CMANTDTO PIC  X(0008).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  80
* EL6311.cbl
  4158     05  CMANTATO PIC  99.99.
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  CCSRO PIC  X(0004).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  CBATCHO PIC  X(0006).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  CSEQO PIC  X(0004).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  CMOENDTO PIC  X(0008).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  CCARRO PIC  X(0001).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  CGROUPO PIC  X(0006).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  CSTATEO PIC  X(0002).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  CACCTO PIC  X(0010).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  CORIGHDO PIC  X(0011).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  CORGNOO PIC  X(0006).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  CORGSEQO PIC  X(0004).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  CREFHDGO PIC  X(0010).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  CREFO PIC  X(0012).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  CNHINTO PIC  999999.99.
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  CCERTNOO PIC  X(0010).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  CSUFIXO PIC  X(0001).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  CEFFDTO PIC  X(0008).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  CLSTNMO PIC  X(0015).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  CPCYNO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  81
* EL6311.cbl
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  CINAMEO PIC  X(0015).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  CINITSO PIC  X(0010).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  CKIND1O PIC  X(0002).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  CCANDT1O PIC  X(0008).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  CREFND1O PIC  Z(7).99-.
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  CMTHD1O PIC  X(0001).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  CKIND2O PIC  X(0002).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  CCANDT2O PIC  X(0008).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  CREFND2O PIC  Z(7).99-.
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  CMTHD2O PIC  X(0001).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  CLIVESO PIC  X(0003).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  CFORCEO PIC  X(0001).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  CBILCDO PIC  X(0001).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  CCRFND1O PIC  Z(7).99-.
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  CCRFND2O PIC  Z(7).99-.
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  CBILIT1O PIC  X(0008).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  CDRFND1O PIC  Z(7).99-.
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  CBILIT2O PIC  X(0008).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  CDRFND2O PIC  Z(7).99-.
  4273*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  82
* EL6311.cbl
  4274     05  FILLER            PIC  X(0003).
  4275     05  CCANTXTO PIC  X(0005).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  CCANFEEO PIC  Z9.
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  CTERM1O PIC  ZZ9.
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  CRTERM1O PIC  ZZ9.
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  CPREM1O PIC  ZZZZZZ9.99-.
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  CTERM2O PIC  ZZ9.
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  CRTERM2O PIC  ZZ9.
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  CPREM2O PIC  ZZZZZZ9.99-.
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  CENTRDTO PIC  X(0008).
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  CPAYEEO PIC  X(0006).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  CRFNDSWO PIC  X(0003).
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
  4308     05  CLFHDGO PIC  X(0006).
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  CAHHDGO PIC  X(0006).
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
  4314     05  CENTDTO PIC  X(0008).
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  CENTBYO PIC  X(0004).
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
  4320     05  CCHGCNTO PIC  X(0003).
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
  4323     05  CLFREFNO PIC  X(0006).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  CAHREFNO PIC  X(0006).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  CREINCDO PIC  X(0003).
  4330*    -------------------------------
  4331     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  83
* EL6311.cbl
  4332     05  CAEFFDTO PIC  X(0008).
  4333*    -------------------------------
  4334     05  FILLER            PIC  X(0003).
  4335     05  CAEXPDTO PIC  X(0008).
  4336*    -------------------------------
  4337     05  FILLER            PIC  X(0003).
  4338     05  COMMLFO PIC  .99999.
  4339*    -------------------------------
  4340     05  FILLER            PIC  X(0003).
  4341     05  COMMAHO PIC  .99999.
  4342*    -------------------------------
  4343     05  FILLER            PIC  X(0003).
  4344     05  CERMSG1O PIC  X(0078).
  4345*    -------------------------------
  4346     05  FILLER            PIC  X(0003).
  4347     05  CERMSG2O PIC  X(0078).
  4348*    -------------------------------
  4349     05  FILLER            PIC  X(0003).
  4350     05  CERMSG3O PIC  X(0078).
  4351*    -------------------------------
  4352     05  FILLER            PIC  X(0003).
  4353     05  CPFENTRO PIC  X(0002).
  4354*    -------------------------------
  4355     05  FILLER            PIC  X(0003).
  4356     05  CPF5HDRO PIC  X(0005).
  4357*    -------------------------------
  4358     05  FILLER            PIC  X(0003).
  4359     05  CPF4HDRO PIC  X(0013).
  4360*    -------------------------------
  4361 01  EL631DI REDEFINES EL631BI.
  4362     05  FILLER            PIC  X(0012).
  4363*    -------------------------------
  4364     05  DDATEL PIC S9(0004) COMP.
  4365     05  DDATEF PIC  X(0001).
  4366     05  FILLER REDEFINES DDATEF.
  4367         10  DDATEA PIC  X(0001).
  4368     05  DDATEI PIC  X(0008).
  4369*    -------------------------------
  4370     05  DTIMEL PIC S9(0004) COMP.
  4371     05  DTIMEF PIC  X(0001).
  4372     05  FILLER REDEFINES DTIMEF.
  4373         10  DTIMEA PIC  X(0001).
  4374     05  DTIMEI PIC  X(0005).
  4375*    -------------------------------
  4376     05  DLDATEL PIC S9(0004) COMP.
  4377     05  DLDATEF PIC  X(0001).
  4378     05  FILLER REDEFINES DLDATEF.
  4379         10  DLDATEA PIC  X(0001).
  4380     05  DLDATEI PIC  X(0010).
  4381*    -------------------------------
  4382     05  DBATCHL PIC S9(0004) COMP.
  4383     05  DBATCHF PIC  X(0001).
  4384     05  FILLER REDEFINES DBATCHF.
  4385         10  DBATCHA PIC  X(0001).
  4386     05  DBATCHI PIC  X(0011).
  4387*    -------------------------------
  4388     05  DACCTNML PIC S9(0004) COMP.
  4389     05  DACCTNMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  84
* EL6311.cbl
  4390     05  FILLER REDEFINES DACCTNMF.
  4391         10  DACCTNMA PIC  X(0001).
  4392     05  DACCTNMI PIC  X(0030).
  4393*    -------------------------------
  4394     05  DPROCDTL PIC S9(0004) COMP.
  4395     05  DPROCDTF PIC  X(0001).
  4396     05  FILLER REDEFINES DPROCDTF.
  4397         10  DPROCDTA PIC  X(0001).
  4398     05  DPROCDTI PIC  X(0008).
  4399*    -------------------------------
  4400     05  DINPUTL PIC S9(0004) COMP.
  4401     05  DINPUTF PIC  X(0001).
  4402     05  FILLER REDEFINES DINPUTF.
  4403         10  DINPUTA PIC  X(0001).
  4404     05  DINPUTI PIC  X(0008).
  4405*    -------------------------------
  4406     05  DMAINDTL PIC S9(0004) COMP.
  4407     05  DMAINDTF PIC  X(0001).
  4408     05  FILLER REDEFINES DMAINDTF.
  4409         10  DMAINDTA PIC  X(0001).
  4410     05  DMAINDTI PIC  X(0008).
  4411*    -------------------------------
  4412     05  DCARRL PIC S9(0004) COMP.
  4413     05  DCARRF PIC  X(0001).
  4414     05  FILLER REDEFINES DCARRF.
  4415         10  DCARRA PIC  X(0001).
  4416     05  DCARRI PIC  X(0001).
  4417*    -------------------------------
  4418     05  DGROUPL PIC S9(0004) COMP.
  4419     05  DGROUPF PIC  X(0001).
  4420     05  FILLER REDEFINES DGROUPF.
  4421         10  DGROUPA PIC  X(0001).
  4422     05  DGROUPI PIC  X(0006).
  4423*    -------------------------------
  4424     05  DSTATEL PIC S9(0004) COMP.
  4425     05  DSTATEF PIC  X(0001).
  4426     05  FILLER REDEFINES DSTATEF.
  4427         10  DSTATEA PIC  X(0001).
  4428     05  DSTATEI PIC  X(0002).
  4429*    -------------------------------
  4430     05  DACCTL PIC S9(0004) COMP.
  4431     05  DACCTF PIC  X(0001).
  4432     05  FILLER REDEFINES DACCTF.
  4433         10  DACCTA PIC  X(0001).
  4434     05  DACCTI PIC  X(0010).
  4435*    -------------------------------
  4436     05  DRECVDTL PIC S9(0004) COMP.
  4437     05  DRECVDTF PIC  X(0001).
  4438     05  FILLER REDEFINES DRECVDTF.
  4439         10  DRECVDTA PIC  X(0001).
  4440     05  DRECVDTI PIC  X(0008).
  4441*    -------------------------------
  4442     05  DCSRL PIC S9(0004) COMP.
  4443     05  DCSRF PIC  X(0001).
  4444     05  FILLER REDEFINES DCSRF.
  4445         10  DCSRA PIC  X(0001).
  4446     05  DCSRI PIC  X(0004).
  4447*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  85
* EL6311.cbl
  4448     05  DREFHDGL PIC S9(0004) COMP.
  4449     05  DREFHDGF PIC  X(0001).
  4450     05  FILLER REDEFINES DREFHDGF.
  4451         10  DREFHDGA PIC  X(0001).
  4452     05  DREFHDGI PIC  X(0010).
  4453*    -------------------------------
  4454     05  DREFL PIC S9(0004) COMP.
  4455     05  DREFF PIC  X(0001).
  4456     05  FILLER REDEFINES DREFF.
  4457         10  DREFA PIC  X(0001).
  4458     05  DREFI PIC  X(0012).
  4459*    -------------------------------
  4460     05  DLFPHDGL PIC S9(0004) COMP.
  4461     05  DLFPHDGF PIC  X(0001).
  4462     05  FILLER REDEFINES DLFPHDGF.
  4463         10  DLFPHDGA PIC  X(0001).
  4464     05  DLFPHDGI PIC  X(0010).
  4465*    -------------------------------
  4466     05  DAHPHDGL PIC S9(0004) COMP.
  4467     05  DAHPHDGF PIC  X(0001).
  4468     05  FILLER REDEFINES DAHPHDGF.
  4469         10  DAHPHDGA PIC  X(0001).
  4470     05  DAHPHDGI PIC  X(0010).
  4471*    -------------------------------
  4472     05  DLFRHDGL PIC S9(0004) COMP.
  4473     05  DLFRHDGF PIC  X(0001).
  4474     05  FILLER REDEFINES DLFRHDGF.
  4475         10  DLFRHDGA PIC  X(0001).
  4476     05  DLFRHDGI PIC  X(0009).
  4477*    -------------------------------
  4478     05  DAHRHDGL PIC S9(0004) COMP.
  4479     05  DAHRHDGF PIC  X(0001).
  4480     05  FILLER REDEFINES DAHRHDGF.
  4481         10  DAHRHDGA PIC  X(0001).
  4482     05  DAHRHDGI PIC  X(0009).
  4483*    -------------------------------
  4484     05  DRISSL PIC S9(0004) COMP.
  4485     05  DRISSF PIC  X(0001).
  4486     05  FILLER REDEFINES DRISSF.
  4487         10  DRISSA PIC  X(0001).
  4488     05  DRISSI PIC  X(0005).
  4489*    -------------------------------
  4490     05  DRLFPRML PIC S9(0004) COMP.
  4491     05  DRLFPRMF PIC  X(0001).
  4492     05  FILLER REDEFINES DRLFPRMF.
  4493         10  DRLFPRMA PIC  X(0001).
  4494     05  DRLFPRMI PIC  S9(9)V99.
  4495*    -------------------------------
  4496     05  DRAHPRML PIC S9(0004) COMP.
  4497     05  DRAHPRMF PIC  X(0001).
  4498     05  FILLER REDEFINES DRAHPRMF.
  4499         10  DRAHPRMA PIC  X(0001).
  4500     05  DRAHPRMI PIC  S9(9)V99.
  4501*    -------------------------------
  4502     05  DRCANCL PIC S9(0004) COMP.
  4503     05  DRCANCF PIC  X(0001).
  4504     05  FILLER REDEFINES DRCANCF.
  4505         10  DRCANCA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  86
* EL6311.cbl
  4506     05  DRCANCI PIC  X(0005).
  4507*    -------------------------------
  4508     05  DRLFRFDL PIC S9(0004) COMP.
  4509     05  DRLFRFDF PIC  X(0001).
  4510     05  FILLER REDEFINES DRLFRFDF.
  4511         10  DRLFRFDA PIC  X(0001).
  4512     05  DRLFRFDI PIC  S9(9)V99.
  4513*    -------------------------------
  4514     05  DRAHRFDL PIC S9(0004) COMP.
  4515     05  DRAHRFDF PIC  X(0001).
  4516     05  FILLER REDEFINES DRAHRFDF.
  4517         10  DRAHRFDA PIC  X(0001).
  4518     05  DRAHRFDI PIC  S9(9)V99.
  4519*    -------------------------------
  4520     05  DEISSL PIC S9(0004) COMP.
  4521     05  DEISSF PIC  X(0001).
  4522     05  FILLER REDEFINES DEISSF.
  4523         10  DEISSA PIC  X(0001).
  4524     05  DEISSI PIC  X(0005).
  4525*    -------------------------------
  4526     05  DELFPRML PIC S9(0004) COMP.
  4527     05  DELFPRMF PIC  X(0001).
  4528     05  FILLER REDEFINES DELFPRMF.
  4529         10  DELFPRMA PIC  X(0001).
  4530     05  DELFPRMI PIC  X(0011).
  4531*    -------------------------------
  4532     05  DEAHPRML PIC S9(0004) COMP.
  4533     05  DEAHPRMF PIC  X(0001).
  4534     05  FILLER REDEFINES DEAHPRMF.
  4535         10  DEAHPRMA PIC  X(0001).
  4536     05  DEAHPRMI PIC  X(0011).
  4537*    -------------------------------
  4538     05  DECANCL PIC S9(0004) COMP.
  4539     05  DECANCF PIC  X(0001).
  4540     05  FILLER REDEFINES DECANCF.
  4541         10  DECANCA PIC  X(0001).
  4542     05  DECANCI PIC  X(0005).
  4543*    -------------------------------
  4544     05  DELFRFDL PIC S9(0004) COMP.
  4545     05  DELFRFDF PIC  X(0001).
  4546     05  FILLER REDEFINES DELFRFDF.
  4547         10  DELFRFDA PIC  X(0001).
  4548     05  DELFRFDI PIC  X(0011).
  4549*    -------------------------------
  4550     05  DEAHRFDL PIC S9(0004) COMP.
  4551     05  DEAHRFDF PIC  X(0001).
  4552     05  FILLER REDEFINES DEAHRFDF.
  4553         10  DEAHRFDA PIC  X(0001).
  4554     05  DEAHRFDI PIC  X(0011).
  4555*    -------------------------------
  4556     05  DCISSL PIC S9(0004) COMP.
  4557     05  DCISSF PIC  X(0001).
  4558     05  FILLER REDEFINES DCISSF.
  4559         10  DCISSA PIC  X(0001).
  4560     05  DCISSI PIC  X(0005).
  4561*    -------------------------------
  4562     05  DCLFPRML PIC S9(0004) COMP.
  4563     05  DCLFPRMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  87
* EL6311.cbl
  4564     05  FILLER REDEFINES DCLFPRMF.
  4565         10  DCLFPRMA PIC  X(0001).
  4566     05  DCLFPRMI PIC  X(0011).
  4567*    -------------------------------
  4568     05  DCAHPRML PIC S9(0004) COMP.
  4569     05  DCAHPRMF PIC  X(0001).
  4570     05  FILLER REDEFINES DCAHPRMF.
  4571         10  DCAHPRMA PIC  X(0001).
  4572     05  DCAHPRMI PIC  X(0011).
  4573*    -------------------------------
  4574     05  DCCANCL PIC S9(0004) COMP.
  4575     05  DCCANCF PIC  X(0001).
  4576     05  FILLER REDEFINES DCCANCF.
  4577         10  DCCANCA PIC  X(0001).
  4578     05  DCCANCI PIC  X(0005).
  4579*    -------------------------------
  4580     05  DCLFRFDL PIC S9(0004) COMP.
  4581     05  DCLFRFDF PIC  X(0001).
  4582     05  FILLER REDEFINES DCLFRFDF.
  4583         10  DCLFRFDA PIC  X(0001).
  4584     05  DCLFRFDI PIC  X(0011).
  4585*    -------------------------------
  4586     05  DCAHRFDL PIC S9(0004) COMP.
  4587     05  DCAHRFDF PIC  X(0001).
  4588     05  FILLER REDEFINES DCAHRFDF.
  4589         10  DCAHRFDA PIC  X(0001).
  4590     05  DCAHRFDI PIC  X(0011).
  4591*    -------------------------------
  4592     05  DOISSL PIC S9(0004) COMP.
  4593     05  DOISSF PIC  X(0001).
  4594     05  FILLER REDEFINES DOISSF.
  4595         10  DOISSA PIC  X(0001).
  4596     05  DOISSI PIC  X(0005).
  4597*    -------------------------------
  4598     05  DOLFPRML PIC S9(0004) COMP.
  4599     05  DOLFPRMF PIC  X(0001).
  4600     05  FILLER REDEFINES DOLFPRMF.
  4601         10  DOLFPRMA PIC  X(0001).
  4602     05  DOLFPRMI PIC  X(0011).
  4603*    -------------------------------
  4604     05  DOAHPRML PIC S9(0004) COMP.
  4605     05  DOAHPRMF PIC  X(0001).
  4606     05  FILLER REDEFINES DOAHPRMF.
  4607         10  DOAHPRMA PIC  X(0001).
  4608     05  DOAHPRMI PIC  X(0011).
  4609*    -------------------------------
  4610     05  DOCANCL PIC S9(0004) COMP.
  4611     05  DOCANCF PIC  X(0001).
  4612     05  FILLER REDEFINES DOCANCF.
  4613         10  DOCANCA PIC  X(0001).
  4614     05  DOCANCI PIC  X(0005).
  4615*    -------------------------------
  4616     05  DOLFRFDL PIC S9(0004) COMP.
  4617     05  DOLFRFDF PIC  X(0001).
  4618     05  FILLER REDEFINES DOLFRFDF.
  4619         10  DOLFRFDA PIC  X(0001).
  4620     05  DOLFRFDI PIC  X(0011).
  4621*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  88
* EL6311.cbl
  4622     05  DOAHRFDL PIC S9(0004) COMP.
  4623     05  DOAHRFDF PIC  X(0001).
  4624     05  FILLER REDEFINES DOAHRFDF.
  4625         10  DOAHRFDA PIC  X(0001).
  4626     05  DOAHRFDI PIC  X(0011).
  4627*    -------------------------------
  4628     05  DITOTALL PIC S9(0004) COMP.
  4629     05  DITOTALF PIC  X(0001).
  4630     05  FILLER REDEFINES DITOTALF.
  4631         10  DITOTALA PIC  X(0001).
  4632     05  DITOTALI PIC  X(0005).
  4633*    -------------------------------
  4634     05  DIFATALL PIC S9(0004) COMP.
  4635     05  DIFATALF PIC  X(0001).
  4636     05  FILLER REDEFINES DIFATALF.
  4637         10  DIFATALA PIC  X(0001).
  4638     05  DIFATALI PIC  X(0005).
  4639*    -------------------------------
  4640     05  DIFORCEL PIC S9(0004) COMP.
  4641     05  DIFORCEF PIC  X(0001).
  4642     05  FILLER REDEFINES DIFORCEF.
  4643         10  DIFORCEA PIC  X(0001).
  4644     05  DIFORCEI PIC  X(0005).
  4645*    -------------------------------
  4646     05  DIHOLDL PIC S9(0004) COMP.
  4647     05  DIHOLDF PIC  X(0001).
  4648     05  FILLER REDEFINES DIHOLDF.
  4649         10  DIHOLDA PIC  X(0001).
  4650     05  DIHOLDI PIC  X(0005).
  4651*    -------------------------------
  4652     05  DIAVAILL PIC S9(0004) COMP.
  4653     05  DIAVAILF PIC  X(0001).
  4654     05  FILLER REDEFINES DIAVAILF.
  4655         10  DIAVAILA PIC  X(0001).
  4656     05  DIAVAILI PIC  X(0005).
  4657*    -------------------------------
  4658     05  DIGPREML PIC S9(0004) COMP.
  4659     05  DIGPREMF PIC  X(0001).
  4660     05  FILLER REDEFINES DIGPREMF.
  4661         10  DIGPREMA PIC  X(0001).
  4662     05  DIGPREMI PIC  X(0011).
  4663*    -------------------------------
  4664     05  DIBPREML PIC S9(0004) COMP.
  4665     05  DIBPREMF PIC  X(0001).
  4666     05  FILLER REDEFINES DIBPREMF.
  4667         10  DIBPREMA PIC  X(0001).
  4668     05  DIBPREMI PIC  X(0011).
  4669*    -------------------------------
  4670     05  DCTOTALL PIC S9(0004) COMP.
  4671     05  DCTOTALF PIC  X(0001).
  4672     05  FILLER REDEFINES DCTOTALF.
  4673         10  DCTOTALA PIC  X(0001).
  4674     05  DCTOTALI PIC  X(0005).
  4675*    -------------------------------
  4676     05  DCFATALL PIC S9(0004) COMP.
  4677     05  DCFATALF PIC  X(0001).
  4678     05  FILLER REDEFINES DCFATALF.
  4679         10  DCFATALA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  89
* EL6311.cbl
  4680     05  DCFATALI PIC  X(0005).
  4681*    -------------------------------
  4682     05  DCFORCEL PIC S9(0004) COMP.
  4683     05  DCFORCEF PIC  X(0001).
  4684     05  FILLER REDEFINES DCFORCEF.
  4685         10  DCFORCEA PIC  X(0001).
  4686     05  DCFORCEI PIC  X(0005).
  4687*    -------------------------------
  4688     05  DCHOLDL PIC S9(0004) COMP.
  4689     05  DCHOLDF PIC  X(0001).
  4690     05  FILLER REDEFINES DCHOLDF.
  4691         10  DCHOLDA PIC  X(0001).
  4692     05  DCHOLDI PIC  X(0005).
  4693*    -------------------------------
  4694     05  DCAVAILL PIC S9(0004) COMP.
  4695     05  DCAVAILF PIC  X(0001).
  4696     05  FILLER REDEFINES DCAVAILF.
  4697         10  DCAVAILA PIC  X(0001).
  4698     05  DCAVAILI PIC  X(0005).
  4699*    -------------------------------
  4700     05  DCGPREML PIC S9(0004) COMP.
  4701     05  DCGPREMF PIC  X(0001).
  4702     05  FILLER REDEFINES DCGPREMF.
  4703         10  DCGPREMA PIC  X(0001).
  4704     05  DCGPREMI PIC  X(0011).
  4705*    -------------------------------
  4706     05  DCBPREML PIC S9(0004) COMP.
  4707     05  DCBPREMF PIC  X(0001).
  4708     05  FILLER REDEFINES DCBPREMF.
  4709         10  DCBPREMA PIC  X(0001).
  4710     05  DCBPREMI PIC  X(0011).
  4711*    -------------------------------
  4712     05  DNTOTALL PIC S9(0004) COMP.
  4713     05  DNTOTALF PIC  X(0001).
  4714     05  FILLER REDEFINES DNTOTALF.
  4715         10  DNTOTALA PIC  X(0001).
  4716     05  DNTOTALI PIC  X(0005).
  4717*    -------------------------------
  4718     05  DNFATALL PIC S9(0004) COMP.
  4719     05  DNFATALF PIC  X(0001).
  4720     05  FILLER REDEFINES DNFATALF.
  4721         10  DNFATALA PIC  X(0001).
  4722     05  DNFATALI PIC  X(0005).
  4723*    -------------------------------
  4724     05  DNFORCEL PIC S9(0004) COMP.
  4725     05  DNFORCEF PIC  X(0001).
  4726     05  FILLER REDEFINES DNFORCEF.
  4727         10  DNFORCEA PIC  X(0001).
  4728     05  DNFORCEI PIC  X(0005).
  4729*    -------------------------------
  4730     05  DNHOLDL PIC S9(0004) COMP.
  4731     05  DNHOLDF PIC  X(0001).
  4732     05  FILLER REDEFINES DNHOLDF.
  4733         10  DNHOLDA PIC  X(0001).
  4734     05  DNHOLDI PIC  X(0005).
  4735*    -------------------------------
  4736     05  DNAVAILL PIC S9(0004) COMP.
  4737     05  DNAVAILF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  90
* EL6311.cbl
  4738     05  FILLER REDEFINES DNAVAILF.
  4739         10  DNAVAILA PIC  X(0001).
  4740     05  DNAVAILI PIC  X(0005).
  4741*    -------------------------------
  4742     05  DNGPREML PIC S9(0004) COMP.
  4743     05  DNGPREMF PIC  X(0001).
  4744     05  FILLER REDEFINES DNGPREMF.
  4745         10  DNGPREMA PIC  X(0001).
  4746     05  DNGPREMI PIC  X(0011).
  4747*    -------------------------------
  4748     05  DNBPREML PIC S9(0004) COMP.
  4749     05  DNBPREMF PIC  X(0001).
  4750     05  FILLER REDEFINES DNBPREMF.
  4751         10  DNBPREMA PIC  X(0001).
  4752     05  DNBPREMI PIC  X(0011).
  4753*    -------------------------------
  4754     05  DERMSGL PIC S9(0004) COMP.
  4755     05  DERMSGF PIC  X(0001).
  4756     05  FILLER REDEFINES DERMSGF.
  4757         10  DERMSGA PIC  X(0001).
  4758     05  DERMSGI PIC  X(0075).
  4759*    -------------------------------
  4760     05  DPFENTRL PIC S9(0004) COMP.
  4761     05  DPFENTRF PIC  X(0001).
  4762     05  FILLER REDEFINES DPFENTRF.
  4763         10  DPFENTRA PIC  X(0001).
  4764     05  DPFENTRI PIC  9(2).
  4765 01  EL631DO REDEFINES EL631BI.
  4766     05  FILLER            PIC  X(0012).
  4767*    -------------------------------
  4768     05  FILLER            PIC  X(0003).
  4769     05  DDATEO PIC  X(0008).
  4770*    -------------------------------
  4771     05  FILLER            PIC  X(0003).
  4772     05  DTIMEO PIC  99.99.
  4773*    -------------------------------
  4774     05  FILLER            PIC  X(0003).
  4775     05  DLDATEO PIC  X(0010).
  4776*    -------------------------------
  4777     05  FILLER            PIC  X(0003).
  4778     05  DBATCHO PIC  X(0011).
  4779*    -------------------------------
  4780     05  FILLER            PIC  X(0003).
  4781     05  DACCTNMO PIC  X(0030).
  4782*    -------------------------------
  4783     05  FILLER            PIC  X(0003).
  4784     05  DPROCDTO PIC  X(0008).
  4785*    -------------------------------
  4786     05  FILLER            PIC  X(0003).
  4787     05  DINPUTO PIC  X(0008).
  4788*    -------------------------------
  4789     05  FILLER            PIC  X(0003).
  4790     05  DMAINDTO PIC  X(0008).
  4791*    -------------------------------
  4792     05  FILLER            PIC  X(0003).
  4793     05  DCARRO PIC  X(0001).
  4794*    -------------------------------
  4795     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  91
* EL6311.cbl
  4796     05  DGROUPO PIC  X(0006).
  4797*    -------------------------------
  4798     05  FILLER            PIC  X(0003).
  4799     05  DSTATEO PIC  X(0002).
  4800*    -------------------------------
  4801     05  FILLER            PIC  X(0003).
  4802     05  DACCTO PIC  X(0010).
  4803*    -------------------------------
  4804     05  FILLER            PIC  X(0003).
  4805     05  DRECVDTO PIC  X(0008).
  4806*    -------------------------------
  4807     05  FILLER            PIC  X(0003).
  4808     05  DCSRO PIC  X(0004).
  4809*    -------------------------------
  4810     05  FILLER            PIC  X(0003).
  4811     05  DREFHDGO PIC  X(0010).
  4812*    -------------------------------
  4813     05  FILLER            PIC  X(0003).
  4814     05  DREFO PIC  X(0012).
  4815*    -------------------------------
  4816     05  FILLER            PIC  X(0003).
  4817     05  DLFPHDGO PIC  X(0010).
  4818*    -------------------------------
  4819     05  FILLER            PIC  X(0003).
  4820     05  DAHPHDGO PIC  X(0010).
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  DLFRHDGO PIC  X(0009).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  DAHRHDGO PIC  X(0009).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  DRISSO PIC  ZZ99-.
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  DRCANCO PIC  ZZ99-.
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  DEISSO PIC  ZZ99-.
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  DELFPRMO PIC  ZZZZZZ9.99-.
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  DEAHPRMO PIC  ZZZZZZ9.99-.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  92
* EL6311.cbl
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  DECANCO PIC  ZZ99-.
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  DELFRFDO PIC  ZZZZZZ9.99-.
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  DCISSO PIC  ZZ99-.
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  DCCANCO PIC  ZZ99-.
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  DOISSO PIC  ZZ99-.
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
  4889     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  DOCANCO PIC  ZZ99-.
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  DITOTALO PIC  ZZZ99.
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
  4904     05  DIFATALO PIC  ZZZ99.
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  DIFORCEO PIC  ZZZ99.
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  DIHOLDO PIC  ZZZ99.
  4911*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  93
* EL6311.cbl
  4912     05  FILLER            PIC  X(0003).
  4913     05  DIAVAILO PIC  ZZZ99.
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  DIGPREMO PIC  ZZZZZZZ9.99.
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  DIBPREMO PIC  ZZZZZZZ9.99.
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  DCTOTALO PIC  ZZZ99.
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  DCFATALO PIC  ZZZ99.
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  DCFORCEO PIC  ZZZ99.
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  DCHOLDO PIC  ZZZ99.
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  DCAVAILO PIC  ZZZ99.
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  DCGPREMO PIC  ZZZZZZZ9.99.
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  DCBPREMO PIC  ZZZZZZZ9.99.
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  DNTOTALO PIC  ---99.
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  DNFATALO PIC  ---99.
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  DNFORCEO PIC  ---99.
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  DNHOLDO PIC  ---99.
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  DNAVAILO PIC  ---99.
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  DNGPREMO PIC  -------9.99.
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  DNBPREMO PIC  -------9.99.
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  DERMSGO PIC  X(0075).
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  DPFENTRO PIC  X(0002).
  4968*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  94
* EL6311.cbl
  4970 01  MAP-B REDEFINES EL631BI.
  4971     12  FILLER                  PIC X(533).
  4972*    12  FILLER                  PIC X(512).
  4973*    12  FILLER                  PIC X(510).
  4974     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  4975         16  BKIND-LEN               PIC S9(4)  COMP.
  4976         16  BKIND-ATTRB             PIC X.
  4977         16  BKIND                   PIC XX.
  4978         16  BTYPE-LEN               PIC S9(4)  COMP.
  4979         16  BTYPE-ATTRB             PIC X.
  4980         16  BTYPE                   PIC X(3).
  4981         16  BTERM-LEN               PIC S9(4)  COMP.
  4982         16  BTERM-ATTRB             PIC X.
  4983         16  BTERMI                  PIC 999.
  4984         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  4985         16  BBEN-LEN                PIC S9(4)  COMP.
  4986         16  BBEN-ATTRB              PIC X.
  4987         16  BBENI                   PIC 9(10)V99.
  4988*        16  BBENI                   PIC 9(12).
  4989         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  4990         16  BPREM-LEN               PIC S9(4)  COMP.
  4991         16  BPREM-ATTRB             PIC X.
  4992         16  BPREMI                  PIC S9(9)V99.
  4993*        16  BPREMI                  PIC 9(11).
  4994         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  4995         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  4996         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  4997         16  BEXPIRE-ATTRB           PIC X.
  4998         16  BEXPIRE                 PIC X(8).
  4999         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5000         16  BCRIT-PERD-ATTRB        PIC X.
  5001         16  BCRIT-PERDI             PIC 99.
  5002         16  BCRIT-PERDO REDEFINES
  5003                         BCRIT-PERDI PIC ZZ.
  5004         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5005         16  BALT-BEN-ATTRB          PIC X.
  5006         16  BALT-BENI               PIC 9(10)V99.
  5007*        16  BALT-BENI               PIC 9(12).
  5008         16  BALT-BENO REDEFINES
  5009                           BALT-BENI PIC Z(9).ZZ.
  5010         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5011         16  BALT-PREM-ATTRB         PIC X.
  5012         16  BALT-PREMI              PIC 9(9)V99.
  5013*        16  BALT-PREMI              PIC 9(11).
  5014         16  BALT-PREMO REDEFINES
  5015                          BALT-PREMI PIC Z(7).ZZ-.
  5016         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5017         16  BBEN-CD-ATTRB           PIC X.
  5018         16  BBEN-CD                 PIC XXX.
  5019         16  BCPREM-LEN              PIC S9(4)  COMP.
  5020         16  BCPREM-ATTRB            PIC X.
  5021         16  BCPREMI                 PIC S9(9)V99.
  5022*        16  BCPREMI                 PIC X(11).
  5023         16  BCPREMO REDEFINES BCPREMI
  5024                                     PIC Z(7).99-.
  5025         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5026         16  BCALT-PREM-ATTRB        PIC X.
  5027         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  95
* EL6311.cbl
  5028         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5029         16  BBEN-ABBR-ATTRB         PIC X.
  5030         16  BBEN-ABBR               PIC X(5).
  5031         16  BDIFF-LEN               PIC S9(4)  COMP.
  5032         16  BDIFF-ATTRB             PIC X.
  5033         16  BDIFFO                  PIC Z(7).99-.
  5034         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5035         16  BBILL-LIT-ATTRB         PIC X.
  5036         16  BBILL-LIT               PIC X(8).
  5037         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5038         16  BDALT-PREM-ATTRB        PIC X.
  5039         16  BDALT-PREM              PIC Z(7).99-.
  5040
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  96
* EL6311.cbl
  5042
  5043****************************************************************
  5044*
  5045* Copyright (c) 2007 by Clerity Solutions, Inc.
  5046* All rights reserved.
  5047*
  5048****************************************************************
  5049 01  DFHEIV.
  5050   02  DFHEIV0               PIC X(35).
  5051   02  DFHEIV1               PIC X(08).
  5052   02  DFHEIV2               PIC X(08).
  5053   02  DFHEIV3               PIC X(08).
  5054   02  DFHEIV4               PIC X(06).
  5055   02  DFHEIV5               PIC X(04).
  5056   02  DFHEIV6               PIC X(04).
  5057   02  DFHEIV7               PIC X(02).
  5058   02  DFHEIV8               PIC X(02).
  5059   02  DFHEIV9               PIC X(01).
  5060   02  DFHEIV10              PIC S9(7) COMP-3.
  5061   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5062   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5063   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5064   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5065   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5066   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5067   02  DFHEIV17              PIC X(04).
  5068   02  DFHEIV18              PIC X(04).
  5069   02  DFHEIV19              PIC X(04).
  5070   02  DFHEIV20              USAGE IS POINTER.
  5071   02  DFHEIV21              USAGE IS POINTER.
  5072   02  DFHEIV22              USAGE IS POINTER.
  5073   02  DFHEIV23              USAGE IS POINTER.
  5074   02  DFHEIV24              USAGE IS POINTER.
  5075   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5076   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5077   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5078   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5079   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5080   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5081   02  FILLER                PIC X(02).
  5082   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5083   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5084   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5085   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5086   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5087 LINKAGE  SECTION.
  5088*****************************************************************
  5089*                                                               *
  5090* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5091* All rights reserved.                                          *
  5092*                                                               *
  5093*****************************************************************
  5094 01  dfheiblk.
  5095     02  eibtime          pic s9(7) comp-3.
  5096     02  eibdate          pic s9(7) comp-3.
  5097     02  eibtrnid         pic x(4).
  5098     02  eibtaskn         pic s9(7) comp-3.
  5099     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  97
* EL6311.cbl
  5100     02  dfheigdi         pic s9(4) comp.
  5101     02  eibcposn         pic s9(4) comp.
  5102     02  eibcalen         pic s9(4) comp.
  5103     02  eibaid           pic x(1).
  5104     02  eibfiller1       pic x(1).
  5105     02  eibfn            pic x(2).
  5106     02  eibfiller2       pic x(2).
  5107     02  eibrcode         pic x(6).
  5108     02  eibfiller3       pic x(2).
  5109     02  eibds            pic x(8).
  5110     02  eibreqid         pic x(8).
  5111     02  eibrsrce         pic x(8).
  5112     02  eibsync          pic x(1).
  5113     02  eibfree          pic x(1).
  5114     02  eibrecv          pic x(1).
  5115     02  eibsend          pic x(1).
  5116     02  eibatt           pic x(1).
  5117     02  eibeoc           pic x(1).
  5118     02  eibfmh           pic x(1).
  5119     02  eibcompl         pic x(1).
  5120     02  eibsig           pic x(1).
  5121     02  eibconf          pic x(1).
  5122     02  eiberr           pic x(1).
  5123     02  eibrldbk         pic x(1).
  5124     02  eiberrcd         pic x(4).
  5125     02  eibsynrb         pic x(1).
  5126     02  eibnodat         pic x(1).
  5127     02  eibfiller5       pic x(2).
  5128     02  eibresp          pic 9(09) comp.
  5129     02  eibresp2         pic 9(09) comp.
  5130     02  dfheigdj         pic s9(4) comp.
  5131     02  dfheigdk         pic s9(4) comp.
  5132 01  DFHCOMMAREA                 PIC X(1300).
  5133
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  98
* EL6311.cbl
  5135*    COPY ERCPNDB.
  5136******************************************************************
  5137*                                                                *
  5138*                                                                *
  5139*                            ERCPNDB.                            *
  5140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5141*                            VMOD=2.025                          *
  5142*                                                                *
  5143*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5144*                                                                *
  5145******************************************************************
  5146*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5147*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5148******************************************************************
  5149*                                                                *
  5150*                                                                *
  5151*   FILE TYPE = VSAM,KSDS                                        *
  5152*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5153*                                                                *
  5154*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5155*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5156*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5157*                                                 RKP=13,LEN=36  *
  5158*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5159*                                      AND CHG-SEQ.)             *
  5160*                                                RKP=49,LEN=11   *
  5161*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5162*                                      AND CHG-SEQ.)             *
  5163*                                                RKP=60,LEN=15   *
  5164*                                                                *
  5165*   LOG = NO                                                     *
  5166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5167******************************************************************
  5168******************************************************************
  5169*                   C H A N G E   L O G
  5170*
  5171* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5172*-----------------------------------------------------------------
  5173*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5174* EFFECTIVE    NUMBER
  5175*-----------------------------------------------------------------
  5176* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5177* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5178* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5179* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5180* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5181* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5182* 032306                   PEMA  ADD BOW LOAN NUMBER
  5183* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5184* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5185* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5186* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5187* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5188* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5189* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5190******************************************************************
  5191
  5192 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page  99
* EL6311.cbl
  5193     12  PB-RECORD-ID                     PIC XX.
  5194         88  VALID-PB-ID                        VALUE 'PB'.
  5195
  5196     12  PB-CONTROL-PRIMARY.
  5197         16  PB-COMPANY-CD                PIC X.
  5198         16  PB-ENTRY-BATCH               PIC X(6).
  5199         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5200         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5201
  5202     12  PB-CONTROL-BY-ACCOUNT.
  5203         16  PB-COMPANY-CD-A1             PIC X.
  5204         16  PB-CARRIER                   PIC X.
  5205         16  PB-GROUPING.
  5206             20  PB-GROUPING-PREFIX       PIC XXX.
  5207             20  PB-GROUPING-PRIME        PIC XXX.
  5208         16  PB-STATE                     PIC XX.
  5209         16  PB-ACCOUNT.
  5210             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5211             20  PB-ACCOUNT-PRIME         PIC X(6).
  5212         16  PB-CERT-EFF-DT               PIC XX.
  5213         16  PB-CERT-NO.
  5214             20  PB-CERT-PRIME            PIC X(10).
  5215             20  PB-CERT-SFX              PIC X.
  5216         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5217
  5218         16  PB-RECORD-TYPE               PIC X.
  5219             88  PB-MAILING-DATA                VALUE '0'.
  5220             88  PB-ISSUE                       VALUE '1'.
  5221             88  PB-CANCELLATION                VALUE '2'.
  5222             88  PB-BATCH-TRAILER               VALUE '9'.
  5223
  5224     12  PB-CONTROL-BY-ORIG-BATCH.
  5225         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5226         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5227         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5228         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5229
  5230     12  PB-CONTROL-BY-CSR.
  5231         16  PB-CSR-COMPANY-CD            PIC X.
  5232         16  PB-CSR-ID                    PIC X(4).
  5233         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5234         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5235         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5236******************************************************************
  5237*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5238******************************************************************
  5239
  5240     12  PB-LAST-MAINT-DT                 PIC XX.
  5241     12  PB-LAST-MAINT-BY                 PIC X(4).
  5242     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5243
  5244     12  PB-RECORD-BODY                   PIC X(375).
  5245
  5246     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5247         16  PB-CERT-ORIGIN               PIC X.
  5248             88  CLASIC-CREATED-CERT         VALUE '1'.
  5249         16  PB-I-NAME.
  5250             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 100
* EL6311.cbl
  5251             20  PB-I-INSURED-FIRST-NAME.
  5252                 24  PB-I-INSURED-1ST-INIT PIC X.
  5253                 24  FILLER                PIC X(9).
  5254             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5255         16  PB-I-AGE                     PIC S99   COMP-3.
  5256         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5257         16  PB-I-BIRTHDAY                PIC XX.
  5258         16  PB-I-INSURED-SEX             PIC X.
  5259             88  PB-SEX-MALE     VALUE 'M'.
  5260             88  PB-SEX-FEMALE   VALUE 'F'.
  5261
  5262         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5263         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5264         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5265         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5266         16  PB-I-SKIP-CODE               PIC X.
  5267             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5268             88  PB-SKIP-JULY              VALUE '1'.
  5269             88  PB-SKIP-AUGUST            VALUE '2'.
  5270             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5271             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5272             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5273             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5274             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5275             88  PB-SKIP-JUNE              VALUE '8'.
  5276             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5277             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5278             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5279         16  PB-I-TERM-TYPE               PIC X.
  5280             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5281             88  PB-PAID-WEEKLY            VALUE 'W'.
  5282             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5283             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5284             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5285         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5286         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5287         16  PB-I-DATA-ENTRY-SW           PIC X.
  5288             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5289             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5290             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5291             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5292         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5293         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5294*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5295         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5296         16  FILLER                       PIC X.
  5297
  5298         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5299             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5300             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5301                                                   '90' THRU '99'.
  5302         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5303                                          PIC XX.
  5304         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5305         16  PB-I-AMOUNT-FINANCED REDEFINES
  5306                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5307         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5308         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 101
* EL6311.cbl
  5309                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5310         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5311         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5312         16  PB-I-CLP-AMOUNT REDEFINES
  5313                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5314         16  PB-I-LF-CALC-FLAG            PIC X.
  5315             88 PB-COMP-LF-PREM               VALUE '?'.
  5316         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5317         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5318         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5319         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5320         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5321         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5322         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5323         16  PB-I-LF-ABBR                 PIC XXX.
  5324         16  PB-I-LF-INPUT-CD             PIC XX.
  5325
  5326         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5327             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5328             88  PB-INVALID-AH               VALUE '  ' '00'
  5329                                                   '90' THRU '99'.
  5330         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5331         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5332         16  PB-I-AH-CALC-FLAG            PIC X.
  5333             88 PB-COMP-AH-PREM                  VALUE '?'.
  5334         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5335         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5336         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5337         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5338         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5339         16  PB-I-AH-ABBR                 PIC XXX.
  5340         16  PB-I-AH-INPUT-CD             PIC XXX.
  5341
  5342         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5343         16  PB-I-REIN-TABLE              PIC XXX.
  5344         16  PB-I-BUSINESS-TYPE           PIC 99.
  5345         16  PB-I-INDV-GRP-CD             PIC X.
  5346         16  PB-I-MORT-CODE.
  5347             20  PB-I-TABLE               PIC X.
  5348             20  PB-I-INTEREST            PIC XX.
  5349             20  PB-I-MORT-TYP            PIC X.
  5350         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5351         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5352         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5353         16  PB-I-INDV-GRP-OVRD           PIC X.
  5354         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5355         16  PB-I-SIG-SW                  PIC X.
  5356             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5357         16  PB-I-RATE-CLASS              PIC XX.
  5358         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5359         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5360         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5361         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5362         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5363         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5364         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5365         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5366         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 102
* EL6311.cbl
  5367             88  PB-I-OB                      VALUE 'B'.
  5368             88  PB-I-SUMMARY                 VALUE 'Z'.
  5369         16  PB-I-ENTRY-STATUS            PIC X.
  5370             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5371                                              'M' '5' '9' '2'.
  5372             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5373             88  PB-I-POLICY-PENDING          VALUE '2'.
  5374             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5375             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5376             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5377             88  PB-I-REIN-ONLY               VALUE '9'.
  5378             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5379             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5380             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5381             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5382         16  PB-I-INT-CODE                PIC X.
  5383             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5384             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5385         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5386         16  PB-I-SOC-SEC-NO              PIC X(11).
  5387         16  PB-I-MEMBER-NO               PIC X(12).
  5388         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5389*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5390         16  PB-I-OLD-LOF                 PIC XXX.
  5391         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5392         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5393         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5394         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5395         16  PB-I-LIFE-INDICATOR          PIC X.
  5396             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5397         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5398         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5399             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5400             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5401         16  PB-I-1ST-PMT-DT              PIC XX.
  5402         16  PB-I-JOINT-INSURED.
  5403             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5404             20 PB-I-JOINT-FIRST-NAME.
  5405                24  PB-I-JOINT-FIRST-INIT PIC X.
  5406                24  FILLER                PIC X(9).
  5407             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5408*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5409         16  PB-I-BENEFICIARY-NAME.
  5410             20  PB-I-BANK-NUMBER         PIC X(10).
  5411             20  FILLER                   PIC X(15).
  5412         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5413         16  PB-I-REFERENCE               PIC X(12).
  5414         16  FILLER REDEFINES PB-I-REFERENCE.
  5415             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5416             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5417             20  PB-I-CLP-STATE           PIC XX.
  5418         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5419             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5420             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5421             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5422         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5423         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5424         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 103
* EL6311.cbl
  5425         16  PB-I-RATE-CODE               PIC X(4).
  5426         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5427         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5428         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5429         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5430         16  PB-I-BANK-NOCHRGB            PIC 99.
  5431         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5432         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5433
  5434     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5435         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5436             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5437         16  PB-C-CANCEL-ORIGIN           PIC X.
  5438             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5439         16  PB-C-LF-CANCEL-DT            PIC XX.
  5440         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5441         16  PB-C-LF-CALC-REQ             PIC X.
  5442             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5443         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5444         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5445         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5446             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5447         16  PB-C-AH-CANCEL-DT            PIC XX.
  5448         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5449         16  PB-C-AH-CALC-REQ             PIC X.
  5450             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5451         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5452         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5453         16  PB-C-LAST-NAME               PIC X(15).
  5454         16  PB-C-REFUND-SW               PIC X.
  5455             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5456             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5457         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5458         16  PB-C-PAYEE-CODE              PIC X(6).
  5459         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5460         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5461         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5462         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5463         16  PB-C-REFERENCE               PIC X(12).
  5464         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5465         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5466         16  PB-C-POST-CARD-IND           PIC X.
  5467         16  PB-C-CANCEL-REASON           PIC X.
  5468         16  PB-C-REF-INTERFACE-SW        PIC X.
  5469         16  FILLER                       PIC X(09).
  5470*        16  FILLER                       PIC X(18).
  5471         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5472*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5473         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5474         16  PB-CANCELED-CERT-DATA.
  5475             20  PB-CI-INSURED-NAME.
  5476                 24  PB-CI-LAST-NAME      PIC X(15).
  5477                 24  PB-CI-INITIALS       PIC XX.
  5478             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5479             20  PB-CI-INSURED-SEX        PIC X.
  5480             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5481             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5482             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 104
* EL6311.cbl
  5483             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5484             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5485             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5486             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5487             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5488             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5489             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5490             20  PB-CI-RATE-CLASS         PIC XX.
  5491             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5492             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5493             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5494             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5495             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5496             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5497             20  PB-CI-LF-ABBR            PIC X(3).
  5498             20  PB-CI-AH-ABBR            PIC X(3).
  5499             20  PB-CI-OB-FLAG            PIC X.
  5500                 88  PB-CI-OB                VALUE 'B'.
  5501             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5502                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5503                                           'M' '4' '5' '9' '2'.
  5504                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5505                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5506                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5507                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5508                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5509                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5510                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5511                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5512                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5513                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5514                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5515                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5516             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5517                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5518                                           'M' '4' '5' '9' '2'.
  5519                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5520                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5521                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5522                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5523                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5524                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5525                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5526                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5527                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5528                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5529                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5530                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5531             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5532             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5533             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5534             20  PB-CI-MEMBER-NO          PIC X(12).
  5535             20  PB-CI-INT-CODE           PIC X.
  5536                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5537                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5538             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5539             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5540             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 105
* EL6311.cbl
  5541                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5542                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5543             20  PB-CI-ENTRY-STATUS       PIC X.
  5544             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5545             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5546             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5547             20  PB-CI-DEATH-DT           PIC XX.
  5548             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5549             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5550             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5551             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5552             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5553             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5554             20  PB-CI-ENTRY-DT              PIC XX.
  5555             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5556             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5557             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5558             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5559             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5560             20  PB-CI-OLD-LOF               PIC XXX.
  5561*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5562             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5563             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5564             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5565             20  PB-CI-INDV-GRP-CD           PIC X.
  5566             20  PB-CI-BENEFICIARY-NAME.
  5567                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5568                 24  FILLER                  PIC X(15).
  5569             20  PB-CI-NOTE-SW               PIC X.
  5570             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5571             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5572             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5573             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5574             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5575             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5576             20  PB-CI-FIRST-NAME            PIC X(10).
  5577
  5578         16  FILLER                       PIC X(17).
  5579*032306  16  FILLER                       PIC X(27).
  5580*        16  FILLER                       PIC X(46).
  5581
  5582     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5583         16  FILLER                       PIC X(10).
  5584         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5585         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5586         16  PB-M-INSURED-MID-INIT        PIC X.
  5587         16  PB-M-INSURED-AGE             PIC 99.
  5588         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5589         16  PB-M-INSURED-SEX             PIC X.
  5590         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5591         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5592         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5593         16  PB-M-INSURED-CITY-STATE.
  5594             20  PB-M-INSURED-CITY        PIC X(28).
  5595             20  PB-M-INSURED-STATE       PIC XX.
  5596         16  PB-M-INSURED-ZIP-CODE.
  5597             20  PB-M-INSURED-ZIP-PRIME.
  5598                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 106
* EL6311.cbl
  5599                     88  PB-M-CANADIAN-POST-CODE
  5600                                             VALUE 'A' THRU 'Z'.
  5601                 24  FILLER               PIC X(4).
  5602             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5603         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5604                                        PB-M-INSURED-ZIP-CODE.
  5605             20  PM-M-INS-CAN-POST1       PIC XXX.
  5606             20  PM-M-INS-CAN-POST2       PIC XXX.
  5607             20  FILLER                   PIC XXX.
  5608         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5609         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5610         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5611         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5612         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5613         16  PB-M-CRED-BENE-CITYST.
  5614             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5615             20  PB-M-CRED-BENE-STATE     PIC XX.
  5616         16  FILLER                       PIC X(92).
  5617
  5618     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5619         16  FILLER                       PIC X(10).
  5620         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5621         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5622         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5623         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5624         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5625         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5626         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5627         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5628         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5629         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5630         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5631         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5632         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5633         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5634         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5635         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5636         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5637         16  PB-ACCOUNT-NAME              PIC X(30).
  5638         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5639         16  PB-REFERENCE                 PIC X(12).
  5640         16  PB-B-RECEIVED-DT             PIC XX.
  5641         16  FILLER                       PIC X(234).
  5642
  5643     12  PB-RECORD-STATUS.
  5644         16  PB-CREDIT-SELECT-DT          PIC XX.
  5645         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5646         16  PB-BILLED-DT                 PIC XX.
  5647         16  PB-BILLING-STATUS            PIC X.
  5648             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5649             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5650             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5651         16  PB-RECORD-BILL               PIC X.
  5652             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5653             88  PB-RECORD-RETURNED           VALUE 'R'.
  5654             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5655             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5656             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 107
* EL6311.cbl
  5657             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5658         16  PB-BATCH-ENTRY               PIC X.
  5659             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5660             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5661             88  PB-REISSUED-CERT             VALUE 'E'.
  5662             88  PB-MONTHLY-CERT              VALUE 'M'.
  5663             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5664             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5665             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5666         16  PB-FORCE-CODE                PIC X.
  5667             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5668             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5669             88  PB-CANCEL-FORCE              VALUE '8'.
  5670             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5671             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5672             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5673             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5674             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5675             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5676             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5677         16  PB-FATAL-FLAG                PIC X.
  5678             88  PB-FATAL-ERRORS              VALUE 'X'.
  5679         16  PB-FORCE-ER-CD               PIC X.
  5680             88  PB-FORCE-ERRORS              VALUE 'F'.
  5681             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5682         16  PB-WARN-ER-CD                PIC X.
  5683             88  PB-WARNING-ERRORS            VALUE 'W'.
  5684         16  FILLER                       PIC X.
  5685         16  PB-OUT-BAL-CD                PIC X.
  5686             88  PB-OUT-OF-BAL                VALUE 'O'.
  5687         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5688         16  PB-AH-OVERRIDE-L1            PIC X.
  5689         16  PB-INPUT-DT                  PIC XX.
  5690         16  PB-INPUT-BY                  PIC X(4).
  5691         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5692         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5693         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5694         16  PB-LF-EARNING-METHOD         PIC X.
  5695         16  PB-AH-EARNING-METHOD         PIC X.
  5696         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5697         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5698         16  PB-REIN-CD                   PIC XXX.
  5699         16  PB-LF-REFUND-TYPE            PIC X.
  5700         16  PB-AH-REFUND-TYPE            PIC X.
  5701         16  PB-ACCT-EFF-DT               PIC XX.
  5702         16  PB-ACCT-EXP-DT               PIC XX.
  5703         16  PB-COMPANY-ID                PIC X(3).
  5704         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5705         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5706         16  PB-SV-CARRIER                PIC X.
  5707         16  PB-SV-GROUPING               PIC X(6).
  5708         16  PB-SV-STATE                  PIC XX.
  5709         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5710         16  PB-GA-BILLING-INFO.
  5711             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5712                                          PIC XX.
  5713         16  PB-SV-REMIT-TO  REDEFINES
  5714             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 108
* EL6311.cbl
  5715         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5716         16  PB-I-LOAN-OFFICER            PIC X(5).
  5717         16  PB-I-VIN                     PIC X(17).
  5718
  5719         16  FILLER                       PIC X(04).
  5720         16  IMNET-BYPASS-SW              PIC X.
  5721
  5722******************************************************************
  5723*                COMMON EDIT ERRORS                              *
  5724******************************************************************
  5725
  5726     12  PB-COMMON-ERRORS.
  5727         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5728                                           PIC S9(4)     COMP.
  5729
  5730******************************************************************
  5731
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 109
* EL6311.cbl
  5733*    COPY ELCCERT.
  5734******************************************************************
  5735*                                                                *
  5736*                            ELCCERT.                            *
  5737*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5738*                            VMOD=2.013                          *
  5739*                                                                *
  5740*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5741*                                                                *
  5742*   FILE TYPE = VSAM,KSDS                                        *
  5743*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5744*                                                                *
  5745*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5746*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5747*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5748*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5749*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5750*                                                                *
  5751*   LOG = YES                                                    *
  5752*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5753******************************************************************
  5754*                   C H A N G E   L O G
  5755*
  5756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5757*-----------------------------------------------------------------
  5758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5759* EFFECTIVE    NUMBER
  5760*-----------------------------------------------------------------
  5761* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5762* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5763* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5764* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5765* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5766* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5767* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5768******************************************************************
  5769
  5770 01  CERTIFICATE-MASTER.
  5771     12  CM-RECORD-ID                      PIC XX.
  5772         88  VALID-CM-ID                      VALUE 'CM'.
  5773
  5774     12  CM-CONTROL-PRIMARY.
  5775         16  CM-COMPANY-CD                 PIC X.
  5776         16  CM-CARRIER                    PIC X.
  5777         16  CM-GROUPING.
  5778             20  CM-GROUPING-PREFIX        PIC X(3).
  5779             20  CM-GROUPING-PRIME         PIC X(3).
  5780         16  CM-STATE                      PIC XX.
  5781         16  CM-ACCOUNT.
  5782             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5783             20  CM-ACCOUNT-PRIME          PIC X(6).
  5784         16  CM-CERT-EFF-DT                PIC XX.
  5785         16  CM-CERT-NO.
  5786             20  CM-CERT-PRIME             PIC X(10).
  5787             20  CM-CERT-SFX               PIC X.
  5788
  5789     12  CM-CONTROL-BY-NAME.
  5790         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 110
* EL6311.cbl
  5791         16  CM-INSURED-LAST-NAME          PIC X(15).
  5792         16  CM-INSURED-INITIALS.
  5793             20  CM-INSURED-INITIAL1       PIC X.
  5794             20  CM-INSURED-INITIAL2       PIC X.
  5795
  5796     12  CM-CONTROL-BY-SSN.
  5797         16  CM-COMPANY-CD-A2              PIC X.
  5798         16  CM-SOC-SEC-NO.
  5799             20  CM-SSN-STATE              PIC XX.
  5800             20  CM-SSN-ACCOUNT            PIC X(6).
  5801             20  CM-SSN-LN3.
  5802                 25  CM-INSURED-INITIALS-A2.
  5803                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5804                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5805                 25 CM-PART-LAST-NAME-A2         PIC X.
  5806
  5807     12  CM-CONTROL-BY-CERT-NO.
  5808         16  CM-COMPANY-CD-A4              PIC X.
  5809         16  CM-CERT-NO-A4                 PIC X(11).
  5810
  5811     12  CM-CONTROL-BY-MEMB.
  5812         16  CM-COMPANY-CD-A5              PIC X.
  5813         16  CM-MEMBER-NO.
  5814             20  CM-MEMB-STATE             PIC XX.
  5815             20  CM-MEMB-ACCOUNT           PIC X(6).
  5816             20  CM-MEMB-LN4.
  5817                 25  CM-INSURED-INITIALS-A5.
  5818                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5819                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5820                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5821
  5822     12  CM-INSURED-PROFILE-DATA.
  5823         16  CM-INSURED-FIRST-NAME.
  5824             20  CM-INSURED-1ST-INIT       PIC X.
  5825             20  FILLER                    PIC X(9).
  5826         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5827         16  CM-INSURED-SEX                PIC X.
  5828             88  CM-SEX-MALE                  VALUE 'M'.
  5829             88  CM-SEX-FEMAL                 VALUE 'F'.
  5830         16  CM-INSURED-JOINT-AGE          PIC 99.
  5831         16  CM-JOINT-INSURED-NAME.
  5832             20  CM-JT-LAST-NAME           PIC X(15).
  5833             20  CM-JT-FIRST-NAME.
  5834                 24  CM-JT-1ST-INIT        PIC X.
  5835                 24  FILLER                PIC X(9).
  5836             20  CM-JT-INITIAL             PIC X.
  5837
  5838     12  CM-LIFE-DATA.
  5839         16  CM-LF-BENEFIT-CD              PIC XX.
  5840         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5841         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5842         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5843         16  CM-LF-DEV-CODE                PIC XXX.
  5844         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5845         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5846         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5847         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5848         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 111
* EL6311.cbl
  5849         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5850         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5851         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5852         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5853         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5854         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5855         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5856         16  FILLER                        PIC XX.
  5857
  5858     12  CM-AH-DATA.
  5859         16  CM-AH-BENEFIT-CD              PIC XX.
  5860         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5861         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5862         16  CM-AH-DEV-CODE                PIC XXX.
  5863         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5864         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5865         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5866         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5867         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5868         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5869         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5870         16  CM-AH-PAID-THRU-DT            PIC XX.
  5871             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5872         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5873         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5874         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5875         16  FILLER                        PIC X.
  5876
  5877     12  CM-LOAN-INFORMATION.
  5878         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5879         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5880         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5881         16  CM-PAY-FREQUENCY              PIC S99.
  5882         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5883         16  CM-RATE-CLASS                 PIC XX.
  5884         16  CM-BENEFICIARY                PIC X(25).
  5885         16  CM-POLICY-FORM-NO             PIC X(12).
  5886         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5887         16  CM-LAST-ADD-ON-DT             PIC XX.
  5888         16  CM-DEDUCTIBLE-AMOUNTS.
  5889             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5890             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5891         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5892             20  CM-RESIDENT-STATE         PIC XX.
  5893             20  CM-RATE-CODE              PIC X(4).
  5894             20  FILLER                    PIC XX.
  5895         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5896             20  CM-LOAN-OFFICER           PIC X(5).
  5897             20  FILLER                    PIC XXX.
  5898         16  CM-CSR-CODE                   PIC XXX.
  5899         16  CM-UNDERWRITING-CODE          PIC X.
  5900             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5901         16  CM-POST-CARD-IND              PIC X.
  5902         16  CM-NH-INTERFACE-SW            PIC X.
  5903         16  CM-PREMIUM-TYPE               PIC X.
  5904             88  CM-SING-PRM                  VALUE '1'.
  5905             88  CM-O-B-COVERAGE              VALUE '2'.
  5906             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 112
* EL6311.cbl
  5907         16  CM-IND-GRP-TYPE               PIC X.
  5908             88  CM-INDIVIDUAL                VALUE 'I'.
  5909             88  CM-GROUP                     VALUE 'G'.
  5910         16  CM-SKIP-CODE                  PIC X.
  5911             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5912             88  SKIP-JULY                    VALUE '1'.
  5913             88  SKIP-AUGUST                  VALUE '2'.
  5914             88  SKIP-SEPTEMBER               VALUE '3'.
  5915             88  SKIP-JULY-AUG                VALUE '4'.
  5916             88  SKIP-AUG-SEPT                VALUE '5'.
  5917             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5918             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5919             88  SKIP-JUNE                    VALUE '8'.
  5920             88  SKIP-JUNE-JULY               VALUE '9'.
  5921             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5922             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5923         16  CM-PAYMENT-MODE               PIC X.
  5924             88  PAY-MONTHLY                  VALUE SPACE.
  5925             88  PAY-WEEKLY                   VALUE '1'.
  5926             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5927             88  PAY-BI-WEEKLY                VALUE '3'.
  5928             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5929         16  CM-LOAN-NUMBER                PIC X(8).
  5930         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5931         16  CM-OLD-LOF                    PIC XXX.
  5932*        16  CM-LOAN-OFFICER               PIC XXX.
  5933         16  CM-REIN-TABLE                 PIC XXX.
  5934         16  CM-SPECIAL-REIN-CODE          PIC X.
  5935         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5936         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5937         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5938
  5939     12  CM-STATUS-DATA.
  5940         16  CM-ENTRY-STATUS               PIC X.
  5941         16  CM-ENTRY-DT                   PIC XX.
  5942
  5943         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5944         16  CM-LF-CANCEL-DT               PIC XX.
  5945         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5946
  5947         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5948         16  CM-LF-DEATH-DT                PIC XX.
  5949         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5950
  5951         16  CM-LF-CURRENT-STATUS          PIC X.
  5952             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5953                                                'M' '4' '5' '9'.
  5954             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5955             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5956             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5957             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5958             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5959             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5960             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5961             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5962             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5963             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5964             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 113
* EL6311.cbl
  5965             88  CM-LF-VOIDED                 VALUE 'V'.
  5966
  5967         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5968         16  CM-AH-CANCEL-DT               PIC XX.
  5969         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5970
  5971         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5972         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5973         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5974
  5975         16  CM-AH-CURRENT-STATUS          PIC X.
  5976             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5977                                                'M' '4' '5' '9'.
  5978             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5979             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5980             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5981             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5982             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5983             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5984             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5985             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5986             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5987             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5988             88  CM-AH-DECLINED               VALUE 'D'.
  5989             88  CM-AH-VOIDED                 VALUE 'V'.
  5990
  5991         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5992             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5993             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5994             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5995         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5996
  5997         16  CM-ENTRY-BATCH                PIC X(6).
  5998         16  CM-LF-EXIT-BATCH              PIC X(6).
  5999         16  CM-AH-EXIT-BATCH              PIC X(6).
  6000         16  CM-LAST-MONTH-END             PIC XX.
  6001
  6002     12  CM-NOTE-SW                        PIC X.
  6003         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6004         88  CERT-NOTES-PRESENT               VALUE '1'.
  6005         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6006         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6007         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6008         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6009         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6010         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6011     12  CM-COMP-EXCP-SW                   PIC X.
  6012         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6013         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6014     12  CM-INSURED-ADDRESS-SW             PIC X.
  6015         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6016         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6017
  6018*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6019     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6020     12  FILLER                            PIC X.
  6021
  6022*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 114
* EL6311.cbl
  6023     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6024     12  FILLER                            PIC X.
  6025*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6026     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6027
  6028     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6029         88  CERT-ADDED-BATCH                 VALUE ' '.
  6030         88  CERT-ADDED-ONLINE                VALUE '1'.
  6031         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6032         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6033         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6034     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6035         88  CERT-AS-LOADED                   VALUE ' '.
  6036         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6037         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6038         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6039         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6040         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6041         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6042         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6043
  6044     12  CM-ACCOUNT-COMM-PCTS.
  6045         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6046         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6047
  6048     12  CM-USER-FIELD                     PIC X.
  6049     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6050     12  CM-CLP-STATE                      PIC XX.
  6051     12  CM-USER-RESERVED                  PIC XXX.
  6052******************************************************************
  6053
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 115
* EL6311.cbl
  6055*    COPY ERCNOTE.
  6056******************************************************************
  6057*                                                                *
  6058*                                                                *
  6059*                            ERCNOTE                             *
  6060*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6061*                            VMOD=2.003                          *
  6062*                                                                *
  6063*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6064*                                                                *
  6065*        FILE TYPE= VSAM,KSDS                                    *
  6066*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6067*                                                                *
  6068*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6069*                                                                *
  6070*        LOG = YES                                               *
  6071*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6072*                                                                *
  6073******************************************************************
  6074*                   C H A N G E   L O G
  6075*
  6076* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6077*-----------------------------------------------------------------
  6078*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6079* EFFECTIVE    NUMBER
  6080*-----------------------------------------------------------------
  6081* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6082*                                FILE WILL CONTAIN BILLING NOTES O
  6083******************************************************************
  6084
  6085 01  CERTIFICATE-NOTE.
  6086     12  CN-RECORD-ID                PIC  XX.
  6087         88  VALID-CN-ID                  VALUE 'CN'.
  6088
  6089     12  CN-CONTROL-PRIMARY.
  6090         16  CN-COMPANY-CD           PIC X.
  6091         16  CN-CARRIER              PIC X.
  6092         16  CN-GROUPING.
  6093             20 CN-GROUPING-PREFIX   PIC XXX.
  6094             20 CN-GROUPING-PRIME    PIC XXX.
  6095         16  CN-STATE                PIC XX.
  6096         16  CN-ACCOUNT.
  6097             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6098             20 CN-ACCOUNT-PRIME     PIC X(6).
  6099         16  CN-CERT-EFF-DT          PIC XX.
  6100         16  CN-CERT-NO.
  6101             20  CN-CERT-PRIME       PIC X(10).
  6102             20  CN-CERT-SFX         PIC X.
  6103
  6104     12  CN-BILLING-START-LINE-NO    PIC 99.
  6105     12  CN-BILLING-END-LINE-NO      PIC 99.
  6106
  6107     12  CN-LINES.
  6108         16  CN-LINE OCCURS 10       PIC X(77).
  6109
  6110     12  CN-LAST-MAINT-DT            PIC XX.
  6111     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6112     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 116
* EL6311.cbl
  6113     12  FILLER                      PIC X(6).
  6114******************************************************************
  6115
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 117
* EL6311.cbl
  6117*    COPY ERCPNDM.
  6118******************************************************************
  6119*                                                                *
  6120*                                                                *
  6121*                            ERCPNDM                             *
  6122*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6123*                            VMOD=2.003                          *
  6124*                                                                *
  6125*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6126*                                                                *
  6127*   FILE TYPE = VSAM,KSDS                                        *
  6128*   RECORD SIZE = 374   RECFORM = FIX                            *
  6129*                                                                *
  6130*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6131*   ALTERNATE PATH    = NOT USED                                 *
  6132*                                                                *
  6133*   LOG = YES                                                    *
  6134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6135******************************************************************
  6136*                   C H A N G E   L O G
  6137*
  6138* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6139*-----------------------------------------------------------------
  6140*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6141* EFFECTIVE    NUMBER
  6142*-----------------------------------------------------------------
  6143* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6144* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6145* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6146******************************************************************
  6147
  6148 01  PENDING-MAILING-DATA.
  6149     12  PM-RECORD-ID                      PIC XX.
  6150         88  VALID-MA-ID                       VALUE 'PM'.
  6151
  6152     12  PM-CONTROL-PRIMARY.
  6153         16  PM-COMPANY-CD                 PIC X.
  6154         16  PM-ENTRY-BATCH                PIC X(6).
  6155         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6156         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6157
  6158     12  FILLER                            PIC X(14).
  6159
  6160     12  PM-ACCESS-CONTROL.
  6161         16  PM-SOURCE-SYSTEM              PIC XX.
  6162             88  PM-FROM-CREDIT                VALUE 'CR'.
  6163             88  PM-FROM-VSI                   VALUE 'VS'.
  6164             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6165             88  PM-FROM-OTHER                 VALUE 'OT'.
  6166         16  PM-RECORD-ADD-DT              PIC XX.
  6167         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6168         16  PM-LAST-MAINT-DT              PIC XX.
  6169         16  PM-LAST-MAINT-BY              PIC XXXX.
  6170         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6171
  6172     12  PM-PROFILE-INFO.
  6173         16  PM-QUALIFY-CODE-1             PIC XX.
  6174         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 118
* EL6311.cbl
  6175         16  PM-QUALIFY-CODE-3             PIC XX.
  6176         16  PM-QUALIFY-CODE-4             PIC XX.
  6177         16  PM-QUALIFY-CODE-5             PIC XX.
  6178
  6179         16  PM-INSURED-LAST-NAME          PIC X(15).
  6180         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6181         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6182         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6183         16  PM-INSURED-BIRTH-DT           PIC XX.
  6184         16  PM-INSURED-SEX                PIC X.
  6185             88  PM-SEX-MALE                   VALUE 'M'.
  6186             88  PM-SEX-FEMALE                 VALUE 'F'.
  6187         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6188
  6189         16  PM-ADDRESS-CORRECTED          PIC X.
  6190         16  PM-JOINT-BIRTH-DT             PIC XX.
  6191*        16  FILLER                        PIC X(12).
  6192
  6193         16  PM-ADDRESS-LINE-1             PIC X(30).
  6194         16  PM-ADDRESS-LINE-2             PIC X(30).
  6195         16  PM-CITY-STATE.
  6196             20  PM-CITY                   PIC X(28).
  6197             20  PM-STATE                  PIC XX.
  6198         16  PM-ZIP.
  6199             20  PM-ZIP-CODE.
  6200                 24  PM-ZIP-1              PIC X.
  6201                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6202                 24  FILLER                PIC X(4).
  6203             20  PM-ZIP-PLUS4              PIC X(4).
  6204         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6205             20  PM-CAN-POST1              PIC XXX.
  6206             20  PM-CAN-POST2              PIC XXX.
  6207             20  FILLER                    PIC XXX.
  6208
  6209         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6210
  6211         16  FILLER                        PIC X(03).
  6212
  6213     12  PM-CRED-BENE-INFO.
  6214         16  PM-CRED-BENE-NAME             PIC X(25).
  6215         16  PM-CRED-BENE-ADDR             PIC X(30).
  6216         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6217         16  PM-CRED-BENE-CTYST.
  6218             20  PM-CRED-BENE-CITY         PIC X(28).
  6219             20  PM-CRED-BENE-STATE        PIC XX.
  6220         16  PM-CRED-BENE-ZIP.
  6221             20  PM-CB-ZIP-CODE.
  6222                 24  PM-CB-ZIP-1           PIC X.
  6223                     88  PM-CB-CANADIAN-POST-CODE
  6224                                  VALUE 'A' THRU 'Z'.
  6225                 24  FILLER                PIC X(4).
  6226             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6227         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6228             20  PM-CB-CAN-POST1           PIC XXX.
  6229             20  PM-CB-CAN-POST2           PIC XXX.
  6230             20  FILLER                    PIC XXX.
  6231     12  PM-POST-CARD-MAIL-DATA.
  6232         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 119
* EL6311.cbl
  6233             20  PM-MAIL-TYPE              PIC X.
  6234                 88  PM-12MO-MAILING           VALUE '1'.
  6235                 88  PM-EXP-MAILING            VALUE '2'.
  6236             20  PM-MAIL-STATUS            PIC X.
  6237                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6238                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6239                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6240             20  PM-MAIL-DATE              PIC XX.
  6241     12  FILLER                            PIC XX.
  6242     12  FILLER                            PIC X(12).
  6243*    12  FILLER                            PIC X(30).
  6244
  6245******************************************************************
  6246
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 120
* EL6311.cbl
  6248*    COPY ERCMAIL.
  6249******************************************************************
  6250*                                                                *
  6251*                                                                *
  6252*                            ERCMAIL                             *
  6253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6254*                            VMOD=2.003                          *
  6255*                                                                *
  6256*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6257*                                                                *
  6258*   FILE TYPE = VSAM,KSDS                                        *
  6259*   RECORD SIZE = 374   RECFORM = FIX                            *
  6260*                                                                *
  6261*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6262*   ALTERNATE PATH    = NOT USED                                 *
  6263*                                                                *
  6264*   LOG = YES                                                    *
  6265*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6266******************************************************************
  6267*                   C H A N G E   L O G
  6268*
  6269* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6270*-----------------------------------------------------------------
  6271*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6272* EFFECTIVE    NUMBER
  6273*-----------------------------------------------------------------
  6274* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6275* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6276* 111108                   PEMA  ADD CRED BENE ADDR2
  6277******************************************************************
  6278
  6279 01  MAILING-DATA.
  6280     12  MA-RECORD-ID                      PIC XX.
  6281         88  VALID-MA-ID                       VALUE 'MA'.
  6282
  6283     12  MA-CONTROL-PRIMARY.
  6284         16  MA-COMPANY-CD                 PIC X.
  6285         16  MA-CARRIER                    PIC X.
  6286         16  MA-GROUPING.
  6287             20  MA-GROUPING-PREFIX        PIC XXX.
  6288             20  MA-GROUPING-PRIME         PIC XXX.
  6289         16  MA-STATE                      PIC XX.
  6290         16  MA-ACCOUNT.
  6291             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6292             20  MA-ACCOUNT-PRIME          PIC X(6).
  6293         16  MA-CERT-EFF-DT                PIC XX.
  6294         16  MA-CERT-NO.
  6295             20  MA-CERT-PRIME             PIC X(10).
  6296             20  MA-CERT-SFX               PIC X.
  6297
  6298     12  FILLER                            PIC XX.
  6299
  6300     12  MA-ACCESS-CONTROL.
  6301         16  MA-SOURCE-SYSTEM              PIC XX.
  6302             88  MA-FROM-CREDIT                VALUE 'CR'.
  6303             88  MA-FROM-VSI                   VALUE 'VS'.
  6304             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6305             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 121
* EL6311.cbl
  6306         16  MA-RECORD-ADD-DT              PIC XX.
  6307         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6308         16  MA-LAST-MAINT-DT              PIC XX.
  6309         16  MA-LAST-MAINT-BY              PIC XXXX.
  6310         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6311
  6312     12  MA-PROFILE-INFO.
  6313         16  MA-QUALIFY-CODE-1             PIC XX.
  6314         16  MA-QUALIFY-CODE-2             PIC XX.
  6315         16  MA-QUALIFY-CODE-3             PIC XX.
  6316         16  MA-QUALIFY-CODE-4             PIC XX.
  6317         16  MA-QUALIFY-CODE-5             PIC XX.
  6318
  6319         16  MA-INSURED-LAST-NAME          PIC X(15).
  6320         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6321         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6322         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6323         16  MA-INSURED-BIRTH-DT           PIC XX.
  6324         16  MA-INSURED-SEX                PIC X.
  6325             88  MA-SEX-MALE                   VALUE 'M'.
  6326             88  MA-SEX-FEMALE                 VALUE 'F'.
  6327         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6328
  6329         16  MA-ADDRESS-CORRECTED          PIC X.
  6330         16  MA-JOINT-BIRTH-DT             PIC XX.
  6331*        16  FILLER                        PIC X(12).
  6332
  6333         16  MA-ADDRESS-LINE-1             PIC X(30).
  6334         16  MA-ADDRESS-LINE-2             PIC X(30).
  6335         16  MA-CITY-STATE.
  6336             20  MA-CITY                   PIC X(28).
  6337             20  MA-ADDR-STATE             PIC XX.
  6338         16  MA-ZIP.
  6339             20  MA-ZIP-CODE.
  6340                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6341                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6342                 24  FILLER                PIC X(4).
  6343             20  MA-ZIP-PLUS4              PIC X(4).
  6344         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6345             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6346             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6347             20  FILLER                    PIC X(3).
  6348
  6349         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6350
  6351         16  FILLER                        PIC XXX.
  6352*        16  FILLER                        PIC X(10).
  6353
  6354     12  MA-CRED-BENE-INFO.
  6355         16  MA-CRED-BENE-NAME                 PIC X(25).
  6356         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6357         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6358         16  MA-CRED-BENE-CTYST.
  6359             20  MA-CRED-BENE-CITY             PIC X(28).
  6360             20  MA-CRED-BENE-STATE            PIC XX.
  6361         16  MA-CRED-BENE-ZIP.
  6362             20  MA-CB-ZIP-CODE.
  6363                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 122
* EL6311.cbl
  6364                     88  MA-CB-CANADIAN-POST-CODE
  6365                                           VALUE 'A' THRU 'Z'.
  6366                 24  FILLER                    PIC X(4).
  6367             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6368         16  MA-CB-CANADIAN-POSTAL-CODE
  6369                            REDEFINES MA-CRED-BENE-ZIP.
  6370             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6371             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6372             20  FILLER                        PIC X(3).
  6373     12  MA-POST-CARD-MAIL-DATA.
  6374         16  MA-MAIL-DATA OCCURS 7.
  6375             20  MA-MAIL-TYPE              PIC X.
  6376                 88  MA-12MO-MAILING           VALUE '1'.
  6377                 88  MA-EXP-MAILING            VALUE '2'.
  6378             20  MA-MAIL-STATUS            PIC X.
  6379                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6380                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6381                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6382             20  MA-MAIL-DATE              PIC XX.
  6383     12  FILLER                            PIC XX.
  6384     12  FILLER                            PIC XX.
  6385*    12  FILLER                            PIC X(30).
  6386******************************************************************
  6387
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 123
* EL6311.cbl
  6389*    COPY ERCRQST.
  6390******************************************************************
  6391*                                                                *
  6392*                                                                *
  6393*                            ERCRQST.                            *
  6394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6395*                            VMOD=2.002                          *
  6396*                                                                *
  6397*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  6398*                                                                *
  6399*   FILE TYPE = VSAM,KSDS                                        *
  6400*   RECORD SIZE = 200  RECFORM = FIXED                           *
  6401*                                                                *
  6402*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  6403*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  6404*                                   ACCOUNT, REF, BATCH)         *
  6405*                                                RKP=9, LEN=38   *
  6406*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  6407*                                   ACCOUNT, REF, BATCH)         *
  6408*                                                RKP=47, LEN=46  *
  6409*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  6410*                                   BATCH)                       *
  6411*                                                RKP=93, LEN=24  *
  6412*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  6413*                                   REF, BATCH)                  *
  6414*                                                RKP=117, LEN=35 *
  6415*   LOG = NO                                                     *
  6416*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6417******************************************************************
  6418
  6419 01  AR-REQUEST-RECORD.
  6420     12  RQ-RECORD-ID                     PIC XX.
  6421         88  VALID-RQ-ID                        VALUE 'RQ'.
  6422
  6423     12  RQ-CONTROL-PRIMARY.
  6424         16  RQ-COMPANY-CD                PIC X.
  6425         16  RQ-ENTRY-BATCH               PIC X(6).
  6426
  6427     12  RQ-CONTROL-BY-ACCT-REF.
  6428         16  RQ-COMPANY-CD-A1             PIC X.
  6429         16  RQ-CARRIER-A1                PIC X.
  6430         16  RQ-GROUPING-A1               PIC X(6).
  6431         16  RQ-STATE-A1                  PIC XX.
  6432         16  RQ-ACCOUNT-A1                PIC X(10).
  6433         16  RQ-REFERENCE-A1              PIC X(12).
  6434         16  RQ-BATCH-A1                  PIC X(6).
  6435
  6436     12  RQ-CONTROL-BY-FIN-RESP.
  6437         16  RQ-COMPANY-CD-A2             PIC X.
  6438         16  RQ-CARRIER-A2                PIC X.
  6439         16  RQ-GROUPING-A2               PIC X(6).
  6440         16  RQ-FIN-RESP-A2               PIC X(10).
  6441         16  RQ-ACCT-AGENT-A2             PIC X(10).
  6442         16  RQ-REFERENCE-A2              PIC X(12).
  6443         16  RQ-BATCH-A2                  PIC X(6).
  6444
  6445     12  RQ-CONTROL-BY-ACCT-AGENT.
  6446         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 124
* EL6311.cbl
  6447         16  RQ-CARRIER-A3                PIC X.
  6448         16  RQ-GROUPING-A3               PIC X(6).
  6449         16  RQ-ACCT-AGENT-A3             PIC X(10).
  6450         16  RQ-BATCH-A3                  PIC X(6).
  6451
  6452     12  RQ-CONTROL-BY-SUMMARY.
  6453         16  RQ-COMPANY-CD-A4             PIC X.
  6454         16  RQ-SUMMARY-CODE              PIC X(6).
  6455         16  RQ-ACCOUNT-A4                PIC X(10).
  6456         16  RQ-REFERENCE-A4              PIC X(12).
  6457         16  RQ-BATCH-A4                  PIC X(6).
  6458
  6459     12  RQ-REQUEST-METHOD                PIC X.
  6460         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  6461         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  6462         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  6463         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  6464     12  FILLER                           PIC X.
  6465     12  RQ-STATUS                        PIC X.
  6466         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  6467         88  RQ-RESUBMIT                      VALUE 'R'.
  6468     12  RQ-PROCESSOR-ID                  PIC X(4).
  6469     12  RQ-ENTRY-DT                      PIC XX.
  6470     12  RQ-MO-END-DT                     PIC XX.
  6471     12  RQ-REQUEST-DT                    PIC XX.
  6472     12  RQ-STMT-DT                       PIC XX.
  6473     12  RQ-REVERSAL-DT                   PIC XX.
  6474     12  RQ-CREDIT-SELECT-DT              PIC XX.
  6475     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  6476
  6477     12  FILLER                           PIC X(27).
  6478
  6479******************************************************************
  6480
  6481
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 125
* EL6311.cbl
  6483*    COPY ERCLOFC.
  6484******************************************************************
  6485*                                                                *
  6486*                                                                *
  6487*                            ERCLOFC                             *
  6488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6489*                            VMOD=2.003                          *
  6490*                                                                *
  6491*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  6492*                                                                *
  6493*   FILE TYPE = VSAM,KSDS                                        *
  6494*   RECORD SIZE = 670   RECFORM = FIX                            *
  6495*                                                                *
  6496*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  6497*                                                                *
  6498*   LOG = YES                                                    *
  6499*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6500*                                                                *
  6501******************************************************************
  6502
  6503 01  LOAN-OFFICER-MASTER.
  6504     12  LO-RECORD-ID                PIC XX.
  6505         88  VALID-LO-ID                VALUE 'LO'.
  6506
  6507     12  LO-CONTROL-PRIMARY.
  6508         16  LO-COMPANY-CD           PIC X.
  6509         16  LO-CARRIER              PIC X.
  6510         16  LO-GROUPING.
  6511             20  LO-GROUPING-PREFIX  PIC XXX.
  6512             20  LO-GROUPING-PRIME   PIC XXX.
  6513         16  LO-STATE                PIC XX.
  6514         16  LO-ACCOUNT.
  6515             20  LO-ACCOUNT-PREFIX   PIC X(4).
  6516             20  LO-ACCOUNT-PRIME    PIC X(6).
  6517         16  LO-OFFICER-CODE         PIC X(5).
  6518
  6519     12  LO-OFFICER-NAME             PIC X(30).
  6520
  6521     12  LO-LAST-MAINT-DT            PIC XX.
  6522     12  LO-LAST-USER                PIC X(4).
  6523     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  6524
  6525     12  LO-COMP-CONTROL             PIC X.
  6526             88  LO-SHOW-COMP           VALUE 'Y'.
  6527             88  LO-SUPPRESS-COMP       VALUE 'N'.
  6528     12  LO-DETAIL-CONTROL           PIC X.
  6529             88  LO-PRINT-DETAIL        VALUE 'D'.
  6530             88  LO-PRINT-SUMMARY       VALUE 'S'.
  6531
  6532     12  LO-SV-CARRIER               PIC X.
  6533     12  LO-SV-GROUPING              PIC X(6).
  6534     12  LO-SV-STATE                 PIC XX.
  6535
  6536     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  6537     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  6538
  6539     12  LO-OFFICER-INFO.
  6540         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 126
* EL6311.cbl
  6541             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  6542             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  6543             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  6544             20  LO-LF-PREM          PIC S9(7) COMP-3.
  6545             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  6546             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  6547             20  LO-AH-PREM          PIC S9(7) COMP-3.
  6548             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  6549     12  FILLER                      PIC X(198).
  6550******************************************************************
  6551
  6552*    COPY ERCPYAJ.
  6553******************************************************************
  6554*                                                                *
  6555*                            ERCPYAJ                             *
  6556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6557*                            VMOD=2.015                          *
  6558*                                                                *
  6559*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  6560*                                                                *
  6561*                                                                *
  6562*   FILE TYPE = VSAM,KSDS                                        *
  6563*   RECORD SIZE = 200  RECFORM = FIXED                           *
  6564*                                                                *
  6565*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  6566*       ALTERNATE PATHS = NONE                                   *
  6567*                                                                *
  6568*   LOG = YES                                                    *
  6569*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6570******************************************************************
  6571******************************************************************
  6572*                   C H A N G E   L O G
  6573*
  6574* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6575*-----------------------------------------------------------------
  6576*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6577* EFFECTIVE    NUMBER
  6578*-----------------------------------------------------------------
  6579* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  6580* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  6581******************************************************************
  6582
  6583 01  PENDING-PAY-ADJ.
  6584     12  PY-RECORD-ID                     PIC XX.
  6585         88  VALID-PY-ID                        VALUE 'PY'.
  6586
  6587     12  PY-CONTROL-PRIMARY.
  6588         16  PY-COMPANY-CD                PIC X.
  6589         16  PY-CARRIER                   PIC X.
  6590         16  PY-GROUPING                  PIC X(6).
  6591         16  PY-FIN-RESP                  PIC X(10).
  6592         16  PY-ACCOUNT                   PIC X(10).
  6593         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  6594                                          PIC X(10).
  6595         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  6596         16  PY-RECORD-TYPE               PIC X.
  6597             88  PY-REMIT-RECEIVED            VALUE 'R'.
  6598             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 127
* EL6311.cbl
  6599             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  6600             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  6601             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  6602             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  6603             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  6604             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  6605             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  6606             88  PY-FICA-ENTRY                VALUE 'F'.
  6607             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  6608             88  PY-POLICY-FEE                VALUE 'W'.
  6609             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  6610
  6611     12  PY-PYMT-TYPE                     PIC X.
  6612             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  6613             88  PY-REINS-PYMT                VALUE 'R'.
  6614             88  PY-EXP-PYMT                  VALUE 'E'.
  6615
  6616     12  PY-BIL-INV                       PIC X(6).
  6617     12  PY-REF-NO                        PIC X(12).
  6618
  6619     12  PY-LAST-MAINT-DT                 PIC XX.
  6620     12  PY-LAST-MAINT-BY                 PIC X(4).
  6621     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6622
  6623     12  PY-PYADJ-RECORD.
  6624         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  6625         16  PY-ENTRY-COMMENT             PIC X(30).
  6626         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  6627             20  PY-GL-ACCOUNT            PIC X(10).
  6628             20  PY-GL-STATE              PIC X(02).
  6629             20  PY-GL-CANC-SW            PIC X(01).
  6630                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  6631                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  6632             20  PY-GL-COMMENT            PIC X(10).
  6633             20  FILLER      REDEFINES PY-GL-COMMENT.
  6634                 24  PY-GL-CHECK-NO       PIC 9(06).
  6635                 24  FILLER               PIC X(04).
  6636             20  FILLER                   PIC X(07).
  6637         16  PY-SAVE-ACCOUNT              PIC X(10).
  6638         16  PY-SAVE-TYPE                 PIC X(01).
  6639
  6640         16  PY-LETTERS.
  6641             20  PY-LETTER OCCURS 3 TIMES
  6642                           INDEXED BY PY-LET-NDX
  6643                                          PIC X(04).
  6644
  6645         16  PY-ERCOMP-TYPE               PIC X.
  6646             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  6647             88  PY-GA-TYPE                   VALUE 'G'.
  6648             88  PY-BANK-TYPE                 VALUE 'B'.
  6649         16  FILLER                       PIC X(05).
  6650
  6651     12  PY-RECORD-STATUS.
  6652         16  PY-CREDIT-SELECT-DT          PIC XX.
  6653         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  6654         16  PY-BILLED-DATE               PIC XX.
  6655         16  PY-REPORTED-DT               PIC XX.
  6656         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 128
* EL6311.cbl
  6657             88  PY-ACCOUNT-PMT               VALUE 'A'.
  6658             88  PY-GA-PMT                    VALUE 'G'.
  6659             88  PY-OVWRITE-PMT               VALUE 'O'.
  6660             88  PY-NON-AR-PMT                VALUE 'N'.
  6661         16  FILLER                       PIC X(5).
  6662         16  PY-INPUT-DT                  PIC XX.
  6663         16  PY-CHECK-NUMBER              PIC X(6).
  6664         16  PY-VOID-SW                   PIC X.
  6665             88  PY-CHECK-VOIDED              VALUE 'V'.
  6666         16  PY-CHECK-ORIGIN-SW           PIC X.
  6667             88  PY-BILLING-CHECK             VALUE 'B'.
  6668             88  PY-REFUND-CHECK              VALUE 'R'.
  6669             88  PY-GA-CHECK                  VALUE 'G'.
  6670             88  PY-CHECK-WRITTEN             VALUE 'W'.
  6671             88  PY-CHECK-REVERSAL            VALUE 'V'.
  6672         16  PY-CHECK-WRITTEN-DT          PIC XX.
  6673         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  6674         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  6675         16  PY-BILL-FLAG                 PIC X.
  6676             88  PY-BILLED                    VALUE 'B'.
  6677         16  PY-AR-FLAG                   PIC X.
  6678             88  PY-AR-CYCLE                  VALUE 'C'.
  6679             88  PY-AR-MONTH-END              VALUE 'M'.
  6680         16  PY-AR-DATE                   PIC XX.
  6681
  6682     12  PY-GL-CODES.
  6683         16  PY-GL-DB                     PIC X(14).
  6684         16  PY-GL-CR                     PIC X(14).
  6685         16  PY-GL-FLAG                   PIC X.
  6686         16  PY-GL-DATE                   PIC XX.
  6687
  6688     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  6689     12  FILLER                           PIC X(3).
  6690******************************************************************
  6691
  6692*    COPY ERCCNOT.
  6693******************************************************************
  6694*                                                                *
  6695*                            ERCCNOT                             *
  6696*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6697*                            VMOD=2.003                          *
  6698*                                                                *
  6699*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  6700*                                                                *
  6701*        FILE TYPE= VSAM,KSDS                                    *
  6702*        RECORD SIZE = 150    RECFORM = FIXED                    *
  6703*                                                                *
  6704*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  6705*                                                                *
  6706*        LOG = YES                                               *
  6707*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6708*                                                                *
  6709******************************************************************
  6710*                   C H A N G E   L O G
  6711*
  6712* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6713*-----------------------------------------------------------------
  6714*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 129
* EL6311.cbl
  6715* EFFECTIVE    NUMBER
  6716*-----------------------------------------------------------------
  6717* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  6718******************************************************************
  6719
  6720 01  CERT-NOTE-FILE.
  6721     12  CZ-RECORD-ID                PIC  XX.
  6722         88  VALID-CZ-ID                  VALUE 'CZ'.
  6723
  6724     12  CZ-CONTROL-PRIMARY.
  6725         16  CZ-COMPANY-CD           PIC X.
  6726         16  CZ-CARRIER              PIC X.
  6727         16  CZ-GROUPING.
  6728             20 CZ-GROUPING-PREFIX   PIC XXX.
  6729             20 CZ-GROUPING-PRIME    PIC XXX.
  6730         16  CZ-STATE                PIC XX.
  6731         16  CZ-ACCOUNT.
  6732             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  6733             20 CZ-ACCOUNT-PRIME     PIC X(6).
  6734         16  CZ-CERT-EFF-DT          PIC XX.
  6735         16  CZ-CERT-NO.
  6736             20  CZ-CERT-PRIME       PIC X(10).
  6737             20  CZ-CERT-SFX         PIC X.
  6738         16  CZ-RECORD-TYPE          PIC X.
  6739             88  CERT-NOTE           VALUE '1'.
  6740             88  CLAIM-CERT-NOTE     VALUE '2'.
  6741         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  6742
  6743     12  CZ-LAST-MAINT-DT            PIC XX.
  6744     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6745     12  CZ-LAST-MAINT-USER          PIC X(4).
  6746
  6747     12  CZ-NOTE-INFORMATION.
  6748         16  CZ-NOTE                 PIC X(63).
  6749         16  FILLER                  PIC X(39).
  6750******************************************************************
  6751
  6752 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  6753                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  6754                          PENDING-MAILING-DATA MAILING-DATA
  6755                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  6756                          PENDING-PAY-ADJ CERT-NOTE-FILE.
  6757 0000-DFHEXIT SECTION.
  6758     MOVE '9#                    $   ' TO DFHEIV0.
  6759     MOVE 'EL6311' TO DFHEIV1.
  6760     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6761
  6762     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  6763     MOVE EIBTRMID               TO QID-TERM.
  6764     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  6765     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6766     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6767     MOVE 2                      TO EMI-SWITCH2.
  6768
  6769     IF EIBCALEN = 0
  6770         GO TO 8800-UNAUTHORIZED-ACCESS.
  6771
  6772     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 130
* EL6311.cbl
  6773     MOVE '5'                   TO DC-OPTION-CODE.
  6774     PERFORM 9700-DATE-LINK.
  6775     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  6776     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  6777
  6778     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  6779     MOVE SPACE                  TO DC-OPTION-CODE.
  6780     PERFORM 9700-DATE-LINK.
  6781     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  6782     MOVE LOW-VALUES             TO EL631BI.
  6783
  6784
  6785* EXEC CICS HANDLE CONDITION
  6786*        PGMIDERR  (9600-PGMID-ERROR)
  6787*        ERROR     (9990-ABEND)
  6788*        INVREQ    (9990-ABEND)
  6789*        QIDERR    (0010-MAIN-LOGIC)
  6790*    END-EXEC.
  6791*    MOVE '"$L.8N                ! " #00006780' TO DFHEIV0
  6792     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  6793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6794     MOVE X'2220233030303036373830' TO DFHEIV0(25:11)
  6795     CALL 'kxdfhei1' USING DFHEIV0
  6796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6797
  6798
  6799     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6800         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6801             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6802             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6803             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6804             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6805             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6806             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6807             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6808             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6809
  6810             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  6811                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  6812
  6813             ELSE
  6814                 NEXT SENTENCE
  6815
  6816         ELSE
  6817             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  6818             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6819             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6820             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6821             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6822             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6823             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6824             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6825             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6826             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  6827             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  6828             GO TO 3900-RE-DISPLAY-RECORD
  6829     ELSE
  6830         GO TO 0020-MAIN-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 131
* EL6311.cbl
  6831
  6832 0010-MAIN-LOGIC.
  6833     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  6834                                    WS-FIRST-ENTRY-SW.
  6835
  6836     MOVE LOW-VALUES             TO EC-NEW-CERT
  6837                                    EC-NEW-STATE.
  6838
  6839     IF PI-DISPLAY-ORIGINAL-BATCH
  6840         NEXT SENTENCE
  6841     ELSE
  6842         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  6843             GO TO 5000-BROWSE-BATCH-HEADERS.
  6844
  6845     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  6846         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  6847
  6848     IF PI-CSR-BROWSE
  6849        GO TO 4200-BROWSE-CSR-FORWARD.
  6850
  6851     IF PI-FILE-BROWSE
  6852         GO TO 4300-BROWSE-FILE-FORWARD.
  6853
  6854     GO TO 4000-BROWSE-DETAIL-FORWARD.
  6855
  6856 0020-MAIN-LOGIC.
  6857     IF EIBAID = DFHCLEAR
  6858         GO TO 9400-CLEAR.
  6859
  6860     MOVE LOW-VALUES             TO EC-NEW-CERT
  6861                                    EC-NEW-STATE.
  6862
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 132
* EL6311.cbl
  6864
  6865******************************************************************
  6866*                                                                *
  6867*              R E C E I V E   M A P                             *
  6868*                                                                *
  6869******************************************************************
  6870
  6871 0200-RECEIVE.
  6872     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6873         MOVE ER-0008            TO EMI-ERROR
  6874         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6875         IF PI-MAP-NAME = EL631B
  6876             MOVE -1                 TO BMAINTL
  6877             GO TO 8200-SEND-DATAONLY
  6878         ELSE
  6879             IF PI-MAP-NAME = EL631C
  6880                 MOVE -1                 TO CMAINTL
  6881                 GO TO 8200-SEND-DATAONLY
  6882             ELSE
  6883                 IF PI-MAP-NAME = EL631D
  6884                     MOVE -1                 TO DPFENTRL
  6885                     GO TO 8200-SEND-DATAONLY.
  6886
  6887
  6888* EXEC CICS RECEIVE
  6889*        MAP      (PI-MAP-NAME)
  6890*        MAPSET   (MAPSET-EL6311S)
  6891*        INTO     (EL631BI)
  6892*    END-EXEC.
  6893     MOVE LENGTH OF
  6894      EL631BI
  6895       TO DFHEIV11
  6896*    MOVE '8"T I  L              ''   #00006875' TO DFHEIV0
  6897     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6898     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6899     MOVE X'2020233030303036383735' TO DFHEIV0(25:11)
  6900     CALL 'kxdfhei1' USING DFHEIV0,
  6901           PI-MAP-NAME,
  6902           EL631BI,
  6903           DFHEIV11,
  6904           MAPSET-EL6311S,
  6905           DFHEIV99,
  6906           DFHEIV99
  6907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6908
  6909
  6910******************************************************************
  6911*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  6912******************************************************************
  6913
  6914     IF BTYPE-LEN (1) EQUAL +3
  6915        IF BTYPE (1) EQUAL ALL ' '
  6916            MOVE 'Y' TO WS-REMOVE-LF-SW.
  6917
  6918     IF BTYPE-LEN (2) EQUAL +3
  6919        IF BTYPE (2) EQUAL ALL ' '
  6920            MOVE 'Y' TO WS-REMOVE-AH-SW.
  6921
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 133
* EL6311.cbl
  6922     INSPECT EL631BI CONVERTING '_' TO ' '.
  6923
  6924     IF PI-MAP-NAME = EL631B
  6925         IF BPFENTRL GREATER THAN ZEROS
  6926             IF EIBAID NOT = DFHENTER
  6927                 MOVE ER-0004       TO EMI-ERROR
  6928                 MOVE -1            TO BPFENTRL
  6929                 MOVE AL-UNBOF      TO BPFENTRA
  6930                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6931                 GO TO 8200-SEND-DATAONLY
  6932             ELSE
  6933                 IF BPFENTRI NUMERIC AND
  6934                   (BPFENTRI GREATER 0 AND LESS 25)
  6935                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  6936                 ELSE
  6937                     MOVE ER-0029  TO EMI-ERROR
  6938                     MOVE AL-UNBON TO BPFENTRA
  6939                     MOVE -1       TO BPFENTRL
  6940                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6941                     GO TO 8200-SEND-DATAONLY
  6942         ELSE
  6943             NEXT SENTENCE
  6944     ELSE
  6945         IF PI-MAP-NAME = EL631C
  6946            IF CPFENTRL GREATER THAN ZEROS
  6947                IF EIBAID NOT = DFHENTER
  6948                 MOVE ER-0004         TO EMI-ERROR
  6949                 MOVE -1              TO CPFENTRL
  6950                 MOVE AL-UNBOF        TO CPFENTRA
  6951                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6952                 GO TO 8200-SEND-DATAONLY
  6953             ELSE
  6954                 IF CPFENTRI NUMERIC AND
  6955                   (CPFENTRI GREATER 0 AND LESS 25)
  6956                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  6957                 ELSE
  6958                     MOVE ER-0029      TO EMI-ERROR
  6959                     MOVE AL-UNBON     TO CPFENTRA
  6960                     MOVE -1           TO CPFENTRL
  6961                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6962                     GO TO 8200-SEND-DATAONLY
  6963         ELSE
  6964             NEXT SENTENCE
  6965     ELSE
  6966     IF PI-MAP-NAME = EL631D
  6967         IF DPFENTRL GREATER THAN ZEROS
  6968             IF EIBAID NOT = DFHENTER
  6969                 MOVE ER-0004         TO EMI-ERROR
  6970                 MOVE -1              TO DPFENTRL
  6971                 MOVE AL-UNBOF        TO DPFENTRA
  6972                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6973                 GO TO 8200-SEND-DATAONLY
  6974             ELSE
  6975                 IF DPFENTRI NUMERIC AND
  6976                   (DPFENTRI GREATER 0 AND LESS 25)
  6977                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  6978                 ELSE
  6979                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 134
* EL6311.cbl
  6980                     MOVE AL-UNBON     TO DPFENTRA
  6981                     MOVE -1           TO DPFENTRL
  6982                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6983                     GO TO 8200-SEND-DATAONLY.
  6984
  6985     IF EIBAID = DFHPF23
  6986         GO TO 8810-PF23.
  6987
  6988     IF EIBAID = DFHPF24
  6989         GO TO 9200-RETURN-MAIN-MENU.
  6990
  6991     IF EIBAID = DFHPF12
  6992         GO TO 9500-PF12.
  6993
  6994     IF PI-MAP-NAME = EL631B
  6995        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  6996
  6997     IF PI-MAP-NAME = EL631C
  6998        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  6999
  7000     IF PI-MAP-NAME = EL631D
  7001        GO TO 0500-CHECK-BATCH-PF-KEYS.
  7002
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 135
* EL6311.cbl
  7004
  7005******************************************************************
  7006*                                                                *
  7007*      ISSUE SCREEN PF KEY CHECKING                              *
  7008*                                                                *
  7009******************************************************************
  7010
  7011******************************************************************
  7012*                                                                *
  7013*      PF KEY FUNCTIONS:                                         *
  7014*                                                                *
  7015*      PF1  = BROWSE FORWARD                                     *
  7016*      PF2  = BROWSE BACKWARD                                    *
  7017*      PF3  = CERTIFICATE LOOKUP                                 *
  7018*      PF4  = DISPLAY BATCH HEADER                               *
  7019*      PF5  = ADD ISSUE  SCREEN                                  *
  7020*      PF6  = ADD CANCEL SCREEN                                  *
  7021*      PF7  = CERTIFICATE DISPLAY                                *
  7022*      PF8  = CERTIFICATE NOTES                                  *
  7023*      PF9  = EDIT CONTROL                                       *
  7024*      PF10 = DISPLAY LETTER SCREEN                              *
  7025*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  7026*      PF12 = HELP SCREEN                                        *
  7027*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  7028*      PF14 = ACCOUNT MASTER                                     *
  7029*      PF15 = PAYMENT CALCULATOR (HER ONLY)                      *
  7030*      PF16 = DISPLAY LETTER REVIEW                              *
  7031*                                                                *
  7032******************************************************************
  7033
  7034 0300-CHECK-ISSUE-PF-KEYS.
  7035     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  7036        MOVE ER-2337            TO EMI-ERROR
  7037        MOVE -1                  TO BMAINTL
  7038        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7039        GO TO 8200-SEND-DATAONLY.
  7040
  7041     IF EIBAID = DFHPF1
  7042        MOVE '0'                TO PI-EDIT-SW
  7043        IF PI-PRIMARY-BROWSE
  7044           GO TO 4100-BROWSE-PRIMARY-FORWARD
  7045        ELSE
  7046           IF PI-PRIMARY-WITH-SELECT
  7047              GO TO 4100-BROWSE-PRIMARY-FORWARD
  7048           ELSE
  7049              IF PI-FILE-BROWSE
  7050                 GO TO 4300-BROWSE-FILE-FORWARD
  7051              ELSE
  7052                 IF PI-CSR-BROWSE
  7053                    GO TO 4200-BROWSE-CSR-FORWARD
  7054                 ELSE
  7055                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  7056
  7057     IF EIBAID = DFHPF2
  7058        MOVE '0'                TO PI-EDIT-SW
  7059        IF PI-PRIMARY-BROWSE
  7060           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  7061        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 136
* EL6311.cbl
  7062           IF PI-PRIMARY-WITH-SELECT
  7063              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  7064           ELSE
  7065              IF PI-FILE-BROWSE
  7066                 GO TO 4800-BROWSE-FILE-BACKWARD
  7067              ELSE
  7068                 IF PI-CSR-BROWSE
  7069                    GO TO 4900-BROWSE-CSR-BACKWARD
  7070                 ELSE
  7071                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  7072
  7073     IF EIBAID = DFHPF3
  7074        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7075        MOVE XCTL-EL127         TO PGM-NAME
  7076        GO TO 9300-XCTL.
  7077
  7078     IF EIBAID = DFHPF15
  7079        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  7080        MOVE PI-SV-CARRIER       TO PI-CARRIER
  7081        MOVE PI-SV-GROUPING      TO PI-GROUPING
  7082        MOVE PI-SV-STATE         TO PI-STATE
  7083        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  7084        MOVE BCERTNOI            TO PI-CERT-PRIME
  7085        MOVE BSUFIXI             TO PI-CERT-SFX
  7086        MOVE BEFFDTI             TO DEEDIT-FIELD
  7087        PERFORM 8600-DEEDIT
  7088        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7089        MOVE '4'                 TO DC-OPTION-CODE
  7090        PERFORM 9700-DATE-LINK
  7091        IF DATE-CONVERSION-ERROR
  7092           MOVE ER-0348          TO EMI-ERROR
  7093           MOVE -1               TO BEFFDTL
  7094           MOVE AL-UABON         TO BEFFDTA
  7095           PERFORM 9900-ERROR-FORMAT
  7096                                 THRU 9900-EXIT
  7097           GO TO 8200-SEND-DATAONLY
  7098        ELSE
  7099           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  7100           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7101           MOVE XCTL-EL6314      TO PGM-NAME
  7102           MOVE '1'              TO PI-PROGRAM-WORK-AREA
  7103           GO TO 9300-XCTL
  7104        END-IF
  7105     END-IF
  7106
  7107     IF EIBAID = DFHPF4
  7108        MOVE '0'                TO PI-EDIT-SW
  7109        IF PI-DISPLAY-ORIGINAL-BATCH
  7110           NEXT SENTENCE
  7111        ELSE
  7112           GO TO 7200-DISPLAY-BATCHES.
  7113
  7114     IF EIBAID = DFHPF5
  7115        MOVE '0'                TO PI-EDIT-SW
  7116        IF PI-DISPLAY-ORIGINAL-BATCH
  7117           NEXT SENTENCE
  7118        ELSE
  7119           MOVE EL631B              TO PI-MAP-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 137
* EL6311.cbl
  7120           MOVE LOW-VALUES          TO EL631BI
  7121           MOVE 'A'                 TO BMAINTO
  7122           MOVE AL-UANON            TO BMAINTA
  7123           MOVE -1                  TO BMAINTL
  7124           MOVE '5'                 TO PI-MAINT-FUNCTION
  7125           GO TO 8100-SEND-INITIAL-MAP.
  7126
  7127     IF EIBAID = DFHPF6
  7128        MOVE '0'                TO PI-EDIT-SW
  7129        IF PI-DISPLAY-ORIGINAL-BATCH
  7130           NEXT SENTENCE
  7131        ELSE
  7132           MOVE EL631C              TO PI-MAP-NAME
  7133           MOVE LOW-VALUES          TO EL631CI
  7134           MOVE 'A'                 TO CMAINTO
  7135           MOVE AL-UANON            TO CMAINTA
  7136           MOVE -1                  TO CMAINTL
  7137           MOVE '6'                 TO PI-MAINT-FUNCTION
  7138           GO TO 8100-SEND-INITIAL-MAP.
  7139
  7140     IF EIBAID = DFHPF7
  7141        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  7142        MOVE PI-SV-CARRIER          TO PI-CARRIER
  7143        MOVE PI-SV-GROUPING         TO PI-GROUPING
  7144        MOVE PI-SV-STATE            TO PI-STATE
  7145        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  7146        MOVE BCERTNOI               TO PI-CERT-PRIME
  7147        MOVE BSUFIXI                TO PI-CERT-SFX
  7148        MOVE BEFFDTI                TO DEEDIT-FIELD
  7149        PERFORM 8600-DEEDIT
  7150        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7151        MOVE '4'                    TO DC-OPTION-CODE
  7152        PERFORM 9700-DATE-LINK
  7153        IF DATE-CONVERSION-ERROR
  7154           MOVE ER-0348            TO EMI-ERROR
  7155           MOVE -1                  TO BEFFDTL
  7156           MOVE AL-UABON            TO BEFFDTA
  7157           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7158           GO TO 8200-SEND-DATAONLY
  7159        ELSE
  7160           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  7161           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7162           MOVE XCTL-EL1273        TO PGM-NAME
  7163           GO TO 9300-XCTL.
  7164
  7165     IF EIBAID = DFHPF8
  7166        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  7167        MOVE PI-SV-CARRIER          TO PI-CARRIER
  7168        MOVE PI-SV-GROUPING         TO PI-GROUPING
  7169        MOVE PI-SV-STATE            TO PI-STATE
  7170        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  7171        MOVE BCERTNOI               TO PI-CERT-PRIME
  7172        MOVE BSUFIXI                TO PI-CERT-SFX
  7173        MOVE BEFFDTI                TO DEEDIT-FIELD
  7174        PERFORM 8600-DEEDIT
  7175        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7176        MOVE '4'                    TO DC-OPTION-CODE
  7177        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 138
* EL6311.cbl
  7178        IF DATE-CONVERSION-ERROR
  7179           MOVE ER-0348            TO EMI-ERROR
  7180           MOVE -1                  TO BEFFDTL
  7181           MOVE AL-UABON            TO BEFFDTA
  7182           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7183           GO TO 8200-SEND-DATAONLY
  7184        ELSE
  7185           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  7186           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7187           IF PI-COMPANY-ID = 'DMD'
  7188               MOVE XCTL-EL401DMD      TO PGM-NAME
  7189             ELSE
  7190               MOVE XCTL-EL1279        TO PGM-NAME
  7191           END-IF
  7192           GO TO 9300-XCTL.
  7193
  7194     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  7195        MOVE XCTL-EL6312         TO PGM-NAME
  7196
  7197* EXEC CICS XCTL
  7198*           PROGRAM   (PGM-NAME)
  7199*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  7200*           LENGTH    (WS-COMM-LENGTH)
  7201*       END-EXEC
  7202*    MOVE '.$C                   $   #00007167' TO DFHEIV0
  7203     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7204     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7205     MOVE X'2020233030303037313637' TO DFHEIV0(25:11)
  7206     CALL 'kxdfhei1' USING DFHEIV0,
  7207           PGM-NAME,
  7208           PROGRAM-INTERFACE-BLOCK,
  7209           WS-COMM-LENGTH
  7210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7211     ELSE
  7212        MOVE '0'                 TO  PI-EDIT-SW.
  7213
  7214     IF  EIBAID = DFHPF10
  7215         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7216         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  7217         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  7218                                    PI-1042-WA
  7219         MOVE 4                  TO PI-689-DATA-SOURCE
  7220         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  7221         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  7222         MOVE PI-SV-STATE        TO PI-689-STATE
  7223         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  7224         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  7225         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  7226         MOVE PI-PB-ALT-CHG-SEQ-NO
  7227                                 TO PI-689-ALT-SEQ-NO
  7228         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  7229         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  7230         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  7231         MOVE +0                 TO PI-689-CONTROL
  7232         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  7233                                    PI-689-EXP-DATE
  7234                                    PI-689-RESP-PERSON
  7235                                    PI-689-TYPE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 139
* EL6311.cbl
  7236                                    PI-689-FOLLOW-UP-EDIT
  7237                                    PI-689-RESEND1-EDIT
  7238                                    PI-689-SEQ-EDIT
  7239                                    PI-689-BCSEQ-EDIT
  7240                                    PI-689-LBL-OVERRIDE
  7241         MOVE W-LETTER-COMMUNICATION-AREAS
  7242                                 TO PI-PROGRAM-WORK-AREA
  7243         MOVE XCTL-EL689         TO PGM-NAME
  7244         GO TO 9300-XCTL.
  7245
  7246     IF  EIBAID = DFHPF16
  7247         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7248         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  7249         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  7250                                    PI-1042-WA
  7251         MOVE 4                  TO PI-689-DATA-SOURCE
  7252         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  7253         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  7254         MOVE PI-SV-STATE        TO PI-689-STATE
  7255         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  7256         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  7257         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  7258         MOVE PI-PB-ALT-CHG-SEQ-NO
  7259                                 TO PI-689-ALT-SEQ-NO
  7260         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  7261         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  7262         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  7263         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  7264         MOVE W-LETTER-COMMUNICATION-AREAS
  7265                                 TO PI-PROGRAM-WORK-AREA
  7266         MOVE XCTL-EL690         TO PGM-NAME
  7267         GO TO 9300-XCTL.
  7268
  7269     IF EIBAID = DFHPF13
  7270         MOVE XCTL-EL6313        TO PGM-NAME
  7271         GO TO 9300-XCTL.
  7272
  7273     IF EIBAID = DFHPF17
  7274        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  7275        IF (PB-I-LOAN-APR > ZEROS)
  7276           AND (PB-I-BENEFICIARY-NAME NOT
  7277              = SPACES AND LOW-VALUES)
  7278
  7279* EXEC CICS START
  7280*            INTERVAL    (0)
  7281*            TRANSID     ('VADS')
  7282*            FROM        (WS-PASS-AREA)
  7283*            LENGTH      (WS-PASS-AREA-LENGTH)
  7284*            TERMID      (PI-PROCESSOR-PRINTER)
  7285*            TERMID      ('PRNB')
  7286*          END-EXEC
  7287     MOVE 0 TO DFHEIV10
  7288     MOVE 'VADS' TO DFHEIV5
  7289*    MOVE '0(ILFT                0   #00007239' TO DFHEIV0
  7290     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
  7291     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  7292     MOVE X'2020233030303037323339' TO DFHEIV0(25:11)
  7293     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 140
* EL6311.cbl
  7294           DFHEIV10,
  7295           DFHEIV5,
  7296           DFHEIV99,
  7297           WS-PASS-AREA,
  7298           WS-PASS-AREA-LENGTH,
  7299           PI-PROCESSOR-PRINTER,
  7300           DFHEIV99,
  7301           DFHEIV99,
  7302           DFHEIV99,
  7303           DFHEIV99,
  7304           DFHEIV99,
  7305           DFHEIV99,
  7306           DFHEIV99,
  7307           DFHEIV99,
  7308           DFHEIV99
  7309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7310           MOVE 0000             TO EMI-ERROR
  7311           MOVE -1               TO BMAINTL
  7312           PERFORM 9900-ERROR-FORMAT
  7313                                 THRU 9900-EXIT
  7314           GO TO 8200-SEND-DATAONLY
  7315        ELSE
  7316           MOVE ER-0877            TO EMI-ERROR
  7317           MOVE -1                  TO BEFFDTL
  7318           MOVE AL-UABON            TO BEFFDTA
  7319           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7320           GO TO 8200-SEND-DATAONLY
  7321        END-IF
  7322     END-IF
  7323     IF EIBAID = DFHPF14
  7324        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  7325        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  7326        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  7327        MOVE PI-SV-STATE            TO PI-CR-STATE
  7328        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  7329        MOVE SPACE                  TO PI-EDIT-SW
  7330        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7331        MOVE XCTL-EL650             TO PGM-NAME
  7332        GO TO 9300-XCTL.
  7333
  7334     IF EIBAID = DFHPF15
  7335        IF PI-COMPANY-ID  =  'HER'
  7336            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7337            MOVE XCTL-EL680         TO PGM-NAME
  7338            GO TO 9300-XCTL.
  7339
  7340     IF EIBAID = DFHENTER OR DFHPF11
  7341        GO TO 1000-ISSUE-MAINLINE.
  7342
  7343     MOVE ER-0029                TO EMI-ERROR
  7344     MOVE -1                     TO BPFENTRL
  7345     MOVE AL-UNBON               TO BPFENTRA
  7346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7347     GO TO 8200-SEND-DATAONLY.
  7348
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 141
* EL6311.cbl
  7350
  7351******************************************************************
  7352*                                                                *
  7353*      CANCEL SCREEN PF KEY CHECKING                             *
  7354*                                                                *
  7355******************************************************************
  7356
  7357******************************************************************
  7358*                                                                *
  7359*      PF KEY FUNCTIONS:                                         *
  7360*                                                                *
  7361*      PF1  = BROWSE FORWARD                                     *
  7362*      PF2  = BROWSE BACKWARD                                    *
  7363*      PF3  = CERTIFICATE LOOKUP                                 *
  7364*      PF4  = DISPLAY BATCH HEADER                               *
  7365*      PF5  = ADD ISSUE SCREEN                                   *
  7366*      PF6  = ADD CANCEL SCREEN                                  *
  7367*      PF7  = CERTIFICATE DISPLAY                                *
  7368*      PF8  = CERTIFICATE NOTES                                  *
  7369*      PF9  = EDIT CONTROL                                       *
  7370*      PF10 = DISPLAY LETTER SCREEN                              *
  7371*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  7372*      PF12 = DISPLAY HELP SCREEN                                *
  7373*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  7374*      PF14 = ACCOUNT MASTER                                     *
  7375*      PF16 = LETTER REVIEW                                      *
  7376*                                                                *
  7377******************************************************************
  7378
  7379 0400-CHECK-CANCEL-PF-KEYS.
  7380     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  7381        MOVE ER-2337             TO EMI-ERROR
  7382        MOVE -1                  TO CMAINTL
  7383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7384        GO TO 8200-SEND-DATAONLY.
  7385
  7386     IF EIBAID = DFHPF1
  7387        MOVE '0'                TO PI-EDIT-SW
  7388        IF PI-PRIMARY-BROWSE
  7389           GO TO 4100-BROWSE-PRIMARY-FORWARD
  7390        ELSE
  7391           IF PI-PRIMARY-WITH-SELECT
  7392              GO TO 4100-BROWSE-PRIMARY-FORWARD
  7393           ELSE
  7394              IF PI-FILE-BROWSE
  7395                 GO TO 4300-BROWSE-FILE-FORWARD
  7396              ELSE
  7397                 IF PI-CSR-BROWSE
  7398                    GO TO 4200-BROWSE-CSR-FORWARD
  7399                 ELSE
  7400                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  7401
  7402     IF EIBAID = DFHPF2
  7403        MOVE '0'                TO PI-EDIT-SW
  7404        IF PI-PRIMARY-BROWSE
  7405           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  7406        ELSE
  7407           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 142
* EL6311.cbl
  7408              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  7409           ELSE
  7410              IF PI-FILE-BROWSE
  7411                 GO TO 4800-BROWSE-FILE-BACKWARD
  7412              ELSE
  7413                 IF PI-CSR-BROWSE
  7414                    GO TO 4900-BROWSE-CSR-BACKWARD
  7415                 ELSE
  7416                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  7417
  7418     IF EIBAID = DFHPF3
  7419        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7420        MOVE XCTL-EL127         TO PGM-NAME
  7421        GO TO 9300-XCTL.
  7422
  7423     IF EIBAID = DFHPF15
  7424        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  7425        MOVE PI-SV-CARRIER       TO PI-CARRIER
  7426        MOVE PI-SV-GROUPING      TO PI-GROUPING
  7427        MOVE PI-SV-STATE         TO PI-STATE
  7428        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  7429        MOVE CCERTNOI            TO PI-CERT-PRIME
  7430        MOVE CSUFIXI             TO PI-CERT-SFX
  7431        MOVE CEFFDTI             TO DEEDIT-FIELD
  7432        PERFORM 8600-DEEDIT
  7433        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7434        MOVE '4'                 TO DC-OPTION-CODE
  7435        PERFORM 9700-DATE-LINK
  7436        IF DATE-CONVERSION-ERROR
  7437           MOVE ER-0348          TO EMI-ERROR
  7438           MOVE -1               TO BEFFDTL
  7439           MOVE AL-UABON         TO BEFFDTA
  7440           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7441           GO TO 8200-SEND-DATAONLY
  7442        ELSE
  7443           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  7444           PERFORM 6000-CREATE-TEMP-STORAGE
  7445                                 THRU 6000-EXIT
  7446           MOVE XCTL-EL6314      TO PGM-NAME
  7447           MOVE '2'              TO PI-PROGRAM-WORK-AREA
  7448           GO TO 9300-XCTL
  7449        END-IF
  7450     END-IF
  7451
  7452     IF EIBAID = DFHPF4
  7453        MOVE '0'                TO PI-EDIT-SW
  7454        IF PI-DISPLAY-ORIGINAL-BATCH
  7455           NEXT SENTENCE
  7456        ELSE
  7457           GO TO 7200-DISPLAY-BATCHES.
  7458
  7459     IF EIBAID = DFHPF5
  7460        MOVE '0'                TO PI-EDIT-SW
  7461        IF PI-DISPLAY-ORIGINAL-BATCH
  7462           NEXT SENTENCE
  7463        ELSE
  7464           MOVE EL631B              TO PI-MAP-NAME
  7465           MOVE LOW-VALUES          TO EL631BI
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 143
* EL6311.cbl
  7466           MOVE 'A'                 TO BMAINTO
  7467           MOVE AL-UANON            TO BMAINTA
  7468           MOVE -1                  TO BMAINTL
  7469           MOVE '5'                 TO PI-MAINT-FUNCTION
  7470           GO TO 8100-SEND-INITIAL-MAP.
  7471
  7472     IF EIBAID = DFHPF6
  7473        MOVE '0'                TO PI-EDIT-SW
  7474        IF PI-DISPLAY-ORIGINAL-BATCH
  7475           NEXT SENTENCE
  7476        ELSE
  7477           MOVE EL631C              TO PI-MAP-NAME
  7478           MOVE LOW-VALUES          TO EL631CI
  7479           MOVE 'A'                 TO CMAINTO
  7480           MOVE AL-UANON            TO CMAINTA
  7481           MOVE -1                  TO CMAINTL
  7482           MOVE '6'                 TO PI-MAINT-FUNCTION
  7483           GO TO 8100-SEND-INITIAL-MAP.
  7484
  7485     IF EIBAID = DFHPF7
  7486        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  7487        MOVE PI-SV-CARRIER          TO PI-CARRIER
  7488        MOVE PI-SV-GROUPING         TO PI-GROUPING
  7489        MOVE PI-SV-STATE            TO PI-STATE
  7490        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  7491        MOVE CCERTNOI               TO PI-CERT-PRIME
  7492        MOVE CSUFIXI                TO PI-CERT-SFX
  7493        MOVE CEFFDTI                TO DEEDIT-FIELD
  7494        PERFORM 8600-DEEDIT
  7495        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7496        MOVE '4'                    TO DC-OPTION-CODE
  7497        PERFORM 9700-DATE-LINK
  7498        IF DATE-CONVERSION-ERROR
  7499           MOVE ER-0348            TO EMI-ERROR
  7500           MOVE -1                  TO BEFFDTL
  7501           MOVE AL-UABON            TO BEFFDTA
  7502           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7503           GO TO 8200-SEND-DATAONLY
  7504        ELSE
  7505           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  7506           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7507           MOVE XCTL-EL1273        TO PGM-NAME
  7508           GO TO 9300-XCTL.
  7509
  7510     IF EIBAID = DFHPF8
  7511        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  7512        MOVE PI-SV-CARRIER          TO PI-CARRIER
  7513        MOVE PI-SV-GROUPING         TO PI-GROUPING
  7514        MOVE PI-SV-STATE            TO PI-STATE
  7515        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  7516        MOVE CCERTNOI               TO PI-CERT-PRIME
  7517        MOVE CSUFIXI                TO PI-CERT-SFX
  7518        MOVE CEFFDTI                TO DEEDIT-FIELD
  7519        PERFORM 8600-DEEDIT
  7520        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7521        MOVE '4'                    TO DC-OPTION-CODE
  7522        PERFORM 9700-DATE-LINK
  7523        IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 144
* EL6311.cbl
  7524           MOVE ER-0348             TO EMI-ERROR
  7525           MOVE -1                  TO BEFFDTL
  7526           MOVE AL-UABON            TO BEFFDTA
  7527           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7528           GO TO 8200-SEND-DATAONLY
  7529        ELSE
  7530           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  7531           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7532           IF PI-COMPANY-ID = 'DMD'
  7533               MOVE XCTL-EL401DMD      TO PGM-NAME
  7534             ELSE
  7535               MOVE XCTL-EL1279        TO PGM-NAME
  7536           END-IF
  7537           GO TO 9300-XCTL.
  7538
  7539     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  7540        MOVE XCTL-EL6312     TO PGM-NAME
  7541
  7542* EXEC CICS XCTL
  7543*           PROGRAM  (PGM-NAME)
  7544*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  7545*           LENGTH   (WS-COMM-LENGTH)
  7546*       END-EXEC
  7547*    MOVE '.$C                   $   #00007478' TO DFHEIV0
  7548     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7549     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7550     MOVE X'2020233030303037343738' TO DFHEIV0(25:11)
  7551     CALL 'kxdfhei1' USING DFHEIV0,
  7552           PGM-NAME,
  7553           PROGRAM-INTERFACE-BLOCK,
  7554           WS-COMM-LENGTH
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7556     ELSE
  7557        MOVE '0'                 TO  PI-EDIT-SW.
  7558
  7559     IF EIBAID = DFHPF10
  7560         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7561         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  7562         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  7563         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  7564                                    PI-1042-WA
  7565         MOVE 4                  TO PI-689-DATA-SOURCE
  7566         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  7567         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  7568         MOVE PI-SV-STATE        TO PI-689-STATE
  7569         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  7570         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  7571         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  7572         MOVE PI-PB-ALT-CHG-SEQ-NO
  7573                                 TO PI-689-ALT-SEQ-NO
  7574         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  7575         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  7576         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  7577         MOVE +0                 TO PI-689-CONTROL
  7578         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  7579                                    PI-689-EXP-DATE
  7580                                    PI-689-RESP-PERSON
  7581                                    PI-689-TYPE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 145
* EL6311.cbl
  7582                                    PI-689-FOLLOW-UP-EDIT
  7583                                    PI-689-RESEND1-EDIT
  7584                                    PI-689-SEQ-EDIT
  7585                                    PI-689-BCSEQ-EDIT
  7586                                    PI-689-LBL-OVERRIDE
  7587         MOVE W-LETTER-COMMUNICATION-AREAS
  7588                                 TO PI-PROGRAM-WORK-AREA
  7589         MOVE XCTL-EL689         TO PGM-NAME
  7590         GO TO 9300-XCTL.
  7591
  7592     IF  EIBAID = DFHPF16
  7593         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7594         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  7595         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  7596                                    PI-1042-WA
  7597         MOVE 4                  TO PI-689-DATA-SOURCE
  7598         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  7599         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  7600         MOVE PI-SV-STATE        TO PI-689-STATE
  7601         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  7602         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  7603         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  7604         MOVE PI-PB-ALT-CHG-SEQ-NO
  7605                                 TO PI-689-ALT-SEQ-NO
  7606         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  7607         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  7608         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  7609         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  7610         MOVE W-LETTER-COMMUNICATION-AREAS
  7611                                 TO PI-PROGRAM-WORK-AREA
  7612         MOVE XCTL-EL690         TO PGM-NAME
  7613         GO TO 9300-XCTL.
  7614
  7615     IF EIBAID = DFHPF13
  7616        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  7617        MOVE PI-SV-CARRIER          TO PI-CARRIER
  7618        MOVE PI-SV-GROUPING         TO PI-GROUPING
  7619        MOVE PI-SV-STATE            TO PI-STATE
  7620        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  7621        MOVE CCERTNOI               TO PI-CERT-PRIME
  7622        MOVE CSUFIXI                TO PI-CERT-SFX
  7623        MOVE CEFFDTI                TO DEEDIT-FIELD
  7624        PERFORM 8600-DEEDIT
  7625        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7626        MOVE '4'                    TO DC-OPTION-CODE
  7627        PERFORM 9700-DATE-LINK
  7628        IF DATE-CONVERSION-ERROR
  7629           MOVE ER-0348            TO EMI-ERROR
  7630           MOVE -1                  TO CEFFDTL
  7631           MOVE AL-UABON            TO CEFFDTA
  7632           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7633           GO TO 8200-SEND-DATAONLY
  7634        ELSE
  7635           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  7636           MOVE AL-UANON            TO CEFFDTA
  7637           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  7638           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7639           MOVE XCTL-EL677         TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 146
* EL6311.cbl
  7640           GO TO 9300-XCTL.
  7641
  7642     IF EIBAID = DFHPF14
  7643        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  7644        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  7645        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  7646        MOVE PI-SV-STATE            TO PI-CR-STATE
  7647        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  7648        MOVE SPACE                  TO PI-EDIT-SW
  7649        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7650        MOVE XCTL-EL650             TO PGM-NAME
  7651        GO TO 9300-XCTL.
  7652
  7653     IF EIBAID = DFHENTER OR DFHPF11
  7654        GO TO 2000-CANCEL-MAINLINE.
  7655
  7656     MOVE ER-0029                TO EMI-ERROR.
  7657     MOVE -1                     TO CPFENTRL.
  7658     MOVE AL-UNBON               TO CPFENTRA.
  7659     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7660     GO TO 8200-SEND-DATAONLY.
  7661
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 147
* EL6311.cbl
  7663
  7664******************************************************************
  7665*                                                                *
  7666*      BATCH SCREEN PF KEY CHECKING                              *
  7667*                                                                *
  7668******************************************************************
  7669
  7670******************************************************************
  7671*                                                                *
  7672*      PF KEY FUNCTIONS:                                         *
  7673*                                                                *
  7674*      PF1 = BROWSE FORWARD                                      *
  7675*      PF2 = BROWSE BACKWARD                                     *
  7676*      PF3 = DISPLAY PREMIUM TOTALS                              *
  7677*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  7678*                                                                *
  7679*                                                                *
  7680******************************************************************
  7681
  7682 0500-CHECK-BATCH-PF-KEYS.
  7683     IF EIBAID = DFHPF1
  7684        MOVE '0'                TO PI-EDIT-SW
  7685        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  7686           GO TO 5000-BROWSE-BATCH-HEADERS
  7687        ELSE
  7688           IF PI-GOOD-BROWSE
  7689              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7690                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  7691              ELSE
  7692                 IF PI-FILE-BROWSE
  7693                    GO TO 4300-BROWSE-FILE-FORWARD
  7694                 ELSE
  7695                    IF PI-CSR-BROWSE
  7696                       GO TO 4200-BROWSE-CSR-FORWARD
  7697                    ELSE
  7698                       GO TO 4000-BROWSE-DETAIL-FORWARD
  7699           ELSE
  7700              GO TO 0800-BROWSE-ERROR.
  7701
  7702     IF EIBAID = DFHPF2
  7703        MOVE '0'                TO PI-EDIT-SW
  7704        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  7705           GO TO 5500-BROWSE-BATCH-BACKWARD
  7706        ELSE
  7707           IF PI-GOOD-BROWSE
  7708              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7709                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  7710              ELSE
  7711                 IF PI-FILE-BROWSE
  7712                    GO TO 4800-BROWSE-FILE-BACKWARD
  7713                 ELSE
  7714                    IF PI-CSR-BROWSE
  7715                       GO TO 4900-BROWSE-CSR-BACKWARD
  7716                    ELSE
  7717                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  7718           ELSE
  7719              GO TO 0800-BROWSE-ERROR.
  7720
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 148
* EL6311.cbl
  7721     IF EIBAID = DFHPF3
  7722        GO TO 3000-BATCH-MAINLINE.
  7723
  7724     IF  EIBAID = DFHPF4
  7725        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  7726        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  7727        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  7728        MOVE PI-SV-STATE            TO PI-CR-STATE
  7729        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  7730                                       PI-CR-FIN-RESP
  7731        MOVE 'A'                    TO PI-CR-TYPE
  7732        MOVE SPACE                  TO PI-EDIT-SW
  7733        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  7734        MOVE XCTL-EL640             TO PGM-NAME
  7735        GO TO 9300-XCTL.
  7736
  7737     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  7738       AND
  7739        (EIBAID = DFHENTER)
  7740           GO TO 3500-EDIT-BATCH-DATA.
  7741
  7742     IF EIBAID = DFHENTER
  7743        GO TO 3500-EDIT-BATCH-DATA.
  7744
  7745     MOVE ER-0029             TO EMI-ERROR.
  7746     MOVE -1                  TO DPFENTRL.
  7747     MOVE AL-UNBON            TO DPFENTRA.
  7748     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7749     GO TO 8200-SEND-DATAONLY.
  7750
  7751 0800-BROWSE-ERROR.
  7752     MOVE ER-2258                TO EMI-ERROR.
  7753     MOVE -1                     TO DPFENTRL.
  7754     MOVE AL-UNBON               TO DPFENTRA.
  7755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7756     GO TO 8200-SEND-DATAONLY.
  7757
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 149
* EL6311.cbl
  7759
  7760******************************************************************
  7761*                                                                *
  7762*                I S S U E   M A I N L I N E                     *
  7763*                                                                *
  7764******************************************************************
  7765
  7766 1000-ISSUE-MAINLINE.
  7767     IF PI-DISPLAY-ORIGINAL-BATCH
  7768        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  7769           MOVE ER-0023             TO EMI-ERROR
  7770           MOVE -1                  TO BMAINTL
  7771           MOVE AL-UABON            TO BMAINTA
  7772           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7773           GO TO 8200-SEND-DATAONLY
  7774        ELSE
  7775           NEXT SENTENCE
  7776     ELSE
  7777        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  7778           MOVE ER-0023             TO EMI-ERROR
  7779           MOVE -1                  TO BMAINTL
  7780           MOVE AL-UABON            TO BMAINTA
  7781           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7782           GO TO 8200-SEND-DATAONLY.
  7783
  7784     IF BMAINTI = 'S'
  7785        GO TO 1100-SHOW-REQUEST.
  7786
  7787     IF NOT MODIFY-CAP
  7788         MOVE 'UPDATE'       TO SM-READ
  7789         PERFORM 9995-SECURITY-VIOLATION
  7790         MOVE ER-0070        TO EMI-ERROR
  7791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7792         GO TO 8100-SEND-INITIAL-MAP.
  7793
  7794     IF BMAINTL GREATER THAN ZEROS
  7795        IF PI-PF5-FUNCTION
  7796           IF BMAINTI NOT = 'A'
  7797              MOVE AL-UABON  TO BMAINTA
  7798              MOVE -1        TO BMAINTL
  7799              MOVE ER-2260   TO EMI-ERROR
  7800              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7801              GO TO 8200-SEND-DATAONLY.
  7802
  7803     IF BCERTNOL = ZEROS
  7804       AND (BMAINTI = 'C' OR 'K' OR 'D')
  7805         NEXT SENTENCE
  7806     ELSE
  7807         IF BCERTNOL NOT = ZEROS
  7808             MOVE AL-UANON       TO BCERTNOA
  7809         ELSE
  7810             MOVE -1             TO BCERTNOL
  7811             MOVE  1             TO SET-CURSOR-SW
  7812             MOVE ER-2218        TO EMI-ERROR
  7813             MOVE AL-UABON       TO BCERTNOA
  7814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7815
  7816     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 150
* EL6311.cbl
  7817         MOVE AL-UANON       TO BSUFIXA
  7818     ELSE
  7819         MOVE AL-SANOF       TO BSUFIXA.
  7820
  7821     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  7822        NEXT SENTENCE
  7823     ELSE
  7824        IF BEFFDTL NOT = ZEROS
  7825           MOVE AL-UNNON             TO BEFFDTA
  7826           MOVE BEFFDTI              TO DEEDIT-FIELD
  7827           PERFORM 8600-DEEDIT
  7828           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  7829           MOVE 4                    TO DC-OPTION-CODE
  7830           PERFORM 9700-DATE-LINK
  7831           IF NO-CONVERSION-ERROR
  7832              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  7833              ELSE
  7834              MOVE -1                TO BEFFDTL
  7835              MOVE  1                TO SET-CURSOR-SW
  7836              MOVE ER-2226           TO EMI-ERROR
  7837              MOVE AL-UNBON          TO BEFFDTA
  7838              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7839           ELSE
  7840              MOVE -1                TO BEFFDTL
  7841              MOVE  1                TO SET-CURSOR-SW
  7842              MOVE ER-2220           TO EMI-ERROR
  7843              MOVE AL-UNBON          TO BEFFDTA
  7844              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7845
  7846     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  7847
  7848     IF BCERTNOL NOT = ZEROS
  7849        MOVE BCERTNOI                TO WS-NEW-PRIME
  7850     ELSE
  7851        MOVE SPACES                  TO WS-NEW-PRIME.
  7852
  7853     IF BSUFIXL NOT = ZEROS
  7854        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  7855     ELSE
  7856        MOVE SPACE                   TO WS-NEW-SUFFIX.
  7857
  7858     IF BEFFDTL NOT = ZEROS
  7859        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  7860     ELSE
  7861        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  7862
  7863     IF BMAINTI = 'A' OR 'K' OR 'S'
  7864        NEXT SENTENCE
  7865     ELSE
  7866        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  7867        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  7868           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  7869           WS-PB-RECORD-TYPE NOT = '1'
  7870           IF BMAINTI = 'C'
  7871               MOVE ER-2287          TO EMI-ERROR
  7872               MOVE -1               TO BCERTNOL
  7873               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  7874               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 151
* EL6311.cbl
  7875               GO TO 8200-SEND-DATAONLY
  7876             ELSE
  7877               MOVE ER-2260          TO EMI-ERROR
  7878               MOVE -1               TO BCERTNOL
  7879               MOVE AL-UABON         TO BCERTNOA
  7880               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7881               GO TO 8200-SEND-DATAONLY.
  7882
  7883     IF BMAINTI = 'D'
  7884         GO TO 1400-DELETE-ISSUE-ROUTINE.
  7885
  7886     IF BMICRNOL  NOT =  ZEROS
  7887         IF BMICRNOI  NUMERIC
  7888             MOVE AL-UNNON       TO  BMICRNOA
  7889         ELSE
  7890             MOVE -1             TO  BMICRNOL
  7891             MOVE 1              TO  SET-CURSOR-SW
  7892             MOVE AL-UNBON       TO  BMICRNOA
  7893             MOVE ER-2701        TO  EMI-ERROR
  7894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7895     IF BVINL NOT = ZEROS
  7896        MOVE AL-UANON            TO BVINA
  7897     END-IF
  7898     IF B1STNML NOT = ZEROS
  7899         MOVE AL-UANON                TO B1STNMA.
  7900
  7901     IF BINITL  NOT = ZEROS
  7902        MOVE AL-UANON                TO BINITA.
  7903
  7904     IF BSEXL NOT = ZEROS
  7905        IF BSEXI = 'M' OR 'F'
  7906           MOVE AL-UANON             TO BSEXA
  7907        ELSE
  7908           MOVE -1               TO BSEXL
  7909           MOVE ER-2629          TO EMI-ERROR
  7910           MOVE AL-UABON         TO BSEXA
  7911           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7912
  7913     IF BAGEL NOT = ZEROS
  7914         IF BAGEI NUMERIC
  7915             MOVE BAGEI              TO WS-BAGE
  7916             MOVE AL-UNNON           TO BAGEA
  7917         ELSE
  7918             MOVE -1                 TO BAGEL
  7919             MOVE  1                 TO SET-CURSOR-SW
  7920             MOVE ER-2223            TO EMI-ERROR
  7921             MOVE AL-UNBON           TO BAGEA
  7922             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7923
  7924     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  7925
  7926     IF (BBIRTHL GREATER THAN +0) AND
  7927        (BBIRTHI NOT EQUAL SPACES)
  7928        NEXT SENTENCE
  7929     ELSE
  7930        GO TO 1010-CHECK-AGE.
  7931
  7932     MOVE BBIRTHI                TO DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 152
* EL6311.cbl
  7933     PERFORM 8600-DEEDIT.
  7934     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  7935     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  7936     MOVE AL-UNNON               TO BBIRTHA.
  7937     MOVE '4'                    TO DC-OPTION-CODE.
  7938     PERFORM 9700-DATE-LINK.
  7939     IF DATE-CONVERSION-ERROR
  7940        MOVE -1                  TO BBIRTHL
  7941        MOVE  1                  TO SET-CURSOR-SW
  7942        MOVE ER-2228             TO EMI-ERROR
  7943        MOVE AL-UNBON            TO BBIRTHA
  7944        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7945        GO TO 1010-CHECK-AGE.
  7946
  7947     IF (NO-CONVERSION-ERROR) AND
  7948        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  7949        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  7950        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  7951        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  7952                                    WS-CONVERTED-BIRTH
  7953        MOVE AL-UANON            TO BBIRTHA
  7954     ELSE
  7955        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  7956        MOVE AL-UANON            TO BBIRTHA.
  7957
  7958 1010-CHECK-AGE.
  7959
  7960*    IF BAGEL = ZERO
  7961*       IF BBIRTHL GREATER THAN ZERO
  7962*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  7963
  7964     IF B1STPMTL NOT = ZEROS
  7965        IF B1STPMTI = SPACES
  7966           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  7967        ELSE
  7968           MOVE B1STPMTI             TO DEEDIT-FIELD
  7969           PERFORM 8600-DEEDIT
  7970           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  7971           MOVE AL-UNNON             TO B1STPMTA
  7972           MOVE 4                    TO DC-OPTION-CODE
  7973           PERFORM 9700-DATE-LINK
  7974           IF NO-CONVERSION-ERROR
  7975              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  7976              MOVE AL-UANON          TO B1STPMTA
  7977           ELSE
  7978              MOVE -1                TO B1STPMTL
  7979              MOVE  1                TO SET-CURSOR-SW
  7980              MOVE ER-2200           TO EMI-ERROR
  7981              MOVE AL-UNBON          TO B1STPMTA
  7982              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7983
  7984     IF BDAYSL NOT = ZEROS
  7985         IF BDAYSI NUMERIC
  7986             MOVE AL-UNNON           TO BDAYSA
  7987         ELSE
  7988             MOVE -1                 TO BDAYSL
  7989             MOVE ER-2530            TO EMI-ERROR
  7990             MOVE AL-UNBON           TO BDAYSA
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 153
* EL6311.cbl
  7991             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7992
  7993     IF BLNTRML NOT = ZEROS
  7994         IF BLNTRMI NUMERIC
  7995             MOVE AL-UNNON       TO BLNTRMA
  7996         ELSE
  7997             MOVE -1             TO BLNTRML
  7998             MOVE ER-2533        TO EMI-ERROR
  7999             MOVE AL-UNBON       TO BLNTRMA
  8000             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8001
  8002**   IF PI-COMPANY-ID = 'DMD'
  8003     IF PI-COMPANY-ID = 'DMD' OR 'CID'
  8004        NEXT SENTENCE
  8005     ELSE
  8006         IF BLNOFCRL NOT = ZEROS
  8007            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  8008            IF LOAN-OFFICER-FOUND
  8009                MOVE AL-UANON        TO BLNOFCRA
  8010             ELSE
  8011                 MOVE SPACE          TO WS-LOAN-OFFICER
  8012                 MOVE -1             TO BLNOFCRL
  8013                 MOVE  1             TO SET-CURSOR-SW
  8014                 MOVE ER-3006        TO EMI-ERROR
  8015                 MOVE AL-UNBON       TO BLNOFCRA
  8016                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8017
  8018     IF BFREQL NOT = ZEROS
  8019         IF BFREQI NUMERIC
  8020             MOVE AL-UNNON       TO BFREQA
  8021         ELSE
  8022             MOVE -1             TO BFREQL
  8023             MOVE  1             TO SET-CURSOR-SW
  8024             MOVE ER-2223        TO EMI-ERROR
  8025             MOVE AL-UNBON       TO BFREQA
  8026             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8027
  8028     IF BMODEL NOT = ZEROS
  8029         MOVE BMODEI             TO WS-MODE-CODE
  8030                                    PI-BMODE
  8031         IF WS-MODE-CODE-VALID
  8032             MOVE AL-UANON       TO BMODEA
  8033         ELSE
  8034             MOVE -1             TO BMODEL
  8035             MOVE ER-2591        TO EMI-ERROR
  8036             MOVE AL-UABON       TO BMODEA
  8037             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8038
  8039     IF BPMTSL NOT = ZEROS
  8040         IF BPMTSI NUMERIC
  8041             MOVE AL-UNNON           TO BPMTSA
  8042             MOVE BPMTSI             TO PI-BPMTS
  8043         ELSE
  8044             MOVE -1                 TO BPMTSL
  8045             MOVE ER-2592            TO EMI-ERROR
  8046             MOVE AL-UNBON           TO BPMTSA
  8047             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8048
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 154
* EL6311.cbl
  8049     IF BPMTAMTL NOT = ZEROS
  8050
  8051* EXEC CICS BIF DEEDIT
  8052*            FIELD  (BPMTAMTI)
  8053*            LENGTH (9)
  8054*       END-EXEC
  8055     MOVE 9
  8056       TO DFHEIV11
  8057*    MOVE '@"L                   #   #00007977' TO DFHEIV0
  8058     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8059     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8060     MOVE X'2020233030303037393737' TO DFHEIV0(25:11)
  8061     CALL 'kxdfhei1' USING DFHEIV0,
  8062           BPMTAMTI,
  8063           DFHEIV11
  8064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8065        MOVE BPMTAMTI           TO PI-BPMTAMT.
  8066*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  8067*        PERFORM 8600-DEEDIT
  8068*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  8069
  8070*    IF BAPRL NOT = ZEROS
  8071*        EXEC CICS BIF DEEDIT
  8072*            FIELD  (BAPRI)
  8073*            LENGTH (7)
  8074*        END-EXEC
  8075*        MOVE BAPRI              TO WS-BAPR.
  8076
  8077     IF BAPRL > 0
  8078        MOVE +0                  TO  WS-BAPR
  8079        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  8080           (WS-SUB > 7)
  8081           OR (BAPRI (WS-SUB:1) NUMERIC)
  8082           OR (BAPRI (WS-SUB:1) = '.')
  8083        END-PERFORM
  8084        IF WS-SUB > 7
  8085           MOVE ER-2471       TO EMI-ERROR
  8086           MOVE -1            TO BAPRL
  8087           MOVE AL-UNBON      TO BAPRA
  8088           PERFORM 9900-ERROR-FORMAT
  8089                                 THRU 9900-EXIT
  8090        ELSE
  8091           IF BAPRI (WS-SUB:1) NUMERIC
  8092              MOVE WS-SUB           TO WS-BEG
  8093              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  8094                 (WS-SUB > 7)
  8095                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  8096              END-PERFORM
  8097              COMPUTE WS-END = WS-SUB - WS-BEG
  8098              MOVE BAPRI (WS-BEG:WS-END)
  8099                                 TO WS-APR-WHOLE-NUM
  8100           END-IF
  8101           IF BAPRI (WS-SUB:1) = '.'
  8102              COMPUTE WS-BEG = WS-SUB + 1
  8103              IF (WS-BEG < 8)
  8104                 AND (BAPRI (WS-BEG:1) NUMERIC)
  8105                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  8106                    (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 155
* EL6311.cbl
  8107                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  8108                 END-PERFORM
  8109                 COMPUTE WS-END = WS-SUB - WS-BEG
  8110                 MOVE BAPRI (WS-BEG:WS-END)
  8111                                 TO WS-APR-DEC (1:WS-END)
  8112              END-IF
  8113           END-IF
  8114           MOVE AL-UNNON      TO BAPRA
  8115           MOVE WS-BAPR       TO BAPRO
  8116        END-IF
  8117     END-IF
  8118*     IF BAPRL NOT = ZEROS
  8119*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  8120*        PERFORM 8600-DEEDIT
  8121*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  8122
  8123     IF BLIVESL NOT = ZEROS
  8124        MOVE BLIVESI             TO DEEDIT-FIELD
  8125        PERFORM 8600-DEEDIT
  8126        IF DEEDIT-FIELD-V0 NUMERIC
  8127           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  8128           MOVE AL-UNNON         TO BLIVESA
  8129        ELSE
  8130           MOVE -1               TO BLIVESL
  8131           MOVE AL-UNBON         TO BLIVESA
  8132           MOVE ER-2223          TO EMI-ERROR
  8133           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8134
  8135*DMD CUSTOM CODING*************START
  8136*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  8137     IF PI-COMPANY-ID NOT = 'DMD'
  8138         MOVE ZEROS               TO BBILLEDL
  8139         GO TO 1010-EDIT-CONT.
  8140
  8141     IF BBILLEDL NOT = ZEROS
  8142        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  8143        MOVE 'Y'                 TO WS-NUMERIC-SW
  8144        MOVE +1                  TO WS-CSO-SUB
  8145        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  8146        IF CSO-NUMERIC-FIELD
  8147
  8148* EXEC CICS BIF DEEDIT
  8149*              FIELD  (BBILLEDI)
  8150*              LENGTH (9)
  8151*          END-EXEC
  8152     MOVE 9
  8153       TO DFHEIV11
  8154*    MOVE '@"L                   #   #00008063' TO DFHEIV0
  8155     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8156     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8157     MOVE X'2020233030303038303633' TO DFHEIV0(25:11)
  8158     CALL 'kxdfhei1' USING DFHEIV0,
  8159           BBILLEDI,
  8160           DFHEIV11
  8161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8162           MOVE BBILLEDI         TO WS-BILLED
  8163           MOVE AL-UNNON         TO BBILLEDA
  8164        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 156
* EL6311.cbl
  8165           MOVE -1               TO BBILLEDL
  8166           MOVE AL-UNBON         TO BBILLEDA
  8167           MOVE ER-2547          TO EMI-ERROR
  8168           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8169     ELSE
  8170        IF BMAINTI EQUAL 'A'
  8171           MOVE -1               TO BBILLEDL
  8172           MOVE AL-UNBON         TO BBILLEDA
  8173           MOVE ER-8148          TO EMI-ERROR
  8174           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8175
  8176 1010-EDIT-CONT.
  8177
  8178     IF BFORCEL  NOT = ZEROS
  8179         IF FORCE-CAP
  8180            MOVE AL-UANON            TO BFORCEA
  8181         ELSE
  8182            MOVE ER-2945             TO EMI-ERROR
  8183            MOVE AL-UABON            TO BFORCEA
  8184            MOVE -1                  TO BFORCEL
  8185            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8186
  8187     IF BENTRYL NOT = ZEROS
  8188        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  8189                         'D' AND 'V' AND 'U' AND 'M'
  8190           MOVE ER-2224              TO EMI-ERROR
  8191           MOVE AL-UABON             TO BENTRYA
  8192           MOVE -1                   TO BENTRYL
  8193           MOVE  1                   TO SET-CURSOR-SW
  8194           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8195        ELSE
  8196           MOVE AL-UANON             TO BENTRYA.
  8197
  8198     IF BUNWRITL NOT = ZEROS
  8199        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  8200           MOVE ER-7574              TO EMI-ERROR
  8201           MOVE AL-UABON             TO BUNWRITA
  8202           MOVE -1                   TO BUNWRITL
  8203           MOVE  1                   TO SET-CURSOR-SW
  8204           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8205        ELSE
  8206           MOVE AL-UANON             TO BUNWRITA.
  8207
  8208     IF BREINL  NOT = ZEROS
  8209         MOVE AL-UANON               TO BREINA.
  8210
  8211     IF BBILCDL NOT = ZEROS
  8212        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  8213                             AND 'A' AND 'B' AND 'E'
  8214           MOVE ER-2225              TO EMI-ERROR
  8215           MOVE AL-UABON             TO BBILCDA
  8216           MOVE -1                   TO BBILCDL
  8217           MOVE  1                   TO SET-CURSOR-SW
  8218           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8219        ELSE
  8220           MOVE AL-UANON             TO BBILCDA.
  8221
  8222     IF BSKPCDL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 157
* EL6311.cbl
  8223         MOVE AL-UANON               TO BSKPCDA.
  8224
  8225     IF BINDGRPL NOT = ZEROS
  8226         MOVE AL-UANON               TO BINDGRPA.
  8227
  8228     IF BSIGL   NOT = ZEROS
  8229         MOVE AL-UANON               TO BSIGA.
  8230
  8231     IF BRTCLSL NOT = ZEROS
  8232         MOVE AL-UANON               TO BRTCLSA.
  8233
  8234     IF BMEMBERL NOT = ZEROS
  8235         MOVE AL-UANON               TO BMEMBERA.
  8236
  8237     MOVE +0                         TO WS-SUB1.
  8238
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 158
* EL6311.cbl
  8240
  8241******************************************************************
  8242*                                                                *
  8243*           E D I T   I S S U E   C O V E R A G E S              *
  8244*                                                                *
  8245******************************************************************
  8246
  8247 1020-EDIT-COVERAGES.
  8248     ADD +1                      TO WS-SUB1.
  8249
  8250     IF WS-SUB1 GREATER +2
  8251        GO TO 1025-EDIT-COMPLETE.
  8252
  8253     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  8254       IF (BMODEL   GREATER ZERO  OR
  8255            BPMTSL   GREATER ZERO  OR
  8256            BPMTAMTL GREATER ZERO)
  8257          AND
  8258            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  8259               GO TO 1021-CONT-EDIT.
  8260
  8261     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  8262        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  8263        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  8264        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  8265        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  8266        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  8267        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  8268        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  8269        NEXT SENTENCE
  8270         ELSE
  8271            GO TO 1020-EDIT-COVERAGES.
  8272
  8273 1021-CONT-EDIT.
  8274
  8275     IF BMAINTI = 'A'
  8276        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  8277           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  8278        ELSE
  8279           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  8280           MOVE ER-7404          TO EMI-ERROR
  8281           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  8282           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8283     ELSE
  8284        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  8285           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  8286
  8287     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  8288        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  8289        PERFORM 8600-DEEDIT
  8290        IF DEEDIT-FIELD-V0 NUMERIC
  8291           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  8292        ELSE
  8293           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  8294
  8295     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  8296*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  8297        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 159
* EL6311.cbl
  8298           BPMTSL  GREATER THAN ZEROS
  8299           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  8300
  8301     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  8302         IF BMODEL   GREATER THAN ZEROS  OR
  8303            BPMTSL   GREATER THAN ZEROS  OR
  8304            BPMTAMTL GREATER THAN ZEROS
  8305             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  8306
  8307     IF BMAINTI = ('C' OR 'K')
  8308        IF BTERM-LEN (WS-SUB1)  = ZEROS
  8309           NEXT SENTENCE
  8310        ELSE
  8311           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  8312           PERFORM 8600-DEEDIT
  8313           IF DEEDIT-FIELD-V0 NUMERIC
  8314              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  8315              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  8316                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  8317              ELSE
  8318                    MOVE ER-2241      TO EMI-ERROR
  8319                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  8320                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  8321                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8322           ELSE
  8323              MOVE ER-2223          TO EMI-ERROR
  8324              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  8325              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  8326              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8327     ELSE
  8328        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  8329            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  8330            PERFORM 8600-DEEDIT
  8331            IF DEEDIT-FIELD-V0      NUMERIC
  8332               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  8333                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  8334                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  8335               ELSE
  8336                  MOVE ER-2241         TO EMI-ERROR
  8337                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  8338                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  8339                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8340            ELSE
  8341              MOVE ER-2223             TO EMI-ERROR
  8342              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  8343              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  8344              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8345        ELSE
  8346            MOVE ER-2240               TO EMI-ERROR
  8347            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  8348            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8349*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  8350*        IF BMODEL  GREATER THAN ZEROS  AND
  8351*           BPMTSL  GREATER THAN ZEROS
  8352*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  8353
  8354     IF BBEN-LEN (WS-SUB1) = ZEROS
  8355        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 160
* EL6311.cbl
  8356           NEXT SENTENCE
  8357     ELSE
  8358        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  8359           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  8360
  8361* EXEC CICS BIF DEEDIT
  8362*              FIELD  (BBENI (WS-SUB1))
  8363*              LENGTH (12)
  8364*          END-EXEC
  8365     MOVE 12
  8366       TO DFHEIV11
  8367*    MOVE '@"L                   #   #00008265' TO DFHEIV0
  8368     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8369     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8370     MOVE X'2020233030303038323635' TO DFHEIV0(25:11)
  8371     CALL 'kxdfhei1' USING DFHEIV0,
  8372           BBENI(WS-SUB1),
  8373           DFHEIV11
  8374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8375           IF BBENI (WS-SUB1)  NUMERIC
  8376              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  8377                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  8378*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  8379*          PERFORM 8600-DEEDIT
  8380*          IF DEEDIT-FIELD-V2  NUMERIC
  8381*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  8382*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  8383              ELSE
  8384                 MOVE ER-7632    TO EMI-ERROR
  8385                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  8386                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  8387                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8388           ELSE
  8389              MOVE ER-2223         TO EMI-ERROR
  8390              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  8391              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  8392              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8393        ELSE
  8394           MOVE ER-7632    TO EMI-ERROR
  8395           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  8396           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  8397           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8398
  8399     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  8400        AND (BMAINTI = ('C' OR 'K'))
  8401        CONTINUE
  8402     ELSE
  8403        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  8404           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  8405           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  8406              FOR ALL '.'
  8407           IF WS-TALLY > 1
  8408              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  8409                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  8410              END-PERFORM
  8411              IF A1 < 9
  8412                 ADD 3 TO A1
  8413                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 161
* EL6311.cbl
  8414              END-IF
  8415           ELSE
  8416              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  8417                (A1 > 11)
  8418                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  8419                  LOW-VALUES OR SPACES)
  8420              END-PERFORM
  8421              IF A1 > 1 AND < 12
  8422                 MOVE SPACES
  8423                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  8424              END-IF
  8425           END-IF
  8426
  8427* EXEC CICS BIF DEEDIT
  8428*              FIELD  (BPREMI (WS-SUB1))
  8429*              LENGTH (11)
  8430*          END-EXEC
  8431     MOVE 11
  8432       TO DFHEIV11
  8433*    MOVE '@"L                   #   #00008320' TO DFHEIV0
  8434     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8435     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8436     MOVE X'2020233030303038333230' TO DFHEIV0(25:11)
  8437     CALL 'kxdfhei1' USING DFHEIV0,
  8438           BPREMI(WS-SUB1),
  8439           DFHEIV11
  8440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8441           IF BPREMI (WS-SUB1) NUMERIC
  8442              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  8443                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  8444*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  8445*          PERFORM 8600-DEEDIT
  8446*          IF DEEDIT-FIELD-V2  NUMERIC
  8447*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  8448*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  8449              ELSE
  8450                 IF PI-COMPANY-ID NOT = 'DCC'
  8451                    MOVE ER-7633    TO EMI-ERROR
  8452                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  8453                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  8454                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8455                 END-IF
  8456              END-IF
  8457           ELSE
  8458              MOVE ER-2223         TO EMI-ERROR
  8459              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  8460              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  8461              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8462           END-IF
  8463        ELSE
  8464           IF PI-COMPANY-ID NOT = 'DCC'
  8465              MOVE ER-7633         TO EMI-ERROR
  8466              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  8467              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  8468              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8469           END-IF
  8470        END-IF
  8471     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 162
* EL6311.cbl
  8472
  8473     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  8474        NEXT SENTENCE
  8475     ELSE
  8476        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  8477
  8478* EXEC CICS BIF DEEDIT
  8479*           FIELD  (BCPREMI (WS-SUB1))
  8480*           LENGTH (11)
  8481*       END-EXEC
  8482     MOVE 11
  8483       TO DFHEIV11
  8484*    MOVE '@"L                   #   #00008360' TO DFHEIV0
  8485     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8486     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8487     MOVE X'2020233030303038333630' TO DFHEIV0(25:11)
  8488     CALL 'kxdfhei1' USING DFHEIV0,
  8489           BCPREMI(WS-SUB1),
  8490           DFHEIV11
  8491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8492        IF BCPREMI (WS-SUB1) NUMERIC
  8493           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  8494*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  8495*       PERFORM 8600-DEEDIT
  8496*       IF DEEDIT-FIELD-V2  NUMERIC
  8497*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  8498        ELSE
  8499           MOVE ER-2223         TO EMI-ERROR
  8500           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  8501           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  8502           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8503
  8504     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  8505        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  8506        PERFORM 8600-DEEDIT
  8507        IF DEEDIT-FIELD-V0 NUMERIC
  8508           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  8509           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  8510         ELSE
  8511           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  8512           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  8513           MOVE ER-2223              TO EMI-ERROR
  8514           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8515
  8516     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  8517        IF BEXPIRE   (WS-SUB1) = SPACES
  8518           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  8519        ELSE
  8520           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  8521           PERFORM 8600-DEEDIT
  8522           IF DEEDIT-FIELD-V0        NUMERIC
  8523              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  8524              MOVE 4                TO DC-OPTION-CODE
  8525              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8526              PERFORM 9700-DATE-LINK
  8527              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  8528                                                        (WS-SUB1)
  8529              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 163
* EL6311.cbl
  8530                 NEXT SENTENCE
  8531              ELSE
  8532                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  8533                 MOVE ER-2531    TO EMI-ERROR
  8534                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  8535                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8536           ELSE
  8537             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  8538             MOVE ER-2532        TO EMI-ERROR
  8539             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  8540             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8541
  8542     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  8543        NEXT SENTENCE
  8544     ELSE
  8545
  8546* EXEC CICS BIF DEEDIT
  8547*           FIELD  (BALT-BENI (WS-SUB1))
  8548*           LENGTH (12)
  8549*       END-EXEC
  8550     MOVE 12
  8551       TO DFHEIV11
  8552*    MOVE '@"L                   #   #00008417' TO DFHEIV0
  8553     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8555     MOVE X'2020233030303038343137' TO DFHEIV0(25:11)
  8556     CALL 'kxdfhei1' USING DFHEIV0,
  8557           BALT-BENI(WS-SUB1),
  8558           DFHEIV11
  8559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8560        IF BALT-BENI (WS-SUB1) NUMERIC
  8561           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  8562*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  8563*       PERFORM 8600-DEEDIT
  8564*       IF DEEDIT-FIELD-V0 NUMERIC
  8565*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  8566        ELSE
  8567           MOVE ER-2223         TO EMI-ERROR
  8568           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  8569           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  8570           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8571
  8572     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  8573        NEXT SENTENCE
  8574     ELSE
  8575
  8576* EXEC CICS BIF DEEDIT
  8577*           FIELD  (BALT-PREMI (WS-SUB1))
  8578*           LENGTH (11)
  8579*       END-EXEC
  8580     MOVE 11
  8581       TO DFHEIV11
  8582*    MOVE '@"L                   #   #00008436' TO DFHEIV0
  8583     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8584     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8585     MOVE X'2020233030303038343336' TO DFHEIV0(25:11)
  8586     CALL 'kxdfhei1' USING DFHEIV0,
  8587           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 164
* EL6311.cbl
  8588           DFHEIV11
  8589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8590        IF BALT-PREMI (WS-SUB1) NUMERIC
  8591           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  8592*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  8593*       PERFORM 8600-DEEDIT
  8594*       IF DEEDIT-FIELD-V0 NUMERIC
  8595*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  8596        ELSE
  8597           MOVE ER-2223         TO EMI-ERROR
  8598           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  8599           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  8600           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8601
  8602      GO TO 1020-EDIT-COVERAGES.
  8603
  8604 1025-EDIT-COMPLETE.
  8605     IF PI-COMPANY-ID  =  'DMD'
  8606        MOVE LOW-VALUES             TO BNCERTI
  8607                                       BNSTATI.
  8608
  8609     IF EMI-ERROR = ZEROS
  8610         NEXT SENTENCE
  8611     ELSE
  8612         GO TO 8200-SEND-DATAONLY.
  8613
  8614     IF BMAINTI = 'A'
  8615         GO TO 1200-ADD-ISSUE-ROUTINE.
  8616
  8617     IF BMAINTI = 'C'
  8618         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  8619
  8620     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  8621
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 165
* EL6311.cbl
  8623
  8624 1030-EDIT-FOR-NUMERICS.
  8625     IF WS-CSO-SUB EQUAL 10
  8626        GO TO 1030-EDIT-EXIT.
  8627
  8628     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  8629        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  8630        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  8631           ADD +1               TO WS-CSO-SUB
  8632           GO TO 1030-EDIT-FOR-NUMERICS.
  8633
  8634     MOVE 'N'                   TO WS-NUMERIC-SW.
  8635
  8636 1030-EDIT-EXIT.
  8637******************************************************************
  8638*                                                                *
  8639*                 C A L C U L A T E   A G E                      *
  8640*                                                                *
  8641******************************************************************
  8642
  8643
  8644 1095-CALC-AGE.
  8645
  8646     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  8647     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  8648     MOVE 1                  TO DC-OPTION-CODE.
  8649     PERFORM 9700-DATE-LINK
  8650     IF NO-CONVERSION-ERROR
  8651         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  8652         MOVE WS-BAGE            TO BAGEI
  8653         MOVE +2                 TO BAGEL
  8654         MOVE AL-UNNON TO BAGEA.
  8655
  8656 1099-EXIT.
  8657     EXIT.
  8658
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 166
* EL6311.cbl
  8660
  8661******************************************************************
  8662*                                                                *
  8663*                   S H O W   I S S U E                          *
  8664*                                                                *
  8665******************************************************************
  8666
  8667 1100-SHOW-REQUEST.
  8668     MOVE 'S'                    TO PI-MAINT-FUNCTION.
  8669
  8670     IF BCERTNOL = ZEROS AND
  8671        BEFFDTL  = ZEROS
  8672        MOVE -1                  TO BMAINTL
  8673        GO TO 8200-SEND-DATAONLY.
  8674
  8675     MOVE BCERTNOI               TO WS-NEW-PRIME.
  8676
  8677     IF BSUFIXL NOT = ZEROS
  8678        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  8679     ELSE
  8680        MOVE SPACE               TO WS-NEW-SUFFIX.
  8681
  8682     MOVE BEFFDTI                TO DEEDIT-FIELD.
  8683     PERFORM 8600-DEEDIT.
  8684     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  8685     MOVE '4'                    TO DC-OPTION-CODE.
  8686     PERFORM 9700-DATE-LINK.
  8687     IF DATE-CONVERSION-ERROR
  8688        MOVE ER-0348             TO EMI-ERROR
  8689        MOVE -1                  TO BEFFDTL
  8690        MOVE AL-UABON            TO BEFFDTA
  8691        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8692        GO TO 8200-SEND-DATAONLY
  8693     ELSE
  8694        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
  8695        MOVE AL-UANON            TO BEFFDTA
  8696        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
  8697
  8698     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8699
  8700     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
  8701        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
  8702          MOVE 'Y'                    TO WS-SHOW-SW
  8703          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8704             GO TO 4100-BROWSE-PRIMARY-FORWARD
  8705           ELSE
  8706             IF PI-FILE-BROWSE
  8707                GO TO 4300-BROWSE-FILE-FORWARD
  8708              ELSE
  8709                IF PI-CSR-BROWSE
  8710                   GO TO 4200-BROWSE-CSR-FORWARD
  8711                ELSE
  8712                   GO TO 4000-BROWSE-DETAIL-FORWARD
  8713        ELSE
  8714           GO TO 3900-RE-DISPLAY-RECORD.
  8715
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 167
* EL6311.cbl
  8717
  8718******************************************************************
  8719*                                                                *
  8720*            A D D   I S S U E   R O U T I N E                   *
  8721*                                                                *
  8722******************************************************************
  8723
  8724***************************************************************
  8725*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
  8726*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
  8727*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
  8728*     4. LINK TO THE EDIT ROUTINE.                            *
  8729*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
  8730*     6. WRITE THE NEW ISSUE RECORD.                          *
  8731*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
  8732*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
  8733*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
  8734*        ELSE                                                 *
  8735*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
  8736***************************************************************
  8737
  8738 1200-ADD-ISSUE-ROUTINE.
  8739     MOVE 'A'                    TO PI-MAINT-FUNCTION.
  8740
  8741
  8742* EXEC CICS GETMAIN
  8743*        SET     (ADDRESS OF PENDING-BUSINESS)
  8744*        LENGTH  (ERPNDB-RECORD-LENGTH)
  8745*    END-EXEC.
  8746*    MOVE '," L                  $   #00008591' TO DFHEIV0
  8747     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8748     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8749     MOVE X'2020233030303038353931' TO DFHEIV0(25:11)
  8750     CALL 'kxdfhei1' USING DFHEIV0,
  8751           DFHEIV20,
  8752           ERPNDB-RECORD-LENGTH,
  8753           DFHEIV99
  8754     SET ADDRESS OF PENDING-BUSINESS TO
  8755         DFHEIV20
  8756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8757
  8758
  8759
  8760* EXEC CICS HANDLE CONDITION
  8761*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
  8762*    END-EXEC.
  8763*    MOVE '"$I                   ! # #00008596' TO DFHEIV0
  8764     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8766     MOVE X'2320233030303038353936' TO DFHEIV0(25:11)
  8767     CALL 'kxdfhei1' USING DFHEIV0
  8768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8769
  8770
  8771     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
  8772     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
  8773     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
  8774
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 168
* EL6311.cbl
  8775
  8776* EXEC CICS READ
  8777*        INTO    (PENDING-BUSINESS)
  8778*        DATASET (FILE-ID-ERPNDB)
  8779*        RIDFLD  (ERPNDB-KEY)
  8780*    END-EXEC.
  8781     MOVE LENGTH OF
  8782      PENDING-BUSINESS
  8783       TO DFHEIV11
  8784*    MOVE '&"IL       E          (   #00008604' TO DFHEIV0
  8785     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8787     MOVE X'2020233030303038363034' TO DFHEIV0(25:11)
  8788     CALL 'kxdfhei1' USING DFHEIV0,
  8789           FILE-ID-ERPNDB,
  8790           PENDING-BUSINESS,
  8791           DFHEIV11,
  8792           ERPNDB-KEY,
  8793           DFHEIV99,
  8794           DFHEIV99,
  8795           DFHEIV99
  8796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8797
  8798
  8799     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
  8800
  8801     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
  8802     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
  8803     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
  8804     MOVE SPACES                 TO PENDING-BUSINESS.
  8805     MOVE 'PB'                   TO PB-RECORD-ID.
  8806     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
  8807     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
  8808     MOVE SPACES                 TO PB-CERT-SFX.
  8809     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
  8810     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  8811                                    PB-ALT-CHG-SEQ-NO.
  8812
  8813     MOVE BCERTNOI               TO PB-CERT-PRIME.
  8814     MOVE '1'                    TO PB-RECORD-TYPE.
  8815
  8816     IF BSUFIXL NOT = ZEROS
  8817        MOVE BSUFIXI             TO PB-CERT-SFX.
  8818
  8819     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
  8820
  8821     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
  8822     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  8823
  8824     MOVE ZEROS                  TO PB-I-LOAN-TERM
  8825                                    PB-I-LF-PREM-CALC
  8826                                    PB-I-LF-ALT-PREM-CALC
  8827                                    PB-I-LF-RATE
  8828                                    PB-I-LF-ALT-RATE
  8829                                    PB-I-LF-REI-RATE
  8830                                    PB-I-LF-ALT-REI-RATE
  8831                                    PB-I-RATE-DEV-PCT-LF
  8832                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 169
* EL6311.cbl
  8833                                    PB-I-AH-RATE
  8834                                    PB-I-AH-REI-RATE
  8835                                    PB-I-AH-RATE-TRM
  8836                                    PB-I-RATE-DEV-PCT-AH
  8837                                    PB-I-BUSINESS-TYPE
  8838                                    PB-I-LIFE-COMMISSION
  8839                                    PB-I-JOINT-COMMISSION
  8840                                    PB-I-JOINT-AGE
  8841                                    PB-I-AH-COMMISSION
  8842                                    PB-I-CURR-SEQ
  8843                                    PB-CHG-COUNT
  8844                                    PB-LF-BILLED-AMTS
  8845                                    PB-AH-BILLED-AMTS
  8846                                    PB-CALC-TOLERANCE
  8847                                    PB-I-EXTENTION-DAYS
  8848*                                   PB-I-MICROFILM-NO
  8849                                    PB-I-TERM-IN-DAYS.
  8850
  8851     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  8852                                    PB-I-LF-EXPIRE-DT
  8853                                    PB-I-AH-EXPIRE-DT
  8854                                    PB-BILLED-DT
  8855                                    PB-ACCT-EFF-DT
  8856                                    PB-ACCT-EXP-DT
  8857                                    PB-I-1ST-PMT-DT.
  8858
  8859     MOVE 'X'                    TO PB-FATAL-FLAG.
  8860
  8861     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
  8862
  8863     IF BLSTNML GREATER THAN ZEROS
  8864         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
  8865
  8866*    IF BMICRNOL  GREATER  ZEROS
  8867*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
  8868*    ELSE
  8869*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
  8870     IF BVINL > ZEROS
  8871        MOVE BVINI               TO PB-I-VIN
  8872     END-IF
  8873     IF B1STNML GREATER THAN ZEROS
  8874         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
  8875
  8876     IF BINITL  GREATER THAN ZEROS
  8877         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
  8878
  8879     IF BBIRTHL GREATER THAN ZERO
  8880         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
  8881     ELSE
  8882         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
  8883
  8884     IF B1STPMTL GREATER THAN ZERO
  8885         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
  8886     ELSE
  8887         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
  8888
  8889     IF BAGEL    GREATER THAN ZEROS
  8890         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 170
* EL6311.cbl
  8891        ELSE
  8892         MOVE ZEROS              TO PB-I-AGE.
  8893
  8894     IF BSEXL    GREATER THAN ZEROS
  8895         MOVE BSEXI              TO PB-I-INSURED-SEX.
  8896
  8897     IF BTERM-LEN (1) GREATER THAN ZEROS
  8898        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
  8899     ELSE
  8900        MOVE ZEROS               TO PB-I-LF-TERM.
  8901
  8902     IF BTERM-LEN (2) GREATER THAN ZEROS
  8903        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
  8904     ELSE
  8905        MOVE ZEROS               TO PB-I-AH-TERM.
  8906
  8907     IF BLNTRML       GREATER THAN ZEROS
  8908         MOVE BLNTRMI            TO PB-I-LOAN-TERM
  8909        ELSE
  8910         MOVE ZEROS              TO PB-I-LOAN-TERM.
  8911
  8912     IF BFREQL        GREATER THAN ZEROS
  8913         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
  8914        ELSE
  8915         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
  8916
  8917     IF BSKPCDL       GREATER THAN ZEROS
  8918         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
  8919
  8920     IF BMODEL        GREATER THAN ZEROS
  8921         MOVE BMODEI             TO PB-I-TERM-TYPE
  8922                                    PI-BMODE.
  8923
  8924     IF BPMTSL        GREATER THAN ZEROS
  8925         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
  8926                                    PI-BPMTS
  8927        ELSE
  8928         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
  8929                                    PI-BPMTS.
  8930
  8931     IF BPMTAMTL      GREATER THAN ZEROS
  8932         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
  8933        ELSE
  8934         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
  8935
  8936     IF BTYPE-LEN (1)   GREATER THAN ZEROS
  8937        IF BTYPE  (1)   NOT = ZEROS
  8938           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
  8939                                    PI-BTYPE (1)
  8940           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
  8941           MOVE SPACES           TO PB-I-LF-ABBR
  8942        ELSE
  8943           MOVE SPACES           TO PB-I-LF-INPUT-CD
  8944                                    PB-I-LF-ABBR
  8945           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
  8946     ELSE
  8947        MOVE SPACES              TO PB-I-LF-INPUT-CD
  8948                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 171
* EL6311.cbl
  8949        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
  8950
  8951     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
  8952         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
  8953     ELSE
  8954         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
  8955
  8956     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
  8957         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
  8958     ELSE
  8959         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
  8960
  8961     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
  8962         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
  8963            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
  8964            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
  8965         ELSE
  8966            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
  8967            MOVE '?'             TO PB-I-LF-CALC-FLAG
  8968     ELSE
  8969         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
  8970
  8971     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
  8972         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
  8973
  8974     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
  8975         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
  8976         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
  8977     ELSE
  8978         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
  8979
  8980     IF  BALT-PREM-LEN     (2) > ZEROS
  8981         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
  8982     ELSE
  8983         MOVE ZEROS            TO PB-I-TOT-FEES.
  8984
  8985     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
  8986        IF BTYPE      (2)   NOT = ZEROS
  8987           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
  8988                                  PI-BTYPE (2)
  8989           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
  8990           MOVE SPACES         TO PB-I-AH-ABBR
  8991        ELSE
  8992           MOVE SPACES         TO PB-I-AH-INPUT-CD
  8993                                  PB-I-AH-ABBR
  8994           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
  8995     ELSE
  8996        MOVE SPACES            TO PB-I-AH-INPUT-CD
  8997                                  PB-I-AH-ABBR
  8998        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
  8999
  9000     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
  9001         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
  9002     ELSE
  9003         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
  9004
  9005     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
  9006         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 172
* EL6311.cbl
  9007            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
  9008            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
  9009         ELSE
  9010            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
  9011            MOVE '?'             TO PB-I-AH-CALC-FLAG
  9012     ELSE
  9013         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
  9014
  9015     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
  9016         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
  9017
  9018     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
  9019        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
  9020     ELSE
  9021        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
  9022
  9023     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
  9024        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
  9025     ELSE
  9026        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
  9027
  9028     IF BINDGRPL  GREATER THAN ZEROS
  9029         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
  9030
  9031     IF BRTCLSL   GREATER THAN ZEROS
  9032         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
  9033
  9034     IF BSIGL     GREATER THAN ZEROS
  9035         MOVE BSIGI              TO PB-I-SIG-SW.
  9036
  9037     IF BAPRL     GREATER THAN ZEROS
  9038         MOVE WS-BAPR            TO PB-I-LOAN-APR
  9039     ELSE
  9040         MOVE ZEROS              TO PB-I-LOAN-APR.
  9041
  9042     IF BMEMBERL  GREATER THAN ZEROS
  9043         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
  9044
  9045     IF BLNOFCRL  GREATER THAN ZEROS
  9046         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
  9047
  9048     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
  9049        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
  9050     ELSE
  9051        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
  9052
  9053     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
  9054        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
  9055     ELSE
  9056        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
  9057
  9058     IF BDAYSL   GREATER THAN ZEROS
  9059        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
  9060                                    PB-I-EXTENTION-DAYS
  9061     ELSE
  9062        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
  9063                                    PB-I-EXTENTION-DAYS.
  9064
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 173
* EL6311.cbl
  9065     IF BDAYSL GREATER THAN ZEROS
  9066        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
  9067
  9068     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
  9069        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
  9070           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
  9071
  9072     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
  9073        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
  9074           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
  9075
  9076     IF B1STPMTL GREATER THAN ZEROS
  9077        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
  9078
  9079     IF PB-EXT-DAYS-PROCESSING
  9080        IF PB-I-EXTENTION-DAYS = ZEROS
  9081           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
  9082
  9083     IF PB-EXPIRE-DT-PROCESSING
  9084        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
  9085           PB-I-AH-EXPIRE-DT = LOW-VALUES
  9086             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
  9087
  9088     IF PB-1ST-PMT-DT-PROCESSING
  9089        IF PB-I-1ST-PMT-DT = LOW-VALUES
  9090           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
  9091
  9092     IF BREINL GREATER THAN ZEROS
  9093        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
  9094
  9095     IF BENTRYL NOT = ZEROS
  9096        MOVE BENTRYI             TO PB-BATCH-ENTRY
  9097        IF PI-COMPANY-ID = 'CID'
  9098           AND (PB-BATCH-ENTRY = 'P')
  9099           AND (PB-STATE = 'VA')
  9100           PERFORM 1500-UPDATE-ERNOTE
  9101                                 THRU 1500-EXIT
  9102        END-IF
  9103     END-IF
  9104     IF BUNWRITL NOT = ZEROS
  9105        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
  9106
  9107     IF BFORCEL NOT = ZEROS
  9108        MOVE BFORCEI             TO PB-FORCE-CODE.
  9109
  9110     IF BBILCDL NOT = ZEROS
  9111        MOVE BBILCDI             TO PB-RECORD-BILL.
  9112
  9113     IF BLIVESL GREATER THAN ZEROS
  9114        MOVE WS-BLIVES           TO PB-I-LIVES
  9115     ELSE
  9116        MOVE ZEROS               TO PB-I-LIVES.
  9117
  9118     IF BBILLEDL GREATER THAN ZEROS
  9119        MOVE WS-BILLED           TO PB-I-NUM-BILLED
  9120     ELSE
  9121        MOVE ZEROS               TO PB-I-NUM-BILLED.
  9122
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 174
* EL6311.cbl
  9123*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
  9124
  9125 1260-WRITE-PB-RECORD.
  9126     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
  9127                                    PB-INPUT-BY.
  9128     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  9129     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
  9130                                    PB-INPUT-DT.
  9131
  9132     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
  9133     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
  9134                                    PB-CONTROL-BY-ORIG-BATCH.
  9135
  9136
  9137     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
  9138     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
  9139     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
  9140     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
  9141     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
  9142
  9143     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
  9144
  9145     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
  9146
  9147     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
  9148     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
  9149     MOVE PB-SV-STATE            TO PI-SV-STATE.
  9150
  9151     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
  9152     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
  9153
  9154 1275-WRITE-PENDING-BUSINESS.
  9155     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9156     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  9157     MOVE 'A'                    TO JP-RECORD-TYPE.
  9158     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9159
  9160
  9161* EXEC CICS HANDLE CONDITION
  9162*        DUPREC (1290-DUPLICATE-ALT-INDEX)
  9163*    END-EXEC.
  9164*    MOVE '"$%                   ! $ #00008971' TO DFHEIV0
  9165     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  9166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9167     MOVE X'2420233030303038393731' TO DFHEIV0(25:11)
  9168     CALL 'kxdfhei1' USING DFHEIV0
  9169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9170
  9171
  9172
  9173* EXEC CICS WRITE
  9174*        DATASET (FILE-ID-ERPNDB)
  9175*        FROM    (PENDING-BUSINESS)
  9176*        RIDFLD  (PB-CONTROL-PRIMARY)
  9177*    END-EXEC.
  9178     MOVE LENGTH OF
  9179      PENDING-BUSINESS
  9180       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 175
* EL6311.cbl
  9181*    MOVE '&$ L                  ''   #00008975' TO DFHEIV0
  9182     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9183     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9184     MOVE X'2020233030303038393735' TO DFHEIV0(25:11)
  9185     CALL 'kxdfhei1' USING DFHEIV0,
  9186           FILE-ID-ERPNDB,
  9187           PENDING-BUSINESS,
  9188           DFHEIV11,
  9189           PB-CONTROL-PRIMARY,
  9190           DFHEIV99,
  9191           DFHEIV99
  9192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9193
  9194
  9195     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
  9196
  9197     PERFORM 8400-LOG-JOURNAL-RECORD.
  9198
  9199******************************************************************
  9200*       U P D A T E   T H E   B A T C H   H E A D E R            *
  9201******************************************************************
  9202
  9203
  9204* EXEC CICS READ
  9205*        INTO    (PENDING-BUSINESS)
  9206*        DATASET (FILE-ID-ERPNDB)
  9207*        RIDFLD  (ERPNDB-KEY)
  9208*        UPDATE
  9209*    END-EXEC.
  9210     MOVE LENGTH OF
  9211      PENDING-BUSINESS
  9212       TO DFHEIV11
  9213*    MOVE '&"IL       EU         (   #00008989' TO DFHEIV0
  9214     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9215     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9216     MOVE X'2020233030303038393839' TO DFHEIV0(25:11)
  9217     CALL 'kxdfhei1' USING DFHEIV0,
  9218           FILE-ID-ERPNDB,
  9219           PENDING-BUSINESS,
  9220           DFHEIV11,
  9221           ERPNDB-KEY,
  9222           DFHEIV99,
  9223           DFHEIV99,
  9224           DFHEIV99
  9225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9226
  9227
  9228     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9229     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  9230     MOVE 'B'                    TO JP-RECORD-TYPE.
  9231     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9232
  9233     PERFORM 8400-LOG-JOURNAL-RECORD.
  9234
  9235     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
  9236
  9237
  9238* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 176
* EL6311.cbl
  9239*        DATASET (FILE-ID-ERPNDB)
  9240*        FROM    (PENDING-BUSINESS)
  9241*    END-EXEC.
  9242     MOVE LENGTH OF
  9243      PENDING-BUSINESS
  9244       TO DFHEIV11
  9245*    MOVE '&& L                  %   #00009005' TO DFHEIV0
  9246     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9247     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9248     MOVE X'2020233030303039303035' TO DFHEIV0(25:11)
  9249     CALL 'kxdfhei1' USING DFHEIV0,
  9250           FILE-ID-ERPNDB,
  9251           PENDING-BUSINESS,
  9252           DFHEIV11,
  9253           DFHEIV99
  9254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9255
  9256
  9257     MOVE 'C'                    TO JP-RECORD-TYPE.
  9258     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9259
  9260     PERFORM 8400-LOG-JOURNAL-RECORD.
  9261
  9262     IF WS-ERRORS-PRESENT
  9263         GO TO 3900-RE-DISPLAY-RECORD.
  9264
  9265     MOVE ZEROS                  TO EMI-ERROR.
  9266     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9267     MOVE LOW-VALUES             TO EL631BI.
  9268     MOVE  -1                    TO BMAINTL.
  9269     GO TO 8100-SEND-INITIAL-MAP.
  9270
  9271 1280-BATCH-HDR-NOT-FOUND.
  9272     MOVE -1                     TO BMAINTL.
  9273     MOVE ER-7450                TO EMI-ERROR.
  9274     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9275     GO TO 8200-SEND-DATAONLY.
  9276
  9277 1290-DUPLICATE-ALT-INDEX.
  9278
  9279******************************************************************
  9280*                                                                *
  9281*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
  9282*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
  9283*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
  9284*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
  9285*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
  9286*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
  9287*                                                                *
  9288******************************************************************
  9289
  9290     IF LCP-ONCTR-01 =  0
  9291         ADD 1 TO LCP-ONCTR-01
  9292        MOVE +0                  TO WS-SEQ-NO-COUNTER.
  9293
  9294     ADD +1                      TO WS-SEQ-NO-COUNTER.
  9295
  9296     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 177
* EL6311.cbl
  9297         NEXT SENTENCE
  9298     ELSE
  9299         ADD +1 TO PB-BATCH-SEQ-NO
  9300                   PB-CSR-BATCH-SEQ-NO
  9301         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
  9302         GO TO 1275-WRITE-PENDING-BUSINESS.
  9303
  9304     MOVE -1                     TO BCERTNOL.
  9305     MOVE AL-UABON               TO BCERTNOA.
  9306     MOVE AL-UNBON               TO BEFFDTA.
  9307
  9308     MOVE 1                      TO EMI-SUB
  9309                                    EMI-SWITCH1
  9310                                    EMI-SWITCH-AREA-1
  9311                                    EMI-SWITCH-AREA-2.
  9312
  9313     MOVE SPACES                 TO EMI-ERROR-LINES.
  9314
  9315
  9316* EXEC CICS SYNCPOINT ROLLBACK
  9317*    END-EXEC.
  9318*    MOVE '6"R                   !   #00009068' TO DFHEIV0
  9319     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  9320     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9321     MOVE X'2020233030303039303638' TO DFHEIV0(25:11)
  9322     CALL 'kxdfhei1' USING DFHEIV0
  9323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9324
  9325
  9326     MOVE ER-2247                TO EMI-ERROR.
  9327     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9328     GO TO 8200-SEND-DATAONLY.
  9329
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 178
* EL6311.cbl
  9331
  9332******************************************************************
  9333*                                                                *
  9334*          C H A N G E   I S S U E   R O U T I N E               *
  9335*                                                                *
  9336******************************************************************
  9337
  9338***************************************************************
  9339*                                                             *
  9340*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
  9341*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
  9342*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
  9343*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
  9344*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
  9345*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
  9346*     5. LINK TO THE EDIT ROUTINE.                            *
  9347*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
  9348*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
  9349*              THE EDIT ROUTINE.                              *
  9350*     7. REWRITE THE NEW ISSUE                                *
  9351*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
  9352*                                                             *
  9353***************************************************************
  9354
  9355 1300-CHANGE-ISSUE-ROUTINE.
  9356     MOVE 'C'                    TO PI-MAINT-FUNCTION.
  9357
  9358     IF BCHGL NOT = ZEROS
  9359        MOVE ER-2196             TO EMI-ERROR
  9360        MOVE AL-UABON            TO BMAINTA
  9361        MOVE -1                  TO BMAINTL
  9362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9363        GO TO 8200-SEND-DATAONLY.
  9364
  9365     MOVE BCERTNOI               TO WS-NEW-PRIME.
  9366
  9367     IF BSUFIXL NOT = ZEROS
  9368        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  9369     ELSE
  9370        MOVE SPACE               TO WS-NEW-SUFFIX.
  9371
  9372     MOVE BEFFDTI                TO DEEDIT-FIELD.
  9373     PERFORM 8600-DEEDIT.
  9374     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9375     MOVE '4'                    TO DC-OPTION-CODE.
  9376     PERFORM 9700-DATE-LINK.
  9377     IF DATE-CONVERSION-ERROR
  9378        MOVE ER-0348             TO EMI-ERROR
  9379        MOVE -1                  TO BEFFDTL
  9380        MOVE AL-UABON            TO BEFFDTA
  9381        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9382        GO TO 8200-SEND-DATAONLY
  9383     ELSE
  9384        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
  9385        MOVE AL-UANON            TO BEFFDTA
  9386        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
  9387
  9388 1325-PROCESS-ISSUE-CHANGES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 179
* EL6311.cbl
  9389
  9390* EXEC CICS HANDLE CONDITION
  9391*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
  9392*    END-EXEC.
  9393*    MOVE '"$I                   ! % #00009134' TO DFHEIV0
  9394     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9396     MOVE X'2520233030303039313334' TO DFHEIV0(25:11)
  9397     CALL 'kxdfhei1' USING DFHEIV0
  9398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9399
  9400
  9401     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
  9402     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
  9403     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
  9404
  9405
  9406* EXEC CICS GETMAIN
  9407*        SET      (ADDRESS OF PENDING-BUSINESS)
  9408*        LENGTH   (ERPNDB-RECORD-LENGTH)
  9409*        INITIMG  (GETMAIN-SPACE)
  9410*     END-EXEC.
  9411*    MOVE ',"IL                  $   #00009142' TO DFHEIV0
  9412     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9413     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9414     MOVE X'2020233030303039313432' TO DFHEIV0(25:11)
  9415     CALL 'kxdfhei1' USING DFHEIV0,
  9416           DFHEIV20,
  9417           ERPNDB-RECORD-LENGTH,
  9418           GETMAIN-SPACE
  9419     SET ADDRESS OF PENDING-BUSINESS TO
  9420         DFHEIV20
  9421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9422
  9423
  9424
  9425* EXEC CICS READ
  9426*        INTO    (PENDING-BUSINESS)
  9427*        DATASET (FILE-ID-ERPNDB)
  9428*        RIDFLD  (ERPNDB-KEY)
  9429*    END-EXEC.
  9430     MOVE LENGTH OF
  9431      PENDING-BUSINESS
  9432       TO DFHEIV11
  9433*    MOVE '&"IL       E          (   #00009148' TO DFHEIV0
  9434     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9436     MOVE X'2020233030303039313438' TO DFHEIV0(25:11)
  9437     CALL 'kxdfhei1' USING DFHEIV0,
  9438           FILE-ID-ERPNDB,
  9439           PENDING-BUSINESS,
  9440           DFHEIV11,
  9441           ERPNDB-KEY,
  9442           DFHEIV99,
  9443           DFHEIV99,
  9444           DFHEIV99
  9445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9446
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 180
* EL6311.cbl
  9447
  9448     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
  9449
  9450
  9451* EXEC CICS HANDLE CONDITION
  9452*         NOTFND     (1385-REC-NOT-FOUND)
  9453*    END-EXEC.
  9454*    MOVE '"$I                   ! & #00009156' TO DFHEIV0
  9455     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9457     MOVE X'2620233030303039313536' TO DFHEIV0(25:11)
  9458     CALL 'kxdfhei1' USING DFHEIV0
  9459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9460
  9461
  9462**********************************************************
  9463*      DONT READ THE RECORD FOR UPDATE UNTIL             *
  9464*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
  9465**********************************************************
  9466
  9467
  9468* EXEC CICS READ
  9469*        DATASET (FILE-ID-ERPNDB)
  9470*        INTO    (PENDING-BUSINESS)
  9471*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9472*    END-EXEC.
  9473     MOVE LENGTH OF
  9474      PENDING-BUSINESS
  9475       TO DFHEIV11
  9476*    MOVE '&"IL       E          (   #00009165' TO DFHEIV0
  9477     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9479     MOVE X'2020233030303039313635' TO DFHEIV0(25:11)
  9480     CALL 'kxdfhei1' USING DFHEIV0,
  9481           FILE-ID-ERPNDB,
  9482           PENDING-BUSINESS,
  9483           DFHEIV11,
  9484           PI-PREV-CONTROL-PRIMARY,
  9485           DFHEIV99,
  9486           DFHEIV99,
  9487           DFHEIV99
  9488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9489
  9490
  9491********** DO NOT ALLOW CHANGES IF THRU A/R
  9492     IF BMAINTI = 'C'
  9493         IF PB-EL860-INTERNAL-PROCESS
  9494             MOVE ER-4005          TO EMI-ERROR
  9495             MOVE -1               TO BMAINTL
  9496             MOVE AL-UABON         TO BMAINTA
  9497             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9498             GO TO 8200-SEND-DATAONLY.
  9499**********
  9500
  9501     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  9502        MOVE -1                 TO BMAINTL
  9503        MOVE ER-2197            TO EMI-ERROR
  9504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 181
* EL6311.cbl
  9505        GO TO 8200-SEND-DATAONLY.
  9506
  9507     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
  9508        MOVE ER-2196             TO EMI-ERROR
  9509        MOVE AL-UABON            TO BMAINTA
  9510        MOVE -1                  TO BMAINTL
  9511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9512        GO TO 8200-SEND-DATAONLY.
  9513
  9514     MOVE ZEROS                  TO WS-SEQ-SAVE.
  9515
  9516     IF PB-BILLED-DT = LOW-VALUES AND
  9517        PB-CHG-COUNT = ZEROS
  9518        NEXT SENTENCE
  9519     ELSE
  9520        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
  9521            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
  9522           OR
  9523           (BPREM-LEN (2) GREATER THAN ZEROS AND
  9524            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
  9525           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
  9526
  9527
  9528* EXEC CICS READ
  9529*        DATASET (FILE-ID-ERPNDB)
  9530*        INTO    (PENDING-BUSINESS)
  9531*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9532*        UPDATE
  9533*    END-EXEC.
  9534     MOVE LENGTH OF
  9535      PENDING-BUSINESS
  9536       TO DFHEIV11
  9537*    MOVE '&"IL       EU         (   #00009207' TO DFHEIV0
  9538     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9539     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9540     MOVE X'2020233030303039323037' TO DFHEIV0(25:11)
  9541     CALL 'kxdfhei1' USING DFHEIV0,
  9542           FILE-ID-ERPNDB,
  9543           PENDING-BUSINESS,
  9544           DFHEIV11,
  9545           PI-PREV-CONTROL-PRIMARY,
  9546           DFHEIV99,
  9547           DFHEIV99,
  9548           DFHEIV99
  9549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9550
  9551
  9552     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  9553     MOVE 'B'                    TO JP-RECORD-TYPE
  9554     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9555     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9556
  9557     PERFORM 8400-LOG-JOURNAL-RECORD.
  9558
  9559     IF PB-BILLED-DT NOT = LOW-VALUES OR
  9560        PB-CHG-COUNT NOT = ZEROS
  9561        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
  9562            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 182
* EL6311.cbl
  9563           OR
  9564           (BPREM-LEN (2) GREATER THAN ZEROS AND
  9565            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
  9566            MOVE LOW-VALUES             TO PB-BILLED-DT
  9567            ADD +1                      TO PB-CHG-COUNT.
  9568
  9569     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  9570     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  9571     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9572     MOVE '5'                    TO DC-OPTION-CODE.
  9573     PERFORM 9700-DATE-LINK
  9574     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
  9575
  9576*    IF BMICRNOL  GREATER  ZEROS
  9577*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
  9578
  9579     IF BVINL > ZEROS
  9580        MOVE BVINI               TO PB-I-VIN
  9581     END-IF
  9582     IF (BFORCEL NOT = ZEROS)
  9583        AND (PB-COMPANY-ID = 'DCC')
  9584        AND (BFORCEI = ' ')
  9585        AND (PB-FORCE-CODE = 'O')
  9586        COMPUTE PB-I-AH-PREMIUM-AMT =
  9587           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
  9588        PERFORM 1800-REMOVE-CERT-NOTES
  9589                                 THRU 1800-EXIT
  9590        PERFORM 1900-DELETE-ERPYAJ
  9591                                 THRU 1900-EXIT
  9592        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
  9593     END-IF
  9594     IF (BFORCEL NOT = ZEROS)
  9595        AND (PB-COMPANY-ID = 'DCC')
  9596        AND (BFORCEI = 'O')
  9597        AND (PB-FORCE-CODE NOT = 'O')
  9598        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
  9599           PB-I-AH-PREM-CALC
  9600        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
  9601        MOVE SPACE               TO DC-OPTION-CODE
  9602        PERFORM 9700-DATE-LINK
  9603        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
  9604        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
  9605        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
  9606        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
  9607        PERFORM 1500-UPDATE-ERNOTE
  9608                                 THRU 1500-EXIT
  9609        PERFORM 1600-UPDATE-ERPYAJ
  9610                                 THRU 1600-EXIT
  9611     END-IF
  9612     IF BLSTNML  GREATER THAN ZEROS
  9613         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
  9614
  9615     IF B1STNML  GREATER THAN ZEROS
  9616         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
  9617
  9618     IF BINITL   GREATER THAN ZEROS
  9619         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
  9620
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 183
* EL6311.cbl
  9621     IF BBIRTHL  GREATER THAN ZERO
  9622         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
  9623
  9624     IF B1STPMTL GREATER THAN ZERO
  9625         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
  9626
  9627     IF BAGEL    GREATER THAN ZEROS
  9628         MOVE BAGEI              TO PB-I-AGE.
  9629
  9630     IF BSEXL    GREATER THAN ZEROS
  9631         MOVE BSEXI              TO PB-I-INSURED-SEX.
  9632
  9633     IF BTERM-LEN (1)   GREATER THAN ZEROS
  9634        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
  9635
  9636     IF BTERM-LEN (2)   GREATER THAN ZEROS
  9637        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
  9638
  9639     IF BLNTRML  GREATER THAN ZEROS
  9640         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
  9641
  9642     IF BFREQL   GREATER THAN ZEROS
  9643         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
  9644
  9645     IF BSKPCDL  GREATER THAN ZEROS
  9646         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
  9647
  9648     IF BMODEL   GREATER THAN ZEROS
  9649         MOVE BMODEI             TO PB-I-TERM-TYPE
  9650                                    PI-BMODE.
  9651
  9652     IF BPMTSL   GREATER THAN ZEROS
  9653         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
  9654                                    PI-BPMTS.
  9655
  9656     IF BPMTAMTL GREATER THAN ZEROS
  9657         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
  9658
  9659     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
  9660         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
  9661
  9662     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
  9663         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
  9664
  9665     MOVE SPACE TO PB-I-LF-CALC-FLAG.
  9666
  9667     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
  9668         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
  9669            SUBTRACT PB-I-LF-PREMIUM-AMT
  9670                     FROM WS-B-LF-ISS-PRM-ENTERED
  9671            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
  9672            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
  9673            MOVE SPACE           TO PB-I-LF-CALC-FLAG
  9674         ELSE
  9675            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
  9676            MOVE '?'             TO PB-I-LF-CALC-FLAG.
  9677
  9678     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 184
* EL6311.cbl
  9679            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
  9680                     FROM WS-B-LF-ISS-PRM-ENTERED
  9681         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
  9682         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
  9683
  9684     IF  BALT-PREM-LEN     (2)  > ZEROS
  9685         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
  9686
  9687     IF  BBEN-LEN (2)  GREATER THAN ZEROS
  9688         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
  9689
  9690     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
  9691         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
  9692            SUBTRACT PB-I-AH-PREMIUM-AMT
  9693                     FROM WS-B-AH-ISS-PRM-ENTERED
  9694            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
  9695            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
  9696            MOVE SPACE           TO PB-I-AH-CALC-FLAG
  9697         ELSE
  9698            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
  9699            MOVE '?'             TO PB-I-AH-CALC-FLAG.
  9700
  9701     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
  9702        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
  9703
  9704     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
  9705        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
  9706
  9707     IF BINDGRPL            GREATER THAN ZEROS
  9708         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
  9709
  9710     IF BRTCLSL             GREATER THAN ZEROS
  9711         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
  9712
  9713     IF BSIGL               GREATER THAN ZEROS
  9714         MOVE BSIGI              TO PB-I-SIG-SW.
  9715
  9716     IF BAPRL               GREATER THAN ZEROS
  9717         MOVE WS-BAPR            TO PB-I-LOAN-APR.
  9718
  9719     IF BMEMBERL            GREATER THAN ZEROS
  9720         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
  9721
  9722     IF BLNOFCRL            GREATER THAN ZEROS
  9723         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
  9724
  9725     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
  9726        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
  9727
  9728     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
  9729        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
  9730
  9731     IF BDAYSL              GREATER THAN ZEROS
  9732        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
  9733                                    PB-I-EXTENTION-DAYS.
  9734
  9735     IF BDAYSL GREATER THAN ZEROS
  9736        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 185
* EL6311.cbl
  9737
  9738     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
  9739        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
  9740           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
  9741
  9742     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
  9743        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
  9744           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
  9745
  9746     IF B1STPMTL GREATER THAN ZEROS
  9747        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
  9748
  9749     IF PB-EXT-DAYS-PROCESSING
  9750        IF PB-I-EXTENTION-DAYS = ZEROS
  9751           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
  9752
  9753     IF PB-EXPIRE-DT-PROCESSING
  9754        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
  9755           PB-I-AH-EXPIRE-DT = LOW-VALUES
  9756             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
  9757
  9758     IF PB-1ST-PMT-DT-PROCESSING
  9759        IF PB-I-1ST-PMT-DT = LOW-VALUES
  9760           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
  9761
  9762     IF BREINL GREATER THAN ZEROS
  9763        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
  9764
  9765     IF BFORCEL NOT = ZEROS
  9766        MOVE BFORCEI             TO PB-FORCE-CODE.
  9767     IF (BENTRYL NOT = ZEROS)
  9768        AND (PB-COMPANY-ID = 'CID')
  9769        AND (PB-STATE = 'VA')
  9770        AND (BENTRYI NOT = 'P')
  9771        AND (PB-BATCH-ENTRY = 'P')
  9772        PERFORM 1800-REMOVE-CERT-NOTES
  9773                                 THRU 1800-EXIT
  9774     END-IF
  9775     IF BENTRYL NOT = ZEROS
  9776        MOVE BENTRYI             TO PB-BATCH-ENTRY
  9777        IF PI-COMPANY-ID = 'CID'
  9778           AND (PB-BATCH-ENTRY = 'P')
  9779           AND (PB-STATE = 'VA')
  9780           PERFORM 1500-UPDATE-ERNOTE
  9781                                 THRU 1500-EXIT
  9782        END-IF
  9783     END-IF
  9784
  9785     IF BUNWRITL NOT = ZEROS
  9786        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
  9787
  9788     IF BBILCDL NOT = ZEROS
  9789        MOVE BBILCDI             TO PB-RECORD-BILL.
  9790
  9791     IF BLIVESL GREATER THAN ZEROS
  9792        MOVE WS-BLIVES           TO PB-I-LIVES.
  9793
  9794
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 186
* EL6311.cbl
  9795*DMD CUSTOM CODING*************START
  9796     IF PI-COMPANY-ID NOT = 'DMD'
  9797         MOVE ZEROS               TO BBILLEDL.
  9798*DMD CUSTOM CODING*************END
  9799
  9800     IF BBILLEDL GREATER THAN ZEROS
  9801        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
  9802
  9803
  9804*****************************************************************
  9805*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
  9806*****************************************************************
  9807
  9808     IF BTYPE-LEN (1)   GREATER THAN ZEROS
  9809        IF BTYPE  (1)   = ZEROS OR SPACES
  9810           IF REMOVE-LF-COVERAGE
  9811               MOVE SPACES           TO PB-I-LF-INPUT-CD
  9812                                        PI-BTYPE (1)
  9813               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
  9814                                        WS-B-LF-ISS-PRM-ENTERED
  9815               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
  9816                                        WS-B-LF-ISS-PRM-ENTERED
  9817               SUBTRACT PB-I-LF-PREM-CALC FROM
  9818                                        WS-B-LF-ISS-PRM-COMPUTED
  9819               MOVE ZEROS            TO PB-I-LF-TERM
  9820                                        PB-I-LF-BENEFIT-AMT
  9821                                        PB-I-LF-PREMIUM-AMT
  9822                                        PB-I-LF-BENEFIT-CD
  9823                                        PB-I-LF-PREM-CALC
  9824                                        PB-I-LF-CRIT-PER
  9825                                        PB-I-LF-ALT-BENEFIT-AMT
  9826                                        PB-I-LF-ALT-PREMIUM-AMT
  9827               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
  9828           ELSE
  9829               NEXT SENTENCE
  9830        ELSE
  9831           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
  9832                                    PI-BTYPE (1).
  9833     IF BTYPE-LEN (2)   GREATER THAN ZEROS
  9834        IF BTYPE  (2)   = ZEROS OR SPACES
  9835           IF  REMOVE-AH-COVERAGE
  9836               MOVE SPACES           TO PB-I-AH-INPUT-CD
  9837                                        PI-BTYPE (2)
  9838               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
  9839                                        WS-B-AH-ISS-PRM-ENTERED
  9840               SUBTRACT PB-I-AH-PREM-CALC FROM
  9841                                        WS-B-AH-ISS-PRM-COMPUTED
  9842               MOVE ZEROS            TO PB-I-AH-TERM
  9843                                        PB-I-AH-BENEFIT-AMT
  9844                                        PB-I-AH-PREMIUM-AMT
  9845                                        PB-I-AH-BENEFIT-CD
  9846                                        PB-I-AH-PREM-CALC
  9847                                        PB-I-AH-CRIT-PER
  9848               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
  9849           ELSE
  9850               NEXT SENTENCE
  9851        ELSE
  9852           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 187
* EL6311.cbl
  9853                                    PI-BTYPE (2).
  9854 1360-REWRITE-PB-RECORD.
  9855     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  9856
  9857     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  9858     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  9859
  9860     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
  9861
  9862     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
  9863     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
  9864
  9865     IF BCPREM-LEN (1)  GREATER THAN ZEROS
  9866         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
  9867
  9868     IF BCPREM-LEN (2)  GREATER THAN ZEROS
  9869         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
  9870
  9871     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
  9872
  9873     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
  9874
  9875     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
  9876
  9877     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
  9878     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
  9879     MOVE PB-SV-STATE            TO PI-SV-STATE.
  9880
  9881     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
  9882     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
  9883
  9884 1375-REWRITE-PB-RECORD.
  9885     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9886     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  9887     MOVE 'C'                    TO JP-RECORD-TYPE.
  9888     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9889
  9890
  9891* EXEC CICS REWRITE
  9892*        DATASET (FILE-ID-ERPNDB)
  9893*        FROM    (PENDING-BUSINESS)
  9894*    END-EXEC.
  9895     MOVE LENGTH OF
  9896      PENDING-BUSINESS
  9897       TO DFHEIV11
  9898*    MOVE '&& L                  %   #00009552' TO DFHEIV0
  9899     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9900     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9901     MOVE X'2020233030303039353532' TO DFHEIV0(25:11)
  9902     CALL 'kxdfhei1' USING DFHEIV0,
  9903           FILE-ID-ERPNDB,
  9904           PENDING-BUSINESS,
  9905           DFHEIV11,
  9906           DFHEIV99
  9907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9908
  9909
  9910     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 188
* EL6311.cbl
  9911
  9912******************************************************************
  9913*       U P D A T E   T H E   B A T C H   H E A D E R            *
  9914******************************************************************
  9915
  9916     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
  9917     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
  9918
  9919
  9920* EXEC CICS READ
  9921*        INTO    (PENDING-BUSINESS)
  9922*        DATASET (FILE-ID-ERPNDB)
  9923*        RIDFLD  (ERPNDB-KEY)
  9924*        UPDATE
  9925*    END-EXEC.
  9926     MOVE LENGTH OF
  9927      PENDING-BUSINESS
  9928       TO DFHEIV11
  9929*    MOVE '&"IL       EU         (   #00009566' TO DFHEIV0
  9930     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9931     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9932     MOVE X'2020233030303039353636' TO DFHEIV0(25:11)
  9933     CALL 'kxdfhei1' USING DFHEIV0,
  9934           FILE-ID-ERPNDB,
  9935           PENDING-BUSINESS,
  9936           DFHEIV11,
  9937           ERPNDB-KEY,
  9938           DFHEIV99,
  9939           DFHEIV99,
  9940           DFHEIV99
  9941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9942
  9943
  9944     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
  9945     MOVE 'B'                    TO JP-RECORD-TYPE.
  9946     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9947
  9948     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9949
  9950     PERFORM 8400-LOG-JOURNAL-RECORD.
  9951
  9952     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
  9953
  9954     MOVE 'C'                    TO JP-RECORD-TYPE.
  9955     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9956
  9957
  9958* EXEC CICS REWRITE
  9959*        DATASET    (FILE-ID-ERPNDB)
  9960*        FROM       (PENDING-BUSINESS)
  9961*    END-EXEC.
  9962     MOVE LENGTH OF
  9963      PENDING-BUSINESS
  9964       TO DFHEIV11
  9965*    MOVE '&& L                  %   #00009586' TO DFHEIV0
  9966     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9967     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9968     MOVE X'2020233030303039353836' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 189
* EL6311.cbl
  9969     CALL 'kxdfhei1' USING DFHEIV0,
  9970           FILE-ID-ERPNDB,
  9971           PENDING-BUSINESS,
  9972           DFHEIV11,
  9973           DFHEIV99
  9974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9975
  9976
  9977     PERFORM 8400-LOG-JOURNAL-RECORD.
  9978
  9979     IF WS-ERRORS-PRESENT
  9980        GO TO 3900-RE-DISPLAY-RECORD.
  9981
  9982     MOVE ZEROS                  TO EMI-ERROR.
  9983     MOVE -1                     TO BMAINTL.
  9984     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9985     GO TO 3900-RE-DISPLAY-RECORD.
  9986
  9987 1380-BATCH-HDR-NOT-FOUND.
  9988     MOVE -1                     TO BMAINTL.
  9989     MOVE ER-7450                TO EMI-ERROR.
  9990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9991     GO TO 8200-SEND-DATAONLY.
  9992
  9993 1385-REC-NOT-FOUND.
  9994     MOVE -1                     TO BMAINTL.
  9995     MOVE ER-7451                TO EMI-ERROR.
  9996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9997     GO TO 8200-SEND-DATAONLY.
  9998
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 190
* EL6311.cbl
 10000
 10001 1390-UPDATE-ERPNDM.
 10002
 10003
 10004* EXEC CICS HANDLE CONDITION
 10005*        NOTFND (1399-EXIT)
 10006*    END-EXEC.
 10007*    MOVE '"$I                   ! '' #00009617' TO DFHEIV0
 10008     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10010     MOVE X'2720233030303039363137' TO DFHEIV0(25:11)
 10011     CALL 'kxdfhei1' USING DFHEIV0
 10012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10013
 10014
 10015     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 10016
 10017
 10018* EXEC CICS READ
 10019*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 10020*        DATASET (FILE-ID-ERPNDM)
 10021*        RIDFLD  (ERPNDM-KEY)
 10022*        UPDATE
 10023*    END-EXEC.
 10024*    MOVE '&"S        EU         (   #00009623' TO DFHEIV0
 10025     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10026     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10027     MOVE X'2020233030303039363233' TO DFHEIV0(25:11)
 10028     CALL 'kxdfhei1' USING DFHEIV0,
 10029           FILE-ID-ERPNDM,
 10030           DFHEIV20,
 10031           DFHEIV99,
 10032           ERPNDM-KEY,
 10033           DFHEIV99,
 10034           DFHEIV99,
 10035           DFHEIV99
 10036     SET ADDRESS OF PENDING-MAILING-DATA TO
 10037         DFHEIV20
 10038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10039
 10040
 10041     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 10042     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 10043     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 10044
 10045     IF BLSTNML GREATER THAN ZEROS
 10046         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 10047
 10048     IF B1STNML GREATER  THAN ZEROS
 10049         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
 10050
 10051     IF BINITL GREATER THAN ZEROS
 10052         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 10053
 10054     IF BAGEL GREATER THAN ZEROS
 10055         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 10056
 10057     IF BBIRTHL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 191
* EL6311.cbl
 10058         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 10059
 10060     IF BSEXL GREATER THAN ZEROS
 10061         MOVE  BSEXI             TO PM-INSURED-SEX.
 10062
 10063
 10064* EXEC CICS REWRITE
 10065*        DATASET (FILE-ID-ERPNDM)
 10066*        FROM    (PENDING-MAILING-DATA)
 10067*    END-EXEC.
 10068     MOVE LENGTH OF
 10069      PENDING-MAILING-DATA
 10070       TO DFHEIV11
 10071*    MOVE '&& L                  %   #00009652' TO DFHEIV0
 10072     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10073     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10074     MOVE X'2020233030303039363532' TO DFHEIV0(25:11)
 10075     CALL 'kxdfhei1' USING DFHEIV0,
 10076           FILE-ID-ERPNDM,
 10077           PENDING-MAILING-DATA,
 10078           DFHEIV11,
 10079           DFHEIV99
 10080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10081
 10082
 10083 1399-EXIT.
 10084     EXIT.
 10085
 10086******************************************************************
 10087*                                                                *
 10088*          D E L E T E   I S S U E   R O U T I N E               *
 10089*                                                                *
 10090******************************************************************
 10091
 10092 1400-DELETE-ISSUE-ROUTINE.
 10093     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 10094
 10095     IF BCHGL NOT = ZEROS
 10096        MOVE ER-2196             TO EMI-ERROR
 10097        MOVE AL-UABON            TO BMAINTA
 10098        MOVE -1                  TO BMAINTL
 10099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10100        GO TO 8200-SEND-DATAONLY.
 10101
 10102
 10103* EXEC CICS HANDLE CONDITION
 10104*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 10105*    END-EXEC.
 10106*    MOVE '"$I                   ! ( #00009676' TO DFHEIV0
 10107     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10109     MOVE X'2820233030303039363736' TO DFHEIV0(25:11)
 10110     CALL 'kxdfhei1' USING DFHEIV0
 10111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10112
 10113
 10114     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10115     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 192
* EL6311.cbl
 10116     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10117
 10118
 10119* EXEC CICS READ
 10120*        SET     (ADDRESS OF PENDING-BUSINESS)
 10121*        DATASET (FILE-ID-ERPNDB)
 10122*        RIDFLD  (ERPNDB-KEY)
 10123*    END-EXEC.
 10124*    MOVE '&"S        E          (   #00009684' TO DFHEIV0
 10125     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10127     MOVE X'2020233030303039363834' TO DFHEIV0(25:11)
 10128     CALL 'kxdfhei1' USING DFHEIV0,
 10129           FILE-ID-ERPNDB,
 10130           DFHEIV20,
 10131           DFHEIV99,
 10132           ERPNDB-KEY,
 10133           DFHEIV99,
 10134           DFHEIV99,
 10135           DFHEIV99
 10136     SET ADDRESS OF PENDING-BUSINESS TO
 10137         DFHEIV20
 10138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10139
 10140
 10141     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10142
 10143     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10144
 10145     IF BSUFIXL NOT = ZEROS
 10146        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10147     ELSE
 10148        MOVE SPACE               TO WS-NEW-SUFFIX.
 10149
 10150     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10151     PERFORM 8600-DEEDIT.
 10152     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10153     MOVE '4'                    TO DC-OPTION-CODE.
 10154     PERFORM 9700-DATE-LINK.
 10155     IF DATE-CONVERSION-ERROR
 10156        MOVE ER-0348             TO EMI-ERROR
 10157        MOVE -1                  TO BEFFDTL
 10158        MOVE AL-UABON            TO BEFFDTA
 10159        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10160        GO TO 8200-SEND-DATAONLY
 10161     ELSE
 10162        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10163        MOVE AL-UANON            TO BEFFDTA
 10164        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10165
 10166
 10167* EXEC CICS HANDLE CONDITION
 10168*         NOTFND    (1490-RECORD-NOT-FOUND)
 10169*    END-EXEC.
 10170*    MOVE '"$I                   ! ) #00009715' TO DFHEIV0
 10171     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10173     MOVE X'2920233030303039373135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 193
* EL6311.cbl
 10174     CALL 'kxdfhei1' USING DFHEIV0
 10175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10176
 10177
 10178
 10179* EXEC CICS READ
 10180*        SET     (ADDRESS OF PENDING-BUSINESS)
 10181*        DATASET (FILE-ID-ERPNDB)
 10182*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10183*        UPDATE
 10184*    END-EXEC.
 10185*    MOVE '&"S        EU         (   #00009719' TO DFHEIV0
 10186     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10187     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10188     MOVE X'2020233030303039373139' TO DFHEIV0(25:11)
 10189     CALL 'kxdfhei1' USING DFHEIV0,
 10190           FILE-ID-ERPNDB,
 10191           DFHEIV20,
 10192           DFHEIV99,
 10193           PI-PREV-CONTROL-PRIMARY,
 10194           DFHEIV99,
 10195           DFHEIV99,
 10196           DFHEIV99
 10197     SET ADDRESS OF PENDING-BUSINESS TO
 10198         DFHEIV20
 10199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10200
 10201
 10202     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 10203        MOVE -1                 TO BMAINTL
 10204        MOVE ER-2197            TO EMI-ERROR
 10205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10206        GO TO 8200-SEND-DATAONLY.
 10207
 10208     IF PB-BILLED-DT NOT = LOW-VALUES
 10209        MOVE -1                 TO BMAINTL
 10210        MOVE ER-2129            TO EMI-ERROR
 10211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10212        GO TO 8200-SEND-DATAONLY.
 10213
 10214     IF PB-CHG-COUNT NOT = ZEROS
 10215        MOVE ER-2336            TO EMI-ERROR
 10216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10217        MOVE AL-UABON            TO BMAINTA
 10218        MOVE -1                  TO BMAINTL
 10219        GO TO 8200-SEND-DATAONLY.
 10220
 10221     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 10222        PB-CHG-COUNT NOT = ZEROS
 10223        MOVE ER-2196             TO EMI-ERROR
 10224        MOVE AL-UABON            TO BMAINTA
 10225        MOVE -1                  TO BMAINTL
 10226        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10227        GO TO 8200-SEND-DATAONLY.
 10228
 10229******************************************************************
 10230*                                                                *
 10231*       DELETE PENDING MAILING ADDRESS RECORDS                   *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 194
* EL6311.cbl
 10232*                                                                *
 10233******************************************************************
 10234
 10235
 10236* EXEC CICS HANDLE CONDITION
 10237*        NOTFND    (1405-DELETE-CERTIFICATE)
 10238*    END-EXEC.
 10239*    MOVE '"$I                   ! * #00009759' TO DFHEIV0
 10240     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10242     MOVE X'2A20233030303039373539' TO DFHEIV0(25:11)
 10243     CALL 'kxdfhei1' USING DFHEIV0
 10244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10245
 10246
 10247
 10248* EXEC CICS READ
 10249*        EQUAL
 10250*        DATASET   (FILE-ID-ERPNDM)
 10251*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 10252*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 10253*        UPDATE
 10254*    END-EXEC.
 10255*    MOVE '&"S        EU         (   #00009763' TO DFHEIV0
 10256     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10257     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10258     MOVE X'2020233030303039373633' TO DFHEIV0(25:11)
 10259     CALL 'kxdfhei1' USING DFHEIV0,
 10260           FILE-ID-ERPNDM,
 10261           DFHEIV20,
 10262           DFHEIV99,
 10263           PI-PREV-CONTROL-PRIMARY,
 10264           DFHEIV99,
 10265           DFHEIV99,
 10266           DFHEIV99
 10267     SET ADDRESS OF PENDING-MAILING-DATA TO
 10268         DFHEIV20
 10269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10270
 10271
 10272     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 10273     MOVE 'D'                    TO  JP-RECORD-TYPE.
 10274     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 10275
 10276     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10277
 10278
 10279* EXEC CICS DELETE
 10280*        DATASET   (FILE-ID-ERPNDM)
 10281*    END-EXEC.
 10282*    MOVE '&(                    &   #00009777' TO DFHEIV0
 10283     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10284     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10285     MOVE X'2020233030303039373737' TO DFHEIV0(25:11)
 10286     CALL 'kxdfhei1' USING DFHEIV0,
 10287           FILE-ID-ERPNDM,
 10288           DFHEIV99,
 10289           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 195
* EL6311.cbl
 10290           DFHEIV99,
 10291           DFHEIV99
 10292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10293
 10294
 10295******************************************************************
 10296*                PROCESS   CERTIFICATE                           *
 10297******************************************************************
 10298
 10299 1405-DELETE-CERTIFICATE.
 10300
 10301* EXEC CICS HANDLE CONDITION
 10302*         NOTFND  (1420-CONTINUE-DELETE)
 10303*    END-EXEC.
 10304*    MOVE '"$I                   ! + #00009786' TO DFHEIV0
 10305     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10307     MOVE X'2B20233030303039373836' TO DFHEIV0(25:11)
 10308     CALL 'kxdfhei1' USING DFHEIV0
 10309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10310
 10311
 10312     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 10313     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 10314     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 10315     MOVE PB-SV-STATE            TO ELCERT-STATE.
 10316
 10317
 10318* EXEC CICS READ
 10319*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 10320*        DATASET (FILE-ID-ELCERT)
 10321*        RIDFLD  (ELCERT-KEY)
 10322*        UPDATE
 10323*    END-EXEC.
 10324*    MOVE '&"S        EU         (   #00009795' TO DFHEIV0
 10325     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10326     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10327     MOVE X'2020233030303039373935' TO DFHEIV0(25:11)
 10328     CALL 'kxdfhei1' USING DFHEIV0,
 10329           FILE-ID-ELCERT,
 10330           DFHEIV20,
 10331           DFHEIV99,
 10332           ELCERT-KEY,
 10333           DFHEIV99,
 10334           DFHEIV99,
 10335           DFHEIV99
 10336     SET ADDRESS OF CERTIFICATE-MASTER TO
 10337         DFHEIV20
 10338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10339
 10340
 10341     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10342
 10343     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 10344     MOVE 'B'                    TO JP-RECORD-TYPE
 10345     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10346
 10347     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 196
* EL6311.cbl
 10348
 10349     IF CERT-NOTES-ARE-NOT-PRESENT
 10350        MOVE ' '                 TO WS-CERT-NOTE-SW
 10351     ELSE
 10352        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 10353
 10354     IF INSURED-ADDR-PRESENT
 10355        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 10356
 10357******************************************************************
 10358******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 10359******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 10360******************************************************************
 10361******************************************************************
 10362
 10363     IF CERT-ADDED-BATCH AND
 10364        (NOT NO-CLAIM-ATTACHED
 10365         OR
 10366         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 10367        GO TO 1410-REWRITE-CERT.
 10368
 10369******************************************************************
 10370******************************************************************
 10371
 10372     IF CERT-ADDED-BATCH  AND
 10373        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 10374        GO TO 1410-REWRITE-CERT.
 10375
 10376     IF NO-CLAIM-ATTACHED
 10377        NEXT SENTENCE
 10378     ELSE
 10379        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 10380        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10381        GO TO 1410-REWRITE-CERT.
 10382
 10383     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 10384     MOVE 'D'                      TO JP-RECORD-TYPE.
 10385     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 10386
 10387
 10388* EXEC CICS DELETE
 10389*         DATASET    (FILE-ID-ELCERT)
 10390*    END-EXEC.
 10391*    MOVE '&(                    &   #00009848' TO DFHEIV0
 10392     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10393     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10394     MOVE X'2020233030303039383438' TO DFHEIV0(25:11)
 10395     CALL 'kxdfhei1' USING DFHEIV0,
 10396           FILE-ID-ELCERT,
 10397           DFHEIV99,
 10398           DFHEIV99,
 10399           DFHEIV99,
 10400           DFHEIV99
 10401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10402
 10403
 10404     PERFORM 8400-LOG-JOURNAL-RECORD.
 10405
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 197
* EL6311.cbl
 10406******************************************************************
 10407*                                                                *
 10408*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 10409*                                                                *
 10410******************************************************************
 10411
 10412     IF  CERT-NOTES-ARE-PRESENT
 10413         NEXT SENTENCE
 10414     ELSE
 10415         GO TO 1407-DELETE-MAILING.
 10416
 10417
 10418* EXEC CICS HANDLE CONDITION
 10419*         NOTFND  (1406-DELETE-ERNOTE)
 10420*    END-EXEC.
 10421*    MOVE '"$I                   ! , #00009865' TO DFHEIV0
 10422     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10424     MOVE X'2C20233030303039383635' TO DFHEIV0(25:11)
 10425     CALL 'kxdfhei1' USING DFHEIV0
 10426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10427
 10428
 10429     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 10430     MOVE '0'                   TO ERCNOT-REC-TYPE.
 10431     MOVE 0                     TO ERCNOT-SEQUENCE.
 10432
 10433 1406-DELETE-ERCNOT-LOOP.
 10434
 10435
 10436* EXEC CICS READ
 10437*        GTEQ
 10438*        DATASET   (FILE-ID-ERCNOT)
 10439*        SET       (ADDRESS OF CERT-NOTE-FILE)
 10440*        RIDFLD    (ERCNOT-KEY)
 10441*    END-EXEC.
 10442*    MOVE '&"S        G          (   #00009875' TO DFHEIV0
 10443     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10445     MOVE X'2020233030303039383735' TO DFHEIV0(25:11)
 10446     CALL 'kxdfhei1' USING DFHEIV0,
 10447           FILE-ID-ERCNOT,
 10448           DFHEIV20,
 10449           DFHEIV99,
 10450           ERCNOT-KEY,
 10451           DFHEIV99,
 10452           DFHEIV99,
 10453           DFHEIV99
 10454     SET ADDRESS OF CERT-NOTE-FILE TO
 10455         DFHEIV20
 10456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10457
 10458
 10459     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 10460     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 10461         GO TO 1406-DELETE-ERNOTE
 10462     END-IF.
 10463
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 198
* EL6311.cbl
 10464     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 10465     MOVE 'D'                    TO  JP-RECORD-TYPE.
 10466     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 10467
 10468     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10469
 10470
 10471* EXEC CICS DELETE
 10472*        DATASET   (FILE-ID-ERCNOT)
 10473*        RIDFLD    (ERCNOT-KEY)
 10474*        END-EXEC.
 10475*    MOVE '&(  R                 &   #00009893' TO DFHEIV0
 10476     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 10477     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10478     MOVE X'2020233030303039383933' TO DFHEIV0(25:11)
 10479     CALL 'kxdfhei1' USING DFHEIV0,
 10480           FILE-ID-ERCNOT,
 10481           ERCNOT-KEY,
 10482           DFHEIV99,
 10483           DFHEIV99,
 10484           DFHEIV99
 10485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10486
 10487
 10488     PERFORM 8400-LOG-JOURNAL-RECORD.
 10489
 10490     GO TO 1406-DELETE-ERCNOT-LOOP.
 10491
 10492 1406-DELETE-ERNOTE.
 10493
 10494
 10495* EXEC CICS HANDLE CONDITION
 10496*         NOTFND  (1407-DELETE-MAILING)
 10497*    END-EXEC.
 10498*    MOVE '"$I                   ! - #00009904' TO DFHEIV0
 10499     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10501     MOVE X'2D20233030303039393034' TO DFHEIV0(25:11)
 10502     CALL 'kxdfhei1' USING DFHEIV0
 10503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10504
 10505
 10506
 10507* EXEC CICS READ
 10508*        EQUAL
 10509*        DATASET   (FILE-ID-ERNOTE)
 10510*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 10511*        RIDFLD    (ELCERT-KEY)
 10512*        UPDATE
 10513*    END-EXEC.
 10514*    MOVE '&"S        EU         (   #00009908' TO DFHEIV0
 10515     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10516     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10517     MOVE X'2020233030303039393038' TO DFHEIV0(25:11)
 10518     CALL 'kxdfhei1' USING DFHEIV0,
 10519           FILE-ID-ERNOTE,
 10520           DFHEIV20,
 10521           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 199
* EL6311.cbl
 10522           ELCERT-KEY,
 10523           DFHEIV99,
 10524           DFHEIV99,
 10525           DFHEIV99
 10526     SET ADDRESS OF CERTIFICATE-NOTE TO
 10527         DFHEIV20
 10528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10529
 10530
 10531     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 10532     MOVE 'D'                    TO  JP-RECORD-TYPE.
 10533     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 10534
 10535     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10536
 10537
 10538* EXEC CICS DELETE
 10539*        DATASET   (FILE-ID-ERNOTE)
 10540*        END-EXEC.
 10541*    MOVE '&(                    &   #00009922' TO DFHEIV0
 10542     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10543     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10544     MOVE X'2020233030303039393232' TO DFHEIV0(25:11)
 10545     CALL 'kxdfhei1' USING DFHEIV0,
 10546           FILE-ID-ERNOTE,
 10547           DFHEIV99,
 10548           DFHEIV99,
 10549           DFHEIV99,
 10550           DFHEIV99
 10551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10552
 10553
 10554     PERFORM 8400-LOG-JOURNAL-RECORD.
 10555
 10556******************************************************************
 10557*                                                                *
 10558*                DELETE MAILING ADDRESS RECORDS                  *
 10559*                                                                *
 10560******************************************************************
 10561
 10562 1407-DELETE-MAILING.
 10563     IF CERT-ADDRESS-PRESENT
 10564        NEXT SENTENCE
 10565     ELSE
 10566        GO TO 1420-CONTINUE-DELETE.
 10567
 10568
 10569* EXEC CICS HANDLE CONDITION
 10570*         NOTFND  (1420-CONTINUE-DELETE)
 10571*    END-EXEC.
 10572*    MOVE '"$I                   ! . #00009940' TO DFHEIV0
 10573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10575     MOVE X'2E20233030303039393430' TO DFHEIV0(25:11)
 10576     CALL 'kxdfhei1' USING DFHEIV0
 10577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10578
 10579
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 200
* EL6311.cbl
 10580
 10581* EXEC CICS READ
 10582*        EQUAL
 10583*        DATASET   (FILE-ID-ERMAIL)
 10584*        SET       (ADDRESS OF MAILING-DATA)
 10585*        RIDFLD    (ELCERT-KEY)
 10586*        UPDATE
 10587*    END-EXEC.
 10588*    MOVE '&"S        EU         (   #00009944' TO DFHEIV0
 10589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10590     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10591     MOVE X'2020233030303039393434' TO DFHEIV0(25:11)
 10592     CALL 'kxdfhei1' USING DFHEIV0,
 10593           FILE-ID-ERMAIL,
 10594           DFHEIV20,
 10595           DFHEIV99,
 10596           ELCERT-KEY,
 10597           DFHEIV99,
 10598           DFHEIV99,
 10599           DFHEIV99
 10600     SET ADDRESS OF MAILING-DATA TO
 10601         DFHEIV20
 10602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10603
 10604
 10605     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 10606     MOVE 'D'                    TO  JP-RECORD-TYPE.
 10607     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 10608
 10609     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10610
 10611
 10612* EXEC CICS DELETE
 10613*        DATASET   (FILE-ID-ERMAIL)
 10614*    END-EXEC.
 10615*    MOVE '&(                    &   #00009958' TO DFHEIV0
 10616     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10617     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10618     MOVE X'2020233030303039393538' TO DFHEIV0(25:11)
 10619     CALL 'kxdfhei1' USING DFHEIV0,
 10620           FILE-ID-ERMAIL,
 10621           DFHEIV99,
 10622           DFHEIV99,
 10623           DFHEIV99,
 10624           DFHEIV99
 10625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10626
 10627
 10628     GO TO 1420-CONTINUE-DELETE.
 10629
 10630 1410-REWRITE-CERT.
 10631     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 10632     MOVE 'C'                      TO JP-RECORD-TYPE.
 10633     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 10634     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 10635
 10636
 10637* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 201
* EL6311.cbl
 10638*         DATASET    (FILE-ID-ELCERT)
 10639*         FROM       (CERTIFICATE-MASTER)
 10640*         END-EXEC.
 10641     MOVE LENGTH OF
 10642      CERTIFICATE-MASTER
 10643       TO DFHEIV11
 10644*    MOVE '&& L                  %   #00009970' TO DFHEIV0
 10645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10647     MOVE X'2020233030303039393730' TO DFHEIV0(25:11)
 10648     CALL 'kxdfhei1' USING DFHEIV0,
 10649           FILE-ID-ELCERT,
 10650           CERTIFICATE-MASTER,
 10651           DFHEIV11,
 10652           DFHEIV99
 10653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10654
 10655
 10656     PERFORM 8400-LOG-JOURNAL-RECORD.
 10657
 10658 1420-CONTINUE-DELETE.
 10659     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 10660     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 10661
 10662     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 10663     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 10664
 10665     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 10666
 10667 1450-DELETE-PB-RECORD.
 10668     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 10669     MOVE 'D'                      TO JP-RECORD-TYPE
 10670     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 10671
 10672
 10673* EXEC CICS DELETE
 10674*        DATASET    (FILE-ID-ERPNDB)
 10675*    END-EXEC.
 10676*    MOVE '&(                    &   #00009991' TO DFHEIV0
 10677     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10678     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10679     MOVE X'2020233030303039393931' TO DFHEIV0(25:11)
 10680     CALL 'kxdfhei1' USING DFHEIV0,
 10681           FILE-ID-ERPNDB,
 10682           DFHEIV99,
 10683           DFHEIV99,
 10684           DFHEIV99,
 10685           DFHEIV99
 10686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10687
 10688
 10689     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10690
 10691     PERFORM 8400-LOG-JOURNAL-RECORD.
 10692
 10693     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10694     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10695     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 202
* EL6311.cbl
 10696
 10697
 10698* EXEC CICS HANDLE CONDITION
 10699*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 10700*    END-EXEC.
 10701*    MOVE '"$I                   ! / #00010003' TO DFHEIV0
 10702     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10704     MOVE X'2F20233030303130303033' TO DFHEIV0(25:11)
 10705     CALL 'kxdfhei1' USING DFHEIV0
 10706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10707
 10708
 10709
 10710* EXEC CICS READ
 10711*        SET     (ADDRESS OF PENDING-BUSINESS)
 10712*        DATASET (FILE-ID-ERPNDB)
 10713*        RIDFLD  (ERPNDB-KEY)
 10714*        UPDATE
 10715*    END-EXEC.
 10716*    MOVE '&"S        EU         (   #00010007' TO DFHEIV0
 10717     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10718     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10719     MOVE X'2020233030303130303037' TO DFHEIV0(25:11)
 10720     CALL 'kxdfhei1' USING DFHEIV0,
 10721           FILE-ID-ERPNDB,
 10722           DFHEIV20,
 10723           DFHEIV99,
 10724           ERPNDB-KEY,
 10725           DFHEIV99,
 10726           DFHEIV99,
 10727           DFHEIV99
 10728     SET ADDRESS OF PENDING-BUSINESS TO
 10729         DFHEIV20
 10730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10731
 10732
 10733     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 10734
 10735     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 10736
 10737     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 10738        WS-B-CANCEL-CNT-ENTERED = ZEROS
 10739        MOVE 'D'                   TO JP-RECORD-TYPE
 10740        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 10741
 10742* EXEC CICS DELETE
 10743*            DATASET    (FILE-ID-ERPNDB)
 10744*       END-EXEC
 10745*    MOVE '&(                    &   #00010022' TO DFHEIV0
 10746     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10747     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10748     MOVE X'2020233030303130303232' TO DFHEIV0(25:11)
 10749     CALL 'kxdfhei1' USING DFHEIV0,
 10750           FILE-ID-ERPNDB,
 10751           DFHEIV99,
 10752           DFHEIV99,
 10753           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 203
* EL6311.cbl
 10754           DFHEIV99
 10755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10756        PERFORM 8400-LOG-JOURNAL-RECORD
 10757     ELSE
 10758        MOVE 'B'                 TO JP-RECORD-TYPE
 10759        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 10760        PERFORM 8400-LOG-JOURNAL-RECORD
 10761        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 10762        MOVE 'C'                 TO JP-RECORD-TYPE
 10763        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 10764
 10765* EXEC CICS REWRITE
 10766*            DATASET    (FILE-ID-ERPNDB)
 10767*            FROM       (PENDING-BUSINESS)
 10768*       END-EXEC
 10769     MOVE LENGTH OF
 10770      PENDING-BUSINESS
 10771       TO DFHEIV11
 10772*    MOVE '&& L                  %   #00010033' TO DFHEIV0
 10773     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10774     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10775     MOVE X'2020233030303130303333' TO DFHEIV0(25:11)
 10776     CALL 'kxdfhei1' USING DFHEIV0,
 10777           FILE-ID-ERPNDB,
 10778           PENDING-BUSINESS,
 10779           DFHEIV11,
 10780           DFHEIV99
 10781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10782        PERFORM 8400-LOG-JOURNAL-RECORD.
 10783
 10784******************************************************************
 10785*                                                                *
 10786*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 10787*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 10788*                                                                *
 10789******************************************************************
 10790
 10791     IF NOT PI-AR-PROCESSING
 10792        GO TO 1475-DELETE-FINISHED.
 10793
 10794     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 10795        WS-B-CANCEL-CNT-ENTERED = ZEROS
 10796        NEXT SENTENCE
 10797     ELSE
 10798        GO TO 1475-DELETE-FINISHED.
 10799
 10800
 10801* EXEC CICS HANDLE CONDITION
 10802*         NOTFND    (1475-DELETE-FINISHED)
 10803*         END-EXEC.
 10804*    MOVE '"$I                   ! 0 #00010055' TO DFHEIV0
 10805     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10807     MOVE X'3020233030303130303535' TO DFHEIV0(25:11)
 10808     CALL 'kxdfhei1' USING DFHEIV0
 10809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10810
 10811
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 204
* EL6311.cbl
 10812     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 10813     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 10814
 10815
 10816* EXEC CICS READ
 10817*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 10818*        DATASET (FILE-ID-ERRQST)
 10819*        RIDFLD  (ERRQST-KEY)
 10820*        UPDATE
 10821*    END-EXEC.
 10822*    MOVE '&"S        EU         (   #00010062' TO DFHEIV0
 10823     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10824     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10825     MOVE X'2020233030303130303632' TO DFHEIV0(25:11)
 10826     CALL 'kxdfhei1' USING DFHEIV0,
 10827           FILE-ID-ERRQST,
 10828           DFHEIV20,
 10829           DFHEIV99,
 10830           ERRQST-KEY,
 10831           DFHEIV99,
 10832           DFHEIV99,
 10833           DFHEIV99
 10834     SET ADDRESS OF AR-REQUEST-RECORD TO
 10835         DFHEIV20
 10836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10837
 10838
 10839     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 10840
 10841     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 10842
 10843     MOVE 'D'                      TO JP-RECORD-TYPE.
 10844     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 10845
 10846
 10847* EXEC CICS DELETE
 10848*         DATASET    (FILE-ID-ERRQST)
 10849*    END-EXEC.
 10850*    MOVE '&(                    &   #00010076' TO DFHEIV0
 10851     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10852     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10853     MOVE X'2020233030303130303736' TO DFHEIV0(25:11)
 10854     CALL 'kxdfhei1' USING DFHEIV0,
 10855           FILE-ID-ERRQST,
 10856           DFHEIV99,
 10857           DFHEIV99,
 10858           DFHEIV99,
 10859           DFHEIV99
 10860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10861
 10862
 10863     PERFORM 8400-LOG-JOURNAL-RECORD.
 10864
 10865 1475-DELETE-FINISHED.
 10866     MOVE ZEROS                  TO EMI-ERROR.
 10867     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10868     MOVE LOW-VALUES             TO EL631BI.
 10869     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 205
* EL6311.cbl
 10870     GO TO 8100-SEND-INITIAL-MAP.
 10871
 10872 1480-BATCH-HDR-NOT-FOUND.
 10873     MOVE -1                     TO BMAINTL.
 10874     MOVE ER-7450                TO EMI-ERROR.
 10875     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10876     GO TO 8200-SEND-DATAONLY.
 10877
 10878 1490-RECORD-NOT-FOUND.
 10879     MOVE -1                     TO BMAINTL.
 10880     MOVE ER-7451                TO EMI-ERROR.
 10881     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10882     GO TO 8200-SEND-DATAONLY.
 10883
 10884******************************************************************
 10885*            O V E R   C H A R G E   P R O C E S S I N G         *
 10886******************************************************************
 10887 1500-UPDATE-ERNOTE.
 10888     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 10889     MOVE 'A'                    TO WS-NOTE-SW
 10890     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 10891     .
 10892 1500-EXIT.
 10893     EXIT.
 10894 1510-ADD-ERNOTE-REC.
 10895
 10896* EXEC CICS GETMAIN
 10897*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 10898*        LENGTH  (ERNOTE-RECORD-LENGTH)
 10899*        INITIMG (GETMAIN-SPACE)
 10900*    END-EXEC
 10901*    MOVE ',"IL                  $   #00010112' TO DFHEIV0
 10902     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10904     MOVE X'2020233030303130313132' TO DFHEIV0(25:11)
 10905     CALL 'kxdfhei1' USING DFHEIV0,
 10906           DFHEIV20,
 10907           ERNOTE-RECORD-LENGTH,
 10908           GETMAIN-SPACE
 10909     SET ADDRESS OF CERTIFICATE-NOTE TO
 10910         DFHEIV20
 10911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10912     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10913                                 TO ERNOTE-KEY
 10914
 10915* EXEC CICS READ
 10916*       DATASET    (FILE-ID-ERNOTE)
 10917*       RIDFLD     (ERNOTE-KEY)
 10918*       INTO       (CERTIFICATE-NOTE)
 10919*       RESP       (WS-RESPONSE)
 10920*       UPDATE
 10921*    END-EXEC
 10922     MOVE LENGTH OF
 10923      CERTIFICATE-NOTE
 10924       TO DFHEIV11
 10925*    MOVE '&"IL       EU         (  N#00010119' TO DFHEIV0
 10926     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10927     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 206
* EL6311.cbl
 10928     MOVE X'204E233030303130313139' TO DFHEIV0(25:11)
 10929     CALL 'kxdfhei1' USING DFHEIV0,
 10930           FILE-ID-ERNOTE,
 10931           CERTIFICATE-NOTE,
 10932           DFHEIV11,
 10933           ERNOTE-KEY,
 10934           DFHEIV99,
 10935           DFHEIV99,
 10936           DFHEIV99
 10937     MOVE EIBRESP  TO WS-RESPONSE
 10938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10939     IF RESP-NORMAL
 10940        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 10941           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 10942        END-IF
 10943        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 10944           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 10945        END-IF
 10946        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 10947           (N1 > +10)
 10948           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 10949           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 10950        END-PERFORM
 10951        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 10952          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 10953
 10954* EXEC CICS UNLOCK
 10955*            DATASET    (FILE-ID-ERNOTE)
 10956*          END-EXEC
 10957*    MOVE '&*                    #   #00010140' TO DFHEIV0
 10958     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10959     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10960     MOVE X'2020233030303130313430' TO DFHEIV0(25:11)
 10961     CALL 'kxdfhei1' USING DFHEIV0,
 10962           FILE-ID-ERNOTE,
 10963           DFHEIV99
 10964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10965        ELSE
 10966          PERFORM VARYING N1 FROM +1 BY +1
 10967           UNTIL (N1 > +10)
 10968           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 10969          END-PERFORM
 10970          IF (N1 < +11)
 10971            IF N1 >= CN-BILLING-START-LINE-NO AND
 10972              N1 <= CN-BILLING-END-LINE-NO
 10973              IF PI-COMPANY-ID = 'DCC'
 10974                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 10975              ELSE
 10976                 MOVE WS-VA-NO-COMM-MESS
 10977                                    TO CN-LINE (N1)
 10978              END-IF
 10979            ELSE
 10980              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 10981               (N1 = (CN-BILLING-END-LINE-NO + +1))
 10982                IF PI-COMPANY-ID = 'DCC'
 10983                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 10984                ELSE
 10985                  MOVE WS-VA-NO-COMM-MESS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 207
* EL6311.cbl
 10986                                    TO CN-LINE (N1)
 10987                END-IF
 10988                MOVE N1             TO CN-BILLING-END-LINE-NO
 10989              ELSE
 10990                IF (CN-BILLING-END-LINE-NO = ZEROS)
 10991                  IF PI-COMPANY-ID = 'DCC'
 10992                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 10993                  ELSE
 10994                     MOVE WS-VA-NO-COMM-MESS
 10995                                    TO CN-LINE (N1)
 10996                  END-IF
 10997                  MOVE N1            TO CN-BILLING-END-LINE-NO
 10998                                      CN-BILLING-START-LINE-NO
 10999                ELSE
 11000                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 11001                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 11002                     IF PI-COMPANY-ID = 'DCC'
 11003                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 11004                     ELSE
 11005                       MOVE WS-VA-NO-COMM-MESS
 11006                                    TO CN-LINE (N1)
 11007                     END-IF
 11008                     MOVE N1         TO CN-BILLING-START-LINE-NO
 11009                  ELSE
 11010                     PERFORM 1700-SQUEEZE-IT-IN
 11011                                 THRU 1700-EXIT
 11012                  END-IF
 11013                END-IF
 11014              END-IF
 11015            END-IF
 11016            MOVE 'E631'              TO CN-LAST-MAINT-USER
 11017            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 11018            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 11019
 11020* EXEC CICS REWRITE
 11021*              DATASET    (FILE-ID-ERNOTE)
 11022*              FROM       (CERTIFICATE-NOTE)
 11023*              RESP       (WS-RESPONSE)
 11024*           END-EXEC
 11025     MOVE LENGTH OF
 11026      CERTIFICATE-NOTE
 11027       TO DFHEIV11
 11028*    MOVE '&& L                  %  N#00010197' TO DFHEIV0
 11029     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11030     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11031     MOVE X'204E233030303130313937' TO DFHEIV0(25:11)
 11032     CALL 'kxdfhei1' USING DFHEIV0,
 11033           FILE-ID-ERNOTE,
 11034           CERTIFICATE-NOTE,
 11035           DFHEIV11,
 11036           DFHEIV99
 11037     MOVE EIBRESP  TO WS-RESPONSE
 11038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11039          END-IF
 11040        END-IF
 11041     ELSE
 11042        MOVE SPACES              TO CERTIFICATE-NOTE
 11043        MOVE 'CN'                TO CN-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 208
* EL6311.cbl
 11044        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11045                                 TO CN-CONTROL-PRIMARY
 11046                                    ERNOTE-KEY
 11047        MOVE 01                  TO CN-BILLING-START-LINE-NO
 11048                                    CN-BILLING-END-LINE-NO
 11049        IF PI-COMPANY-ID = 'DCC'
 11050           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 11051        ELSE
 11052           MOVE WS-VA-NO-COMM-MESS
 11053                                 TO CN-LINE (1)
 11054        END-IF
 11055        MOVE 'E631'              TO CN-LAST-MAINT-USER
 11056        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 11057        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 11058
 11059* EXEC CICS WRITE
 11060*          DATASET    (FILE-ID-ERNOTE)
 11061*          FROM       (CERTIFICATE-NOTE)
 11062*          RIDFLD     (ERNOTE-KEY)
 11063*          RESP       (WS-RESPONSE)
 11064*       END-EXEC
 11065     MOVE LENGTH OF
 11066      CERTIFICATE-NOTE
 11067       TO DFHEIV11
 11068*    MOVE '&$ L                  ''  N#00010221' TO DFHEIV0
 11069     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11070     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11071     MOVE X'204E233030303130323231' TO DFHEIV0(25:11)
 11072     CALL 'kxdfhei1' USING DFHEIV0,
 11073           FILE-ID-ERNOTE,
 11074           CERTIFICATE-NOTE,
 11075           DFHEIV11,
 11076           ERNOTE-KEY,
 11077           DFHEIV99,
 11078           DFHEIV99
 11079     MOVE EIBRESP  TO WS-RESPONSE
 11080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11081     END-IF
 11082     .
 11083 1510-EXIT.
 11084     EXIT.
 11085 1520-UPDATE-ELCERT.
 11086     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11087                                 TO ELCERT-KEY
 11088
 11089* EXEC CICS READ
 11090*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 11091*        DATASET (FILE-ID-ELCERT)
 11092*        RIDFLD  (ELCERT-KEY)
 11093*        UPDATE
 11094*        RESP    (WS-RESPONSE)
 11095*    END-EXEC
 11096*    MOVE '&"S        EU         (  N#00010234' TO DFHEIV0
 11097     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11098     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11099     MOVE X'204E233030303130323334' TO DFHEIV0(25:11)
 11100     CALL 'kxdfhei1' USING DFHEIV0,
 11101           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 209
* EL6311.cbl
 11102           DFHEIV20,
 11103           DFHEIV99,
 11104           ELCERT-KEY,
 11105           DFHEIV99,
 11106           DFHEIV99,
 11107           DFHEIV99
 11108     SET ADDRESS OF CERTIFICATE-MASTER TO
 11109         DFHEIV20
 11110     MOVE EIBRESP  TO WS-RESPONSE
 11111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11112     IF RESP-NORMAL
 11113        IF WS-NOTE-SW = 'A'
 11114           IF CM-NOTE-SW = ' '
 11115              MOVE '2'             TO CM-NOTE-SW
 11116           ELSE
 11117             IF CM-NOTE-SW = '1'
 11118                MOVE '3'           TO CM-NOTE-SW
 11119             ELSE
 11120               IF CM-NOTE-SW = '4'
 11121                  MOVE '6'         TO CM-NOTE-SW
 11122               ELSE
 11123                 IF CM-NOTE-SW = '5'
 11124                    MOVE '7'       TO CM-NOTE-SW
 11125                 END-IF
 11126               END-IF
 11127             END-IF
 11128           END-IF
 11129        ELSE
 11130           IF CM-NOTE-SW = '2'
 11131              MOVE ' '             TO CM-NOTE-SW
 11132           ELSE
 11133             IF CM-NOTE-SW = '3'
 11134                MOVE '1'           TO CM-NOTE-SW
 11135             ELSE
 11136               IF CM-NOTE-SW = '6'
 11137                  MOVE '4'         TO CM-NOTE-SW
 11138               ELSE
 11139                 IF CM-NOTE-SW = '7'
 11140                    MOVE '5'       TO CM-NOTE-SW
 11141                 END-IF
 11142               END-IF
 11143             END-IF
 11144           END-IF
 11145        END-IF
 11146
 11147* EXEC CICS REWRITE
 11148*          DATASET    (FILE-ID-ELCERT)
 11149*          FROM       (CERTIFICATE-MASTER)
 11150*          RESP       (WS-RESPONSE)
 11151*       END-EXEC
 11152     MOVE LENGTH OF
 11153      CERTIFICATE-MASTER
 11154       TO DFHEIV11
 11155*    MOVE '&& L                  %  N#00010275' TO DFHEIV0
 11156     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11157     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11158     MOVE X'204E233030303130323735' TO DFHEIV0(25:11)
 11159     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 210
* EL6311.cbl
 11160           FILE-ID-ELCERT,
 11161           CERTIFICATE-MASTER,
 11162           DFHEIV11,
 11163           DFHEIV99
 11164     MOVE EIBRESP  TO WS-RESPONSE
 11165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11166        IF RESP-NORMAL
 11167           CONTINUE
 11168        ELSE
 11169           MOVE WS-RESPONSE TO EMI-ERROR
 11170           PERFORM 9900-ERROR-FORMAT
 11171                                 THRU 9900-EXIT
 11172           GO TO 8200-SEND-DATAONLY
 11173        END-IF
 11174     ELSE
 11175        MOVE -1                  TO BMAINTL
 11176        MOVE 0249                TO EMI-ERROR
 11177        PERFORM 9900-ERROR-FORMAT
 11178                                 THRU 9900-EXIT
 11179        GO TO 8200-SEND-DATAONLY
 11180     END-IF
 11181     .
 11182 1520-EXIT.
 11183     EXIT.
 11184 1600-UPDATE-ERPYAJ.
 11185     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 11186                                 THRU 1610-EXIT
 11187     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 11188                                 THRU 1620-EXIT
 11189     .
 11190 1600-EXIT.
 11191     EXIT.
 11192 1610-ADD-ERPYAJ-BANK-REC.
 11193
 11194* EXEC CICS GETMAIN
 11195*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 11196*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 11197*        INITIMG (GETMAIN-SPACE)
 11198*    END-EXEC
 11199*    MOVE ',"IL                  $   #00010307' TO DFHEIV0
 11200     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11201     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11202     MOVE X'2020233030303130333037' TO DFHEIV0(25:11)
 11203     CALL 'kxdfhei1' USING DFHEIV0,
 11204           DFHEIV20,
 11205           ERPYAJ-RECORD-LENGTH,
 11206           GETMAIN-SPACE
 11207     SET ADDRESS OF PENDING-PAY-ADJ TO
 11208         DFHEIV20
 11209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11210     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 11211     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 11212     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 11213     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 11214     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 11215     MOVE +10                    TO ERPYAJ-SEQ-NO
 11216     MOVE 'R'                    TO ERPYAJ-TYPE
 11217     IF REVERSAL
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 211
* EL6311.cbl
 11218        MOVE 'C'                 TO ERPYAJ-TYPE
 11219     END-IF
 11220     MOVE SPACES                 TO PENDING-PAY-ADJ
 11221     MOVE 'PY'                   TO PY-RECORD-ID
 11222     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 11223     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 11224     IF REVERSAL
 11225        MOVE PB-I-DCC-OVER-CHG-AMT
 11226                                 TO PY-ENTRY-AMT
 11227     END-IF
 11228     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 11229                                    PY-INPUT-DT
 11230*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 11231*                                   PY-INPUT-DT
 11232     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 11233     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 11234     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 11235     MOVE 'B'                    TO PY-ERCOMP-TYPE
 11236     IF PB-CARRIER = '2'
 11237        MOVE '2725040330'        TO PY-GL-ACCOUNT
 11238     ELSE
 11239        MOVE '2725040130'        TO PY-GL-ACCOUNT
 11240     END-IF
 11241     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 11242                                    PY-BILLED-DATE
 11243                                    PY-AR-DATE
 11244                                    PY-REPORTED-DT
 11245                                    PY-CHECK-WRITTEN-DT
 11246     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 11247                                    PY-CHECK-QUE-SEQUENCE
 11248     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 11249     PERFORM WITH TEST AFTER
 11250        UNTIL (NOT RESP-DUPKEY)
 11251           AND (NOT RESP-DUPREC)
 11252
 11253* EXEC CICS WRITE
 11254*          DATASET    (FILE-ID-ERPYAJ)
 11255*          FROM       (PENDING-PAY-ADJ)
 11256*          RIDFLD     (ERPYAJ-KEY)
 11257*          RESP       (WS-RESPONSE)
 11258*       END-EXEC
 11259     MOVE LENGTH OF
 11260      PENDING-PAY-ADJ
 11261       TO DFHEIV11
 11262*    MOVE '&$ L                  ''  N#00010354' TO DFHEIV0
 11263     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11264     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11265     MOVE X'204E233030303130333534' TO DFHEIV0(25:11)
 11266     CALL 'kxdfhei1' USING DFHEIV0,
 11267           FILE-ID-ERPYAJ,
 11268           PENDING-PAY-ADJ,
 11269           DFHEIV11,
 11270           ERPYAJ-KEY,
 11271           DFHEIV99,
 11272           DFHEIV99
 11273     MOVE EIBRESP  TO WS-RESPONSE
 11274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11275        IF RESP-DUPKEY OR RESP-DUPREC
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 212
* EL6311.cbl
 11276           ADD +1                TO ERPYAJ-SEQ-NO
 11277           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 11278        END-IF
 11279     END-PERFORM
 11280     .
 11281 1610-EXIT.
 11282     EXIT.
 11283 1620-ADD-ERPYAJ-DLR-REC.
 11284     MOVE 'C'                    TO ERPYAJ-TYPE
 11285     IF REVERSAL
 11286        MOVE 'R'                 TO ERPYAJ-TYPE
 11287     END-IF
 11288     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 11289                                    ERPYAJ-ACCOUNT
 11290     ADD +1                      TO ERPYAJ-SEQ-NO
 11291     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 11292     MOVE 'A'                    TO PY-ERCOMP-TYPE
 11293     IF PB-CARRIER = '2'
 11294        MOVE '2725040330'        TO PY-GL-ACCOUNT
 11295     ELSE
 11296        MOVE '2725040130'        TO PY-GL-ACCOUNT
 11297     END-IF
 11298     PERFORM WITH TEST AFTER
 11299        UNTIL (NOT RESP-DUPKEY)
 11300           AND (NOT RESP-DUPREC)
 11301
 11302* EXEC CICS WRITE
 11303*          DATASET    (FILE-ID-ERPYAJ)
 11304*          FROM       (PENDING-PAY-ADJ)
 11305*          RIDFLD     (ERPYAJ-KEY)
 11306*          RESP       (WS-RESPONSE)
 11307*       END-EXEC
 11308     MOVE LENGTH OF
 11309      PENDING-PAY-ADJ
 11310       TO DFHEIV11
 11311*    MOVE '&$ L                  ''  N#00010386' TO DFHEIV0
 11312     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11313     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11314     MOVE X'204E233030303130333836' TO DFHEIV0(25:11)
 11315     CALL 'kxdfhei1' USING DFHEIV0,
 11316           FILE-ID-ERPYAJ,
 11317           PENDING-PAY-ADJ,
 11318           DFHEIV11,
 11319           ERPYAJ-KEY,
 11320           DFHEIV99,
 11321           DFHEIV99
 11322     MOVE EIBRESP  TO WS-RESPONSE
 11323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11324        IF RESP-DUPKEY OR RESP-DUPREC
 11325           ADD +1                TO ERPYAJ-SEQ-NO
 11326           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 11327        END-IF
 11328     END-PERFORM
 11329     .
 11330 1620-EXIT.
 11331     EXIT.
 11332 1700-SQUEEZE-IT-IN.
 11333     IF (N1 > CN-BILLING-END-LINE-NO)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 213
* EL6311.cbl
 11334        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 11335           N1 = +1
 11336           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 11337           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 11338              IF PI-COMPANY-ID = 'DCC'
 11339                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 11340              ELSE
 11341                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 11342              END-IF
 11343              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 11344              MOVE +2 TO N1
 11345           END-IF
 11346        END-PERFORM
 11347     ELSE
 11348        IF (N1 < CN-BILLING-START-LINE-NO)
 11349           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 11350              N1 = +10
 11351              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 11352              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 11353                 IF PI-COMPANY-ID = 'DCC'
 11354                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 11355                 ELSE
 11356                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 11357                 END-IF
 11358                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 11359                 MOVE +9 TO N1
 11360              END-IF
 11361           END-PERFORM
 11362        END-IF
 11363     END-IF
 11364     .
 11365 1700-EXIT.
 11366     EXIT.
 11367 1800-REMOVE-CERT-NOTES.
 11368     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11369                                 TO ERNOTE-KEY
 11370
 11371* EXEC CICS READ
 11372*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 11373*       DATASET    (FILE-ID-ERNOTE)
 11374*       RIDFLD     (ERNOTE-KEY)
 11375*       RESP       (WS-RESPONSE)
 11376*       UPDATE
 11377*    END-EXEC
 11378*    MOVE '&"S        EU         (  N#00010438' TO DFHEIV0
 11379     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11380     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11381     MOVE X'204E233030303130343338' TO DFHEIV0(25:11)
 11382     CALL 'kxdfhei1' USING DFHEIV0,
 11383           FILE-ID-ERNOTE,
 11384           DFHEIV20,
 11385           DFHEIV99,
 11386           ERNOTE-KEY,
 11387           DFHEIV99,
 11388           DFHEIV99,
 11389           DFHEIV99
 11390     SET ADDRESS OF CERTIFICATE-NOTE TO
 11391         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 214
* EL6311.cbl
 11392     MOVE EIBRESP  TO WS-RESPONSE
 11393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11394     IF RESP-NORMAL
 11395        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 11396           (N1 > +10)
 11397           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 11398           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 11399        END-PERFORM
 11400        IF N1 < +11
 11401           MOVE SPACES              TO CN-LINE (N1)
 11402           IF N1 >= CN-BILLING-START-LINE-NO  AND
 11403              N1 <= CN-BILLING-END-LINE-NO
 11404              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 11405              IF CN-BILLING-END-LINE-NO <
 11406                               CN-BILLING-START-LINE-NO
 11407                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 11408                                     CN-BILLING-START-LINE-NO
 11409              END-IF
 11410              PERFORM 1820-SQUEEZE-ERNOTE
 11411                                  THRU 1820-EXIT
 11412           END-IF
 11413           IF CN-LINES = SPACES
 11414
 11415* EXEC CICS DELETE
 11416*                DATASET    (FILE-ID-ERNOTE)
 11417*                RESP       (WS-RESPONSE)
 11418*             END-EXEC
 11419*    MOVE '&(                    &  N#00010465' TO DFHEIV0
 11420     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11422     MOVE X'204E233030303130343635' TO DFHEIV0(25:11)
 11423     CALL 'kxdfhei1' USING DFHEIV0,
 11424           FILE-ID-ERNOTE,
 11425           DFHEIV99,
 11426           DFHEIV99,
 11427           DFHEIV99,
 11428           DFHEIV99
 11429     MOVE EIBRESP  TO WS-RESPONSE
 11430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11431              IF RESP-NORMAL
 11432                 MOVE 'D'        TO WS-NOTE-SW
 11433                 PERFORM 1520-UPDATE-ELCERT
 11434                                 THRU 1520-EXIT
 11435              END-IF
 11436           ELSE
 11437
 11438* EXEC CICS REWRITE
 11439*                DATASET    (FILE-ID-ERNOTE)
 11440*                FROM       (CERTIFICATE-NOTE)
 11441*                RESP       (WS-RESPONSE)
 11442*             END-EXEC
 11443     MOVE LENGTH OF
 11444      CERTIFICATE-NOTE
 11445       TO DFHEIV11
 11446*    MOVE '&& L                  %  N#00010475' TO DFHEIV0
 11447     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11448     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11449     MOVE X'204E233030303130343735' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 215
* EL6311.cbl
 11450     CALL 'kxdfhei1' USING DFHEIV0,
 11451           FILE-ID-ERNOTE,
 11452           CERTIFICATE-NOTE,
 11453           DFHEIV11,
 11454           DFHEIV99
 11455     MOVE EIBRESP  TO WS-RESPONSE
 11456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11457           END-IF
 11458        END-IF
 11459     END-IF
 11460     .
 11461 1800-EXIT.
 11462     EXIT.
 11463 1820-SQUEEZE-ERNOTE.
 11464     MOVE CN-BILLING-START-LINE-NO TO N2
 11465     IF N2 = 0
 11466         MOVE +1                 TO N2
 11467     END-IF
 11468     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 11469        (N1 > +9)
 11470        IF CN-LINE (N1) = SPACES
 11471           MOVE CN-LINE (N1 + +1)
 11472                                 TO CN-LINE (N1)
 11473           MOVE SPACES           TO CN-LINE (N1 + +1)
 11474        END-IF
 11475     END-PERFORM
 11476     .
 11477 1820-EXIT.
 11478     EXIT.
 11479 1900-DELETE-ERPYAJ.
 11480     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 11481     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 11482     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 11483     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 11484     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 11485     MOVE +10                    TO ERPYAJ-SEQ-NO
 11486     MOVE 'R'                    TO ERPYAJ-TYPE
 11487     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 11488
 11489* EXEC CICS STARTBR
 11490*       DATASET    (FILE-ID-ERPYAJ)
 11491*       RIDFLD     (ERPYAJ-KEY)
 11492*       RESP       (WS-RESPONSE)
 11493*    END-EXEC
 11494     MOVE 0
 11495       TO DFHEIV11
 11496*    MOVE '&,         G          &  N#00010511' TO DFHEIV0
 11497     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11498     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11499     MOVE X'204E233030303130353131' TO DFHEIV0(25:11)
 11500     CALL 'kxdfhei1' USING DFHEIV0,
 11501           FILE-ID-ERPYAJ,
 11502           ERPYAJ-KEY,
 11503           DFHEIV99,
 11504           DFHEIV11,
 11505           DFHEIV99
 11506     MOVE EIBRESP  TO WS-RESPONSE
 11507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 216
* EL6311.cbl
 11508     IF RESP-NORMAL
 11509        CONTINUE
 11510     ELSE
 11511        GO TO 1900-GET-DEALER
 11512     END-IF
 11513     .
 11514 1900-READNEXT-ERPYAJ-B.
 11515*  GET THE BANK ERPYAJ RECORD
 11516
 11517* EXEC CICS READNEXT
 11518*       DATASET    (FILE-ID-ERPYAJ)
 11519*       RIDFLD     (ERPYAJ-KEY)
 11520*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 11521*       RESP       (WS-RESPONSE)
 11522*    END-EXEC
 11523     MOVE 0
 11524       TO DFHEIV11
 11525*    MOVE '&.S                   )  N#00010524' TO DFHEIV0
 11526     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11527     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11528     MOVE X'204E233030303130353234' TO DFHEIV0(25:11)
 11529     CALL 'kxdfhei1' USING DFHEIV0,
 11530           FILE-ID-ERPYAJ,
 11531           DFHEIV20,
 11532           DFHEIV99,
 11533           ERPYAJ-KEY,
 11534           DFHEIV99,
 11535           DFHEIV11,
 11536           DFHEIV99,
 11537           DFHEIV99
 11538     SET ADDRESS OF PENDING-PAY-ADJ TO
 11539         DFHEIV20
 11540     MOVE EIBRESP  TO WS-RESPONSE
 11541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11542     IF RESP-NORMAL
 11543        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 11544           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 11545              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 11546                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 11547
 11548* EXEC CICS READ
 11549*                   DATASET    (FILE-ID-ERPYAJ)
 11550*                   RIDFLD     (ERPYAJ-KEY)
 11551*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 11552*                   RESP       (WS-RESPONSE)
 11553*                   UPDATE
 11554*                END-EXEC
 11555*    MOVE '&"S        EU         (  N#00010535' TO DFHEIV0
 11556     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11557     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11558     MOVE X'204E233030303130353335' TO DFHEIV0(25:11)
 11559     CALL 'kxdfhei1' USING DFHEIV0,
 11560           FILE-ID-ERPYAJ,
 11561           DFHEIV20,
 11562           DFHEIV99,
 11563           ERPYAJ-KEY,
 11564           DFHEIV99,
 11565           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 217
* EL6311.cbl
 11566           DFHEIV99
 11567     SET ADDRESS OF PENDING-PAY-ADJ TO
 11568         DFHEIV20
 11569     MOVE EIBRESP  TO WS-RESPONSE
 11570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11571                 IF RESP-NORMAL
 11572
 11573* EXEC CICS DELETE
 11574*                      DATASET   (FILE-ID-ERPYAJ)
 11575*                      RESP      (WS-RESPONSE)
 11576*                   END-EXEC
 11577*    MOVE '&(                    &  N#00010543' TO DFHEIV0
 11578     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11579     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11580     MOVE X'204E233030303130353433' TO DFHEIV0(25:11)
 11581     CALL 'kxdfhei1' USING DFHEIV0,
 11582           FILE-ID-ERPYAJ,
 11583           DFHEIV99,
 11584           DFHEIV99,
 11585           DFHEIV99,
 11586           DFHEIV99
 11587     MOVE EIBRESP  TO WS-RESPONSE
 11588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11589                 END-IF
 11590              ELSE
 11591                 SET REVERSAL    TO TRUE
 11592                 PERFORM 1600-UPDATE-ERPYAJ
 11593                                 THRU 1600-EXIT
 11594                 GO TO 1900-EXIT
 11595              END-IF
 11596           ELSE
 11597              GO TO 1900-READNEXT-ERPYAJ-B
 11598           END-IF
 11599        END-IF
 11600
 11601* EXEC CICS ENDBR
 11602*          DATASET   (FILE-ID-ERPYAJ)
 11603*       END-EXEC
 11604     MOVE 0
 11605       TO DFHEIV11
 11606*    MOVE '&2                    $   #00010558' TO DFHEIV0
 11607     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11608     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11609     MOVE X'2020233030303130353538' TO DFHEIV0(25:11)
 11610     CALL 'kxdfhei1' USING DFHEIV0,
 11611           FILE-ID-ERPYAJ,
 11612           DFHEIV11,
 11613           DFHEIV99
 11614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11615     END-IF
 11616     .
 11617 1900-GET-DEALER.
 11618     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 11619     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 11620     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 11621     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 11622     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 11623     MOVE +10                    TO ERPYAJ-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 218
* EL6311.cbl
 11624     MOVE 'C'                    TO ERPYAJ-TYPE
 11625     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 11626
 11627* EXEC CICS STARTBR
 11628*       DATASET    (FILE-ID-ERPYAJ)
 11629*       RIDFLD     (ERPYAJ-KEY)
 11630*       RESP       (WS-RESPONSE)
 11631*    END-EXEC
 11632     MOVE 0
 11633       TO DFHEIV11
 11634*    MOVE '&,         G          &  N#00010572' TO DFHEIV0
 11635     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11636     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11637     MOVE X'204E233030303130353732' TO DFHEIV0(25:11)
 11638     CALL 'kxdfhei1' USING DFHEIV0,
 11639           FILE-ID-ERPYAJ,
 11640           ERPYAJ-KEY,
 11641           DFHEIV99,
 11642           DFHEIV11,
 11643           DFHEIV99
 11644     MOVE EIBRESP  TO WS-RESPONSE
 11645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11646     IF RESP-NORMAL
 11647        CONTINUE
 11648     ELSE
 11649        GO TO 1900-EXIT
 11650     END-IF
 11651     .
 11652 1900-READNEXT-ERPYAJ-D.
 11653*  GET THE DEALER ERPYAJ RECORD
 11654
 11655* EXEC CICS READNEXT
 11656*       DATASET    (FILE-ID-ERPYAJ)
 11657*       RIDFLD     (ERPYAJ-KEY)
 11658*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 11659*       RESP       (WS-RESPONSE)
 11660*    END-EXEC
 11661     MOVE 0
 11662       TO DFHEIV11
 11663*    MOVE '&.S                   )  N#00010585' TO DFHEIV0
 11664     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11665     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11666     MOVE X'204E233030303130353835' TO DFHEIV0(25:11)
 11667     CALL 'kxdfhei1' USING DFHEIV0,
 11668           FILE-ID-ERPYAJ,
 11669           DFHEIV20,
 11670           DFHEIV99,
 11671           ERPYAJ-KEY,
 11672           DFHEIV99,
 11673           DFHEIV11,
 11674           DFHEIV99,
 11675           DFHEIV99
 11676     SET ADDRESS OF PENDING-PAY-ADJ TO
 11677         DFHEIV20
 11678     MOVE EIBRESP  TO WS-RESPONSE
 11679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11680     IF RESP-NORMAL
 11681        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 219
* EL6311.cbl
 11682           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 11683              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 11684                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 11685
 11686* EXEC CICS READ
 11687*                   DATASET    (FILE-ID-ERPYAJ)
 11688*                   RIDFLD     (ERPYAJ-KEY)
 11689*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 11690*                   RESP       (WS-RESPONSE)
 11691*                   UPDATE
 11692*                END-EXEC
 11693*    MOVE '&"S        EU         (  N#00010596' TO DFHEIV0
 11694     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11695     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11696     MOVE X'204E233030303130353936' TO DFHEIV0(25:11)
 11697     CALL 'kxdfhei1' USING DFHEIV0,
 11698           FILE-ID-ERPYAJ,
 11699           DFHEIV20,
 11700           DFHEIV99,
 11701           ERPYAJ-KEY,
 11702           DFHEIV99,
 11703           DFHEIV99,
 11704           DFHEIV99
 11705     SET ADDRESS OF PENDING-PAY-ADJ TO
 11706         DFHEIV20
 11707     MOVE EIBRESP  TO WS-RESPONSE
 11708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11709                 IF RESP-NORMAL
 11710
 11711* EXEC CICS DELETE
 11712*                      DATASET   (FILE-ID-ERPYAJ)
 11713*                      RESP      (WS-RESPONSE)
 11714*                   END-EXEC
 11715*    MOVE '&(                    &  N#00010604' TO DFHEIV0
 11716     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11717     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11718     MOVE X'204E233030303130363034' TO DFHEIV0(25:11)
 11719     CALL 'kxdfhei1' USING DFHEIV0,
 11720           FILE-ID-ERPYAJ,
 11721           DFHEIV99,
 11722           DFHEIV99,
 11723           DFHEIV99,
 11724           DFHEIV99
 11725     MOVE EIBRESP  TO WS-RESPONSE
 11726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11727                 END-IF
 11728              ELSE
 11729                 SET REVERSAL    TO TRUE
 11730              END-IF
 11731           ELSE
 11732              GO TO 1900-READNEXT-ERPYAJ-D
 11733           END-IF
 11734        END-IF
 11735
 11736* EXEC CICS ENDBR
 11737*          DATASET   (FILE-ID-ERPYAJ)
 11738*       END-EXEC
 11739     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 220
* EL6311.cbl
 11740       TO DFHEIV11
 11741*    MOVE '&2                    $   #00010616' TO DFHEIV0
 11742     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11743     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11744     MOVE X'2020233030303130363136' TO DFHEIV0(25:11)
 11745     CALL 'kxdfhei1' USING DFHEIV0,
 11746           FILE-ID-ERPYAJ,
 11747           DFHEIV11,
 11748           DFHEIV99
 11749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11750     END-IF
 11751     .
 11752 1900-EXIT.
 11753     EXIT.
 11754******************************************************************
 11755*            C A N C E L   M A I N L I N E                       *
 11756******************************************************************
 11757
 11758 2000-CANCEL-MAINLINE.
 11759     IF PI-DISPLAY-ORIGINAL-BATCH
 11760        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 11761           MOVE ER-0023             TO EMI-ERROR
 11762           MOVE -1                  TO CMAINTL
 11763           MOVE AL-UABON            TO CMAINTA
 11764           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11765           GO TO 8200-SEND-DATAONLY
 11766        ELSE
 11767           NEXT SENTENCE
 11768     ELSE
 11769        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 11770           MOVE ER-0023             TO EMI-ERROR
 11771           MOVE -1                  TO CMAINTL
 11772           MOVE AL-UABON            TO CMAINTA
 11773           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11774           GO TO 8200-SEND-DATAONLY.
 11775
 11776     IF CMAINTI = 'S'
 11777        GO TO 2100-SHOW-REQUEST.
 11778
 11779     IF NOT MODIFY-CAP
 11780         MOVE 'UPDATE'       TO SM-READ
 11781         PERFORM 9995-SECURITY-VIOLATION
 11782         MOVE ER-0070        TO EMI-ERROR
 11783         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11784         GO TO 8100-SEND-INITIAL-MAP.
 11785
 11786     IF CMAINTL GREATER THAN ZEROS
 11787        IF PI-PF6-FUNCTION
 11788           IF CMAINTI NOT = 'A'
 11789              MOVE AL-UABON  TO CMAINTA
 11790              MOVE -1        TO CMAINTL
 11791              MOVE ER-2260   TO EMI-ERROR
 11792              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11793              GO TO 8200-SEND-DATAONLY.
 11794
 11795     IF CCERTNOL = ZEROS
 11796       AND (CMAINTI = 'C' OR 'K' OR 'D')
 11797         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 221
* EL6311.cbl
 11798     ELSE
 11799         IF CCERTNOL NOT = ZEROS
 11800             MOVE AL-UANON       TO CCERTNOA
 11801         ELSE
 11802             MOVE -1             TO CCERTNOL
 11803             MOVE  1             TO SET-CURSOR-SW
 11804             MOVE ER-2218       TO EMI-ERROR
 11805             MOVE AL-UABON       TO CCERTNOA
 11806             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11807
 11808     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 11809        NEXT SENTENCE
 11810     ELSE
 11811        IF CEFFDTL NOT = ZEROS
 11812           MOVE AL-UNNON         TO CEFFDTA
 11813           MOVE CEFFDTI TO DEEDIT-FIELD
 11814           PERFORM 8600-DEEDIT
 11815           MOVE 4                TO DC-OPTION-CODE
 11816           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 11817           PERFORM 9700-DATE-LINK
 11818           IF NO-CONVERSION-ERROR
 11819              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 11820              ELSE
 11821              MOVE -1            TO CEFFDTL
 11822              MOVE  1            TO SET-CURSOR-SW
 11823              MOVE ER-2226      TO EMI-ERROR
 11824              MOVE AL-UNBON      TO CEFFDTA
 11825              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11826          ELSE
 11827          MOVE -1                 TO CEFFDTL
 11828          MOVE  1                 TO SET-CURSOR-SW
 11829          MOVE ER-2220            TO EMI-ERROR
 11830          MOVE AL-UNBON           TO CEFFDTA
 11831          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11832
 11833     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 11834
 11835     IF CCERTNOL NOT = ZEROS
 11836        MOVE CCERTNOI                TO WS-NEW-PRIME
 11837     ELSE
 11838        MOVE SPACES                  TO WS-NEW-PRIME.
 11839
 11840     IF CSUFIXL NOT = ZEROS
 11841        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 11842     ELSE
 11843        MOVE SPACE                   TO WS-NEW-SUFFIX.
 11844
 11845     IF CEFFDTL NOT = ZEROS
 11846        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 11847     ELSE
 11848        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 11849
 11850     IF CMAINTI = 'A' OR 'K' OR 'S'
 11851        NEXT SENTENCE
 11852     ELSE
 11853        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 11854        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 11855           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 222
* EL6311.cbl
 11856           WS-PB-RECORD-TYPE NOT = '2'
 11857           IF CMAINTI = 'C'
 11858              MOVE ER-2287          TO EMI-ERROR
 11859              MOVE -1               TO CCERTNOL
 11860              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 11861              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11862              GO TO 8200-SEND-DATAONLY
 11863             ELSE
 11864              MOVE ER-2260          TO EMI-ERROR
 11865              MOVE -1               TO CCERTNOL
 11866              MOVE AL-UABON         TO CCERTNOA
 11867              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11868              GO TO 8200-SEND-DATAONLY.
 11869
 11870     IF CMAINTI = 'D'
 11871        GO TO 2400-DELETE-CANCEL-ROUTINE.
 11872
 11873     IF CLSTNML GREATER THAN ZEROS
 11874         MOVE AL-UANON           TO CLSTNMA.
 11875
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 223
* EL6311.cbl
 11877
 11878******************************************************************
 11879*                                                                *
 11880*           E D I T   C A N C E L   C O V E R A G E S            *
 11881*                                                                *
 11882******************************************************************
 11883
 11884 2015-EDIT-COVERAGES.
 11885     IF CCANDT1L      GREATER THAN ZEROS OR
 11886        CREFND1L      GREATER THAN ZEROS OR
 11887        CCANDT2L      GREATER THAN ZEROS OR
 11888        CREFND2L      GREATER THAN ZEROS OR
 11889        CMTHD1L       GREATER THAN ZEROS OR
 11890        CMTHD2L       GREATER THAN ZEROS OR
 11891        CLIVESL       GREATER THAN ZEROS OR
 11892        CPAYEEL       GREATER THAN ZEROS OR
 11893        CFORCEL       GREATER THAN ZEROS OR
 11894        CBILCDL       GREATER THAN ZEROS
 11895            NEXT SENTENCE
 11896         ELSE
 11897            GO TO 2030-EDIT-COMPLETE.
 11898
 11899     IF CCANDT1L = ZEROS
 11900        AND (CMAINTI = 'C' OR 'K')
 11901        NEXT SENTENCE
 11902     ELSE
 11903        IF CCANDT1L      GREATER THAN ZEROS
 11904            MOVE AL-UNNON            TO CCANDT1A
 11905            IF CCANDT1I = SPACES
 11906               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 11907            ELSE
 11908               MOVE CCANDT1I            TO DEEDIT-FIELD
 11909               PERFORM 8600-DEEDIT
 11910               IF DEEDIT-FIELD-V0   NUMERIC
 11911                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 11912                  MOVE 4                TO DC-OPTION-CODE
 11913                  PERFORM 9700-DATE-LINK
 11914                  IF NO-CONVERSION-ERROR
 11915                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 11916                  ELSE
 11917                      MOVE -1        TO CCANDT1L
 11918                      MOVE ER-2227   TO EMI-ERROR
 11919                      MOVE AL-UNBON  TO CCANDT1A
 11920                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11921               ELSE
 11922                  MOVE -1         TO CCANDT1L
 11923                  MOVE ER-2223    TO EMI-ERROR
 11924                  MOVE AL-UNBON   TO CCANDT1A
 11925                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11926        ELSE
 11927            IF CREFND1L GREATER THAN ZEROS
 11928               MOVE -1             TO CCANDT1L
 11929               MOVE ER-2222        TO EMI-ERROR
 11930               MOVE AL-UNBOF       TO CCANDT1A
 11931               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11932
 11933     IF CREFND1L = ZEROS
 11934        AND (CMAINTI = 'C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 224
* EL6311.cbl
 11935         NEXT SENTENCE
 11936     ELSE
 11937         IF CREFND1L NOT = ZEROS
 11938            MOVE AL-UNNON        TO CREFND1A
 11939
 11940* EXEC CICS BIF DEEDIT
 11941*               FIELD  (CREFND1I)
 11942*               LENGTH (11)
 11943*           END-EXEC
 11944     MOVE 11
 11945       TO DFHEIV11
 11946*    MOVE '@"L                   #   #00010808' TO DFHEIV0
 11947     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 11948     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11949     MOVE X'2020233030303130383038' TO DFHEIV0(25:11)
 11950     CALL 'kxdfhei1' USING DFHEIV0,
 11951           CREFND1I,
 11952           DFHEIV11
 11953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11954            MOVE CREFND1I        TO WS-CREFND1
 11955*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 11956*           PERFORM 8600-DEEDIT
 11957*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 11958            IF WS-CREFND1  = ZEROS
 11959               AND CMAINTI = 'A'
 11960             MOVE ER-2437        TO EMI-ERROR
 11961             MOVE -1             TO CREFND1L
 11962             MOVE AL-UNBON       TO CREFND1A
 11963             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11964
 11965     IF CMTHD1L EQUAL +0
 11966        NEXT SENTENCE
 11967     ELSE
 11968        IF CMTHD1L NOT = +0
 11969           MOVE AL-UNNON        TO CMTHD1A
 11970           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 11971                         OR '5' OR '6' OR '8' OR '9'
 11972                         OR 'R' OR ' '
 11973              NEXT SENTENCE
 11974           ELSE
 11975              MOVE ER-0582        TO EMI-ERROR
 11976              MOVE -1             TO CMTHD1L
 11977              MOVE AL-UNBON       TO CMTHD1A
 11978              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11979
 11980     IF CCANDT2L = ZEROS
 11981        AND (CMAINTI = 'C' OR 'K')
 11982         NEXT SENTENCE
 11983     ELSE
 11984         IF CCANDT2L  GREATER THAN ZEROS
 11985             MOVE AL-UNNON       TO CCANDT2A
 11986             IF CCANDT2I = SPACES
 11987                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 11988             ELSE
 11989                MOVE CCANDT2I       TO DEEDIT-FIELD
 11990                PERFORM 8600-DEEDIT
 11991                IF DEEDIT-FIELD-V0   NUMERIC
 11992                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 225
* EL6311.cbl
 11993                   MOVE 4                TO DC-OPTION-CODE
 11994                   PERFORM 9700-DATE-LINK
 11995                   IF NO-CONVERSION-ERROR
 11996                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 11997                   ELSE
 11998                      MOVE -1       TO CCANDT2L
 11999                      MOVE ER-2227  TO EMI-ERROR
 12000                      MOVE AL-UNBON TO CCANDT2A
 12001                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12002                ELSE
 12003                   MOVE -1         TO CCANDT2L
 12004                   MOVE ER-2223    TO EMI-ERROR
 12005                   MOVE AL-UNBON   TO CCANDT2A
 12006                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12007         ELSE
 12008            IF CREFND2L GREATER THAN ZEROS
 12009               MOVE -1             TO CCANDT2L
 12010               MOVE ER-2222        TO EMI-ERROR
 12011               MOVE AL-UNBOF       TO CCANDT2A
 12012               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12013
 12014     IF CREFND2L = ZEROS
 12015        AND (CMAINTI = 'C' OR 'K')
 12016         NEXT SENTENCE
 12017     ELSE
 12018         IF CREFND2L NOT = ZEROS
 12019            MOVE AL-UNNON        TO CREFND2A
 12020
 12021* EXEC CICS BIF DEEDIT
 12022*               FIELD  (CREFND2I)
 12023*               LENGTH (11)
 12024*           END-EXEC
 12025     MOVE 11
 12026       TO DFHEIV11
 12027*    MOVE '@"L                   #   #00010878' TO DFHEIV0
 12028     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12030     MOVE X'2020233030303130383738' TO DFHEIV0(25:11)
 12031     CALL 'kxdfhei1' USING DFHEIV0,
 12032           CREFND2I,
 12033           DFHEIV11
 12034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12035            MOVE CREFND2I        TO WS-CREFND2
 12036*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 12037*           PERFORM 8600-DEEDIT
 12038*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
 12039            IF WS-CREFND2  = ZEROS
 12040               AND CMAINTI = 'A'
 12041             MOVE ER-2437        TO EMI-ERROR
 12042             MOVE -1             TO CREFND2L
 12043             MOVE AL-UNBON       TO CREFND2A
 12044             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12045
 12046     IF CMTHD2L EQUAL +0
 12047        NEXT SENTENCE
 12048     ELSE
 12049        IF CMTHD2L NOT = +0
 12050           MOVE AL-UNNON        TO CMTHD2A
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 226
* EL6311.cbl
 12051           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 12052                         OR '5' OR '6' OR '8' OR '9'
 12053                         OR ' ' OR 'R'
 12054              NEXT SENTENCE
 12055           ELSE
 12056              MOVE ER-0582        TO EMI-ERROR
 12057              MOVE -1             TO CMTHD2L
 12058              MOVE AL-UNBON       TO CMTHD2A
 12059              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12060
 12061     IF CLIVESL GREATER THAN ZEROS
 12062         MOVE CLIVESI            TO DEEDIT-FIELD
 12063         PERFORM 8600-DEEDIT
 12064         IF DEEDIT-FIELD-V0 NUMERIC
 12065             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 12066             MOVE AL-UNNON       TO CLIVESA
 12067         ELSE
 12068             MOVE -1             TO CLIVESL
 12069             MOVE AL-UNBON       TO CLIVESA
 12070             MOVE ER-2223        TO EMI-ERROR
 12071             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12072
 12073     IF CFORCEL  NOT = ZEROS
 12074         IF FORCE-CAP
 12075            MOVE AL-UANON            TO CFORCEA
 12076         ELSE
 12077            MOVE ER-2945             TO EMI-ERROR
 12078            MOVE AL-UABON            TO CFORCEA
 12079            MOVE -1                  TO CFORCEL
 12080            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12081
 12082     IF CPAYEEL GREATER THAN ZEROS
 12083        MOVE AL-UANON            TO CPAYEEA.
 12084
 12085     IF CBILCDL NOT = ZEROS
 12086        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 12087                             AND 'A' AND 'B' AND 'E'
 12088           MOVE ER-2225              TO EMI-ERROR
 12089           MOVE AL-UABON             TO CBILCDA
 12090           MOVE -1                   TO CBILCDL
 12091           MOVE  1                   TO SET-CURSOR-SW
 12092           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12093        ELSE
 12094           MOVE AL-UANON             TO CBILCDA.
 12095
 12096 2030-EDIT-COMPLETE.
 12097     IF EMI-ERROR = ZEROS
 12098         NEXT SENTENCE
 12099     ELSE
 12100         GO TO 8200-SEND-DATAONLY.
 12101
 12102     IF CMAINTI = 'A'
 12103        GO TO 2200-ADD-CANCEL-ROUTINE.
 12104
 12105     IF CMAINTI = 'C'
 12106        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 12107
 12108     GO TO 2900-REWRITE-CAN-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 227
* EL6311.cbl
 12109
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 228
* EL6311.cbl
 12111
 12112******************************************************************
 12113*                                                                *
 12114*                   S H O W   C A N C E L                        *
 12115*                                                                *
 12116******************************************************************
 12117
 12118 2100-SHOW-REQUEST.
 12119     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 12120
 12121     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 12122        MOVE -1                  TO CMAINTL
 12123        GO TO 8200-SEND-DATAONLY.
 12124
 12125     MOVE CCERTNOI            TO WS-NEW-PRIME.
 12126
 12127     IF CSUFIXL NOT = ZEROS
 12128        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 12129       ELSE
 12130        MOVE SPACE            TO WS-NEW-SUFFIX.
 12131
 12132     MOVE CEFFDTI                TO DEEDIT-FIELD.
 12133     PERFORM 8600-DEEDIT.
 12134     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12135     MOVE '4'                    TO DC-OPTION-CODE.
 12136     PERFORM 9700-DATE-LINK.
 12137     IF DATE-CONVERSION-ERROR
 12138        MOVE ER-0348             TO EMI-ERROR
 12139        MOVE -1                  TO CEFFDTL
 12140        MOVE AL-UABON            TO CEFFDTA
 12141        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12142        GO TO 8200-SEND-DATAONLY
 12143     ELSE
 12144        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 12145        MOVE AL-UANON            TO CEFFDTA
 12146        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12147
 12148     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 12149
 12150     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 12151        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 12152        MOVE 'Y'                    TO WS-SHOW-SW
 12153        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 12154           GO TO 4100-BROWSE-PRIMARY-FORWARD
 12155        ELSE
 12156           IF PI-FILE-BROWSE
 12157              GO TO 4300-BROWSE-FILE-FORWARD
 12158           ELSE
 12159              IF PI-CSR-BROWSE
 12160                 GO TO 4200-BROWSE-CSR-FORWARD
 12161              ELSE
 12162                 GO TO 4000-BROWSE-DETAIL-FORWARD
 12163     ELSE
 12164        GO TO 3900-RE-DISPLAY-RECORD.
 12165
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 229
* EL6311.cbl
 12167
 12168
 12169******************************************************************
 12170*                                                                *
 12171*            A D D   C A N C E L   R O U T I N E                 *
 12172*                                                                *
 12173******************************************************************
 12174
 12175 2200-ADD-CANCEL-ROUTINE.
 12176     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 12177
 12178
 12179* EXEC CICS GETMAIN
 12180*        SET     (ADDRESS OF PENDING-BUSINESS)
 12181*        LENGTH  (ERPNDB-RECORD-LENGTH)
 12182*    END-EXEC.
 12183*    MOVE '," L                  $   #00011025' TO DFHEIV0
 12184     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12185     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12186     MOVE X'2020233030303131303235' TO DFHEIV0(25:11)
 12187     CALL 'kxdfhei1' USING DFHEIV0,
 12188           DFHEIV20,
 12189           ERPNDB-RECORD-LENGTH,
 12190           DFHEIV99
 12191     SET ADDRESS OF PENDING-BUSINESS TO
 12192         DFHEIV20
 12193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12194
 12195
 12196
 12197* EXEC CICS HANDLE CONDITION
 12198*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 12199*    END-EXEC.
 12200*    MOVE '"$I                   ! 1 #00011030' TO DFHEIV0
 12201     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12203     MOVE X'3120233030303131303330' TO DFHEIV0(25:11)
 12204     CALL 'kxdfhei1' USING DFHEIV0
 12205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12206
 12207
 12208     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 12209     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12210     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12211
 12212
 12213* EXEC CICS READ
 12214*        INTO    (PENDING-BUSINESS)
 12215*        DATASET (FILE-ID-ERPNDB)
 12216*        RIDFLD  (ERPNDB-KEY)
 12217*    END-EXEC.
 12218     MOVE LENGTH OF
 12219      PENDING-BUSINESS
 12220       TO DFHEIV11
 12221*    MOVE '&"IL       E          (   #00011038' TO DFHEIV0
 12222     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12224     MOVE X'2020233030303131303338' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 230
* EL6311.cbl
 12225     CALL 'kxdfhei1' USING DFHEIV0,
 12226           FILE-ID-ERPNDB,
 12227           PENDING-BUSINESS,
 12228           DFHEIV11,
 12229           ERPNDB-KEY,
 12230           DFHEIV99,
 12231           DFHEIV99,
 12232           DFHEIV99
 12233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12234
 12235
 12236     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 12237
 12238     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12239     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 12240     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 12241     MOVE SPACES                 TO PENDING-BUSINESS.
 12242     MOVE 'PB'                   TO PB-RECORD-ID.
 12243     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 12244     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 12245     MOVE SPACES                 TO PB-CERT-SFX.
 12246     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 12247     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 12248                                    PB-ALT-CHG-SEQ-NO.
 12249
 12250     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 12251     MOVE CCERTNOI               TO PB-CERT-PRIME.
 12252     MOVE '2'                    TO PB-RECORD-TYPE.
 12253
 12254     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 12255     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 12256
 12257
 12258     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 12259                                    PB-ALT-CHG-SEQ-NO
 12260                                    PB-C-LF-REF-CALC
 12261                                    PB-C-AH-REF-CALC
 12262                                    PB-CI-INSURED-AGE
 12263                                    PB-CI-LF-TERM
 12264                                    PB-CI-AH-TERM
 12265                                    PB-CI-LF-BENEFIT-CD
 12266                                    PB-CI-LF-BENEFIT-AMT
 12267                                    PB-CI-LF-ALT-BENEFIT-AMT
 12268                                    PB-CI-LF-PREMIUM-AMT
 12269                                    PB-CI-LF-ALT-PREMIUM-AMT
 12270                                    PB-CI-AH-BENEFIT-CD
 12271                                    PB-CI-AH-BENEFIT-AMT
 12272                                    PB-CI-AH-PREMIUM-AMT
 12273                                    PB-CI-PAY-FREQUENCY
 12274                                    PB-CI-LOAN-APR
 12275                                    PB-CI-LOAN-TERM
 12276                                    PB-CI-LIFE-COMMISSION
 12277                                    PB-CI-AH-COMMISSION
 12278                                    PB-CI-CURR-SEQ
 12279                                    PB-CI-AH-CANCEL-AMT
 12280                                    PB-CI-LF-CANCEL-AMT
 12281                                    PB-CI-RATE-DEV-PCT-LF
 12282                                    PB-CI-RATE-DEV-PCT-AH
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 231
* EL6311.cbl
 12283                                    PB-CI-EXTENTION-DAYS
 12284                                    PB-CI-TERM-IN-DAYS
 12285                                    PB-CI-LIVES
 12286                                    PB-CI-LF-CRIT-PER
 12287                                    PB-CI-AH-CRIT-PER
 12288                                    PB-C-LF-REM-TERM
 12289                                    PB-C-AH-REM-TERM
 12290                                    PB-CHG-COUNT
 12291                                    PB-LF-BILLED-AMTS
 12292                                    PB-AH-BILLED-AMTS
 12293                                    PB-C-NH-INT-ON-REFS
 12294*                                   PB-C-MICROFILM-NO
 12295                                    PB-CALC-TOLERANCE.
 12296
 12297     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 12298                                    PB-CI-AH-SETTLEMENT-DT
 12299                                    PB-CI-DEATH-DT
 12300                                    PB-CI-LF-PRIOR-CANCEL-DT
 12301                                    PB-CI-AH-PRIOR-CANCEL-DT
 12302                                    PB-CI-ENTRY-DT
 12303                                    PB-CI-LF-EXPIRE-DT
 12304                                    PB-CI-AH-EXPIRE-DT
 12305                                    PB-CI-LOAN-1ST-PMT-DT
 12306                                    PB-C-LF-CANCEL-DT
 12307                                    PB-C-AH-CANCEL-DT
 12308                                    PB-CREDIT-ACCEPT-DT
 12309                                    PB-BILLED-DT
 12310                                    PB-ACCT-EFF-DT
 12311                                    PB-ACCT-EXP-DT.
 12312
 12313     MOVE 'X'                    TO PB-FATAL-FLAG.
 12314
 12315     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 12316
 12317     IF CSUFIXL     GREATER THAN ZEROS
 12318        MOVE CSUFIXI             TO PB-CERT-SFX.
 12319
 12320*    IF CMICRNOL  GREATER  ZEROS
 12321*        IF CMICRNOI  NUMERIC
 12322*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 12323*            MOVE AL-UNNON       TO  CMICRNOA
 12324*        ELSE
 12325*            MOVE -1             TO  CMICRNOL
 12326*            MOVE AL-UNBON       TO  CMICRNOA
 12327*            MOVE ER-2701        TO  EMI-ERROR
 12328*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12329
 12330     IF CLSTNML     GREATER THAN ZEROS
 12331        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 12332
 12333     IF CPCYNL > ZEROS
 12334        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 12335     END-IF
 12336     IF CCANDT1L    GREATER THAN ZEROS
 12337        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 12338
 12339     IF CCANDT2L    GREATER THAN ZEROS
 12340        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 232
* EL6311.cbl
 12341
 12342     IF CMTHD1L    GREATER THAN +0
 12343        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 12344
 12345     IF CMTHD2L    GREATER THAN +0
 12346        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 12347
 12348     IF CREFND1L    GREATER THAN ZEROS
 12349        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 12350        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 12351     ELSE
 12352        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 12353
 12354     IF CREFND2L    GREATER THAN ZEROS
 12355        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 12356        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 12357     ELSE
 12358        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 12359
 12360     IF CLIVESL     GREATER THAN ZEROS
 12361        MOVE WS-CLIVES           TO PB-C-LIVES
 12362     ELSE
 12363        MOVE ZEROS               TO PB-C-LIVES.
 12364
 12365     IF CPAYEEL     GREATER THAN ZEROS
 12366        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 12367
 12368     IF CFORCEL     GREATER THAN ZEROS
 12369        MOVE CFORCEI             TO PB-FORCE-CODE.
 12370
 12371     IF CBILCDL     GREATER THAN ZEROS
 12372        MOVE CBILCDI             TO PB-RECORD-BILL.
 12373
 12374*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 12375
 12376 2260-WRITE-PB-RECORD.
 12377     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 12378                                    PB-INPUT-BY.
 12379     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12380     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 12381                                    PB-INPUT-DT.
 12382
 12383     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12384     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 12385                                    PB-CONTROL-BY-ORIG-BATCH.
 12386
 12387     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 12388     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 12389     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 12390     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 12391     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 12392
 12393     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12394
 12395     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12396
 12397     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12398     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 233
* EL6311.cbl
 12399     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12400
 12401     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 12402     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 12403
 12404 2275-WRITE-PENDING-BUSINESS.
 12405     MOVE 'A'                    TO JP-RECORD-TYPE.
 12406     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12407     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12408     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12409
 12410
 12411* EXEC CICS HANDLE CONDITION
 12412*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 12413*    END-EXEC.
 12414*    MOVE '"$%                   ! 2 #00011218' TO DFHEIV0
 12415     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12417     MOVE X'3220233030303131323138' TO DFHEIV0(25:11)
 12418     CALL 'kxdfhei1' USING DFHEIV0
 12419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12420
 12421
 12422
 12423* EXEC CICS WRITE
 12424*        DATASET (FILE-ID-ERPNDB)
 12425*        FROM    (PENDING-BUSINESS)
 12426*        RIDFLD  (PB-CONTROL-PRIMARY)
 12427*    END-EXEC.
 12428     MOVE LENGTH OF
 12429      PENDING-BUSINESS
 12430       TO DFHEIV11
 12431*    MOVE '&$ L                  ''   #00011222' TO DFHEIV0
 12432     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12433     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12434     MOVE X'2020233030303131323232' TO DFHEIV0(25:11)
 12435     CALL 'kxdfhei1' USING DFHEIV0,
 12436           FILE-ID-ERPNDB,
 12437           PENDING-BUSINESS,
 12438           DFHEIV11,
 12439           PB-CONTROL-PRIMARY,
 12440           DFHEIV99,
 12441           DFHEIV99
 12442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12443
 12444
 12445     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 12446
 12447     PERFORM 8400-LOG-JOURNAL-RECORD.
 12448
 12449******************************************************************
 12450*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12451******************************************************************
 12452
 12453
 12454* EXEC CICS READ
 12455*        INTO    (PENDING-BUSINESS)
 12456*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 234
* EL6311.cbl
 12457*        RIDFLD  (ERPNDB-KEY)
 12458*        UPDATE
 12459*    END-EXEC.
 12460     MOVE LENGTH OF
 12461      PENDING-BUSINESS
 12462       TO DFHEIV11
 12463*    MOVE '&"IL       EU         (   #00011236' TO DFHEIV0
 12464     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12465     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12466     MOVE X'2020233030303131323336' TO DFHEIV0(25:11)
 12467     CALL 'kxdfhei1' USING DFHEIV0,
 12468           FILE-ID-ERPNDB,
 12469           PENDING-BUSINESS,
 12470           DFHEIV11,
 12471           ERPNDB-KEY,
 12472           DFHEIV99,
 12473           DFHEIV99,
 12474           DFHEIV99
 12475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12476
 12477
 12478     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12479     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12480     MOVE 'B'                    TO JP-RECORD-TYPE.
 12481     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12482
 12483     PERFORM 8400-LOG-JOURNAL-RECORD.
 12484
 12485     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 12486
 12487
 12488* EXEC CICS REWRITE
 12489*        DATASET (FILE-ID-ERPNDB)
 12490*        FROM    (PENDING-BUSINESS)
 12491*    END-EXEC.
 12492     MOVE LENGTH OF
 12493      PENDING-BUSINESS
 12494       TO DFHEIV11
 12495*    MOVE '&& L                  %   #00011252' TO DFHEIV0
 12496     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12497     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12498     MOVE X'2020233030303131323532' TO DFHEIV0(25:11)
 12499     CALL 'kxdfhei1' USING DFHEIV0,
 12500           FILE-ID-ERPNDB,
 12501           PENDING-BUSINESS,
 12502           DFHEIV11,
 12503           DFHEIV99
 12504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12505
 12506
 12507     MOVE 'C'                    TO JP-RECORD-TYPE.
 12508     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12509
 12510     PERFORM 8400-LOG-JOURNAL-RECORD.
 12511
 12512     IF WS-ERRORS-PRESENT
 12513        GO TO 3900-RE-DISPLAY-RECORD.
 12514
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 235
* EL6311.cbl
 12515     MOVE ZEROS                  TO EMI-ERROR.
 12516     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12517     MOVE LOW-VALUES             TO EL631CI.
 12518     MOVE  -1                    TO CMAINTL.
 12519     GO TO 8100-SEND-INITIAL-MAP.
 12520
 12521 2280-BATCH-HDR-NOT-FOUND.
 12522     MOVE -1                     TO BMAINTL.
 12523     MOVE ER-7450                TO EMI-ERROR.
 12524     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12525     GO TO 8200-SEND-DATAONLY.
 12526
 12527 2290-DUPLICATE-ALT-INDEX.
 12528
 12529******************************************************************
 12530*                                                                *
 12531*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 12532*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 12533*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 12534*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 12535*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 12536*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 12537*                                                                *
 12538******************************************************************
 12539
 12540     IF LCP-ONCTR-02 =  0
 12541         ADD 1 TO LCP-ONCTR-02
 12542        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 12543
 12544     ADD +1                      TO WS-SEQ-NO-COUNTER.
 12545
 12546     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 12547         NEXT SENTENCE
 12548     ELSE
 12549         ADD +1 TO PB-BATCH-SEQ-NO
 12550                   PB-CSR-BATCH-SEQ-NO
 12551         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 12552         GO TO 2275-WRITE-PENDING-BUSINESS.
 12553
 12554     MOVE -1                     TO CCERTNOL.
 12555     MOVE AL-UABON               TO CCERTNOA.
 12556     MOVE AL-UNBON               TO CEFFDTA.
 12557
 12558     MOVE 1                      TO EMI-SUB
 12559                                    EMI-SWITCH1
 12560                                    EMI-SWITCH-AREA-1
 12561                                    EMI-SWITCH-AREA-2.
 12562
 12563     MOVE SPACES                 TO EMI-ERROR-LINES.
 12564
 12565
 12566* EXEC CICS SYNCPOINT ROLLBACK
 12567*    END-EXEC.
 12568*    MOVE '6"R                   !   #00011315' TO DFHEIV0
 12569     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12571     MOVE X'2020233030303131333135' TO DFHEIV0(25:11)
 12572     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 236
* EL6311.cbl
 12573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12574
 12575
 12576     MOVE ER-2247                TO EMI-ERROR.
 12577     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12578     GO TO 8200-SEND-DATAONLY.
 12579
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 237
* EL6311.cbl
 12581
 12582******************************************************************
 12583*                                                                *
 12584*          C H A N G E   C A N C E L   R O U T I N E             *
 12585*                                                                *
 12586******************************************************************
 12587
 12588***************************************************************
 12589*                                                             *
 12590*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 12591*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 12592*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 12593*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 12594*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 12595*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 12596*     5. LINK TO THE EDIT ROUTINE.                            *
 12597*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 12598*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 12599*              THE EDIT ROUTINE.                              *
 12600*     7. REWRITE THE NEW ISSUE                                *
 12601*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 12602*                                                             *
 12603***************************************************************
 12604 2300-CHANGE-CANCEL-ROUTINE.
 12605     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 12606
 12607     IF CCHGL NOT = ZEROS
 12608        MOVE ER-2196             TO EMI-ERROR
 12609        MOVE AL-UABON            TO CMAINTA
 12610        MOVE -1                  TO CMAINTL
 12611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12612        GO TO 8200-SEND-DATAONLY.
 12613
 12614     MOVE CCERTNOI               TO WS-NEW-PRIME.
 12615
 12616     IF CSUFIXL NOT = ZEROS
 12617        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 12618     ELSE
 12619        MOVE SPACE               TO WS-NEW-SUFFIX.
 12620
 12621     MOVE CEFFDTI                TO DEEDIT-FIELD.
 12622     PERFORM 8600-DEEDIT.
 12623     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12624     MOVE '4'                    TO DC-OPTION-CODE.
 12625
 12626     PERFORM 9700-DATE-LINK.
 12627
 12628     IF DATE-CONVERSION-ERROR
 12629        MOVE ER-0348             TO EMI-ERROR
 12630        MOVE -1                  TO CEFFDTL
 12631        MOVE AL-UABON            TO CEFFDTA
 12632        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12633        GO TO 8200-SEND-DATAONLY
 12634     ELSE
 12635        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 12636        MOVE AL-UANON            TO CEFFDTA
 12637        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12638
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 238
* EL6311.cbl
 12639 2325-PROCESS-CANCEL-CHANGES.
 12640
 12641* EXEC CICS HANDLE CONDITION
 12642*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 12643*    END-EXEC.
 12644*    MOVE '"$I                   ! 3 #00011382' TO DFHEIV0
 12645     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12647     MOVE X'3320233030303131333832' TO DFHEIV0(25:11)
 12648     CALL 'kxdfhei1' USING DFHEIV0
 12649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12650
 12651
 12652     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12653     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12654     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12655
 12656
 12657* EXEC CICS GETMAIN
 12658*        SET      (ADDRESS OF PENDING-BUSINESS)
 12659*        LENGTH   (ERPNDB-RECORD-LENGTH)
 12660*        INITIMG  (GETMAIN-SPACE)
 12661*     END-EXEC.
 12662*    MOVE ',"IL                  $   #00011390' TO DFHEIV0
 12663     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12664     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12665     MOVE X'2020233030303131333930' TO DFHEIV0(25:11)
 12666     CALL 'kxdfhei1' USING DFHEIV0,
 12667           DFHEIV20,
 12668           ERPNDB-RECORD-LENGTH,
 12669           GETMAIN-SPACE
 12670     SET ADDRESS OF PENDING-BUSINESS TO
 12671         DFHEIV20
 12672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12673
 12674
 12675
 12676* EXEC CICS READ
 12677*        INTO    (PENDING-BUSINESS)
 12678*        DATASET (FILE-ID-ERPNDB)
 12679*        RIDFLD  (ERPNDB-KEY)
 12680*    END-EXEC.
 12681     MOVE LENGTH OF
 12682      PENDING-BUSINESS
 12683       TO DFHEIV11
 12684*    MOVE '&"IL       E          (   #00011396' TO DFHEIV0
 12685     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12686     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12687     MOVE X'2020233030303131333936' TO DFHEIV0(25:11)
 12688     CALL 'kxdfhei1' USING DFHEIV0,
 12689           FILE-ID-ERPNDB,
 12690           PENDING-BUSINESS,
 12691           DFHEIV11,
 12692           ERPNDB-KEY,
 12693           DFHEIV99,
 12694           DFHEIV99,
 12695           DFHEIV99
 12696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 239
* EL6311.cbl
 12697
 12698
 12699     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12700
 12701
 12702* EXEC CICS HANDLE CONDITION
 12703*         NOTFND     (2385-REC-NOT-FOUND)
 12704*    END-EXEC.
 12705*    MOVE '"$I                   ! 4 #00011404' TO DFHEIV0
 12706     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12708     MOVE X'3420233030303131343034' TO DFHEIV0(25:11)
 12709     CALL 'kxdfhei1' USING DFHEIV0
 12710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12711
 12712
 12713**********************************************************
 12714*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 12715*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 12716**********************************************************
 12717
 12718
 12719* EXEC CICS READ
 12720*        DATASET (FILE-ID-ERPNDB)
 12721*        INTO    (PENDING-BUSINESS)
 12722*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12723*    END-EXEC.
 12724     MOVE LENGTH OF
 12725      PENDING-BUSINESS
 12726       TO DFHEIV11
 12727*    MOVE '&"IL       E          (   #00011413' TO DFHEIV0
 12728     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12729     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12730     MOVE X'2020233030303131343133' TO DFHEIV0(25:11)
 12731     CALL 'kxdfhei1' USING DFHEIV0,
 12732           FILE-ID-ERPNDB,
 12733           PENDING-BUSINESS,
 12734           DFHEIV11,
 12735           PI-PREV-CONTROL-PRIMARY,
 12736           DFHEIV99,
 12737           DFHEIV99,
 12738           DFHEIV99
 12739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12740
 12741
 12742********** DO NOT ALLOW CHANGES IF THRU A/R
 12743     IF BMAINTI = 'C'
 12744         IF PB-EL860-INTERNAL-PROCESS
 12745             MOVE ER-4005          TO EMI-ERROR
 12746             MOVE -1               TO BMAINTL
 12747             MOVE AL-UABON         TO BMAINTA
 12748             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12749             GO TO 8200-SEND-DATAONLY.
 12750**********
 12751
 12752     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12753        MOVE -1                 TO CMAINTL
 12754        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 240
* EL6311.cbl
 12755        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12756        GO TO 8200-SEND-DATAONLY.
 12757
 12758     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 12759        MOVE ER-2196             TO EMI-ERROR
 12760        MOVE AL-UABON            TO CMAINTA
 12761        MOVE -1                  TO CMAINTL
 12762        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12763        GO TO 8200-SEND-DATAONLY.
 12764     MOVE ZEROS                  TO WS-SEQ-SAVE.
 12765
 12766     IF PB-BILLED-DT = LOW-VALUES AND
 12767        PB-CHG-COUNT = ZEROS
 12768        NEXT SENTENCE
 12769     ELSE
 12770        IF (CREFND1L GREATER THAN ZEROS AND
 12771            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 12772           OR
 12773           (CREFND2L GREATER THAN ZEROS AND
 12774            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 12775           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 12776
 12777
 12778* EXEC CICS READ
 12779*        DATASET (FILE-ID-ERPNDB)
 12780*        INTO    (PENDING-BUSINESS)
 12781*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12782*        UPDATE
 12783*    END-EXEC.
 12784     MOVE LENGTH OF
 12785      PENDING-BUSINESS
 12786       TO DFHEIV11
 12787*    MOVE '&"IL       EU         (   #00011454' TO DFHEIV0
 12788     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12789     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12790     MOVE X'2020233030303131343534' TO DFHEIV0(25:11)
 12791     CALL 'kxdfhei1' USING DFHEIV0,
 12792           FILE-ID-ERPNDB,
 12793           PENDING-BUSINESS,
 12794           DFHEIV11,
 12795           PI-PREV-CONTROL-PRIMARY,
 12796           DFHEIV99,
 12797           DFHEIV99,
 12798           DFHEIV99
 12799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12800
 12801
 12802     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12803     MOVE 'B'                    TO JP-RECORD-TYPE
 12804     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12805     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12806
 12807     PERFORM 8400-LOG-JOURNAL-RECORD.
 12808
 12809     IF PB-BILLED-DT NOT = LOW-VALUES OR
 12810          PB-CHG-COUNT NOT = ZEROS
 12811        IF (CREFND1L GREATER THAN ZEROS AND
 12812            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 241
* EL6311.cbl
 12813           OR
 12814           (CREFND2L GREATER THAN ZEROS AND
 12815            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 12816            ADD +1                      TO PB-CHG-COUNT
 12817            MOVE LOW-VALUES             TO PB-BILLED-DT.
 12818
 12819*    IF CMICRNOL  GREATER  ZEROS
 12820*        IF CMICRNOI  NUMERIC
 12821*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 12822*            MOVE AL-UNNON       TO  CMICRNOA
 12823*        ELSE
 12824*            MOVE -1             TO  CMICRNOL
 12825*            MOVE AL-UNBON       TO  CMICRNOA
 12826*            MOVE ER-2701        TO  EMI-ERROR
 12827*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12828
 12829     IF CSUFIXL GREATER THAN ZEROS
 12830        MOVE CSUFIXI             TO PB-CERT-SFX.
 12831
 12832     IF CLSTNML GREATER THAN ZEROS
 12833         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 12834
 12835     IF CPCYNL > ZEROS
 12836        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 12837     END-IF
 12838     IF CCANDT1L    GREATER THAN ZEROS
 12839        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 12840
 12841     IF CCANDT2L    GREATER THAN ZEROS
 12842        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 12843
 12844     IF CMTHD1L    GREATER THAN +0
 12845        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 12846
 12847     IF CMTHD2L    GREATER THAN +0
 12848        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 12849
 12850     IF CREFND1L    GREATER THAN ZEROS
 12851        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 12852        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 12853        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 12854        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 12855
 12856     IF CREFND2L    GREATER THAN ZEROS
 12857        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 12858        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 12859        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 12860        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 12861
 12862     IF CLIVESL     GREATER THAN ZEROS
 12863        MOVE WS-CLIVES           TO PB-C-LIVES.
 12864
 12865     IF CPAYEEL     GREATER THAN ZEROS
 12866        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 12867
 12868     IF CFORCEL     GREATER THAN ZEROS
 12869        MOVE CFORCEI             TO PB-FORCE-CODE.
 12870
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 242
* EL6311.cbl
 12871     IF CBILCDL     GREATER THAN ZEROS
 12872        MOVE CBILCDI             TO PB-RECORD-BILL.
 12873
 12874 2360-REWRITE-PB-RECORD.
 12875     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12876     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12877     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12878     MOVE 'C'                    TO JP-RECORD-TYPE.
 12879     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12880     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12881     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12882
 12883     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12884
 12885     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 12886     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 12887
 12888     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12889
 12890     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12891
 12892     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12893     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12894     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12895
 12896     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 12897     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 12898
 12899 2375-REWRITE-PENDING-BUSINESS.
 12900     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12901     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12902     MOVE 'C'                    TO JP-RECORD-TYPE.
 12903     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12904
 12905
 12906* EXEC CICS REWRITE
 12907*        DATASET (FILE-ID-ERPNDB)
 12908*        FROM    (PENDING-BUSINESS)
 12909*    END-EXEC.
 12910     MOVE LENGTH OF
 12911      PENDING-BUSINESS
 12912       TO DFHEIV11
 12913*    MOVE '&& L                  %   #00011564' TO DFHEIV0
 12914     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12915     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12916     MOVE X'2020233030303131353634' TO DFHEIV0(25:11)
 12917     CALL 'kxdfhei1' USING DFHEIV0,
 12918           FILE-ID-ERPNDB,
 12919           PENDING-BUSINESS,
 12920           DFHEIV11,
 12921           DFHEIV99
 12922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12923
 12924
 12925     PERFORM 8400-LOG-JOURNAL-RECORD.
 12926
 12927******************************************************************
 12928*       U P D A T E   T H E   B A T C H   H E A D E R            *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 243
* EL6311.cbl
 12929******************************************************************
 12930
 12931
 12932* EXEC CICS HANDLE CONDITION
 12933*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 12934*    END-EXEC.
 12935*    MOVE '"$I                   ! 5 #00011575' TO DFHEIV0
 12936     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12938     MOVE X'3520233030303131353735' TO DFHEIV0(25:11)
 12939     CALL 'kxdfhei1' USING DFHEIV0
 12940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12941
 12942
 12943
 12944* EXEC CICS READ
 12945*        INTO    (PENDING-BUSINESS)
 12946*        DATASET (FILE-ID-ERPNDB)
 12947*        RIDFLD  (ERPNDB-KEY)
 12948*        UPDATE
 12949*    END-EXEC.
 12950     MOVE LENGTH OF
 12951      PENDING-BUSINESS
 12952       TO DFHEIV11
 12953*    MOVE '&"IL       EU         (   #00011579' TO DFHEIV0
 12954     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12956     MOVE X'2020233030303131353739' TO DFHEIV0(25:11)
 12957     CALL 'kxdfhei1' USING DFHEIV0,
 12958           FILE-ID-ERPNDB,
 12959           PENDING-BUSINESS,
 12960           DFHEIV11,
 12961           ERPNDB-KEY,
 12962           DFHEIV99,
 12963           DFHEIV99,
 12964           DFHEIV99
 12965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12966
 12967
 12968     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12969     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12970     MOVE 'B'                    TO JP-RECORD-TYPE.
 12971     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12972
 12973     PERFORM 8400-LOG-JOURNAL-RECORD.
 12974
 12975     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 12976
 12977
 12978* EXEC CICS REWRITE
 12979*        DATASET (FILE-ID-ERPNDB)
 12980*        FROM    (PENDING-BUSINESS)
 12981*    END-EXEC.
 12982     MOVE LENGTH OF
 12983      PENDING-BUSINESS
 12984       TO DFHEIV11
 12985*    MOVE '&& L                  %   #00011595' TO DFHEIV0
 12986     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 244
* EL6311.cbl
 12987     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12988     MOVE X'2020233030303131353935' TO DFHEIV0(25:11)
 12989     CALL 'kxdfhei1' USING DFHEIV0,
 12990           FILE-ID-ERPNDB,
 12991           PENDING-BUSINESS,
 12992           DFHEIV11,
 12993           DFHEIV99
 12994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12995
 12996
 12997     MOVE 'C'                    TO JP-RECORD-TYPE.
 12998     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12999
 13000     PERFORM 8400-LOG-JOURNAL-RECORD.
 13001
 13002     IF WS-ERRORS-PRESENT
 13003         GO TO 3900-RE-DISPLAY-RECORD.
 13004
 13005     MOVE ZEROS                  TO EMI-ERROR
 13006     MOVE -1                     TO CMAINTL
 13007     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13008     GO TO 3900-RE-DISPLAY-RECORD.
 13009
 13010 2380-BATCH-HDR-NOT-FOUND.
 13011     MOVE -1                     TO BMAINTL.
 13012     MOVE ER-7450                TO EMI-ERROR.
 13013     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13014     GO TO 8200-SEND-DATAONLY.
 13015
 13016 2385-REC-NOT-FOUND.
 13017     MOVE -1                     TO BMAINTL.
 13018     MOVE ER-7451                TO EMI-ERROR.
 13019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13020     GO TO 8200-SEND-DATAONLY.
 13021
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 245
* EL6311.cbl
 13023
 13024******************************************************************
 13025*                                                                *
 13026*          D E L E T E   C A N C E L   R O U T I N E             *
 13027*                                                                *
 13028******************************************************************
 13029
 13030 2400-DELETE-CANCEL-ROUTINE.
 13031     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 13032
 13033     IF CCHGL NOT = ZEROS
 13034        MOVE ER-2196             TO EMI-ERROR
 13035        MOVE AL-UABON            TO CMAINTA
 13036        MOVE -1                  TO CMAINTL
 13037        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13038        GO TO 8200-SEND-DATAONLY.
 13039
 13040
 13041* EXEC CICS HANDLE CONDITION
 13042*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 13043*    END-EXEC.
 13044*    MOVE '"$I                   ! 6 #00011643' TO DFHEIV0
 13045     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13047     MOVE X'3620233030303131363433' TO DFHEIV0(25:11)
 13048     CALL 'kxdfhei1' USING DFHEIV0
 13049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13050
 13051
 13052     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13053     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13054     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13055
 13056
 13057* EXEC CICS READ
 13058*        SET     (ADDRESS OF PENDING-BUSINESS)
 13059*        DATASET (FILE-ID-ERPNDB)
 13060*        RIDFLD  (ERPNDB-KEY)
 13061*    END-EXEC.
 13062*    MOVE '&"S        E          (   #00011651' TO DFHEIV0
 13063     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13064     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13065     MOVE X'2020233030303131363531' TO DFHEIV0(25:11)
 13066     CALL 'kxdfhei1' USING DFHEIV0,
 13067           FILE-ID-ERPNDB,
 13068           DFHEIV20,
 13069           DFHEIV99,
 13070           ERPNDB-KEY,
 13071           DFHEIV99,
 13072           DFHEIV99,
 13073           DFHEIV99
 13074     SET ADDRESS OF PENDING-BUSINESS TO
 13075         DFHEIV20
 13076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13077
 13078
 13079     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 13080
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 246
* EL6311.cbl
 13081     MOVE CCERTNOI               TO WS-NEW-PRIME.
 13082
 13083     IF CSUFIXL NOT = ZEROS
 13084        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 13085     ELSE
 13086        MOVE SPACE               TO WS-NEW-SUFFIX.
 13087
 13088     MOVE CEFFDTI                TO DEEDIT-FIELD.
 13089
 13090     PERFORM 8600-DEEDIT.
 13091     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 13092     MOVE '4'                    TO DC-OPTION-CODE.
 13093     PERFORM 9700-DATE-LINK.
 13094
 13095     IF DATE-CONVERSION-ERROR
 13096        MOVE ER-0348             TO EMI-ERROR
 13097        MOVE -1                  TO CEFFDTL
 13098        MOVE AL-UABON            TO CEFFDTA
 13099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13100        GO TO 8200-SEND-DATAONLY
 13101     ELSE
 13102        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 13103        MOVE AL-UANON            TO CEFFDTA
 13104        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 13105
 13106
 13107* EXEC CICS HANDLE CONDITION
 13108*         NOTFND    (2490-RECORD-NOT-FOUND)
 13109*    END-EXEC.
 13110*    MOVE '"$I                   ! 7 #00011684' TO DFHEIV0
 13111     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13113     MOVE X'3720233030303131363834' TO DFHEIV0(25:11)
 13114     CALL 'kxdfhei1' USING DFHEIV0
 13115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13116
 13117
 13118
 13119* EXEC CICS READ
 13120*        SET     (ADDRESS OF PENDING-BUSINESS)
 13121*        DATASET (FILE-ID-ERPNDB)
 13122*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 13123*        UPDATE
 13124*    END-EXEC.
 13125*    MOVE '&"S        EU         (   #00011688' TO DFHEIV0
 13126     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13127     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13128     MOVE X'2020233030303131363838' TO DFHEIV0(25:11)
 13129     CALL 'kxdfhei1' USING DFHEIV0,
 13130           FILE-ID-ERPNDB,
 13131           DFHEIV20,
 13132           DFHEIV99,
 13133           PI-PREV-CONTROL-PRIMARY,
 13134           DFHEIV99,
 13135           DFHEIV99,
 13136           DFHEIV99
 13137     SET ADDRESS OF PENDING-BUSINESS TO
 13138         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 247
* EL6311.cbl
 13139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13140
 13141
 13142     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 13143        MOVE -1                 TO CMAINTL
 13144        MOVE ER-2197            TO EMI-ERROR
 13145        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13146        GO TO 8200-SEND-DATAONLY.
 13147
 13148     IF PB-BILLED-DT NOT = LOW-VALUES
 13149        MOVE -1                 TO CMAINTL
 13150        MOVE ER-2129            TO EMI-ERROR
 13151        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13152        GO TO 8200-SEND-DATAONLY.
 13153
 13154     IF PB-CHG-COUNT NOT = ZEROS
 13155        MOVE ER-2336            TO EMI-ERROR
 13156        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13157        MOVE AL-UABON            TO CMAINTA
 13158        MOVE -1                  TO CMAINTL
 13159        GO TO 8200-SEND-DATAONLY.
 13160
 13161     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 13162        PB-CHG-COUNT NOT = ZEROS
 13163        MOVE ER-2196             TO EMI-ERROR
 13164        MOVE AL-UABON            TO CMAINTA
 13165        MOVE -1                  TO CMAINTL
 13166        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13167        GO TO 8200-SEND-DATAONLY.
 13168
 13169     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 13170        MOVE ER-2900 TO EMI-ERROR
 13171        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13172        MOVE AL-UABON         TO CMAINTA
 13173        MOVE -1               TO CMAINTL
 13174        GO TO 8200-SEND-DATAONLY.
 13175
 13176
 13177* EXEC CICS HANDLE CONDITION
 13178*         NOTFND  (2475-CONTINUE-DELETE)
 13179*    END-EXEC
 13180*    MOVE '"$I                   ! 8 #00011729' TO DFHEIV0
 13181     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13183     MOVE X'3820233030303131373239' TO DFHEIV0(25:11)
 13184     CALL 'kxdfhei1' USING DFHEIV0
 13185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13186
 13187     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13188     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13189     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13190     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13191
 13192
 13193* EXEC CICS READ
 13194*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13195*        DATASET (FILE-ID-ELCERT)
 13196*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 248
* EL6311.cbl
 13197*        UPDATE
 13198*    END-EXEC.
 13199*    MOVE '&"S        EU         (   #00011738' TO DFHEIV0
 13200     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13201     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13202     MOVE X'2020233030303131373338' TO DFHEIV0(25:11)
 13203     CALL 'kxdfhei1' USING DFHEIV0,
 13204           FILE-ID-ELCERT,
 13205           DFHEIV20,
 13206           DFHEIV99,
 13207           ELCERT-KEY,
 13208           DFHEIV99,
 13209           DFHEIV99,
 13210           DFHEIV99
 13211     SET ADDRESS OF CERTIFICATE-MASTER TO
 13212         DFHEIV20
 13213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13214
 13215
 13216     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13217
 13218     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13219     MOVE 'B'                    TO JP-RECORD-TYPE.
 13220     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13221     PERFORM 8400-LOG-JOURNAL-RECORD.
 13222
 13223     IF PB-CI-LIVES NOT NUMERIC
 13224         MOVE ZERO                    TO PB-CI-LIVES.
 13225
 13226     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 13227        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 13228           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 13229           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 13230           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 13231                                            CM-LF-CANCEL-DT
 13232           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 13233        ELSE
 13234           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 13235           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 13236           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 13237           MOVE PB-CI-LIVES              TO CM-LIVES.
 13238
 13239     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 13240        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 13241           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 13242               MOVE CM-LF-STATUS-AT-CANCEL
 13243                                        TO CM-LF-CURRENT-STATUS
 13244               MOVE SPACE
 13245                                        TO CM-LF-STATUS-AT-CANCEL
 13246           ELSE
 13247               MOVE PB-CI-LF-POLICY-STATUS
 13248                                        TO CM-LF-CURRENT-STATUS
 13249        ELSE
 13250           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 13251
 13252
 13253     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 13254        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 249
* EL6311.cbl
 13255           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 13256           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 13257           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 13258                                            CM-AH-CANCEL-DT
 13259           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 13260        ELSE
 13261           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 13262           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 13263           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 13264           MOVE PB-CI-LIVES              TO CM-LIVES.
 13265
 13266     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 13267        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 13268           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 13269               MOVE CM-AH-STATUS-AT-CANCEL
 13270                                        TO CM-AH-CURRENT-STATUS
 13271               MOVE SPACE
 13272                                        TO CM-AH-STATUS-AT-CANCEL
 13273           ELSE
 13274               MOVE PB-CI-AH-POLICY-STATUS
 13275                                        TO CM-AH-CURRENT-STATUS
 13276        ELSE
 13277           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 13278
 13279 2450-REWRITE-CERT.
 13280     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13281     MOVE 'C'                      TO JP-RECORD-TYPE.
 13282     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13283
 13284
 13285* EXEC CICS REWRITE
 13286*        DATASET  (FILE-ID-ELCERT)
 13287*        FROM     (CERTIFICATE-MASTER)
 13288*    END-EXEC.
 13289     MOVE LENGTH OF
 13290      CERTIFICATE-MASTER
 13291       TO DFHEIV11
 13292*    MOVE '&& L                  %   #00011813' TO DFHEIV0
 13293     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13294     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13295     MOVE X'2020233030303131383133' TO DFHEIV0(25:11)
 13296     CALL 'kxdfhei1' USING DFHEIV0,
 13297           FILE-ID-ELCERT,
 13298           CERTIFICATE-MASTER,
 13299           DFHEIV11,
 13300           DFHEIV99
 13301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13302
 13303
 13304     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13305
 13306     PERFORM 8400-LOG-JOURNAL-RECORD.
 13307
 13308 2475-CONTINUE-DELETE.
 13309     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 13310     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 13311
 13312     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 250
* EL6311.cbl
 13313     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 13314
 13315     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 13316
 13317     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 13318     MOVE 'D'                    TO JP-RECORD-TYPE
 13319     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 13320
 13321
 13322* EXEC CICS DELETE
 13323*        DATASET    (FILE-ID-ERPNDB)
 13324*    END-EXEC.
 13325*    MOVE '&(                    &   #00011835' TO DFHEIV0
 13326     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13327     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13328     MOVE X'2020233030303131383335' TO DFHEIV0(25:11)
 13329     CALL 'kxdfhei1' USING DFHEIV0,
 13330           FILE-ID-ERPNDB,
 13331           DFHEIV99,
 13332           DFHEIV99,
 13333           DFHEIV99,
 13334           DFHEIV99
 13335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13336
 13337
 13338     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13339
 13340     PERFORM 8400-LOG-JOURNAL-RECORD.
 13341
 13342     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13343     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13344
 13345
 13346* EXEC CICS HANDLE CONDITION
 13347*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 13348*    END-EXEC.
 13349*    MOVE '"$I                   ! 9 #00011846' TO DFHEIV0
 13350     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13352     MOVE X'3920233030303131383436' TO DFHEIV0(25:11)
 13353     CALL 'kxdfhei1' USING DFHEIV0
 13354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13355
 13356
 13357
 13358* EXEC CICS READ
 13359*        SET     (ADDRESS OF PENDING-BUSINESS)
 13360*        DATASET (FILE-ID-ERPNDB)
 13361*        RIDFLD  (ERPNDB-KEY)
 13362*        UPDATE
 13363*    END-EXEC.
 13364*    MOVE '&"S        EU         (   #00011850' TO DFHEIV0
 13365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13366     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13367     MOVE X'2020233030303131383530' TO DFHEIV0(25:11)
 13368     CALL 'kxdfhei1' USING DFHEIV0,
 13369           FILE-ID-ERPNDB,
 13370           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 251
* EL6311.cbl
 13371           DFHEIV99,
 13372           ERPNDB-KEY,
 13373           DFHEIV99,
 13374           DFHEIV99,
 13375           DFHEIV99
 13376     SET ADDRESS OF PENDING-BUSINESS TO
 13377         DFHEIV20
 13378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13379
 13380
 13381     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 13382     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13383
 13384     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13385        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13386        MOVE 'D'                 TO JP-RECORD-TYPE
 13387        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13388
 13389* EXEC CICS DELETE
 13390*            DATASET    (FILE-ID-ERPNDB)
 13391*       END-EXEC
 13392*    MOVE '&(                    &   #00011864' TO DFHEIV0
 13393     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13394     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13395     MOVE X'2020233030303131383634' TO DFHEIV0(25:11)
 13396     CALL 'kxdfhei1' USING DFHEIV0,
 13397           FILE-ID-ERPNDB,
 13398           DFHEIV99,
 13399           DFHEIV99,
 13400           DFHEIV99,
 13401           DFHEIV99
 13402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13403        PERFORM 8400-LOG-JOURNAL-RECORD
 13404     ELSE
 13405        MOVE 'B'                 TO JP-RECORD-TYPE
 13406        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13407        PERFORM 8400-LOG-JOURNAL-RECORD
 13408        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13409        MOVE 'C'                 TO JP-RECORD-TYPE
 13410        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13411
 13412* EXEC CICS REWRITE
 13413*            DATASET    (FILE-ID-ERPNDB)
 13414*            FROM       (PENDING-BUSINESS)
 13415*       END-EXEC
 13416     MOVE LENGTH OF
 13417      PENDING-BUSINESS
 13418       TO DFHEIV11
 13419*    MOVE '&& L                  %   #00011875' TO DFHEIV0
 13420     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13421     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13422     MOVE X'2020233030303131383735' TO DFHEIV0(25:11)
 13423     CALL 'kxdfhei1' USING DFHEIV0,
 13424           FILE-ID-ERPNDB,
 13425           PENDING-BUSINESS,
 13426           DFHEIV11,
 13427           DFHEIV99
 13428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 252
* EL6311.cbl
 13429        PERFORM 8400-LOG-JOURNAL-RECORD.
 13430
 13431******************************************************************
 13432*                                                                *
 13433*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13434*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13435*                                                                *
 13436******************************************************************
 13437
 13438     IF NOT PI-AR-PROCESSING
 13439        GO TO 2480-DELETE-FINISHED.
 13440
 13441     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13442        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13443        NEXT SENTENCE
 13444     ELSE
 13445        GO TO 2480-DELETE-FINISHED.
 13446
 13447
 13448* EXEC CICS HANDLE CONDITION
 13449*         NOTFND    (2480-DELETE-FINISHED)
 13450*    END-EXEC.
 13451*    MOVE '"$I                   ! : #00011897' TO DFHEIV0
 13452     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13454     MOVE X'3A20233030303131383937' TO DFHEIV0(25:11)
 13455     CALL 'kxdfhei1' USING DFHEIV0
 13456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13457
 13458
 13459     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13460     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13461
 13462
 13463* EXEC CICS READ
 13464*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13465*        DATASET (FILE-ID-ERRQST)
 13466*        RIDFLD  (ERRQST-KEY)
 13467*        UPDATE
 13468*    END-EXEC.
 13469*    MOVE '&"S        EU         (   #00011904' TO DFHEIV0
 13470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13471     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13472     MOVE X'2020233030303131393034' TO DFHEIV0(25:11)
 13473     CALL 'kxdfhei1' USING DFHEIV0,
 13474           FILE-ID-ERRQST,
 13475           DFHEIV20,
 13476           DFHEIV99,
 13477           ERRQST-KEY,
 13478           DFHEIV99,
 13479           DFHEIV99,
 13480           DFHEIV99
 13481     SET ADDRESS OF AR-REQUEST-RECORD TO
 13482         DFHEIV20
 13483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13484
 13485
 13486     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 253
* EL6311.cbl
 13487
 13488     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13489
 13490     MOVE 'D'                      TO JP-RECORD-TYPE.
 13491     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13492
 13493
 13494* EXEC CICS DELETE
 13495*         DATASET    (FILE-ID-ERRQST)
 13496*    END-EXEC.
 13497*    MOVE '&(                    &   #00011918' TO DFHEIV0
 13498     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13499     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13500     MOVE X'2020233030303131393138' TO DFHEIV0(25:11)
 13501     CALL 'kxdfhei1' USING DFHEIV0,
 13502           FILE-ID-ERRQST,
 13503           DFHEIV99,
 13504           DFHEIV99,
 13505           DFHEIV99,
 13506           DFHEIV99
 13507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13508
 13509
 13510     PERFORM 8400-LOG-JOURNAL-RECORD.
 13511
 13512 2480-DELETE-FINISHED.
 13513     MOVE ZEROS                  TO EMI-ERROR.
 13514     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13515     MOVE LOW-VALUES             TO EL631CI.
 13516     MOVE -1                     TO CMAINTL.
 13517     GO TO 8100-SEND-INITIAL-MAP.
 13518
 13519 2485-BATCH-HDR-NOT-FOUND.
 13520     MOVE -1                     TO CMAINTL
 13521     MOVE AL-UABON               TO CMAINTA.
 13522     MOVE ER-7450                TO EMI-ERROR.
 13523     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13524     GO TO 8200-SEND-DATAONLY.
 13525
 13526 2490-RECORD-NOT-FOUND.
 13527     MOVE -1                     TO CMAINTL
 13528     MOVE AL-UABON               TO CMAINTA.
 13529     MOVE ER-7451                TO EMI-ERROR.
 13530     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13531     GO TO 8200-SEND-DATAONLY.
 13532
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 254
* EL6311.cbl
 13534
 13535***************************************************************
 13536*                                                             *
 13537*       B U I L D   C O R R E C T I O N   R E C O R D         *
 13538*                                                             *
 13539***************************************************************
 13540
 13541***************************************************************
 13542*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 13543*     AN ALREADY BILLED RECORD.                               *
 13544***************************************************************
 13545
 13546 2700-BUILD-CORRECTION-RECORD.
 13547     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 13548     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 13549     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 13550     MOVE '5'                    TO DC-OPTION-CODE.
 13551     PERFORM 9700-DATE-LINK.
 13552     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 13553
 13554     IF PB-CHG-COUNT = ZEROS
 13555        MOVE +1                  TO WS-SEQ-SAVE
 13556     ELSE
 13557        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 13558
 13559     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 13560     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 13561
 13562     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 13563
 13564     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 13565     MOVE 'A'                    TO JP-RECORD-TYPE.
 13566     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 13567
 13568
 13569* EXEC CICS WRITE
 13570*        DATASET    (FILE-ID-ERPNDB)
 13571*        FROM       (PENDING-BUSINESS)
 13572*        RIDFLD     (PB-CONTROL-PRIMARY)
 13573*    END-EXEC.
 13574     MOVE LENGTH OF
 13575      PENDING-BUSINESS
 13576       TO DFHEIV11
 13577*    MOVE '&$ L                  ''   #00011980' TO DFHEIV0
 13578     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13579     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13580     MOVE X'2020233030303131393830' TO DFHEIV0(25:11)
 13581     CALL 'kxdfhei1' USING DFHEIV0,
 13582           FILE-ID-ERPNDB,
 13583           PENDING-BUSINESS,
 13584           DFHEIV11,
 13585           PB-CONTROL-PRIMARY,
 13586           DFHEIV99,
 13587           DFHEIV99
 13588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13589
 13590
 13591     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 255
* EL6311.cbl
 13592
 13593     PERFORM 8400-LOG-JOURNAL-RECORD.
 13594
 13595 2799-EXIT.
 13596      EXIT.
 13597
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 256
* EL6311.cbl
 13599
 13600******************************************************************
 13601*                                                                *
 13602*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 13603*                                                                *
 13604******************************************************************
 13605
 13606 2800-REWRITE-ISSUE-CERT-KEY.
 13607     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 13608
 13609     IF  BCERTNOL GREATER THAN ZEROS
 13610         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 13611
 13612     IF  BSUFIXL  GREATER THAN ZEROS
 13613         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 13614
 13615     IF  BEFFDTL  GREATER THAN ZEROS
 13616         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 13617
 13618 2810-READ-BY-ACCOUNT.
 13619
 13620* EXEC CICS HANDLE CONDITION
 13621*         NOTFND    (2820-PROCESS-REWRITE)
 13622*    END-EXEC.
 13623*    MOVE '"$I                   ! ; #00012014' TO DFHEIV0
 13624     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13626     MOVE X'3B20233030303132303134' TO DFHEIV0(25:11)
 13627     CALL 'kxdfhei1' USING DFHEIV0
 13628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13629
 13630
 13631
 13632* EXEC CICS READ
 13633*        SET     (ADDRESS OF PENDING-BUSINESS)
 13634*        DATASET (FILE-ID-ERPNDB2)
 13635*        RIDFLD  (ERPNDB-ALT-KEY)
 13636*    END-EXEC.
 13637*    MOVE '&"S        E          (   #00012018' TO DFHEIV0
 13638     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13639     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13640     MOVE X'2020233030303132303138' TO DFHEIV0(25:11)
 13641     CALL 'kxdfhei1' USING DFHEIV0,
 13642           FILE-ID-ERPNDB2,
 13643           DFHEIV20,
 13644           DFHEIV99,
 13645           ERPNDB-ALT-KEY,
 13646           DFHEIV99,
 13647           DFHEIV99,
 13648           DFHEIV99
 13649     SET ADDRESS OF PENDING-BUSINESS TO
 13650         DFHEIV20
 13651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13652
 13653
 13654     GO TO 2890-DUPLICATE-RECORD.
 13655
 13656  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 257
* EL6311.cbl
 13657
 13658* EXEC CICS HANDLE CONDITION
 13659*         NOTFND    (2885-RECORD-MISSING)
 13660*    END-EXEC.
 13661*    MOVE '"$I                   ! < #00012027' TO DFHEIV0
 13662     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13664     MOVE X'3C20233030303132303237' TO DFHEIV0(25:11)
 13665     CALL 'kxdfhei1' USING DFHEIV0
 13666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13667
 13668
 13669     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13670
 13671
 13672* EXEC CICS READ
 13673*        SET     (ADDRESS OF PENDING-BUSINESS)
 13674*        DATASET (FILE-ID-ERPNDB)
 13675*        RIDFLD  (ERPNDB-KEY)
 13676*        UPDATE
 13677*    END-EXEC.
 13678*    MOVE '&"S        EU         (   #00012033' TO DFHEIV0
 13679     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13680     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13681     MOVE X'2020233030303132303333' TO DFHEIV0(25:11)
 13682     CALL 'kxdfhei1' USING DFHEIV0,
 13683           FILE-ID-ERPNDB,
 13684           DFHEIV20,
 13685           DFHEIV99,
 13686           ERPNDB-KEY,
 13687           DFHEIV99,
 13688           DFHEIV99,
 13689           DFHEIV99
 13690     SET ADDRESS OF PENDING-BUSINESS TO
 13691         DFHEIV20
 13692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13693
 13694
 13695     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 13696     MOVE 'D'                    TO JP-RECORD-TYPE.
 13697     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 13698     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13699
 13700     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13701
 13702     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13703     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13704     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13705
 13706
 13707* EXEC CICS DELETE
 13708*        DATASET    (FILE-ID-ERPNDB)
 13709*    END-EXEC.
 13710*    MOVE '&(                    &   #00012051' TO DFHEIV0
 13711     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13712     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13713     MOVE X'2020233030303132303531' TO DFHEIV0(25:11)
 13714     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 258
* EL6311.cbl
 13715           FILE-ID-ERPNDB,
 13716           DFHEIV99,
 13717           DFHEIV99,
 13718           DFHEIV99,
 13719           DFHEIV99
 13720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13721
 13722
 13723     PERFORM 8400-LOG-JOURNAL-RECORD.
 13724
 13725
 13726* EXEC CICS GETMAIN
 13727*        SET      (ADDRESS OF PENDING-BUSINESS)
 13728*        LENGTH   (ERPNDB-RECORD-LENGTH)
 13729*        INITIMG  (GETMAIN-SPACE)
 13730*    END-EXEC.
 13731*    MOVE ',"IL                  $   #00012057' TO DFHEIV0
 13732     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13733     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13734     MOVE X'2020233030303132303537' TO DFHEIV0(25:11)
 13735     CALL 'kxdfhei1' USING DFHEIV0,
 13736           DFHEIV20,
 13737           ERPNDB-RECORD-LENGTH,
 13738           GETMAIN-SPACE
 13739     SET ADDRESS OF PENDING-BUSINESS TO
 13740         DFHEIV20
 13741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13742
 13743
 13744     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 13745
 13746
 13747* EXEC CICS HANDLE CONDITION
 13748*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 13749*    END-EXEC.
 13750*    MOVE '"$I                   ! = #00012065' TO DFHEIV0
 13751     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13753     MOVE X'3D20233030303132303635' TO DFHEIV0(25:11)
 13754     CALL 'kxdfhei1' USING DFHEIV0
 13755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13756
 13757
 13758
 13759* EXEC CICS READ
 13760*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13761*        DATASET (FILE-ID-ELCERT)
 13762*        RIDFLD  (ELCERT-KEY)
 13763*        UPDATE
 13764*    END-EXEC.
 13765*    MOVE '&"S        EU         (   #00012069' TO DFHEIV0
 13766     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13767     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13768     MOVE X'2020233030303132303639' TO DFHEIV0(25:11)
 13769     CALL 'kxdfhei1' USING DFHEIV0,
 13770           FILE-ID-ELCERT,
 13771           DFHEIV20,
 13772           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 259
* EL6311.cbl
 13773           ELCERT-KEY,
 13774           DFHEIV99,
 13775           DFHEIV99,
 13776           DFHEIV99
 13777     SET ADDRESS OF CERTIFICATE-MASTER TO
 13778         DFHEIV20
 13779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13780
 13781
 13782     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 13783     MOVE 'B'                    TO JP-RECORD-TYPE
 13784     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13785     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13786
 13787     IF INSURED-ADDR-PRESENT
 13788        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13789
 13790     IF CERT-NOTES-ARE-NOT-PRESENT
 13791        MOVE SPACE               TO WS-CERT-NOTE-SW
 13792     ELSE
 13793        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13794
 13795     IF CERT-ADDED-BATCH      OR
 13796        CERT-AND-CLAIM-ONLINE OR
 13797        CERT-WAS-CREATED-FOR-CLAIM
 13798        NEXT SENTENCE
 13799     ELSE
 13800        GO TO 2825-DELETE-CERTIFICATE.
 13801
 13802     PERFORM 8400-LOG-JOURNAL-RECORD.
 13803
 13804*********************************************************
 13805** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 13806     IF CERT-ADDED-BATCH
 13807         GO TO 2822-REWRITE-ELCERT.
 13808*********************************************************
 13809
 13810     IF NO-CLAIM-ATTACHED
 13811        NEXT SENTENCE
 13812     ELSE
 13813        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 13814        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 13815
 13816 2822-REWRITE-ELCERT.
 13817     MOVE 'C'                    TO JP-RECORD-TYPE
 13818     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13819
 13820     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13821
 13822
 13823* EXEC CICS REWRITE
 13824*         DATASET    (FILE-ID-ELCERT)
 13825*         FROM       (CERTIFICATE-MASTER)
 13826*    END-EXEC.
 13827     MOVE LENGTH OF
 13828      CERTIFICATE-MASTER
 13829       TO DFHEIV11
 13830*    MOVE '&& L                  %   #00012116' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 260
* EL6311.cbl
 13831     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13832     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13833     MOVE X'2020233030303132313136' TO DFHEIV0(25:11)
 13834     CALL 'kxdfhei1' USING DFHEIV0,
 13835           FILE-ID-ELCERT,
 13836           CERTIFICATE-MASTER,
 13837           DFHEIV11,
 13838           DFHEIV99
 13839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13840
 13841
 13842     PERFORM 8400-LOG-JOURNAL-RECORD.
 13843
 13844     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 13845
 13846 2825-DELETE-CERTIFICATE.
 13847     MOVE 'D'                      TO JP-RECORD-TYPE.
 13848     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13849
 13850     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13851
 13852
 13853* EXEC CICS DELETE
 13854*         DATASET    (FILE-ID-ELCERT)
 13855*    END-EXEC.
 13856*    MOVE '&(                    &   #00012131' TO DFHEIV0
 13857     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13858     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13859     MOVE X'2020233030303132313331' TO DFHEIV0(25:11)
 13860     CALL 'kxdfhei1' USING DFHEIV0,
 13861           FILE-ID-ELCERT,
 13862           DFHEIV99,
 13863           DFHEIV99,
 13864           DFHEIV99,
 13865           DFHEIV99
 13866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13867
 13868
 13869     PERFORM 8400-LOG-JOURNAL-RECORD.
 13870
 13871******************************************************************
 13872*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13873******************************************************************
 13874
 13875     IF CERT-NOTES-ARE-PRESENT
 13876        NEXT SENTENCE
 13877     ELSE
 13878        GO TO 2827-DELETE-MAILING.
 13879
 13880
 13881* EXEC CICS HANDLE CONDITION
 13882*         NOTFND  (2827-DELETE-MAILING)
 13883*    END-EXEC.
 13884*    MOVE '"$I                   ! > #00012146' TO DFHEIV0
 13885     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13887     MOVE X'3E20233030303132313436' TO DFHEIV0(25:11)
 13888     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 261
* EL6311.cbl
 13889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13890
 13891
 13892
 13893* EXEC CICS READ
 13894*        EQUAL
 13895*        DATASET   (FILE-ID-ERNOTE)
 13896*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13897*        RIDFLD    (ELCERT-KEY)
 13898*        UPDATE
 13899*    END-EXEC.
 13900*    MOVE '&"S        EU         (   #00012150' TO DFHEIV0
 13901     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13902     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13903     MOVE X'2020233030303132313530' TO DFHEIV0(25:11)
 13904     CALL 'kxdfhei1' USING DFHEIV0,
 13905           FILE-ID-ERNOTE,
 13906           DFHEIV20,
 13907           DFHEIV99,
 13908           ELCERT-KEY,
 13909           DFHEIV99,
 13910           DFHEIV99,
 13911           DFHEIV99
 13912     SET ADDRESS OF CERTIFICATE-NOTE TO
 13913         DFHEIV20
 13914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13915
 13916
 13917     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 13918     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13919     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13920
 13921     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13922
 13923
 13924* EXEC CICS DELETE
 13925*        DATASET   (FILE-ID-ERNOTE)
 13926*    END-EXEC.
 13927*    MOVE '&(                    &   #00012164' TO DFHEIV0
 13928     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13929     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13930     MOVE X'2020233030303132313634' TO DFHEIV0(25:11)
 13931     CALL 'kxdfhei1' USING DFHEIV0,
 13932           FILE-ID-ERNOTE,
 13933           DFHEIV99,
 13934           DFHEIV99,
 13935           DFHEIV99,
 13936           DFHEIV99
 13937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13938
 13939
 13940     PERFORM 8400-LOG-JOURNAL-RECORD.
 13941
 13942******************************************************************
 13943*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 13944******************************************************************
 13945
 13946 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 262
* EL6311.cbl
 13947     IF CERT-ADDRESS-PRESENT
 13948        NEXT SENTENCE
 13949     ELSE
 13950        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 13951
 13952
 13953* EXEC CICS HANDLE CONDITION
 13954*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 13955*    END-EXEC.
 13956*    MOVE '"$I                   ! ? #00012180' TO DFHEIV0
 13957     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13958     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13959     MOVE X'3F20233030303132313830' TO DFHEIV0(25:11)
 13960     CALL 'kxdfhei1' USING DFHEIV0
 13961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13962
 13963
 13964     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 13965
 13966
 13967* EXEC CICS READ
 13968*        EQUAL
 13969*        DATASET   (FILE-ID-ERMAIL)
 13970*        SET       (ADDRESS OF MAILING-DATA)
 13971*        RIDFLD    (ERMAIL-KEY)
 13972*        UPDATE
 13973*    END-EXEC.
 13974*    MOVE '&"S        EU         (   #00012186' TO DFHEIV0
 13975     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13976     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13977     MOVE X'2020233030303132313836' TO DFHEIV0(25:11)
 13978     CALL 'kxdfhei1' USING DFHEIV0,
 13979           FILE-ID-ERMAIL,
 13980           DFHEIV20,
 13981           DFHEIV99,
 13982           ERMAIL-KEY,
 13983           DFHEIV99,
 13984           DFHEIV99,
 13985           DFHEIV99
 13986     SET ADDRESS OF MAILING-DATA TO
 13987         DFHEIV20
 13988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13989
 13990
 13991     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13992     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13993     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13994
 13995     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 13996
 13997
 13998* EXEC CICS DELETE
 13999*        DATASET   (FILE-ID-ERMAIL)
 14000*    END-EXEC.
 14001*    MOVE '&(                    &   #00012200' TO DFHEIV0
 14002     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14003     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14004     MOVE X'2020233030303132323030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 263
* EL6311.cbl
 14005     CALL 'kxdfhei1' USING DFHEIV0,
 14006           FILE-ID-ERMAIL,
 14007           DFHEIV99,
 14008           DFHEIV99,
 14009           DFHEIV99,
 14010           DFHEIV99
 14011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14012
 14013
 14014     PERFORM 8400-LOG-JOURNAL-RECORD.
 14015
 14016 2830-BUILD-NEW-ISSUE-RECORD.
 14017     MOVE SPACES                 TO ELCERT-KEY.
 14018
 14019     IF  BCERTNOL GREATER THAN ZEROS
 14020         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 14021
 14022     IF  BSUFIXL  GREATER THAN ZEROS
 14023         MOVE BSUFIXI            TO  PB-CERT-SFX.
 14024
 14025     IF BEFFDTL GREATER THAN ZEROS
 14026        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 14027
 14028 2870-WRITE-PENDING-BUSINESS.
 14029     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 14030     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14031     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 14032     MOVE '5'                    TO DC-OPTION-CODE.
 14033     PERFORM 9700-DATE-LINK.
 14034     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 14035
 14036     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14037
 14038     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 14039     MOVE 'A'                    TO JP-RECORD-TYPE.
 14040     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14041
 14042
 14043* EXEC CICS WRITE
 14044*        DATASET  (FILE-ID-ERPNDB)
 14045*        FROM     (PENDING-BUSINESS)
 14046*        RIDFLD   (PB-CONTROL-PRIMARY)
 14047*    END-EXEC.
 14048     MOVE LENGTH OF
 14049      PENDING-BUSINESS
 14050       TO DFHEIV11
 14051*    MOVE '&$ L                  ''   #00012232' TO DFHEIV0
 14052     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14054     MOVE X'2020233030303132323332' TO DFHEIV0(25:11)
 14055     CALL 'kxdfhei1' USING DFHEIV0,
 14056           FILE-ID-ERPNDB,
 14057           PENDING-BUSINESS,
 14058           DFHEIV11,
 14059           PB-CONTROL-PRIMARY,
 14060           DFHEIV99,
 14061           DFHEIV99
 14062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 264
* EL6311.cbl
 14063
 14064
 14065     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 14066
 14067     PERFORM 8400-LOG-JOURNAL-RECORD.
 14068
 14069     GO TO 1325-PROCESS-ISSUE-CHANGES.
 14070
 14071 2885-RECORD-MISSING.
 14072     MOVE -1                     TO BMAINTL
 14073     MOVE AL-UABON               TO BMAINTA
 14074     MOVE ER-2902                TO EMI-ERROR.
 14075     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14076     GO TO 8200-SEND-DATAONLY.
 14077
 14078 2890-DUPLICATE-RECORD.
 14079     MOVE -1                     TO BMAINTL.
 14080     MOVE AL-UABON               TO BCERTNOA.
 14081     MOVE AL-UNBON               TO BEFFDTA.
 14082     MOVE SPACE                  TO BMAINTI.
 14083
 14084     MOVE 1                      TO EMI-SUB
 14085                                    EMI-SWITCH1
 14086                                    EMI-SWITCH-AREA-1
 14087                                    EMI-SWITCH-AREA-2.
 14088
 14089     MOVE SPACES                 TO EMI-ERROR-LINES.
 14090
 14091
 14092* EXEC CICS SYNCPOINT ROLLBACK
 14093*    END-EXEC.
 14094*    MOVE '6"R                   !   #00012264' TO DFHEIV0
 14095     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14097     MOVE X'2020233030303132323634' TO DFHEIV0(25:11)
 14098     CALL 'kxdfhei1' USING DFHEIV0
 14099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14100
 14101
 14102     MOVE ER-2247                TO EMI-ERROR.
 14103     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 14104     GO TO 8200-SEND-DATAONLY.
 14105
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 265
* EL6311.cbl
 14107
 14108******************************************************************
 14109*                                                                *
 14110*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 14111*                                                                *
 14112******************************************************************
 14113
 14114 2900-REWRITE-CAN-CERT-KEY.
 14115     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 14116
 14117     IF  CCERTNOL GREATER THAN ZEROS
 14118         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 14119
 14120     IF  CSUFIXL  GREATER THAN ZEROS
 14121         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 14122
 14123     IF  CEFFDTL  GREATER THAN ZEROS
 14124         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 14125
 14126 2910-READ-BY-ACCOUNT.
 14127
 14128* EXEC CICS HANDLE CONDITION
 14129*         NOTFND    (2920-PROCESS-REWRITE)
 14130*    END-EXEC.
 14131*    MOVE '"$I                   ! @ #00012292' TO DFHEIV0
 14132     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14134     MOVE X'4020233030303132323932' TO DFHEIV0(25:11)
 14135     CALL 'kxdfhei1' USING DFHEIV0
 14136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14137
 14138
 14139
 14140* EXEC CICS READ
 14141*        SET     (ADDRESS OF PENDING-BUSINESS)
 14142*        DATASET (FILE-ID-ERPNDB2)
 14143*        RIDFLD  (ERPNDB-ALT-KEY)
 14144*    END-EXEC.
 14145*    MOVE '&"S        E          (   #00012296' TO DFHEIV0
 14146     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14148     MOVE X'2020233030303132323936' TO DFHEIV0(25:11)
 14149     CALL 'kxdfhei1' USING DFHEIV0,
 14150           FILE-ID-ERPNDB2,
 14151           DFHEIV20,
 14152           DFHEIV99,
 14153           ERPNDB-ALT-KEY,
 14154           DFHEIV99,
 14155           DFHEIV99,
 14156           DFHEIV99
 14157     SET ADDRESS OF PENDING-BUSINESS TO
 14158         DFHEIV20
 14159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14160
 14161
 14162     GO TO 2990-DUPLICATE-RECORD.
 14163
 14164  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 266
* EL6311.cbl
 14165
 14166* EXEC CICS HANDLE CONDITION
 14167*         NOTFND    (2985-RECORD-MISSING)
 14168*    END-EXEC.
 14169*    MOVE '"$I                   ! A #00012305' TO DFHEIV0
 14170     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14172     MOVE X'4120233030303132333035' TO DFHEIV0(25:11)
 14173     CALL 'kxdfhei1' USING DFHEIV0
 14174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14175
 14176
 14177     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14178
 14179
 14180* EXEC CICS READ
 14181*        SET     (ADDRESS OF PENDING-BUSINESS)
 14182*        DATASET (FILE-ID-ERPNDB)
 14183*        RIDFLD  (ERPNDB-KEY)
 14184*        UPDATE
 14185*    END-EXEC.
 14186*    MOVE '&"S        EU         (   #00012311' TO DFHEIV0
 14187     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14188     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14189     MOVE X'2020233030303132333131' TO DFHEIV0(25:11)
 14190     CALL 'kxdfhei1' USING DFHEIV0,
 14191           FILE-ID-ERPNDB,
 14192           DFHEIV20,
 14193           DFHEIV99,
 14194           ERPNDB-KEY,
 14195           DFHEIV99,
 14196           DFHEIV99,
 14197           DFHEIV99
 14198     SET ADDRESS OF PENDING-BUSINESS TO
 14199         DFHEIV20
 14200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14201
 14202
 14203     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14204     MOVE 'D'                    TO JP-RECORD-TYPE.
 14205     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14206     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14207
 14208     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14209
 14210     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14211     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14212     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14213
 14214
 14215* EXEC CICS DELETE
 14216*        DATASET    (FILE-ID-ERPNDB)
 14217*    END-EXEC.
 14218*    MOVE '&(                    &   #00012329' TO DFHEIV0
 14219     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14220     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14221     MOVE X'2020233030303132333239' TO DFHEIV0(25:11)
 14222     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 267
* EL6311.cbl
 14223           FILE-ID-ERPNDB,
 14224           DFHEIV99,
 14225           DFHEIV99,
 14226           DFHEIV99,
 14227           DFHEIV99
 14228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14229
 14230
 14231     PERFORM 8400-LOG-JOURNAL-RECORD.
 14232
 14233
 14234* EXEC CICS GETMAIN
 14235*        SET      (ADDRESS OF PENDING-BUSINESS)
 14236*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14237*        INITIMG  (GETMAIN-SPACE)
 14238*    END-EXEC.
 14239*    MOVE ',"IL                  $   #00012335' TO DFHEIV0
 14240     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14241     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14242     MOVE X'2020233030303132333335' TO DFHEIV0(25:11)
 14243     CALL 'kxdfhei1' USING DFHEIV0,
 14244           DFHEIV20,
 14245           ERPNDB-RECORD-LENGTH,
 14246           GETMAIN-SPACE
 14247     SET ADDRESS OF PENDING-BUSINESS TO
 14248         DFHEIV20
 14249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14250
 14251
 14252     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 14253
 14254 2950-PROCESS-CANCELS.
 14255
 14256
 14257* EXEC CICS HANDLE CONDITION
 14258*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 14259*    END-EXEC.
 14260*    MOVE '"$I                   ! B #00012345' TO DFHEIV0
 14261     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14263     MOVE X'4220233030303132333435' TO DFHEIV0(25:11)
 14264     CALL 'kxdfhei1' USING DFHEIV0
 14265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14266
 14267
 14268
 14269* EXEC CICS READ
 14270*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14271*        DATASET (FILE-ID-ELCERT)
 14272*        RIDFLD  (ELCERT-KEY)
 14273*        UPDATE
 14274*    END-EXEC.
 14275*    MOVE '&"S        EU         (   #00012349' TO DFHEIV0
 14276     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14277     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14278     MOVE X'2020233030303132333439' TO DFHEIV0(25:11)
 14279     CALL 'kxdfhei1' USING DFHEIV0,
 14280           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 268
* EL6311.cbl
 14281           DFHEIV20,
 14282           DFHEIV99,
 14283           ELCERT-KEY,
 14284           DFHEIV99,
 14285           DFHEIV99,
 14286           DFHEIV99
 14287     SET ADDRESS OF CERTIFICATE-MASTER TO
 14288         DFHEIV20
 14289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14290
 14291
 14292     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 14293
 14294     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 14295     MOVE 'B'                      TO JP-RECORD-TYPE.
 14296     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 14297     PERFORM 8400-LOG-JOURNAL-RECORD.
 14298
 14299     IF PB-CI-LIVES NOT NUMERIC
 14300         MOVE ZERO                    TO PB-CI-LIVES.
 14301
 14302     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 14303        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 14304        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 14305        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 14306                                         CM-LF-CANCEL-DT
 14307     ELSE
 14308        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 14309        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 14310        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 14311        MOVE PB-CI-LIVES              TO CM-LIVES.
 14312
 14313     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 14314        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 14315            MOVE CM-LF-STATUS-AT-CANCEL
 14316                                     TO CM-LF-CURRENT-STATUS
 14317            MOVE SPACE
 14318                                     TO CM-LF-STATUS-AT-CANCEL
 14319        ELSE
 14320            MOVE PB-CI-LF-POLICY-STATUS
 14321                                     TO CM-LF-CURRENT-STATUS
 14322     ELSE
 14323        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 14324
 14325     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 14326        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 14327        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 14328        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 14329                                         CM-AH-CANCEL-DT
 14330     ELSE
 14331        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 14332        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 14333        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 14334        MOVE PB-CI-LIVES              TO CM-LIVES.
 14335
 14336     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 14337        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 14338            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 269
* EL6311.cbl
 14339                                     TO CM-AH-CURRENT-STATUS
 14340            MOVE SPACE
 14341                                     TO CM-AH-STATUS-AT-CANCEL
 14342        ELSE
 14343            MOVE PB-CI-AH-POLICY-STATUS
 14344                                     TO CM-AH-CURRENT-STATUS
 14345     ELSE
 14346        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 14347
 14348 2975-REWRITE-CERT.
 14349     MOVE 'C'                      TO JP-RECORD-TYPE.
 14350     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 14351
 14352
 14353* EXEC CICS REWRITE
 14354*        DATASET    (FILE-ID-ELCERT)
 14355*        FROM       (CERTIFICATE-MASTER)
 14356*    END-EXEC.
 14357     MOVE LENGTH OF
 14358      CERTIFICATE-MASTER
 14359       TO DFHEIV11
 14360*    MOVE '&& L                  %   #00012416' TO DFHEIV0
 14361     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14363     MOVE X'2020233030303132343136' TO DFHEIV0(25:11)
 14364     CALL 'kxdfhei1' USING DFHEIV0,
 14365           FILE-ID-ELCERT,
 14366           CERTIFICATE-MASTER,
 14367           DFHEIV11,
 14368           DFHEIV99
 14369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14370
 14371
 14372     PERFORM 8400-LOG-JOURNAL-RECORD.
 14373
 14374 2960-BUILD-NEW-CANCEL-RECORD.
 14375     IF  CCERTNOL GREATER THAN ZEROS
 14376         MOVE CCERTNOI            TO PB-CERT-PRIME.
 14377
 14378     IF  CSUFIXL  GREATER THAN ZEROS
 14379         MOVE CSUFIXI             TO PB-CERT-SFX.
 14380
 14381     IF  CEFFDTL  GREATER  THAN ZEROS
 14382         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 14383
 14384 2970-WRITE-PENDING-BUSINESS.
 14385     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 14386     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14387     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 14388     MOVE '5'                    TO DC-OPTION-CODE.
 14389     PERFORM 9700-DATE-LINK.
 14390     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 14391
 14392     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14393
 14394     MOVE SPACES                 TO PB-CI-INSURED-NAME
 14395                                    PB-CI-INSURED-SEX
 14396                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 270
* EL6311.cbl
 14397                                    PB-CI-AH-BENEFIT-CD
 14398                                    PB-CI-RATE-CLASS
 14399                                    PB-CI-RATE-DEV-LF
 14400                                    PB-CI-RATE-DEV-AH
 14401                                    PB-CI-LF-ABBR
 14402                                    PB-CI-AH-ABBR
 14403                                    PB-CI-OB-FLAG
 14404                                    PB-CI-LF-POLICY-STATUS
 14405                                    PB-CI-AH-POLICY-STATUS
 14406                                    PB-CI-INDV-GRP-CD
 14407                                    PB-CI-BENEFICIARY-NAME
 14408                                    PB-CI-NOTE-SW
 14409                                    PB-CI-SOC-SEC-NO
 14410                                    PB-CI-MEMBER-NO
 14411                                    PB-CI-INT-CODE
 14412                                    PB-CI-COMP-EXCP-SW
 14413                                    PB-CI-ENTRY-STATUS
 14414                                    PB-CI-CREDIT-INTERFACE-SW-1
 14415                                    PB-CI-CREDIT-INTERFACE-SW-2
 14416                                    PB-CI-ENTRY-BATCH.
 14417
 14418     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14419                                    PB-CI-AH-SETTLEMENT-DT
 14420                                    PB-CI-DEATH-DT
 14421                                    PB-CI-LF-PRIOR-CANCEL-DT
 14422                                    PB-CI-AH-PRIOR-CANCEL-DT
 14423                                    PB-CI-LOAN-1ST-PMT-DT
 14424                                    PB-CI-ENTRY-DT
 14425                                    PB-CI-LF-EXPIRE-DT
 14426                                    PB-CI-AH-EXPIRE-DT.
 14427
 14428     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 14429                                    PB-CI-LF-TERM
 14430                                    PB-CI-LF-BENEFIT-AMT
 14431                                    PB-CI-LF-ALT-BENEFIT-AMT
 14432                                    PB-CI-LF-PREMIUM-AMT
 14433                                    PB-CI-LF-ALT-PREMIUM-AMT
 14434                                    PB-CI-AH-TERM
 14435                                    PB-CI-AH-BENEFIT-AMT
 14436                                    PB-CI-AH-PREMIUM-AMT
 14437                                    PB-CI-RATE-DEV-PCT-LF
 14438                                    PB-CI-RATE-DEV-PCT-AH
 14439                                    PB-CI-LIFE-COMMISSION
 14440                                    PB-CI-AH-COMMISSION
 14441                                    PB-CI-PAY-FREQUENCY
 14442                                    PB-CI-LOAN-APR
 14443                                    PB-CI-LOAN-TERM
 14444                                    PB-CI-CURR-SEQ
 14445                                    PB-CI-AH-CANCEL-AMT
 14446                                    PB-CI-LF-CANCEL-AMT
 14447                                    PB-CI-EXTENTION-DAYS
 14448                                    PB-CI-TERM-IN-DAYS
 14449                                    PB-CI-LOAN-OFFICER
 14450                                    PB-CI-LIVES
 14451                                    PB-CI-LF-CRIT-PER
 14452                                    PB-CI-AH-CRIT-PER
 14453                                    PB-C-LF-REM-TERM
 14454                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 271
* EL6311.cbl
 14455
 14456     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 14457     MOVE 'A'                    TO JP-RECORD-TYPE.
 14458     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14459
 14460
 14461* EXEC CICS HANDLE CONDITION
 14462*        DUPREC   (2990-DUPLICATE-RECORD)
 14463*    END-EXEC.
 14464*    MOVE '"$%                   ! C #00012509' TO DFHEIV0
 14465     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14467     MOVE X'4320233030303132353039' TO DFHEIV0(25:11)
 14468     CALL 'kxdfhei1' USING DFHEIV0
 14469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14470
 14471
 14472
 14473* EXEC CICS WRITE
 14474*        DATASET  (FILE-ID-ERPNDB)
 14475*        FROM     (PENDING-BUSINESS)
 14476*        RIDFLD   (PB-CONTROL-PRIMARY)
 14477*    END-EXEC.
 14478     MOVE LENGTH OF
 14479      PENDING-BUSINESS
 14480       TO DFHEIV11
 14481*    MOVE '&$ L                  ''   #00012513' TO DFHEIV0
 14482     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14483     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14484     MOVE X'2020233030303132353133' TO DFHEIV0(25:11)
 14485     CALL 'kxdfhei1' USING DFHEIV0,
 14486           FILE-ID-ERPNDB,
 14487           PENDING-BUSINESS,
 14488           DFHEIV11,
 14489           PB-CONTROL-PRIMARY,
 14490           DFHEIV99,
 14491           DFHEIV99
 14492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14493
 14494
 14495     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 14496
 14497     PERFORM 8400-LOG-JOURNAL-RECORD.
 14498
 14499     GO TO 2325-PROCESS-CANCEL-CHANGES.
 14500
 14501 2985-RECORD-MISSING.
 14502     MOVE -1                     TO CMAINTL
 14503     MOVE AL-UABON               TO CMAINTA.
 14504
 14505     MOVE ER-2902                TO EMI-ERROR.
 14506     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14507     GO TO 8200-SEND-DATAONLY.
 14508
 14509 2990-DUPLICATE-RECORD.
 14510     MOVE SPACE                  TO CMAINTI.
 14511     MOVE -1                     TO CMAINTL.
 14512     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 272
* EL6311.cbl
 14513     MOVE AL-UNBON               TO CEFFDTA.
 14514
 14515     MOVE 1                      TO EMI-SUB
 14516                                    EMI-SWITCH1
 14517                                    EMI-SWITCH-AREA-1
 14518                                    EMI-SWITCH-AREA-2.
 14519     MOVE SPACES                 TO EMI-ERROR-LINES.
 14520
 14521
 14522* EXEC CICS SYNCPOINT ROLLBACK
 14523*    END-EXEC.
 14524*    MOVE '6"R                   !   #00012545' TO DFHEIV0
 14525     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14527     MOVE X'2020233030303132353435' TO DFHEIV0(25:11)
 14528     CALL 'kxdfhei1' USING DFHEIV0
 14529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14530
 14531
 14532     MOVE ER-2247                TO EMI-ERROR.
 14533     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14534     GO TO 8200-SEND-DATAONLY.
 14535
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 273
* EL6311.cbl
 14537
 14538***************************************************************
 14539*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 14540*     PREMIUM FOR A SINGLE BATCH.                             *
 14541*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 14542***************************************************************
 14543
 14544 3000-BATCH-MAINLINE.
 14545     IF PI-PREV-KEY NOT = SPACES
 14546         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 14547     ELSE
 14548         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 14549
 14550     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 14551
 14552 3010-READNEXT.
 14553
 14554* EXEC CICS READ
 14555*         DATASET    (FILE-ID-ERPNDB)
 14556*         SET        (ADDRESS OF PENDING-BUSINESS)
 14557*         RIDFLD     (ERPNDB-KEY)
 14558*         GTEQ
 14559*    END-EXEC.
 14560*    MOVE '&"S        G          (   #00012569' TO DFHEIV0
 14561     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14563     MOVE X'2020233030303132353639' TO DFHEIV0(25:11)
 14564     CALL 'kxdfhei1' USING DFHEIV0,
 14565           FILE-ID-ERPNDB,
 14566           DFHEIV20,
 14567           DFHEIV99,
 14568           ERPNDB-KEY,
 14569           DFHEIV99,
 14570           DFHEIV99,
 14571           DFHEIV99
 14572     SET ADDRESS OF PENDING-BUSINESS TO
 14573         DFHEIV20
 14574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14575
 14576
 14577     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 14578        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 14579          GO TO 3030-END-BATCH.
 14580
 14581     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 14582
 14583     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 14584        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 14585          GO TO 3020-BUMP-SEQ.
 14586
 14587     IF PB-ISSUE
 14588        ADD +1                   TO WS-ISS-TOTAL-CNT
 14589        IF PB-FATAL-ERRORS
 14590           ADD +1                      TO WS-ISS-FATAL-CNT
 14591           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 14592           GO TO 3020-BUMP-SEQ
 14593        ELSE
 14594           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 274
* EL6311.cbl
 14595              ADD +1                      TO WS-ISS-FORCE-CNT
 14596              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 14597              GO TO 3020-BUMP-SEQ
 14598           ELSE
 14599              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 14600                 ADD +1                      TO WS-ISS-HOLD-CNT
 14601                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 14602                 GO TO 3020-BUMP-SEQ
 14603              ELSE
 14604                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 14605                     THRU  3299-EXIT
 14606                 GO TO 3020-BUMP-SEQ.
 14607
 14608     IF PB-CANCELLATION
 14609        ADD +1                   TO WS-CAN-TOTAL-CNT
 14610        IF PB-FATAL-ERRORS
 14611           ADD +1                 TO WS-CAN-FATAL-CNT
 14612           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 14613           GO TO 3020-BUMP-SEQ
 14614        ELSE
 14615           IF PB-UNFORCED-ERRORS
 14616              ADD +1                 TO WS-CAN-FORCE-CNT
 14617              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 14618              GO TO 3020-BUMP-SEQ
 14619           ELSE
 14620              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 14621                 ADD +1                 TO WS-CAN-HOLD-CNT
 14622                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 14623                 GO TO 3020-BUMP-SEQ
 14624              ELSE
 14625                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 14626                     THRU  3499-EXIT
 14627                 GO TO 3020-BUMP-SEQ.
 14628
 14629     IF PB-BATCH-TRAILER
 14630         GO TO 3030-END-BATCH.
 14631
 14632 3020-BUMP-SEQ.
 14633     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 14634     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14635     GO TO 3010-READNEXT.
 14636
 14637 3030-END-BATCH.
 14638     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 14639     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 14640     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 14641     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 14642
 14643     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 14644                                          - WS-ISS-FORCE-CNT
 14645                                          - WS-ISS-HOLD-CNT).
 14646
 14647     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 14648     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 14649
 14650     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 14651     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 14652     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 275
* EL6311.cbl
 14653     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 14654     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 14655                                          - WS-CAN-FORCE-CNT
 14656                                          - WS-CAN-HOLD-CNT).
 14657     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 14658     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 14659
 14660     COMPUTE WS-NET-TOTAL-CNT
 14661         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 14662     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 14663     COMPUTE WS-NET-FATAL-CNT
 14664         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 14665     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 14666     COMPUTE WS-NET-FORCE-CNT
 14667         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 14668     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 14669     COMPUTE WS-NET-HOLD-CNT
 14670         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 14671     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 14672
 14673     COMPUTE WS-NET-AVAIL-CNT
 14674          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 14675                              - WS-ISS-FORCE-CNT
 14676                              - WS-ISS-HOLD-CNT)
 14677          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 14678                              - WS-CAN-FORCE-CNT
 14679                              - WS-CAN-HOLD-CNT).
 14680     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 14681
 14682     COMPUTE WS-NET-GOOD-PREM
 14683         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 14684     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 14685     COMPUTE WS-NET-BAD-PREM
 14686         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 14687     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 14688
 14689     MOVE 0000                   TO EMI-ERROR.
 14690     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14691     MOVE -1                     TO DPFENTRL.
 14692     GO TO 8200-SEND-DATAONLY.
 14693
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 276
* EL6311.cbl
 14695
 14696******************************************************************
 14697*                                                                *
 14698*           A D D    B A D   I S S U E   P R E M I U M           *
 14699*                                                                *
 14700******************************************************************
 14701
 14702 3100-ADD-BAD-ISSUE-PREM.
 14703     IF PB-OVERRIDE-LIFE
 14704       OR PB-OVERRIDE-BOTH
 14705           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 14706           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 14707       ELSE
 14708           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 14709           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 14710
 14711     IF PB-OVERRIDE-AH
 14712       OR PB-OVERRIDE-BOTH
 14713           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 14714       ELSE
 14715           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 14716
 14717 3199-EXIT.
 14718     EXIT.
 14719
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 277
* EL6311.cbl
 14721
 14722******************************************************************
 14723*                                                                *
 14724*       A D D   G O O D   I S S U E   P R E M I U M              *
 14725*                                                                *
 14726******************************************************************
 14727
 14728 3200-ADD-GOOD-ISSUE-PREM.
 14729     IF PB-OVERRIDE-LIFE
 14730       OR PB-OVERRIDE-BOTH
 14731           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 14732           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 14733       ELSE
 14734           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 14735           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 14736
 14737     IF PB-OVERRIDE-AH
 14738       OR PB-OVERRIDE-BOTH
 14739           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 14740       ELSE
 14741           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 14742
 14743 3299-EXIT.
 14744     EXIT.
 14745
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 278
* EL6311.cbl
 14747
 14748
 14749******************************************************************
 14750*                                                                *
 14751*        A D D   B A D   C A N C E L   P R E M I U M             *
 14752*                                                                *
 14753******************************************************************
 14754
 14755 3300-ADD-BAD-CANCEL-PREM.
 14756     IF PB-OVERRIDE-LIFE
 14757       OR PB-OVERRIDE-BOTH
 14758           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 14759       ELSE
 14760           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 14761
 14762     IF PB-OVERRIDE-AH
 14763       OR PB-OVERRIDE-BOTH
 14764           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 14765       ELSE
 14766           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 14767
 14768 3399-EXIT.
 14769     EXIT.
 14770
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 279
* EL6311.cbl
 14772
 14773******************************************************************
 14774*                                                                *
 14775*       A D D   G O O D   C A N C E L   P R E M I U M            *
 14776*                                                                *
 14777******************************************************************
 14778
 14779 3400-ADD-GOOD-CANCEL-PREM.
 14780     IF PB-OVERRIDE-LIFE
 14781       OR PB-OVERRIDE-BOTH
 14782           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 14783       ELSE
 14784           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 14785
 14786     IF PB-OVERRIDE-AH
 14787       OR PB-OVERRIDE-BOTH
 14788           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 14789       ELSE
 14790           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 14791
 14792 3499-EXIT.
 14793     EXIT.
 14794
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 280
* EL6311.cbl
 14796
 14797******************************************************************
 14798*                                                                *
 14799*           E D I T   B A T C H   D A T A                        *
 14800*                                                                *
 14801******************************************************************
 14802
 14803 3500-EDIT-BATCH-DATA.
 14804     IF PI-PREV-KEY NOT = SPACES
 14805        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 14806     ELSE
 14807        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 14808
 14809     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14810     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14811
 14812
 14813* EXEC CICS HANDLE CONDITION
 14814*         NOTFND      (3590-NOT-FOUND)
 14815*    END-EXEC.
 14816*    MOVE '"$I                   ! D #00012811' TO DFHEIV0
 14817     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14819     MOVE X'4420233030303132383131' TO DFHEIV0(25:11)
 14820     CALL 'kxdfhei1' USING DFHEIV0
 14821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14822
 14823
 14824     IF DRISSL   GREATER THAN ZEROS OR
 14825        DRISSL   GREATER THAN ZEROS OR
 14826        DRLFPRML GREATER THAN ZEROS OR
 14827        DRAHPRML GREATER THAN ZEROS OR
 14828        DRCANCL  GREATER THAN ZEROS OR
 14829        DRLFRFDL GREATER THAN ZEROS OR
 14830        DRAHRFDL GREATER THAN ZEROS
 14831              NEXT SENTENCE
 14832          ELSE
 14833              MOVE ER-3224    TO EMI-ERROR
 14834              MOVE -1         TO DPFENTRL
 14835              MOVE AL-UNBON   TO DPFENTRA
 14836              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14837              GO TO 8200-SEND-DATAONLY.
 14838
 14839     IF NOT MODIFY-CAP
 14840         MOVE 'UPDATE'       TO SM-READ
 14841         PERFORM 9995-SECURITY-VIOLATION
 14842         MOVE ER-0070        TO EMI-ERROR
 14843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14844         GO TO 8100-SEND-INITIAL-MAP.
 14845
 14846        IF DRISSL GREATER THAN ZEROS
 14847           MOVE AL-UNNON         TO DRISSA
 14848           MOVE DRISSI           TO DEEDIT-FIELD
 14849           PERFORM 8600-DEEDIT
 14850           IF DEEDIT-FIELD-V0  NUMERIC
 14851              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 14852           ELSE
 14853              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 281
* EL6311.cbl
 14854              MOVE -1         TO DRISSL
 14855              MOVE AL-UNBON   TO DRISSA
 14856              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14857
 14858        IF DRLFPRML GREATER THAN ZEROS
 14859           MOVE AL-UNNON         TO DRLFPRMA
 14860
 14861* EXEC CICS BIF DEEDIT
 14862*              FIELD  (DRLFPRMI)
 14863*              LENGTH (11)
 14864*          END-EXEC
 14865     MOVE 11
 14866       TO DFHEIV11
 14867*    MOVE '@"L                   #   #00012851' TO DFHEIV0
 14868     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14869     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14870     MOVE X'2020233030303132383531' TO DFHEIV0(25:11)
 14871     CALL 'kxdfhei1' USING DFHEIV0,
 14872           DRLFPRMI,
 14873           DFHEIV11
 14874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14875           IF DRLFPRMI NUMERIC
 14876              MOVE DRLFPRMI   TO WS-DRLFPRM
 14877*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 14878*          PERFORM 8600-DEEDIT
 14879*          IF DEEDIT-FIELD-V2  NUMERIC
 14880*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 14881           ELSE
 14882              MOVE ER-2223    TO EMI-ERROR
 14883              MOVE -1         TO DRLFPRML
 14884              MOVE AL-UNBON   TO DRLFPRMA
 14885              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14886
 14887        IF DRAHPRML GREATER THAN ZEROS
 14888           MOVE AL-UNNON         TO DRAHPRMA
 14889
 14890* EXEC CICS BIF DEEDIT
 14891*              FIELD  (DRAHPRMI)
 14892*              LENGTH (11)
 14893*          END-EXEC
 14894     MOVE 11
 14895       TO DFHEIV11
 14896*    MOVE '@"L                   #   #00012869' TO DFHEIV0
 14897     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14898     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14899     MOVE X'2020233030303132383639' TO DFHEIV0(25:11)
 14900     CALL 'kxdfhei1' USING DFHEIV0,
 14901           DRAHPRMI,
 14902           DFHEIV11
 14903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14904           IF DRAHPRMI NUMERIC
 14905              MOVE DRAHPRMI   TO WS-DRAHPRM
 14906*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 14907*          PERFORM 8600-DEEDIT
 14908*          IF DEEDIT-FIELD-V2  NUMERIC
 14909*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 14910           ELSE
 14911              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 282
* EL6311.cbl
 14912              MOVE -1         TO DRAHPRML
 14913              MOVE AL-UNBON   TO DRAHPRMA
 14914              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14915
 14916        IF DRCANCL GREATER THAN ZEROS
 14917           MOVE AL-UNNON         TO DRCANCA
 14918           MOVE DRCANCI          TO DEEDIT-FIELD
 14919           PERFORM 8600-DEEDIT
 14920           IF DEEDIT-FIELD-V0  NUMERIC
 14921              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 14922           ELSE
 14923              MOVE ER-2223    TO EMI-ERROR
 14924              MOVE -1         TO DRCANCL
 14925              MOVE AL-UNBON   TO DRCANCL
 14926              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14927
 14928        IF DRLFRFDL GREATER THAN ZEROS
 14929           MOVE AL-UNNON         TO DRLFRFDA
 14930
 14931* EXEC CICS BIF DEEDIT
 14932*              FIELD  (DRLFRFDI)
 14933*              LENGTH (11)
 14934*          END-EXEC
 14935     MOVE 11
 14936       TO DFHEIV11
 14937*    MOVE '@"L                   #   #00012899' TO DFHEIV0
 14938     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14939     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14940     MOVE X'2020233030303132383939' TO DFHEIV0(25:11)
 14941     CALL 'kxdfhei1' USING DFHEIV0,
 14942           DRLFRFDI,
 14943           DFHEIV11
 14944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14945           IF DRLFRFDI NUMERIC
 14946              MOVE DRLFRFDI   TO WS-DRLFRFD
 14947*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 14948*          PERFORM 8600-DEEDIT
 14949*          IF DEEDIT-FIELD-V2  NUMERIC
 14950*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 14951           ELSE
 14952              MOVE ER-2223    TO EMI-ERROR
 14953              MOVE -1         TO DRLFRFDL
 14954              MOVE AL-UNBON   TO DRLFRFDA
 14955              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14956
 14957        IF DRAHRFDL GREATER THAN ZEROS
 14958           MOVE AL-UNNON         TO DRAHRFDA
 14959
 14960* EXEC CICS BIF DEEDIT
 14961*              FIELD  (DRAHRFDI)
 14962*              LENGTH (11)
 14963*          END-EXEC
 14964     MOVE 11
 14965       TO DFHEIV11
 14966*    MOVE '@"L                   #   #00012917' TO DFHEIV0
 14967     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14968     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14969     MOVE X'2020233030303132393137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 283
* EL6311.cbl
 14970     CALL 'kxdfhei1' USING DFHEIV0,
 14971           DRAHRFDI,
 14972           DFHEIV11
 14973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14974           IF DRAHRFDI NUMERIC
 14975              MOVE DRAHRFDI   TO WS-DRAHRFD
 14976*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 14977*          PERFORM 8600-DEEDIT
 14978*          IF DEEDIT-FIELD-V2  NUMERIC
 14979*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 14980           ELSE
 14981              MOVE ER-2223    TO EMI-ERROR
 14982              MOVE -1         TO DRAHRFDL
 14983              MOVE AL-UNBON   TO DRAHRFDA
 14984              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14985
 14986     IF EMI-ERROR = ZEROS
 14987        GO 3600-UPDATE-BATCH-HEADER.
 14988
 14989     GO TO 8200-SEND-DATAONLY.
 14990
 14991 3590-NOT-FOUND.
 14992     MOVE ER-2192                TO EMI-ERROR.
 14993     MOVE -1                     TO DPFENTRL.
 14994     MOVE AL-UNBON               TO DPFENTRA.
 14995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14996     GO TO 8200-SEND-DATAONLY.
 14997
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 284
* EL6311.cbl
 14999
 15000******************************************************************
 15001*                                                                *
 15002*           U P D A T E   B A T C H   H E A D E R                *
 15003*                                                                *
 15004******************************************************************
 15005
 15006 3600-UPDATE-BATCH-HEADER.
 15007
 15008* EXEC CICS HANDLE CONDITION
 15009*         NOTFND      (3690-NOT-FOUND)
 15010*    END-EXEC.
 15011*    MOVE '"$I                   ! E #00012954' TO DFHEIV0
 15012     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15014     MOVE X'4520233030303132393534' TO DFHEIV0(25:11)
 15015     CALL 'kxdfhei1' USING DFHEIV0
 15016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15017
 15018
 15019
 15020* EXEC CICS READ
 15021*        DATASET (FILE-ID-ERPNDB)
 15022*        RIDFLD  (ERPNDB-KEY)
 15023*        SET     (ADDRESS OF PENDING-BUSINESS)
 15024*        UPDATE
 15025*    END-EXEC.
 15026*    MOVE '&"S        EU         (   #00012958' TO DFHEIV0
 15027     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15028     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15029     MOVE X'2020233030303132393538' TO DFHEIV0(25:11)
 15030     CALL 'kxdfhei1' USING DFHEIV0,
 15031           FILE-ID-ERPNDB,
 15032           DFHEIV20,
 15033           DFHEIV99,
 15034           ERPNDB-KEY,
 15035           DFHEIV99,
 15036           DFHEIV99,
 15037           DFHEIV99
 15038     SET ADDRESS OF PENDING-BUSINESS TO
 15039         DFHEIV20
 15040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15041
 15042
 15043     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15044     MOVE 'B'                    TO JP-RECORD-TYPE.
 15045     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15046
 15047     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15048
 15049     PERFORM 8400-LOG-JOURNAL-RECORD.
 15050
 15051     IF DRISSL GREATER THAN ZEROS
 15052        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 15053
 15054     IF DRCANCL GREATER THAN ZEROS
 15055        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 15056
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 285
* EL6311.cbl
 15057
 15058     IF DRLFPRML GREATER THAN ZEROS
 15059        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 15060
 15061     IF DRAHPRML GREATER THAN ZEROS
 15062        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 15063
 15064     IF DRLFRFDL GREATER THAN ZEROS
 15065        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 15066
 15067     IF DRAHRFDL GREATER THAN ZEROS
 15068        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 15069
 15070 3670-REWRITE-BATCH-HEADER.
 15071     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 15072        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 15073        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 15074        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 15075        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 15076        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 15077        MOVE SPACE               TO PB-OUT-BAL-CD
 15078     ELSE
 15079        MOVE 'O'                 TO PB-OUT-BAL-CD.
 15080
 15081     MOVE 'C'                    TO JP-RECORD-TYPE.
 15082     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15083
 15084
 15085* EXEC CICS REWRITE
 15086*         DATASET      (FILE-ID-ERPNDB)
 15087*         FROM         (PENDING-BUSINESS)
 15088*    END-EXEC.
 15089     MOVE LENGTH OF
 15090      PENDING-BUSINESS
 15091       TO DFHEIV11
 15092*    MOVE '&& L                  %   #00013006' TO DFHEIV0
 15093     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15094     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15095     MOVE X'2020233030303133303036' TO DFHEIV0(25:11)
 15096     CALL 'kxdfhei1' USING DFHEIV0,
 15097           FILE-ID-ERPNDB,
 15098           PENDING-BUSINESS,
 15099           DFHEIV11,
 15100           DFHEIV99
 15101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15102
 15103
 15104     PERFORM 8400-LOG-JOURNAL-RECORD.
 15105
 15106     GO TO 7200-DISPLAY-BATCHES.
 15107
 15108 3690-NOT-FOUND.
 15109     MOVE ER-2192                TO EMI-ERROR.
 15110     MOVE -1                     TO DPFENTRL.
 15111     MOVE AL-UNBON               TO DPFENTRA.
 15112     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15113     GO TO 8200-SEND-DATAONLY.
 15114
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 286
* EL6311.cbl
 15116
 15117******************************************************************
 15118*                                                                *
 15119*           R E - D I S P L A Y   R E C O R D                    *
 15120*                                                                *
 15121******************************************************************
 15122
 15123 3900-RE-DISPLAY-RECORD.
 15124
 15125* EXEC CICS HANDLE CONDITION
 15126*         NOTFND   (3990-NOT-FOUND)
 15127*    END-EXEC.
 15128*    MOVE '"$I                   ! F #00013031' TO DFHEIV0
 15129     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15131     MOVE X'4620233030303133303331' TO DFHEIV0(25:11)
 15132     CALL 'kxdfhei1' USING DFHEIV0
 15133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15134
 15135
 15136     IF PI-DISPLAY-ORIGINAL-BATCH
 15137         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 15138     ELSE
 15139         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 15140
 15141
 15142* EXEC CICS READ
 15143*         DATASET   (FILE-ID)
 15144*         RIDFLD    (PI-PREV-KEY)
 15145*         SET       (ADDRESS OF PENDING-BUSINESS)
 15146*    END-EXEC.
 15147*    MOVE '&"S        E          (   #00013040' TO DFHEIV0
 15148     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15150     MOVE X'2020233030303133303430' TO DFHEIV0(25:11)
 15151     CALL 'kxdfhei1' USING DFHEIV0,
 15152           FILE-ID,
 15153           DFHEIV20,
 15154           DFHEIV99,
 15155           PI-PREV-KEY,
 15156           DFHEIV99,
 15157           DFHEIV99,
 15158           DFHEIV99
 15159     SET ADDRESS OF PENDING-BUSINESS TO
 15160         DFHEIV20
 15161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15162
 15163
 15164     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 15165
 15166     IF PB-ISSUE
 15167         GO TO 7000-DISPLAY-ISSUES.
 15168
 15169     IF PB-CANCELLATION
 15170         GO TO 7100-DISPLAY-CANCELS.
 15171
 15172     IF PB-BATCH-TRAILER
 15173         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 287
* EL6311.cbl
 15174
 15175 3990-NOT-FOUND.
 15176     MOVE LOW-VALUES             TO EL631BI.
 15177
 15178     IF PI-MAP-NAME = EL631B
 15179         MOVE -1                  TO BMAINTL
 15180     ELSE
 15181         MOVE -1                  TO CMAINTL.
 15182
 15183     GO TO 8100-SEND-INITIAL-MAP.
 15184
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 288
* EL6311.cbl
 15186
 15187***************************************************************
 15188*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 15189*                                                             *
 15190*      1. START BROWSE WITH                                   *
 15191*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 15192*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 15193*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 15194*                                                             *
 15195*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 15196*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 15197*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 15198*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 15199*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 15200*               AND IS IT TO BE DISPLAYED.                    *
 15201*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 15202*               DISPLAYED.                                    *
 15203*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 15204*               DISPLAYED.                                    *
 15205*                                                             *
 15206*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 15207*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 15208***************************************************************
 15209
 15210 4000-BROWSE-DETAIL-FORWARD.
 15211     IF FIRST-TIME
 15212        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 15213     ELSE
 15214        IF SHOW-RECORD
 15215           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 15216           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 15217           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 15218           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 15219           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 15220        ELSE
 15221           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 15222
 15223
 15224* EXEC CICS HANDLE CONDITION
 15225*         NOTFND   (4050-END-RECORDS)
 15226*         ENDFILE  (4050-END-RECORDS)
 15227*    END-EXEC.
 15228*    MOVE '"$I''                  ! G #00013105' TO DFHEIV0
 15229     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15231     MOVE X'4720233030303133313035' TO DFHEIV0(25:11)
 15232     CALL 'kxdfhei1' USING DFHEIV0
 15233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15234
 15235
 15236
 15237* EXEC CICS STARTBR
 15238*         DATASET   (FILE-ID-ERPNDB2)
 15239*         RIDFLD    (ERPNDB-ALT-KEY)
 15240*    END-EXEC.
 15241     MOVE 0
 15242       TO DFHEIV11
 15243*    MOVE '&,         G          &   #00013110' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 289
* EL6311.cbl
 15244     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15245     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15246     MOVE X'2020233030303133313130' TO DFHEIV0(25:11)
 15247     CALL 'kxdfhei1' USING DFHEIV0,
 15248           FILE-ID-ERPNDB2,
 15249           ERPNDB-ALT-KEY,
 15250           DFHEIV99,
 15251           DFHEIV11,
 15252           DFHEIV99
 15253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15254
 15255
 15256     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 15257
 15258     IF FIRST-TIME OR SHOW-RECORD
 15259        MOVE SPACE               TO WS-FIRST-TIME-SW
 15260        GO TO 4005-READ-NEXT-RECORD.
 15261
 15262
 15263* EXEC CICS READNEXT
 15264*         DATASET    (FILE-ID-ERPNDB2)
 15265*         SET        (ADDRESS OF PENDING-BUSINESS)
 15266*         RIDFLD     (ERPNDB-ALT-KEY)
 15267*    END-EXEC.
 15268     MOVE 0
 15269       TO DFHEIV11
 15270*    MOVE '&.S                   )   #00013121' TO DFHEIV0
 15271     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15272     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15273     MOVE X'2020233030303133313231' TO DFHEIV0(25:11)
 15274     CALL 'kxdfhei1' USING DFHEIV0,
 15275           FILE-ID-ERPNDB2,
 15276           DFHEIV20,
 15277           DFHEIV99,
 15278           ERPNDB-ALT-KEY,
 15279           DFHEIV99,
 15280           DFHEIV11,
 15281           DFHEIV99,
 15282           DFHEIV99
 15283     SET ADDRESS OF PENDING-BUSINESS TO
 15284         DFHEIV20
 15285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15286
 15287
 15288 4005-READ-NEXT-RECORD.
 15289
 15290* EXEC CICS READNEXT
 15291*         DATASET    (FILE-ID-ERPNDB2)
 15292*         SET        (ADDRESS OF PENDING-BUSINESS)
 15293*         RIDFLD     (ERPNDB-ALT-KEY)
 15294*    END-EXEC.
 15295     MOVE 0
 15296       TO DFHEIV11
 15297*    MOVE '&.S                   )   #00013128' TO DFHEIV0
 15298     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15299     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15300     MOVE X'2020233030303133313238' TO DFHEIV0(25:11)
 15301     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 290
* EL6311.cbl
 15302           FILE-ID-ERPNDB2,
 15303           DFHEIV20,
 15304           DFHEIV99,
 15305           ERPNDB-ALT-KEY,
 15306           DFHEIV99,
 15307           DFHEIV11,
 15308           DFHEIV99,
 15309           DFHEIV99
 15310     SET ADDRESS OF PENDING-BUSINESS TO
 15311         DFHEIV20
 15312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15313
 15314
 15315     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 15316
 15317     IF WS-BATCH-PREFIX = '#CL'
 15318        GO TO 4005-READ-NEXT-RECORD.
 15319
 15320     IF SHOW-RECORD
 15321        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 15322           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 15323           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 15324           PB-STATE         NOT = PI-PB-STATE          OR
 15325           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 15326           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 15327           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 15328           GO TO 4050-END-RECORDS
 15329        ELSE
 15330           GO TO 4010-CHECK-REC-TYPE.
 15331
 15332     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 15333        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 15334        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 15335        PB-STATE            NOT = PI-PB-STATE          OR
 15336        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 15337        GO TO 4050-END-RECORDS.
 15338
 15339     IF PB-BATCH-TRAILER
 15340        GO TO 4005-READ-NEXT-RECORD.
 15341
 15342     IF PI-PB-CERT-NO NOT = LOW-VALUES
 15343        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 15344           GO TO 4005-READ-NEXT-RECORD
 15345        ELSE
 15346           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 15347              GO TO 4010-CHECK-REC-TYPE
 15348           ELSE
 15349              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 15350                 GO TO 4010-CHECK-REC-TYPE
 15351              ELSE
 15352                 GO TO 4005-READ-NEXT-RECORD.
 15353
 15354     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 15355        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 15356           GO TO 4005-READ-NEXT-RECORD.
 15357
 15358 4010-CHECK-REC-TYPE.
 15359     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 291
* EL6311.cbl
 15360         IF  PB-CARRIER = PI-CARRIER-SECURITY
 15361             NEXT SENTENCE
 15362         ELSE
 15363             GO TO 4005-READ-NEXT-RECORD.
 15364
 15365     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 15366         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 15367             NEXT SENTENCE
 15368        ELSE
 15369             GO TO 4005-READ-NEXT-RECORD.
 15370
 15371     IF NOT DISPLAY-CHANGE-RECORDS AND
 15372            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15373        GO TO 4005-READ-NEXT-RECORD.
 15374
 15375     IF DISPLAY-HOLD-RECORDS AND
 15376        NOT PB-RECORD-ON-HOLD
 15377          GO TO 4005-READ-NEXT-RECORD.
 15378
 15379     IF PB-ISSUE
 15380        IF DISPLAY-CHK-REQ-RECORDS
 15381            GO TO 4005-READ-NEXT-RECORD.
 15382
 15383     IF PB-ISSUE
 15384        IF ISSUE-WITH-WARNING
 15385           IF PB-WARNING-ERRORS
 15386              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 15387                  GO TO 4005-READ-NEXT-RECORD
 15388              ELSE
 15389                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15390                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15391                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15392                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 15393                 MOVE PB-SV-STATE            TO PI-SV-STATE
 15394                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 15395                 GO TO 7000-DISPLAY-ISSUES
 15396           ELSE
 15397              GO TO 4005-READ-NEXT-RECORD.
 15398
 15399     IF PB-ISSUE
 15400        IF (ISSUES-IN-ERROR AND
 15401            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 15402            ALL-ISSUES
 15403            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15404            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15405            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15406            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 15407            MOVE PB-SV-STATE            TO PI-SV-STATE
 15408            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 15409            GO TO 7000-DISPLAY-ISSUES
 15410        ELSE
 15411            GO TO 4005-READ-NEXT-RECORD.
 15412
 15413     IF PB-CANCELLATION
 15414        IF DISPLAY-CHK-REQ-RECORDS
 15415           IF PB-C-REFUND-REQUESTED
 15416              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15417              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 292
* EL6311.cbl
 15418              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15419              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 15420              MOVE PB-SV-STATE            TO PI-SV-STATE
 15421              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 15422              GO TO 7100-DISPLAY-CANCELS
 15423           ELSE
 15424               GO TO 4005-READ-NEXT-RECORD.
 15425
 15426     IF PB-CANCELLATION
 15427        IF CANCEL-WITH-WARNING
 15428           IF PB-WARNING-ERRORS
 15429              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 15430                  GO TO 4005-READ-NEXT-RECORD
 15431              ELSE
 15432                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15433                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15434                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15435                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 15436                 MOVE PB-SV-STATE            TO PI-SV-STATE
 15437                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 15438                 GO TO 7100-DISPLAY-CANCELS
 15439           ELSE
 15440              GO TO 4005-READ-NEXT-RECORD.
 15441
 15442     IF PB-CANCELLATION
 15443        IF (CANCEL-IN-ERROR  AND
 15444            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 15445            ALL-CANCELS
 15446            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15447            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15448            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15449            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 15450            MOVE PB-SV-STATE            TO PI-SV-STATE
 15451            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 15452            GO TO 7100-DISPLAY-CANCELS.
 15453
 15454     GO TO 4005-READ-NEXT-RECORD.
 15455
 15456 4050-END-RECORDS.
 15457******************************************************************
 15458*                                                                *
 15459*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 15460*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 15461*         PROGRAM.                                               *
 15462*                                                                *
 15463******************************************************************
 15464
 15465     IF BROWSE-STARTED
 15466        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 15467
 15468* EXEC CICS ENDBR
 15469*            DATASET  (FILE-ID-ERPNDB2)
 15470*       END-EXEC.
 15471     MOVE 0
 15472       TO DFHEIV11
 15473*    MOVE '&2                    $   #00013286' TO DFHEIV0
 15474     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15475     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 293
* EL6311.cbl
 15476     MOVE X'2020233030303133323836' TO DFHEIV0(25:11)
 15477     CALL 'kxdfhei1' USING DFHEIV0,
 15478           FILE-ID-ERPNDB2,
 15479           DFHEIV11,
 15480           DFHEIV99
 15481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15482
 15483
 15484     IF  EIBTRNID NOT = TRANS-EXB1
 15485         IF PENDING-BUS-RECS-FOUND
 15486             NEXT SENTENCE
 15487           ELSE
 15488             MOVE '9'            TO PI-BROWSE-SW
 15489             GO TO 9400-CLEAR.
 15490
 15491     IF SHOW-RECORD
 15492        MOVE ER-2253            TO EMI-ERROR
 15493       ELSE
 15494        MOVE ER-2254            TO EMI-ERROR.
 15495
 15496     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15497
 15498     IF PI-MAP-NAME = SPACES
 15499        MOVE -1                  TO DPFENTRL
 15500        MOVE EL631D               TO PI-MAP-NAME
 15501        GO TO 8100-SEND-INITIAL-MAP.
 15502
 15503     IF PI-MAP-NAME = EL631B
 15504        MOVE -1                  TO BMAINTL
 15505     ELSE
 15506        IF PI-MAP-NAME = EL631C
 15507           MOVE -1               TO CMAINTL
 15508        ELSE
 15509           MOVE -1               TO DPFENTRL.
 15510
 15511     GO TO 8200-SEND-DATAONLY.
 15512
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 294
* EL6311.cbl
 15514
 15515***************************************************************
 15516*                                                             *
 15517*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 15518*                                                             *
 15519*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 15520*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 15521*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 15522*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 15523*                                                             *
 15524*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 15525*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 15526*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 15527*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 15528*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 15529*                AND IS IT TO BE DISPLAYED.                   *
 15530*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 15531*                DISPLAYED.                                   *
 15532*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 15533*                DISPLAYED.                                   *
 15534*                                                             *
 15535*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 15536*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 15537*                                                             *
 15538*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 15539*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 15540*                THEY ARE NOT TO BE DISPLAYED.                *
 15541*                                                             *
 15542***************************************************************
 15543
 15544 4100-BROWSE-PRIMARY-FORWARD.
 15545     IF FIRST-TIME  OR SHOW-RECORD
 15546        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 15547        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 15548        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 15549     ELSE
 15550        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 15551        IF ERPNDB-BATCH-SEQ-NO = +9999
 15552           GO TO 4150-END-BATCH
 15553        ELSE
 15554           IF DISPLAY-CHANGE-RECORDS
 15555              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 15556           ELSE
 15557              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 15558              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 15559
 15560     IF FIRST-TIME
 15561         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 15562            PI-PB-BATCH-SEQ-NO NOT = ZERO
 15563              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 15564
 15565
 15566* EXEC CICS HANDLE CONDITION
 15567*         ENDFILE  (4150-END-BATCH)
 15568*    END-EXEC.
 15569*    MOVE '"$''                   ! H #00013371' TO DFHEIV0
 15570     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 295
* EL6311.cbl
 15572     MOVE X'4820233030303133333731' TO DFHEIV0(25:11)
 15573     CALL 'kxdfhei1' USING DFHEIV0
 15574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15575
 15576
 15577 4105-READ-NEXT.
 15578
 15579* EXEC CICS HANDLE CONDITION
 15580*         NOTFND    (4150-END-BATCH)
 15581*    END-EXEC.
 15582*    MOVE '"$I                   ! I #00013376' TO DFHEIV0
 15583     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15585     MOVE X'4920233030303133333736' TO DFHEIV0(25:11)
 15586     CALL 'kxdfhei1' USING DFHEIV0
 15587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15588
 15589
 15590     MOVE SPACES                 TO WS-REC-FOUND-SW.
 15591
 15592     IF PI-DISPLAY-ORIGINAL-BATCH
 15593        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 15594     ELSE
 15595        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 15596
 15597
 15598* EXEC CICS READ
 15599*         DATASET   (FILE-ID)
 15600*         SET       (ADDRESS OF PENDING-BUSINESS)
 15601*         RIDFLD    (ERPNDB-KEY)
 15602*         GTEQ
 15603*    END-EXEC.
 15604*    MOVE '&"S        G          (   #00013387' TO DFHEIV0
 15605     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15607     MOVE X'2020233030303133333837' TO DFHEIV0(25:11)
 15608     CALL 'kxdfhei1' USING DFHEIV0,
 15609           FILE-ID,
 15610           DFHEIV20,
 15611           DFHEIV99,
 15612           ERPNDB-KEY,
 15613           DFHEIV99,
 15614           DFHEIV99,
 15615           DFHEIV99
 15616     SET ADDRESS OF PENDING-BUSINESS TO
 15617         DFHEIV20
 15618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15619
 15620
 15621     IF PI-DISPLAY-ORIGINAL-BATCH
 15622        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 15623           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 15624           GO TO 4150-END-BATCH
 15625        ELSE
 15626           IF PB-BATCH-TRAILER
 15627              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 15628              GO TO 4105-READ-NEXT
 15629           ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 296
* EL6311.cbl
 15630              NEXT SENTENCE
 15631     ELSE
 15632        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 15633           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 15634           GO TO 4150-END-BATCH.
 15635
 15636     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 15637
 15638     IF WS-BATCH-PREFIX = '#CL'
 15639         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 15640         GO TO 4105-READ-NEXT.
 15641
 15642     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 15643     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 15644     MOVE PB-STATE               TO PI-PB-STATE.
 15645     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 15646
 15647     IF PB-BATCH-TRAILER
 15648        IF SHOW-RECORD
 15649           GO TO 4150-END-BATCH
 15650        ELSE
 15651           MOVE ER-2251         TO EMI-ERROR
 15652           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15653           MOVE 1               TO PI-BROWSE-TYPE
 15654           GO TO 7200-DISPLAY-BATCHES.
 15655
 15656     IF SHOW-RECORD
 15657           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 15658              GO TO 4110-BUMP-SEQ
 15659           ELSE
 15660              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 15661                 GO TO 4110-BUMP-SEQ
 15662              ELSE
 15663                 GO TO 4107-CHECK-REC-TYPE.
 15664
 15665     IF NOT  PI-PRIMARY-WITH-SELECT
 15666        GO TO 4107-CHECK-REC-TYPE.
 15667
 15668     IF PI-PB-CERT-NO NOT = LOW-VALUES
 15669        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 15670           GO TO 4110-BUMP-SEQ
 15671        ELSE
 15672           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 15673              GO TO 4107-CHECK-REC-TYPE
 15674           ELSE
 15675              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 15676                 GO TO 4107-CHECK-REC-TYPE
 15677              ELSE
 15678                 GO TO 4110-BUMP-SEQ.
 15679
 15680     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 15681        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 15682           GO TO 4110-BUMP-SEQ.
 15683
 15684 4107-CHECK-REC-TYPE.
 15685     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 15686         IF  PB-CARRIER = PI-CARRIER-SECURITY
 15687             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 297
* EL6311.cbl
 15688           ELSE
 15689             GO TO 4110-BUMP-SEQ.
 15690
 15691     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 15692         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 15693             NEXT SENTENCE
 15694           ELSE
 15695             GO TO 4110-BUMP-SEQ.
 15696
 15697     IF NOT DISPLAY-CHANGE-RECORDS AND
 15698        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15699           GO TO 4110-BUMP-SEQ.
 15700
 15701     IF DISPLAY-HOLD-RECORDS AND
 15702        NOT PB-RECORD-ON-HOLD
 15703          GO TO 4110-BUMP-SEQ.
 15704
 15705     IF PB-ISSUE
 15706        IF DISPLAY-CHK-REQ-RECORDS
 15707            GO TO 4110-BUMP-SEQ.
 15708
 15709     IF PB-ISSUE
 15710        IF ISSUE-WITH-WARNING
 15711           IF PB-WARNING-ERRORS
 15712              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 15713                  GO TO 4110-BUMP-SEQ
 15714              ELSE
 15715                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15716                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15717                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15718                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 15719                 MOVE PB-SV-STATE            TO PI-SV-STATE
 15720                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 15721                 GO TO 7000-DISPLAY-ISSUES
 15722        ELSE
 15723            GO TO 4110-BUMP-SEQ.
 15724
 15725     IF PB-ISSUE
 15726        IF (ISSUES-IN-ERROR AND
 15727            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 15728            ALL-ISSUES
 15729            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15730            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15731            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15732            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 15733            MOVE PB-SV-STATE            TO PI-SV-STATE
 15734            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 15735            GO TO 7000-DISPLAY-ISSUES
 15736        ELSE
 15737            GO TO 4110-BUMP-SEQ.
 15738
 15739     IF PB-CANCELLATION
 15740        IF DISPLAY-CHK-REQ-RECORDS
 15741           IF PB-C-REFUND-REQUESTED
 15742              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15743              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15744              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15745              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 298
* EL6311.cbl
 15746              MOVE PB-SV-STATE            TO PI-SV-STATE
 15747              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 15748              GO TO 7100-DISPLAY-CANCELS
 15749           ELSE
 15750              GO TO 4110-BUMP-SEQ.
 15751
 15752     IF PB-CANCELLATION
 15753        IF CANCEL-WITH-WARNING
 15754           IF PB-WARNING-ERRORS
 15755              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 15756                  GO TO 4110-BUMP-SEQ
 15757              ELSE
 15758                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15759                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15760                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15761                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 15762                 MOVE PB-SV-STATE            TO PI-SV-STATE
 15763                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 15764                 GO TO 7100-DISPLAY-CANCELS
 15765           ELSE
 15766              GO TO 4110-BUMP-SEQ.
 15767
 15768     IF PB-CANCELLATION
 15769        IF (CANCEL-IN-ERROR  AND
 15770            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 15771            ALL-CANCELS
 15772            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 15773            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15774            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 15775            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 15776            MOVE PB-SV-STATE            TO PI-SV-STATE
 15777            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 15778            GO TO 7100-DISPLAY-CANCELS.
 15779
 15780 4110-BUMP-SEQ.
 15781     IF NOT DISPLAY-CHANGE-RECORDS
 15782        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 15783        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 15784     ELSE
 15785        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 15786           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 15787           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 15788        ELSE
 15789           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 15790           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 15791
 15792     GO TO 4105-READ-NEXT.
 15793
 15794 4150-END-BATCH.
 15795******************************************************************
 15796*                                                                *
 15797*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 15798*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 15799*         PROGRAM.                                               *
 15800*                                                                *
 15801******************************************************************
 15802
 15803     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 299
* EL6311.cbl
 15804         IF PENDING-BUS-RECS-FOUND
 15805             NEXT SENTENCE
 15806           ELSE
 15807             MOVE '9'            TO PI-BROWSE-SW
 15808             GO TO 9400-CLEAR.
 15809
 15810     IF SHOW-RECORD
 15811        MOVE ER-2253             TO EMI-ERROR
 15812     ELSE
 15813        MOVE ER-2251             TO EMI-ERROR.
 15814
 15815     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15816
 15817     IF PI-MAP-NAME = SPACES
 15818        MOVE -1                  TO BMAINTL
 15819        MOVE EL631B              TO PI-MAP-NAME
 15820        GO TO 8100-SEND-INITIAL-MAP.
 15821
 15822     IF PI-MAP-NAME = EL631B
 15823        MOVE -1                  TO BMAINTL
 15824     ELSE
 15825        IF PI-MAP-NAME = EL631C
 15826           MOVE -1               TO CMAINTL
 15827        ELSE
 15828           MOVE -1               TO DPFENTRL.
 15829
 15830     GO TO 8200-SEND-DATAONLY.
 15831
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 300
* EL6311.cbl
 15833
 15834***************************************************************
 15835*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 15836*                                                             *
 15837*      1. START BROWSE WITH                                   *
 15838*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 15839*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 15840*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 15841*                                                             *
 15842*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 15843*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 15844*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 15845*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 15846*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 15847*               AND IS IT TO BE DISPLAYED.                    *
 15848*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 15849*               DISPLAYED.                                    *
 15850*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 15851*               DISPLAYED.                                    *
 15852*                                                             *
 15853*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 15854*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 15855***************************************************************
 15856
 15857 4200-BROWSE-CSR-FORWARD.
 15858
 15859     IF FIRST-TIME
 15860        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 15861     ELSE
 15862        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 15863
 15864
 15865* EXEC CICS HANDLE CONDITION
 15866*         NOTFND   (4250-END-RECORDS)
 15867*         ENDFILE  (4250-END-RECORDS)
 15868*    END-EXEC.
 15869*    MOVE '"$I''                  ! J #00013637' TO DFHEIV0
 15870     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15872     MOVE X'4A20233030303133363337' TO DFHEIV0(25:11)
 15873     CALL 'kxdfhei1' USING DFHEIV0
 15874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15875
 15876
 15877
 15878* EXEC CICS STARTBR
 15879*         DATASET   (FILE-ID-ERPNDB4)
 15880*         RIDFLD    (ERPNDB-CSR-KEY)
 15881*    END-EXEC.
 15882     MOVE 0
 15883       TO DFHEIV11
 15884*    MOVE '&,         G          &   #00013642' TO DFHEIV0
 15885     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15886     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15887     MOVE X'2020233030303133363432' TO DFHEIV0(25:11)
 15888     CALL 'kxdfhei1' USING DFHEIV0,
 15889           FILE-ID-ERPNDB4,
 15890           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 301
* EL6311.cbl
 15891           DFHEIV99,
 15892           DFHEIV11,
 15893           DFHEIV99
 15894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15895
 15896
 15897     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 15898
 15899     IF FIRST-TIME
 15900        MOVE SPACE               TO WS-FIRST-TIME-SW
 15901        GO TO 4205-READ-NEXT-RECORD.
 15902
 15903
 15904* EXEC CICS READNEXT
 15905*         DATASET    (FILE-ID-ERPNDB4)
 15906*         SET        (ADDRESS OF PENDING-BUSINESS)
 15907*         RIDFLD     (ERPNDB-CSR-KEY)
 15908*    END-EXEC.
 15909     MOVE 0
 15910       TO DFHEIV11
 15911*    MOVE '&.S                   )   #00013653' TO DFHEIV0
 15912     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15913     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15914     MOVE X'2020233030303133363533' TO DFHEIV0(25:11)
 15915     CALL 'kxdfhei1' USING DFHEIV0,
 15916           FILE-ID-ERPNDB4,
 15917           DFHEIV20,
 15918           DFHEIV99,
 15919           ERPNDB-CSR-KEY,
 15920           DFHEIV99,
 15921           DFHEIV11,
 15922           DFHEIV99,
 15923           DFHEIV99
 15924     SET ADDRESS OF PENDING-BUSINESS TO
 15925         DFHEIV20
 15926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15927
 15928
 15929 4205-READ-NEXT-RECORD.
 15930
 15931
 15932* EXEC CICS READNEXT
 15933*         DATASET    (FILE-ID-ERPNDB4)
 15934*         SET        (ADDRESS OF PENDING-BUSINESS)
 15935*         RIDFLD     (ERPNDB-CSR-KEY)
 15936*    END-EXEC.
 15937     MOVE 0
 15938       TO DFHEIV11
 15939*    MOVE '&.S                   )   #00013661' TO DFHEIV0
 15940     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15941     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15942     MOVE X'2020233030303133363631' TO DFHEIV0(25:11)
 15943     CALL 'kxdfhei1' USING DFHEIV0,
 15944           FILE-ID-ERPNDB4,
 15945           DFHEIV20,
 15946           DFHEIV99,
 15947           ERPNDB-CSR-KEY,
 15948           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 302
* EL6311.cbl
 15949           DFHEIV11,
 15950           DFHEIV99,
 15951           DFHEIV99
 15952     SET ADDRESS OF PENDING-BUSINESS TO
 15953         DFHEIV20
 15954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15955
 15956
 15957     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 15958
 15959     IF WS-BATCH-PREFIX = '#CL'
 15960        GO TO 4205-READ-NEXT-RECORD.
 15961
 15962     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 15963        PB-CSR-ID           NOT = PI-PB-CSR-ID
 15964        GO TO 4250-END-RECORDS.
 15965
 15966     IF PB-BATCH-TRAILER
 15967        GO TO 4205-READ-NEXT-RECORD.
 15968
 15969     IF PI-PB-CERT-NO NOT = LOW-VALUES
 15970        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 15971           GO TO 4205-READ-NEXT-RECORD
 15972        ELSE
 15973           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 15974              GO TO 4210-CHECK-REC-TYPE
 15975           ELSE
 15976              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 15977                 GO TO 4210-CHECK-REC-TYPE
 15978              ELSE
 15979                 GO TO 4205-READ-NEXT-RECORD.
 15980
 15981     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 15982        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 15983           GO TO 4205-READ-NEXT-RECORD.
 15984
 15985 4210-CHECK-REC-TYPE.
 15986     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 15987         IF  PB-CARRIER = PI-CARRIER-SECURITY
 15988             NEXT SENTENCE
 15989         ELSE
 15990             GO TO 4205-READ-NEXT-RECORD.
 15991
 15992     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 15993         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 15994             NEXT SENTENCE
 15995        ELSE
 15996             GO TO 4205-READ-NEXT-RECORD.
 15997
 15998     IF NOT DISPLAY-CHANGE-RECORDS AND
 15999            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 16000        GO TO 4205-READ-NEXT-RECORD.
 16001
 16002     IF DISPLAY-HOLD-RECORDS AND
 16003        NOT PB-RECORD-ON-HOLD
 16004          GO TO 4205-READ-NEXT-RECORD.
 16005
 16006     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 303
* EL6311.cbl
 16007        IF DISPLAY-CHK-REQ-RECORDS
 16008            GO TO 4205-READ-NEXT-RECORD.
 16009
 16010     IF PB-ISSUE
 16011        IF ISSUE-WITH-WARNING
 16012           IF PB-WARNING-ERRORS
 16013              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 16014                  GO TO 4205-READ-NEXT-RECORD
 16015              ELSE
 16016                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16017                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 16018                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16019                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16020                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16021                 MOVE PB-SV-STATE            TO PI-SV-STATE
 16022                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16023                 GO TO 7000-DISPLAY-ISSUES
 16024           ELSE
 16025              GO TO 4205-READ-NEXT-RECORD.
 16026
 16027     IF PB-ISSUE
 16028        IF (ISSUES-IN-ERROR AND
 16029            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 16030            ALL-ISSUES
 16031            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16032            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 16033            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16034            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16035            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16036            MOVE PB-SV-STATE            TO PI-SV-STATE
 16037            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16038            GO TO 7000-DISPLAY-ISSUES
 16039        ELSE
 16040            GO TO 4205-READ-NEXT-RECORD.
 16041
 16042     IF PB-CANCELLATION
 16043        IF DISPLAY-CHK-REQ-RECORDS
 16044           IF PB-C-REFUND-REQUESTED
 16045              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16046              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 16047              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16048              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16049              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16050              MOVE PB-SV-STATE            TO PI-SV-STATE
 16051              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16052              GO TO 7100-DISPLAY-CANCELS
 16053           ELSE
 16054               GO TO 4205-READ-NEXT-RECORD.
 16055
 16056     IF PB-CANCELLATION
 16057        IF CANCEL-WITH-WARNING
 16058           IF PB-WARNING-ERRORS
 16059              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 16060                  GO TO 4205-READ-NEXT-RECORD
 16061              ELSE
 16062                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16063                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 16064                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 304
* EL6311.cbl
 16065                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16066                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16067                 MOVE PB-SV-STATE            TO PI-SV-STATE
 16068                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16069                 GO TO 7100-DISPLAY-CANCELS
 16070           ELSE
 16071              GO TO 4205-READ-NEXT-RECORD.
 16072
 16073     IF PB-CANCELLATION
 16074        IF (CANCEL-IN-ERROR  AND
 16075            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 16076            ALL-CANCELS
 16077            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16078            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 16079            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16080            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16081            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16082            MOVE PB-SV-STATE            TO PI-SV-STATE
 16083            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16084            GO TO 7100-DISPLAY-CANCELS.
 16085
 16086     GO TO 4205-READ-NEXT-RECORD.
 16087
 16088 4250-END-RECORDS.
 16089******************************************************************
 16090*                                                                *
 16091*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 16092*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 16093*         PROGRAM.                                               *
 16094*                                                                *
 16095******************************************************************
 16096
 16097     IF BROWSE-STARTED
 16098        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 16099
 16100* EXEC CICS ENDBR
 16101*            DATASET  (FILE-ID-ERPNDB4)
 16102*       END-EXEC.
 16103     MOVE 0
 16104       TO DFHEIV11
 16105*    MOVE '&2                    $   #00013809' TO DFHEIV0
 16106     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16107     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16108     MOVE X'2020233030303133383039' TO DFHEIV0(25:11)
 16109     CALL 'kxdfhei1' USING DFHEIV0,
 16110           FILE-ID-ERPNDB4,
 16111           DFHEIV11,
 16112           DFHEIV99
 16113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16114
 16115
 16116     IF  EIBTRNID NOT = TRANS-EXB1
 16117         IF PENDING-BUS-RECS-FOUND
 16118             NEXT SENTENCE
 16119           ELSE
 16120             MOVE '9'            TO PI-BROWSE-SW
 16121             GO TO 9400-CLEAR.
 16122
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 305
* EL6311.cbl
 16123     IF SHOW-RECORD
 16124        MOVE ER-2253            TO EMI-ERROR
 16125       ELSE
 16126        MOVE ER-2254            TO EMI-ERROR.
 16127
 16128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16129
 16130     IF PI-MAP-NAME = SPACES
 16131        MOVE -1                  TO DPFENTRL
 16132        MOVE EL631D               TO PI-MAP-NAME
 16133        GO TO 8100-SEND-INITIAL-MAP.
 16134
 16135     IF PI-MAP-NAME = EL631B
 16136        MOVE -1                  TO BMAINTL
 16137     ELSE
 16138        IF PI-MAP-NAME = EL631C
 16139           MOVE -1               TO CMAINTL
 16140        ELSE
 16141           MOVE -1               TO DPFENTRL.
 16142
 16143     GO TO 8200-SEND-DATAONLY.
 16144
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 306
* EL6311.cbl
 16146
 16147***************************************************************
 16148*                                                             *
 16149*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 16150*                                                             *
 16151*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 16152*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 16153*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 16154*                                                             *
 16155*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 16156*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 16157*          A. IS IT WITHIN THE SAME COMPANY                   *
 16158*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 16159*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 16160*                AND IS IT TO BE DISPLAYED.                   *
 16161*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 16162*                DISPLAYED.                                   *
 16163*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 16164*                DISPLAYED.                                   *
 16165*                                                             *
 16166*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 16167*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 16168*                                                             *
 16169*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 16170*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 16171*                THEY ARE NOT TO BE DISPLAYED.                *
 16172*                                                             *
 16173***************************************************************
 16174
 16175 4300-BROWSE-FILE-FORWARD.
 16176     IF FIRST-TIME OR SHOW-RECORD
 16177        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 16178        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 16179        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 16180     ELSE
 16181        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 16182        IF ERPNDB-BATCH-SEQ-NO = +9999
 16183           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 16184        ELSE
 16185           IF DISPLAY-CHANGE-RECORDS
 16186              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 16187           ELSE
 16188              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 16189              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 16190
 16191
 16192* EXEC CICS HANDLE CONDITION
 16193*         ENDFILE  (4350-END-BATCH)
 16194*         NOTFND   (4350-END-BATCH)
 16195*    END-EXEC.
 16196*    MOVE '"$''I                  ! K #00013888' TO DFHEIV0
 16197     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16199     MOVE X'4B20233030303133383838' TO DFHEIV0(25:11)
 16200     CALL 'kxdfhei1' USING DFHEIV0
 16201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16202
 16203
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 307
* EL6311.cbl
 16204 4305-READ-NEXT.
 16205     IF PI-DISPLAY-ORIGINAL-BATCH
 16206        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 16207     ELSE
 16208        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 16209
 16210
 16211* EXEC CICS READ
 16212*         DATASET   (FILE-ID)
 16213*         SET       (ADDRESS OF PENDING-BUSINESS)
 16214*         RIDFLD    (ERPNDB-KEY)
 16215*         GTEQ
 16216*    END-EXEC.
 16217*    MOVE '&"S        G          (   #00013899' TO DFHEIV0
 16218     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16220     MOVE X'2020233030303133383939' TO DFHEIV0(25:11)
 16221     CALL 'kxdfhei1' USING DFHEIV0,
 16222           FILE-ID,
 16223           DFHEIV20,
 16224           DFHEIV99,
 16225           ERPNDB-KEY,
 16226           DFHEIV99,
 16227           DFHEIV99,
 16228           DFHEIV99
 16229     SET ADDRESS OF PENDING-BUSINESS TO
 16230         DFHEIV20
 16231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16232
 16233
 16234     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 16235        GO TO 4350-END-BATCH.
 16236
 16237     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 16238                                    WS-BATCH-NO.
 16239
 16240     IF  WS-BATCH-PREFIX = '#CL'
 16241         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 16242         GO TO 4305-READ-NEXT.
 16243
 16244     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 16245     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 16246     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 16247     MOVE PB-STATE               TO PI-PB-STATE.
 16248     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 16249
 16250     IF PB-BATCH-TRAILER
 16251        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 16252        GO TO 4305-READ-NEXT.
 16253
 16254     IF SHOW-RECORD
 16255           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 16256              GO TO 4310-BUMP-SEQ
 16257           ELSE
 16258              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 16259                 GO TO 4310-BUMP-SEQ
 16260              ELSE
 16261                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 308
* EL6311.cbl
 16262
 16263     IF PI-PB-CERT-NO NOT = LOW-VALUES
 16264        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 16265           GO TO 4310-BUMP-SEQ
 16266        ELSE
 16267           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 16268              GO TO 4307-CHECK-REC-TYPE
 16269           ELSE
 16270              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 16271                 GO TO 4307-CHECK-REC-TYPE
 16272              ELSE
 16273                 GO TO 4310-BUMP-SEQ.
 16274
 16275     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 16276        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 16277           GO TO 4310-BUMP-SEQ.
 16278
 16279 4307-CHECK-REC-TYPE.
 16280     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 16281         IF  PB-CARRIER = PI-CARRIER-SECURITY
 16282             NEXT SENTENCE
 16283         ELSE
 16284             GO TO 4310-BUMP-SEQ.
 16285
 16286     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 16287         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 16288             NEXT SENTENCE
 16289        ELSE
 16290             GO TO 4310-BUMP-SEQ.
 16291
 16292     IF NOT DISPLAY-CHANGE-RECORDS AND
 16293            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 16294        GO TO 4310-BUMP-SEQ.
 16295
 16296     IF DISPLAY-HOLD-RECORDS AND
 16297        NOT PB-RECORD-ON-HOLD
 16298          GO TO 4310-BUMP-SEQ.
 16299
 16300     IF PB-ISSUE
 16301        IF DISPLAY-CHK-REQ-RECORDS
 16302           GO TO 4310-BUMP-SEQ.
 16303
 16304     IF PB-ISSUE
 16305        IF ISSUE-WITH-WARNING
 16306           IF PB-WARNING-ERRORS
 16307              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 16308                  GO TO 4310-BUMP-SEQ
 16309              ELSE
 16310                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16311                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16312                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16313                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16314                 MOVE PB-SV-STATE            TO PI-SV-STATE
 16315                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16316                 GO TO 7000-DISPLAY-ISSUES
 16317           ELSE
 16318              GO TO 4310-BUMP-SEQ.
 16319
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 309
* EL6311.cbl
 16320     IF PB-ISSUE
 16321        IF (ISSUES-IN-ERROR AND
 16322            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 16323            ALL-ISSUES
 16324            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16325            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16326            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16327            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16328            MOVE PB-SV-STATE            TO PI-SV-STATE
 16329            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16330            GO TO 7000-DISPLAY-ISSUES
 16331        ELSE
 16332            GO TO 4310-BUMP-SEQ.
 16333
 16334     IF PB-CANCELLATION
 16335        IF DISPLAY-CHK-REQ-RECORDS
 16336           IF PB-C-REFUND-REQUESTED
 16337              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16338              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16339              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16340              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16341              MOVE PB-SV-STATE            TO PI-SV-STATE
 16342              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16343              GO TO 7100-DISPLAY-CANCELS
 16344           ELSE
 16345              GO TO 4310-BUMP-SEQ.
 16346
 16347     IF PB-CANCELLATION
 16348        IF CANCEL-WITH-WARNING
 16349           IF PB-WARNING-ERRORS
 16350              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 16351                  GO TO 4310-BUMP-SEQ
 16352              ELSE
 16353                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16354                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16355                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16356                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16357                 MOVE PB-SV-STATE            TO PI-SV-STATE
 16358                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16359                 GO TO 7100-DISPLAY-CANCELS
 16360           ELSE
 16361              GO TO 4310-BUMP-SEQ.
 16362
 16363     IF PB-CANCELLATION
 16364        IF (CANCEL-IN-ERROR  AND
 16365            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 16366            ALL-CANCELS
 16367            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16368            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16369            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16370            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16371            MOVE PB-SV-STATE            TO PI-SV-STATE
 16372            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16373            GO TO 7100-DISPLAY-CANCELS.
 16374
 16375 4310-BUMP-SEQ.
 16376     IF NOT DISPLAY-CHANGE-RECORDS
 16377        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 310
* EL6311.cbl
 16378        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 16379     ELSE
 16380        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 16381           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 16382           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 16383        ELSE
 16384           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 16385           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 16386
 16387     GO TO 4305-READ-NEXT.
 16388
 16389 4350-END-BATCH.
 16390
 16391******************************************************************
 16392*                                                                *
 16393*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 16394*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 16395*         PROGRAM.                                               *
 16396*                                                                *
 16397******************************************************************
 16398
 16399     IF  EIBTRNID NOT = TRANS-EXB1
 16400         IF PENDING-BUS-RECS-FOUND
 16401             NEXT SENTENCE
 16402           ELSE
 16403             MOVE '9'            TO PI-BROWSE-SW
 16404             GO TO 9400-CLEAR.
 16405
 16406     IF SHOW-RECORD
 16407        MOVE ER-2253            TO EMI-ERROR
 16408     ELSE
 16409        MOVE ER-2251            TO EMI-ERROR.
 16410
 16411     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16412
 16413     IF PI-MAP-NAME = SPACES
 16414        MOVE -1                  TO BMAINTL
 16415        MOVE EL631B               TO PI-MAP-NAME
 16416        GO TO 8100-SEND-INITIAL-MAP.
 16417
 16418     IF PI-MAP-NAME = EL631B
 16419        MOVE -1                  TO BMAINTL
 16420     ELSE
 16421        IF PI-MAP-NAME = EL631C
 16422           MOVE -1               TO CMAINTL
 16423        ELSE
 16424           MOVE -1               TO DPFENTRL.
 16425
 16426     GO TO 8200-SEND-DATAONLY.
 16427
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 311
* EL6311.cbl
 16429
 16430******************************************************************
 16431*                                                                *
 16432*        B R O W S E   D E T A I L   B A C K W A R D             *
 16433*                                                                *
 16434******************************************************************
 16435
 16436 4500-BROWSE-DETAIL-BACKWARD.
 16437
 16438     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 16439
 16440
 16441* EXEC CICS HANDLE CONDITION
 16442*         NOTFND   (4570-NOT-FOUND)
 16443*         ENDFILE  (4550-END-RECORDS)
 16444*    END-EXEC
 16445*    MOVE '"$I''                  ! L #00014112' TO DFHEIV0
 16446     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 16447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16448     MOVE X'4C20233030303134313132' TO DFHEIV0(25:11)
 16449     CALL 'kxdfhei1' USING DFHEIV0
 16450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16451
 16452
 16453* EXEC CICS STARTBR
 16454*         DATASET   (FILE-ID-ERPNDB2)
 16455*         RIDFLD    (ERPNDB-ALT-KEY)
 16456*    END-EXEC.
 16457     MOVE 0
 16458       TO DFHEIV11
 16459*    MOVE '&,         G          &   #00014117' TO DFHEIV0
 16460     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16461     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16462     MOVE X'2020233030303134313137' TO DFHEIV0(25:11)
 16463     CALL 'kxdfhei1' USING DFHEIV0,
 16464           FILE-ID-ERPNDB2,
 16465           ERPNDB-ALT-KEY,
 16466           DFHEIV99,
 16467           DFHEIV11,
 16468           DFHEIV99
 16469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16470
 16471
 16472     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 16473                                    WS-FIRST-TIME-SW.
 16474
 16475 4505-READ-PREV-RECORD.
 16476
 16477* EXEC CICS READPREV
 16478*         DATASET    (FILE-ID-ERPNDB2)
 16479*         SET        (ADDRESS OF PENDING-BUSINESS)
 16480*         RIDFLD     (ERPNDB-ALT-KEY)
 16481*    END-EXEC.
 16482     MOVE 0
 16483       TO DFHEIV11
 16484*    MOVE '&0S                   )   #00014126' TO DFHEIV0
 16485     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 16486     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 312
* EL6311.cbl
 16487     MOVE X'2020233030303134313236' TO DFHEIV0(25:11)
 16488     CALL 'kxdfhei1' USING DFHEIV0,
 16489           FILE-ID-ERPNDB2,
 16490           DFHEIV20,
 16491           DFHEIV99,
 16492           ERPNDB-ALT-KEY,
 16493           DFHEIV99,
 16494           DFHEIV11,
 16495           DFHEIV99,
 16496           DFHEIV99
 16497     SET ADDRESS OF PENDING-BUSINESS TO
 16498         DFHEIV20
 16499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16500
 16501
 16502     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 16503
 16504     IF WS-BATCH-PREFIX = '#CL'
 16505         GO TO 4505-READ-PREV-RECORD.
 16506
 16507     IF FIRST-TIME
 16508         MOVE SPACE               TO WS-FIRST-TIME-SW
 16509         GO TO 4505-READ-PREV-RECORD.
 16510
 16511     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 16512        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 16513        PB-GROUPING      NOT = PI-PB-GROUPING OR
 16514        PB-STATE         NOT = PI-PB-STATE    OR
 16515        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 16516          GO TO 4550-END-RECORDS.
 16517
 16518
 16519     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 16520
 16521     IF PB-BATCH-TRAILER
 16522        GO TO 4505-READ-PREV-RECORD.
 16523
 16524     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 16525
 16526     IF  WS-BATCH-PREFIX = '#CL'
 16527         GO TO 4505-READ-PREV-RECORD.
 16528
 16529     IF PI-PB-CERT-NO NOT = LOW-VALUES
 16530        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 16531           GO TO 4505-READ-PREV-RECORD
 16532        ELSE
 16533           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 16534              GO TO 4510-CHECK-REC-TYPE
 16535           ELSE
 16536              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 16537                 GO TO 4510-CHECK-REC-TYPE
 16538              ELSE
 16539                 GO TO 4505-READ-PREV-RECORD.
 16540
 16541     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 16542        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 16543           GO TO 4505-READ-PREV-RECORD.
 16544
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 313
* EL6311.cbl
 16545 4510-CHECK-REC-TYPE.
 16546     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 16547         IF  PB-CARRIER = PI-CARRIER-SECURITY
 16548             NEXT SENTENCE
 16549         ELSE
 16550             GO TO 4505-READ-PREV-RECORD.
 16551
 16552     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 16553         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 16554             NEXT SENTENCE
 16555        ELSE
 16556             GO TO 4505-READ-PREV-RECORD.
 16557
 16558     IF NOT DISPLAY-CHANGE-RECORDS AND
 16559            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 16560        GO TO 4505-READ-PREV-RECORD.
 16561
 16562     IF DISPLAY-HOLD-RECORDS AND
 16563        NOT PB-RECORD-ON-HOLD
 16564          GO TO 4505-READ-PREV-RECORD.
 16565
 16566     IF PB-ISSUE
 16567        IF DISPLAY-CHK-REQ-RECORDS
 16568           GO TO 4505-READ-PREV-RECORD.
 16569
 16570     IF PB-ISSUE
 16571        IF ISSUE-WITH-WARNING
 16572           IF PB-WARNING-ERRORS
 16573              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 16574                  GO TO 4505-READ-PREV-RECORD
 16575              ELSE
 16576                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16577                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16578                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16579                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16580                 MOVE PB-SV-STATE            TO PI-SV-STATE
 16581                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16582                 GO TO 7000-DISPLAY-ISSUES
 16583           ELSE
 16584              GO TO 4505-READ-PREV-RECORD.
 16585
 16586     IF PB-ISSUE
 16587        IF (ISSUES-IN-ERROR AND
 16588            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 16589            ALL-ISSUES
 16590            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16591            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16592            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16593            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16594            MOVE PB-SV-STATE            TO PI-SV-STATE
 16595            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16596            GO TO 7000-DISPLAY-ISSUES
 16597        ELSE
 16598            GO TO 4505-READ-PREV-RECORD.
 16599
 16600     IF PB-CANCELLATION
 16601        IF DISPLAY-CHK-REQ-RECORDS
 16602           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 314
* EL6311.cbl
 16603              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16604              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16605              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16606              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16607              MOVE PB-SV-STATE            TO PI-SV-STATE
 16608              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16609              GO TO 7100-DISPLAY-CANCELS
 16610           ELSE
 16611              GO TO 4505-READ-PREV-RECORD.
 16612
 16613     IF PB-CANCELLATION
 16614        IF CANCEL-WITH-WARNING
 16615           IF PB-WARNING-ERRORS
 16616              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 16617                  GO TO 4505-READ-PREV-RECORD
 16618              ELSE
 16619                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16620                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16621                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16622                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16623                 MOVE PB-SV-STATE            TO PI-SV-STATE
 16624                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16625                 GO TO 7100-DISPLAY-CANCELS
 16626           ELSE
 16627              GO TO 4505-READ-PREV-RECORD.
 16628
 16629     IF PB-CANCELLATION
 16630        IF (CANCEL-IN-ERROR  AND
 16631            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 16632            ALL-CANCELS
 16633            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16634            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16635            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16636            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16637            MOVE PB-SV-STATE            TO PI-SV-STATE
 16638            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16639            GO TO 7100-DISPLAY-CANCELS.
 16640
 16641     GO TO 4505-READ-PREV-RECORD.
 16642
 16643 4550-END-RECORDS.
 16644     IF PI-MAP-NAME = EL631B
 16645        MOVE -1                  TO BMAINTL
 16646     ELSE
 16647        IF PI-MAP-NAME = EL631C
 16648           MOVE -1               TO CMAINTL
 16649        ELSE
 16650           MOVE -1               TO DPFENTRL.
 16651
 16652     MOVE ER-2255               TO EMI-ERROR.
 16653     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16654     GO TO 8200-SEND-DATAONLY.
 16655
 16656 4570-NOT-FOUND.
 16657
 16658******************************************************************
 16659*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 16660******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 315
* EL6311.cbl
 16661
 16662
 16663* EXEC CICS RESETBR
 16664*         DATASET    (FILE-ID-ERPNDB2)
 16665*         RIDFLD     (ERPNDB-ALT-KEY)
 16666*    END-EXEC.
 16667     MOVE 0
 16668       TO DFHEIV11
 16669*    MOVE '&4         G          &   #00014292' TO DFHEIV0
 16670     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 16671     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16672     MOVE X'2020233030303134323932' TO DFHEIV0(25:11)
 16673     CALL 'kxdfhei1' USING DFHEIV0,
 16674           FILE-ID-ERPNDB2,
 16675           ERPNDB-ALT-KEY,
 16676           DFHEIV99,
 16677           DFHEIV11,
 16678           DFHEIV99
 16679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16680
 16681
 16682
 16683* EXEC CICS READNEXT
 16684*         DATASET    (FILE-ID-ERPNDB2)
 16685*         SET        (ADDRESS OF PENDING-BUSINESS)
 16686*         RIDFLD     (ERPNDB-ALT-KEY)
 16687*    END-EXEC.
 16688     MOVE 0
 16689       TO DFHEIV11
 16690*    MOVE '&.S                   )   #00014297' TO DFHEIV0
 16691     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16692     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16693     MOVE X'2020233030303134323937' TO DFHEIV0(25:11)
 16694     CALL 'kxdfhei1' USING DFHEIV0,
 16695           FILE-ID-ERPNDB2,
 16696           DFHEIV20,
 16697           DFHEIV99,
 16698           ERPNDB-ALT-KEY,
 16699           DFHEIV99,
 16700           DFHEIV11,
 16701           DFHEIV99,
 16702           DFHEIV99
 16703     SET ADDRESS OF PENDING-BUSINESS TO
 16704         DFHEIV20
 16705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16706
 16707
 16708
 16709* EXEC CICS READPREV
 16710*         DATASET    (FILE-ID-ERPNDB2)
 16711*         SET        (ADDRESS OF PENDING-BUSINESS)
 16712*         RIDFLD     (ERPNDB-ALT-KEY)
 16713*    END-EXEC.
 16714     MOVE 0
 16715       TO DFHEIV11
 16716*    MOVE '&0S                   )   #00014303' TO DFHEIV0
 16717     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 16718     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 316
* EL6311.cbl
 16719     MOVE X'2020233030303134333033' TO DFHEIV0(25:11)
 16720     CALL 'kxdfhei1' USING DFHEIV0,
 16721           FILE-ID-ERPNDB2,
 16722           DFHEIV20,
 16723           DFHEIV99,
 16724           ERPNDB-ALT-KEY,
 16725           DFHEIV99,
 16726           DFHEIV11,
 16727           DFHEIV99,
 16728           DFHEIV99
 16729     SET ADDRESS OF PENDING-BUSINESS TO
 16730         DFHEIV20
 16731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16732
 16733
 16734 4580-READ-PREV-RECORD.
 16735
 16736* EXEC CICS READPREV
 16737*         DATASET    (FILE-ID-ERPNDB2)
 16738*         SET        (ADDRESS OF PENDING-BUSINESS)
 16739*         RIDFLD     (ERPNDB-ALT-KEY)
 16740*    END-EXEC.
 16741     MOVE 0
 16742       TO DFHEIV11
 16743*    MOVE '&0S                   )   #00014310' TO DFHEIV0
 16744     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 16745     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16746     MOVE X'2020233030303134333130' TO DFHEIV0(25:11)
 16747     CALL 'kxdfhei1' USING DFHEIV0,
 16748           FILE-ID-ERPNDB2,
 16749           DFHEIV20,
 16750           DFHEIV99,
 16751           ERPNDB-ALT-KEY,
 16752           DFHEIV99,
 16753           DFHEIV11,
 16754           DFHEIV99,
 16755           DFHEIV99
 16756     SET ADDRESS OF PENDING-BUSINESS TO
 16757         DFHEIV20
 16758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16759
 16760
 16761     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 16762
 16763     IF WS-BATCH-PREFIX = '#CL'
 16764        GO TO 4580-READ-PREV-RECORD.
 16765
 16766     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 16767     GO TO 4505-READ-PREV-RECORD.
 16768
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 317
* EL6311.cbl
 16770
 16771******************************************************************
 16772*                                                                *
 16773*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 16774*                                                                *
 16775******************************************************************
 16776
 16777 4600-BROWSE-PRIMARY-BACKWARD.
 16778        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 16779
 16780     IF ERPNDB-BATCH-SEQ-NO = +9999
 16781        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 16782
 16783        IF ERPNDB-BATCH-SEQ-NO = +0000
 16784           GO TO 4650-END-BATCH
 16785        ELSE
 16786           IF PI-MAP-NAME NOT = EL631D
 16787              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 16788                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 16789              ELSE
 16790                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 16791                 IF DISPLAY-CHANGE-RECORDS
 16792                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 16793                 ELSE
 16794                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 16795
 16796
 16797* EXEC CICS HANDLE CONDITION
 16798*         NOTFND    (4680-NOT-FOUND)
 16799*         ENDFILE   (4680-NOT-FOUND)
 16800*    END-EXEC.
 16801*    MOVE '"$I''                  ! M #00014351' TO DFHEIV0
 16802     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 16803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16804     MOVE X'4D20233030303134333531' TO DFHEIV0(25:11)
 16805     CALL 'kxdfhei1' USING DFHEIV0
 16806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16807
 16808
 16809 4605-READ-NEXT.
 16810     IF ERPNDB-BATCH-SEQ-NO = +0000
 16811        GO TO 4650-END-BATCH.
 16812
 16813     IF PI-DISPLAY-ORIGINAL-BATCH
 16814        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 16815     ELSE
 16816        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 16817
 16818
 16819* EXEC CICS READ
 16820*         DATASET   (FILE-ID)
 16821*         SET       (ADDRESS OF PENDING-BUSINESS)
 16822*         RIDFLD    (ERPNDB-KEY)
 16823*    END-EXEC.
 16824*    MOVE '&"S        E          (   #00014365' TO DFHEIV0
 16825     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16826     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16827     MOVE X'2020233030303134333635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 318
* EL6311.cbl
 16828     CALL 'kxdfhei1' USING DFHEIV0,
 16829           FILE-ID,
 16830           DFHEIV20,
 16831           DFHEIV99,
 16832           ERPNDB-KEY,
 16833           DFHEIV99,
 16834           DFHEIV99,
 16835           DFHEIV99
 16836     SET ADDRESS OF PENDING-BUSINESS TO
 16837         DFHEIV20
 16838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16839
 16840
 16841     IF NOT  PI-PRIMARY-WITH-SELECT
 16842        GO TO 4607-CHECK-REC-TYPE.
 16843
 16844     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 16845
 16846     IF  WS-BATCH-PREFIX = '#CL'
 16847         GO TO 4610-BUMP-SEQ.
 16848
 16849     IF PI-PB-CERT-NO NOT = LOW-VALUES
 16850        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 16851           GO TO 4610-BUMP-SEQ
 16852        ELSE
 16853           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 16854              GO TO 4607-CHECK-REC-TYPE
 16855           ELSE
 16856              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 16857                 GO TO 4607-CHECK-REC-TYPE
 16858              ELSE
 16859                 GO TO 4610-BUMP-SEQ.
 16860
 16861     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 16862        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 16863           GO TO 4610-BUMP-SEQ.
 16864
 16865 4607-CHECK-REC-TYPE.
 16866     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 16867         IF  PB-CARRIER = PI-CARRIER-SECURITY
 16868             NEXT SENTENCE
 16869         ELSE
 16870             GO TO 4610-BUMP-SEQ.
 16871
 16872     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 16873         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 16874             NEXT SENTENCE
 16875        ELSE
 16876             GO TO 4610-BUMP-SEQ.
 16877
 16878     IF NOT DISPLAY-CHANGE-RECORDS AND
 16879            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 16880        GO TO 4610-BUMP-SEQ.
 16881
 16882     IF DISPLAY-HOLD-RECORDS AND
 16883        NOT PB-RECORD-ON-HOLD
 16884          GO TO 4610-BUMP-SEQ.
 16885
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 319
* EL6311.cbl
 16886     IF PB-ISSUE
 16887        IF DISPLAY-CHK-REQ-RECORDS
 16888           GO TO 4610-BUMP-SEQ.
 16889
 16890     IF PB-ISSUE
 16891        IF ISSUE-WITH-WARNING
 16892           IF PB-WARNING-ERRORS
 16893              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 16894                  GO TO 4610-BUMP-SEQ
 16895              ELSE
 16896                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16897                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16898                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16899                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16900                 MOVE PB-SV-STATE            TO PI-SV-STATE
 16901                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16902                 GO TO 7000-DISPLAY-ISSUES
 16903           ELSE
 16904              GO TO 4610-BUMP-SEQ.
 16905
 16906     IF PB-ISSUE
 16907        IF (ISSUES-IN-ERROR AND
 16908            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 16909            ALL-ISSUES
 16910            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16911            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16912            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16913            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16914            MOVE PB-SV-STATE            TO PI-SV-STATE
 16915            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16916            GO TO 7000-DISPLAY-ISSUES
 16917        ELSE
 16918            GO TO 4610-BUMP-SEQ.
 16919
 16920     IF PB-CANCELLATION
 16921        IF DISPLAY-CHK-REQ-RECORDS
 16922           IF PB-C-REFUND-REQUESTED
 16923              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16924              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16925              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16926              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16927              MOVE PB-SV-STATE            TO PI-SV-STATE
 16928              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16929              GO TO 7100-DISPLAY-CANCELS
 16930           ELSE
 16931              GO TO 4610-BUMP-SEQ.
 16932
 16933     IF PB-CANCELLATION
 16934        IF CANCEL-WITH-WARNING
 16935           IF PB-WARNING-ERRORS
 16936              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 16937                  GO TO 4610-BUMP-SEQ
 16938              ELSE
 16939                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16940                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16941                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16942                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16943                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 320
* EL6311.cbl
 16944                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16945                 GO TO 7100-DISPLAY-CANCELS
 16946           ELSE
 16947              GO TO 4610-BUMP-SEQ.
 16948
 16949     IF PB-CANCELLATION
 16950        IF (CANCEL-IN-ERROR  AND
 16951            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 16952            ALL-CANCELS
 16953            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 16954            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 16955            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 16956            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 16957            MOVE PB-SV-STATE            TO PI-SV-STATE
 16958            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 16959            GO TO 7100-DISPLAY-CANCELS.
 16960
 16961 4610-BUMP-SEQ.
 16962     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 16963        GO TO 4650-END-BATCH.
 16964
 16965     IF DISPLAY-CHANGE-RECORDS
 16966        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 16967           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 16968        ELSE
 16969           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 16970           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 16971        ELSE
 16972           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 16973           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 16974
 16975        GO TO 4605-READ-NEXT.
 16976
 16977 4650-END-BATCH.
 16978     IF PI-MAP-NAME = EL631B
 16979        MOVE -1                  TO BMAINTL
 16980     ELSE
 16981        IF PI-MAP-NAME = EL631C
 16982           MOVE -1               TO CMAINTL
 16983        ELSE
 16984           MOVE -1               TO DPFENTRL.
 16985
 16986     MOVE ER-2252               TO EMI-ERROR.
 16987     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16988     GO TO 8200-SEND-DATAONLY.
 16989
 16990 4680-NOT-FOUND.
 16991     IF DISPLAY-CHANGE-RECORDS
 16992        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 16993           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 16994        ELSE
 16995           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 16996           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 16997     ELSE
 16998        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 16999
 17000     GO TO 4605-READ-NEXT.
 17001
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 321
* EL6311.cbl
 17003
 17004******************************************************************
 17005*                                                                *
 17006*        B R O W S E   F I L E   B A C K W A R D S               *
 17007*                                                                *
 17008******************************************************************
 17009
 17010 4800-BROWSE-FILE-BACKWARD.
 17011
 17012* EXEC CICS HANDLE CONDITION
 17013*         NOTFND   (4860-NOT-FOUND)
 17014*         ENDFILE  (4850-END-RECORDS)
 17015*    END-EXEC.
 17016*    MOVE '"$I''                  ! N #00014541' TO DFHEIV0
 17017     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17019     MOVE X'4E20233030303134353431' TO DFHEIV0(25:11)
 17020     CALL 'kxdfhei1' USING DFHEIV0
 17021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17022
 17023
 17024     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17025
 17026     IF PI-DISPLAY-ORIGINAL-BATCH
 17027        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17028     ELSE
 17029        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17030
 17031
 17032* EXEC CICS STARTBR
 17033*         DATASET   (FILE-ID)
 17034*         RIDFLD    (ERPNDB-KEY)
 17035*    END-EXEC.
 17036     MOVE 0
 17037       TO DFHEIV11
 17038*    MOVE '&,         G          &   #00014553' TO DFHEIV0
 17039     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17040     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17041     MOVE X'2020233030303134353533' TO DFHEIV0(25:11)
 17042     CALL 'kxdfhei1' USING DFHEIV0,
 17043           FILE-ID,
 17044           ERPNDB-KEY,
 17045           DFHEIV99,
 17046           DFHEIV11,
 17047           DFHEIV99
 17048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17049
 17050
 17051     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17052
 17053
 17054* EXEC CICS READPREV
 17055*         DATASET    (FILE-ID-ERPNDB)
 17056*         SET        (ADDRESS OF PENDING-BUSINESS)
 17057*         RIDFLD     (ERPNDB-KEY)
 17058*    END-EXEC.
 17059     MOVE 0
 17060       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 322
* EL6311.cbl
 17061*    MOVE '&0S                   )   #00014560' TO DFHEIV0
 17062     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 17063     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17064     MOVE X'2020233030303134353630' TO DFHEIV0(25:11)
 17065     CALL 'kxdfhei1' USING DFHEIV0,
 17066           FILE-ID-ERPNDB,
 17067           DFHEIV20,
 17068           DFHEIV99,
 17069           ERPNDB-KEY,
 17070           DFHEIV99,
 17071           DFHEIV11,
 17072           DFHEIV99,
 17073           DFHEIV99
 17074     SET ADDRESS OF PENDING-BUSINESS TO
 17075         DFHEIV20
 17076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17077
 17078
 17079 4810-READ-PREV-RECORD.
 17080
 17081* EXEC CICS READPREV
 17082*         DATASET    (FILE-ID-ERPNDB)
 17083*         SET        (ADDRESS OF PENDING-BUSINESS)
 17084*         RIDFLD     (ERPNDB-KEY)
 17085*    END-EXEC.
 17086     MOVE 0
 17087       TO DFHEIV11
 17088*    MOVE '&0S                   )   #00014567' TO DFHEIV0
 17089     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 17090     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17091     MOVE X'2020233030303134353637' TO DFHEIV0(25:11)
 17092     CALL 'kxdfhei1' USING DFHEIV0,
 17093           FILE-ID-ERPNDB,
 17094           DFHEIV20,
 17095           DFHEIV99,
 17096           ERPNDB-KEY,
 17097           DFHEIV99,
 17098           DFHEIV11,
 17099           DFHEIV99,
 17100           DFHEIV99
 17101     SET ADDRESS OF PENDING-BUSINESS TO
 17102         DFHEIV20
 17103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17104
 17105
 17106     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 17107        GO TO 4850-END-RECORDS.
 17108
 17109     IF PB-BATCH-TRAILER
 17110        GO TO 4810-READ-PREV-RECORD.
 17111
 17112     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17113
 17114     IF  WS-BATCH-PREFIX = '#CL'
 17115         GO TO 4810-READ-PREV-RECORD.
 17116
 17117     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17118        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 323
* EL6311.cbl
 17119           GO TO 4810-READ-PREV-RECORD
 17120        ELSE
 17121           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 17122              GO TO 4820-CHECK-REC-TYPE
 17123           ELSE
 17124              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 17125                 GO TO 4820-CHECK-REC-TYPE
 17126              ELSE
 17127                 GO TO 4810-READ-PREV-RECORD.
 17128
 17129     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 17130        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17131           GO TO 4810-READ-PREV-RECORD.
 17132
 17133 4820-CHECK-REC-TYPE.
 17134     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 17135         IF  PB-CARRIER = PI-CARRIER-SECURITY
 17136             NEXT SENTENCE
 17137         ELSE
 17138             GO TO 4810-READ-PREV-RECORD.
 17139
 17140     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 17141         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 17142             NEXT SENTENCE
 17143        ELSE
 17144             GO TO 4810-READ-PREV-RECORD.
 17145
 17146     IF NOT DISPLAY-CHANGE-RECORDS AND
 17147            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 17148        GO TO 4810-READ-PREV-RECORD.
 17149
 17150     IF DISPLAY-HOLD-RECORDS AND
 17151        NOT PB-RECORD-ON-HOLD
 17152          GO TO 4810-READ-PREV-RECORD.
 17153
 17154     IF PB-ISSUE
 17155        IF DISPLAY-CHK-REQ-RECORDS
 17156           GO TO 4810-READ-PREV-RECORD.
 17157
 17158     IF PB-ISSUE
 17159        IF ISSUE-WITH-WARNING
 17160           IF PB-WARNING-ERRORS
 17161              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17162                  GO TO 4810-READ-PREV-RECORD
 17163              ELSE
 17164                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17165                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17166                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17167                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17168                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17169                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17170                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17171                 GO TO 7000-DISPLAY-ISSUES
 17172           ELSE
 17173              GO TO 4810-READ-PREV-RECORD.
 17174
 17175     IF PB-ISSUE
 17176        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 324
* EL6311.cbl
 17177            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17178            ALL-ISSUES
 17179            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17180            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17181            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17182            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17183            MOVE PB-SV-STATE            TO PI-SV-STATE
 17184            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17185            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17186            GO TO 7000-DISPLAY-ISSUES
 17187        ELSE
 17188            GO TO 4810-READ-PREV-RECORD.
 17189
 17190     IF PB-CANCELLATION
 17191        IF DISPLAY-CHK-REQ-RECORDS
 17192           IF PB-C-REFUND-REQUESTED
 17193              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17194              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17195              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17196              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17197              MOVE PB-SV-STATE            TO PI-SV-STATE
 17198              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17199              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17200              GO TO 7100-DISPLAY-CANCELS
 17201           ELSE
 17202              GO TO 4810-READ-PREV-RECORD.
 17203
 17204     IF PB-CANCELLATION
 17205        IF CANCEL-WITH-WARNING
 17206           IF PB-WARNING-ERRORS
 17207              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17208                  GO TO 4810-READ-PREV-RECORD
 17209              ELSE
 17210                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17211                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17212                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17213                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17214                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17215                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17216                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17217                 GO TO 7100-DISPLAY-CANCELS
 17218           ELSE
 17219              GO TO 4810-READ-PREV-RECORD.
 17220
 17221     IF PB-CANCELLATION
 17222        IF (CANCEL-IN-ERROR  AND
 17223            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17224            ALL-CANCELS
 17225            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17226            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17227            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17228            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17229            MOVE PB-SV-STATE            TO PI-SV-STATE
 17230            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17231            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17232            GO TO 7100-DISPLAY-CANCELS.
 17233
 17234     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 325
* EL6311.cbl
 17235
 17236 4850-END-RECORDS.
 17237     MOVE ER-2252                TO EMI-ERROR.
 17238     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17239
 17240     IF PI-MAP-NAME = EL631B
 17241        MOVE -1                  TO BPFENTRL
 17242     ELSE
 17243        MOVE -1                  TO CPFENTRL.
 17244
 17245     GO TO 8200-SEND-DATAONLY.
 17246
 17247 4860-NOT-FOUND.
 17248
 17249******************************************************************
 17250*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 17251******************************************************************
 17252
 17253
 17254* EXEC CICS RESETBR
 17255*         DATASET    (FILE-ID-ERPNDB)
 17256*         RIDFLD     (ERPNDB-KEY)
 17257*     END-EXEC.
 17258     MOVE 0
 17259       TO DFHEIV11
 17260*    MOVE '&4         G          &   #00014720' TO DFHEIV0
 17261     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17262     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17263     MOVE X'2020233030303134373230' TO DFHEIV0(25:11)
 17264     CALL 'kxdfhei1' USING DFHEIV0,
 17265           FILE-ID-ERPNDB,
 17266           ERPNDB-KEY,
 17267           DFHEIV99,
 17268           DFHEIV11,
 17269           DFHEIV99
 17270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17271
 17272
 17273
 17274* EXEC CICS READNEXT
 17275*         DATASET    (FILE-ID-ERPNDB)
 17276*         SET        (ADDRESS OF PENDING-BUSINESS)
 17277*         RIDFLD     (ERPNDB-KEY)
 17278*    END-EXEC.
 17279     MOVE 0
 17280       TO DFHEIV11
 17281*    MOVE '&.S                   )   #00014725' TO DFHEIV0
 17282     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17283     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17284     MOVE X'2020233030303134373235' TO DFHEIV0(25:11)
 17285     CALL 'kxdfhei1' USING DFHEIV0,
 17286           FILE-ID-ERPNDB,
 17287           DFHEIV20,
 17288           DFHEIV99,
 17289           ERPNDB-KEY,
 17290           DFHEIV99,
 17291           DFHEIV11,
 17292           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 326
* EL6311.cbl
 17293           DFHEIV99
 17294     SET ADDRESS OF PENDING-BUSINESS TO
 17295         DFHEIV20
 17296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17297
 17298
 17299
 17300* EXEC CICS READPREV
 17301*         DATASET    (FILE-ID-ERPNDB)
 17302*         SET        (ADDRESS OF PENDING-BUSINESS)
 17303*         RIDFLD     (ERPNDB-KEY)
 17304*    END-EXEC.
 17305     MOVE 0
 17306       TO DFHEIV11
 17307*    MOVE '&0S                   )   #00014731' TO DFHEIV0
 17308     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 17309     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17310     MOVE X'2020233030303134373331' TO DFHEIV0(25:11)
 17311     CALL 'kxdfhei1' USING DFHEIV0,
 17312           FILE-ID-ERPNDB,
 17313           DFHEIV20,
 17314           DFHEIV99,
 17315           ERPNDB-KEY,
 17316           DFHEIV99,
 17317           DFHEIV11,
 17318           DFHEIV99,
 17319           DFHEIV99
 17320     SET ADDRESS OF PENDING-BUSINESS TO
 17321         DFHEIV20
 17322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17323
 17324
 17325     GO TO 4810-READ-PREV-RECORD.
 17326
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 327
* EL6311.cbl
 17328
 17329******************************************************************
 17330*                                                                *
 17331*           B R O W S E   C S R   B A C K W A R D                *
 17332*                                                                *
 17333******************************************************************
 17334
 17335 4900-BROWSE-CSR-BACKWARD.
 17336
 17337     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 17338
 17339
 17340* EXEC CICS HANDLE CONDITION
 17341*         NOTFND   (4970-NOT-FOUND)
 17342*         ENDFILE  (4950-END-RECORDS)
 17343*    END-EXEC
 17344*    MOVE '"$I''                  ! O #00014751' TO DFHEIV0
 17345     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17347     MOVE X'4F20233030303134373531' TO DFHEIV0(25:11)
 17348     CALL 'kxdfhei1' USING DFHEIV0
 17349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17350
 17351
 17352* EXEC CICS STARTBR
 17353*         DATASET   (FILE-ID-ERPNDB4)
 17354*         RIDFLD    (ERPNDB-CSR-KEY)
 17355*    END-EXEC.
 17356     MOVE 0
 17357       TO DFHEIV11
 17358*    MOVE '&,         G          &   #00014756' TO DFHEIV0
 17359     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17360     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17361     MOVE X'2020233030303134373536' TO DFHEIV0(25:11)
 17362     CALL 'kxdfhei1' USING DFHEIV0,
 17363           FILE-ID-ERPNDB4,
 17364           ERPNDB-CSR-KEY,
 17365           DFHEIV99,
 17366           DFHEIV11,
 17367           DFHEIV99
 17368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17369
 17370
 17371     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 17372                                    WS-FIRST-TIME-SW.
 17373
 17374 4905-READ-PREV-RECORD.
 17375
 17376* EXEC CICS READPREV
 17377*         DATASET    (FILE-ID-ERPNDB4)
 17378*         SET        (ADDRESS OF PENDING-BUSINESS)
 17379*         RIDFLD     (ERPNDB-CSR-KEY)
 17380*    END-EXEC.
 17381     MOVE 0
 17382       TO DFHEIV11
 17383*    MOVE '&0S                   )   #00014765' TO DFHEIV0
 17384     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 17385     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 328
* EL6311.cbl
 17386     MOVE X'2020233030303134373635' TO DFHEIV0(25:11)
 17387     CALL 'kxdfhei1' USING DFHEIV0,
 17388           FILE-ID-ERPNDB4,
 17389           DFHEIV20,
 17390           DFHEIV99,
 17391           ERPNDB-CSR-KEY,
 17392           DFHEIV99,
 17393           DFHEIV11,
 17394           DFHEIV99,
 17395           DFHEIV99
 17396     SET ADDRESS OF PENDING-BUSINESS TO
 17397         DFHEIV20
 17398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17399
 17400
 17401     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17402
 17403     IF WS-BATCH-PREFIX = '#CL'
 17404         GO TO 4905-READ-PREV-RECORD.
 17405
 17406     IF FIRST-TIME
 17407         MOVE SPACE               TO WS-FIRST-TIME-SW
 17408         GO TO 4905-READ-PREV-RECORD.
 17409
 17410     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 17411        PB-CSR-ID           NOT = PI-PB-CSR-ID
 17412        GO TO 4950-END-RECORDS.
 17413
 17414     IF PB-BATCH-TRAILER
 17415        GO TO 4905-READ-PREV-RECORD.
 17416
 17417     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17418
 17419     IF  WS-BATCH-PREFIX = '#CL'
 17420         GO TO 4905-READ-PREV-RECORD.
 17421
 17422     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17423        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 17424           GO TO 4905-READ-PREV-RECORD
 17425        ELSE
 17426           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 17427              GO TO 4910-CHECK-REC-TYPE
 17428           ELSE
 17429              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 17430                 GO TO 4910-CHECK-REC-TYPE
 17431              ELSE
 17432                 GO TO 4905-READ-PREV-RECORD.
 17433
 17434     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 17435        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17436           GO TO 4905-READ-PREV-RECORD.
 17437
 17438 4910-CHECK-REC-TYPE.
 17439     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 17440         IF  PB-CARRIER = PI-CARRIER-SECURITY
 17441             NEXT SENTENCE
 17442         ELSE
 17443             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 329
* EL6311.cbl
 17444
 17445     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 17446         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 17447             NEXT SENTENCE
 17448        ELSE
 17449             GO TO 4905-READ-PREV-RECORD.
 17450
 17451     IF NOT DISPLAY-CHANGE-RECORDS AND
 17452            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 17453        GO TO 4905-READ-PREV-RECORD.
 17454
 17455     IF DISPLAY-HOLD-RECORDS AND
 17456        NOT PB-RECORD-ON-HOLD
 17457          GO TO 4905-READ-PREV-RECORD.
 17458
 17459     IF PB-ISSUE
 17460        IF DISPLAY-CHK-REQ-RECORDS
 17461           GO TO 4905-READ-PREV-RECORD.
 17462
 17463     IF PB-ISSUE
 17464        IF ISSUE-WITH-WARNING
 17465           IF PB-WARNING-ERRORS
 17466              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17467                  GO TO 4505-READ-PREV-RECORD
 17468              ELSE
 17469                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 17470                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17471                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17472                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17473                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17474                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17475                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17476                 GO TO 7000-DISPLAY-ISSUES
 17477           ELSE
 17478              GO TO 4905-READ-PREV-RECORD.
 17479
 17480     IF PB-ISSUE
 17481        IF (ISSUES-IN-ERROR AND
 17482            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17483            ALL-ISSUES
 17484            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 17485            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17486            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17487            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17488            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17489            MOVE PB-SV-STATE            TO PI-SV-STATE
 17490            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17491            GO TO 7000-DISPLAY-ISSUES
 17492        ELSE
 17493            GO TO 4905-READ-PREV-RECORD.
 17494
 17495     IF PB-CANCELLATION
 17496        IF DISPLAY-CHK-REQ-RECORDS
 17497           IF PB-C-REFUND-REQUESTED
 17498              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 17499              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17500              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17501              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 330
* EL6311.cbl
 17502              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17503              MOVE PB-SV-STATE            TO PI-SV-STATE
 17504              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17505              GO TO 7100-DISPLAY-CANCELS
 17506           ELSE
 17507              GO TO 4905-READ-PREV-RECORD.
 17508
 17509     IF PB-CANCELLATION
 17510        IF CANCEL-WITH-WARNING
 17511           IF PB-WARNING-ERRORS
 17512              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17513                  GO TO 4505-READ-PREV-RECORD
 17514              ELSE
 17515                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 17516                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17517                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17518                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17519                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17520                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17521                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17522                 GO TO 7100-DISPLAY-CANCELS
 17523           ELSE
 17524              GO TO 4905-READ-PREV-RECORD.
 17525
 17526     IF PB-CANCELLATION
 17527        IF (CANCEL-IN-ERROR  AND
 17528            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17529            ALL-CANCELS
 17530            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 17531            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17532            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17533            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17534            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17535            MOVE PB-SV-STATE            TO PI-SV-STATE
 17536            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17537            GO TO 7100-DISPLAY-CANCELS.
 17538
 17539     GO TO 4905-READ-PREV-RECORD.
 17540
 17541 4950-END-RECORDS.
 17542     IF PI-MAP-NAME = EL631B
 17543        MOVE -1                  TO BMAINTL
 17544     ELSE
 17545        IF PI-MAP-NAME = EL631C
 17546           MOVE -1               TO CMAINTL
 17547        ELSE
 17548           MOVE -1               TO DPFENTRL.
 17549
 17550     MOVE ER-2255               TO EMI-ERROR.
 17551     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17552     GO TO 8200-SEND-DATAONLY.
 17553
 17554 4970-NOT-FOUND.
 17555
 17556******************************************************************
 17557*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 17558******************************************************************
 17559
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 331
* EL6311.cbl
 17560
 17561* EXEC CICS RESETBR
 17562*         DATASET    (FILE-ID-ERPNDB4)
 17563*         RIDFLD     (ERPNDB-CSR-KEY)
 17564*    END-EXEC.
 17565     MOVE 0
 17566       TO DFHEIV11
 17567*    MOVE '&4         G          &   #00014930' TO DFHEIV0
 17568     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17569     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17570     MOVE X'2020233030303134393330' TO DFHEIV0(25:11)
 17571     CALL 'kxdfhei1' USING DFHEIV0,
 17572           FILE-ID-ERPNDB4,
 17573           ERPNDB-CSR-KEY,
 17574           DFHEIV99,
 17575           DFHEIV11,
 17576           DFHEIV99
 17577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17578
 17579
 17580
 17581* EXEC CICS READNEXT
 17582*         DATASET    (FILE-ID-ERPNDB4)
 17583*         SET        (ADDRESS OF PENDING-BUSINESS)
 17584*         RIDFLD     (ERPNDB-CSR-KEY)
 17585*    END-EXEC.
 17586     MOVE 0
 17587       TO DFHEIV11
 17588*    MOVE '&.S                   )   #00014935' TO DFHEIV0
 17589     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17590     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17591     MOVE X'2020233030303134393335' TO DFHEIV0(25:11)
 17592     CALL 'kxdfhei1' USING DFHEIV0,
 17593           FILE-ID-ERPNDB4,
 17594           DFHEIV20,
 17595           DFHEIV99,
 17596           ERPNDB-CSR-KEY,
 17597           DFHEIV99,
 17598           DFHEIV11,
 17599           DFHEIV99,
 17600           DFHEIV99
 17601     SET ADDRESS OF PENDING-BUSINESS TO
 17602         DFHEIV20
 17603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17604
 17605
 17606
 17607* EXEC CICS READPREV
 17608*         DATASET    (FILE-ID-ERPNDB4)
 17609*         SET        (ADDRESS OF PENDING-BUSINESS)
 17610*         RIDFLD     (ERPNDB-CSR-KEY)
 17611*    END-EXEC.
 17612     MOVE 0
 17613       TO DFHEIV11
 17614*    MOVE '&0S                   )   #00014941' TO DFHEIV0
 17615     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 17616     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17617     MOVE X'2020233030303134393431' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 332
* EL6311.cbl
 17618     CALL 'kxdfhei1' USING DFHEIV0,
 17619           FILE-ID-ERPNDB4,
 17620           DFHEIV20,
 17621           DFHEIV99,
 17622           ERPNDB-CSR-KEY,
 17623           DFHEIV99,
 17624           DFHEIV11,
 17625           DFHEIV99,
 17626           DFHEIV99
 17627     SET ADDRESS OF PENDING-BUSINESS TO
 17628         DFHEIV20
 17629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17630
 17631
 17632 4980-READ-PREV-RECORD.
 17633
 17634* EXEC CICS READPREV
 17635*         DATASET    (FILE-ID-ERPNDB4)
 17636*         SET        (ADDRESS OF PENDING-BUSINESS)
 17637*         RIDFLD     (ERPNDB-CSR-KEY)
 17638*    END-EXEC.
 17639     MOVE 0
 17640       TO DFHEIV11
 17641*    MOVE '&0S                   )   #00014948' TO DFHEIV0
 17642     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 17643     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17644     MOVE X'2020233030303134393438' TO DFHEIV0(25:11)
 17645     CALL 'kxdfhei1' USING DFHEIV0,
 17646           FILE-ID-ERPNDB4,
 17647           DFHEIV20,
 17648           DFHEIV99,
 17649           ERPNDB-CSR-KEY,
 17650           DFHEIV99,
 17651           DFHEIV11,
 17652           DFHEIV99,
 17653           DFHEIV99
 17654     SET ADDRESS OF PENDING-BUSINESS TO
 17655         DFHEIV20
 17656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17657
 17658
 17659     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17660
 17661     IF WS-BATCH-PREFIX = '#CL'
 17662        GO TO 4980-READ-PREV-RECORD.
 17663
 17664     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 17665     GO TO 4905-READ-PREV-RECORD.
 17666
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 333
* EL6311.cbl
 17668
 17669
 17670******************************************************************
 17671*                                                                *
 17672*        B R O W S E   B A T C H   H E A D E R S                 *
 17673*                                                                *
 17674******************************************************************
 17675
 17676 5000-BROWSE-BATCH-HEADERS.
 17677
 17678     IF EIBTRNID NOT = TRANS-EXB1
 17679        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 17680        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 17681        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 17682        GO TO 5010-READ-NEXT-RECORD.
 17683
 17684     IF EIBAID = DFHPF4
 17685        MOVE '0'                TO PI-EDIT-SW
 17686        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17687        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 17688        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 17689        GO TO 5010-READ-NEXT-RECORD.
 17690
 17691     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17692     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 17693     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17694
 17695
 17696* EXEC CICS HANDLE CONDITION
 17697*         ENDFILE  (5050-NOT-FOUND)
 17698*    END-EXEC.
 17699*    MOVE '"$''                   ! P #00014990' TO DFHEIV0
 17700     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 17701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17702     MOVE X'5020233030303134393930' TO DFHEIV0(25:11)
 17703     CALL 'kxdfhei1' USING DFHEIV0
 17704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17705
 17706
 17707 5010-READ-NEXT-RECORD.
 17708
 17709* EXEC CICS HANDLE CONDITION
 17710*         NOTFND    (5050-NOT-FOUND)
 17711*    END-EXEC.
 17712*    MOVE '"$I                   ! Q #00014995' TO DFHEIV0
 17713     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17715     MOVE X'5120233030303134393935' TO DFHEIV0(25:11)
 17716     CALL 'kxdfhei1' USING DFHEIV0
 17717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17718
 17719
 17720
 17721* EXEC CICS READ
 17722*         DATASET   (FILE-ID-ERPNDB)
 17723*         SET       (ADDRESS OF PENDING-BUSINESS)
 17724*         RIDFLD    (ERPNDB-KEY)
 17725*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 334
* EL6311.cbl
 17726*    END-EXEC.
 17727*    MOVE '&"S        G          (   #00014999' TO DFHEIV0
 17728     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17729     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17730     MOVE X'2020233030303134393939' TO DFHEIV0(25:11)
 17731     CALL 'kxdfhei1' USING DFHEIV0,
 17732           FILE-ID-ERPNDB,
 17733           DFHEIV20,
 17734           DFHEIV99,
 17735           ERPNDB-KEY,
 17736           DFHEIV99,
 17737           DFHEIV99,
 17738           DFHEIV99
 17739     SET ADDRESS OF PENDING-BUSINESS TO
 17740         DFHEIV20
 17741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17742
 17743
 17744     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 17745         GO TO 5050-NOT-FOUND.
 17746
 17747     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17748
 17749     IF WS-BATCH-PREFIX = '#CL'
 17750         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 17751         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 17752         GO TO 5010-READ-NEXT-RECORD.
 17753
 17754     IF NOT PB-BATCH-TRAILER
 17755         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 17756         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 17757         GO TO 5010-READ-NEXT-RECORD.
 17758
 17759     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 17760         IF  PB-CARRIER = PI-CARRIER-SECURITY
 17761             NEXT SENTENCE
 17762         ELSE
 17763             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 17764             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 17765             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 17766             GO TO 5010-READ-NEXT-RECORD.
 17767
 17768     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 17769         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 17770             NEXT SENTENCE
 17771        ELSE
 17772             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 17773             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 17774             GO TO 5010-READ-NEXT-RECORD.
 17775
 17776     IF EIBAID = DFHPF4
 17777        MOVE '0'                TO PI-EDIT-SW
 17778        GO TO 7200-DISPLAY-BATCHES.
 17779
 17780     IF PI-CSR-BROWSE
 17781        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 17782           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 17783           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 335
* EL6311.cbl
 17784           GO TO 5010-READ-NEXT-RECORD.
 17785
 17786     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 17787       IF PI-PB-CARRIER    = SPACES AND
 17788          PI-PB-GROUPING   = SPACES AND
 17789          PI-PB-STATE      = SPACES AND
 17790          PI-PB-ACCOUNT    = SPACES
 17791            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17792            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17793            GO TO 7200-DISPLAY-BATCHES
 17794         ELSE
 17795           IF PI-PB-CARRIER    = PB-CARRIER  AND
 17796              PI-PB-GROUPING   = PB-GROUPING AND
 17797              PI-PB-STATE      = PB-STATE    AND
 17798              PI-PB-ACCOUNT    = PB-ACCOUNT
 17799              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 17800              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17801              GO TO 7200-DISPLAY-BATCHES.
 17802
 17803     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 17804     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 17805
 17806
 17807* EXEC CICS HANDLE CONDITION
 17808*         NOTFND    (5050-NOT-FOUND)
 17809*    END-EXEC.
 17810*    MOVE '"$I                   ! R #00015068' TO DFHEIV0
 17811     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17813     MOVE X'5220233030303135303638' TO DFHEIV0(25:11)
 17814     CALL 'kxdfhei1' USING DFHEIV0
 17815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17816
 17817
 17818
 17819* EXEC CICS READ
 17820*         DATASET   (FILE-ID-ERPNDB)
 17821*         SET       (ADDRESS OF PENDING-BUSINESS)
 17822*         RIDFLD    (ERPNDB-KEY)
 17823*         GTEQ
 17824*    END-EXEC.
 17825*    MOVE '&"S        G          (   #00015072' TO DFHEIV0
 17826     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17827     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17828     MOVE X'2020233030303135303732' TO DFHEIV0(25:11)
 17829     CALL 'kxdfhei1' USING DFHEIV0,
 17830           FILE-ID-ERPNDB,
 17831           DFHEIV20,
 17832           DFHEIV99,
 17833           ERPNDB-KEY,
 17834           DFHEIV99,
 17835           DFHEIV99,
 17836           DFHEIV99
 17837     SET ADDRESS OF PENDING-BUSINESS TO
 17838         DFHEIV20
 17839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17840
 17841
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 336
* EL6311.cbl
 17842     GO TO 5010-READ-NEXT-RECORD.
 17843
 17844 5050-NOT-FOUND.
 17845
 17846******************************************************************
 17847*                                                                *
 17848*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 17849*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 17850*         PROGRAM.                                               *
 17851*                                                                *
 17852******************************************************************
 17853
 17854     IF EIBTRNID NOT = TRANS-EXB1
 17855        IF PENDING-BUS-RECS-FOUND
 17856            NEXT SENTENCE
 17857          ELSE
 17858            MOVE '9'            TO PI-BROWSE-SW
 17859            GO TO 9400-CLEAR.
 17860
 17861     MOVE ER-2256                TO EMI-ERROR.
 17862     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17863
 17864     IF PI-MAP-NAME = SPACES
 17865        MOVE EL631D              TO PI-MAP-NAME
 17866        MOVE -1                  TO DPFENTRL
 17867        GO TO 8100-SEND-INITIAL-MAP.
 17868
 17869     IF PI-MAP-NAME = EL631B
 17870        MOVE -1                  TO BMAINTL
 17871     ELSE
 17872        IF PI-MAP-NAME = EL631C
 17873           MOVE -1               TO CMAINTL
 17874        ELSE
 17875           MOVE -1               TO DPFENTRL
 17876           GO TO 8200-SEND-DATAONLY.
 17877
 17878     GO TO 8100-SEND-INITIAL-MAP.
 17879
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 337
* EL6311.cbl
 17881
 17882******************************************************************
 17883*                                                                *
 17884*        B R O W S E   B A T C H   B A C K W A R D S             *
 17885*                                                                *
 17886******************************************************************
 17887
 17888 5500-BROWSE-BATCH-BACKWARD.
 17889
 17890* EXEC CICS HANDLE CONDITION
 17891*         NOTFND   (5550-END-RECORDS)
 17892*         ENDFILE  (5550-END-RECORDS)
 17893*    END-EXEC.
 17894*    MOVE '"$I''                  ! S #00015126' TO DFHEIV0
 17895     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17897     MOVE X'5320233030303135313236' TO DFHEIV0(25:11)
 17898     CALL 'kxdfhei1' USING DFHEIV0
 17899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17900
 17901
 17902 5505-START-BROWSE.
 17903     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17904     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17905     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17906
 17907
 17908* EXEC CICS STARTBR
 17909*         DATASET   (FILE-ID-ERPNDB)
 17910*         RIDFLD    (ERPNDB-ALT-KEY)
 17911*    END-EXEC.
 17912     MOVE 0
 17913       TO DFHEIV11
 17914*    MOVE '&,         G          &   #00015136' TO DFHEIV0
 17915     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17916     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17917     MOVE X'2020233030303135313336' TO DFHEIV0(25:11)
 17918     CALL 'kxdfhei1' USING DFHEIV0,
 17919           FILE-ID-ERPNDB,
 17920           ERPNDB-ALT-KEY,
 17921           DFHEIV99,
 17922           DFHEIV11,
 17923           DFHEIV99
 17924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17925
 17926
 17927     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17928
 17929
 17930* EXEC CICS READNEXT
 17931*         DATASET    (FILE-ID-ERPNDB)
 17932*         SET        (ADDRESS OF PENDING-BUSINESS)
 17933*         RIDFLD     (ERPNDB-KEY)
 17934*    END-EXEC.
 17935     MOVE 0
 17936       TO DFHEIV11
 17937*    MOVE '&.S                   )   #00015143' TO DFHEIV0
 17938     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 338
* EL6311.cbl
 17939     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17940     MOVE X'2020233030303135313433' TO DFHEIV0(25:11)
 17941     CALL 'kxdfhei1' USING DFHEIV0,
 17942           FILE-ID-ERPNDB,
 17943           DFHEIV20,
 17944           DFHEIV99,
 17945           ERPNDB-KEY,
 17946           DFHEIV99,
 17947           DFHEIV11,
 17948           DFHEIV99,
 17949           DFHEIV99
 17950     SET ADDRESS OF PENDING-BUSINESS TO
 17951         DFHEIV20
 17952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17953
 17954
 17955
 17956* EXEC CICS READPREV
 17957*         DATASET    (FILE-ID-ERPNDB)
 17958*         SET        (ADDRESS OF PENDING-BUSINESS)
 17959*         RIDFLD     (ERPNDB-KEY)
 17960*    END-EXEC.
 17961     MOVE 0
 17962       TO DFHEIV11
 17963*    MOVE '&0S                   )   #00015149' TO DFHEIV0
 17964     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 17965     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17966     MOVE X'2020233030303135313439' TO DFHEIV0(25:11)
 17967     CALL 'kxdfhei1' USING DFHEIV0,
 17968           FILE-ID-ERPNDB,
 17969           DFHEIV20,
 17970           DFHEIV99,
 17971           ERPNDB-KEY,
 17972           DFHEIV99,
 17973           DFHEIV11,
 17974           DFHEIV99,
 17975           DFHEIV99
 17976     SET ADDRESS OF PENDING-BUSINESS TO
 17977         DFHEIV20
 17978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17979
 17980
 17981
 17982* EXEC CICS READPREV
 17983*         DATASET    (FILE-ID-ERPNDB)
 17984*         SET        (ADDRESS OF PENDING-BUSINESS)
 17985*         RIDFLD     (ERPNDB-KEY)
 17986*    END-EXEC.
 17987     MOVE 0
 17988       TO DFHEIV11
 17989*    MOVE '&0S                   )   #00015155' TO DFHEIV0
 17990     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 17991     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17992     MOVE X'2020233030303135313535' TO DFHEIV0(25:11)
 17993     CALL 'kxdfhei1' USING DFHEIV0,
 17994           FILE-ID-ERPNDB,
 17995           DFHEIV20,
 17996           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 339
* EL6311.cbl
 17997           ERPNDB-KEY,
 17998           DFHEIV99,
 17999           DFHEIV11,
 18000           DFHEIV99,
 18001           DFHEIV99
 18002     SET ADDRESS OF PENDING-BUSINESS TO
 18003         DFHEIV20
 18004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18005
 18006
 18007     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 18008        GO TO 5550-END-RECORDS.
 18009
 18010     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 18011
 18012     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18013
 18014     IF  WS-BATCH-PREFIX = '#CL'
 18015             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18016
 18017* EXEC CICS ENDBR
 18018*                 DATASET  (FILE-ID-ERPNDB)
 18019*            END-EXEC
 18020     MOVE 0
 18021       TO DFHEIV11
 18022*    MOVE '&2                    $   #00015170' TO DFHEIV0
 18023     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18025     MOVE X'2020233030303135313730' TO DFHEIV0(25:11)
 18026     CALL 'kxdfhei1' USING DFHEIV0,
 18027           FILE-ID-ERPNDB,
 18028           DFHEIV11,
 18029           DFHEIV99
 18030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18031         GO TO 5505-START-BROWSE.
 18032
 18033     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18034         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18035             NEXT SENTENCE
 18036         ELSE
 18037             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18038
 18039* EXEC CICS ENDBR
 18040*                 DATASET  (FILE-ID-ERPNDB)
 18041*            END-EXEC
 18042     MOVE 0
 18043       TO DFHEIV11
 18044*    MOVE '&2                    $   #00015180' TO DFHEIV0
 18045     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18046     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18047     MOVE X'2020233030303135313830' TO DFHEIV0(25:11)
 18048     CALL 'kxdfhei1' USING DFHEIV0,
 18049           FILE-ID-ERPNDB,
 18050           DFHEIV11,
 18051           DFHEIV99
 18052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18053             GO TO 5505-START-BROWSE.
 18054
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 340
* EL6311.cbl
 18055
 18056     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18057         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18058             NEXT SENTENCE
 18059        ELSE
 18060             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18061
 18062* EXEC CICS ENDBR
 18063*                 DATASET  (FILE-ID-ERPNDB)
 18064*            END-EXEC
 18065     MOVE 0
 18066       TO DFHEIV11
 18067*    MOVE '&2                    $   #00015191' TO DFHEIV0
 18068     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18069     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18070     MOVE X'2020233030303135313931' TO DFHEIV0(25:11)
 18071     CALL 'kxdfhei1' USING DFHEIV0,
 18072           FILE-ID-ERPNDB,
 18073           DFHEIV11,
 18074           DFHEIV99
 18075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18076             GO TO 5505-START-BROWSE.
 18077
 18078     IF NOT PB-BATCH-TRAILER
 18079        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18080
 18081* EXEC CICS ENDBR
 18082*            DATASET  (FILE-ID-ERPNDB)
 18083*       END-EXEC
 18084     MOVE 0
 18085       TO DFHEIV11
 18086*    MOVE '&2                    $   #00015198' TO DFHEIV0
 18087     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18088     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18089     MOVE X'2020233030303135313938' TO DFHEIV0(25:11)
 18090     CALL 'kxdfhei1' USING DFHEIV0,
 18091           FILE-ID-ERPNDB,
 18092           DFHEIV11,
 18093           DFHEIV99
 18094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18095        GO TO 5505-START-BROWSE.
 18096
 18097     IF PI-CSR-BROWSE
 18098        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 18099           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 18100
 18101* EXEC CICS ENDBR
 18102*               DATASET  (FILE-ID-ERPNDB)
 18103*          END-EXEC
 18104     MOVE 0
 18105       TO DFHEIV11
 18106*    MOVE '&2                    $   #00015206' TO DFHEIV0
 18107     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18108     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18109     MOVE X'2020233030303135323036' TO DFHEIV0(25:11)
 18110     CALL 'kxdfhei1' USING DFHEIV0,
 18111           FILE-ID-ERPNDB,
 18112           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 341
* EL6311.cbl
 18113           DFHEIV99
 18114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18115           GO TO 5505-START-BROWSE.
 18116
 18117     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 18118        IF PI-PB-CARRIER    = SPACES AND
 18119           PI-PB-GROUPING   = SPACES AND
 18120           PI-PB-STATE      = SPACES AND
 18121           PI-PB-ACCOUNT    = SPACES
 18122             GO TO 7200-DISPLAY-BATCHES
 18123          ELSE
 18124            IF PI-PB-CARRIER    = PB-CARRIER  AND
 18125               PI-PB-GROUPING   = PB-GROUPING AND
 18126               PI-PB-STATE      = PB-STATE    AND
 18127               PI-PB-ACCOUNT    = PB-ACCOUNT
 18128                 GO TO 7200-DISPLAY-BATCHES.
 18129
 18130     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 18131
 18132
 18133* EXEC CICS ENDBR
 18134*         DATASET  (FILE-ID-ERPNDB)
 18135*    END-EXEC.
 18136     MOVE 0
 18137       TO DFHEIV11
 18138*    MOVE '&2                    $   #00015226' TO DFHEIV0
 18139     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18140     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18141     MOVE X'2020233030303135323236' TO DFHEIV0(25:11)
 18142     CALL 'kxdfhei1' USING DFHEIV0,
 18143           FILE-ID-ERPNDB,
 18144           DFHEIV11,
 18145           DFHEIV99
 18146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18147
 18148
 18149     GO TO 5505-START-BROWSE.
 18150
 18151 5550-END-RECORDS.
 18152     MOVE ER-2257                TO EMI-ERROR.
 18153     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18154     MOVE -1                     TO DPFENTRL.
 18155
 18156     GO TO 8200-SEND-DATAONLY.
 18157
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 342
* EL6311.cbl
 18159
 18160******************************************************************
 18161*                                                                *
 18162*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 18163*                                                                *
 18164******************************************************************
 18165
 18166 6000-CREATE-TEMP-STORAGE.
 18167
 18168
 18169* EXEC CICS HANDLE CONDITION
 18170*        QIDERR  (6050-QID-ERROR)
 18171*    END-EXEC.
 18172*    MOVE '"$N                   ! T #00015249' TO DFHEIV0
 18173     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 18174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18175     MOVE X'5420233030303135323439' TO DFHEIV0(25:11)
 18176     CALL 'kxdfhei1' USING DFHEIV0
 18177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18178
 18179
 18180
 18181* EXEC CICS WRITEQ TS
 18182*        QUEUE    (QID)
 18183*        FROM     (PROGRAM-INTERFACE-BLOCK)
 18184*        LENGTH   (WS-COMM-LENGTH)
 18185*        ITEM     (W-ONE)
 18186*    END-EXEC.
 18187*    MOVE '*" I                  ''   #00015253' TO DFHEIV0
 18188     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 18189     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18190     MOVE X'2020233030303135323533' TO DFHEIV0(25:11)
 18191     CALL 'kxdfhei1' USING DFHEIV0,
 18192           QID,
 18193           PROGRAM-INTERFACE-BLOCK,
 18194           WS-COMM-LENGTH,
 18195           W-ONE,
 18196           DFHEIV99,
 18197           DFHEIV99
 18198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18199
 18200
 18201 6000-EXIT.
 18202      EXIT.
 18203
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 343
* EL6311.cbl
 18205
 18206******************************************************************
 18207*                                                                *
 18208*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 18209*                                                                *
 18210******************************************************************
 18211
 18212 6050-RECOVER-TEMP-STORAGE.
 18213     IF PGM-NAME = XCTL-EL6312
 18214        GO TO 6050-EXIT.
 18215
 18216     IF PGM-NAME = XCTL-EL6313
 18217        GO TO 6050-EXIT.
 18218
 18219
 18220* EXEC CICS HANDLE CONDITION
 18221*        QIDERR  (6050-QID-ERROR)
 18222*    END-EXEC.
 18223*    MOVE '"$N                   ! U #00015278' TO DFHEIV0
 18224     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 18225     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18226     MOVE X'5520233030303135323738' TO DFHEIV0(25:11)
 18227     CALL 'kxdfhei1' USING DFHEIV0
 18228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18229
 18230
 18231
 18232* EXEC CICS READQ TS
 18233*         QUEUE   (QID)
 18234*         INTO    (PROGRAM-INTERFACE-BLOCK)
 18235*         LENGTH  (WS-COMM-LENGTH)
 18236*         ITEM    (W-ONE)
 18237*     END-EXEC.
 18238*    MOVE '*$II   L              ''   #00015282' TO DFHEIV0
 18239     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 18240     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18241     MOVE X'2020233030303135323832' TO DFHEIV0(25:11)
 18242     CALL 'kxdfhei1' USING DFHEIV0,
 18243           QID,
 18244           PROGRAM-INTERFACE-BLOCK,
 18245           WS-COMM-LENGTH,
 18246           W-ONE,
 18247           DFHEIV99,
 18248           DFHEIV99
 18249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18250
 18251
 18252 6050-DELETE-TEMP-STORAGE.
 18253
 18254
 18255* EXEC CICS DELETEQ TS
 18256*        QUEUE   (QID)
 18257*    END-EXEC.
 18258*    MOVE '*&                    #   #00015291' TO DFHEIV0
 18259     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 18260     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18261     MOVE X'2020233030303135323931' TO DFHEIV0(25:11)
 18262     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 344
* EL6311.cbl
 18263           QID,
 18264           DFHEIV99
 18265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18266
 18267
 18268     GO TO 6050-EXIT.
 18269
 18270 6050-QID-ERROR.
 18271     MOVE ER-0033                TO EMI-ERROR
 18272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18273
 18274 6050-EXIT.
 18275      EXIT.
 18276
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 345
* EL6311.cbl
 18278
 18279******************************************************************
 18280*                                                                *
 18281*            T E R M   C O N V E R S I O N                       *
 18282*                                                                *
 18283******************************************************************
 18284
 18285 6100-TERM-CONVERSION.
 18286
 18287     IF PI-BPMTS = ZERO
 18288         GO TO 6199-EXIT.
 18289
 18290     IF PI-BMODE = ' ' OR 'M'
 18291         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 18292         GO TO 6105-ROUND-TERM.
 18293
 18294     IF PI-BMODE = 'S'
 18295         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 18296         GO TO 6105-ROUND-TERM.
 18297
 18298     IF PI-BMODE = 'W'
 18299         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 18300         GO TO 6105-ROUND-TERM.
 18301
 18302     IF PI-BMODE = 'B'
 18303         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 18304         GO TO 6105-ROUND-TERM.
 18305
 18306     IF PI-BMODE = 'T'
 18307         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 18308
 18309 6105-ROUND-TERM.
 18310
 18311     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 18312         ADD +1                  TO WS-CALC-TERM-WHOLE
 18313         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 18314
 18315     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 18316         GO TO 6125-COMPUTE-TERM-BENEFIT.
 18317
 18318     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 18319         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 18320                                      WS-BTERM    (WS-SUB1)
 18321         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 18322
 18323     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 18324         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 18325             MOVE -1               TO BMODEL
 18326             MOVE ER-2593          TO EMI-ERROR
 18327             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 18328             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18329
 18330 6124-CHECK-BENEFIT.
 18331
 18332     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 18333        GO TO 6126-COMPUTE-BENEFIT.
 18334
 18335     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 346
* EL6311.cbl
 18336
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 347
* EL6311.cbl
 18338******************************************************************
 18339**         COMPUTE TERM AND BENEFIT
 18340******************************************************************
 18341 6125-COMPUTE-TERM-BENEFIT.
 18342
 18343     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 18344        PI-BPMTAMT = ZERO
 18345         GO TO 6199-EXIT.
 18346
 18347     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 18348                                     WS-BTERM  (WS-SUB1).
 18349     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 18350
 18351 6126-COMPUTE-BENEFIT.
 18352
 18353     IF PI-BMODE = 'M' OR  ' '
 18354         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 18355
 18356     IF PI-BMODE = 'W'
 18357         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 18358
 18359     IF PI-BMODE = 'S'
 18360         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 18361
 18362     IF PI-BMODE = 'B'
 18363         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 18364
 18365     IF PI-BMODE = 'T'
 18366         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 18367
 18368     IF WS-SUB1 = +1
 18369        COMPUTE WS-BBEN (WS-SUB1) =
 18370                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 18371
 18372     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 18373     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 18374     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 18375
 18376 6199-EXIT.
 18377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 348
* EL6311.cbl
 18379
 18380******************************************************************
 18381*                                                                *
 18382*             D I S P L A Y   I S S U E S                        *
 18383*                                                                *
 18384******************************************************************
 18385
 18386 6200-CREATE-VADS.
 18387     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 18388     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 18389
 18390* EXEC CICS GETMAIN
 18391*       SET      (ADDRESS OF PENDING-BUSINESS)
 18392*       LENGTH   (ERPNDB-RECORD-LENGTH)
 18393*       INITIMG  (GETMAIN-SPACE)
 18394*       RESP     (WS-RESPONSE)
 18395*    END-EXEC
 18396*    MOVE ',"IL                  $  N#00015416' TO DFHEIV0
 18397     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18398     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18399     MOVE X'204E233030303135343136' TO DFHEIV0(25:11)
 18400     CALL 'kxdfhei1' USING DFHEIV0,
 18401           DFHEIV20,
 18402           ERPNDB-RECORD-LENGTH,
 18403           GETMAIN-SPACE
 18404     SET ADDRESS OF PENDING-BUSINESS TO
 18405         DFHEIV20
 18406     MOVE EIBRESP  TO WS-RESPONSE
 18407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18408
 18409* EXEC CICS READ
 18410*       INTO    (PENDING-BUSINESS)
 18411*       DATASET (FILE-ID-ERPNDB)
 18412*       RIDFLD  (ERPNDB-KEY)
 18413*       RESP    (WS-RESPONSE)
 18414*    END-EXEC
 18415     MOVE LENGTH OF
 18416      PENDING-BUSINESS
 18417       TO DFHEIV11
 18418*    MOVE '&"IL       E          (  N#00015422' TO DFHEIV0
 18419     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18421     MOVE X'204E233030303135343232' TO DFHEIV0(25:11)
 18422     CALL 'kxdfhei1' USING DFHEIV0,
 18423           FILE-ID-ERPNDB,
 18424           PENDING-BUSINESS,
 18425           DFHEIV11,
 18426           ERPNDB-KEY,
 18427           DFHEIV99,
 18428           DFHEIV99,
 18429           DFHEIV99
 18430     MOVE EIBRESP  TO WS-RESPONSE
 18431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18432     IF RESP-NORMAL
 18433        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 18434        MOVE PENDING-BUSINESS    TO WS-PENDING-REC
 18435     ELSE
 18436        MOVE SPACES              TO WS-PENDING-REC
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 349
* EL6311.cbl
 18437     END-IF
 18438     .
 18439 6200-EXIT.
 18440     EXIT.
 18441 6210-READ-ERACCT.
 18442     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 18443     MOVE LOW-VALUES             TO ERACCT-FILL
 18444
 18445* EXEC CICS READ
 18446*         DATASET   ('ERACCT')
 18447*         INTO      (ACCOUNT-MASTER)
 18448*         RIDFLD    (ERACCT-KEY)
 18449*         GTEQ
 18450*         RESP      (WS-RESPONSE)
 18451*    END-EXEC
 18452     MOVE LENGTH OF
 18453      ACCOUNT-MASTER
 18454       TO DFHEIV11
 18455     MOVE 'ERACCT' TO DFHEIV1
 18456*    MOVE '&"IL       G          (  N#00015440' TO DFHEIV0
 18457     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 18458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18459     MOVE X'204E233030303135343430' TO DFHEIV0(25:11)
 18460     CALL 'kxdfhei1' USING DFHEIV0,
 18461           DFHEIV1,
 18462           ACCOUNT-MASTER,
 18463           DFHEIV11,
 18464           ERACCT-KEY,
 18465           DFHEIV99,
 18466           DFHEIV99,
 18467           DFHEIV99
 18468     MOVE EIBRESP  TO WS-RESPONSE
 18469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18470     IF (RESP-NORMAL)
 18471        AND (PB-CONTROL-BY-ACCOUNT (1:20) =
 18472           AM-CONTROL-PRIMARY (1:20))
 18473        MOVE AM-NAME             TO PB-RECORD-STATUS (1:30)
 18474     ELSE
 18475        MOVE 'ACCOUNT NOT FOUND' TO PB-RECORD-STATUS (1:30)
 18476     END-IF
 18477     .
 18478 6210-EXIT.
 18479     EXIT.
 18480 7000-DISPLAY-ISSUES.
 18481
 18482     IF PI-DISPLAY-ORIGINAL-BATCH
 18483        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 18484        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 18485     ELSE
 18486        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 18487
 18488     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 18489
 18490     MOVE 'Y'                        TO WS-DISPLAY-SW.
 18491     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 18492
 18493     MOVE LOW-VALUES                 TO EL631BI.
 18494     MOVE ZEROS                      TO PI-BPMTAMT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 350
* EL6311.cbl
 18495                                        PI-BPMTS.
 18496     MOVE SPACE                      TO PI-BMODE
 18497                                        PI-BTYPE (1)
 18498                                        PI-BTYPE (2).
 18499     MOVE EL631B                     TO PI-MAP-NAME.
 18500     MOVE 'Y'                        TO PI-BROWSE-SW.
 18501     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 18502                                        PI-HIGH-SEQ-NO.
 18503
 18504     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18505        MOVE AL-SABOF                TO BCHGTA
 18506        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 18507        MOVE AL-SANON                TO BCHGA
 18508     ELSE
 18509        MOVE AL-SADOF                TO BCHGTA
 18510                                        BCHGA
 18511        MOVE PB-CHG-COUNT            TO BCHGO.
 18512
 18513     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 18514     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 18515     MOVE WS-HR-MINS                 TO BMANTATO.
 18516
 18517     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18518        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 18519        MOVE SPACE                   TO DC-OPTION-CODE
 18520        PERFORM 9700-DATE-LINK
 18521        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 18522        MOVE 'INACTIVE'              TO BMOENDTO
 18523     ELSE
 18524        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 18525        MOVE SPACE                   TO DC-OPTION-CODE
 18526        PERFORM 9700-DATE-LINK
 18527        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 18528        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 18529        MOVE SPACE                   TO DC-OPTION-CODE
 18530        PERFORM 9700-DATE-LINK
 18531        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 18532
 18533*    MOVE PB-I-REFERENCE             TO BREFO.
 18534
 18535     IF PI-COMPANY-ID EQUAL 'HER'
 18536         MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 18537         IF WS-MEMBER-NO-1-8  IS NUMERIC
 18538             IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 18539                 MOVE WS-MEMBER-NO-1-8
 18540                                 TO  BMICRNOO.
 18541
 18542*    IF PB-I-MICROFILM-NO  IS NUMERIC
 18543*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 18544*            MOVE PB-I-MICROFILM-NO
 18545*                                TO  BMICRNOO.
 18546     IF PB-I-VIN NOT = SPACES
 18547        MOVE PB-I-VIN            TO BVINO
 18548     END-IF
 18549
 18550     MOVE PB-CERT-PRIME              TO BCERTNOO.
 18551     MOVE PB-CERT-SFX                TO BSUFIXO.
 18552     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 351
* EL6311.cbl
 18553     MOVE SPACE                      TO DC-OPTION-CODE.
 18554     PERFORM 9700-DATE-LINK.
 18555     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 18556
 18557     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 18558     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 18559     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 18560     MOVE PB-I-INSURED-SEX           TO BSEXO
 18561
 18562     IF PB-I-AGE NOT = ZEROS
 18563         MOVE PB-I-AGE               TO BAGEO.
 18564
 18565     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 18566         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 18567         MOVE SPACE                  TO DC-OPTION-CODE
 18568         PERFORM 9700-DATE-LINK
 18569         IF NO-CONVERSION-ERROR
 18570            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 18571
 18572     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 18573         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 18574         MOVE SPACE                  TO DC-OPTION-CODE
 18575         PERFORM 9700-DATE-LINK
 18576         IF NO-CONVERSION-ERROR
 18577            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 18578
 18579     IF PB-I-EXTENTION-DAYS NUMERIC
 18580        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 18581           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 18582        ELSE
 18583           IF PB-I-TERM-IN-DAYS NUMERIC
 18584              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 18585                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 18586
 18587     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 18588        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 18589
 18590     MOVE PB-FORCE-CODE              TO BFORCEO.
 18591     MOVE PB-I-TERM-TYPE             TO BMODEO
 18592                                        PI-BMODE.
 18593
 18594     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 18595        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 18596
 18597     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 18598         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 18599                                        PI-BPMTS.
 18600
 18601     IF PB-I-PAYMENT-AMOUNT NUMERIC
 18602         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 18603           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 18604                                        PI-BPMTAMT.
 18605
 18606     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 18607     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 18608     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 18609     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 18610     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 352
* EL6311.cbl
 18611     MOVE PB-I-SIG-SW                TO BSIGO.
 18612     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 18613     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 18614     MOVE PB-RECORD-BILL             TO BBILCDO.
 18615     MOVE PB-FORCE-CODE              TO BFORCEO.
 18616
 18617     IF PB-I-LIVES NUMERIC AND
 18618        PB-I-LIVES GREATER THAN ZEROS
 18619        MOVE PB-I-LIVES              TO BLIVESO.
 18620*    ELSE
 18621*       MOVE ZEROS                   TO BLIVESO.
 18622
 18623     IF PB-I-NUM-BILLED NUMERIC AND
 18624        PB-I-NUM-BILLED GREATER THAN ZEROS
 18625        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 18626*    ELSE
 18627*       MOVE ZEROS                   TO BBILLEDO.
 18628
 18629     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 18630
 18631     IF PB-I-LOAN-APR NOT = ZEROS
 18632        MOVE PB-I-LOAN-APR           TO BAPRO.
 18633
 18634     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 18635        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 18636
 18637     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 18638        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 18639           MOVE AL-SANOF                TO BORIGHDA
 18640           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 18641           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 18642
 18643     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 18644
 18645     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 18646        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 18647
 18648     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 18649        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 18650                                        PI-BTYPE (1).
 18651
 18652     IF PB-I-LF-TERM     GREATER THAN ZEROS
 18653        MOVE PB-I-LF-TERM            TO BTERMO (1).
 18654
 18655     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 18656        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 18657
 18658     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 18659        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 18660
 18661     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 18662        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 18663
 18664     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 18665        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 18666
 18667     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 18668         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 353
* EL6311.cbl
 18669         MOVE SPACE                  TO DC-OPTION-CODE
 18670         PERFORM 9700-DATE-LINK
 18671         IF NO-CONVERSION-ERROR
 18672            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 18673
 18674     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 18675        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 18676        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 18677        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 18678        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 18679                 GIVING BDIFFO (1)
 18680     ELSE
 18681        MOVE SPACES                  TO BBEN-CD     (1)
 18682                                        BBEN-ABBR   (1).
 18683
 18684     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 18685        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 18686        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 18687                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 18688
 18689     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 18690       IF PB-RECORD-ON-HOLD
 18691          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 18692
 18693     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 18694       IF PB-RECORD-RETURNED
 18695          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 18696
 18697     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 18698        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 18699             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 18700
 18701     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 18702
 18703     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 18704        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 18705
 18706     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 18707        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 18708                                        PI-BTYPE (2).
 18709
 18710     IF PB-I-AH-TERM     GREATER THAN ZEROS
 18711        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 18712
 18713     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 18714        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 18715
 18716     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 18717        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 18718
 18719     IF PB-I-TOT-FEES NOT NUMERIC
 18720        MOVE ZEROS               TO PB-I-TOT-FEES
 18721     END-IF
 18722     IF PB-I-TOT-FEES > ZEROS
 18723        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 18724
 18725     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 18726         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 354
* EL6311.cbl
 18727         MOVE SPACE                  TO DC-OPTION-CODE
 18728         PERFORM 9700-DATE-LINK
 18729         IF NO-CONVERSION-ERROR
 18730            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 18731
 18732     IF PB-I-TOT-FEES > ZEROS
 18733        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 18734        SUBTRACT PB-I-TOT-FEES FROM
 18735                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 18736
 18737     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 18738        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 18739        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 18740        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 18741        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 18742                 GIVING BDIFFO (2)
 18743     ELSE
 18744        MOVE SPACES                  TO BBEN-CD     (2)
 18745                                        BBEN-ABBR   (2).
 18746
 18747     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 18748       IF PB-RECORD-ON-HOLD
 18749          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 18750
 18751     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 18752       IF PB-RECORD-RETURNED
 18753          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 18754
 18755     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 18756        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 18757             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 18758
 18759     MOVE PB-CSR-ID                  TO BCSRO.
 18760
 18761     IF PI-COMPANY-ID  =  'DMD'
 18762        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 18763            NEXT SENTENCE
 18764        ELSE
 18765            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 18766               MOVE 'NEW CERT'       TO BNCERTLI
 18767               MOVE EC-NEW-CERT      TO BNCERTO.
 18768
 18769     IF PI-COMPANY-ID  =  'DMD'
 18770        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 18771            NEXT SENTENCE
 18772        ELSE
 18773           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 18774               MOVE 'NEW STATE'      TO BNSTATLI
 18775               MOVE EC-NEW-STATE     TO BNSTATO.
 18776
 18777 7000-CONTINUE.
 18778     MOVE 'C'                        TO BMAINTI.
 18779     MOVE AL-UANON                   TO BMAINTA.
 18780
 18781     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 18782        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 18783
 18784     IF NO-CURSOR-SET
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 355
* EL6311.cbl
 18785        MOVE -1                      TO BMAINTL.
 18786
 18787     GO TO 8100-SEND-INITIAL-MAP.
 18788
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 356
* EL6311.cbl
 18790
 18791******************************************************************
 18792*                                                                *
 18793*             D I S P L A Y   C A N C E L S                      *
 18794*                                                                *
 18795******************************************************************
 18796
 18797 7100-DISPLAY-CANCELS.
 18798     IF PI-DISPLAY-ORIGINAL-BATCH
 18799        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 18800        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 18801     ELSE
 18802        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 18803
 18804     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 18805
 18806     MOVE 'Y'                        TO WS-DISPLAY-SW.
 18807     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 18808
 18809     MOVE LOW-VALUES                 TO EL631CI.
 18810     MOVE EL631C                     TO PI-MAP-NAME.
 18811     MOVE 'Y'                        TO PI-BROWSE-SW.
 18812     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 18813                                        PI-HIGH-SEQ-NO.
 18814
 18815     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18816        MOVE AL-SABOF                TO CCHGTA
 18817        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 18818        MOVE AL-SANON                TO CCHGA
 18819      ELSE
 18820        MOVE AL-SADOF                TO CCHGTA
 18821                                        CCHGA
 18822        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 18823
 18824*    MOVE PB-C-REFERENCE             TO CREFO.
 18825
 18826*    IF PB-C-MICROFILM-NO IS NUMERIC
 18827*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 18828*          MOVE PB-C-MICROFILM-NO
 18829*                                TO CMICRNOO
 18830*          MOVE AL-UNNON         TO CMICRNOA
 18831*       END-IF
 18832*    END-IF
 18833     IF PB-C-NH-INT-ON-REFS NUMERIC
 18834        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 18835           MOVE PB-C-NH-INT-ON-REFS
 18836                                 TO CNHINTO
 18837           MOVE AL-SANOF         TO CNHINTA
 18838        END-IF
 18839     END-IF
 18840     MOVE PB-CERT-PRIME              TO CCERTNOO.
 18841     MOVE PB-CERT-SFX                TO CSUFIXO.
 18842     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18843     MOVE SPACE                      TO DC-OPTION-CODE.
 18844     PERFORM 9700-DATE-LINK.
 18845     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 18846
 18847     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 357
* EL6311.cbl
 18848        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 18849        MOVE SPACE                   TO DC-OPTION-CODE
 18850        PERFORM 9700-DATE-LINK
 18851        IF NO-CONVERSION-ERROR
 18852           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 18853
 18854     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 18855        NEXT SENTENCE
 18856     ELSE
 18857        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 18858
 18859     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 18860        NEXT SENTENCE
 18861     ELSE
 18862        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 18863
 18864     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 18865        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 18866        MOVE SPACE                   TO DC-OPTION-CODE
 18867        PERFORM 9700-DATE-LINK
 18868        IF NO-CONVERSION-ERROR
 18869           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 18870
 18871     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 18872         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 18873
 18874     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 18875         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 18876
 18877     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 18878        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 18879        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 18880                 GIVING CDRFND1O.
 18881
 18882     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 18883        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 18884        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 18885                 GIVING CDRFND2O.
 18886
 18887     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 18888       IF PB-RECORD-ON-HOLD
 18889          MOVE 'ON HOLD'             TO CBILIT1O.
 18890
 18891     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 18892       IF PB-RECORD-RETURNED
 18893          MOVE 'RETURNED'            TO CBILIT1O.
 18894
 18895     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 18896        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 18897             MOVE 'OVERRIDE'         TO CBILIT1O.
 18898
 18899     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 18900       IF PB-RECORD-ON-HOLD
 18901          MOVE 'ON HOLD'             TO CBILIT2O.
 18902
 18903     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 18904       IF PB-RECORD-RETURNED
 18905          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 358
* EL6311.cbl
 18906
 18907     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 18908        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 18909             MOVE 'OVERRIDE'         TO CBILIT2O.
 18910
 18911     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 18912     IF PB-C-POST-CARD-IND = 'Y'
 18913        MOVE 'Y'                     TO CPCYNO
 18914     ELSE
 18915        MOVE 'N'                     TO CPCYNO
 18916     END-IF
 18917     MOVE PB-FORCE-CODE              TO CFORCEO.
 18918     MOVE PB-RECORD-BILL             TO CBILCDO.
 18919     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 18920     MOVE SPACES                     TO CINITSO.
 18921     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 18922         MOVE PB-CI-FIRST-NAME       TO CINITSO
 18923     ELSE
 18924         MOVE PB-CI-INITIALS         TO CINITSO
 18925     END-IF.
 18926
 18927     IF PB-CI-CANCEL-FEE NUMERIC
 18928        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 18929        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 18930     ELSE
 18931        MOVE ZEROES                  TO W-CANCEL-FEE.
 18932
 18933     MOVE W-CANCEL-FEE               TO CCANFEEO.
 18934
 18935     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 18936        ADD PB-CI-LF-PREMIUM-AMT
 18937             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 18938
 18939     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 18940        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 18941
 18942     MOVE PB-CI-LF-TERM              TO CTERM1O.
 18943     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 18944     MOVE PB-CI-AH-TERM              TO CTERM2O.
 18945     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 18946
 18947     IF PB-C-LIVES NUMERIC
 18948        MOVE PB-C-LIVES              TO CLIVESO.
 18949
 18950     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 18951        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 18952
 18953     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 18954        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 18955        MOVE SPACE                   TO DC-OPTION-CODE
 18956        PERFORM 9700-DATE-LINK
 18957        IF NO-CONVERSION-ERROR
 18958           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 18959
 18960     IF  PB-C-REFUND-CREATED
 18961         MOVE 'YES'                  TO CRFNDSWO
 18962     ELSE
 18963         IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 359
* EL6311.cbl
 18964            MOVE 'REQ'               TO CRFNDSWO
 18965         ELSE
 18966            MOVE 'NO'                TO CRFNDSWO.
 18967
 18968     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 18969     MOVE SPACE                      TO DC-OPTION-CODE.
 18970     PERFORM 9700-DATE-LINK.
 18971     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 18972     MOVE PB-INPUT-BY                TO CENTBYO.
 18973
 18974     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18975        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 18976        MOVE SPACE                   TO DC-OPTION-CODE
 18977        PERFORM 9700-DATE-LINK
 18978        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 18979        MOVE 'INACTIVE'              TO CMOENDTO
 18980     ELSE
 18981        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 18982        MOVE SPACE                   TO DC-OPTION-CODE
 18983        PERFORM 9700-DATE-LINK
 18984        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 18985        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 18986        MOVE SPACE                   TO DC-OPTION-CODE
 18987        PERFORM 9700-DATE-LINK
 18988        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 18989
 18990     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 18991
 18992     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 18993     MOVE WS-HR-MINS                 TO CMANTATO.
 18994
 18995     EVALUATE PB-LF-REFUND-TYPE
 18996        WHEN '1'
 18997           MOVE 'RULE78'            TO CLFREFNO
 18998        WHEN '2'
 18999           MOVE 'PRORAT'            TO CLFREFNO
 19000        WHEN '3'
 19001           MOVE 'CALIF'             TO CLFREFNO
 19002        WHEN '4'
 19003           MOVE 'IRREG'             TO CLFREFNO
 19004        WHEN '5'
 19005           MOVE 'NETPAY'            TO CLFREFNO
 19006        WHEN '6'
 19007           MOVE 'ATCP'              TO CLFREFNO
 19008        WHEN '7'
 19009           MOVE 'UTAH'              TO CLFREFNO
 19010        WHEN '8'
 19011           MOVE 'MEAN'              TO CLFREFNO
 19012        WHEN '9'
 19013           MOVE 'SUM '              TO CLFREFNO
 19014        WHEN 'B'
 19015           MOVE 'BALN'              TO CLFREFNO
 19016     END-EVALUATE.
 19017
 19018     EVALUATE TRUE
 19019        WHEN PB-AH-REFUND-TYPE =  '1'
 19020           MOVE 'RULE78'            TO CAHREFNO
 19021        WHEN PB-AH-REFUND-TYPE =  '2'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 360
* EL6311.cbl
 19022           MOVE 'PRORAT'            TO CAHREFNO
 19023        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 19024           MOVE 'CALIF'             TO CAHREFNO
 19025        WHEN PB-AH-REFUND-TYPE =  '4'
 19026           MOVE 'IRREG'             TO CAHREFNO
 19027        WHEN PB-AH-REFUND-TYPE =  '5'
 19028           MOVE 'NETPAY'            TO CAHREFNO
 19029        WHEN PB-AH-REFUND-TYPE =  '6'
 19030           MOVE 'ATCP'              TO CAHREFNO
 19031        WHEN PB-AH-REFUND-TYPE =  '7'
 19032           MOVE 'UTAH'              TO CAHREFNO
 19033        WHEN PB-AH-REFUND-TYPE =  '8'
 19034           MOVE 'MEAN'              TO CAHREFNO
 19035        WHEN PB-AH-REFUND-TYPE =  '9'
 19036           MOVE 'SUM '              TO CAHREFNO
 19037        WHEN PB-AH-REFUND-TYPE =  'B'
 19038           MOVE 'BALN'              TO CAHREFNO
 19039     END-EVALUATE.
 19040
 19041     MOVE PB-REIN-CD                 TO CREINCDO.
 19042
 19043     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 19044        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 19045        MOVE SPACE                   TO DC-OPTION-CODE
 19046        PERFORM 9700-DATE-LINK
 19047        IF NO-CONVERSION-ERROR
 19048           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 19049
 19050     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 19051        MOVE 999999                  TO WS-EXP-DT-EDIT
 19052        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 19053        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 19054     ELSE
 19055        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 19056           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 19057           MOVE SPACE                   TO DC-OPTION-CODE
 19058           PERFORM 9700-DATE-LINK
 19059           IF NO-CONVERSION-ERROR
 19060              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 19061
 19062     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 19063        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 19064           MOVE AL-SANOF                TO CORIGHDA
 19065           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 19066           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 19067
 19068     MOVE PB-CSR-ID              TO CCSRO.
 19069
 19070     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 19071     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 19072
 19073     MOVE 'C'                    TO CMAINTI.
 19074     MOVE AL-UANON               TO CMAINTA.
 19075
 19076     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 19077        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 19078
 19079     IF NO-CURSOR-SET
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 361
* EL6311.cbl
 19080        MOVE -1                  TO CMAINTL.
 19081
 19082     GO TO 8100-SEND-INITIAL-MAP.
 19083
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 362
* EL6311.cbl
 19085***************************************************************
 19086*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 19087*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 19088***************************************************************
 19089
 19090 7200-DISPLAY-BATCHES.
 19091     MOVE EL631D                 TO PI-MAP-NAME.
 19092     MOVE LOW-VALUES             TO EL631DI.
 19093
 19094     MOVE 'Y'                    TO WS-DISPLAY-SW.
 19095
 19096
 19097* EXEC CICS HANDLE CONDITION
 19098*         NOTFND   (3690-NOT-FOUND)
 19099*    END-EXEC.
 19100*    MOVE '"$I                   ! V #00016073' TO DFHEIV0
 19101     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19102     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19103     MOVE X'5620233030303136303733' TO DFHEIV0(25:11)
 19104     CALL 'kxdfhei1' USING DFHEIV0
 19105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19106
 19107
 19108     IF PI-DISPLAY-SCREEN
 19109        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19110     ELSE
 19111        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 19112
 19113     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 19114     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 19115
 19116
 19117* EXEC CICS READ
 19118*         DATASET   (FILE-ID-ERPNDB)
 19119*         RIDFLD    (ERPNDB-KEY)
 19120*         SET       (ADDRESS OF PENDING-BUSINESS)
 19121*    END-EXEC.
 19122*    MOVE '&"S        E          (   #00016085' TO DFHEIV0
 19123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19125     MOVE X'2020233030303136303835' TO DFHEIV0(25:11)
 19126     CALL 'kxdfhei1' USING DFHEIV0,
 19127           FILE-ID-ERPNDB,
 19128           DFHEIV20,
 19129           DFHEIV99,
 19130           ERPNDB-KEY,
 19131           DFHEIV99,
 19132           DFHEIV99,
 19133           DFHEIV99
 19134     SET ADDRESS OF PENDING-BUSINESS TO
 19135         DFHEIV20
 19136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19137
 19138
 19139     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 19140     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19141     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 19142     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 363
* EL6311.cbl
 19143     MOVE PB-SV-STATE            TO PI-SV-STATE.
 19144
 19145     MOVE EL631D                 TO PI-MAP-NAME.
 19146     MOVE LOW-VALUES             TO EL631DI.
 19147     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 19148
 19149*    IF PI-AR-PROCESSING
 19150*       MOVE PB-REFERENCE        TO DREFO.
 19151
 19152     MOVE PB-CSR-ID              TO DCSRO.
 19153
 19154     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 19155        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 19156        MOVE SPACE               TO DC-OPTION-CODE
 19157        PERFORM 9700-DATE-LINK
 19158        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 19159        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 19160        MOVE 'INACTIVE'          TO DLDATEO
 19161     ELSE
 19162        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 19163        MOVE SPACE               TO DC-OPTION-CODE
 19164        PERFORM 9700-DATE-LINK
 19165        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 19166
 19167     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 19168     MOVE SPACE                  TO DC-OPTION-CODE.
 19169     PERFORM 9700-DATE-LINK.
 19170     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 19171
 19172     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 19173        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 19174     ELSE
 19175        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 19176        MOVE SPACE               TO DC-OPTION-CODE
 19177        PERFORM 9700-DATE-LINK
 19178        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 19179
 19180     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 19181     MOVE SPACE                  TO DC-OPTION-CODE.
 19182     PERFORM 9700-DATE-LINK.
 19183     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 19184
 19185     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 19186     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 19187
 19188     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 19189        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 19190                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 19191
 19192     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 19193     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 19194     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 19195
 19196     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 19197        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 19198                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 19199
 19200     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 364
* EL6311.cbl
 19201     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 19202     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 19203
 19204     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 19205        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 19206                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 19207
 19208     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 19209     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 19210
 19211     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 19212        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 19213                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 19214
 19215     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 19216     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 19217     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 19218
 19219     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 19220        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 19221                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 19222
 19223     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 19224     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 19225     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 19226
 19227     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 19228        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 19229                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 19230
 19231     MOVE -1                     TO DPFENTRL.
 19232     GO TO 8100-SEND-INITIAL-MAP.
 19233
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 365
* EL6311.cbl
 19235
 19236***************************************************************
 19237*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 19238*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 19239*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 19240*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 19241*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 19242*     ARE THEN SET ACCORDINGLY.                               *
 19243*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 19244*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 19245*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 19246***************************************************************
 19247
 19248******************************************************************
 19249*                                                                *
 19250*            E R R O R   A N A L Y S I S                         *
 19251*                                                                *
 19252******************************************************************
 19253
 19254******************************************************************
 19255*                                                                *
 19256*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 19257*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 19258*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 19259*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 19260*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 19261*                                                                *
 19262*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 19263*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 19264*                                                                *
 19265******************************************************************
 19266
 19267 7300-FORMAT-ERRORS.
 19268
 19269     IF PB-COMMON-ERRORS = LOW-VALUES
 19270        IF PB-FATAL-ERRORS
 19271           MOVE ER-2695          TO EMI-ERROR
 19272           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19273           GO TO 7399-EXIT.
 19274
 19275     MOVE +0                     TO WS-SUB4.
 19276
 19277 7310-ERROR-LOOP.
 19278
 19279     ADD +1                      TO WS-SUB4.
 19280
 19281     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 19282        GO TO 7350-SET-ERROR-FLAGS.
 19283
 19284     IF PI-COMPANY-ID = 'UCL'
 19285         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 19286             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 19287             MOVE ' '                   TO DC-OPTION-CODE
 19288             PERFORM 9700-DATE-LINK
 19289             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 19290
 19291     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 19292     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 366
* EL6311.cbl
 19293     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 19294
 19295     GO TO 7310-ERROR-LOOP.
 19296
 19297
 19298 7350-SET-ERROR-FLAGS.
 19299
 19300     IF EMI-FATAL-CTR NOT = ZEROS
 19301        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 19302        MOVE 'X'                 TO PB-FATAL-FLAG
 19303        GO TO 7355-SET-ERROR-FLAGS.
 19304
 19305     IF EMI-FORCABLE-CTR NOT = ZEROS
 19306        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 19307        IF PB-ISSUE
 19308           IF PB-ISSUE-FORCE
 19309              MOVE 'F'           TO PB-FORCE-ER-CD
 19310              MOVE ER-2600       TO EMI-ERROR
 19311              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19312             ELSE
 19313              MOVE 'X'           TO PB-FORCE-ER-CD
 19314          ELSE
 19315           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 19316              MOVE 'F'           TO PB-FORCE-ER-CD
 19317              MOVE ER-2600       TO EMI-ERROR
 19318              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19319             ELSE
 19320              MOVE 'X'           TO PB-FORCE-ER-CD.
 19321
 19322     IF FIRST-ENTRY OR
 19323        EIBAID = DFHPF1 OR DFHPF2
 19324        MOVE '0'                TO PI-EDIT-SW
 19325        GO TO 7399-EXIT.
 19326
 19327 7355-SET-ERROR-FLAGS.
 19328
 19329     IF EMI-WARNING-CTR NOT = ZEROS
 19330        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 19331        MOVE 'W'                 TO PB-WARN-ER-CD.
 19332
 19333     IF PB-UNFORCED-ERRORS OR
 19334        PB-FATAL-ERRORS    OR
 19335        PB-RECORD-ON-HOLD  OR
 19336        PB-RECORD-RETURNED OR
 19337        PB-CANCELLATION
 19338          NEXT SENTENCE
 19339        ELSE
 19340          GO TO 7399-EXIT.
 19341
 19342
 19343* EXEC CICS  HANDLE CONDITION
 19344*           NOTFND   (7399-EXIT)
 19345*    END-EXEC.
 19346*    MOVE '"$I                   ! W #00016294' TO DFHEIV0
 19347     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19349     MOVE X'5720233030303136323934' TO DFHEIV0(25:11)
 19350     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 367
* EL6311.cbl
 19351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19352
 19353
 19354     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 19355     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 19356     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 19357     MOVE PB-SV-STATE            TO ELCERT-STATE.
 19358
 19359
 19360* EXEC CICS READ
 19361*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 19362*        DATASET (FILE-ID-ELCERT)
 19363*        RIDFLD  (ELCERT-KEY)
 19364*        UPDATE
 19365*    END-EXEC.
 19366*    MOVE '&"S        EU         (   #00016303' TO DFHEIV0
 19367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19368     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19369     MOVE X'2020233030303136333033' TO DFHEIV0(25:11)
 19370     CALL 'kxdfhei1' USING DFHEIV0,
 19371           FILE-ID-ELCERT,
 19372           DFHEIV20,
 19373           DFHEIV99,
 19374           ELCERT-KEY,
 19375           DFHEIV99,
 19376           DFHEIV99,
 19377           DFHEIV99
 19378     SET ADDRESS OF CERTIFICATE-MASTER TO
 19379         DFHEIV20
 19380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19381
 19382
 19383
 19384     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 19385     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 19386
 19387     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 19388        GO TO 7360-REWRITE-CERT-MASTER.
 19389
 19390     IF PB-ISSUE
 19391        IF PB-RECORD-RETURNED
 19392            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 19393            GO TO 7360-REWRITE-CERT-MASTER
 19394        ELSE
 19395            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 19396            GO TO 7360-REWRITE-CERT-MASTER.
 19397
 19398     IF PB-RECORD-RETURNED
 19399         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 19400         GO TO 7360-REWRITE-CERT-MASTER.
 19401
 19402     IF PB-C-LF-CANCEL-VOIDED
 19403        IF (PB-UNFORCED-ERRORS OR
 19404            PB-FATAL-ERRORS    OR
 19405            PB-RECORD-ON-HOLD)
 19406            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 19407            GO TO 7360-REWRITE-CERT-MASTER
 19408        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 368
* EL6311.cbl
 19409            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 19410            GO TO 7360-REWRITE-CERT-MASTER.
 19411
 19412     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 19413                            OR PB-RECORD-ON-HOLD)
 19414        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 19415     ELSE
 19416        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 19417
 19418 7360-REWRITE-CERT-MASTER.
 19419
 19420     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 19421        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 19422
 19423* EXEC CICS UNLOCK
 19424*            DATASET    (FILE-ID-ELCERT)
 19425*       END-EXEC
 19426*    MOVE '&*                    #   #00016349' TO DFHEIV0
 19427     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19428     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19429     MOVE X'2020233030303136333439' TO DFHEIV0(25:11)
 19430     CALL 'kxdfhei1' USING DFHEIV0,
 19431           FILE-ID-ELCERT,
 19432           DFHEIV99
 19433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19434        GO TO 7399-EXIT.
 19435
 19436
 19437* EXEC CICS REWRITE
 19438*         DATASET    (FILE-ID-ELCERT)
 19439*         FROM       (CERTIFICATE-MASTER)
 19440*    END-EXEC.
 19441     MOVE LENGTH OF
 19442      CERTIFICATE-MASTER
 19443       TO DFHEIV11
 19444*    MOVE '&& L                  %   #00016354' TO DFHEIV0
 19445     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19446     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19447     MOVE X'2020233030303136333534' TO DFHEIV0(25:11)
 19448     CALL 'kxdfhei1' USING DFHEIV0,
 19449           FILE-ID-ELCERT,
 19450           CERTIFICATE-MASTER,
 19451           DFHEIV11,
 19452           DFHEIV99
 19453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19454
 19455
 19456 7399-EXIT.
 19457      EXIT.
 19458
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 369
* EL6311.cbl
 19460
 19461*************************************************************
 19462*                                                           *
 19463*              S E T   A T T R I B U T E S                  *
 19464*                                                           *
 19465*************************************************************
 19466
 19467 7400-SET-ATTRIBUTES.
 19468
 19469     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 19470        GO TO 7499-EXIT.
 19471
 19472**2601**
 19473
 19474     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 19475        IF PB-ISSUE
 19476           MOVE AL-UABON         TO BEFFDTA
 19477           GO TO 7499-EXIT
 19478         ELSE
 19479           MOVE AL-UABON         TO CEFFDTA
 19480           GO TO 7499-EXIT.
 19481
 19482**2604**
 19483
 19484     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 19485        IF PB-ISSUE
 19486           MOVE AL-UABON         TO BTYPE1A
 19487           MOVE -1               TO BTYPE1L
 19488           MOVE  1               TO SET-CURSOR-SW
 19489           GO TO 7499-EXIT.
 19490
 19491**2605**
 19492
 19493     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 19494        IF PB-ISSUE
 19495           MOVE AL-UABON         TO BTYPE2A
 19496           MOVE -1               TO BTYPE2L
 19497           MOVE  1               TO SET-CURSOR-SW
 19498           GO TO 7499-EXIT.
 19499
 19500**2606**
 19501
 19502     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 19503        IF PB-ISSUE
 19504           MOVE AL-UABON         TO BSIGA
 19505           MOVE -1               TO BSIGL
 19506           MOVE  1               TO SET-CURSOR-SW
 19507           GO TO 7499-EXIT.
 19508
 19509**2607**
 19510
 19511     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 19512        IF PB-ISSUE
 19513           MOVE AL-UABON         TO BSIGA
 19514           MOVE -1               TO BSIGL
 19515           MOVE  1               TO SET-CURSOR-SW
 19516           GO TO 7499-EXIT.
 19517
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 370
* EL6311.cbl
 19518**2615**
 19519
 19520     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 19521        IF PB-ISSUE
 19522           MOVE AL-UABOF         TO BREINA
 19523           MOVE -1               TO BREINL
 19524           GO TO 7499-EXIT.
 19525
 19526**2622**
 19527
 19528     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 19529        IF PB-ISSUE
 19530           MOVE AL-UABON         TO BEFFDTA
 19531           GO TO 7499-EXIT
 19532        ELSE
 19533           MOVE AL-UABON         TO CEFFDTA
 19534           GO TO 7499-EXIT.
 19535
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 371
* EL6311.cbl
 19537
 19538*************************************************************
 19539*                                                           *
 19540*              I S S U E   E R R O R S                      *
 19541*                                                           *
 19542*************************************************************
 19543
 19544 7420-ISSUE-ERRORS.
 19545
 19546**2626**
 19547
 19548     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 19549        MOVE AL-UABON            TO BCERTNOA
 19550        GO TO 7499-EXIT.
 19551
 19552**2627**
 19553
 19554     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 19555        MOVE AL-UNBON            TO BAGEA
 19556        MOVE -1                  TO BAGEL
 19557        MOVE  1                  TO SET-CURSOR-SW
 19558        GO TO 7499-EXIT.
 19559
 19560**2628**
 19561
 19562     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 19563        MOVE AL-UNBON            TO BAGEA
 19564        MOVE -1                  TO BAGEL
 19565        MOVE  1                  TO SET-CURSOR-SW
 19566        GO TO 7499-EXIT.
 19567
 19568**2629**
 19569
 19570     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 19571        MOVE AL-UABON            TO BSEXA
 19572        MOVE -1                  TO BSEXL
 19573        MOVE  1                  TO SET-CURSOR-SW
 19574        GO TO 7499-EXIT.
 19575
 19576**2630**
 19577
 19578     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 19579        MOVE -1                  TO BTYPE1L
 19580        MOVE  1                  TO SET-CURSOR-SW
 19581        GO TO 7499-EXIT.
 19582
 19583**2631**
 19584
 19585     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 19586        MOVE -1                  TO BTYPE1L
 19587        MOVE  1                  TO SET-CURSOR-SW
 19588        GO TO 7499-EXIT.
 19589
 19590**2632**
 19591
 19592     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 19593        MOVE AL-UNBON            TO BBEN1A
 19594        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 372
* EL6311.cbl
 19595        MOVE  1                  TO SET-CURSOR-SW
 19596        GO TO 7499-EXIT.
 19597
 19598**2633**
 19599
 19600     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 19601        MOVE AL-UNBON            TO BPREM1A
 19602        MOVE -1                  TO BPREM1L
 19603        MOVE  1                  TO SET-CURSOR-SW
 19604        GO TO 7499-EXIT.
 19605
 19606**2634**
 19607
 19608     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 19609        MOVE -1                  TO BTYPE2L
 19610        MOVE  1                  TO SET-CURSOR-SW
 19611        GO TO 7499-EXIT.
 19612
 19613**2635**
 19614
 19615     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 19616        MOVE AL-UNBON            TO BBEN2A
 19617        MOVE -1                  TO BBEN2L
 19618        MOVE  1                  TO SET-CURSOR-SW
 19619        GO TO 7499-EXIT.
 19620
 19621**2636**
 19622
 19623     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 19624        MOVE AL-UNBON            TO BPREM2A
 19625        MOVE -1                  TO BPREM2L
 19626        MOVE  1                  TO SET-CURSOR-SW
 19627        GO TO 7499-EXIT.
 19628
 19629**2639**
 19630
 19631     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 19632        MOVE AL-UNBON            TO BBEN1A
 19633        MOVE -1                  TO BBEN1L
 19634        MOVE  1                  TO SET-CURSOR-SW
 19635        GO TO 7499-EXIT.
 19636
 19637**2640**
 19638
 19639     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 19640        MOVE AL-UNBON            TO BBEN2A
 19641        MOVE -1                  TO BBEN2L
 19642        MOVE  1                  TO SET-CURSOR-SW
 19643        GO TO 7499-EXIT.
 19644
 19645**2647**
 19646
 19647     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 19648        MOVE AL-UNBON            TO BTERM1A
 19649        MOVE -1                  TO BTERM1L
 19650        MOVE  1                  TO SET-CURSOR-SW
 19651        GO TO 7499-EXIT.
 19652
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 373
* EL6311.cbl
 19653**2648**
 19654
 19655     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 19656        MOVE AL-UNBON            TO BLNTRMA
 19657        MOVE -1                  TO BLNTRML
 19658        MOVE  1                  TO SET-CURSOR-SW
 19659        GO TO 7499-EXIT.
 19660
 19661**2649**
 19662
 19663     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 19664        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 19665            MOVE AL-UNBON            TO BPREM1A
 19666            MOVE -1                  TO BPREM1L
 19667            MOVE  1                  TO SET-CURSOR-SW
 19668            GO TO 7499-EXIT
 19669     ELSE
 19670        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 19671           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 19672            MOVE AL-UNBON            TO BPREM2A
 19673            MOVE -1                  TO BPREM2L
 19674            MOVE  1                  TO SET-CURSOR-SW
 19675            GO TO 7499-EXIT.
 19676
 19677**2650**
 19678
 19679     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 19680        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 19681            MOVE AL-UNBON        TO BPREM1A
 19682            MOVE -1              TO BPREM1L
 19683            MOVE  1              TO SET-CURSOR-SW
 19684            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 19685                MOVE AL-UNBON        TO BPREM2A
 19686                MOVE -1              TO BPREM2L
 19687                MOVE  1              TO SET-CURSOR-SW
 19688                GO TO 7499-EXIT
 19689            ELSE
 19690                GO TO 7499-EXIT
 19691        ELSE
 19692            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 19693                MOVE AL-UNBON        TO BPREM2A
 19694                MOVE -1              TO BPREM2L
 19695                MOVE  1              TO SET-CURSOR-SW
 19696                GO TO 7499-EXIT
 19697            ELSE
 19698                GO TO 7499-EXIT.
 19699
 19700**2651**
 19701
 19702     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 19703        MOVE AL-UABON            TO BSIGA
 19704        MOVE -1                  TO BSIGL
 19705        MOVE  1                  TO SET-CURSOR-SW
 19706        GO TO 7499-EXIT.
 19707
 19708**2653**
 19709
 19710     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 374
* EL6311.cbl
 19711        MOVE AL-UABON            TO BFREQA
 19712        MOVE -1                  TO BFREQL
 19713        MOVE  1                  TO SET-CURSOR-SW
 19714        GO TO 7499-EXIT.
 19715
 19716**2654**
 19717
 19718     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 19719        MOVE AL-UABON            TO BFREQA
 19720        MOVE -1                  TO BFREQL
 19721        MOVE  1                  TO SET-CURSOR-SW
 19722        GO TO 7499-EXIT.
 19723
 19724**2655**
 19725
 19726     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 19727        MOVE AL-UABON            TO BFREQA
 19728        MOVE -1                  TO BFREQL
 19729        MOVE  1                  TO SET-CURSOR-SW
 19730        GO TO 7499-EXIT.
 19731
 19732**2656**
 19733
 19734     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 19735        MOVE AL-UNBON            TO BAPRA
 19736        MOVE -1                  TO BAPRL
 19737        MOVE  1                  TO SET-CURSOR-SW
 19738        GO TO 7499-EXIT.
 19739
 19740**2657**
 19741
 19742     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 19743        MOVE AL-UNBON            TO BAPRA
 19744        MOVE -1                  TO BAPRL
 19745        MOVE  1                  TO SET-CURSOR-SW
 19746        GO TO 7499-EXIT.
 19747
 19748**2658**
 19749
 19750     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 19751        MOVE AL-UNBON            TO BTERM2A
 19752        MOVE -1                  TO BTERM2L
 19753        MOVE  1                  TO SET-CURSOR-SW
 19754        GO TO 7499-EXIT.
 19755
 19756**2660**
 19757
 19758     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 19759        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 19760        MOVE -1                  TO BLSTNML
 19761        MOVE  1                  TO SET-CURSOR-SW
 19762        GO TO 7499-EXIT.
 19763
 19764
 19765**2662**
 19766
 19767     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 19768        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 375
* EL6311.cbl
 19769        MOVE -1                  TO BAGEL
 19770        MOVE  1                  TO SET-CURSOR-SW
 19771        GO TO 7499-EXIT.
 19772
 19773**2663**
 19774
 19775     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 19776        MOVE AL-UNBON            TO BAGEA
 19777        MOVE -1                  TO BAGEL
 19778        MOVE  1                  TO SET-CURSOR-SW
 19779        GO TO 7499-EXIT.
 19780
 19781**2664**
 19782
 19783     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 19784        MOVE AL-UABON            TO BREINA
 19785        MOVE -1                  TO BREINL
 19786        MOVE  1                  TO SET-CURSOR-SW
 19787        GO TO 7499-EXIT.
 19788
 19789**2667**
 19790
 19791     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 19792        MOVE AL-UNBON            TO BBEN2A
 19793        MOVE -1                  TO BBEN2L
 19794        MOVE  1                  TO SET-CURSOR-SW
 19795        GO TO 7499-EXIT.
 19796
 19797**2668**
 19798
 19799     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 19800        MOVE AL-UABON            TO BEFFDTA
 19801        GO TO 7499-EXIT.
 19802
 19803**2669**
 19804
 19805     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 19806        MOVE AL-UNBON            TO BAGEA
 19807        MOVE -1                  TO BAGEL
 19808        MOVE  1                  TO SET-CURSOR-SW
 19809        GO TO 7499-EXIT.
 19810
 19811**2670**
 19812
 19813     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 19814        MOVE AL-UABON            TO BFORCEA
 19815        MOVE -1                  TO BFORCEL
 19816        MOVE  1                  TO SET-CURSOR-SW
 19817        GO TO 7499-EXIT.
 19818
 19819**2671**
 19820
 19821     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 19822        MOVE AL-UABON            TO BEFFDTA
 19823        GO TO 7499-EXIT.
 19824
 19825**2672**
 19826
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 376
* EL6311.cbl
 19827     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 19828        MOVE AL-UABON            TO BEFFDTA
 19829        GO TO 7499-EXIT.
 19830
 19831**2673**
 19832
 19833     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 19834        MOVE AL-UABON            TO BEFFDTA
 19835        GO TO 7499-EXIT.
 19836
 19837**2674**
 19838
 19839     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 19840        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 19841        MOVE -1                  TO BTYPE1L
 19842        MOVE  1                  TO SET-CURSOR-SW
 19843        GO TO 7499-EXIT.
 19844
 19845**2677**
 19846
 19847     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 19848        MOVE AL-UNBON            TO BTERM1A
 19849        MOVE -1                  TO BTERM1L
 19850        MOVE  1                  TO SET-CURSOR-SW
 19851        GO TO 7499-EXIT.
 19852
 19853**2678**
 19854
 19855     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 19856        MOVE AL-UNBON            TO BTERM2A
 19857        MOVE -1                  TO BTERM2L
 19858        MOVE  1                  TO SET-CURSOR-SW
 19859        GO TO 7499-EXIT.
 19860
 19861**2679**
 19862
 19863     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 19864        MOVE AL-UABON            TO BTYPE1A
 19865        MOVE -1                  TO BTYPE1L
 19866        MOVE  1                  TO SET-CURSOR-SW
 19867        GO TO 7499-EXIT.
 19868
 19869**2680**
 19870
 19871     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 19872        MOVE AL-UABOF            TO B1STPMTA
 19873        MOVE -1                  TO B1STPMTL
 19874        MOVE  1                  TO SET-CURSOR-SW
 19875        GO TO 7499-EXIT.
 19876
 19877**2681**
 19878
 19879     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 19880        MOVE AL-UABON            TO BDAYSA
 19881        MOVE -1                  TO BDAYSL
 19882        MOVE  1                  TO SET-CURSOR-SW
 19883        GO TO 7499-EXIT.
 19884
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 377
* EL6311.cbl
 19885**2682**
 19886
 19887     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 19888        MOVE AL-UABON            TO BTERM1A
 19889        MOVE -1                  TO BTERM1L
 19890        MOVE  1                  TO SET-CURSOR-SW
 19891        GO TO 7499-EXIT.
 19892
 19893**2683**
 19894
 19895     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 19896        MOVE AL-UABON            TO BSKPCDA
 19897        MOVE -1                  TO BSKPCDL
 19898        MOVE  1                  TO SET-CURSOR-SW
 19899        GO TO 7499-EXIT.
 19900
 19901**2684**
 19902
 19903     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 19904        MOVE AL-UABON            TO BTYPE2A
 19905        MOVE -1                  TO BTYPE2L
 19906        MOVE  1                  TO SET-CURSOR-SW
 19907        GO TO 7499-EXIT.
 19908
 19909**2686**
 19910
 19911     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 19912        MOVE AL-UABON            TO BTYPE2A
 19913        MOVE -1                  TO BTYPE2L
 19914        MOVE  1                  TO SET-CURSOR-SW
 19915        GO TO 7499-EXIT.
 19916
 19917**2689**
 19918
 19919     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 19920        MOVE AL-UABON            TO BSIGA
 19921        MOVE -1                  TO BSIGL
 19922        MOVE  1                  TO SET-CURSOR-SW
 19923        GO TO 7499-EXIT.
 19924
 19925**2690**
 19926
 19927     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 19928        MOVE AL-UABOF            TO BLNOFCRA
 19929        MOVE -1                  TO BLNOFCRL
 19930        MOVE  1                  TO SET-CURSOR-SW
 19931        GO TO 7499-EXIT.
 19932
 19933**2693**
 19934
 19935     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 19936        MOVE AL-UABOF            TO BLNOFCRA
 19937        MOVE AL-UNBON            TO BBEN1A
 19938        MOVE -1                  TO BBEN1L
 19939        MOVE  1                  TO SET-CURSOR-SW
 19940        GO TO 7499-EXIT.
 19941
 19942**2720**
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 378
* EL6311.cbl
 19943
 19944     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 19945        MOVE AL-UNBON            TO BBEN1A
 19946        MOVE -1                  TO BBEN1L
 19947        MOVE  1                  TO SET-CURSOR-SW
 19948        GO TO 7499-EXIT.
 19949
 19950**2709**
 19951
 19952*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 19953*       MOVE AL-UNBON            TO BBEN1A
 19954*       MOVE -1                  TO BBEN1L
 19955*       MOVE  1                  TO SET-CURSOR-SW
 19956*       GO TO 7499-EXIT.
 19957
 19958*************************************************************
 19959*                                                           *
 19960*            C A N C E L   E R R O R S                      *
 19961*                                                           *
 19962*************************************************************
 19963
 19964**2726**
 19965
 19966     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 19967        MOVE AL-UABON            TO CCERTNOA
 19968        GO TO 7499-EXIT.
 19969
 19970**2728**
 19971
 19972     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 19973        MOVE AL-UABON            TO CCERTNOA
 19974        GO TO 7499-EXIT.
 19975
 19976**2729**
 19977
 19978     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 19979        MOVE AL-UABON            TO CCERTNOA
 19980        GO TO 7499-EXIT.
 19981
 19982**2730**
 19983
 19984     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 19985        MOVE AL-UABON            TO CCERTNOA
 19986        GO TO 7499-EXIT.
 19987
 19988**2731**
 19989
 19990     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 19991        MOVE AL-UABON            TO CCANDT1A
 19992        MOVE -1                  TO CCANDT1L
 19993        MOVE  1                  TO SET-CURSOR-SW
 19994        GO TO 7499-EXIT.
 19995
 19996**2732**
 19997
 19998     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 19999        MOVE AL-UABON            TO CCANDT1A
 20000        MOVE -1                  TO CCANDT1L
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 379
* EL6311.cbl
 20001        MOVE  1                  TO SET-CURSOR-SW
 20002        GO TO 7499-EXIT.
 20003
 20004**2733**
 20005
 20006     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 20007        MOVE AL-UABON            TO CCANDT1A
 20008        MOVE -1                  TO CCANDT1L
 20009        MOVE  1                  TO SET-CURSOR-SW
 20010        GO TO 7499-EXIT.
 20011
 20012**2734**
 20013
 20014     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 20015        MOVE AL-UNBON            TO CREFND1A
 20016        MOVE -1                  TO CREFND1L
 20017        MOVE  1                  TO SET-CURSOR-SW
 20018        GO TO 7499-EXIT.
 20019
 20020**2735**
 20021
 20022     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 20023        MOVE AL-UABON            TO CCANDT2A
 20024        MOVE -1                  TO CCANDT2L
 20025        MOVE  1                  TO SET-CURSOR-SW
 20026        GO TO 7499-EXIT.
 20027
 20028**2736**
 20029
 20030     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 20031        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 20032            MOVE AL-UNBON        TO CREFND1A
 20033            MOVE -1              TO CREFND1L
 20034            MOVE  1              TO SET-CURSOR-SW
 20035            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 20036                MOVE AL-UNBON        TO CREFND2A
 20037                MOVE -1              TO CREFND2L
 20038                MOVE  1              TO SET-CURSOR-SW
 20039                GO TO 7499-EXIT
 20040            ELSE
 20041                GO TO 7499-EXIT
 20042        ELSE
 20043            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 20044                MOVE AL-UNBON        TO CREFND2A
 20045                MOVE -1              TO CREFND2L
 20046                MOVE  1              TO SET-CURSOR-SW
 20047                GO TO 7499-EXIT
 20048            ELSE
 20049                GO TO 7499-EXIT.
 20050
 20051**2738**
 20052
 20053     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 20054        MOVE -1                  TO CREFND2L
 20055        MOVE  1                  TO SET-CURSOR-SW
 20056        GO TO 7499-EXIT.
 20057
 20058**2739**
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 380
* EL6311.cbl
 20059
 20060     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 20061        MOVE -1                  TO CREFND1L
 20062        MOVE  1                  TO SET-CURSOR-SW
 20063        GO TO 7499-EXIT.
 20064
 20065**2741**
 20066
 20067     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 20068        MOVE -1                  TO CREFND1L
 20069        MOVE  1                  TO SET-CURSOR-SW
 20070        GO TO 7499-EXIT.
 20071
 20072**2743**
 20073
 20074     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 20075        MOVE AL-UNBON            TO CCANDT1A
 20076        MOVE -1                  TO CCANDT1L
 20077        MOVE  1                  TO SET-CURSOR-SW
 20078        GO TO 7499-EXIT.
 20079
 20080**2744**
 20081
 20082     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 20083        MOVE AL-UNBON            TO CCANDT2A
 20084        MOVE -1                  TO CCANDT2L
 20085        MOVE  1                  TO SET-CURSOR-SW
 20086        GO TO 7499-EXIT.
 20087
 20088**2747**
 20089
 20090     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 20091        MOVE AL-UABON            TO CLSTNMA
 20092        MOVE -1                  TO CLSTNML
 20093        MOVE  1                  TO SET-CURSOR-SW
 20094        GO TO 7499-EXIT.
 20095
 20096**2749**
 20097
 20098     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 20099        MOVE AL-UABON            TO CFORCEA
 20100        MOVE -1                  TO CFORCEL
 20101        MOVE  1                  TO SET-CURSOR-SW
 20102        GO TO 7499-EXIT.
 20103
 20104**2753**
 20105
 20106     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 20107        MOVE AL-UNBON            TO CCANDT1A
 20108        MOVE -1                  TO CCANDT1L
 20109        MOVE  1                  TO SET-CURSOR-SW
 20110        GO TO 7499-EXIT.
 20111
 20112**2755**
 20113
 20114     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 20115        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 20116            MOVE AL-UNBON        TO CREFND1A
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 381
* EL6311.cbl
 20117            MOVE -1              TO CREFND1L
 20118            MOVE  1              TO SET-CURSOR-SW
 20119            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 20120                MOVE AL-UNBON        TO CREFND2A
 20121                MOVE -1              TO CREFND2L
 20122                MOVE  1              TO SET-CURSOR-SW
 20123                GO TO 7499-EXIT
 20124            ELSE
 20125                GO TO 7499-EXIT
 20126        ELSE
 20127            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 20128                MOVE AL-UNBON        TO CREFND2A
 20129                MOVE -1              TO CREFND2L
 20130                MOVE  1              TO SET-CURSOR-SW
 20131            ELSE
 20132                GO TO 7499-EXIT.
 20133
 20134**2757**
 20135
 20136     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 20137        MOVE AL-UNBON            TO CLIVESA
 20138        MOVE -1                  TO CLIVESL
 20139        MOVE  1                  TO SET-CURSOR-SW
 20140        GO TO 7499-EXIT.
 20141
 20142**2771**
 20143
 20144     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 20145        MOVE AL-UABON            TO CCANDT2A
 20146        MOVE -1                  TO CCANDT2L
 20147        MOVE  1                  TO SET-CURSOR-SW
 20148        GO TO 7499-EXIT.
 20149
 20150**2774**
 20151
 20152     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 20153        MOVE AL-UABON            TO CCANDT1A
 20154        MOVE -1                  TO CCANDT1L
 20155        MOVE  1                  TO SET-CURSOR-SW
 20156        GO TO 7499-EXIT.
 20157
 20158**2775**
 20159
 20160     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 20161        MOVE AL-UABON            TO CCANDT2A
 20162        MOVE -1                  TO CCANDT2L
 20163        MOVE  1                  TO SET-CURSOR-SW
 20164        GO TO 7499-EXIT.
 20165
 20166**2776**
 20167
 20168     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 20169        MOVE AL-UABON            TO CCANDT1A
 20170        MOVE -1                  TO CCANDT1L
 20171        MOVE  1                  TO SET-CURSOR-SW
 20172        GO TO 7499-EXIT.
 20173
 20174
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 382
* EL6311.cbl
 20175**2777**
 20176
 20177     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 20178        MOVE AL-UABON            TO CCANDT2A
 20179        MOVE -1                  TO CCANDT2L
 20180        MOVE  1                  TO SET-CURSOR-SW
 20181        GO TO 7499-EXIT.
 20182
 20183**2794**
 20184
 20185     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 20186        MOVE AL-UABON            TO CFORCEA
 20187        MOVE -1                  TO CFORCEL
 20188        MOVE  1                  TO SET-CURSOR-SW
 20189        GO TO 7499-EXIT.
 20190
 20191**2799**
 20192
 20193     IF PI-COMPANY-ID = 'UCL'
 20194         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 20195             MOVE AL-UNBON            TO BEFFDTA
 20196             MOVE -1                  TO BEFFDTL
 20197             MOVE  1                  TO SET-CURSOR-SW
 20198             GO TO 7499-EXIT.
 20199
 20200 7499-EXIT.
 20201      EXIT.
 20202
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 383
* EL6311.cbl
 20204
 20205 7500-READ-ERLOFC.
 20206     MOVE SPACES                 TO  WS-LOAN-OFFICER
 20207                                     ERLOFC-KEY.
 20208
 20209     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 20210
 20211     IF ST-ACCNT-CNTL
 20212         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 20213
 20214     IF CARR-GROUP-ST-ACCNT-CNTL
 20215         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 20216         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 20217         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 20218
 20219     IF CARR-ST-ACCNT-CNTL
 20220         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 20221         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 20222
 20223     IF CARR-ACCNT-CNTL
 20224         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 20225
 20226     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 20227
 20228     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 20229
 20230
 20231* EXEC CICS HANDLE CONDITION
 20232*        NOTFND   (7550-OFFICER-NOTFND)
 20233*    END-EXEC.
 20234*    MOVE '"$I                   ! X #00017133' TO DFHEIV0
 20235     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20237     MOVE X'5820233030303137313333' TO DFHEIV0(25:11)
 20238     CALL 'kxdfhei1' USING DFHEIV0
 20239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20240
 20241
 20242
 20243* EXEC CICS READ
 20244*        DATASET   (FILE-ID-ERLOFC)
 20245*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 20246*        RIDFLD    (ERLOFC-KEY)
 20247*        EQUAL
 20248*    END-EXEC.
 20249*    MOVE '&"S        E          (   #00017137' TO DFHEIV0
 20250     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20252     MOVE X'2020233030303137313337' TO DFHEIV0(25:11)
 20253     CALL 'kxdfhei1' USING DFHEIV0,
 20254           FILE-ID-ERLOFC,
 20255           DFHEIV20,
 20256           DFHEIV99,
 20257           ERLOFC-KEY,
 20258           DFHEIV99,
 20259           DFHEIV99,
 20260           DFHEIV99
 20261     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 384
* EL6311.cbl
 20262         DFHEIV20
 20263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20264
 20265
 20266     GO TO 7599-EXIT.
 20267
 20268 7550-OFFICER-NOTFND.
 20269     MOVE 'X'                    TO WS-LOAN-OFFICER.
 20270
 20271 7599-EXIT.
 20272      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 385
* EL6311.cbl
 20274******************************************************************
 20275*                                                                *
 20276*            S  E N D    I N I T I A L   M A P                   *
 20277*                                                                *
 20278******************************************************************
 20279
 20280 8100-SEND-INITIAL-MAP.
 20281     MOVE EIBTIME                TO TIME-IN.
 20282
 20283     IF EIBAID = DFHPF11
 20284        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20286
 20287
 20288     IF PI-COMPANY-ID = CLIENT-GIC
 20289        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 20290                                       BCPREM-ATTRB (2).
 20291
 20292     IF PI-COMPANY-ID = (CLIENT-MIC OR
 20293                         CLIENT-PEM OR
 20294                         CLIENT-CSO)
 20295        AND PI-DISPLAY-ORIGINAL-BATCH
 20296          IF PI-MAP-NAME = EL631B
 20297             MOVE AL-SADOF               TO BPF5HDRA
 20298                                            BPF4HDRA
 20299          ELSE
 20300             IF PI-MAP-NAME = EL631C
 20301                MOVE AL-SADOF            TO CPF5HDRA
 20302                                            CPF4HDRA.
 20303
 20304
 20305*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 20306     IF PI-MAP-NAME = EL631B
 20307          IF PI-COMPANY-ID NOT = 'DMD'
 20308             MOVE AL-SANOF            TO BBILLEDA
 20309             MOVE AL-SADOF            TO DMDBILA.
 20310*DMD CUSTOM CODING*************END
 20311
 20312     IF PI-PROCESSOR-ID = 'LGXX'
 20313        IF PI-MAP-NAME = EL631B
 20314           MOVE AL-SABOF                    TO BREFHDGA
 20315           MOVE AL-SANOF                    TO BREFA
 20316        ELSE
 20317           IF PI-MAP-NAME = EL631C
 20318              MOVE AL-SABOF                 TO CREFHDGA
 20319              MOVE AL-SANOF                 TO CREFA.
 20320
 20321*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 20322     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 20323        NEXT SENTENCE
 20324     ELSE
 20325        IF PI-MAP-NAME = EL631C
 20326           MOVE AL-SADOF            TO CCANTXTA
 20327                                       CCANFEEA.
 20328
 20329     IF PI-MAP-NAME = EL631D
 20330        IF PI-AR-PROCESSING
 20331           MOVE AL-SANOF            TO DREFHDGA
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 386
* EL6311.cbl
 20332        ELSE
 20333           MOVE AL-SADOF            TO DREFHDGA.
 20334
 20335     IF (PI-COMPANY-ID NOT = 'DCC')
 20336        AND (PI-MAP-NAME = EL631B)
 20337        MOVE AL-SADOF            TO BVINHA
 20338                                    BVINA
 20339     END-IF
 20340     IF PI-MAP-NAME = EL631B
 20341        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 20342        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 20343        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 20344        MOVE WS-CURRENT-DT          TO BDATEO
 20345        MOVE TIME-OUT               TO BTIMEO
 20346        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 20347        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 20348        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 20349        IF   WS-DISPLAY-SCREEN
 20350             MOVE PB-ENTRY-BATCH    TO BBATCHO
 20351             MOVE PB-SV-CARRIER     TO BCARRO
 20352             MOVE PB-SV-GROUPING    TO BGROUPO
 20353             MOVE PB-SV-STATE       TO BSTATEO
 20354             MOVE PB-ACCOUNT        TO BACCTO
 20355        ELSE
 20356             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 20357     ELSE
 20358        IF PI-MAP-NAME = EL631C
 20359           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 20360           MOVE WS-CURRENT-DT          TO CDATEO
 20361           MOVE TIME-OUT               TO CTIMEO
 20362           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 20363           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 20364           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 20365           MOVE WS-C-HDG               TO CLFHDGO
 20366           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 20367           MOVE WS-C-HDG               TO CAHHDGO
 20368           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 20369           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 20370           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 20371           IF   WS-DISPLAY-SCREEN
 20372                MOVE PB-ENTRY-BATCH    TO CBATCHO
 20373                MOVE PB-SV-CARRIER     TO CCARRO
 20374                MOVE PB-SV-GROUPING    TO CGROUPO
 20375                MOVE PB-SV-STATE       TO CSTATEO
 20376                MOVE PB-ACCOUNT        TO CACCTO
 20377           ELSE
 20378                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 20379        ELSE
 20380           MOVE WS-CURRENT-DT          TO DDATEO
 20381           MOVE TIME-OUT               TO DTIMEO
 20382           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 20383                                          WS-REFUND-HDG-OVERRIDE
 20384           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 20385           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 20386           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 20387                                          WS-REFUND-HDG-OVERRIDE
 20388           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 20389           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 387
* EL6311.cbl
 20390           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 20391           IF  WS-DISPLAY-SCREEN
 20392               MOVE PB-ENTRY-BATCH     TO DBATCHO
 20393               MOVE PB-CARRIER         TO DCARRO
 20394               MOVE PB-GROUPING        TO DGROUPO
 20395               MOVE PB-STATE           TO DSTATEO
 20396               MOVE PB-ACCOUNT         TO DACCTO
 20397               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 20398           ELSE
 20399               MOVE EL631D             TO PI-MAP-NAME
 20400               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 20401               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 20402
 20403     MOVE SPACE                        TO WS-DISPLAY-SW.
 20404
 20405
 20406* EXEC CICS SEND
 20407*        MAP      (PI-MAP-NAME)
 20408*        MAPSET   (MAPSET-EL6311S)
 20409*        FROM     (EL631BI)
 20410*        ERASE
 20411*        CURSOR
 20412*    END-EXEC.
 20413     MOVE LENGTH OF
 20414      EL631BI
 20415       TO DFHEIV12
 20416     MOVE -1
 20417       TO DFHEIV11
 20418*    MOVE '8$     CT  E    H L F ,   #00017283' TO DFHEIV0
 20419     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 20420     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20421     MOVE X'2020233030303137323833' TO DFHEIV0(25:11)
 20422     CALL 'kxdfhei1' USING DFHEIV0,
 20423           PI-MAP-NAME,
 20424           EL631BI,
 20425           DFHEIV12,
 20426           MAPSET-EL6311S,
 20427           DFHEIV99,
 20428           DFHEIV99,
 20429           DFHEIV99,
 20430           DFHEIV11,
 20431           DFHEIV99,
 20432           DFHEIV99,
 20433           DFHEIV99
 20434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20435
 20436
 20437     GO TO 9100-RETURN-TRAN.
 20438
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 388
* EL6311.cbl
 20440
 20441******************************************************************
 20442*                                                                *
 20443*              S E N D    D A T A O N L Y                        *
 20444*                                                                *
 20445******************************************************************
 20446
 20447 8200-SEND-DATAONLY.
 20448     MOVE EIBTIME                TO TIME-IN.
 20449
 20450     IF PI-COMPANY-ID = CLIENT-GIC
 20451        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 20452                                       BCPREM-ATTRB (2).
 20453
 20454     IF PI-MAP-NAME = EL631B
 20455        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 20456        MOVE WS-CURRENT-DT          TO BDATEO
 20457        MOVE TIME-OUT               TO BTIMEO
 20458        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 20459        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 20460        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 20461        MOVE SPACES                 TO BPFENTRO
 20462        MOVE AL-UANOF               TO BPFENTRA
 20463
 20464*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 20465        IF PI-COMPANY-ID NOT = 'DMD'
 20466             MOVE AL-SANOF            TO BBILLEDA
 20467             MOVE AL-SADOF            TO DMDBILA
 20468         ELSE
 20469            NEXT SENTENCE
 20470*DMD CUSTOM CODING*************END
 20471     ELSE
 20472        IF PI-MAP-NAME = EL631C
 20473           MOVE WS-CURRENT-DT          TO CDATEO
 20474           MOVE TIME-OUT               TO CTIMEO
 20475           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 20476           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 20477           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 20478           MOVE SPACES                 TO CPFENTRO
 20479           MOVE AL-UANOF               TO CPFENTRA
 20480        ELSE
 20481           MOVE WS-CURRENT-DT          TO DDATEO
 20482           MOVE TIME-OUT               TO DTIMEO
 20483           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 20484
 20485
 20486* EXEC CICS SEND
 20487*        MAP      (PI-MAP-NAME)
 20488*        MAPSET   (MAPSET-EL6311S)
 20489*        FROM     (EL631BI)
 20490*        DATAONLY
 20491*        CURSOR
 20492*    END-EXEC.
 20493     MOVE LENGTH OF
 20494      EL631BI
 20495       TO DFHEIV12
 20496     MOVE -1
 20497       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 389
* EL6311.cbl
 20498*    MOVE '8$D    CT       H L F ,   #00017339' TO DFHEIV0
 20499     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20500     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20501     MOVE X'2020233030303137333339' TO DFHEIV0(25:11)
 20502     CALL 'kxdfhei1' USING DFHEIV0,
 20503           PI-MAP-NAME,
 20504           EL631BI,
 20505           DFHEIV12,
 20506           MAPSET-EL6311S,
 20507           DFHEIV99,
 20508           DFHEIV99,
 20509           DFHEIV99,
 20510           DFHEIV11,
 20511           DFHEIV99,
 20512           DFHEIV99,
 20513           DFHEIV99
 20514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20515
 20516
 20517     GO TO 9100-RETURN-TRAN.
 20518
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 390
* EL6311.cbl
 20520
 20521******************************************************************
 20522*                                                                *
 20523*           U T I L I T Y   R O U T I N E S                      *
 20524*                                                                *
 20525******************************************************************
 20526
 20527 8300-SEND-TEXT.
 20528
 20529* EXEC CICS SEND TEXT
 20530*        FROM     (LOGOFF-TEXT)
 20531*        LENGTH   (LOGOFF-LENGTH)
 20532*        ERASE
 20533*        FREEKB
 20534*    END-EXEC.
 20535*    MOVE '8&      T  E F  H   F -   #00017358' TO DFHEIV0
 20536     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20537     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20538     MOVE X'2020233030303137333538' TO DFHEIV0(25:11)
 20539     CALL 'kxdfhei1' USING DFHEIV0,
 20540           LOGOFF-TEXT,
 20541           LOGOFF-LENGTH,
 20542           DFHEIV99,
 20543           DFHEIV99,
 20544           DFHEIV99,
 20545           DFHEIV99,
 20546           DFHEIV99,
 20547           DFHEIV99,
 20548           DFHEIV99,
 20549           DFHEIV99,
 20550           DFHEIV99,
 20551           DFHEIV99
 20552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20553
 20554
 20555
 20556* EXEC CICS RETURN
 20557*    END-EXEC.
 20558*    MOVE '.(                    &   #00017365' TO DFHEIV0
 20559     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20560     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20561     MOVE X'2020233030303137333635' TO DFHEIV0(25:11)
 20562     CALL 'kxdfhei1' USING DFHEIV0,
 20563           DFHEIV99,
 20564           DFHEIV99,
 20565           DFHEIV99,
 20566           DFHEIV99,
 20567           DFHEIV99
 20568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20569
 20570
 20571 8400-LOG-JOURNAL-RECORD.
 20572     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 20573     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 20574
 20575*    EXEC CICS JOURNAL
 20576*        JFILEID     (PI-JOURNAL-FILE-ID)
 20577*        JTYPEID     ('EL')
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 391
* EL6311.cbl
 20578*        FROM        (JOURNAL-RECORD)
 20579*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 20580*    END-EXEC.
 20581
 20582 8600-DEEDIT.
 20583
 20584* EXEC CICS BIF DEEDIT
 20585*         FIELD   (DEEDIT-FIELD)
 20586*         LENGTH  (15)
 20587*    END-EXEC.
 20588     MOVE 15
 20589       TO DFHEIV11
 20590*    MOVE '@"L                   #   #00017380' TO DFHEIV0
 20591     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 20592     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20593     MOVE X'2020233030303137333830' TO DFHEIV0(25:11)
 20594     CALL 'kxdfhei1' USING DFHEIV0,
 20595           DEEDIT-FIELD,
 20596           DFHEIV11
 20597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20598
 20599
 20600 8800-UNAUTHORIZED-ACCESS.
 20601     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20602     GO TO 8300-SEND-TEXT.
 20603
 20604 8810-PF23.
 20605     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20606     MOVE XCTL-EL005             TO PGM-NAME.
 20607     GO TO 9300-XCTL.
 20608
 20609 9100-RETURN-TRAN.
 20610     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20611
 20612     IF  PI-MAP-NAME =  EL631B
 20613         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 20614
 20615     IF  PI-MAP-NAME =  EL631C
 20616         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 20617
 20618     IF  PI-MAP-NAME =  EL631D
 20619         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 20620
 20621
 20622* EXEC CICS RETURN
 20623*        TRANSID    (TRANS-EXB1)
 20624*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 20625*        LENGTH     (1300)
 20626*    END-EXEC.
 20627     MOVE 1300
 20628       TO DFHEIV11
 20629*    MOVE '.(CT                  &   #00017406' TO DFHEIV0
 20630     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20632     MOVE X'2020233030303137343036' TO DFHEIV0(25:11)
 20633     CALL 'kxdfhei1' USING DFHEIV0,
 20634           TRANS-EXB1,
 20635           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 392
* EL6311.cbl
 20636           DFHEIV11,
 20637           DFHEIV99,
 20638           DFHEIV99
 20639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20640
 20641
 20642 9200-RETURN-MAIN-MENU.
 20643     MOVE XCTL-EL626             TO PGM-NAME.
 20644     GO TO 9300-XCTL.
 20645
 20646 9300-XCTL.
 20647
 20648* EXEC CICS XCTL
 20649*        PROGRAM    (PGM-NAME)
 20650*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 20651*        LENGTH     (PI-COMM-LENGTH)
 20652*    END-EXEC.
 20653*    MOVE '.$C                   $   #00017417' TO DFHEIV0
 20654     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20655     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20656     MOVE X'2020233030303137343137' TO DFHEIV0(25:11)
 20657     CALL 'kxdfhei1' USING DFHEIV0,
 20658           PGM-NAME,
 20659           PROGRAM-INTERFACE-BLOCK,
 20660           PI-COMM-LENGTH
 20661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20662
 20663
 20664 9400-CLEAR.
 20665     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20666     GO TO 9300-XCTL.
 20667
 20668 9500-PF12.
 20669     MOVE XCTL-EL010             TO PGM-NAME.
 20670     GO TO 9300-XCTL.
 20671
 20672 9600-PGMID-ERROR.
 20673
 20674* EXEC CICS HANDLE CONDITION
 20675*        PGMIDERR    (8300-SEND-TEXT)
 20676*    END-EXEC.
 20677*    MOVE '"$L                   ! Y #00017432' TO DFHEIV0
 20678     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 20679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20680     MOVE X'5920233030303137343332' TO DFHEIV0(25:11)
 20681     CALL 'kxdfhei1' USING DFHEIV0
 20682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20683
 20684
 20685     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 20686     MOVE ' '                    TO PI-ENTRY-CD-1.
 20687     MOVE XCTL-EL005             TO PGM-NAME.
 20688     MOVE PGM-NAME               TO LOGOFF-PGM.
 20689     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 20690     GO TO 9300-XCTL.
 20691
 20692 9700-DATE-LINK.
 20693     MOVE LINK-ELDATCV           TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 393
* EL6311.cbl
 20694
 20695* EXEC CICS LINK
 20696*        PROGRAM    (PGM-NAME)
 20697*        COMMAREA   (DATE-CONVERSION-DATA)
 20698*        LENGTH     (DC-COMM-LENGTH)
 20699*    END-EXEC.
 20700*    MOVE '."C                   ''   #00017445' TO DFHEIV0
 20701     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20702     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20703     MOVE X'2020233030303137343435' TO DFHEIV0(25:11)
 20704     CALL 'kxdfhei1' USING DFHEIV0,
 20705           PGM-NAME,
 20706           DATE-CONVERSION-DATA,
 20707           DC-COMM-LENGTH,
 20708           DFHEIV99,
 20709           DFHEIV99,
 20710           DFHEIV99
 20711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20712
 20713
 20714 9800-LINK-PENDING-EDIT.
 20715     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 20716     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 20717
 20718     MOVE LINK-EL050             TO PGM-NAME
 20719     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 20720     MOVE ZEROS                  TO WK-CO-MAX-CAP
 20721                                    WK-CO-TOL-CLAIM
 20722                                    WK-CO-TOL-PREM
 20723                                    WK-CO-TOL-REFUND
 20724                                    WK-CO-TOL-PREM-PCT
 20725                                    WK-CO-TOL-REFUND-PCT
 20726                                    WK-REFUND-OVS-AMT
 20727                                    WK-REFUND-OVS-PCT
 20728                                    WK-ACCT-ADDR
 20729                                    WK-LIFE-EDIT-ADDR
 20730                                    WK-AH-EDIT-ADDR
 20731                                    WK-LIFE-BEN-ADDR
 20732                                    WK-AH-BEN-ADDR
 20733                                    WK-STATE-ADDR
 20734                                    WK-PLAN-ADDR
 20735                                    WK-FORM-ADDR.
 20736
 20737     MOVE '6'                    TO WK-ENTRY-SW.
 20738
 20739     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 20740
 20741     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 20742                                    EC-AM-EXPIRATION-DT
 20743                                    EC-AM-EFFECTIVE-DT
 20744                                    EC-CM-LF-CANCEL-DT
 20745                                    EC-CM-AH-CANCEL-DT
 20746                                    EC-CM-DEATH-DT.
 20747
 20748     MOVE ZEROS                  TO EC-CO-TOL-PREM
 20749                                    EC-CO-TOL-REFUND
 20750                                    EC-CO-MIN-AGE
 20751                                    EC-CO-MIN-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 394
* EL6311.cbl
 20752                                    EC-CO-MIN-TERM
 20753                                    EC-CO-MAX-TERM
 20754                                    EC-ST-TOL-PREM
 20755                                    EC-ST-TOL-REFUND
 20756                                    EC-AM-LF-TOL-PREM
 20757                                    EC-AM-AH-TOL-PREM
 20758                                    EC-AM-LF-MAX-ATT-AGE
 20759                                    EC-AM-LF-MAX-AGE
 20760                                    EC-AM-LF-MAX-TERM
 20761                                    EC-AM-LF-MAX-TOT-BEN
 20762                                    EC-AM-AH-MAX-ATT-AGE
 20763                                    EC-AM-AH-MAX-AGE
 20764                                    EC-AM-AH-MAX-TERM
 20765                                    EC-AM-AH-MAX-TOT-BEN
 20766                                    EC-AM-AH-MAX-MON-BEN
 20767                                    EC-RT-LF-MAX-ATT-AGE
 20768                                    EC-RT-LF-MAX-AGE
 20769                                    EC-RT-LF-MAX-TERM
 20770                                    EC-RT-LF-MAX-TOT-BEN
 20771                                    EC-RT-AH-MAX-ATT-AGE
 20772                                    EC-RT-AH-MAX-AGE
 20773                                    EC-RT-AH-MAX-TERM
 20774                                    EC-RT-AH-MAX-TOT-BEN
 20775                                    EC-RT-AH-MAX-MON-BEN
 20776                                    EC-RT-AH-RATE
 20777                                    EC-RT-LF-RATE
 20778                                    EC-RT-LF-NSP-RATE
 20779                                    EC-RT-AH-NSP-RATE
 20780                                    EC-CM-LF-PRIOR-REFUND
 20781                                    EC-CM-AH-PRIOR-REFUND.
 20782
 20783     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 20784                                    EC-ST-TOL-PREM-PCT
 20785                                    EC-AM-LF-TOL-REFUND
 20786                                    EC-AM-LF-DEV-PERCENT
 20787                                    EC-CO-TOL-REFUND-PCT
 20788                                    EC-ST-TOL-REFUND-PCT
 20789                                    EC-AM-AH-TOL-REFUND
 20790                                    EC-AM-AH-DEV-PERCENT.
 20791
 20792
 20793* EXEC CICS LINK
 20794*         PROGRAM   (PGM-NAME)
 20795*         COMMAREA  (PASSED-RECORD)
 20796*         LENGTH    (WS-EDIT-PASS-LENGTH)
 20797*    END-EXEC.
 20798*    MOVE '."C                   ''   #00017529' TO DFHEIV0
 20799     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20800     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20801     MOVE X'2020233030303137353239' TO DFHEIV0(25:11)
 20802     CALL 'kxdfhei1' USING DFHEIV0,
 20803           PGM-NAME,
 20804           PASSED-RECORD,
 20805           WS-EDIT-PASS-LENGTH,
 20806           DFHEIV99,
 20807           DFHEIV99,
 20808           DFHEIV99
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 395
* EL6311.cbl
 20810
 20811
 20812     MOVE '1'                    TO PI-EDIT-SW.
 20813     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 20814
 20815     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 20816
 20817     IF PI-COMPANY-ID = 'UCL'
 20818         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 20819
 20820     IF VALID-PB-ID
 20821        GO TO 9800-EXIT.
 20822
 20823     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 20824
 20825     IF PI-MAP-NAME = EL631B
 20826        MOVE -1                  TO BMAINTL
 20827       ELSE
 20828        MOVE -1                  TO CMAINTL.
 20829
 20830     GO TO 8200-SEND-DATAONLY.
 20831
 20832 9800-EXIT.
 20833      EXIT.
 20834
 20835 9900-ERROR-FORMAT.
 20836
 20837     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20838
 20839     IF NOT EMI-ERRORS-COMPLETE
 20840         MOVE LINK-EL001         TO PGM-NAME
 20841
 20842* EXEC CICS LINK
 20843*            PROGRAM    (PGM-NAME)
 20844*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 20845*            LENGTH     (EMI-COMM-LENGTH)
 20846*        END-EXEC.
 20847*    MOVE '."C                   ''   #00017564' TO DFHEIV0
 20848     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20850     MOVE X'2020233030303137353634' TO DFHEIV0(25:11)
 20851     CALL 'kxdfhei1' USING DFHEIV0,
 20852           PGM-NAME,
 20853           ERROR-MESSAGE-INTERFACE-BLOCK,
 20854           EMI-COMM-LENGTH,
 20855           DFHEIV99,
 20856           DFHEIV99,
 20857           DFHEIV99
 20858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20859
 20860
 20861 9900-EXIT.
 20862     EXIT.
 20863
 20864 9990-ABEND.
 20865     MOVE LINK-EL004             TO PGM-NAME.
 20866     MOVE DFHEIBLK               TO EMI-LINE1.
 20867
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 396
* EL6311.cbl
 20868* EXEC CICS LINK
 20869*        PROGRAM   (PGM-NAME)
 20870*        COMMAREA  (EMI-LINE1)
 20871*        LENGTH    (72)
 20872*    END-EXEC.
 20873     MOVE 72
 20874       TO DFHEIV11
 20875*    MOVE '."C                   ''   #00017576' TO DFHEIV0
 20876     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20877     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20878     MOVE X'2020233030303137353736' TO DFHEIV0(25:11)
 20879     CALL 'kxdfhei1' USING DFHEIV0,
 20880           PGM-NAME,
 20881           EMI-LINE1,
 20882           DFHEIV11,
 20883           DFHEIV99,
 20884           DFHEIV99,
 20885           DFHEIV99
 20886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20887
 20888
 20889     IF PI-MAP-NAME = EL631B
 20890        MOVE -1                  TO BMAINTL
 20891       ELSE
 20892        MOVE -1                  TO CMAINTL.
 20893
 20894     IF EIBTRNID NOT = TRANS-EXB1
 20895        GO TO 8100-SEND-INITIAL-MAP
 20896       ELSE
 20897        GO TO 8200-SEND-DATAONLY.
 20898
 20899 9995-SECURITY-VIOLATION.
 20900*                            COPY ELCSCTP.
 20901******************************************************************
 20902*                                                                *
 20903*                            ELCSCTP                             *
 20904*                            VMOD=2.001                          *
 20905*                                                                *
 20906*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20907******************************************************************
 20908
 20909
 20910     MOVE EIBDATE          TO SM-JUL-DATE.
 20911     MOVE EIBTRMID         TO SM-TERMID.
 20912     MOVE THIS-PGM         TO SM-PGM.
 20913     MOVE EIBTIME          TO TIME-IN.
 20914     MOVE TIME-OUT         TO SM-TIME.
 20915     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20916
 20917
 20918* EXEC CICS LINK
 20919*         PROGRAM  ('EL003')
 20920*         COMMAREA (SECURITY-MESSAGE)
 20921*         LENGTH   (80)
 20922*    END-EXEC.
 20923     MOVE 'EL003' TO DFHEIV1
 20924     MOVE 80
 20925       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 397
* EL6311.cbl
 20926*    MOVE '."C                   ''   #00017610' TO DFHEIV0
 20927     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20928     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20929     MOVE X'2020233030303137363130' TO DFHEIV0(25:11)
 20930     CALL 'kxdfhei1' USING DFHEIV0,
 20931           DFHEIV1,
 20932           SECURITY-MESSAGE,
 20933           DFHEIV11,
 20934           DFHEIV99,
 20935           DFHEIV99,
 20936           DFHEIV99
 20937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20938
 20939
 20940******************************************************************
 20941
 20942
 20943 9999-DFHBACK SECTION.
 20944     MOVE '9%                    "   ' TO DFHEIV0
 20945     MOVE 'EL6311' TO DFHEIV1
 20946     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20947     GOBACK.
 20948 9999-DFHEXIT.
 20949     IF DFHEIGDJ EQUAL 0001
 20950         NEXT SENTENCE
 20951     ELSE IF DFHEIGDJ EQUAL 2
 20952         GO TO 9600-PGMID-ERROR,
 20953               9990-ABEND,
 20954               9990-ABEND,
 20955               0010-MAIN-LOGIC
 20956         DEPENDING ON DFHEIGDI
 20957     ELSE IF DFHEIGDJ EQUAL 3
 20958         GO TO 1280-BATCH-HDR-NOT-FOUND
 20959         DEPENDING ON DFHEIGDI
 20960     ELSE IF DFHEIGDJ EQUAL 4
 20961         GO TO 1290-DUPLICATE-ALT-INDEX
 20962         DEPENDING ON DFHEIGDI
 20963     ELSE IF DFHEIGDJ EQUAL 5
 20964         GO TO 1380-BATCH-HDR-NOT-FOUND
 20965         DEPENDING ON DFHEIGDI
 20966     ELSE IF DFHEIGDJ EQUAL 6
 20967         GO TO 1385-REC-NOT-FOUND
 20968         DEPENDING ON DFHEIGDI
 20969     ELSE IF DFHEIGDJ EQUAL 7
 20970         GO TO 1399-EXIT
 20971         DEPENDING ON DFHEIGDI
 20972     ELSE IF DFHEIGDJ EQUAL 8
 20973         GO TO 1480-BATCH-HDR-NOT-FOUND
 20974         DEPENDING ON DFHEIGDI
 20975     ELSE IF DFHEIGDJ EQUAL 9
 20976         GO TO 1490-RECORD-NOT-FOUND
 20977         DEPENDING ON DFHEIGDI
 20978     ELSE IF DFHEIGDJ EQUAL 10
 20979         GO TO 1405-DELETE-CERTIFICATE
 20980         DEPENDING ON DFHEIGDI
 20981     ELSE IF DFHEIGDJ EQUAL 11
 20982         GO TO 1420-CONTINUE-DELETE
 20983         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 398
* EL6311.cbl
 20984     ELSE IF DFHEIGDJ EQUAL 12
 20985         GO TO 1406-DELETE-ERNOTE
 20986         DEPENDING ON DFHEIGDI
 20987     ELSE IF DFHEIGDJ EQUAL 13
 20988         GO TO 1407-DELETE-MAILING
 20989         DEPENDING ON DFHEIGDI
 20990     ELSE IF DFHEIGDJ EQUAL 14
 20991         GO TO 1420-CONTINUE-DELETE
 20992         DEPENDING ON DFHEIGDI
 20993     ELSE IF DFHEIGDJ EQUAL 15
 20994         GO TO 1480-BATCH-HDR-NOT-FOUND
 20995         DEPENDING ON DFHEIGDI
 20996     ELSE IF DFHEIGDJ EQUAL 16
 20997         GO TO 1475-DELETE-FINISHED
 20998         DEPENDING ON DFHEIGDI
 20999     ELSE IF DFHEIGDJ EQUAL 17
 21000         GO TO 2280-BATCH-HDR-NOT-FOUND
 21001         DEPENDING ON DFHEIGDI
 21002     ELSE IF DFHEIGDJ EQUAL 18
 21003         GO TO 2290-DUPLICATE-ALT-INDEX
 21004         DEPENDING ON DFHEIGDI
 21005     ELSE IF DFHEIGDJ EQUAL 19
 21006         GO TO 2380-BATCH-HDR-NOT-FOUND
 21007         DEPENDING ON DFHEIGDI
 21008     ELSE IF DFHEIGDJ EQUAL 20
 21009         GO TO 2385-REC-NOT-FOUND
 21010         DEPENDING ON DFHEIGDI
 21011     ELSE IF DFHEIGDJ EQUAL 21
 21012         GO TO 2380-BATCH-HDR-NOT-FOUND
 21013         DEPENDING ON DFHEIGDI
 21014     ELSE IF DFHEIGDJ EQUAL 22
 21015         GO TO 2485-BATCH-HDR-NOT-FOUND
 21016         DEPENDING ON DFHEIGDI
 21017     ELSE IF DFHEIGDJ EQUAL 23
 21018         GO TO 2490-RECORD-NOT-FOUND
 21019         DEPENDING ON DFHEIGDI
 21020     ELSE IF DFHEIGDJ EQUAL 24
 21021         GO TO 2475-CONTINUE-DELETE
 21022         DEPENDING ON DFHEIGDI
 21023     ELSE IF DFHEIGDJ EQUAL 25
 21024         GO TO 2485-BATCH-HDR-NOT-FOUND
 21025         DEPENDING ON DFHEIGDI
 21026     ELSE IF DFHEIGDJ EQUAL 26
 21027         GO TO 2480-DELETE-FINISHED
 21028         DEPENDING ON DFHEIGDI
 21029     ELSE IF DFHEIGDJ EQUAL 27
 21030         GO TO 2820-PROCESS-REWRITE
 21031         DEPENDING ON DFHEIGDI
 21032     ELSE IF DFHEIGDJ EQUAL 28
 21033         GO TO 2885-RECORD-MISSING
 21034         DEPENDING ON DFHEIGDI
 21035     ELSE IF DFHEIGDJ EQUAL 29
 21036         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 21037         DEPENDING ON DFHEIGDI
 21038     ELSE IF DFHEIGDJ EQUAL 30
 21039         GO TO 2827-DELETE-MAILING
 21040         DEPENDING ON DFHEIGDI
 21041     ELSE IF DFHEIGDJ EQUAL 31
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 399
* EL6311.cbl
 21042         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 21043         DEPENDING ON DFHEIGDI
 21044     ELSE IF DFHEIGDJ EQUAL 32
 21045         GO TO 2920-PROCESS-REWRITE
 21046         DEPENDING ON DFHEIGDI
 21047     ELSE IF DFHEIGDJ EQUAL 33
 21048         GO TO 2985-RECORD-MISSING
 21049         DEPENDING ON DFHEIGDI
 21050     ELSE IF DFHEIGDJ EQUAL 34
 21051         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 21052         DEPENDING ON DFHEIGDI
 21053     ELSE IF DFHEIGDJ EQUAL 35
 21054         GO TO 2990-DUPLICATE-RECORD
 21055         DEPENDING ON DFHEIGDI
 21056     ELSE IF DFHEIGDJ EQUAL 36
 21057         GO TO 3590-NOT-FOUND
 21058         DEPENDING ON DFHEIGDI
 21059     ELSE IF DFHEIGDJ EQUAL 37
 21060         GO TO 3690-NOT-FOUND
 21061         DEPENDING ON DFHEIGDI
 21062     ELSE IF DFHEIGDJ EQUAL 38
 21063         GO TO 3990-NOT-FOUND
 21064         DEPENDING ON DFHEIGDI
 21065     ELSE IF DFHEIGDJ EQUAL 39
 21066         GO TO 4050-END-RECORDS,
 21067               4050-END-RECORDS
 21068         DEPENDING ON DFHEIGDI
 21069     ELSE IF DFHEIGDJ EQUAL 40
 21070         GO TO 4150-END-BATCH
 21071         DEPENDING ON DFHEIGDI
 21072     ELSE IF DFHEIGDJ EQUAL 41
 21073         GO TO 4150-END-BATCH
 21074         DEPENDING ON DFHEIGDI
 21075     ELSE IF DFHEIGDJ EQUAL 42
 21076         GO TO 4250-END-RECORDS,
 21077               4250-END-RECORDS
 21078         DEPENDING ON DFHEIGDI
 21079     ELSE IF DFHEIGDJ EQUAL 43
 21080         GO TO 4350-END-BATCH,
 21081               4350-END-BATCH
 21082         DEPENDING ON DFHEIGDI
 21083     ELSE IF DFHEIGDJ EQUAL 44
 21084         GO TO 4570-NOT-FOUND,
 21085               4550-END-RECORDS
 21086         DEPENDING ON DFHEIGDI
 21087     ELSE IF DFHEIGDJ EQUAL 45
 21088         GO TO 4680-NOT-FOUND,
 21089               4680-NOT-FOUND
 21090         DEPENDING ON DFHEIGDI
 21091     ELSE IF DFHEIGDJ EQUAL 46
 21092         GO TO 4860-NOT-FOUND,
 21093               4850-END-RECORDS
 21094         DEPENDING ON DFHEIGDI
 21095     ELSE IF DFHEIGDJ EQUAL 47
 21096         GO TO 4970-NOT-FOUND,
 21097               4950-END-RECORDS
 21098         DEPENDING ON DFHEIGDI
 21099     ELSE IF DFHEIGDJ EQUAL 48
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:44 Page 400
* EL6311.cbl
 21100         GO TO 5050-NOT-FOUND
 21101         DEPENDING ON DFHEIGDI
 21102     ELSE IF DFHEIGDJ EQUAL 49
 21103         GO TO 5050-NOT-FOUND
 21104         DEPENDING ON DFHEIGDI
 21105     ELSE IF DFHEIGDJ EQUAL 50
 21106         GO TO 5050-NOT-FOUND
 21107         DEPENDING ON DFHEIGDI
 21108     ELSE IF DFHEIGDJ EQUAL 51
 21109         GO TO 5550-END-RECORDS,
 21110               5550-END-RECORDS
 21111         DEPENDING ON DFHEIGDI
 21112     ELSE IF DFHEIGDJ EQUAL 52
 21113         GO TO 6050-QID-ERROR
 21114         DEPENDING ON DFHEIGDI
 21115     ELSE IF DFHEIGDJ EQUAL 53
 21116         GO TO 6050-QID-ERROR
 21117         DEPENDING ON DFHEIGDI
 21118     ELSE IF DFHEIGDJ EQUAL 54
 21119         GO TO 3690-NOT-FOUND
 21120         DEPENDING ON DFHEIGDI
 21121     ELSE IF DFHEIGDJ EQUAL 55
 21122         GO TO 7399-EXIT
 21123         DEPENDING ON DFHEIGDI
 21124     ELSE IF DFHEIGDJ EQUAL 56
 21125         GO TO 7550-OFFICER-NOTFND
 21126         DEPENDING ON DFHEIGDI
 21127     ELSE IF DFHEIGDJ EQUAL 57
 21128         GO TO 8300-SEND-TEXT
 21129         DEPENDING ON DFHEIGDI.
 21130     MOVE '9%                    "   ' TO DFHEIV0
 21131     MOVE 'EL6311' TO DFHEIV1
 21132     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21133     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       11524     Code:       84972
