* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL689 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 04/20/94 15:10:07.
     8*                            VMOD=2.037
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12*DATE-COMPILED.
    13*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   2
* EL689.cbl
    14*
    15******************************************************************
    16
    17* W-FILE-USED REFERENCE LIST:
    18* (1)  ELCNTL - COMPANY
    19* (2)  ELCNTL - LIFE BENEFIT
    20* (3)  ELCNTL - A&H BENEFIT
    21* (4)  ELCNTL - CARRIER
    22* (5)  MAIL
    23* (6)  ERACCT
    24* (7)  USED FOR SYSTEM VARIABLES ?
    25* (8)  ELCERT
    26* (9)  PENDING BUSINESS
    27* (10) COMPENSATION
    28* (11) ELCNTL - PROCESSOR DATA ?
    29* (12) ERCHEK
    30* (13) ERPYAJ
    31* (14) NOT USED
    32* (15) NOT USED
    33* (16) NOT USED
    34* (17) NOT USED
    35* (18) NOT USED
    36* (19) NOT USED
    37* (20) NOT USED
    38*
    39******************************************************************
    40*                   C H A N G E   L O G
    41*
    42* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    43*-----------------------------------------------------------------
    44*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    45* EFFECTIVE    NUMBER
    46*-----------------------------------------------------------------
    47* 101501    2001100100006  SMVA  ADD USERID to screen header
    48*                                ADJUSTED REDEFINES EL689AI FILLER
    49* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    50* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    51* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    52* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    53* 092908    2008013100006  PEMA  MOVE VAR 154
    54* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    55* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    56* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    57* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    58* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    59* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    60* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    61* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    62* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    63* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    64* 122011  CR2011022800001  AJRA  NAPERSOFT
    65* 090612  IR2012090600001  AJRA  NAPERSOFT
    66* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    67* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    68* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    69* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    70* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    71* 011013  CR2012101700002  AJRA  CHECK REQ REASON CODE IND
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   3
* EL689.cbl
    72* 012413  CR2013012100001  AJRA  ADD AUTO BILLING NOTE
    73* 121213  CR2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    74* 123113  CR2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    75* 010814  CR2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    76******************************************************************
    77
    78 DATA DIVISION.
    79 WORKING-STORAGE SECTION.
    80 01  DFH-START PIC X(04).
    81 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    82 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    83                                   USAGE POINTER.
    84 77  FILLER  PIC X(32) VALUE '********************************'.
    85 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    86 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    87
*   88 EXEC SQL
*   89    INCLUDE SQLDA
*   90 END-EXEC
    91 01 SQLDA sync.
    92    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    93    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    94    05 SQLN                  PIC S9(4) COMP-5 value 0.
    95    05 SQLD                  PIC S9(4) COMP-5 value 0.
    96    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    97       10 SQLTYPE            PIC S9(4) COMP-5.
    98       10 SQLLEN             PIC S9(4) COMP-5.
    99$IF P64 SET
   100X      *> For 64-bit environments, ensure that SQLDATA is
   101X      *> aligned on an 8-byte boundary.
   102X      10 FILLER             PIC S9(9) COMP-5.
   103$END
   104       10 SQLDATA            USAGE POINTER.
   105       10 SQLIND             USAGE POINTER.
   106       10 SQLNAME.
   107          15 SQLNAMEL        PIC S9(4) COMP-5.
   108          15 SQLNAMEC        PIC X(30).
   109
   110* Values for SQLTYPE
   111
   112 78  ESQL-DATE-CHAR              VALUE 384.
   113 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   114 78  ESQL-DATE-REC               VALUE 386.
   115 78  ESQL-DATE-REC-NULL          VALUE 387.
   116 78  ESQL-TIME-CHAR              VALUE 388.
   117 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   118 78  ESQL-TIME-REC               VALUE 390.
   119 78  ESQL-TIME-REC-NULL          VALUE 391.
   120 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   121 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   122 78  ESQL-TIMESTAMP-REC          VALUE 394.
   123 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   124 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   125 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   126 78  ESQL-TS-OFFSET-REC          VALUE 398.
   127 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   128 78  ESQL-LONGVARBINARY          VALUE 404.
   129 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   4
* EL689.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-LONGVARCHAR            VALUE 408.
   131 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   132 78  ESQL-BINARY                 VALUE 444.
   133 78  ESQL-BINARY-NULL            VALUE 445.
   134 78  ESQL-VARBINARY              VALUE 446.
   135 78  ESQL-VARBINARY-NULL         VALUE 447.
   136 78  ESQL-VARCHAR                VALUE 448.
   137 78  ESQL-VARCHAR-NULL           VALUE 449.
   138
   139 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   140 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   141
   142 78  ESQL-CHAR                   VALUE 452.
   143 78  ESQL-CHAR-NULL              VALUE 453.
   144
   145 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   146 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   147
   148 78  ESQL-DOUBLE                 VALUE 480.
   149 78  ESQL-DOUBLE-NULL            VALUE 481.
   150 78  ESQL-REAL                   VALUE 482.
   151 78  ESQL-REAL-NULL              VALUE 483.
   152 78  ESQL-DECIMAL                VALUE 484.
   153 78  ESQL-DECIMAL-NULL           VALUE 485.
   154 78  ESQL-INTEGER                VALUE 496.
   155 78  ESQL-INTEGER-NULL           VALUE 497.
   156 78  ESQL-SMALLINT               VALUE 500.
   157 78  ESQL-SMALLINT-NULL          VALUE 501.
   158 78  ESQL-TINYINT                VALUE 502.
   159 78  ESQL-TINYINT-NULL           VALUE 503.
   160
*  161 EXEC SQL
*  162    INCLUDE SQLCA
*  163 END-EXEC
   164 01 SQLCA.
   165     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   166     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   167     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   168     05  SQLERRM.
   169         49  SQLERRML    PIC S9(4) COMP-5.
   170         49  SQLERRMC    PIC X(70).
   171     05  SQLERRP         PIC X(8).
   172     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   173     05  SQLWARN.
   174         10  SQLWARN0    PIC X.
   175         10  SQLWARN1    PIC X.
   176         10  SQLWARN2    PIC X.
   177         10  SQLWARN3    PIC X.
   178         10  SQLWARN4    PIC X.
   179         10  SQLWARN5    PIC X.
   180         10  SQLWARN6    PIC X.
   181         10  SQLWARN7    PIC X.
   182     05  SQLEXT.
   183         10  SQLWARN8    PIC X.
   184         10  SQLWARN9    PIC X.
   185         10  SQLWARN10   PIC X.
   186         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   187     05  SQLSTATE    PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   5
* EL689.cbl
   188
   189 EXEC SQL
   190    BEGIN DECLARE SECTION
   191 END-EXEC
   192
   193 01  SQLCMD                      PIC X(1024).
   194 01  SVR                         PIC X(32).
   195 01  USR                         PIC X(32).
   196 01  PASS                        PIC X(32).
   197 01  USR-PASS                    PIC X(64).
   198
   199 01  WS-SQL-DATA.
   200     05  WS-CYCLE-DATE           PIC X(10).
   201     05  WS-NEXT-BUS-DT          PIC X(10).
   202
   203 EXEC SQL
   204    END DECLARE SECTION
   205 END-EXEC
   206
   207 01  P pointer.
   208 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   209 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   210 01  var-ptr pointer.
   211 01  env-var-len                 pic 9(4)  binary.
   212 01  rc                          pic 9(9)  binary.
   213 01  WS-KIXHOST                  PIC X(10).
   214 01  WS-KIXSYS.
   215     05  WS-KIX-FIL1             PIC X(10).
   216     05  WS-KIX-APPS             PIC X(10).
   217     05  WS-KIX-ENV              PIC X(10).
   218     05  WS-KIX-MYENV            PIC X(10).
   219     05  WS-KIX-SYS              PIC X(10).
   220 01 srch-commarea.
   221*                                copy ELCADLTRSPI.
   222******************************************************************
   223*                   C H A N G E   L O G
   224*
   225* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   226*-----------------------------------------------------------------
   227*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   228* EFFECTIVE    NUMBER
   229*-----------------------------------------------------------------
   230* 060611    2011022800001  PEMA  NEW COPYBOOK
   231* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   232* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   233******************************************************************
   234****************************************
   235*  commarea for NaperSoft On Demand Admin services letters
   236*  (business logic input & output)
   237****************************************
   238     03  BL-INPUT.
   239         05  BL-DATA-SRCE        PIC X.
   240         05  BL-LETTER-ID        PIC XXXX.
   241         05  BL-CARRIER          PIC X.
   242         05  BL-GROUP            PIC X(6).
   243         05  BL-STATE            PIC XX.
   244         05  BL-ACCOUNT          PIC X(10).
   245         05  BL-EFF-DT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   6
* EL689.cbl
   246         05  BL-CERT-NO          PIC X(11).
   247         05  BL-BATCH-NO         PIC X(6).
   248         05  BL-BATCH-SEQ        PIC 9(8).
   249         05  BL-RESP-NO          PIC X(10).
   250         05  BL-NO-OF-COPIES     PIC 99.
   251         05  BL-PROC-ID          PIC XXXX.
   252         05  BL-COMP-ID          PIC XXX.
   253         05  BL-PRINT-NOW-SW     PIC X.
   254         05  BL-ENC-CD           PIC XXX.
   255         05  BL-RESEND-DT        PIC X(10).
   256         05  BL-FOLLOW-UP-DT     PIC X(10).
   257         05  BL-ARCHIVE-NO       PIC 9(8).
   258         05  BL-FUNC             PIC X(8).
   259         05  BL-COMMENTS         PIC X(100).
   260         05  FILLER REDEFINES BL-COMMENTS.
   261             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   262             10  BL-LETTER-TO-ACCT PIC X.
   263             10  BL-LETTER-TO-BENE PIC X.
   264             10  BL-WRITE-ERARCH   PIC X.
   265                 88  ERARCH-QWS      VALUE 'Q'.
   266                 88  ERARCH-BATCH    VALUE 'B'.
   267                 88  ERARCH-TEMP     VALUE 'T'.
   268             10  BL-PROCESS-TYPE PIC X(07).
   269             10  BL-CERT-FORM-ID PIC X(05).
   270             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   271             10  BL-SOURCE-SCREEN PIC X(8).
   272             10  FILLER          PIC X(25).
   273     03  BL-OUTPUT.
   274         05  BL-STATUS                   PIC X.
   275             88  BL-OK                      VALUE "P".
   276             88  BL-FAIL                  VALUE "F".
   277         05  BL-MESSAGE          PIC X(50).
   278     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   279     03  FILLER                  PIC X(31).
   280 01  W-WORK-AREAS.
   281     12  FILLER                  PIC  X(18)
   282                                      VALUE 'PROGRAM WORK AREA:'.
   283
   284     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   285     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   286     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   287     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   288     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   289     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   290     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   291     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   292     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   293     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   294
   295     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   296     12  W-DIFFERENCE            PIC S9(07)V9(02)
   297                                            VALUE +0   COMP-3.
   298     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   299     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   300     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   301     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
   302     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   303     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   7
* EL689.cbl
   304     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   305     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   306     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   307     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   308     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   309     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   310     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   311     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   312     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   313     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   314     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   315     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   316     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   317     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   318     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   319     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   320     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   321     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   322     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   323                                            VALUE +0   COMP-3.
   324
   325     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   326     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   327         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   328     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   329     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   330     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   331     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   332     12  W-SAVE-REVISION         PIC  9(03) value 0.
   333     12  W-DISPLAY-3             PIC  9(03) value 0.
   334     12  W-DISPLAY-8             PIC  9(08) value 0.
   335     12  W-DISPLAY-7             PIC  9(07) value 0.
   336     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   337     12  W-EDIT-3-0              PIC  ZZ9.
   338     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   339     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   340     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   341     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   342
   343     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   344         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   345
   346     12  W-ARCH-SUPPRESS         PIC 99999999.
   347     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   348                                 PIC  X(08).
   349     12  W-COMP-WORK-AREA.
   350         16  W-CWA-CHAR OCCURS 10 TIMES
   351                                 PIC  X(01).
   352     12  W-INCOMING-ARCHIVE      PIC  X(08).
   353     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   354                                 PIC  9(08).
   355
   356     12  W-BATCH-BREAKDOWN.
   357         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   358         16  W-BATCH-SEQ         PIC S9(04) COMP.
   359     12  W-BEN-HOLD              PIC  X(02).
   360     12  W-BENEFIT-WORK          PIC  X(03).
   361     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   8
* EL689.cbl
   362         16  W-ELIM-DAYS         PIC  X(02).
   363         16  FILLER              PIC  X(01).
   364     12  W-CALL-PGM              PIC  X(08).
   365     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   366
   367     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   368     12  W-LINE-CONTROL-RECORD.
   369         16  W-LC-LINE-WIDTH     PIC  9(02).
   370         16  FILLER              PIC  X(01).
   371         16  W-LC-PARAGRAPH-INDENT
   372                                 PIC  9(02).
   373         16  FILLER              PIC  X(01).
   374         16  W-LC-MAX-LINES-PER-PAGE
   375                                 PIC  9(02).
   376         16  FILLER              PIC  X(01).
   377         16  W-LC-LINE-ADJUST    PIC  9(02).
   378         16  FILLER              PIC  X(01).
   379         16  W-LC-LINE-INDENT-1  PIC  9(02).
   380         16  FILLER              PIC  X(01).
   381         16  W-LC-LINE-INDENT-2  PIC  9(02).
   382         16  FILLER              PIC  X(01).
   383         16  W-LC-LINE-INDENT-3  PIC  9(02).
   384         16  FILLER              PIC  X(01).
   385         16  W-LC-LINE-INDENT-4  PIC  9(02).
   386         16  FILLER              PIC  X(01).
   387         16  W-LC-LINE-INDENT-5  PIC  9(02).
   388         16  FILLER              PIC  X(01).
   389         16  W-LC-TOP-MARGIN     PIC  9(02).
   390         16  FILLER              PIC  X(01).
   391         16  W-LC-CASE-IND       PIC  X(01).
   392             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   393         16  FILLER              PIC  X(01).
   394         16  W-LC-PAGE-IND       PIC  X(01).
   395             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   396     12  W-DATE-WORK             PIC  9(07).
   397     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   398         16  FILLER              PIC  X(02).
   399         16  W-DT-WORK           PIC  9(05).
   400
   401     12  W-DEEDIT-FIELD          PIC  X(15).
   402     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   403
   404     12  W-EDIT-DATE-1.
   405         16  W-ED1-MM            PIC  X(02).
   406         16  FILLER              PIC  X(01) VALUE '/'.
   407         16  W-ED1-DD            PIC  X(02).
   408         16  FILLER              PIC  X(01) VALUE '/'.
   409         16  W-ED1-YY            PIC  X(02).
   410
   411     12  W-EDIT-DATE-2.
   412         16  W-ED2-DD            PIC  X(02).
   413         16  FILLER              PIC  X(01) VALUE '/'.
   414         16  W-ED2-MM            PIC  X(02).
   415         16  FILLER              PIC  X(01) VALUE '/'.
   416         16  W-ED2-YY            PIC  X(02).
   417
   418     12  W-EDIT-A-DATE.
   419         16  W-EDIT-A-MM                  PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page   9
* EL689.cbl
   420         16  FILLER                       PIC X(1).
   421         16  W-EDIT-A-DD                  PIC X(2).
   422         16  FILLER                       PIC X(1).
   423         16  W-EDIT-A-CCYY.
   424             20  W-EDIT-A-CC              PIC X(2).
   425             20  W-EDIT-A-YY              PIC X(2).
   426
   427     12  W-LABEL-HOLD-AREA.
   428         16  W-LABEL-LINES OCCURS 6 TIMES.
   429             20  W-LABEL-ZIP.
   430                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   431                 24  W-LABEL-DASH     PIC  X(01).
   432                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   433             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   434                 24  W-LAB-CAN-POSTAL-CD-1
   435                                      PIC  X(03).
   436                 24  W-LAB-CAN-DASH   PIC  X(01).
   437                 24  W-LAB-CAN-POSTAL-CD-2
   438                                      PIC  X(03).
   439                 24  W-LAB-CAN-FILLER PIC  X(03).
   440             20  FILLER               PIC  X(10).
   441             20  W-LAST-ZIP.
   442                 24  W-LAST-1ST-ZIP   PIC  X(05).
   443                 24  W-LABEL-DASH-LAST
   444                                      PIC  X(01).
   445                 24  W-LAST-2ND-ZIP   PIC  X(04).
   446             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   447                 24  W-LAST-CAN-POSTAL-CD-1
   448                                      PIC  X(03).
   449                 24  W-LAST-CAN-DASH  PIC  X(01).
   450                 24  W-LAST-CAN-POSTAL-CD-2
   451                                      PIC  X(03).
   452                 24  W-LAST-CAN-FILLER
   453                                      PIC  X(03).
   454
   455     12  W-LAST-CHAR             PIC  X(01).
   456         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   457     12  W-LAST-SQ-CHAR          PIC  X(01).
   458
   459     12  W-LINE-NUM.
   460         16  W-LINE1             PIC  X(01).
   461         16  W-LINE23            PIC  9(02).
   462     12  W-LIN-NUM REDEFINES W-LINE-NUM
   463                                 PIC  9(03).
   464
   465     12  W-NAME-LAST             PIC  X(15).
   466     12  W-NAME-FIRST.
   467         16  W-NAME-FIRST-INIT   PIC  X(01).
   468         16  W-NAME-FIRST-REMAIN PIC  X(14).
   469     12  W-NAME-MIDDLE.
   470         16  FILLER              PIC  X(01).
   471         16  W-NAME-MIDDLE-2     PIC  X(01).
   472         16  FILLER              PIC  X(13).
   473
   474     12  W-PAGE-PRT.
   475         16  FILLER              PIC  X(34) VALUE SPACES.
   476         16  W-PAGE-NUMBER       PIC  Z9.
   477         16  FILLER              PIC  X(01) VALUE '.'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  10
* EL689.cbl
   478         16  FILLER              PIC  X(33) VALUE SPACES.
   479
   480     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   481     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   482         16  FILLER              PIC  9(01).
   483         16  W-PHI-AREA          PIC  9(03).
   484         16  W-PHI-PFX           PIC  9(03).
   485         16  W-PHI-SFX           PIC  9(04).
   486     12  W-PHONE-OUT.
   487         16  W-PO-AREA           PIC  X(03).
   488         16  FILLER              PIC  X(01) VALUE '-'.
   489         16  W-PO-PFX            PIC  X(03).
   490         16  FILLER              PIC  X(01) VALUE '-'.
   491         16  W-PO-SFX            PIC  X(04).
   492
   493     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   494     12  W-SAVE-BIN-NEXT-BUS-DT  PIC  X(02) VALUE SPACES.
   495     12  W-SAVE-NEXT-BUS-DT-EDIT-A PIC X(10)   VALUE SPACES.
   496     12  W-SAVE-CYCLE-DAY-OF-WEEK PIC S9   COMP-3 VALUE +0.
   497     12  W-SAVE-EDIT-A-DATE      PIC  X(10) VALUE SPACES.
   498     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   499     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   500
   501     12  W-SINGLE-LINE           PIC  X(70).
   502     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   503         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   504                                 PIC  X(01).
   505
   506     12  W-SQUEEZED-LINE.
   507         16  W-SQ-CHAR OCCURS 70 TIMES
   508                       INDEXED BY W-SQ-NDX
   509                                 PIC  X(01).
   510
   511     12  W-TIME-IN               PIC S9(07).
   512     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   513         16  FILLER              PIC  X(01).
   514         16  W-TIME-OUT          PIC  99V9(02).
   515         16  FILLER              PIC  X(02).
   516
   517     12  W-TS-NAME-TEXT.
   518         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   519         16  W-TS-ID-TIME
   520             REDEFINES W-TS-ID-TEXT
   521                                 PIC S9(07) COMP-3.
   522         16  W-TS-TERM-TEXT.
   523             20 W-TS-TERM-PREFIX PIC  X(02).
   524             20 FILLER           PIC  X(02).
   525     12  W-TS-NAME-SCREEN.
   526         16  FILLER              PIC  X(04) VALUE '689X'.
   527         16  W-TS-TERM-SCREEN    PIC  X(04).
   528
   529     12  W-WORK-LINE.
   530         16  W-WORK-CHAR OCCURS 70 TIMES
   531                       INDEXED BY W-WC-NDX
   532                                  W-WC-NDX2
   533                                  W-WC-NDX3
   534                                 PIC  X(01).
   535
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  11
* EL689.cbl
   536     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   537     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   538         16  W-WORK-ZIP5         PIC  X(05).
   539         16  W-WORK-ZIP4         PIC  X(04).
   540     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   541         16  W-CAN-POSTAL-CD-1.
   542             20  FILLER          PIC  X(01).
   543                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   544             20  FILLER          PIC  X(02).
   545         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   546         16  W-FILLER            PIC  X(03).
   547
   548**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   549*                   COPY ELCZREC.
   550******************************************************************
   551*                                                                *
   552*                                                                *
   553*                            ELCZREC.                            *
   554*                                                                *
   555*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   556*                                                                *
   557******************************************************************
   558*-----------------------------------------------------------------
   559*                   C H A N G E   L O G
   560*
   561* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   562*-----------------------------------------------------------------
   563*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   564* EFFECTIVE    NUMBER
   565*-----------------------------------------------------------------
   566* 122011    2011022800001  AJRA  NEW FILE
   567* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   568* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   569* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   570* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   571*-----------------------------------------------------------------
   572 01  W-Z-CONTROL-DATA.
   573     05  W-NUMBER-OF-COPIES      PIC  9.
   574     05  FILLER                  PIC  X.
   575     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   576     05  FILLER                  PIC  X.
   577     05  W-DAYS-TO-RESEND        PIC  999.
   578     05  FILLER                  PIC  X.
   579     05  W-FORM-TO-RESEND        PIC  X(4).
   580     05  W-ADD-BAR-CODE          PIC  X.
   581     05  W-PROMPT-LETTER         PIC  X.
   582     05  W-HAS-RETURN-ENV        PIC  X.
   583     05  W-ENCLOSURE-CD          PIC  XXX.
   584     05  W-SIG-FLAG-DEFAULT      PIC  X.
   585     05  W-AUTO-CLOSE-IND        PIC  X.
   586     05  FILLER                  PIC  X.
   587     05  W-LETTER-TO-BENE        PIC  X.
   588     05  FILLER                  PIC  X.
   589     05  W-LETTER-TO-ACCT        PIC  X.
   590     05  FILLER                  PIC  X.
   591     05  W-LETTER-TYPE           PIC  X.
   592     05  FILLER                  PIC  X.
   593     05  W-PRINT-CERTIFICATE     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  12
* EL689.cbl
   594     05  FILLER                  PIC  X.
   595     05  W-REFUND-REQUIRED       PIC  X.
   596     05  FILLER                  PIC  X.
   597     05  W-ONBASE-CODE           PIC  XX.
   598     05  FILLER                  PIC  X.
   599     05  W-ACCT-SUMM             PIC  X.
   600     05  FILLER                  PIC  X.
   601     05  W-CSO-SUMM              PIC  X.
   602     05  FILLER                  PIC  X.
   603     05  W-REASONS-REQUIRED      PIC  X.
   604     05  FILLER                  PIC  X(29).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  13
* EL689.cbl
   606 01  W-SWITCH-INDICATORS-AREA.
   607     12  FILLER                  PIC  X(16)
   608                                      VALUE 'PROGRAM SWITCHS:'.
   609     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   610         88  W-ADDRESS-ONLY      VALUE 'Y'.
   611         88  W-FULL-DATA         VALUE ' '.
   612     12  W-ACCT-BROWSE-STARTED-SW
   613                                 PIC  X(01) VALUE 'N'.
   614         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   615     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   616     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   617         88  W-CERT-FOUND                   VALUE 'Y'.
   618     12  W-CHARACTER-TYPE        PIC  X(01).
   619         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   620         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   621         88  W-SPACE             VALUE ' '.
   622     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   623         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   624     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   625         88  W-DATA-SHRINKING    VALUE 'Y'.
   626     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   627         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   628     12  W-FIRST-BAD-VARIABLE-IND
   629                                 PIC  X(01) VALUE SPACES.
   630         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   631     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   632         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   633         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   634     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   635         88  W-FORM-CHANGED                 VALUE 'Y'.
   636     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   637         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   638         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   639     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   640         88  W-HOLD-ON                      VALUE 'Y'.
   641         88  W-HOLD-OFF                     VALUE ' '.
   642     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   643         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   644         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   645     12  W-KEY-FIELDS-CHANGED-IND
   646                                 PIC  X(01) VALUE ' '.
   647         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   648         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   649     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   650         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   651     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   652         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   653                                                   'T' 'U'.
   654         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   655                                                   'G' 'H'.
   656         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   657         88  W-DO-NOT-ADJUST                VALUE 'N'.
   658         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   659         88  W-AS-IS                        VALUE 'A' 'N'.
   660         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   661                                                   '4' '5'.
   662
   663     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  14
* EL689.cbl
   664         88  W-PNDB-FOUND                   VALUE 'Y'.
   665     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   666         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   667     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   668         88  W-REVERSE-DATE                 VALUE 'Y'.
   669     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   670         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   671         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   672
   673     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   674         88  W-VALID-ENDT                   VALUE 'Y'.
   675     12  W-RESPONSE              PIC S9(8)   COMP.
   676         88  RESP-NORMAL                  VALUE +00.
   677         88  RESP-NOTFND                  VALUE +13.
   678         88  RESP-DUPREC                  VALUE +14.
   679         88  RESP-DUPKEY                  VALUE +15.
   680         88  RESP-NOTOPEN                 VALUE +19.
   681         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  15
* EL689.cbl
   683 01  WS-SAVE-AREA.
   684     12  WS-SAV-AM-DEFN-1.
   685         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   686             20  WS-SAV-AM-AGT             PIC  X(10).
   687             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   688             20  FILLER                    PIC  X(15).
   689     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   690     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   691     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   692     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   693     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   694     12  WS-SAV-AM-NAME                    PIC  X(30).
   695     12  WS-SAV-AM-PERSON                  PIC  X(30).
   696     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   697     12  WS-SAV-AM-CITY                    PIC  X(30).
   698     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   699     12  WS-SAV-AM-ZIP.
   700         16  WS-SAV-AM-ZIP-PRIME.
   701             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   702                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   703                     'A' THRU 'Z'.
   704             20  FILLER                    PIC  X(04).
   705         16  FILLER                        PIC  X(04).
   706     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   707                        WS-SAV-AM-ZIP      PIC  X(09).
   708     12  WS-SAV-AM-TEL-NO.
   709         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   710         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   711         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   712 01  W-KEY-AREAS.
   713     12  FILLER                    PIC  X(13)
   714                                      VALUE 'PROGRAM KEYS:'.
   715
   716     12  W-ACCT-SAVE-KEY           PIC  X(20).
   717     12  W-ACCT-KEY.
   718         16  W-ACCT-PARTIAL-KEY.
   719             20  W-ACCT-COMPANY-CD PIC  X(01).
   720             20  W-ACCT-CARRIER    PIC  X(01).
   721             20  W-ACCT-GROUPING   PIC  X(06).
   722             20  W-ACCT-STATE      PIC  X(02).
   723             20  W-ACCT-ACCOUNT    PIC  X(10).
   724         16  W-ACCT-EXP-DT         PIC  X(02).
   725
   726     12  W-ARCH-SAVE-KEY         PIC  X(05).
   727     12  W-ARCH-KEY.
   728         16  W-ARCH-PARTIAL-KEY.
   729             20  W-ARCH-COMPANY-CD
   730                                 PIC  X(01).
   731             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   732         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   733
   734     12  W-ARCT-KEY.
   735         16  W-ARCT-PARTIAL-KEY.
   736             20  W-ARCT-COMPANY-CD
   737                                 PIC  X(01).
   738             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   739         16  W-ARCT-REC-TYPE     PIC  X(01).
   740         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  16
* EL689.cbl
   741
   742     12  W-CERT-KEY.
   743         16  W-CERT-COMPANY-CD   PIC  X(01).
   744         16  W-CERT-CARRIER      PIC  X(01).
   745         16  W-CERT-GROUPING     PIC  X(06).
   746         16  W-CERT-STATE        PIC  X(02).
   747         16  W-CERT-ACCOUNT      PIC  X(10).
   748         16  W-CERT-EFF-DT       PIC  X(02).
   749         16  W-CERT-CERT-NO.
   750             20  W-CERT-CERT-PRIME
   751                                 PIC  X(10).
   752             20  W-CERT-CERT-SFX PIC  X(01).
   753
   754     12  W-CHEK-KEY.
   755         16  W-CHEK-COMPANY-CD   PIC  X(01).
   756         16  W-CHEK-CARRIER      PIC  X(01).
   757         16  W-CHEK-GROUPING     PIC  X(06).
   758         16  W-CHEK-STATE        PIC  X(02).
   759         16  W-CHEK-ACCOUNT      PIC  X(10).
   760         16  W-CHEK-EFF-DT       PIC  X(02).
   761         16  W-CHEK-CERT-NO.
   762             20  W-CHEK-CERT-PRIME
   763                                 PIC  X(10).
   764             20  W-CHEK-CERT-SFX PIC  X(01).
   765         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   766
   767     12  W-CNTL-KEY.
   768         16  W-CNTL-COMPANY-ID   PIC  X(03).
   769         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   770         16  W-CNTL-GENL.
   771             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   772             20  W-CNTL-GEN2.
   773                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   774                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   775         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   776
   777     12  W-COMP-SAVE-KEY         PIC  X(29).
   778     12  W-COMP-KEY.
   779         16  W-COMP-COMPANY-CD   PIC  X(01).
   780         16  W-COMP-CARRIER      PIC  X(01).
   781         16  W-COMP-GROUPING     PIC  X(06).
   782         16  W-COMP-RESP-PERSON.
   783             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   784                                INDEXED BY W-COMP-NDX
   785                                 PIC  X(01).
   786         16  W-COMP-ACCOUNT      PIC  X(10).
   787         16  W-COMP-TYPE         PIC  X(01).
   788
   789     12  W-DELETE-KEY.
   790         16  W-DELETE-PARTIAL-KEY.
   791             20  W-DELETE-COMPANY-CD
   792                                 PIC  X(01).
   793             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   794         16  W-DELETE-RECORD-TYPE
   795                                 PIC  X(01).
   796         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   797
   798     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  17
* EL689.cbl
   799         16  W-MAIL-COMPANY-CD   PIC  X(01).
   800         16  W-MAIL-CARRIER      PIC  X(01).
   801         16  W-MAIL-GROUPING     PIC  X(06).
   802         16  W-MAIL-STATE        PIC  X(02).
   803         16  W-MAIL-ACCOUNT      PIC  X(10).
   804         16  W-MAIL-EFF-DT       PIC  X(02).
   805         16  W-MAIL-CERT-NO.
   806             20  W-MAIL-CERT-PRIME
   807                                 PIC  X(10).
   808             20  W-MAIL-CERT-SFX PIC  X(01).
   809
   810     12  W-PNDB-KEY.
   811         16  W-PNDB-COMPANY-CD   PIC  X(01).
   812         16  W-PNDB-ENTRY        PIC  X(06).
   813         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   814         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   815
   816     12  W-PNDB2-KEY.
   817         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   818         16  W-PNDB2-CARRIER     PIC  X(01).
   819         16  W-PNDB2-GROUPING    PIC  X(06).
   820         16  W-PNDB2-STATE       PIC  X(02).
   821         16  W-PNDB2-ACCOUNT     PIC  X(10).
   822         16  W-PNDB2-EFF-DT      PIC  X(02).
   823         16  W-PNDB2-CERT-NO.
   824             20  W-PNDB2-CERT-PRIME
   825                                 PIC  X(10).
   826             20  W-PNDB2-CERT-SFX
   827                                 PIC  X(01).
   828         16  W-PNDB2-ALT-CHG-SEQ-NO
   829                                 PIC S9(04)  COMP.
   830         16  W-PNDB2-TYPE        PIC  X(01).
   831
   832     12  W-PYAJ-KEY.
   833         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   834         16  W-PYAJ-CARRIER      PIC  X(01).
   835         16  W-PYAJ-GROUPING     PIC  X(06).
   836         16  W-PYAJ-FIN-RESP     PIC  X(10).
   837         16  W-PYAJ-ACCOUNT      PIC  X(10).
   838         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   839         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   840
   841     12  W-SC-QUID-KEY.
   842         16  W-SC-QUID-TERMINAL  PIC  X(04).
   843         16  W-SC-QUID-SYSTEM    PIC  X(04).
   844
   845     12  W-TEXT-SAVE-KEY         PIC  X(05).
   846     12  W-TEXT-KEY.
   847         16  W-TEXT-PARTIAL-KEY.
   848             20  W-TEXT-COMPANY-CD
   849                                 PIC  X(01).
   850             20  W-TEXT-LETTER   PIC  X(04).
   851         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   852         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   853
   854     12  W-ERENDT-KEY-BY-ARCH.
   855         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   856         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  18
* EL689.cbl
   857
   858     12  W-ELEOBC-KEY.
   859         16  W-EOBC-COMPANY-CD   PIC X.
   860         16  W-EOBC-REC-TYPE     PIC X.
   861         16  W-EOBC-CODE         PIC X(4).
   862         16  FILLER              PIC X(9).
   863     12  W-ERNOTE-KEY.
   864         16  W-NOTE-COMPANY-CD   PIC X.
   865         16  W-NOTE-CARRIER      PIC X.
   866         16  W-NOTE-GROUPING     PIC X(6).
   867         16  W-NOTE-STATE        PIC XX.
   868         16  W-NOTE-ACCOUNT      PIC X(10).
   869         16  W-NOTE-CERT-EFF-DT  PIC XX.
   870         16  W-NOTE-CERT-PRIME   PIC X(10).
   871         16  W-NOTE-CERT-SFX     PIC X.
   872     12  W-SAVE-KEY.
   873         16  W-SV-COMPANY-CD     PIC X.
   874         16  W-SV-CARRIER        PIC X.
   875         16  W-SV-GROUPING       PIC X(6).
   876         16  W-SV-STATE          PIC XX.
   877         16  W-SV-ACCOUNT        PIC X(10).
   878         16  W-SV-CERT-EFF-DT    PIC XX.
   879         16  W-SV-CERT-PRIME     PIC X(10).
   880         16  W-SV-CERT-SFX       PIC X.
   881     12  W-BILLING-NOTE.
   882         16  W-BN-NOTE           PIC X(25).
   883         16  W-BN-LTRID          PIC X(4).
   884         16  FILLER              PIC X(3).
   885         16  W-BN-DATE           PIC X(8).
   886         16  FILLER              PIC X(3).
   887         16  W-BN-USERID         PIC X(4).
   888         16  FILLER              PIC X(30).
   889     12  W-LEN                   PIC S9(5) COMP-3 VALUE +0.
   890     12  NOTE-SUB                PIC S9(5) COMP-3 VALUE +0.
   891     12  W-CERT-UPDATE-SW        PIC X  VALUE ' '.
   892         88  NO-CERT-RW                 VALUE 'N'.
   893         88  CERT-RW                    VALUE 'Y'.
   894
   895     12  W-ELENCC-KEY.
   896         16  W-ENCC-COMPANY-CD   PIC X.
   897         16  W-ENCC-REC-TYPE     PIC X.
   898         16  W-ENCC-ENC-CODE     PIC X(5).
   899         16  FILLER              PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  19
* EL689.cbl
   901 01  FILLER                      PIC  X(22)
   902                                 VALUE 'INTERFACE AREA STARTS:'.
   903*    COPY ELCINTF.
   904******************************************************************
   905*                                                                *
   906*                                                                *
   907*                            ELCINTF.                            *
   908*                            VMOD=2.017                          *
   909*                                                                *
   910*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   911*                                                                *
   912*       LENGTH = 1024                                            *
   913*                                                                *
   914******************************************************************
   915*                   C H A N G E   L O G
   916*
   917* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   918*-----------------------------------------------------------------
   919*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   920* EFFECTIVE    NUMBER
   921*-----------------------------------------------------------------
   922* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   923******************************************************************
   924 01  PROGRAM-INTERFACE-BLOCK.
   925     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   926     12  PI-CALLING-PROGRAM              PIC X(8).
   927     12  PI-SAVED-PROGRAM-1              PIC X(8).
   928     12  PI-SAVED-PROGRAM-2              PIC X(8).
   929     12  PI-SAVED-PROGRAM-3              PIC X(8).
   930     12  PI-SAVED-PROGRAM-4              PIC X(8).
   931     12  PI-SAVED-PROGRAM-5              PIC X(8).
   932     12  PI-SAVED-PROGRAM-6              PIC X(8).
   933     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   934     12  PI-COMPANY-ID                   PIC XXX.
   935     12  PI-COMPANY-CD                   PIC X.
   936
   937     12  PI-COMPANY-PASSWORD             PIC X(8).
   938
   939     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   940
   941     12  PI-CONTROL-IN-PROGRESS.
   942         16  PI-CARRIER                  PIC X.
   943         16  PI-GROUPING                 PIC X(6).
   944         16  PI-STATE                    PIC XX.
   945         16  PI-ACCOUNT                  PIC X(10).
   946         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   947                                         PIC X(10).
   948         16  PI-CLAIM-CERT-GRP.
   949             20  PI-CLAIM-NO             PIC X(7).
   950             20  PI-CERT-NO.
   951                 25  PI-CERT-PRIME       PIC X(10).
   952                 25  PI-CERT-SFX         PIC X.
   953             20  PI-CERT-EFF-DT          PIC XX.
   954         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   955             20  PI-PLAN-CODE            PIC X(2).
   956             20  PI-REVISION-NUMBER      PIC X(3).
   957             20  PI-PLAN-EFF-DT          PIC X(2).
   958             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  20
* EL689.cbl
   959             20  FILLER                  PIC X(11).
   960         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   961             20  PI-OE-REFERENCE-1.
   962                 25  PI-OE-REF-1-PRIME   PIC X(18).
   963                 25  PI-OE-REF-1-SUFF    PIC XX.
   964
   965     12  PI-SESSION-IN-PROGRESS          PIC X.
   966         88  CLAIM-SESSION                   VALUE '1'.
   967         88  CREDIT-SESSION                  VALUE '2'.
   968         88  WARRANTY-SESSION                VALUE '3'.
   969         88  MORTGAGE-SESSION                VALUE '4'.
   970         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   971
   972
   973*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   974
   975     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   976     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   977
   978     12  PI-CREDIT-USER                  PIC X.
   979         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   980         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   981
   982     12  PI-CLAIM-USER                   PIC X.
   983         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   984         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   985
   986     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   987         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   988         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   989         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   990         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   991         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   992
   993     12  PI-PROCESSOR-ID                 PIC X(4).
   994
   995     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   996
   997     12  PI-MEMBER-CAPTION               PIC X(10).
   998
   999     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1000         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1001
  1002     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1003     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1004     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1005     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1006
  1007     12  PI-AH-OVERRIDE-L1               PIC X.
  1008     12  PI-AH-OVERRIDE-L2               PIC XX.
  1009     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1010     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1011
  1012     12  PI-NEW-SYSTEM                   PIC X(2).
  1013
  1014     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1015     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1016         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  21
* EL689.cbl
  1017     12  PI-CRDTCRD-SYSTEM.
  1018         16  PI-CRDTCRD-USER             PIC X.
  1019             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1020             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1021         16  PI-CC-MONTH-END-DT          PIC XX.
  1022     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1023
  1024     12  PI-OE-REFERENCE-2.
  1025         16  PI-OE-REF-2-PRIME           PIC X(10).
  1026         16  PI-OE-REF-2-SUFF            PIC X.
  1027
  1028     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1029
  1030     12  PI-LANGUAGE-TYPE                PIC X.
  1031             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1032             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1033             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1034
  1035     12  PI-POLICY-LINKAGE-IND           PIC X.
  1036         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1037         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1038                                                   LOW-VALUES.
  1039
  1040     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1041     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1042         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1043         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1044
  1045     12  PI-PROCESSOR-CSR-IND            PIC X.
  1046         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1047         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1048
  1049     12  FILLER                          PIC X(3).
  1050
  1051     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1052
  1053     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1054         PI-SYSTEM-LEVEL.
  1055
  1056         16  PI-ENTRY-CODES.
  1057             20  PI-ENTRY-CD-1           PIC X.
  1058             20  PI-ENTRY-CD-2           PIC X.
  1059
  1060         16  PI-RETURN-CODES.
  1061             20  PI-RETURN-CD-1          PIC X.
  1062             20  PI-RETURN-CD-2          PIC X.
  1063
  1064         16  PI-UPDATE-STATUS-SAVE.
  1065             20  PI-UPDATE-BY            PIC X(4).
  1066             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1067
  1068         16  PI-LOWER-CASE-LETTERS       PIC X.
  1069             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1070
  1071*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1072*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1073*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1074
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  22
* EL689.cbl
  1075         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1076             88  ST-ACCNT-CNTL               VALUE ' '.
  1077             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1078             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1079             88  ACCNT-CNTL                  VALUE '3'.
  1080             88  CARR-ACCNT-CNTL             VALUE '4'.
  1081
  1082         16  PI-PROCESSOR-CAP-LIST.
  1083             20  PI-SYSTEM-CONTROLS.
  1084                24 PI-SYSTEM-DISPLAY     PIC X.
  1085                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1086                24 PI-SYSTEM-MODIFY      PIC X.
  1087                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1088             20  FILLER                  PIC XX.
  1089             20  PI-DISPLAY-CAP          PIC X.
  1090                 88  DISPLAY-CAP             VALUE 'Y'.
  1091             20  PI-MODIFY-CAP           PIC X.
  1092                 88  MODIFY-CAP              VALUE 'Y'.
  1093             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1094                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1095             20  PI-FORCE-CAP            PIC X.
  1096                 88  FORCE-CAP               VALUE 'Y'.
  1097
  1098         16  PI-PROGRAM-CONTROLS.
  1099             20  PI-PGM-PRINT-OPT        PIC X.
  1100             20  PI-PGM-FORMAT-OPT       PIC X.
  1101             20  PI-PGM-PROCESS-OPT      PIC X.
  1102             20  PI-PGM-TOTALS-OPT       PIC X.
  1103
  1104         16  PI-HELP-INTERFACE.
  1105             20  PI-LAST-ERROR-NO        PIC X(4).
  1106             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1107
  1108         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1109             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1110
  1111         16  PI-CR-CONTROL-IN-PROGRESS.
  1112             20  PI-CR-CARRIER           PIC X.
  1113             20  PI-CR-GROUPING          PIC X(6).
  1114             20  PI-CR-STATE             PIC XX.
  1115             20  PI-CR-ACCOUNT           PIC X(10).
  1116             20  PI-CR-FIN-RESP          PIC X(10).
  1117             20  PI-CR-TYPE              PIC X.
  1118
  1119         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1120
  1121         16  PI-CR-MONTH-END-DT          PIC XX.
  1122
  1123         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1124             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1125             88  PI-ZERO-CARRIER             VALUE '1'.
  1126             88  PI-ZERO-GROUPING            VALUE '2'.
  1127             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1128
  1129         16  PI-CARRIER-SECURITY         PIC X.
  1130             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1131
  1132         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  23
* EL689.cbl
  1133             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1134             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1135
  1136         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1137             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1138                                         INDEXED BY PI-ACCESS-NDX
  1139                                         PIC X.
  1140
  1141         16  PI-GA-BILLING-CONTROL       PIC X.
  1142             88  PI-GA-BILLING               VALUE '1'.
  1143
  1144         16  PI-MAIL-PROCESSING          PIC X.
  1145             88  PI-MAIL-YES                 VALUE 'Y'.
  1146
  1147         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1148
  1149         16  PI-AR-SYSTEM.
  1150             20  PI-AR-PROCESSING-CNTL   PIC X.
  1151                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1152             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1153             20  PI-AR-MONTH-END-DT      PIC XX.
  1154
  1155         16  PI-MP-SYSTEM.
  1156             20  PI-MORTGAGE-USER            PIC X.
  1157                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1158                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1159             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1160                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1161                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1162                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1163                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1164                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1165             20  PI-MP-MONTH-END-DT          PIC XX.
  1166             20  PI-MP-REFERENCE-NO.
  1167                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1168                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1169
  1170         16  PI-LABEL-CONTROL            PIC X(01).
  1171             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1172             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1173
  1174         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1175             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1176
  1177         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1178             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1179             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1180
  1181         16  FILLER                      PIC X(14).
  1182
  1183     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1184******************************************************************
  1185     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1186*    COPY ELC1042.
  1187******************************************************************
  1188*                                                                *
  1189*                                                                *
  1190*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  24
* EL689.cbl
  1191*                            VMOD=2.002                          *
  1192*                                                                *
  1193*    NOTE                                                        *
  1194*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1195*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1196*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1197*        TO THESE PROGRAMS.                                      *
  1198*                                                                *
  1199*    NOTE                                                        *
  1200*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1201*        USE ONLY!                                               *
  1202*                                                                *
  1203******************************************************************
  1204
  1205         16  PI-1042-WA.
  1206             20  PI-ACTION       PIC  X(01).
  1207                 88 PI-SHOW-MODE           VALUE '1'.
  1208                 88 PI-CLEAR-MODE          VALUE '2'.
  1209                 88 PI-CREATE-MODE         VALUE '3'.
  1210             20  PI-COMM-CONTROL PIC  X(12).
  1211             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1212             20  PI-EOF-SW       PIC  X(01).
  1213                 88  PI-FILE-EOF           VALUE 'Y'.
  1214             20  PI-FILETYP      PIC  X(01).
  1215             20  PI-FORM-SQUEEZE-CONTROL
  1216                                 PIC  X(01).
  1217                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1218                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1219             20  PI-LAST-CONTROL PIC  X(12).
  1220             20  PI-TEMP-STOR-ITEMS
  1221                                 PIC S9(04) COMP.
  1222             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1223             20  PI-UPDATE-SW    PIC  9(01).
  1224                 88 ANY-UPDATES            VALUE 1.
  1225             20  PI-104-SCREEN-SENT-IND
  1226                                 PIC  X(01).
  1227                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1228                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1229             20  PI-1042-SCREEN-SENT-IND
  1230                                 PIC  X(01).
  1231                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1232                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1233             20  PI-1042-ARCHIVE-IND
  1234                                 PIC  X(01).
  1235                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1236             20  FILLER          PIC  X(29).
  1237*    COPY ELC689PI.
  1238******************************************************************
  1239*                                                                *
  1240*                            ELC689PI                            *
  1241*                            VMOD=2.003                          *
  1242*                                                                *
  1243*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1244*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1245*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1246*                                                                *
  1247*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1248*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  25
* EL689.cbl
  1249*    BETWEEN PROGRAMS.                                           *
  1250*                                                                *
  1251*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1252*                                                                *
  1253*               EL631 - EL689  - EL6891 - EL6892                 *
  1254*                                                                *
  1255******************************************************************
  1256*                   C H A N G E   L O G
  1257*
  1258* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1259*-----------------------------------------------------------------
  1260*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1261* EFFECTIVE    NUMBER
  1262*-----------------------------------------------------------------
  1263* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1264* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1265* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1266******************************************************************
  1267
  1268
  1269         16  PI-689-WORK-AREA.
  1270             20  PI-689-ALT-PRINTER-ID
  1271                                 PIC  X(04).
  1272             20  PI-689-ARCHIVE-NUMBER
  1273                                 PIC  9(08).
  1274             20  PI-689-ARCHIVE-SW
  1275                                 PIC  X(01).
  1276                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1277             20  PI-689-DATA-SOURCE
  1278                                 PIC  X(01).
  1279                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1280                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1281                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1282                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1283                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1284             20  PI-689-ERROR-IND
  1285                                 PIC  X(01).
  1286                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1287             20  PI-689-ERROR    PIC  9(04).
  1288                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1289                 88  PI-689-FATAL-ERROR
  1290                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1291                            0042 0047 0051 0066 0067 0070
  1292                            0168 0169 0174 0175 0176 0177 0179
  1293                            0180 0181 0182 0184 0185 0189 0190
  1294                            0191
  1295                            0215 0279 0280
  1296                            0412 0413 0454
  1297                            0533 0537
  1298                            2055 2114 2208 2209 2216 2232 2369
  1299                            2398 2433 2908 2999
  1300                            3000 3770 3771 3775
  1301                            7250 7365 7367 7368 7369 7370 7371
  1302                            7272 7373 7374 7376 7377 7378 7379
  1303                            7381 7388 7390 7393 7395 7396 7398
  1304                            9095 9096 9281 9298 9299 9320 9327
  1305                            9426 9427.
  1306                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  26
* EL689.cbl
  1307                     VALUES 0004 0008 0013 0023 0029 0033
  1308                            0042 0047 0066 0067 0070
  1309                            0168 0169 0174 0175 0176 0177
  1310                            0181 0182 0184 0185 0189 0190
  1311                            0279 0280
  1312                            0412 0413 0454
  1313                            2055 2208 2209 2216 2232
  1314                            2398 2999
  1315                            3000 3770 3771 3775
  1316                            7250 7365 7369 7370 7371
  1317                            7272 7373 7374 7376 7377 7378 7379
  1318                            7381 7388 7390 7393 7396 7398
  1319                            9095 9096 9299 9320 9426.
  1320             20  PI-689-FOLLOW-UP-DATE
  1321                                 PIC  X(02).
  1322             20  PI-689-FORM-NUMBER
  1323                                 PIC  X(04).
  1324             20  PI-689-LABEL-SOURCE
  1325                                 PIC X(01).
  1326                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1327                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1328                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1329                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1330                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1331                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1332                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1333             20  PI-689-NUMBER-COPIES
  1334                                 PIC  9(01).
  1335             20  PI-689-NUMBER-LABEL-LINES
  1336                                 PIC  9(01).
  1337             20  PI-689-NUMBER-TEXT-RECORDS
  1338                                 PIC  9(03).
  1339             20  PI-689-PRINT-ORDER-SW
  1340                                 PIC  X(01).
  1341                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1342                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1343                 88  PI-689-PRINT-LATER     VALUE '3'.
  1344                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1345             20  PI-689-PRINT-RESTRICTION
  1346                                 PIC  X(01).
  1347                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1348                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1349                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1350             20  PI-689-PRINT-SW PIC  X(01).
  1351                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1352             20  PI-689-RESEND-DATE-1
  1353                                 PIC  X(02).
  1354             20  PI-689-RESEND-LETR-1
  1355                                 PIC X(4).
  1356             20  PI-689-TEMP-STOR-ID
  1357                                 PIC  X(08).
  1358             20  PI-689-USE-SCREEN-IND
  1359                                 PIC  X(01).
  1360                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1361             20  PI-689-ARCH-POINTER
  1362                                 PIC S9(08) COMP.
  1363                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1364             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  27
* EL689.cbl
  1365                                 PIC S9(08) COMP.
  1366                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1367             20  PI-689-VARIABLE-DATA-GRP.
  1368                 24  PI-689-VARIABLE-DATA-1
  1369                                 PIC  X(30).
  1370                 24  PI-689-VARIABLE-DATA-2
  1371                                 PIC  X(30).
  1372                 24  PI-689-VARIABLE-DATA-3
  1373                                 PIC  X(30).
  1374                 24  PI-689-VARIABLE-DATA-4
  1375                                 PIC  X(30).
  1376
  1377         16  PI-689-KEY-DATA-FIELDS.
  1378             20  PI-689-ACCOUNT  PIC  X(10).
  1379             20  PI-689-CARRIER  PIC  X(01).
  1380             20  PI-689-CERT-NO.
  1381                 24  PI-689-CERT-PRIME
  1382                                 PIC  X(10).
  1383                 24  PI-689-CERT-SFX
  1384                                 PIC  X(01).
  1385             20  PI-689-CHG-SEQ-NO
  1386                                 PIC S9(04)    COMP.
  1387             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1388                                 PIC  X(02).
  1389             20  PI-689-ENTRY-BATCH
  1390                                 PIC  X(06).
  1391             20  PI-689-EFF-DATE PIC  X(02).
  1392             20  PI-689-EXP-DATE PIC  X(02).
  1393             20  PI-689-GROUPING PIC  X(06).
  1394             20  PI-689-RESP-PERSON
  1395                                 PIC  X(10).
  1396             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1397             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1398                                 PIC  X(04).
  1399             20  PI-689-STATE    PIC  X(02).
  1400             20  PI-689-TYPE     PIC  X(01).
  1401             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1402             20  PI-689-ALT-SEQ-NO
  1403                                 PIC S9(04)    COMP.
  1404         16  PI-689-DATE-EDIT    PIC  X(08).
  1405         16  PI-689-FOLLOW-UP-EDIT
  1406                                 PIC  X(08).
  1407         16  PI-689-RESEND1-EDIT PIC  X(08).
  1408         16  PI-689-SEQ-EDIT     PIC  X(08).
  1409         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1410         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1411             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1412         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1413         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1414         16  PI-PROMPT-IND       PIC X(1).
  1415         16  PI-CERT-FORM-ID     PIC X(5).
  1416         16  PI-PRINT-NOW        PIC X(1).
  1417         16  PI-ENCLOSURE-CD     PIC X(3).
  1418         16  PI-CERT-REQ-IND     PIC X(1).
  1419         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1420         16  PI-REASON-REQ-IND   PIC X(1).
  1421         16  FILLER              PIC X(244).
  1422*        16  FILLER                        PIC X(276).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  28
* EL689.cbl
  1423*        16  FILLER                        PIC X(280).
  1424
  1425 01  FILLER                      PIC  X(20)
  1426                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  29
* EL689.cbl
  1428 01  FILLER                      PIC  X(16)
  1429                        VALUE 'MAP AREA STARTS:'.
  1430*    COPY EL689S.
  1431 01  EL689AI.
  1432     05  FILLER            PIC  X(0012).
  1433*    -------------------------------
  1434     05  RUNDTEL PIC S9(0004) COMP.
  1435     05  RUNDTEF PIC  X(0001).
  1436     05  FILLER REDEFINES RUNDTEF.
  1437         10  RUNDTEA PIC  X(0001).
  1438     05  RUNDTEI PIC  X(0008).
  1439*    -------------------------------
  1440     05  RUNTIMEL PIC S9(0004) COMP.
  1441     05  RUNTIMEF PIC  X(0001).
  1442     05  FILLER REDEFINES RUNTIMEF.
  1443         10  RUNTIMEA PIC  X(0001).
  1444     05  RUNTIMEI PIC  X(0005).
  1445*    -------------------------------
  1446     05  HOSTL PIC S9(0004) COMP.
  1447     05  HOSTF PIC  X(0001).
  1448     05  FILLER REDEFINES HOSTF.
  1449         10  HOSTA PIC  X(0001).
  1450     05  HOSTI PIC  X(0010).
  1451*    -------------------------------
  1452     05  SYSL PIC S9(0004) COMP.
  1453     05  SYSF PIC  X(0001).
  1454     05  FILLER REDEFINES SYSF.
  1455         10  SYSA PIC  X(0001).
  1456     05  SYSI PIC  X(0008).
  1457*    -------------------------------
  1458     05  COMPANYL PIC S9(0004) COMP.
  1459     05  COMPANYF PIC  X(0001).
  1460     05  FILLER REDEFINES COMPANYF.
  1461         10  COMPANYA PIC  X(0001).
  1462     05  COMPANYI PIC  X(0003).
  1463*    -------------------------------
  1464     05  USERIDL PIC S9(0004) COMP.
  1465     05  USERIDF PIC  X(0001).
  1466     05  FILLER REDEFINES USERIDF.
  1467         10  USERIDA PIC  X(0001).
  1468     05  USERIDI PIC  X(0004).
  1469*    -------------------------------
  1470     05  MAINTL PIC S9(0004) COMP.
  1471     05  MAINTF PIC  X(0001).
  1472     05  FILLER REDEFINES MAINTF.
  1473         10  MAINTA PIC  X(0001).
  1474     05  MAINTI PIC  X(0001).
  1475*    -------------------------------
  1476     05  FORML PIC S9(0004) COMP.
  1477     05  FORMF PIC  X(0001).
  1478     05  FILLER REDEFINES FORMF.
  1479         10  FORMA PIC  X(0001).
  1480     05  FORMI PIC  X(0004).
  1481*    -------------------------------
  1482     05  ARCHNUML PIC S9(0004) COMP.
  1483     05  ARCHNUMF PIC  X(0001).
  1484     05  FILLER REDEFINES ARCHNUMF.
  1485         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  30
* EL689.cbl
  1486     05  ARCHNUMI PIC  99999999.
  1487*    -------------------------------
  1488     05  PRTNOWL PIC S9(0004) COMP.
  1489     05  PRTNOWF PIC  X(0001).
  1490     05  FILLER REDEFINES PRTNOWF.
  1491         10  PRTNOWA PIC  X(0001).
  1492     05  PRTNOWI PIC  X(0001).
  1493*    -------------------------------
  1494     05  CARRIERL PIC S9(0004) COMP.
  1495     05  CARRIERF PIC  X(0001).
  1496     05  FILLER REDEFINES CARRIERF.
  1497         10  CARRIERA PIC  X(0001).
  1498     05  CARRIERI PIC  X(0001).
  1499*    -------------------------------
  1500     05  GROUPL PIC S9(0004) COMP.
  1501     05  GROUPF PIC  X(0001).
  1502     05  FILLER REDEFINES GROUPF.
  1503         10  GROUPA PIC  X(0001).
  1504     05  GROUPI PIC  X(0006).
  1505*    -------------------------------
  1506     05  STATEL PIC S9(0004) COMP.
  1507     05  STATEF PIC  X(0001).
  1508     05  FILLER REDEFINES STATEF.
  1509         10  STATEA PIC  X(0001).
  1510     05  STATEI PIC  X(0002).
  1511*    -------------------------------
  1512     05  ACCTL PIC S9(0004) COMP.
  1513     05  ACCTF PIC  X(0001).
  1514     05  FILLER REDEFINES ACCTF.
  1515         10  ACCTA PIC  X(0001).
  1516     05  ACCTI PIC  X(0010).
  1517*    -------------------------------
  1518     05  CERTL PIC S9(0004) COMP.
  1519     05  CERTF PIC  X(0001).
  1520     05  FILLER REDEFINES CERTF.
  1521         10  CERTA PIC  X(0001).
  1522     05  CERTI PIC  X(0010).
  1523*    -------------------------------
  1524     05  SFXL PIC S9(0004) COMP.
  1525     05  SFXF PIC  X(0001).
  1526     05  FILLER REDEFINES SFXF.
  1527         10  SFXA PIC  X(0001).
  1528     05  SFXI PIC  X(0001).
  1529*    -------------------------------
  1530     05  TYPEL PIC S9(0004) COMP.
  1531     05  TYPEF PIC  X(0001).
  1532     05  FILLER REDEFINES TYPEF.
  1533         10  TYPEA PIC  X(0001).
  1534     05  TYPEI PIC  X(0001).
  1535*    -------------------------------
  1536     05  DATEL PIC S9(0004) COMP.
  1537     05  DATEF PIC  X(0001).
  1538     05  FILLER REDEFINES DATEF.
  1539         10  DATEA PIC  X(0001).
  1540     05  DATEI PIC  X(0008).
  1541*    -------------------------------
  1542     05  FOLLOWL PIC S9(0004) COMP.
  1543     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  31
* EL689.cbl
  1544     05  FILLER REDEFINES FOLLOWF.
  1545         10  FOLLOWA PIC  X(0001).
  1546     05  FOLLOWI PIC  X(0008).
  1547*    -------------------------------
  1548     05  RESEND1L PIC S9(0004) COMP.
  1549     05  RESEND1F PIC  X(0001).
  1550     05  FILLER REDEFINES RESEND1F.
  1551         10  RESEND1A PIC  X(0001).
  1552     05  RESEND1I PIC  X(0008).
  1553*    -------------------------------
  1554     05  ENCL PIC S9(0004) COMP.
  1555     05  ENCF PIC  X(0001).
  1556     05  FILLER REDEFINES ENCF.
  1557         10  ENCA PIC  X(0001).
  1558     05  ENCI PIC  X(0003).
  1559*    -------------------------------
  1560     05  ENDARCHL PIC S9(0004) COMP.
  1561     05  ENDARCHF PIC  X(0001).
  1562     05  FILLER REDEFINES ENDARCHF.
  1563         10  ENDARCHA PIC  X(0001).
  1564     05  ENDARCHI PIC  99999999.
  1565*    -------------------------------
  1566     05  CERTIDL PIC S9(0004) COMP.
  1567     05  CERTIDF PIC  X(0001).
  1568     05  FILLER REDEFINES CERTIDF.
  1569         10  CERTIDA PIC  X(0001).
  1570     05  CERTIDI PIC  X(0005).
  1571*    -------------------------------
  1572     05  ADDRSL PIC S9(0004) COMP.
  1573     05  ADDRSF PIC  X(0001).
  1574     05  FILLER REDEFINES ADDRSF.
  1575         10  ADDRSA PIC  X(0001).
  1576     05  ADDRSI PIC  X(0001).
  1577*    -------------------------------
  1578     05  PRINTERL PIC S9(0004) COMP.
  1579     05  PRINTERF PIC  X(0001).
  1580     05  FILLER REDEFINES PRINTERF.
  1581         10  PRINTERA PIC  X(0001).
  1582     05  PRINTERI PIC  X(0004).
  1583*    -------------------------------
  1584     05  COPIESL PIC S9(0004) COMP.
  1585     05  COPIESF PIC  X(0001).
  1586     05  FILLER REDEFINES COPIESF.
  1587         10  COPIESA PIC  X(0001).
  1588     05  COPIESI PIC  X(0001).
  1589*    -------------------------------
  1590     05  DATASORL PIC S9(0004) COMP.
  1591     05  DATASORF PIC  X(0001).
  1592     05  FILLER REDEFINES DATASORF.
  1593         10  DATASORA PIC  X(0001).
  1594     05  DATASORI PIC  X(0001).
  1595*    -------------------------------
  1596     05  ADDRLBLL PIC S9(0004) COMP.
  1597     05  ADDRLBLF PIC  X(0001).
  1598     05  FILLER REDEFINES ADDRLBLF.
  1599         10  ADDRLBLA PIC  X(0001).
  1600     05  ADDRLBLI PIC  X(0001).
  1601*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  32
* EL689.cbl
  1602     05  RPERSONL PIC S9(0004) COMP.
  1603     05  RPERSONF PIC  X(0001).
  1604     05  FILLER REDEFINES RPERSONF.
  1605         10  RPERSONA PIC  X(0001).
  1606     05  RPERSONI PIC  X(0010).
  1607*    -------------------------------
  1608     05  BENTRYL PIC S9(0004) COMP.
  1609     05  BENTRYF PIC  X(0001).
  1610     05  FILLER REDEFINES BENTRYF.
  1611         10  BENTRYA PIC  X(0001).
  1612     05  BENTRYI PIC  X(0006).
  1613*    -------------------------------
  1614     05  SEQL PIC S9(0004) COMP.
  1615     05  SEQF PIC  X(0001).
  1616     05  FILLER REDEFINES SEQF.
  1617         10  SEQA PIC  X(0001).
  1618     05  SEQI PIC  X(0008).
  1619*    -------------------------------
  1620     05  BCSEQL PIC S9(0004) COMP.
  1621     05  BCSEQF PIC  X(0001).
  1622     05  FILLER REDEFINES BCSEQF.
  1623         10  BCSEQA PIC  X(0001).
  1624     05  BCSEQI PIC  X(0004).
  1625*    -------------------------------
  1626     05  L1L PIC S9(0004) COMP.
  1627     05  L1F PIC  X(0001).
  1628     05  FILLER REDEFINES L1F.
  1629         10  L1A PIC  X(0001).
  1630     05  L1I PIC  X(0003).
  1631*    -------------------------------
  1632     05  TEXT1L PIC S9(0004) COMP.
  1633     05  TEXT1F PIC  X(0001).
  1634     05  FILLER REDEFINES TEXT1F.
  1635         10  TEXT1A PIC  X(0001).
  1636     05  TEXT1I PIC  X(0070).
  1637*    -------------------------------
  1638     05  L2L PIC S9(0004) COMP.
  1639     05  L2F PIC  X(0001).
  1640     05  FILLER REDEFINES L2F.
  1641         10  L2A PIC  X(0001).
  1642     05  L2I PIC  X(0003).
  1643*    -------------------------------
  1644     05  TEXT2L PIC S9(0004) COMP.
  1645     05  TEXT2F PIC  X(0001).
  1646     05  FILLER REDEFINES TEXT2F.
  1647         10  TEXT2A PIC  X(0001).
  1648     05  TEXT2I PIC  X(0070).
  1649*    -------------------------------
  1650     05  L3L PIC S9(0004) COMP.
  1651     05  L3F PIC  X(0001).
  1652     05  FILLER REDEFINES L3F.
  1653         10  L3A PIC  X(0001).
  1654     05  L3I PIC  X(0003).
  1655*    -------------------------------
  1656     05  TEXT3L PIC S9(0004) COMP.
  1657     05  TEXT3F PIC  X(0001).
  1658     05  FILLER REDEFINES TEXT3F.
  1659         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  33
* EL689.cbl
  1660     05  TEXT3I PIC  X(0070).
  1661*    -------------------------------
  1662     05  L4L PIC S9(0004) COMP.
  1663     05  L4F PIC  X(0001).
  1664     05  FILLER REDEFINES L4F.
  1665         10  L4A PIC  X(0001).
  1666     05  L4I PIC  X(0003).
  1667*    -------------------------------
  1668     05  TEXT4L PIC S9(0004) COMP.
  1669     05  TEXT4F PIC  X(0001).
  1670     05  FILLER REDEFINES TEXT4F.
  1671         10  TEXT4A PIC  X(0001).
  1672     05  TEXT4I PIC  X(0070).
  1673*    -------------------------------
  1674     05  L5L PIC S9(0004) COMP.
  1675     05  L5F PIC  X(0001).
  1676     05  FILLER REDEFINES L5F.
  1677         10  L5A PIC  X(0001).
  1678     05  L5I PIC  X(0003).
  1679*    -------------------------------
  1680     05  TEXT5L PIC S9(0004) COMP.
  1681     05  TEXT5F PIC  X(0001).
  1682     05  FILLER REDEFINES TEXT5F.
  1683         10  TEXT5A PIC  X(0001).
  1684     05  TEXT5I PIC  X(0070).
  1685*    -------------------------------
  1686     05  L6L PIC S9(0004) COMP.
  1687     05  L6F PIC  X(0001).
  1688     05  FILLER REDEFINES L6F.
  1689         10  L6A PIC  X(0001).
  1690     05  L6I PIC  X(0003).
  1691*    -------------------------------
  1692     05  TEXT6L PIC S9(0004) COMP.
  1693     05  TEXT6F PIC  X(0001).
  1694     05  FILLER REDEFINES TEXT6F.
  1695         10  TEXT6A PIC  X(0001).
  1696     05  TEXT6I PIC  X(0070).
  1697*    -------------------------------
  1698     05  L7L PIC S9(0004) COMP.
  1699     05  L7F PIC  X(0001).
  1700     05  FILLER REDEFINES L7F.
  1701         10  L7A PIC  X(0001).
  1702     05  L7I PIC  X(0003).
  1703*    -------------------------------
  1704     05  TEXT7L PIC S9(0004) COMP.
  1705     05  TEXT7F PIC  X(0001).
  1706     05  FILLER REDEFINES TEXT7F.
  1707         10  TEXT7A PIC  X(0001).
  1708     05  TEXT7I PIC  X(0070).
  1709*    -------------------------------
  1710     05  L8L PIC S9(0004) COMP.
  1711     05  L8F PIC  X(0001).
  1712     05  FILLER REDEFINES L8F.
  1713         10  L8A PIC  X(0001).
  1714     05  L8I PIC  X(0003).
  1715*    -------------------------------
  1716     05  TEXT8L PIC S9(0004) COMP.
  1717     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  34
* EL689.cbl
  1718     05  FILLER REDEFINES TEXT8F.
  1719         10  TEXT8A PIC  X(0001).
  1720     05  TEXT8I PIC  X(0070).
  1721*    -------------------------------
  1722     05  L9L PIC S9(0004) COMP.
  1723     05  L9F PIC  X(0001).
  1724     05  FILLER REDEFINES L9F.
  1725         10  L9A PIC  X(0001).
  1726     05  L9I PIC  X(0003).
  1727*    -------------------------------
  1728     05  TEXT9L PIC S9(0004) COMP.
  1729     05  TEXT9F PIC  X(0001).
  1730     05  FILLER REDEFINES TEXT9F.
  1731         10  TEXT9A PIC  X(0001).
  1732     05  TEXT9I PIC  X(0070).
  1733*    -------------------------------
  1734     05  L10L PIC S9(0004) COMP.
  1735     05  L10F PIC  X(0001).
  1736     05  FILLER REDEFINES L10F.
  1737         10  L10A PIC  X(0001).
  1738     05  L10I PIC  X(0003).
  1739*    -------------------------------
  1740     05  TEXT10L PIC S9(0004) COMP.
  1741     05  TEXT10F PIC  X(0001).
  1742     05  FILLER REDEFINES TEXT10F.
  1743         10  TEXT10A PIC  X(0001).
  1744     05  TEXT10I PIC  X(0070).
  1745*    -------------------------------
  1746     05  L11L PIC S9(0004) COMP.
  1747     05  L11F PIC  X(0001).
  1748     05  FILLER REDEFINES L11F.
  1749         10  L11A PIC  X(0001).
  1750     05  L11I PIC  X(0003).
  1751*    -------------------------------
  1752     05  TEXT11L PIC S9(0004) COMP.
  1753     05  TEXT11F PIC  X(0001).
  1754     05  FILLER REDEFINES TEXT11F.
  1755         10  TEXT11A PIC  X(0001).
  1756     05  TEXT11I PIC  X(0070).
  1757*    -------------------------------
  1758     05  L12L PIC S9(0004) COMP.
  1759     05  L12F PIC  X(0001).
  1760     05  FILLER REDEFINES L12F.
  1761         10  L12A PIC  X(0001).
  1762     05  L12I PIC  X(0003).
  1763*    -------------------------------
  1764     05  TEXT12L PIC S9(0004) COMP.
  1765     05  TEXT12F PIC  X(0001).
  1766     05  FILLER REDEFINES TEXT12F.
  1767         10  TEXT12A PIC  X(0001).
  1768     05  TEXT12I PIC  X(0070).
  1769*    -------------------------------
  1770     05  ERRMSGL PIC S9(0004) COMP.
  1771     05  ERRMSGF PIC  X(0001).
  1772     05  FILLER REDEFINES ERRMSGF.
  1773         10  ERRMSGA PIC  X(0001).
  1774     05  ERRMSGI PIC  X(0079).
  1775*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  35
* EL689.cbl
  1776     05  ENTERPFL PIC S9(0004) COMP.
  1777     05  ENTERPFF PIC  X(0001).
  1778     05  FILLER REDEFINES ENTERPFF.
  1779         10  ENTERPFA PIC  X(0001).
  1780     05  ENTERPFI PIC  99.
  1781*    -------------------------------
  1782     05  PF8HDL PIC S9(0004) COMP.
  1783     05  PF8HDF PIC  X(0001).
  1784     05  FILLER REDEFINES PF8HDF.
  1785         10  PF8HDA PIC  X(0001).
  1786     05  PF8HDI PIC  X(0022).
  1787 01  EL689AO REDEFINES EL689AI.
  1788     05  FILLER            PIC  X(0012).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  RUNDTEO PIC  X(0008).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  RUNTIMEO PIC  99.99.
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  HOSTO PIC  X(0010).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  SYSO PIC  X(0008).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  COMPANYO PIC  X(0003).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  USERIDO PIC  X(0004).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  MAINTO PIC  X(0001).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  FORMO PIC  X(0004).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  ARCHNUMO PIC  99999999.
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  PRTNOWO PIC  X(0001).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  CARRIERO PIC  X(0001).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  GROUPO PIC  X(0006).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  STATEO PIC  X(0002).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  ACCTO PIC  X(0010).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  36
* EL689.cbl
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  SFXO PIC  X(0001).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  TYPEO PIC  X(0001).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  DATEO PIC  X(0008).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  FOLLOWO PIC  X(0008).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  RESEND1O PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  ENCO PIC  X(0003).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  ENDARCHO PIC  99999999.
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  CERTIDO PIC  X(0005).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  ADDRSO PIC  X(0001).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  PRINTERO PIC  X(0004).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  COPIESO PIC  X(0001).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  DATASORO PIC  X(0001).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  ADDRLBLO PIC  X(0001).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  RPERSONO PIC  X(0010).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  BENTRYO PIC  X(0006).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  SEQO PIC  X(0008).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  BCSEQO PIC  X(0004).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  L1O PIC  X(0003).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  TEXT1O PIC  X(0070).
  1891*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  37
* EL689.cbl
  1892     05  FILLER            PIC  X(0003).
  1893     05  L2O PIC  X(0003).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  TEXT2O PIC  X(0070).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  L3O PIC  X(0003).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  TEXT3O PIC  X(0070).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  L4O PIC  X(0003).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  TEXT4O PIC  X(0070).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  L5O PIC  X(0003).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  TEXT5O PIC  X(0070).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  L6O PIC  X(0003).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  TEXT6O PIC  X(0070).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  L7O PIC  X(0003).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  TEXT7O PIC  X(0070).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  L8O PIC  X(0003).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  TEXT8O PIC  X(0070).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  L9O PIC  X(0003).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  TEXT9O PIC  X(0070).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  L10O PIC  X(0003).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  TEXT10O PIC  X(0070).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  L11O PIC  X(0003).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  38
* EL689.cbl
  1950     05  TEXT11O PIC  X(0070).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  L12O PIC  X(0003).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  TEXT12O PIC  X(0070).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  ERRMSGO PIC  X(0079).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  ENTERPFO PIC  X(0002).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  PF8HDO PIC  X(0022).
  1966*    -------------------------------
  1967 01  W-MAP-REDEF REDEFINES EL689AI.
  1968*    12  FILLER                  PIC X(218).
  1969     12  FILLER                  PIC X(267).
  1970     12  EL689RI.
  1971         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1972             20  W-SC-LINEL      PIC S9(04) COMP.
  1973             20  W-SC-LINEA      PIC  X(01).
  1974             20  W-SC-LINE       PIC  X(03).
  1975             20  W-SC-TEXTL      PIC S9(04) COMP.
  1976             20  W-SC-TEXTA      PIC  X(01).
  1977             20  W-SC-TEXT       PIC  X(70).
  1978*    12  FILLER                  PIC  X(87).
  1979     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  39
* EL689.cbl
  1981 01  W-CONSTANT-AREA.
  1982     12  FILLER                  PIC  X(18)
  1983                                 VALUE 'PROGRAM CONSTANTS:'.
  1984     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1985     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1986     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1987     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1988     12  W-NOTE-LENGTH           PIC S9(04)  COMP  VALUE +825.
  1989     12  W-EOBC-LENGTH           PIC S9(04)  COMP  VALUE +350.
  1990     12  W-ENCC-LENGTH           PIC S9(04)  COMP  VALUE +400.
  1991     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1992     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1993     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1994     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1995     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1996     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1997
  1998     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  1999     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  2000     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  2001     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  2002     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  2003     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  2004     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  2005     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  2006     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  2007     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  2008     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  2009     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  2010     12  W-NOTE-FILE-ID          PIC  X(08) VALUE 'ERNOTE'.
  2011     12  W-EOBC-FILE-ID          PIC  X(08) VALUE 'ELEOBC'.
  2012     12  W-ENCC-FILE-ID          PIC  X(08) VALUE 'ELENCC'.
  2013     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  2014     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  2015     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  2016     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  2017     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  2018     12  W-LOWER-CASE            PIC  X(26)
  2019         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  2020     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  2021     12  W-MAP.
  2022         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  2023         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  2024         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  2025     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  2026     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  2027     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  2028     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  2029     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  2030     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  2031     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  2032
  2033     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  2034     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  2035     12  W-TOP-FORM              PIC  X(70)
  2036                              VALUE '*****TOP OF FORM *****'.
  2037     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  2038     12  W-UPPER-CASE            PIC  X(26)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  40
* EL689.cbl
  2039         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  2040     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  2041     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  2042     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  41
* EL689.cbl
  2044 01  W-VARIABLE-PROCESS-CNTLS.
  2045     12  FILLER                  PIC  X(26)
  2046                        VALUE 'VARIABLE WORK AREA STARTS:'.
  2047     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  2048     12  W-VAR-HOLD.
  2049         16  W-V1                PIC  X(01).
  2050         16  W-V2                PIC  X(01).
  2051         16  W-V3                PIC  X(01).
  2052     12  FILLER REDEFINES W-VAR-HOLD.
  2053         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  2054     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  2055         88  W-SQUEEZE-FIELD          VALUE '#'.
  2056
  2057 01  W-SUPPORTED-VARIABLES.
  2058
  2059*****************COMPANY VARIABLES - ELCNTL ********************
  2060*****COMPANY NAME
  2061     12  FILLER                  PIC  X(03) VALUE '001'.
  2062     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2063     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2064     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2065     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2066
  2067*****FULL COMPANY ADDRESS
  2068     12  FILLER                  PIC  X(03) VALUE '002'.
  2069     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2070     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2071     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2072     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2073
  2074     12  FILLER                  PIC  X(03) VALUE '003'.
  2075     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2076     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2077     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2078     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2079
  2080     12  FILLER                  PIC  X(03) VALUE '004'.
  2081     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2082     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2083     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2084     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2085
  2086     12  FILLER                  PIC  X(03) VALUE '005'.
  2087     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2088     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2089     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2090     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2091
  2092     12  FILLER                  PIC  X(03) VALUE '006'.
  2093     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2094     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2095     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2096     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2097
  2098*****REMAINING 4 ARE NOT CURRENTLY USED
  2099     12  FILLER                  PIC  X(03) VALUE '007'.
  2100     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2101     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  42
* EL689.cbl
  2102     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2103     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2104
  2105     12  FILLER                  PIC  X(03) VALUE '008'.
  2106     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2107     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2108     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2109     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2110
  2111     12  FILLER                  PIC  X(03) VALUE '009'.
  2112     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2113     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2114     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2115     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2116
  2117     12  FILLER                  PIC  X(03) VALUE '010'.
  2118     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2119     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2120     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2121     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2122
  2123************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  2124*****LIFE BENEFIT DESCRIPTION
  2125     12  FILLER                  PIC  X(03) VALUE '011'.
  2126     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2127     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2128     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2129     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2130
  2131*****REMAINING 3 ARE NOT CURRENTLY USED
  2132     12  FILLER                  PIC  X(03) VALUE '012'.
  2133     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2134     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2135     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2136     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2137
  2138     12  FILLER                  PIC  X(03) VALUE '013'.
  2139     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2140     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2141     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2142     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2143
  2144     12  FILLER                  PIC  X(03) VALUE '014'.
  2145     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2146     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2147     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2148     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2149
  2150************* A&H BENEFIT VARIABLES - ELCNTL *******************
  2151*****AH BENEFIT DESCRIPTION
  2152     12  FILLER                  PIC  X(03) VALUE '015'.
  2153     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2154     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2155     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2156     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2157
  2158*****ELIMINATION PERIOD
  2159     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  43
* EL689.cbl
  2160     12  FILLER                  PIC S9(04) COMP VALUE +2.
  2161     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2162     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2163     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2164
  2165*****REMAINING 3 ARE NOT CURRENTLY USED
  2166     12  FILLER                  PIC  X(03) VALUE '017'.
  2167     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2168     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2169     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2170     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2171
  2172     12  FILLER                  PIC  X(03) VALUE '018'.
  2173     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2174     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2175     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2176     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2177
  2178     12  FILLER                  PIC  X(03) VALUE '019'.
  2179     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2180     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2181     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2182     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2183
  2184*****************CARRIER VARIABLES - ELCNTL ********************
  2185*****CARRIER NAME
  2186     12  FILLER                  PIC  X(03) VALUE '020'.
  2187     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2188     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2189     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2190     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2191
  2192*****FULL CARRIER ADDRESS
  2193     12  FILLER                  PIC  X(03) VALUE '021'.
  2194     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2195     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2196     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2197     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2198
  2199     12  FILLER                  PIC  X(03) VALUE '022'.
  2200     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2201     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2202     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2203     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2204
  2205     12  FILLER                  PIC  X(03) VALUE '023'.
  2206     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2207     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2208     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2209     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2210
  2211     12  FILLER                  PIC  X(03) VALUE '024'.
  2212     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2213     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2214     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2215     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2216
  2217     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  44
* EL689.cbl
  2218     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2219     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2220     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2221     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2222
  2223*****CARRIER PHONE NUMBER
  2224     12  FILLER                  PIC  X(03) VALUE '026'.
  2225     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2226     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2227     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2228     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2229
  2230*****REMAINING 4 ARE NOT CURRENTLY USED
  2231     12  FILLER                  PIC  X(03) VALUE '027'.
  2232     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2233     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2234     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2235     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2236
  2237     12  FILLER                  PIC  X(03) VALUE '028'.
  2238     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2239     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2240     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2241     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2242
  2243     12  FILLER                  PIC  X(03) VALUE '029'.
  2244     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2245     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2246     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2247     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2248
  2249     12  FILLER                  PIC  X(03) VALUE '030'.
  2250     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2251     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2252     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2253     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2254
  2255***************** MAIL VARIABLES - ELMAIL **********************
  2256*****FULL MAIL ADDRESS
  2257     12  FILLER                  PIC  X(03) VALUE '031'.
  2258     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2259     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2260     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2261     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2262
  2263     12  FILLER                  PIC  X(03) VALUE '032'.
  2264     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2265     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2266     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2267     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2268
  2269     12  FILLER                  PIC  X(03) VALUE '033'.
  2270     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2271     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2272     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2273     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2274
  2275     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  45
* EL689.cbl
  2276     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2277     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2278     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2279     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2280
  2281     12  FILLER                  PIC  X(03) VALUE '035'.
  2282     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2283     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2284     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2285     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2286
  2287     12  FILLER                  PIC  X(03) VALUE '036'.
  2288     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2289     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2290     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2291     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2292**** CRED BENE NAME FROM ERMAIL
  2293     12  FILLER                  PIC  X(03) VALUE '037'.
  2294     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2295     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2296     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2297     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2298*****REMAINING 2 ARE NOT CURRENTLY USED
  2299     12  FILLER                  PIC  X(03) VALUE '038'.
  2300     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2301     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2302     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2303     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2304
  2305     12  FILLER                  PIC  X(03) VALUE '039'.
  2306     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2307     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2308     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2309     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2310
  2311*************** ACCOUNT VARIABLES - ERACCT *********************
  2312*****ACCOUNT NAME
  2313     12  FILLER                  PIC  X(03) VALUE '040'.
  2314     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2315     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2316     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2317     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2318
  2319*****FULL ACCOUNT ADDRESS
  2320     12  FILLER                  PIC  X(03) VALUE '041'.
  2321     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2322     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2323     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2324     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2325
  2326     12  FILLER                  PIC  X(03) VALUE '042'.
  2327     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2328     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2329     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2330     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2331
  2332     12  FILLER                  PIC  X(03) VALUE '043'.
  2333     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  46
* EL689.cbl
  2334     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2335     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2336     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2337
  2338     12  FILLER                  PIC  X(03) VALUE '044'.
  2339     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2340     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2341     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2342     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2343
  2344     12  FILLER                  PIC  X(03) VALUE '045'.
  2345     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2346     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2347     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2348     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2349
  2350*****ACCOUNT PHONE NUMBER
  2351     12  FILLER                  PIC  X(03) VALUE '046'.
  2352     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2353     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2354     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2355     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2356
  2357*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2358     12  FILLER                  PIC  X(03) VALUE '047'.
  2359     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2360     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2361     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2362     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2363
  2364****ACCOUNT CSR CODE
  2365     12  FILLER                  PIC  X(03) VALUE '048'.
  2366     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2367     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2368     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2369     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2370****ACCOUNT ACCOUNT NUMBER
  2371     12  FILLER                  PIC  X(03) VALUE '049'.
  2372     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2373     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2374     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2375     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2376
  2377**** CRED BENE ADDRESS LINE 1 ERMAIL
  2378     12  FILLER                  PIC  X(03) VALUE '050'.
  2379     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2380     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2381     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2382     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2383
  2384**** CRED BENE ADDRESS LINE 2 ERMAIL
  2385     12  FILLER                  PIC  X(03) VALUE '051'.
  2386     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2387     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2388     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2389     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2390
  2391**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  47
* EL689.cbl
  2392     12  FILLER                  PIC  X(03) VALUE '052'.
  2393     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2394     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2395     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2396     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2397
  2398**** CRED BENE ZIP  1 ERMAIL
  2399     12  FILLER                  PIC  X(03) VALUE '053'.
  2400     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2401     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2402     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2403     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2404
  2405*****REMAINING 6 ARE NOT CURRENTLY USED
  2406     12  FILLER                  PIC  X(03) VALUE '054'.
  2407     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2408     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2409     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2410     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2411
  2412     12  FILLER                  PIC  X(03) VALUE '055'.
  2413     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2414     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2415     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2416     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2417
  2418     12  FILLER                  PIC  X(03) VALUE '056'.
  2419     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2420     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2421     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2422     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2423
  2424     12  FILLER                  PIC  X(03) VALUE '057'.
  2425     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2426     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2427     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2428     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2429
  2430     12  FILLER                  PIC  X(03) VALUE '058'.
  2431     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2432     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2433     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2434     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2435
  2436     12  FILLER                  PIC  X(03) VALUE '059'.
  2437     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2438     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2439     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2440     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2441
  2442*************** NON FILE VARIABLES *****************************
  2443*****CURRENT DATE
  2444     12  FILLER                  PIC  X(03) VALUE '060'.
  2445     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2446     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2447     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2448     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2449
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  48
* EL689.cbl
  2450*****FULL CURRENT DATE
  2451     12  FILLER                  PIC  X(03) VALUE '061'.
  2452     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2453     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2454     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2455     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2456
  2457*****FORM
  2458     12  FILLER                  PIC  X(03) VALUE '062'.
  2459     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2460     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2461     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2462     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2463
  2464*****VARIABLE 1
  2465     12  FILLER                  PIC  X(03) VALUE '063'.
  2466     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2467     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2468     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2469     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2470
  2471*****VARIABLE 2
  2472     12  FILLER                  PIC  X(03) VALUE '064'.
  2473     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2474     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2475     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2476     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2477
  2478*****VARIABLE 3
  2479     12  FILLER                  PIC  X(03) VALUE '065'.
  2480     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2481     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2482     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2483     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2484
  2485*****VARIABLE 4
  2486     12  FILLER                  PIC  X(03) VALUE '066'.
  2487     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2488     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2489     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2490     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2491
  2492*****REMAINING 3 ARE NOT CURRENTLY USED
  2493     12  FILLER                  PIC  X(03) VALUE '067'.
  2494     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2495     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2496     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2497     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2498
  2499     12  FILLER                  PIC  X(03) VALUE '068'.
  2500     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2501     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2502     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2503     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2504
  2505     12  FILLER                  PIC  X(03) VALUE '069'.
  2506     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2507     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  49
* EL689.cbl
  2508     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2509     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2510
  2511************** CERTIFICATE VARIABLES - ELCERT *****************
  2512*****CARRIER CODE IN CERT
  2513     12  FILLER                  PIC  X(03) VALUE '070'.
  2514     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2515     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2516     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2517     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2518
  2519*****GROUPING CODE IN CERT
  2520     12  FILLER                  PIC  X(03) VALUE '071'.
  2521     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2522     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2523     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2524     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2525
  2526*****ACCOUNT NUMBER IN CERT
  2527     12  FILLER                  PIC  X(03) VALUE '072'.
  2528     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2529     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2530     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2531     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2532
  2533*****CERTIFICATE NUMBER
  2534     12  FILLER                  PIC  X(03) VALUE '073'.
  2535     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2536     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2537     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2538     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2539
  2540*****CERT EFFECTIVE DATE
  2541     12  FILLER                  PIC  X(03) VALUE '074'.
  2542     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2543     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2544     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2545     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2546
  2547*****CERT EXPIRATION DATE (LIFE)
  2548     12  FILLER                  PIC  X(03) VALUE '075'.
  2549     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2550     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2551     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2552     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2553
  2554*****CERT EXPIRATION DATE (AH)
  2555     12  FILLER                  PIC  X(03) VALUE '076'.
  2556     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2557     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2558     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2559     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2560
  2561*****LIFE TERM
  2562     12  FILLER                  PIC  X(03) VALUE '077'.
  2563     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2564     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2565     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  50
* EL689.cbl
  2566     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2567
  2568*****AH  TERM
  2569     12  FILLER                  PIC  X(03) VALUE '078'.
  2570     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2571     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2572     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2573     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2574
  2575*****LIFE COVERAGE AMOUNT
  2576     12  FILLER                  PIC  X(03) VALUE '079'.
  2577     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2578     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2579     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2580     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2581
  2582*****AH MONTHLY BENEFIT
  2583     12  FILLER                  PIC  X(03) VALUE '080'.
  2584     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2585     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2586     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2587     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2588
  2589*****LIFE CANCEL DATE
  2590     12  FILLER                  PIC  X(03) VALUE '081'.
  2591     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2592     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2593     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2594     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2595
  2596*****AH CANCEL DATE
  2597     12  FILLER                  PIC  X(03) VALUE '082'.
  2598     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2599     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2600     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2601     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2602
  2603*****LIFE COVERAGE FORM NUMBER
  2604     12  FILLER                  PIC  X(03) VALUE '083'.
  2605     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2606     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2607     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2608     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2609
  2610*****UNUSED
  2611     12  FILLER                  PIC  X(03) VALUE '084'.
  2612     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2613     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2614     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2615     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2616
  2617*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2618     12  FILLER                  PIC  X(03) VALUE '085'.
  2619     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2620     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2621     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2622     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2623
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  51
* EL689.cbl
  2624*****LOAN NUMBER
  2625     12  FILLER                  PIC  X(03) VALUE '086'.
  2626     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2627     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2628     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2629     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2630
  2631*****LOAN BALANCE
  2632     12  FILLER                  PIC  X(03) VALUE '087'.
  2633     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2634     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2635     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2636     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2637
  2638*****MEMBER NUMBER
  2639     12  FILLER                  PIC  X(03) VALUE '088'.
  2640     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2641     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2642     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2643     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2644
  2645*****INSURED SOC SEC NUMBER
  2646     12  FILLER                  PIC  X(03) VALUE '089'.
  2647     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2648     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2649     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2650     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2651
  2652*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2653     12  FILLER                  PIC  X(03) VALUE '090'.
  2654     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2655     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2656     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2657     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2658
  2659*****INSURED FIRST NAME (CERTIFICATE)
  2660     12  FILLER                  PIC  X(03) VALUE '091'.
  2661     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2662     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2663     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2664     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2665
  2666*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2667     12  FILLER                  PIC  X(03) VALUE '092'.
  2668     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2669     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2670     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2671     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2672
  2673*****ORIG TERM * MON BEN
  2674     12  FILLER                  PIC  X(03) VALUE '093'.
  2675     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2676     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2677     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2678     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2679
  2680*****INSURED'S NAME (LAST, FIRST, INIT)
  2681     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  52
* EL689.cbl
  2682     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2683     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2684     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2685     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2686
  2687*****INSURED'S NAME (FIRST, INIT, LAST)
  2688     12  FILLER                  PIC  X(03) VALUE  '095'.
  2689     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2690     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2691     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2692     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2693
  2694*****TITLE (MR/MS)
  2695     12  FILLER                  PIC  X(03) VALUE '096'.
  2696     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2697     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2698     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2699     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2700
  2701*****LIFE PREMIUM (CERTIFICATE)
  2702     12  FILLER                  PIC  X(03) VALUE '097'.
  2703     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2704     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2705     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2706     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2707
  2708*****A/H PREMIUM (CERTIFICATE)
  2709     12  FILLER                  PIC  X(03) VALUE '098'.
  2710     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2711     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2712     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2713     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2714
  2715*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2716     12  FILLER                  PIC  X(03) VALUE '099'.
  2717     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2718     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2719     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2720     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2721
  2722*****JOINT'S FIRST NAME (CERTIFICATE)
  2723     12  FILLER                  PIC  X(03) VALUE '100'.
  2724     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2725     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2726     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2727     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2728
  2729*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2730     12  FILLER                  PIC  X(03) VALUE '101'.
  2731     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2732     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2733     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2734     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2735
  2736*****JOINT'S NAME (LAST, FIRST, INIT)
  2737     12  FILLER                  PIC  X(03) VALUE '102'.
  2738     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2739     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  53
* EL689.cbl
  2740     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2741     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2742
  2743*****JOINT'S NAME (FIRST, INIT, LAST)
  2744     12  FILLER                  PIC  X(03) VALUE '103'.
  2745     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2746     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2747     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2748     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2749
  2750*****INSURED'S FIRST AND LAST NAME
  2751     12  FILLER                  PIC  X(03) VALUE '104'.
  2752     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2753     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2754     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2755     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2756
  2757*****JOINT'S FIRST AND LAST NAME
  2758     12  FILLER                  PIC  X(03) VALUE '105'.
  2759     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2760     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2761     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2762     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2763
  2764*****ENTERED LIFE REFUND (CERT)
  2765     12  FILLER                  PIC  X(03) VALUE '106'.
  2766     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2767     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2768     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2769     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2770
  2771*****ENTERED A/H REFUND (CERT)
  2772     12  FILLER                  PIC  X(03) VALUE '107'.
  2773     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2774     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2775     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2776     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2777
  2778*****INSURED'S LAST NAME
  2779     12  FILLER                  PIC  X(03) VALUE '108'.
  2780     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2781     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2782     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2783     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2784
  2785*****BENEFICIARY
  2786     12  FILLER                  PIC  X(03) VALUE  '109'.
  2787     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2788     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2789     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2790     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2791
  2792************** PENDING VARIABLES - ERPNDB *********************
  2793*****INSURED DATE OF BIRTH
  2794     12  FILLER                  PIC  X(03) VALUE '110'.
  2795     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2796     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2797     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  54
* EL689.cbl
  2798     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2799
  2800*****ENTERED LIFE PREMIUM (PENDING)
  2801     12  FILLER                  PIC  X(03) VALUE '111'.
  2802     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2803     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2804     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2805     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2806
  2807*****ENTERED A/H PREMIUM (PENDING)
  2808     12  FILLER                  PIC  X(03) VALUE '112'.
  2809     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2810     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2811     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2812     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2813
  2814*****CALCULATED LIFE PREMIUM (PENDING)
  2815     12  FILLER                  PIC  X(03) VALUE '113'.
  2816     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2817     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2818     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2819     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2820
  2821*****CALCULATED A/H PREMIUM (PENDING)
  2822     12  FILLER                  PIC  X(03) VALUE '114'.
  2823     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2824     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2825     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2826     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2827
  2828*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2829     12  FILLER                  PIC  X(03) VALUE '115'.
  2830     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2831     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2832     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2833     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2834
  2835*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2836     12  FILLER                  PIC  X(03) VALUE '116'.
  2837     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2838     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2839     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2840     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2841
  2842*****PRIOR CANCEL DATE
  2843     12  FILLER                  PIC  X(03) VALUE '117'.
  2844     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2845     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2846     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2847     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2848
  2849*****ENTERED LIFE REFUND (PENDING)
  2850     12  FILLER                  PIC  X(03) VALUE '118'.
  2851     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2852     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2853     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2854     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2855
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  55
* EL689.cbl
  2856*****ENTERED A/H REFUND (PENDING)
  2857     12  FILLER                  PIC  X(03) VALUE '119'.
  2858     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2859     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2860     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2861     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2862
  2863*****CALCULATED LIFE REFUND (PENDING)
  2864     12  FILLER                  PIC  X(03) VALUE '120'.
  2865     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2866     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2867     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2868     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2869
  2870*****CALCULATED A/H REFUND (PENDING)
  2871     12  FILLER                  PIC  X(03) VALUE '121'.
  2872     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2873     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2874     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2875     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2876
  2877*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2878     12  FILLER                  PIC  X(03) VALUE '122'.
  2879     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2880     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2881     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2882     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2883
  2884*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2885     12  FILLER                  PIC  X(03) VALUE '123'.
  2886     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2887     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2888     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2889     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2890
  2891*****INSUREDS AGE
  2892     12  FILLER                  PIC  X(03) VALUE '124'.
  2893     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2894     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2895     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2896     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2897
  2898*****LIFE BENEFIT (PENDING)
  2899     12  FILLER                  PIC  X(03) VALUE '125'.
  2900     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2901     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2902     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2903     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2904
  2905*****A/H BENEFIT (PENDING)
  2906     12  FILLER                  PIC  X(03) VALUE '126'.
  2907     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2908     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2909     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2910     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2911
  2912*****LIFE RATE
  2913     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  56
* EL689.cbl
  2914     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2915     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2916     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2917     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2918
  2919*****A/H RATE
  2920     12  FILLER                  PIC  X(03) VALUE '128'.
  2921     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2922     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2923     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2924     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2925
  2926*****TERM (PENDING)
  2927     12  FILLER                  PIC  X(03) VALUE '129'.
  2928     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2929     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2930     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2931     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2932
  2933*****BATCH NUMBER
  2934     12  FILLER                  PIC  X(03) VALUE '130'.
  2935     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2936     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2937     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2938     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2939
  2940*****TOTAL OF LIFE AND A&H REFUND
  2941     12  FILLER                  PIC  X(03) VALUE '131'.
  2942     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2943     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2944     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2945     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2946
  2947*****NH INTEREST ON REFUNDS
  2948     12  FILLER                  PIC  X(03) VALUE '132'.
  2949     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2950     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2951     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2952     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2953*****GREATER OF THE LIFE AND AH CANCEL DATE
  2954     12  FILLER                  PIC  X(03) VALUE '133'.
  2955     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2956     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2957     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2958     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2959
  2960*****THE NEXT 6 NOT CURRENTLY USED
  2961     12  FILLER                  PIC  X(03) VALUE '134'.
  2962     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2963     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2964     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2965     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2966
  2967     12  FILLER                  PIC  X(03) VALUE '135'.
  2968     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2969     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2970     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2971     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  57
* EL689.cbl
  2972
  2973     12  FILLER                  PIC  X(03) VALUE '136'.
  2974     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2975     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2976     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2977     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2978
  2979     12  FILLER                  PIC  X(03) VALUE '137'.
  2980     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2981     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2982     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2983     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2984
  2985     12  FILLER                  PIC  X(03) VALUE '138'.
  2986     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2987     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2988     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2989     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2990
  2991     12  FILLER                  PIC  X(03) VALUE '139'.
  2992     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2993     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2994     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2995     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2996
  2997************** COMPENSATION VARIABLES - ERCOMP ****************
  2998*****COMPENSATION ACCT NAME
  2999     12  FILLER                  PIC  X(03) VALUE '140'.
  3000     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3001     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3002     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3003     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3004
  3005*****FULL COMPENSATION ADDRESS TYPE 'A'
  3006     12  FILLER                  PIC  X(03) VALUE '141'.
  3007     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3008     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3009     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3010     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3011
  3012     12  FILLER                  PIC  X(03) VALUE '142'.
  3013     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3014     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3015     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3016     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3017
  3018     12  FILLER                  PIC  X(03) VALUE '143'.
  3019     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3020     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3021     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3022     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3023
  3024     12  FILLER                  PIC  X(03) VALUE '144'.
  3025     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3026     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3027     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3028     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3029
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  58
* EL689.cbl
  3030     12  FILLER                  PIC  X(03) VALUE '145'.
  3031     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3032     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3033     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3034     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3035
  3036     12  FILLER                  PIC  X(03) VALUE '146'.
  3037     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3038     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3039     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3040     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3041
  3042*****COMPENSATION PHONE NUMBER
  3043     12  FILLER                  PIC  X(03) VALUE '147'.
  3044     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3045     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3046     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3047     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3048
  3049*****COMPENSATION CSR NAME
  3050     12  FILLER                  PIC  X(03) VALUE '148'.
  3051     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3052     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3053     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3054     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3055
  3056*****COMPENSATION LAST STATEMENT DATE
  3057     12  FILLER                  PIC  X(03) VALUE '149'.
  3058     12  FILLER                  PIC S9(04) COMP VALUE +18.
  3059     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3060     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3061     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3062
  3063*****COMPENSATION ENDING BALANCE
  3064     12  FILLER                  PIC  X(03) VALUE '150'.
  3065     12  FILLER                  PIC S9(04) COMP VALUE +14.
  3066     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3067     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3068     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3069
  3070******************  PROCESSOR DATA - ELCNTL (2) ****************
  3071*****EXECUTING PROCESSOR NAME
  3072     12  FILLER                  PIC  X(03) VALUE '151'.
  3073     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3074     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3075     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3076     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3077
  3078*****PROCESSOR TITLE
  3079     12  FILLER                  PIC  X(03) VALUE '152'.
  3080     12  FILLER                  PIC S9(04) COMP VALUE +26.
  3081     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3082     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3083     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3084
  3085*****PROCESSOR
  3086     12  FILLER                  PIC  X(03) VALUE '153'.
  3087     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  59
* EL689.cbl
  3088     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3089     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3090     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3091
  3092*****CSR TITLE
  3093     12  FILLER                  PIC  X(03) VALUE '154'.
  3094     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3095     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3096     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3097     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3098*****REMAINING 2 ARE NOT CURRENTLY USED
  3099     12  FILLER                  PIC  X(03) VALUE '155'.
  3100     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3101     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3102     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3103     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3104
  3105     12  FILLER                  PIC  X(03) VALUE '156'.
  3106     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3107     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3108     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3109     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3110
  3111******************  CHECK DATA - ERCHEK    *********************
  3112*****CHECK AMOUNT
  3113     12  FILLER                  PIC  X(03) VALUE '157'.
  3114     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3115     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3116     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3117     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3118
  3119*****CHECK NUMBER
  3120     12  FILLER                  PIC  X(03) VALUE '158'.
  3121     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3122     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3123     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3124     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3125
  3126*****PAYEE 1 NAME
  3127     12  FILLER                  PIC  X(03) VALUE '159'.
  3128     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3129     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3130     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3131     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3132
  3133*****PAYEE 2 NAME
  3134     12  FILLER                  PIC  X(03) VALUE '160'.
  3135     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3136     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3137     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3138     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3139
  3140*****ADDRSS 1
  3141     12  FILLER                  PIC  X(03) VALUE '161'.
  3142     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3143     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3144     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3145     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  60
* EL689.cbl
  3146
  3147*****ADDRESS 2
  3148     12  FILLER                  PIC  X(03) VALUE '162'.
  3149     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3150     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3151     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3152     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3153
  3154*****PAYEE CITY STATE
  3155     12  FILLER                  PIC  X(03) VALUE '163'.
  3156     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3157     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3158     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3159     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3160
  3161*****ZIP CODE
  3162     12  FILLER                  PIC  X(03) VALUE '164'.
  3163     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3164     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3165     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3166     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3167
  3168*****CHECK CONTROL
  3169     12  FILLER                  PIC  X(03) VALUE '165'.
  3170     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3171     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3172     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3173     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3174
  3175*****REASON FOR CHECK
  3176     12  FILLER                  PIC  X(03) VALUE '166'.
  3177     12  FILLER                  PIC S9(04) COMP VALUE +25.
  3178     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3179     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3180     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3181
  3182*****REMAINING 3 ARE NOT CURRENTLY USED
  3183     12  FILLER                  PIC  X(03) VALUE '167'.
  3184     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3185     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3186     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3187     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3188
  3189     12  FILLER                  PIC  X(03) VALUE '168'.
  3190     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3191     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3192     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3193     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3194
  3195     12  FILLER                  PIC  X(03) VALUE '169'.
  3196     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3197     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3198     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3199     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3200
  3201
  3202*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3203*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  61
* EL689.cbl
  3204     12  FILLER                  PIC  X(03) VALUE '170'.
  3205     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3206     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3207     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3208     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3209
  3210*****CHECK NUMBER - PYAJ
  3211     12  FILLER                  PIC  X(03) VALUE '171'.
  3212     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3213     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3214     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3215     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3216
  3217*****CHECK CONTROL - PYAJ
  3218     12  FILLER                  PIC  X(03) VALUE '172'.
  3219     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3220     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3221     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3222     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3223
  3224***** COMMENT - PYAJ
  3225     12  FILLER                  PIC  X(03) VALUE '173'.
  3226     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3227     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3228     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3229     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3230
  3231*****NEW FIELDS.
  3232*****COMPENSATION FULL ADDRESS TYPE 'G'
  3233     12  FILLER                  PIC  X(03) VALUE '174'.
  3234     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3235     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3236     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3237     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3238
  3239     12  FILLER                  PIC  X(03) VALUE '175'.
  3240     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3241     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3242     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3243     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3244
  3245     12  FILLER                  PIC  X(03) VALUE '176'.
  3246     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3247     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3248     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3249     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3250
  3251     12  FILLER                  PIC  X(03) VALUE '177'.
  3252     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3253     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3254     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3255     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3256
  3257     12  FILLER                  PIC  X(03) VALUE '178'.
  3258     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3259     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3260     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3261     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  62
* EL689.cbl
  3262
  3263     12  FILLER                  PIC  X(03) VALUE '179'.
  3264     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3265     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3266     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3267     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3268
  3269*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3270     12  FILLER                  PIC  X(03) VALUE '180'.
  3271     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3272     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3273     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3274     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3275**** COMPENSATION BILLING SWITCH
  3276     12  FILLER                  PIC XXX    VALUE '181'.
  3277     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3278     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3279     12  FILLER                  PIC X      VALUE ALL 'N'.
  3280     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3281*****COMPENSATION FAX NUMBER
  3282     12  FILLER                  PIC  X(03) VALUE '182'.
  3283     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3284     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3285     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3286     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3287**** COMPENSATION STATUS
  3288     12  FILLER                  PIC XXX    VALUE '183'.
  3289     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3290     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3291     12  FILLER                  PIC X      VALUE ALL 'N'.
  3292     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3293***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3294*****COMPENSATION FULL ADDRESS TYPE 'B'
  3295     12  FILLER                  PIC  X(03) VALUE '184'.
  3296     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3297     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3298     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3299     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3300
  3301     12  FILLER                  PIC  X(03) VALUE '185'.
  3302     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3303     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3304     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3305     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3306
  3307     12  FILLER                  PIC  X(03) VALUE '186'.
  3308     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3309     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3310     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3311     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3312
  3313     12  FILLER                  PIC  X(03) VALUE '187'.
  3314     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3315     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3316     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3317     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3318
  3319     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  63
* EL689.cbl
  3320     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3321     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3322     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3323     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3324
  3325     12  FILLER                  PIC  X(03) VALUE '189'.
  3326     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3327     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3328     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3329     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3330
  3331
  3332 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3333*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3334     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3335                        INDEXED BY W-VG-NDX.
  3336         16  W-VARIABLE-ID         PIC  X(03).
  3337         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3338         16  W-VG-TEXT.
  3339             20  W-VAR-CHAR
  3340                        OCCURS 30 TIMES
  3341                        INDEXED BY W-VC-NDX
  3342                                   PIC  X(01).
  3343         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3344             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3345
  3346         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3347
  3348 01  W-VAR-END                   PIC  X(23)
  3349                        VALUE ':VARIABLE WORK AREA END'.
  3350
  3351 01  W-PROGRAM-TABLE-AREA.
  3352     12  FILLER                  PIC  X(15)
  3353                                 VALUE 'PROGRAM TABLES:'.
  3354
  3355     12  W-RECORD-TABLE              VALUE SPACES.
  3356         16  W-RC-GRP OCCURS 500 TIMES
  3357                       INDEXED BY W-RG-NDX
  3358                                  W-RG-NDX1.
  3359             20  W-RC-TEXT.
  3360                 24  W-RC-CHAR OCCURS 70 TIMES
  3361                                INDEXED BY W-RC-NDX
  3362                                           W-RC-NDX1
  3363                                 PIC  X(01).
  3364             20  W-RC-PC         PIC  9(02).
  3365             20  W-RC-SC         PIC  X(01).
  3366
  3367     12  FILLER REDEFINES W-RECORD-TABLE.
  3368         16  W-REC-CHAR OCCURS 36500 TIMES
  3369                        INDEXED BY W-RVS-NDX
  3370                                   W-RVS-NDX2
  3371                                 PIC  X(01).
  3372     12  FILLER REDEFINES W-RECORD-TABLE.
  3373         16  W-TS-GROUP OCCURS 10 TIMES
  3374                        INDEXED BY W-TS-NDX
  3375                                 PIC X(3650).
  3376
  3377     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  64
* EL689.cbl
  3378                                 VALUE 'TEXT TABLE:'.
  3379     12  W-TX-TABLE                  VALUE SPACES.
  3380         16  W-TX-GRP OCCURS 500 TIMES
  3381                       INDEXED BY W-TG-NDX
  3382                                  W-TG-NDX2.
  3383             20  W-TX-TEXT.
  3384                 24  W-TX-CHAR OCCURS 70 TIMES
  3385                                    INDEXED BY W-TX-NDX
  3386                                               W-TX-NDX1
  3387                                               W-TX-NDX2
  3388                                 PIC  X(01).
  3389             20  W-TX-PC         PIC  9(02).
  3390             20  W-TX-SC         PIC  X(01).
  3391
  3392     12  FILLER                  PIC  X(11)
  3393                                 VALUE 'FILE TABLE:'.
  3394     12  W-FILE-TABLE                VALUE SPACES.
  3395         16  W-FILE-USE-IND OCCURS 20 TIMES
  3396                       INDEXED BY W-FILE-NDX
  3397                                 PIC  X(01).
  3398             88  W-FILE-NOT-USED     VALUE SPACE.
  3399             88  W-FILE-USED         VALUE 'Y'.
  3400
  3401     12  FILLER                  PIC  X(14)
  3402                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  65
* EL689.cbl
  3404 01  ERROR-MESSAGES.
  3405     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3406     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3407     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3408     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3409     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3410     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3411     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3412     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3413     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3414     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3415     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3416     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3417     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3418     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3419     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3420     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3421     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3422     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3423     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3424     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3425     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3426     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3427     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3428     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3429     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3430     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3431     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3432     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3433     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3434     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3435     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3436     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3437     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3438     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3439     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3440     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3441     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3442     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3443     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3444     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3445     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3446     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3447     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3448     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3449     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3450     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3451     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3452     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3453     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3454     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3455     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3456     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3457     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3458     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3459     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3460     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3461     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  66
* EL689.cbl
  3462     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3463     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3464     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3465     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3466     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3467     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3468     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3469     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3470     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3471     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3472     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3473     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3474     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3475     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3476     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3477     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3478     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3479     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3480     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3481     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3482     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3483     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3484     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3485     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3486     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3487     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3488     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3489     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3490     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3491     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3492     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3493     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3494     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3495     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3496     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3497     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3498     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3499     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3500     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3501     12  ER-9427                 PIC  X(04) VALUE '9427'.
  3502     12  ER-9840                 PIC  X(04) VALUE '9840'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  67
* EL689.cbl
  3504*    COPY ELCAID.
  3505******************************************************************
  3506*                                                                *
  3507*                            ELCAID.                             *
  3508*                            VMOD=2.001                          *
  3509*                                                                *
  3510*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3511*                                                                *
  3512*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3513*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3514******************************************************************
  3515
  3516 01  DFHAID.
  3517   02  DFHNULL   PIC  X  VALUE  ' '.
  3518   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3519   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3520   02  DFHPEN    PIC  X  VALUE  '='.
  3521   02  DFHOPID   PIC  X  VALUE  'W'.
  3522   02  DFHPA1    PIC  X  VALUE  '%'.
  3523   02  DFHPA2    PIC  X  VALUE  '>'.
  3524   02  DFHPA3    PIC  X  VALUE  ','.
  3525   02  DFHPF1    PIC  X  VALUE  '1'.
  3526   02  DFHPF2    PIC  X  VALUE  '2'.
  3527   02  DFHPF3    PIC  X  VALUE  '3'.
  3528   02  DFHPF4    PIC  X  VALUE  '4'.
  3529   02  DFHPF5    PIC  X  VALUE  '5'.
  3530   02  DFHPF6    PIC  X  VALUE  '6'.
  3531   02  DFHPF7    PIC  X  VALUE  '7'.
  3532   02  DFHPF8    PIC  X  VALUE  '8'.
  3533   02  DFHPF9    PIC  X  VALUE  '9'.
  3534   02  DFHPF10   PIC  X  VALUE  ':'.
  3535   02  DFHPF11   PIC  X  VALUE  '#'.
  3536   02  DFHPF12   PIC  X  VALUE  '@'.
  3537   02  DFHPF13   PIC  X  VALUE  'A'.
  3538   02  DFHPF14   PIC  X  VALUE  'B'.
  3539   02  DFHPF15   PIC  X  VALUE  'C'.
  3540   02  DFHPF16   PIC  X  VALUE  'D'.
  3541   02  DFHPF17   PIC  X  VALUE  'E'.
  3542   02  DFHPF18   PIC  X  VALUE  'F'.
  3543   02  DFHPF19   PIC  X  VALUE  'G'.
  3544   02  DFHPF20   PIC  X  VALUE  'H'.
  3545   02  DFHPF21   PIC  X  VALUE  'I'.
  3546*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3547   02  DFHPF22   PIC  X  VALUE  '['.
  3548   02  DFHPF23   PIC  X  VALUE  '.'.
  3549   02  DFHPF24   PIC  X  VALUE  '<'.
  3550   02  DFHMSRE   PIC  X  VALUE  'X'.
  3551   02  DFHSTRF   PIC  X  VALUE  'h'.
  3552   02  DFHTRIG   PIC  X  VALUE  '"'.
  3553 01  FILLER    REDEFINES DFHAID.
  3554     12  FILLER                  PIC  X(08).
  3555     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  68
* EL689.cbl
  3557*    COPY ELCATTR.
  3558******************************************************************
  3559*                                                                *
  3560*                            ELCATTR.                            *
  3561*                            VMOD=2.001                          *
  3562*                                                                *
  3563*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3564*                                                                *
  3565*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3566*                                                                *
  3567*                   POS 1   P=PROTECTED                          *
  3568*                           U=UNPROTECTED                        *
  3569*                           S=ASKIP                              *
  3570*                   POS 2   A=ALPHA/NUMERIC                      *
  3571*                           N=NUMERIC                            *
  3572*                   POS 3   N=NORMAL                             *
  3573*                           B=BRIGHT                             *
  3574*                           D=DARK                               *
  3575*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3576*                           OF=MODIFIED DATA TAG OFF             *
  3577*                                                                *
  3578*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3579******************************************************************
  3580 01  ATTRIBUTE-LIST.
  3581     12  AL-PABOF            PIC X       VALUE 'Y'.
  3582     12  AL-PABON            PIC X       VALUE 'Z'.
  3583     12  AL-PADOF            PIC X       VALUE '%'.
  3584     12  AL-PADON            PIC X       VALUE '_'.
  3585     12  AL-PANOF            PIC X       VALUE '-'.
  3586     12  AL-PANON            PIC X       VALUE '/'.
  3587     12  AL-SABOF            PIC X       VALUE '8'.
  3588     12  AL-SABON            PIC X       VALUE '9'.
  3589     12  AL-SADOF            PIC X       VALUE '@'.
  3590     12  AL-SADON            PIC X       VALUE QUOTE.
  3591     12  AL-SANOF            PIC X       VALUE '0'.
  3592     12  AL-SANON            PIC X       VALUE '1'.
  3593     12  AL-UABOF            PIC X       VALUE 'H'.
  3594     12  AL-UABON            PIC X       VALUE 'I'.
  3595     12  AL-UADOF            PIC X       VALUE '<'.
  3596     12  AL-UADON            PIC X       VALUE '('.
  3597     12  AL-UANOF            PIC X       VALUE ' '.
  3598     12  AL-UANON            PIC X       VALUE 'A'.
  3599     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3600     12  AL-UNBON            PIC X       VALUE 'R'.
  3601     12  AL-UNDOF            PIC X       VALUE '*'.
  3602     12  AL-UNDON            PIC X       VALUE ')'.
  3603     12  AL-UNNOF            PIC X       VALUE '&'.
  3604     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  69
* EL689.cbl
  3606*    COPY ELCDATE.
  3607******************************************************************
  3608*                                                                *
  3609*                                                                *
  3610*                            ELCDATE.                            *
  3611*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3612*                            VMOD=2.003
  3613*                                                                *
  3614*                                                                *
  3615*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3616*                 LENGTH = 200                                   *
  3617******************************************************************
  3618
  3619 01  DATE-CONVERSION-DATA.
  3620     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3621     12  DC-OPTION-CODE                PIC X.
  3622         88  BIN-TO-GREG                VALUE ' '.
  3623         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3624         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3625         88  YMD-GREG-TO-BIN            VALUE '3'.
  3626         88  MDY-GREG-TO-BIN            VALUE '4'.
  3627         88  JULIAN-TO-BIN              VALUE '5'.
  3628         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3629         88  FIND-CENTURY               VALUE '7'.
  3630         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3631         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3632         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3633         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3634         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3635         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3636         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3637         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3638         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3639         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3640         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3641         88  BIN-3-TO-GREG              VALUE 'I'.
  3642         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3643         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3644         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3645         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3646         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3647         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3648         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3649         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3650         88  THREE-CHARACTER-BIN
  3651                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3652         88  GREGORIAN-TO-BIN
  3653                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3654         88  BIN-TO-GREGORIAN
  3655                  VALUES ' ' '1' 'I' '8' 'G'.
  3656         88  JULIAN-TO-BINARY
  3657                  VALUES '5' 'C' 'E' 'F'.
  3658     12  DC-ERROR-CODE                 PIC X.
  3659         88  NO-CONVERSION-ERROR        VALUE ' '.
  3660         88  DATE-CONVERSION-ERROR
  3661                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3662         88  DATE-IS-ZERO               VALUE '1'.
  3663         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  70
* EL689.cbl
  3664         88  DATE-IS-INVALID            VALUE '3'.
  3665         88  DATE1-GREATER-DATE2        VALUE '4'.
  3666         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3667         88  DATE-INVALID-OPTION        VALUE '9'.
  3668         88  INVALID-CENTURY            VALUE 'A'.
  3669         88  ONLY-CENTURY               VALUE 'B'.
  3670         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3671         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3672     12  DC-END-OF-MONTH               PIC X.
  3673         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3674     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3675         88  USE-NORMAL-PROCESS         VALUE ' '.
  3676         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3677         88  ADJUST-UP-100-YRS          VALUE '2'.
  3678     12  FILLER                        PIC X.
  3679     12  DC-CONVERSION-DATES.
  3680         16  DC-BIN-DATE-1             PIC XX.
  3681         16  DC-BIN-DATE-2             PIC XX.
  3682         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3683         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3684                       DC-GREG-DATE-1-EDIT.
  3685             20  DC-EDIT1-MONTH        PIC 99.
  3686             20  SLASH1-1              PIC X.
  3687             20  DC-EDIT1-DAY          PIC 99.
  3688             20  SLASH1-2              PIC X.
  3689             20  DC-EDIT1-YEAR         PIC 99.
  3690         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3691         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3692                     DC-GREG-DATE-2-EDIT.
  3693             20  DC-EDIT2-MONTH        PIC 99.
  3694             20  SLASH2-1              PIC X.
  3695             20  DC-EDIT2-DAY          PIC 99.
  3696             20  SLASH2-2              PIC X.
  3697             20  DC-EDIT2-YEAR         PIC 99.
  3698         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3699         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3700                     DC-GREG-DATE-1-YMD.
  3701             20  DC-YMD-YEAR           PIC 99.
  3702             20  DC-YMD-MONTH          PIC 99.
  3703             20  DC-YMD-DAY            PIC 99.
  3704         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3705         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3706                      DC-GREG-DATE-1-MDY.
  3707             20  DC-MDY-MONTH          PIC 99.
  3708             20  DC-MDY-DAY            PIC 99.
  3709             20  DC-MDY-YEAR           PIC 99.
  3710         16  DC-GREG-DATE-1-ALPHA.
  3711             20  DC-ALPHA-MONTH        PIC X(10).
  3712             20  DC-ALPHA-DAY          PIC 99.
  3713             20  FILLER                PIC XX.
  3714             20  DC-ALPHA-CENTURY.
  3715                 24 DC-ALPHA-CEN-N     PIC 99.
  3716             20  DC-ALPHA-YEAR         PIC 99.
  3717         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3718         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3719         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3720         16  DC-JULIAN-DATE            PIC 9(05).
  3721         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  71
* EL689.cbl
  3722                                       PIC 9(05).
  3723         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3724             20  DC-JULIAN-YEAR        PIC 99.
  3725             20  DC-JULIAN-DAYS        PIC 999.
  3726         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3727         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3728         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3729     12  DATE-CONVERSION-VARIBLES.
  3730         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3731         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3732             20  FILLER                PIC 9(3).
  3733             20  HOLD-CEN-1-CCYY.
  3734                 24  HOLD-CEN-1-CC     PIC 99.
  3735                 24  HOLD-CEN-1-YY     PIC 99.
  3736             20  HOLD-CEN-1-MO         PIC 99.
  3737             20  HOLD-CEN-1-DA         PIC 99.
  3738         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3739             20  HOLD-CEN-1-R-MO       PIC 99.
  3740             20  HOLD-CEN-1-R-DA       PIC 99.
  3741             20  HOLD-CEN-1-R-CCYY.
  3742                 24  HOLD-CEN-1-R-CC   PIC 99.
  3743                 24  HOLD-CEN-1-R-YY   PIC 99.
  3744             20  FILLER                PIC 9(3).
  3745         16  HOLD-CENTURY-1-X.
  3746             20  FILLER                PIC X(3)  VALUE SPACES.
  3747             20  HOLD-CEN-1-X-CCYY.
  3748                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3749                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3750             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3751             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3752         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3753             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3754             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3755             20  HOLD-CEN-1-R-X-CCYY.
  3756                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3757                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3758             20  FILLER                PIC XXX.
  3759         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3760         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3761         16  DC-JULIAN-DATE-1          PIC 9(07).
  3762         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3763             20  DC-JULIAN-1-CCYY.
  3764                 24  DC-JULIAN-1-CC    PIC 99.
  3765                 24  DC-JULIAN-1-YR    PIC 99.
  3766             20  DC-JULIAN-DA-1        PIC 999.
  3767         16  DC-JULIAN-DATE-2          PIC 9(07).
  3768         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3769             20  DC-JULIAN-2-CCYY.
  3770                 24  DC-JULIAN-2-CC    PIC 99.
  3771                 24  DC-JULIAN-2-YR    PIC 99.
  3772             20  DC-JULIAN-DA-2        PIC 999.
  3773         16  DC-GREG-DATE-A-EDIT.
  3774             20  DC-EDITA-MONTH        PIC 99.
  3775             20  SLASHA-1              PIC X VALUE '/'.
  3776             20  DC-EDITA-DAY          PIC 99.
  3777             20  SLASHA-2              PIC X VALUE '/'.
  3778             20  DC-EDITA-CCYY.
  3779                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  72
* EL689.cbl
  3780                 24  DC-EDITA-YEAR     PIC 99.
  3781         16  DC-GREG-DATE-B-EDIT.
  3782             20  DC-EDITB-MONTH        PIC 99.
  3783             20  SLASHB-1              PIC X VALUE '/'.
  3784             20  DC-EDITB-DAY          PIC 99.
  3785             20  SLASHB-2              PIC X VALUE '/'.
  3786             20  DC-EDITB-CCYY.
  3787                 24  DC-EDITB-CENT     PIC 99.
  3788                 24  DC-EDITB-YEAR     PIC 99.
  3789         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3790         16  DC-GREG-DATE-CYMD-R REDEFINES
  3791                              DC-GREG-DATE-CYMD.
  3792             20  DC-CYMD-CEN           PIC 99.
  3793             20  DC-CYMD-YEAR          PIC 99.
  3794             20  DC-CYMD-MONTH         PIC 99.
  3795             20  DC-CYMD-DAY           PIC 99.
  3796         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3797         16  DC-GREG-DATE-MDCY-R REDEFINES
  3798                              DC-GREG-DATE-MDCY.
  3799             20  DC-MDCY-MONTH         PIC 99.
  3800             20  DC-MDCY-DAY           PIC 99.
  3801             20  DC-MDCY-CEN           PIC 99.
  3802             20  DC-MDCY-YEAR          PIC 99.
  3803    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3804        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3805    12  DC-EL310-DATE                  PIC X(21).
  3806    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  73
* EL689.cbl
  3808*    COPY ELCNWA.
  3809*****************************************************************
  3810*                                                               *
  3811*                                                               *
  3812*                            ELCNWA.                            *
  3813*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3814*                            VMOD=2.003                         *
  3815*                                                               *
  3816*            M O V E   N A M E   W O R K   A R E A.             *
  3817*                                                               *
  3818*****************************************************************.
  3819
  3820 01  WS-NAME-WORK-AREA.
  3821     05  WS-INSURED-LAST-NAME        PIC X(15).
  3822     05  WS-INSURED-1ST-NAME         PIC X(12).
  3823     05  WS-INSURED-MID-INIT         PIC X.
  3824
  3825     05  WS-NAME-WORK.
  3826         10  WS-NW                   PIC X
  3827             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3828
  3829     05  WS-NAME-WORK2.
  3830         10  WS-NW2                  PIC X
  3831             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3832                                        NWA-INDEX0.
  3833
  3834     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3835                                     COMP-3.
  3836
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  74
* EL689.cbl
  3838*    COPY ELCEMIB.
  3839******************************************************************
  3840*                                                                *
  3841*                                                                *
  3842*                            ELCEMIB.                            *
  3843*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3844*                            VMOD=2.005                          *
  3845*                                                                *
  3846*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3847*                                                                *
  3848******************************************************************
  3849 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3850     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3851     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3852     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3853     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3854     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3855     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3856     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3857     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3858     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3859         88  EMI-NO-ERRORS                    VALUE '1'.
  3860         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3861         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3862     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3863         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3864     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3865         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3866         88  EMI-AREA1-FULL                   VALUE '2'.
  3867     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3868         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3869         88  EMI-AREA2-FULL                   VALUE '2'.
  3870     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3871         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3872         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3873         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3874         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3875         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3876     12  EMI-ERROR-LINES.
  3877         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3878         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3879         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3880         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3881             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3882                 24  EMI-ERR-NUM         PIC X(4).
  3883                 24  EMI-FILLER          PIC X.
  3884                 24  EMI-SEV             PIC X.
  3885                 24  FILLER              PIC X.
  3886             20  FILLER                  PIC X(02).
  3887     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3888         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3889             20  EMI-ERROR-NUMBER    PIC X(4).
  3890             20  EMI-FILL            PIC X.
  3891             20  EMI-SEVERITY        PIC X.
  3892             20  FILLER              PIC X.
  3893             20  EMI-ERROR-TEXT.
  3894                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3895                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  75
* EL689.cbl
  3896     12  EMI-SEVERITY-SAVE           PIC X.
  3897         88  EMI-NOTE                    VALUE 'N'.
  3898         88  EMI-WARNING                 VALUE 'W'.
  3899         88  EMI-FORCABLE                VALUE 'F'.
  3900         88  EMI-FATAL                   VALUE 'X'.
  3901     12  EMI-MESSAGE-FLAG            PIC X.
  3902         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3903         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3904     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3905     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3906         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3907         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3908         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3909     12  emi-claim-no                pic x(7).
  3910     12  emi-claim-type              pic x(6).
  3911     12  FILLER                      PIC X(124)  VALUE SPACES.
  3912     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3913     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3914     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3915     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3916 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  76
* EL689.cbl
  3918*    COPY ELCLOGOF.
  3919******************************************************************
  3920*                                                                *
  3921*                                                                *
  3922*                            ELCLOGOF.                           *
  3923*                            VMOD=2.001                          *
  3924*                                                                *
  3925*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3926*                                                                *
  3927******************************************************************
  3928 01  CLASIC-LOGOFF.
  3929     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3930     12  LOGOFF-TEXT.
  3931         16  FILLER          PIC X(5)    VALUE SPACES.
  3932         16  LOGOFF-MSG.
  3933             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3934             20  FILLER      PIC X       VALUE SPACES.
  3935             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3936         16  FILLER          PIC X(80)
  3937           VALUE '* YOU ARE NOW LOGGED OFF'.
  3938         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3939         16  FILLER          PIC X       VALUE QUOTE.
  3940         16  LOGOFF-SYS-MSG  PIC X(17)
  3941           VALUE 'S CLAS-IC SYSTEM '.
  3942     12  TEXT-MESSAGES.
  3943         16  UNACCESS-MSG    PIC X(29)
  3944             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3945         16  PGMIDERR-MSG    PIC X(17)
  3946             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  77
* EL689.cbl
  3948*    COPY ELCSCTM.
  3949******************************************************************
  3950*                                                                *
  3951*                                                                *
  3952*                            ELCSCTM                             *
  3953*                            VMOD=2.001                          *
  3954*                                                                *
  3955*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3956*                                                                *
  3957******************************************************************
  3958 01  SECURITY-MESSAGE.
  3959     12  FILLER                          PIC X(30)
  3960            VALUE '** LOGIC SECURITY VIOLATION -'.
  3961     12  SM-READ                         PIC X(6).
  3962     12  FILLER                          PIC X(5)
  3963            VALUE ' PGM='.
  3964     12  SM-PGM                          PIC X(6).
  3965     12  FILLER                          PIC X(5)
  3966            VALUE ' OPR='.
  3967     12  SM-PROCESSOR-ID                 PIC X(4).
  3968     12  FILLER                          PIC X(6)
  3969            VALUE ' TERM='.
  3970     12  SM-TERMID                       PIC X(4).
  3971     12  FILLER                          PIC XX   VALUE SPACE.
  3972     12  SM-JUL-DATE                     PIC 9(5).
  3973     12  FILLER                          PIC X    VALUE SPACE.
  3974     12  SM-TIME                         PIC 99.99.
  3975
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  78
* EL689.cbl
  3977*    COPY ELCSCRTY.
  3978******************************************************************
  3979*                                                                *
  3980*                                                                *
  3981*                            ELCSCRTY                            *
  3982*                            VMOD=2.001                          *
  3983*                                                                *
  3984*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3985*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3986*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3987*                                                                *
  3988******************************************************************
  3989 01  SECURITY-CONTROL.
  3990     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3991     12  FILLER                       PIC XX    VALUE 'SC'.
  3992     12  SC-CREDIT-CODES.
  3993         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3994             20  SC-CREDIT-DISPLAY    PIC X.
  3995             20  SC-CREDIT-UPDATE     PIC X.
  3996     12  SC-CLAIMS-CODES.
  3997         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3998             20  SC-CLAIMS-DISPLAY    PIC X.
  3999             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  79
* EL689.cbl
  4001
  4002 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  80
* EL689.cbl
  4004****************************************************************
  4005*
  4006* Copyright (c) 2007 by Clerity Solutions, Inc.
  4007* All rights reserved.
  4008*
  4009****************************************************************
  4010 01  DFHEIV.
  4011   02  DFHEIV0               PIC X(35).
  4012   02  DFHEIV1               PIC X(08).
  4013   02  DFHEIV2               PIC X(08).
  4014   02  DFHEIV3               PIC X(08).
  4015   02  DFHEIV4               PIC X(06).
  4016   02  DFHEIV5               PIC X(04).
  4017   02  DFHEIV6               PIC X(04).
  4018   02  DFHEIV7               PIC X(02).
  4019   02  DFHEIV8               PIC X(02).
  4020   02  DFHEIV9               PIC X(01).
  4021   02  DFHEIV10              PIC S9(7) COMP-3.
  4022   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4023   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4024   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4025   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4026   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4027   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4028   02  DFHEIV17              PIC X(04).
  4029   02  DFHEIV18              PIC X(04).
  4030   02  DFHEIV19              PIC X(04).
  4031   02  DFHEIV20              USAGE IS POINTER.
  4032   02  DFHEIV21              USAGE IS POINTER.
  4033   02  DFHEIV22              USAGE IS POINTER.
  4034   02  DFHEIV23              USAGE IS POINTER.
  4035   02  DFHEIV24              USAGE IS POINTER.
  4036   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4037   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4038   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4039   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4040   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4041   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4042   02  FILLER                PIC X(02).
  4043   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4044   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4045   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4046   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4047   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4048 LINKAGE  SECTION.
  4049*****************************************************************
  4050*                                                               *
  4051* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4052* All rights reserved.                                          *
  4053*                                                               *
  4054*****************************************************************
  4055 01  dfheiblk.
  4056     02  eibtime          pic s9(7) comp-3.
  4057     02  eibdate          pic s9(7) comp-3.
  4058     02  eibtrnid         pic x(4).
  4059     02  eibtaskn         pic s9(7) comp-3.
  4060     02  eibtrmid         pic x(4).
  4061     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  81
* EL689.cbl
  4062     02  eibcposn         pic s9(4) comp.
  4063     02  eibcalen         pic s9(4) comp.
  4064     02  eibaid           pic x(1).
  4065     02  eibfiller1       pic x(1).
  4066     02  eibfn            pic x(2).
  4067     02  eibfiller2       pic x(2).
  4068     02  eibrcode         pic x(6).
  4069     02  eibfiller3       pic x(2).
  4070     02  eibds            pic x(8).
  4071     02  eibreqid         pic x(8).
  4072     02  eibrsrce         pic x(8).
  4073     02  eibsync          pic x(1).
  4074     02  eibfree          pic x(1).
  4075     02  eibrecv          pic x(1).
  4076     02  eibsend          pic x(1).
  4077     02  eibatt           pic x(1).
  4078     02  eibeoc           pic x(1).
  4079     02  eibfmh           pic x(1).
  4080     02  eibcompl         pic x(1).
  4081     02  eibsig           pic x(1).
  4082     02  eibconf          pic x(1).
  4083     02  eiberr           pic x(1).
  4084     02  eibrldbk         pic x(1).
  4085     02  eiberrcd         pic x(4).
  4086     02  eibsynrb         pic x(1).
  4087     02  eibnodat         pic x(1).
  4088     02  eibfiller5       pic x(2).
  4089     02  eibresp          pic 9(09) comp.
  4090     02  eibresp2         pic 9(09) comp.
  4091     02  dfheigdj         pic s9(4) comp.
  4092     02  dfheigdk         pic s9(4) comp.
  4093 01  DFHCOMMAREA                 PIC X(1024).
  4094 01  var  pic x(30).
  4095
  4096*    COPY ERCACCT.
  4097******************************************************************
  4098*                                                                *
  4099*                                                                *
  4100*                            ERCACCT                             *
  4101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4102*                            VMOD=2.031                          *
  4103*                                                                *
  4104*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4105*                                                                *
  4106*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4107*   VSAM ACCOUNT MASTER FILES.                                   *
  4108*                                                                *
  4109*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4110*                                                                *
  4111*   FILE TYPE = VSAM,KSDS                                        *
  4112*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4113*                                                                *
  4114*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4115*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4116*                                                                *
  4117*   LOG = NO                                                     *
  4118*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4119*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  82
* EL689.cbl
  4120*                                                                *
  4121******************************************************************
  4122*                   C H A N G E   L O G
  4123*
  4124* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4125*-----------------------------------------------------------------
  4126*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4127* EFFECTIVE    NUMBER
  4128*-----------------------------------------------------------------
  4129* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4130* 092705    2005050300006  PEMA  ADD SPP LEASES
  4131* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4132* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4133* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4134* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4135* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4136******************************************************************
  4137
  4138 01  ACCOUNT-MASTER.
  4139     12  AM-RECORD-ID                      PIC XX.
  4140         88  VALID-AM-ID                      VALUE 'AM'.
  4141
  4142     12  AM-CONTROL-PRIMARY.
  4143         16  AM-COMPANY-CD                 PIC X.
  4144         16  AM-MSTR-CNTRL.
  4145             20  AM-CONTROL-A.
  4146                 24  AM-CARRIER            PIC X.
  4147                 24  AM-GROUPING.
  4148                     28 AM-GROUPING-PREFIX PIC XXX.
  4149                     28 AM-GROUPING-PRIME  PIC XXX.
  4150                 24  AM-STATE              PIC XX.
  4151                 24  AM-ACCOUNT.
  4152                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4153                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4154             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4155                                           PIC X(19).
  4156             20  AM-CNTRL-B.
  4157                 24  AM-EXPIRATION-DT      PIC XX.
  4158                 24  FILLER                PIC X(4).
  4159             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4160                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4161
  4162     12  AM-CONTROL-BY-VAR-GRP.
  4163         16  AM-COMPANY-CD-A1              PIC X.
  4164         16  AM-VG-CARRIER                 PIC X.
  4165         16  AM-VG-GROUPING                PIC X(6).
  4166         16  AM-VG-STATE                   PIC XX.
  4167         16  AM-VG-ACCOUNT                 PIC X(10).
  4168         16  AM-VG-DATE.
  4169             20  AM-VG-EXPIRATION-DT       PIC XX.
  4170             20  FILLER                    PIC X(4).
  4171         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4172                                           PIC 9(11)      COMP-3.
  4173     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4174         16  FILLER                        PIC X(10).
  4175         16  AM-VG-KEY3.
  4176             20  AM-VG3-ACCOUNT            PIC X(10).
  4177             20  AM-VG3-EXP-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  83
* EL689.cbl
  4178         16  FILLER                        PIC X(4).
  4179     12  AM-MAINT-INFORMATION.
  4180         16  AM-LAST-MAINT-DT              PIC XX.
  4181         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4182         16  AM-LAST-MAINT-USER            PIC X(4).
  4183         16  FILLER                        PIC XX.
  4184
  4185     12  AM-EFFECTIVE-DT                   PIC XX.
  4186     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4187
  4188     12  AM-PREV-DATES  COMP-3.
  4189         16  AM-PREV-EXP-DT                PIC 9(11).
  4190         16  AM-PREV-EFF-DT                PIC 9(11).
  4191
  4192     12  AM-REPORT-CODE-1                  PIC X(10).
  4193     12  AM-REPORT-CODE-2                  PIC X(10).
  4194
  4195     12  AM-CITY-CODE                      PIC X(4).
  4196     12  AM-COUNTY-PARISH                  PIC X(6).
  4197
  4198     12  AM-NAME                           PIC X(30).
  4199     12  AM-PERSON                         PIC X(30).
  4200     12  AM-ADDRS                          PIC X(30).
  4201     12  AM-CITY.
  4202         16  AM-ADDR-CITY                  PIC X(28).
  4203         16  AM-ADDR-STATE                 PIC XX.
  4204     12  AM-ZIP.
  4205         16  AM-ZIP-PRIME.
  4206             20  AM-ZIP-PRI-1ST            PIC X.
  4207                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4208             20  FILLER                    PIC X(4).
  4209         16  AM-ZIP-PLUS4                  PIC X(4).
  4210     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4211         16  AM-CAN-POSTAL-1               PIC XXX.
  4212         16  AM-CAN-POSTAL-2               PIC XXX.
  4213         16  FILLER                        PIC XXX.
  4214     12  AM-TEL-NO.
  4215         16  AM-AREA-CODE                  PIC 999.
  4216         16  AM-TEL-PRE                    PIC 999.
  4217         16  AM-TEL-NBR                    PIC 9(4).
  4218     12  AM-TEL-LOC                        PIC X.
  4219         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4220         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4221
  4222     12  AM-COMM-STRUCTURE.
  4223         16  AM-DEFN-1.
  4224             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4225                 24  AM-AGT.
  4226                     28  AM-AGT-PREFIX     PIC X(4).
  4227                     28  AM-AGT-PRIME      PIC X(6).
  4228                 24  AM-COM-TYP            PIC X.
  4229                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4230                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4231                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4232                 24  AM-RECALC-LV-INDIC    PIC X.
  4233                 24  AM-RETRO-LV-INDIC     PIC X.
  4234                 24  AM-GL-CODES           PIC X.
  4235                 24  AM-COMM-CHARGEBACK    PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  84
* EL689.cbl
  4236                 24  FILLER                PIC X(01).
  4237         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4238             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4239                 24  FILLER                PIC X(11).
  4240                 24  AM-L-COMA             PIC XXX.
  4241                 24  AM-J-COMA             PIC XXX.
  4242                 24  AM-A-COMA             PIC XXX.
  4243                 24  FILLER                PIC X(6).
  4244
  4245     12  AM-COMM-CHANGE-STATUS             PIC X.
  4246         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4247
  4248     12  AM-CSR-CODE                       PIC X(4).
  4249
  4250     12  AM-BILLING-STATUS                 PIC X.
  4251         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4252         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4253     12  AM-AUTO-REFUND-SW                 PIC X.
  4254         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4255         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4256     12  AM-GPCD                           PIC 99.
  4257     12  AM-IG                             PIC X.
  4258         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4259         88  AM-HAS-GROUP                     VALUE '2'.
  4260     12  AM-STATUS                         PIC X.
  4261         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4262         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4263         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4264         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4265         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4266         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4267     12  AM-REMIT-TO                       PIC 99.
  4268     12  AM-ID-NO                          PIC X(11).
  4269
  4270     12  AM-CAL-TABLE                      PIC XX.
  4271     12  AM-LF-DEVIATION                   PIC XXX.
  4272     12  AM-AH-DEVIATION                   PIC XXX.
  4273     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4274     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4275     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4276     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4277     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4278     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4279
  4280     12  AM-USER-FIELDS.
  4281         16  AM-FLD-1                      PIC XX.
  4282         16  AM-FLD-2                      PIC XX.
  4283         16  AM-FLD-3                      PIC XX.
  4284         16  AM-FLD-4                      PIC XX.
  4285         16  AM-FLD-5                      PIC XX.
  4286
  4287     12  AM-1ST-PROD-DATE.
  4288         16  AM-1ST-PROD-YR                PIC XX.
  4289         16  AM-1ST-PROD-MO                PIC XX.
  4290         16  AM-1ST-PROD-DA                PIC XX.
  4291     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4292     12  AM-CERTS-PURGED-DATE.
  4293         16  AM-PUR-YR                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  85
* EL689.cbl
  4294         16  AM-PUR-MO                     PIC XX.
  4295         16  AM-PUR-DA                     PIC XX.
  4296     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4297     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4298     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4299     12  AM-INACTIVE-DATE.
  4300         16  AM-INA-MO                     PIC 99.
  4301         16  AM-INA-DA                     PIC 99.
  4302         16  AM-INA-YR                     PIC 99.
  4303     12  AM-AR-HI-CERT-DATE                PIC XX.
  4304
  4305     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4306     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4307
  4308     12  AM-OB-PAYMENT-MODE                PIC X.
  4309         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4310         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4311         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4312         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4313
  4314     12  AM-AH-ONLY-INDICATOR              PIC X.
  4315         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4316         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4317
  4318     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4319
  4320     12  AM-OVER-SHORT.
  4321         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4322         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4323
  4324     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4325     12  AM-DCC-CLP-STATE                  PIC XX.
  4326
  4327     12  AM-RECALC-COMM                    PIC X.
  4328     12  AM-RECALC-REIN                    PIC X.
  4329
  4330     12  AM-REI-TABLE                      PIC XXX.
  4331     12  AM-REI-ET-LF                      PIC X.
  4332     12  AM-REI-ET-AH                      PIC X.
  4333     12  AM-REI-PE-LF                      PIC X.
  4334     12  AM-REI-PE-AH                      PIC X.
  4335     12  AM-REI-PRT-ST                     PIC X.
  4336     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4337     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4338     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4339     12  AM-REI-GROUP-A                    PIC X(6).
  4340     12  AM-REI-MORT                       PIC X(4).
  4341     12  AM-REI-PRT-OW                     PIC X.
  4342     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4343     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4344     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4345     12  AM-REI-GROUP-B                    PIC X(6).
  4346
  4347     12  AM-TRUST-TYPE                     PIC X(2).
  4348
  4349     12  AM-EMPLOYER-STMT-USED             PIC X.
  4350     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4351
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  86
* EL689.cbl
  4352     12  AM-STD-AH-TYPE                    PIC XX.
  4353     12  AM-EARN-METHODS.
  4354         16  AM-EARN-METHOD-R              PIC X.
  4355             88 AM-REF-RL-R78                 VALUE 'R'.
  4356             88 AM-REF-RL-PR                  VALUE 'P'.
  4357             88 AM-REF-RL-MEAN                VALUE 'M'.
  4358             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4359         16  AM-EARN-METHOD-L              PIC X.
  4360             88 AM-REF-LL-R78                 VALUE 'R'.
  4361             88 AM-REF-LL-PR                  VALUE 'P'.
  4362             88 AM-REF-LL-MEAN                VALUE 'M'.
  4363             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4364         16  AM-EARN-METHOD-A              PIC X.
  4365             88 AM-REF-AH-R78                 VALUE 'R'.
  4366             88 AM-REF-AH-PR                  VALUE 'P'.
  4367             88 AM-REF-AH-MEAN                VALUE 'M'.
  4368             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4369             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4370             88 AM-REF-AH-NET                 VALUE 'N'.
  4371
  4372     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4373     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4374     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4375
  4376     12  AM-RET-Y-N                        PIC X.
  4377     12  AM-RET-P-E                        PIC X.
  4378     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4379     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4380     12  AM-RET-GRP                        PIC X(6).
  4381     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4382         16  AM-POOL-PRIME                 PIC XXX.
  4383         16  AM-POOL-SUB                   PIC XXX.
  4384     12  AM-RETRO-EARNINGS.
  4385         16  AM-RET-EARN-R                 PIC X.
  4386         16  AM-RET-EARN-L                 PIC X.
  4387         16  AM-RET-EARN-A                 PIC X.
  4388     12  AM-RET-ST-TAX-USE                 PIC X.
  4389         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4390         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4391     12  AM-RETRO-BEG-EARNINGS.
  4392         16  AM-RET-BEG-EARN-R             PIC X.
  4393         16  AM-RET-BEG-EARN-L             PIC X.
  4394         16  AM-RET-BEG-EARN-A             PIC X.
  4395     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4396     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4397
  4398     12  AM-USER-SELECT-OPTIONS.
  4399         16  AM-USER-SELECT-1              PIC X(10).
  4400         16  AM-USER-SELECT-2              PIC X(10).
  4401         16  AM-USER-SELECT-3              PIC X(10).
  4402         16  AM-USER-SELECT-4              PIC X(10).
  4403         16  AM-USER-SELECT-5              PIC X(10).
  4404
  4405     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4406
  4407     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4408
  4409     12  AM-RPT045A-SWITCH                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  87
* EL689.cbl
  4410         88  RPT045A-OFF                   VALUE 'N'.
  4411
  4412     12  AM-INSURANCE-LIMITS.
  4413         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4414         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4415
  4416     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4417         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4418
  4419     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4420         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4421         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4422
  4423     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4424
  4425     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4426     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4427     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4428     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4429     12  AM-DCC-UEF-STATE                  PIC XX.
  4430     12  FILLER                            PIC XXX.
  4431     12  AM-REPORT-CODE-3                  PIC X(10).
  4432*    12  FILLER                            PIC X(22).
  4433
  4434     12  AM-RESERVE-DATE.
  4435         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4436         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4437         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4438
  4439     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4440     12  AM-NOTIFICATION-TYPES.
  4441         16  AM-NOTIF-OF-LETTERS           PIC X.
  4442         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4443         16  AM-NOTIF-OF-REPORTS           PIC X.
  4444         16  AM-NOTIF-OF-STATUS            PIC X.
  4445
  4446     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4447         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4448         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4449         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4450         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4451
  4452     12  AM-BENEFIT-CONTROLS.
  4453         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4454             20  AM-BENEFIT-CODE           PIC XX.
  4455             20  AM-BENEFIT-TYPE           PIC X.
  4456             20  AM-BENEFIT-REVISION       PIC XXX.
  4457             20  AM-BENEFIT-REM-TERM       PIC X.
  4458             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4459             20  FILLER                    PIC XX.
  4460         16  FILLER                        PIC X(80).
  4461
  4462     12  AM-TRANSFER-DATA.
  4463         16  AM-TRANSFERRED-FROM.
  4464             20  AM-TRNFROM-CARRIER        PIC X.
  4465             20  AM-TRNFROM-GROUPING.
  4466                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4467                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  88
* EL689.cbl
  4468             20  AM-TRNFROM-STATE          PIC XX.
  4469             20  AM-TRNFROM-ACCOUNT.
  4470                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4471                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4472             20  AM-TRNFROM-DTE            PIC XX.
  4473         16  AM-TRANSFERRED-TO.
  4474             20  AM-TRNTO-CARRIER          PIC X.
  4475             20  AM-TRNTO-GROUPING.
  4476                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4477                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4478             20  AM-TRNTO-STATE            PIC XX.
  4479             20  AM-TRNTO-ACCOUNT.
  4480                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4481                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4482             20  AM-TRNTO-DTE              PIC XX.
  4483         16  FILLER                        PIC X(10).
  4484
  4485     12  AM-SAVED-REMIT-TO                 PIC 99.
  4486
  4487     12  AM-COMM-STRUCTURE-SAVED.
  4488         16  AM-DEFN-1-SAVED.
  4489             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4490                 24  AM-AGT-SV             PIC X(10).
  4491                 24  AM-COM-TYP-SV         PIC X.
  4492                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4493                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4494                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4495                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4496                 24  FILLER                PIC X.
  4497                 24  AM-GL-CODES-SV        PIC X.
  4498                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4499                 24  FILLER                PIC X.
  4500         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4501             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4502                 24  FILLER                PIC X(11).
  4503                 24  AM-L-COMA-SV          PIC XXX.
  4504                 24  AM-J-COMA-SV          PIC XXX.
  4505                 24  AM-A-COMA-SV          PIC XXX.
  4506                 24  FILLER                PIC X(6).
  4507
  4508     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4509         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4510            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4511            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4512            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4513
  4514     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4515     12  FILLER                            PIC X(120).
  4516
  4517     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4518         16  AM-CONTROL-NAME               PIC X(30).
  4519         16  AM-EXECUTIVE-ONE.
  4520             20  AM-EXEC1-NAME             PIC X(15).
  4521             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4522                                                          COMP-3.
  4523             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4524                                                          COMP-3.
  4525         16  AM-EXECUTIVE-TWO.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  89
* EL689.cbl
  4526             20  AM-EXEC2-NAME             PIC X(15).
  4527             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4528                                                          COMP-3.
  4529             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4530                                                          COMP-3.
  4531
  4532     12  AM-RETRO-ADDITIONAL-DATA.
  4533         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4534         16  AM-RETRO-PREM-P-E             PIC X.
  4535         16  AM-RETRO-CLMS-P-I             PIC X.
  4536         16  AM-RETRO-RET-BRACKET-LF.
  4537             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4538                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4539                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4540             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4541                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4542                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4543             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4544                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4545                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4546         16  AM-RETRO-RET-BRACKET-AH.
  4547             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4548                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4549                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4550                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4551             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4552                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4553                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4554             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4555                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4556                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4557
  4558     12  AM-COMMENTS.
  4559         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4560
  4561     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4562         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4563         16  AM-FLI-BILLING-CODE           PIC X.
  4564         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4565         16  AM-FLI-UNITED-IDENT           PIC X.
  4566         16  AM-FLI-INTEREST-LOST-DATA.
  4567             20  AM-FLI-BANK-NO            PIC X(5).
  4568             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4569             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4570             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4571         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4572             20  AM-FLI-AGT                PIC X(9).
  4573             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4574             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4575         16  FILLER                        PIC X(102).
  4576
  4577     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4578         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4579             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4580             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4581             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4582             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4583             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  90
* EL689.cbl
  4584         16  FILLER                          PIC X(10).
  4585******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  91
* EL689.cbl
  4587*    COPY ERCARCH.
  4588******************************************************************
  4589*                                                                *
  4590*                            ERCARCH.                            *
  4591*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4592*                            VMOD=2.002                          *
  4593*                                                                *
  4594*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4595*                                                                *
  4596*   FILE TYPE = VSAM,KSDS                                        *
  4597*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4598*                                                                *
  4599*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4600*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4601*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4602*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4603*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4604*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4605*                                                                *
  4606*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4607******************************************************************
  4608*                   C H A N G E   L O G
  4609*
  4610* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4611*-----------------------------------------------------------------
  4612*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4613* EFFECTIVE    NUMBER
  4614*-----------------------------------------------------------------
  4615* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4616* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4617* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4618******************************************************************
  4619 01  LETTER-ARCHIVE.
  4620     12  LA-RECORD-ID                PIC  X(02).
  4621         88  LA-VALID-ID                VALUE 'LA'.
  4622
  4623     12  LA-CONTROL-PRIMARY.
  4624         16  LA-COMPANY-CD           PIC  X(01).
  4625         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4626
  4627     12  LA-CONTROL-BY-CERT-RESP.
  4628         16  LA-COMPANY-CD-A2        PIC  X(01).
  4629         16  LA-CERT-NO-A2.
  4630             20  LA-CERT-PRIME-A2    PIC  X(10).
  4631             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4632         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4633             20  LA-RESP-PERSON-A2   PIC  X(10).
  4634             20  LA-TYPE-A2          PIC  X(01).
  4635         16  LA-CARRIER-A2           PIC  X(01).
  4636         16  LA-GROUPING-A2          PIC  X(06).
  4637         16  LA-STATE-A2             PIC  X(02).
  4638         16  LA-ACCOUNT-A2           PIC  X(10).
  4639         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4640         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4641
  4642     12  LA-CONTROL-BY-FORM.
  4643         16  LA-COMPANY-CD-A3        PIC  X(01).
  4644         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  92
* EL689.cbl
  4645         16  LA-CARRIER-A3           PIC  X(01).
  4646         16  LA-GROUPING-A3          PIC  X(06).
  4647         16  LA-STATE-A3             PIC  X(02).
  4648         16  LA-ACCOUNT-A3           PIC  X(10).
  4649         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4650
  4651     12  LA-CONTROL-BY-PROCESSOR.
  4652         16  LA-COMPANY-CD-A4        PIC  X(01).
  4653         16  LA-PROCESSOR-CD         PIC  X(04).
  4654         16  LA-CARRIER-A4           PIC  X(01).
  4655         16  LA-GROUPING-A4          PIC  X(06).
  4656         16  LA-STATE-A4             PIC  X(02).
  4657         16  LA-ACCOUNT-A4           PIC  X(10).
  4658         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4659
  4660     12  LA-CONTROL-BY-KEY-FIELDS.
  4661         16  LA-COMPANY-CD-A5        PIC  X(01).
  4662         16  LA-CARRIER-A5           PIC  X(01).
  4663         16  LA-GROUPING-A5          PIC  X(06).
  4664         16  LA-STATE-A5             PIC  X(02).
  4665         16  LA-ACCOUNT-A5           PIC  X(10).
  4666         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4667
  4668     12  LA-CONTROL-BY-GROUP-CODE.
  4669         16  LA-COMPANY-CD-A6        PIC  X(01).
  4670         16  LA-ENTRY-A6.
  4671             20  LA-FILLER           PIC  X(02).
  4672             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4673         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4674
  4675     12  FILLER                      PIC  X(09).
  4676
  4677     12  LA-HEADER-RECORD.
  4678         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4679         16  LA-CREATION-DATE        PIC  X(02).
  4680         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4681         16  LA-FINAL-ACT-DATE       REDEFINES
  4682               LA-FOLLOW-UP-DATE     PIC  X(02).
  4683         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4684         16  LA-NO-OF-COPIES         PIC S9(01).
  4685         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4686         16  LA-REPLY-DATE           PIC  X(02).
  4687         16  LA-RESEND-DATES.
  4688             20  LA-RESEND-DATE      PIC  X(02).
  4689             20  LA-SENT-DATE        PIC  X(02).
  4690             20  FILLER              PIC  X(08).
  4691         16  LA-SOURCE-INFORMATION.
  4692             20  LA-DATA-SOURCE      PIC  X(01).
  4693             20  LA-ADDR-SOURCE      PIC  X(01).
  4694         16  LA-STATUS               PIC  X(01).
  4695             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4696             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4697             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4698             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4699             88  LA-STATUS-PURGED         VALUE 'P'.
  4700             88  LA-STATUS-VOIDED         VALUE 'V'.
  4701         16  LA-LAST-RESENT-PRINT-DATE
  4702                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  93
* EL689.cbl
  4703         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4704             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4705                                          VALUE 'C'.
  4706             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4707                                          VALUE 'F'.
  4708             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4709                                          VALUE 'P'.
  4710         16  LA-PURGED-DATE          PIC  X(02).
  4711         16  LA-VOIDED-DATE          PIC  X(02).
  4712         16  LA-RESEND-LETR          PIC  X(4).
  4713         16  FILLER                  PIC  X(08).
  4714*        16  LA-RESEND-LETR-2        PIC  X(4).
  4715*        16  LA-RESEND-LETR-3        PIC  X(4).
  4716*        16  FILLER                  PIC  X(59).
  4717         16  LA-ARCHIVE-STATUS       PIC  X.
  4718             88  LA-TEMP                VALUE 'T'.
  4719             88  LA-QWS                 VALUE 'Q'.
  4720             88  LA-BATCH               VALUE 'B'.
  4721         16  LA-FINAL-ACT-IND        PIC  X(1).
  4722         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4723         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4724         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4725                                     PIC X(4).
  4726         16  FILLER                  PIC  X(42).
  4727*        16  FILLER                  PIC  X(71).
  4728         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4729         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4730         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4731                                     PIC  X(4).
  4732         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4733
  4734******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  94
* EL689.cbl
  4736*    COPY ERCARCT.
  4737******************************************************************
  4738*                                                                *
  4739*                            ERCARCT.                            *
  4740*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4741*                            VMOD=2.002                          *
  4742*                                                                *
  4743*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4744*                                                                *
  4745*   FILE TYPE = VSAM,KSDS                                        *
  4746*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4747*                                                                *
  4748*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4749*                                                                *
  4750*   LOG = NO                                                     *
  4751*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4752******************************************************************
  4753*                   C H A N G E   L O G
  4754*
  4755* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4756*-----------------------------------------------------------------
  4757*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4758* EFFECTIVE    NUMBER
  4759*-----------------------------------------------------------------
  4760* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4761******************************************************************
  4762 01  LETTER-ARCHIVE-TEXT.
  4763     12  LT-RECORD-ID                PIC  X(02).
  4764         88  LT-VALID-ID                VALUE 'LT'.
  4765
  4766     12  LT-CONTROL-PRIMARY.
  4767         16  LT-COMPANY-CD           PIC  X(01).
  4768         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4769         16  LT-RECORD-TYPE          PIC  X(01).
  4770             88  LT-ADDRESS-DATA        VALUE '1'.
  4771             88  LT-TEXT-DATA           VALUE '2'.
  4772             88  LT-COMMENT-DATA        VALUE '3'.
  4773         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4774
  4775     12  FILLER                      PIC  X(28).
  4776     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4777
  4778     12  LT-TEXT-RECORD.
  4779         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4780                            INDEXED BY LT-NDX.
  4781             20  LT-TEXT-LINE        PIC  X(70).
  4782             20  LT-SKIP-CONTROL     PIC  X(02).
  4783                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4784                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4785             20  FILLER              PIC  X(08).
  4786
  4787     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4788         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4789             20  LT-COMMENT-LINE     PIC X(69).
  4790             20  LT-COMMENT-CHG-DT   PIC X(02).
  4791             20  LT-COMMENT-CHG-BY   PIC X(04).
  4792             20  FILLER              PIC X(05).
  4793
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  95
* EL689.cbl
  4795*    COPY ELCCERT.
  4796******************************************************************
  4797*                                                                *
  4798*                            ELCCERT.                            *
  4799*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4800*                            VMOD=2.013                          *
  4801*                                                                *
  4802*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4803*                                                                *
  4804*   FILE TYPE = VSAM,KSDS                                        *
  4805*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4806*                                                                *
  4807*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4808*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4809*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4810*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4811*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4812*                                                                *
  4813*   LOG = YES                                                    *
  4814*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4815******************************************************************
  4816*                   C H A N G E   L O G
  4817*
  4818* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4819*-----------------------------------------------------------------
  4820*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4821* EFFECTIVE    NUMBER
  4822*-----------------------------------------------------------------
  4823* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4824* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4825* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4826* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4827* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4828* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4829* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4830* 032612  CR2011110200001  PEMA  AHL CHANGES
  4831******************************************************************
  4832
  4833 01  CERTIFICATE-MASTER.
  4834     12  CM-RECORD-ID                      PIC XX.
  4835         88  VALID-CM-ID                      VALUE 'CM'.
  4836
  4837     12  CM-CONTROL-PRIMARY.
  4838         16  CM-COMPANY-CD                 PIC X.
  4839         16  CM-CARRIER                    PIC X.
  4840         16  CM-GROUPING.
  4841             20  CM-GROUPING-PREFIX        PIC X(3).
  4842             20  CM-GROUPING-PRIME         PIC X(3).
  4843         16  CM-STATE                      PIC XX.
  4844         16  CM-ACCOUNT.
  4845             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4846             20  CM-ACCOUNT-PRIME          PIC X(6).
  4847         16  CM-CERT-EFF-DT                PIC XX.
  4848         16  CM-CERT-NO.
  4849             20  CM-CERT-PRIME             PIC X(10).
  4850             20  CM-CERT-SFX               PIC X.
  4851
  4852     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  96
* EL689.cbl
  4853         16  CM-COMPANY-CD-A1              PIC X.
  4854         16  CM-INSURED-LAST-NAME          PIC X(15).
  4855         16  CM-INSURED-INITIALS.
  4856             20  CM-INSURED-INITIAL1       PIC X.
  4857             20  CM-INSURED-INITIAL2       PIC X.
  4858
  4859     12  CM-CONTROL-BY-SSN.
  4860         16  CM-COMPANY-CD-A2              PIC X.
  4861         16  CM-SOC-SEC-NO.
  4862             20  CM-SSN-STATE              PIC XX.
  4863             20  CM-SSN-ACCOUNT            PIC X(6).
  4864             20  CM-SSN-LN3.
  4865                 25  CM-INSURED-INITIALS-A2.
  4866                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4867                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4868                 25 CM-PART-LAST-NAME-A2         PIC X.
  4869
  4870     12  CM-CONTROL-BY-CERT-NO.
  4871         16  CM-COMPANY-CD-A4              PIC X.
  4872         16  CM-CERT-NO-A4                 PIC X(11).
  4873
  4874     12  CM-CONTROL-BY-MEMB.
  4875         16  CM-COMPANY-CD-A5              PIC X.
  4876         16  CM-MEMBER-NO.
  4877             20  CM-MEMB-STATE             PIC XX.
  4878             20  CM-MEMB-ACCOUNT           PIC X(6).
  4879             20  CM-MEMB-LN4.
  4880                 25  CM-INSURED-INITIALS-A5.
  4881                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4882                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4883                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4884
  4885     12  CM-INSURED-PROFILE-DATA.
  4886         16  CM-INSURED-FIRST-NAME.
  4887             20  CM-INSURED-1ST-INIT       PIC X.
  4888             20  FILLER                    PIC X(9).
  4889         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4890         16  CM-INSURED-SEX                PIC X.
  4891             88  CM-SEX-MALE                  VALUE 'M'.
  4892             88  CM-SEX-FEMAL                 VALUE 'F'.
  4893         16  CM-INSURED-JOINT-AGE          PIC 99.
  4894         16  CM-JOINT-INSURED-NAME.
  4895             20  CM-JT-LAST-NAME           PIC X(15).
  4896             20  CM-JT-FIRST-NAME.
  4897                 24  CM-JT-1ST-INIT        PIC X.
  4898                 24  FILLER                PIC X(9).
  4899             20  CM-JT-INITIAL             PIC X.
  4900
  4901     12  CM-LIFE-DATA.
  4902         16  CM-LF-BENEFIT-CD              PIC XX.
  4903         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4904         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4905         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4906         16  CM-LF-DEV-CODE                PIC XXX.
  4907         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4908         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4909         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4910         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  97
* EL689.cbl
  4911         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4912         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4913         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4914         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4915         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4916         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4917         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4918         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4919         16  FILLER                        PIC XX.
  4920
  4921     12  CM-AH-DATA.
  4922         16  CM-AH-BENEFIT-CD              PIC XX.
  4923         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4924         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4925         16  CM-AH-DEV-CODE                PIC XXX.
  4926         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4927         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4928         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4929         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4930         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4931         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4932         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4933         16  CM-AH-PAID-THRU-DT            PIC XX.
  4934             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4935         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4936         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4937         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4938         16  FILLER                        PIC X.
  4939
  4940     12  CM-LOAN-INFORMATION.
  4941         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4942         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4943                                           PIC S9(5)V99  COMP-3.
  4944         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4945         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4946         16  CM-PAY-FREQUENCY              PIC S99.
  4947         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4948         16  CM-RATE-CLASS                 PIC XX.
  4949         16  CM-BENEFICIARY                PIC X(25).
  4950         16  CM-POLICY-FORM-NO             PIC X(12).
  4951         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4952         16  CM-LAST-ADD-ON-DT             PIC XX.
  4953         16  CM-DEDUCTIBLE-AMOUNTS.
  4954             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4955             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4956         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4957             20  CM-RESIDENT-STATE         PIC XX.
  4958             20  CM-RATE-CODE              PIC X(4).
  4959             20  FILLER                    PIC XX.
  4960         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4961             20  CM-LOAN-OFFICER           PIC X(5).
  4962             20  FILLER                    PIC XXX.
  4963         16  CM-CSR-CODE                   PIC XXX.
  4964         16  CM-UNDERWRITING-CODE          PIC X.
  4965             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4966         16  CM-POST-CARD-IND              PIC X.
  4967         16  CM-NH-INTERFACE-SW            PIC X.
  4968         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  98
* EL689.cbl
  4969             88  CM-SING-PRM                  VALUE '1'.
  4970             88  CM-O-B-COVERAGE              VALUE '2'.
  4971             88  CM-OPEN-END                  VALUE '3'.
  4972         16  CM-IND-GRP-TYPE               PIC X.
  4973             88  CM-INDIVIDUAL                VALUE 'I'.
  4974             88  CM-GROUP                     VALUE 'G'.
  4975         16  CM-SKIP-CODE                  PIC X.
  4976             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4977             88  SKIP-JULY                    VALUE '1'.
  4978             88  SKIP-AUGUST                  VALUE '2'.
  4979             88  SKIP-SEPTEMBER               VALUE '3'.
  4980             88  SKIP-JULY-AUG                VALUE '4'.
  4981             88  SKIP-AUG-SEPT                VALUE '5'.
  4982             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4983             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4984             88  SKIP-JUNE                    VALUE '8'.
  4985             88  SKIP-JUNE-JULY               VALUE '9'.
  4986             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4987             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4988         16  CM-PAYMENT-MODE               PIC X.
  4989             88  PAY-MONTHLY                  VALUE SPACE.
  4990             88  PAY-WEEKLY                   VALUE '1'.
  4991             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4992             88  PAY-BI-WEEKLY                VALUE '3'.
  4993             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4994         16  CM-LOAN-NUMBER                PIC X(8).
  4995         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4996         16  CM-OLD-LOF                    PIC XXX.
  4997*        16  CM-LOAN-OFFICER               PIC XXX.
  4998         16  CM-REIN-TABLE                 PIC XXX.
  4999         16  CM-SPECIAL-REIN-CODE          PIC X.
  5000         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5001         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5002         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5003
  5004     12  CM-STATUS-DATA.
  5005         16  CM-ENTRY-STATUS               PIC X.
  5006         16  CM-ENTRY-DT                   PIC XX.
  5007
  5008         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5009         16  CM-LF-CANCEL-DT               PIC XX.
  5010         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5011
  5012         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5013         16  CM-LF-DEATH-DT                PIC XX.
  5014         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5015
  5016         16  CM-LF-CURRENT-STATUS          PIC X.
  5017             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5018                                                'M' '4' '5' '9'.
  5019             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5020             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5021             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5022             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5023             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5024             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5025             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5026             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page  99
* EL689.cbl
  5027             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5028             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5029             88  CM-LF-DECLINED               VALUE 'D'.
  5030             88  CM-LF-VOIDED                 VALUE 'V'.
  5031
  5032         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5033         16  CM-AH-CANCEL-DT               PIC XX.
  5034         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5035
  5036         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5037         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5038         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5039
  5040         16  CM-AH-CURRENT-STATUS          PIC X.
  5041             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5042                                                'M' '4' '5' '9'.
  5043             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5044             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5045             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5046             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5047             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5048             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5049             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5050             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5051             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5052             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5053             88  CM-AH-DECLINED               VALUE 'D'.
  5054             88  CM-AH-VOIDED                 VALUE 'V'.
  5055
  5056         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5057             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5058             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5059             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5060         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5061
  5062         16  CM-ENTRY-BATCH                PIC X(6).
  5063         16  CM-LF-EXIT-BATCH              PIC X(6).
  5064         16  CM-AH-EXIT-BATCH              PIC X(6).
  5065         16  CM-LAST-MONTH-END             PIC XX.
  5066
  5067     12  CM-NOTE-SW                        PIC X.
  5068         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5069         88  CERT-NOTES-PRESENT               VALUE '1'.
  5070         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5071         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5072         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5073         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5074         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5075         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5076     12  CM-COMP-EXCP-SW                   PIC X.
  5077         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5078         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5079     12  CM-INSURED-ADDRESS-SW             PIC X.
  5080         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5081         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5082
  5083*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5084     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 100
* EL689.cbl
  5085     12  FILLER                            PIC X.
  5086
  5087*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5088     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5089     12  FILLER                            PIC X.
  5090*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5091     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5092
  5093     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5094         88  CERT-ADDED-BATCH                 VALUE ' '.
  5095         88  CERT-ADDED-ONLINE                VALUE '1'.
  5096         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5097         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5098         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5099     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5100         88  CERT-AS-LOADED                   VALUE ' '.
  5101         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5102         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5103         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5104         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5105         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5106         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5107         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5108
  5109     12  CM-ACCOUNT-COMM-PCTS.
  5110         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5111         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5112
  5113     12  CM-USER-FIELD                     PIC X.
  5114     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5115     12  CM-CLP-STATE                      PIC XX.
  5116     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5117     12  CM-USER-RESERVED                  PIC XXX.
  5118     12  FILLER REDEFINES CM-USER-RESERVED.
  5119         16  CM-AH-CLASS-CD                PIC XX.
  5120         16  F                             PIC X.
  5121******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 101
* EL689.cbl
  5123*    COPY ERCCHEK.
  5124******************************************************************
  5125*                                                                *
  5126*                                                                *
  5127*                            ERCCHEK                             *
  5128*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5129*                            VMOD=2.008                          *
  5130*                                                                *
  5131*   FILE DESCRIPTION = CHECK RECORDS                             *
  5132*                                                                *
  5133*   FILE TYPE = VSAM,KSDS                                        *
  5134*   RECORD SIZE = 600    RECFORM = FIXED                         *
  5135*                                                                *
  5136*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  5137*       ALTERNATE INDEX = NONE                                   *
  5138*                                                                *
  5139*   LOG = YES                                                    *
  5140*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5141******************************************************************
  5142 01  CHECK-RECORDS.
  5143     12  CH-RECORD-ID                      PIC XX.
  5144         88  VALID-CH-ID                      VALUE 'CH'.
  5145
  5146     12  CH-CONTROL-PRIMARY.
  5147         16  CH-COMPANY-CD                 PIC X.
  5148         16  CH-CARRIER                    PIC X.
  5149         16  CH-GROUPING                   PIC X(6).
  5150         16  CH-STATE                      PIC XX.
  5151         16  CH-ACCOUNT                    PIC X(10).
  5152         16  CH-CERT-EFF-DT                PIC XX.
  5153         16  CH-CERT-NO.
  5154             20  CH-CERT-PRIME             PIC X(10).
  5155             20  CH-CERT-SFX               PIC X.
  5156         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  5157
  5158     12  CH-RECORDED-DT                    PIC XX.
  5159     12  CH-RECORDED-BY                    PIC X(4).
  5160     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  5161
  5162     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  5163     12  CH-CHECK-NO                       PIC X(7).
  5164     12  CH-REASON-FOR-CHECK               PIC X(25).
  5165     12  CH-CHECK-WRITTEN-DT               PIC XX.
  5166     12  CH-OFFLINE-CHECK-IND              PIC X.
  5167         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  5168
  5169     12  CH-PAYEE-INFO.
  5170         16  CH-PAYEE-NAME-1               PIC X(30).
  5171         16  CH-PAYEE-NAME-2               PIC X(30).
  5172         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  5173         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  5174         16  CH-PAYEE-CITY-ST              PIC X(30).
  5175         16  CH-PAYEE-ZIP-CODE.
  5176             20  CH-PAYEE-ZIP.
  5177                 24  CH-ZIP-PRI-1ST        PIC X.
  5178                     88  CH-CANADIAN-POST-CODE
  5179                                           VALUES 'A' THRU 'Z'.
  5180                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 102
* EL689.cbl
  5181             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  5182         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  5183             20  CH-CAN-POSTAL-1           PIC XXX.
  5184             20  CH-CAN-POSTAL-2           PIC XXX.
  5185             20  FILLER                    PIC XXX.
  5186
  5187     12  CH-CHECK-STUB-TEXT.
  5188         16  CH-STUB-LINE-1                PIC X(50).
  5189         16  CH-STUB-LINE-2                PIC X(50).
  5190         16  CH-STUB-LINE-3                PIC X(50).
  5191         16  FILLER.
  5192           18  CH-STUB-LINE-4              PIC X(20).
  5193           18  CH-LIENHOLDER-NAME          PIC X(30).
  5194
  5195     12  CH-COMPENSATION-CONTROL.
  5196         16  CH-COMP-CARRIER               PIC X.
  5197         16  CH-COMP-GROUPING              PIC X(6).
  5198         16  CH-COMP-FIN-RESP              PIC X(10).
  5199         16  CH-COMP-ACCOUNT               PIC X(10).
  5200
  5201     12  CH-CREDIT-SELECT-DT               PIC XX.
  5202     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5203     12  CH-PAYEE-CODE                     PIC X(6).
  5204
  5205     12  CH-VOID-DATA.
  5206         20  CH-VOID-DT                    PIC XX.
  5207         20  CH-VOID-BY                    PIC X(4).
  5208         20  CH-VOID-REASON                PIC X(25).
  5209
  5210     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5211             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5212     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5213
  5214     12  CH-CHECK-REFERENCE                PIC X(12).
  5215     12  CH-CHECK-ORIGIN-SW                PIC X.
  5216             88  CH-REFUND-CHECK              VALUE 'R'.
  5217             88  CH-MAINT-CHECK               VALUE 'M'.
  5218
  5219     12  CH-CANC-DT                        PIC XX.
  5220     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5221     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5222
  5223     12  CH-INSURED-NAME                   PIC X(28).
  5224
  5225     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  5226     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  5227
  5228     12  CH-LETTER-TABLE.
  5229         16  CH-LETTERS OCCURS 3 TIMES
  5230                        INDEXED BY CH-LT-NDX
  5231                                           PIC X(04).
  5232
  5233     12  FILLER                            PIC X(07).
  5234
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 103
* EL689.cbl
  5236*    COPY ELCCNTL.
  5237******************************************************************
  5238*                                                                *
  5239*                                                                *
  5240*                            ELCCNTL.                            *
  5241*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5242*                            VMOD=2.059                          *
  5243*                                                                *
  5244*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5245*                                                                *
  5246*   FILE TYPE = VSAM,KSDS                                        *
  5247*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5248*                                                                *
  5249*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5250*       ALTERNATE INDEX = NONE                                   *
  5251*                                                                *
  5252*   LOG = YES                                                    *
  5253*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5254******************************************************************
  5255*                   C H A N G E   L O G
  5256*
  5257* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5258*-----------------------------------------------------------------
  5259*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5260* EFFECTIVE    NUMBER
  5261*-----------------------------------------------------------------
  5262* 082503                   PEMA  ADD BENEFIT GROUP
  5263* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5264* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5265* 092705    2005050300006  PEMA  ADD SPP LEASES
  5266* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5267* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5268* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5269* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5270* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5271* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5272* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5273* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5274* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5275******************************************************************
  5276*
  5277 01  CONTROL-FILE.
  5278     12  CF-RECORD-ID                       PIC XX.
  5279         88  VALID-CF-ID                        VALUE 'CF'.
  5280
  5281     12  CF-CONTROL-PRIMARY.
  5282         16  CF-COMPANY-ID                  PIC XXX.
  5283         16  CF-RECORD-TYPE                 PIC X.
  5284             88  CF-COMPANY-MASTER              VALUE '1'.
  5285             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5286             88  CF-STATE-MASTER                VALUE '3'.
  5287             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5288             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5289             88  CF-CARRIER-MASTER              VALUE '6'.
  5290             88  CF-MORTALITY-MASTER            VALUE '7'.
  5291             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5292             88  CF-TERMINAL-MASTER             VALUE '9'.
  5293             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 104
* EL689.cbl
  5294             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5295             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5296             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5297             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5298             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5299             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5300             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5301             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5302         16  CF-ACCESS-CD-GENL              PIC X(4).
  5303         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5304             20  CF-PROCESSOR               PIC X(4).
  5305         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5306             20  CF-STATE-CODE              PIC XX.
  5307             20  FILLER                     PIC XX.
  5308         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5309             20  FILLER                     PIC XX.
  5310             20  CF-HI-BEN-IN-REC           PIC XX.
  5311         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5312             20  FILLER                     PIC XXX.
  5313             20  CF-CARRIER-CNTL            PIC X.
  5314         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5315             20  FILLER                     PIC XX.
  5316             20  CF-HI-TYPE-IN-REC          PIC 99.
  5317         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5318             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5319                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5320             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5321             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5322         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5323             20  FILLER                     PIC X.
  5324             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5325         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5326             20  FILLER                     PIC XX.
  5327             20  CF-MORTGAGE-PLAN           PIC XX.
  5328         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5329
  5330     12  CF-LAST-MAINT-DT                   PIC XX.
  5331     12  CF-LAST-MAINT-BY                   PIC X(4).
  5332     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5333
  5334     12  CF-RECORD-BODY                     PIC X(728).
  5335
  5336
  5337****************************************************************
  5338*             COMPANY MASTER RECORD                            *
  5339****************************************************************
  5340
  5341     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5342         16  CF-COMPANY-ADDRESS.
  5343             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5344             20  CF-CL-IN-CARE-OF           PIC X(30).
  5345             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5346             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5347             20  CF-CL-CITY-STATE           PIC X(30).
  5348             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5349             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5350         16  CF-COMPANY-CD                  PIC X.
  5351         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 105
* EL689.cbl
  5352         16  CF-SECURITY-OPTION             PIC X.
  5353             88  ALL-SECURITY                   VALUE '1'.
  5354             88  COMPANY-VERIFY                 VALUE '2'.
  5355             88  PROCESSOR-VERIFY               VALUE '3'.
  5356             88  NO-SECURITY                    VALUE '4'.
  5357             88  ALL-BUT-TERM                   VALUE '5'.
  5358         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5359             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5360         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5361             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5362         16  CF-INFORCE-LOCATION            PIC X.
  5363             88  CERTS-ARE-ONLINE               VALUE '1'.
  5364             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5365             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5366         16  CF-LOWER-CASE-LETTERS          PIC X.
  5367         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5368             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5369             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5370             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5371             88  CF-ACCNT-CNTL                  VALUE '3'.
  5372             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5373
  5374         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5375         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5376
  5377         16  CF-LGX-CREDIT-USER             PIC X.
  5378             88  CO-IS-NOT-USER                 VALUE 'N'.
  5379             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5380
  5381         16 CF-CREDIT-CALC-CODES.
  5382             20  CF-CR-REM-TERM-CALC PIC X.
  5383               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5384               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5385               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5386               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5387               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5388               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5389               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5390             20  CF-CR-R78-METHOD           PIC X.
  5391               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5392               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5393
  5394         16  CF-CLAIM-CONTROL-COUNTS.
  5395             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5396                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5397
  5398             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5399                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5400
  5401             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5402                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5403
  5404             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5405                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5406
  5407         16  CF-CURRENT-MONTH-END           PIC XX.
  5408
  5409         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 106
* EL689.cbl
  5410             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5411             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5412             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5413             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5414                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5415                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5416             20  CF-CO-PREM-REJECT-SW       PIC X.
  5417                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5418                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5419             20  CF-CO-REF-REJECT-SW        PIC X.
  5420                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5421                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5422
  5423         16  CF-CO-REPORTING-DT             PIC XX.
  5424         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5425         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5426           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5427           88  CF-CO-MONTH-END                  VALUE '1'.
  5428
  5429         16  CF-LGX-CLAIM-USER              PIC X.
  5430             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5431             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5432
  5433         16  CF-CREDIT-EDIT-CONTROLS.
  5434             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5435             20  CF-MIN-AGE                 PIC 99.
  5436             20  CF-DEFAULT-AGE             PIC 99.
  5437             20  CF-MIN-TERM                PIC S999      COMP-3.
  5438             20  CF-MAX-TERM                PIC S999      COMP-3.
  5439             20  CF-DEFAULT-SEX             PIC X.
  5440             20  CF-JOINT-AGE-INPUT         PIC X.
  5441                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5442             20  CF-BIRTH-DATE-INPUT        PIC X.
  5443                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5444             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5445                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5446                 88  CF-ZERO-CARRIER            VALUE '1'.
  5447                 88  CF-ZERO-GROUPING           VALUE '2'.
  5448                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5449             20  CF-EDIT-SW                 PIC X.
  5450                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5451             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5452             20  CF-CR-PR-METHOD            PIC X.
  5453               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5454               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5455             20  FILLER                     PIC X.
  5456
  5457         16  CF-CREDIT-MISC-CONTROLS.
  5458             20  CF-REIN-TABLE-SW           PIC X.
  5459                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5460             20  CF-COMP-TABLE-SW           PIC X.
  5461                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5462             20  CF-EXPERIENCE-RETENTION-AGE
  5463                                            PIC S9        COMP-3.
  5464             20  CF-CONVERSION-DT           PIC XX.
  5465             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5466             20  CF-RUN-FREQUENCY-SW        PIC X.
  5467                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 107
* EL689.cbl
  5468                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5469
  5470             20  CF-CR-CHECK-NO-CONTROL.
  5471                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5472                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5473                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5474                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5475                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5476                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5477
  5478                 24  CF-CR-CHECK-COUNT       REDEFINES
  5479                     CF-CR-CHECK-COUNTER      PIC X(4).
  5480
  5481                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5482                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5483
  5484                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5485                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5486                 24  CF-MAIL-PROCESSING       PIC X.
  5487                     88  MAIL-PROCESSING          VALUE 'Y'.
  5488
  5489         16  CF-MISC-SYSTEM-CONTROL.
  5490             20  CF-SYSTEM-C                 PIC X.
  5491                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5492             20  CF-SYSTEM-D                 PIC X.
  5493                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5494             20  CF-SOC-SEC-NO-SW            PIC X.
  5495                 88  SOC-SEC-NO-USED             VALUE '1'.
  5496             20  CF-MEMBER-NO-SW             PIC X.
  5497                 88  MEMBER-NO-USED              VALUE '1'.
  5498             20  CF-TAX-ID-NUMBER            PIC X(11).
  5499             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5500             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5501                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5502                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5503                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5504                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5505             20  CF-SYSTEM-E                 PIC X.
  5506                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5507
  5508         16  CF-LGX-LIFE-USER               PIC X.
  5509             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5510             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5511
  5512         16  CF-CR-MONTH-END-DT             PIC XX.
  5513
  5514         16  CF-FILE-MAINT-DATES.
  5515             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5516                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5517             20  CF-LAST-BATCH       REDEFINES
  5518                 CF-LAST-BATCH-NO               PIC X(4).
  5519             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5520             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5521             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5522             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5523             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5524             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5525             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 108
* EL689.cbl
  5526             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5527             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5528             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5529
  5530         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5531         16  FILLER                         PIC X.
  5532
  5533         16  CF-ALT-MORT-CODE               PIC X(4).
  5534         16  CF-MEMBER-CAPTION              PIC X(10).
  5535
  5536         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5537             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5538             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5539             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5540             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5541             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5542
  5543         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5544
  5545         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5546         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5547         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5548         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5549
  5550         16  CF-AH-OVERRIDE-L1              PIC X.
  5551         16  CF-AH-OVERRIDE-L2              PIC XX.
  5552         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5553         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5554
  5555         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5556         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5557
  5558         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5559         16  CF-AR-LAST-EL860-DT            PIC XX.
  5560         16  CF-MP-MONTH-END-DT             PIC XX.
  5561
  5562         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5563         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5564             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5565
  5566         16  CF-AR-MONTH-END-DT             PIC XX.
  5567
  5568         16  CF-CRDTCRD-USER                PIC X.
  5569             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5570             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5571
  5572         16  CF-CC-MONTH-END-DT             PIC XX.
  5573
  5574         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5575
  5576         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5577             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5578             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5579             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5580         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5581         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5582         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5583         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 109
* EL689.cbl
  5584             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5585             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5586         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5587         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5588         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5589             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5590         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5591
  5592         16  CF-CL-ZIP-CODE.
  5593             20  CF-CL-ZIP-PRIME.
  5594                 24  CF-CL-ZIP-1ST          PIC X.
  5595                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5596                 24  FILLER                 PIC X(4).
  5597             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5598         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5599             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5600             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5601             20  FILLER                     PIC XXX.
  5602
  5603         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5604         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5605         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5606         16  CF-CO-OPTION-START-DATE        PIC XX.
  5607         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5608           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5609                                                      '3' '4'.
  5610           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5611           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5612           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5613           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5614           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5615           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5616
  5617         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5618
  5619         16  CF-PAYMENT-APPROVAL-LEVELS.
  5620             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5621             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5622             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5623             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5624             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5625             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5626
  5627         16  CF-END-USER-REPORTING-USER     PIC X.
  5628             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5629             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5630
  5631         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5632             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5633             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5634
  5635         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5636
  5637         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5638         16  FILLER                         PIC X.
  5639
  5640         16  CF-CREDIT-ARCHIVE-CNTL.
  5641             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 110
* EL689.cbl
  5642             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5643             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5644
  5645         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5646
  5647         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5648             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5649             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5650
  5651         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5652             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5653             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5654
  5655         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5656
  5657         16  CF-CO-ACH-ID-CODE              PIC  X.
  5658             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5659             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5660             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5661         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5662         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5663         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5664         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5665         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5666         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5667         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5668         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5669         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5670                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5671         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5672                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5673
  5674         16  CF-CO-OVER-SHORT.
  5675             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5676             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5677
  5678*         16  FILLER                         PIC X(102).
  5679         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5680             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5681             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5682
  5683         16  CF-AH-APPROVAL-DAYS.
  5684             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5685             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5686             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5687             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5688
  5689         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5690
  5691         16  CF-APPROV-LEV-5.
  5692             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5693             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5694             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5695
  5696         16  FILLER                         PIC X(68).
  5697****************************************************************
  5698*             PROCESSOR/USER RECORD                            *
  5699****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 111
* EL689.cbl
  5700
  5701     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5702         16  CF-PROCESSOR-NAME              PIC X(30).
  5703         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5704         16  CF-PROCESSOR-TITLE             PIC X(26).
  5705         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5706                 88  MESSAGE-YES                VALUE 'Y'.
  5707                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5708
  5709*****************************************************
  5710****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5711****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5712****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5713****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5714*****************************************************
  5715
  5716         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5717             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5718             20  CF-APPLICATION-FORCE       PIC X.
  5719             20  CF-INDIVIDUAL-APP.
  5720                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5721                     28  CF-BROWSE-APP      PIC X.
  5722                     28  CF-UPDATE-APP      PIC X.
  5723
  5724         16  CF-CURRENT-TERM-ON             PIC X(4).
  5725         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5726             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5727             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5728             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5729             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5730             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5731             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5732             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5733         16  CF-PROCESSOR-CARRIER           PIC X.
  5734             88  NO-CARRIER-SECURITY            VALUE ' '.
  5735         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5736             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5737         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5738             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5739         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5740             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5741
  5742         16  CF-PROC-SYS-ACCESS-SW.
  5743             20  CF-PROC-CREDIT-CLAIMS-SW.
  5744                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5745                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5746                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5747                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5748             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5749                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5750                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5751             20  CF-PROC-LIFE-GNRLDGR-SW.
  5752                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5753                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5754                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5755                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5756             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5757                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 112
* EL689.cbl
  5758                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5759         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5760             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5761             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5762         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5763
  5764         16  CF-APPROVAL-LEVEL                  PIC X.
  5765             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5766             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5767             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5768             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5769             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5770
  5771         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5772
  5773         16  CF-LANGUAGE-TYPE                   PIC X.
  5774             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5775             88  CF-LANG-IS-FR                      VALUE 'F'.
  5776
  5777         16  CF-CSR-IND                         PIC X.
  5778         16  FILLER                             PIC X(239).
  5779
  5780****************************************************************
  5781*             PROCESSOR/REMINDERS RECORD                       *
  5782****************************************************************
  5783
  5784     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5785         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5786             20  CF-START-REMIND-DT         PIC XX.
  5787             20  CF-END-REMIND-DT           PIC XX.
  5788             20  CF-REMINDER-TEXT           PIC X(50).
  5789         16  FILLER                         PIC X(296).
  5790
  5791
  5792****************************************************************
  5793*             STATE MASTER RECORD                              *
  5794****************************************************************
  5795
  5796     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5797         16  CF-STATE-ABBREVIATION          PIC XX.
  5798         16  CF-STATE-NAME                  PIC X(25).
  5799         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5800         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5801             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5802             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5803             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5804             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5805                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5806                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5807             20  CF-ST-PREM-REJECT-SW       PIC X.
  5808                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5809                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5810             20  CF-ST-REF-REJECT-SW        PIC X.
  5811                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5812                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5813         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5814         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5815         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 113
* EL689.cbl
  5816             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5817             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5818             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5819         16  CF-ST-FST-PMT-EXTENSION.
  5820             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5821             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5822                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5823                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5824                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5825                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5826         16  CF-ST-STATE-CALL.
  5827             20  CF-ST-CALL-UNEARNED        PIC X.
  5828             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5829             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5830         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5831             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5832             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5833         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5834         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5835         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5836         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5837         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5838         16  FILLER                         PIC X.
  5839         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5840             20  CF-ST-BENEFIT-CD           PIC XX.
  5841             20  CF-ST-BENEFIT-KIND         PIC X.
  5842                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5843                 88  CF-ST-AH-KIND              VALUE 'A'.
  5844             20  CF-ST-REM-TERM-CALC        PIC X.
  5845                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5846                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5847                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5848                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5849                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5850                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5851                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5852                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5853
  5854             20  CF-ST-REFUND-CALC          PIC X.
  5855                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5856                 88  ST-REFD-BY-R78             VALUE '1'.
  5857                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5858                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5859                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5860                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5861                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5862                 88  ST-REFD-UTAH               VALUE '7'.
  5863                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5864                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5865                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5866
  5867             20  CF-ST-EARNING-CALC         PIC X.
  5868                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5869                 88  ST-EARN-BY-R78             VALUE '1'.
  5870                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5871                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5872                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5873                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 114
* EL689.cbl
  5874                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5875                 88  ST-EARN-MEAN               VALUE '8'.
  5876                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5877
  5878             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5879                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5880                 88  ST-OVRD-BY-R78             VALUE '1'.
  5881                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5882                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5883                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5884                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5885                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5886                 88  ST-OVRD-MEAN               VALUE '8'.
  5887                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5888             20  FILLER                     PIC X.
  5889
  5890         16  CF-ST-COMMISSION-CAPS.
  5891             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5892             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5893             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5894             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5895         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5896                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5897
  5898         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5899
  5900         16  CF-ST-STATUTORY-INTEREST.
  5901             20  CF-ST-STAT-DATE-FROM       PIC X.
  5902                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5903                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5904             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5905             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5906             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5907             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5908             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5909
  5910         16  CF-ST-OVER-SHORT.
  5911             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5912             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5913
  5914         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5915
  5916         16  CF-ST-RT-CALC                  PIC X.
  5917
  5918         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5919         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5920         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5921         16  CF-ST-RF-LR-CALC               PIC X.
  5922         16  CF-ST-RF-LL-CALC               PIC X.
  5923         16  CF-ST-RF-LN-CALC               PIC X.
  5924         16  CF-ST-RF-AH-CALC               PIC X.
  5925         16  CF-ST-RF-CP-CALC               PIC X.
  5926*        16  FILLER                         PIC X(206).
  5927*CIDMOD         16  FILLER                         PIC X(192).
  5928         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5929             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5930         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5931         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 115
* EL689.cbl
  5932         16  CF-ST-CAUSAL-STATE             PIC X.
  5933         16  FILLER                         PIC X(185).
  5934
  5935****************************************************************
  5936*             BENEFIT MASTER RECORD                            *
  5937****************************************************************
  5938
  5939     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5940         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5941             20  CF-BENEFIT-CODE            PIC XX.
  5942             20  CF-BENEFIT-NUMERIC  REDEFINES
  5943                 CF-BENEFIT-CODE            PIC XX.
  5944             20  CF-BENEFIT-ALPHA           PIC XXX.
  5945             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5946             20  CF-BENEFIT-COMMENT         PIC X(10).
  5947
  5948             20  CF-LF-COVERAGE-TYPE        PIC X.
  5949                 88  CF-REDUCING                VALUE 'R'.
  5950                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5951
  5952             20  CF-SPECIAL-CALC-CD         PIC X.
  5953                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5954                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5955                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5956                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5957                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5958                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5959                 88  CF-FARM-PLAN               VALUE 'F'.
  5960                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5961                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5962                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5963                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5964                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5965                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5966                 88  CF-PRUDENTIAL              VALUE 'P'.
  5967                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5968                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5969                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5970                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5971                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5972                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5973
  5974             20  CF-JOINT-INDICATOR         PIC X.
  5975                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5976
  5977*            20  FILLER                     PIC X(12).
  5978             20  FILLER                     PIC X(11).
  5979             20  CF-BENEFIT-CATEGORY        PIC X.
  5980             20  CF-LOAN-TYPE               PIC X(8).
  5981
  5982             20  CF-CO-REM-TERM-CALC        PIC X.
  5983                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5984                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5985                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5986                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5987                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5988
  5989             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 116
* EL689.cbl
  5990                 88  CO-EARN-BY-R78             VALUE '1'.
  5991                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5992                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5993                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5994                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5995                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5996                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5997                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5998
  5999             20  CF-CO-REFUND-CALC          PIC X.
  6000                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  6001                 88  CO-REFD-BY-R78             VALUE '1'.
  6002                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  6003                 88  CO-REFD-AS-CALIF           VALUE '3'.
  6004                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  6005                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  6006                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  6007                 88  CO-REFD-MEAN               VALUE '8'.
  6008                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  6009                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  6010                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  6011
  6012             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  6013                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  6014                 88  CO-OVRD-BY-R78             VALUE '1'.
  6015                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  6016                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  6017                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  6018                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  6019                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  6020                 88  CO-OVRD-MEAN               VALUE '8'.
  6021                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  6022
  6023             20  CF-CO-BEN-I-G-CD           PIC X.
  6024                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  6025                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  6026                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  6027
  6028         16  FILLER                         PIC X(304).
  6029
  6030
  6031****************************************************************
  6032*             CARRIER MASTER RECORD                            *
  6033****************************************************************
  6034
  6035     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6036         16  CF-ADDRESS-DATA.
  6037             20  CF-MAIL-TO-NAME            PIC X(30).
  6038             20  CF-IN-CARE-OF              PIC X(30).
  6039             20  CF-ADDRESS-LINE-1          PIC X(30).
  6040             20  CF-ADDRESS-LINE-2          PIC X(30).
  6041             20  CF-CITY-STATE              PIC X(30).
  6042             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6043             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6044
  6045         16  CF-CLAIM-NO-CONTROL.
  6046             20  CF-CLAIM-NO-METHOD         PIC X.
  6047                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 117
* EL689.cbl
  6048                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6049                 88  CLAIM-NO-SEQ               VALUE '3'.
  6050                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6051             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6052                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6053                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6054                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6055
  6056         16  CF-CHECK-NO-CONTROL.
  6057             20  CF-CHECK-NO-METHOD         PIC X.
  6058                 88  CHECK-NO-MANUAL            VALUE '1'.
  6059                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6060                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6061                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6062             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6063                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6064
  6065         16  CF-DOMICILE-STATE              PIC XX.
  6066
  6067         16  CF-EXPENSE-CONTROLS.
  6068             20  CF-EXPENSE-METHOD          PIC X.
  6069                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6070                 88  DOLLARS-PER-PMT            VALUE '2'.
  6071                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6072                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6073             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6074             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6075
  6076         16  CF-CORRESPONDENCE-CONTROL.
  6077             20  CF-LETTER-RESEND-OPT       PIC X.
  6078                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6079                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6080             20  FILLER                     PIC X(4).
  6081
  6082         16  CF-RESERVE-CONTROLS.
  6083             20  CF-MANUAL-SW               PIC X.
  6084                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6085             20  CF-FUTURE-SW               PIC X.
  6086                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6087             20  CF-PTC-SW                  PIC X.
  6088                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6089             20  CF-IBNR-SW                 PIC X.
  6090                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6091             20  CF-PTC-LF-SW               PIC X.
  6092                 88  CF-LF-PTC-USED             VALUE '1'.
  6093             20  CF-CDT-ACCESS-METHOD       PIC X.
  6094                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6095                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6096                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6097             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6098
  6099         16  CF-CLAIM-CALC-METHOD           PIC X.
  6100             88  360-PLUS-MONTHS                VALUE '1'.
  6101             88  365-PLUS-MONTHS                VALUE '2'.
  6102             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6103             88  360-DAILY                      VALUE '4'.
  6104             88  365-DAILY                      VALUE '5'.
  6105
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 118
* EL689.cbl
  6106         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6107         16  FILLER                         PIC X(11).
  6108
  6109         16  CF-LIMIT-AMOUNTS.
  6110             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6111             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6112             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6113             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6114             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6115             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6116             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6117             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6118             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6119             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6120
  6121         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6122         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6123         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6124
  6125         16  CF-ZIP-CODE.
  6126             20  CF-ZIP-PRIME.
  6127                 24  CF-ZIP-1ST             PIC X.
  6128                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6129                 24  FILLER                 PIC X(4).
  6130             20  CF-ZIP-PLUS4               PIC X(4).
  6131         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6132             20  CF-CAN-POSTAL-1            PIC XXX.
  6133             20  CF-CAN-POSTAL-2            PIC XXX.
  6134             20  FILLER                     PIC XXX.
  6135
  6136         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6137         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6138         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6139
  6140         16  CF-RATING-SWITCH               PIC X.
  6141             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6142             88  CF-NO-RATING                   VALUE 'N'.
  6143
  6144         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6145
  6146         16  CF-CARRIER-OVER-SHORT.
  6147             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6148             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6149
  6150         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6151         16  CF-SECPAY-SWITCH               PIC X.
  6152             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6153             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6154         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6155         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6156         16  FILLER                         PIC X(444).
  6157*        16  FILLER                         PIC X(452).
  6158
  6159
  6160****************************************************************
  6161*             MORTALITY MASTER RECORD                          *
  6162****************************************************************
  6163
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 119
* EL689.cbl
  6164     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6165         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6166                                INDEXED BY CF-MORT-NDX.
  6167             20  CF-MORT-TABLE              PIC X(5).
  6168             20  CF-MORT-TABLE-TYPE         PIC X.
  6169                 88  CF-MORT-JOINT              VALUE 'J'.
  6170                 88  CF-MORT-SINGLE             VALUE 'S'.
  6171                 88  CF-MORT-COMBINED           VALUE 'C'.
  6172                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6173                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6174             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6175             20  CF-MORT-AGE-METHOD         PIC XX.
  6176                 88  CF-AGE-LAST                VALUE 'AL'.
  6177                 88  CF-AGE-NEAR                VALUE 'AN'.
  6178             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6179             20  CF-MORT-ADJUSTMENT-DIRECTION
  6180                                            PIC X.
  6181                 88  CF-MINUS                   VALUE '-'.
  6182                 88  CF-PLUS                    VALUE '+'.
  6183             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6184             20  CF-MORT-JOINT-CODE         PIC X.
  6185                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6186             20  CF-MORT-PC-Q               PIC X.
  6187                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6188             20  CF-MORT-TABLE-CODE         PIC X(4).
  6189             20  CF-MORT-COMMENTS           PIC X(15).
  6190             20  FILLER                     PIC X(14).
  6191
  6192         16  FILLER                         PIC X(251).
  6193
  6194
  6195****************************************************************
  6196*             BUSSINESS TYPE MASTER RECORD                     *
  6197****************************************************************
  6198
  6199     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6200* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6201* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6202* AND RECORD 05 IS TYPES 81-99
  6203         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6204             20  CF-BUSINESS-TITLE          PIC  X(19).
  6205             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6206                                            PIC S9V9(4) COMP-3.
  6207             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6208             20  FILLER                     PIC  X.
  6209         16  FILLER                         PIC  X(248).
  6210
  6211
  6212****************************************************************
  6213*             TERMINAL MASTER RECORD                           *
  6214****************************************************************
  6215
  6216     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6217
  6218         16  CF-COMPANY-TERMINALS.
  6219             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6220                                  PIC X(4).
  6221         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 120
* EL689.cbl
  6222
  6223
  6224****************************************************************
  6225*             LIFE EDIT MASTER RECORD                          *
  6226****************************************************************
  6227
  6228     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6229         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6230             20  CF-LIFE-CODE-IN            PIC XX.
  6231             20  CF-LIFE-CODE-OUT           PIC XX.
  6232         16  FILLER                         PIC X(248).
  6233
  6234
  6235****************************************************************
  6236*             AH EDIT MASTER RECORD                            *
  6237****************************************************************
  6238
  6239     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6240         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6241             20  CF-AH-CODE-IN              PIC XXX.
  6242             20  CF-AH-CODE-OUT             PIC XX.
  6243         16  FILLER                         PIC X(248).
  6244
  6245
  6246****************************************************************
  6247*             CREDIBILITY TABLES                               *
  6248****************************************************************
  6249
  6250     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6251         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6252                             INDEXED BY CF-CRDB-NDX.
  6253             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6254             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6255             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6256         16  FILLER                         PIC  X(332).
  6257
  6258
  6259****************************************************************
  6260*             REPORT CUSTOMIZATION RECORD                      *
  6261****************************************************************
  6262
  6263     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6264         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6265             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6266             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6267             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6268**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6269****       A T-TRANSFER.                                   ****
  6270             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6271
  6272         16  FILLER                         PIC XX.
  6273
  6274         16  CF-CARRIER-CNTL-OPT.
  6275             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6276                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6277                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6278             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6279                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 121
* EL689.cbl
  6280         16  CF-GROUP-CNTL-OPT.
  6281             20  CF-GROUP-OPT-SEQ           PIC 9.
  6282                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6283                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6284             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6285                                            PIC X(6).
  6286         16  CF-STATE-CNTL-OPT.
  6287             20  CF-STATE-OPT-SEQ           PIC 9.
  6288                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6289                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6290             20  CF-STATE-SELECT OCCURS 3 TIMES
  6291                                            PIC XX.
  6292         16  CF-ACCOUNT-CNTL-OPT.
  6293             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6294                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6295                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6296             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6297                                            PIC X(10).
  6298         16  CF-BUS-TYP-CNTL-OPT.
  6299             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6300                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6301                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6302             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6303                                            PIC XX.
  6304         16  CF-LF-TYP-CNTL-OPT.
  6305             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6306                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6307                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6308             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6309                                            PIC XX.
  6310         16  CF-AH-TYP-CNTL-OPT.
  6311             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6312                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6313                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6314             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6315                                            PIC XX.
  6316         16  CF-REPTCD1-CNTL-OPT.
  6317             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6318                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6319                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6320             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6321                                            PIC X(10).
  6322         16  CF-REPTCD2-CNTL-OPT.
  6323             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6324                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6325                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6326             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6327                                            PIC X(10).
  6328         16  CF-USER1-CNTL-OPT.
  6329             20  CF-USER1-OPT-SEQ           PIC 9.
  6330                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6331                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6332             20  CF-USER1-SELECT OCCURS 3 TIMES
  6333                                            PIC X(10).
  6334         16  CF-USER2-CNTL-OPT.
  6335             20  CF-USER2-OPT-SEQ           PIC 9.
  6336                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6337                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 122
* EL689.cbl
  6338             20  CF-USER2-SELECT OCCURS 3 TIMES
  6339                                            PIC X(10).
  6340         16  CF-USER3-CNTL-OPT.
  6341             20  CF-USER3-OPT-SEQ           PIC 9.
  6342                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6343                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6344             20  CF-USER3-SELECT OCCURS 3 TIMES
  6345                                            PIC X(10).
  6346         16  CF-USER4-CNTL-OPT.
  6347             20  CF-USER4-OPT-SEQ           PIC 9.
  6348                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6349                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6350             20  CF-USER4-SELECT OCCURS 3 TIMES
  6351                                            PIC X(10).
  6352         16  CF-USER5-CNTL-OPT.
  6353             20  CF-USER5-OPT-SEQ           PIC 9.
  6354                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6355                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6356             20  CF-USER5-SELECT OCCURS 3 TIMES
  6357                                            PIC X(10).
  6358         16  CF-REINS-CNTL-OPT.
  6359             20  CF-REINS-OPT-SEQ           PIC 9.
  6360                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6361                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6362             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6363                 24  CF-REINS-PRIME         PIC XXX.
  6364                 24  CF-REINS-SUB           PIC XXX.
  6365
  6366         16  CF-AGENT-CNTL-OPT.
  6367             20  CF-AGENT-OPT-SEQ           PIC 9.
  6368                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6369                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6370             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6371                                            PIC X(10).
  6372
  6373         16  FILLER                         PIC X(43).
  6374
  6375         16  CF-LOSS-RATIO-SELECT.
  6376             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6377             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6378         16  CF-ENTRY-DATE-SELECT.
  6379             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6380             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6381         16  CF-EFFECTIVE-DATE-SELECT.
  6382             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6383             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6384
  6385         16  CF-EXCEPTION-LIST-IND          PIC X.
  6386             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6387
  6388         16  FILLER                         PIC X(318).
  6389
  6390****************************************************************
  6391*                  EXCEPTION REPORTING RECORD                  *
  6392****************************************************************
  6393
  6394     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6395         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 123
* EL689.cbl
  6396             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6397
  6398         16  CF-COMBINED-LIFE-AH-OPT.
  6399             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6400             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6401             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6402             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6403
  6404         16  CF-LIFE-OPT.
  6405             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6406             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6407             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6408             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6409             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6410             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6411             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6412             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6413             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6414             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6415
  6416         16  CF-AH-OPT.
  6417             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6418             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6419             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6420             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6421             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6422             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6423             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6424             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6425             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6426             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6427
  6428         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6429             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6430             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6431             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6432
  6433         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6434
  6435         16  FILLER                         PIC X(673).
  6436
  6437
  6438****************************************************************
  6439*             MORTGAGE SYSTEM PLAN RECORD                      *
  6440****************************************************************
  6441
  6442     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6443         16  CF-PLAN-TYPE                   PIC X.
  6444             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6445             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6446             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6447         16  CF-PLAN-ABBREV                 PIC XXX.
  6448         16  CF-PLAN-DESCRIPT               PIC X(10).
  6449         16  CF-PLAN-NOTES                  PIC X(20).
  6450         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6451         16  CF-PLAN-UNDERWRITING.
  6452             20  CF-PLAN-TERM-DATA.
  6453                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 124
* EL689.cbl
  6454                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6455             20  CF-PLAN-AGE-DATA.
  6456                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6457                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6458                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6459             20  CF-PLAN-BENEFIT-DATA.
  6460                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6461                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6462                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6463                                            PIC S9(7)V99  COMP-3.
  6464         16  CF-PLAN-POLICY-FORMS.
  6465             20  CF-POLICY-FORM             PIC X(12).
  6466             20  CF-MASTER-APPLICATION      PIC X(12).
  6467             20  CF-MASTER-POLICY           PIC X(12).
  6468         16  CF-PLAN-RATING.
  6469             20  CF-RATE-CODE               PIC X(5).
  6470             20  CF-SEX-RATING              PIC X.
  6471                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6472                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6473             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6474             20  CF-SUB-STD-TYPE            PIC X.
  6475                 88  CF-PCT-OF-PREM            VALUE '1'.
  6476                 88  CF-PCT-OF-BENE            VALUE '2'.
  6477         16  CF-PLAN-PREM-TOLERANCES.
  6478             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6479             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6480         16  CF-PLAN-PYMT-TOLERANCES.
  6481             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6482             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6483         16  CF-PLAN-MISC-DATA.
  6484             20  FILLER                     PIC X.
  6485             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6486             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6487         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6488         16  CF-PLAN-IND-GRP                PIC X.
  6489             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6490                                                     '1'.
  6491             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6492                                                     '2'.
  6493         16  CF-MIB-SEARCH-SW               PIC X.
  6494             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6495             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6496             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6497             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6498         16  CF-ALPHA-SEARCH-SW             PIC X.
  6499             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6500             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6501             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6502             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6503             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6504             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6505             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6506             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6507             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6508             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6509                                                     'A' 'B' 'C'
  6510                                                     'X' 'Y' 'Z'.
  6511         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 125
* EL689.cbl
  6512             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6513             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6514             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6515             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6516             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6517         16  FILLER                         PIC X(4).
  6518         16  CF-HEALTH-QUESTIONS            PIC X.
  6519             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6520         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6521         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6522         16  CF-PLAN-SNGL-JNT               PIC X.
  6523             88  CF-COMBINED-PLAN              VALUE 'C'.
  6524             88  CF-JNT-PLAN                   VALUE 'J'.
  6525             88  CF-SNGL-PLAN                  VALUE 'S'.
  6526         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6527         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6528         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6529         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6530         16  CF-RERATE-CNTL                 PIC  X.
  6531             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6532             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6533             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6534             88  CF-AUTO-RECALC                 VALUE '4'.
  6535         16  CF-BENEFIT-TYPE                PIC  X.
  6536             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6537             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6538         16  CF-POLICY-FEE                  PIC S999V99
  6539                                                    COMP-3.
  6540         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6541         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6542         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6543         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6544         16  FILLER                         PIC  X(32).
  6545         16  CF-TERMINATION-FORM            PIC  X(04).
  6546         16  FILLER                         PIC  X(08).
  6547         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6548                                                       COMP-3.
  6549         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6550         16  CF-ISSUE-LETTER                PIC  X(4).
  6551         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6552         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6553             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6554             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6555         16  CF-MP-REFUND-CALC              PIC X.
  6556             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6557             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6558             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6559             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6560             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6561             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6562             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6563             88  CF-MP-REFD-MEAN                VALUE '8'.
  6564         16  CF-ALT-RATE-CODE               PIC  X(5).
  6565
  6566
  6567         16  FILLER                         PIC X(498).
  6568****************************************************************
  6569*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 126
* EL689.cbl
  6570****************************************************************
  6571
  6572     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6573         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6574         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6575             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6576             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6577             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6578             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6579             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6580
  6581         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6582         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6583         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6584         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6585         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6586
  6587         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6588             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6589         16  CF-MP-RECON-USE-IND            PIC X(1).
  6590             88  CF-MP-USE-RECON             VALUE 'Y'.
  6591         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6592             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6593         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6594             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6595             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6596         16  FILLER                         PIC X(1).
  6597         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6598             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6599         16  CF-MORTG-MIB-VERSION           PIC X.
  6600             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6601             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6602             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6603         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6604             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6605                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6606             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6607                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6608             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6609                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6610             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6611                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6612             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6613                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6614             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6615                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6616         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6617         16  FILLER                         PIC X(7).
  6618         16  CF-MORTG-DESTINATION-SYMBOL.
  6619             20  CF-MORTG-MIB-COMM          PIC X(5).
  6620             20  CF-MORTG-MIB-TERM          PIC X(5).
  6621         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6622             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6623         16  FILLER                         PIC X(03).
  6624         16  CF-MP-CHECK-NO-CONTROL.
  6625             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6626                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6627                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 127
* EL689.cbl
  6628                                                ' ' LOW-VALUES.
  6629                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6630                                               VALUE '3'.
  6631         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6632         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6633         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6634             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6635                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6636             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6637                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6638             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6639                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6640             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6641                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6642             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6643                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6644             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6645                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6646         16  CF-MORTG-BILLING-AREA.
  6647             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6648                                            PIC X.
  6649         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6650         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6651         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6652         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6653             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6654             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6655         16  FILLER                         PIC X.
  6656         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6657             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6658             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6659         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6660         16  FILLER                         PIC X(8).
  6661         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6662         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6663         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6664         16  CF-ACH-COMPANY-ID.
  6665             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6666                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6667                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6668                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6669             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6670         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6671             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6672         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6673             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6674             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6675         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6676         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6677         16  FILLER                         PIC X(536).
  6678
  6679****************************************************************
  6680*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6681****************************************************************
  6682
  6683     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6684         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6685             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 128
* EL689.cbl
  6686                 24  CF-FEMALE-FT           PIC 99.
  6687                 24  CF-FEMALE-IN           PIC 99.
  6688             20  CF-FEMALE-MIN-WT           PIC 999.
  6689             20  CF-FEMALE-MAX-WT           PIC 999.
  6690         16  FILLER                         PIC X(428).
  6691
  6692     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6693         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6694             20  CF-MALE-HEIGHT.
  6695                 24  CF-MALE-FT             PIC 99.
  6696                 24  CF-MALE-IN             PIC 99.
  6697             20  CF-MALE-MIN-WT             PIC 999.
  6698             20  CF-MALE-MAX-WT             PIC 999.
  6699         16  FILLER                         PIC X(428).
  6700******************************************************************
  6701*             AUTOMATIC ACTIVITY RECORD                          *
  6702******************************************************************
  6703     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6704         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6705             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6706             20  CF-SYS-LETTER-ID           PIC X(04).
  6707             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6708             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6709             20  CF-SYS-RESET-SW            PIC X(01).
  6710             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6711             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6712
  6713         16  FILLER                         PIC X(50).
  6714
  6715         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6716             20  CF-USER-ACTIVE-SW          PIC X(01).
  6717             20  CF-USER-LETTER-ID          PIC X(04).
  6718             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6719             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6720             20  CF-USER-RESET-SW           PIC X(01).
  6721             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6722             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6723             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6724
  6725         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 129
* EL689.cbl
  6727*    COPY ERCCOMP.
  6728******************************************************************
  6729*                                                                *
  6730*                                                                *
  6731*                            ERCCOMP                             *
  6732*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6733*                            VMOD=2.019                          *
  6734*                                                                *
  6735*   ONLINE CREDIT SYSTEM                                         *
  6736*                                                                *
  6737*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6738*                                                                *
  6739*   FILE TYPE = VSAM,KSDS                                        *
  6740*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6741*                                                                *
  6742*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6743*       ALTERNATE PATH = NONE                                    *
  6744*                                                                *
  6745*   LOG = NO                                                     *
  6746*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6747*                                                                *
  6748******************************************************************
  6749*                   C H A N G E   L O G
  6750*
  6751* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6752*-----------------------------------------------------------------
  6753*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6754* EFFECTIVE    NUMBER
  6755*-----------------------------------------------------------------
  6756* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6757* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6758* 092205    2005050300006  PEMA  ADD LEASE FEE
  6759* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6760* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6761* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6762* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6763* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6764* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6765******************************************************************
  6766
  6767 01  COMPENSATION-MASTER.
  6768     12  CO-RECORD-ID                          PIC XX.
  6769         88  VALID-CO-ID                          VALUE 'CO'.
  6770
  6771     12  CO-CONTROL-PRIMARY.
  6772         16  CO-COMPANY-CD                     PIC X.
  6773         16  CO-CONTROL.
  6774             20  CO-CTL-1.
  6775                 24  CO-CARR-GROUP.
  6776                     28  CO-CARRIER            PIC X.
  6777                     28  CO-GROUPING.
  6778                         32  CO-GROUP-PREFIX   PIC XXX.
  6779                         32  CO-GROUP-PRIME    PIC XXX.
  6780                 24  CO-RESP-NO.
  6781                     28  CO-RESP-PREFIX        PIC X(4).
  6782                     28  CO-RESP-PRIME         PIC X(6).
  6783             20  CO-CTL-2.
  6784                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 130
* EL689.cbl
  6785                     28  CO-ACCT-PREFIX        PIC X(4).
  6786                     28  CO-ACCT-PRIME         PIC X(6).
  6787         16  CO-TYPE                           PIC X.
  6788             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6789             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6790             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6791
  6792     12  CO-MAINT-INFORMATION.
  6793         16  CO-LAST-MAINT-DT                  PIC XX.
  6794         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6795         16  CO-LAST-MAINT-USER                PIC X(4).
  6796     12  FILLER                                PIC XX.
  6797     12  CO-STMT-TYPE                          PIC XXX.
  6798     12  CO-COMP-TYPE                          PIC X.
  6799         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6800     12  CO-STMT-OWNER                         PIC X(4).
  6801     12  CO-BALANCE-CONTROL                    PIC X.
  6802         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6803         88  CO-NO-BALANCE                        VALUE 'N'.
  6804
  6805     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6806         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6807         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6808         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6809
  6810     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6811         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6812         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6813
  6814     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6815     12  CO-GA-DIRECT-DEP                      PIC X.
  6816     12  CO-FUTURE-SPACE                       PIC X.
  6817         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6818
  6819     12  CO-ACCT-NAME                          PIC X(30).
  6820     12  CO-MAIL-NAME                          PIC X(30).
  6821     12  CO-ADDR-1                             PIC X(30).
  6822     12  CO-ADDR-2                             PIC X(30).
  6823     12  CO-ADDR-3.
  6824         16  CO-ADDR-CITY                      PIC X(27).
  6825         16  CO-ADDR-STATE                     PIC XX.
  6826     12  CO-CSO-1099                           PIC X.
  6827     12  CO-ZIP.
  6828         16  CO-ZIP-PRIME.
  6829             20  CO-ZIP-PRI-1ST                PIC X.
  6830                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6831             20  FILLER                        PIC X(4).
  6832         16  CO-ZIP-PLUS4                      PIC X(4).
  6833     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6834         16  CO-CAN-POSTAL-1                   PIC XXX.
  6835         16  CO-CAN-POSTAL-2                   PIC XXX.
  6836         16  FILLER                            PIC XXX.
  6837     12  CO-SOC-SEC                            PIC X(13).
  6838     12  CO-TELEPHONE.
  6839         16  CO-AREA-CODE                      PIC XXX.
  6840         16  CO-PREFIX                         PIC XXX.
  6841         16  CO-PHONE                          PIC X(4).
  6842
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 131
* EL689.cbl
  6843     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6844
  6845     12  CO-AR-BAL-LEVEL                       PIC X.
  6846         88  CO-AR-REF-LVL                        VALUE '1'.
  6847         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6848         88  CO-AR-BILL-LVL                       VALUE '2'.
  6849         88  CO-AR-AGT-LVL                        VALUE '3'.
  6850         88  CO-AR-FR-LVL                         VALUE '4'.
  6851
  6852     12  CO-AR-NORMAL-PRINT                    PIC X.
  6853         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6854         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6855
  6856     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6857
  6858     12  CO-AR-REPORTING                       PIC X.
  6859         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6860         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6861
  6862     12  CO-AR-PULL-CHECK                      PIC X.
  6863         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6864         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6865
  6866     12  CO-AR-BALANCE-PRINT                   PIC X.
  6867         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6868
  6869     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6870         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6871         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6872         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6873
  6874     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6875
  6876     12  CO-USER-CODE                          PIC X.
  6877     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6878
  6879******************************************************************
  6880*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6881*    THE LAST MONTH END RUN.
  6882******************************************************************
  6883
  6884     12  CO-LAST-ACTIVITY-DATE.
  6885         16  CO-ACT-YEAR                       PIC 99.
  6886         16  CO-ACT-MONTH                      PIC 99.
  6887         16  CO-ACT-DAY                        PIC 99.
  6888
  6889     12  CO-LAST-STMT-DT.
  6890         16  CO-LAST-STMT-YEAR                 PIC 99.
  6891         16  CO-LAST-STMT-MONTH                PIC 99.
  6892         16  CO-LAST-STMT-DAY                  PIC 99.
  6893
  6894     12  CO-MO-END-TOTALS.
  6895         16  CO-MONTHLY-TOTALS.
  6896             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6897             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6898             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6899             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6900             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 132
* EL689.cbl
  6901
  6902         16  CO-AGING-TOTALS.
  6903             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6904             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6905             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6906             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6907
  6908         16  CO-YTD-TOTALS.
  6909             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6910             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6911
  6912         16  CO-OVER-UNDER-TOTALS.
  6913             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6914             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6915
  6916     12  CO-MISCELLANEOUS-TOTALS.
  6917         16  CO-FICA-TOTALS.
  6918             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6919             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6920
  6921         16  CO-CLAIM-TOTALS.
  6922             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6923             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6924
  6925******************************************************************
  6926*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6927*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6928******************************************************************
  6929
  6930     12  CO-CURRENT-TOTALS.
  6931         16  CO-CURRENT-LAST-STMT-DT.
  6932             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6933             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6934             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6935
  6936         16  CO-CURRENT-MONTHLY-TOTALS.
  6937             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6938             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6939             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6940             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6941             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6942
  6943         16  CO-CURRENT-AGING-TOTALS.
  6944             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6945             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6946             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6947             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6948
  6949         16  CO-CURRENT-YTD-TOTALS.
  6950             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6951             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6952
  6953     12  CO-PAID-COMM-TOTALS.
  6954         16  CO-YTD-PAID-COMMS.
  6955             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6956             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6957
  6958     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 133
* EL689.cbl
  6959         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6960         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6961
  6962     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6963         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6964         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6965         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6966         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6967         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6968         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6969         88  CO-FINAL-LETTER                  VALUE 'F'.
  6970         88  CO-RECONCILING                   VALUE 'R'.
  6971         88  CO-PHONE-CALL                    VALUE 'P'.
  6972         88  CO-LEGAL                         VALUE 'L'.
  6973         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6974         88  CO-WRITE-OFF                     VALUE 'W'.
  6975         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6976
  6977     12  CO-CSR-CODE                       PIC X(4).
  6978
  6979     12  CO-GA-STATUS-INFO.
  6980         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6981         16  CO-GA-TERMINATION-DT          PIC XX.
  6982         16  CO-GA-STATUS-CODE             PIC X.
  6983             88  CO-GA-ACTIVE                 VALUE 'A'.
  6984             88  CO-GA-INACTIVE               VALUE 'I'.
  6985             88  CO-GA-PENDING                VALUE 'P'.
  6986         16  CO-GA-COMMENTS.
  6987             20  CO-GA-COMMENT-1           PIC X(40).
  6988             20  CO-GA-COMMENT-2           PIC X(40).
  6989             20  CO-GA-COMMENT-3           PIC X(40).
  6990             20  CO-GA-COMMENT-4           PIC X(40).
  6991
  6992     12  CO-RPTCD2                         PIC X(10).
  6993     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6994         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6995         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6996
  6997     12  CO-TYPE-AGENT                     PIC X(01).
  6998         88  CO-CORPORATION                   VALUE 'C'.
  6999         88  CO-PARTNERSHIP                   VALUE 'P'.
  7000         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7001         88  CO-TRUST                         VALUE 'T'.
  7002         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7003
  7004     12  CO-FAXNO.
  7005         16  CO-FAX-AREA-CODE                  PIC XXX.
  7006         16  CO-FAX-PREFIX                     PIC XXX.
  7007         16  CO-FAX-PHONE                      PIC X(4).
  7008
  7009     12  CO-BANK-INFORMATION.
  7010         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7011         16  CO-BANK-TRANSIT-NON REDEFINES
  7012             CO-BANK-TRANSIT-NO                PIC 9(8).
  7013
  7014         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7015     12  CO-MISC-DEDUCT-INFO REDEFINES
  7016                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 134
* EL689.cbl
  7017         16  CO-MD-GL-ACCT                     PIC X(10).
  7018         16  CO-MD-DIV                         PIC XX.
  7019         16  CO-MD-CENTER                      PIC X(4).
  7020         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7021         16  CO-CREATE-AP-CHECK                PIC X.
  7022         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7023         16  FILLER                            PIC XXX.
  7024     12  CO-ACH-STATUS                         PIC X.
  7025         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7026         88  CO-ACH-PENDING                        VALUE 'P'.
  7027
  7028     12  CO-BILL-SW                            PIC X.
  7029     12  CO-CONTROL-NAME                       PIC X(30).
  7030     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7031     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7032     12  CO-CLP-STATE                          PIC XX.
  7033     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7034     12  CO-SPP-REFUND-EDIT                    PIC X.
  7035
  7036******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 135
* EL689.cbl
  7038*    COPY ERCMAIL.
  7039******************************************************************
  7040*                                                                *
  7041*                                                                *
  7042*                            ERCMAIL                             *
  7043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7044*                            VMOD=2.003                          *
  7045*                                                                *
  7046*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7047*                                                                *
  7048*   FILE TYPE = VSAM,KSDS                                        *
  7049*   RECORD SIZE = 374   RECFORM = FIX                            *
  7050*                                                                *
  7051*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7052*   ALTERNATE PATH    = NOT USED                                 *
  7053*                                                                *
  7054*   LOG = YES                                                    *
  7055*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7056******************************************************************
  7057*                   C H A N G E   L O G
  7058*
  7059* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7060*-----------------------------------------------------------------
  7061*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7062* EFFECTIVE    NUMBER
  7063*-----------------------------------------------------------------
  7064* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7065* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7066* 111108                   PEMA  ADD CRED BENE ADDR2
  7067******************************************************************
  7068
  7069 01  MAILING-DATA.
  7070     12  MA-RECORD-ID                      PIC XX.
  7071         88  VALID-MA-ID                       VALUE 'MA'.
  7072
  7073     12  MA-CONTROL-PRIMARY.
  7074         16  MA-COMPANY-CD                 PIC X.
  7075         16  MA-CARRIER                    PIC X.
  7076         16  MA-GROUPING.
  7077             20  MA-GROUPING-PREFIX        PIC XXX.
  7078             20  MA-GROUPING-PRIME         PIC XXX.
  7079         16  MA-STATE                      PIC XX.
  7080         16  MA-ACCOUNT.
  7081             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7082             20  MA-ACCOUNT-PRIME          PIC X(6).
  7083         16  MA-CERT-EFF-DT                PIC XX.
  7084         16  MA-CERT-NO.
  7085             20  MA-CERT-PRIME             PIC X(10).
  7086             20  MA-CERT-SFX               PIC X.
  7087
  7088     12  FILLER                            PIC XX.
  7089
  7090     12  MA-ACCESS-CONTROL.
  7091         16  MA-SOURCE-SYSTEM              PIC XX.
  7092             88  MA-FROM-CREDIT                VALUE 'CR'.
  7093             88  MA-FROM-VSI                   VALUE 'VS'.
  7094             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7095             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 136
* EL689.cbl
  7096         16  MA-RECORD-ADD-DT              PIC XX.
  7097         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7098         16  MA-LAST-MAINT-DT              PIC XX.
  7099         16  MA-LAST-MAINT-BY              PIC XXXX.
  7100         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7101
  7102     12  MA-PROFILE-INFO.
  7103         16  MA-QUALIFY-CODE-1             PIC XX.
  7104         16  MA-QUALIFY-CODE-2             PIC XX.
  7105         16  MA-QUALIFY-CODE-3             PIC XX.
  7106         16  MA-QUALIFY-CODE-4             PIC XX.
  7107         16  MA-QUALIFY-CODE-5             PIC XX.
  7108
  7109         16  MA-INSURED-LAST-NAME          PIC X(15).
  7110         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7111         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7112         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7113         16  MA-INSURED-BIRTH-DT           PIC XX.
  7114         16  MA-INSURED-SEX                PIC X.
  7115             88  MA-SEX-MALE                   VALUE 'M'.
  7116             88  MA-SEX-FEMALE                 VALUE 'F'.
  7117         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7118
  7119         16  MA-ADDRESS-CORRECTED          PIC X.
  7120         16  MA-JOINT-BIRTH-DT             PIC XX.
  7121*        16  FILLER                        PIC X(12).
  7122
  7123         16  MA-ADDRESS-LINE-1             PIC X(30).
  7124         16  MA-ADDRESS-LINE-2             PIC X(30).
  7125         16  MA-CITY-STATE.
  7126             20  MA-CITY                   PIC X(28).
  7127             20  MA-ADDR-STATE             PIC XX.
  7128         16  MA-ZIP.
  7129             20  MA-ZIP-CODE.
  7130                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7131                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7132                 24  FILLER                PIC X(4).
  7133             20  MA-ZIP-PLUS4              PIC X(4).
  7134         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7135             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7136             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7137             20  FILLER                    PIC X(3).
  7138
  7139         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7140
  7141         16  FILLER                        PIC XXX.
  7142*        16  FILLER                        PIC X(10).
  7143
  7144     12  MA-CRED-BENE-INFO.
  7145         16  MA-CRED-BENE-NAME                 PIC X(25).
  7146         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7147         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7148         16  MA-CRED-BENE-CTYST.
  7149             20  MA-CRED-BENE-CITY             PIC X(28).
  7150             20  MA-CRED-BENE-STATE            PIC XX.
  7151         16  MA-CRED-BENE-ZIP.
  7152             20  MA-CB-ZIP-CODE.
  7153                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 137
* EL689.cbl
  7154                     88  MA-CB-CANADIAN-POST-CODE
  7155                                           VALUE 'A' THRU 'Z'.
  7156                 24  FILLER                    PIC X(4).
  7157             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7158         16  MA-CB-CANADIAN-POSTAL-CODE
  7159                            REDEFINES MA-CRED-BENE-ZIP.
  7160             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7161             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7162             20  FILLER                        PIC X(3).
  7163     12  MA-POST-CARD-MAIL-DATA.
  7164         16  MA-MAIL-DATA OCCURS 7.
  7165             20  MA-MAIL-TYPE              PIC X.
  7166                 88  MA-12MO-MAILING           VALUE '1'.
  7167                 88  MA-EXP-MAILING            VALUE '2'.
  7168             20  MA-MAIL-STATUS            PIC X.
  7169                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7170                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7171                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7172             20  MA-MAIL-DATE              PIC XX.
  7173     12  FILLER                            PIC XX.
  7174     12  FILLER                            PIC XX.
  7175*    12  FILLER                            PIC X(30).
  7176******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 138
* EL689.cbl
  7178*    COPY ERCPNDB.
  7179******************************************************************
  7180*                                                                *
  7181*                                                                *
  7182*                            ERCPNDB.                            *
  7183*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7184*                            VMOD=2.025                          *
  7185*                                                                *
  7186*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  7187*                                                                *
  7188******************************************************************
  7189*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  7190*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  7191******************************************************************
  7192*                                                                *
  7193*                                                                *
  7194*   FILE TYPE = VSAM,KSDS                                        *
  7195*   RECORD SIZE = 585  RECFORM = FIXED                           *
  7196*                                                                *
  7197*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  7198*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  7199*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  7200*                                                 RKP=13,LEN=36  *
  7201*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  7202*                                      AND CHG-SEQ.)             *
  7203*                                                RKP=49,LEN=11   *
  7204*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  7205*                                      AND CHG-SEQ.)             *
  7206*                                                RKP=60,LEN=15   *
  7207*                                                                *
  7208*   LOG = NO                                                     *
  7209*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7210******************************************************************
  7211******************************************************************
  7212*                   C H A N G E   L O G
  7213*
  7214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7215*-----------------------------------------------------------------
  7216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7217* EFFECTIVE    NUMBER
  7218*-----------------------------------------------------------------
  7219* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7220* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7221* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7222* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7223* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7224* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7225* 032306                   PEMA  ADD BOW LOAN NUMBER
  7226* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7227* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7228* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7229* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7230* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7231* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7232* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7233* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7234******************************************************************
  7235
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 139
* EL689.cbl
  7236 01  PENDING-BUSINESS.
  7237     12  PB-RECORD-ID                     PIC XX.
  7238         88  VALID-PB-ID                        VALUE 'PB'.
  7239
  7240     12  PB-CONTROL-PRIMARY.
  7241         16  PB-COMPANY-CD                PIC X.
  7242         16  PB-ENTRY-BATCH               PIC X(6).
  7243         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7244         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7245
  7246     12  PB-CONTROL-BY-ACCOUNT.
  7247         16  PB-COMPANY-CD-A1             PIC X.
  7248         16  PB-CARRIER                   PIC X.
  7249         16  PB-GROUPING.
  7250             20  PB-GROUPING-PREFIX       PIC XXX.
  7251             20  PB-GROUPING-PRIME        PIC XXX.
  7252         16  PB-STATE                     PIC XX.
  7253         16  PB-ACCOUNT.
  7254             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7255             20  PB-ACCOUNT-PRIME         PIC X(6).
  7256         16  PB-CERT-EFF-DT               PIC XX.
  7257         16  PB-CERT-NO.
  7258             20  PB-CERT-PRIME            PIC X(10).
  7259             20  PB-CERT-SFX              PIC X.
  7260         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7261
  7262         16  PB-RECORD-TYPE               PIC X.
  7263             88  PB-MAILING-DATA                VALUE '0'.
  7264             88  PB-ISSUE                       VALUE '1'.
  7265             88  PB-CANCELLATION                VALUE '2'.
  7266             88  PB-BATCH-TRAILER               VALUE '9'.
  7267
  7268     12  PB-CONTROL-BY-ORIG-BATCH.
  7269         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7270         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7271         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7272         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7273
  7274     12  PB-CONTROL-BY-CSR.
  7275         16  PB-CSR-COMPANY-CD            PIC X.
  7276         16  PB-CSR-ID                    PIC X(4).
  7277         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7278         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7279         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7280******************************************************************
  7281*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7282******************************************************************
  7283
  7284     12  PB-LAST-MAINT-DT                 PIC XX.
  7285     12  PB-LAST-MAINT-BY                 PIC X(4).
  7286     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7287
  7288     12  PB-RECORD-BODY                   PIC X(375).
  7289
  7290     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7291         16  PB-CERT-ORIGIN               PIC X.
  7292             88  CLASIC-CREATED-CERT         VALUE '1'.
  7293         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 140
* EL689.cbl
  7294             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7295             20  PB-I-INSURED-FIRST-NAME.
  7296                 24  PB-I-INSURED-1ST-INIT PIC X.
  7297                 24  FILLER                PIC X(9).
  7298             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7299         16  PB-I-AGE                     PIC S99   COMP-3.
  7300         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7301         16  PB-I-BIRTHDAY                PIC XX.
  7302         16  PB-I-INSURED-SEX             PIC X.
  7303             88  PB-SEX-MALE     VALUE 'M'.
  7304             88  PB-SEX-FEMALE   VALUE 'F'.
  7305
  7306         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7307         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7308         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7309         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7310         16  PB-I-SKIP-CODE               PIC X.
  7311             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7312             88  PB-SKIP-JULY              VALUE '1'.
  7313             88  PB-SKIP-AUGUST            VALUE '2'.
  7314             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7315             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7316             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7317             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7318             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7319             88  PB-SKIP-JUNE              VALUE '8'.
  7320             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7321             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7322             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7323         16  PB-I-TERM-TYPE               PIC X.
  7324             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7325             88  PB-PAID-WEEKLY            VALUE 'W'.
  7326             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7327             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7328             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7329         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7330         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7331         16  PB-I-DATA-ENTRY-SW           PIC X.
  7332             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7333             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7334             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7335             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7336         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7337         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7338*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7339         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7340         16  FILLER                       PIC X.
  7341
  7342         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7343             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7344             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7345                                                   '90' THRU '99'.
  7346         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7347                                          PIC XX.
  7348         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7349         16  PB-I-AMOUNT-FINANCED REDEFINES
  7350                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7351         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 141
* EL689.cbl
  7352         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7353                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7354         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7355         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7356         16  PB-I-CLP-AMOUNT REDEFINES
  7357                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7358         16  PB-I-LF-CALC-FLAG            PIC X.
  7359             88 PB-COMP-LF-PREM               VALUE '?'.
  7360         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7361         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7362         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7363         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7364         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7365         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7366         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7367         16  PB-I-LF-ABBR                 PIC XXX.
  7368         16  PB-I-LF-INPUT-CD             PIC XX.
  7369
  7370         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7371             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7372             88  PB-INVALID-AH               VALUE '  ' '00'
  7373                                                   '90' THRU '99'.
  7374         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7375         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7376         16  PB-I-AH-CALC-FLAG            PIC X.
  7377             88 PB-COMP-AH-PREM                  VALUE '?'.
  7378         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7379         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7380         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7381         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7382         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7383         16  PB-I-AH-ABBR                 PIC XXX.
  7384         16  PB-I-AH-INPUT-CD             PIC XXX.
  7385
  7386         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7387         16  PB-I-REIN-TABLE              PIC XXX.
  7388         16  PB-I-BUSINESS-TYPE           PIC 99.
  7389         16  PB-I-INDV-GRP-CD             PIC X.
  7390         16  PB-I-MORT-CODE.
  7391             20  PB-I-TABLE               PIC X.
  7392             20  PB-I-INTEREST            PIC XX.
  7393             20  PB-I-MORT-TYP            PIC X.
  7394         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7395         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7396         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7397         16  PB-I-INDV-GRP-OVRD           PIC X.
  7398         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7399         16  PB-I-SIG-SW                  PIC X.
  7400             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7401         16  PB-I-RATE-CLASS              PIC XX.
  7402         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7403         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7404         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7405         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7406         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7407         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7408         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7409         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 142
* EL689.cbl
  7410         16  PB-I-OB-FLAG                 PIC X.
  7411             88  PB-I-OB                      VALUE 'B'.
  7412             88  PB-I-SUMMARY                 VALUE 'Z'.
  7413         16  PB-I-ENTRY-STATUS            PIC X.
  7414             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7415                                              'M' '5' '9' '2'.
  7416             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7417             88  PB-I-POLICY-PENDING          VALUE '2'.
  7418             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7419             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7420             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7421             88  PB-I-REIN-ONLY               VALUE '9'.
  7422             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7423             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7424             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7425             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7426         16  PB-I-INT-CODE                PIC X.
  7427             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7428             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7429         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7430         16  PB-I-SOC-SEC-NO              PIC X(11).
  7431         16  PB-I-MEMBER-NO               PIC X(12).
  7432         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7433*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7434         16  PB-I-OLD-LOF                 PIC XXX.
  7435         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7436         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7437         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7438         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7439         16  PB-I-LIFE-INDICATOR          PIC X.
  7440             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7441         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7442         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7443                                          PIC S9(5)V99    COMP-3.
  7444         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7445             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7446             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7447         16  PB-I-1ST-PMT-DT              PIC XX.
  7448         16  PB-I-JOINT-INSURED.
  7449             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7450             20 PB-I-JOINT-FIRST-NAME.
  7451                24  PB-I-JOINT-FIRST-INIT PIC X.
  7452                24  FILLER                PIC X(9).
  7453             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7454*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7455         16  PB-I-BENEFICIARY-NAME.
  7456             20  PB-I-BANK-NUMBER         PIC X(10).
  7457             20  FILLER                   PIC X(15).
  7458         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7459         16  PB-I-REFERENCE               PIC X(12).
  7460         16  FILLER REDEFINES PB-I-REFERENCE.
  7461             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7462             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7463             20  PB-I-CLP-STATE           PIC XX.
  7464         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7465             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7466             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7467             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 143
* EL689.cbl
  7468         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7469         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7470         16  PB-I-RESIDENT-STATE          PIC XX.
  7471         16  PB-I-RATE-CODE               PIC X(4).
  7472         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7473         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7474         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7475         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7476         16  PB-I-BANK-NOCHRGB            PIC 99.
  7477         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7478         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7479
  7480     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7481         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7482             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7483         16  PB-C-CANCEL-ORIGIN           PIC X.
  7484             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7485         16  PB-C-LF-CANCEL-DT            PIC XX.
  7486         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7487         16  PB-C-LF-CALC-REQ             PIC X.
  7488             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7489         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7490         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7491         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7492             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7493         16  PB-C-AH-CANCEL-DT            PIC XX.
  7494         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7495         16  PB-C-AH-CALC-REQ             PIC X.
  7496             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7497         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7498         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7499         16  PB-C-LAST-NAME               PIC X(15).
  7500         16  PB-C-REFUND-SW               PIC X.
  7501             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7502             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7503         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7504         16  PB-C-PAYEE-CODE              PIC X(6).
  7505         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7506         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7507         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7508         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7509         16  PB-C-REFERENCE               PIC X(12).
  7510         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7511         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7512         16  PB-C-POST-CARD-IND           PIC X.
  7513         16  PB-C-CANCEL-REASON           PIC X.
  7514         16  PB-C-REF-INTERFACE-SW        PIC X.
  7515         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7516         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7517         16  FILLER                       PIC X(01).
  7518*        16  FILLER                       PIC X(18).
  7519         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7520*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7521         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7522         16  PB-CANCELED-CERT-DATA.
  7523             20  PB-CI-INSURED-NAME.
  7524                 24  PB-CI-LAST-NAME      PIC X(15).
  7525                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 144
* EL689.cbl
  7526             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7527             20  PB-CI-INSURED-SEX        PIC X.
  7528             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7529             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7530             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7531             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7532             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7533             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7534             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7535             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7536             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7537             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7538             20  PB-CI-RATE-CLASS         PIC XX.
  7539             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7540             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7541             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7542             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7543             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7544             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7545             20  PB-CI-LF-ABBR            PIC X(3).
  7546             20  PB-CI-AH-ABBR            PIC X(3).
  7547             20  PB-CI-OB-FLAG            PIC X.
  7548                 88  PB-CI-OB                VALUE 'B'.
  7549             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7550                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7551                                           'M' '4' '5' '9' '2'.
  7552                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7553                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7554                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7555                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7556                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7557                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7558                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7559                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7560                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7561                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7562                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7563                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7564             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7565                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7566                                           'M' '4' '5' '9' '2'.
  7567                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7568                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7569                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7570                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7571                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7572                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7573                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7574                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7575                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7576                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7577                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7578                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7579             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7580             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7581             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7582             20  PB-CI-MEMBER-NO          PIC X(12).
  7583             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 145
* EL689.cbl
  7584                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7585                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7586             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7587             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7588             20  PB-CI-COMP-EXCP-SW       PIC X.
  7589                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7590                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7591             20  PB-CI-ENTRY-STATUS       PIC X.
  7592             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7593             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7594             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7595             20  PB-CI-DEATH-DT           PIC XX.
  7596             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7597             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7598             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7599             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7600             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7601             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7602             20  PB-CI-ENTRY-DT              PIC XX.
  7603             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7604             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7605             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7606             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7607             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7608             20  PB-CI-OLD-LOF               PIC XXX.
  7609*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7610             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7611             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7612             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7613             20  PB-CI-INDV-GRP-CD           PIC X.
  7614             20  PB-CI-BENEFICIARY-NAME.
  7615                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7616                 24  FILLER                  PIC X(15).
  7617             20  PB-CI-NOTE-SW               PIC X.
  7618             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7619             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7620             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7621             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7622             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7623             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7624             20  PB-CI-FIRST-NAME            PIC X(10).
  7625             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7626
  7627         16  FILLER                       PIC X(13).
  7628*032306  16  FILLER                       PIC X(27).
  7629*        16  FILLER                       PIC X(46).
  7630
  7631     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7632         16  FILLER                       PIC X(10).
  7633         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7634         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7635         16  PB-M-INSURED-MID-INIT        PIC X.
  7636         16  PB-M-INSURED-AGE             PIC 99.
  7637         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7638         16  PB-M-INSURED-SEX             PIC X.
  7639         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7640         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7641         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 146
* EL689.cbl
  7642         16  PB-M-INSURED-CITY-STATE.
  7643             20  PB-M-INSURED-CITY        PIC X(28).
  7644             20  PB-M-INSURED-STATE       PIC XX.
  7645         16  PB-M-INSURED-ZIP-CODE.
  7646             20  PB-M-INSURED-ZIP-PRIME.
  7647                 24  PB-M-INSURED-ZIP-1   PIC X.
  7648                     88  PB-M-CANADIAN-POST-CODE
  7649                                             VALUE 'A' THRU 'Z'.
  7650                 24  FILLER               PIC X(4).
  7651             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7652         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7653                                        PB-M-INSURED-ZIP-CODE.
  7654             20  PM-M-INS-CAN-POST1       PIC XXX.
  7655             20  PM-M-INS-CAN-POST2       PIC XXX.
  7656             20  FILLER                   PIC XXX.
  7657         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7658         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7659         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7660         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7661         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7662         16  PB-M-CRED-BENE-CITYST.
  7663             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7664             20  PB-M-CRED-BENE-STATE     PIC XX.
  7665         16  FILLER                       PIC X(92).
  7666
  7667     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7668         16  FILLER                       PIC X(10).
  7669         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7670         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7671         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7672         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7673         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7674         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7675         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7676         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7677         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7678         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7679         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7680         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7681         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7682         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7683         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7684         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7685         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7686         16  PB-ACCOUNT-NAME              PIC X(30).
  7687         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7688         16  PB-REFERENCE                 PIC X(12).
  7689         16  PB-B-RECEIVED-DT             PIC XX.
  7690         16  FILLER                       PIC X(234).
  7691
  7692     12  PB-RECORD-STATUS.
  7693         16  PB-CREDIT-SELECT-DT          PIC XX.
  7694         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7695         16  PB-BILLED-DT                 PIC XX.
  7696         16  PB-BILLING-STATUS            PIC X.
  7697             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7698             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7699             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 147
* EL689.cbl
  7700         16  PB-RECORD-BILL               PIC X.
  7701             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7702             88  PB-RECORD-RETURNED           VALUE 'R'.
  7703             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7704             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7705             88  PB-OVERRIDE-AH               VALUE 'A'.
  7706             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7707         16  PB-BATCH-ENTRY               PIC X.
  7708             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7709             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7710             88  PB-REISSUED-CERT             VALUE 'E'.
  7711             88  PB-MONTHLY-CERT              VALUE 'M'.
  7712             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7713             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7714             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7715         16  PB-FORCE-CODE                PIC X.
  7716             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7717             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7718             88  PB-CANCEL-FORCE              VALUE '8'.
  7719             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7720             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7721             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7722             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7723             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7724             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7725             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7726         16  PB-FATAL-FLAG                PIC X.
  7727             88  PB-FATAL-ERRORS              VALUE 'X'.
  7728         16  PB-FORCE-ER-CD               PIC X.
  7729             88  PB-FORCE-ERRORS              VALUE 'F'.
  7730             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7731         16  PB-WARN-ER-CD                PIC X.
  7732             88  PB-WARNING-ERRORS            VALUE 'W'.
  7733         16  FILLER                       PIC X.
  7734         16  PB-OUT-BAL-CD                PIC X.
  7735             88  PB-OUT-OF-BAL                VALUE 'O'.
  7736         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7737         16  PB-AH-OVERRIDE-L1            PIC X.
  7738         16  PB-INPUT-DT                  PIC XX.
  7739         16  PB-INPUT-BY                  PIC X(4).
  7740         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7741         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7742         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7743         16  PB-LF-EARNING-METHOD         PIC X.
  7744         16  PB-AH-EARNING-METHOD         PIC X.
  7745         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7746         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7747         16  PB-REIN-CD                   PIC XXX.
  7748         16  PB-LF-REFUND-TYPE            PIC X.
  7749         16  PB-AH-REFUND-TYPE            PIC X.
  7750         16  PB-ACCT-EFF-DT               PIC XX.
  7751         16  PB-ACCT-EXP-DT               PIC XX.
  7752         16  PB-COMPANY-ID                PIC X(3).
  7753         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7754         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7755         16  PB-SV-CARRIER                PIC X.
  7756         16  PB-SV-GROUPING               PIC X(6).
  7757         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 148
* EL689.cbl
  7758         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7759         16  PB-GA-BILLING-INFO.
  7760             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7761                                          PIC XX.
  7762         16  PB-SV-REMIT-TO  REDEFINES
  7763             PB-GA-BILLING-INFO           PIC X(10).
  7764         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7765         16  PB-I-LOAN-OFFICER            PIC X(5).
  7766         16  PB-I-VIN                     PIC X(17).
  7767
  7768         16  FILLER                       PIC X(04).
  7769         16  IMNET-BYPASS-SW              PIC X.
  7770
  7771******************************************************************
  7772*                COMMON EDIT ERRORS                              *
  7773******************************************************************
  7774
  7775     12  PB-COMMON-ERRORS.
  7776         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7777                                           PIC S9(4)     COMP.
  7778
  7779******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 149
* EL689.cbl
  7781*    COPY ERCPYAJ.
  7782******************************************************************
  7783*                                                                *
  7784*                            ERCPYAJ                             *
  7785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7786*                            VMOD=2.015                          *
  7787*                                                                *
  7788*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7789*                                                                *
  7790*                                                                *
  7791*   FILE TYPE = VSAM,KSDS                                        *
  7792*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7793*                                                                *
  7794*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7795*       ALTERNATE PATHS = NONE                                   *
  7796*                                                                *
  7797*   LOG = YES                                                    *
  7798*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7799******************************************************************
  7800******************************************************************
  7801*                   C H A N G E   L O G
  7802*
  7803* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7804*-----------------------------------------------------------------
  7805*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7806* EFFECTIVE    NUMBER
  7807*-----------------------------------------------------------------
  7808* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7809* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7810******************************************************************
  7811
  7812 01  PENDING-PAY-ADJ.
  7813     12  PY-RECORD-ID                     PIC XX.
  7814         88  VALID-PY-ID                        VALUE 'PY'.
  7815
  7816     12  PY-CONTROL-PRIMARY.
  7817         16  PY-COMPANY-CD                PIC X.
  7818         16  PY-CARRIER                   PIC X.
  7819         16  PY-GROUPING                  PIC X(6).
  7820         16  PY-FIN-RESP                  PIC X(10).
  7821         16  PY-ACCOUNT                   PIC X(10).
  7822         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7823                                          PIC X(10).
  7824         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7825         16  PY-RECORD-TYPE               PIC X.
  7826             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7827             88  PY-DEPOSIT                   VALUE 'D'.
  7828             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7829             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7830             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7831             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7832             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7833             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7834             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7835             88  PY-FICA-ENTRY                VALUE 'F'.
  7836             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7837             88  PY-POLICY-FEE                VALUE 'W'.
  7838             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 150
* EL689.cbl
  7839
  7840     12  PY-PYMT-TYPE                     PIC X.
  7841             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7842             88  PY-REINS-PYMT                VALUE 'R'.
  7843             88  PY-EXP-PYMT                  VALUE 'E'.
  7844
  7845     12  PY-BIL-INV                       PIC X(6).
  7846     12  PY-REF-NO                        PIC X(12).
  7847
  7848     12  PY-LAST-MAINT-DT                 PIC XX.
  7849     12  PY-LAST-MAINT-BY                 PIC X(4).
  7850     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7851
  7852     12  PY-PYADJ-RECORD.
  7853         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7854         16  PY-ENTRY-COMMENT             PIC X(30).
  7855         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7856             20  PY-GL-ACCOUNT            PIC X(10).
  7857             20  PY-GL-STATE              PIC X(02).
  7858             20  PY-GL-CANC-SW            PIC X(01).
  7859                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7860                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7861             20  PY-GL-COMMENT            PIC X(10).
  7862             20  FILLER      REDEFINES PY-GL-COMMENT.
  7863                 24  PY-GL-CHECK-NO       PIC 9(06).
  7864                 24  FILLER               PIC X(04).
  7865             20  FILLER                   PIC X(07).
  7866         16  PY-SAVE-ACCOUNT              PIC X(10).
  7867         16  PY-SAVE-TYPE                 PIC X(01).
  7868
  7869         16  PY-LETTERS.
  7870             20  PY-LETTER OCCURS 3 TIMES
  7871                           INDEXED BY PY-LET-NDX
  7872                                          PIC X(04).
  7873
  7874         16  PY-ERCOMP-TYPE               PIC X.
  7875             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7876             88  PY-GA-TYPE                   VALUE 'G'.
  7877             88  PY-BANK-TYPE                 VALUE 'B'.
  7878         16  FILLER                       PIC X(05).
  7879
  7880     12  PY-RECORD-STATUS.
  7881         16  PY-CREDIT-SELECT-DT          PIC XX.
  7882         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7883         16  PY-BILLED-DATE               PIC XX.
  7884         16  PY-REPORTED-DT               PIC XX.
  7885         16  PY-PMT-APPLIED               PIC X.
  7886             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7887             88  PY-GA-PMT                    VALUE 'G'.
  7888             88  PY-OVWRITE-PMT               VALUE 'O'.
  7889             88  PY-NON-AR-PMT                VALUE 'N'.
  7890         16  FILLER                       PIC X(5).
  7891         16  PY-INPUT-DT                  PIC XX.
  7892         16  PY-CHECK-NUMBER              PIC X(6).
  7893         16  PY-VOID-SW                   PIC X.
  7894             88  PY-CHECK-VOIDED              VALUE 'V'.
  7895         16  PY-CHECK-ORIGIN-SW           PIC X.
  7896             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 151
* EL689.cbl
  7897             88  PY-REFUND-CHECK              VALUE 'R'.
  7898             88  PY-GA-CHECK                  VALUE 'G'.
  7899             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7900             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7901         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7902         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7903         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7904         16  PY-BILL-FLAG                 PIC X.
  7905             88  PY-BILLED                    VALUE 'B'.
  7906         16  PY-AR-FLAG                   PIC X.
  7907             88  PY-AR-CYCLE                  VALUE 'C'.
  7908             88  PY-AR-MONTH-END              VALUE 'M'.
  7909         16  PY-AR-DATE                   PIC XX.
  7910
  7911     12  PY-GL-CODES.
  7912         16  PY-GL-DB                     PIC X(14).
  7913         16  PY-GL-CR                     PIC X(14).
  7914         16  PY-GL-FLAG                   PIC X.
  7915         16  PY-GL-DATE                   PIC XX.
  7916
  7917     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7918     12  FILLER                           PIC X(3).
  7919******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 152
* EL689.cbl
  7921*    COPY ELCTEXT.
  7922******************************************************************
  7923*                                                                *
  7924*                                                                *
  7925*                            ELCTEXT.                            *
  7926*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7927*                            VMOD=2.008                          *
  7928*                                                                *
  7929*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7930*                                     FORM LETTERS,              *
  7931*                                     CERT FORM DISPLAY.
  7932*                                                                *
  7933*   FILE TYPE = VSAM,KSDS                                        *
  7934*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7935*                                                                *
  7936*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7937*       ALTERNATE INDEX = NONE                                   *
  7938*                                                                *
  7939*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7940*       ALTERNATE INDEX = NONE                                   *
  7941*                                                                *
  7942*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7943*       ALTERNATE INDEX = NONE                                   *
  7944*                                                                *
  7945*   LOG = NO                                                     *
  7946*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7947******************************************************************
  7948 01  TEXT-FILES.
  7949     12  TEXT-FILE-ID                PIC XX.
  7950         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7951         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7952         88  HELP-FILE-TEXT             VALUE 'TH'.
  7953
  7954     12  TX-CONTROL-PRIMARY.
  7955         16  TX-COMPANY-CD           PIC X.
  7956             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7957         16  TX-ACCESS-CD-GENL       PIC X(12).
  7958
  7959         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7960             20  TX-LETTER-NO        PIC X(4).
  7961             20  FILLER              PIC X(8).
  7962
  7963         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7964             20  TX-FORM-NO          PIC X(12).
  7965
  7966         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7967             20  TX-HELP-TYPE        PIC X.
  7968                 88  HELP-FOR-GENERAL   VALUE ' '.
  7969                 88  HELP-BY-SCREEN     VALUE 'S'.
  7970                 88  HELP-BY-ERROR      VALUE 'E'.
  7971             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7972                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7973             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7974                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7975             20  FILLER              PIC X(4).
  7976
  7977         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7978
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 153
* EL689.cbl
  7979     12  TX-PROCESS-CONTROL          PIC XX.
  7980         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7981
  7982     12  TX-TEXT-LINE                PIC X(70).
  7983
  7984     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7985         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7986         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7987         88  TX-VALID-FORM-SQUEEZE-VALUE
  7988                                        VALUE 'Y' ' '.
  7989
  7990     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7991         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7992         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7993         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7994         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7995         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7996         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7997         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7998                                              'K' 'N' ' '
  7999                                              'Z'.
  8000
  8001     12  TX-ARCHIVE-SW               PIC X.
  8002         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  8003         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  8004         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  8005
  8006     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  8007     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  8008
  8009     12  TX-BSR-CODE                 PIC X.
  8010         88  TX-BSR-LETTER              VALUE 'B'.
  8011         88  TX-NON-BSR-LETTER          VALUE ' '.
  8012
  8013     12  FILLER                      PIC X.
  8014*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 154
* EL689.cbl
  8016*    COPY ERCENDT.
  8017******************************************************************
  8018*                                                                *
  8019*                                                                *
  8020*                            ERCENDT.                            *
  8021*                            VMOD=2.001                          *
  8022*                                                                *
  8023*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  8024*                                                                *
  8025*   FILE TYPE = VSAM,KSDS                                        *
  8026*   RECORD SIZE = 579  RECFORM = FIXED                           *
  8027*                                                                *
  8028*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  8029*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  8030*                                                                *
  8031*   LOG = NO                                                     *
  8032*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8033******************************************************************
  8034*-----------------------------------------------------------------
  8035*                   C H A N G E   L O G
  8036*
  8037* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8038*-----------------------------------------------------------------
  8039*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8040* EFFECTIVE    NUMBER
  8041*-----------------------------------------------------------------
  8042* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  8043*                                WITH OPEN CLAIMS
  8044* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  8045* 110612    2012101700002  AJRA  ADD NEW FIELDS
  8046* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8047*-----------------------------------------------------------------
  8048 01  ENDORSEMENT-RECORD.
  8049     12  EN-RECORD-ID                PIC XX.
  8050         88  VALID-EN-ID                VALUE 'EN'.
  8051     12  EN-CONTROL-PRIMARY.
  8052         16  EN-COMPANY-CD           PIC X.
  8053         16  EN-CARRIER              PIC X.
  8054         16  EN-GROUPING             PIC X(6).
  8055         16  EN-STATE                PIC XX.
  8056         16  EN-ACCOUNT              PIC X(10).
  8057         16  EN-CERT-EFF-DT          PIC XX.
  8058         16  EN-CERT-NO.
  8059             20  EN-CERT-PRIME       PIC X(10).
  8060             20  EN-CERT-SFX         PIC X.
  8061         16  EN-REC-TYPE             PIC X.
  8062             88  EN-ISSUE               VALUE 'I'.
  8063             88  EN-CANCELLATION        VALUE 'C'.
  8064         16  EN-SEQ-NO               PIC 9(04) BINARY.
  8065     12  EN-CONTROL-BY-ARCH-NO.
  8066         16  EN-COMPANY-CD-A1              PIC X.
  8067         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  8068     12  EN-LAST-MAINT-DT            PIC XX.
  8069     12  EN-LAST-MAINT-BY            PIC X(4).
  8070     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  8071     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  8072     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8073         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 155
* EL689.cbl
  8074         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  8075         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  8076         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  8077         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  8078         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  8079         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  8080         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  8081         16  EN-LF-ORIG-BENCD        PIC XX.
  8082         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  8083         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8084         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8085         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  8086         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  8087         16  EN-LF-ORIG-EXP-DT       PIC XX.
  8088*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  8089         16  EN-ORIG-CRED-BENE       PIC X(25).
  8090         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8091         16  FILLER                  PIC X.
  8092         16  EN-AH-ORIG-BENCD        PIC XX.
  8093         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  8094         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8095         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8096         16  EN-AH-ORIG-EXP-DT       PIC XX.
  8097*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  8098*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  8099         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8100         16  F                       PIC X(09).
  8101         16  EN-AH-ORIG-CP           PIC 99.
  8102         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  8103         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  8104         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  8105         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  8106         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  8107         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  8108         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  8109         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  8110         16  EN-LF-NEW-BENCD         PIC XX.
  8111         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  8112         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8113         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8114         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8115         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8116         16  EN-LF-NEW-EXP-DT        PIC XX.
  8117         16  EN-NEW-CRED-BENE        PIC X(25).
  8118         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8119         16  FILLER                  PIC X.
  8120         16  EN-AH-NEW-BENCD         PIC XX.
  8121         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8122         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8123         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8124         16  EN-AH-NEW-EXP-DT        PIC XX.
  8125*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8126*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8127*        16  F                       PIC X(12).
  8128         16  EN-AH-NEW-CP            PIC 99.
  8129         16  EN-SIG-SW               PIC X.
  8130         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8131         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 156
* EL689.cbl
  8132         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8133         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8134         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8135         16  FILLER                  PIC X(33).
  8136     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8137         16  EN-LF-ORIG-REF-DT       PIC XX.
  8138         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8139         16  EN-AH-ORIG-REF-DT       PIC XX.
  8140         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8141         16  EN-LF-NEW-REF-DT        PIC XX.
  8142         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8143         16  EN-AH-NEW-REF-DT        PIC XX.
  8144         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8145         16  EN-FLAG-CERT            PIC X.
  8146         16  EN-INS-LAST-NAME        PIC X(15).
  8147         16  EN-INS-FIRST-NAME       PIC X(10).
  8148         16  EN-INS-MIDDLE-INIT      PIC X.
  8149         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8150         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8151         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8152         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8153         16  FILLER                  PIC X(262).
  8154     12  EN-MONEY-SW             PIC X.
  8155     12  EN-HEALTH-APP           PIC X.
  8156     12  EN-VOUCHER-SW           PIC X.
  8157     12  EN-PAYEE                PIC X(14).
  8158     12  EN-INPUT-DT             PIC XX.
  8159     12  EN-PROCESS-DT           PIC XX.
  8160     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8161     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8162     12  EN-REASON-CODES.
  8163         16  F OCCURS 12.
  8164             20  EN-REASON-CODE  PIC X(4).
  8165     12  EN-TEMPLATE-USED        PIC X(8).
  8166     12  EN-DOCU-TYPE            PIC X.
  8167         88  EN-VERI-DOCU          VALUE 'V'.
  8168         88  EN-GCE-DOCU           VALUE 'G'.
  8169         88  EN-CANC-DOCU          VALUE 'C'.
  8170     12  EN-COMMENTS1            PIC X(13).
  8171     12  EN-COMMENTS2            PIC X(70).
  8172     12  EN-COMM-CHGBK           PIC X.
  8173         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8174         88  EN-CHG-ACCT           VALUE 'Y'.
  8175     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8176     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8177     12  EN-BATCH-NUMBER         PIC X(6).
  8178     12  EN-ACCT-SUMM            PIC X.
  8179     12  EN-CSO-SUMM             PIC X.
  8180     12  FILLER                  PIC X(13).
  8181******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 157
* EL689.cbl
  8183*    COPY ERCNOTE.
  8184******************************************************************
  8185*                                                                *
  8186*                                                                *
  8187*                            ERCNOTE                             *
  8188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8189*                            VMOD=2.003                          *
  8190*                                                                *
  8191*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  8192*                                                                *
  8193*        FILE TYPE= VSAM,KSDS                                    *
  8194*        RECORD SIZE = 825    RECFORM = FIXED                    *
  8195*                                                                *
  8196*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  8197*                                                                *
  8198*        LOG = YES                                               *
  8199*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8200*                                                                *
  8201******************************************************************
  8202*                   C H A N G E   L O G
  8203*
  8204* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8205*-----------------------------------------------------------------
  8206*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8207* EFFECTIVE    NUMBER
  8208*-----------------------------------------------------------------
  8209* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  8210*                                FILE WILL CONTAIN BILLING NOTES O
  8211******************************************************************
  8212
  8213 01  CERTIFICATE-NOTE.
  8214     12  CN-RECORD-ID                PIC  XX.
  8215         88  VALID-CN-ID                  VALUE 'CN'.
  8216
  8217     12  CN-CONTROL-PRIMARY.
  8218         16  CN-COMPANY-CD           PIC X.
  8219         16  CN-CARRIER              PIC X.
  8220         16  CN-GROUPING.
  8221             20 CN-GROUPING-PREFIX   PIC XXX.
  8222             20 CN-GROUPING-PRIME    PIC XXX.
  8223         16  CN-STATE                PIC XX.
  8224         16  CN-ACCOUNT.
  8225             20 CN-ACCOUNT-PREFIX    PIC X(4).
  8226             20 CN-ACCOUNT-PRIME     PIC X(6).
  8227         16  CN-CERT-EFF-DT          PIC XX.
  8228         16  CN-CERT-NO.
  8229             20  CN-CERT-PRIME       PIC X(10).
  8230             20  CN-CERT-SFX         PIC X.
  8231
  8232     12  CN-BILLING-START-LINE-NO    PIC 99.
  8233     12  CN-BILLING-END-LINE-NO      PIC 99.
  8234
  8235     12  CN-LINES.
  8236         16  CN-LINE OCCURS 10       PIC X(77).
  8237
  8238     12  CN-LAST-MAINT-DT            PIC XX.
  8239     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8240     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 158
* EL689.cbl
  8241     12  FILLER                      PIC X(6).
  8242******************************************************************
  8243*    COPY ELCEOBC.
  8244******************************************************************
  8245*                                                                *
  8246*                                                                *
  8247*                            ELCEOBC                             *
  8248*                            VMOD=2.001                          *
  8249*                                                                *
  8250*   CLAIM SYSTEM EOB CODE TABLE                                  *
  8251*                                                                *
  8252*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  8253*   VSAM EOB CODE TABLE                                          *
  8254*                                                                *
  8255*   FILE DESCRIPTION = EOB CODE TABLE                            *
  8256*                                                                *
  8257*   FILE TYPE = VSAM,KSDS                                        *
  8258*   RECORD SIZE = 350   RECFORM = FIX                            *
  8259*                                                                *
  8260*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  8261*                                                                *
  8262*   LOG = NO                                                     *
  8263*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8264*                                                                *
  8265*                                                                *
  8266******************************************************************
  8267*                   C H A N G E   L O G
  8268*
  8269* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8270*-----------------------------------------------------------------
  8271*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8272* EFFECTIVE    NUMBER
  8273*-----------------------------------------------------------------
  8274* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  8275* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  8276* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  8277******************************************************************
  8278 01  EOB-CODES.
  8279     12  EO-RECORD-ID                      PIC XX.
  8280         88  VALID-DN-ID                      VALUE 'EO'.
  8281     12  EO-CONTROL-PRIMARY.
  8282         16  EO-COMPANY-CD                 PIC X.
  8283         16  EO-RECORD-TYPE                PIC X.
  8284             88  EO-EOB-RECS                  VALUE '1'.
  8285             88  EO-VERIF-RECS                VALUE '2'.
  8286             88  EO-GCE-RECS                  VALUE '3'.
  8287             88  EO-CANC-RECS                 VALUE '4'.
  8288             88  EO-BILL-NOTE-RECS            VALUE '5'.
  8289         16  EO-EOB-CODE                   PIC X(4).
  8290         16  FILLER                        PIC X(9).
  8291     12  EO-MAINT-INFORMATION.
  8292         16  EO-LAST-MAINT-DT              PIC XX.
  8293         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8294         16  EO-LAST-MAINT-USER            PIC X(4).
  8295         16  FILLER                        PIC XX.
  8296     12  EO-DESCRIPTION                    PIC X(275).
  8297     12  FILLER                            PIC X(46).
  8298******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 159
* EL689.cbl
  8300*    COPY ELCENCC.
  8301******************************************************************
  8302*                                                                *
  8303*                                                                *
  8304*                            ELCENCC                             *
  8305*                            VMOD=2.001                          *
  8306*                                                                *
  8307*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  8308*                                                                *
  8309*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  8310*   A NAPERSOFT DOCUMENT                                         *
  8311*                                                                *
  8312*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  8313*                                                                *
  8314*   FILE TYPE = VSAM,KSDS                                        *
  8315*   RECORD SIZE = 400   RECFORM = FIX                            *
  8316*                                                                *
  8317*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  8318*                                                                *
  8319*   LOG = NO                                                     *
  8320*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8321*                                                                *
  8322*                                                                *
  8323******************************************************************
  8324*                   C H A N G E   L O G
  8325*
  8326* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8327*-----------------------------------------------------------------
  8328*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8329* EFFECTIVE    NUMBER
  8330*-----------------------------------------------------------------
  8331* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  8332******************************************************************
  8333 01  ENCLOSURE-CODES.
  8334     12  NC-RECORD-ID                      PIC XX.
  8335         88  VALID-NC-ID                      VALUE 'NC'.
  8336     12  NC-CONTROL-PRIMARY.
  8337         16  NC-COMPANY-CD                 PIC X.
  8338         16  NC-REC-TYPE                   PIC X.
  8339             88  NC-CLAIMS                   VALUE '1'.
  8340             88  NC-ADMIN                    VALUE '2'.
  8341         16  NC-ENC-CODE                   PIC X(5).
  8342         16  FILLER                        PIC X(09).
  8343     12  NC-MAINT-INFORMATION.
  8344         16  NC-LAST-MAINT-DT              PIC XX.
  8345         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8346         16  NC-LAST-MAINT-USER            PIC X(4).
  8347         16  FILLER                        PIC XX.
  8348     12  NC-OUTPUT-STACK                   PIC XXX.
  8349     12  NC-ENCLOSURE-LINE                 PIC X(100).
  8350     12  NC-ATTACHMENTS                    PIC X(100).
  8351     12  NC-FUTURE                         PIC X(50).
  8352     12  FILLER                            PIC X(117).
  8353******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 160
* EL689.cbl
  8355 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  8356                          ACCOUNT-MASTER LETTER-ARCHIVE
  8357                          LETTER-ARCHIVE-TEXT
  8358                          CERTIFICATE-MASTER CHECK-RECORDS
  8359                          CONTROL-FILE COMPENSATION-MASTER
  8360                          MAILING-DATA PENDING-BUSINESS
  8361                          PENDING-PAY-ADJ TEXT-FILES
  8362                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  8363                          EOB-CODES ENCLOSURE-CODES.
  8364 0000-DFHEXIT SECTION.
  8365     MOVE '9#                    $   ' TO DFHEIV0.
  8366     MOVE 'EL689' TO DFHEIV1.
  8367     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8368     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  8369
  8370     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8371     MOVE '5'                    TO DC-OPTION-CODE.
  8372     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  8373     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  8374     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  8375                                    W-CURRENT-SAVE.
  8376     MOVE DC-GREG-DATE-A-EDIT    TO W-SAVE-EDIT-A-DATE
  8377     MOVE DC-DAY-OF-WEEK         TO W-SAVE-CYCLE-DAY-OF-WEEK
  8378
  8379     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8380     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  8381                                 TO EMI-SAVE-AREA.
  8382
  8383     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8384                                    W-TS-TERM-SCREEN.
  8385
  8386     IF  EIBCALEN EQUAL 0
  8387         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  8388         GO TO 8300-SEND-TEXT
  8389     END-IF.
  8390     set P to address of KIXSYS
  8391     CALL "getenv" using by value P returning var-ptr
  8392     if var-ptr = null then
  8393        display ' kixsys not set '
  8394     else
  8395        set address of var to var-ptr
  8396        move 0 to env-var-len
  8397        inspect var tallying env-var-len
  8398          for characters before X'00'
  8399*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8400        unstring var (1:env-var-len) delimited by '/'
  8401           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8402              WS-KIX-SYS
  8403        end-unstring
  8404*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8405*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8406     end-if
  8407     set P to address of KIXHOST
  8408     CALL "getenv" using by value P returning var-ptr
  8409     if var-ptr = null then
  8410        display ' kixhost not set '
  8411     else
  8412        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 161
* EL689.cbl
  8413        move 0 to env-var-len
  8414        inspect var tallying env-var-len
  8415          for characters before X'00'
  8416*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8417        MOVE var(1:env-var-len)  to ws-kixhost
  8418*       unstring var (1:env-var-len) delimited by '/'
  8419*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8420*             WS-KIX-SYS
  8421*       end-unstring
  8422        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8423*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8424     end-if
  8425
  8426**** This routine will connect to the Logic Database on SQL Server
  8427**** and call a stored procedure to determine the next business da
  8428
  8429     PERFORM 4500-CONNECT-TO-DB  THRU 4500-EXIT
  8430     IF SQLCODE = 0
  8431        PERFORM 4600-GET-NEXT-BUS-DT  THRU 4600-EXIT
  8432        IF SQLCODE = 0
  8433            MOVE WS-NEXT-BUS-DT TO W-SAVE-NEXT-BUS-DT-EDIT-A
  8434                                   W-EDIT-A-DATE
  8435            MOVE W-EDIT-A-YY    TO DC-YMD-YEAR
  8436            MOVE W-EDIT-A-MM    TO DC-YMD-MONTH
  8437            MOVE W-EDIT-A-DD    TO DC-YMD-DAY
  8438            MOVE '3'            TO DC-OPTION-CODE
  8439            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8440            IF NO-CONVERSION-ERROR
  8441               MOVE DC-BIN-DATE-1 TO W-SAVE-BIN-NEXT-BUS-DT
  8442            ELSE
  8443               MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8444               MOVE '6'         TO DC-OPTION-CODE
  8445               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8446               IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8447                  MOVE 3        TO DC-ELAPSED-DAYS
  8448               ELSE
  8449                 IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8450                    MOVE 2     TO DC-ELAPSED-DAYS
  8451                 ELSE
  8452                    MOVE 1     TO DC-ELAPSED-DAYS
  8453                 END-IF
  8454               END-IF
  8455               PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8456               IF NO-CONVERSION-ERROR
  8457                   MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8458                   MOVE DC-GREG-DATE-A-EDIT TO
  8459                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8460               ELSE
  8461                   MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8462                   MOVE W-SAVE-EDIT-A-DATE TO
  8463                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8464               END-IF
  8465            END-IF
  8466        ELSE
  8467            MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8468            MOVE '6'         TO DC-OPTION-CODE
  8469            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8470            IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 162
* EL689.cbl
  8471               MOVE 3        TO DC-ELAPSED-DAYS
  8472            ELSE
  8473              IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8474                 MOVE 2     TO DC-ELAPSED-DAYS
  8475              ELSE
  8476                 MOVE 1     TO DC-ELAPSED-DAYS
  8477              END-IF
  8478            END-IF
  8479            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8480            IF NO-CONVERSION-ERROR
  8481                MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8482                MOVE DC-GREG-DATE-A-EDIT TO
  8483                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8484            ELSE
  8485                MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8486                MOVE W-SAVE-EDIT-A-DATE TO
  8487                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8488            END-IF
  8489        END-IF
  8490     ELSE
  8491        MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8492        MOVE '6'         TO DC-OPTION-CODE
  8493        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8494        IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8495           MOVE 3        TO DC-ELAPSED-DAYS
  8496        ELSE
  8497          IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8498             MOVE 2     TO DC-ELAPSED-DAYS
  8499          ELSE
  8500             MOVE 1     TO DC-ELAPSED-DAYS
  8501          END-IF
  8502        END-IF
  8503        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8504        IF NO-CONVERSION-ERROR
  8505            MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8506            MOVE DC-GREG-DATE-A-EDIT TO
  8507                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8508        ELSE
  8509            MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8510            MOVE W-SAVE-EDIT-A-DATE TO
  8511                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8512        END-IF
  8513     END-IF
  8514
  8515     IF  PI-689-CREATE-NO-SCREENS
  8516         GO TO 0600-BYPASS-SCREEN-CNTL
  8517     END-IF.
  8518
  8519     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8520         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8521             MOVE PI-SAVED-PROGRAM-5
  8522                                 TO PI-SAVED-PROGRAM-6
  8523             MOVE PI-SAVED-PROGRAM-4
  8524                                 TO PI-SAVED-PROGRAM-5
  8525             MOVE PI-SAVED-PROGRAM-3
  8526                                 TO PI-SAVED-PROGRAM-4
  8527             MOVE PI-SAVED-PROGRAM-2
  8528                                 TO PI-SAVED-PROGRAM-3
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 163
* EL689.cbl
  8529             MOVE PI-SAVED-PROGRAM-1
  8530                                 TO PI-SAVED-PROGRAM-2
  8531             MOVE PI-RETURN-TO-PROGRAM
  8532                                 TO PI-SAVED-PROGRAM-1
  8533             MOVE PI-CALLING-PROGRAM
  8534                                 TO PI-RETURN-TO-PROGRAM
  8535             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8536             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8537             MOVE LOW-VALUES     TO EL689AO
  8538             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8539             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8540                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8541             END-IF
  8542             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8543                     AND
  8544                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  8545                 GO TO 0400-EL6311-INCOMING
  8546             ELSE
  8547                 MOVE PI-689-ARCHIVE-NUMBER
  8548                                 TO W-INCOMING-ARCHIVE
  8549                 MOVE LOW-VALUES TO PI-1042-WA
  8550                                    PI-689-WORK-AREA
  8551                 MOVE ZEROS      TO PI-CURRENT-LINE
  8552                                    PI-TEMP-STOR-ITEMS
  8553                                    PI-TOTAL-LINES
  8554                                    PI-UPDATE-SW
  8555                                    PI-689-NUMBER-LABEL-LINES
  8556                                    PI-689-NUMBER-TEXT-RECORDS
  8557                                    PI-689-ERROR
  8558                 MOVE SPACES     TO PI-689-PRINT-SW
  8559                                    PI-689-ALT-PRINTER-ID
  8560                                    PI-689-LBL-OVERRIDE
  8561                                    PI-COMM-CONTROL
  8562                                    PI-689-FORM-NUMBER
  8563                                    PI-689-TEMP-STOR-ID
  8564                                    PI-689-LABEL-SOURCE
  8565                                    PI-689-USE-SCREEN-IND
  8566                 MOVE '2'        TO PI-ACTION
  8567                 MOVE -1         TO MAINTL
  8568                 MOVE PI-LOWER-CASE-LETTERS
  8569                                 TO W-LC-CASE-IND
  8570                 IF  W-INCOMING-ARCHIVE NUMERIC
  8571                         AND
  8572                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8573                     MOVE 'S'    TO MAINTI
  8574                     MOVE +1     TO MAINTL
  8575                     MOVE AL-UANON
  8576                                 TO MAINTA
  8577                     MOVE W-INCOMING-ARCH-NO
  8578                                 TO ARCHNUMI
  8579                     MOVE +8     TO ARCHNUML
  8580                     MOVE AL-UNNON
  8581                                 TO ARCHNUMA
  8582                     GO TO 1000-SHOW
  8583                 ELSE
  8584                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8585                 END-IF
  8586             END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 164
* EL689.cbl
  8587         ELSE
  8588             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8589             MOVE PI-RETURN-TO-PROGRAM
  8590                                     TO PI-CALLING-PROGRAM
  8591             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8592             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8593             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8594             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8595             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8596             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8597             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8598             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8599             MOVE LOW-VALUES         TO EL689AO
  8600             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8601             SET W-RG-NDX            TO PI-CURRENT-LINE
  8602             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8603                 VARYING
  8604                     W-SC-NDX FROM 1 BY 1
  8605                 UNTIL
  8606                     W-SC-NDX GREATER THAN
  8607                     W-NUM-LINES-PER-SCREEN
  8608             MOVE PI-689-ALT-PRINTER-ID
  8609                                     TO PRINTERO
  8610             MOVE AL-UANON           TO PRINTERA
  8611             MOVE -1                 TO PRINTERL
  8612             GO TO 8100-SEND-INITIAL-MAP
  8613         END-IF
  8614     END-IF.
  8615
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 165
* EL689.cbl
  8617 0200-RECEIVE.
  8618
  8619     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8620     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8621     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8622             OR
  8623         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8624         MOVE 'Y'                TO W-HOLD-IND.
  8625
  8626     MOVE W-TRANSACTION          TO EIBTRNID.
  8627     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8628     MOVE ZEROS                  TO W-LAST-ERROR.
  8629     MOVE LOW-VALUES             TO EL689AI.
  8630     MOVE '104A'                 TO W-TS-ID-TEXT.
  8631     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8632                                    W-TS-TERM-SCREEN.
  8633
  8634
  8635* EXEC CICS HANDLE AID
  8636*        CLEAR    (9300-DFHCLEAR)
  8637*        PA1      (9200-PA)
  8638*        PA2      (9200-PA)
  8639*        PA3      (9200-PA)
  8640*    END-EXEC.
  8641*    MOVE '"&=!"#               V! " #00008537' TO DFHEIV0
  8642     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8643     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8644     MOVE X'2220233030303038353337' TO DFHEIV0(25:11)
  8645     CALL 'kxdfhei1' USING DFHEIV0
  8646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8647
  8648
  8649
  8650* EXEC CICS HANDLE CONDITION
  8651*        PGMIDERR (9700-PGMID-ERROR)
  8652*        ERROR    (9800-ABEND)
  8653*        MAPFAIL  (0325-MAPFAIL)
  8654*    END-EXEC.
  8655*    MOVE '"$L.?                 ! # #00008544' TO DFHEIV0
  8656     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8658     MOVE X'2320233030303038353434' TO DFHEIV0(25:11)
  8659     CALL 'kxdfhei1' USING DFHEIV0
  8660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8661
  8662
  8663
  8664* EXEC CICS SYNCPOINT
  8665*    END-EXEC.
  8666*    MOVE '6"                    !   #00008550' TO DFHEIV0
  8667     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8669     MOVE X'2020233030303038353530' TO DFHEIV0(25:11)
  8670     CALL 'kxdfhei1' USING DFHEIV0
  8671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8672
  8673
  8674     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 166
* EL689.cbl
  8675*    IF  W-LC-USE-BOTH-CASES
  8676
  8677* EXEC CICS RECEIVE
  8678*            MAP      (W-MAP)
  8679*            MAPSET   (W-MAPSET)
  8680*            INTO     (EL689AI)
  8681*            ASIS
  8682*        END-EXEC
  8683     MOVE LENGTH OF
  8684      EL689AI
  8685       TO DFHEIV11
  8686*    MOVE '8"TAI  L              ''   #00008555' TO DFHEIV0
  8687     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8688     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8689     MOVE X'2020233030303038353535' TO DFHEIV0(25:11)
  8690     CALL 'kxdfhei1' USING DFHEIV0,
  8691           W-MAP,
  8692           EL689AI,
  8693           DFHEIV11,
  8694           W-MAPSET,
  8695           DFHEIV99,
  8696           DFHEIV99
  8697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8698     ELSE
  8699
  8700* EXEC CICS RECEIVE
  8701*            MAP      (W-MAP)
  8702*            MAPSET   (W-MAPSET)
  8703*            INTO     (EL689AI)
  8704*        END-EXEC.
  8705     MOVE LENGTH OF
  8706      EL689AI
  8707       TO DFHEIV11
  8708*    MOVE '8"T I  L              ''   #00008562' TO DFHEIV0
  8709     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8710     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8711     MOVE X'2020233030303038353632' TO DFHEIV0(25:11)
  8712     CALL 'kxdfhei1' USING DFHEIV0,
  8713           W-MAP,
  8714           EL689AI,
  8715           DFHEIV11,
  8716           W-MAPSET,
  8717           DFHEIV99,
  8718           DFHEIV99
  8719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8720
  8721
  8722     IF  NOT DISPLAY-CAP
  8723         MOVE 'READ'             TO SM-READ
  8724         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8725         MOVE ER-9097            TO EMI-ERROR
  8726         MOVE -1                 TO MAINTL
  8727         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8728         GO TO 8100-SEND-INITIAL-MAP.
  8729
  8730     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8731
  8732     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 167
* EL689.cbl
  8733         GO TO 0300-CHECK-PFKEYS.
  8734
  8735     IF  EIBAID NOT EQUAL DFHENTER
  8736         MOVE ER-0004            TO EMI-ERROR
  8737         GO TO 0320-INPUT-ERROR.
  8738
  8739     IF  ENTERPFI NUMERIC
  8740             AND
  8741         ENTERPFI GREATER THAN 0
  8742             AND
  8743         ENTERPFI LESS THAN 25
  8744         MOVE PF-VALUES (ENTERPFI)
  8745                                 TO EIBAID
  8746     ELSE
  8747         MOVE ER-0029            TO EMI-ERROR
  8748         GO TO 0320-INPUT-ERROR.
  8749
  8750 0300-CHECK-PFKEYS.
  8751
  8752     IF  EIBAID EQUAL DFHPF23
  8753         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8754         MOVE ZEROS              TO PI-TOTAL-LINES
  8755                                    PI-CURRENT-LINE
  8756         MOVE EIBAID             TO PI-ENTRY-CD-1
  8757         MOVE W-XCTL-005         TO W-CALL-PGM
  8758         GO TO 9400-XCTL.
  8759
  8760     IF  EIBAID EQUAL DFHPF24
  8761         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8762         MOVE ZEROS              TO PI-TOTAL-LINES
  8763                                    PI-CURRENT-LINE
  8764         MOVE W-XCTL-626         TO W-CALL-PGM
  8765         GO TO 9400-XCTL.
  8766
  8767     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8768                                    W-FORM-CHANGED-IND.
  8769
  8770     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8771             OR
  8772         PI-SHOW-MODE
  8773         NEXT SENTENCE
  8774     ELSE
  8775         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8776                 AND
  8777             FORML NOT EQUAL ZEROS
  8778                 AND
  8779             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8780             MOVE FORMI          TO PI-689-FORM-NUMBER
  8781             MOVE LOW-VALUES     TO EL689AI
  8782                                    PI-1042-WA
  8783                                    PI-689-FOLLOW-UP-DATE
  8784                                    PI-689-PRINT-RESTRICTION
  8785                                    PI-689-RESEND-DATE-1
  8786                                    PI-689-RESEND1-EDIT
  8787                                    PI-689-FOLLOW-UP-DATE
  8788                                    PI-689-FOLLOW-UP-EDIT
  8789                                    PI-689-ERROR-IND
  8790             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 168
* EL689.cbl
  8791                                    PI-689-NUMBER-COPIES
  8792                                    PI-689-NUMBER-LABEL-LINES
  8793                                    PI-689-NUMBER-TEXT-RECORDS
  8794                                    PI-CURRENT-LINE
  8795                                    PI-TEMP-STOR-ITEMS
  8796                                    PI-TOTAL-LINES
  8797                                    PI-UPDATE-SW
  8798             MOVE SPACES         TO PI-689-PRINT-SW
  8799                                    PI-689-ALT-PRINTER-ID
  8800                                    PI-COMM-CONTROL
  8801                                    PI-689-TEMP-STOR-ID
  8802                                    PI-689-USE-SCREEN-IND
  8803                                    PI-689-RESEND-LETR-1
  8804                                    PI-CERT-FORM-ID
  8805                                    PI-CERT-REQ-IND
  8806                                    PI-REASON-REQ-IND
  8807             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8808             MOVE DFHENTER       TO EIBAID
  8809             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8810             GO TO 0330-FUNCTION-CHECK
  8811         ELSE
  8812             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8813                     OR
  8814                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8815                         AND
  8816                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8817                             OR
  8818                         ADDRSI NOT EQUAL LOW-VALUES))
  8819                     OR
  8820                 PI-689-CARRIER NOT EQUAL CARRIERI
  8821                     OR
  8822                 PI-689-GROUPING NOT EQUAL GROUPI
  8823                     OR
  8824                 PI-689-STATE NOT EQUAL STATEI
  8825                     OR
  8826                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8827                     OR
  8828                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8829                     OR
  8830                 PI-689-CERT-SFX NOT EQUAL SFXI
  8831                     OR
  8832                 PI-689-TYPE NOT EQUAL TYPEI
  8833                     OR
  8834                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8835                     OR
  8836                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8837                     OR
  8838                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8839                     OR
  8840                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8841                     OR
  8842                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8843                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8844                 MOVE DFHENTER   TO EIBAID
  8845                 GO TO 0330-FUNCTION-CHECK.
  8846
  8847*    IF  EIBAID EQUAL DFHPF1
  8848*        MOVE +7                 TO W-ROLL-COUNTER
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 169
* EL689.cbl
  8849*        GO TO 4000-ROLL-PAGE.
  8850
  8851*    IF  EIBAID EQUAL DFHPF2
  8852*        MOVE -7                 TO W-ROLL-COUNTER
  8853*        GO TO 4000-ROLL-PAGE.
  8854
  8855*    IF  EIBAID EQUAL DFHPF3
  8856*        IF  W-HOLD-ON
  8857*            MOVE ER-7245        TO EMI-ERROR
  8858*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8859*            MOVE -1             TO MAINTL
  8860*            MOVE AL-UABON       TO MAINTA
  8861*            GO TO 8200-SEND-DATAONLY
  8862*        ELSE
  8863*            GO TO 0330-FUNCTION-CHECK.
  8864*    IF (EIBAID = DFHPF8)
  8865*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8866*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8867*       MOVE ER-0029             TO EMI-ERROR
  8868*       GO TO 0320-INPUT-ERROR
  8869*    END-IF
  8870*    IF EIBAID = DFHPF4 OR DFHPF8
  8871*        IF  W-HOLD-ON
  8872*            MOVE ER-7245        TO EMI-ERROR
  8873*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8874*            MOVE -1             TO MAINTL
  8875*            MOVE AL-UABON       TO MAINTA
  8876*            GO TO 8200-SEND-DATAONLY
  8877*        ELSE
  8878*            GO TO 0330-FUNCTION-CHECK.
  8879
  8880*    IF  EIBAID = DFHPF5
  8881*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8882*        GO TO 4000-ROLL-PAGE.
  8883
  8884*    IF  EIBAID = DFHPF6
  8885*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8886*        GO TO 4000-ROLL-PAGE.
  8887
  8888     IF  EIBAID EQUAL DFHPF7
  8889         IF PI-PROMPT-IND EQUAL 'Y'
  8890             MOVE ER-0894        TO EMI-ERROR
  8891             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8892             MOVE -1             TO MAINTL
  8893             MOVE AL-UABON       TO MAINTA
  8894             GO TO 8200-SEND-DATAONLY
  8895         END-IF
  8896     END-IF.
  8897
  8898     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8899         IF  W-HOLD-ON
  8900             MOVE ER-7245        TO EMI-ERROR
  8901             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8902             MOVE -1             TO MAINTL
  8903             MOVE AL-UABON       TO MAINTA
  8904             GO TO 8200-SEND-DATAONLY
  8905         ELSE
  8906             GO TO 0330-FUNCTION-CHECK.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 170
* EL689.cbl
  8907
  8908     IF  EIBAID EQUAL DFHENTER
  8909         GO TO 0330-FUNCTION-CHECK.
  8910
  8911     MOVE ER-0029                TO EMI-ERROR.
  8912
  8913 0320-INPUT-ERROR.
  8914
  8915     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8916
  8917     IF  ENTERPFL EQUAL 0
  8918         MOVE -1                 TO MAINTL
  8919         MOVE AL-UABON           TO MAINTA
  8920     ELSE
  8921         MOVE AL-UNBON           TO ENTERPFA
  8922         MOVE -1                 TO ENTERPFL.
  8923
  8924     GO TO 8200-SEND-DATAONLY.
  8925
  8926 0325-MAPFAIL.
  8927***********************************************************
  8928*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  8929*      LETTERS ON A 3275 PRINTER.                         *
  8930***********************************************************
  8931
  8932     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8933
  8934     SET W-RG-NDX                TO PI-CURRENT-LINE.
  8935     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8936             VARYING
  8937         W-SC-NDX FROM 1 BY 1
  8938             UNTIL
  8939         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  8940
  8941     MOVE -1                     TO MAINTL.
  8942     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 171
* EL689.cbl
  8944 0330-FUNCTION-CHECK.
  8945
  8946     IF  MAINTI EQUAL 'S'
  8947*        IF EIBAID = DFHPF4 OR DFHPF8
  8948*            GO TO 7900-PRINT-LETTER-NOW
  8949*        ELSE
  8950             GO TO 1000-SHOW.
  8951
  8952     IF  NOT MODIFY-CAP
  8953         MOVE 'UPDATE'           TO SM-READ
  8954         PERFORM 9995-SECURITY-VIOLATION
  8955         MOVE ER-0070            TO EMI-ERROR
  8956         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8957         MOVE -1                 TO MAINTL
  8958         GO TO 8100-SEND-INITIAL-MAP.
  8959
  8960     IF  W-FORM-CHANGED
  8961             OR
  8962         W-KEY-FIELDS-CHANGED
  8963         GO TO 0330-EDIT.
  8964
  8965     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8966
  8967
  8968*    IF  EIBAID EQUAL DFHPF3
  8969*        IF  PI-NO-CARRIER-SECURITY
  8970*                AND
  8971*            PI-NO-ACCOUNT-SECURITY
  8972*            GO TO 5000-EDIT-MODE.
  8973
  8974     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8975         IF  PI-NO-CARRIER-SECURITY
  8976                 AND
  8977             PI-NO-ACCOUNT-SECURITY
  8978             GO TO 5400-LETTER-RELEASE
  8979         ELSE
  8980             IF  PI-689-PRINT-PERFORMED
  8981                 GO TO 5400-LETTER-RELEASE
  8982             ELSE
  8983                 MOVE AL-UNBON TO ENTERPFA
  8984                 MOVE -1       TO ENTERPFL
  8985                 MOVE ER-2398  TO EMI-ERROR
  8986                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8987                 GO TO 8200-SEND-DATAONLY.
  8988
  8989*    IF  EIBAID = DFHPF4 OR DFHPF8
  8990*        GO TO 7900-PRINT-LETTER-NOW.
  8991
  8992 0330-EDIT.
  8993
  8994     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8995             OR
  8996         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8997             OR
  8998         W-SC-TEXTL (3) NOT EQUAL ZEROS
  8999             OR
  9000         W-SC-TEXTL (4) NOT EQUAL ZEROS
  9001             OR
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 172
* EL689.cbl
  9002         W-SC-TEXTL (5) NOT EQUAL ZEROS
  9003             OR
  9004         W-SC-TEXTL (6) NOT EQUAL ZEROS
  9005             OR
  9006         W-SC-TEXTL (7) NOT EQUAL ZEROS
  9007             OR
  9008         W-SC-TEXTL (8) NOT EQUAL ZEROS
  9009             OR
  9010         W-SC-TEXTL (9) NOT EQUAL ZEROS
  9011             OR
  9012         W-SC-TEXTL (10) NOT EQUAL ZEROS
  9013             OR
  9014         W-SC-TEXTL (11) NOT EQUAL ZEROS
  9015         IF  W-KEY-FIELDS-CHANGED
  9016                 OR
  9017             W-FORM-CHANGED
  9018             MOVE ER-7250        TO EMI-ERROR
  9019             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9020             MOVE -1             TO MAINTL
  9021             MOVE AL-UABON       TO MAINTA
  9022         ELSE
  9023             PERFORM 4100-SET-NDX THRU 4100-EXIT
  9024             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  9025                     VARYING
  9026                 W-SC-NDX FROM 1 BY 1
  9027                     UNTIL
  9028                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  9029             MOVE ER-7398        TO EMI-ERROR
  9030             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9031             MOVE -1             TO MAINTL
  9032             MOVE AL-UABON       TO MAINTA
  9033             GO TO 8200-SEND-DATAONLY.
  9034
  9035     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9036
  9037     IF  W-KEY-FIELDS-CHANGED
  9038             OR
  9039         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  9040         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9041         IF  MAINTI EQUAL 'C'
  9042             GO TO 2000-CREATE
  9043         ELSE
  9044             NEXT SENTENCE
  9045     ELSE
  9046         IF  W-FORM-CHANGED
  9047             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9048             IF  MAINTI EQUAL 'C'
  9049                 GO TO 2000-CREATE
  9050             ELSE
  9051                 NEXT SENTENCE
  9052         ELSE
  9053             MOVE -1             TO MAINTL
  9054             GO TO 8200-SEND-DATAONLY.
  9055
  9056     MOVE ER-0023                TO EMI-ERROR.
  9057     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9058     MOVE -1                     TO MAINTL.
  9059     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 173
* EL689.cbl
  9060     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 174
* EL689.cbl
  9062 0350-EDIT-ROUTINE.
  9063
  9064     IF  MAINTI EQUAL 'C'
  9065             AND
  9066         FORML EQUAL ZEROS
  9067         MOVE -1                 TO FORML
  9068         MOVE ER-0177            TO EMI-ERROR
  9069         MOVE AL-UABON           TO FORMA
  9070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9071
  9072     IF PRTNOWL > ZEROS
  9073        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  9074           MOVE PRTNOWI          TO PI-PRINT-NOW
  9075           MOVE AL-UANON         TO PRTNOWA
  9076        END-IF
  9077     END-IF
  9078     IF ENDARCHL > ZEROS
  9079        IF ENDARCHI NUMERIC
  9080            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  9081            MOVE AL-UNNON       TO ENDARCHA
  9082            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  9083            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  9084            MOVE 'N'            TO W-VALID-ENDT-SW
  9085            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  9086            IF NOT W-VALID-ENDT
  9087                MOVE -1         TO ENDARCHL
  9088                MOVE ER-1565    TO EMI-ERROR
  9089                MOVE AL-UNBON   TO ENDARCHA
  9090                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9091            END-IF
  9092        END-IF
  9093     ELSE
  9094        MOVE ZEROS              TO PI-ENDT-ARCH-NO
  9095     END-IF
  9096     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  9097*    IF  PRTRESTL NOT EQUAL ZEROS
  9098*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  9099
  9100     IF  FOLLOWL NOT EQUAL ZEROS
  9101         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  9102         PERFORM 8600-DEEDIT
  9103         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9104         MOVE '4'                TO DC-OPTION-CODE
  9105         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9106         IF  DATE-CONVERSION-ERROR
  9107             MOVE ER-0182        TO EMI-ERROR
  9108             MOVE -1             TO FOLLOWL
  9109             MOVE AL-UABON       TO FOLLOWA
  9110             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111         ELSE
  9112             MOVE DC-GREG-DATE-1-EDIT
  9113                                 TO FOLLOWO
  9114                                    PI-689-FOLLOW-UP-EDIT
  9115             MOVE AL-UANON       TO FOLLOWA
  9116             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  9117     ELSE
  9118         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  9119
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 175
* EL689.cbl
  9120     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  9121         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  9122                 W-SAVE-BIN-DATE
  9123             MOVE ER-0533        TO EMI-ERROR
  9124             MOVE AL-UABON       TO FOLLOWA
  9125             MOVE -1             TO FOLLOWL
  9126             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9127
  9128     IF  RESEND1L NOT EQUAL ZEROS
  9129         MOVE RESEND1I           TO W-DEEDIT-FIELD
  9130         PERFORM 8600-DEEDIT
  9131         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9132         MOVE '4'                TO DC-OPTION-CODE
  9133         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9134         IF  DATE-CONVERSION-ERROR
  9135             MOVE ER-0185        TO EMI-ERROR
  9136             MOVE -1             TO RESEND1L
  9137             MOVE AL-UABON       TO RESEND1A
  9138             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9139         ELSE
  9140             MOVE DC-GREG-DATE-1-EDIT
  9141                                 TO RESEND1O
  9142                                    PI-689-RESEND1-EDIT
  9143             MOVE AL-UANON       TO RESEND1A
  9144             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  9145     ELSE
  9146         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  9147
  9148     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  9149         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  9150                 W-SAVE-BIN-DATE
  9151             MOVE ER-0537        TO EMI-ERROR
  9152             MOVE AL-UABON       TO RESEND1A
  9153             MOVE -1             TO RESEND1L
  9154             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9155
  9156     IF ENCL > ZEROS
  9157        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  9158                                          PI-ENCLOSURE-CD
  9159        MOVE SPACES             TO W-ELENCC-KEY
  9160        MOVE PI-COMPANY-CD      TO W-ENCC-COMPANY-CD
  9161        MOVE '2'                TO W-ENCC-REC-TYPE
  9162        MOVE ENCI               TO W-ENCC-ENC-CODE
  9163
  9164
  9165* EXEC CICS READ
  9166*           DATASET    (W-ENCC-FILE-ID)
  9167*           SET        (ADDRESS OF ENCLOSURE-CODES)
  9168*           RIDFLD     (W-ELENCC-KEY)
  9169*           RESP       (W-RESPONSE)
  9170*       END-EXEC
  9171*    MOVE '&"S        E          (  N#00009010' TO DFHEIV0
  9172     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9174     MOVE X'204E233030303039303130' TO DFHEIV0(25:11)
  9175     CALL 'kxdfhei1' USING DFHEIV0,
  9176           W-ENCC-FILE-ID,
  9177           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 176
* EL689.cbl
  9178           DFHEIV99,
  9179           W-ELENCC-KEY,
  9180           DFHEIV99,
  9181           DFHEIV99,
  9182           DFHEIV99
  9183     SET ADDRESS OF ENCLOSURE-CODES TO
  9184         DFHEIV20
  9185     MOVE EIBRESP  TO W-RESPONSE
  9186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9187
  9188        IF RESP-NORMAL
  9189           MOVE ENCI             TO PI-ENCLOSURE-CD
  9190                                    W-ENCLOSURE-CD
  9191           MOVE AL-UANON         TO ENCA
  9192        ELSE
  9193           MOVE ER-1560          TO EMI-ERROR
  9194           MOVE -1               TO ENCL
  9195           MOVE AL-UABON         TO ENCA
  9196           PERFORM 9900-ERROR-FORMAT
  9197                                 THRU 9900-EXIT
  9198        END-IF
  9199     END-IF
  9200
  9201
  9202     IF NOT PI-CREATE-LABELS
  9203         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  9204         MOVE AL-PANON           TO ADDRLBLA
  9205         GO TO 0350-BYPASS-OVERRIDE.
  9206
  9207     IF  ADDRLBLL GREATER THAN ZEROS
  9208          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9209          IF ADDRLBLI = 'N' OR 'Y'
  9210              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  9211              MOVE AL-UANON      TO ADDRLBLA
  9212          ELSE
  9213             MOVE ER-3783        TO EMI-ERROR
  9214             MOVE -1             TO ADDRLBLL
  9215             MOVE AL-UABON       TO ADDRLBLA
  9216             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9217
  9218 0350-BYPASS-OVERRIDE.
  9219
  9220     IF  PI-BYPASS-LABELS
  9221             OR
  9222         FORMI EQUAL '9999'
  9223             OR
  9224         PI-689-LABELS-OVERRIDEN
  9225         MOVE SPACES             TO PI-689-LABEL-SOURCE
  9226         MOVE LOW-VALUES         TO ADDRSI
  9227         MOVE AL-UANOF           TO ADDRSA
  9228         MOVE ZEROS              TO ADDRSL
  9229     ELSE
  9230         IF  ADDRSL GREATER THAN ZEROS
  9231             MOVE ADDRSI         TO W-LABEL-SOURCE
  9232             IF  W-LABEL-SOURCE-VALID
  9233                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  9234             ELSE
  9235                 MOVE -1         TO ADDRSL
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 177
* EL689.cbl
  9236                 MOVE ER-0176    TO EMI-ERROR
  9237                 MOVE AL-UABON   TO ADDRSA
  9238                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9239         ELSE
  9240             IF  MAINTI EQUAL 'C'
  9241                 MOVE -1         TO ADDRSL
  9242                 MOVE ER-0176    TO EMI-ERROR
  9243                 MOVE AL-UABON   TO ADDRSA
  9244                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9245
  9246     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  9247     IF  PRINTERL GREATER ZERO
  9248         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9249         MOVE AL-UANON           TO PRINTERA
  9250         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  9251                                    PI-ALT-DMD-PRT-ID
  9252     ELSE
  9253         IF  PI-NO-CARRIER-SECURITY
  9254                 AND
  9255             PI-NO-ACCOUNT-SECURITY
  9256             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  9257                 MOVE PI-PROCESSOR-PRINTER
  9258                                 TO PI-689-ALT-PRINTER-ID
  9259                                    PRINTERI
  9260                 MOVE AL-UABON   TO PRINTERA
  9261             ELSE
  9262                 MOVE PI-COMPANY-ID
  9263                                 TO W-CNTL-COMPANY-ID
  9264                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  9265                 MOVE SPACES     TO W-CNTL-GENL
  9266                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  9267
  9268* EXEC CICS HANDLE CONDITION
  9269*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  9270*                     NOTFND     (7945-NOT-FOUND)
  9271*                END-EXEC
  9272*    MOVE '"$JI                  ! $ #00009096' TO DFHEIV0
  9273     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9275     MOVE X'2420233030303039303936' TO DFHEIV0(25:11)
  9276     CALL 'kxdfhei1' USING DFHEIV0
  9277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9278
  9279* EXEC CICS READ
  9280*                     DATASET    (W-CNTL-FILE-ID)
  9281*                     SET        (ADDRESS OF CONTROL-FILE)
  9282*                     RIDFLD     (W-CNTL-KEY)
  9283*                END-EXEC
  9284*    MOVE '&"S        E          (   #00009100' TO DFHEIV0
  9285     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9286     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9287     MOVE X'2020233030303039313030' TO DFHEIV0(25:11)
  9288     CALL 'kxdfhei1' USING DFHEIV0,
  9289           W-CNTL-FILE-ID,
  9290           DFHEIV20,
  9291           DFHEIV99,
  9292           W-CNTL-KEY,
  9293           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 178
* EL689.cbl
  9294           DFHEIV99,
  9295           DFHEIV99
  9296     SET ADDRESS OF CONTROL-FILE TO
  9297         DFHEIV20
  9298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9299                 MOVE CF-FORMS-PRINTER-ID
  9300                                 TO PI-689-ALT-PRINTER-ID
  9301                                    PRINTERI
  9302                                    W-TS-TERM-TEXT
  9303                 MOVE AL-UABON   TO PRINTERA
  9304         ELSE
  9305             MOVE AL-UABON       TO PRINTERA
  9306             MOVE -1             TO PRINTERL
  9307             MOVE ER-9283        TO EMI-ERROR
  9308             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9309
  9310     IF  COPIESL NOT EQUAL ZEROS
  9311         IF  COPIESI NOT NUMERIC
  9312                 OR
  9313             COPIESI EQUAL '0'
  9314             MOVE ER-0184        TO EMI-ERROR
  9315             MOVE -1             TO COPIESL
  9316             MOVE AL-UABON       TO COPIESA
  9317             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9318         ELSE
  9319             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  9320             MOVE AL-UANON       TO COPIESA
  9321     ELSE
  9322         IF FORMI EQUAL '9999'
  9323             MOVE 1              TO PI-689-NUMBER-COPIES
  9324                                    COPIESL
  9325                                    COPIESO.
  9326
  9327     IF  FORML NOT EQUAL ZEROS
  9328         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9329         MOVE FORMI              TO PI-689-FORM-NUMBER.
  9330
  9331     MOVE SPACES                 TO W-HOLD-IND.
  9332
  9333     IF PI-CERT-REQ-IND = 'Y'
  9334       IF  CERTIDL NOT EQUAL ZEROS
  9335         IF CERTIDI NUMERIC
  9336             MOVE AL-UANON      TO CERTIDA
  9337             MOVE CERTIDI       TO PI-CERT-FORM-ID
  9338         ELSE
  9339             MOVE ER-1778       TO EMI-ERROR
  9340             MOVE -1            TO CERTIDL
  9341             MOVE AL-UABON      TO CERTIDA
  9342             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9343         END-IF
  9344       ELSE
  9345          MOVE ER-0715       TO EMI-ERROR
  9346          MOVE -1            TO CERTIDL
  9347          MOVE AL-UABON      TO CERTIDA
  9348          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9349       END-IF
  9350     END-IF.
  9351
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 179
* EL689.cbl
  9352     IF PI-REASON-REQ-IND = 'Y'
  9353        IF PI-ENDT-ARCH-NO NOT > ZERO
  9354          MOVE ER-9840       TO EMI-ERROR
  9355          MOVE -1            TO FORML
  9356          MOVE AL-UABON      TO FORMA
  9357          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9358        END-IF
  9359     END-IF.
  9360
  9361     IF  NOT EMI-NO-ERRORS
  9362         IF  EMI-ERROR EQUAL ER-7250
  9363             GO TO 0350-EXIT
  9364         ELSE
  9365            MOVE -1             TO MAINTL
  9366            GO TO 8200-SEND-DATAONLY.
  9367
  9368 0350-EXIT.
  9369      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 180
* EL689.cbl
  9371 0355-CHECK-ERENDT.
  9372
  9373*     EXEC CICS GETMAIN
  9374*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  9375*          LENGTH   (W-ENDT-LENGTH)
  9376*     END-EXEC
  9377
  9378
  9379* EXEC CICS READ
  9380*         DATASET    ('ERENDT2')
  9381*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  9382*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  9383*         RESP       (W-RESPONSE)
  9384*    END-EXEC
  9385     MOVE 'ERENDT2' TO DFHEIV1
  9386*    MOVE '&"S        E          (  N#00009184' TO DFHEIV0
  9387     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9389     MOVE X'204E233030303039313834' TO DFHEIV0(25:11)
  9390     CALL 'kxdfhei1' USING DFHEIV0,
  9391           DFHEIV1,
  9392           DFHEIV20,
  9393           DFHEIV99,
  9394           W-ERENDT-KEY-BY-ARCH,
  9395           DFHEIV99,
  9396           DFHEIV99,
  9397           DFHEIV99
  9398     SET ADDRESS OF ENDORSEMENT-RECORD TO
  9399         DFHEIV20
  9400     MOVE EIBRESP  TO W-RESPONSE
  9401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9402
  9403     IF (RESP-NORMAL)
  9404         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  9405            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9406            EN-CARRIER     =  PI-689-CARRIER     AND
  9407            EN-GROUPING    =  PI-689-GROUPING    AND
  9408            EN-STATE       =  PI-689-STATE       AND
  9409            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  9410            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  9411            EN-CERT-NO     =  PI-689-CERT-NO
  9412               SET W-VALID-ENDT TO TRUE
  9413         END-IF
  9414         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  9415            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9416            EN-CARRIER     =  PI-CARRIER         AND
  9417            EN-GROUPING    =  PI-GROUPING        AND
  9418            EN-STATE       =  PI-STATE           AND
  9419            EN-ACCOUNT     =  PI-ACCOUNT         AND
  9420            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  9421            EN-CERT-NO     =  PI-CERT-NO
  9422               SET W-VALID-ENDT TO TRUE
  9423         END-IF
  9424     END-IF
  9425      .
  9426
  9427 0355-EXIT.
  9428      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 181
* EL689.cbl
  9430 0360-EDIT-PRINT-RESTRICTIONS.
  9431
  9432*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  9433*                                TO W-UPPER-CASE.
  9434*
  9435*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  9436*                                     OR 'P' OR LOW-VALUES)
  9437*            AND
  9438*        PRTRESTI EQUAL 'C'
  9439*            AND
  9440*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9441*        MOVE ER-7243            TO EMI-ERROR
  9442*        MOVE -1                 TO PRTRESTL
  9443*        MOVE AL-UABON           TO PRTRESTA
  9444*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9445*        GO TO 0360-EXIT.
  9446*
  9447*    IF  PRTRESTL NOT EQUAL ZEROS
  9448*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  9449*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  9450*            MOVE AL-UANON       TO PRTRESTA
  9451*        ELSE
  9452*            IF  PRTRESTI EQUAL ' '
  9453*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  9454*                MOVE AL-UANON   TO PRTRESTA
  9455*            ELSE
  9456*                MOVE ER-7393    TO EMI-ERROR
  9457*                MOVE -1         TO PRTRESTL
  9458*                MOVE AL-UABON   TO PRTRESTA
  9459*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9460*
  9461*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  9462*            AND
  9463*        W-HOLD-ON
  9464*            AND
  9465*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9466*        MOVE ER-7243            TO EMI-ERROR
  9467*        MOVE -1                 TO PRTRESTL
  9468*        MOVE AL-UABON           TO PRTRESTA
  9469*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9470     .
  9471 0360-EXIT.
  9472      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 182
* EL689.cbl
  9474 0400-EL6311-INCOMING.
  9475
  9476     MOVE ZEROS                  TO PI-CURRENT-LINE
  9477                                    PI-TEMP-STOR-ITEMS
  9478                                    PI-TOTAL-LINES
  9479                                    PI-UPDATE-SW
  9480                                    PI-689-NUMBER-LABEL-LINES
  9481                                    PI-689-ERROR
  9482                                    PI-689-NUMBER-TEXT-RECORDS.
  9483     MOVE SPACES                 TO PI-689-PRINT-SW
  9484                                    PI-689-ALT-PRINTER-ID
  9485                                    PI-COMM-CONTROL
  9486                                    PI-689-FORM-NUMBER
  9487                                    PI-689-TEMP-STOR-ID
  9488                                    PI-689-LABEL-SOURCE
  9489                                    PI-689-USE-SCREEN-IND.
  9490
  9491     IF PI-CREATE-LABELS
  9492         MOVE  AL-UANON          TO ADDRLBLA
  9493         MOVE  +1                TO ADDRLBLL.
  9494
  9495     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9496                                    PI-689-LBL-OVERRIDE.
  9497
  9498     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9499     MOVE '2'                    TO PI-ACTION.
  9500     MOVE -1                     TO MAINTL.
  9501
  9502     MOVE AL-UANON               TO PRTNOWA.
  9503     MOVE +1                     TO PRTNOWL.
  9504     MOVE 'N'                    TO PRTNOWI
  9505                                    PI-PRINT-NOW.
  9506
  9507     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  9508         MOVE AL-UANON           TO CARRIERA
  9509         MOVE +1                 TO CARRIERL
  9510         MOVE PI-689-CARRIER     TO CARRIERI.
  9511
  9512     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  9513         MOVE +6                 TO GROUPL
  9514         MOVE AL-UANON           TO GROUPA
  9515         MOVE PI-689-GROUPING    TO GROUPI.
  9516
  9517     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9518         MOVE +2                 TO STATEL
  9519         MOVE AL-UANON           TO STATEA
  9520         MOVE PI-689-STATE       TO STATEI.
  9521
  9522     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9523         MOVE +10                TO ACCTL
  9524         MOVE AL-UANON           TO ACCTA
  9525         MOVE PI-689-ACCOUNT     TO ACCTI.
  9526
  9527     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9528         MOVE +10                TO CERTL
  9529         MOVE AL-UANON           TO CERTA
  9530         MOVE PI-689-CERT-PRIME  TO CERTI.
  9531
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 183
* EL689.cbl
  9532     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9533         MOVE +1                 TO SFXL
  9534         MOVE AL-UANON           TO SFXA
  9535         MOVE PI-689-CERT-SFX    TO SFXI.
  9536
  9537     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9538         MOVE +6                 TO BENTRYL
  9539         MOVE AL-UANON           TO BENTRYA
  9540         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9541
  9542     MOVE +4                     TO BCSEQL.
  9543     MOVE AL-UANON               TO BCSEQA.
  9544     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9545
  9546     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9547         MOVE +8                 TO SEQL
  9548         MOVE AL-UANON           TO SEQA
  9549         MOVE PI-689-SEQ-NO      TO SEQI.
  9550
  9551     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9552         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9553         MOVE ' '                TO DC-OPTION-CODE
  9554         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9555         MOVE +8                 TO DATEL
  9556         MOVE DC-GREG-DATE-1-EDIT
  9557                                 TO DATEI
  9558         MOVE AL-UANON           TO DATEA.
  9559
  9560     MOVE -1                     TO MAINTL.
  9561     MOVE '4'                    TO DATASORI
  9562                                    PI-689-DATA-SOURCE.
  9563     MOVE +1                     TO DATASORL.
  9564     MOVE AL-UANON               TO DATASORA.
  9565
  9566     GO TO 8100-SEND-INITIAL-MAP.
  9567
  9568 0400-EXIT.
  9569      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 184
* EL689.cbl
  9571 0450-SPECIAL-INPUT-PROCESS.
  9572
  9573     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9574             AND
  9575         PI-CARRIER GREATER THAN LOW-VALUES
  9576         MOVE '1'                TO DATASORI
  9577                                    PI-689-DATA-SOURCE
  9578         MOVE PI-CARRIER         TO CARRIERI
  9579         MOVE PI-GROUPING        TO GROUPI
  9580         MOVE PI-STATE           TO STATEI
  9581         MOVE PI-ACCOUNT         TO ACCTI
  9582         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9583         MOVE ' '                TO DC-OPTION-CODE
  9584         PERFORM 9500-LINK-DATE-CONVERT
  9585             THRU 9500-EXIT
  9586         MOVE DC-GREG-DATE-1-EDIT
  9587                                 TO DATEI
  9588         MOVE 'N'                TO PRTNOWI
  9589                                    PI-PRINT-NOW
  9590         MOVE AL-UANON           TO ACCTA
  9591                                    CARRIERA
  9592                                    DATEA
  9593                                    DATASORA
  9594                                    GROUPA
  9595                                    STATEA
  9596                                    PRTNOWA
  9597         MOVE +1                 TO CARRIERL
  9598                                    DATASORL
  9599                                    PRTNOWL
  9600         MOVE -1                 TO MAINTL
  9601         MOVE +6                 TO GROUPL
  9602         MOVE +2                 TO STATEL
  9603         MOVE +8                 TO DATEL
  9604         MOVE +10                TO ACCTL
  9605     ELSE
  9606         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9607                 AND
  9608             PI-CARRIER GREATER THAN LOW-VALUES
  9609             MOVE '3'            TO DATASORI
  9610                                    PI-689-DATA-SOURCE
  9611             MOVE PI-CR-CARRIER  TO CARRIERI
  9612             MOVE PI-CR-GROUPING TO GROUPI
  9613             MOVE PI-CR-ACCOUNT  TO ACCTI
  9614             MOVE PI-CR-FIN-RESP TO RPERSONI
  9615             MOVE PI-CR-TYPE     TO TYPEI
  9616             MOVE 'N'            TO PRTNOWI
  9617                                    PI-PRINT-NOW
  9618             MOVE AL-UANON       TO CARRIERA
  9619                                    GROUPA
  9620                                    ACCTA
  9621                                    DATASORA
  9622                                    RPERSONA
  9623                                    TYPEA
  9624                                    PRTNOWA
  9625             MOVE +1             TO CARRIERL
  9626                                    DATASORL
  9627                                    TYPEL
  9628                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 185
* EL689.cbl
  9629             MOVE -1             TO MAINTL
  9630             MOVE +6             TO GROUPL
  9631             MOVE +10            TO ACCTL
  9632                                    RPERSONL
  9633         ELSE
  9634             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9635                     AND
  9636                 PI-CARRIER GREATER THAN LOW-VALUES
  9637                 MOVE '2'        TO DATASORI
  9638                                    PI-689-DATA-SOURCE
  9639                 MOVE PI-CARRIER TO CARRIERI
  9640                 MOVE PI-GROUPING
  9641                                 TO GROUPI
  9642                 MOVE PI-STATE   TO STATEI
  9643                 MOVE PI-ACCOUNT TO ACCTI
  9644                 MOVE PI-CERT-PRIME
  9645                                 TO CERTI
  9646                 MOVE PI-CERT-SFX
  9647                                 TO SFXI
  9648                 MOVE PI-CERT-EFF-DT
  9649                                 TO DC-BIN-DATE-1
  9650                 MOVE ' '        TO DC-OPTION-CODE
  9651                 PERFORM 9500-LINK-DATE-CONVERT
  9652                     THRU 9500-EXIT
  9653                 MOVE DC-GREG-DATE-1-EDIT
  9654                                 TO DATEI
  9655                 MOVE 'N'        TO PRTNOWI
  9656                                    PI-PRINT-NOW
  9657                 MOVE AL-UANON   TO CARRIERA
  9658                                    GROUPA
  9659                                    STATEA
  9660                                    ACCTA
  9661                                    CERTA
  9662                                    SFXA
  9663                                    DATEA
  9664                                    ADDRSA
  9665                                    DATASORA
  9666                                    PRTNOWA
  9667                 MOVE +1         TO CARRIERL
  9668                                    SFXL
  9669                                    DATASORL
  9670                                    ADDRSL
  9671                                    PRTNOWL
  9672                 MOVE -1         TO MAINTL
  9673                 MOVE +6         TO GROUPL
  9674                 MOVE +2         TO STATEL
  9675                 MOVE +8         TO DATEL
  9676                 MOVE +10        TO ACCTL
  9677                                    CERTL.
  9678
  9679     IF PI-CREATE-LABELS
  9680         MOVE  AL-UANON          TO ADDRLBLA
  9681         MOVE  +1                TO ADDRLBLL.
  9682
  9683     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9684                                    PI-689-LBL-OVERRIDE.
  9685
  9686     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 186
* EL689.cbl
  9687     GO TO 8100-SEND-INITIAL-MAP.
  9688
  9689 0450-EXIT.
  9690      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 187
* EL689.cbl
  9692 0600-BYPASS-SCREEN-CNTL.
  9693***************************************************************
  9694*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9695*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9696*     PERFORMING ANY SCREEN IO.                               *
  9697***************************************************************
  9698
  9699
  9700* EXEC CICS HANDLE CONDITION
  9701*        PGMIDERR (9700-PGMID-ERROR)
  9702*        MAPFAIL  (0325-MAPFAIL)
  9703*        ERROR    (9800-ABEND)
  9704*    END-EXEC.
  9705*    MOVE '"$L?.                 ! % #00009487' TO DFHEIV0
  9706     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9708     MOVE X'2520233030303039343837' TO DFHEIV0(25:11)
  9709     CALL 'kxdfhei1' USING DFHEIV0
  9710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9711
  9712
  9713     MOVE LOW-VALUES             TO EL689AI.
  9714
  9715     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9716
  9717     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9718     MOVE +4                     TO FORML.
  9719
  9720     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9721         MOVE PI-689-NUMBER-COPIES
  9722                                 TO COPIESI
  9723         MOVE +1                 TO COPIESL.
  9724
  9725     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9726     MOVE +1                     TO ADDRSL.
  9727     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9728     MOVE +1                     TO DATASORL.
  9729
  9730*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9731*        MOVE PI-689-PRINT-RESTRICTION
  9732*                                TO PRTRESTI
  9733*        MOVE +1                 TO PRTRESTL.
  9734
  9735     MOVE SPACES                 TO PI-689-PRINT-SW
  9736                                    PI-689-LBL-OVERRIDE.
  9737     MOVE ZEROS                  TO PI-TOTAL-LINES
  9738                                    PI-CURRENT-LINE
  9739                                    PI-TEMP-STOR-ITEMS
  9740                                    PI-UPDATE-SW
  9741                                    PI-689-ERROR
  9742                                    PI-689-NUMBER-LABEL-LINES
  9743                                    PI-689-NUMBER-TEXT-RECORDS.
  9744
  9745     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9746         MOVE +4                 TO PRINTERL
  9747         MOVE PI-689-ALT-PRINTER-ID
  9748                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9749
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 188
* EL689.cbl
  9750     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9751
  9752     IF  PI-689-SOURCE-VARIABLE
  9753         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9754
  9755     MOVE SPACES                 TO W-CNTL-KEY
  9756     MOVE LOW-VALUES             TO W-ACCT-KEY
  9757                                    W-CERT-KEY
  9758                                    W-CHEK-KEY
  9759                                    W-COMP-KEY
  9760                                    W-MAIL-KEY
  9761                                    W-PNDB-KEY
  9762                                    W-PNDB2-KEY
  9763                                    W-PYAJ-KEY.
  9764
  9765     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9766     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9767                                    W-CERT-COMPANY-CD
  9768                                    W-CHEK-COMPANY-CD
  9769                                    W-COMP-COMPANY-CD
  9770                                    W-MAIL-COMPANY-CD
  9771                                    W-PNDB-COMPANY-CD
  9772                                    W-PNDB2-COMPANY-CD
  9773                                    W-PYAJ-COMPANY-CD.
  9774
  9775     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9776         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9777                                    W-CERT-CARRIER
  9778                                    W-MAIL-CARRIER
  9779                                    W-CERT-CARRIER
  9780                                    W-COMP-CARRIER
  9781                                    W-CHEK-CARRIER
  9782                                    W-PNDB2-CARRIER
  9783                                    W-PYAJ-CARRIER.
  9784
  9785     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9786         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9787                                    W-CERT-GROUPING
  9788                                    W-CHEK-GROUPING
  9789                                    W-COMP-GROUPING
  9790                                    W-MAIL-GROUPING
  9791                                    W-PNDB2-GROUPING
  9792                                    W-PYAJ-GROUPING.
  9793
  9794     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9795         MOVE PI-689-STATE       TO W-ACCT-STATE
  9796                                    W-CERT-STATE
  9797                                    W-CHEK-STATE
  9798                                    W-MAIL-STATE
  9799                                    W-PNDB2-STATE.
  9800
  9801     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9802         IF PI-689-DATA-SOURCE = '3' OR '6'
  9803             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9804                                    W-PYAJ-ACCOUNT
  9805         ELSE
  9806             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9807                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 189
* EL689.cbl
  9808                                    W-CHEK-ACCOUNT
  9809                                    W-MAIL-ACCOUNT
  9810                                    W-PNDB2-ACCOUNT.
  9811
  9812     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9813         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9814                                    W-CHEK-EFF-DT
  9815                                    W-MAIL-EFF-DT
  9816                                    W-PNDB2-EFF-DT.
  9817
  9818     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9819         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9820                                    W-CHEK-CERT-PRIME
  9821                                    W-MAIL-CERT-PRIME
  9822                                    W-PNDB2-CERT-PRIME
  9823
  9824         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9825             MOVE PI-689-CERT-SFX
  9826                                 TO W-CERT-CERT-SFX
  9827                                    W-CHEK-CERT-SFX
  9828                                    W-MAIL-CERT-SFX
  9829                                    W-PNDB2-CERT-SFX
  9830         ELSE
  9831             MOVE SPACES         TO W-CERT-CERT-SFX
  9832                                    W-CHEK-CERT-SFX
  9833                                    W-MAIL-CERT-SFX
  9834                                    W-PNDB2-CERT-SFX.
  9835
  9836     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9837         IF PI-689-DATA-SOURCE = '3' OR '6'
  9838             MOVE PI-689-RESP-PERSON
  9839                                 TO W-COMP-RESP-PERSON
  9840                                    W-PYAJ-FIN-RESP.
  9841
  9842     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9843         IF PI-689-DATA-SOURCE = '3' OR '6'
  9844             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9845                                    W-PYAJ-RECORD-TYPE
  9846         ELSE
  9847             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9848
  9849     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9850         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9851                                    W-PYAJ-FILE-SEQ-NO
  9852                                    W-CHEK-SEQ-NO.
  9853
  9854     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9855         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9856                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9857
  9858     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9859         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9860
  9861     IF  PI-689-NO-ERRORS-DETECTED
  9862         PERFORM 2000-CREATE THRU 2000-EXIT
  9863         IF  NOT PI-689-FATAL-ERROR
  9864                 AND
  9865             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 190
* EL689.cbl
  9866             IF  PI-689-PRINT-ONLY
  9867                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9868             ELSE
  9869                 IF  PI-689-PRINT-FIRST
  9870                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9871                     IF  NOT PI-689-FATAL-ERROR
  9872                         IF  PI-689-ARCHIVE-LETTER
  9873                             PERFORM 5400-LETTER-RELEASE
  9874                                 THRU 5400-EXIT
  9875                         ELSE
  9876                             MOVE ER-7390
  9877                                 TO PI-689-ERROR
  9878                     ELSE
  9879                         NEXT SENTENCE
  9880                 ELSE
  9881                     IF  NOT PI-689-ARCHIVE-LETTER
  9882                         MOVE ER-7390
  9883                                 TO PI-689-ERROR
  9884                     ELSE
  9885                         PERFORM 5400-LETTER-RELEASE
  9886                             THRU 5400-EXIT
  9887                         IF  NOT PI-689-FATAL-ERROR
  9888                             IF  PI-689-PRINT-SECOND
  9889                                 PERFORM 7900-PRINT-LETTER-NOW
  9890                                     THRU 7900-EXIT.
  9891
  9892 0600-EXIT.
  9893     EXIT.
  9894
  9895 0620-RETURN-TO-CALLER.
  9896
  9897     MOVE PROGRAM-INTERFACE-BLOCK
  9898                                 TO DFHCOMMAREA.
  9899
  9900* EXEC CICS RETURN
  9901*    END-EXEC.
  9902*    MOVE '.(                    ''   #00009679' TO DFHEIV0
  9903     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9904     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9905     MOVE X'2020233030303039363739' TO DFHEIV0(25:11)
  9906     CALL 'kxdfhei1' USING DFHEIV0,
  9907           DFHEIV99,
  9908           DFHEIV99,
  9909           DFHEIV99,
  9910           DFHEIV99,
  9911           DFHEIV99,
  9912           DFHEIV99
  9913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9914
  9915
  9916 0700-GET-VARIABLE-LABEL.
  9917
  9918     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  9919         MOVE '(VARIABLE NOT PROVIDED)'
  9920                                 TO W-RC-TEXT (1)
  9921                                    W-VG-TEXT (48)
  9922         GO TO 0700-EXIT.
  9923
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 191
* EL689.cbl
  9924     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
  9925                                    W-VG-TEXT (48).
  9926     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  9927                                    W-VG-TEXT (49).
  9928     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  9929                                    W-VG-TEXT (50).
  9930     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  9931                                    W-VG-TEXT (51).
  9932     SET W-RG-NDX                TO +5.
  9933
  9934 0700-EXIT.
  9935     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 192
* EL689.cbl
  9937 0800-EDIT-KEY-FIELDS.
  9938***************************************************************
  9939*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  9940*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  9941*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  9942*     PROCESSING.                                             *
  9943***************************************************************
  9944     MOVE SPACES                 TO W-CNTL-KEY
  9945     MOVE LOW-VALUES             TO W-ACCT-KEY
  9946                                    W-CERT-KEY
  9947                                    W-CHEK-KEY
  9948                                    W-COMP-KEY
  9949                                    W-MAIL-KEY
  9950                                    W-PNDB-KEY
  9951                                    W-PNDB2-KEY
  9952                                    W-PYAJ-KEY.
  9953
  9954     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9955     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9956                                    W-CERT-COMPANY-CD
  9957                                    W-CHEK-COMPANY-CD
  9958                                    W-COMP-COMPANY-CD
  9959                                    W-MAIL-COMPANY-CD
  9960                                    W-PNDB-COMPANY-CD
  9961                                    W-PNDB2-COMPANY-CD
  9962                                    W-PYAJ-COMPANY-CD.
  9963
  9964     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  9965     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  9966     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  9967     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  9968     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  9969     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  9970     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  9971     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  9972     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  9973     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  9974     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  9975     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  9976     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  9977     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  9978     PERFORM 0970-EDIT-CSO THRU 0970-EXIT.
  9979
  9980     IF  DATASORI NUMERIC
  9981         MOVE DATASORI           TO W-DATA-SOURCE
  9982                                    PI-689-DATA-SOURCE
  9983         GO TO 0800-SOURCE-ACCOUNT
  9984               0800-SOURCE-CERTIFICATE
  9985               0800-SOURCE-COMPENSATION
  9986               0800-SOURCE-PENDING
  9987               0800-SOURCE-CHEK
  9988               0800-SOURCE-PAYMENTS-ADJS
  9989                                 DEPENDING ON W-DATA-SOURCE.
  9990
  9991     IF  FORMI NOT EQUAL '9999'
  9992         MOVE ER-7365            TO EMI-ERROR
  9993         MOVE -1                 TO MAINTL
  9994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 193
* EL689.cbl
  9995         GO TO 8200-SEND-DATAONLY
  9996
  9997     ELSE
  9998         GO TO 0800-EXIT.
  9999
 10000 0800-SOURCE-ACCOUNT.
 10001
 10002     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
 10003             OR
 10004         W-ACCT-CARRIER EQUAL LOW-VALUES
 10005             OR
 10006         W-ACCT-GROUPING EQUAL LOW-VALUES
 10007             OR
 10008         W-ACCT-STATE EQUAL LOW-VALUES
 10009             OR
 10010         W-ACCT-ACCOUNT EQUAL LOW-VALUES
 10011             OR
 10012         W-ACCT-EXP-DT EQUAL LOW-VALUES
 10013         MOVE ER-7376            TO EMI-ERROR
 10014         MOVE -1                 TO MAINTL
 10015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10016
 10017     GO TO 0800-ERROR-TEST.
 10018
 10019 0800-SOURCE-CERTIFICATE.
 10020
 10021     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
 10022             OR
 10023         W-CERT-CARRIER EQUAL LOW-VALUES
 10024             OR
 10025         W-CERT-GROUPING EQUAL LOW-VALUES
 10026             OR
 10027         W-CERT-STATE EQUAL LOW-VALUES
 10028             OR
 10029         W-CERT-ACCOUNT EQUAL LOW-VALUES
 10030             OR
 10031         W-CERT-EFF-DT EQUAL LOW-VALUES
 10032             OR
 10033         W-CERT-CERT-NO EQUAL LOW-VALUES
 10034         MOVE ER-7377            TO EMI-ERROR
 10035         MOVE -1                 TO MAINTL
 10036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10037
 10038     GO TO 0800-ERROR-TEST.
 10039
 10040 0800-SOURCE-COMPENSATION.
 10041
 10042     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
 10043             OR
 10044         W-COMP-CARRIER EQUAL LOW-VALUES
 10045             OR
 10046         W-COMP-GROUPING EQUAL LOW-VALUES
 10047             OR
 10048         W-COMP-RESP-PERSON EQUAL LOW-VALUES
 10049             OR
 10050         W-COMP-TYPE EQUAL LOW-VALUES
 10051             OR
 10052         (W-COMP-TYPE EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 194
* EL689.cbl
 10053                 AND
 10054             W-COMP-ACCOUNT EQUAL LOW-VALUES)
 10055         MOVE ER-7378            TO EMI-ERROR
 10056         MOVE -1                 TO MAINTL
 10057         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10058
 10059     GO TO 0800-ERROR-TEST.
 10060
 10061 0800-SOURCE-PENDING.
 10062
 10063     IF  BENTRYL EQUAL ZEROS
 10064         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
 10065                 OR
 10066             W-PNDB2-CARRIER EQUAL LOW-VALUES
 10067                 OR
 10068             W-PNDB2-GROUPING EQUAL LOW-VALUES
 10069                 OR
 10070             W-PNDB2-STATE EQUAL LOW-VALUES
 10071                 OR
 10072             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
 10073                 OR
 10074             W-PNDB2-EFF-DT EQUAL LOW-VALUES
 10075                 OR
 10076             W-PNDB2-CERT-NO EQUAL LOW-VALUES
 10077                 OR
 10078             W-PNDB2-TYPE EQUAL LOW-VALUES
 10079                 OR
 10080             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
 10081             MOVE ER-7379        TO EMI-ERROR
 10082             MOVE -1             TO MAINTL
 10083             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10084         ELSE
 10085             NEXT SENTENCE
 10086     ELSE
 10087         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
 10088                 OR
 10089             W-PNDB-ENTRY EQUAL LOW-VALUES
 10090                 OR
 10091             W-PNDB-SEQ-NO EQUAL ZEROS
 10092             MOVE ER-7379        TO EMI-ERROR
 10093             MOVE -1             TO MAINTL
 10094             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10095
 10096     GO TO 0800-ERROR-TEST.
 10097
 10098 0800-SOURCE-CHEK.
 10099
 10100     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
 10101             OR
 10102         W-CHEK-CARRIER EQUAL LOW-VALUES
 10103             OR
 10104         W-CHEK-GROUPING EQUAL LOW-VALUES
 10105             OR
 10106         W-CHEK-STATE EQUAL LOW-VALUES
 10107             OR
 10108         W-CHEK-ACCOUNT EQUAL LOW-VALUES
 10109             OR
 10110         W-CHEK-EFF-DT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 195
* EL689.cbl
 10111             OR
 10112         W-CHEK-CERT-NO EQUAL LOW-VALUES
 10113         MOVE ER-7381            TO EMI-ERROR
 10114         MOVE -1                 TO MAINTL
 10115         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10116
 10117     GO TO 0800-ERROR-TEST.
 10118
 10119 0800-SOURCE-PAYMENTS-ADJS.
 10120
 10121     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
 10122             OR
 10123         W-PYAJ-CARRIER EQUAL LOW-VALUES
 10124             OR
 10125         W-PYAJ-GROUPING EQUAL LOW-VALUES
 10126             OR
 10127         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 10128             OR
 10129         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
 10130             OR
 10131         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
 10132         MOVE ER-7396            TO EMI-ERROR
 10133         MOVE -1                 TO MAINTL
 10134         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10135
 10136     GO TO 0800-ERROR-TEST.
 10137
 10138 0800-ERROR-TEST.
 10139
 10140     IF  NOT EMI-NO-ERRORS
 10141         IF  EMI-ERROR EQUAL ER-7250
 10142             GO TO 0800-EXIT
 10143         ELSE
 10144             GO TO 8200-SEND-DATAONLY.
 10145
 10146 0800-EXIT.
 10147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 196
* EL689.cbl
 10149 0900-EDIT-CARRIER.
 10150
 10151     IF  CARRIERL EQUAL ZEROES
 10152         MOVE LOW-VALUES         TO PI-689-CARRIER
 10153                                    W-ACCT-CARRIER
 10154                                    W-CERT-CARRIER
 10155                                    W-COMP-CARRIER
 10156                                    W-CHEK-CARRIER
 10157                                    W-MAIL-CARRIER
 10158                                    W-PNDB2-CARRIER
 10159                                    W-PYAJ-CARRIER
 10160     ELSE
 10161         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
 10162
 10163 0900-EXIT.
 10164     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 197
* EL689.cbl
 10166 0905-EDIT-GROUPING.
 10167
 10168     IF  GROUPL EQUAL ZEROES
 10169         MOVE LOW-VALUES         TO PI-689-GROUPING
 10170                                    W-ACCT-GROUPING
 10171                                    W-CERT-GROUPING
 10172                                    W-CHEK-GROUPING
 10173                                    W-COMP-GROUPING
 10174                                    W-MAIL-GROUPING
 10175                                    W-PNDB2-GROUPING
 10176                                    W-PYAJ-GROUPING
 10177     ELSE
 10178         MOVE AL-UANON           TO GROUPA
 10179         MOVE GROUPI             TO PI-689-GROUPING
 10180                                    W-ACCT-GROUPING
 10181                                    W-CERT-GROUPING
 10182                                    W-CHEK-GROUPING
 10183                                    W-COMP-GROUPING
 10184                                    W-MAIL-GROUPING
 10185                                    W-PNDB2-GROUPING
 10186                                    W-PYAJ-GROUPING.
 10187
 10188 0905-EXIT.
 10189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 198
* EL689.cbl
 10191 0910-EDIT-STATE.
 10192
 10193     IF  STATEL EQUAL ZEROES
 10194         MOVE LOW-VALUES         TO PI-689-STATE
 10195                                    W-ACCT-STATE
 10196                                    W-CERT-STATE
 10197                                    W-CHEK-STATE
 10198                                    W-MAIL-STATE
 10199                                    W-PNDB2-STATE
 10200     ELSE
 10201         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
 10202
 10203 0910-EXIT.
 10204     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 199
* EL689.cbl
 10206 0915-EDIT-ACCOUNT.
 10207
 10208     IF  ACCTL EQUAL ZEROES
 10209         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10210                                    W-ACCT-ACCOUNT
 10211                                    W-CERT-ACCOUNT
 10212                                    W-CHEK-ACCOUNT
 10213                                    W-COMP-ACCOUNT
 10214                                    W-MAIL-ACCOUNT
 10215                                    W-PNDB2-ACCOUNT
 10216                                    W-PYAJ-ACCOUNT
 10217     ELSE
 10218         MOVE AL-UANON           TO ACCTA
 10219         MOVE ACCTI              TO PI-689-ACCOUNT
 10220                                    W-ACCT-ACCOUNT
 10221                                    W-CERT-ACCOUNT
 10222                                    W-CHEK-ACCOUNT
 10223                                    W-COMP-ACCOUNT
 10224                                    W-MAIL-ACCOUNT
 10225                                    W-PYAJ-ACCOUNT
 10226                                    W-PNDB2-ACCOUNT.
 10227
 10228 0915-EXIT.
 10229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 200
* EL689.cbl
 10231 0920-EDIT-EXP-DATE.
 10232
 10233     IF  DATEL NOT EQUAL ZEROS
 10234         IF  DATEI EQUAL '99/99/99' OR '999999'
 10235             MOVE '99/99/99'     TO DATEO
 10236                                    PI-689-DATE-EDIT
 10237             MOVE AL-UANON       TO DATEA
 10238             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
 10239                                    W-ACCT-EXP-DT
 10240         ELSE
 10241             MOVE DATEI          TO W-DEEDIT-FIELD
 10242             PERFORM 8600-DEEDIT
 10243             MOVE W-DEEDIT-FIELD-V0
 10244                                 TO DC-GREG-DATE-1-MDY
 10245             MOVE '4'            TO DC-OPTION-CODE
 10246             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10247             IF  DATE-CONVERSION-ERROR
 10248                 MOVE ER-0454    TO EMI-ERROR
 10249                 MOVE -1         TO DATEL
 10250                 MOVE AL-UABON   TO DATEA
 10251                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10252             ELSE
 10253                 MOVE DC-GREG-DATE-1-EDIT
 10254                                 TO DATEO
 10255                                    PI-689-DATE-EDIT
 10256                 MOVE AL-UANON   TO DATEA
 10257                 MOVE DC-BIN-DATE-1
 10258                                 TO PI-689-EXP-DATE
 10259                                    W-ACCT-EXP-DT
 10260     ELSE
 10261         MOVE LOW-VALUES         TO PI-689-EXP-DATE
 10262                                    W-ACCT-EXP-DT
 10263                                    PI-689-DATE-EDIT.
 10264
 10265 0920-EXIT.
 10266     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 201
* EL689.cbl
 10268 0925-EDIT-EFF-DATE.
 10269
 10270     IF  CERTL EQUAL ZERO
 10271             AND
 10272         DATASORI NOT EQUAL '2'
 10273         GO TO 0925-EXIT.
 10274
 10275     IF  DATEL NOT EQUAL ZEROS
 10276         MOVE DATEI              TO W-DEEDIT-FIELD
 10277         PERFORM 8600-DEEDIT
 10278         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 10279         MOVE '4'                TO DC-OPTION-CODE
 10280         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10281
 10282         IF  DATE-CONVERSION-ERROR
 10283             MOVE ER-0215        TO EMI-ERROR
 10284             MOVE -1             TO DATEL
 10285             MOVE AL-UABON       TO DATEA
 10286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10287         ELSE
 10288             MOVE DC-GREG-DATE-1-EDIT
 10289                                 TO DATEO
 10290                                    PI-689-DATE-EDIT
 10291             MOVE AL-UANON       TO DATEA
 10292             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
 10293                                    W-CERT-EFF-DT
 10294                                    W-CHEK-EFF-DT
 10295                                    W-MAIL-EFF-DT
 10296                                    W-PNDB2-EFF-DT
 10297     ELSE
 10298         MOVE LOW-VALUES         TO PI-689-EFF-DATE
 10299                                    W-PNDB2-EFF-DT
 10300                                    W-CHEK-EFF-DT
 10301                                    W-MAIL-EFF-DT
 10302                                    W-CERT-EFF-DT
 10303                                    PI-689-DATE-EDIT.
 10304
 10305 0925-EXIT.
 10306     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 202
* EL689.cbl
 10308 0930-EDIT-CERTIFICATE.
 10309
 10310     IF  CERTL EQUAL ZEROES
 10311         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
 10312                                    W-CERT-CERT-PRIME
 10313                                    W-CHEK-CERT-PRIME
 10314                                    W-MAIL-CERT-PRIME
 10315                                    W-PNDB2-CERT-PRIME
 10316                                    PI-689-CERT-SFX
 10317                                    W-CERT-CERT-SFX
 10318                                    W-CHEK-CERT-SFX
 10319                                    W-MAIL-CERT-SFX
 10320                                    W-PNDB2-CERT-SFX
 10321     ELSE
 10322         MOVE AL-UANON           TO CERTA
 10323         MOVE CERTI              TO PI-689-CERT-PRIME
 10324                                    W-CERT-CERT-PRIME
 10325                                    W-CHEK-CERT-PRIME
 10326                                    W-MAIL-CERT-PRIME
 10327                                    W-PNDB2-CERT-PRIME
 10328         IF  SFXL EQUAL ZEROES
 10329                 OR
 10330             SFXI EQUAL LOW-VALUES
 10331             MOVE SPACES         TO PI-689-CERT-SFX
 10332                                    W-CERT-CERT-SFX
 10333                                    W-CHEK-CERT-SFX
 10334                                    W-MAIL-CERT-SFX
 10335                                    W-PNDB2-CERT-SFX
 10336         ELSE
 10337             MOVE AL-UANON       TO SFXA
 10338             MOVE SFXI           TO PI-689-CERT-SFX
 10339                                    W-CERT-CERT-SFX
 10340                                    W-CHEK-CERT-SFX
 10341                                    W-MAIL-CERT-SFX
 10342                                    W-PNDB2-CERT-SFX.
 10343
 10344 0930-EXIT.
 10345     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 203
* EL689.cbl
 10347 0935-EDIT-RESP-PERSON.
 10348
 10349     IF  RPERSONL EQUAL ZEROES
 10350         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
 10351                                    W-COMP-RESP-PERSON
 10352                                    W-PYAJ-FIN-RESP
 10353     ELSE
 10354         MOVE AL-UANON           TO RPERSONA
 10355         MOVE RPERSONI           TO PI-689-RESP-PERSON
 10356                                    W-PYAJ-FIN-RESP
 10357                                    W-COMP-RESP-PERSON.
 10358
 10359 0935-EXIT.
 10360     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 204
* EL689.cbl
 10362 0940-EDIT-ACCOUNT.
 10363
 10364     IF  ACCTL EQUAL ZEROES
 10365         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10366                                    W-COMP-ACCOUNT
 10367                                    W-PYAJ-ACCOUNT
 10368     ELSE
 10369         MOVE AL-UANON           TO ACCTA
 10370         MOVE ACCTI              TO PI-689-ACCOUNT
 10371                                    W-PYAJ-ACCOUNT
 10372                                    W-COMP-ACCOUNT.
 10373
 10374 0940-EXIT.
 10375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 205
* EL689.cbl
 10377 0945-EDIT-TYPE.
 10378
 10379     IF  TYPEL EQUAL ZEROES
 10380         MOVE LOW-VALUES         TO PI-689-TYPE
 10381                                    W-COMP-TYPE
 10382                                    W-PYAJ-RECORD-TYPE
 10383     ELSE
 10384         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
 10385         IF TYPEI = 'C' OR 'G' OR 'A'
 10386             MOVE AL-UANON       TO TYPEA
 10387             MOVE TYPEI          TO PI-689-TYPE
 10388                                    W-COMP-TYPE
 10389                                    W-PYAJ-RECORD-TYPE
 10390         ELSE
 10391             MOVE ER-7368        TO EMI-ERROR
 10392             MOVE -1             TO TYPEL
 10393             MOVE AL-UABON       TO TYPEA
 10394             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10395
 10396 0945-EXIT.
 10397     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 206
* EL689.cbl
 10399 0950-EDIT-ENTRY.
 10400
 10401     IF  BENTRYL EQUAL ZEROES
 10402         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
 10403                                    W-PNDB-ENTRY
 10404     ELSE
 10405         MOVE AL-UANON           TO BENTRYA
 10406         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
 10407                                    W-PNDB-ENTRY.
 10408
 10409 0950-EXIT.
 10410     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 207
* EL689.cbl
 10412 0955-EDIT-SEQUENCE.
 10413
 10414     IF  SEQL NOT EQUAL ZEROS
 10415         IF  SEQI NOT NUMERIC
 10416                 OR
 10417             SEQI EQUAL '0'
 10418             MOVE ER-7367        TO EMI-ERROR
 10419             MOVE -1             TO SEQL
 10420             MOVE AL-UABON       TO SEQA
 10421             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10422         ELSE
 10423             MOVE AL-UANON       TO SEQA
 10424             MOVE SEQI           TO PI-689-SEQ-NO
 10425                                    W-CHEK-SEQ-NO
 10426                                    W-PYAJ-FILE-SEQ-NO
 10427                                    W-PNDB-SEQ-NO
 10428                                    PI-689-SEQ-EDIT
 10429     ELSE
 10430         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
 10431
 10432 0955-EXIT.
 10433     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 208
* EL689.cbl
 10435 0960-EDIT-BATCH-SEQ.
 10436
 10437     IF  BCSEQL NOT EQUAL ZEROS
 10438         IF  BCSEQI NOT NUMERIC
 10439             MOVE ER-7368        TO EMI-ERROR
 10440             MOVE -1             TO BCSEQL
 10441             MOVE AL-UABON       TO BCSEQA
 10442             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10443         ELSE
 10444             MOVE AL-UANON       TO BCSEQA
 10445             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
 10446                                    W-PNDB-CHG-SEQ-NO
 10447                                    W-PNDB2-ALT-CHG-SEQ-NO
 10448                                    PI-689-BCSEQ-EDIT
 10449     ELSE
 10450         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
 10451
 10452 0960-EXIT.
 10453     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 209
* EL689.cbl
 10455 0965-EDIT-TYPE.
 10456
 10457     IF  TYPEL EQUAL ZEROES
 10458         MOVE LOW-VALUES         TO PI-689-TYPE
 10459                                    W-PNDB2-TYPE
 10460     ELSE
 10461         IF  DATASORI NOT EQUAL '4'
 10462             GO TO 0965-EXIT
 10463         ELSE
 10464             IF TYPEI = '0' OR '1' OR '2' OR '3'
 10465                 MOVE AL-UANON   TO TYPEA
 10466                 MOVE TYPEI      TO PI-689-TYPE
 10467                                    W-PNDB2-TYPE
 10468             ELSE
 10469                 MOVE ER-7370    TO EMI-ERROR
 10470                 MOVE -1         TO TYPEL
 10471                 MOVE AL-UABON   TO TYPEA
 10472                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10473
 10474 0965-EXIT.
 10475     EXIT.
 10476
 10477 0970-EDIT-CSO.
 10478
 10479     IF ENDARCHL > ZEROS
 10480        IF ENDARCHI NUMERIC
 10481            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
 10482            MOVE AL-UNNON       TO ENDARCHA
 10483            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
 10484            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
 10485            MOVE 'N'            TO W-VALID-ENDT-SW
 10486            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
 10487            IF NOT W-VALID-ENDT
 10488                MOVE -1         TO ENDARCHL
 10489                MOVE ER-1565    TO EMI-ERROR
 10490                MOVE AL-UNBON   TO ENDARCHA
 10491                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10492            END-IF
 10493        END-IF
 10494     ELSE
 10495        MOVE ZEROS              TO PI-ENDT-ARCH-NO
 10496     END-IF
 10497
 10498     IF PI-CERT-REQ-IND = 'Y'
 10499       IF  CERTIDL NOT EQUAL ZEROS
 10500         IF CERTIDI NUMERIC
 10501             MOVE AL-UANON      TO CERTIDA
 10502             MOVE CERTIDI       TO PI-CERT-FORM-ID
 10503         ELSE
 10504             MOVE ER-1778       TO EMI-ERROR
 10505             MOVE -1            TO CERTIDL
 10506             MOVE AL-UABON      TO CERTIDA
 10507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10508         END-IF
 10509       ELSE
 10510          MOVE ER-0715       TO EMI-ERROR
 10511          MOVE -1            TO CERTIDL
 10512          MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 210
* EL689.cbl
 10513          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10514       END-IF
 10515     END-IF.
 10516
 10517 0970-EXIT.
 10518      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 211
* EL689.cbl
 10520 0990-CARRIER-VALIDITY-CHECK.
 10521
 10522     IF  CARRIERI EQUAL SPACES
 10523         GO TO 0990-EXIT.
 10524
 10525     MOVE SPACES                 TO W-CNTL-KEY.
 10526     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10527     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
 10528     MOVE CARRIERI               TO W-CNTL-GEN4.
 10529     MOVE +0                     TO W-CNTL-SEQ-NO.
 10530
 10531
 10532* EXEC CICS HANDLE CONDITION
 10533*        NOTFND  (0990-CARRIER-NOT-FOUND)
 10534*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10535*    END-EXEC.
 10536*    MOVE '"$IJ                  ! & #00010297' TO DFHEIV0
 10537     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10539     MOVE X'2620233030303130323937' TO DFHEIV0(25:11)
 10540     CALL 'kxdfhei1' USING DFHEIV0
 10541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10542
 10543
 10544
 10545* EXEC CICS READ
 10546*        DATASET (W-CNTL-FILE-ID)
 10547*        SET     (ADDRESS OF CONTROL-FILE)
 10548*        RIDFLD  (W-CNTL-KEY)
 10549*    END-EXEC.
 10550*    MOVE '&"S        E          (   #00010302' TO DFHEIV0
 10551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10553     MOVE X'2020233030303130333032' TO DFHEIV0(25:11)
 10554     CALL 'kxdfhei1' USING DFHEIV0,
 10555           W-CNTL-FILE-ID,
 10556           DFHEIV20,
 10557           DFHEIV99,
 10558           W-CNTL-KEY,
 10559           DFHEIV99,
 10560           DFHEIV99,
 10561           DFHEIV99
 10562     SET ADDRESS OF CONTROL-FILE TO
 10563         DFHEIV20
 10564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10565
 10566
 10567     IF  PI-NO-CARRIER-SECURITY
 10568             OR
 10569         PI-CARRIER-SECURITY EQUAL CARRIERI
 10570         MOVE AL-UANON           TO CARRIERA
 10571         MOVE CARRIERI           TO PI-689-CARRIER
 10572                                    W-ACCT-CARRIER
 10573                                    W-CERT-CARRIER
 10574                                    W-CHEK-CARRIER
 10575                                    W-COMP-CARRIER
 10576                                    W-MAIL-CARRIER
 10577                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 212
* EL689.cbl
 10578                                    W-PYAJ-CARRIER
 10579     ELSE
 10580         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10581         MOVE ER-9095            TO EMI-ERROR
 10582         MOVE -1                 TO MAINTL
 10583         MOVE AL-UANON           TO MAINTA
 10584         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10585
 10586     GO TO 0990-EXIT.
 10587
 10588 0990-CARRIER-NOT-FOUND.
 10589
 10590     MOVE -1                     TO CARRIERL.
 10591     MOVE AL-UABON               TO CARRIERA.
 10592     MOVE ER-2208                TO EMI-ERROR.
 10593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10594
 10595 0990-EXIT.
 10596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 213
* EL689.cbl
 10598 0994-STATE-VALIDITY-CHECK.
 10599
 10600     IF  STATEI EQUAL SPACES
 10601         GO TO 0994-EXIT.
 10602
 10603     MOVE SPACES                 TO W-CNTL-KEY.
 10604     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10605     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10606     MOVE STATEI                 TO W-CNTL-GEN1.
 10607     MOVE +0                     TO W-CNTL-SEQ-NO.
 10608
 10609
 10610* EXEC CICS HANDLE CONDITION
 10611*        NOTFND  (0994-STATE-NOT-FOUND)
 10612*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10613*    END-EXEC.
 10614*    MOVE '"$IJ                  ! '' #00010350' TO DFHEIV0
 10615     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10617     MOVE X'2720233030303130333530' TO DFHEIV0(25:11)
 10618     CALL 'kxdfhei1' USING DFHEIV0
 10619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10620
 10621
 10622
 10623* EXEC CICS READ
 10624*        DATASET (W-CNTL-FILE-ID)
 10625*        SET     (ADDRESS OF CONTROL-FILE)
 10626*        RIDFLD  (W-CNTL-KEY)
 10627*    END-EXEC.
 10628*    MOVE '&"S        E          (   #00010355' TO DFHEIV0
 10629     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10630     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10631     MOVE X'2020233030303130333535' TO DFHEIV0(25:11)
 10632     CALL 'kxdfhei1' USING DFHEIV0,
 10633           W-CNTL-FILE-ID,
 10634           DFHEIV20,
 10635           DFHEIV99,
 10636           W-CNTL-KEY,
 10637           DFHEIV99,
 10638           DFHEIV99,
 10639           DFHEIV99
 10640     SET ADDRESS OF CONTROL-FILE TO
 10641         DFHEIV20
 10642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10643
 10644
 10645     MOVE AL-UANON               TO STATEA.
 10646     MOVE STATEI                 TO PI-689-STATE
 10647                                    W-ACCT-STATE
 10648                                    W-CERT-STATE
 10649                                    W-CHEK-STATE
 10650                                    W-MAIL-STATE
 10651                                    W-PNDB2-STATE.
 10652
 10653     GO TO 0994-EXIT.
 10654
 10655 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 214
* EL689.cbl
 10656
 10657     MOVE -1                     TO STATEL.
 10658     MOVE AL-UABON               TO STATEA.
 10659     MOVE ER-2209                TO EMI-ERROR.
 10660     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10661
 10662 0994-EXIT.
 10663     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 215
* EL689.cbl
 10665 1000-SHOW.
 10666***************************************************************
 10667*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10668*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10669*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10670*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10671***************************************************************
 10672
 10673     MOVE SPACES                 TO W-RECORD-TABLE.
 10674
 10675     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10676          MOVE PI-689-LBL-OVERRIDE
 10677                                 TO ADDRLBLI
 10678          MOVE +1                TO ADDRLBLL
 10679          MOVE AL-UANON          TO ADDRLBLA
 10680     ELSE
 10681          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10682          MOVE +1                TO ADDRLBLL
 10683          MOVE AL-UANON          TO ADDRLBLA.
 10684
 10685     IF  ARCHNUML EQUAL ZEROS
 10686         MOVE -1                 TO ARCHNUML
 10687         MOVE AL-UNBON           TO ARCHNUMA
 10688         MOVE ER-0174            TO EMI-ERROR
 10689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10690         GO TO 8200-SEND-DATAONLY.
 10691
 10692     IF  ARCHNUMI NOT NUMERIC
 10693         MOVE -1                 TO ARCHNUML
 10694         MOVE AL-UNBON           TO ARCHNUMA
 10695         MOVE ER-0175            TO EMI-ERROR
 10696         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10697         GO TO 8200-SEND-DATAONLY.
 10698
 10699     IF  PI-SHOW-MODE
 10700
 10701         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10702             MOVE -1             TO MAINTL
 10703             GO TO 8200-SEND-DATAONLY
 10704         ELSE
 10705             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10706
 10707     MOVE +0                     TO W-ARCH-SEQ-NO
 10708                                    W-ARCT-SEQ-NO.
 10709     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10710                                    W-ARCT-COMPANY-CD.
 10711     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10712                                    W-ARCT-NUMBER
 10713                                    PI-689-ARCHIVE-NUMBER.
 10714     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10715     MOVE '1'                    TO PI-ACTION.
 10716     MOVE SPACES                 TO PI-689-PRINT-SW
 10717                                    PI-689-FORM-NUMBER
 10718                                    W-DELETE-KEY.
 10719     SET W-RG-NDX                TO W-ZEROS.
 10720
 10721
 10722* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 216
* EL689.cbl
 10723*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10724*         NOTFND     (1070-ARCH-NOT-FOUND)
 10725*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10726*    END-EXEC.
 10727*    MOVE '"$JI''                 ! ( #00010437' TO DFHEIV0
 10728     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10730     MOVE X'2820233030303130343337' TO DFHEIV0(25:11)
 10731     CALL 'kxdfhei1' USING DFHEIV0
 10732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10733
 10734
 10735
 10736* EXEC CICS READ
 10737*        DATASET (W-ARCH-FILE-ID)
 10738*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10739*        RIDFLD  (W-ARCH-KEY)
 10740*    END-EXEC.
 10741*    MOVE '&"S        E          (   #00010443' TO DFHEIV0
 10742     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10744     MOVE X'2020233030303130343433' TO DFHEIV0(25:11)
 10745     CALL 'kxdfhei1' USING DFHEIV0,
 10746           W-ARCH-FILE-ID,
 10747           DFHEIV20,
 10748           DFHEIV99,
 10749           W-ARCH-KEY,
 10750           DFHEIV99,
 10751           DFHEIV99,
 10752           DFHEIV99
 10753     SET ADDRESS OF LETTER-ARCHIVE TO
 10754         DFHEIV20
 10755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10756
 10757
 10758     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10759
 10760*    EXEC CICS HANDLE CONDITION
 10761*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10762*         NOTFND     (1020-ARCT-ENDBR)
 10763*         ENDFILE    (1020-ARCT-ENDBR)
 10764*    END-EXEC.
 10765*
 10766*1005-START-BROWSE.
 10767*
 10768*    EXEC CICS STARTBR
 10769*         DATASET    (W-ARCT-FILE-ID)
 10770*         RIDFLD     (W-ARCT-KEY)
 10771*         GTEQ
 10772*    END-EXEC.
 10773*
 10774*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10775*
 10776*1010-READ-NEXT.
 10777*
 10778*    EXEC CICS READNEXT
 10779*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10780*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 217
* EL689.cbl
 10781*         RIDFLD    (W-ARCT-KEY)
 10782*    END-EXEC.
 10783*
 10784*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10785*        IF  LT-ADDRESS-DATA
 10786*            IF  PI-CREATE-LABELS  AND
 10787*                NOT PI-689-LABELS-OVERRIDEN
 10788*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10789*                        VARYING
 10790*                    LT-NDX FROM 1 BY 1
 10791*                        UNTIL
 10792*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10793*                GO TO 1010-READ-NEXT
 10794*            ELSE
 10795*                MOVE LT-CONTROL-PRIMARY
 10796*                                TO W-DELETE-KEY
 10797*                GO TO 1010-READ-NEXT
 10798*        ELSE
 10799*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10800*                    VARYING
 10801*                LT-NDX FROM 1 BY 1
 10802*                    UNTIL
 10803*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10804*                    OR
 10805*                LT-NDX GREATER THAN +20
 10806*            GO TO 1010-READ-NEXT.
 10807*
 10808*1020-ARCT-ENDBR.
 10809*
 10810*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10811*        EXEC CICS ENDBR
 10812*             DATASET   (W-ARCT-FILE-ID)
 10813*        END-EXEC.
 10814*
 10815*    IF  W-RG-NDX EQUAL ZEROS
 10816*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10817*
 10818*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10819*            AND
 10820*        PI-BYPASS-LABELS
 10821*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10822*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10823*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10824*
 10825*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10826*    MOVE 1                      TO PI-CURRENT-LINE.
 10827*    SET W-RG-NDX                TO +1.
 10828*
 10829*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10830*            VARYING
 10831*        W-SC-NDX FROM 1 BY 1
 10832*            UNTIL
 10833*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10834
 10835     MOVE -1                     TO MAINTL.
 10836     GO TO 8100-SEND-INITIAL-MAP.
 10837
 10838 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 218
* EL689.cbl
 10839     EXIT.
 10840
 10841 1030-TEXT-BUILD.
 10842
 10843     SET W-RG-NDX UP BY 1.
 10844     MOVE LT-SKIP-CONTROL (LT-NDX)
 10845                                 TO W-PRINT-CONTROL.
 10846
 10847     IF  W-PRINT-CONTROL EQUAL 99
 10848         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10849         SET W-RG-NDX UP BY 1
 10850     ELSE
 10851         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10852
 10853     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10854     MOVE LT-SKIP-CONTROL (LT-NDX)
 10855                                 TO W-RC-PC (W-RG-NDX).
 10856     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10857
 10858 1030-EXIT.
 10859     EXIT.
 10860
 10861 1040-FORMAT-HEADER-DATA.
 10862
 10863     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10864     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10865     MOVE LA-CARRIER-A2          TO CARRIERO.
 10866     MOVE LA-CERT-NO-A2          TO CERTO.
 10867     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10868     MOVE LA-DATA-SOURCE         TO DATASORO.
 10869
 10870     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10871         MOVE ZEROES             TO DATEO
 10872
 10873     ELSE
 10874         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10875         MOVE ' '                TO DC-OPTION-CODE
 10876         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10877         MOVE DC-GREG-DATE-1-EDIT
 10878                                 TO DATEO.
 10879
 10880     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10881         MOVE ZEROES             TO FOLLOWO
 10882     ELSE
 10883         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10884         MOVE ' '                TO DC-OPTION-CODE
 10885         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10886         MOVE DC-GREG-DATE-1-EDIT
 10887                                 TO FOLLOWO.
 10888
 10889     MOVE LA-FORM-A3             TO FORMO.
 10890     MOVE LA-GROUPING-A2         TO GROUPO.
 10891     MOVE LA-NO-OF-COPIES        TO COPIESO
 10892                                    PI-689-NUMBER-COPIES.
 10893
 10894*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10895*        MOVE LA-PRINT-RESTRICTION
 10896*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 219
* EL689.cbl
 10897*    ELSE
 10898*        MOVE SPACES             TO PRTRESTO.
 10899
 10900     IF  LA-RESEND-DATE = LOW-VALUES
 10901         MOVE ZEROES             TO RESEND1O
 10902     ELSE
 10903         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10904         MOVE ' '                TO DC-OPTION-CODE
 10905         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10906         MOVE DC-GREG-DATE-1-EDIT
 10907                                 TO RESEND1O.
 10908
 10909     MOVE LA-STATE-A2            TO STATEO.
 10910
 10911     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10912
 10913 1040-EXIT.
 10914     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 220
* EL689.cbl
 10916 1050-MOVE-LABELS.
 10917
 10918     SET W-RG-NDX                TO LT-NDX.
 10919     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 10920     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10921     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10922
 10923 1050-EXIT.
 10924     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 221
* EL689.cbl
 10926 1060-DELETE-ADDRESS-RECORD.
 10927
 10928
 10929* EXEC CICS DELETE
 10930*        DATASET (W-ARCT-FILE-ID)
 10931*        RIDFLD  (W-DELETE-KEY)
 10932*    END-EXEC.
 10933*    MOVE '&(  R                 &   #00010619' TO DFHEIV0
 10934     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 10935     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10936     MOVE X'2020233030303130363139' TO DFHEIV0(25:11)
 10937     CALL 'kxdfhei1' USING DFHEIV0,
 10938           W-ARCT-FILE-ID,
 10939           W-DELETE-KEY,
 10940           DFHEIV99,
 10941           DFHEIV99,
 10942           DFHEIV99
 10943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10944
 10945
 10946
 10947* EXEC CICS READ
 10948*        DATASET (W-ARCH-FILE-ID)
 10949*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10950*        RIDFLD  (W-ARCH-KEY)
 10951*        UPDATE
 10952*    END-EXEC.
 10953*    MOVE '&"S        EU         (   #00010624' TO DFHEIV0
 10954     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10956     MOVE X'2020233030303130363234' TO DFHEIV0(25:11)
 10957     CALL 'kxdfhei1' USING DFHEIV0,
 10958           W-ARCH-FILE-ID,
 10959           DFHEIV20,
 10960           DFHEIV99,
 10961           W-ARCH-KEY,
 10962           DFHEIV99,
 10963           DFHEIV99,
 10964           DFHEIV99
 10965     SET ADDRESS OF LETTER-ARCHIVE TO
 10966         DFHEIV20
 10967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10968
 10969
 10970     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 10971
 10972
 10973* EXEC CICS REWRITE
 10974*         FROM      (LETTER-ARCHIVE)
 10975*         DATASET   (W-ARCH-FILE-ID)
 10976*    END-EXEC.
 10977     MOVE LENGTH OF
 10978      LETTER-ARCHIVE
 10979       TO DFHEIV11
 10980*    MOVE '&& L                  %   #00010633' TO DFHEIV0
 10981     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10982     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10983     MOVE X'2020233030303130363333' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 222
* EL689.cbl
 10984     CALL 'kxdfhei1' USING DFHEIV0,
 10985           W-ARCH-FILE-ID,
 10986           LETTER-ARCHIVE,
 10987           DFHEIV11,
 10988           DFHEIV99
 10989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10990
 10991
 10992 1060-EXIT.
 10993     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 223
* EL689.cbl
 10995 1070-ARCH-NOT-FOUND.
 10996
 10997     MOVE ER-7371                TO EMI-ERROR.
 10998     MOVE -1                     TO ARCHNUML.
 10999     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11000     GO TO 8100-SEND-INITIAL-MAP.
 11001
 11002 1080-ARCHIVE-TEXT-NOT-FOUND.
 11003
 11004     MOVE ER-7372                TO EMI-ERROR.
 11005     MOVE -1                     TO ARCHNUML.
 11006     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11007     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 224
* EL689.cbl
 11009 2000-CREATE.
 11010***************************************************************
 11011*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 11012*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 11013*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 11014*    WILL BE DISPLAYED ON THE SCREEN.                         *
 11015*                                                             *
 11016***************************************************************
 11017
 11018***************************************************************
 11019*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 11020*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 11021*    THEN FORCE AN ERROR.                                     *
 11022***************************************************************
 11023
 11024     IF  PI-689-CREATE-NO-SCREENS
 11025         GO TO 2000-GET-TEXT.
 11026
 11027     IF  PI-CREATE-MODE
 11028         IF  PI-689-PRINT-PERFORMED
 11029                 AND
 11030             FORMI NOT EQUAL 9999
 11031             MOVE ER-0279    TO EMI-ERROR
 11032             MOVE -1         TO MAINTL
 11033             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11034             GO TO 8200-SEND-DATAONLY.
 11035
 11036     IF  ARCHNUML GREATER THAN ZEROS
 11037         MOVE ER-9320            TO EMI-ERROR
 11038         MOVE -1                 TO ARCHNUML
 11039         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11040         GO TO 8200-SEND-DATAONLY.
 11041
 11042***************************************************************
 11043*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 11044*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 11045***************************************************************
 11046
 11047     IF  FORMI EQUAL '9999'
 11048         MOVE 16                 TO PI-TOTAL-LINES
 11049         MOVE 1                  TO PI-CURRENT-LINE
 11050         MOVE SPACES             TO W-FILE-TABLE
 11051                                    W-LINE-CONTROL-RECORD
 11052                                    W-RECORD-TABLE
 11053                                    W-SINGLE-LINE
 11054                                    W-SQUEEZED-LINE
 11055                                    W-TS-WORK-AREA
 11056                                    W-TX-TABLE
 11057         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 11058         MOVE '3'                TO PI-ACTION
 11059         MOVE FORMI              TO PI-689-FORM-NUMBER
 11060                                    PI-COMM-CONTROL
 11061         MOVE ZEROS              TO PI-UPDATE-SW
 11062         MOVE W-PGM-EL1042       TO W-CALL-PGM
 11063         GO TO 9400-XCTL.
 11064
 11065 2000-GET-TEXT.
 11066
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 225
* EL689.cbl
 11067     MOVE SPACES                 TO W-FILE-TABLE
 11068                                    W-LINE-CONTROL-RECORD
 11069                                    W-RECORD-TABLE
 11070                                    W-SINGLE-LINE
 11071                                    W-SQUEEZED-LINE
 11072                                    W-TS-WORK-AREA
 11073                                    W-TX-TABLE.
 11074     SET W-TG-NDX                TO +1
 11075     MOVE ZEROS                  TO W-INITIAL-COLUMN
 11076                                    W-LINE-COUNT
 11077                                    W-LINE-INDENT-1
 11078                                    W-LINE-INDENT-2
 11079                                    W-LINE-INDENT-3
 11080                                    W-LINE-INDENT-4
 11081                                    W-LINE-INDENT-5
 11082                                    W-PAGE
 11083                                    W-PARAGRAPH-INDENT
 11084                                    W-TOP-MARGIN
 11085                                    W-WORK-INDENT.
 11086     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 11087     MOVE +70                    TO W-LAST-COLUMN.
 11088     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 11089     MOVE +1                     TO W-START-COLUMN.
 11090     MOVE +71                    TO W-TOO-FAR.
 11091
 11092     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 11093     MOVE FORMI                  TO W-TEXT-LETTER.
 11094     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 11095     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 11096
 11097
 11098* EXEC CICS HANDLE CONDITION
 11099*         NOTFND     (2001-NOT-FOUND)
 11100*         ENDFILE    (2001-NOT-FOUND)
 11101*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 11102*    END-EXEC.
 11103*    MOVE '"$I''J                 ! ) #00010743' TO DFHEIV0
 11104     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 11105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11106     MOVE X'2920233030303130373433' TO DFHEIV0(25:11)
 11107     CALL 'kxdfhei1' USING DFHEIV0
 11108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11109
 11110
 11111
 11112* EXEC CICS STARTBR
 11113*         DATASET    (W-TEXT-FILE-ID)
 11114*         RIDFLD     (W-TEXT-KEY)
 11115*         GTEQ
 11116*    END-EXEC.
 11117     MOVE 0
 11118       TO DFHEIV11
 11119*    MOVE '&,         G          &   #00010749' TO DFHEIV0
 11120     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11121     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11122     MOVE X'2020233030303130373439' TO DFHEIV0(25:11)
 11123     CALL 'kxdfhei1' USING DFHEIV0,
 11124           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 226
* EL689.cbl
 11125           W-TEXT-KEY,
 11126           DFHEIV99,
 11127           DFHEIV11,
 11128           DFHEIV99
 11129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11130
 11131
 11132
 11133* EXEC CICS HANDLE CONDITION
 11134*         ENDFILE    (2000-ENDBR)
 11135*    END-EXEC.
 11136*    MOVE '"$''                   ! * #00010755' TO DFHEIV0
 11137     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 11138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11139     MOVE X'2A20233030303130373535' TO DFHEIV0(25:11)
 11140     CALL 'kxdfhei1' USING DFHEIV0
 11141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11142
 11143
 11144 2000-READ-NEXT.
 11145
 11146     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 11147         MOVE ER-0051            TO EMI-ERROR
 11148         MOVE -1                 TO MAINTL
 11149         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11150         GO TO 2000-ENDBR.
 11151
 11152
 11153* EXEC CICS READNEXT
 11154*         DATASET    (W-TEXT-FILE-ID)
 11155*         SET        (ADDRESS OF TEXT-FILES)
 11156*         RIDFLD     (W-TEXT-KEY)
 11157*    END-EXEC.
 11158     MOVE 0
 11159       TO DFHEIV11
 11160*    MOVE '&.S                   )   #00010767' TO DFHEIV0
 11161     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11162     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11163     MOVE X'2020233030303130373637' TO DFHEIV0(25:11)
 11164     CALL 'kxdfhei1' USING DFHEIV0,
 11165           W-TEXT-FILE-ID,
 11166           DFHEIV20,
 11167           DFHEIV99,
 11168           W-TEXT-KEY,
 11169           DFHEIV99,
 11170           DFHEIV11,
 11171           DFHEIV99,
 11172           DFHEIV99
 11173     SET ADDRESS OF TEXT-FILES TO
 11174         DFHEIV20
 11175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11176
 11177
 11178     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 11179         GO TO 2000-ENDBR.
 11180
 11181     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 11182
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 227
* EL689.cbl
 11183     MOVE TX-FORM-SQUEEZE-CONTROL
 11184                                 TO W-FORM-SQUEEZE-IND.
 11185
 11186     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 11187         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 11188
 11189     IF  TX-FORM-CONTROL-LINE
 11190         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 11191         GO TO 2000-READ-NEXT.
 11192
 11193     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 11194         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 11195         GO TO 2000-READ-NEXT.
 11196
 11197     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 11198     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 11199     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 11200     MOVE TX-LINE-SQUEEZE-CONTROL
 11201                                 TO W-TX-SC (W-TG-NDX).
 11202
 11203     SET W-TG-NDX UP BY 1.
 11204     GO TO 2000-READ-NEXT.
 11205
 11206 2000-ENDBR.
 11207
 11208
 11209* EXEC CICS ENDBR
 11210*        DATASET     (W-TEXT-FILE-ID)
 11211*    END-EXEC.
 11212     MOVE 0
 11213       TO DFHEIV11
 11214*    MOVE '&2                    $   #00010803' TO DFHEIV0
 11215     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11216     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11217     MOVE X'2020233030303130383033' TO DFHEIV0(25:11)
 11218     CALL 'kxdfhei1' USING DFHEIV0,
 11219           W-TEXT-FILE-ID,
 11220           DFHEIV11,
 11221           DFHEIV99
 11222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11223
 11224
 11225     IF  W-TEXT-BROWSE-NOT-STARTED
 11226         MOVE ER-0006            TO EMI-ERROR
 11227         MOVE -1                 TO FORML
 11228         MOVE AL-UABON           TO FORMA
 11229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11230         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11231
 11232     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 11233     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 11234     MOVE 1                      TO PI-CURRENT-LINE.
 11235
 11236     IF  COPIESL NOT GREATER THAN ZEROS
 11237         MOVE +1                 TO COPIESI
 11238                                    PI-689-NUMBER-COPIES
 11239         MOVE +1                 TO COPIESL
 11240         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 228
* EL689.cbl
 11241
 11242***************************************************************
 11243*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 11244*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 11245***************************************************************
 11246
 11247     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 11248
 11249*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 11250*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 11251*            MOVE ER-7243        TO EMI-ERROR
 11252*            MOVE -1             TO PRTRESTL
 11253*            MOVE AL-UABON       TO PRTRESTA
 11254*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11255
 11256     IF  PI-CREATE-LABELS AND
 11257         NOT  PI-689-LABELS-OVERRIDEN
 11258         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11259         SET W-RG-NDX UP BY +1
 11260     ELSE
 11261         SET W-RG-NDX            TO +1.
 11262
 11263     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 11264     SET W-RG-NDX UP BY W-TOP-MARGIN.
 11265
 11266     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 11267
 11268     SET PI-TOTAL-LINES          TO W-RG-NDX.
 11269
 11270     IF  W-FIRST-BAD-VARIABLE-FOUND
 11271         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 11272         MOVE W-FIRST-BAD-VARIABLE
 11273                                 TO PI-CURRENT-LINE
 11274     ELSE
 11275         SET W-RG-NDX            TO 1.
 11276
 11277     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11278             VARYING
 11279         W-SC-NDX FROM 1 BY 1
 11280             UNTIL
 11281         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11282     IF  PI-689-CREATE-NO-SCREENS
 11283         GO TO 2000-EXIT
 11284     ELSE
 11285         IF  W-FORM-CHANGED
 11286             MOVE '3'            TO PI-ACTION
 11287             MOVE -1             TO MAINTL
 11288             GO TO 8100-SEND-INITIAL-MAP
 11289         ELSE
 11290             MOVE '3'            TO PI-ACTION
 11291             MOVE -1             TO MAINTL
 11292             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11293
 11294 2000-EXIT.
 11295     EXIT.
 11296
 11297 2001-NOT-FOUND.
 11298
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 229
* EL689.cbl
 11299     MOVE ER-0006                TO EMI-ERROR.
 11300     MOVE -1                     TO FORML.
 11301     MOVE AL-UABON               TO FORMA.
 11302     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11303     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 230
* EL689.cbl
 11305 2100-PROCESS-FORM-CONTROL-LINE.
 11306
 11307     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 11308
 11309     IF  W-LC-LINE-WIDTH NUMERIC
 11310             AND
 11311         W-LC-LINE-WIDTH GREATER THAN ZEROS
 11312         COMPUTE W-INITIAL-COLUMN
 11313             = (70 - W-LC-LINE-WIDTH) / 2
 11314         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 11315         COMPUTE W-LAST-COLUMN ROUNDED
 11316             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 11317         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 11318     ELSE
 11319         MOVE 70                 TO W-LC-LINE-WIDTH.
 11320
 11321     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 11322             AND
 11323         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 11324         MOVE W-LC-PARAGRAPH-INDENT
 11325                                 TO W-PARAGRAPH-INDENT.
 11326
 11327     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 11328             AND
 11329         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 11330         MOVE W-LC-MAX-LINES-PER-PAGE
 11331                                 TO W-MAX-LINES-PER-PAGE.
 11332
 11333     IF  W-LC-LINE-ADJUST NUMERIC
 11334             AND
 11335         W-LC-LINE-ADJUST GREATER THAN ZEROS
 11336         COMPUTE W-TOTAL-LINE-LENGTH
 11337             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 11338         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 11339             ADD W-LC-LINE-ADJUST
 11340                                 TO W-INITIAL-COLUMN
 11341                                    W-LAST-COLUMN
 11342                                    W-START-COLUMN
 11343                                    W-TOO-FAR.
 11344
 11345     IF  W-LC-LINE-INDENT-1 NUMERIC
 11346             AND
 11347         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 11348         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 11349     ELSE
 11350         MOVE +0                 TO W-LINE-INDENT-1.
 11351
 11352     IF  W-LC-LINE-INDENT-2 NUMERIC
 11353             AND
 11354         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 11355         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 11356     ELSE
 11357         MOVE +0                 TO W-LINE-INDENT-2.
 11358
 11359     IF  W-LC-LINE-INDENT-3 NUMERIC
 11360             AND
 11361         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 11362         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 231
* EL689.cbl
 11363     ELSE
 11364         MOVE +0                 TO W-LINE-INDENT-3.
 11365
 11366     IF  W-LC-LINE-INDENT-4 NUMERIC
 11367             AND
 11368         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 11369         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 11370     ELSE
 11371         MOVE +0                 TO W-LINE-INDENT-4.
 11372
 11373     IF  W-LC-LINE-INDENT-5 NUMERIC
 11374             AND
 11375         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 11376         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 11377
 11378     ELSE
 11379         MOVE +0                 TO W-LINE-INDENT-5.
 11380
 11381     IF  W-LC-TOP-MARGIN NUMERIC
 11382         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 11383     ELSE
 11384         MOVE +0                 TO W-TOP-MARGIN.
 11385
 11386     IF W-LC-CASE-IND = 'Y' OR 'N'
 11387         NEXT SENTENCE
 11388     ELSE
 11389         MOVE PI-LOWER-CASE-LETTERS
 11390                                 TO W-LC-CASE-IND.
 11391
 11392 2100-EXIT.
 11393     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 232
* EL689.cbl
 11395 2150-PROCESS-Z-CONTROLS.
 11396
 11397     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 11398
 11399     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 11400        IF W-DAYS-TO-RESEND NUMERIC
 11401           IF W-DAYS-TO-RESEND > ZEROS
 11402              MOVE '6'           TO DC-OPTION-CODE
 11403              MOVE W-SAVE-BIN-NEXT-BUS-DT
 11404                                 TO DC-BIN-DATE-1
 11405              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 11406              MOVE W-DAYS-TO-RESEND
 11407                                 TO DC-ELAPSED-DAYS
 11408              PERFORM 9500-LINK-DATE-CONVERT
 11409                                 THRU 9500-EXIT
 11410              IF NO-CONVERSION-ERROR
 11411                 MOVE DC-BIN-DATE-2
 11412                                 TO PI-689-RESEND-DATE-1
 11413                 MOVE DC-GREG-DATE-1-EDIT
 11414                                 TO RESEND1O
 11415                                    PI-689-RESEND1-EDIT
 11416                 MOVE AL-UANON
 11417                                 TO RESEND1A
 11418                 MOVE +8         TO RESEND1L
 11419              ELSE
 11420                 MOVE ER-3770
 11421                                 TO EMI-ERROR
 11422                 MOVE -1         TO MAINTL
 11423                 PERFORM 9900-ERROR-FORMAT
 11424                                 THRU 9900-EXIT
 11425                 GO TO 8200-SEND-DATAONLY
 11426              END-IF
 11427           END-IF
 11428        END-IF
 11429     END-IF
 11430     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 11431        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 11432     END-IF
 11433     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 11434         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 11435            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 11436                 MOVE '6'        TO DC-OPTION-CODE
 11437                 MOVE W-SAVE-BIN-DATE
 11438                                 TO DC-BIN-DATE-1
 11439                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 11440                 MOVE W-DAYS-TO-FOLLOW-UP
 11441                                 TO DC-ELAPSED-DAYS
 11442                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11443                 IF  NO-CONVERSION-ERROR
 11444                     MOVE DC-BIN-DATE-2
 11445                                 TO PI-689-FOLLOW-UP-DATE
 11446                     MOVE DC-GREG-DATE-1-EDIT
 11447                                 TO FOLLOWO
 11448                     MOVE AL-UANON
 11449                                 TO FOLLOWA
 11450                     MOVE +8     TO FOLLOWL
 11451                 ELSE
 11452                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 233
* EL689.cbl
 11453                                 TO EMI-ERROR
 11454                     MOVE -1     TO MAINTL
 11455                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11456                     GO TO 8200-SEND-DATAONLY.
 11457
 11458     IF  COPIESI NOT NUMERIC
 11459             OR
 11460         COPIESI NOT GREATER THAN ZEROS
 11461         IF  W-NUMBER-OF-COPIES NUMERIC
 11462             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 11463                 MOVE W-NUMBER-OF-COPIES
 11464                                 TO COPIESI
 11465                                    PI-689-NUMBER-COPIES
 11466                 MOVE AL-UNNON   TO COPIESA
 11467                 MOVE +1         TO COPIESL
 11468             ELSE
 11469                 MOVE +1         TO COPIESI
 11470                                    PI-689-NUMBER-COPIES
 11471                 MOVE AL-UNNON   TO COPIESA
 11472                 MOVE +1         TO COPIESL
 11473         ELSE
 11474             MOVE +1             TO COPIESI
 11475                                    PI-689-NUMBER-COPIES
 11476             MOVE AL-UNNON       TO COPIESA
 11477             MOVE +1             TO COPIESL.
 11478
 11479     IF W-PROMPT-LETTER EQUAL 'Y'
 11480         MOVE 'Y'                TO PI-PROMPT-IND
 11481         MOVE ER-0894            TO EMI-ERROR
 11482         MOVE -1                 TO MAINTL
 11483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11484     END-IF.
 11485
 11486     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 11487                                           ENCO
 11488     MOVE AL-UANON                      TO ENCA
 11489     MOVE +3                            TO ENCL
 11490
 11491     IF W-PRINT-CERTIFICATE = 'Y'
 11492        MOVE 'Y' TO PI-CERT-REQ-IND
 11493        IF CERTIDL > ZEROS
 11494            IF CERTIDI NUMERIC
 11495              MOVE AL-UANON      TO CERTIDA
 11496              MOVE CERTIDI       TO PI-CERT-FORM-ID
 11497            ELSE
 11498              MOVE ER-1778       TO EMI-ERROR
 11499              MOVE -1            TO CERTIDL
 11500              MOVE AL-UABON      TO CERTIDA
 11501              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11502           END-IF
 11503        ELSE
 11504              MOVE ER-0715       TO EMI-ERROR
 11505              MOVE -1            TO CERTIDL
 11506              MOVE AL-UABON      TO CERTIDA
 11507              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11508        END-IF
 11509     END-IF.
 11510
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 234
* EL689.cbl
 11511     IF W-REASONS-REQUIRED = 'Y'
 11512        MOVE 'Y' TO PI-REASON-REQ-IND
 11513        IF PI-ENDT-ARCH-NO NOT > ZERO
 11514          MOVE ER-9840       TO EMI-ERROR
 11515          MOVE -1            TO FORML
 11516          MOVE AL-UABON      TO FORMA
 11517          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11518        END-IF
 11519     END-IF.
 11520
 11521*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 11522*                                       SPACES
 11523*        IF  W-PRINT-RESTRICTED
 11524*            MOVE W-PRINT-RESTRICTED-IND
 11525*                                TO PRTRESTI
 11526*                                   PI-689-PRINT-RESTRICTION
 11527*            MOVE AL-UANON       TO PRTRESTA
 11528*            MOVE +1             TO PRTRESTL.
 11529     .
 11530 2150-EXIT.
 11531     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 235
* EL689.cbl
 11533 2200-CHECK-FOR-VARIABLE.
 11534
 11535     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 11536         GO TO 2200-EXIT.
 11537
 11538     SET W-TX-NDX                TO +1.
 11539
 11540 2200-CONTINUE.
 11541
 11542     SEARCH W-TX-CHAR
 11543         VARYING
 11544             W-TX-NDX
 11545         AT END
 11546             GO TO 2200-EXIT
 11547         WHEN
 11548             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11549             NEXT SENTENCE.
 11550
 11551     SET W-TX-NDX UP BY +1.
 11552
 11553     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11554         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 11555         GO TO 2200-CONTINUE.
 11556
 11557 2200-EXIT.
 11558     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 236
* EL689.cbl
 11560 2220-BUILD-VARIABLE-NUMBER.
 11561
 11562     SET W-TX-NDX UP BY +1.
 11563     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 11564     SET W-TX-NDX UP BY +1.
 11565     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 11566     SET W-TX-NDX UP BY +1.
 11567     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11568
 11569     IF  W-VAR-RELATIVE-NUM NUMERIC
 11570         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11571         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11572
 11573 2220-EXIT.
 11574     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 237
* EL689.cbl
 11576 4000-ROLL-PAGE.
 11577
 11578     IF  ENTERPFL NOT EQUAL ZEROS
 11579         MOVE -1                 TO ENTERPFL
 11580     ELSE
 11581         MOVE -1                 TO MAINTL.
 11582
 11583     IF  PI-TOTAL-LINES EQUAL 0
 11584         MOVE ER-0047            TO EMI-ERROR
 11585         MOVE -1                 TO MAINTL
 11586         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11587         GO TO 8200-SEND-DATAONLY.
 11588
 11589     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11590         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11591
 11592     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11593             OR
 11594         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11595         MOVE ER-0067            TO EMI-ERROR
 11596         MOVE -1                 TO MAINTL
 11597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11598         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11599
 11600*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11601*            AND
 11602*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11603*        MOVE ER-0066            TO EMI-ERROR
 11604*        MOVE -1                 TO MAINTL
 11605*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11606*        COMPUTE W-TEMP-CURRENT-LINE
 11607*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11608*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11609*                OR
 11610*            W-TEMP-CURRENT-LINE = ZEROS
 11611*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11612
 11613     IF  EMI-ERROR NOT EQUAL ER-0191
 11614             AND
 11615         MAINTI NOT EQUAL 'S'
 11616         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11617         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11618         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11619                 VARYING
 11620             W-SC-NDX FROM 1 BY 1
 11621                 UNTIL
 11622             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11623
 11624     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11625                         ER-0191
 11626         NEXT SENTENCE
 11627     ELSE
 11628         GO TO 8200-SEND-DATAONLY.
 11629
 11630     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11631     SET W-RG-NDX                TO PI-CURRENT-LINE
 11632     MOVE LOW-VALUES             TO EL689RI
 11633*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 238
* EL689.cbl
 11634     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11635     SET W-RG-NDX                TO PI-CURRENT-LINE
 11636     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11637             VARYING
 11638         W-SC-NDX FROM 1 BY 1
 11639             UNTIL
 11640         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11641
 11642     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 239
* EL689.cbl
 11644 4100-SET-NDX.
 11645
 11646     IF  PI-CURRENT-LINE EQUAL 0
 11647         SET W-RG-NDX            TO 1
 11648     ELSE
 11649         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11650
 11651 4100-EXIT.
 11652      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 240
* EL689.cbl
 11654 4200-UPDATE-TABLE-FROM-SCREEN.
 11655
 11656     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11657         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11658         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11659             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11660                 MOVE ER-0051    TO EMI-ERROR
 11661                 MOVE -1         TO MAINTL
 11662                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11663                 GO TO 8200-SEND-DATAONLY
 11664             ELSE
 11665                 MOVE W-SC-TEXT (W-SC-NDX)
 11666                                 TO W-RC-TEXT (W-RG-NDX)
 11667                 ADD 1           TO PI-TOTAL-LINES
 11668         ELSE
 11669             MOVE W-SC-TEXT (W-SC-NDX)
 11670                                 TO W-RC-TEXT (W-RG-NDX).
 11671
 11672     SET W-RG-NDX UP BY 1.
 11673
 11674 4200-EXIT.
 11675      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 241
* EL689.cbl
 11677
 11678
 11679 4500-CONNECT-TO-DB.
 11680
 11681     MOVE 'NTCSO2_LOGIC'         TO SVR
 11682     MOVE 'sa'                   TO USR
 11683     MOVE 'ntcso2'               TO PASS
 11684
 11685     STRING
 11686         USR DELIMITED SPACE
 11687         "." DELIMITED SIZE
 11688         PASS DELIMITED SPACE INTO USR-PASS
 11689     END-STRING
 11690
 11691     EXEC SQL
 11692        CONNECT TO :SVR USER :USR-PASS
 11693     END-EXEC
 11694
 11695     IF SQLCODE NOT = 0
 11696        DISPLAY "ERROR: CANNOT CONNECT "
 11697        DISPLAY SQLCODE
 11698        DISPLAY SQLERRMC
 11699        GO TO 4500-EXIT
 11700     END-IF
 11701
 11702     .
 11703 4500-EXIT.
 11704     EXIT.
 11705
 11706
 11707
 11708 4600-GET-NEXT-BUS-DT.
 11709
 11710     MOVE W-SAVE-EDIT-A-DATE     TO WS-CYCLE-DATE
 11711     MOVE SPACES                 TO WS-NEXT-BUS-DT
 11712
 11713     IF WS-KIXHOST = 'logictest'
 11714        EXEC SQL
 11715          CALL NaperTestCalcNextBusDt
 11716                        @cycledate = :WS-CYCLE-DATE,
 11717                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11718        END-EXEC
 11719     ELSE
 11720        EXEC SQL
 11721          CALL NaperProdCalcNextBusDt
 11722                        @cycledate = :WS-CYCLE-DATE,
 11723                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11724        END-EXEC
 11725     END-IF
 11726
 11727     IF SQLCODE NOT = 0
 11728        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
 11729        DISPLAY ' SQL RETURN CODE ' SQLCODE
 11730        DISPLAY ' SQL ERR MESS    ' SQLERRMC
 11731        GO TO 4600-EXIT
 11732     END-IF
 11733
 11734     .
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 242
* EL689.cbl
 11735 4600-EXIT.
 11736     EXIT.
 11737
 11738
 11739 5000-EDIT-MODE.
 11740***************************************************************
 11741*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11742*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11743*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11744***************************************************************
 11745
 11746     IF  PI-SHOW-MODE
 11747         MOVE ER-0188            TO EMI-ERROR
 11748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11749         MOVE -1                 TO MAINTL
 11750         MOVE AL-UABON           TO MAINTA
 11751         GO TO 8200-SEND-DATAONLY.
 11752
 11753     IF  PI-CURRENT-LINE EQUAL ZEROS
 11754         MOVE ER-0187            TO EMI-ERROR
 11755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11756         MOVE -1                 TO MAINTL
 11757         GO TO 8200-SEND-DATAONLY.
 11758
 11759     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11760     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11761     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11762             VARYING
 11763         W-SC-NDX FROM 1 BY 1
 11764             UNTIL
 11765         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11766
 11767     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11768
 11769     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11770     MOVE ZEROS                  TO PI-UPDATE-SW.
 11771     MOVE '1'                    TO PI-ENTRY-CD-1.
 11772     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11773     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 243
* EL689.cbl
 11775 5400-LETTER-RELEASE.
 11776***************************************************************
 11777*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11778*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11779*    THE ARCHIVE FILE.                                        *
 11780*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11781*        1. CHECK SECURITY.                                   *
 11782*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11783*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11784*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11785*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11786*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11787***************************************************************
 11788
 11789     IF  NOT MODIFY-CAP
 11790         MOVE ER-0070            TO EMI-ERROR
 11791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792         MOVE -1                 TO MAINTL
 11793         GO TO 8200-SEND-DATAONLY.
 11794
 11795     IF  PI-SHOW-MODE
 11796         MOVE ER-0188            TO EMI-ERROR
 11797         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11798         MOVE -1                 TO MAINTL
 11799         MOVE AL-UABON           TO MAINTA
 11800         GO TO 8200-SEND-DATAONLY.
 11801
 11802      IF  ARCHNUML GREATER THAN ZEROS
 11803          MOVE ER-9320            TO EMI-ERROR
 11804          MOVE -1                 TO ARCHNUML
 11805          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11806          GO TO 8200-SEND-DATAONLY.
 11807
 11808*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11809*        MOVE ER-0187            TO EMI-ERROR
 11810*        MOVE -1                 TO MAINTL
 11811*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11812*        GO TO 8200-SEND-DATAONLY.
 11813
 11814*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11815*
 11816*    IF  NOT PI-689-CREATE-NO-SCREENS
 11817*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11818*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11819*                VARYING
 11820*            W-SC-NDX FROM 1 BY 1
 11821*                UNTIL
 11822*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11823*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11824*                OR
 11825*            PI-689-FATAL-ERROR
 11826*            GO TO 8200-SEND-DATAONLY.
 11827*
 11828*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11829*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11830*            VARYING
 11831*        W-RVS-NDX FROM +1 BY +1
 11832*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 244
* EL689.cbl
 11833*        W-RVS-NDX > +36500
 11834*            OR
 11835*        W-REMAINING-VAR-FOUND.
 11836*
 11837*    IF  NOT PI-689-CREATE-NO-SCREENS
 11838*        IF  W-REMAINING-VAR-FOUND
 11839*            GO TO 4000-ROLL-PAGE.
 11840
 11841*    MOVE SPACES                 TO W-CNTL-KEY.
 11842*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11843*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11844*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11845*
 11846*    EXEC CICS HANDLE CONDITION
 11847*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11848*         NOTFND     (5470-CNTL-NOT-FOUND)
 11849*    END-EXEC.
 11850*
 11851*    EXEC CICS READ
 11852*         DATASET    (W-CNTL-FILE-ID)
 11853*         SET        (ADDRESS OF CONTROL-FILE)
 11854*         RIDFLD     (W-CNTL-KEY)
 11855*         UPDATE
 11856*    END-EXEC.
 11857*
 11858*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11859*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11860*                                   CF-CREDIT-START-ARCH-NUM.
 11861*
 11862*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11863*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11864*                                TO W-ARCH-NUMBER
 11865*                                   W-ARCT-NUMBER.
 11866*
 11867*    EXEC CICS REWRITE
 11868*         FROM      (CONTROL-FILE)
 11869*         DATASET   (W-CNTL-FILE-ID)
 11870*    END-EXEC
 11871
 11872*    EXEC CICS HANDLE CONDITION
 11873*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11874*    END-EXEC.
 11875*
 11876*    EXEC CICS GETMAIN
 11877*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11878*       LENGTH   (W-ARCH-LENGTH)
 11879*    END-EXEC
 11880*
 11881*    MOVE SPACES                 TO LETTER-ARCHIVE
 11882*    MOVE 'LA'                   TO LA-RECORD-ID.
 11883*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11884*                                   LA-ARCHIVE-NO-A2
 11885*                                   LA-ARCHIVE-NO-A3
 11886*                                   LA-ARCHIVE-NO-A4
 11887*                                   LA-ARCHIVE-NO-A5
 11888*                                   LA-ARCHIVE-NO-A6
 11889*                                   PI-689-ARCHIVE-NUMBER.
 11890*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 245
* EL689.cbl
 11891*                                   LA-COMPANY-CD-A2
 11892*                                   LA-COMPANY-CD-A3
 11893*                                   LA-COMPANY-CD-A4
 11894*                                   LA-COMPANY-CD-A5
 11895*                                   LA-COMPANY-CD-A6.
 11896*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 11897*                                   LA-CARRIER-A3
 11898*                                   LA-CARRIER-A4
 11899*                                   LA-CARRIER-A5.
 11900*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11901*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11902*                                   LA-GROUPING-A3
 11903*                                   LA-GROUPING-A4
 11904*                                   LA-GROUPING-A5.
 11905*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11906*                                   LA-ACCOUNT-A3
 11907*                                   LA-ACCOUNT-A4
 11908*                                   LA-ACCOUNT-A5.
 11909*    MOVE PI-689-STATE           TO LA-STATE-A2
 11910*                                   LA-STATE-A3
 11911*                                   LA-STATE-A4
 11912*                                   LA-STATE-A5.
 11913*
 11914*    IF  PI-689-DATA-SOURCE EQUAL '3'
 11915*            AND
 11916*        PI-689-RESP-PERSON GREATER THAN SPACES
 11917*        MOVE PI-689-RESP-PERSON
 11918*                                TO LA-RESP-PERSON-A2
 11919*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 11920*    ELSE
 11921*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 11922*            MOVE PI-689-CERT-PRIME
 11923*                                TO LA-CERT-PRIME-A2
 11924*            MOVE PI-689-CERT-SFX
 11925*                                TO LA-CERT-SUFFIX-A2
 11926*        ELSE
 11927*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 11928*                                   LA-TYPE-A2.
 11929*
 11930*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 11931*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 11932*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11933*                AND
 11934*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 11935*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11936*            MOVE 'CK'           TO LA-FILLER
 11937*        ELSE
 11938*            NEXT SENTENCE
 11939*    ELSE
 11940*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11941*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11942*            MOVE 'CK'           TO LA-FILLER
 11943*        ELSE
 11944*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 11945*
 11946*    MOVE ZEROS                  TO W-SEQ-CTR.
 11947*
 11948*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 246
* EL689.cbl
 11949*
 11950*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 11951*                                   LA-INITIAL-PRINT-DATE
 11952*                                   LA-SENT-DATE
 11953*                                   LA-REPLY-DATE.
 11954*    MOVE 'A'                    TO LA-STATUS.
 11955*
 11956*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 11957*            OR
 11958*        PI-689-NUMBER-COPIES EQUAL ZEROS
 11959*        MOVE  1                 TO LA-NO-OF-COPIES
 11960*    ELSE
 11961*        MOVE PI-689-NUMBER-COPIES
 11962*                                TO LA-NO-OF-COPIES.
 11963*
 11964*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 11965*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 11966*    MOVE PI-689-PRINT-RESTRICTION
 11967*                                TO LA-PRINT-RESTRICTION
 11968*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 11969*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 11970*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 11971*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 11972*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 11973*
 11974*    IF  PI-689-PRINT-PERFORMED
 11975*        MOVE SPACES             TO PI-689-PRINT-SW
 11976*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 11977*        IF  LA-RESEND-DATE = LOW-VALUES
 11978*            MOVE 'C'            TO LA-STATUS.
 11979*
 11980*    MOVE PI-689-NUMBER-LABEL-LINES
 11981*                                TO LA-NUMBER-LABEL-LINES.
 11982*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 11983*
 11984*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 11985*
 11986*    MOVE PI-689-NUMBER-TEXT-RECORDS
 11987*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 11988*
 11989*    EXEC CICS HANDLE CONDITION
 11990*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 11991*    END-EXEC.
 11992*
 11993*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 11994*    MOVE ER-0280                TO EMI-ERROR.
 11995*    MOVE -1                     TO MAINTL.
 11996*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11997*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11998*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 11999     .
 12000 5400-END.
 12001     DISPLAY ' MADE IT TO 5400 '
 12002     MOVE SPACES                 TO BL-INPUT
 12003     MOVE ZEROS                  TO BL-ARCHIVE-NO
 12004     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 12005     MOVE PI-689-CARRIER         TO BL-CARRIER
 12006     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 247
* EL689.cbl
 12007     MOVE PI-689-STATE           TO BL-STATE
 12008     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 12009     IF PI-689-EFF-DATE NOT = LOW-VALUES
 12010        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 12011        MOVE ' '                 TO DC-OPTION-CODE
 12012        PERFORM 9500-LINK-DATE-CONVERT
 12013                                 THRU 9500-EXIT
 12014        IF NO-CONVERSION-ERROR
 12015           MOVE DC-GREG-DATE-1-EDIT
 12016                                 TO BL-EFF-DT
 12017        END-IF
 12018     END-IF
 12019     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 12020     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 12021     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 12022     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 12023     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 12024     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 12025     IF PI-ENDT-ARCH-NO > ZERO
 12026         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 12027     END-IF
 12028     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 12029     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 12030*    MOVE 'ALWA'                 TO BL-PROC-ID
 12031     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 12032*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 12033     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 12034     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 12035        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 12036        MOVE ' '                 TO DC-OPTION-CODE
 12037        PERFORM 9500-LINK-DATE-CONVERT
 12038                                 THRU 9500-EXIT
 12039        IF NO-CONVERSION-ERROR
 12040           MOVE DC-GREG-DATE-B-EDIT
 12041                                 TO BL-RESEND-DT
 12042        END-IF
 12043     END-IF
 12044     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 12045        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 12046        MOVE ' '                 TO DC-OPTION-CODE
 12047        PERFORM 9500-LINK-DATE-CONVERT
 12048                                 THRU 9500-EXIT
 12049        IF NO-CONVERSION-ERROR
 12050           MOVE DC-GREG-DATE-B-EDIT
 12051                                 TO BL-FOLLOW-UP-DT
 12052        END-IF
 12053     END-IF
 12054*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 12055*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 12056     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 12057     if eibaid = dfhpf7
 12058        move 'B'                 TO BL-WRITE-ERARCH
 12059     else
 12060        move 'T'                 to bl-write-erarch
 12061     end-if
 12062    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 12063*****************************************
 12064* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 248
* EL689.cbl
 12065*****************************************
 12066
 12067* exec cics link
 12068*       program('NSRASBL')
 12069*       commarea(srch-commarea)
 12070*    end-exec.
 12071     MOVE LENGTH OF
 12072      srch-commarea
 12073       TO DFHEIV11
 12074     MOVE 'NSRASBL' TO DFHEIV1
 12075*    MOVE '."C                   (   #00011648' TO DFHEIV0
 12076     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12077     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12078     MOVE X'2020233030303131363438' TO DFHEIV0(25:11)
 12079     CALL 'kxdfhei1' USING DFHEIV0,
 12080           DFHEIV1,
 12081           srch-commarea,
 12082           DFHEIV11,
 12083           DFHEIV99,
 12084           DFHEIV99,
 12085           DFHEIV99,
 12086           DFHEIV99
 12087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12088
 12089     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 12090        bl-message ' ' bl-archive-no
 12091     move bl-archive-no to w-arch-number
 12092
 12093     if eibaid = dfhpf7
 12094        PERFORM 5440-ADD-BILLING-NOTE THRU 5440-EXIT
 12095        MOVE ER-0280                TO EMI-ERROR
 12096        MOVE -1                     TO MAINTL
 12097        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12098        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12099        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 12100        MOVE '2'                    TO PI-ACTION
 12101        MOVE ZEROS                  TO PI-TOTAL-LINES
 12102                                       PI-CURRENT-LINE
 12103        MOVE SPACES                 TO PI-689-PRINT-SW
 12104                                       PI-689-FORM-NUMBER
 12105        GO TO 9300-DFHCLEAR
 12106     else
 12107        move w-arch-number          to archnumo
 12108        MOVE ER-1818                TO EMI-ERROR
 12109        MOVE -1                     TO MAINTL
 12110        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12111     end-if
 12112     MOVE -1                     TO MAINTL
 12113     GO TO 8200-SEND-DATAONLY
 12114     .
 12115 5400-EXIT.
 12116     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 249
* EL689.cbl
 12118 5410-CREATE-TEXT-RECORDS.
 12119
 12120*    EXEC CICS HANDLE CONDITION
 12121*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 12122*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 12123*    END-EXEC.
 12124*
 12125*    IF  PI-689-CREATE-NO-SCREENS
 12126*        IF  PI-689-GET-ARCT-MAIN
 12127*            EXEC CICS GETMAIN
 12128*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12129*                 LENGTH   (W-ARCT-LENGTH)
 12130*            END-EXEC
 12131*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 12132*                                    LETTER-ARCHIVE-TEXT
 12133*            MOVE LCP-WS-ADDR-COMP
 12134*                                TO PI-689-ARCT-POINTER
 12135*        ELSE
 12136*            MOVE PI-689-ARCT-POINTER
 12137*                                TO LCP-WS-ADDR-COMP
 12138*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 12139*                                TO LCP-WS-ADDR-PNTR
 12140*    ELSE
 12141*        EXEC CICS GETMAIN
 12142*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12143*             LENGTH   (W-ARCT-LENGTH)
 12144*        END-EXEC.
 12145*
 12146*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12147*
 12148*    MOVE ZEROS                  TO W-SEQ-CTR
 12149*
 12150*    IF  PI-CREATE-LABELS AND
 12151*        NOT PI-689-LABELS-OVERRIDEN
 12152*        MOVE '1'                TO LT-RECORD-TYPE
 12153*        MOVE +0                 TO LT-LINE-SEQ-NO
 12154*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 12155*                VARYING
 12156*            W-RG-NDX FROM 1 BY 1
 12157*                UNTIL
 12158*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 12159*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12160*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 12161*    ELSE
 12162*        SET W-RG-NDX            TO +1.
 12163*
 12164*    SET LT-NDX                  TO W-ZEROS.
 12165*
 12166*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 12167*            VARYING
 12168*        W-RG-NDX FROM W-RG-NDX BY +1
 12169*            UNTIL
 12170*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 12171
 12172 5410-EXIT.
 12173     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 250
* EL689.cbl
 12175 5415-INITIALIZE-TEXT.
 12176
 12177     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 12178     MOVE 'LT'                   TO LT-RECORD-ID.
 12179
 12180     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 12181     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 12182
 12183     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 12184                                    LT-NUM-LINES-ON-RECORD.
 12185
 12186 5415-EXIT.
 12187     EXIT.
 12188
 12189 5440-ADD-BILLING-NOTE.
 12190
 12191     MOVE LOW-VALUES             TO W-ELEOBC-KEY
 12192     MOVE PI-COMPANY-CD          TO W-EOBC-COMPANY-CD
 12193     MOVE '5'                    TO W-EOBC-REC-TYPE
 12194
 12195
 12196* EXEC CICS STARTBR
 12197*        DATASET   ('ELEOBC')
 12198*        RIDFLD    (W-ELEOBC-KEY)
 12199*        GTEQ
 12200*        RESP      (W-RESPONSE)
 12201*    END-EXEC
 12202     MOVE 'ELEOBC' TO DFHEIV1
 12203     MOVE 0
 12204       TO DFHEIV11
 12205*    MOVE '&,         G          &  N#00011758' TO DFHEIV0
 12206     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12207     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12208     MOVE X'204E233030303131373538' TO DFHEIV0(25:11)
 12209     CALL 'kxdfhei1' USING DFHEIV0,
 12210           DFHEIV1,
 12211           W-ELEOBC-KEY,
 12212           DFHEIV99,
 12213           DFHEIV11,
 12214           DFHEIV99
 12215     MOVE EIBRESP  TO W-RESPONSE
 12216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12217
 12218     IF NOT RESP-NORMAL
 12219        GO TO 5440-EXIT
 12220     END-IF
 12221      .
 12222 5440-READNEXT-ELEOBC.
 12223
 12224
 12225* EXEC CICS READNEXT
 12226*       INTO    (EOB-CODES)
 12227*       DATASET ('ELEOBC')
 12228*       RIDFLD  (W-ELEOBC-KEY)
 12229*       RESP    (W-RESPONSE)
 12230*    END-EXEC
 12231     MOVE LENGTH OF
 12232      EOB-CODES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 251
* EL689.cbl
 12233       TO DFHEIV12
 12234     MOVE 'ELEOBC' TO DFHEIV1
 12235     MOVE 0
 12236       TO DFHEIV11
 12237*    MOVE '&.IL                  )  N#00011771' TO DFHEIV0
 12238     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12239     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12240     MOVE X'204E233030303131373731' TO DFHEIV0(25:11)
 12241     CALL 'kxdfhei1' USING DFHEIV0,
 12242           DFHEIV1,
 12243           EOB-CODES,
 12244           DFHEIV12,
 12245           W-ELEOBC-KEY,
 12246           DFHEIV99,
 12247           DFHEIV11,
 12248           DFHEIV99,
 12249           DFHEIV99
 12250     MOVE EIBRESP  TO W-RESPONSE
 12251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12252
 12253     IF RESP-NORMAL
 12254         IF EO-RECORD-TYPE NOT = '5'
 12255             GO TO 5440-EXIT
 12256         END-IF
 12257     ELSE
 12258         GO TO 5440-EXIT
 12259     END-IF
 12260
 12261     IF EO-RECORD-TYPE = '5' AND
 12262        EO-EOB-CODE = PI-689-FORM-NUMBER
 12263           CONTINUE
 12264     ELSE
 12265         GO TO 5440-READNEXT-ELEOBC
 12266     END-IF
 12267
 12268     MOVE SPACES TO W-BILLING-NOTE
 12269     MOVE EO-DESCRIPTION TO W-BN-NOTE
 12270     MOVE PI-689-FORM-NUMBER TO W-BN-LTRID
 12271     MOVE W-SAVE-DATE TO W-BN-DATE
 12272     MOVE PI-PROCESSOR-ID TO W-BN-USERID
 12273     MOVE +25 TO W-LEN
 12274
 12275     PERFORM 5441-UPDATE-BILLING-NOTE THRU 5441-EXIT
 12276     .
 12277 5440-EXIT.
 12278     EXIT.
 12279
 12280 5441-UPDATE-BILLING-NOTE.
 12281
 12282     MOVE PI-COMPANY-CD          TO W-SV-COMPANY-CD
 12283     MOVE PI-689-CARRIER         TO W-SV-CARRIER
 12284     MOVE PI-689-GROUPING        TO W-SV-GROUPING
 12285     MOVE PI-689-STATE           TO W-SV-STATE
 12286     MOVE PI-689-ACCOUNT         TO W-SV-ACCOUNT
 12287     MOVE PI-689-EFF-DATE        TO W-SV-CERT-EFF-DT
 12288     MOVE PI-689-CERT-PRIME      TO W-SV-CERT-PRIME
 12289     MOVE PI-689-CERT-SFX        TO W-SV-CERT-SFX
 12290     MOVE W-SAVE-KEY             TO W-ERNOTE-KEY
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 252
* EL689.cbl
 12291
 12292
 12293* EXEC CICS READ
 12294*       DATASET    (W-NOTE-FILE-ID)
 12295*       RIDFLD     (W-ERNOTE-KEY)
 12296*       INTO       (CERTIFICATE-NOTE)
 12297*       RESP       (W-RESPONSE)
 12298*       UPDATE
 12299*    END-EXEC
 12300     MOVE LENGTH OF
 12301      CERTIFICATE-NOTE
 12302       TO DFHEIV11
 12303*    MOVE '&"IL       EU         (  N#00011817' TO DFHEIV0
 12304     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12305     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12306     MOVE X'204E233030303131383137' TO DFHEIV0(25:11)
 12307     CALL 'kxdfhei1' USING DFHEIV0,
 12308           W-NOTE-FILE-ID,
 12309           CERTIFICATE-NOTE,
 12310           DFHEIV11,
 12311           W-ERNOTE-KEY,
 12312           DFHEIV99,
 12313           DFHEIV99,
 12314           DFHEIV99
 12315     MOVE EIBRESP  TO W-RESPONSE
 12316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12317
 12318     IF RESP-NORMAL
 12319       IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12320          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12321       END-IF
 12322       IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12323          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12324       END-IF
 12325       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12326           (NOTE-SUB > +10) OR
 12327           (CN-LINE (NOTE-SUB) (1:W-LEN) =
 12328                             W-BILLING-NOTE (1:W-LEN))
 12329       END-PERFORM
 12330       IF CN-LINE (NOTE-SUB) (1:W-LEN) =
 12331                              W-BILLING-NOTE (1:W-LEN)
 12332
 12333* EXEC CICS UNLOCK
 12334*           DATASET    (W-NOTE-FILE-ID)
 12335*        END-EXEC
 12336*    MOVE '&*                    #   #00011839' TO DFHEIV0
 12337     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12338     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12339     MOVE X'2020233030303131383339' TO DFHEIV0(25:11)
 12340     CALL 'kxdfhei1' USING DFHEIV0,
 12341           W-NOTE-FILE-ID,
 12342           DFHEIV99
 12343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12344       ELSE
 12345         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12346           (NOTE-SUB > +10) OR
 12347           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
 12348         END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 253
* EL689.cbl
 12349         IF (NOTE-SUB < +11)
 12350           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
 12351              NOTE-SUB <= CN-BILLING-END-LINE-NO
 12352                MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12353           ELSE
 12354             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12355              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
 12356                MOVE W-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
 12357                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
 12358             ELSE
 12359               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 12360                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
 12361                     MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12362                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
 12363               ELSE
 12364                 IF (CN-BILLING-END-LINE-NO = ZEROS)
 12365                   MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
 12366                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
 12367                                       CN-BILLING-START-LINE-NO
 12368                 ELSE
 12369                    PERFORM 5442-SQUEEZE-IT-IN THRU 5442-EXIT
 12370                 END-IF
 12371               END-IF
 12372             END-IF
 12373           END-IF
 12374           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12375           MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12376           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12377
 12378* EXEC CICS REWRITE
 12379*             DATASET    (W-NOTE-FILE-ID)
 12380*             FROM       (CERTIFICATE-NOTE)
 12381*             RESP       (W-RESPONSE)
 12382*          END-EXEC
 12383     MOVE LENGTH OF
 12384      CERTIFICATE-NOTE
 12385       TO DFHEIV11
 12386*    MOVE '&& L                  %  N#00011875' TO DFHEIV0
 12387     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12388     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12389     MOVE X'204E233030303131383735' TO DFHEIV0(25:11)
 12390     CALL 'kxdfhei1' USING DFHEIV0,
 12391           W-NOTE-FILE-ID,
 12392           CERTIFICATE-NOTE,
 12393           DFHEIV11,
 12394           DFHEIV99
 12395     MOVE EIBRESP  TO W-RESPONSE
 12396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12397           PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12398         END-IF
 12399       END-IF
 12400     ELSE
 12401        MOVE SPACES              TO CERTIFICATE-NOTE
 12402        MOVE 'CN'                TO CN-RECORD-ID
 12403        MOVE W-SAVE-KEY          TO CN-CONTROL-PRIMARY
 12404                                    W-ERNOTE-KEY
 12405        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12406                                    CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 254
* EL689.cbl
 12407        MOVE W-BILLING-NOTE      TO CN-LINE (01)
 12408        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12409        MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12410        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12411
 12412* EXEC CICS WRITE
 12413*          DATASET    (W-NOTE-FILE-ID)
 12414*          FROM       (CERTIFICATE-NOTE)
 12415*          RIDFLD     (W-ERNOTE-KEY)
 12416*          RESP       (W-RESPONSE)
 12417*       END-EXEC
 12418     MOVE LENGTH OF
 12419      CERTIFICATE-NOTE
 12420       TO DFHEIV11
 12421*    MOVE '&$ L                  ''  N#00011894' TO DFHEIV0
 12422     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12423     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12424     MOVE X'204E233030303131383934' TO DFHEIV0(25:11)
 12425     CALL 'kxdfhei1' USING DFHEIV0,
 12426           W-NOTE-FILE-ID,
 12427           CERTIFICATE-NOTE,
 12428           DFHEIV11,
 12429           W-ERNOTE-KEY,
 12430           DFHEIV99,
 12431           DFHEIV99
 12432     MOVE EIBRESP  TO W-RESPONSE
 12433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12434
 12435        PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12436     END-IF
 12437
 12438     .
 12439 5441-EXIT.
 12440     EXIT.
 12441
 12442
 12443 5442-SQUEEZE-IT-IN.
 12444
 12445     IF NOTE-SUB < CN-BILLING-START-LINE-NO
 12446        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
 12447           NOTE-SUB = +10
 12448           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
 12449           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
 12450             MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
 12451             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
 12452             MOVE +9 TO NOTE-SUB
 12453           END-IF
 12454        END-PERFORM
 12455     ELSE
 12456        IF NOTE-SUB > CN-BILLING-END-LINE-NO
 12457           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
 12458             UNTIL NOTE-SUB = +1
 12459             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
 12460             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
 12461                MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
 12462                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
 12463                MOVE +2          TO NOTE-SUB
 12464             END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 255
* EL689.cbl
 12465           END-PERFORM
 12466        END-IF
 12467     END-IF
 12468
 12469     .
 12470 5442-EXIT.
 12471     EXIT.
 12472
 12473 5445-CERTIFICATE-UPDATE.
 12474
 12475     MOVE W-SAVE-KEY         TO W-CERT-KEY
 12476
 12477
 12478* EXEC CICS READ
 12479*        DATASET  (W-CERT-FILE-ID)
 12480*        RIDFLD   (W-CERT-KEY)
 12481*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 12482*        RESP     (W-RESPONSE)
 12483*        UPDATE
 12484*    END-EXEC
 12485*    MOVE '&"S        EU         (  N#00011943' TO DFHEIV0
 12486     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12487     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12488     MOVE X'204E233030303131393433' TO DFHEIV0(25:11)
 12489     CALL 'kxdfhei1' USING DFHEIV0,
 12490           W-CERT-FILE-ID,
 12491           DFHEIV20,
 12492           DFHEIV99,
 12493           W-CERT-KEY,
 12494           DFHEIV99,
 12495           DFHEIV99,
 12496           DFHEIV99
 12497     SET ADDRESS OF CERTIFICATE-MASTER TO
 12498         DFHEIV20
 12499     MOVE EIBRESP  TO W-RESPONSE
 12500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12501
 12502     IF RESP-NORMAL
 12503        EVALUATE CM-NOTE-SW
 12504           WHEN '2'
 12505           WHEN '3'
 12506           WHEN '6'
 12507           WHEN '7'
 12508              SET NO-CERT-RW     TO TRUE
 12509           WHEN ' '
 12510              MOVE '2'           TO CM-NOTE-SW
 12511           WHEN '1'
 12512              MOVE '3'           TO CM-NOTE-SW
 12513           WHEN '4'
 12514              MOVE '6'           TO CM-NOTE-SW
 12515           WHEN '5'
 12516              MOVE '7'           TO CM-NOTE-SW
 12517        END-EVALUATE
 12518     END-IF
 12519     IF NOT NO-CERT-RW
 12520
 12521* EXEC CICS REWRITE
 12522*          FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 256
* EL689.cbl
 12523*          DATASET  (W-CERT-FILE-ID)
 12524*          RESP     (W-RESPONSE)
 12525*       END-EXEC
 12526     MOVE LENGTH OF
 12527      CERTIFICATE-MASTER
 12528       TO DFHEIV11
 12529*    MOVE '&& L                  %  N#00011969' TO DFHEIV0
 12530     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12531     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12532     MOVE X'204E233030303131393639' TO DFHEIV0(25:11)
 12533     CALL 'kxdfhei1' USING DFHEIV0,
 12534           W-CERT-FILE-ID,
 12535           CERTIFICATE-MASTER,
 12536           DFHEIV11,
 12537           DFHEIV99
 12538     MOVE EIBRESP  TO W-RESPONSE
 12539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12540     ELSE
 12541
 12542* EXEC CICS UNLOCK
 12543*          DATASET  (W-CERT-FILE-ID)
 12544*       END-EXEC
 12545*    MOVE '&*                    #   #00011975' TO DFHEIV0
 12546     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12547     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12548     MOVE X'2020233030303131393735' TO DFHEIV0(25:11)
 12549     CALL 'kxdfhei1' USING DFHEIV0,
 12550           W-CERT-FILE-ID,
 12551           DFHEIV99
 12552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12553     END-IF
 12554
 12555     .
 12556 5445-EXIT.
 12557     EXIT.
 12558
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 257
* EL689.cbl
 12560 5460-DUPLICATE-ARCHIVE-RCD.
 12561
 12562     IF  NOT PI-689-CREATE-NO-SCREENS
 12563
 12564* EXEC CICS SYNCPOINT ROLLBACK
 12565*        END-EXEC.
 12566*    MOVE '6"R                   !   #00011988' TO DFHEIV0
 12567     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12569     MOVE X'2020233030303131393838' TO DFHEIV0(25:11)
 12570     CALL 'kxdfhei1' USING DFHEIV0
 12571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12572
 12573
 12574     MOVE ER-9426                TO EMI-ERROR.
 12575     MOVE -1                     TO MAINTL.
 12576     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12577     GO TO 8200-SEND-DATAONLY.
 12578
 12579 5465-DUPLICATE-ARCH-TEXT.
 12580
 12581     IF  NOT PI-689-CREATE-NO-SCREENS
 12582
 12583* EXEC CICS SYNCPOINT ROLLBACK
 12584*        END-EXEC.
 12585*    MOVE '6"R                   !   #00011999' TO DFHEIV0
 12586     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12587     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12588     MOVE X'2020233030303131393939' TO DFHEIV0(25:11)
 12589     CALL 'kxdfhei1' USING DFHEIV0
 12590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12591
 12592
 12593     MOVE ER-7369                TO EMI-ERROR.
 12594     MOVE -1                     TO MAINTL.
 12595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12596     GO TO 8200-SEND-DATAONLY.
 12597
 12598 5470-CNTL-NOT-FOUND.
 12599
 12600     MOVE ER-9299                TO EMI-ERROR.
 12601     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12602     MOVE -1                     TO MAINTL.
 12603     MOVE AL-UANON               TO MAINTA.
 12604     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 258
* EL689.cbl
 12606 5500-FORMAT-TEXT.
 12607
 12608     SET LT-NDX UP BY +1.
 12609
 12610     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 12611         SET W-RG-NDX UP BY 1
 12612         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 12613         MOVE W-RC-TEXT (W-RG-NDX)
 12614                                 TO LT-TEXT-LINE (LT-NDX)
 12615     ELSE
 12616         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 12617             MOVE ZEROS          TO W-PRINT-CONTROL
 12618             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 12619                     VARYING
 12620                 W-RG-NDX FROM W-RG-NDX BY 1
 12621                     UNTIL
 12622                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12623                     OR
 12624                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 12625             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12626                 GO TO 5500-WRITE-TEST
 12627             ELSE
 12628                 MOVE W-PRINT-CONTROL
 12629                                 TO LT-SKIP-CONTROL (LT-NDX)
 12630                 MOVE W-RC-TEXT (W-RG-NDX)
 12631                                 TO LT-TEXT-LINE (LT-NDX)
 12632         ELSE
 12633             MOVE W-RC-TEXT (W-RG-NDX)
 12634                                 TO LT-TEXT-LINE (LT-NDX)
 12635             MOVE ZEROS          TO W-PRINT-CONTROL.
 12636
 12637     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 12638
 12639 5500-WRITE-TEST.
 12640
 12641     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 12642         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 12643             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12644             MOVE '2'            TO LT-RECORD-TYPE
 12645             ADD +1              TO W-SEQ-CTR
 12646             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12647             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12648         ELSE
 12649             NEXT SENTENCE
 12650     ELSE
 12651         IF  LT-NDX EQUAL +20
 12652             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12653             MOVE '2'            TO LT-RECORD-TYPE
 12654             ADD +1              TO W-SEQ-CTR
 12655             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12656             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12657             SET LT-NDX          TO W-ZEROS
 12658             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12659
 12660 5500-EXIT.
 12661      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 259
* EL689.cbl
 12663 5505-FIND-USED-LINE.
 12664
 12665     ADD +1                      TO W-PRINT-CONTROL.
 12666
 12667 5505-EXIT.
 12668      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 260
* EL689.cbl
 12670 5600-FORMAT-ADDRESS-LINE.
 12671
 12672     SET LT-NDX                  TO W-RG-NDX.
 12673     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 12674
 12675 5600-EXIT.
 12676     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 261
* EL689.cbl
 12678 5650-WRITE-ARCHIVE.
 12679
 12680
 12681* EXEC CICS WRITE
 12682*         DATASET   (W-ARCH-FILE-ID)
 12683*         FROM      (LETTER-ARCHIVE)
 12684*         RIDFLD    (LA-CONTROL-PRIMARY)
 12685*    END-EXEC.
 12686     MOVE LENGTH OF
 12687      LETTER-ARCHIVE
 12688       TO DFHEIV11
 12689*    MOVE '&$ L                  ''   #00012089' TO DFHEIV0
 12690     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12691     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12692     MOVE X'2020233030303132303839' TO DFHEIV0(25:11)
 12693     CALL 'kxdfhei1' USING DFHEIV0,
 12694           W-ARCH-FILE-ID,
 12695           LETTER-ARCHIVE,
 12696           DFHEIV11,
 12697           LA-CONTROL-PRIMARY,
 12698           DFHEIV99,
 12699           DFHEIV99
 12700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12701
 12702
 12703 5650-EXIT.
 12704     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 262
* EL689.cbl
 12706 5655-WRITE-ARCHIVE-TEXT.
 12707
 12708
 12709* EXEC CICS WRITE
 12710*         DATASET   (W-ARCT-FILE-ID)
 12711*         FROM      (LETTER-ARCHIVE-TEXT)
 12712*         RIDFLD    (LT-CONTROL-PRIMARY)
 12713*    END-EXEC.
 12714     MOVE LENGTH OF
 12715      LETTER-ARCHIVE-TEXT
 12716       TO DFHEIV11
 12717*    MOVE '&$ L                  ''   #00012100' TO DFHEIV0
 12718     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12719     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12720     MOVE X'2020233030303132313030' TO DFHEIV0(25:11)
 12721     CALL 'kxdfhei1' USING DFHEIV0,
 12722           W-ARCT-FILE-ID,
 12723           LETTER-ARCHIVE-TEXT,
 12724           DFHEIV11,
 12725           LT-CONTROL-PRIMARY,
 12726           DFHEIV99,
 12727           DFHEIV99
 12728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12729
 12730
 12731 5655-EXIT.
 12732     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 263
* EL689.cbl
 12734 6000-RESOLVE-VARIABLES.
 12735***************************************************************
 12736*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 12737*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 12738*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 12739*    RESOLVE ALL OF THE SYMBOLS.                              *
 12740*                                                             *
 12741***************************************************************
 12742
 12743     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 12744     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 12745     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 12746     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 12747     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 12748*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 12749     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 12750     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 12751     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 12752     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 12753     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 12754     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 12755     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 12756     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 12757
 12758     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 12759
 12760 6000-EXIT.
 12761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 264
* EL689.cbl
 12763 6200-GET-COMPANY-DATA.
 12764
 12765     IF  ADDRSI EQUAL '3'
 12766             AND
 12767         PI-CREATE-LABELS
 12768             AND
 12769         NOT PI-689-LABELS-OVERRIDEN
 12770         NEXT SENTENCE
 12771     ELSE
 12772         IF  W-FILE-NOT-USED (1)
 12773             GO TO 6200-EXIT.
 12774
 12775     MOVE SPACES                 TO W-CNTL-KEY.
 12776     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12777     MOVE +0                     TO W-CNTL-SEQ-NO.
 12778     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 12779
 12780
 12781* EXEC CICS HANDLE CONDITION
 12782*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 12783*         NOTFND    (6200-CNTL1-NOT-FOUND)
 12784*    END-EXEC.
 12785*    MOVE '"$JI                  ! + #00012155' TO DFHEIV0
 12786     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12787     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12788     MOVE X'2B20233030303132313535' TO DFHEIV0(25:11)
 12789     CALL 'kxdfhei1' USING DFHEIV0
 12790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12791
 12792
 12793
 12794* EXEC CICS READ
 12795*         DATASET   (W-CNTL-FILE-ID)
 12796*         SET       (ADDRESS OF CONTROL-FILE)
 12797*         RIDFLD    (W-CNTL-KEY)
 12798*    END-EXEC.
 12799*    MOVE '&"S        E          (   #00012160' TO DFHEIV0
 12800     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12802     MOVE X'2020233030303132313630' TO DFHEIV0(25:11)
 12803     CALL 'kxdfhei1' USING DFHEIV0,
 12804           W-CNTL-FILE-ID,
 12805           DFHEIV20,
 12806           DFHEIV99,
 12807           W-CNTL-KEY,
 12808           DFHEIV99,
 12809           DFHEIV99,
 12810           DFHEIV99
 12811     SET ADDRESS OF CONTROL-FILE TO
 12812         DFHEIV20
 12813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12814
 12815
 12816     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12817     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 12818                                    W-VG-TEXT (25).
 12819     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 12820     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 265
* EL689.cbl
 12821     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 12822     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 12823
 12824     IF  CF-CL-CAN-POST-CODE
 12825         MOVE CF-CL-CANADIAN-POSTAL-CODE
 12826                                 TO W-CANADIAN-POSTAL-CODES
 12827         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12828         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12829         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12830                                    W-LAB-CAN-FILLER (6)
 12831         GO TO 6200-CONTINUE.
 12832
 12833     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12834         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 12835         MOVE SPACES             TO W-LABEL-ZIP (6)
 12836         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12837
 12838         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12839             MOVE '-'            TO W-LABEL-DASH (6)
 12840             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12841             GO TO 6200-CONTINUE
 12842         ELSE
 12843             MOVE SPACES         TO W-LABEL-DASH (6)
 12844                                    W-LABEL-2ND-ZIP (6)
 12845             GO TO 6200-CONTINUE.
 12846
 12847     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 12848         GO TO 6200-CONTINUE.
 12849
 12850     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 12851
 12852     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12853         COMPUTE W-WORK-ZIP-NUMERIC
 12854             = W-WORK-ZIP-NUMERIC * 10000.
 12855
 12856     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12857     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12858
 12859     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12860         MOVE '-'                TO W-LABEL-DASH (6)
 12861         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12862         GO TO 6200-CONTINUE
 12863     ELSE
 12864         MOVE SPACES             TO W-LABEL-DASH (6)
 12865                                    W-LABEL-2ND-ZIP (6)
 12866         GO TO 6200-CONTINUE.
 12867
 12868 6200-CONTINUE.
 12869
 12870     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12871
 12872     IF  ADDRSI EQUAL '3'
 12873             AND
 12874         PI-CREATE-LABELS
 12875             AND
 12876         NOT PI-689-LABELS-OVERRIDEN
 12877         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 12878         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 266
* EL689.cbl
 12879         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 12880         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 12881         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 12882         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 12883         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12884         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12885         SET W-RG-NDX UP BY +1
 12886     ELSE
 12887         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 12888         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 12889         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 12890         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 12891         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 12892         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 12893
 12894     GO TO 6200-EXIT.
 12895
 12896 6200-CNTL1-NOT-FOUND.
 12897
 12898     MOVE ER-9299                TO EMI-ERROR.
 12899     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12900     MOVE -1                     TO ADDRSL.
 12901     MOVE AL-UANON               TO ADDRSA.
 12902     GO TO 8200-SEND-DATAONLY.
 12903
 12904 6200-EXIT.
 12905     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 267
* EL689.cbl
 12907 6250-GET-CNTL2-DATA.
 12908
 12909     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 12910         GO TO 6250-EXIT.
 12911
 12912     IF  W-FILE-NOT-USED (11)
 12913         GO TO 6250-EXIT.
 12914
 12915     MOVE SPACES                 TO W-CNTL-KEY.
 12916     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12917     MOVE +0                     TO W-CNTL-SEQ-NO.
 12918     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 12919     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 12920
 12921
 12922* EXEC CICS HANDLE CONDITION
 12923*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12924*         NOTFND     (6250-CNTL2-NOT-FOUND)
 12925*    END-EXEC.
 12926*    MOVE '"$JI                  ! , #00012271' TO DFHEIV0
 12927     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12929     MOVE X'2C20233030303132323731' TO DFHEIV0(25:11)
 12930     CALL 'kxdfhei1' USING DFHEIV0
 12931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12932
 12933
 12934
 12935* EXEC CICS READ
 12936*         DATASET    (W-CNTL-FILE-ID)
 12937*         SET        (ADDRESS OF CONTROL-FILE)
 12938*         RIDFLD     (W-CNTL-KEY)
 12939*    END-EXEC.
 12940*    MOVE '&"S        E          (   #00012276' TO DFHEIV0
 12941     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12942     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12943     MOVE X'2020233030303132323736' TO DFHEIV0(25:11)
 12944     CALL 'kxdfhei1' USING DFHEIV0,
 12945           W-CNTL-FILE-ID,
 12946           DFHEIV20,
 12947           DFHEIV99,
 12948           W-CNTL-KEY,
 12949           DFHEIV99,
 12950           DFHEIV99,
 12951           DFHEIV99
 12952     SET ADDRESS OF CONTROL-FILE TO
 12953         DFHEIV20
 12954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12955
 12956
 12957     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 12958     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 12959     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 12960     GO TO 6250-EXIT.
 12961
 12962 6250-CNTL2-NOT-FOUND.
 12963
 12964     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 268
* EL689.cbl
 12965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12966     MOVE -1                     TO MAINTL.
 12967     MOVE AL-UANON               TO MAINTA.
 12968     GO TO 8200-SEND-DATAONLY.
 12969
 12970 6250-EXIT.
 12971     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 269
* EL689.cbl
 12973 6300-GET-CARRIER-DATA.
 12974
 12975     IF  ADDRSI EQUAL '2'
 12976             AND
 12977         PI-CREATE-LABELS
 12978             AND
 12979         NOT PI-689-LABELS-OVERRIDEN
 12980         NEXT SENTENCE
 12981     ELSE
 12982         IF  W-FILE-NOT-USED (4)
 12983             GO TO 6300-EXIT.
 12984
 12985     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 12986         MOVE SPACES             TO W-CNTL-KEY
 12987         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 12988         MOVE +0                 TO W-CNTL-SEQ-NO
 12989         MOVE '6'                TO W-CNTL-RECORD-TYPE
 12990         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 12991     ELSE
 12992         MOVE ER-9327            TO EMI-ERROR
 12993         MOVE -1                 TO CARRIERL
 12994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12995         GO TO 6300-EXIT.
 12996
 12997
 12998* EXEC CICS HANDLE CONDITION
 12999*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13000*         NOTFND     (6300-CNTL6-NOT-FOUND)
 13001*    END-EXEC.
 13002*    MOVE '"$JI                  ! - #00012322' TO DFHEIV0
 13003     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13005     MOVE X'2D20233030303132333232' TO DFHEIV0(25:11)
 13006     CALL 'kxdfhei1' USING DFHEIV0
 13007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13008
 13009
 13010
 13011* EXEC CICS READ
 13012*         DATASET    (W-CNTL-FILE-ID)
 13013*         SET        (ADDRESS OF CONTROL-FILE)
 13014*         RIDFLD     (W-CNTL-KEY)
 13015*    END-EXEC.
 13016*    MOVE '&"S        E          (   #00012327' TO DFHEIV0
 13017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13018     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13019     MOVE X'2020233030303132333237' TO DFHEIV0(25:11)
 13020     CALL 'kxdfhei1' USING DFHEIV0,
 13021           W-CNTL-FILE-ID,
 13022           DFHEIV20,
 13023           DFHEIV99,
 13024           W-CNTL-KEY,
 13025           DFHEIV99,
 13026           DFHEIV99,
 13027           DFHEIV99
 13028     SET ADDRESS OF CONTROL-FILE TO
 13029         DFHEIV20
 13030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 270
* EL689.cbl
 13031
 13032
 13033     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13034     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 13035     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 13036     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 13037     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 13038     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 13039
 13040     IF  CF-CANADIAN-POST-CODE
 13041         MOVE CF-CANADIAN-POSTAL-CODE
 13042                                 TO W-CANADIAN-POSTAL-CODES
 13043         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13044         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13045         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13046                                    W-LAB-CAN-FILLER (6)
 13047         GO TO 6300-CONTINUE.
 13048
 13049     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 13050         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 13051         MOVE SPACES             TO W-LABEL-ZIP (6)
 13052         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13053         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13054             MOVE '-'            TO W-LABEL-DASH (6)
 13055             MOVE W-WORK-ZIP4
 13056                                 TO W-LABEL-2ND-ZIP (6)
 13057             GO TO 6300-CONTINUE
 13058         ELSE
 13059             MOVE SPACES         TO W-LABEL-DASH (6)
 13060                                    W-LABEL-2ND-ZIP (6)
 13061             GO TO 6300-CONTINUE.
 13062
 13063     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 13064         GO TO 6300-CONTINUE.
 13065
 13066     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 13067
 13068     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 13069         COMPUTE W-WORK-ZIP-NUMERIC
 13070             = W-WORK-ZIP-NUMERIC * 10000.
 13071
 13072     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13073     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 13074
 13075     IF  W-WORK-ZIP4 GREATER THAN '0000'
 13076         MOVE '-'                TO W-LABEL-DASH (6)
 13077         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 13078         GO TO 6300-CONTINUE
 13079     ELSE
 13080         MOVE SPACES             TO W-LABEL-DASH (6)
 13081                                    W-LABEL-2ND-ZIP (6)
 13082         GO TO 6300-CONTINUE.
 13083
 13084 6300-CONTINUE.
 13085
 13086     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13087
 13088     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 271
* EL689.cbl
 13089             AND
 13090         PI-CREATE-LABELS
 13091             AND
 13092         NOT PI-689-LABELS-OVERRIDEN
 13093         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 13094         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 13095         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 13096         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 13097         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 13098         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 13099         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13100         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13101         SET W-RG-NDX UP BY +1
 13102     ELSE
 13103         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 13104         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 13105         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 13106         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 13107         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 13108         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 13109
 13110     IF  W-FULL-DATA
 13111         MOVE ZEROS              TO W-PHONE-IN
 13112         MOVE CF-PHONE-NO        TO W-PHONE-IN
 13113         MOVE W-PHI-AREA         TO W-PO-AREA
 13114         MOVE W-PHI-PFX          TO W-PO-PFX
 13115         MOVE W-PHI-SFX          TO W-PO-SFX
 13116         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 13117
 13118     GO TO 6300-EXIT.
 13119
 13120 6300-CNTL6-NOT-FOUND.
 13121
 13122     MOVE ER-9298                TO EMI-ERROR.
 13123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13124     MOVE -1                     TO ADDRSL.
 13125     MOVE AL-UANON               TO ADDRSA.
 13126     GO TO 8200-SEND-DATAONLY.
 13127
 13128 6300-EXIT.
 13129     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 272
* EL689.cbl
 13131 6350-GET-CSR-DATA.
 13132     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 13133        GO TO 6350-EXIT
 13134     END-IF
 13135*    IF W-FILE-NOT-USED (11)
 13136*       GO TO 6350-EXIT
 13137*    END-IF
 13138     MOVE SPACES                 TO W-CNTL-KEY
 13139     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 13140     MOVE +0                     TO W-CNTL-SEQ-NO
 13141     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 13142     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 13143
 13144* EXEC CICS HANDLE CONDITION
 13145*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13146*         NOTFND     (6350-CNTL2-NOT-FOUND)
 13147*    END-EXEC
 13148*    MOVE '"$JI                  ! . #00012443' TO DFHEIV0
 13149     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13150     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13151     MOVE X'2E20233030303132343433' TO DFHEIV0(25:11)
 13152     CALL 'kxdfhei1' USING DFHEIV0
 13153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13154
 13155* EXEC CICS READ
 13156*         DATASET    (W-CNTL-FILE-ID)
 13157*         SET        (ADDRESS OF CONTROL-FILE)
 13158*         RIDFLD     (W-CNTL-KEY)
 13159*    END-EXEC
 13160*    MOVE '&"S        E          (   #00012447' TO DFHEIV0
 13161     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13163     MOVE X'2020233030303132343437' TO DFHEIV0(25:11)
 13164     CALL 'kxdfhei1' USING DFHEIV0,
 13165           W-CNTL-FILE-ID,
 13166           DFHEIV20,
 13167           DFHEIV99,
 13168           W-CNTL-KEY,
 13169           DFHEIV99,
 13170           DFHEIV99,
 13171           DFHEIV99
 13172     SET ADDRESS OF CONTROL-FILE TO
 13173         DFHEIV20
 13174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13175     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 13176     GO TO 6350-EXIT
 13177     .
 13178 6350-CNTL2-NOT-FOUND.
 13179     MOVE ER-9299                TO EMI-ERROR.
 13180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13181     MOVE -1                     TO MAINTL.
 13182     MOVE AL-UANON               TO MAINTA.
 13183     GO TO 8200-SEND-DATAONLY.
 13184 6350-EXIT.
 13185     EXIT.
 13186 6400-GET-PENDING-DATA.
 13187
 13188     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 273
* EL689.cbl
 13189        AND (PI-CREATE-LABELS)
 13190        AND (NOT PI-689-LABELS-OVERRIDEN)
 13191        CONTINUE
 13192     ELSE
 13193        IF PI-689-DATA-SOURCE = '4'
 13194           CONTINUE
 13195        ELSE
 13196           IF W-FILE-NOT-USED (9)
 13197              GO TO 6400-EXIT
 13198           END-IF
 13199        END-IF
 13200     END-IF
 13201     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 13202         MOVE ER-9327            TO EMI-ERROR
 13203         MOVE -1                 TO MAINTL
 13204         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13205         GO TO 6400-EXIT.
 13206
 13207 6400-READ-PNDB-ONLY.
 13208
 13209
 13210* EXEC CICS HANDLE CONDITION
 13211*         NOTOPEN (8060-PNDB-NOT-OPEN)
 13212*         NOTFND  (8070-PNDB-NOT-FOUND)
 13213*    END-EXEC.
 13214*    MOVE '"$JI                  ! / #00012486' TO DFHEIV0
 13215     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13217     MOVE X'2F20233030303132343836' TO DFHEIV0(25:11)
 13218     CALL 'kxdfhei1' USING DFHEIV0
 13219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13220
 13221
 13222
 13223* EXEC CICS READ
 13224*         DATASET (W-PNDB-FILE-ID)
 13225*         SET     (ADDRESS OF PENDING-BUSINESS)
 13226*         RIDFLD  (W-PNDB-KEY)
 13227*    END-EXEC.
 13228*    MOVE '&"S        E          (   #00012491' TO DFHEIV0
 13229     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13231     MOVE X'2020233030303132343931' TO DFHEIV0(25:11)
 13232     CALL 'kxdfhei1' USING DFHEIV0,
 13233           W-PNDB-FILE-ID,
 13234           DFHEIV20,
 13235           DFHEIV99,
 13236           W-PNDB-KEY,
 13237           DFHEIV99,
 13238           DFHEIV99,
 13239           DFHEIV99
 13240     SET ADDRESS OF PENDING-BUSINESS TO
 13241         DFHEIV20
 13242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13243
 13244
 13245     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 13246
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 274
* EL689.cbl
 13247     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13248         MOVE PB-SV-CARRIER      TO PB-CARRIER
 13249                                    PI-689-CARRIER
 13250         MOVE PB-SV-GROUPING     TO PB-GROUPING
 13251                                    PI-689-GROUPING
 13252         MOVE PB-SV-STATE        TO PB-STATE
 13253                                    PI-689-STATE
 13254         MOVE PB-CONTROL-BY-ACCOUNT
 13255                                 TO W-CERT-KEY
 13256                                    W-MAIL-KEY
 13257                                    W-ACCT-KEY
 13258         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 13259         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 13260         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 13261
 13262 6400-ONLY-STOP.
 13263
 13264     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 13265
 13266     IF  NOT PB-ISSUE
 13267         GO TO 6400-CANCEL.
 13268
 13269     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 13270     MOVE SPACES                 TO DC-OPTION-CODE.
 13271     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13272
 13273     IF  NO-CONVERSION-ERROR
 13274         MOVE DC-GREG-DATE-1-EDIT
 13275                                 TO W-VG-TEXT (110).
 13276
 13277     MOVE PB-I-AGE               TO W-EDIT-3-0.
 13278     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 13279     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 13280     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 13281     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 13282     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 13283     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 13284     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 13285     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 13286     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 13287     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 13288     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 13289     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 13290     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 13291     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 13292     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 13293     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 13294     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 13295     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 13296     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 13297
 13298     COMPUTE W-DIFFERENCE
 13299         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 13300
 13301     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13302     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 13303
 13304     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 275
* EL689.cbl
 13305         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 13306
 13307     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13308     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 13309
 13310 6400-CANCEL.
 13311
 13312     IF  NOT PB-CANCELLATION
 13313         GO TO 6400-EXIT.
 13314
 13315     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 13316                                 TO DC-BIN-DATE-1.
 13317     MOVE SPACES                 TO DC-OPTION-CODE.
 13318     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13319
 13320     IF  NO-CONVERSION-ERROR
 13321         MOVE DC-GREG-DATE-1-EDIT
 13322                                 TO W-VG-TEXT (117).
 13323
 13324     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 13325     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 13326     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 13327     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 13328     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 13329     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 13330     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 13331     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 13332     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 13333     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13334
 13335     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 13336        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 13337     END-IF
 13338     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 13339     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13340     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 13341     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 13342        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 13343     END-IF
 13344     MOVE SPACES                 TO DC-OPTION-CODE
 13345     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13346
 13347     IF NO-CONVERSION-ERROR
 13348        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13349     END-IF
 13350
 13351     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 13352                           - PB-C-LF-CANCEL-AMT.
 13353
 13354     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13355     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 13356
 13357     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 13358                           - PB-C-AH-CANCEL-AMT.
 13359
 13360     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13361     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 13362
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 276
* EL689.cbl
 13363 6400-EXIT.
 13364     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 277
* EL689.cbl
 13366 6450-GET-CERT-DATA.
 13367     IF  W-FILE-NOT-USED (8)
 13368         GO TO 6450-EXIT.
 13369
 13370     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13371         MOVE ER-9327            TO EMI-ERROR
 13372         MOVE -1                 TO MAINTL
 13373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13374         GO TO 6450-EXIT.
 13375
 13376 6450-READ-CERT-ONLY.
 13377
 13378
 13379* EXEC CICS HANDLE CONDITION
 13380*         NOTOPEN (8030-CERT-NOT-OPEN)
 13381*         NOTFND  (8035-CERT-NOT-FOUND)
 13382*    END-EXEC.
 13383*    MOVE '"$JI                  ! 0 #00012630' TO DFHEIV0
 13384     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13386     MOVE X'3020233030303132363330' TO DFHEIV0(25:11)
 13387     CALL 'kxdfhei1' USING DFHEIV0
 13388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13389
 13390
 13391
 13392* EXEC CICS READ
 13393*         DATASET (W-CERT-FILE-ID)
 13394*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 13395*         RIDFLD  (W-CERT-KEY)
 13396*    END-EXEC.
 13397*    MOVE '&"S        E          (   #00012635' TO DFHEIV0
 13398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13400     MOVE X'2020233030303132363335' TO DFHEIV0(25:11)
 13401     CALL 'kxdfhei1' USING DFHEIV0,
 13402           W-CERT-FILE-ID,
 13403           DFHEIV20,
 13404           DFHEIV99,
 13405           W-CERT-KEY,
 13406           DFHEIV99,
 13407           DFHEIV99,
 13408           DFHEIV99
 13409     SET ADDRESS OF CERTIFICATE-MASTER TO
 13410         DFHEIV20
 13411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13412
 13413
 13414     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 13415
 13416 6450-ONLY-STOP.
 13417
 13418     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 13419
 13420     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 13421
 13422     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13423     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 278
* EL689.cbl
 13424     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13425     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13426     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 13427
 13428     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13429     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13430     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13431     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13432     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 13433
 13434     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13435     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13436     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13437     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13438     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13439     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 13440
 13441     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13442     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13443     MOVE SPACES                 TO W-NAME-MIDDLE.
 13444     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13445     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 13446
 13447     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 13448     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 13449
 13450     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13451     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13452     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13453     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13454     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 13455                                    W-LABEL-JOINT-NAME.
 13456
 13457     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13458     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13459     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13460     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13461     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 13462
 13463     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13464     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13465     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13466     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13467     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13468     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 13469
 13470     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13471     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13472     MOVE SPACES                 TO W-NAME-MIDDLE.
 13473     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13474     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 13475
 13476     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 13477     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 13478
 13479     COMPUTE W-WORK-AMOUNT
 13480         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 13481     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 279
* EL689.cbl
 13482     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 13483     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 13484     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 13485
 13486     IF  CM-SEX-FEMAL
 13487         MOVE 'MS.'              TO W-VG-TEXT (96)
 13488
 13489     ELSE
 13490         MOVE 'MR.'              TO W-VG-TEXT (96).
 13491
 13492     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 13493                                 TO W-VG-TEXT (70).
 13494     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 13495     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 13496     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 13497     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 13498     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 13499     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 13500     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 13501     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 13502     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 13503     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 13504     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 13505     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 13506     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 13507     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 13508     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 13509     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 13510     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 13511     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 13512     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 13513     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13514     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 13515     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13516     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 13517     IF PI-689-DATA-SOURCE NOT = '4'
 13518     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 13519        + CM-AH-ITD-CANCEL-AMT
 13520     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13521     IF CM-NH-INT-ON-REFS NOT NUMERIC
 13522        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 13523     END-IF
 13524     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 13525     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13526     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 13527     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 13528        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 13529     END-IF
 13530     MOVE SPACES                 TO DC-OPTION-CODE
 13531     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13532
 13533     IF NO-CONVERSION-ERROR
 13534        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13535     END-IF
 13536     END-IF
 13537     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 13538     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 13539     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 280
* EL689.cbl
 13540
 13541     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 13542     MOVE SPACES                 TO DC-OPTION-CODE.
 13543     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13544
 13545     IF  NO-CONVERSION-ERROR
 13546         MOVE DC-GREG-DATE-1-EDIT
 13547                                 TO W-VG-TEXT (81).
 13548
 13549     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 13550     MOVE SPACES                 TO DC-OPTION-CODE.
 13551     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13552
 13553     IF  NO-CONVERSION-ERROR
 13554         MOVE DC-GREG-DATE-1-EDIT
 13555                                 TO W-VG-TEXT (82).
 13556
 13557     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13558     MOVE SPACES                 TO DC-OPTION-CODE.
 13559     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13560
 13561     IF  NO-CONVERSION-ERROR
 13562         MOVE DC-GREG-DATE-1-EDIT
 13563                                 TO W-VG-TEXT (74).
 13564
 13565     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13566
 13567     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 13568         MOVE CM-PMT-EXTENSION-DAYS
 13569                                 TO DC-ELAPSED-DAYS
 13570     ELSE
 13571         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 13572
 13573     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13574     MOVE '6'                    TO DC-OPTION-CODE.
 13575     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13576
 13577     IF  NO-CONVERSION-ERROR
 13578         MOVE DC-GREG-DATE-1-EDIT
 13579                                 TO W-VG-TEXT (75).
 13580
 13581     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13582     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13583     MOVE '6'                    TO DC-OPTION-CODE.
 13584     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13585
 13586     IF  NO-CONVERSION-ERROR
 13587         MOVE DC-GREG-DATE-1-EDIT
 13588                                 TO W-VG-TEXT (76).
 13589
 13590 6450-EXIT.
 13591     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 281
* EL689.cbl
 13593 6500-GET-ACCOUNT-DATA.
 13594
 13595     IF  ADDRSI EQUAL '1'
 13596             AND
 13597         PI-CREATE-LABELS
 13598             AND
 13599         NOT PI-689-LABELS-OVERRIDEN
 13600         NEXT SENTENCE
 13601     ELSE
 13602         IF  W-FILE-NOT-USED (6)
 13603             GO TO 6500-EXIT
 13604         END-IF
 13605     END-IF.
 13606
 13607 6500-READ-ACCT-ONLY.
 13608
 13609     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 13610         MOVE ER-9327            TO EMI-ERROR
 13611         MOVE -1                 TO MAINTL
 13612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13613         GO TO 6500-EXIT.
 13614
 13615
 13616* EXEC CICS HANDLE CONDITION
 13617*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 13618*         NOTFND     (6500-ACCT-NOT-FOUND)
 13619*         ENDFILE    (6500-ONLY-STOP)
 13620*    END-EXEC.
 13621*    MOVE '"$JI''                 ! 1 #00012842' TO DFHEIV0
 13622     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 13623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13624     MOVE X'3120233030303132383432' TO DFHEIV0(25:11)
 13625     CALL 'kxdfhei1' USING DFHEIV0
 13626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13627
 13628
 13629
 13630* EXEC CICS STARTBR
 13631*         RIDFLD     (W-ACCT-KEY)
 13632*         DATASET    (W-ACCT-FILE-ID)
 13633*         KEYLENGTH  (20)
 13634*         GENERIC
 13635*    END-EXEC.
 13636     MOVE 20
 13637       TO DFHEIV11
 13638     MOVE 0
 13639       TO DFHEIV12
 13640*    MOVE '&,   KG    G          &   #00012848' TO DFHEIV0
 13641     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13642     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13643     MOVE X'2020233030303132383438' TO DFHEIV0(25:11)
 13644     CALL 'kxdfhei1' USING DFHEIV0,
 13645           W-ACCT-FILE-ID,
 13646           W-ACCT-KEY,
 13647           DFHEIV11,
 13648           DFHEIV12,
 13649           DFHEIV99
 13650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 282
* EL689.cbl
 13651
 13652
 13653     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 13654     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 13655
 13656 6500-READNEXT.
 13657
 13658
 13659* EXEC CICS READNEXT
 13660*         DATASET    (W-ACCT-FILE-ID)
 13661*         SET        (ADDRESS OF ACCOUNT-MASTER)
 13662*         RIDFLD     (W-ACCT-KEY)
 13663*    END-EXEC.
 13664     MOVE 0
 13665       TO DFHEIV11
 13666*    MOVE '&.S                   )   #00012860' TO DFHEIV0
 13667     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13668     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13669     MOVE X'2020233030303132383630' TO DFHEIV0(25:11)
 13670     CALL 'kxdfhei1' USING DFHEIV0,
 13671           W-ACCT-FILE-ID,
 13672           DFHEIV20,
 13673           DFHEIV99,
 13674           W-ACCT-KEY,
 13675           DFHEIV99,
 13676           DFHEIV11,
 13677           DFHEIV99,
 13678           DFHEIV99
 13679     SET ADDRESS OF ACCOUNT-MASTER TO
 13680         DFHEIV20
 13681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13682
 13683
 13684     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 13685         IF  PRIOR-MATCH-ACCT-PKEY
 13686             CONTINUE
 13687*            GO TO 6500-ONLY-STOP
 13688         ELSE
 13689             IF  W-FILE-NOT-USED (6)
 13690                 PERFORM 6500-ENDBR
 13691                 GO TO 6500-EXIT
 13692             ELSE
 13693                 GO TO 6500-ACCT-NOT-FOUND
 13694             END-IF
 13695         END-IF
 13696     ELSE
 13697         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 13698         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 13699         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 13700         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 13701         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 13702         MOVE AM-NAME              TO WS-SAV-AM-NAME
 13703         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 13704         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 13705         MOVE SPACES               TO WS-SAV-AM-CITY
 13706*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 13707         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13708            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 283
* EL689.cbl
 13709         END-STRING
 13710         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 13711         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 13712         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 13713         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 13714         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 13715         GO TO 6500-READNEXT
 13716     END-IF
 13717     .
 13718 6500-ONLY-STOP.
 13719
 13720     IF  NOT PI-NO-CARRIER-SECURITY
 13721             AND
 13722         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 13723         MOVE -1                 TO CARRIERL
 13724         MOVE AL-UANON           TO CARRIERA
 13725         MOVE ER-9095            TO EMI-ERROR
 13726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13727         PERFORM 6500-ENDBR
 13728         GO TO 8200-SEND-DATAONLY.
 13729
 13730     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13731     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 13732     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 13733     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 13734     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 13735
 13736     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 13737     MOVE SPACES                 TO W-LABEL-ZIP (5).
 13738
 13739     IF  SAVE-AM-CANADIAN-POST-CODE
 13740         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 13741                                 TO W-CANADIAN-POSTAL-CODES
 13742         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13743         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13744         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13745                                    W-LAB-CAN-FILLER (5)
 13746     ELSE
 13747         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13748
 13749         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13750             MOVE '-'            TO W-LABEL-DASH (5)
 13751             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13752         ELSE
 13753             MOVE SPACES         TO W-LABEL-DASH (5)
 13754                                    W-LABEL-2ND-ZIP (5).
 13755
 13756     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13757
 13758     IF  ADDRSI EQUAL '1'
 13759             AND
 13760         PI-CREATE-LABELS
 13761             AND
 13762         NOT PI-689-LABELS-OVERRIDEN
 13763         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13764                                    W-VG-TEXT (40)
 13765         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13766                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 284
* EL689.cbl
 13767         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13768                                    W-VG-TEXT (42)
 13769         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13770                                    W-VG-TEXT (43)
 13771         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13772                                    W-VG-TEXT (44)
 13773         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13774                                    W-VG-TEXT (45)
 13775         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13776         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13777         SET W-RG-NDX UP BY +1
 13778     ELSE
 13779         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 13780         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 13781         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 13782         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 13783         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 13784         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 13785
 13786     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 13787             OR
 13788         WS-SAV-AM-TEL-NO EQUAL ZEROS
 13789         MOVE SPACES             TO W-VG-TEXT (46)
 13790     ELSE
 13791         MOVE ZEROS                  TO W-PHONE-IN
 13792         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 13793         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 13794         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 13795         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 13796
 13797     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 13798        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 13799     ELSE
 13800        MOVE SPACES                   TO W-VG-TEXT (47)
 13801     END-IF.
 13802     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 13803     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 13804                                 TO W-VG-TEXT (49)
 13805
 13806     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 13807     PERFORM 6500-ENDBR.
 13808
 13809     GO TO 6500-EXIT.
 13810
 13811 6500-ENDBR.
 13812
 13813     IF  W-ACCT-BROWSE-STARTED
 13814         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 13815
 13816* EXEC CICS ENDBR
 13817*            DATASET (W-ACCT-FILE-ID)
 13818*        END-EXEC
 13819     MOVE 0
 13820       TO DFHEIV11
 13821*    MOVE '&2                    $   #00012997' TO DFHEIV0
 13822     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13823     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13824     MOVE X'2020233030303132393937' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 285
* EL689.cbl
 13825     CALL 'kxdfhei1' USING DFHEIV0,
 13826           W-ACCT-FILE-ID,
 13827           DFHEIV11,
 13828           DFHEIV99
 13829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13830     END-IF.
 13831
 13832 6500-ACCT-NOT-FOUND.
 13833
 13834     PERFORM 6500-ENDBR.
 13835
 13836     IF  DATASORI NOT EQUAL '1'
 13837         MOVE ER-0179            TO EMI-ERROR
 13838         GO TO 6500-EXIT.
 13839
 13840     MOVE ER-0179                TO EMI-ERROR.
 13841     MOVE -1                     TO MAINTL.
 13842     MOVE AL-UNBON               TO MAINTA.
 13843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13844     GO TO 8200-SEND-DATAONLY.
 13845
 13846 6500-EXIT.
 13847     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 286
* EL689.cbl
 13849 6600-GET-COMPENSATION-DATA.
 13850
 13851     IF  ADDRSI EQUAL '4'
 13852             AND
 13853         PI-CREATE-LABELS
 13854             AND
 13855         NOT PI-689-LABELS-OVERRIDEN
 13856         NEXT SENTENCE
 13857     ELSE
 13858         IF  W-FILE-NOT-USED (10)
 13859             GO TO 6600-EXIT.
 13860
 13861     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 13862         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 13863         GO TO 6600-START.
 13864
 13865     IF  PI-ZERO-CARRIER
 13866             OR
 13867         PI-ZERO-CAR-GROUP
 13868         MOVE ZEROS              TO W-COMP-CARRIER.
 13869
 13870     IF  PI-ZERO-GROUPING
 13871             OR
 13872         PI-ZERO-CAR-GROUP
 13873         MOVE ZEROS              TO W-COMP-GROUPING.
 13874
 13875     IF  W-FILE-NOT-USED (6)
 13876         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 13877         IF  EMI-ERROR EQUAL ER-0179
 13878             MOVE ER-9327        TO EMI-ERROR
 13879             MOVE -1             TO MAINTL
 13880             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13881             GO TO 6600-EXIT.
 13882
 13883     MOVE  'A'                   TO W-COMP-TYPE.
 13884
 13885     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 13886         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 13887                                 TO W-COMP-RESP-PERSON
 13888     ELSE
 13889         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13890
 13891     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 13892        (W-NDX > +10)
 13893            OR
 13894         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 13895     END-PERFORM
 13896
 13897     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 13898         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 13899     ELSE
 13900         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13901
 13902     PERFORM 6500-ENDBR.
 13903     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13904
 13905     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 13906         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 287
* EL689.cbl
 13907         MOVE -1                 TO MAINTL
 13908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13909         GO TO 6600-EXIT.
 13910
 13911 6600-START.
 13912
 13913
 13914* EXEC CICS HANDLE CONDITION
 13915*         NOTOPEN (8080-COMP-NOT-OPEN)
 13916*         NOTFND  (6600-COMP-NOT-FOUND)
 13917*    END-EXEC.
 13918*    MOVE '"$JI                  ! 2 #00013083' TO DFHEIV0
 13919     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13921     MOVE X'3220233030303133303833' TO DFHEIV0(25:11)
 13922     CALL 'kxdfhei1' USING DFHEIV0
 13923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13924
 13925
 13926
 13927* EXEC CICS STARTBR
 13928*         RIDFLD  (W-COMP-KEY)
 13929*         DATASET (W-COMP-FILE-ID)
 13930*    END-EXEC.
 13931     MOVE 0
 13932       TO DFHEIV11
 13933*    MOVE '&,         G          &   #00013088' TO DFHEIV0
 13934     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13935     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13936     MOVE X'2020233030303133303838' TO DFHEIV0(25:11)
 13937     CALL 'kxdfhei1' USING DFHEIV0,
 13938           W-COMP-FILE-ID,
 13939           W-COMP-KEY,
 13940           DFHEIV99,
 13941           DFHEIV11,
 13942           DFHEIV99
 13943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13944
 13945
 13946     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 13947
 13948 6600-READNEXT.
 13949
 13950
 13951* EXEC CICS READNEXT
 13952*         DATASET (W-COMP-FILE-ID)
 13953*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13954*         RIDFLD  (W-COMP-KEY)
 13955*    END-EXEC.
 13956     MOVE 0
 13957       TO DFHEIV11
 13958*    MOVE '&.S                   )   #00013097' TO DFHEIV0
 13959     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13960     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13961     MOVE X'2020233030303133303937' TO DFHEIV0(25:11)
 13962     CALL 'kxdfhei1' USING DFHEIV0,
 13963           W-COMP-FILE-ID,
 13964           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 288
* EL689.cbl
 13965           DFHEIV99,
 13966           W-COMP-KEY,
 13967           DFHEIV99,
 13968           DFHEIV11,
 13969           DFHEIV99,
 13970           DFHEIV99
 13971     SET ADDRESS OF COMPENSATION-MASTER TO
 13972         DFHEIV20
 13973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13974
 13975
 13976     IF CO-CONTROL-PRIMARY
 13977           NOT = W-COMP-SAVE-KEY
 13978        GO TO 6600-COMP-NOT-FOUND.
 13979
 13980     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13981     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 13982                                    W-VG-TEXT (140).
 13983     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13984     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13985     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13986*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13987     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13988        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13989     END-STRING
 13990
 13991     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13992
 13993     IF  CO-CANADIAN-POST-CODE
 13994         MOVE CO-CANADIAN-POSTAL-CODE
 13995                                 TO W-CANADIAN-POSTAL-CODES
 13996         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13997         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13998         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13999                                    W-LAB-CAN-FILLER (6)
 14000     ELSE
 14001         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14002
 14003         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14004             MOVE '-'            TO W-LABEL-DASH (6)
 14005             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14006         ELSE
 14007             MOVE SPACES         TO W-LABEL-DASH (6)
 14008                                    W-LABEL-2ND-ZIP (6).
 14009
 14010     IF  CO-TELEPHONE NOT NUMERIC
 14011             OR
 14012         CO-TELEPHONE = ZEROS
 14013         MOVE SPACES             TO W-VG-TEXT (147)
 14014     ELSE
 14015         MOVE ZEROS              TO W-PHONE-IN
 14016         MOVE CO-AREA-CODE       TO W-PO-AREA
 14017         MOVE CO-PREFIX          TO W-PO-PFX
 14018         MOVE CO-PHONE           TO W-PO-SFX
 14019         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 14020
 14021     IF (CO-FAXNO NOT NUMERIC)
 14022        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 289
* EL689.cbl
 14023        MOVE SPACES              TO W-VG-TEXT (182)
 14024     ELSE
 14025        MOVE ZEROS               TO W-PHONE-IN
 14026        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 14027        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 14028        MOVE CO-FAX-PHONE        TO W-PO-SFX
 14029        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 14030     END-IF
 14031     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 14032        MOVE SPACES              TO W-VG-TEXT (183)
 14033     ELSE
 14034        EVALUATE CO-GA-STATUS-CODE
 14035           WHEN 'A'
 14036              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 14037           WHEN 'I'
 14038              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 14039           WHEN 'P'
 14040              MOVE 'PENDING'     TO W-VG-TEXT (183)
 14041        END-EVALUATE
 14042     END-IF
 14043     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 14044        MOVE SPACES              TO W-VG-TEXT (181)
 14045     ELSE
 14046        EVALUATE CO-BILL-SW
 14047           WHEN 'B'
 14048              MOVE 'BILLED'      TO W-VG-TEXT (181)
 14049           WHEN 'R'
 14050              MOVE 'REMIT'       TO W-VG-TEXT (181)
 14051           WHEN 'T'
 14052              MOVE 'T'           TO W-VG-TEXT (181)
 14053           WHEN 'S'
 14054              MOVE 'S'           TO W-VG-TEXT (181)
 14055        END-EVALUATE
 14056     END-IF
 14057     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14058
 14059     IF  ADDRSI EQUAL '4'
 14060             AND
 14061         PI-CREATE-LABELS
 14062             AND
 14063         NOT PI-689-LABELS-OVERRIDEN
 14064         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14065                                    W-VG-TEXT (141)
 14066         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14067                                    W-VG-TEXT (142)
 14068         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14069                                    W-VG-TEXT (143)
 14070         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14071                                    W-VG-TEXT (144)
 14072         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14073                                    W-VG-TEXT (145)
 14074         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14075                                    W-VG-TEXT (146)
 14076         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14077         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14078         SET W-RG-NDX UP BY +1
 14079     ELSE
 14080         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 290
* EL689.cbl
 14081         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 14082         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 14083         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 14084         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 14085         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 14086
 14087     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 14088
 14089     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 14090     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 14091     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 14092
 14093     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 14094     MOVE '3'                    TO DC-OPTION-CODE.
 14095     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14096
 14097     IF  NO-CONVERSION-ERROR
 14098         MOVE DC-GREG-DATE-1-ALPHA
 14099                                 TO W-VG-TEXT (149).
 14100
 14101     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 14102     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 14103
 14104     PERFORM 6600-ENDBR.
 14105     GO TO 6600-EXIT.
 14106
 14107 6600-ENDBR.
 14108
 14109     IF  W-COMP-BROWSE-STARTED
 14110         MOVE 'N'                      TO W-COMP-BROWSE-SW
 14111
 14112* EXEC CICS ENDBR
 14113*             DATASET(W-COMP-FILE-ID)
 14114*        END-EXEC.
 14115     MOVE 0
 14116       TO DFHEIV11
 14117*    MOVE '&2                    $   #00013238' TO DFHEIV0
 14118     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14119     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14120     MOVE X'2020233030303133323338' TO DFHEIV0(25:11)
 14121     CALL 'kxdfhei1' USING DFHEIV0,
 14122           W-COMP-FILE-ID,
 14123           DFHEIV11,
 14124           DFHEIV99
 14125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14126
 14127
 14128 6600-COMP-NOT-FOUND.
 14129
 14130     PERFORM 6600-ENDBR.
 14131
 14132     IF ADDRSL GREATER ZERO
 14133         IF ADDRSI = '4'
 14134            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 14135                MOVE ER-7378                TO EMI-ERROR
 14136                MOVE -1                     TO TYPEL
 14137                MOVE AL-UNBON               TO TYPEA
 14138                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 291
* EL689.cbl
 14139                GO TO 8200-SEND-DATAONLY
 14140            ELSE
 14141                MOVE ER-2114                TO EMI-ERROR
 14142                MOVE -1                     TO ADDRSL
 14143                MOVE AL-UNBON               TO ADDRSA
 14144                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14145                GO TO 8200-SEND-DATAONLY.
 14146
 14147 6600-EXIT.
 14148     EXIT.
 14149 6620-GET-G-DATA.
 14150
 14151     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 14152
 14153     IF  CO-RPTCD2 GREATER THAN SPACES
 14154         MOVE SPACES             TO W-COMP-RESP-PERSON
 14155         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 14156         MOVE +10                TO W-CWA-NDX
 14157         PERFORM 6622-FIND-LAST-NON-SPACE
 14158         SET W-COMP-NDX          TO +10
 14159         PERFORM 6625-FILL-IN-RESP-PERSON.
 14160         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 14161
 14162     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 14163     MOVE 'G'                    TO W-COMP-TYPE.
 14164     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 14165
 14166
 14167* EXEC CICS RESETBR
 14168*         RIDFLD  (W-COMP-KEY)
 14169*         DATASET (W-COMP-FILE-ID)
 14170*    END-EXEC.
 14171     MOVE 0
 14172       TO DFHEIV11
 14173*    MOVE '&4         G          &   #00013280' TO DFHEIV0
 14174     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14175     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14176     MOVE X'2020233030303133323830' TO DFHEIV0(25:11)
 14177     CALL 'kxdfhei1' USING DFHEIV0,
 14178           W-COMP-FILE-ID,
 14179           W-COMP-KEY,
 14180           DFHEIV99,
 14181           DFHEIV11,
 14182           DFHEIV99
 14183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14184
 14185
 14186
 14187* EXEC CICS READNEXT
 14188*         DATASET (W-COMP-FILE-ID)
 14189*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14190*         RIDFLD  (W-COMP-KEY)
 14191*    END-EXEC.
 14192     MOVE 0
 14193       TO DFHEIV11
 14194*    MOVE '&.S                   )   #00013285' TO DFHEIV0
 14195     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14196     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 292
* EL689.cbl
 14197     MOVE X'2020233030303133323835' TO DFHEIV0(25:11)
 14198     CALL 'kxdfhei1' USING DFHEIV0,
 14199           W-COMP-FILE-ID,
 14200           DFHEIV20,
 14201           DFHEIV99,
 14202           W-COMP-KEY,
 14203           DFHEIV99,
 14204           DFHEIV11,
 14205           DFHEIV99,
 14206           DFHEIV99
 14207     SET ADDRESS OF COMPENSATION-MASTER TO
 14208         DFHEIV20
 14209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14210
 14211
 14212     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14213         GO TO 6620-EXIT.
 14214
 14215     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14216     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14217     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14218     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14219     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14220*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14221     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14222        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14223     END-STRING
 14224
 14225     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14226
 14227     IF  CO-CANADIAN-POST-CODE
 14228         MOVE CO-CANADIAN-POSTAL-CODE
 14229                                 TO W-CANADIAN-POSTAL-CODES
 14230         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14231         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14232         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14233                                    W-LAB-CAN-FILLER (6)
 14234     ELSE
 14235         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14236         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14237             MOVE '-'            TO W-LABEL-DASH (6)
 14238             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14239         ELSE
 14240             MOVE SPACES         TO W-LABEL-DASH (6)
 14241                                    W-LABEL-2ND-ZIP (6).
 14242
 14243     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14244
 14245     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 14246     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 14247     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 14248     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 14249     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 14250     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 14251
 14252 6620-EXIT.
 14253     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 293
* EL689.cbl
 14255 6622-FIND-LAST-NON-SPACE.
 14256
 14257     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 14258         SUBTRACT +1 FROM W-CWA-NDX
 14259         GO TO 6622-FIND-LAST-NON-SPACE.
 14260
 14261 6622-EXIT.
 14262     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 294
* EL689.cbl
 14264 6625-FILL-IN-RESP-PERSON.
 14265
 14266     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 14267     SET W-COMP-NDX DOWN BY +1.
 14268     SUBTRACT +1 FROM W-CWA-NDX.
 14269
 14270     IF  W-CWA-NDX GREATER THAN ZEROS
 14271         GO TO 6625-FILL-IN-RESP-PERSON.
 14272
 14273 6625-EXIT.
 14274     EXIT.
 14275 6626-GET-B-DATA.
 14276     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 14277     IF W-FILE-USED (8)
 14278        PERFORM 6450-READ-CERT-ONLY
 14279        IF W-CERT-FOUND
 14280           MOVE CM-BENEFICIARY (1:10)
 14281                                 TO W-COMP-RESP-PERSON
 14282        ELSE
 14283           MOVE SPACES           TO W-COMP-RESP-PERSON
 14284           GO TO 6626-EXIT
 14285        END-IF
 14286     ELSE
 14287        MOVE CM-BENEFICIARY (1:10)
 14288                                 TO W-COMP-RESP-PERSON
 14289     END-IF
 14290     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 14291     MOVE 'B'                    TO W-COMP-TYPE
 14292     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 14293
 14294
 14295* EXEC CICS RESETBR
 14296*         RIDFLD  (W-COMP-KEY)
 14297*         DATASET (W-COMP-FILE-ID)
 14298*    END-EXEC.
 14299     MOVE 0
 14300       TO DFHEIV11
 14301*    MOVE '&4         G          &   #00013373' TO DFHEIV0
 14302     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14303     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14304     MOVE X'2020233030303133333733' TO DFHEIV0(25:11)
 14305     CALL 'kxdfhei1' USING DFHEIV0,
 14306           W-COMP-FILE-ID,
 14307           W-COMP-KEY,
 14308           DFHEIV99,
 14309           DFHEIV11,
 14310           DFHEIV99
 14311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14312
 14313
 14314
 14315* EXEC CICS READNEXT
 14316*         DATASET (W-COMP-FILE-ID)
 14317*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14318*         RIDFLD  (W-COMP-KEY)
 14319*    END-EXEC.
 14320     MOVE 0
 14321       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 295
* EL689.cbl
 14322*    MOVE '&.S                   )   #00013378' TO DFHEIV0
 14323     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14324     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14325     MOVE X'2020233030303133333738' TO DFHEIV0(25:11)
 14326     CALL 'kxdfhei1' USING DFHEIV0,
 14327           W-COMP-FILE-ID,
 14328           DFHEIV20,
 14329           DFHEIV99,
 14330           W-COMP-KEY,
 14331           DFHEIV99,
 14332           DFHEIV11,
 14333           DFHEIV99,
 14334           DFHEIV99
 14335     SET ADDRESS OF COMPENSATION-MASTER TO
 14336         DFHEIV20
 14337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14338
 14339
 14340     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14341         GO TO 6626-EXIT.
 14342
 14343     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14344     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14345     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14346     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14347     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14348*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14349     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14350        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14351     END-STRING
 14352
 14353     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14354
 14355     IF  CO-CANADIAN-POST-CODE
 14356         MOVE CO-CANADIAN-POSTAL-CODE
 14357                                 TO W-CANADIAN-POSTAL-CODES
 14358         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14359         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14360         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14361                                    W-LAB-CAN-FILLER (6)
 14362     ELSE
 14363         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14364         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14365             MOVE '-'            TO W-LABEL-DASH (6)
 14366             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14367         ELSE
 14368             MOVE SPACES         TO W-LABEL-DASH (6)
 14369                                    W-LABEL-2ND-ZIP (6).
 14370
 14371     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14372
 14373     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 14374     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 14375     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 14376     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 14377     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 14378     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 14379
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 296
* EL689.cbl
 14380 6626-EXIT.
 14381     EXIT.
 14382 6630-GET-CSR-NAME.
 14383
 14384     MOVE SPACES                 TO W-CNTL-KEY.
 14385     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 14386     MOVE +0                     TO W-CNTL-SEQ-NO.
 14387     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 14388     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 14389
 14390
 14391* EXEC CICS HANDLE CONDITION
 14392*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 14393*         NOTFND     (6630-CNTL2-NOT-FOUND)
 14394*    END-EXEC.
 14395*    MOVE '"$JI                  ! 3 #00013434' TO DFHEIV0
 14396     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14398     MOVE X'3320233030303133343334' TO DFHEIV0(25:11)
 14399     CALL 'kxdfhei1' USING DFHEIV0
 14400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14401
 14402
 14403
 14404* EXEC CICS READ
 14405*         DATASET    (W-CNTL-FILE-ID)
 14406*         SET        (ADDRESS OF CONTROL-FILE)
 14407*         RIDFLD     (W-CNTL-KEY)
 14408*    END-EXEC.
 14409*    MOVE '&"S        E          (   #00013439' TO DFHEIV0
 14410     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14412     MOVE X'2020233030303133343339' TO DFHEIV0(25:11)
 14413     CALL 'kxdfhei1' USING DFHEIV0,
 14414           W-CNTL-FILE-ID,
 14415           DFHEIV20,
 14416           DFHEIV99,
 14417           W-CNTL-KEY,
 14418           DFHEIV99,
 14419           DFHEIV99,
 14420           DFHEIV99
 14421     SET ADDRESS OF CONTROL-FILE TO
 14422         DFHEIV20
 14423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14424
 14425
 14426     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 14427     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 14428     GO TO 6630-EXIT.
 14429
 14430 6630-CNTL2-NOT-FOUND.
 14431
 14432*    MOVE ER-8965                TO EMI-ERROR.
 14433*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14434*    MOVE -1                     TO MAINTL.
 14435*    MOVE AL-UANON               TO MAINTA.
 14436*    GO TO 8200-SEND-DATAONLY
 14437     .
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 297
* EL689.cbl
 14438 6630-EXIT.
 14439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 298
* EL689.cbl
 14441 6700-GET-MAIL-DATA.
 14442
 14443     IF  ADDRSI EQUAL '5'
 14444             AND
 14445         PI-CREATE-LABELS
 14446             AND
 14447         NOT PI-689-LABELS-OVERRIDEN
 14448         NEXT SENTENCE
 14449     ELSE
 14450         IF  W-FILE-NOT-USED (5)
 14451             GO TO 6700-EXIT.
 14452
 14453     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 14454         MOVE ER-9327            TO EMI-ERROR
 14455         MOVE -1                 TO MAINTL
 14456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14457         GO TO 6700-EXIT.
 14458
 14459
 14460* EXEC CICS HANDLE CONDITION
 14461*         NOTOPEN (8090-MAIL-NOT-OPEN)
 14462*         NOTFND  (6700-MAIL-NOT-FOUND)
 14463*    END-EXEC.
 14464*    MOVE '"$JI                  ! 4 #00013478' TO DFHEIV0
 14465     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14467     MOVE X'3420233030303133343738' TO DFHEIV0(25:11)
 14468     CALL 'kxdfhei1' USING DFHEIV0
 14469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14470
 14471
 14472
 14473* EXEC CICS READ
 14474*         DATASET(W-MAIL-FILE-ID)
 14475*         SET    (ADDRESS OF MAILING-DATA)
 14476*         RIDFLD (W-MAIL-KEY)
 14477*    END-EXEC.
 14478*    MOVE '&"S        E          (   #00013483' TO DFHEIV0
 14479     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14481     MOVE X'2020233030303133343833' TO DFHEIV0(25:11)
 14482     CALL 'kxdfhei1' USING DFHEIV0,
 14483           W-MAIL-FILE-ID,
 14484           DFHEIV20,
 14485           DFHEIV99,
 14486           W-MAIL-KEY,
 14487           DFHEIV99,
 14488           DFHEIV99,
 14489           DFHEIV99
 14490     SET ADDRESS OF MAILING-DATA TO
 14491         DFHEIV20
 14492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14493
 14494
 14495     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 14496     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 14497     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 14498     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 299
* EL689.cbl
 14499
 14500     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14501     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 14502     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 14503     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 14504     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 14505*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 14506     STRING MA-CITY ' ' MA-ADDR-STATE
 14507        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14508     END-STRING
 14509
 14510     MOVE MA-ZIP                 TO W-WORK-ZIP.
 14511     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14512
 14513     IF  MA-CANADIAN-POST-CODE
 14514         MOVE MA-CANADIAN-POSTAL-CODE
 14515                                 TO W-CANADIAN-POSTAL-CODES
 14516         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14517         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14518         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14519                                    W-LAB-CAN-FILLER (6)
 14520     ELSE
 14521         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14522         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14523             MOVE '-'            TO W-LABEL-DASH (6)
 14524             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14525         ELSE
 14526             MOVE SPACES         TO W-LABEL-DASH (6)
 14527                                    W-LABEL-2ND-ZIP (6).
 14528
 14529     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14530
 14531     IF  ADDRSI EQUAL '5'
 14532             AND
 14533         PI-CREATE-LABELS
 14534             AND
 14535         NOT PI-689-LABELS-OVERRIDEN
 14536         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14537                                    W-VG-TEXT (31)
 14538         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14539                                    W-VG-TEXT (32)
 14540         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14541                                    W-VG-TEXT (33)
 14542         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14543                                    W-VG-TEXT (34)
 14544         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14545                                    W-VG-TEXT (35)
 14546         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14547                                    W-VG-TEXT (36)
 14548         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14549         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14550         SET W-RG-NDX UP BY +1
 14551     ELSE
 14552         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 14553         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 14554         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 14555         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 14556         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 300
* EL689.cbl
 14557         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 14558     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14559     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 14560     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 14561     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 14562     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 14563        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 14564     END-STRING
 14565
 14566     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 14567     MOVE SPACES                 TO W-LABEL-ZIP (5)
 14568
 14569     IF  MA-CB-CANADIAN-POST-CODE
 14570         MOVE MA-CB-CANADIAN-POSTAL-CODE
 14571                                 TO W-CANADIAN-POSTAL-CODES
 14572         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 14573         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 14574         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 14575                                    W-LAB-CAN-FILLER (5)
 14576     ELSE
 14577         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 14578         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14579             MOVE '-'            TO W-LABEL-DASH (5)
 14580             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 14581         ELSE
 14582             MOVE SPACES         TO W-LABEL-DASH (5)
 14583                                    W-LABEL-2ND-ZIP (5)
 14584         END-IF
 14585     END-IF
 14586     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 14587     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 14588     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 14589     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 14590     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 14591     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 14592     GO TO 6700-EXIT.
 14593
 14594 6700-MAIL-NOT-FOUND.
 14595
 14596     IF  ADDRSL GREATER ZERO
 14597         IF ADDRSI = '5'
 14598            MOVE ER-3000         TO EMI-ERROR
 14599            MOVE -1              TO ADDRSL
 14600            MOVE AL-UNBON        TO ADDRSA
 14601            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14602            GO TO 8200-SEND-DATAONLY.
 14603
 14604 6700-EXIT.
 14605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 301
* EL689.cbl
 14607 6750-GET-LIFE-BENEFIT-DATA.
 14608
 14609     IF  W-FILE-NOT-USED (2)
 14610         GO TO 6750-EXIT.
 14611
 14612     MOVE SPACES                 TO W-CNTL-GEN2.
 14613
 14614     IF  DATASORI EQUAL '2'
 14615         IF  W-FILE-NOT-USED (8)
 14616             PERFORM 6450-READ-CERT-ONLY
 14617             IF  W-CERT-FOUND
 14618                 MOVE CM-LF-BENEFIT-CD
 14619                                 TO W-BEN-HOLD
 14620                                    W-CNTL-GEN2
 14621             ELSE
 14622                 NEXT SENTENCE
 14623         ELSE
 14624             MOVE CM-LF-BENEFIT-CD
 14625                                 TO W-BEN-HOLD
 14626                                    W-CNTL-GEN2
 14627     ELSE
 14628         IF  DATASORI EQUAL '4'
 14629             IF  W-FILE-NOT-USED (9)
 14630                 PERFORM 6400-READ-PNDB-ONLY
 14631                 IF  W-PNDB-FOUND
 14632                     IF  PI-689-TYPE = '1'
 14633                         MOVE PB-I-LF-BENEFIT-CD
 14634                                 TO W-BEN-HOLD
 14635                                    W-CNTL-GEN2
 14636                     ELSE
 14637                         MOVE PB-CI-LF-BENEFIT-CD
 14638                                 TO W-BEN-HOLD
 14639                                    W-CNTL-GEN2
 14640             ELSE
 14641                 NEXT SENTENCE
 14642         ELSE
 14643             IF  W-FILE-USED (8)
 14644                 MOVE CM-LF-BENEFIT-CD
 14645                                 TO W-BEN-HOLD
 14646                                    W-CNTL-GEN2
 14647             ELSE
 14648                 IF  W-FILE-USED (9)
 14649                     IF  PI-689-TYPE = '1'
 14650                         MOVE PB-I-LF-BENEFIT-CD
 14651                                 TO W-BEN-HOLD
 14652                                    W-CNTL-GEN2
 14653                     ELSE
 14654                         MOVE PB-CI-LF-BENEFIT-CD
 14655                                 TO W-BEN-HOLD
 14656                                    W-CNTL-GEN2.
 14657
 14658     IF  W-CNTL-GEN2 EQUAL SPACES
 14659         MOVE ER-9327            TO EMI-ERROR
 14660         MOVE -1                 TO MAINTL
 14661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14662         GO TO 6750-EXIT.
 14663
 14664     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 302
* EL689.cbl
 14665     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 14666     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14667
 14668
 14669* EXEC CICS HANDLE CONDITION
 14670*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14671*         NOTFND  (6750-EXIT)
 14672*    END-EXEC.
 14673*    MOVE '"$JI                  ! 5 #00013662' TO DFHEIV0
 14674     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14676     MOVE X'3520233030303133363632' TO DFHEIV0(25:11)
 14677     CALL 'kxdfhei1' USING DFHEIV0
 14678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14679
 14680
 14681
 14682* EXEC CICS READ
 14683*         DATASET (W-CNTL-FILE-ID)
 14684*         SET     (ADDRESS OF CONTROL-FILE)
 14685*         GTEQ
 14686*         RIDFLD  (W-CNTL-KEY)
 14687*    END-EXEC.
 14688*    MOVE '&"S        G          (   #00013667' TO DFHEIV0
 14689     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14690     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14691     MOVE X'2020233030303133363637' TO DFHEIV0(25:11)
 14692     CALL 'kxdfhei1' USING DFHEIV0,
 14693           W-CNTL-FILE-ID,
 14694           DFHEIV20,
 14695           DFHEIV99,
 14696           W-CNTL-KEY,
 14697           DFHEIV99,
 14698           DFHEIV99,
 14699           DFHEIV99
 14700     SET ADDRESS OF CONTROL-FILE TO
 14701         DFHEIV20
 14702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14703
 14704
 14705     MOVE 1                      TO W-NDX.
 14706
 14707 6750-LOOP.
 14708
 14709     IF  W-NDX = 9
 14710         GO TO 6750-EXIT.
 14711
 14712     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14713         ADD 1                   TO W-NDX
 14714         GO TO 6750-LOOP.
 14715
 14716     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14717         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14718                                 TO W-VG-TEXT (11).
 14719
 14720 6750-EXIT.
 14721     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 303
* EL689.cbl
 14723 6800-GET-A-H-BENEFIT-DATA.
 14724
 14725     IF  W-FILE-NOT-USED (3)
 14726         GO TO 6800-EXIT.
 14727
 14728     MOVE SPACES                 TO W-CNTL-GEN2.
 14729
 14730     IF  DATASORI EQUAL '2'
 14731         IF  W-FILE-NOT-USED (8)
 14732             PERFORM 6450-READ-CERT-ONLY
 14733             IF  W-CERT-FOUND
 14734                 MOVE CM-AH-BENEFIT-CD
 14735                                 TO W-BEN-HOLD
 14736                                    W-CNTL-GEN2
 14737             ELSE
 14738                 NEXT SENTENCE
 14739         ELSE
 14740             MOVE CM-AH-BENEFIT-CD
 14741                                 TO W-BEN-HOLD
 14742                                    W-CNTL-GEN2
 14743     ELSE
 14744         IF  DATASORI EQUAL '4'
 14745             IF  W-FILE-NOT-USED (9)
 14746                 PERFORM 6400-READ-PNDB-ONLY
 14747                 IF  W-PNDB-FOUND
 14748                     IF  PI-689-TYPE = '1'
 14749                         MOVE PB-I-AH-BENEFIT-CD
 14750                                 TO W-BEN-HOLD
 14751                                    W-CNTL-GEN2
 14752                     ELSE
 14753                         MOVE PB-CI-AH-BENEFIT-CD
 14754                                 TO W-BEN-HOLD
 14755                                    W-CNTL-GEN2
 14756             ELSE
 14757                 NEXT SENTENCE
 14758         ELSE
 14759             IF  W-FILE-USED (8)
 14760                 MOVE CM-AH-BENEFIT-CD
 14761                                 TO W-BEN-HOLD
 14762                                    W-CNTL-GEN2
 14763             ELSE
 14764                 IF  W-FILE-USED (9)
 14765                     IF  PI-689-TYPE = '1'
 14766                         MOVE PB-I-AH-BENEFIT-CD
 14767                                 TO W-BEN-HOLD
 14768                                    W-CNTL-GEN2
 14769                     ELSE
 14770                         MOVE PB-CI-AH-BENEFIT-CD
 14771                                 TO W-BEN-HOLD
 14772                                    W-CNTL-GEN2.
 14773
 14774     IF  W-CNTL-GEN2 EQUAL SPACES
 14775         MOVE ER-9327            TO EMI-ERROR
 14776         MOVE -1                 TO MAINTL
 14777         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14778         GO TO 6800-EXIT.
 14779
 14780     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 304
* EL689.cbl
 14781     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 14782     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14783
 14784
 14785* EXEC CICS HANDLE CONDITION
 14786*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14787*         NOTFND  (6800-EXIT)
 14788*    END-EXEC.
 14789*    MOVE '"$JI                  ! 6 #00013753' TO DFHEIV0
 14790     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14792     MOVE X'3620233030303133373533' TO DFHEIV0(25:11)
 14793     CALL 'kxdfhei1' USING DFHEIV0
 14794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14795
 14796
 14797
 14798* EXEC CICS READ
 14799*         DATASET (W-CNTL-FILE-ID)
 14800*         SET     (ADDRESS OF CONTROL-FILE)
 14801*         RIDFLD  (W-CNTL-KEY)
 14802*         GTEQ
 14803*    END-EXEC.
 14804*    MOVE '&"S        G          (   #00013758' TO DFHEIV0
 14805     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14807     MOVE X'2020233030303133373538' TO DFHEIV0(25:11)
 14808     CALL 'kxdfhei1' USING DFHEIV0,
 14809           W-CNTL-FILE-ID,
 14810           DFHEIV20,
 14811           DFHEIV99,
 14812           W-CNTL-KEY,
 14813           DFHEIV99,
 14814           DFHEIV99,
 14815           DFHEIV99
 14816     SET ADDRESS OF CONTROL-FILE TO
 14817         DFHEIV20
 14818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14819
 14820
 14821     MOVE 1                      TO W-NDX.
 14822
 14823 6800-LOOP-AH.
 14824
 14825     IF  W-NDX = 9
 14826         GO TO 6800-EXIT.
 14827
 14828     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14829         ADD 1                   TO W-NDX
 14830         GO TO 6800-LOOP-AH.
 14831
 14832     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14833         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14834                                 TO W-VG-TEXT (15)
 14835         MOVE CF-BENEFIT-ALPHA (W-NDX)
 14836                                 TO W-BENEFIT-WORK
 14837         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 14838
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 305
* EL689.cbl
 14839 6800-EXIT.
 14840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 306
* EL689.cbl
 14842 6850-GET-CHECK-DATA.
 14843
 14844     IF  ADDRSI EQUAL '6'
 14845             AND
 14846         PI-CREATE-LABELS
 14847             AND
 14848         NOT PI-689-LABELS-OVERRIDEN
 14849         NEXT SENTENCE
 14850     ELSE
 14851         IF  W-FILE-NOT-USED (12)
 14852             GO TO 6850-EXIT.
 14853
 14854     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 14855         MOVE ER-9327            TO EMI-ERROR
 14856         MOVE -1                 TO MAINTL
 14857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14858         GO TO 6850-EXIT.
 14859
 14860
 14861* EXEC CICS HANDLE CONDITION
 14862*         NOTOPEN (8045-CHEK-NOT-OPEN)
 14863*         NOTFND  (6850-CHEK-NOT-FOUND)
 14864*    END-EXEC.
 14865*    MOVE '"$JI                  ! 7 #00013804' TO DFHEIV0
 14866     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14868     MOVE X'3720233030303133383034' TO DFHEIV0(25:11)
 14869     CALL 'kxdfhei1' USING DFHEIV0
 14870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14871
 14872
 14873
 14874* EXEC CICS READ
 14875*         DATASET (W-CHEK-FILE-ID)
 14876*         SET     (ADDRESS OF CHECK-RECORDS)
 14877*         RIDFLD  (W-CHEK-KEY)
 14878*    END-EXEC.
 14879*    MOVE '&"S        E          (   #00013809' TO DFHEIV0
 14880     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14881     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14882     MOVE X'2020233030303133383039' TO DFHEIV0(25:11)
 14883     CALL 'kxdfhei1' USING DFHEIV0,
 14884           W-CHEK-FILE-ID,
 14885           DFHEIV20,
 14886           DFHEIV99,
 14887           W-CHEK-KEY,
 14888           DFHEIV99,
 14889           DFHEIV99,
 14890           DFHEIV99
 14891     SET ADDRESS OF CHECK-RECORDS TO
 14892         DFHEIV20
 14893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14894
 14895
 14896     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 14897     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 14898     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 14899     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 307
* EL689.cbl
 14900                                    PI-689-CONTROL.
 14901     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 14902     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 14903
 14904     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14905     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 14906     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 14907     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 14908     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 14909     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 14910
 14911     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 14912     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14913
 14914     IF  CH-CANADIAN-POST-CODE
 14915         MOVE CH-CANADIAN-POSTAL-CODE
 14916                                 TO W-CANADIAN-POSTAL-CODES
 14917         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14918         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14919         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14920                                    W-LAB-CAN-FILLER (6)
 14921     ELSE
 14922         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14923         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14924             MOVE '-'            TO W-LABEL-DASH (6)
 14925             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14926         ELSE
 14927             MOVE SPACES         TO W-LABEL-DASH (6)
 14928                                    W-LABEL-2ND-ZIP (6).
 14929
 14930     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14931
 14932     IF  ADDRSI EQUAL '6'
 14933             AND
 14934         PI-CREATE-LABELS
 14935             AND
 14936         NOT PI-689-LABELS-OVERRIDEN
 14937         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14938                                    W-VG-TEXT (159)
 14939         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14940                                    W-VG-TEXT (160)
 14941         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14942                                    W-VG-TEXT (161)
 14943         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14944                                    W-VG-TEXT (162)
 14945         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14946                                    W-VG-TEXT (163)
 14947         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14948                                    W-VG-TEXT (164)
 14949         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14950         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14951         SET W-RG-NDX UP BY +1
 14952     ELSE
 14953         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 14954         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 14955         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 14956         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 14957         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 308
* EL689.cbl
 14958         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 14959
 14960     GO TO 6850-EXIT.
 14961
 14962 6850-CHEK-NOT-FOUND.
 14963
 14964     IF  ADDRSL GREATER ZERO
 14965         IF ADDRSI = '6'
 14966            MOVE ER-2908         TO EMI-ERROR
 14967            MOVE -1              TO ADDRSL
 14968            MOVE AL-UNBON        TO ADDRSA
 14969            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14970            GO TO 8200-SEND-DATAONLY.
 14971
 14972 6850-EXIT.
 14973     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 309
* EL689.cbl
 14975 6900-GET-PYAJ-DATA.
 14976
 14977     IF  W-FILE-NOT-USED (13)
 14978         GO TO 6900-EXIT.
 14979
 14980     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 14981         MOVE ER-9327            TO EMI-ERROR
 14982         MOVE -1                 TO MAINTL
 14983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14984         GO TO 6900-EXIT.
 14985
 14986
 14987* EXEC CICS HANDLE CONDITION
 14988*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 14989*         NOTFND  (6900-PYAJ-NOT-FOUND)
 14990*    END-EXEC.
 14991*    MOVE '"$JI                  ! 8 #00013905' TO DFHEIV0
 14992     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14994     MOVE X'3820233030303133393035' TO DFHEIV0(25:11)
 14995     CALL 'kxdfhei1' USING DFHEIV0
 14996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14997
 14998
 14999 6900-READ-NEXT.
 15000
 15001
 15002* EXEC CICS READ
 15003*         DATASET (W-PYAJ-FILE-ID)
 15004*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 15005*         RIDFLD  (W-PYAJ-KEY)
 15006*         GTEQ
 15007*    END-EXEC.
 15008*    MOVE '&"S        G          (   #00013912' TO DFHEIV0
 15009     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15011     MOVE X'2020233030303133393132' TO DFHEIV0(25:11)
 15012     CALL 'kxdfhei1' USING DFHEIV0,
 15013           W-PYAJ-FILE-ID,
 15014           DFHEIV20,
 15015           DFHEIV99,
 15016           W-PYAJ-KEY,
 15017           DFHEIV99,
 15018           DFHEIV99,
 15019           DFHEIV99
 15020     SET ADDRESS OF PENDING-PAY-ADJ TO
 15021         DFHEIV20
 15022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15023
 15024
 15025     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 15026             OR
 15027         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 15028             OR
 15029         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 15030             OR
 15031         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 15032             OR
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 310
* EL689.cbl
 15033         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 15034         GO TO 6900-PYAJ-NOT-FOUND.
 15035
 15036     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 15037             AND
 15038         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 15039         GO TO 6900-PYAJ-NOT-FOUND.
 15040
 15041     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 15042         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 15043         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 15044         GO TO 6900-READ-NEXT.
 15045
 15046     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 15047     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 15048
 15049     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 15050     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 15051
 15052     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 15053                                    PI-689-CONTROL.
 15054     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 15055     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 15056
 15057     GO TO 6900-EXIT.
 15058
 15059 6900-PYAJ-NOT-FOUND.
 15060
 15061     MOVE ER-7395                TO EMI-ERROR
 15062     MOVE -1                     TO DATASORL
 15063     MOVE AL-UNBON               TO DATASORA
 15064     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15065     GO TO 8200-SEND-DATAONLY.
 15066
 15067 6900-EXIT.
 15068     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 311
* EL689.cbl
 15070 6950-MOVE-SYSTEM-DATA.
 15071
 15072     IF  W-FILE-NOT-USED (7)
 15073         GO TO 6950-EXIT.
 15074
 15075     MOVE EIBDATE                TO W-DATE-WORK.
 15076     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 15077     MOVE '5'                    TO DC-OPTION-CODE.
 15078     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 15079     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 15080     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 15081
 15082     MOVE FORMI                  TO W-VG-TEXT (62).
 15083
 15084     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 15085         MOVE PI-689-VARIABLE-DATA-1
 15086                                 TO W-VG-TEXT (63)
 15087         MOVE PI-689-VARIABLE-DATA-2
 15088                                 TO W-VG-TEXT (64)
 15089         MOVE PI-689-VARIABLE-DATA-3
 15090                                 TO W-VG-TEXT (65)
 15091         MOVE PI-689-VARIABLE-DATA-4
 15092                                 TO W-VG-TEXT (66)
 15093     ELSE
 15094         MOVE '(VARIABLE NOT PROVIDED)'
 15095                                 TO W-VG-TEXT (63).
 15096
 15097 6950-EXIT.
 15098     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 312
* EL689.cbl
 15100 7000-FORMAT-SCREEN.
 15101
 15102     IF  MAINTI EQUAL 'S'
 15103             OR
 15104         PI-SHOW-MODE
 15105         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 15106     ELSE
 15107         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 15108
 15109     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 15110         SET W-LINE23            TO W-RG-NDX
 15111         MOVE 'A'                TO W-LINE1
 15112     ELSE
 15113         SET W-LIN-NUM           TO W-RG-NDX
 15114         COMPUTE W-LIN-NUM
 15115             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 15116
 15117     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 15118     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 15119     SET W-RG-NDX UP BY 1.
 15120
 15121 7000-EXIT.
 15122      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 313
* EL689.cbl
 15124 7100-FORMAT-LAST-NAME-1ST.
 15125*****************************************************************
 15126*             M O V E   N A M E   R O U T I N E                 *
 15127*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15128*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15129*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15130*                  FIELD                   VALUE                *
 15131*           W-NAME-LAST    (CL15)      SMITH                    *
 15132*           W-NAME-FIRST   (CL15)      JOHN                     *
 15133*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15134*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15135*     CONTAIN                                                   *
 15136*                SMITH, JOHN ALLEN                              *
 15137*     OR                                                        *
 15138*                SMITH, JOHN A.                                 *
 15139*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15140*     COPYBOOK, ELCNWA.                                         *
 15141*****************************************************************.
 15142
 15143     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15144     MOVE ZERO                   TO WS-NAME-SW.
 15145     SET NWA-INDEX               TO +1.
 15146
 15147     IF  W-NAME-LAST EQUAL SPACES
 15148             AND
 15149         W-NAME-MIDDLE EQUAL SPACES
 15150         MOVE +1                 TO WS-NAME-SW.
 15151
 15152     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15153     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15154
 15155     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15156     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15157
 15158     SET NWA-INDEX UP BY +1.
 15159
 15160     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15161         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15162             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15163             SET NWA-INDEX UP BY +1
 15164             MOVE '.'            TO WS-NW (NWA-INDEX)
 15165             SET NWA-INDEX UP BY +2
 15166         ELSE
 15167             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15168             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15169
 15170 7100-EXIT.
 15171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 314
* EL689.cbl
 15173 7110-MOVE-NAME.
 15174
 15175     IF  WS-NAME-SW GREATER THAN +1
 15176         GO TO 7110-EXIT.
 15177
 15178     IF  WS-NAME-WORK2 = SPACES
 15179         GO TO 7110-EXIT.
 15180
 15181     SET NWA-INDEX2            TO +1.
 15182     SET NWA-INDEX3            TO +2.
 15183
 15184 7110-MOVE-NAME-CYCLE.
 15185
 15186     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15187
 15188     IF  NWA-INDEX LESS THAN +30
 15189         SET NWA-INDEX UP BY +1
 15190     ELSE
 15191         ADD +2                TO WS-NAME-SW
 15192         GO TO 7110-EXIT.
 15193
 15194     IF  NWA-INDEX2 LESS THAN +20
 15195         SET NWA-INDEX3 UP BY +1
 15196         SET NWA-INDEX2 UP BY +1.
 15197
 15198     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15199             AND
 15200         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15201         IF  WS-NAME-SW EQUAL ZERO
 15202             MOVE ','            TO WS-NW (NWA-INDEX)
 15203             SET NWA-INDEX UP BY +2
 15204             MOVE +1             TO WS-NAME-SW
 15205             GO TO 7110-EXIT
 15206         ELSE
 15207             GO TO 7110-EXIT.
 15208
 15209     GO TO 7110-MOVE-NAME-CYCLE.
 15210
 15211 7110-EXIT.
 15212     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 315
* EL689.cbl
 15214 7200-FORMAT-NAME-STRAIGHT.
 15215*****************************************************************
 15216*           M O V E   N A M E   R O U T I N E                   *
 15217*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15218*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15219*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15220*                  FIELD                   VALUE                *
 15221*           W-NAME-LAST    (CL15)      SMITH                    *
 15222*           W-NAME-FIRST   (CL15)      JOHN                     *
 15223*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15224*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15225*     CONTAIN                                                   *
 15226*              JOHN A. SMITH                                    *
 15227*     OR                                                        *
 15228*              JOHN ALLEN SMITH                                 *
 15229*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15230*     COPYBOOK, ELCNWA.                                         *
 15231*****************************************************************
 15232
 15233     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15234     MOVE ZERO                   TO WS-NAME-SW.
 15235     SET NWA-INDEX               TO +1.
 15236
 15237     IF  W-NAME-FIRST EQUAL SPACES
 15238             AND
 15239         W-NAME-MIDDLE EQUAL SPACES
 15240         MOVE W-NAME-LAST        TO WS-NAME-WORK
 15241         GO TO 7200-EXIT.
 15242
 15243     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15244     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15245
 15246     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15247         SET NWA-INDEX UP BY +1
 15248
 15249         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15250             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15251             SET NWA-INDEX UP BY +1
 15252             MOVE '.'            TO WS-NW (NWA-INDEX)
 15253             SET NWA-INDEX UP BY +1
 15254
 15255         ELSE
 15256             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15257             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15258
 15259     SET NWA-INDEX UP BY +1
 15260     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15261     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15262
 15263 7200-EXIT.
 15264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 316
* EL689.cbl
 15266 7290-MOVE-NAME.
 15267
 15268     IF  WS-NAME-SW GREATER THAN +1
 15269         GO TO 7290-EXIT.
 15270
 15271     IF  WS-NAME-WORK2 EQUAL SPACES
 15272         GO TO 7290-EXIT.
 15273
 15274     SET NWA-INDEX2            TO +1.
 15275     SET NWA-INDEX3            TO +2.
 15276
 15277 7290-MOVE-NAME-CYCLE.
 15278
 15279     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15280
 15281     IF  NWA-INDEX LESS THAN +30
 15282         SET NWA-INDEX UP BY +1
 15283     ELSE
 15284         ADD +2                TO WS-NAME-SW
 15285         GO TO 7290-EXIT.
 15286
 15287     IF  NWA-INDEX2 LESS THAN +20
 15288         SET NWA-INDEX2 UP BY +1
 15289         SET NWA-INDEX3 UP BY +1.
 15290
 15291     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15292             AND
 15293         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15294         GO TO 7290-EXIT.
 15295
 15296     GO TO 7290-MOVE-NAME-CYCLE.
 15297
 15298 7290-EXIT.
 15299     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 317
* EL689.cbl
 15301 7300-LABEL-MOVE.
 15302
 15303     IF  W-LABEL-HOLD-AREA = SPACES
 15304         MOVE +0                 TO W-NUMB-LABEL-LINES
 15305         GO TO 7300-EXIT.
 15306
 15307     IF  W-LABEL-LINES (1) = SPACES
 15308         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 15309         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15310         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15311         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15312         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15313         MOVE SPACES             TO W-LABEL-LINES (6)
 15314         GO TO 7300-LABEL-MOVE.
 15315
 15316     IF  W-LABEL-LINES (2) = SPACES
 15317             AND
 15318         W-LABEL-LINES (3) = SPACES
 15319             AND
 15320         W-LABEL-LINES (4) = SPACES
 15321             AND
 15322         W-LABEL-LINES (5) = SPACES
 15323             AND
 15324         W-LABEL-LINES (6) = SPACES
 15325         MOVE 1                  TO W-NDX
 15326                                    W-NUMB-LABEL-LINES
 15327         GO TO 7300-EXIT.
 15328
 15329 7300-TRY-2.
 15330
 15331     IF  W-LABEL-LINES (2) = SPACES
 15332         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15333         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15334         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15335         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15336         MOVE SPACES             TO W-LABEL-LINES (6)
 15337         GO TO 7300-TRY-2.
 15338
 15339     IF  W-LABEL-LINES (3) = SPACES
 15340             AND
 15341         W-LABEL-LINES (4) = SPACES
 15342             AND
 15343         W-LABEL-LINES (5) = SPACES
 15344             AND
 15345         W-LABEL-LINES (6) = SPACES
 15346         MOVE 2                  TO W-NDX
 15347         GO TO 7300-MOVE-ZIP.
 15348
 15349 7300-TRY-3.
 15350
 15351     IF  W-LABEL-LINES (3) = SPACES
 15352         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15353         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15354         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15355         MOVE SPACES             TO W-LABEL-LINES (6)
 15356         GO TO 7300-TRY-3.
 15357
 15358     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 318
* EL689.cbl
 15359             AND
 15360         W-LABEL-LINES (5) = SPACES
 15361             AND
 15362         W-LABEL-LINES (6) = SPACES
 15363         MOVE 3                   TO W-NDX
 15364         GO TO 7300-MOVE-ZIP.
 15365
 15366 7300-TRY-4.
 15367
 15368     IF  W-LABEL-LINES (4) = SPACES
 15369         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15370         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15371         MOVE SPACES             TO W-LABEL-LINES (6)
 15372         GO TO 7300-TRY-4.
 15373
 15374     IF  W-LABEL-LINES (5) = SPACES
 15375             AND
 15376         W-LABEL-LINES (6) = SPACES
 15377         MOVE 4                  TO W-NDX
 15378         GO TO 7300-MOVE-ZIP.
 15379
 15380 7300-TRY-5.
 15381
 15382     IF  W-LABEL-LINES (5) = SPACES
 15383         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15384         MOVE SPACES             TO W-LABEL-LINES (6)
 15385         GO TO 7300-TRY-5
 15386     ELSE
 15387         IF  W-LABEL-LINES (6) = SPACES
 15388             MOVE 5              TO W-NDX
 15389             GO TO 7300-MOVE-ZIP
 15390         ELSE
 15391             MOVE 6              TO W-NDX.
 15392
 15393 7300-MOVE-ZIP.
 15394
 15395     COMPUTE W-NDX2 = W-NDX - 1.
 15396
 15397     IF  W-LAST-ZIP (W-NDX2) = SPACES
 15398*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 15399
 15400         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 15401                 MOVE W-LABEL-ZIP (W-NDX)
 15402                                 TO W-LAST-ZIP (W-NDX2)
 15403                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 15404                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 15405                 GO TO 7300-EXIT.
 15406
 15407     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 15408
 15409 7300-EXIT.
 15410     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 319
* EL689.cbl
 15412 7400-CREATE-LETTER.
 15413****************************************************************
 15414*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 15415*    RECORDS.                                                  *
 15416****************************************************************
 15417
 15418     SET W-SQ-NDX                TO W-START-COLUMN.
 15419     MOVE SPACES                 TO W-SQUEEZED-LINE
 15420                                    W-WORK-LINE.
 15421     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 15422     MOVE +1                     TO W-LAST-WC-SPACE.
 15423     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 15424
 15425     SET W-TG-NDX                TO +1.
 15426
 15427     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 15428            VARYING
 15429         W-TG-NDX FROM W-TG-NDX BY +1
 15430            UNTIL
 15431         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 15432
 15433     IF  W-FORM-SQUEEZE-ON
 15434             AND
 15435         W-SQUEEZED-LINE GREATER THAN SPACES
 15436         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 15437
 15438     PERFORM 7640-PAGING THRU 7640-EXIT.
 15439
 15440 7400-EXIT.
 15441     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 320
* EL689.cbl
 15443 7410-TEXT-LINE-PROCESS.
 15444***************************************************************
 15445*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 15446*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 15447*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 15448*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 15449*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 15450*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 15451***************************************************************
 15452
 15453
 15454     SET W-WC-NDX                TO W-ZEROS.
 15455     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15456
 15457     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 15458
 15459     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 15460             VARYING
 15461         W-TX-NDX FROM +1 BY +1
 15462             UNTIL
 15463         W-TX-NDX GREATER THAN +70.
 15464
 15465****************************************************************
 15466*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 15467*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 15468*    LINE SQUEEZE CONTROL.                                     *
 15469****************************************************************
 15470     IF  W-FORM-SQUEEZE-ON
 15471
 15472         IF  W-WORK-LINE GREATER THAN SPACES
 15473                 OR
 15474             W-AS-IS
 15475             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15476
 15477         ELSE
 15478             NEXT SENTENCE
 15479****************************************************************
 15480*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 15481*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 15482****************************************************************
 15483     ELSE
 15484         IF  W-WORK-LINE GREATER THAN SPACES
 15485             MOVE W-TX-PC (W-TG-NDX)
 15486                                 TO W-PRINT-CONTROL
 15487             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 15488             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15489             MOVE SPACES         TO W-WORK-LINE.
 15490
 15491 7410-EXIT.
 15492     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 321
* EL689.cbl
 15494 7420-TEXT-CHAR-PROCESS.
 15495****************************************************************
 15496*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 15497*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 15498*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 15499*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 15500****************************************************************
 15501
 15502     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 15503             AND
 15504         W-LAST-CHAR EQUAL '@'
 15505         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 15506
 15507     SET W-WC-NDX UP BY +1.
 15508
 15509     IF  W-WC-NDX GREATER THAN +70
 15510         IF  W-FORM-SQUEEZE-ON
 15511                 AND
 15512             NOT W-AS-IS
 15513             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 15514                     VARYING
 15515                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 15516                     UNTIL
 15517                 W-WC-NDX EQUAL +71
 15518             SET W-TX-NDX        TO W-LAST-TX-SPACE
 15519
 15520             IF  W-WORK-LINE GREATER THAN SPACES
 15521                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15522                 MOVE SPACES     TO W-WORK-LINE
 15523                                    W-LINE-SQUEEZE-IND
 15524                 SET W-WC-NDX    TO +1
 15525             ELSE
 15526                 SET W-WC-NDX    TO +1
 15527         ELSE
 15528             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 15529
 15530     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15531                                 TO W-CHARACTER-TYPE.
 15532
 15533     SET W-WC-NDX2               TO W-WC-NDX.
 15534     SET W-WC-NDX2 DOWN BY +1.
 15535
 15536     IF  W-PUNCTUATION
 15537             AND
 15538         W-WC-NDX2 GREATER THAN W-ZEROS
 15539             AND
 15540         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 15541         SET W-WC-NDX DOWN BY +1.
 15542
 15543     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15544                                 TO W-LAST-CHAR
 15545                                    W-WORK-CHAR (W-WC-NDX).
 15546
 15547     IF  W-LAST-CHAR EQUAL SPACES
 15548         SET W-LAST-WC-SPACE     TO W-WC-NDX
 15549         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 15550
 15551 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 322
* EL689.cbl
 15552     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 323
* EL689.cbl
 15554 7430-PROCESS-VARIABLE.
 15555******************************************************************
 15556*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 15557*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 15558*    ITS CORRESPONDING VALUES.                                   *
 15559******************************************************************
 15560
 15561     SET W-TX-NDX UP BY +1.
 15562
 15563     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15564         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15565                                 TO W-V1
 15566         SET W-TX-NDX UP BY +1
 15567
 15568         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15569             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15570                                 TO W-V2
 15571             SET W-TX-NDX UP BY +1
 15572             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15573                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15574                                 TO W-V3
 15575                 SET W-TX-NDX UP BY +1
 15576                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15577                                 TO W-FIELD-SQUEEZE-IND
 15578                 GO TO 7430-CONTINUE
 15579             ELSE
 15580                 SET W-TX-NDX DOWN BY +3
 15581                 MOVE ER-0180    TO EMI-ERROR
 15582                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15583                 MOVE -1         TO MAINTL
 15584                 MOVE HIGH-VALUES
 15585                                 TO W-LAST-CHAR
 15586         ELSE
 15587             SET W-TX-NDX DOWN BY +2
 15588             MOVE ER-0180        TO EMI-ERROR
 15589             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15590             MOVE -1             TO MAINTL
 15591             MOVE HIGH-VALUES    TO W-LAST-CHAR
 15592     ELSE
 15593         SET W-TX-NDX DOWN BY +1
 15594         MOVE ER-7246            TO EMI-ERROR
 15595         MOVE -1                 TO MAINTL
 15596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15597         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 15598
 15599****************************************************************
 15600*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 15601*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 15602*    ACTION.                                                   *
 15603****************************************************************
 15604
 15605     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15606         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15607         GO TO 7430-EXIT
 15608     ELSE
 15609         GO TO 7430-EXIT.
 15610
 15611 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 324
* EL689.cbl
 15612
 15613     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 15614             OR
 15615         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 15616         SET W-TX-NDX DOWN BY +4
 15617         MOVE ER-0180            TO EMI-ERROR
 15618         MOVE -1                 TO MAINTL
 15619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15620         MOVE HIGH-VALUES        TO W-LAST-CHAR
 15621         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15622             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15623             GO TO 7430-EXIT
 15624         ELSE
 15625             GO TO 7430-EXIT.
 15626
 15627     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 15628
 15629     SET W-WC-NDX DOWN BY +1.
 15630
 15631     IF  (W-FORM-SQUEEZE-OFF
 15632                 AND
 15633             NOT W-SQUEEZE-FIELD)
 15634             OR
 15635         (W-FORM-SQUEEZE-ON
 15636                 AND
 15637             W-AS-IS)
 15638         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 15639                 VARYING
 15640             W-VC-NDX FROM +1 BY +1
 15641                 UNTIL
 15642             W-VC-NDX GREATER THAN
 15643                 W-VARIABLE-SIZE (W-VG-NDX)
 15644
 15645         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 15646             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15647             SET W-TX-NDX DOWN BY +5
 15648             IF  W-TX-NDX GREATER THAN +70
 15649                 SET W-TX-NDX    TO +70
 15650                 GO TO 7430-EXIT
 15651             ELSE
 15652                 GO TO 7430-EXIT
 15653         ELSE
 15654             COMPUTE W-ADJUST-SHORT
 15655                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 15656             SET W-WC-NDX UP BY W-ADJUST-SHORT
 15657             GO TO 7430-EXIT.
 15658
 15659     IF  W-SQUEEZE-FIELD
 15660         SET W-TX-NDX UP BY +1.
 15661
 15662     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 15663
 15664     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 15665             VARYING
 15666         W-VC-NDX FROM +1 BY +1
 15667             UNTIL
 15668         W-VC-NDX GREATER THAN
 15669             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 325
* EL689.cbl
 15670
 15671     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15672
 15673     IF  W-FORM-SQUEEZE-ON
 15674         GO TO 7430-EXIT.
 15675
 15676     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 15677         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15678         SET W-TX-NDX DOWN BY +6
 15679         IF  W-TX-NDX GREATER THAN +70
 15680             SET W-TX-NDX        TO +70.
 15681
 15682     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15683         SET W-WC-NDX DOWN BY +1.
 15684
 15685 7430-EXIT.
 15686     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 326
* EL689.cbl
 15688 7435-MOVE-VARIABLE-DIRECT.
 15689
 15690     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15691             AND
 15692         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15693             AND
 15694         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15695             AND
 15696         (W-VC-NDX GREATER THAN +1
 15697                 AND
 15698             W-LAST-CHAR NOT EQUAL SPACE
 15699                 AND
 15700             NOT W-LAST-CHAR-PUNC)
 15701         IF  W-LC-USE-BOTH-CASES
 15702             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15703                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15704         ELSE
 15705             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15706                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15707
 15708     SET W-WC-NDX UP BY +1.
 15709     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15710                                 TO W-WORK-CHAR (W-WC-NDX)
 15711                                    W-LAST-CHAR.
 15712
 15713 7435-EXIT.
 15714     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 327
* EL689.cbl
 15716 7437-FIND-NEXT-CHARACTER.
 15717*DELIBERATELY LEFT BLANK.
 15718 7437-EXIT.
 15719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 328
* EL689.cbl
 15721 7440-BACK-TO-NEAREST-WORD.
 15722
 15723     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 15724
 15725 7440-EXIT.
 15726     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 329
* EL689.cbl
 15728 7450-SQUEEZING.
 15729
 15730     IF  W-NEW-PARAGRAPH
 15731         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 15732         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 15733         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15734             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15735             MOVE W-TX-PC (W-TG-NDX)
 15736                                 TO W-PRINT-CONTROL
 15737             MOVE SPACES         TO W-SQUEEZED-LINE
 15738             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15739             SET W-SQ-NDX UP BY W-WORK-INDENT
 15740         ELSE
 15741             MOVE W-TX-PC (W-TG-NDX)
 15742                                 TO W-PRINT-CONTROL
 15743             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15744             SET W-SQ-NDX UP BY W-WORK-INDENT
 15745     ELSE
 15746         IF  W-DO-NOT-ADJUST
 15747             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 15748             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15749                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15750                 MOVE W-WORK-LINE
 15751                                 TO W-SQUEEZED-LINE
 15752                 MOVE W-TX-PC (W-TG-NDX)
 15753                                 TO W-PRINT-CONTROL
 15754                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15755                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15756                 MOVE SPACES     TO W-SQUEEZED-LINE
 15757                 GO TO 7450-EXIT
 15758             ELSE
 15759                 MOVE W-WORK-LINE
 15760                                 TO W-SQUEEZED-LINE
 15761                 MOVE W-TX-PC (W-TG-NDX)
 15762                                 TO W-PRINT-CONTROL
 15763                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15764                 MOVE SPACES     TO W-SQUEEZED-LINE
 15765                                    W-WORK-LINE
 15766                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15767                 GO TO 7450-EXIT
 15768         ELSE
 15769             IF  W-ADJUST-TO-LINE-LENGTH
 15770                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 15771
 15772                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15773                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15774                     SET W-SQ-NDX
 15775                                 TO W-INITIAL-COLUMN
 15776                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15777                             VARYING
 15778                         W-WC-NDX FROM 1 BY 1
 15779                             UNTIL
 15780                         W-SQ-NDX EQUAL W-TOO-FAR
 15781                     MOVE W-TX-PC (W-TG-NDX)
 15782                                 TO W-PRINT-CONTROL
 15783                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15784                     SET W-SQ-NDX
 15785                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 330
* EL689.cbl
 15786                     MOVE SPACES TO W-SQUEEZED-LINE
 15787                                    W-WORK-LINE
 15788                     GO TO 7450-EXIT
 15789                 ELSE
 15790                     SET W-SQ-NDX
 15791                                 TO W-INITIAL-COLUMN
 15792                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15793                             VARYING
 15794                         W-WC-NDX FROM 1 BY 1
 15795                             UNTIL
 15796                         W-SQ-NDX EQUAL W-TOO-FAR
 15797                     MOVE W-TX-PC (W-TG-NDX)
 15798                                 TO W-PRINT-CONTROL
 15799                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15800                     MOVE SPACES TO W-SQUEEZED-LINE
 15801                                    W-WORK-LINE
 15802                     SET W-SQ-NDX
 15803                                 TO W-INITIAL-COLUMN
 15804                     GO TO 7450-EXIT
 15805             ELSE
 15806                 IF  W-CONTINUE-PARAGRAPH
 15807                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15808                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15809                         PERFORM 7610-SET-CONP-INDENT
 15810                             THRU 7610-EXIT
 15811                         MOVE SPACES
 15812                                 TO W-LINE-SQUEEZE-IND
 15813                         MOVE W-TX-PC (W-TG-NDX)
 15814                                 TO W-PRINT-CONTROL
 15815                         MOVE SPACES
 15816                                 TO W-SQUEEZED-LINE
 15817                         SET W-SQ-NDX
 15818                                 TO W-INITIAL-COLUMN
 15819                         SET W-SQ-NDX UP BY W-WORK-INDENT
 15820                     ELSE
 15821                         PERFORM 7610-SET-CONP-INDENT
 15822                             THRU 7610-EXIT
 15823                         MOVE SPACES
 15824                                 TO W-LINE-SQUEEZE-IND
 15825                         MOVE W-TX-PC (W-TG-NDX)
 15826                                 TO W-PRINT-CONTROL
 15827                         MOVE SPACES
 15828                                 TO W-SQUEEZED-LINE
 15829                         SET W-SQ-NDX
 15830                                 TO W-INITIAL-COLUMN
 15831                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 15832
 15833
 15834     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 15835             VARYING
 15836         W-WC-NDX FROM +1 BY +1
 15837             UNTIL
 15838         W-WC-NDX GREATER THAN +70.
 15839
 15840 7450-EXIT.
 15841     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 331
* EL689.cbl
 15843 7460-REMAIN-CHAR-CHECK.
 15844
 15845     IF  W-TX-NDX EQUAL W-WC-NDX
 15846         MOVE W-TX-PC (W-TG-NDX)
 15847                                 TO W-PRINT-CONTROL
 15848         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 15849         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15850         MOVE SPACES             TO W-WORK-LINE
 15851         SET W-WC-NDX            TO +1
 15852     ELSE
 15853         SET W-TX-NDX1           TO W-TX-NDX
 15854         SEARCH W-TX-CHAR
 15855             VARYING W-TX-NDX1
 15856             AT END
 15857                 MOVE W-TX-PC (W-TG-NDX)
 15858                                 TO W-PRINT-CONTROL
 15859                 MOVE W-WORK-LINE
 15860                                 TO W-SQUEEZED-LINE
 15861                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15862                 MOVE SPACES     TO W-WORK-LINE
 15863                 SET W-WC-NDX    TO +1
 15864                 SET W-TX-NDX    TO +1
 15865                 SET W-TG-NDX UP BY +1
 15866             WHEN
 15867                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 15868                 MOVE ER-9427    TO EMI-ERROR
 15869                 MOVE -1         TO MAINTL
 15870                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15871                 MOVE W-TX-PC (W-TG-NDX)
 15872                                 TO W-PRINT-CONTROL
 15873                 MOVE W-WORK-LINE
 15874                                 TO W-SQUEEZED-LINE
 15875                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15876                 MOVE SPACES     TO W-WORK-LINE
 15877                 SET W-WC-NDX    TO +1.
 15878
 15879 7460-EXIT.
 15880     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 332
* EL689.cbl
 15882 7470-MOVE-CHAR.
 15883
 15884     IF  W-FIRST-CHAR-NOT-FOUND
 15885             AND
 15886         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15887         MOVE SPACES             TO W-LAST-CHAR
 15888         GO TO 7470-EXIT.
 15889
 15890     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 15891
 15892     IF  W-SQUEEZE-FIELD
 15893             AND
 15894         W-LAST-CHAR EQUAL SPACES
 15895             AND
 15896         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15897         GO TO 7470-EXIT.
 15898
 15899     SET W-WC-NDX UP BY +1.
 15900
 15901     IF  W-WC-NDX GREATER THAN +70
 15902         IF  W-FORM-SQUEEZE-ON
 15903             GO TO 7470-EXIT
 15904         ELSE
 15905             MOVE ER-9427        TO EMI-ERROR
 15906             MOVE -1             TO MAINTL
 15907             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15908             GO TO 7470-EXIT.
 15909
 15910     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15911             AND
 15912         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15913             AND
 15914         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15915             AND
 15916         (W-VC-NDX GREATER THAN +1
 15917                 AND
 15918             W-LAST-CHAR NOT EQUAL SPACE
 15919                 AND
 15920             NOT W-LAST-CHAR-PUNC)
 15921         IF  W-LC-USE-BOTH-CASES
 15922             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15923                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15924         ELSE
 15925             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15926                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15927
 15928     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15929                                 TO W-WORK-CHAR (W-WC-NDX)
 15930                                    W-LAST-CHAR.
 15931
 15932     IF  W-LAST-CHAR EQUAL SPACES
 15933         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 15934
 15935 7470-EXIT.
 15936     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 333
* EL689.cbl
 15938 7480-UPDATE-SQUEEZED-LINE.
 15939****************************************************************
 15940*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 15941*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 15942*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 15943*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 15944*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 15945*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 15946****************************************************************
 15947
 15948     SET W-SQ-NDX UP BY +1.
 15949
 15950     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 15951         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 15952                                 TO W-CHARACTER-TYPE
 15953         IF  W-PUNCTUATION
 15954                 OR
 15955             W-SPACE
 15956             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 15957             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15958             MOVE SPACES         TO W-SQUEEZED-LINE
 15959             SET W-SQ-NDX        TO W-START-COLUMN
 15960             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15961             SET W-LAST-SQUEEZED-SPACE
 15962                                 TO W-SQ-NDX
 15963         ELSE
 15964             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 15965             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15966             MOVE SPACES         TO W-SQUEEZED-LINE
 15967             SET W-SQ-NDX        TO W-START-COLUMN
 15968             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15969             SET W-LAST-SQUEEZED-SPACE
 15970                                 TO W-SQ-NDX.
 15971
 15972     IF  W-WC-NDX GREATER THAN +70
 15973         GO TO 7480-EXIT.
 15974
 15975     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 15976
 15977     IF  W-END-OF-SENTENCE
 15978         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 15979         SET W-WORK-NDX          TO W-SQ-NDX
 15980         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 15981         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 15982             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 15983         ELSE
 15984             NEXT SENTENCE
 15985     ELSE
 15986         IF  W-PUNCTUATION
 15987                 AND
 15988             W-LAST-SQ-CHAR EQUAL SPACES
 15989             SET W-SQ-NDX DOWN BY +1
 15990             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 15991         ELSE
 15992             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15993                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 15994                     IF  W-END-OF-SENTENCE-WORKING
 15995                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 334
* EL689.cbl
 15996                                 TO W-END-OF-SENTENCE-IND
 15997                         SET W-LAST-SQUEEZED-SPACE
 15998                                 TO W-SQ-NDX
 15999                     ELSE
 16000                         SET W-SQ-NDX DOWN BY +1
 16001                         GO TO 7480-EXIT
 16002                 ELSE
 16003                     SET W-LAST-SQUEEZED-SPACE
 16004                                 TO W-SQ-NDX
 16005             ELSE
 16006                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 16007
 16008     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 16009                                    W-LAST-SQ-CHAR.
 16010
 16011     IF  W-WC-NDX EQUAL +70
 16012             AND
 16013         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 16014             AND
 16015         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 16016         SET W-SQ-NDX UP BY +1
 16017         SET W-LAST-SQUEEZED-SPACE
 16018                                 TO W-SQ-NDX
 16019         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 16020                                    W-LAST-SQ-CHAR.
 16021
 16022 7480-EXIT.
 16023     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 335
* EL689.cbl
 16025 7485-FIND-NEXT-CHARACTER.
 16026
 16027     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16028
 16029     IF  W-PUNCTUATION
 16030         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16031     ELSE
 16032         SET W-WC-NDX            TO W-WC-NDX
 16033         SEARCH W-WORK-CHAR
 16034             VARYING W-WC-NDX
 16035             AT END
 16036                 GO TO 7485-EXIT
 16037             WHEN
 16038                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 16039                 GO TO 7485-EXIT.
 16040
 16041 7485-EXIT.
 16042     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 336
* EL689.cbl
 16044 7490-REMOVE-LAST-WORD.
 16045
 16046*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 16047     IF  W-WC-NDX EQUAL +1
 16048         GO TO 7490-EXIT.
 16049
 16050     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 16051
 16052     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 16053             VARYING
 16054         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 16055             UNTIL
 16056         W-SQ-NDX EQUAL W-TOO-FAR.
 16057
 16058     SET W-WORK-NDX              TO W-WC-NDX.
 16059     COMPUTE W-LAST-WC-SPACE
 16060         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 16061     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 16062
 16063 7490-EXIT.
 16064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 337
* EL689.cbl
 16066 7500-CLEAR-SQUEEZED-EXCESS.
 16067
 16068     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 16069
 16070 7500-EXIT.
 16071     EXIT.
 16072
 16073 7505-MOVE-STRAIGHT.
 16074
 16075     SET W-SQ-NDX UP BY +1.
 16076
 16077     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 16078
 16079 7505-EXIT.
 16080     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 338
* EL689.cbl
 16082 7510-MOVE-TO-TABLE.
 16083
 16084     IF  W-PRINT-CONTROL NOT NUMERIC
 16085         MOVE 00                 TO W-PRINT-CONTROL
 16086         ADD +1                  TO W-LINE-COUNT
 16087     ELSE
 16088         IF  W-PRINT-CONTROL EQUAL 99
 16089             PERFORM 7640-PAGING THRU 7640-EXIT
 16090             MOVE 00             TO W-PRINT-CONTROL
 16091             SET W-RG-NDX UP BY +1
 16092             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 16093             MOVE +1             TO W-LINE-COUNT
 16094             SET W-RG-NDX UP BY W-TOP-MARGIN
 16095         ELSE
 16096           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 16097             COMPUTE W-LINE-COUNT
 16098                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 16099
 16100     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 16101         PERFORM 7640-PAGING THRU 7640-EXIT
 16102         MOVE 00                 TO W-PRINT-CONTROL
 16103         SET W-RG-NDX UP BY +1
 16104         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 16105         SET W-RG-NDX UP BY W-TOP-MARGIN
 16106         MOVE +1                 TO W-LINE-COUNT.
 16107
 16108     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 16109     SET W-RG-NDX UP BY +1.
 16110     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 16111     MOVE 00                     TO W-PRINT-CONTROL.
 16112
 16113     IF  W-FIRST-BAD-VARIABLE-FOUND
 16114             AND
 16115         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 16116         SET W-FIRST-BAD-VARIABLE
 16117                                 TO W-RG-NDX.
 16118
 16119 7510-EXIT.
 16120     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 339
* EL689.cbl
 16122 7600-SET-PARA-INDENT.
 16123
 16124     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 16125         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 16126     ELSE
 16127     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 16128         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16129         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16130     ELSE
 16131     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 16132         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16133         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16134     ELSE
 16135     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 16136         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16137         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16138     ELSE
 16139     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 16140         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16141         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16142     ELSE
 16143     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 16144         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 16145         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 16146
 16147     SET W-TG-NDX2               TO W-TG-NDX.
 16148     SET W-TG-NDX2 UP BY +1.
 16149
 16150     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16151         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16152     ELSE
 16153         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16154
 16155 7600-EXIT.
 16156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 340
* EL689.cbl
 16158 7610-SET-CONP-INDENT.
 16159
 16160     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 16161         MOVE +0                 TO W-WORK-INDENT
 16162     ELSE
 16163     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 16164         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16165     ELSE
 16166     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 16167         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16168     ELSE
 16169     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 16170         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16171     ELSE
 16172     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 16173         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16174     ELSE
 16175     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 16176         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 16177
 16178     SET W-TG-NDX2               TO W-TG-NDX.
 16179     SET W-TG-NDX2 UP BY +1.
 16180
 16181     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16182         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16183     ELSE
 16184         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16185
 16186 7610-EXIT.
 16187     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 341
* EL689.cbl
 16189 7630-NEXT-LINE.
 16190
 16191     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 16192         MOVE ZEROS              TO W-NEXT-INDENT
 16193     ELSE
 16194     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 16195         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 16196     ELSE
 16197     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 16198         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 16199     ELSE
 16200     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 16201         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 16202     ELSE
 16203     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 16204         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 16205     ELSE
 16206     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 16207         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 16208     ELSE
 16209         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16210         SUBTRACT W-PARAGRAPH-INDENT
 16211                                  FROM W-NEXT-INDENT.
 16212
 16213 7630-EXIT.
 16214     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 342
* EL689.cbl
 16216 7640-PAGING.
 16217
 16218     IF  NOT W-LC-CREATE-PAGES
 16219         GO TO 7640-EXIT.
 16220
 16221     IF  W-LINE-COUNT GREATER ZEROS
 16222             AND
 16223         W-RG-NDX GREATER THAN +1
 16224         ADD +1                  TO W-PAGE
 16225         MOVE W-PAGE             TO W-PAGE-NUMBER
 16226         COMPUTE W-PAGE-LINE
 16227             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 16228         IF  W-PAGE-LINE GREATER THAN +2
 16229             SET W-RG-NDX UP BY W-PAGE-LINE
 16230             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 16231         ELSE
 16232             SET W-RG-NDX UP BY +2
 16233             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 16234
 16235 7640-EXIT.
 16236     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 343
* EL689.cbl
 16238 7700-READ-TEXT-TS.
 16239**************************************************************
 16240*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 16241*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 16242*  AND EL1042.                                               *
 16243**************************************************************
 16244
 16245
 16246* EXEC CICS HANDLE CONDITION
 16247*         QIDERR     (7700-TS-ERROR)
 16248*         ITEMERR    (7700-TS-ERROR)
 16249*    END-EXEC.
 16250*    MOVE '"$N<                  ! 9 #00015139' TO DFHEIV0
 16251     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 16252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16253     MOVE X'3920233030303135313339' TO DFHEIV0(25:11)
 16254     CALL 'kxdfhei1' USING DFHEIV0
 16255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16256
 16257
 16258     SET W-TS-NDX                TO 1.
 16259     MOVE 1                      TO W-TS-ITEM.
 16260
 16261 7700-LOOP.
 16262
 16263     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 16264         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 16265             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16266             GO TO 7700-EXIT
 16267         ELSE
 16268             GO TO 7700-EXIT.
 16269
 16270
 16271* EXEC CICS READQ TS
 16272*         INTO     (W-TS-WORK-AREA)
 16273*         QUEUE    (W-TS-NAME-TEXT)
 16274*         LENGTH   (W-TS-LENGTH)
 16275*         ITEM     (W-TS-ITEM)
 16276*    END-EXEC.
 16277*    MOVE '*$II   L              ''   #00015156' TO DFHEIV0
 16278     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16279     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16280     MOVE X'2020233030303135313536' TO DFHEIV0(25:11)
 16281     CALL 'kxdfhei1' USING DFHEIV0,
 16282           W-TS-NAME-TEXT,
 16283           W-TS-WORK-AREA,
 16284           W-TS-LENGTH,
 16285           W-TS-ITEM,
 16286           DFHEIV99,
 16287           DFHEIV99
 16288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16289
 16290
 16291     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 16292     SET W-TS-NDX UP BY 1.
 16293     ADD 1                       TO W-TS-ITEM.
 16294     GO TO 7700-LOOP.
 16295
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 344
* EL689.cbl
 16296 7700-TS-ERROR.
 16297
 16298     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 16299         MOVE ER-0033            TO EMI-ERROR
 16300         MOVE -1                 TO MAINTL
 16301         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16302         GO TO 8200-SEND-DATAONLY.
 16303
 16304 7700-EXIT.
 16305      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 345
* EL689.cbl
 16307 7740-RESTORE-SCREEN.
 16308
 16309     MOVE 'C'                    TO MAINTI.
 16310     MOVE +1                     TO MAINTL.
 16311     MOVE AL-UANON               TO MAINTA.
 16312
 16313     MOVE PI-689-FORM-NUMBER     TO FORMI.
 16314     MOVE +4                     TO FORML.
 16315     MOVE AL-UANON               TO FORMA.
 16316
 16317*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 16318*        MOVE PI-689-PRINT-RESTRICTION
 16319*                                TO PRTRESTL
 16320*        MOVE +1                 TO PRTRESTL
 16321*        MOVE AL-UANON           TO PRTRESTA.
 16322
 16323     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 16324         MOVE PI-689-FOLLOW-UP-EDIT
 16325                                 TO FOLLOWI
 16326         MOVE +8                 TO FOLLOWL
 16327         MOVE AL-UANON           TO FOLLOWA.
 16328
 16329     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 16330         MOVE PI-689-RESEND1-EDIT
 16331                                 TO RESEND1I
 16332         MOVE +8                 TO RESEND1L
 16333         MOVE AL-UANON           TO RESEND1A.
 16334     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 16335         MOVE PI-689-ALT-PRINTER-ID
 16336                                 TO PRINTERI
 16337         MOVE +1                 TO PRINTERL
 16338         MOVE AL-UANON           TO PRINTERA.
 16339
 16340     IF  PI-BYPASS-LABELS
 16341          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 16342          MOVE +1                TO ADDRLBLL
 16343          MOVE AL-UANON          TO ADDRLBLA
 16344     ELSE
 16345          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 16346               MOVE PI-689-LBL-OVERRIDE
 16347                                 TO ADDRLBLI
 16348               MOVE +1           TO ADDRLBLL
 16349               MOVE AL-UANON     TO ADDRLBLA.
 16350
 16351     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 16352         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 16353         MOVE +1                     TO COPIESL
 16354         MOVE AL-UNNON               TO COPIESA.
 16355
 16356     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 16357         MOVE PI-689-LABEL-SOURCE
 16358                                 TO ADDRSI
 16359         MOVE +1                 TO ADDRSL
 16360         MOVE AL-UANON           TO ADDRSA.
 16361
 16362     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 16363     MOVE +1                     TO DATASORL.
 16364     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 346
* EL689.cbl
 16365
 16366     IF  PI-689-CARRIER GREATER THAN SPACES
 16367         MOVE PI-689-CARRIER     TO CARRIERI
 16368         MOVE +1                 TO CARRIERL
 16369         MOVE AL-UANON           TO CARRIERA.
 16370
 16371     IF  PI-689-GROUPING GREATER THAN SPACES
 16372         MOVE PI-689-GROUPING    TO GROUPI
 16373         MOVE +6                 TO GROUPL
 16374         MOVE AL-UANON           TO GROUPA.
 16375
 16376     IF  PI-689-STATE GREATER THAN SPACES
 16377         MOVE PI-689-STATE       TO STATEI
 16378         MOVE +2                 TO STATEL
 16379         MOVE AL-UANON           TO STATEA.
 16380
 16381     IF  PI-689-ACCOUNT GREATER THAN SPACES
 16382         MOVE PI-689-ACCOUNT     TO ACCTI
 16383         MOVE +10                TO ACCTL
 16384         MOVE AL-UANON           TO ACCTA.
 16385
 16386     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16387         MOVE PI-689-CERT-PRIME  TO CERTI
 16388         MOVE +10                TO CERTL
 16389         MOVE AL-UANON           TO CERTA.
 16390
 16391     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16392         MOVE PI-689-CERT-SFX    TO SFXI
 16393         MOVE +1                 TO SFXL
 16394         MOVE AL-UANON           TO SFXA.
 16395
 16396     IF  PI-689-TYPE GREATER THAN SPACES
 16397         MOVE PI-689-TYPE        TO TYPEI
 16398         MOVE +1                 TO TYPEL
 16399         MOVE AL-UANON           TO TYPEA.
 16400
 16401     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 16402         MOVE PI-689-RESP-PERSON TO RPERSONI
 16403         MOVE +10                TO RPERSONL
 16404         MOVE AL-UANON           TO RPERSONA.
 16405
 16406     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 16407         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 16408         MOVE +6                 TO BENTRYL
 16409         MOVE AL-UANON           TO BENTRYA.
 16410
 16411     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 16412         MOVE PI-689-SEQ-EDIT    TO SEQI
 16413         MOVE +8                 TO SEQL
 16414         MOVE AL-UNNON           TO SEQA.
 16415
 16416     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 16417         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 16418         MOVE +4                 TO BCSEQL
 16419         MOVE AL-UNNON           TO BCSEQA.
 16420
 16421     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 16422         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 347
* EL689.cbl
 16423         MOVE +8                 TO DATEL
 16424         MOVE AL-UNNON           TO DATEA.
 16425
 16426     IF PI-CERT-FORM-ID GREATER THAN SPACES
 16427        MOVE PI-CERT-FORM-ID     TO CERTIDI
 16428        MOVE +5                  TO CERTIDL
 16429        MOVE AL-UNNON            TO CERTIDA
 16430     END-IF.
 16431
 16432     IF PI-PRINT-NOW GREATER THAN SPACES
 16433        MOVE PI-PRINT-NOW        TO PRTNOWI
 16434        MOVE +1                  TO PRTNOWL
 16435        MOVE AL-UNNON            TO PRTNOWA
 16436     END-IF.
 16437     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 16438        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 16439        MOVE +8                  TO ENDARCHL
 16440        MOVE AL-UNNON            TO ENDARCHA
 16441     END-IF
 16442
 16443     MOVE PI-ENCLOSURE-CD        TO ENCI.
 16444     MOVE +3                     TO ENCL.
 16445     MOVE AL-UANON               TO ENCA.
 16446
 16447 7749-EXIT.
 16448     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 348
* EL689.cbl
 16450 7760-PUT-TEMP-STORAGE.
 16451**************************************************************
 16452*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 16453*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 16454*  EL1042 AND EL6892.                                        *
 16455**************************************************************
 16456
 16457     SET W-TS-NDX                TO 1.
 16458     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16459
 16460     MOVE -1                     TO MAINTL.
 16461     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16462             VARYING
 16463         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16464             UNTIL
 16465         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16466
 16467 7760-EXIT.
 16468      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 349
* EL689.cbl
 16470 7780-DELETE-TEMP-STOR-TEXT.
 16471
 16472
 16473* EXEC CICS HANDLE CONDITION
 16474*         QIDERR      (7780-EXIT)
 16475*    END-EXEC.
 16476*    MOVE '"$N                   ! : #00015344' TO DFHEIV0
 16477     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 16478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16479     MOVE X'3A20233030303135333434' TO DFHEIV0(25:11)
 16480     CALL 'kxdfhei1' USING DFHEIV0
 16481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16482
 16483
 16484
 16485* EXEC CICS DELETEQ TS
 16486*         QUEUE       (W-TS-NAME-TEXT)
 16487*    END-EXEC.
 16488*    MOVE '*&                    #   #00015348' TO DFHEIV0
 16489     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 16490     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16491     MOVE X'2020233030303135333438' TO DFHEIV0(25:11)
 16492     CALL 'kxdfhei1' USING DFHEIV0,
 16493           W-TS-NAME-TEXT,
 16494           DFHEIV99
 16495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16496
 16497
 16498 7780-EXIT.
 16499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 350
* EL689.cbl
 16501 7840-WRITE-TS.
 16502
 16503     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 16504     SET W-TS-NDX UP BY 1.
 16505     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 16506
 16507
 16508* EXEC CICS WRITEQ TS
 16509*         FROM    (W-TS-WORK-AREA)
 16510*         QUEUE   (W-TS-NAME-TEXT)
 16511*         LENGTH  (W-TS-LENGTH)
 16512*         ITEM    (PI-TEMP-STOR-ITEMS)
 16513*    END-EXEC.
 16514*    MOVE '*" I                  ''   #00015361' TO DFHEIV0
 16515     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 16516     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16517     MOVE X'2020233030303135333631' TO DFHEIV0(25:11)
 16518     CALL 'kxdfhei1' USING DFHEIV0,
 16519           W-TS-NAME-TEXT,
 16520           W-TS-WORK-AREA,
 16521           W-TS-LENGTH,
 16522           PI-TEMP-STOR-ITEMS,
 16523           DFHEIV99,
 16524           DFHEIV99
 16525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16526
 16527
 16528 7840-EXIT.
 16529     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 351
* EL689.cbl
 16531 7900-PRINT-LETTER-NOW.
 16532***************************************************************
 16533*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 16534*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 16535*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 16536*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 16537*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 16538*     ISSUED FOR THE PRINT TRANSACTION.                       *
 16539***************************************************************
 16540
 16541*    IF (EIBAID = DFHPF4 OR DFHPF8)
 16542*            AND
 16543*        PI-SHOW-MODE
 16544*        IF  PRINTERL GREATER ZERO
 16545*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 16546*                                                    W-UPPER-CASE
 16547*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 16548*                                   PI-ALT-DMD-PRT-ID.
 16549*
 16550*    IF  EIBAID EQUAL DFHPF8
 16551*            AND
 16552*        PI-SHOW-MODE
 16553*            AND
 16554*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 16555*        MOVE ER-7247            TO EMI-ERROR
 16556*        MOVE -1                 TO MAINTL
 16557*        MOVE AL-UABON           TO MAINTA
 16558*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16559*        GO TO 8200-SEND-DATAONLY.
 16560
 16561     IF  PI-TOTAL-LINES EQUAL 0
 16562         MOVE ER-0187            TO EMI-ERROR
 16563         MOVE -1                 TO MAINTL
 16564         MOVE AL-UABON           TO MAINTA
 16565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16566         GO TO 8200-SEND-DATAONLY.
 16567
 16568     IF  EMI-ERROR NOT EQUAL ER-0191
 16569         IF  PI-689-CREATE-NO-SCREENS
 16570*                OR
 16571*            (EIBAID = DFHPF4 OR DFHPF8)
 16572             SET W-RG-NDX        TO +1
 16573         ELSE
 16574             PERFORM 4100-SET-NDX THRU 4100-EXIT
 16575             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16576                     VARYING
 16577                 W-SC-NDX FROM 1 BY 1
 16578                     UNTIL
 16579                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 16580
 16581     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 16582
 16583     IF EIBAID NOT = DFHPF4 AND DFHPF8
 16584         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 16585                 VARYING
 16586             W-RVS-NDX FROM +1 BY +1
 16587                 UNTIL
 16588             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 352
* EL689.cbl
 16589                 OR
 16590             W-REMAINING-VAR-FOUND
 16591         IF  W-REMAINING-VAR-FOUND
 16592             GO TO 4000-ROLL-PAGE.
 16593
 16594*    IF EIBAID = DFHPF4 OR DFHPF8
 16595*       PERFORM 7700-READ-TEXT-TS
 16596*                                THRU 7700-EXIT
 16597*
 16598*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 16599*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16600*                VARYING
 16601*            W-SC-NDX FROM 1 BY 1
 16602*                UNTIL
 16603*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 16604*
 16605*       PERFORM 7760-PUT-TEMP-STORAGE
 16606*                                THRU 7760-EXIT
 16607*    END-IF
 16608     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 16609         MOVE PI-689-ALT-PRINTER-ID
 16610                                 TO W-TS-TERM-TEXT
 16611     ELSE
 16612         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 16613             MOVE PI-PROCESSOR-PRINTER
 16614                                 TO W-TS-TERM-TEXT
 16615         ELSE
 16616             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 16617             MOVE '1'            TO W-CNTL-RECORD-TYPE
 16618             MOVE SPACES         TO W-CNTL-GENL
 16619             MOVE ZEROS          TO W-CNTL-SEQ-NO
 16620
 16621* EXEC CICS HANDLE CONDITION
 16622*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 16623*                 NOTFND     (7945-NOT-FOUND)
 16624*            END-EXEC
 16625*    MOVE '"$JI                  ! ; #00015460' TO DFHEIV0
 16626     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 16627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16628     MOVE X'3B20233030303135343630' TO DFHEIV0(25:11)
 16629     CALL 'kxdfhei1' USING DFHEIV0
 16630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16631
 16632* EXEC CICS READ
 16633*                 DATASET    (W-CNTL-FILE-ID)
 16634*                 SET        (ADDRESS OF CONTROL-FILE)
 16635*                 RIDFLD     (W-CNTL-KEY)
 16636*            END-EXEC
 16637*    MOVE '&"S        E          (   #00015464' TO DFHEIV0
 16638     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16639     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16640     MOVE X'2020233030303135343634' TO DFHEIV0(25:11)
 16641     CALL 'kxdfhei1' USING DFHEIV0,
 16642           W-CNTL-FILE-ID,
 16643           DFHEIV20,
 16644           DFHEIV99,
 16645           W-CNTL-KEY,
 16646           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 353
* EL689.cbl
 16647           DFHEIV99,
 16648           DFHEIV99
 16649     SET ADDRESS OF CONTROL-FILE TO
 16650         DFHEIV20
 16651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16652             MOVE CF-FORMS-PRINTER-ID
 16653                                 TO W-TS-TERM-TEXT.
 16654
 16655***********************************************************
 16656*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 16657*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 16658***********************************************************
 16659
 16660     SET W-TS-NDX                TO 1.
 16661     MOVE EIBTIME                TO W-TS-ID-TIME.
 16662     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 16663     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16664
 16665     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16666             VARYING
 16667         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16668             UNTIL
 16669         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16670
 16671*    IF  EIBAID EQUAL DFHPF8
 16672*        MOVE '1'                TO PI-689-PRINT-SW
 16673*    ELSE
 16674         MOVE SPACES             TO PI-689-PRINT-SW.
 16675
 16676
 16677* EXEC CICS HANDLE CONDITION
 16678*         TERMIDERR  (7935-TERM-ERROR)
 16679*         TRANSIDERR (7940-TRAN-ERROR)
 16680*    END-EXEC.
 16681*    MOVE '"$[\                  ! < #00015493' TO DFHEIV0
 16682     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 16683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16684     MOVE X'3C20233030303135343933' TO DFHEIV0(25:11)
 16685     CALL 'kxdfhei1' USING DFHEIV0
 16686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16687
 16688
 16689
 16690* EXEC CICS START
 16691*             INTERVAL    (0)
 16692*             TRANSID     (W-PRINT-TRANS)
 16693*             FROM        (PROGRAM-INTERFACE-BLOCK)
 16694*             LENGTH      (PI-COMM-LENGTH)
 16695*             TERMID      (W-TS-TERM-TEXT)
 16696*    END-EXEC.
 16697     MOVE 0 TO DFHEIV10
 16698*    MOVE '0(ILFT                1   #00015498' TO DFHEIV0
 16699     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 16700     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 16701     MOVE X'2020233030303135343938' TO DFHEIV0(25:11)
 16702     CALL 'kxdfhei1' USING DFHEIV0,
 16703           DFHEIV10,
 16704           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 354
* EL689.cbl
 16705           DFHEIV99,
 16706           PROGRAM-INTERFACE-BLOCK,
 16707           PI-COMM-LENGTH,
 16708           W-TS-TERM-TEXT,
 16709           DFHEIV99,
 16710           DFHEIV99,
 16711           DFHEIV99,
 16712           DFHEIV99,
 16713           DFHEIV99,
 16714           DFHEIV99,
 16715           DFHEIV99,
 16716           DFHEIV99,
 16717           DFHEIV99,
 16718           DFHEIV99
 16719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16720
 16721
 16722
 16723* EXEC CICS SYNCPOINT
 16724*    END-EXEC.
 16725*    MOVE '6"                    !   #00015506' TO DFHEIV0
 16726     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 16727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16728     MOVE X'2020233030303135353036' TO DFHEIV0(25:11)
 16729     CALL 'kxdfhei1' USING DFHEIV0
 16730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16731
 16732
 16733     IF  PI-689-CREATE-NO-SCREENS
 16734         GO TO 7900-EXIT.
 16735
 16736*    IF  EIBAID EQUAL DFHPF8
 16737*            AND
 16738*        PI-SHOW-MODE
 16739*            AND
 16740*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 16741*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 16742
 16743     MOVE ER-0189                TO EMI-ERROR.
 16744     MOVE -1                     TO MAINTL.
 16745
 16746     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16747     MOVE -1                     TO MAINTL
 16748     MOVE AL-UABON               TO MAINTA
 16749     MOVE '104A'                 TO W-TS-ID-TEXT
 16750     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16751                                    W-TS-TERM-SCREEN
 16752     GO TO 8200-SEND-DATAONLY.
 16753
 16754 7900-EXIT.
 16755     EXIT.
 16756
 16757 7915-SEARCH-REMAINING-VARS.
 16758
 16759     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 16760         SET W-RVS-NDX2          TO W-RVS-NDX
 16761         SET W-RVS-NDX2 UP BY +1
 16762         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 355
* EL689.cbl
 16763             SET W-RVS-NDX2 UP BY +1
 16764             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 16765                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 16766                 COMPUTE PI-CURRENT-LINE
 16767                     = PI-CURRENT-LINE / 73
 16768                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 16769                 MOVE +0         TO W-ROLL-COUNTER
 16770                 MOVE ER-0191    TO EMI-ERROR
 16771                 MOVE -1         TO MAINTL
 16772                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16773
 16774 7915-EXIT.
 16775     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 356
* EL689.cbl
 16777 7920-UPDATE-INITIAL-PRINT.
 16778
 16779
 16780* EXEC CICS HANDLE CONDITION
 16781*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 16782*         NOTFND     (1070-ARCH-NOT-FOUND)
 16783*         ENDFILE    (1070-ARCH-NOT-FOUND)
 16784*    END-EXEC.
 16785*    MOVE '"$JI''                 ! = #00015555' TO DFHEIV0
 16786     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 16787     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16788     MOVE X'3D20233030303135353535' TO DFHEIV0(25:11)
 16789     CALL 'kxdfhei1' USING DFHEIV0
 16790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16791
 16792     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 16793     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 16794
 16795* EXEC CICS READ
 16796*        DATASET (W-ARCH-FILE-ID)
 16797*        SET     (ADDRESS OF LETTER-ARCHIVE)
 16798*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 16799*        UPDATE
 16800*    END-EXEC.
 16801*    MOVE '&"S        EU         (   #00015562' TO DFHEIV0
 16802     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16803     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16804     MOVE X'2020233030303135353632' TO DFHEIV0(25:11)
 16805     CALL 'kxdfhei1' USING DFHEIV0,
 16806           W-ARCH-FILE-ID,
 16807           DFHEIV20,
 16808           DFHEIV99,
 16809           W-ARCH-PARTIAL-KEY,
 16810           DFHEIV99,
 16811           DFHEIV99,
 16812           DFHEIV99
 16813     SET ADDRESS OF LETTER-ARCHIVE TO
 16814         DFHEIV20
 16815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16816
 16817
 16818     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 16819
 16820     IF  LA-RESEND-DATE = LOW-VALUES
 16821         MOVE 'C'                TO LA-STATUS.
 16822
 16823
 16824* EXEC CICS REWRITE
 16825*         FROM      (LETTER-ARCHIVE)
 16826*         DATASET   (W-ARCH-FILE-ID)
 16827*    END-EXEC.
 16828     MOVE LENGTH OF
 16829      LETTER-ARCHIVE
 16830       TO DFHEIV11
 16831*    MOVE '&& L                  %   #00015574' TO DFHEIV0
 16832     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16833     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16834     MOVE X'2020233030303135353734' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 357
* EL689.cbl
 16835     CALL 'kxdfhei1' USING DFHEIV0,
 16836           W-ARCH-FILE-ID,
 16837           LETTER-ARCHIVE,
 16838           DFHEIV11,
 16839           DFHEIV99
 16840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16841
 16842
 16843 7920-EXIT.
 16844     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 358
* EL689.cbl
 16846 7935-TERM-ERROR.
 16847
 16848     MOVE ER-0412                TO EMI-ERROR.
 16849     MOVE SPACES                 TO PI-689-PRINT-SW.
 16850     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16851     MOVE -1                     TO MAINTL.
 16852     GO TO 8200-SEND-DATAONLY.
 16853
 16854 7940-TRAN-ERROR.
 16855
 16856     MOVE ER-0413                TO EMI-ERROR.
 16857     MOVE SPACES                 TO PI-689-PRINT-SW.
 16858     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16859     MOVE -1                     TO MAINTL.
 16860     GO TO 8200-SEND-DATAONLY.
 16861
 16862 7945-NOT-FOUND.
 16863
 16864     MOVE ER-0190                TO EMI-ERROR.
 16865     MOVE -1                     TO MAINTL.
 16866     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16867     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 359
* EL689.cbl
 16869 8010-ARCH-NOT-OPEN.
 16870
 16871     MOVE ER-7388                TO EMI-ERROR.
 16872     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16873     MOVE -1                     TO MAINTL.
 16874     GO TO 8200-SEND-DATAONLY.
 16875
 16876 8015-ARCT-NOT-OPEN.
 16877
 16878     MOVE ER-7373                TO EMI-ERROR.
 16879     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16880     MOVE -1                     TO MAINTL.
 16881     GO TO 8200-SEND-DATAONLY.
 16882
 16883 8020-ACCT-NOT-OPEN.
 16884
 16885     MOVE ER-0168 TO EMI-ERROR
 16886     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16887     MOVE -1                     TO MAINTL.
 16888     GO TO 8200-SEND-DATAONLY.
 16889
 16890 8030-CERT-NOT-OPEN.
 16891
 16892     MOVE ER-0169 TO EMI-ERROR.
 16893     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16894     MOVE -1                     TO MAINTL.
 16895     GO TO 8200-SEND-DATAONLY.
 16896
 16897 8035-CERT-NOT-FOUND.
 16898
 16899     MOVE ER-2369 TO EMI-ERROR.
 16900     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16901     MOVE -1                     TO MAINTL.
 16902     GO TO 8200-SEND-DATAONLY.
 16903
 16904 8040-CNTL-NOT-OPEN.
 16905
 16906     MOVE ER-0042                TO EMI-ERROR.
 16907     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16908     MOVE -1                     TO MAINTL.
 16909     GO TO 8200-SEND-DATAONLY.
 16910
 16911 8045-CHEK-NOT-OPEN.
 16912
 16913     MOVE ER-3775                TO EMI-ERROR.
 16914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16915     MOVE -1                     TO MAINTL.
 16916     GO TO 8200-SEND-DATAONLY.
 16917
 16918 8050-TEXT-NOT-OPEN.
 16919
 16920     MOVE ER-0013                TO EMI-ERROR.
 16921     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16922     MOVE -1                     TO MAINTL.
 16923     GO TO 8200-SEND-DATAONLY.
 16924
 16925 8060-PNDB-NOT-OPEN.
 16926
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 360
* EL689.cbl
 16927     MOVE ER-2216 TO EMI-ERROR.
 16928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16929     MOVE -1                     TO MAINTL.
 16930     GO TO 8200-SEND-DATAONLY.
 16931
 16932 8070-PNDB-NOT-FOUND.
 16933
 16934     MOVE ER-7374 TO EMI-ERROR.
 16935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16936     MOVE -1                     TO MAINTL.
 16937     GO TO 8200-SEND-DATAONLY.
 16938
 16939 8080-COMP-NOT-OPEN.
 16940
 16941     MOVE ER-2055 TO EMI-ERROR
 16942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16943     MOVE -1                     TO MAINTL.
 16944     GO TO 8200-SEND-DATAONLY.
 16945
 16946 8085-PYAJ-NOT-OPEN.
 16947
 16948     MOVE ER-2232 TO EMI-ERROR
 16949     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16950     MOVE -1                     TO MAINTL.
 16951     GO TO 8200-SEND-DATAONLY.
 16952
 16953 8090-MAIL-NOT-OPEN.
 16954
 16955     MOVE ER-2999                TO EMI-ERROR.
 16956     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16957     MOVE -1                     TO MAINTL.
 16958     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 361
* EL689.cbl
 16960 8100-SEND-INITIAL-MAP.
 16961
 16962     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 16963     IF  PI-689-CREATE-NO-SCREENS
 16964         MOVE '9999'             TO PI-689-ERROR
 16965         GO TO 0620-RETURN-TO-CALLER.
 16966
 16967     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16968
 16969     IF  NOT EMI-NO-ERRORS
 16970         MOVE EMI-MESSAGE-AREA (1)
 16971                                 TO ERRMSGO
 16972     ELSE
 16973         MOVE SPACES             TO ERRMSGO.
 16974     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 16975                                 TO SYSO
 16976     MOVE WS-KIXHOST             TO HOSTO
 16977     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 16978        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 16979        MOVE AL-SADOF            TO PF8HDA
 16980     END-IF
 16981     IF NOT PI-CREATE-LABELS
 16982         MOVE AL-PANON           TO ADDRLBLA.
 16983
 16984
 16985* EXEC CICS SEND
 16986*        MAP    (W-MAP)
 16987*        MAPSET (W-MAPSET)
 16988*        FROM   (EL689AO)
 16989*        ERASE
 16990*        CURSOR
 16991*    END-EXEC.
 16992     MOVE LENGTH OF
 16993      EL689AO
 16994       TO DFHEIV12
 16995     MOVE -1
 16996       TO DFHEIV11
 16997*    MOVE '8$     CT  E    H L F ,   #00015720' TO DFHEIV0
 16998     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16999     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17000     MOVE X'2020233030303135373230' TO DFHEIV0(25:11)
 17001     CALL 'kxdfhei1' USING DFHEIV0,
 17002           W-MAP,
 17003           EL689AO,
 17004           DFHEIV12,
 17005           W-MAPSET,
 17006           DFHEIV99,
 17007           DFHEIV99,
 17008           DFHEIV99,
 17009           DFHEIV11,
 17010           DFHEIV99,
 17011           DFHEIV99,
 17012           DFHEIV99
 17013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17014
 17015
 17016     GO TO 9000-RETURN-TRANS.
 17017
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 362
* EL689.cbl
 17018 8100-EXIT.
 17019     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 363
* EL689.cbl
 17021 8200-SEND-DATAONLY.
 17022
 17023     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 17024     IF  PI-689-CREATE-NO-SCREENS
 17025         MOVE '9999'             TO PI-689-ERROR
 17026         GO TO 0620-RETURN-TO-CALLER.
 17027
 17028     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17029
 17030     IF EMI-ERROR = ER-0715
 17031         DISPLAY 'ER 0715'
 17032         MOVE -1          TO CERTIDL
 17033         MOVE +0          TO MAINTL
 17034     END-IF
 17035
 17036     IF  NOT EMI-NO-ERRORS
 17037         MOVE EMI-MESSAGE-AREA (1)
 17038                                 TO ERRMSGO
 17039     ELSE
 17040         MOVE SPACES             TO ERRMSGO.
 17041
 17042
 17043* EXEC CICS SEND
 17044*        MAP    (W-MAP)
 17045*        MAPSET (W-MAPSET)
 17046*        FROM   (EL689AO)
 17047*        DATAONLY
 17048*        CURSOR
 17049*    END-EXEC.
 17050     MOVE LENGTH OF
 17051      EL689AO
 17052       TO DFHEIV12
 17053     MOVE -1
 17054       TO DFHEIV11
 17055*    MOVE '8$D    CT       H L F ,   #00015754' TO DFHEIV0
 17056     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17057     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17058     MOVE X'2020233030303135373534' TO DFHEIV0(25:11)
 17059     CALL 'kxdfhei1' USING DFHEIV0,
 17060           W-MAP,
 17061           EL689AO,
 17062           DFHEIV12,
 17063           W-MAPSET,
 17064           DFHEIV99,
 17065           DFHEIV99,
 17066           DFHEIV99,
 17067           DFHEIV11,
 17068           DFHEIV99,
 17069           DFHEIV99,
 17070           DFHEIV99
 17071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17072
 17073
 17074     GO TO 9000-RETURN-TRANS.
 17075
 17076 8200-EXIT.
 17077     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 364
* EL689.cbl
 17079 8300-SEND-TEXT.
 17080
 17081     IF  PI-689-CREATE-NO-SCREENS
 17082         MOVE '9999'             TO PI-689-ERROR
 17083         GO TO 0620-RETURN-TO-CALLER.
 17084
 17085
 17086* EXEC CICS SEND TEXT
 17087*        FROM    (LOGOFF-TEXT)
 17088*        LENGTH  (LOGOFF-LENGTH)
 17089*        ERASE
 17090*        FREEKB
 17091*    END-EXEC.
 17092*    MOVE '8&      T  E F  H   F -   #00015773' TO DFHEIV0
 17093     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17094     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17095     MOVE X'2020233030303135373733' TO DFHEIV0(25:11)
 17096     CALL 'kxdfhei1' USING DFHEIV0,
 17097           LOGOFF-TEXT,
 17098           LOGOFF-LENGTH,
 17099           DFHEIV99,
 17100           DFHEIV99,
 17101           DFHEIV99,
 17102           DFHEIV99,
 17103           DFHEIV99,
 17104           DFHEIV99,
 17105           DFHEIV99,
 17106           DFHEIV99,
 17107           DFHEIV99,
 17108           DFHEIV99
 17109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17110
 17111
 17112     GO TO 9000-RETURN-TRANS.
 17113
 17114 8300-EXIT.
 17115     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 365
* EL689.cbl
 17117 8350-SEND-DATAONLY-ERASEAUP.
 17118
 17119     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 17120     PERFORM 7760-PUT-TEMP-STORAGE
 17121                                 THRU 7760-EXIT
 17122     IF  PI-689-CREATE-NO-SCREENS
 17123         MOVE '9999'             TO PI-689-ERROR
 17124         GO TO 0620-RETURN-TO-CALLER.
 17125
 17126     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17127
 17128     IF EMI-ERROR = ER-0715
 17129         DISPLAY 'ER 0715'
 17130         MOVE -1          TO CERTIDL
 17131         MOVE +0          TO MAINTL
 17132     END-IF
 17133
 17134     IF  NOT EMI-NO-ERRORS
 17135         MOVE EMI-MESSAGE-AREA (1)
 17136                                 TO ERRMSGO
 17137     ELSE
 17138         MOVE SPACES             TO ERRMSGO.
 17139
 17140
 17141* EXEC CICS SEND
 17142*        MAP      (W-MAP)
 17143*        MAPSET   (W-MAPSET)
 17144*        FROM     (EL689AO)
 17145*        DATAONLY
 17146*        ERASEAUP
 17147*        CURSOR
 17148*    END-EXEC.
 17149     MOVE LENGTH OF
 17150      EL689AO
 17151       TO DFHEIV12
 17152     MOVE -1
 17153       TO DFHEIV11
 17154*    MOVE '8$D    CT  A    H L F ,   #00015808' TO DFHEIV0
 17155     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 17156     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17157     MOVE X'2020233030303135383038' TO DFHEIV0(25:11)
 17158     CALL 'kxdfhei1' USING DFHEIV0,
 17159           W-MAP,
 17160           EL689AO,
 17161           DFHEIV12,
 17162           W-MAPSET,
 17163           DFHEIV99,
 17164           DFHEIV99,
 17165           DFHEIV99,
 17166           DFHEIV11,
 17167           DFHEIV99,
 17168           DFHEIV99,
 17169           DFHEIV99
 17170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17171
 17172
 17173     GO TO 9000-RETURN-TRANS.
 17174
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 366
* EL689.cbl
 17175 8350-EXIT.
 17176     EXIT.
 17177
 17178 8600-DEEDIT.
 17179
 17180
 17181* EXEC CICS BIF DEEDIT
 17182*         FIELD    (W-DEEDIT-FIELD)
 17183*         LENGTH   (15)
 17184*    END-EXEC.
 17185     MOVE 15
 17186       TO DFHEIV11
 17187*    MOVE '@"L                   #   #00015824' TO DFHEIV0
 17188     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17189     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17190     MOVE X'2020233030303135383234' TO DFHEIV0(25:11)
 17191     CALL 'kxdfhei1' USING DFHEIV0,
 17192           W-DEEDIT-FIELD,
 17193           DFHEIV11
 17194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17195
 17196
 17197 8600-EXIT.
 17198     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 367
* EL689.cbl
 17200 9000-RETURN-TRANS.
 17201
 17202     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 17203     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 17204     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 17205     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 17206
 17207* EXEC CICS RETURN
 17208*        TRANSID    (W-TRANSACTION)
 17209*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 17210*        LENGTH     (PI-COMM-LENGTH)
 17211*    END-EXEC.
 17212*    MOVE '.(CT                  ''   #00015838' TO DFHEIV0
 17213     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17214     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17215     MOVE X'2020233030303135383338' TO DFHEIV0(25:11)
 17216     CALL 'kxdfhei1' USING DFHEIV0,
 17217           W-TRANSACTION,
 17218           PROGRAM-INTERFACE-BLOCK,
 17219           PI-COMM-LENGTH,
 17220           DFHEIV99,
 17221           DFHEIV99,
 17222           DFHEIV99
 17223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17224
 17225*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17226*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17227*    GO TO 0200-RECEIVE.
 17228
 17229 9000-EXIT.
 17230     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 368
* EL689.cbl
 17232 9200-PA.
 17233
 17234     MOVE ER-0008                TO EMI-ERROR.
 17235     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17236     MOVE -1                     TO MAINTL.
 17237     GO TO 8200-SEND-DATAONLY.
 17238
 17239 9200-EXIT.
 17240     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 369
* EL689.cbl
 17242 9300-DFHCLEAR.
 17243
 17244     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 17245         MOVE '2'                TO PI-ACTION.
 17246
 17247     IF  PI-CLEAR-MODE
 17248         MOVE PI-RETURN-TO-PROGRAM
 17249                                 TO W-CALL-PGM
 17250         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17251         GO TO 9400-XCTL
 17252     ELSE
 17253         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17254         MOVE LOW-VALUES         TO EL689AO
 17255                                    PI-1042-WA
 17256                                    PI-689-WORK-AREA
 17257         MOVE ZEROS              TO PI-CURRENT-LINE
 17258                                    PI-TEMP-STOR-ITEMS
 17259                                    PI-TOTAL-LINES
 17260                                    PI-UPDATE-SW
 17261                                    PI-689-NUMBER-LABEL-LINES
 17262         MOVE SPACES             TO PI-689-PRINT-SW
 17263                                    PI-689-ALT-PRINTER-ID
 17264                                    PI-COMM-CONTROL
 17265                                    PI-689-FORM-NUMBER
 17266                                    PI-689-TEMP-STOR-ID
 17267                                    PI-689-LABEL-SOURCE
 17268                                    PI-689-USE-SCREEN-IND
 17269         MOVE '2'                TO PI-ACTION
 17270         MOVE -1                 TO MAINTL
 17271         GO TO 8100-SEND-INITIAL-MAP.
 17272
 17273 9300-EXIT.
 17274     EXIT.
 17275
 17276 9400-XCTL.
 17277
 17278
 17279* EXEC CICS XCTL
 17280*        PROGRAM  (W-CALL-PGM)
 17281*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 17282*        LENGTH   (PI-COMM-LENGTH)
 17283*    END-EXEC.
 17284*    MOVE '.$C                   %   #00015896' TO DFHEIV0
 17285     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17286     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17287     MOVE X'2020233030303135383936' TO DFHEIV0(25:11)
 17288     CALL 'kxdfhei1' USING DFHEIV0,
 17289           W-CALL-PGM,
 17290           PROGRAM-INTERFACE-BLOCK,
 17291           PI-COMM-LENGTH,
 17292           DFHEIV99
 17293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17294
 17295
 17296 9400-EXIT.
 17297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 370
* EL689.cbl
 17299 9500-LINK-DATE-CONVERT.
 17300
 17301     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 17302             AND
 17303         DC-OPTION-CODE EQUAL ' '
 17304         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 17305         GO TO 9500-EXIT.
 17306
 17307
 17308* EXEC CICS LINK
 17309*        PROGRAM    ('ELDATCV')
 17310*        COMMAREA   (DATE-CONVERSION-DATA)
 17311*        LENGTH     (DC-COMM-LENGTH)
 17312*    END-EXEC.
 17313     MOVE 'ELDATCV' TO DFHEIV1
 17314*    MOVE '."C                   (   #00015913' TO DFHEIV0
 17315     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17317     MOVE X'2020233030303135393133' TO DFHEIV0(25:11)
 17318     CALL 'kxdfhei1' USING DFHEIV0,
 17319           DFHEIV1,
 17320           DATE-CONVERSION-DATA,
 17321           DC-COMM-LENGTH,
 17322           DFHEIV99,
 17323           DFHEIV99,
 17324           DFHEIV99,
 17325           DFHEIV99
 17326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17327
 17328
 17329     IF  NO-CONVERSION-ERROR
 17330             AND
 17331         PI-COMPANY-ID EQUAL 'AUK'
 17332             AND
 17333         W-REVERSE-DATE
 17334         MOVE DC-GREG-DATE-1-EDIT
 17335                                 TO W-EDIT-DATE-1
 17336         MOVE W-ED1-MM           TO W-ED2-MM
 17337         MOVE W-ED1-DD           TO W-ED2-DD
 17338         MOVE W-ED1-YY           TO W-ED2-YY
 17339         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 17340
 17341 9500-EXIT.
 17342     EXIT.
 17343
 17344 9600-FORMAT-DATE-TIME.
 17345
 17346     MOVE W-SAVE-DATE            TO RUNDTEO.
 17347     MOVE EIBTIME                TO W-TIME-IN.
 17348     MOVE W-TIME-OUT             TO RUNTIMEO.
 17349     MOVE PI-COMPANY-ID          TO COMPANYO.
 17350     MOVE PI-PROCESSOR-ID        TO USERIDO.
 17351     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17352
 17353 9600-EXIT.
 17354     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 371
* EL689.cbl
 17356 9700-PGMID-ERROR.
 17357
 17358     IF  PI-689-CREATE-NO-SCREENS
 17359         MOVE '9999'             TO PI-689-ERROR
 17360         GO TO 0620-RETURN-TO-CALLER.
 17361
 17362
 17363* EXEC CICS  HANDLE CONDITION
 17364*        PGMIDERR  (8300-SEND-TEXT)
 17365*    END-EXEC.
 17366*    MOVE '"$L                   ! > #00015952' TO DFHEIV0
 17367     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17369     MOVE X'3E20233030303135393532' TO DFHEIV0(25:11)
 17370     CALL 'kxdfhei1' USING DFHEIV0
 17371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17372
 17373
 17374     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 17375     MOVE ' '                    TO PI-ENTRY-CD-1.
 17376     MOVE W-XCTL-005             TO W-CALL-PGM
 17377                                    LOGOFF-PGM.
 17378     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 17379
 17380     PERFORM 9400-XCTL THRU 9400-EXIT.
 17381
 17382 9700-EXIT.
 17383     EXIT.
 17384
 17385 9800-ABEND.
 17386
 17387     IF  PI-689-CREATE-NO-SCREENS
 17388         MOVE '9999'             TO PI-689-ERROR
 17389         GO TO 0620-RETURN-TO-CALLER.
 17390
 17391     MOVE W-LINK-004             TO W-CALL-PGM.
 17392     MOVE DFHEIBLK               TO EMI-LINE1
 17393
 17394
 17395* EXEC CICS  LINK
 17396*        PROGRAM   (W-CALL-PGM)
 17397*        COMMAREA  (EMI-LINE1)
 17398*        LENGTH    (72)
 17399*    END-EXEC.
 17400     MOVE 72
 17401       TO DFHEIV11
 17402*    MOVE '."C                   (   #00015976' TO DFHEIV0
 17403     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17405     MOVE X'2020233030303135393736' TO DFHEIV0(25:11)
 17406     CALL 'kxdfhei1' USING DFHEIV0,
 17407           W-CALL-PGM,
 17408           EMI-LINE1,
 17409           DFHEIV11,
 17410           DFHEIV99,
 17411           DFHEIV99,
 17412           DFHEIV99,
 17413           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 372
* EL689.cbl
 17414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17415
 17416
 17417     GO TO 8200-SEND-DATAONLY.
 17418
 17419 9800-EXIT.
 17420     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 373
* EL689.cbl
 17422 9900-ERROR-FORMAT.
 17423
 17424     IF  PI-689-CREATE-NO-SCREENS
 17425         MOVE EMI-ERROR          TO PI-689-ERROR
 17426         IF  PI-689-FATAL-ERROR
 17427             GO TO 0620-RETURN-TO-CALLER
 17428         ELSE
 17429             GO TO 9900-EXIT.
 17430
 17431     IF  EMI-ERROR EQUAL ER-9097
 17432         NEXT SENTENCE
 17433     ELSE
 17434         IF  EMI-ERRORS-COMPLETE
 17435                 OR
 17436             EMI-ERROR EQUAL W-LAST-ERROR
 17437             GO TO 9900-EXIT.
 17438
 17439     MOVE W-LINK-001             TO W-CALL-PGM.
 17440
 17441
 17442* EXEC CICS LINK
 17443*        PROGRAM    (W-CALL-PGM)
 17444*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17445*        LENGTH     (EMI-COMM-LENGTH)
 17446*    END-EXEC.
 17447*    MOVE '."C                   (   #00016006' TO DFHEIV0
 17448     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17449     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17450     MOVE X'2020233030303136303036' TO DFHEIV0(25:11)
 17451     CALL 'kxdfhei1' USING DFHEIV0,
 17452           W-CALL-PGM,
 17453           ERROR-MESSAGE-INTERFACE-BLOCK,
 17454           EMI-COMM-LENGTH,
 17455           DFHEIV99,
 17456           DFHEIV99,
 17457           DFHEIV99,
 17458           DFHEIV99
 17459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17460
 17461
 17462     IF  EMI-SEVERITY (2) EQUAL 'X'
 17463             AND
 17464         EMI-SEVERITY (1) NOT EQUAL 'X'
 17465         MOVE EMI-MESSAGE-AREA (2)
 17466                                 TO EMI-MESSAGE-AREA (1).
 17467
 17468     MOVE EMI-ERROR              TO W-LAST-ERROR.
 17469
 17470 9900-EXIT.
 17471     EXIT.
 17472
 17473 9905-INITIALIZE-SECURITY.
 17474******************************************************************
 17475*                                                                *
 17476*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 17477*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 17478*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 17479*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 374
* EL689.cbl
 17480*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 17481*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 17482*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 17483*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 17484*                                                                *
 17485*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 17486*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 17487*                                                                *
 17488******************************************************************
 17489
 17490     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 17491         MOVE 'Y'                TO PI-DISPLAY-CAP
 17492                                    PI-MODIFY-CAP
 17493     ELSE
 17494
 17495* EXEC CICS READQ TS
 17496*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 17497*            INTO   (SECURITY-CONTROL)
 17498*            LENGTH (SC-COMM-LENGTH)
 17499*            ITEM   (1)
 17500*        END-EXEC
 17501     MOVE 1
 17502       TO DFHEIV11
 17503*    MOVE '*$II   L              ''   #00016044' TO DFHEIV0
 17504     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 17505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17506     MOVE X'2020233030303136303434' TO DFHEIV0(25:11)
 17507     CALL 'kxdfhei1' USING DFHEIV0,
 17508           PI-SECURITY-TEMP-STORE-ID,
 17509           SECURITY-CONTROL,
 17510           SC-COMM-LENGTH,
 17511           DFHEIV11,
 17512           DFHEIV99,
 17513           DFHEIV99
 17514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17515         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 17516                                 TO PI-DISPLAY-CAP
 17517         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 17518                                 TO PI-MODIFY-CAP.
 17519
 17520 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 375
* EL689.cbl
 17522 9995-SECURITY-VIOLATION.
 17523
 17524     MOVE EIBDATE                TO SM-JUL-DATE.
 17525     MOVE EIBTRMID               TO SM-TERMID.
 17526     MOVE W-THIS-PGM             TO SM-PGM.
 17527     MOVE EIBTIME                TO W-TIME-IN.
 17528     MOVE W-TIME-OUT             TO SM-TIME.
 17529     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 17530
 17531
 17532* EXEC CICS LINK
 17533*         PROGRAM  ('EL003')
 17534*         COMMAREA (SECURITY-MESSAGE)
 17535*         LENGTH   (80)
 17536*    END-EXEC.
 17537     MOVE 'EL003' TO DFHEIV1
 17538     MOVE 80
 17539       TO DFHEIV11
 17540*    MOVE '."C                   (   #00016066' TO DFHEIV0
 17541     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17543     MOVE X'2020233030303136303636' TO DFHEIV0(25:11)
 17544     CALL 'kxdfhei1' USING DFHEIV0,
 17545           DFHEIV1,
 17546           SECURITY-MESSAGE,
 17547           DFHEIV11,
 17548           DFHEIV99,
 17549           DFHEIV99,
 17550           DFHEIV99,
 17551           DFHEIV99
 17552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17553
 17554
 17555 9995-EXIT.
 17556     EXIT.
 17557
 17558 9999-GOBACK.
 17559
 17560
 17561* GOBACK.
 17562     MOVE '9%                    "   ' TO DFHEIV0
 17563     MOVE 'EL689' TO DFHEIV1
 17564     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17565     GOBACK.
 17566
 17567 9999-EXIT.
 17568     EXIT.
 17569
 17570 9999-DFHBACK SECTION.
 17571     MOVE '9%                    "   ' TO DFHEIV0
 17572     MOVE 'EL689' TO DFHEIV1
 17573     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17574     GOBACK.
 17575 9999-DFHEXIT.
 17576     IF DFHEIGDJ EQUAL 0001
 17577         NEXT SENTENCE
 17578     ELSE IF DFHEIGDJ EQUAL 2
 17579         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 376
* EL689.cbl
 17580               9200-PA,
 17581               9200-PA,
 17582               9200-PA
 17583         DEPENDING ON DFHEIGDI
 17584     ELSE IF DFHEIGDJ EQUAL 3
 17585         GO TO 9700-PGMID-ERROR,
 17586               9800-ABEND,
 17587               0325-MAPFAIL
 17588         DEPENDING ON DFHEIGDI
 17589     ELSE IF DFHEIGDJ EQUAL 4
 17590         GO TO 8040-CNTL-NOT-OPEN,
 17591               7945-NOT-FOUND
 17592         DEPENDING ON DFHEIGDI
 17593     ELSE IF DFHEIGDJ EQUAL 5
 17594         GO TO 9700-PGMID-ERROR,
 17595               0325-MAPFAIL,
 17596               9800-ABEND
 17597         DEPENDING ON DFHEIGDI
 17598     ELSE IF DFHEIGDJ EQUAL 6
 17599         GO TO 0990-CARRIER-NOT-FOUND,
 17600               8040-CNTL-NOT-OPEN
 17601         DEPENDING ON DFHEIGDI
 17602     ELSE IF DFHEIGDJ EQUAL 7
 17603         GO TO 0994-STATE-NOT-FOUND,
 17604               8040-CNTL-NOT-OPEN
 17605         DEPENDING ON DFHEIGDI
 17606     ELSE IF DFHEIGDJ EQUAL 8
 17607         GO TO 8010-ARCH-NOT-OPEN,
 17608               1070-ARCH-NOT-FOUND,
 17609               1070-ARCH-NOT-FOUND
 17610         DEPENDING ON DFHEIGDI
 17611     ELSE IF DFHEIGDJ EQUAL 9
 17612         GO TO 2001-NOT-FOUND,
 17613               2001-NOT-FOUND,
 17614               8050-TEXT-NOT-OPEN
 17615         DEPENDING ON DFHEIGDI
 17616     ELSE IF DFHEIGDJ EQUAL 10
 17617         GO TO 2000-ENDBR
 17618         DEPENDING ON DFHEIGDI
 17619     ELSE IF DFHEIGDJ EQUAL 11
 17620         GO TO 8040-CNTL-NOT-OPEN,
 17621               6200-CNTL1-NOT-FOUND
 17622         DEPENDING ON DFHEIGDI
 17623     ELSE IF DFHEIGDJ EQUAL 12
 17624         GO TO 8040-CNTL-NOT-OPEN,
 17625               6250-CNTL2-NOT-FOUND
 17626         DEPENDING ON DFHEIGDI
 17627     ELSE IF DFHEIGDJ EQUAL 13
 17628         GO TO 8040-CNTL-NOT-OPEN,
 17629               6300-CNTL6-NOT-FOUND
 17630         DEPENDING ON DFHEIGDI
 17631     ELSE IF DFHEIGDJ EQUAL 14
 17632         GO TO 8040-CNTL-NOT-OPEN,
 17633               6350-CNTL2-NOT-FOUND
 17634         DEPENDING ON DFHEIGDI
 17635     ELSE IF DFHEIGDJ EQUAL 15
 17636         GO TO 8060-PNDB-NOT-OPEN,
 17637               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 377
* EL689.cbl
 17638         DEPENDING ON DFHEIGDI
 17639     ELSE IF DFHEIGDJ EQUAL 16
 17640         GO TO 8030-CERT-NOT-OPEN,
 17641               8035-CERT-NOT-FOUND
 17642         DEPENDING ON DFHEIGDI
 17643     ELSE IF DFHEIGDJ EQUAL 17
 17644         GO TO 8020-ACCT-NOT-OPEN,
 17645               6500-ACCT-NOT-FOUND,
 17646               6500-ONLY-STOP
 17647         DEPENDING ON DFHEIGDI
 17648     ELSE IF DFHEIGDJ EQUAL 18
 17649         GO TO 8080-COMP-NOT-OPEN,
 17650               6600-COMP-NOT-FOUND
 17651         DEPENDING ON DFHEIGDI
 17652     ELSE IF DFHEIGDJ EQUAL 19
 17653         GO TO 8040-CNTL-NOT-OPEN,
 17654               6630-CNTL2-NOT-FOUND
 17655         DEPENDING ON DFHEIGDI
 17656     ELSE IF DFHEIGDJ EQUAL 20
 17657         GO TO 8090-MAIL-NOT-OPEN,
 17658               6700-MAIL-NOT-FOUND
 17659         DEPENDING ON DFHEIGDI
 17660     ELSE IF DFHEIGDJ EQUAL 21
 17661         GO TO 8040-CNTL-NOT-OPEN,
 17662               6750-EXIT
 17663         DEPENDING ON DFHEIGDI
 17664     ELSE IF DFHEIGDJ EQUAL 22
 17665         GO TO 8040-CNTL-NOT-OPEN,
 17666               6800-EXIT
 17667         DEPENDING ON DFHEIGDI
 17668     ELSE IF DFHEIGDJ EQUAL 23
 17669         GO TO 8045-CHEK-NOT-OPEN,
 17670               6850-CHEK-NOT-FOUND
 17671         DEPENDING ON DFHEIGDI
 17672     ELSE IF DFHEIGDJ EQUAL 24
 17673         GO TO 8085-PYAJ-NOT-OPEN,
 17674               6900-PYAJ-NOT-FOUND
 17675         DEPENDING ON DFHEIGDI
 17676     ELSE IF DFHEIGDJ EQUAL 25
 17677         GO TO 7700-TS-ERROR,
 17678               7700-TS-ERROR
 17679         DEPENDING ON DFHEIGDI
 17680     ELSE IF DFHEIGDJ EQUAL 26
 17681         GO TO 7780-EXIT
 17682         DEPENDING ON DFHEIGDI
 17683     ELSE IF DFHEIGDJ EQUAL 27
 17684         GO TO 8040-CNTL-NOT-OPEN,
 17685               7945-NOT-FOUND
 17686         DEPENDING ON DFHEIGDI
 17687     ELSE IF DFHEIGDJ EQUAL 28
 17688         GO TO 7935-TERM-ERROR,
 17689               7940-TRAN-ERROR
 17690         DEPENDING ON DFHEIGDI
 17691     ELSE IF DFHEIGDJ EQUAL 29
 17692         GO TO 8010-ARCH-NOT-OPEN,
 17693               1070-ARCH-NOT-FOUND,
 17694               1070-ARCH-NOT-FOUND
 17695         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:54 Page 378
* EL689.cbl
 17696     ELSE IF DFHEIGDJ EQUAL 30
 17697         GO TO 8300-SEND-TEXT
 17698         DEPENDING ON DFHEIGDI.
 17699     MOVE '9%                    "   ' TO DFHEIV0
 17700     MOVE 'EL689' TO DFHEIV1
 17701     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17702     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      232188     Code:       60183
