* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    47* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    48* 021418  CR2017110200001  TANA  EDIT NAME CHANGE AGST INSRD TYPE
    49* 052918  CR2018031500002  TANA  Add Message for filing time limit
    50* 061418  IR2018053000003  TANA  Fix Causal state / filing limit
    51* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    52* 011020  IR2019121100004  PEMA  ADD last name to compare.
    53* 071720  CR2019112600001  TANA  Remove filing time limit error
    54******************************************************************
    55
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page   3
* EL131.cbl
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
    60
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63
    64 77  FILLER  PIC X(32)  VALUE '********************************'.
    65 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    66 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    67 77  s1                          pic s999 comp-3 value+0.
    68 77  s2                          pic s999 comp-3 value+0.
    69 77  a1                          pic s999 comp-3 value+0.
    70 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    71 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    72 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    73 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    74 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    75 77  ws-max-extension            pic s999 comp-3 value +0.
    76 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    77 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    78 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    79     88  ERPDEF-FOUND                 VALUE 'Y'.
    80 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    81     88  TRLR-FILE-EOF                VALUE 'Y'.
    82 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    83     88  PAYMENT-PENDING              VALUE 'Y'.
    84 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    85     88  AUTH-RCVD                    VALUE 'Y'.
    86     88  NO-AUTH-RCVD                 VALUE 'N'.
    87 77  ws-eracct-sw                pic x  value ' '.
    88     88  acct-found                value 'Y'.
    89 77  ws-benper-sw                pic x   value ' '.
    90     88  good-benper               value 'Y'.
    91 77  ws-claim-type               pic x value ' '.
    92 77  ws-ben-per                  pic 99 value 00.
    93 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    94 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    95 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    96 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    97
    98 01  LCP-TIME-OF-DAY-XX.
    99     05  LCP-TIME-OF-DAY-68        PIC 9(6).
   100     05  FILLER                    PIC 99.
   101 01  LCP-CICS-TIME                 PIC 9(15).
   102*                            COPY ELCSCTM.
   103******************************************************************
   104*                                                                *
   105*                                                                *
   106*                            ELCSCTM                             *
   107*                            VMOD=2.001                          *
   108*                                                                *
   109*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   110*                                                                *
   111******************************************************************
   112 01  SECURITY-MESSAGE.
   113     12  FILLER                          PIC X(30)
   114            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page   4
* EL131.cbl
   115     12  SM-READ                         PIC X(6).
   116     12  FILLER                          PIC X(5)
   117            VALUE ' PGM='.
   118     12  SM-PGM                          PIC X(6).
   119     12  FILLER                          PIC X(5)
   120            VALUE ' OPR='.
   121     12  SM-PROCESSOR-ID                 PIC X(4).
   122     12  FILLER                          PIC X(6)
   123            VALUE ' TERM='.
   124     12  SM-TERMID                       PIC X(4).
   125     12  FILLER                          PIC XX   VALUE SPACE.
   126     12  SM-JUL-DATE                     PIC 9(5).
   127     12  FILLER                          PIC X    VALUE SPACE.
   128     12  SM-TIME                         PIC 99.99.
   129
   130
   131*                            COPY ELCSCRTY.
   132******************************************************************
   133*                                                                *
   134*                                                                *
   135*                            ELCSCRTY                            *
   136*                            VMOD=2.001                          *
   137*                                                                *
   138*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   139*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   140*        SAVED IN PI-SECURITY-ADDRESS.                           *
   141*                                                                *
   142******************************************************************
   143 01  SECURITY-CONTROL.
   144     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   145     12  FILLER                       PIC XX    VALUE 'SC'.
   146     12  SC-CREDIT-CODES.
   147         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   148             20  SC-CREDIT-DISPLAY    PIC X.
   149             20  SC-CREDIT-UPDATE     PIC X.
   150     12  SC-CLAIMS-CODES.
   151         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   152             20  SC-CLAIMS-DISPLAY    PIC X.
   153             20  SC-CLAIMS-UPDATE     PIC X.
   154
   155*                            COPY ELCNWA.
   156*****************************************************************
   157*                                                               *
   158*                                                               *
   159*                            ELCNWA.                            *
   160*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   161*                            VMOD=2.003                         *
   162*                                                               *
   163*            M O V E   N A M E   W O R K   A R E A.             *
   164*                                                               *
   165*****************************************************************.
   166
   167 01  WS-NAME-WORK-AREA.
   168     05  WS-INSURED-LAST-NAME        PIC X(15).
   169     05  WS-INSURED-1ST-NAME         PIC X(12).
   170     05  WS-INSURED-MID-INIT         PIC X.
   171
   172     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page   5
* EL131.cbl
   173         10  WS-NW                   PIC X
   174             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   175
   176     05  WS-NAME-WORK2.
   177         10  WS-NW2                  PIC X
   178             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   179                                        NWA-INDEX0.
   180
   181     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   182                                     COMP-3.
   183
   184
   185 01  ws-dcc-error-line.
   186     05  filler occurs 15.
   187         10  ws-error-no        pic x(4).
   188 01  WS-DATE-AREA.
   189     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   190     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   191     12  SAVE-DATE-CCYYMMDD.
   192         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   193         16  SAVE-DATE-YMD.
   194             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   195             20  FILLER         PIC X(4)    VALUE SPACES.
   196
   197 01  WS-BLANK                   PIC X       VALUE ' '.
   198
   199 01  CSO-WORK-FIELDS.
   200     05  WS-HOLD-CLAIM-STATUS    PIC X.
   201     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   202     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   203         10  WS-RECURRENT-YN     PIC X.
   204         10  FILLER              PIC X.
   205
   206 01  LITERALS-NUMBERS.
   207     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   208     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   209     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   210     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   211     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   212     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   213     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   214     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   215
   216     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   217     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   218     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   219     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   220     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   221     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   222     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   223     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   224     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   225     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   226
   227     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   228
   229     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   230
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page   6
* EL131.cbl
   231     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   232     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   233     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   234     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   235     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   236     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   237     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   238     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   239     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   240     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   241     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   242     12  WS-CONTEST-NOTE      PIC X(44)
   243         VALUE 'CONTRACT NOW CONTESTABLE - INC/RPT DT CHGD'.
   244     12  WS-FILE-LIM-NOTE     PIC X(44)
   245         VALUE 'FILING TIME LIMIT OK - INCRD DT CHGD'.
   246
   247     12  WS-FILING-NOTE     PIC X(30)
   248         VALUE 'FILING TIME LIMIT EXCEEDED'.
   249
   250     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   251     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   252     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   253     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   254         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   255     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   256     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   257     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   258     12  WS-ICD-CODE-1           PIC X(8).
   259     12  WS-ICD-CODE-2           PIC X(8).
   260     12  WS-CLAIM-SEQU.
   261         16  FILLER              PIC X VALUE '('.
   262         16  WS-CURRENT-SEQU     PIC Z9.
   263         16  FILLER              PIC X(04) VALUE ' OF '.
   264         16  WS-OF-SEQU          PIC Z9.
   265         16  FILLER              PIC X VALUE ')'.
   266     12  WS-EDIT-BEN-CODE        PIC XX.
   267         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   268                                          '90' THRU '99'.
   269
   270     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   271     12  WS-EDIT-NUMBER          PIC ZZZ9.
   272
   273     12  WS-RESPONSE             PIC S9(8)   COMP.
   274         88  WS-RESP-NORMAL              VALUE +00.
   275         88  WS-RESP-ERROR               VALUE +01.
   276         88  WS-RESP-NOTFND              VALUE +13.
   277         88  WS-RESP-DUPKEY              VALUE +15.
   278         88  WS-RESP-NOTOPEN             VALUE +19.
   279         88  WS-RESP-ENDFILE             VALUE +20.
   280
   281     12  WS-MOS-PAID             PIC 999.
   282     12  WS-ODD-DAYS             PIC 99.
   283     12  WS-REM-MOS              PIC 999.
   284     12  WS-REM-DAYS             PIC 99.
   285     12  WS-TERM-IN-DAYS         PIC 9(4).
   286     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   287
   288     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page   7
* EL131.cbl
   289     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   290     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   291     12  WS-RESET-SW             PIC X       VALUE 'N'.
   292     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   293     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   294     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   295
   296 01  DMD-DATE-YYYYMMDD.
   297     12  DMD-DECADE          PIC XX      VALUE SPACES.
   298     12  DMD-YYMMDD.
   299         16  DMD-YY          PIC XX      VALUE SPACES.
   300         16  DMD-MM          PIC XX      VALUE SPACES.
   301         16  DMD-DD          PIC XX      VALUE SPACES.
   302
   303 01  DMD-DATE-MMDDYYYY.
   304     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   305     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   306     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   307     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   308     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   309     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   310
   311 01  WS-MAIL-CODE.
   312     12  FILLER              PIC X.
   313     12  DMD-MAIL-CODE.
   314         16  WS-MAIL-4       PIC X(4).
   315         16  WS-MAIL-5       PIC X.
   316     12  FILLER              PIC X(4).
   317
   318     12  W-NAME-LAST             PIC  X(15).
   319     12  W-NAME-FIRST            PIC  X(15).
   320     12  W-NAME-MIDDLE.
   321         16  FILLER              PIC  X.
   322         16  W-NAME-MIDDLE-2     PIC  X.
   323         16  FILLER              PIC  X(13).
   324
   325*    COPY ELCDCTB.
   326******************************************************************
   327*                                                                *
   328*                                                                *
   329*                            ELCDCTB.                            *
   330*                            VMOD=2.002                          *
   331*                                                                *
   332*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   333*       COMMUNICATIONS AREA                                      *
   334*                                                                *
   335******************************************************************
   336 01  DCT-COMMUNICATION-AREA.
   337     12  DCT-BILLING-BANK-ID      PIC  X(05).
   338     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   339     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   340     12  DCT-PRODUCT-CODE         PIC  X(02).
   341     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   342     12  DCT-RETURN-CODE          PIC  X(02).
   343     12  DCT-MAIL-CODE            PIC  X(05).
   344     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   345     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page   8
* EL131.cbl
   347 01  ERROR-SWITCHES.
   348     12  ERROR-SWITCH            PIC X.
   349         88  SCREEN-ERROR                    VALUE 'X'.
   350     12  MSTR-KEY-SWITCH         PIC X.
   351         88  MSTR-KEY-CHANGED                VALUE 'X'.
   352     12  CERT-KEY-SWITCH         PIC X.
   353*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   354         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   355*********SET TO Y IF PRIMARY KEY WILL CHANGE
   356         88  CERT-KEY-CHANGED                VALUE 'Y'.
   357     12  MSTR-SWITCH             PIC X.
   358         88  MSTR-UPDATES                    VALUE 'X'.
   359     12  crtt-switch             pic x value spaces.
   360         88  crtt-update             value 'X'.
   361     12  CERT-SWITCH             PIC X.
   362         88  CERT-UPDATES                    VALUE 'X'.
   363     12  UPDATE-SWITCH           PIC X.
   364         88  UPDATES-PRESENT                 VALUE 'X'.
   365     12  TRLR-SWITCH             PIC X.
   366         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   367         88  UPDATE-MADE                     VALUE 'Y'.
   368     12  NINETY-TRLR-SWITCH      PIC X.
   369         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   370     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   371         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   372     12  EARNINGS-CALC-SWITCH    PIC X.
   373         88  TEX-REG                         VALUE '4'.
   374         88  NET-PAY                         VALUE '5'.
   375     12  DLYACTV-SW              PIC X       VALUE 'N'.
   376         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page   9
* EL131.cbl
   378 01  EDIT-WORK-AREA.
   379     12  COUNT-2                 PIC 9.
   380     12  CALL-PGM                PIC X(8).
   381     12  TRANS-ID                PIC X(4).
   382     12  CHECK-PFKEYS            PIC 99.
   383     12  CHECK-MAINT             PIC X.
   384         88  ADD-ALPHA-RECORD                VALUE 'A'.
   385         88  CHANGE-CLAIM                    VALUE 'C'.
   386         88  DELETE-CLAIM                    VALUE 'D'.
   387         88  CHANGE-NAME                     VALUE 'N'.
   388         88  VALID-OPTIONS                   VALUE 'A' 'C'
   389                                                   'D' 'N'.
   390
   391     12  HOLD-BENEFIT            PIC XX.
   392     12  HOLD-FREQ               PIC XX.
   393     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   394     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   395     12  HOLD-PDTHRU             PIC XX.
   396     12  HOLD-ADDON              PIC XX.
   397     12  HOLD-NODAYS             PIC 9(4).
   398     12  HOLD-NOPMTS             PIC 9(3).
   399     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   400     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   401     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   402     12  HOLD-BIRTH              PIC XX.
   403     12  HOLD-END                PIC XX.
   404     12  HOLD-EFF                PIC XX.
   405     12  HOLD-ENTRY              PIC XX.
   406     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   407     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   408     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   409     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   410     12  HOLD-LF-CV-CAN          PIC XX.
   411     12  HOLD-AH-CV-CAN          PIC XX.
   412     12  DIVIDE-QUOT             PIC 9(3).
   413     12  DIVIDE-REM              PIC 9(3).
   414
   415     12  WS-ALPHA-DATE.
   416         16  WS-ALPHA-YEAR.
   417             20  WS-ALPHA-YY-1   PIC 99.
   418             20  WS-ALPHA-YY-2   PIC 99.
   419         16  WS-ALPHA-MM         PIC 99.
   420         16  WS-ALPHA-DD         PIC 99.
   421
   422     12  BUILD-VALID-DATE.
   423         16  BUILD-MONTH         PIC 99.
   424         16  BUILD-DAY           PIC 99.
   425         16  BUILD-YEAR          PIC 99.
   426     12  DEEDIT-MMYY-INPUT.
   427         16  FILLER              PIC X.
   428         16  DEEDIT-MONTH        PIC XX.
   429         16  DEEDIT-YEAR         PIC XX.
   430     12  DEEDIT-BEN              PIC 9(9)V99.
   431     12  DEEDIT-DATE-INPUT.
   432         16  FILLER              PIC XX.
   433         16  DEEDIT-DATE         PIC X(6).
   434     12  WORK-DATE-MDY.
   435         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  10
* EL131.cbl
   436         16  FILLER              PIC X(4).
   437         16  YEAR-WORK           PIC XX.
   438     12  WORK-DATE-MY.
   439         16  WORK-MONTH          PIC XX.
   440         16  WORK-SLASH          PIC X       VALUE '/'.
   441         16  WORK-YEAR           PIC XX.
   442     12  HOLD-DATE.
   443         16  HOLD-MONTH          PIC 99.
   444         16  FILLER              PIC X(4).
   445         16  HOLD-YEAR           PIC 99.
   446     12  SPLIT-INFO-LINE-1.
   447         16  SPLIT-INFO-DESC     PIC X(15).
   448         16  FILLER              PIC X(5)    VALUE ' OLD='.
   449         16  SPLIT-INFO-OLD      PIC X(40).
   450     12  EFF-TERM-MO             PIC 9(4).
   451     12  CURR-MO                 PIC 9(4).
   452     12  WS-BIN-CURRENT-DT       PIC XX.
   453     12  WS-CALC-METHOD          PIC X.
   454     12  WS-INITIALS.
   455         16  WS-INIT-1           PIC X.
   456         16  WS-INIT-2           PIC X.
   457     12  WS-REIN-TABLE.
   458         16  WS-REIN-1           PIC X.
   459         16  WS-REIN-2           PIC X.
   460         16  WS-REIN-3           PIC X.
   461     12  PI-KEY.
   462         16  PI-TERM             PIC X(4).
   463         16  PI-QUAL             PIC X(4).
   464     12  CHECK-KEY               PIC X(20).
   465     12  SAVE-ACCT-KEY           PIC X(20).
   466     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   467     12  WS-SOC-SEC-NUMBER.
   468         16  WS-SOC-SEC-NO       PIC 9(9).
   469         16  WS-SOC-SEC-BLANK    PIC X(2).
   470     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   471         16  WS-SSN-1-3          PIC 9(3).
   472         16  WS-SSN-DASH1        PIC X(1).
   473         16  WS-SSN-4-5          PIC 9(2).
   474         16  WS-SSN-DASH2        PIC X(1).
   475         16  WS-SSN-6-9          PIC 9(4).
   476     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   477     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   478
   479 01  WS-SAVE-FIELDS.
   480     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   481     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   482     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   483     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   484     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   485     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   486     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   487     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   488     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   489     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   490     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   491     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   492     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   493     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  11
* EL131.cbl
   494     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   495     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   496     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   497     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   498     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   499     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   500     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   501     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   502     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   503     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   504     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   505     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   506     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   507     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   508     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   509     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   510     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   511     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   512     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   513     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   514     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   515     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   516     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   517     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   518     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   519     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   520     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   521     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   522     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   523     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   524     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   525     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   526     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   527     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   528     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   529     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   530     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   531     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   532     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   533     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   534     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   535
   536 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   537     12  M                   PIC S9(7)V99           VALUE ZEROS.
   538     12  L                   PIC S9(7)V99           VALUE ZEROS.
   539     12  N                   PIC S9(3)              VALUE ZEROS.
   540     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   541     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   542     12  I                   PIC S99V9(5)           VALUE ZEROS.
   543     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   544     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   545     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   546     12  R                   PIC S9(3)              VALUE ZEROS.
   547     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   548     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   549     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   550     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   551     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  12
* EL131.cbl
   552     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   553     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   554     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   555     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   556
   557 01  TERM-CALC-WORK-AREA.
   558     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   559     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   560     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   561     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   562     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   563     12  V-EXPONENTS.
   564        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   565     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   566
   567 01  TIME-IN.
   568     12  UN-HOURS                PIC XX.
   569     12  UN-MINUTES              PIC XX.
   570     12  FILLER                  PIC XX.
   571
   572 01  TIME-OUT.
   573     12  FOR-HOURS               PIC XX.
   574     12  FILLER                  PIC X       VALUE '.'.
   575     12  FOR-MINUTES             PIC XX.
   576
   577 01  ERROR-NUMBERS.
   578     12  ER-0000                 PIC X(4)    VALUE '0000'.
   579     12  ER-0004                 PIC X(4)    VALUE '0004'.
   580     12  ER-0008                 PIC X(4)    VALUE '0008'.
   581     12  ER-0023                 PIC X(4)    VALUE '0023'.
   582     12  ER-0029                 PIC X(4)    VALUE '0029'.
   583     12  ER-0068                 PIC X(4)    VALUE '0068'.
   584     12  ER-0070                 PIC X(4)    VALUE '0070'.
   585     12  ER-0149                 PIC X(4)    VALUE '0149'.
   586     12  ER-0154                 PIC X(4)    VALUE '0154'.
   587     12  ER-0169                 PIC X(4)    VALUE '0169'.
   588     12  ER-0192                 PIC X(4)    VALUE '0192'.
   589     12  ER-0199                 PIC X(4)    VALUE '0199'.
   590     12  ER-0203                 PIC X(4)    VALUE '0203'.
   591     12  ER-0204                 PIC X(4)    VALUE '0204'.
   592     12  ER-0205                 PIC X(4)    VALUE '0205'.
   593     12  ER-0206                 PIC X(4)    VALUE '0206'.
   594     12  ER-0208                 PIC X(4)    VALUE '0208'.
   595     12  ER-0210                 PIC X(4)    VALUE '0210'.
   596     12  ER-0215                 PIC X(4)    VALUE '0215'.
   597     12  ER-0219                 PIC X(4)    VALUE '0219'.
   598     12  ER-0220                 PIC X(4)    VALUE '0220'.
   599     12  ER-0222                 PIC X(4)    VALUE '0222'.
   600     12  ER-0223                 PIC X(4)    VALUE '0223'.
   601     12  ER-0224                 PIC X(4)    VALUE '0224'.
   602     12  ER-0227                 PIC X(4)    VALUE '0227'.
   603     12  ER-0230                 PIC X(4)    VALUE '0230'.
   604     12  ER-0232                 PIC X(4)    VALUE '0232'.
   605     12  ER-0233                 PIC X(4)    VALUE '0233'.
   606     12  ER-0236                 PIC X(4)    VALUE '0236'.
   607     12  ER-0237                 PIC X(4)    VALUE '0237'.
   608     12  ER-0238                 PIC X(4)    VALUE '0238'.
   609     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  13
* EL131.cbl
   610     12  ER-0241                 PIC X(4)    VALUE '0241'.
   611     12  ER-0243                 PIC X(4)    VALUE '0243'.
   612     12  ER-0244                 PIC X(4)    VALUE '0244'.
   613     12  ER-0246                 PIC X(4)    VALUE '0246'.
   614     12  ER-0247                 PIC X(4)    VALUE '0247'.
   615     12  ER-0248                 PIC X(4)    VALUE '0248'.
   616     12  ER-0250                 PIC X(4)    VALUE '0250'.
   617     12  ER-0251                 PIC X(4)    VALUE '0251'.
   618     12  ER-0253                 PIC X(4)    VALUE '0253'.
   619     12  ER-0256                 PIC X(4)    VALUE '0256'.
   620     12  ER-0257                 PIC X(4)    VALUE '0257'.
   621     12  ER-0258                 PIC X(4)    VALUE '0258'.
   622     12  ER-0259                 PIC X(4)    VALUE '0259'.
   623     12  ER-0260                 PIC X(4)    VALUE '0260'.
   624     12  ER-0261                 PIC X(4)    VALUE '0261'.
   625     12  ER-0262                 PIC X(4)    VALUE '0262'.
   626     12  ER-0263                 PIC X(4)    VALUE '0263'.
   627     12  ER-0273                 PIC X(4)    VALUE '0273'.
   628     12  ER-0274                 PIC X(4)    VALUE '0274'.
   629     12  ER-0276                 PIC X(4)    VALUE '0276'.
   630     12  ER-0282                 PIC X(4)    VALUE '0282'.
   631     12  ER-0283                 PIC X(4)    VALUE '0283'.
   632     12  ER-0309                 PIC X(4)    VALUE '0309'.
   633     12  ER-0310                 PIC X(4)    VALUE '0310'.
   634     12  ER-0311                 PIC X(4)    VALUE '0311'.
   635     12  ER-0333                 PIC X(4)    VALUE '0333'.
   636     12  ER-0360                 PIC X(4)    VALUE '0360'.
   637     12  ER-0377                 PIC X(4)    VALUE '0377'.
   638     12  ER-0402                 PIC X(4)    VALUE '0402'.
   639     12  ER-0416                 PIC X(4)    VALUE '0416'.
   640     12  ER-0426                 PIC X(4)    VALUE '0426'.
   641     12  ER-0427                 PIC X(4)    VALUE '0427'.
   642     12  ER-0428                 PIC X(4)    VALUE '0428'.
   643     12  ER-0429                 PIC X(4)    VALUE '0429'.
   644     12  ER-0430                 PIC X(4)    VALUE '0430'.
   645     12  ER-0458                 PIC X(4)    VALUE '0458'.
   646     12  ER-0475                 PIC X(4)    VALUE '0475'.
   647     12  ER-0491                 PIC X(4)    VALUE '0491'.
   648     12  ER-0509                 PIC X(4)    VALUE '0509'.
   649     12  ER-0510                 PIC X(4)    VALUE '0510'.
   650     12  ER-0511                 PIC X(4)    VALUE '0511'.
   651     12  ER-0512                 PIC X(4)    VALUE '0512'.
   652     12  ER-0519                 PIC X(4)    VALUE '0519'.
   653     12  ER-0520                 PIC X(4)    VALUE '0520'.
   654     12  ER-0521                 PIC X(4)    VALUE '0521'.
   655     12  ER-0547                 PIC X(4)    VALUE '0547'.
   656     12  ER-0548                 PIC X(4)    VALUE '0548'.
   657     12  ER-0549                 PIC X(4)    VALUE '0549'.
   658     12  ER-0565                 PIC X(4)    VALUE '0565'.
   659     12  ER-0598                 PIC X(4)    VALUE '0598'.
   660     12  ER-0639                 PIC X(4)    VALUE '0639'.
   661     12  ER-0797                 PIC X(4)    VALUE '0797'.
   662     12  ER-0802                 PIC X(4)    VALUE '0802'.
   663     12  ER-0803                 PIC X(4)    VALUE '0803'.
   664     12  ER-0849                 PIC X(4)    VALUE '0849'.
   665     12  ER-0885                 PIC X(4)    VALUE '0885'.
   666     12  ER-0887                 PIC X(4)    VALUE '0887'.
   667     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  14
* EL131.cbl
   668     12  ER-0921                 PIC X(4)    VALUE '0921'.
   669     12  ER-0938                 PIC X(4)    VALUE '0938'.
   670     12  ER-0946                 PIC X(4)    VALUE '0946'.
   671     12  ER-0947                 PIC X(4)    VALUE '0947'.
   672     12  ER-0948                 PIC X(4)    VALUE '0948'.
   673     12  ER-0949                 PIC X(4)    VALUE '0949'.
   674     12  ER-0950                 PIC X(4)    VALUE '0950'.
   675     12  ER-0951                 PIC X(4)    VALUE '0951'.
   676     12  ER-0954                 PIC X(4)    VALUE '0954'.
   677     12  ER-0974                 PIC X(4)    VALUE '0974'.
   678     12  ER-0975                 PIC X(4)    VALUE '0975'.
   679     12  ER-0992                 PIC X(4)    VALUE '0992'.
   680     12  er-1581                 pic x(4)    value '1581'.
   681     12  ER-1651                 PIC X(4)    VALUE '1651'.
   682     12  ER-1652                 PIC X(4)    VALUE '1652'.
   683     12  ER-1653                 PIC X(4)    VALUE '1653'.
   684     12  ER-1654                 PIC X(4)    VALUE '1654'.
   685     12  ER-1655                 PIC X(4)    VALUE '1655'.
   686     12  er-1656                 pic x(4)    value '1656'.
   687     12  ER-1661                 PIC X(4)    VALUE '1661'.
   688     12  ER-1662                 PIC X(4)    VALUE '1662'.
   689     12  ER-1663                 PIC X(4)    VALUE '1663'.
   690     12  er-1664                 pic x(4)    value '1664'.
   691     12  er-1665                 pic x(4)    value '1665'.
   692     12  er-1666                 pic x(4)    value '1666'.
   693     12  er-1668                 pic x(4)    value '1668'.
   694     12  er-1669                 pic x(4)    value '1669'.
   695     12  er-1675                 pic x(4)    value '1675'.
   696     12  er-1676                 pic x(4)    value '1676'.
   697     12  ER-1678                 PIC X(4)    VALUE '1678'.
   698     12  ER-1679                 PIC X(4)    VALUE '1679'.
   699     12  ER-1772                 PIC X(4)    VALUE '1772'.
   700     12  ER-1773                 PIC X(4)    VALUE '1773'.
   701     12  ER-1778                 PIC X(4)    VALUE '1778'.
   702     12  ER-2280                 PIC X(4)    VALUE '2280'.
   703     12  ER-2878                 PIC X(4)    VALUE '2878'.
   704     12  ER-7572                 PIC X(4)    VALUE '7572'.
   705     12  ER-7641                 PIC X(4)    VALUE '7641'.
   706     12  ER-7642                 PIC X(4)    VALUE '7642'.
   707     12  ER-7650                 PIC X(4)    VALUE '7650'.
   708     12  ER-7651                 PIC X(4)    VALUE '7651'.
   709     12  ER-7687                 PIC X(4)    VALUE '7687'.
   710     12  ER-7689                 PIC X(4)    VALUE '7689'.
   711     12  ER-7690                 PIC X(4)    VALUE '7690'.
   712     12  ER-7691                 PIC X(4)    VALUE '7691'.
   713     12  ER-8003                 PIC X(4)    VALUE '8003'.
   714     12  ER-8051                 PIC X(4)    VALUE '8051'.
   715     12  ER-8052                 PIC X(4)    VALUE '8052'.
   716     12  ER-8053                 PIC X(4)    VALUE '8053'.
   717     12  ER-8054                 PIC X(4)    VALUE '8054'.
   718     12  ER-8055                 PIC X(4)    VALUE '8055'.
   719     12  ER-8056                 PIC X(4)    VALUE '8056'.
   720     12  ER-8057                 PIC X(4)    VALUE '8057'.
   721     12  ER-8058                 PIC X(4)    VALUE '8058'.
   722     12  ER-8059                 PIC X(4)    VALUE '8059'.
   723     12  ER-8060                 PIC X(4)    VALUE '8060'.
   724     12  ER-8061                 PIC X(4)    VALUE '8061'.
   725     12  ER-8062                 PIC X(4)    VALUE '8062'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  15
* EL131.cbl
   726     12  ER-8063                 PIC X(4)    VALUE '8063'.
   727     12  ER-8064                 PIC X(4)    VALUE '8064'.
   728     12  ER-8065                 PIC X(4)    VALUE '8065'.
   729     12  ER-8066                 PIC X(4)    VALUE '8066'.
   730     12  ER-8152                 PIC X(4)    VALUE '8152'.
   731     12  ER-8153                 PIC X(4)    VALUE '8153'.
   732     12  ER-8154                 PIC X(4)    VALUE '8154'.
   733     12  ER-8155                 PIC X(4)    VALUE '8155'.
   734 01  ERPDEF-KEY-SAVE             PIC X(18).
   735 01  ERPDEF-KEY.
   736     12  ERPDEF-COMPANY-CD       PIC X.
   737     12  ERPDEF-STATE            PIC XX.
   738     12  ERPDEF-PROD-CD          PIC XXX.
   739     12  F                       PIC X(7).
   740     12  ERPDEF-BEN-TYPE         PIC X.
   741     12  ERPDEF-BEN-CODE         PIC XX.
   742     12  ERPDEF-EXP-DT           PIC XX.
   743 01  MSTR-KEY.
   744     12  COMPANY-CODE            PIC X.
   745     12  CARRIER-CODE            PIC X.
   746     12  CLAIM-NO                PIC X(7).
   747     12  CERT-NO.
   748         16  CERT-NO-PRIME       PIC X(10).
   749         16  CERT-NO-SUFX        PIC X.
   750
   751 01  WS-SAVE-CLAIM-KEY.
   752     12  WS-SAVE-COMPANY-CD      PIC X.
   753     12  WS-SAVE-CARRIER         PIC X.
   754     12  WS-SAVE-CLAIM-NO        PIC X(7).
   755     12  WS-SAVE-CERT-NO.
   756         16  WS-CERT-NO-PRIME    PIC X(10).
   757         16  WS-CERT-NO-SUFX     PIC X.
   758
   759 01  CERT-KEY.
   760     12  CERT-COMPANY-CODE       PIC X.
   761     12  CERT-CARRIER            PIC X.
   762     12  CERT-GROUP              PIC X(6).
   763     12  CERT-STATE              PIC XX.
   764     12  CERT-ACCOUNT            PIC X(10).
   765     12  CERT-DATE               PIC XX.
   766     12  CERT-CERT.
   767         16  CERT-CERT-PRIME     PIC X(10).
   768         16  CERT-CERT-SUFX      PIC X.
   769
   770 01  ELCRTT-KEY.
   771     05  CTRLR-COMP-CD       PIC X.
   772     05  CTRLR-CARRIER       PIC X.
   773     05  CTRLR-GROUPING      PIC X(6).
   774     05  CTRLR-STATE         PIC X(2).
   775     05  CTRLR-ACCOUNT       PIC X(10).
   776     05  CTRLR-EFF-DT        PIC XX.
   777     05  CTRLR-CERT-NO       PIC X(11).
   778     05  CTRLR-REC-TYPE      PIC X.
   779 01  NOTE-KEY.
   780     12  NOTE-COMP-CD            PIC X.
   781     12  NOTE-CERT-KEY.
   782         16  NOTE-CARRIER        PIC X.
   783         16  NOTE-GROUP          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  16
* EL131.cbl
   784         16  NOTE-STATE          PIC XX.
   785         16  NOTE-ACCOUNT        PIC X(10).
   786         16  NOTE-DATE           PIC XX.
   787         16  NOTE-CERT-NO        PIC X(11).
   788
   789 01  TRLR-KEY.
   790     12  TRLR-MAIN-KEY.
   791         16  TRLR-COMPANY-CD     PIC X.
   792         16  TRLR-CARRIER        PIC X.
   793         16  TRLR-CLAIM-NO       PIC X(07).
   794         16  TRLR-CERT-NO        PIC X(11).
   795     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   796
   797 01  BENEFIT-KEY.
   798     12  BEN-CO-ID               PIC X(3).
   799     12  BEN-REC-TYPE            PIC X.
   800     12  FILLER                  PIC XX.
   801     12  BEN-ACC-CD              PIC XX.
   802     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   803
   804 01  CNTL-KEY.
   805     12  CNTL-CO-ID              PIC X(3).
   806     12  CNTL-REC-TYPE           PIC X.
   807     12  CNTL-PROC-ID            PIC X(4).
   808     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   809         16  CNTL-STATE-NUMBER   PIC XX.
   810         16  FILLER              PIC XX.
   811     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   812         16  FILLER              PIC X(3).
   813         16  CNTL-CARRIER        PIC X.
   814     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   815
   816 01  ACTQ-KEY                    PIC X(20).
   817
   818 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   819
   820 01  CHKQ-KEY.
   821     12  CHKQ-COMPANY-CODE       PIC X.
   822     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   823     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   824
   825 01  ARCH-KEY.
   826     12  ARCH-COMPANY-CODE       PIC X.
   827     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   828     12  ARCH-RECORD-TYPE        PIC X.
   829     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   830
   831 01  ACCT-KEY.
   832     05  ACCT-PARTIAL-KEY.
   833         12  ACCT-COMPANY-CODE   PIC X.
   834         12  ACCT-CARRIER        PIC X.
   835         12  ACCT-GROUP          PIC X(6).
   836         12  ACCT-STATE          PIC XX.
   837         12  ACCT-ACCOUNT        PIC X(10).
   838     05  ACCT-DATE               PIC XX.
   839
   840 01  WS-ELBENE-KEY.
   841     12  WS-ELBENE-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  17
* EL131.cbl
   842     12  WS-ELBENE-RECORD-TYPE   PIC X.
   843     12  WS-ELBENE-ID            PIC X(10).
   844
   845 01  ELALPH-KEY.
   846     12  ELALPH-COMPANY-CD       PIC X.
   847     12  ELALPH-SOURCE           PIC X.
   848     12  ELALPH-NAME.
   849         16  ELALPH-LAST-NAME    PIC X(15).
   850         16  ELALPH-FIRST-NAME.
   851             20  ELALPH-FIRST-INIT   PIC X.
   852             20  FILLER              PIC X(11).
   853         16  ELALPH-MIDDLE-INIT  PIC X.
   854     12  ELALPH-DATE             PIC X(08).
   855     12  ELALPH-TIME             PIC S9(04)    COMP.
   856
   857 01  COMP-LENGTHS.
   858     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   859     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   860     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   861     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   862     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   863     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   864     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   865     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   866     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   867     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   868     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   869     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   870     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   871     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  18
* EL131.cbl
   873*                                COPY ELCLNKLT.
   874******************************************************************
   875*                                                                *
   876*                                                                *
   877*                           ELCLNKLT                             *
   878*                            VMOD=2.003                          *
   879*                                                                *
   880*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   881*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   882*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   883*                                                                *
   884*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   885*   COMPLETING THE REQUIRED FIELDS.                              *
   886*                                                                *
   887*   THE CALLING PROGRAM SHOULD CHECK:                            *
   888*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   889*                              9999 INDICATES AN UNKNOWN ABEND   *
   890*                                   WAS DETECTED.                *
   891*                              ALL OTHER VALUES ARE NORMAL ERROR *
   892*                              CODES FOUND IN THE ERROR FILE.    *
   893******************************************************************
   894 01  W-1523-LINKDATA.
   895     12  W-1523-COMMON-PI-DATA.
   896         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   897         16  FILLER              PIC  X(67).
   898         16  W-1523-COMPANY-CD   PIC  X(01).
   899         16  FILLER              PIC  X(10).
   900         16  W-1523-CONTROL-IN-PROGRESS.
   901             20  W-1523-CARRIER  PIC  X(01).
   902             20  W-1523-GROUPING PIC  X(06).
   903             20  W-1523-STATE    PIC  X(02).
   904             20  W-1523-ACCOUNT  PIC  X(10).
   905             20  W-1523-CLAIM-CERT-GRP.
   906                 24  W-1523-CLAIM-NO
   907                                 PIC  X(07).
   908                 24  W-1523-CERT-NO.
   909                     28  W-1523-CERT-PRIME
   910                                 PIC  X(10).
   911                     28  W-1523-CERT-SFX
   912                                 PIC  X(01).
   913                 24  W-1523-CERT-EFF-DT
   914                                 PIC  X(02).
   915         16  FILLER              PIC X(265).
   916
   917     12  W-1523-WORK-AREA.
   918         16  W-1523-FORM-NUMBER  PIC  X(04).
   919         16  W-1523-NUMBER-COPIES
   920                                 PIC  9(01).
   921         16  W-1523-ADDR-TYPE    PIC  X(02).
   922         16  W-1523-FOLLOW-UP-DATE
   923                                 PIC  X(02).
   924         16  W-1523-RESEND-DATE  PIC  X(02).
   925         16  W-1523-ERROR-CODE   PIC  9(04).
   926             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   927             88  W-1523-FATAL-ERROR
   928                                    VALUES  0006 0013 0042
   929                                            0154 0168 0169
   930                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  19
* EL131.cbl
   931                                            0179 0186 0281
   932                                            0332 2055 3697
   933                                            3698 3699 3770
   934                                            3771 3772 7675
   935                                            9106 9808 9883
   936                                            9887.
   937             88  W-1523-STOP-ERRORS
   938                                    VALUES  0013 0042 0154
   939                                            0168 0169 0172
   940                                            0281 0332 2055
   941                                            3698 3699 7675
   942                                            9106 9808 9883
   943                                            9999.
   944         16  W-1523-REASON       PIC  X(70).
   945         16  W-1523-ARCHIVE-NUMBER
   946                                 PIC  9(08).
   947     12  W-1523-POINTER-AREA.
   948         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   949         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   950         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   951         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   952         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  20
* EL131.cbl
   954*                                COPY ELCINTF.
   955******************************************************************
   956*                                                                *
   957*                                                                *
   958*                            ELCINTF.                            *
   959*                            VMOD=2.017                          *
   960*                                                                *
   961*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   962*                                                                *
   963*       LENGTH = 1024                                            *
   964*                                                                *
   965******************************************************************
   966*                   C H A N G E   L O G
   967*
   968* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   969*-----------------------------------------------------------------
   970*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   971* EFFECTIVE    NUMBER
   972*-----------------------------------------------------------------
   973* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   974******************************************************************
   975 01  PROGRAM-INTERFACE-BLOCK.
   976     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   977     12  PI-CALLING-PROGRAM              PIC X(8).
   978     12  PI-SAVED-PROGRAM-1              PIC X(8).
   979     12  PI-SAVED-PROGRAM-2              PIC X(8).
   980     12  PI-SAVED-PROGRAM-3              PIC X(8).
   981     12  PI-SAVED-PROGRAM-4              PIC X(8).
   982     12  PI-SAVED-PROGRAM-5              PIC X(8).
   983     12  PI-SAVED-PROGRAM-6              PIC X(8).
   984     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   985     12  PI-COMPANY-ID                   PIC XXX.
   986     12  PI-COMPANY-CD                   PIC X.
   987
   988     12  PI-COMPANY-PASSWORD             PIC X(8).
   989
   990     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   991
   992     12  PI-CONTROL-IN-PROGRESS.
   993         16  PI-CARRIER                  PIC X.
   994         16  PI-GROUPING                 PIC X(6).
   995         16  PI-STATE                    PIC XX.
   996         16  PI-ACCOUNT                  PIC X(10).
   997         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   998                                         PIC X(10).
   999         16  PI-CLAIM-CERT-GRP.
  1000             20  PI-CLAIM-NO             PIC X(7).
  1001             20  PI-CERT-NO.
  1002                 25  PI-CERT-PRIME       PIC X(10).
  1003                 25  PI-CERT-SFX         PIC X.
  1004             20  PI-CERT-EFF-DT          PIC XX.
  1005         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1006             20  PI-PLAN-CODE            PIC X(2).
  1007             20  PI-REVISION-NUMBER      PIC X(3).
  1008             20  PI-PLAN-EFF-DT          PIC X(2).
  1009             20  PI-PLAN-EXP-DT          PIC X(2).
  1010             20  FILLER                  PIC X(11).
  1011         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  21
* EL131.cbl
  1012             20  PI-OE-REFERENCE-1.
  1013                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1014                 25  PI-OE-REF-1-SUFF    PIC XX.
  1015
  1016     12  PI-SESSION-IN-PROGRESS          PIC X.
  1017         88  CLAIM-SESSION                   VALUE '1'.
  1018         88  CREDIT-SESSION                  VALUE '2'.
  1019         88  WARRANTY-SESSION                VALUE '3'.
  1020         88  MORTGAGE-SESSION                VALUE '4'.
  1021         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1022
  1023
  1024*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1025
  1026     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1027     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1028
  1029     12  PI-CREDIT-USER                  PIC X.
  1030         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1031         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1032
  1033     12  PI-CLAIM-USER                   PIC X.
  1034         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1035         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1036
  1037     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1038         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1039         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1040         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1041         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1042         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1043
  1044     12  PI-PROCESSOR-ID                 PIC X(4).
  1045
  1046     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1047
  1048     12  PI-MEMBER-CAPTION               PIC X(10).
  1049
  1050     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1051         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1052
  1053     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1054     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1055     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1056     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1057
  1058     12  PI-AH-OVERRIDE-L1               PIC X.
  1059     12  PI-AH-OVERRIDE-L2               PIC XX.
  1060     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1061     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1062
  1063     12  PI-NEW-SYSTEM                   PIC X(2).
  1064
  1065     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1066     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1067         88  PI-USES-PAID-TO                 VALUE '1'.
  1068     12  PI-CRDTCRD-SYSTEM.
  1069         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  22
* EL131.cbl
  1070             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1071             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1072         16  PI-CC-MONTH-END-DT          PIC XX.
  1073     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1074
  1075     12  PI-OE-REFERENCE-2.
  1076         16  PI-OE-REF-2-PRIME           PIC X(10).
  1077         16  PI-OE-REF-2-SUFF            PIC X.
  1078
  1079     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1080
  1081     12  PI-LANGUAGE-TYPE                PIC X.
  1082             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1083             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1084             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1085
  1086     12  PI-POLICY-LINKAGE-IND           PIC X.
  1087         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1088         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1089                                                   LOW-VALUES.
  1090
  1091     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1092     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1093         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1094         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1095
  1096     12  PI-PROCESSOR-CSR-IND            PIC X.
  1097         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1098         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1099
  1100     12  FILLER                          PIC X(3).
  1101
  1102     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1103
  1104     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1105         PI-SYSTEM-LEVEL.
  1106
  1107         16  PI-ENTRY-CODES.
  1108             20  PI-ENTRY-CD-1           PIC X.
  1109             20  PI-ENTRY-CD-2           PIC X.
  1110
  1111         16  PI-RETURN-CODES.
  1112             20  PI-RETURN-CD-1          PIC X.
  1113             20  PI-RETURN-CD-2          PIC X.
  1114
  1115         16  PI-UPDATE-STATUS-SAVE.
  1116             20  PI-UPDATE-BY            PIC X(4).
  1117             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1118
  1119         16  PI-LOWER-CASE-LETTERS       PIC X.
  1120             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1121
  1122*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1123*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1124*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1125
  1126         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1127             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  23
* EL131.cbl
  1128             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1129             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1130             88  ACCNT-CNTL                  VALUE '3'.
  1131             88  CARR-ACCNT-CNTL             VALUE '4'.
  1132
  1133         16  PI-PROCESSOR-CAP-LIST.
  1134             20  PI-SYSTEM-CONTROLS.
  1135                24 PI-SYSTEM-DISPLAY     PIC X.
  1136                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1137                24 PI-SYSTEM-MODIFY      PIC X.
  1138                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1139             20  FILLER                  PIC XX.
  1140             20  PI-DISPLAY-CAP          PIC X.
  1141                 88  DISPLAY-CAP             VALUE 'Y'.
  1142             20  PI-MODIFY-CAP           PIC X.
  1143                 88  MODIFY-CAP              VALUE 'Y'.
  1144             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1145                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1146             20  PI-FORCE-CAP            PIC X.
  1147                 88  FORCE-CAP               VALUE 'Y'.
  1148
  1149         16  PI-PROGRAM-CONTROLS.
  1150             20  PI-PGM-PRINT-OPT        PIC X.
  1151             20  PI-PGM-FORMAT-OPT       PIC X.
  1152             20  PI-PGM-PROCESS-OPT      PIC X.
  1153             20  PI-PGM-TOTALS-OPT       PIC X.
  1154
  1155         16  PI-HELP-INTERFACE.
  1156             20  PI-LAST-ERROR-NO        PIC X(4).
  1157             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1158
  1159         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1160             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1161
  1162         16  PI-CR-CONTROL-IN-PROGRESS.
  1163             20  PI-CR-CARRIER           PIC X.
  1164             20  PI-CR-GROUPING          PIC X(6).
  1165             20  PI-CR-STATE             PIC XX.
  1166             20  PI-CR-ACCOUNT           PIC X(10).
  1167             20  PI-CR-FIN-RESP          PIC X(10).
  1168             20  PI-CR-TYPE              PIC X.
  1169
  1170         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1171
  1172         16  PI-CR-MONTH-END-DT          PIC XX.
  1173
  1174         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1175             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1176             88  PI-ZERO-CARRIER             VALUE '1'.
  1177             88  PI-ZERO-GROUPING            VALUE '2'.
  1178             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1179
  1180         16  PI-CARRIER-SECURITY         PIC X.
  1181             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1182
  1183         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1184             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1185             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  24
* EL131.cbl
  1186
  1187         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1188             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1189                                         INDEXED BY PI-ACCESS-NDX
  1190                                         PIC X.
  1191
  1192         16  PI-GA-BILLING-CONTROL       PIC X.
  1193             88  PI-GA-BILLING               VALUE '1'.
  1194
  1195         16  PI-MAIL-PROCESSING          PIC X.
  1196             88  PI-MAIL-YES                 VALUE 'Y'.
  1197
  1198         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1199
  1200         16  PI-AR-SYSTEM.
  1201             20  PI-AR-PROCESSING-CNTL   PIC X.
  1202                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1203             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1204             20  PI-AR-MONTH-END-DT      PIC XX.
  1205
  1206         16  PI-MP-SYSTEM.
  1207             20  PI-MORTGAGE-USER            PIC X.
  1208                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1209                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1210             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1211                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1212                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1213                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1214                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1215                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1216             20  PI-MP-MONTH-END-DT          PIC XX.
  1217             20  PI-MP-REFERENCE-NO.
  1218                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1219                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1220
  1221         16  PI-LABEL-CONTROL            PIC X(01).
  1222             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1223             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1224
  1225         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1226             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1227
  1228         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1229             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1230             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1231
  1232         16  FILLER                      PIC X(14).
  1233
  1234     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1235******************************************************************
  1236     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1237         16  PI-NO-PMTS                    PIC 9(4).
  1238         16  PI-CERT-SWITCH                PIC X.
  1239             88  CREATED-CERT              VALUE '2'.
  1240         16  PI-PREM-TYPE                  PIC X.
  1241         16  PI-SAVE-CERT-NO.
  1242             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1243             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  25
* EL131.cbl
  1244         16  FILLER                        PIC X(46).
  1245         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1246         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1247         16  PI-REC-FOUND-SW               PIC X.
  1248         16  PI-LETTER-SW                  PIC X.
  1249         16  PI-PREV-TRLR-KEY              PIC X(22).
  1250         16  pi-claim-type                 pic x.
  1251         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1252         16  pi-approval-level             pic x.
  1253         16  FILLER                        PIC X(543).
  1254
  1255 01  SAVE-RECORD                 PIC X(450).
  1256
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  26
* EL131.cbl
  1258*                                COPY ELCLOGOF SUPPRESS.
  1259******************************************************************
  1260*                                                                *
  1261*                                                                *
  1262*                            ELCLOGOF.                           *
  1263*                            VMOD=2.001                          *
  1264*                                                                *
  1265*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1266*                                                                *
  1267******************************************************************
  1268 01  CLASIC-LOGOFF.
  1269     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1270     12  LOGOFF-TEXT.
  1271         16  FILLER          PIC X(5)    VALUE SPACES.
  1272         16  LOGOFF-MSG.
  1273             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1274             20  FILLER      PIC X       VALUE SPACES.
  1275             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1276         16  FILLER          PIC X(80)
  1277           VALUE '* YOU ARE NOW LOGGED OFF'.
  1278         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1279         16  FILLER          PIC X       VALUE QUOTE.
  1280         16  LOGOFF-SYS-MSG  PIC X(17)
  1281           VALUE 'S CLAS-IC SYSTEM '.
  1282     12  TEXT-MESSAGES.
  1283         16  UNACCESS-MSG    PIC X(29)
  1284             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1285         16  PGMIDERR-MSG    PIC X(17)
  1286             VALUE 'PROGRAM NOT FOUND'.
  1287
  1288*                                COPY ELCATTR SUPPRESS.
  1289******************************************************************
  1290*                                                                *
  1291*                            ELCATTR.                            *
  1292*                            VMOD=2.001                          *
  1293*                                                                *
  1294*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1295*                                                                *
  1296*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1297*                                                                *
  1298*                   POS 1   P=PROTECTED                          *
  1299*                           U=UNPROTECTED                        *
  1300*                           S=ASKIP                              *
  1301*                   POS 2   A=ALPHA/NUMERIC                      *
  1302*                           N=NUMERIC                            *
  1303*                   POS 3   N=NORMAL                             *
  1304*                           B=BRIGHT                             *
  1305*                           D=DARK                               *
  1306*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1307*                           OF=MODIFIED DATA TAG OFF             *
  1308*                                                                *
  1309*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1310******************************************************************
  1311 01  ATTRIBUTE-LIST.
  1312     12  AL-PABOF            PIC X       VALUE 'Y'.
  1313     12  AL-PABON            PIC X       VALUE 'Z'.
  1314     12  AL-PADOF            PIC X       VALUE '%'.
  1315     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  27
* EL131.cbl
  1316     12  AL-PANOF            PIC X       VALUE '-'.
  1317     12  AL-PANON            PIC X       VALUE '/'.
  1318     12  AL-SABOF            PIC X       VALUE '8'.
  1319     12  AL-SABON            PIC X       VALUE '9'.
  1320     12  AL-SADOF            PIC X       VALUE '@'.
  1321     12  AL-SADON            PIC X       VALUE QUOTE.
  1322     12  AL-SANOF            PIC X       VALUE '0'.
  1323     12  AL-SANON            PIC X       VALUE '1'.
  1324     12  AL-UABOF            PIC X       VALUE 'H'.
  1325     12  AL-UABON            PIC X       VALUE 'I'.
  1326     12  AL-UADOF            PIC X       VALUE '<'.
  1327     12  AL-UADON            PIC X       VALUE '('.
  1328     12  AL-UANOF            PIC X       VALUE ' '.
  1329     12  AL-UANON            PIC X       VALUE 'A'.
  1330     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1331     12  AL-UNBON            PIC X       VALUE 'R'.
  1332     12  AL-UNDOF            PIC X       VALUE '*'.
  1333     12  AL-UNDON            PIC X       VALUE ')'.
  1334     12  AL-UNNOF            PIC X       VALUE '&'.
  1335     12  AL-UNNON            PIC X       VALUE 'J'.
  1336
  1337*                                COPY ELCAID SUPPRESS.
  1338******************************************************************
  1339*                                                                *
  1340*                            ELCAID.                             *
  1341*                            VMOD=2.001                          *
  1342*                                                                *
  1343*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1344*                                                                *
  1345*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1346*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1347******************************************************************
  1348
  1349 01  DFHAID.
  1350   02  DFHNULL   PIC  X  VALUE  ' '.
  1351   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1352   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1353   02  DFHPEN    PIC  X  VALUE  '='.
  1354   02  DFHOPID   PIC  X  VALUE  'W'.
  1355   02  DFHPA1    PIC  X  VALUE  '%'.
  1356   02  DFHPA2    PIC  X  VALUE  '>'.
  1357   02  DFHPA3    PIC  X  VALUE  ','.
  1358   02  DFHPF1    PIC  X  VALUE  '1'.
  1359   02  DFHPF2    PIC  X  VALUE  '2'.
  1360   02  DFHPF3    PIC  X  VALUE  '3'.
  1361   02  DFHPF4    PIC  X  VALUE  '4'.
  1362   02  DFHPF5    PIC  X  VALUE  '5'.
  1363   02  DFHPF6    PIC  X  VALUE  '6'.
  1364   02  DFHPF7    PIC  X  VALUE  '7'.
  1365   02  DFHPF8    PIC  X  VALUE  '8'.
  1366   02  DFHPF9    PIC  X  VALUE  '9'.
  1367   02  DFHPF10   PIC  X  VALUE  ':'.
  1368   02  DFHPF11   PIC  X  VALUE  '#'.
  1369   02  DFHPF12   PIC  X  VALUE  '@'.
  1370   02  DFHPF13   PIC  X  VALUE  'A'.
  1371   02  DFHPF14   PIC  X  VALUE  'B'.
  1372   02  DFHPF15   PIC  X  VALUE  'C'.
  1373   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  28
* EL131.cbl
  1374   02  DFHPF17   PIC  X  VALUE  'E'.
  1375   02  DFHPF18   PIC  X  VALUE  'F'.
  1376   02  DFHPF19   PIC  X  VALUE  'G'.
  1377   02  DFHPF20   PIC  X  VALUE  'H'.
  1378   02  DFHPF21   PIC  X  VALUE  'I'.
  1379*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1380   02  DFHPF22   PIC  X  VALUE  '['.
  1381   02  DFHPF23   PIC  X  VALUE  '.'.
  1382   02  DFHPF24   PIC  X  VALUE  '<'.
  1383   02  DFHMSRE   PIC  X  VALUE  'X'.
  1384   02  DFHSTRF   PIC  X  VALUE  'h'.
  1385   02  DFHTRIG   PIC  X  VALUE  '"'.
  1386 01  FILLER REDEFINES DFHAID.
  1387     12  FILLER                  PIC X(8).
  1388     12  AID-KEYS OCCURS 24 TIMES.
  1389         16  FILLER              PIC X.
  1390
  1391*                                COPY EL131S.
  1392 01  EL131AI.
  1393     05  FILLER            PIC  X(0012).
  1394*    -------------------------------
  1395     05  DATEL PIC S9(0004) COMP.
  1396     05  DATEF PIC  X(0001).
  1397     05  FILLER REDEFINES DATEF.
  1398         10  DATEA PIC  X(0001).
  1399     05  DATEI PIC  X(0008).
  1400*    -------------------------------
  1401     05  TIMEL PIC S9(0004) COMP.
  1402     05  TIMEF PIC  X(0001).
  1403     05  FILLER REDEFINES TIMEF.
  1404         10  TIMEA PIC  X(0001).
  1405     05  TIMEI PIC  X(0005).
  1406*    -------------------------------
  1407     05  SEQUL PIC S9(0004) COMP.
  1408     05  SEQUF PIC  X(0001).
  1409     05  FILLER REDEFINES SEQUF.
  1410         10  SEQUA PIC  X(0001).
  1411     05  SEQUI PIC  X(0010).
  1412*    -------------------------------
  1413     05  COMPL PIC S9(0004) COMP.
  1414     05  COMPF PIC  X(0001).
  1415     05  FILLER REDEFINES COMPF.
  1416         10  COMPA PIC  X(0001).
  1417     05  COMPI PIC  X(0003).
  1418*    -------------------------------
  1419     05  USERIDL PIC S9(0004) COMP.
  1420     05  USERIDF PIC  X(0001).
  1421     05  FILLER REDEFINES USERIDF.
  1422         10  USERIDA PIC  X(0001).
  1423     05  USERIDI PIC  X(0004).
  1424*    -------------------------------
  1425     05  LABEL1L PIC S9(0004) COMP.
  1426     05  LABEL1F PIC  X(0001).
  1427     05  FILLER REDEFINES LABEL1F.
  1428         10  LABEL1A PIC  X(0001).
  1429     05  LABEL1I PIC  X(0011).
  1430*    -------------------------------
  1431     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  29
* EL131.cbl
  1432     05  PCERTNOF PIC  X(0001).
  1433     05  FILLER REDEFINES PCERTNOF.
  1434         10  PCERTNOA PIC  X(0001).
  1435     05  PCERTNOI PIC  X(0010).
  1436*    -------------------------------
  1437     05  PSUFXL PIC S9(0004) COMP.
  1438     05  PSUFXF PIC  X(0001).
  1439     05  FILLER REDEFINES PSUFXF.
  1440         10  PSUFXA PIC  X(0001).
  1441     05  PSUFXI PIC  X(0001).
  1442*    -------------------------------
  1443     05  CCNOL PIC S9(0004) COMP.
  1444     05  CCNOF PIC  X(0001).
  1445     05  FILLER REDEFINES CCNOF.
  1446         10  CCNOA PIC  X(0001).
  1447     05  CCNOI PIC  X(0016).
  1448*    -------------------------------
  1449     05  MAINTL PIC S9(0004) COMP.
  1450     05  MAINTF PIC  X(0001).
  1451     05  FILLER REDEFINES MAINTF.
  1452         10  MAINTA PIC  X(0001).
  1453     05  MAINTI PIC  X(0001).
  1454*    -------------------------------
  1455     05  CLAIML PIC S9(0004) COMP.
  1456     05  CLAIMF PIC  X(0001).
  1457     05  FILLER REDEFINES CLAIMF.
  1458         10  CLAIMA PIC  X(0001).
  1459     05  CLAIMI PIC  X(0007).
  1460*    -------------------------------
  1461     05  CARRL PIC S9(0004) COMP.
  1462     05  CARRF PIC  X(0001).
  1463     05  FILLER REDEFINES CARRF.
  1464         10  CARRA PIC  X(0001).
  1465     05  CARRI PIC  X(0001).
  1466*    -------------------------------
  1467     05  CERTL PIC S9(0004) COMP.
  1468     05  CERTF PIC  X(0001).
  1469     05  FILLER REDEFINES CERTF.
  1470         10  CERTA PIC  X(0001).
  1471     05  CERTI PIC  X(0010).
  1472*    -------------------------------
  1473     05  SUFXL PIC S9(0004) COMP.
  1474     05  SUFXF PIC  X(0001).
  1475     05  FILLER REDEFINES SUFXF.
  1476         10  SUFXA PIC  X(0001).
  1477     05  SUFXI PIC  X(0001).
  1478*    -------------------------------
  1479     05  TYPEL PIC S9(0004) COMP.
  1480     05  TYPEF PIC  X(0001).
  1481     05  FILLER REDEFINES TYPEF.
  1482         10  TYPEA PIC  X(0001).
  1483     05  TYPEI PIC  X(0001).
  1484*    -------------------------------
  1485     05  BENPERL PIC S9(0004) COMP.
  1486     05  BENPERF PIC  X(0001).
  1487     05  FILLER REDEFINES BENPERF.
  1488         10  BENPERA PIC  X(0001).
  1489     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  30
* EL131.cbl
  1490*    -------------------------------
  1491     05  INSTYPEL PIC S9(0004) COMP.
  1492     05  INSTYPEF PIC  X(0001).
  1493     05  FILLER REDEFINES INSTYPEF.
  1494         10  INSTYPEA PIC  X(0001).
  1495     05  INSTYPEI PIC  X(0001).
  1496*    -------------------------------
  1497     05  STATUSL PIC S9(0004) COMP.
  1498     05  STATUSF PIC  X(0001).
  1499     05  FILLER REDEFINES STATUSF.
  1500         10  STATUSA PIC  X(0001).
  1501     05  STATUSI PIC  X(0006).
  1502*    -------------------------------
  1503     05  INCL PIC S9(0004) COMP.
  1504     05  INCF PIC  X(0001).
  1505     05  FILLER REDEFINES INCF.
  1506         10  INCA PIC  X(0001).
  1507     05  INCI PIC  X(0008).
  1508*    -------------------------------
  1509     05  REPL PIC S9(0004) COMP.
  1510     05  REPF PIC  X(0001).
  1511     05  FILLER REDEFINES REPF.
  1512         10  REPA PIC  X(0001).
  1513     05  REPI PIC  X(0008).
  1514*    -------------------------------
  1515     05  ICD1L PIC S9(0004) COMP.
  1516     05  ICD1F PIC  X(0001).
  1517     05  FILLER REDEFINES ICD1F.
  1518         10  ICD1A PIC  X(0001).
  1519     05  ICD1I PIC  X(0008).
  1520*    -------------------------------
  1521     05  ICD2L PIC S9(0004) COMP.
  1522     05  ICD2F PIC  X(0001).
  1523     05  FILLER REDEFINES ICD2F.
  1524         10  ICD2A PIC  X(0001).
  1525     05  ICD2I PIC  X(0008).
  1526*    -------------------------------
  1527     05  DIAGL PIC S9(0004) COMP.
  1528     05  DIAGF PIC  X(0001).
  1529     05  FILLER REDEFINES DIAGF.
  1530         10  DIAGA PIC  X(0001).
  1531     05  DIAGI PIC  X(0060).
  1532*    -------------------------------
  1533     05  ACCSWL PIC S9(0004) COMP.
  1534     05  ACCSWF PIC  X(0001).
  1535     05  FILLER REDEFINES ACCSWF.
  1536         10  ACCSWA PIC  X(0001).
  1537     05  ACCSWI PIC  X(0001).
  1538*    -------------------------------
  1539     05  BENEL PIC S9(0004) COMP.
  1540     05  BENEF PIC  X(0001).
  1541     05  FILLER REDEFINES BENEF.
  1542         10  BENEA PIC  X(0001).
  1543     05  BENEI PIC  X(0010).
  1544*    -------------------------------
  1545     05  BIRTHL PIC S9(0004) COMP.
  1546     05  BIRTHF PIC  X(0001).
  1547     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  31
* EL131.cbl
  1548         10  BIRTHA PIC  X(0001).
  1549     05  BIRTHI PIC  X(0008).
  1550*    -------------------------------
  1551     05  SOCIALL PIC S9(0004) COMP.
  1552     05  SOCIALF PIC  X(0001).
  1553     05  FILLER REDEFINES SOCIALF.
  1554         10  SOCIALA PIC  X(0001).
  1555     05  SOCIALI PIC  X(0011).
  1556*    -------------------------------
  1557     05  SEXL PIC S9(0004) COMP.
  1558     05  SEXF PIC  X(0001).
  1559     05  FILLER REDEFINES SEXF.
  1560         10  SEXA PIC  X(0001).
  1561     05  SEXI PIC  X(0001).
  1562*    -------------------------------
  1563     05  MLNAMEL PIC S9(0004) COMP.
  1564     05  MLNAMEF PIC  X(0001).
  1565     05  FILLER REDEFINES MLNAMEF.
  1566         10  MLNAMEA PIC  X(0001).
  1567     05  MLNAMEI PIC  X(0015).
  1568*    -------------------------------
  1569     05  MFNAMEL PIC S9(0004) COMP.
  1570     05  MFNAMEF PIC  X(0001).
  1571     05  FILLER REDEFINES MFNAMEF.
  1572         10  MFNAMEA PIC  X(0001).
  1573     05  MFNAMEI PIC  X(0012).
  1574*    -------------------------------
  1575     05  MMINITL PIC S9(0004) COMP.
  1576     05  MMINITF PIC  X(0001).
  1577     05  FILLER REDEFINES MMINITF.
  1578         10  MMINITA PIC  X(0001).
  1579     05  MMINITI PIC  X(0001).
  1580*    -------------------------------
  1581     05  AUTHRCVL PIC S9(0004) COMP.
  1582     05  AUTHRCVF PIC  X(0001).
  1583     05  FILLER REDEFINES AUTHRCVF.
  1584         10  AUTHRCVA PIC  X(0001).
  1585     05  AUTHRCVI PIC  X(0001).
  1586*    -------------------------------
  1587     05  CRTLNMEL PIC S9(0004) COMP.
  1588     05  CRTLNMEF PIC  X(0001).
  1589     05  FILLER REDEFINES CRTLNMEF.
  1590         10  CRTLNMEA PIC  X(0001).
  1591     05  CRTLNMEI PIC  X(0015).
  1592*    -------------------------------
  1593     05  CRTFNMEL PIC S9(0004) COMP.
  1594     05  CRTFNMEF PIC  X(0001).
  1595     05  FILLER REDEFINES CRTFNMEF.
  1596         10  CRTFNMEA PIC  X(0001).
  1597     05  CRTFNMEI PIC  X(0012).
  1598*    -------------------------------
  1599     05  CRTINITL PIC S9(0004) COMP.
  1600     05  CRTINITF PIC  X(0001).
  1601     05  FILLER REDEFINES CRTINITF.
  1602         10  CRTINITA PIC  X(0001).
  1603     05  CRTINITI PIC  X(0001).
  1604*    -------------------------------
  1605     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  32
* EL131.cbl
  1606     05  LOANBALF PIC  X(0001).
  1607     05  FILLER REDEFINES LOANBALF.
  1608         10  LOANBALA PIC  X(0001).
  1609     05  LOANBALI PIC  9(7)V99.
  1610*    -------------------------------
  1611     05  PROCL PIC S9(0004) COMP.
  1612     05  PROCF PIC  X(0001).
  1613     05  FILLER REDEFINES PROCF.
  1614         10  PROCA PIC  X(0001).
  1615     05  PROCI PIC  X(0004).
  1616*    -------------------------------
  1617     05  SUPVL PIC S9(0004) COMP.
  1618     05  SUPVF PIC  X(0001).
  1619     05  FILLER REDEFINES SUPVF.
  1620         10  SUPVA PIC  X(0001).
  1621     05  SUPVI PIC  X(0001).
  1622*    -------------------------------
  1623     05  PRICDL PIC S9(0004) COMP.
  1624     05  PRICDF PIC  X(0001).
  1625     05  FILLER REDEFINES PRICDF.
  1626         10  PRICDA PIC  X(0001).
  1627     05  PRICDI PIC  X(0001).
  1628*    -------------------------------
  1629     05  CRITPL PIC S9(0004) COMP.
  1630     05  CRITPF PIC  X(0001).
  1631     05  FILLER REDEFINES CRITPF.
  1632         10  CRITPA PIC  X(0001).
  1633     05  CRITPI PIC  X(0002).
  1634*    -------------------------------
  1635     05  EXTENSL PIC S9(0004) COMP.
  1636     05  EXTENSF PIC  X(0001).
  1637     05  FILLER REDEFINES EXTENSF.
  1638         10  EXTENSA PIC  X(0001).
  1639     05  EXTENSI PIC  99.
  1640*    -------------------------------
  1641     05  FILETOL PIC S9(0004) COMP.
  1642     05  FILETOF PIC  X(0001).
  1643     05  FILLER REDEFINES FILETOF.
  1644         10  FILETOA PIC  X(0001).
  1645     05  FILETOI PIC  X(0004).
  1646*    -------------------------------
  1647     05  PTHRHDGL PIC S9(0004) COMP.
  1648     05  PTHRHDGF PIC  X(0001).
  1649     05  FILLER REDEFINES PTHRHDGF.
  1650         10  PTHRHDGA PIC  X(0001).
  1651     05  PTHRHDGI PIC  X(0010).
  1652*    -------------------------------
  1653     05  PDTHRUL PIC S9(0004) COMP.
  1654     05  PDTHRUF PIC  X(0001).
  1655     05  FILLER REDEFINES PDTHRUF.
  1656         10  PDTHRUA PIC  X(0001).
  1657     05  PDTHRUI PIC  X(0008).
  1658*    -------------------------------
  1659     05  PDAMTL PIC S9(0004) COMP.
  1660     05  PDAMTF PIC  X(0001).
  1661     05  FILLER REDEFINES PDAMTF.
  1662         10  PDAMTA PIC  X(0001).
  1663     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  33
* EL131.cbl
  1664*    -------------------------------
  1665     05  NODAYSL PIC S9(0004) COMP.
  1666     05  NODAYSF PIC  X(0001).
  1667     05  FILLER REDEFINES NODAYSF.
  1668         10  NODAYSA PIC  X(0001).
  1669     05  NODAYSI PIC  9(5).
  1670*    -------------------------------
  1671     05  NOPMTSL PIC S9(0004) COMP.
  1672     05  NOPMTSF PIC  X(0001).
  1673     05  FILLER REDEFINES NOPMTSF.
  1674         10  NOPMTSA PIC  X(0001).
  1675     05  NOPMTSI PIC  9(4).
  1676*    -------------------------------
  1677     05  FORMTYPL PIC S9(0004) COMP.
  1678     05  FORMTYPF PIC  X(0001).
  1679     05  FILLER REDEFINES FORMTYPF.
  1680         10  FORMTYPA PIC  X(0001).
  1681     05  FORMTYPI PIC  X(0001).
  1682*    -------------------------------
  1683     05  ESTL PIC S9(0004) COMP.
  1684     05  ESTF PIC  X(0001).
  1685     05  FILLER REDEFINES ESTF.
  1686         10  ESTA PIC  X(0001).
  1687     05  ESTI PIC  X(0008).
  1688*    -------------------------------
  1689     05  AUIDL PIC S9(0004) COMP.
  1690     05  AUIDF PIC  X(0001).
  1691     05  FILLER REDEFINES AUIDF.
  1692         10  AUIDA PIC  X(0001).
  1693     05  AUIDI PIC  X(0004).
  1694*    -------------------------------
  1695     05  OCCL PIC S9(0004) COMP.
  1696     05  OCCF PIC  X(0001).
  1697     05  FILLER REDEFINES OCCF.
  1698         10  OCCA PIC  X(0001).
  1699     05  OCCI PIC  X(0006).
  1700*    -------------------------------
  1701     05  MNTDTL PIC S9(0004) COMP.
  1702     05  MNTDTF PIC  X(0001).
  1703     05  FILLER REDEFINES MNTDTF.
  1704         10  MNTDTA PIC  X(0001).
  1705     05  MNTDTI PIC  X(0008).
  1706*    -------------------------------
  1707     05  MNTTYPEL PIC S9(0004) COMP.
  1708     05  MNTTYPEF PIC  X(0001).
  1709     05  FILLER REDEFINES MNTTYPEF.
  1710         10  MNTTYPEA PIC  X(0001).
  1711     05  MNTTYPEI PIC  X(0006).
  1712*    -------------------------------
  1713     05  CERTCARL PIC S9(0004) COMP.
  1714     05  CERTCARF PIC  X(0001).
  1715     05  FILLER REDEFINES CERTCARF.
  1716         10  CERTCARA PIC  X(0001).
  1717     05  CERTCARI PIC  X(0001).
  1718*    -------------------------------
  1719     05  CERTGRPL PIC S9(0004) COMP.
  1720     05  CERTGRPF PIC  X(0001).
  1721     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  34
* EL131.cbl
  1722         10  CERTGRPA PIC  X(0001).
  1723     05  CERTGRPI PIC  X(0006).
  1724*    -------------------------------
  1725     05  CERTSTL PIC S9(0004) COMP.
  1726     05  CERTSTF PIC  X(0001).
  1727     05  FILLER REDEFINES CERTSTF.
  1728         10  CERTSTA PIC  X(0001).
  1729     05  CERTSTI PIC  X(0002).
  1730*    -------------------------------
  1731     05  CERTACTL PIC S9(0004) COMP.
  1732     05  CERTACTF PIC  X(0001).
  1733     05  FILLER REDEFINES CERTACTF.
  1734         10  CERTACTA PIC  X(0001).
  1735     05  CERTACTI PIC  X(0010).
  1736*    -------------------------------
  1737     05  CERTEFFL PIC S9(0004) COMP.
  1738     05  CERTEFFF PIC  X(0001).
  1739     05  FILLER REDEFINES CERTEFFF.
  1740         10  CERTEFFA PIC  X(0001).
  1741     05  CERTEFFI PIC  X(0008).
  1742*    -------------------------------
  1743     05  ISSAGEL PIC S9(0004) COMP.
  1744     05  ISSAGEF PIC  X(0001).
  1745     05  FILLER REDEFINES ISSAGEF.
  1746         10  ISSAGEA PIC  X(0001).
  1747     05  ISSAGEI PIC  X(0002).
  1748*    -------------------------------
  1749     05  APRL PIC S9(0004) COMP.
  1750     05  APRF PIC  X(0001).
  1751     05  FILLER REDEFINES APRF.
  1752         10  APRA PIC  X(0001).
  1753     05  APRI PIC  9(4)V9(4).
  1754*    -------------------------------
  1755     05  PMTFREQL PIC S9(0004) COMP.
  1756     05  PMTFREQF PIC  X(0001).
  1757     05  FILLER REDEFINES PMTFREQF.
  1758         10  PMTFREQA PIC  X(0001).
  1759     05  PMTFREQI PIC  99.
  1760*    -------------------------------
  1761     05  INDGRPL PIC S9(0004) COMP.
  1762     05  INDGRPF PIC  X(0001).
  1763     05  FILLER REDEFINES INDGRPF.
  1764         10  INDGRPA PIC  X(0001).
  1765     05  INDGRPI PIC  X(0001).
  1766*    -------------------------------
  1767     05  PREMTYPL PIC S9(0004) COMP.
  1768     05  PREMTYPF PIC  X(0001).
  1769     05  FILLER REDEFINES PREMTYPF.
  1770         10  PREMTYPA PIC  X(0001).
  1771     05  PREMTYPI PIC  X(0001).
  1772*    -------------------------------
  1773     05  REINCDL PIC S9(0004) COMP.
  1774     05  REINCDF PIC  X(0001).
  1775     05  FILLER REDEFINES REINCDF.
  1776         10  REINCDA PIC  X(0001).
  1777     05  REINCDI PIC  X(0001).
  1778*    -------------------------------
  1779     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  35
* EL131.cbl
  1780     05  JNTLNMEF PIC  X(0001).
  1781     05  FILLER REDEFINES JNTLNMEF.
  1782         10  JNTLNMEA PIC  X(0001).
  1783     05  JNTLNMEI PIC  X(0015).
  1784*    -------------------------------
  1785     05  JNTFNMEL PIC S9(0004) COMP.
  1786     05  JNTFNMEF PIC  X(0001).
  1787     05  FILLER REDEFINES JNTFNMEF.
  1788         10  JNTFNMEA PIC  X(0001).
  1789     05  JNTFNMEI PIC  X(0012).
  1790*    -------------------------------
  1791     05  JNTINITL PIC S9(0004) COMP.
  1792     05  JNTINITF PIC  X(0001).
  1793     05  FILLER REDEFINES JNTINITF.
  1794         10  JNTINITA PIC  X(0001).
  1795     05  JNTINITI PIC  X(0001).
  1796*    -------------------------------
  1797     05  JNTAGEL PIC S9(0004) COMP.
  1798     05  JNTAGEF PIC  X(0001).
  1799     05  FILLER REDEFINES JNTAGEF.
  1800         10  JNTAGEA PIC  X(0001).
  1801     05  JNTAGEI PIC  X(0002).
  1802*    -------------------------------
  1803     05  ADDONDTL PIC S9(0004) COMP.
  1804     05  ADDONDTF PIC  X(0001).
  1805     05  FILLER REDEFINES ADDONDTF.
  1806         10  ADDONDTA PIC  X(0001).
  1807     05  ADDONDTI PIC  X(0008).
  1808*    -------------------------------
  1809     05  LCVDSCRL PIC S9(0004) COMP.
  1810     05  LCVDSCRF PIC  X(0001).
  1811     05  FILLER REDEFINES LCVDSCRF.
  1812         10  LCVDSCRA PIC  X(0001).
  1813     05  LCVDSCRI PIC  X(0006).
  1814*    -------------------------------
  1815     05  LCVKINDL PIC S9(0004) COMP.
  1816     05  LCVKINDF PIC  X(0001).
  1817     05  FILLER REDEFINES LCVKINDF.
  1818         10  LCVKINDA PIC  X(0001).
  1819     05  LCVKINDI PIC  X(0003).
  1820*    -------------------------------
  1821     05  LCVCDL PIC S9(0004) COMP.
  1822     05  LCVCDF PIC  X(0001).
  1823     05  FILLER REDEFINES LCVCDF.
  1824         10  LCVCDA PIC  X(0001).
  1825     05  LCVCDI PIC  X(0002).
  1826*    -------------------------------
  1827     05  LCVOTRML PIC S9(0004) COMP.
  1828     05  LCVOTRMF PIC  X(0001).
  1829     05  FILLER REDEFINES LCVOTRMF.
  1830         10  LCVOTRMA PIC  X(0001).
  1831     05  LCVOTRMI PIC  999.
  1832*    -------------------------------
  1833     05  LCVRTRML PIC S9(0004) COMP.
  1834     05  LCVRTRMF PIC  X(0001).
  1835     05  FILLER REDEFINES LCVRTRMF.
  1836         10  LCVRTRMA PIC  X(0001).
  1837     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  36
* EL131.cbl
  1838*    -------------------------------
  1839     05  LCVRATEL PIC S9(0004) COMP.
  1840     05  LCVRATEF PIC  X(0001).
  1841     05  FILLER REDEFINES LCVRATEF.
  1842         10  LCVRATEA PIC  X(0001).
  1843     05  LCVRATEI PIC  9999V99.
  1844*    -------------------------------
  1845     05  LCVBENEL PIC S9(0004) COMP.
  1846     05  LCVBENEF PIC  X(0001).
  1847     05  FILLER REDEFINES LCVBENEF.
  1848         10  LCVBENEA PIC  X(0001).
  1849     05  LCVBENEI PIC  9(9)V99.
  1850*    -------------------------------
  1851     05  LCVFORML PIC S9(0004) COMP.
  1852     05  LCVFORMF PIC  X(0001).
  1853     05  FILLER REDEFINES LCVFORMF.
  1854         10  LCVFORMA PIC  X(0001).
  1855     05  LCVFORMI PIC  X(0012).
  1856*    -------------------------------
  1857     05  LCVCNDTL PIC S9(0004) COMP.
  1858     05  LCVCNDTF PIC  X(0001).
  1859     05  FILLER REDEFINES LCVCNDTF.
  1860         10  LCVCNDTA PIC  X(0001).
  1861     05  LCVCNDTI PIC  X(0008).
  1862*    -------------------------------
  1863     05  LCVEXITL PIC S9(0004) COMP.
  1864     05  LCVEXITF PIC  X(0001).
  1865     05  FILLER REDEFINES LCVEXITF.
  1866         10  LCVEXITA PIC  X(0001).
  1867     05  LCVEXITI PIC  X(0008).
  1868*    -------------------------------
  1869     05  LCVSTATL PIC S9(0004) COMP.
  1870     05  LCVSTATF PIC  X(0001).
  1871     05  FILLER REDEFINES LCVSTATF.
  1872         10  LCVSTATA PIC  X(0001).
  1873     05  LCVSTATI PIC  X(0006).
  1874*    -------------------------------
  1875     05  ACVDSCRL PIC S9(0004) COMP.
  1876     05  ACVDSCRF PIC  X(0001).
  1877     05  FILLER REDEFINES ACVDSCRF.
  1878         10  ACVDSCRA PIC  X(0001).
  1879     05  ACVDSCRI PIC  X(0006).
  1880*    -------------------------------
  1881     05  ACVKINDL PIC S9(0004) COMP.
  1882     05  ACVKINDF PIC  X(0001).
  1883     05  FILLER REDEFINES ACVKINDF.
  1884         10  ACVKINDA PIC  X(0001).
  1885     05  ACVKINDI PIC  X(0003).
  1886*    -------------------------------
  1887     05  ACVCDL PIC S9(0004) COMP.
  1888     05  ACVCDF PIC  X(0001).
  1889     05  FILLER REDEFINES ACVCDF.
  1890         10  ACVCDA PIC  X(0001).
  1891     05  ACVCDI PIC  X(0002).
  1892*    -------------------------------
  1893     05  ACVOTRML PIC S9(0004) COMP.
  1894     05  ACVOTRMF PIC  X(0001).
  1895     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  37
* EL131.cbl
  1896         10  ACVOTRMA PIC  X(0001).
  1897     05  ACVOTRMI PIC  999.
  1898*    -------------------------------
  1899     05  ACVRTRML PIC S9(0004) COMP.
  1900     05  ACVRTRMF PIC  X(0001).
  1901     05  FILLER REDEFINES ACVRTRMF.
  1902         10  ACVRTRMA PIC  X(0001).
  1903     05  ACVRTRMI PIC  X(0003).
  1904*    -------------------------------
  1905     05  ACVRATEL PIC S9(0004) COMP.
  1906     05  ACVRATEF PIC  X(0001).
  1907     05  FILLER REDEFINES ACVRATEF.
  1908         10  ACVRATEA PIC  X(0001).
  1909     05  ACVRATEI PIC  9999V99.
  1910*    -------------------------------
  1911     05  ACVBENEL PIC S9(0004) COMP.
  1912     05  ACVBENEF PIC  X(0001).
  1913     05  FILLER REDEFINES ACVBENEF.
  1914         10  ACVBENEA PIC  X(0001).
  1915     05  ACVBENEI PIC  9(9)V99.
  1916*    -------------------------------
  1917     05  ACVFORML PIC S9(0004) COMP.
  1918     05  ACVFORMF PIC  X(0001).
  1919     05  FILLER REDEFINES ACVFORMF.
  1920         10  ACVFORMA PIC  X(0001).
  1921     05  ACVFORMI PIC  X(0012).
  1922*    -------------------------------
  1923     05  ACVCNDTL PIC S9(0004) COMP.
  1924     05  ACVCNDTF PIC  X(0001).
  1925     05  FILLER REDEFINES ACVCNDTF.
  1926         10  ACVCNDTA PIC  X(0001).
  1927     05  ACVCNDTI PIC  X(0008).
  1928*    -------------------------------
  1929     05  ACVEXITL PIC S9(0004) COMP.
  1930     05  ACVEXITF PIC  X(0001).
  1931     05  FILLER REDEFINES ACVEXITF.
  1932         10  ACVEXITA PIC  X(0001).
  1933     05  ACVEXITI PIC  X(0008).
  1934*    -------------------------------
  1935     05  ACVSTATL PIC S9(0004) COMP.
  1936     05  ACVSTATF PIC  X(0001).
  1937     05  FILLER REDEFINES ACVSTATF.
  1938         10  ACVSTATA PIC  X(0001).
  1939     05  ACVSTATI PIC  X(0006).
  1940*    -------------------------------
  1941     05  LABEL2L PIC S9(0004) COMP.
  1942     05  LABEL2F PIC  X(0001).
  1943     05  FILLER REDEFINES LABEL2F.
  1944         10  LABEL2A PIC  X(0001).
  1945     05  LABEL2I PIC  X(0014).
  1946*    -------------------------------
  1947     05  BCERT1L PIC S9(0004) COMP.
  1948     05  BCERT1F PIC  X(0001).
  1949     05  FILLER REDEFINES BCERT1F.
  1950         10  BCERT1A PIC  X(0001).
  1951     05  BCERT1I PIC  X(0010).
  1952*    -------------------------------
  1953     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  38
* EL131.cbl
  1954     05  BSUFX1F PIC  X(0001).
  1955     05  FILLER REDEFINES BSUFX1F.
  1956         10  BSUFX1A PIC  X(0001).
  1957     05  BSUFX1I PIC  X(0001).
  1958*    -------------------------------
  1959     05  BCERT2L PIC S9(0004) COMP.
  1960     05  BCERT2F PIC  X(0001).
  1961     05  FILLER REDEFINES BCERT2F.
  1962         10  BCERT2A PIC  X(0001).
  1963     05  BCERT2I PIC  X(0010).
  1964*    -------------------------------
  1965     05  BSUFX2L PIC S9(0004) COMP.
  1966     05  BSUFX2F PIC  X(0001).
  1967     05  FILLER REDEFINES BSUFX2F.
  1968         10  BSUFX2A PIC  X(0001).
  1969     05  BSUFX2I PIC  X(0001).
  1970*    -------------------------------
  1971     05  BCERT3L PIC S9(0004) COMP.
  1972     05  BCERT3F PIC  X(0001).
  1973     05  FILLER REDEFINES BCERT3F.
  1974         10  BCERT3A PIC  X(0001).
  1975     05  BCERT3I PIC  X(0010).
  1976*    -------------------------------
  1977     05  BSUFX3L PIC S9(0004) COMP.
  1978     05  BSUFX3F PIC  X(0001).
  1979     05  FILLER REDEFINES BSUFX3F.
  1980         10  BSUFX3A PIC  X(0001).
  1981     05  BSUFX3I PIC  X(0001).
  1982*    -------------------------------
  1983     05  BCERT4L PIC S9(0004) COMP.
  1984     05  BCERT4F PIC  X(0001).
  1985     05  FILLER REDEFINES BCERT4F.
  1986         10  BCERT4A PIC  X(0001).
  1987     05  BCERT4I PIC  X(0010).
  1988*    -------------------------------
  1989     05  BSUFX4L PIC S9(0004) COMP.
  1990     05  BSUFX4F PIC  X(0001).
  1991     05  FILLER REDEFINES BSUFX4F.
  1992         10  BSUFX4A PIC  X(0001).
  1993     05  BSUFX4I PIC  X(0001).
  1994*    -------------------------------
  1995     05  BCERT5L PIC S9(0004) COMP.
  1996     05  BCERT5F PIC  X(0001).
  1997     05  FILLER REDEFINES BCERT5F.
  1998         10  BCERT5A PIC  X(0001).
  1999     05  BCERT5I PIC  X(0010).
  2000*    -------------------------------
  2001     05  BSUFX5L PIC S9(0004) COMP.
  2002     05  BSUFX5F PIC  X(0001).
  2003     05  FILLER REDEFINES BSUFX5F.
  2004         10  BSUFX5A PIC  X(0001).
  2005     05  BSUFX5I PIC  X(0001).
  2006*    -------------------------------
  2007     05  MSG1L PIC S9(0004) COMP.
  2008     05  MSG1F PIC  X(0001).
  2009     05  FILLER REDEFINES MSG1F.
  2010         10  MSG1A PIC  X(0001).
  2011     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  39
* EL131.cbl
  2012*    -------------------------------
  2013     05  MSG2L PIC S9(0004) COMP.
  2014     05  MSG2F PIC  X(0001).
  2015     05  FILLER REDEFINES MSG2F.
  2016         10  MSG2A PIC  X(0001).
  2017     05  MSG2I PIC  X(0072).
  2018*    -------------------------------
  2019     05  PFKEYL PIC S9(0004) COMP.
  2020     05  PFKEYF PIC  X(0001).
  2021     05  FILLER REDEFINES PFKEYF.
  2022         10  PFKEYA PIC  X(0001).
  2023     05  PFKEYI PIC  99.
  2024*    -------------------------------
  2025     05  PFKEY6L PIC S9(0004) COMP.
  2026     05  PFKEY6F PIC  X(0001).
  2027     05  FILLER REDEFINES PFKEY6F.
  2028         10  PFKEY6A PIC  X(0001).
  2029     05  PFKEY6I PIC  X(0016).
  2030 01  EL131AO REDEFINES EL131AI.
  2031     05  FILLER            PIC  X(0012).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  DATEO PIC  X(0008).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  TIMEO PIC  99.99.
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  SEQUO PIC  X(0010).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  COMPO PIC  X(0003).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  USERIDO PIC  X(0004).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  LABEL1O PIC  X(0011).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  PCERTNOO PIC  X(0010).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  PSUFXO PIC  X(0001).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  CCNOO PIC  X(0016).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  MAINTO PIC  X(0001).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  CLAIMO PIC  X(0007).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  CARRO PIC  X(0001).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  40
* EL131.cbl
  2070     05  CERTO PIC  X(0010).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  SUFXO PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  TYPEO PIC  X(0001).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  BENPERO PIC  X(0002).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  INSTYPEO PIC  X(0001).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  STATUSO PIC  X(0006).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  INCO PIC  X(0008).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  REPO PIC  X(0008).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  ICD1O PIC  X(0008).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  ICD2O PIC  X(0008).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  DIAGO PIC  X(0060).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  ACCSWO PIC  X(0001).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  BENEO PIC  X(0010).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  BIRTHO PIC  X(0008).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  SOCIALO PIC  X(0011).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  SEXO PIC  X(0001).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  MLNAMEO PIC  X(0015).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  MFNAMEO PIC  X(0012).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  MMINITO PIC  X(0001).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  41
* EL131.cbl
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  CRTLNMEO PIC  X(0015).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  CRTFNMEO PIC  X(0012).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  CRTINITO PIC  X(0001).
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  LOANBALO PIC  ZZZZZ9.99.
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  PROCO PIC  X(0004).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  SUPVO PIC  X(0001).
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  PRICDO PIC  X(0001).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  CRITPO PIC  X(0002).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  EXTENSO PIC  X(0002).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  FILETOO PIC  X(0004).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  PTHRHDGO PIC  X(0010).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  PDTHRUO PIC  X(0008).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  PDAMTO PIC  Z(06).99.
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  NODAYSO PIC  ZZZ99.
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  NOPMTSO PIC  ZZ99.
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  FORMTYPO PIC  X(0001).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  ESTO PIC  X(0008).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  AUIDO PIC  X(0004).
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  OCCO PIC  X(0006).
  2185*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  42
* EL131.cbl
  2186     05  FILLER            PIC  X(0003).
  2187     05  MNTDTO PIC  X(0008).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  MNTTYPEO PIC  X(0006).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  CERTCARO PIC  X(0001).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  CERTGRPO PIC  X(0006).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  CERTSTO PIC  X(0002).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  CERTACTO PIC  X(0010).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  CERTEFFO PIC  X(0008).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  ISSAGEO PIC  X(0002).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  APRO PIC  9(3).9(4).
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  PMTFREQO PIC  99.
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  INDGRPO PIC  X(0001).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  PREMTYPO PIC  X(0001).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  REINCDO PIC  X(0001).
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  JNTLNMEO PIC  X(0015).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  JNTFNMEO PIC  X(0012).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  JNTINITO PIC  X(0001).
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  JNTAGEO PIC  X(0002).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  ADDONDTO PIC  X(0008).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  LCVDSCRO PIC  X(0006).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  43
* EL131.cbl
  2244     05  LCVKINDO PIC  X(0003).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  LCVCDO PIC  X(0002).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  LCVOTRMO PIC  999.
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  LCVRTRMO PIC  999.
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  LCVRATEO PIC  ZZZ.ZZ.
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  LCVFORMO PIC  X(0012).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  LCVCNDTO PIC  X(0008).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  LCVEXITO PIC  X(0008).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  LCVSTATO PIC  X(0006).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  ACVDSCRO PIC  X(0006).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  ACVKINDO PIC  X(0003).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  ACVCDO PIC  X(0002).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  ACVOTRMO PIC  999.
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  ACVRTRMO PIC  999.
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  ACVRATEO PIC  ZZZ.ZZ.
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  ACVFORMO PIC  X(0012).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  ACVCNDTO PIC  X(0008).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  44
* EL131.cbl
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  ACVSTATO PIC  X(0006).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  LABEL2O PIC  X(0014).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  BCERT1O PIC  X(0010).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  BSUFX1O PIC  X(0001).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  BCERT2O PIC  X(0010).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  BSUFX2O PIC  X(0001).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  BCERT3O PIC  X(0010).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  BSUFX3O PIC  X(0001).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  BCERT4O PIC  X(0010).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  BSUFX4O PIC  X(0001).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  BCERT5O PIC  X(0010).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  BSUFX5O PIC  X(0001).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  MSG1O PIC  X(0072).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  MSG2O PIC  X(0072).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  PFKEYO PIC  X(0002).
  2347*    -------------------------------
  2348     05  FILLER            PIC  X(0003).
  2349     05  PFKEY6O PIC  X(0016).
  2350*    -------------------------------
  2351
  2352*                                COPY ELCEMIB SUPPRESS.
  2353******************************************************************
  2354*                                                                *
  2355*                                                                *
  2356*                            ELCEMIB.                            *
  2357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2358*                            VMOD=2.005                          *
  2359*                                                                *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  45
* EL131.cbl
  2360*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2361*                                                                *
  2362******************************************************************
  2363 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2364     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2365     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2366     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2367     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2368     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2369     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2370     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2371     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2372     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2373         88  EMI-NO-ERRORS                    VALUE '1'.
  2374         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2375         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2376     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2377         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2378     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2379         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2380         88  EMI-AREA1-FULL                   VALUE '2'.
  2381     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2382         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2383         88  EMI-AREA2-FULL                   VALUE '2'.
  2384     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2385         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2386         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2387         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2388         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2389         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2390     12  EMI-ERROR-LINES.
  2391         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2392         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2393         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2394         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2395             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2396                 24  EMI-ERR-NUM         PIC X(4).
  2397                 24  EMI-FILLER          PIC X.
  2398                 24  EMI-SEV             PIC X.
  2399                 24  FILLER              PIC X.
  2400             20  FILLER                  PIC X(02).
  2401     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2402         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2403             20  EMI-ERROR-NUMBER    PIC X(4).
  2404             20  EMI-FILL            PIC X.
  2405             20  EMI-SEVERITY        PIC X.
  2406             20  FILLER              PIC X.
  2407             20  EMI-ERROR-TEXT.
  2408                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2409                 24  FILLER          PIC X(55).
  2410     12  EMI-SEVERITY-SAVE           PIC X.
  2411         88  EMI-NOTE                    VALUE 'N'.
  2412         88  EMI-WARNING                 VALUE 'W'.
  2413         88  EMI-FORCABLE                VALUE 'F'.
  2414         88  EMI-FATAL                   VALUE 'X'.
  2415     12  EMI-MESSAGE-FLAG            PIC X.
  2416         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2417         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  46
* EL131.cbl
  2418     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2419     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2420         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2421         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2422         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2423     12  emi-claim-no                pic x(7).
  2424     12  emi-claim-type              pic x(6).
  2425     12  FILLER                      PIC X(124)  VALUE SPACES.
  2426     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2427     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2428     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2429     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2430
  2431*                                COPY ELCJPFX SUPPRESS.
  2432******************************************************************
  2433*                                                                *
  2434*                                                                *
  2435*                            ELCJPFX.                            *
  2436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2437*                            VMOD=2.002                          *
  2438*                                                                *
  2439*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2440*                                                                *
  2441*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2442*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2443*        ELCNTL - CONTROL FILE                                   *
  2444*        ELMSTR - CLAIM MASTERS                                  *
  2445*        ELTRLR - ACTIVITY TRAILERS                              *
  2446*        ELCHKQ - CHECK QUE                                      *
  2447******************************************************************
  2448 01  JOURNAL-RECORD.
  2449     12  jp-date                     pic s9(5) comp-3.
  2450     12  jp-time                     pic s9(7) comp-3.
  2451     12  JP-USER-ID                  PIC X(4).
  2452     12  JP-FILE-ID                  PIC X(8).
  2453     12  JP-PROGRAM-ID               PIC X(8).
  2454     12  JP-RECORD-TYPE              PIC X.
  2455         88 JP-ADD              VALUE 'A'.
  2456         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2457         88 JP-AFTER-CHANGE     VALUE 'C'.
  2458         88 JP-DELETE           VALUE 'D'.
  2459         88 JP-GENERIC-DELETE   VALUE 'G'.
  2460         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2461         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2462     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2463     12  JP-RECORD-AREA
  2464
  2465
  2466                                 PIC X(750).
  2467
  2468*                                COPY ELCCALC.
  2469******************************************************************
  2470*                                                                *
  2471*                           ELCCALC.                            *
  2472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2473*                            VMOD=2.025                          *
  2474*                                                                *
  2475*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  47
* EL131.cbl
  2476*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2477*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2478*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2479*                                                                *
  2480*  PASSED TO ELRTRM                                              *
  2481*  -----------------                                             *
  2482*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2483*  ORIGINAL TERM                                                 *
  2484*  BEGINNING DATE                                                *
  2485*  ENDING DATE                                                   *
  2486*  COMPANY I.D.                                                  *
  2487*  ACCOUNT MASTER USER FIELD                                     *
  2488*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2489*  FREE LOOK DAYS                                                *
  2490*                                                                *
  2491*  RETURNED FROM ELRTRM                                          *
  2492*  ---------------------                                         *
  2493*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2494*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2495*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2496*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2497*----------------------------------------------------------------*
  2498*  PASSED TO ELRAMT                                              *
  2499*  ----------------                                              *
  2500*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2501*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2502*  ORIGINAL AMOUNT                                               *
  2503*  ALTERNATE BENEFIT (BALLON)                                    *
  2504*  A.P.R. - NET PAY ONLY                                         *
  2505*  METHOD
  2506*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2507*  COMPANY I.D.                                                  *
  2508*  BENEFIT TYPE                                                  *
  2509*                                                                *
  2510*  RETURNED FROM ELRAMT                                          *
  2511*  --------------------                                          *
  2512*  REMAINING AMOUNT 1 - CURRENT                                  *
  2513*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2514*  REMAINING AMOUNT FACTOR
  2515*----------------------------------------------------------------*
  2516*  PASSED TO ELRESV                                              *
  2517*  -----------------                                             *
  2518*  CERTIFICATE EFFECTIVE DATE                                    *
  2519*  VALUATION DATE                                                *
  2520*  PAID THRU DATE                                                *
  2521*  BENEFIT                                                       *
  2522*  INCURRED DATE                                                 *
  2523*  REPORTED DATE                                                 *
  2524*  ISSUE AGE                                                     *
  2525*  TERM                                                          *
  2526*  CDT PERCENT                                                   *
  2527*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2528* *CLAIM TYPE (LIFE, A/H)                                        *
  2529* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2530* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2531*                                                                *
  2532*  RETURNED FROM ELRESV                                          *
  2533*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  48
* EL131.cbl
  2534*  CDT TABLE USED                                                *
  2535*  CDT FACTOR USED                                               *
  2536*  PAY TO CURRENT RESERVE                                        *
  2537*  I.B.N.R. - A/H ONLY                                           *
  2538*  FUTURE (ACCRUED) AH ONLY                                      *
  2539*----------------------------------------------------------------*
  2540*  PASSED TO ELRATE                                              *
  2541*  ----------------                                              *
  2542*  CERT ISSUE DATE                                               *
  2543*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2544*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2545*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2546*  STATE CODE (CLIENT DEFINED)                                   *
  2547*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2548*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2549*  DEVIATION CODE                                                *
  2550*  ISSUE AGE                                                     *
  2551*  ORIGINAL BENEFIT AMOUNT                                       *
  2552*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2553*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2554*  BENEFIT KIND (LIFE OR A/H)                                    *
  2555*  A.P.R.                                                        *
  2556*  METHOD
  2557*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2558*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2559*  COMPANY I.D. (3 CHARACTER)                                    *
  2560*  BENEFIT CODE                                                  *
  2561*  BENEFIT OVERRIDE CODE                                         *
  2562*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2563*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2564*  JOINT INDICATOR (CSL ONLY)                                    *
  2565*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2566*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2567*                                                                *
  2568*  RETURNED FROM ELRATE                                          *
  2569*  --------------------                                          *
  2570*  CALCULATED PREMIUM                                            *
  2571*  PREMIUM RATE                                                  *
  2572*  MORTALITY CODE                                                *
  2573*  MAX ATTAINED AGE                                              *
  2574*  MAX AGE                                                       *
  2575*  MAX TERM                                                      *
  2576*  MAX MONTHLY BENEFIT                                           *
  2577*  MAX TOTAL BENIFIT                                             *
  2578*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2579*----------------------------------------------------------------*
  2580*  PASSED TO ELRFND                                              *
  2581*  ----------------                                              *
  2582*  CERT ISSUE DATE                                               *
  2583*  REFUND DATE                                                   *
  2584*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2585*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2586*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2587*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2588*  STATE CODE (CLIENT DEFINED)                                   *
  2589*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2590*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2591*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  49
* EL131.cbl
  2592*  ISSUE AGE                                                     *
  2593*  ORIGINAL BENEFIT AMOUNT                                       *
  2594*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2595*  PROCESS TYPE (CANCEL)                                         *
  2596*  BENEFIT KIND (LIFE OR A/H)                                    *
  2597*  A.P.R.                                                        *
  2598*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2599*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2600*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2601*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2602*  COMPANY I.D. (3 CHARACTER)                                    *
  2603*  BENEFIT CODE                                                  *
  2604*  BENEFIT OVERRIDE CODE                                         *
  2605*                                                                *
  2606*  RETURNED FROM ELRFND                                          *
  2607*  --------------------                                          *
  2608*  CALCULATED REFUND                                             *
  2609*----------------------------------------------------------------*
  2610*  PASSED TO ELEARN                                              *
  2611*  ----------------                                              *
  2612*  CERT ISSUE DATE                                               *
  2613*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2614*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2615*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2616*  STATE CODE (CLIENT DEFINED)                                   *
  2617*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2618*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2619*  DEVIATION CODE                                                *
  2620*  ISSUE AGE                                                     *
  2621*  ORIGINAL BENEFIT AMOUNT                                       *
  2622*  BENEFIT KIND (LIFE OR A/H)                                    *
  2623*  A.P.R.                                                        *
  2624*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2625*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2626*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2627*  COMPANY I.D. (3 CHARACTER)                                    *
  2628*  BENEFIT CODE                                                  *
  2629*  BENEFIT OVERRIDE CODE                                         *
  2630*                                                                *
  2631*  RETURNED FROM ELEARN                                          *
  2632*  --------------------                                          *
  2633*  INDICATED  EARNINGS                                           *
  2634*----------------------------------------------------------------*
  2635*                 LENGTH = 450                                   *
  2636*                                                                *
  2637******************************************************************
  2638******************************************************************
  2639*                   C H A N G E   L O G
  2640*
  2641* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2642*-----------------------------------------------------------------
  2643*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2644* EFFECTIVE    NUMBER
  2645*-----------------------------------------------------------------
  2646* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2647* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2648* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2649* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  50
* EL131.cbl
  2650* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2651* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2652* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2653* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2654* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2655* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2656* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2657* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  2658******************************************************************
  2659
  2660 01  CALCULATION-PASS-AREA.
  2661     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2662                                     COMP.
  2663
  2664     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2665       88  NO-CP-ERROR                             VALUE ZERO.
  2666       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2667                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  2668       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2669       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2670       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2671       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2672       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2673       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2674       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2675       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2676       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2677       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2678       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2679       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2680       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2681       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2682       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2683       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2684       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2685       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  2686
  2687     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2688       88  NO-CP-ERROR-2                           VALUE ZERO.
  2689***********************  INPUT AREAS ****************************
  2690
  2691     12  CP-CALCULATION-AREA.
  2692         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2693         16  CP-CERT-EFF-DT        PIC XX.
  2694         16  CP-VALUATION-DT       PIC XX.
  2695         16  CP-PAID-THRU-DT       PIC XX.
  2696         16  CP-BENEFIT-TYPE       PIC X.
  2697           88  CP-AH                               VALUE 'A' 'D'
  2698                                                   'I' 'U'.
  2699           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2700           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2701         16  CP-INCURRED-DT        PIC XX.
  2702         16  CP-REPORTED-DT        PIC XX.
  2703         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2704         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2705         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2706                                     COMP-3.
  2707         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  51
* EL131.cbl
  2708                                     COMP-3.
  2709         16  CP-CDT-METHOD         PIC X.
  2710           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2711           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2712           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2713         16  CP-CLAIM-TYPE         PIC X.
  2714           88  CP-AH-CLAIM                         VALUE 'A'.
  2715           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2716         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2717                                     COMP-3.
  2718         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2719                                     COMP-3.
  2720         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2721                                     COMP-3.
  2722         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2723                                     COMP-3.
  2724         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2725                                     COMP-3.
  2726         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2727                                     COMP-3.
  2728         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2729                                     COMP-3.
  2730         16  CP-REM-TERM-METHOD    PIC X.
  2731           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2732           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2733           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2734           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2735           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2736           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2737           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2738         16  CP-EARNING-METHOD     PIC X.
  2739           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2740           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2741           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2742           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2743           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2744           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2745           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2746           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2747           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2748           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2749           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2750           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2751           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2752           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2753         16  CP-PROCESS-TYPE       PIC X.
  2754           88  CP-CLAIM                            VALUE '1'.
  2755           88  CP-CANCEL                           VALUE '2'.
  2756           88  CP-ISSUE                            VALUE '3'.
  2757         16  CP-SPECIAL-CALC-CD    PIC X.
  2758           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2759           88  CP-1-MTH-INTEREST               VALUE ' '.
  2760           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2761           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2762           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2763           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2764           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2765           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  52
* EL131.cbl
  2766           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2767           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2768           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2769           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2770           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2771           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2772           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2773           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2774           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2775           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2776                                                     'W' 'X'.
  2777           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2778           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2779           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2780           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2781           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2782           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2783           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2784           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2785           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2786           88  CP-CSL-METH-1                   VALUE '5'.
  2787           88  CP-CSL-METH-2                   VALUE '6'.
  2788           88  CP-CSL-METH-3                   VALUE '7'.
  2789           88  CP-CSL-METH-4                   VALUE '8'.
  2790
  2791         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2792                                     COMP-3.
  2793         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2794         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2795         16  CP-STATE              PIC XX          VALUE SPACE.
  2796         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2797         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2798           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2799               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2800         16  CP-R78-OPTION         PIC X.
  2801           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2802           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2803
  2804         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2805         16  CP-IBNR-RESERVE-SW    PIC X.
  2806         16  CP-CLAIM-STATUS       PIC X.
  2807         16  CP-RATE-FILE          PIC X.
  2808         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2809                                     COMP-3.
  2810
  2811         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2812         16  CP-AH-OVERRIDE-CODE   PIC X.
  2813
  2814         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2815                                     COMP-3.
  2816         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2817                                   PIC S9(5)V99 COMP-3.
  2818         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2819                                     COMP-3.
  2820         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2821                                     COMP-3.
  2822         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2823                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  53
* EL131.cbl
  2824         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2825                                  PIC S9(7)V99 COMP-3.
  2826
  2827         16  CP-PAID-FROM-DATE     PIC X(02).
  2828         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2829         16  CP-EXT-DAYS-CALC      PIC X.
  2830           88  CP-EXT-NO-CHG                   VALUE ' '.
  2831           88  CP-EXT-CHG-LF                   VALUE '1'.
  2832           88  CP-EXT-CHG-AH                   VALUE '2'.
  2833           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2834         16  CP-DOMICILE-STATE     PIC XX.
  2835         16  CP-CARRIER            PIC X.
  2836         16  CP-REIN-FLAG          PIC X.
  2837         16  CP-REM-TRM-CALC-OPTION PIC X.
  2838           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2839                      '2' '3' '4' '5'.
  2840           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2841           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2842           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2843           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2844           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2845           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2846           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2847           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2848         16  CP-SIG-SWITCH         PIC X.
  2849         16  CP-RATING-METHOD      PIC X.
  2850           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2851           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2852           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2853           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2854           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2855           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2856           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2857           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2858           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2859         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2860                                     COMP-3.
  2861         16  CP-BEN-CATEGORY       PIC X.
  2862         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2863         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2864                                   PIC S99V9(5) COMP-3.
  2865         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2866         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2867                                   PIC S99V9(5) COMP-3.
  2868         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2869         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2870         16  CP-EXPIRE-DT          PIC XX.
  2871         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2872         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2873         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2874         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2875         16  CP-DDF-SPEC-CALC      PIC X.
  2876             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2877             88  CP-CALC-CLP              VALUE 'C'.
  2878         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2879         16  CP-CANCEL-REASON      PIC X.
  2880         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2881         16  CP-PMT-MODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  54
* EL131.cbl
  2882         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2883         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2884         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2885         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2886         16  FILLER                PIC X.
  2887
  2888***************    OUTPUT FROM ELRESV   ************************
  2889
  2890         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2891
  2892         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2893                                     COMP-3.
  2894         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2895                                     COMP-3.
  2896         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2897                                     COMP-3.
  2898         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2899                                     COMP-3.
  2900         16  FILLER                PIC X(09).
  2901***************    OUTPUT FROM ELRTRM   *************************
  2902
  2903         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2904                                     COMP-3.
  2905         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2906                                     COMP-3.
  2907         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2908                                     COMP-3.
  2909         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2910                                     COMP-3.
  2911         16  FILLER                PIC X(12).
  2912
  2913***************    OUTPUT FROM ELRAMT   *************************
  2914
  2915         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2916                                     COMP-3.
  2917         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2918                                     COMP-3.
  2919         16  FILLER                PIC X(12).
  2920
  2921***************    OUTPUT FROM ELRATE   *************************
  2922
  2923         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2924                                     COMP-3.
  2925         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2926                                     COMP-3.
  2927         16  CP-MORTALITY-CODE     PIC X(4).
  2928         16  CP-RATE-EDIT-FLAG     PIC X.
  2929             88  CP-RATES-NEED-APR                  VALUE '1'.
  2930         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2931                                     COMP-3.
  2932         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2933         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2934         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2935                                   PIC S9(7)V99 COMP-3.
  2936         16  FILLER                PIC X(07).
  2937
  2938***************    OUTPUT FROM ELRFND   *************************
  2939
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  55
* EL131.cbl
  2940         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2941                                     COMP-3.
  2942         16  CP-REFUND-TYPE-USED   PIC X.
  2943           88  CP-R-AS-R78                         VALUE '1'.
  2944           88  CP-R-AS-PRORATA                     VALUE '2'.
  2945           88  CP-R-AS-CALIF                       VALUE '3'.
  2946           88  CP-R-AS-TEXAS                       VALUE '4'.
  2947           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2948           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2949           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2950           88  CP-R-AS-MEAN                        VALUE '8'.
  2951           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2952           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2953           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2954           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2955           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2956           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2957         16  FILLER                PIC X(12).
  2958
  2959***************    OUTPUT FROM ELEARN   *************************
  2960
  2961         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2962                                     COMP-3.
  2963         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2964                                     COMP-3.
  2965         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2966                                     COMP-3.
  2967         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2968                                     COMP-3.
  2969         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2970                                     COMP-3.
  2971         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2972                                     COMP-3.
  2973         16  CP-EARNING-TYPE-USED  PIC X.
  2974           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2975           88  CP-E-AS-R78                         VALUE '1'.
  2976           88  CP-E-AS-PRORATA                     VALUE '2'.
  2977           88  CP-E-AS-TEXAS                       VALUE '4'.
  2978           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2979           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2980           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2981           88  CP-E-AS-MEAN                        VALUE '8'.
  2982           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2983         16  FILLER                PIC X(12).
  2984
  2985***************    OUTPUT FROM ELPMNT   *************************
  2986
  2987         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2988                                     COMP-3.
  2989         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2990                                     COMP-3.
  2991         16  FILLER                PIC X(12).
  2992
  2993***************   MISC WORK AREAS    *****************************
  2994         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2995                                     COMP-3.
  2996         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2997                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  56
* EL131.cbl
  2998         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2999                                     COMP-3.
  3000         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3001                                     COMP-3.
  3002         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3003                                     COMP-3.
  3004         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3005                                     COMP-3.
  3006         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3007             88  OPEN-RATE-FILE                   VALUE 'O'.
  3008             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3009             88  IO-ERROR                         VALUE 'E'.
  3010
  3011         16  CP-FIRST-PAY-DATE     PIC XX.
  3012
  3013         16  CP-JOINT-INDICATOR    PIC X.
  3014
  3015         16  CP-RESERVE-REMAINING-TERM
  3016                                   PIC S9(4)V9    VALUE ZERO
  3017                                     COMP-3.
  3018
  3019         16  CP-INSURED-BIRTH-DT   PIC XX.
  3020
  3021         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3022                                     COMP-3.
  3023
  3024         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3025                                     COMP-3.
  3026
  3027         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3028                                     COMP-3.
  3029
  3030         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3031                                     COMP-3.
  3032
  3033         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3034                                     COMP-3.
  3035
  3036         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3037                                     COMP-3.
  3038
  3039         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3040                                     COMP-3.
  3041
  3042         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3043             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3044
  3045         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3046                                     COMP-3.
  3047         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3048                                     COMP-3.
  3049         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3050         16  cp-extra-periods      pic 9 value zeros.
  3051         16  cp-net-only-state     pic x value spaces.
  3052         16  FILLER                PIC X(13).
  3053******************************************************************
  3054
  3055*                                COPY ELCDATE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  57
* EL131.cbl
  3056******************************************************************
  3057*                                                                *
  3058*                                                                *
  3059*                            ELCDATE.                            *
  3060*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3061*                            VMOD=2.003
  3062*                                                                *
  3063*                                                                *
  3064*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3065*                 LENGTH = 200                                   *
  3066******************************************************************
  3067
  3068 01  DATE-CONVERSION-DATA.
  3069     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3070     12  DC-OPTION-CODE                PIC X.
  3071         88  BIN-TO-GREG                VALUE ' '.
  3072         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3073         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3074         88  YMD-GREG-TO-BIN            VALUE '3'.
  3075         88  MDY-GREG-TO-BIN            VALUE '4'.
  3076         88  JULIAN-TO-BIN              VALUE '5'.
  3077         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3078         88  FIND-CENTURY               VALUE '7'.
  3079         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3080         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3081         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3082         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3083         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3084         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3085         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3086         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3087         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3088         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3089         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3090         88  BIN-3-TO-GREG              VALUE 'I'.
  3091         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3092         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3093         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3094         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3095         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3096         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3097         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3098         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3099         88  THREE-CHARACTER-BIN
  3100                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3101         88  GREGORIAN-TO-BIN
  3102                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3103         88  BIN-TO-GREGORIAN
  3104                  VALUES ' ' '1' 'I' '8' 'G'.
  3105         88  JULIAN-TO-BINARY
  3106                  VALUES '5' 'C' 'E' 'F'.
  3107     12  DC-ERROR-CODE                 PIC X.
  3108         88  NO-CONVERSION-ERROR        VALUE ' '.
  3109         88  DATE-CONVERSION-ERROR
  3110                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3111         88  DATE-IS-ZERO               VALUE '1'.
  3112         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3113         88  DATE-IS-INVALID            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  58
* EL131.cbl
  3114         88  DATE1-GREATER-DATE2        VALUE '4'.
  3115         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3116         88  DATE-INVALID-OPTION        VALUE '9'.
  3117         88  INVALID-CENTURY            VALUE 'A'.
  3118         88  ONLY-CENTURY               VALUE 'B'.
  3119         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3120         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3121     12  DC-END-OF-MONTH               PIC X.
  3122         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3123     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3124         88  USE-NORMAL-PROCESS         VALUE ' '.
  3125         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3126         88  ADJUST-UP-100-YRS          VALUE '2'.
  3127     12  FILLER                        PIC X.
  3128     12  DC-CONVERSION-DATES.
  3129         16  DC-BIN-DATE-1             PIC XX.
  3130         16  DC-BIN-DATE-2             PIC XX.
  3131         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3132         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3133                       DC-GREG-DATE-1-EDIT.
  3134             20  DC-EDIT1-MONTH        PIC 99.
  3135             20  SLASH1-1              PIC X.
  3136             20  DC-EDIT1-DAY          PIC 99.
  3137             20  SLASH1-2              PIC X.
  3138             20  DC-EDIT1-YEAR         PIC 99.
  3139         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3140         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3141                     DC-GREG-DATE-2-EDIT.
  3142             20  DC-EDIT2-MONTH        PIC 99.
  3143             20  SLASH2-1              PIC X.
  3144             20  DC-EDIT2-DAY          PIC 99.
  3145             20  SLASH2-2              PIC X.
  3146             20  DC-EDIT2-YEAR         PIC 99.
  3147         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3148         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3149                     DC-GREG-DATE-1-YMD.
  3150             20  DC-YMD-YEAR           PIC 99.
  3151             20  DC-YMD-MONTH          PIC 99.
  3152             20  DC-YMD-DAY            PIC 99.
  3153         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3154         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3155                      DC-GREG-DATE-1-MDY.
  3156             20  DC-MDY-MONTH          PIC 99.
  3157             20  DC-MDY-DAY            PIC 99.
  3158             20  DC-MDY-YEAR           PIC 99.
  3159         16  DC-GREG-DATE-1-ALPHA.
  3160             20  DC-ALPHA-MONTH        PIC X(10).
  3161             20  DC-ALPHA-DAY          PIC 99.
  3162             20  FILLER                PIC XX.
  3163             20  DC-ALPHA-CENTURY.
  3164                 24 DC-ALPHA-CEN-N     PIC 99.
  3165             20  DC-ALPHA-YEAR         PIC 99.
  3166         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3167         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3168         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3169         16  DC-JULIAN-DATE            PIC 9(05).
  3170         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3171                                       PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  59
* EL131.cbl
  3172         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3173             20  DC-JULIAN-YEAR        PIC 99.
  3174             20  DC-JULIAN-DAYS        PIC 999.
  3175         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3176         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3177         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3178     12  DATE-CONVERSION-VARIBLES.
  3179         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3180         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3181             20  FILLER                PIC 9(3).
  3182             20  HOLD-CEN-1-CCYY.
  3183                 24  HOLD-CEN-1-CC     PIC 99.
  3184                 24  HOLD-CEN-1-YY     PIC 99.
  3185             20  HOLD-CEN-1-MO         PIC 99.
  3186             20  HOLD-CEN-1-DA         PIC 99.
  3187         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3188             20  HOLD-CEN-1-R-MO       PIC 99.
  3189             20  HOLD-CEN-1-R-DA       PIC 99.
  3190             20  HOLD-CEN-1-R-CCYY.
  3191                 24  HOLD-CEN-1-R-CC   PIC 99.
  3192                 24  HOLD-CEN-1-R-YY   PIC 99.
  3193             20  FILLER                PIC 9(3).
  3194         16  HOLD-CENTURY-1-X.
  3195             20  FILLER                PIC X(3)  VALUE SPACES.
  3196             20  HOLD-CEN-1-X-CCYY.
  3197                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3198                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3199             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3200             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3201         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3202             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3203             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3204             20  HOLD-CEN-1-R-X-CCYY.
  3205                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3206                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3207             20  FILLER                PIC XXX.
  3208         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3209         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3210         16  DC-JULIAN-DATE-1          PIC 9(07).
  3211         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3212             20  DC-JULIAN-1-CCYY.
  3213                 24  DC-JULIAN-1-CC    PIC 99.
  3214                 24  DC-JULIAN-1-YR    PIC 99.
  3215             20  DC-JULIAN-DA-1        PIC 999.
  3216         16  DC-JULIAN-DATE-2          PIC 9(07).
  3217         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3218             20  DC-JULIAN-2-CCYY.
  3219                 24  DC-JULIAN-2-CC    PIC 99.
  3220                 24  DC-JULIAN-2-YR    PIC 99.
  3221             20  DC-JULIAN-DA-2        PIC 999.
  3222         16  DC-GREG-DATE-A-EDIT.
  3223             20  DC-EDITA-MONTH        PIC 99.
  3224             20  SLASHA-1              PIC X VALUE '/'.
  3225             20  DC-EDITA-DAY          PIC 99.
  3226             20  SLASHA-2              PIC X VALUE '/'.
  3227             20  DC-EDITA-CCYY.
  3228                 24  DC-EDITA-CENT     PIC 99.
  3229                 24  DC-EDITA-YEAR     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  60
* EL131.cbl
  3230         16  DC-GREG-DATE-B-EDIT.
  3231             20  DC-EDITB-MONTH        PIC 99.
  3232             20  SLASHB-1              PIC X VALUE '/'.
  3233             20  DC-EDITB-DAY          PIC 99.
  3234             20  SLASHB-2              PIC X VALUE '/'.
  3235             20  DC-EDITB-CCYY.
  3236                 24  DC-EDITB-CENT     PIC 99.
  3237                 24  DC-EDITB-YEAR     PIC 99.
  3238         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3239         16  DC-GREG-DATE-CYMD-R REDEFINES
  3240                              DC-GREG-DATE-CYMD.
  3241             20  DC-CYMD-CEN           PIC 99.
  3242             20  DC-CYMD-YEAR          PIC 99.
  3243             20  DC-CYMD-MONTH         PIC 99.
  3244             20  DC-CYMD-DAY           PIC 99.
  3245         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3246         16  DC-GREG-DATE-MDCY-R REDEFINES
  3247                              DC-GREG-DATE-MDCY.
  3248             20  DC-MDCY-MONTH         PIC 99.
  3249             20  DC-MDCY-DAY           PIC 99.
  3250             20  DC-MDCY-CEN           PIC 99.
  3251             20  DC-MDCY-YEAR          PIC 99.
  3252    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3253        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3254    12  DC-EL310-DATE                  PIC X(21).
  3255    12  FILLER                         PIC X(28).
  3256
  3257*                                COPY ELCDMO.
  3258******************************************************************
  3259*                                                                *
  3260*                                                                *
  3261*                            ELCDMO.                             *
  3262*                            VMOD=2.004                          *
  3263*                                                                *
  3264*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3265*        COMMUNICATION AREA                                      *
  3266*   FILE TYPE = NA                                               *
  3267*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3268*                                                                *
  3269******************************************************************
  3270 01  DMO-COMMUNICATION-AREA.
  3271     12  DM-RECORD-TYPE                  PIC  X(02).
  3272             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3273             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3274             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3275     12  DM-DIST-CODE                    PIC  X(04).
  3276     12  DM-MAIL-CODE                    PIC  X(05).
  3277     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3278     12  DM-INSURED-NAME                 PIC  X(30).
  3279     12  DM-CLAIM-NO                     PIC  X(07).
  3280     12  DM-CLAIM-TYPE                   PIC  X.
  3281
  3282     12  DM-STATUS-DATA-AREA.
  3283         16  DM-CLAIM-STATUS             PIC  X.
  3284             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3285             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3286             88  DM-CLOSED                        VALUE '3'.
  3287             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  61
* EL131.cbl
  3288             88  DM-DEFAULT                       VALUE '9'.
  3289         16  DM-STATUS-DATE              PIC  X(08).
  3290******YYYYMMDD
  3291         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3292             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3293             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3294             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3295             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3296             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3297             88  DM-RE-OPENED                     VALUE 'R'.
  3298             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3299             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3300             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3301         16  DM-STAT-CARRIER             PIC X.
  3302
  3303     12  DM-DRAFT-DATA-AREA.
  3304         16  DM-PAYMENT-TYPE             PIC  X.
  3305             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3306         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3307         16  DM-PAYMENT-DATE             PIC  X(08).
  3308******YYYYMMDD
  3309         16  DM-CERT-NO                  PIC  X(11).
  3310         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3311         16  DM-CARRIER                  PIC  X.
  3312
  3313     12  DM-RETURN-CODE                  PIC  XX.
  3314*                                COPY ERCPDEF.
  3315******************************************************************
  3316*                                                                *
  3317*                                                                *
  3318*                            ERCPDEF.                            *
  3319*                                                                *
  3320*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3321*                                                                *
  3322*    FILE TYPE = VSAM,KSDS                                       *
  3323*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3324*                                                                *
  3325*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3326*                                                                *
  3327*    LOG = YES                                                   *
  3328*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3329******************************************************************
  3330*                   C H A N G E   L O G
  3331*
  3332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3333*-----------------------------------------------------------------
  3334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3335* EFFECTIVE    NUMBER
  3336*-----------------------------------------------------------------
  3337* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3338* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3339* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3340* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3341******************************************************************
  3342 01  PRODUCT-MASTER.
  3343    12  PD-RECORD-ID                 PIC X(02).
  3344        88  VALID-PD-ID                  VALUE 'PD'.
  3345    12  PD-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  62
* EL131.cbl
  3346        16  PD-COMPANY-CD            PIC X.
  3347        16  PD-STATE                 PIC XX.
  3348        16  PD-PRODUCT-CD            PIC XXX.
  3349        16  PD-FILLER                PIC X(7).
  3350        16  PD-BEN-TYPE              PIC X.
  3351        16  PD-BEN-CODE              PIC XX.
  3352        16  PD-PROD-EXP-DT           PIC XX.
  3353    12  FILLER                       PIC X(50).
  3354    12  PD-PRODUCT-DATA OCCURS 8.
  3355        16  PD-PROD-CODE             PIC X.
  3356            88  PD-PROD-LIFE           VALUE 'L'.
  3357            88  PD-PROD-PROP           VALUE 'P'.
  3358            88  PD-PROD-AH             VALUE 'A'.
  3359            88  PD-PROD-IU             VALUE 'I'.
  3360            88  PD-PROD-GAP            VALUE 'G'.
  3361            88  PD-PROD-FAML           VALUE 'F'.
  3362            88  PD-PROD-OTH            VALUE 'O'.
  3363        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3364        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3365        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3366        16  PD-MAX-TERM              PIC S999        COMP-3.
  3367        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3368        16  FILLER                   PIC X.
  3369        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3370        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3371        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3372        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3373        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3374        16  PD-REC-CRIT-PERIOD       PIC 99.
  3375        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3376            20  PD-RECURRING-YN      PIC X.
  3377            20  FILLER               PIC X.
  3378        16  PD-RTW-MOS               PIC 99.
  3379        16  PD-MAX-EXTENSION         PIC 99.
  3380        16  pd-ben-pct               pic sv999 comp-3.
  3381*       16  FILLER                   PIC XX.
  3382    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3383    12  PD-TERM-LIMITS OCCURS 15.
  3384        16  PD-LOW-TERM              PIC S999        COMP-3.
  3385        16  PD-HI-TERM               PIC S999        COMP-3.
  3386*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3387    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3388        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3389        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3390    12  PD-EARN-FACTORS.
  3391        16  FILLER OCCURS 15.
  3392            20  FILLER OCCURS 15.
  3393                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3394    12  PD-PRODUCT-DESC              PIC X(80).
  3395    12  PD-TRUNCATED                 PIC X.
  3396    12  FILLER                       PIC X(59).
  3397    12  PD-MAINT-INFORMATION.
  3398        16  PD-LAST-MAINT-DT         PIC X(02).
  3399        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3400        16  PD-LAST-MAINT-BY         PIC X(04).
  3401*                                COPY ELCCRTT.
  3402******************************************************************
  3403*                                                                *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  63
* EL131.cbl
  3404*                            ELCCRTT.                            *
  3405*                                                                *
  3406*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3407*                                                                *
  3408*   FILE TYPE = VSAM,KSDS                                        *
  3409*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3410*                                                                *
  3411*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3412*                                                                *
  3413*   LOG = YES                                                    *
  3414*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3415******************************************************************
  3416*                   C H A N G E   L O G
  3417*
  3418* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3419*-----------------------------------------------------------------
  3420*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3421* EFFECTIVE    NUMBER
  3422*-----------------------------------------------------------------
  3423* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3424* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3425* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3426* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3427* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3428* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3429* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3430* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3431* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3432* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3433* 091318  CR2018073000001  PEMA  ADD Refund methods
  3434* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3435******************************************************************
  3436
  3437 01  CERTIFICATE-TRAILERS.
  3438     12  CS-RECORD-ID                      PIC XX.
  3439         88  VALID-CS-ID                      VALUE 'CS'.
  3440
  3441     12  CS-CONTROL-PRIMARY.
  3442         16  CS-COMPANY-CD                 PIC X.
  3443         16  CS-CARRIER                    PIC X.
  3444         16  CS-GROUPING                   PIC X(6).
  3445         16  CS-STATE                      PIC XX.
  3446         16  CS-ACCOUNT                    PIC X(10).
  3447         16  CS-CERT-EFF-DT                PIC XX.
  3448         16  CS-CERT-NO.
  3449             20  CS-CERT-PRIME             PIC X(10).
  3450             20  CS-CERT-SFX               PIC X.
  3451         16  CS-TRAILER-TYPE               PIC X.
  3452             88  COMM-TRLR           VALUE 'A'.
  3453             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3454             88  CERT-DATA-TRLR      VALUE 'C'.
  3455
  3456     12  CS-DATA-AREA                      PIC X(516).
  3457
  3458     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3459         16  CS-BANK-COMMISSION-AREA.
  3460             20  CS-BANK-COMMS       OCCURS 10.
  3461                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  64
* EL131.cbl
  3462                 24  CS-COM-TYP            PIC X.
  3463                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3464                 24  CS-RECALC-LV-INDIC    PIC X.
  3465                 24  FILLER                PIC X(10).
  3466         16  FILLER                        PIC X(256).
  3467
  3468     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3469****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3470         16  CS-MB-CLAIM-DATA OCCURS 24.
  3471             20  CS-CLAIM-NO               PIC X(7).
  3472             20  CS-CLAIM-TYPE             PIC X.
  3473                 88  CS-AH-CLM               VALUE 'A'.
  3474                 88  CS-IU-CLM               VALUE 'I'.
  3475                 88  CS-GP-CLM               VALUE 'G'.
  3476                 88  CS-LF-CLM               VALUE 'L'.
  3477                 88  CS-PR-CLM               VALUE 'P'.
  3478                 88  CS-FL-CLM               VALUE 'F'.
  3479                 88  CS-OT-CLM               VALUE 'O'.
  3480             20  CS-INSURED-TYPE           PIC X.
  3481                 88  CS-PRIM-INSURED          VALUE 'P'.
  3482                 88  CS-CO-BORROWER           VALUE 'C'.
  3483             20  CS-BENEFIT-PERIOD         PIC 99.
  3484             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3485             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3486             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3487         16  FILLER                        PIC X(12).
  3488     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3489         16  CS-VIN-NUMBER                 PIC X(17).
  3490         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3491         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3492         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3493         16  cs-agent-name.
  3494             20  cs-agent-fname            pic x(20).
  3495             20  cs-agent-mi               pic x.
  3496             20  cs-agent-lname            pic x(25).
  3497         16  cs-license-no                 pic x(15).
  3498         16  cs-npn-number                 pic x(10).
  3499         16  cs-agent-edit-status          pic x.
  3500             88  cs-ae-refer-to-manager      value 'M'.
  3501             88  cs-ae-cover-sheet           value 'C'.
  3502             88  cs-ae-sig-form              value 'S'.
  3503             88  cs-ae-verified              value 'V'.
  3504             88  cs-unidentified-signature   value 'U'.
  3505             88  cs-cert-returned            value 'R'.
  3506             88  cs-accept-no-commission     value 'N'.
  3507         16  cs-year                       pic 9999.
  3508         16  cs-make                       pic x(20).
  3509         16  cs-model                      pic x(20).
  3510         16  cs-future                     pic x(20).
  3511         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3512         16  cs-claim-verification-status  pic x.
  3513             88  cs-clm-ver-eligible         value 'A'.
  3514             88  cs-clm-ver-partial-elig     value 'B'.
  3515             88  cs-clm-ver-not-eligible     value 'C'.
  3516             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3517             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3518             88  cs-clm-ver-ND-CERT          value 'F'.
  3519             88  cs-clm-ver-spec-other       value 'G'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  65
* EL131.cbl
  3520             88  cs-clam-ver-pratial-corrected
  3521                                             value 'H'.
  3522             88  cs-clm-ver-no-matches       value 'I'.
  3523             88  cs-clm-ver-not-elig-corrected
  3524                                             value 'J'.
  3525             88  cs-clm-ver-needs-review     value 'R'.
  3526             88  cs-clm-ver-sent-to-claims   value 'W'.
  3527         16  CS-LF-REFUND-METHOD           PIC X.
  3528         16  CS-AH-REFUND-METHOD           PIC X.
  3529         16  FILLER                        PIC X(353). *> was 420
  3530*        16  FILLER                        PIC X(496).
  3531
  3532****************************************************************
  3533*
  3534* Copyright (c) 2007-2013 Dell Inc.
  3535* All rights reserved.
  3536*
  3537****************************************************************
  3538 01  DFHEIV.
  3539   02  DFHEIV0               PIC X(35).
  3540   02  DFHEIV1               PIC X(08).
  3541   02  DFHEIV2               PIC X(08).
  3542   02  DFHEIV3               PIC X(08).
  3543   02  DFHEIV4               PIC X(06).
  3544   02  DFHEIV5               PIC X(04).
  3545   02  DFHEIV6               PIC X(04).
  3546   02  DFHEIV7               PIC X(02).
  3547   02  DFHEIV8               PIC X(02).
  3548   02  DFHEIV9               PIC X(01).
  3549   02  DFHEIV10              PIC S9(7) COMP-3.
  3550   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3551   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3552   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3553   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3554   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3555   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3556   02  DFHEIV17              PIC X(04).
  3557   02  DFHEIV18              PIC X(04).
  3558   02  DFHEIV19              PIC X(04).
  3559   02  DFHEIV20              USAGE IS POINTER.
  3560   02  DFHEIV21              USAGE IS POINTER.
  3561   02  DFHEIV22              USAGE IS POINTER.
  3562   02  DFHEIV23              USAGE IS POINTER.
  3563   02  DFHEIV24              USAGE IS POINTER.
  3564   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3565   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3566   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3567   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3568   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3569   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3570   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3571   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3572   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3573   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3574   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3575   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3576   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3577   02  FILLER                PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  66
* EL131.cbl
  3578   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3579   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3580   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3581   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3582   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3583   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3584   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3585 LINKAGE  SECTION.
  3586*****************************************************************
  3587*                                                               *
  3588* Copyright (c) 2007-2013 Dell Inc.                             *
  3589* All rights reserved.                                          *
  3590*                                                               *
  3591*****************************************************************
  3592 01  dfheiblk.
  3593     02  eibtime          pic s9(7) comp-3.
  3594     02  eibdate          pic s9(7) comp-3.
  3595     02  eibtrnid         pic x(4).
  3596     02  eibtaskn         pic s9(7) comp-3.
  3597     02  eibtrmid         pic x(4).
  3598     02  dfheigdi         pic s9(4) comp.
  3599     02  eibcposn         pic s9(4) comp.
  3600     02  eibcalen         pic s9(4) comp.
  3601     02  eibaid           pic x(1).
  3602     02  eibfiller1       pic x(1).
  3603     02  eibfn            pic x(2).
  3604     02  eibfiller2       pic x(2).
  3605     02  eibrcode         pic x(6).
  3606     02  eibfiller3       pic x(2).
  3607     02  eibds            pic x(8).
  3608     02  eibreqid         pic x(8).
  3609     02  eibrsrce         pic x(8).
  3610     02  eibsync          pic x(1).
  3611     02  eibfree          pic x(1).
  3612     02  eibrecv          pic x(1).
  3613     02  eibsend          pic x(1).
  3614     02  eibatt           pic x(1).
  3615     02  eibeoc           pic x(1).
  3616     02  eibfmh           pic x(1).
  3617     02  eibcompl         pic x(1).
  3618     02  eibsig           pic x(1).
  3619     02  eibconf          pic x(1).
  3620     02  eiberr           pic x(1).
  3621     02  eibrldbk         pic x(1).
  3622     02  eiberrcd         pic x(4).
  3623     02  eibsynrb         pic x(1).
  3624     02  eibnodat         pic x(1).
  3625     02  eibfiller5       pic x(2).
  3626     02  eibresp          pic s9(8) comp.
  3627     02  eibresp2         pic s9(8) comp.
  3628     02  dfheigdj         pic s9(4) comp.
  3629     02  dfheigdk         pic s9(4) comp.
  3630 01  DFHCOMMAREA                 PIC X(1024).
  3631
  3632*                                COPY ELCMSTR.
  3633******************************************************************
  3634*                                                                *
  3635*                            ELCMSTR.                            *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  67
* EL131.cbl
  3636*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3637*                            VMOD=2.012                          *
  3638*                                                                *
  3639*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3640*                                                                *
  3641*   FILE TYPE = VSAM,KSDS                                        *
  3642*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3643*                                                                *
  3644*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3645*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3646*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3647*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3648*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3649*                                                 RKP=75,LEN=21  *
  3650*                                                                *
  3651*   **** NOTE ****                                               *
  3652*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3653*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3654*                                                                *
  3655*   LOG = YES                                                    *
  3656*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3657******************************************************************
  3658*                   C H A N G E   L O G
  3659*
  3660* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3661*-----------------------------------------------------------------
  3662*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3663* EFFECTIVE    NUMBER
  3664*-----------------------------------------------------------------
  3665* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3666* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3667* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3668* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3669* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3670* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3671* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3672******************************************************************
  3673 01  CLAIM-MASTER.
  3674     12  CL-RECORD-ID                PIC XX.
  3675         88  VALID-CL-ID         VALUE 'CL'.
  3676
  3677     12  CL-CONTROL-PRIMARY.
  3678         16  CL-COMPANY-CD           PIC X.
  3679         16  CL-CARRIER              PIC X.
  3680         16  CL-CLAIM-NO             PIC X(7).
  3681         16  CL-CERT-NO.
  3682             20  CL-CERT-PRIME       PIC X(10).
  3683             20  CL-CERT-SFX         PIC X.
  3684
  3685     12  CL-CONTROL-BY-NAME.
  3686         16  CL-COMPANY-CD-A1        PIC X.
  3687         16  CL-INSURED-LAST-NAME    PIC X(15).
  3688         16  CL-INSURED-NAME.
  3689             20  CL-INSURED-1ST-NAME PIC X(12).
  3690             20  CL-INSURED-MID-INIT PIC X.
  3691
  3692     12  CL-CONTROL-BY-SSN.
  3693         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  68
* EL131.cbl
  3694         16  CL-SOC-SEC-NO.
  3695             20  CL-SSN-STATE        PIC XX.
  3696             20  CL-SSN-ACCOUNT      PIC X(6).
  3697             20  CL-SSN-LN3          PIC X(3).
  3698
  3699     12  CL-CONTROL-BY-CERT-NO.
  3700         16  CL-COMPANY-CD-A4        PIC X.
  3701         16  CL-CERT-NO-A4.
  3702             20  CL-CERT-A4-PRIME    PIC X(10).
  3703             20  CL-CERT-A4-SFX      PIC X.
  3704
  3705     12  CL-CONTROL-BY-CCN.
  3706         16  CL-COMPANY-CD-A5        PIC X.
  3707         16  CL-CCN-A5.
  3708             20  CL-CCN.
  3709                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3710                 24  CL-CCN-PRIME-A5 PIC X(12).
  3711             20  CL-CCN-FILLER-A5    PIC X(4).
  3712
  3713     12  CL-INSURED-PROFILE-DATA.
  3714         16  CL-INSURED-BIRTH-DT     PIC XX.
  3715         16  CL-INSURED-SEX-CD       PIC X.
  3716             88  INSURED-IS-MALE        VALUE 'M'.
  3717             88  INSURED-IS-FEMALE      VALUE 'F'.
  3718             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3719         16  CL-INSURED-OCC-CD       PIC X(6).
  3720         16  FILLER                  PIC X(5).
  3721
  3722     12  CL-PROCESSING-INFO.
  3723         16  CL-PROCESSOR-ID         PIC X(4).
  3724         16  CL-CLAIM-STATUS         PIC X.
  3725             88  CLAIM-IS-OPEN          VALUE 'O'.
  3726             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3727         16  CL-CLAIM-TYPE           PIC X.
  3728*            88  AH-CLAIM               VALUE 'A'.
  3729*            88  LIFE-CLAIM             VALUE 'L'.
  3730*            88  PROPERTY-CLAIM         VALUE 'P'.
  3731*            88  IUI-CLAIM              VALUE 'I'.
  3732*            88  GAP-CLAIM              VALUE 'G'.
  3733*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3734*            88  OTHER-CLAIM            VALUE 'O'.
  3735         16  CL-CLAIM-PREM-TYPE      PIC X.
  3736             88  SINGLE-PREMIUM         VALUE '1'.
  3737             88  O-B-COVERAGE           VALUE '2'.
  3738             88  OPEN-END-COVERAGE      VALUE '3'.
  3739         16  CL-INCURRED-DT          PIC XX.
  3740         16  CL-REPORTED-DT          PIC XX.
  3741         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3742         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3743         16  CL-LAST-PMT-DT          PIC XX.
  3744         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3745         16  CL-PAID-THRU-DT         PIC XX.
  3746         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3747         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3748         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3749         16  CL-PMT-CALC-METHOD      PIC X.
  3750             88  CL-360-DAY-YR          VALUE '1'.
  3751             88  CL-365-DAY-YR          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  69
* EL131.cbl
  3752             88  CL-FULL-MONTHS         VALUE '3'.
  3753         16  CL-CAUSE-CD             PIC X(6).
  3754
  3755         16  CL-PRIME-CERT-NO.
  3756             20  CL-PRIME-CERT-PRIME PIC X(10).
  3757             20  CL-PRIME-CERT-SFX   PIC X.
  3758
  3759         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3760             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3761             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3762
  3763         16  CL-MICROFILM-NO         PIC X(10).
  3764         16  FILLER REDEFINES CL-MICROFILM-NO.
  3765             20  CL-BENEFIT-PERIOD   PIC 99.
  3766             20  FILLER              PIC X(8).
  3767         16  CL-PROG-FORM-TYPE       PIC X.
  3768         16  CL-LAST-ADD-ON-DT       PIC XX.
  3769
  3770         16  CL-LAST-REOPEN-DT       PIC XX.
  3771         16  CL-LAST-CLOSE-DT        PIC XX.
  3772         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3773             88  FINAL-PAID             VALUE '1'.
  3774             88  CLAIM-DENIED           VALUE '2'.
  3775             88  AUTO-CLOSE             VALUE '3'.
  3776             88  MANUAL-CLOSE           VALUE '4'.
  3777             88  BENEFITS-CHANGED       VALUE 'C'.
  3778             88  SETUP-ERRORS           VALUE 'E'.
  3779         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3780         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3781         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3782             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3783         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3784         16  FILLER                  PIC X.
  3785
  3786     12  CL-CERTIFICATE-DATA.
  3787         16  CL-CERT-ORIGIN          PIC X.
  3788             88  CERT-WAS-ONLINE        VALUE '1'.
  3789             88  CERT-WAS-CREATED       VALUE '2'.
  3790             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3791         16  CL-CERT-KEY-DATA.
  3792             20  CL-CERT-CARRIER     PIC X.
  3793             20  CL-CERT-GROUPING    PIC X(6).
  3794             20  CL-CERT-STATE       PIC XX.
  3795             20  CL-CERT-ACCOUNT.
  3796                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3797                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3798             20  CL-CERT-EFF-DT      PIC XX.
  3799
  3800     12  CL-STATUS-CONTROLS.
  3801         16  CL-PRIORITY-CD          PIC X.
  3802             88  CONFIDENTIAL-DATA      VALUE '8'.
  3803             88  HIGHEST-PRIORITY       VALUE '9'.
  3804         16  CL-SUPV-ATTN-CD         PIC X.
  3805             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3806             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3807         16  CL-PURGED-DT            PIC XX.
  3808         16  CL-RESTORED-DT          PIC XX.
  3809         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  70
* EL131.cbl
  3810         16  CL-NEXT-RESEND-DT       PIC XX.
  3811         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3812         16  CL-CRITICAL-PERIOD      PIC 99.
  3813*        16  FILLER                  PIC XX.
  3814         16  CL-LAST-MAINT-DT        PIC XX.
  3815         16  CL-LAST-MAINT-USER      PIC X(4).
  3816         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3817         16  CL-LAST-MAINT-TYPE      PIC X.
  3818             88  CLAIM-SET-UP           VALUE ' '.
  3819             88  PAYMENT-MADE           VALUE '1'.
  3820             88  LETTER-SENT            VALUE '2'.
  3821             88  MASTER-WAS-ALTERED     VALUE '3'.
  3822             88  MASTER-WAS-RESTORED    VALUE '4'.
  3823             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3824             88  FILE-CONVERTED         VALUE '6'.
  3825             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3826             88  ERROR-CORRECTION       VALUE 'E'.
  3827         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3828         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3829         16  CL-BENEFICIARY          PIC X(10).
  3830         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3831         16  CL-DENIAL-TYPE          PIC X.
  3832             88  CL-TYPE-DENIAL          VALUE '1'.
  3833             88  CL-TYPE-RESCISSION      VALUE '2'.
  3834             88  CL-TYPE-REFORMATION     VALUE '3'.
  3835             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3836             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3837         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3838         16  filler                  pic x(3).
  3839*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3840*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3841*        16  CL-RTW-DT               PIC XX.
  3842
  3843     12  CL-TRAILER-CONTROLS.
  3844         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3845             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3846             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3847             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3848         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3849         16  FILLER                  PIC XX.
  3850         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3851         16  CL-ADDRESS-TRAILER-CNT.
  3852             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3853                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3854             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3855                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3856             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3857                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3858             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3859                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3860             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3861                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3862             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3863                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3864             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3865                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3866
  3867     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  71
* EL131.cbl
  3868         16  CL-CV-REFNO-PRIME       PIC X(18).
  3869         16  CL-CV-REFNO-SFX         PIC XX.
  3870
  3871     12  CL-FILE-LOCATION            PIC X(4).
  3872
  3873     12  CL-PROCESS-ERRORS.
  3874         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3875             88  NO-FATAL-ERRORS        VALUE ZERO.
  3876         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3877             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3878
  3879     12  CL-PRODUCT-CD               PIC X.
  3880
  3881     12  CL-CURRENT-KEY-DATA.
  3882         16  CL-CURRENT-CARRIER      PIC X.
  3883         16  CL-CURRENT-GROUPING     PIC X(6).
  3884         16  CL-CURRENT-STATE        PIC XX.
  3885         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3886
  3887     12  CL-ASSOCIATES               PIC X.
  3888         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3889         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3890         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3891         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3892
  3893     12  CL-ACTIVITY-CODE            PIC 99.
  3894     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3895     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3896
  3897     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3898     12  CL-LAG-REPORT-CODE          PIC 9.
  3899     12  CL-LOAN-TYPE                PIC XX.
  3900     12  CL-LEGAL-STATE              PIC XX.
  3901
  3902     12  CL-YESNOSW                  PIC X.
  3903     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3904         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3905         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3906         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3907     12  cl-insured-type             pic x.
  3908         88  cl-claim-on-primary         value 'P'.
  3909         88  cl-claim-on-co-borrower     value 'C'.
  3910     12  cl-benefit-expiration-dt    PIC XX.
  3911
  3912*                                COPY ELCCERT.
  3913******************************************************************
  3914*                                                                *
  3915*                            ELCCERT.                            *
  3916*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3917*                            VMOD=2.013                          *
  3918*                                                                *
  3919*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3920*                                                                *
  3921*   FILE TYPE = VSAM,KSDS                                        *
  3922*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3923*                                                                *
  3924*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3925*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  72
* EL131.cbl
  3926*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3927*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3928*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3929*                                                                *
  3930*   LOG = YES                                                    *
  3931*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3932******************************************************************
  3933*                   C H A N G E   L O G
  3934*
  3935* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3936*-----------------------------------------------------------------
  3937*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3938* EFFECTIVE    NUMBER
  3939*-----------------------------------------------------------------
  3940* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3941* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3942* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3943* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3944* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3945* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3946* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3947* 032612  CR2011110200001  PEMA  AHL CHANGES
  3948* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3949* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3950* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  3951******************************************************************
  3952
  3953 01  CERTIFICATE-MASTER.
  3954     12  CM-RECORD-ID                      PIC XX.
  3955         88  VALID-CM-ID                      VALUE 'CM'.
  3956
  3957     12  CM-CONTROL-PRIMARY.
  3958         16  CM-COMPANY-CD                 PIC X.
  3959         16  CM-CARRIER                    PIC X.
  3960         16  CM-GROUPING.
  3961             20  CM-GROUPING-PREFIX        PIC X(3).
  3962             20  CM-GROUPING-PRIME         PIC X(3).
  3963         16  CM-STATE                      PIC XX.
  3964         16  CM-ACCOUNT.
  3965             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3966             20  CM-ACCOUNT-PRIME          PIC X(6).
  3967         16  CM-CERT-EFF-DT                PIC XX.
  3968         16  CM-CERT-NO.
  3969             20  CM-CERT-PRIME             PIC X(10).
  3970             20  CM-CERT-SFX               PIC X.
  3971
  3972     12  CM-CONTROL-BY-NAME.
  3973         16  CM-COMPANY-CD-A1              PIC X.
  3974         16  CM-INSURED-LAST-NAME          PIC X(15).
  3975         16  CM-INSURED-INITIALS.
  3976             20  CM-INSURED-INITIAL1       PIC X.
  3977             20  CM-INSURED-INITIAL2       PIC X.
  3978
  3979     12  CM-CONTROL-BY-SSN.
  3980         16  CM-COMPANY-CD-A2              PIC X.
  3981         16  CM-SOC-SEC-NO.
  3982             20  CM-SSN-STATE              PIC XX.
  3983             20  CM-SSN-ACCOUNT            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  73
* EL131.cbl
  3984             20  CM-SSN-LN3.
  3985                 25  CM-INSURED-INITIALS-A2.
  3986                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3987                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3988                 25 CM-PART-LAST-NAME-A2         PIC X.
  3989
  3990     12  CM-CONTROL-BY-CERT-NO.
  3991         16  CM-COMPANY-CD-A4              PIC X.
  3992         16  CM-CERT-NO-A4                 PIC X(11).
  3993
  3994     12  CM-CONTROL-BY-MEMB.
  3995         16  CM-COMPANY-CD-A5              PIC X.
  3996         16  CM-MEMBER-NO.
  3997             20  CM-MEMB-STATE             PIC XX.
  3998             20  CM-MEMB-ACCOUNT           PIC X(6).
  3999             20  CM-MEMB-LN4.
  4000                 25  CM-INSURED-INITIALS-A5.
  4001                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4002                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4003                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4004
  4005     12  CM-INSURED-PROFILE-DATA.
  4006         16  CM-INSURED-FIRST-NAME.
  4007             20  CM-INSURED-1ST-INIT       PIC X.
  4008             20  FILLER                    PIC X(9).
  4009         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4010         16  CM-INSURED-SEX                PIC X.
  4011             88  CM-SEX-MALE                  VALUE 'M'.
  4012             88  CM-SEX-FEMAL                 VALUE 'F'.
  4013         16  CM-INSURED-JOINT-AGE          PIC 99.
  4014         16  CM-JOINT-INSURED-NAME.
  4015             20  CM-JT-LAST-NAME           PIC X(15).
  4016             20  CM-JT-FIRST-NAME.
  4017                 24  CM-JT-1ST-INIT        PIC X.
  4018                 24  FILLER                PIC X(9).
  4019             20  CM-JT-INITIAL             PIC X.
  4020
  4021     12  CM-LIFE-DATA.
  4022         16  CM-LF-BENEFIT-CD              PIC XX.
  4023         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4024         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4025         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4026         16  CM-LF-DEV-CODE                PIC XXX.
  4027         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4028         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4029         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4030         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4031         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4032         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4033         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4034         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4035         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4036         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4037         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4038         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4039         16  cm-temp-epiq                  pic xx.
  4040             88  EPIQ-CLASS                  value 'EQ'.
  4041*        16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  74
* EL131.cbl
  4042
  4043     12  CM-AH-DATA.
  4044         16  CM-AH-BENEFIT-CD              PIC XX.
  4045         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4046         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4047         16  CM-AH-DEV-CODE                PIC XXX.
  4048         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4049         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4050         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4051         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4052         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4053         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4054         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4055         16  CM-AH-PAID-THRU-DT            PIC XX.
  4056             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4057         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4058         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4059         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4060         16  FILLER                        PIC X.
  4061
  4062     12  CM-LOAN-INFORMATION.
  4063         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4064         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4065                                           PIC S9(5)V99  COMP-3.
  4066         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4067         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4068         16  CM-PAY-FREQUENCY              PIC S99.
  4069         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4070         16  CM-RATE-CLASS                 PIC XX.
  4071         16  CM-BENEFICIARY                PIC X(25).
  4072         16  CM-POLICY-FORM-NO             PIC X(12).
  4073         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4074         16  CM-LAST-ADD-ON-DT             PIC XX.
  4075         16  CM-DEDUCTIBLE-AMOUNTS.
  4076             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4077             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4078         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4079             20  CM-RESIDENT-STATE         PIC XX.
  4080             20  CM-RATE-CODE              PIC X(4).
  4081             20  FILLER                    PIC XX.
  4082         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4083             20  CM-LOAN-OFFICER           PIC X(5).
  4084             20  FILLER                    PIC XXX.
  4085         16  CM-CSR-CODE                   PIC XXX.
  4086         16  CM-UNDERWRITING-CODE          PIC X.
  4087             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4088         16  CM-POST-CARD-IND              PIC X.
  4089         16  CM-REF-INTERFACE-SW           PIC X.
  4090         16  CM-PREMIUM-TYPE               PIC X.
  4091             88  CM-SING-PRM                  VALUE '1'.
  4092             88  CM-O-B-COVERAGE              VALUE '2'.
  4093             88  CM-OPEN-END                  VALUE '3'.
  4094         16  CM-IND-GRP-TYPE               PIC X.
  4095             88  CM-INDIVIDUAL                VALUE 'I'.
  4096             88  CM-GROUP                     VALUE 'G'.
  4097         16  CM-SKIP-CODE                  PIC X.
  4098             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4099             88  SKIP-JULY                    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  75
* EL131.cbl
  4100             88  SKIP-AUGUST                  VALUE '2'.
  4101             88  SKIP-SEPTEMBER               VALUE '3'.
  4102             88  SKIP-JULY-AUG                VALUE '4'.
  4103             88  SKIP-AUG-SEPT                VALUE '5'.
  4104             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4105             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4106             88  SKIP-JUNE                    VALUE '8'.
  4107             88  SKIP-JUNE-JULY               VALUE '9'.
  4108             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4109             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4110         16  CM-PAYMENT-MODE               PIC X.
  4111             88  PAY-MONTHLY                  VALUE SPACE.
  4112             88  PAY-WEEKLY                   VALUE '1'.
  4113             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4114             88  PAY-BI-WEEKLY                VALUE '3'.
  4115             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4116         16  CM-LOAN-NUMBER                PIC X(8).
  4117         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4118         16  CM-OLD-LOF                    PIC XXX.
  4119*        16  CM-LOAN-OFFICER               PIC XXX.
  4120         16  CM-REIN-TABLE                 PIC XXX.
  4121         16  CM-SPECIAL-REIN-CODE          PIC X.
  4122         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4123         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4124         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4125
  4126     12  CM-STATUS-DATA.
  4127         16  CM-ENTRY-STATUS               PIC X.
  4128         16  CM-ENTRY-DT                   PIC XX.
  4129
  4130         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4131         16  CM-LF-CANCEL-DT               PIC XX.
  4132         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4133
  4134         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4135         16  CM-LF-DEATH-DT                PIC XX.
  4136         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4137
  4138         16  CM-LF-CURRENT-STATUS          PIC X.
  4139             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4140                                                'M' '4' '5' '9'.
  4141             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4142             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4143             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4144             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4145             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4146             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4147             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4148             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4149             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4150             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4151             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4152             88  CM-LF-DECLINED               VALUE 'D'.
  4153             88  CM-LF-VOIDED                 VALUE 'V'.
  4154
  4155         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4156         16  CM-AH-CANCEL-DT               PIC XX.
  4157         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  76
* EL131.cbl
  4158
  4159         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4160         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4161         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4162
  4163         16  CM-AH-CURRENT-STATUS          PIC X.
  4164             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4165                                                'M' '4' '5' '9'.
  4166             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4167             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4168             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4169             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4170             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4171             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4172             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4173             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4174             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4175             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4176             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4177             88  CM-AH-DECLINED               VALUE 'D'.
  4178             88  CM-AH-VOIDED                 VALUE 'V'.
  4179
  4180         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4181             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4182             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4183             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4184         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4185
  4186         16  CM-ENTRY-BATCH                PIC X(6).
  4187         16  CM-LF-EXIT-BATCH              PIC X(6).
  4188         16  CM-AH-EXIT-BATCH              PIC X(6).
  4189         16  CM-LAST-MONTH-END             PIC XX.
  4190
  4191     12  CM-NOTE-SW                        PIC X.
  4192         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4193         88  CERT-NOTES-PRESENT               VALUE '1'.
  4194         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4195         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4196         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4197         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4198         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4199         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4200     12  CM-COMP-EXCP-SW                   PIC X.
  4201         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4202         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4203     12  CM-INSURED-ADDRESS-SW             PIC X.
  4204         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4205         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4206
  4207*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4208     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4209     12  FILLER                            PIC X.
  4210
  4211*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4212     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4213     12  FILLER                            PIC X.
  4214*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4215     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  77
* EL131.cbl
  4216
  4217     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4218         88  CERT-ADDED-BATCH                 VALUE ' '.
  4219         88  CERT-ADDED-ONLINE                VALUE '1'.
  4220         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4221         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4222         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4223     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4224         88  CERT-AS-LOADED                   VALUE ' '.
  4225         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4226         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4227         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4228         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4229         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4230         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4231         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4232
  4233     12  CM-ACCOUNT-COMM-PCTS.
  4234         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4235         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4236
  4237     12  CM-USER-FIELD                     PIC X.
  4238     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4239     12  CM-CLP-STATE                      PIC XX.
  4240     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4241     12  CM-USER-RESERVED                  PIC XXX.
  4242     12  FILLER REDEFINES CM-USER-RESERVED.
  4243         16  CM-AH-CLASS-CD                PIC XX.
  4244         16  F                             PIC X.
  4245******************************************************************
  4246
  4247*                                COPY ELCTRLR.
  4248******************************************************************
  4249*                                                                *
  4250*                            ELCTRLR.                            *
  4251*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4252*                            VMOD=2.014                          *
  4253*                                                                *
  4254*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4255*                                                                *
  4256*   FILE TYPE = VSAM,KSDS                                        *
  4257*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4258*                                                                *
  4259*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4260*       ALTERNATE INDEX = NONE                                   *
  4261*                                                                *
  4262*   LOG = YES                                                    *
  4263*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4264******************************************************************
  4265*                   C H A N G E   L O G
  4266*
  4267* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4268*-----------------------------------------------------------------
  4269*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4270* EFFECTIVE    NUMBER
  4271*-----------------------------------------------------------------
  4272* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4273* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  78
* EL131.cbl
  4274* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4275* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4276* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4277* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4278* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4279* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4280* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4281* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4282* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4283* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4284* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4285* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4286* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4287* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4288* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4289* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4290* 040814    2014030500002  AJRA  ADD ICD CODES
  4291* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4292* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4293* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4294* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4295* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  4296******************************************************************
  4297 01  ACTIVITY-TRAILERS.
  4298     12  AT-RECORD-ID                    PIC XX.
  4299         88  VALID-AT-ID                       VALUE 'AT'.
  4300
  4301     12  AT-CONTROL-PRIMARY.
  4302         16  AT-COMPANY-CD               PIC X.
  4303         16  AT-CARRIER                  PIC X.
  4304         16  AT-CLAIM-NO                 PIC X(7).
  4305         16  AT-CERT-NO.
  4306             20  AT-CERT-PRIME           PIC X(10).
  4307             20  AT-CERT-SFX             PIC X.
  4308         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4309             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4310             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4311             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4312             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4313             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4314             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4315             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4316             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4317             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4318             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4319             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4320             88  AT-BENEFICIARY-TRL           VALUE +91.
  4321             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4322             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4323             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4324             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4325
  4326     12  AT-TRAILER-TYPE                 PIC X.
  4327         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4328         88  PAYMENT-TR                       VALUE '2'.
  4329         88  AUTO-PAY-TR                      VALUE '3'.
  4330         88  CORRESPONDENCE-TR                VALUE '4'.
  4331         88  ADDRESS-TR                       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  79
* EL131.cbl
  4332         88  GENERAL-INFO-TR                  VALUE '6'.
  4333         88  AUTO-PROMPT-TR                   VALUE '7'.
  4334         88  DENIAL-TR                        VALUE '8'.
  4335         88  INCURRED-CHG-TR                  VALUE '9'.
  4336         88  FORM-CONTROL-TR                  VALUE 'A'.
  4337
  4338     12  AT-RECORDED-DT                  PIC XX.
  4339     12  AT-RECORDED-BY                  PIC X(4).
  4340     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4341
  4342     12  AT-TRAILER-BODY                 PIC X(165).
  4343
  4344     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4345         16  AT-RESERVE-CONTROLS.
  4346             20  AT-MANUAL-SW            PIC X.
  4347                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4348             20  AT-FUTURE-SW            PIC X.
  4349                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4350             20  AT-PTC-SW               PIC X.
  4351                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4352             20  AT-IBNR-SW              PIC X.
  4353                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4354             20  AT-PTC-LF-SW            PIC X.
  4355                 88  AT-LF-PTC-USED          VALUE '1'.
  4356             20  AT-CDT-ACCESS-METHOD    PIC X.
  4357                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4358                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4359                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4360             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4361         16  AT-LAST-COMPUTED-DT         PIC XX.
  4362         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4363         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4364         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4365         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4366         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4367         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4368         16  AT-EXPENSE-CONTROLS.
  4369             20  AT-EXPENSE-METHOD       PIC X.
  4370                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4371                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4372                 88  PERCENT-OF-PMT           VALUE '3'.
  4373                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4374             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4375             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4376         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4377         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4378
  4379         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4380         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4381
  4382*        16  FILLER                      PIC X(53).
  4383         16  FILLER                      PIC X(47).
  4384
  4385         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4386         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4387
  4388         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4389             20  AT-OPEN-CLOSE-DATE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  80
* EL131.cbl
  4390             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4391*                    C = CLOSED
  4392*                    O = OPEN
  4393             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4394*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4395
  4396     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4397         16  AT-PAYMENT-TYPE             PIC X.
  4398             88  PARTIAL-PAYMENT                VALUE '1'.
  4399             88  FINAL-PAYMENT                  VALUE '2'.
  4400             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4401             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4402             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4403             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4404             88  VOIDED-PAYMENT                 VALUE '9'.
  4405             88  TRANSFER                       VALUE 'T'.
  4406             88  LIFE-INTEREST                  VALUE 'I'.
  4407
  4408         16  AT-CLAIM-TYPE               PIC X.
  4409             88  PAID-FOR-AH                    VALUE 'A'.
  4410             88  PAID-FOR-LIFE                  VALUE 'L'.
  4411             88  PAID-FOR-IUI                   VALUE 'I'.
  4412             88  PAID-FOR-GAP                   VALUE 'G'.
  4413             88  PAID-FOR-FAM                   VALUE 'F'.
  4414             88  PAID-FOR-OTH                   VALUE 'O'.
  4415         16  AT-CLAIM-PREM-TYPE          PIC X.
  4416             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4417             88  AT-O-B-COVERAGE                VALUE '2'.
  4418             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4419         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4420         16  AT-CHECK-NO                 PIC X(7).
  4421         16  AT-PAID-FROM-DT             PIC XX.
  4422         16  AT-PAID-THRU-DT             PIC XX.
  4423         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4424         16  AT-ACH-PAYMENT              PIC X.
  4425*        16  FILLER                      PIC X.
  4426         16  AT-PAYEES-NAME              PIC X(30).
  4427         16  AT-PAYMENT-ORIGIN           PIC X.
  4428             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4429             88  ONLINE-AUTO-PMT                VALUE '2'.
  4430             88  OFFLINE-PMT                    VALUE '3'.
  4431         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4432         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4433         16  AT-VOID-DATA.
  4434             20  AT-VOID-DT              PIC XX.
  4435*00144       20  AT-VOID-REASON          PIC X(30).
  4436             20  AT-VOID-REASON          PIC X(26).
  4437         16  AT-PMT-APPROVED-BY          PIC X(04).
  4438         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4439         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4440         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4441                                         PIC S99V9(5)  COMP-3.
  4442         16  AT-CREDIT-INTERFACE.
  4443             20  AT-PMT-SELECT-DT        PIC XX.
  4444                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4445             20  AT-PMT-ACCEPT-DT        PIC XX.
  4446                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4447             20  AT-VOID-SELECT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  81
* EL131.cbl
  4448                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4449             20  AT-VOID-ACCEPT-DT       PIC XX.
  4450                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4451
  4452         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4453                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4454                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4455         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4456
  4457         16  AT-FORCE-CONTROL            PIC X.
  4458             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4459         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4460         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4461         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4462         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4463         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4464         16  AT-BENEFIT-TYPE             PIC X.
  4465
  4466         16  AT-EXPENSE-TYPE             PIC X.
  4467         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4468
  4469         16  AT-PAYEE-TYPE-CD.
  4470             20  AT-PAYEE-TYPE           PIC X.
  4471                 88  INSURED-PAID           VALUE 'I'.
  4472                 88  BENEFICIARY-PAID       VALUE 'B'.
  4473                 88  ACCOUNT-PAID           VALUE 'A'.
  4474                 88  OTHER-1-PAID           VALUE 'O'.
  4475                 88  OTHER-2-PAID           VALUE 'Q'.
  4476                 88  DOCTOR-PAID            VALUE 'P'.
  4477                 88  EMPLOYER-PAID          VALUE 'E'.
  4478             20  AT-PAYEE-SEQ            PIC X.
  4479
  4480         16  AT-CASH-PAYMENT             PIC X.
  4481         16  AT-GROUPED-PAYMENT          PIC X.
  4482         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4483         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4484         16  AT-APPROVED-LEVEL           PIC X.
  4485         16  AT-VOID-TYPE                PIC X.
  4486             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4487             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4488         16  AT-AIG-UNEMP-IND            PIC X.
  4489             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4490         16  AT-ASSOCIATES               PIC X.
  4491             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4492             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4493
  4494         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4495         16  AT-CV-PMT-CODE              PIC X.
  4496             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4497             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4498             88  FULL-ADD-PAYMENT           VALUE '3'.
  4499             88  HALF-ADD-PAYMENT           VALUE '4'.
  4500             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4501             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4502             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4503             88  ADDL-PAYMENT               VALUE '8'.
  4504
  4505         16  AT-EOB-CODE1                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  82
* EL131.cbl
  4506         16  AT-EOB-CODE2                PIC XXX.
  4507         16  AT-EOB-CODE3                PIC XXX.
  4508         16  FILLER REDEFINES AT-EOB-CODE3.
  4509             20  AT-PRINT-CLM-FORM       PIC X.
  4510             20  AT-PRINT-SURVEY         PIC X.
  4511             20  AT-SPECIAL-RELEASE      PIC X.
  4512         16  AT-EOB-CODE4                PIC XXX.
  4513         16  FILLER REDEFINES AT-EOB-CODE4.
  4514             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4515             20  FILLER                  PIC X.
  4516         16  AT-EOB-CODE5                PIC XXX.
  4517         16  FILLER REDEFINES AT-EOB-CODE5.
  4518             20  AT-PMT-PROOF-DT         PIC XX.
  4519             20  FILLER                  PIC X.
  4520
  4521         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4522             88  AT-PRINT-EOB            VALUE 'Y'.
  4523
  4524         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4525         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4526
  4527     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4528         16  AT-SCHEDULE-START-DT        PIC XX.
  4529         16  AT-SCHEDULE-END-DT          PIC XX.
  4530         16  AT-TERMINATED-DT            PIC XX.
  4531         16  AT-LAST-PMT-TYPE            PIC X.
  4532             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4533             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4534         16  AT-FIRST-PMT-DATA.
  4535             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4536             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4537             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4538         16  AT-REGULAR-PMT-DATA.
  4539             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4540             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4541             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4542         16  AT-AUTO-PAYEE-CD.
  4543             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4544                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4545                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4546                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4547                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4548                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4549             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4550         16  AT-AUTO-PAY-DAY             PIC 99.
  4551         16  AT-AUTO-CASH                PIC X.
  4552             88  AT-CASH                      VALUE 'Y'.
  4553             88  AT-NON-CASH                  VALUE 'N'.
  4554*        16  FILLER                      PIC X(129).
  4555         16  AT-AUTO-END-LETTER          PIC X(4).
  4556         16  FILLER                      PIC X(125).
  4557
  4558         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4559         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4560
  4561     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4562         16  AT-LETTER-SENT-DT           PIC XX.
  4563         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  83
* EL131.cbl
  4564         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4565         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4566         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4567         16  AT-LETTER-ORIGIN            PIC X.
  4568             88  ONLINE-CREATION              VALUE '1' '3'.
  4569             88  OFFLINE-CREATION             VALUE '2' '4'.
  4570             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4571             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4572         16  AT-STD-LETTER-FORM          PIC X(4).
  4573         16  AT-REASON-TEXT              PIC X(70).
  4574         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4575         16  AT-ADDRESEE-TYPE            PIC X.
  4576              88  INSURED-ADDRESEE            VALUE 'I'.
  4577              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4578              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4579              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4580              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4581              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4582              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4583         16  AT-ADDRESSEE-NAME           PIC X(30).
  4584         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4585         16  AT-RESEND-PRINT-DATE        PIC XX.
  4586         16  AT-CORR-SOL-UNSOL           PIC X.
  4587         16  AT-LETTER-PURGED-DT         PIC XX.
  4588*
  4589*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4590*
  4591         16  AT-CSO-REDEFINITION.
  4592             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4593             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4594             20  AT-LETTER-TO-BENE       PIC X(1).
  4595             20  AT-STOP-LETTER-DT       PIC X(2).
  4596             20  AT-AUTH-RCVD            PIC X(1).
  4597             20  FILLER                  PIC X(18).
  4598*             20  FILLER                  PIC X(27).
  4599             20  AT-CSO-LETTER-STATUS    PIC X.
  4600                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4601                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4602                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4603             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4604             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4605*
  4606*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4607*
  4608*        16  FILLER                      PIC X(26).
  4609*
  4610*        16  AT-DMD-BSR-CODE             PIC X.
  4611*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4612*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4613*
  4614*        16  AT-DMD-LETTER-STATUS        PIC X.
  4615*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4616*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4617*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4618*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4619*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4620
  4621         16  AT-CORR-LAST-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  84
* EL131.cbl
  4622         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4623
  4624     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4625         16  AT-ADDRESS-TYPE             PIC X.
  4626             88  INSURED-ADDRESS               VALUE 'I'.
  4627             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4628             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4629             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4630             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4631             88  OTHER-ADDRESS-1               VALUE 'O'.
  4632             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4633         16  AT-MAIL-TO-NAME             PIC X(30).
  4634         16  AT-ADDRESS-LINE-1           PIC X(30).
  4635         16  AT-ADDRESS-LINE-2           PIC X(30).
  4636         16  AT-CITY-STATE.
  4637             20  AT-CITY                 PIC X(28).
  4638             20  AT-STATE                PIC XX.
  4639         16  AT-ZIP.
  4640             20  AT-ZIP-CODE.
  4641                 24  AT-ZIP-1ST          PIC X.
  4642                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4643                 24  FILLER              PIC X(4).
  4644             20  AT-ZIP-PLUS4            PIC X(4).
  4645         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4646             20  AT-CAN-POSTAL-1         PIC XXX.
  4647             20  AT-CAN-POSTAL-2         PIC XXX.
  4648             20  FILLER                  PIC XXX.
  4649         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4650*         16  FILLER                      PIC X(23).
  4651         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4652         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4653         16  FILLER                      PIC X(13).
  4654         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4655         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4656
  4657     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4658         16  AT-INFO-LINE-1              PIC X(60).
  4659         16  FILLER REDEFINES AT-INFO-LINE-1.
  4660             20  AT-NOTE-ERROR-NO OCCURS 15
  4661                                         PIC X(4).
  4662         16  AT-INFO-LINE-2              PIC X(60).
  4663         16  FILLER REDEFINES AT-INFO-LINE-2.
  4664             20  AT-ICD-CODE-1           PIC X(8).
  4665             20  AT-ICD-CODE-2           PIC X(8).
  4666             20  FILLER                  PIC X(44).
  4667         16  AT-INFO-TRAILER-TYPE        PIC X.
  4668             88  AT-ERRORS-NOTE          VALUE 'E'.
  4669             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4670             88  AT-CALL-NOTE            VALUE 'C'.
  4671             88  AT-MAINT-NOTE           VALUE 'M'.
  4672             88  AT-CERT-CHANGE          VALUE 'X'.
  4673             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4674             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4675             88  AT-CERT-CANCELLED       VALUE 'T'.
  4676         16  AT-CALL-TYPE                PIC X.
  4677             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4678             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  4679             88  AT-PHONE-CALL-OUT       VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  85
* EL131.cbl
  4680         16  AT-NOTE-CONTINUATION        PIC X.
  4681             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4682         16  AT-EOB-CODES-EXIST          PIC X.
  4683             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4684         16  FILLER                      PIC X(35).
  4685         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4686         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4687
  4688     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4689         16  AT-PROMPT-LINE-1            PIC X(60).
  4690         16  AT-PROMPT-LINE-2            PIC X(60).
  4691         16  AT-PROMPT-START-DT          PIC XX.
  4692         16  AT-PROMPT-END-DT            PIC XX.
  4693         16  FILLER                      PIC X(35).
  4694         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4695         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4696
  4697     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4698         16  AT-DENIAL-INFO-1            PIC X(60).
  4699         16  AT-DENIAL-INFO-2            PIC X(60).
  4700         16  AT-DENIAL-DT                PIC XX.
  4701         16  AT-RETRACTION-DT            PIC XX.
  4702         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4703*         16  FILLER                      PIC X(31).
  4704         16  AT-DENIAL-PROOF-DT          PIC XX.
  4705         16  FILLER                      PIC X(29).
  4706         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4707         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4708
  4709     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4710         16  AT-OLD-INCURRED-DT          PIC XX.
  4711         16  AT-OLD-REPORTED-DT          PIC XX.
  4712         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4713         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4714         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4715         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4716         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4717         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4718         16  FILLER                      PIC X(26).
  4719         16  AT-OLD-DIAG-CODE            PIC X(6).
  4720         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4721         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4722         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4723         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4724         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4725         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4726         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4727         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4728         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4729         16  FILLER                      PIC X(9).
  4730         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4731
  4732     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4733         16  AT-FORM-SEND-ON-DT          PIC XX.
  4734         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4735         16  AT-FORM-RE-SEND-DT          PIC XX.
  4736         16  AT-FORM-ANSWERED-DT         PIC XX.
  4737         16  AT-FORM-PRINTED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  86
* EL131.cbl
  4738         16  AT-FORM-REPRINT-DT          PIC XX.
  4739         16  AT-FORM-TYPE                PIC X.
  4740             88  INITIAL-FORM                  VALUE '1'.
  4741             88  PROGRESS-FORM                 VALUE '2'.
  4742         16  AT-INSTRUCT-LN-1            PIC X(28).
  4743         16  AT-INSTRUCT-LN-2            PIC X(28).
  4744         16  AT-INSTRUCT-LN-3            PIC X(28).
  4745         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4746         16  AT-FORM-ADDRESS             PIC X.
  4747             88  FORM-TO-INSURED              VALUE 'I'.
  4748             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4749             88  FORM-TO-OTHER-1              VALUE 'O'.
  4750             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4751         16  AT-RELATED-1.
  4752             20 AT-REL-CARR-1            PIC X.
  4753             20 AT-REL-CLAIM-1           PIC X(7).
  4754             20 AT-REL-CERT-1            PIC X(11).
  4755         16  AT-RELATED-2.
  4756             20 AT-REL-CARR-2            PIC X.
  4757             20 AT-REL-CLAIM-2           PIC X(7).
  4758             20 AT-REL-CERT-2            PIC X(11).
  4759         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4760         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4761         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4762         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4763         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4764         16  AT-STOP-FORM-DT             PIC X(2).
  4765
  4766         16  FILLER                      PIC X(09).
  4767         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4768         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4769******************************************************************
  4770
  4771*                                COPY ELCCNTL.
  4772******************************************************************
  4773*                                                                *
  4774*                                                                *
  4775*                            ELCCNTL.                            *
  4776*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4777*                            VMOD=2.059                          *
  4778*                                                                *
  4779*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4780*                                                                *
  4781*   FILE TYPE = VSAM,KSDS                                        *
  4782*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4783*                                                                *
  4784*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4785*       ALTERNATE INDEX = NONE                                   *
  4786*                                                                *
  4787*   LOG = YES                                                    *
  4788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4789******************************************************************
  4790*                   C H A N G E   L O G
  4791*
  4792* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4793*-----------------------------------------------------------------
  4794*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4795* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  87
* EL131.cbl
  4796*-----------------------------------------------------------------
  4797* 082503                   PEMA  ADD BENEFIT GROUP
  4798* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4799* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4800* 092705    2005050300006  PEMA  ADD SPP LEASES
  4801* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4802* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4803* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4804* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4805* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4806* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4807* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4808* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4809* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4810* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4811* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4812******************************************************************
  4813*
  4814 01  CONTROL-FILE.
  4815     12  CF-RECORD-ID                       PIC XX.
  4816         88  VALID-CF-ID                        VALUE 'CF'.
  4817
  4818     12  CF-CONTROL-PRIMARY.
  4819         16  CF-COMPANY-ID                  PIC XXX.
  4820         16  CF-RECORD-TYPE                 PIC X.
  4821             88  CF-COMPANY-MASTER              VALUE '1'.
  4822             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4823             88  CF-STATE-MASTER                VALUE '3'.
  4824             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4825             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4826             88  CF-CARRIER-MASTER              VALUE '6'.
  4827             88  CF-MORTALITY-MASTER            VALUE '7'.
  4828             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4829             88  CF-TERMINAL-MASTER             VALUE '9'.
  4830             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4831             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4832             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4833             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4834             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4835             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4836             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4837             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4838             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4839         16  CF-ACCESS-CD-GENL              PIC X(4).
  4840         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4841             20  CF-PROCESSOR               PIC X(4).
  4842         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4843             20  CF-STATE-CODE              PIC XX.
  4844             20  FILLER                     PIC XX.
  4845         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4846             20  FILLER                     PIC XX.
  4847             20  CF-HI-BEN-IN-REC           PIC XX.
  4848         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4849             20  FILLER                     PIC XXX.
  4850             20  CF-CARRIER-CNTL            PIC X.
  4851         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4852             20  FILLER                     PIC XX.
  4853             20  CF-HI-TYPE-IN-REC          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  88
* EL131.cbl
  4854         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4855             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4856                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4857             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4858             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4859         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4860             20  FILLER                     PIC X.
  4861             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4862         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4863             20  FILLER                     PIC XX.
  4864             20  CF-MORTGAGE-PLAN           PIC XX.
  4865         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4866
  4867     12  CF-LAST-MAINT-DT                   PIC XX.
  4868     12  CF-LAST-MAINT-BY                   PIC X(4).
  4869     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4870
  4871     12  CF-RECORD-BODY                     PIC X(728).
  4872
  4873
  4874****************************************************************
  4875*             COMPANY MASTER RECORD                            *
  4876****************************************************************
  4877
  4878     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4879         16  CF-COMPANY-ADDRESS.
  4880             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4881             20  CF-CL-IN-CARE-OF           PIC X(30).
  4882             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4883             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4884             20  CF-CL-CITY-STATE           PIC X(30).
  4885             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4886             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4887         16  CF-COMPANY-CD                  PIC X.
  4888         16  CF-COMPANY-PASSWORD            PIC X(8).
  4889         16  CF-SECURITY-OPTION             PIC X.
  4890             88  ALL-SECURITY                   VALUE '1'.
  4891             88  COMPANY-VERIFY                 VALUE '2'.
  4892             88  PROCESSOR-VERIFY               VALUE '3'.
  4893             88  NO-SECURITY                    VALUE '4'.
  4894             88  ALL-BUT-TERM                   VALUE '5'.
  4895         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4896             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4897         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4898             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4899         16  CF-INFORCE-LOCATION            PIC X.
  4900             88  CERTS-ARE-ONLINE               VALUE '1'.
  4901             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4902             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4903         16  CF-LOWER-CASE-LETTERS          PIC X.
  4904         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4905             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4906             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4907             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4908             88  CF-ACCNT-CNTL                  VALUE '3'.
  4909             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4910
  4911         16  CF-FORMS-PRINTER-ID            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  89
* EL131.cbl
  4912         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4913
  4914         16  CF-LGX-CREDIT-USER             PIC X.
  4915             88  CO-IS-NOT-USER                 VALUE 'N'.
  4916             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4917
  4918         16 CF-CREDIT-CALC-CODES.
  4919             20  CF-CR-REM-TERM-CALC PIC X.
  4920               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4921               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4922               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4923               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4924               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4925               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4926               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4927             20  CF-CR-R78-METHOD           PIC X.
  4928               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4929               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4930
  4931         16  CF-CLAIM-CONTROL-COUNTS.
  4932             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4933                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4934
  4935             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4936                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4937
  4938             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4939                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4940
  4941             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4942                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4943
  4944         16  CF-CURRENT-MONTH-END           PIC XX.
  4945
  4946         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4947             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4948             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4949             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4950             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4951                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4952                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4953             20  CF-CO-PREM-REJECT-SW       PIC X.
  4954                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4955                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4956             20  CF-CO-REF-REJECT-SW        PIC X.
  4957                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4958                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4959
  4960         16  CF-CO-REPORTING-DT             PIC XX.
  4961         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4962         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4963           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4964           88  CF-CO-MONTH-END                  VALUE '1'.
  4965
  4966         16  CF-LGX-CLAIM-USER              PIC X.
  4967             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4968             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4969
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  90
* EL131.cbl
  4970         16  CF-CREDIT-EDIT-CONTROLS.
  4971             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4972             20  CF-MIN-AGE                 PIC 99.
  4973             20  CF-DEFAULT-AGE             PIC 99.
  4974             20  CF-MIN-TERM                PIC S999      COMP-3.
  4975             20  CF-MAX-TERM                PIC S999      COMP-3.
  4976             20  CF-DEFAULT-SEX             PIC X.
  4977             20  CF-JOINT-AGE-INPUT         PIC X.
  4978                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4979             20  CF-BIRTH-DATE-INPUT        PIC X.
  4980                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4981             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4982                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4983                 88  CF-ZERO-CARRIER            VALUE '1'.
  4984                 88  CF-ZERO-GROUPING           VALUE '2'.
  4985                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4986             20  CF-EDIT-SW                 PIC X.
  4987                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4988             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4989             20  CF-CR-PR-METHOD            PIC X.
  4990               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4991               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4992             20  FILLER                     PIC X.
  4993
  4994         16  CF-CREDIT-MISC-CONTROLS.
  4995             20  CF-REIN-TABLE-SW           PIC X.
  4996                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4997             20  CF-COMP-TABLE-SW           PIC X.
  4998                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4999             20  CF-EXPERIENCE-RETENTION-AGE
  5000                                            PIC S9        COMP-3.
  5001             20  CF-CONVERSION-DT           PIC XX.
  5002             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5003             20  CF-RUN-FREQUENCY-SW        PIC X.
  5004                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5005                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5006
  5007             20  CF-CR-CHECK-NO-CONTROL.
  5008                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5009                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5010                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5011                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5012                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5013                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5014
  5015                 24  CF-CR-CHECK-COUNT       REDEFINES
  5016                     CF-CR-CHECK-COUNTER      PIC X(4).
  5017
  5018                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5019                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5020
  5021                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5022                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5023                 24  CF-MAIL-PROCESSING       PIC X.
  5024                     88  MAIL-PROCESSING          VALUE 'Y'.
  5025
  5026         16  CF-MISC-SYSTEM-CONTROL.
  5027             20  CF-SYSTEM-C                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  91
* EL131.cbl
  5028                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5029             20  CF-SYSTEM-D                 PIC X.
  5030                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5031             20  CF-SOC-SEC-NO-SW            PIC X.
  5032                 88  SOC-SEC-NO-USED             VALUE '1'.
  5033             20  CF-MEMBER-NO-SW             PIC X.
  5034                 88  MEMBER-NO-USED              VALUE '1'.
  5035             20  CF-TAX-ID-NUMBER            PIC X(11).
  5036             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5037             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5038                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5039                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5040                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5041                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5042             20  CF-SYSTEM-E                 PIC X.
  5043                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5044
  5045         16  CF-LGX-LIFE-USER               PIC X.
  5046             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5047             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5048
  5049         16  CF-CR-MONTH-END-DT             PIC XX.
  5050
  5051         16  CF-FILE-MAINT-DATES.
  5052             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5053                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5054             20  CF-LAST-BATCH       REDEFINES
  5055                 CF-LAST-BATCH-NO               PIC X(4).
  5056             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5057             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5058             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5059             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5060             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5061             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5062             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5063             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5064             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5065             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5066
  5067         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5068         16  FILLER                         PIC X.
  5069
  5070         16  CF-ALT-MORT-CODE               PIC X(4).
  5071         16  CF-MEMBER-CAPTION              PIC X(10).
  5072
  5073         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5074             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5075             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5076             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5077             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5078             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5079
  5080         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5081
  5082         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5083         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5084         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5085         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  92
* EL131.cbl
  5086
  5087         16  CF-AH-OVERRIDE-L1              PIC X.
  5088         16  CF-AH-OVERRIDE-L2              PIC XX.
  5089         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5090         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5091
  5092         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5093         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5094
  5095         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5096         16  CF-AR-LAST-EL860-DT            PIC XX.
  5097         16  CF-MP-MONTH-END-DT             PIC XX.
  5098
  5099         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5100         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5101             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5102
  5103         16  CF-AR-MONTH-END-DT             PIC XX.
  5104
  5105         16  CF-CRDTCRD-USER                PIC X.
  5106             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5107             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5108
  5109         16  CF-CC-MONTH-END-DT             PIC XX.
  5110
  5111         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5112
  5113         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5114             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5115             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5116             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5117         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5118         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5119         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5120         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5121             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5122             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5123         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5124         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5125         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5126             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5127         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5128
  5129         16  CF-CL-ZIP-CODE.
  5130             20  CF-CL-ZIP-PRIME.
  5131                 24  CF-CL-ZIP-1ST          PIC X.
  5132                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5133                 24  FILLER                 PIC X(4).
  5134             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5135         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5136             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5137             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5138             20  FILLER                     PIC XXX.
  5139
  5140         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5141         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5142         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5143         16  CF-CO-OPTION-START-DATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  93
* EL131.cbl
  5144         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5145           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5146                                                      '3' '4'.
  5147           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5148           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5149           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5150           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5151           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5152           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5153
  5154         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5155
  5156         16  CF-PAYMENT-APPROVAL-LEVELS.
  5157             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5158             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5159             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5160             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5161             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5162             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5163
  5164         16  CF-END-USER-REPORTING-USER     PIC X.
  5165             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5166             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5167
  5168         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5169             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5170             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5171
  5172         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5173
  5174         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5175         16  FILLER                         PIC X.
  5176
  5177         16  CF-CREDIT-ARCHIVE-CNTL.
  5178             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5179             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5180             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5181
  5182         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5183
  5184         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5185             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5186             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5187
  5188         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5189             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5190             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5191
  5192         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5193
  5194         16  CF-CO-ACH-ID-CODE              PIC  X.
  5195             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5196             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5197             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5198         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5199         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5200         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5201         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  94
* EL131.cbl
  5202         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5203         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5204         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5205         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5206         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5207                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5208         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5209                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5210
  5211         16  CF-CO-OVER-SHORT.
  5212             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5213             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5214
  5215*         16  FILLER                         PIC X(102).
  5216         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5217             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5218             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5219
  5220         16  CF-AH-APPROVAL-DAYS.
  5221             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5222             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5223             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5224             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5225
  5226         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5227
  5228         16  CF-APPROV-LEV-5.
  5229             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5230             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5231             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5232
  5233         16  FILLER                         PIC X(68).
  5234****************************************************************
  5235*             PROCESSOR/USER RECORD                            *
  5236****************************************************************
  5237
  5238     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5239         16  CF-PROCESSOR-NAME              PIC X(30).
  5240         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5241         16  CF-PROCESSOR-TITLE             PIC X(26).
  5242         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5243                 88  MESSAGE-YES                VALUE 'Y'.
  5244                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5245
  5246*****************************************************
  5247****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5248****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5249****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5250****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5251*****************************************************
  5252
  5253         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5254             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5255             20  CF-APPLICATION-FORCE       PIC X.
  5256             20  CF-INDIVIDUAL-APP.
  5257                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5258                     28  CF-BROWSE-APP      PIC X.
  5259                     28  CF-UPDATE-APP      PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  95
* EL131.cbl
  5260
  5261         16  CF-CURRENT-TERM-ON             PIC X(4).
  5262         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5263             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5264             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5265             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5266             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5267             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5268             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5269             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5270         16  CF-PROCESSOR-CARRIER           PIC X.
  5271             88  NO-CARRIER-SECURITY            VALUE ' '.
  5272         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5273             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5274         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5275             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5276         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5277             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5278
  5279         16  CF-PROC-SYS-ACCESS-SW.
  5280             20  CF-PROC-CREDIT-CLAIMS-SW.
  5281                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5282                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5283                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5284                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5285             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5286                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5287                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5288             20  CF-PROC-LIFE-GNRLDGR-SW.
  5289                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5290                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5291                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5292                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5293             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5294                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5295                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5296         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5297             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5298             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5299         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5300
  5301         16  CF-APPROVAL-LEVEL                  PIC X.
  5302             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5303             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5304             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5305             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5306             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5307
  5308         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5309
  5310         16  CF-LANGUAGE-TYPE                   PIC X.
  5311             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5312             88  CF-LANG-IS-FR                      VALUE 'F'.
  5313
  5314         16  CF-CSR-IND                         PIC X.
  5315         16  FILLER                             PIC X(239).
  5316
  5317****************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  96
* EL131.cbl
  5318*             PROCESSOR/REMINDERS RECORD                       *
  5319****************************************************************
  5320
  5321     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5322         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5323             20  CF-START-REMIND-DT         PIC XX.
  5324             20  CF-END-REMIND-DT           PIC XX.
  5325             20  CF-REMINDER-TEXT           PIC X(50).
  5326         16  FILLER                         PIC X(296).
  5327
  5328
  5329****************************************************************
  5330*             STATE MASTER RECORD                              *
  5331****************************************************************
  5332
  5333     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5334         16  CF-STATE-ABBREVIATION          PIC XX.
  5335         16  CF-STATE-NAME                  PIC X(25).
  5336         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5337         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5338             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5339             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5340             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5341             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5342                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5343                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5344             20  CF-ST-PREM-REJECT-SW       PIC X.
  5345                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5346                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5347             20  CF-ST-REF-REJECT-SW        PIC X.
  5348                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5349                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5350         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5351         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5352         16  CF-ST-REFUND-RULES.
  5353             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5354             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5355             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5356         16  CF-ST-FST-PMT-EXTENSION.
  5357             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5358             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5359                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5360                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5361                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5362                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5363         16  CF-ST-STATE-CALL.
  5364             20  CF-ST-CALL-UNEARNED        PIC X.
  5365             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5366             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5367         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5368             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5369             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5370         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5371         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5372         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5373         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5374         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5375         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  97
* EL131.cbl
  5376         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5377             20  CF-ST-BENEFIT-CD           PIC XX.
  5378             20  CF-ST-BENEFIT-KIND         PIC X.
  5379                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5380                 88  CF-ST-AH-KIND              VALUE 'A'.
  5381             20  CF-ST-REM-TERM-CALC        PIC X.
  5382                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5383                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5384                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5385                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5386                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5387                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5388                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5389                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5390
  5391             20  CF-ST-REFUND-CALC          PIC X.
  5392                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5393                 88  ST-REFD-BY-R78             VALUE '1'.
  5394                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5395                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5396                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5397                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5398                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5399                 88  ST-REFD-UTAH               VALUE '7'.
  5400                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5401                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5402                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5403
  5404             20  CF-ST-EARNING-CALC         PIC X.
  5405                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5406                 88  ST-EARN-BY-R78             VALUE '1'.
  5407                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5408                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5409                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5410                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5411                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5412                 88  ST-EARN-MEAN               VALUE '8'.
  5413                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5414
  5415             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5416                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5417                 88  ST-OVRD-BY-R78             VALUE '1'.
  5418                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5419                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5420                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5421                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5422                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5423                 88  ST-OVRD-MEAN               VALUE '8'.
  5424                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5425             20  cf-st-extra-periods        pic 9.
  5426*            20  FILLER                     PIC X.
  5427
  5428         16  CF-ST-COMMISSION-CAPS.
  5429             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5430             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5431             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5432             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5433         16  CF-COMM-CAP-LIMIT-TO           PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  98
* EL131.cbl
  5434                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5435                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5436                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5437
  5438         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5439
  5440         16  CF-ST-STATUTORY-INTEREST.
  5441             20  CF-ST-STAT-DATE-FROM       PIC X.
  5442                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5443                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5444             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5445             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5446             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5447             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5448             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5449
  5450         16  CF-ST-OVER-SHORT.
  5451             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5452             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5453
  5454         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5455
  5456         16  CF-ST-RT-CALC                  PIC X.
  5457
  5458         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5459         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5460         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5461         16  CF-ST-RF-LR-CALC               PIC X.
  5462         16  CF-ST-RF-LL-CALC               PIC X.
  5463         16  CF-ST-RF-LN-CALC               PIC X.
  5464         16  CF-ST-RF-AH-CALC               PIC X.
  5465         16  CF-ST-RF-CP-CALC               PIC X.
  5466*        16  FILLER                         PIC X(206).
  5467*CIDMOD         16  FILLER                         PIC X(192).
  5468         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5469             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5470         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5471         16  CF-ST-VFY-2ND-BENE             PIC X.
  5472         16  CF-ST-CAUSAL-STATE             PIC X.
  5473         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5474         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5475         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5476             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5477         16  CF-ST-NET-ONLY-STATE           PIC X.
  5478             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5479         16  cf-commission-cap-required     pic x.
  5480         16  CF-ST-GA-COMMISSION-CAPS.
  5481             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5482             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5483             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5484             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5485         16  CF-ST-TOT-COMMISSION-CAPS.
  5486             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5487             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5488             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5489             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5490         16  FILLER                         PIC X(156).
  5491
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page  99
* EL131.cbl
  5492****************************************************************
  5493*             BENEFIT MASTER RECORD                            *
  5494****************************************************************
  5495
  5496     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5497         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5498             20  CF-BENEFIT-CODE            PIC XX.
  5499             20  CF-BENEFIT-NUMERIC  REDEFINES
  5500                 CF-BENEFIT-CODE            PIC XX.
  5501             20  CF-BENEFIT-ALPHA           PIC XXX.
  5502             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5503             20  CF-BENEFIT-COMMENT         PIC X(10).
  5504
  5505             20  CF-LF-COVERAGE-TYPE        PIC X.
  5506                 88  CF-REDUCING                VALUE 'R'.
  5507                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5508
  5509             20  CF-SPECIAL-CALC-CD         PIC X.
  5510                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5511                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5512                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5513                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5514                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5515                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5516                 88  CF-FARM-PLAN               VALUE 'F'.
  5517                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5518                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5519                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5520                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5521                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5522                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5523                 88  CF-PRUDENTIAL              VALUE 'P'.
  5524                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5525                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5526                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5527                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5528                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5529                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5530
  5531             20  CF-JOINT-INDICATOR         PIC X.
  5532                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5533
  5534*            20  FILLER                     PIC X(12).
  5535             20  cf-maximum-benefits        pic s999 comp-3.
  5536             20  FILLER                     PIC X(09).
  5537             20  CF-BENEFIT-CATEGORY        PIC X.
  5538             20  CF-LOAN-TYPE               PIC X(8).
  5539
  5540             20  CF-CO-REM-TERM-CALC        PIC X.
  5541                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5542                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5543                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5544                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5545                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5546
  5547             20  CF-CO-EARNINGS-CALC        PIC X.
  5548                 88  CO-EARN-BY-R78             VALUE '1'.
  5549                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 100
* EL131.cbl
  5550                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5551                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5552                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5553                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5554                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5555                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5556
  5557             20  CF-CO-REFUND-CALC          PIC X.
  5558                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5559                 88  CO-REFD-BY-R78             VALUE '1'.
  5560                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5561                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5562                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5563                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5564                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5565                 88  CO-REFD-MEAN               VALUE '8'.
  5566                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5567                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5568                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5569
  5570             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5571                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5572                 88  CO-OVRD-BY-R78             VALUE '1'.
  5573                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5574                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5575                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5576                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5577                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5578                 88  CO-OVRD-MEAN               VALUE '8'.
  5579                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5580
  5581             20  CF-CO-BEN-I-G-CD           PIC X.
  5582                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5583                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5584                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5585
  5586         16  FILLER                         PIC X(304).
  5587
  5588
  5589****************************************************************
  5590*             CARRIER MASTER RECORD                            *
  5591****************************************************************
  5592
  5593     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5594         16  CF-ADDRESS-DATA.
  5595             20  CF-MAIL-TO-NAME            PIC X(30).
  5596             20  CF-IN-CARE-OF              PIC X(30).
  5597             20  CF-ADDRESS-LINE-1          PIC X(30).
  5598             20  CF-ADDRESS-LINE-2          PIC X(30).
  5599             20  CF-CITY-STATE              PIC X(30).
  5600             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5601             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5602
  5603         16  CF-CLAIM-NO-CONTROL.
  5604             20  CF-CLAIM-NO-METHOD         PIC X.
  5605                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5606                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5607                 88  CLAIM-NO-SEQ               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 101
* EL131.cbl
  5608                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5609             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5610                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5611                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5612                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5613
  5614         16  CF-CHECK-NO-CONTROL.
  5615             20  CF-CHECK-NO-METHOD         PIC X.
  5616                 88  CHECK-NO-MANUAL            VALUE '1'.
  5617                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5618                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5619                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5620             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5621                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5622
  5623         16  CF-DOMICILE-STATE              PIC XX.
  5624
  5625         16  CF-EXPENSE-CONTROLS.
  5626             20  CF-EXPENSE-METHOD          PIC X.
  5627                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5628                 88  DOLLARS-PER-PMT            VALUE '2'.
  5629                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5630                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5631             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5632             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5633
  5634         16  CF-CORRESPONDENCE-CONTROL.
  5635             20  CF-LETTER-RESEND-OPT       PIC X.
  5636                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5637                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5638             20  FILLER                     PIC X(4).
  5639
  5640         16  CF-RESERVE-CONTROLS.
  5641             20  CF-MANUAL-SW               PIC X.
  5642                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5643             20  CF-FUTURE-SW               PIC X.
  5644                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5645             20  CF-PTC-SW                  PIC X.
  5646                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5647             20  CF-IBNR-SW                 PIC X.
  5648                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5649             20  CF-PTC-LF-SW               PIC X.
  5650                 88  CF-LF-PTC-USED             VALUE '1'.
  5651             20  CF-CDT-ACCESS-METHOD       PIC X.
  5652                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5653                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5654                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5655             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5656
  5657         16  CF-CLAIM-CALC-METHOD           PIC X.
  5658             88  360-PLUS-MONTHS                VALUE '1'.
  5659             88  365-PLUS-MONTHS                VALUE '2'.
  5660             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5661             88  360-DAILY                      VALUE '4'.
  5662             88  365-DAILY                      VALUE '5'.
  5663
  5664         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5665         16  FILLER                         PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 102
* EL131.cbl
  5666
  5667         16  CF-LIMIT-AMOUNTS.
  5668             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5669             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5670             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5671             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5672             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5673             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5674             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5675             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5676             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5677             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5678
  5679         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5680         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5681         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5682
  5683         16  CF-ZIP-CODE.
  5684             20  CF-ZIP-PRIME.
  5685                 24  CF-ZIP-1ST             PIC X.
  5686                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5687                 24  FILLER                 PIC X(4).
  5688             20  CF-ZIP-PLUS4               PIC X(4).
  5689         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5690             20  CF-CAN-POSTAL-1            PIC XXX.
  5691             20  CF-CAN-POSTAL-2            PIC XXX.
  5692             20  FILLER                     PIC XXX.
  5693
  5694         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5695         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5696         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5697
  5698         16  CF-RATING-SWITCH               PIC X.
  5699             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5700             88  CF-NO-RATING                   VALUE 'N'.
  5701
  5702         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5703
  5704         16  CF-CARRIER-OVER-SHORT.
  5705             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5706             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5707
  5708         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5709         16  CF-SECPAY-SWITCH               PIC X.
  5710             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5711             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5712         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5713         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5714         16  FILLER                         PIC X(444).
  5715*        16  FILLER                         PIC X(452).
  5716
  5717
  5718****************************************************************
  5719*             MORTALITY MASTER RECORD                          *
  5720****************************************************************
  5721
  5722     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5723         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 103
* EL131.cbl
  5724                                INDEXED BY CF-MORT-NDX.
  5725             20  CF-MORT-TABLE              PIC X(5).
  5726             20  CF-MORT-TABLE-TYPE         PIC X.
  5727                 88  CF-MORT-JOINT              VALUE 'J'.
  5728                 88  CF-MORT-SINGLE             VALUE 'S'.
  5729                 88  CF-MORT-COMBINED           VALUE 'C'.
  5730                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5731                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5732             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5733             20  CF-MORT-AGE-METHOD         PIC XX.
  5734                 88  CF-AGE-LAST                VALUE 'AL'.
  5735                 88  CF-AGE-NEAR                VALUE 'AN'.
  5736             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5737             20  CF-MORT-ADJUSTMENT-DIRECTION
  5738                                            PIC X.
  5739                 88  CF-MINUS                   VALUE '-'.
  5740                 88  CF-PLUS                    VALUE '+'.
  5741             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5742             20  CF-MORT-JOINT-CODE         PIC X.
  5743                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5744             20  CF-MORT-PC-Q               PIC X.
  5745                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5746             20  CF-MORT-TABLE-CODE         PIC X(4).
  5747             20  CF-MORT-COMMENTS           PIC X(15).
  5748             20  FILLER                     PIC X(14).
  5749
  5750         16  FILLER                         PIC X(251).
  5751
  5752
  5753****************************************************************
  5754*             BUSSINESS TYPE MASTER RECORD                     *
  5755****************************************************************
  5756
  5757     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5758* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5759* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5760* AND RECORD 05 IS TYPES 81-99
  5761         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5762             20  CF-BUSINESS-TITLE          PIC  X(19).
  5763             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5764                                            PIC S9V9(4) COMP-3.
  5765             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5766             20  FILLER                     PIC  X.
  5767         16  FILLER                         PIC  X(248).
  5768
  5769
  5770****************************************************************
  5771*             TERMINAL MASTER RECORD                           *
  5772****************************************************************
  5773
  5774     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5775
  5776         16  CF-COMPANY-TERMINALS.
  5777             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5778                                  PIC X(4).
  5779         16  FILLER               PIC X(248).
  5780
  5781
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 104
* EL131.cbl
  5782****************************************************************
  5783*             LIFE EDIT MASTER RECORD                          *
  5784****************************************************************
  5785
  5786     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5787         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5788             20  CF-LIFE-CODE-IN            PIC XX.
  5789             20  CF-LIFE-CODE-OUT           PIC XX.
  5790         16  FILLER                         PIC X(248).
  5791
  5792
  5793****************************************************************
  5794*             AH EDIT MASTER RECORD                            *
  5795****************************************************************
  5796
  5797     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5798         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5799             20  CF-AH-CODE-IN              PIC XXX.
  5800             20  CF-AH-CODE-OUT             PIC XX.
  5801         16  FILLER                         PIC X(248).
  5802
  5803
  5804****************************************************************
  5805*             CREDIBILITY TABLES                               *
  5806****************************************************************
  5807
  5808     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5809         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5810                             INDEXED BY CF-CRDB-NDX.
  5811             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5812             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5813             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5814         16  FILLER                         PIC  X(332).
  5815
  5816
  5817****************************************************************
  5818*             REPORT CUSTOMIZATION RECORD                      *
  5819****************************************************************
  5820
  5821     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5822         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5823             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5824             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5825             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5826**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5827****       A T-TRANSFER.                                   ****
  5828             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5829
  5830         16  FILLER                         PIC XX.
  5831
  5832         16  CF-CARRIER-CNTL-OPT.
  5833             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5834                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5835                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5836             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5837                                            PIC X.
  5838         16  CF-GROUP-CNTL-OPT.
  5839             20  CF-GROUP-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 105
* EL131.cbl
  5840                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5841                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5842             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5843                                            PIC X(6).
  5844         16  CF-STATE-CNTL-OPT.
  5845             20  CF-STATE-OPT-SEQ           PIC 9.
  5846                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5847                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5848             20  CF-STATE-SELECT OCCURS 3 TIMES
  5849                                            PIC XX.
  5850         16  CF-ACCOUNT-CNTL-OPT.
  5851             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5852                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5853                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5854             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5855                                            PIC X(10).
  5856         16  CF-BUS-TYP-CNTL-OPT.
  5857             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5858                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5859                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5860             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5861                                            PIC XX.
  5862         16  CF-LF-TYP-CNTL-OPT.
  5863             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5864                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5865                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5866             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5867                                            PIC XX.
  5868         16  CF-AH-TYP-CNTL-OPT.
  5869             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5870                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5871                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5872             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5873                                            PIC XX.
  5874         16  CF-REPTCD1-CNTL-OPT.
  5875             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5876                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5877                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5878             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5879                                            PIC X(10).
  5880         16  CF-REPTCD2-CNTL-OPT.
  5881             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5882                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5883                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5884             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5885                                            PIC X(10).
  5886         16  CF-USER1-CNTL-OPT.
  5887             20  CF-USER1-OPT-SEQ           PIC 9.
  5888                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5889                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5890             20  CF-USER1-SELECT OCCURS 3 TIMES
  5891                                            PIC X(10).
  5892         16  CF-USER2-CNTL-OPT.
  5893             20  CF-USER2-OPT-SEQ           PIC 9.
  5894                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5895                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5896             20  CF-USER2-SELECT OCCURS 3 TIMES
  5897                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 106
* EL131.cbl
  5898         16  CF-USER3-CNTL-OPT.
  5899             20  CF-USER3-OPT-SEQ           PIC 9.
  5900                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5901                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5902             20  CF-USER3-SELECT OCCURS 3 TIMES
  5903                                            PIC X(10).
  5904         16  CF-USER4-CNTL-OPT.
  5905             20  CF-USER4-OPT-SEQ           PIC 9.
  5906                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5907                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5908             20  CF-USER4-SELECT OCCURS 3 TIMES
  5909                                            PIC X(10).
  5910         16  CF-USER5-CNTL-OPT.
  5911             20  CF-USER5-OPT-SEQ           PIC 9.
  5912                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5913                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5914             20  CF-USER5-SELECT OCCURS 3 TIMES
  5915                                            PIC X(10).
  5916         16  CF-REINS-CNTL-OPT.
  5917             20  CF-REINS-OPT-SEQ           PIC 9.
  5918                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5919                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5920             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5921                 24  CF-REINS-PRIME         PIC XXX.
  5922                 24  CF-REINS-SUB           PIC XXX.
  5923
  5924         16  CF-AGENT-CNTL-OPT.
  5925             20  CF-AGENT-OPT-SEQ           PIC 9.
  5926                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5927                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5928             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5929                                            PIC X(10).
  5930
  5931         16  FILLER                         PIC X(43).
  5932
  5933         16  CF-LOSS-RATIO-SELECT.
  5934             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5935             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5936         16  CF-ENTRY-DATE-SELECT.
  5937             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5938             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5939         16  CF-EFFECTIVE-DATE-SELECT.
  5940             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5941             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5942
  5943         16  CF-EXCEPTION-LIST-IND          PIC X.
  5944             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5945
  5946         16  FILLER                         PIC X(318).
  5947
  5948****************************************************************
  5949*                  EXCEPTION REPORTING RECORD                  *
  5950****************************************************************
  5951
  5952     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5953         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5954             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5955
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 107
* EL131.cbl
  5956         16  CF-COMBINED-LIFE-AH-OPT.
  5957             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5958             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5959             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5960             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5961
  5962         16  CF-LIFE-OPT.
  5963             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5964             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5965             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5966             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5967             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5968             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5969             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5970             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5971             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5972             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5973
  5974         16  CF-AH-OPT.
  5975             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5976             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5977             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5978             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5979             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5980             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5981             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5982             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5983             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5984             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5985
  5986         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5987             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5988             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5989             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5990
  5991         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5992
  5993         16  FILLER                         PIC X(673).
  5994
  5995
  5996****************************************************************
  5997*             MORTGAGE SYSTEM PLAN RECORD                      *
  5998****************************************************************
  5999
  6000     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6001         16  CF-PLAN-TYPE                   PIC X.
  6002             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6003             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6004             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6005         16  CF-PLAN-ABBREV                 PIC XXX.
  6006         16  CF-PLAN-DESCRIPT               PIC X(10).
  6007         16  CF-PLAN-NOTES                  PIC X(20).
  6008         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6009         16  CF-PLAN-UNDERWRITING.
  6010             20  CF-PLAN-TERM-DATA.
  6011                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6012                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6013             20  CF-PLAN-AGE-DATA.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 108
* EL131.cbl
  6014                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6015                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6016                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6017             20  CF-PLAN-BENEFIT-DATA.
  6018                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6019                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6020                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6021                                            PIC S9(7)V99  COMP-3.
  6022         16  CF-PLAN-POLICY-FORMS.
  6023             20  CF-POLICY-FORM             PIC X(12).
  6024             20  CF-MASTER-APPLICATION      PIC X(12).
  6025             20  CF-MASTER-POLICY           PIC X(12).
  6026         16  CF-PLAN-RATING.
  6027             20  CF-RATE-CODE               PIC X(5).
  6028             20  CF-SEX-RATING              PIC X.
  6029                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6030                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6031             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6032             20  CF-SUB-STD-TYPE            PIC X.
  6033                 88  CF-PCT-OF-PREM            VALUE '1'.
  6034                 88  CF-PCT-OF-BENE            VALUE '2'.
  6035         16  CF-PLAN-PREM-TOLERANCES.
  6036             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6037             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6038         16  CF-PLAN-PYMT-TOLERANCES.
  6039             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6040             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6041         16  CF-PLAN-MISC-DATA.
  6042             20  FILLER                     PIC X.
  6043             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6044             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6045         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6046         16  CF-PLAN-IND-GRP                PIC X.
  6047             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6048                                                     '1'.
  6049             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6050                                                     '2'.
  6051         16  CF-MIB-SEARCH-SW               PIC X.
  6052             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6053             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6054             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6055             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6056         16  CF-ALPHA-SEARCH-SW             PIC X.
  6057             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6058             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6059             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6060             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6061             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6062             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6063             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6064             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6065             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6066             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6067                                                     'A' 'B' 'C'
  6068                                                     'X' 'Y' 'Z'.
  6069         16  CF-EFF-DT-RULE-SW              PIC X.
  6070             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6071             88  CF-EFF-DT-MONTH               VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 109
* EL131.cbl
  6072             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6073             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6074             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6075         16  FILLER                         PIC X(4).
  6076         16  CF-HEALTH-QUESTIONS            PIC X.
  6077             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6078         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6079         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6080         16  CF-PLAN-SNGL-JNT               PIC X.
  6081             88  CF-COMBINED-PLAN              VALUE 'C'.
  6082             88  CF-JNT-PLAN                   VALUE 'J'.
  6083             88  CF-SNGL-PLAN                  VALUE 'S'.
  6084         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6085         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6086         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6087         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6088         16  CF-RERATE-CNTL                 PIC  X.
  6089             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6090             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6091             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6092             88  CF-AUTO-RECALC                 VALUE '4'.
  6093         16  CF-BENEFIT-TYPE                PIC  X.
  6094             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6095             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6096         16  CF-POLICY-FEE                  PIC S999V99
  6097                                                    COMP-3.
  6098         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6099         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6100         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6101         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6102         16  FILLER                         PIC  X(32).
  6103         16  CF-TERMINATION-FORM            PIC  X(04).
  6104         16  FILLER                         PIC  X(08).
  6105         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6106                                                       COMP-3.
  6107         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6108         16  CF-ISSUE-LETTER                PIC  X(4).
  6109         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6110         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6111             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6112             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6113         16  CF-MP-REFUND-CALC              PIC X.
  6114             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6115             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6116             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6117             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6118             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6119             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6120             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6121             88  CF-MP-REFD-MEAN                VALUE '8'.
  6122         16  CF-ALT-RATE-CODE               PIC  X(5).
  6123
  6124
  6125         16  FILLER                         PIC X(498).
  6126****************************************************************
  6127*             MORTGAGE COMPANY MASTER RECORD                   *
  6128****************************************************************
  6129
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 110
* EL131.cbl
  6130     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6131         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6132         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6133             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6134             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6135             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6136             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6137             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6138
  6139         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6140         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6141         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6142         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6143         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6144
  6145         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6146             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6147         16  CF-MP-RECON-USE-IND            PIC X(1).
  6148             88  CF-MP-USE-RECON             VALUE 'Y'.
  6149         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6150             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6151         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6152             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6153             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6154         16  FILLER                         PIC X(1).
  6155         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6156             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6157         16  CF-MORTG-MIB-VERSION           PIC X.
  6158             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6159             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6160             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6161         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6162             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6163                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6164             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6165                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6166             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6167                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6168             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6169                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6170             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6171                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6172             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6173                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6174         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6175         16  FILLER                         PIC X(7).
  6176         16  CF-MORTG-DESTINATION-SYMBOL.
  6177             20  CF-MORTG-MIB-COMM          PIC X(5).
  6178             20  CF-MORTG-MIB-TERM          PIC X(5).
  6179         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6180             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6181         16  FILLER                         PIC X(03).
  6182         16  CF-MP-CHECK-NO-CONTROL.
  6183             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6184                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6185                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6186                                                ' ' LOW-VALUES.
  6187                 88  CF-MP-CHECK-NO-PRE-PRINTED
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 111
* EL131.cbl
  6188                                               VALUE '3'.
  6189         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6190         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6191         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6192             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6193                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6194             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6195                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6196             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6197                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6198             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6199                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6200             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6201                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6202             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6203                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6204         16  CF-MORTG-BILLING-AREA.
  6205             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6206                                            PIC X.
  6207         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6208         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6209         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6210         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6211             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6212             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6213         16  FILLER                         PIC X.
  6214         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6215             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6216             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6217         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6218         16  FILLER                         PIC X(8).
  6219         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6220         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6221         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6222         16  CF-ACH-COMPANY-ID.
  6223             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6224                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6225                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6226                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6227             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6228         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6229             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6230         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6231             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6232             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6233         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6234         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6235         16  FILLER                         PIC X(536).
  6236
  6237****************************************************************
  6238*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6239****************************************************************
  6240
  6241     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6242         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6243             20  CF-FEMALE-HEIGHT.
  6244                 24  CF-FEMALE-FT           PIC 99.
  6245                 24  CF-FEMALE-IN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 112
* EL131.cbl
  6246             20  CF-FEMALE-MIN-WT           PIC 999.
  6247             20  CF-FEMALE-MAX-WT           PIC 999.
  6248         16  FILLER                         PIC X(428).
  6249
  6250     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6251         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6252             20  CF-MALE-HEIGHT.
  6253                 24  CF-MALE-FT             PIC 99.
  6254                 24  CF-MALE-IN             PIC 99.
  6255             20  CF-MALE-MIN-WT             PIC 999.
  6256             20  CF-MALE-MAX-WT             PIC 999.
  6257         16  FILLER                         PIC X(428).
  6258******************************************************************
  6259*             AUTOMATIC ACTIVITY RECORD                          *
  6260******************************************************************
  6261     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6262         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6263             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6264             20  CF-SYS-LETTER-ID           PIC X(04).
  6265             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6266             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6267             20  CF-SYS-RESET-SW            PIC X(01).
  6268             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6269             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6270
  6271         16  FILLER                         PIC X(50).
  6272
  6273         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6274             20  CF-USER-ACTIVE-SW          PIC X(01).
  6275             20  CF-USER-LETTER-ID          PIC X(04).
  6276             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6277             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6278             20  CF-USER-RESET-SW           PIC X(01).
  6279             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6280             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6281             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6282
  6283         16  FILLER                         PIC X(246).
  6284
  6285*                                COPY ELCACTQ.
  6286******************************************************************
  6287*                                                                *
  6288*                            ELCACTQ.                            *
  6289*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6290*                            VMOD=2.004                          *
  6291*                                                                *
  6292*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6293*                                                                *
  6294*   FILE TYPE = VSAM,KSDS                                        *
  6295*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6296*                                                                *
  6297*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6298*       ALTERNATE INDEX = NONE                                   *
  6299*                                                                *
  6300*   LOG = YES                                                    *
  6301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6302*                                                                *
  6303*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 113
* EL131.cbl
  6304******************************************************************
  6305
  6306 01  ACTIVITY-QUE.
  6307     12  AQ-RECORD-ID                PIC XX.
  6308         88  VALID-AQ-ID                VALUE 'AQ'.
  6309
  6310     12  AQ-CONTROL-PRIMARY.
  6311         16  AQ-COMPANY-CD           PIC X.
  6312         16  AQ-CARRIER              PIC X.
  6313         16  AQ-CLAIM-NO             PIC X(7).
  6314         16  AQ-CERT-NO.
  6315             20  AQ-CERT-PRIME       PIC X(10).
  6316             20  AQ-CERT-SFX         PIC X.
  6317
  6318     12  AQ-PENDING-ACTIVITY-FLAGS.
  6319         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6320         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6321             88  PENDING-PAYMENTS       VALUE '1'.
  6322         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6323             88  PENDING-FULL-PRINT     VALUE '1'.
  6324             88  PENDING-PART-PRINT     VALUE '2'.
  6325         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6326             88  PENDING-LETTERS        VALUE '1'.
  6327         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6328             88  PENDING-RESTORE        VALUE 'C'.
  6329             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6330
  6331     12  FILLER                      PIC X(20).
  6332
  6333     12  AQ-RESEND-DATE              PIC XX.
  6334     12  AQ-FOLLOWUP-DATE            PIC XX.
  6335     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6336     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6337     12  AQ-AUTO-LETTER              PIC X(4).
  6338     12  FILLER                      PIC XX.
  6339     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6340*****************************************************************
  6341
  6342*                                COPY ERCACCT.
  6343******************************************************************
  6344*                                                                *
  6345*                                                                *
  6346*                            ERCACCT                             *
  6347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6348*                            VMOD=2.031                          *
  6349*                                                                *
  6350*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6351*                                                                *
  6352*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6353*   VSAM ACCOUNT MASTER FILES.                                   *
  6354*                                                                *
  6355*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6356*                                                                *
  6357*   FILE TYPE = VSAM,KSDS                                        *
  6358*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6359*                                                                *
  6360*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6361*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 114
* EL131.cbl
  6362*                                                                *
  6363*   LOG = NO                                                     *
  6364*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6365*                                                                *
  6366*                                                                *
  6367******************************************************************
  6368*                   C H A N G E   L O G
  6369*
  6370* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6371*-----------------------------------------------------------------
  6372*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6373* EFFECTIVE    NUMBER
  6374*-----------------------------------------------------------------
  6375* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6376* 092705    2005050300006  PEMA  ADD SPP LEASES
  6377* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6378* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6379* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6380* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6381* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6382* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6383******************************************************************
  6384
  6385 01  ACCOUNT-MASTER.
  6386     12  AM-RECORD-ID                      PIC XX.
  6387         88  VALID-AM-ID                      VALUE 'AM'.
  6388
  6389     12  AM-CONTROL-PRIMARY.
  6390         16  AM-COMPANY-CD                 PIC X.
  6391         16  AM-MSTR-CNTRL.
  6392             20  AM-CONTROL-A.
  6393                 24  AM-CARRIER            PIC X.
  6394                 24  AM-GROUPING.
  6395                     28 AM-GROUPING-PREFIX PIC XXX.
  6396                     28 AM-GROUPING-PRIME  PIC XXX.
  6397                 24  AM-STATE              PIC XX.
  6398                 24  AM-ACCOUNT.
  6399                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6400                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6401             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6402                                           PIC X(19).
  6403             20  AM-CNTRL-B.
  6404                 24  AM-EXPIRATION-DT      PIC XX.
  6405                 24  FILLER                PIC X(4).
  6406             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6407                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6408
  6409     12  AM-CONTROL-BY-VAR-GRP.
  6410         16  AM-COMPANY-CD-A1              PIC X.
  6411         16  AM-VG-CARRIER                 PIC X.
  6412         16  AM-VG-GROUPING                PIC X(6).
  6413         16  AM-VG-STATE                   PIC XX.
  6414         16  AM-VG-ACCOUNT                 PIC X(10).
  6415         16  AM-VG-DATE.
  6416             20  AM-VG-EXPIRATION-DT       PIC XX.
  6417             20  FILLER                    PIC X(4).
  6418         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6419                                           PIC 9(11)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 115
* EL131.cbl
  6420     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6421         16  FILLER                        PIC X(10).
  6422         16  AM-VG-KEY3.
  6423             20  AM-VG3-ACCOUNT            PIC X(10).
  6424             20  AM-VG3-EXP-DT             PIC XX.
  6425         16  FILLER                        PIC X(4).
  6426     12  AM-MAINT-INFORMATION.
  6427         16  AM-LAST-MAINT-DT              PIC XX.
  6428         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6429         16  AM-LAST-MAINT-USER            PIC X(4).
  6430         16  FILLER                        PIC XX.
  6431
  6432     12  AM-EFFECTIVE-DT                   PIC XX.
  6433     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6434
  6435     12  AM-PREV-DATES  COMP-3.
  6436         16  AM-PREV-EXP-DT                PIC 9(11).
  6437         16  AM-PREV-EFF-DT                PIC 9(11).
  6438
  6439     12  AM-REPORT-CODE-1                  PIC X(10).
  6440     12  AM-REPORT-CODE-2                  PIC X(10).
  6441
  6442     12  AM-CITY-CODE                      PIC X(4).
  6443     12  AM-COUNTY-PARISH                  PIC X(6).
  6444
  6445     12  AM-NAME                           PIC X(30).
  6446     12  AM-PERSON                         PIC X(30).
  6447     12  AM-ADDRS                          PIC X(30).
  6448     12  AM-CITY.
  6449         16  AM-ADDR-CITY                  PIC X(28).
  6450         16  AM-ADDR-STATE                 PIC XX.
  6451     12  AM-ZIP.
  6452         16  AM-ZIP-PRIME.
  6453             20  AM-ZIP-PRI-1ST            PIC X.
  6454                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6455             20  FILLER                    PIC X(4).
  6456         16  AM-ZIP-PLUS4                  PIC X(4).
  6457     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6458         16  AM-CAN-POSTAL-1               PIC XXX.
  6459         16  AM-CAN-POSTAL-2               PIC XXX.
  6460         16  FILLER                        PIC XXX.
  6461     12  AM-TEL-NO.
  6462         16  AM-AREA-CODE                  PIC 999.
  6463         16  AM-TEL-PRE                    PIC 999.
  6464         16  AM-TEL-NBR                    PIC 9(4).
  6465     12  AM-TEL-LOC                        PIC X.
  6466         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6467         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6468
  6469     12  AM-COMM-STRUCTURE.
  6470         16  AM-DEFN-1.
  6471             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6472                 24  AM-AGT.
  6473                     28  AM-AGT-PREFIX     PIC X(4).
  6474                     28  AM-AGT-PRIME      PIC X(6).
  6475                 24  AM-COM-TYP            PIC X.
  6476                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6477                 24  AM-J-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 116
* EL131.cbl
  6478                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6479                 24  AM-RECALC-LV-INDIC    PIC X.
  6480                 24  AM-RETRO-LV-INDIC     PIC X.
  6481                 24  AM-GL-CODES           PIC X.
  6482                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6483                 24  FILLER                PIC X(01).
  6484         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6485             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6486                 24  FILLER                PIC X(11).
  6487                 24  AM-L-COMA             PIC XXX.
  6488                 24  AM-J-COMA             PIC XXX.
  6489                 24  AM-A-COMA             PIC XXX.
  6490                 24  FILLER                PIC X(6).
  6491
  6492     12  AM-COMM-CHANGE-STATUS             PIC X.
  6493         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6494
  6495     12  AM-CSR-CODE                       PIC X(4).
  6496
  6497     12  AM-BILLING-STATUS                 PIC X.
  6498         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6499         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6500     12  AM-AUTO-REFUND-SW                 PIC X.
  6501         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6502         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6503     12  AM-GPCD                           PIC 99.
  6504     12  AM-IG                             PIC X.
  6505         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6506         88  AM-HAS-GROUP                     VALUE '2'.
  6507     12  AM-STATUS                         PIC X.
  6508         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6509         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6510         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6511         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6512         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6513         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6514         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6515         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6516         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6517         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6518     12  AM-REMIT-TO                       PIC 99.
  6519     12  AM-ID-NO                          PIC X(11).
  6520
  6521     12  AM-CAL-TABLE                      PIC XX.
  6522     12  AM-LF-DEVIATION                   PIC XXX.
  6523     12  AM-AH-DEVIATION                   PIC XXX.
  6524     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6525     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6526     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6527     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6528     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6529     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6530
  6531     12  AM-USER-FIELDS.
  6532         16  AM-FLD-1                      PIC XX.
  6533         16  AM-FLD-2                      PIC XX.
  6534         16  AM-FLD-3                      PIC XX.
  6535         16  AM-FLD-4                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 117
* EL131.cbl
  6536         16  AM-FLD-5                      PIC XX.
  6537
  6538     12  AM-1ST-PROD-DATE.
  6539         16  AM-1ST-PROD-YR                PIC XX.
  6540         16  AM-1ST-PROD-MO                PIC XX.
  6541         16  AM-1ST-PROD-DA                PIC XX.
  6542     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6543     12  AM-CERTS-PURGED-DATE.
  6544         16  AM-PUR-YR                     PIC XX.
  6545         16  AM-PUR-MO                     PIC XX.
  6546         16  AM-PUR-DA                     PIC XX.
  6547     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6548     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6549     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6550     12  AM-INACTIVE-DATE.
  6551         16  AM-INA-MO                     PIC 99.
  6552         16  AM-INA-DA                     PIC 99.
  6553         16  AM-INA-YR                     PIC 99.
  6554     12  AM-AR-HI-CERT-DATE                PIC XX.
  6555
  6556     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6557     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6558
  6559     12  AM-OB-PAYMENT-MODE                PIC X.
  6560         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6561         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6562         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6563         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6564
  6565     12  AM-AH-ONLY-INDICATOR              PIC X.
  6566         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6567         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6568
  6569     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6570
  6571     12  AM-OVER-SHORT.
  6572         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6573         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6574
  6575     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6576     12  AM-DCC-CLP-STATE                  PIC XX.
  6577
  6578     12  AM-RECALC-COMM                    PIC X.
  6579     12  AM-RECALC-REIN                    PIC X.
  6580
  6581     12  AM-REI-TABLE                      PIC XXX.
  6582     12  AM-REI-ET-LF                      PIC X.
  6583     12  AM-REI-ET-AH                      PIC X.
  6584     12  AM-REI-PE-LF                      PIC X.
  6585     12  AM-REI-PE-AH                      PIC X.
  6586     12  AM-REI-PRT-ST                     PIC X.
  6587     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6588     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6589     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6590     12  AM-REI-GROUP-A                    PIC X(6).
  6591     12  AM-REI-MORT                       PIC X(4).
  6592     12  AM-REI-PRT-OW                     PIC X.
  6593     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 118
* EL131.cbl
  6594     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6595     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6596     12  AM-REI-GROUP-B                    PIC X(6).
  6597
  6598     12  AM-TRUST-TYPE                     PIC X(2).
  6599
  6600     12  AM-EMPLOYER-STMT-USED             PIC X.
  6601     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6602
  6603     12  AM-STD-AH-TYPE                    PIC XX.
  6604     12  AM-EARN-METHODS.
  6605         16  AM-EARN-METHOD-R              PIC X.
  6606             88 AM-REF-RL-R78                 VALUE 'R'.
  6607             88 AM-REF-RL-PR                  VALUE 'P'.
  6608             88 AM-REF-RL-MEAN                VALUE 'M'.
  6609             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6610         16  AM-EARN-METHOD-L              PIC X.
  6611             88 AM-REF-LL-R78                 VALUE 'R'.
  6612             88 AM-REF-LL-PR                  VALUE 'P'.
  6613             88 AM-REF-LL-MEAN                VALUE 'M'.
  6614             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6615         16  AM-EARN-METHOD-A              PIC X.
  6616             88 AM-REF-AH-R78                 VALUE 'R'.
  6617             88 AM-REF-AH-PR                  VALUE 'P'.
  6618             88 AM-REF-AH-MEAN                VALUE 'M'.
  6619             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6620             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6621             88 AM-REF-AH-NET                 VALUE 'N'.
  6622
  6623     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6624     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6625     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6626
  6627     12  AM-RET-Y-N                        PIC X.
  6628     12  AM-RET-P-E                        PIC X.
  6629     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6630     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6631     12  AM-RET-GRP                        PIC X(6).
  6632     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6633         16  AM-POOL-PRIME                 PIC XXX.
  6634         16  AM-POOL-SUB                   PIC XXX.
  6635     12  AM-RETRO-EARNINGS.
  6636         16  AM-RET-EARN-R                 PIC X.
  6637         16  AM-RET-EARN-L                 PIC X.
  6638         16  AM-RET-EARN-A                 PIC X.
  6639     12  AM-RET-ST-TAX-USE                 PIC X.
  6640         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6641         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6642     12  AM-RETRO-BEG-EARNINGS.
  6643         16  AM-RET-BEG-EARN-R             PIC X.
  6644         16  AM-RET-BEG-EARN-L             PIC X.
  6645         16  AM-RET-BEG-EARN-A             PIC X.
  6646     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6647     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6648
  6649     12  AM-USER-SELECT-OPTIONS.
  6650         16  AM-USER-SELECT-1              PIC X(10).
  6651         16  AM-USER-SELECT-2              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 119
* EL131.cbl
  6652         16  AM-USER-SELECT-3              PIC X(10).
  6653         16  AM-USER-SELECT-4              PIC X(10).
  6654         16  AM-USER-SELECT-5              PIC X(10).
  6655
  6656     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6657
  6658     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6659
  6660     12  AM-RPT045A-SWITCH                 PIC X.
  6661         88  RPT045A-OFF                   VALUE 'N'.
  6662
  6663     12  AM-INSURANCE-LIMITS.
  6664         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6665         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6666
  6667     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6668         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6669
  6670     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6671         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6672         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6673
  6674     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6675
  6676     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6677     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6678     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6679     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6680     12  AM-DCC-UEF-STATE                  PIC XX.
  6681     12  FILLER                            PIC XXX.
  6682     12  AM-REPORT-CODE-3                  PIC X(10).
  6683*    12  FILLER                            PIC X(22).
  6684
  6685     12  AM-RESERVE-DATE.
  6686         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6687         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6688         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6689
  6690     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6691     12  AM-NOTIFICATION-TYPES.
  6692         16  AM-NOTIF-OF-LETTERS           PIC X.
  6693         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6694         16  AM-NOTIF-OF-REPORTS           PIC X.
  6695         16  AM-NOTIF-OF-STATUS            PIC X.
  6696
  6697     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6698         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6699         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6700         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6701         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6702
  6703     12  AM-BENEFIT-CONTROLS.
  6704         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6705             20  AM-BENEFIT-CODE           PIC XX.
  6706             20  AM-BENEFIT-TYPE           PIC X.
  6707             20  AM-BENEFIT-REVISION       PIC XXX.
  6708             20  AM-BENEFIT-REM-TERM       PIC X.
  6709             20  AM-BENEFIT-RETRO-Y-N      PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 120
* EL131.cbl
  6710             20  FILLER                    PIC XX.
  6711         16  FILLER                        PIC X(80).
  6712
  6713     12  AM-TRANSFER-DATA.
  6714         16  AM-TRANSFERRED-FROM.
  6715             20  AM-TRNFROM-CARRIER        PIC X.
  6716             20  AM-TRNFROM-GROUPING.
  6717                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6718                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6719             20  AM-TRNFROM-STATE          PIC XX.
  6720             20  AM-TRNFROM-ACCOUNT.
  6721                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6722                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6723             20  AM-TRNFROM-DTE            PIC XX.
  6724         16  AM-TRANSFERRED-TO.
  6725             20  AM-TRNTO-CARRIER          PIC X.
  6726             20  AM-TRNTO-GROUPING.
  6727                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6728                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6729             20  AM-TRNTO-STATE            PIC XX.
  6730             20  AM-TRNTO-ACCOUNT.
  6731                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6732                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6733             20  AM-TRNTO-DTE              PIC XX.
  6734         16  FILLER                        PIC X(10).
  6735
  6736     12  AM-SAVED-REMIT-TO                 PIC 99.
  6737
  6738     12  AM-COMM-STRUCTURE-SAVED.
  6739         16  AM-DEFN-1-SAVED.
  6740             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6741                 24  AM-AGT-SV             PIC X(10).
  6742                 24  AM-COM-TYP-SV         PIC X.
  6743                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6744                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6745                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6746                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6747                 24  FILLER                PIC X.
  6748                 24  AM-GL-CODES-SV        PIC X.
  6749                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6750                 24  FILLER                PIC X.
  6751         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6752             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6753                 24  FILLER                PIC X(11).
  6754                 24  AM-L-COMA-SV          PIC XXX.
  6755                 24  AM-J-COMA-SV          PIC XXX.
  6756                 24  AM-A-COMA-SV          PIC XXX.
  6757                 24  FILLER                PIC X(6).
  6758
  6759     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6760         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6761            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6762            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6763            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6764
  6765     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6766     12  FILLER                            PIC X(120).
  6767
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 121
* EL131.cbl
  6768     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6769         16  AM-CONTROL-NAME               PIC X(30).
  6770         16  AM-EXECUTIVE-ONE.
  6771             20  AM-EXEC1-NAME             PIC X(15).
  6772             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6773                                                          COMP-3.
  6774             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6775                                                          COMP-3.
  6776         16  AM-EXECUTIVE-TWO.
  6777             20  AM-EXEC2-NAME             PIC X(15).
  6778             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6779                                                          COMP-3.
  6780             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6781                                                          COMP-3.
  6782
  6783     12  AM-RETRO-ADDITIONAL-DATA.
  6784         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6785         16  AM-RETRO-PREM-P-E             PIC X.
  6786         16  AM-RETRO-CLMS-P-I             PIC X.
  6787         16  AM-RETRO-RET-BRACKET-LF.
  6788             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6789                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6790                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6791             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6792                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6793                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6794             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6795                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6796                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6797         16  AM-RETRO-RET-BRACKET-AH.
  6798             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6799                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6800                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6801                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6802             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6803                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6804                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6805             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6806                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6807                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6808
  6809     12  AM-COMMENTS.
  6810         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6811
  6812     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6813         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6814         16  AM-FLI-BILLING-CODE           PIC X.
  6815         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6816         16  AM-FLI-UNITED-IDENT           PIC X.
  6817         16  AM-FLI-INTEREST-LOST-DATA.
  6818             20  AM-FLI-BANK-NO            PIC X(5).
  6819             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6820             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6821             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6822         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6823             20  AM-FLI-AGT                PIC X(9).
  6824             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6825             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 122
* EL131.cbl
  6826         16  FILLER                        PIC X(102).
  6827
  6828     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6829         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6830             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6831             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6832             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6833             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6834             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6835         16  FILLER                          PIC X(10).
  6836******************************************************************
  6837
  6838*                                COPY ELCCHKQ.
  6839******************************************************************
  6840*                                                                *
  6841*                                                                *
  6842*                            ELCCHKQ.                            *
  6843*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6844*                            VMOD=2.007                          *
  6845*                                                                *
  6846*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6847*                                                                *
  6848*   FILE TYPE = VSAM,KSDS                                        *
  6849*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6850*                                                                *
  6851*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6852*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6853*                                                                *
  6854*   LOG = YES                                                    *
  6855*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6856******************************************************************
  6857 01  CHECK-QUE.
  6858     12  CQ-RECORD-ID                PIC XX.
  6859         88  VALID-CQ-ID         VALUE 'CQ'.
  6860
  6861     12  CQ-CONTROL-PRIMARY.
  6862         16  CQ-COMPANY-CD           PIC X.
  6863         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6864         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6865
  6866     12  CQ-CONTROL-BY-PAYEE.
  6867         16  CQ-CONTROL-BY-NUMBER.
  6868             20  CQ-COMPANY-CD-A1     PIC X.
  6869             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6870         16  CQ-PAYEE-CARRIER        PIC X.
  6871         16  CQ-PAYEE-GROUPING       PIC X(6).
  6872         16  CQ-PAYEE-STATE          PIC XX.
  6873         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6874         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6875
  6876     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6877         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6878         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6879         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6880         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6881         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6882         16  FILLER                  PIC X(3).
  6883
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 123
* EL131.cbl
  6884     12  CQ-ENTRY-TYPE               PIC X.
  6885             88  CHECK-ON-QUE           VALUE 'Q'.
  6886             88  ALIGNMENT-CHECK        VALUE 'A'.
  6887             88  SPOILED-CHECK          VALUE 'S'.
  6888             88  PAYMENT-ABORTED        VALUE 'X'.
  6889
  6890     12  CQ-CLAIM-MAST-CNTL.
  6891         16  CQ-CARRIER              PIC X.
  6892         16  CQ-CLAIM-NO             PIC X(7).
  6893         16  CQ-CERT-NO.
  6894             20  CQ-CERT-PRIME       PIC X(10).
  6895             20  CQ-CERT-SFX         PIC X.
  6896         16  CQ-CLAIM-TYPE           PIC X.
  6897             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6898             88  CQ-AH-CLAIM            VALUE 'A'.
  6899         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6900             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6901             88  CQ-O-B-COVERAGE        VALUE '2'.
  6902             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6903
  6904     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6905     12  CQ-CHECK-NUMBER             PIC X(7).
  6906     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6907     12  CQ-PAYMENT-TYPE             PIC X.
  6908             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6909             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6910             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6911             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6912             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6913             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6914             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6915             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6916     12  CQ-VOID-INDICATOR           PIC X.
  6917             88  CHECK-IS-STOPPED          VALUE 'S'.
  6918             88  CHECK-IS-VOID             VALUE 'V'.
  6919     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6920     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6921     12  CQ-CHECK-BY-USER            PIC X(4).
  6922     12  CQ-PRE-NUMBERING-SW         PIC X.
  6923       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6924       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6925
  6926     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6927     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6928     12  CQ-LEDGER-FLAG              PIC X(01).
  6929     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6930     12  CQ-LAST-UPDATED-DT          PIC XX.
  6931     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6932     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6933
  6934     12  FILLER                      PIC X(04).
  6935
  6936******************************************************************
  6937
  6938*                                COPY ELCARCH.
  6939******************************************************************
  6940*                                                                *
  6941*                            ELCARCH.                            *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 124
* EL131.cbl
  6942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6943*                            VMOD=2.007                          *
  6944*                                                                *
  6945*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6946*                                                                *
  6947*   FILE TYPE = VSAM,KSDS                                        *
  6948*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6949*                                                                *
  6950*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6951*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6952*                                                                *
  6953*   LOG = NO                                                     *
  6954*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6955*                                                                *
  6956*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6957******************************************************************
  6958 01  LETTER-ARCHIVE.
  6959     12  LA-RECORD-ID                PIC XX.
  6960         88  VALID-LA-ID                VALUE 'LA'.
  6961
  6962     12  LA-CONTROL-PRIMARY.
  6963         16  LA-COMPANY-CD           PIC X.
  6964         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6965         16  LA-RECORD-TYPE          PIC X.
  6966             88  LA-HEADER-DATA         VALUE '1'.
  6967             88  LA-ADDRESS-DATA        VALUE '2'.
  6968             88  LA-TEXT-DATA           VALUE '3'.
  6969             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6970         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6971
  6972     12  LA-CONTROL-BY-TYPE.
  6973         16  LA-COMPANY-CD-A1        PIC X.
  6974         16  LA-RECORD-TYPE-A1       PIC X.
  6975         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6976         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6977
  6978     12  LA-TEXT-RECORD.
  6979         16  LA-SKIP-CONTROL         PIC XX.
  6980             88  NO-LINES-SKIPPED       VALUE SPACES.
  6981             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6982         16  LA-TEXT-LINE            PIC X(70).
  6983
  6984     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6985         16  FILLER                  PIC XX.
  6986         16  LA-ADDRESS-LINE         PIC X(30).
  6987         16  FILLER                  PIC X(40).
  6988
  6989     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6990         16  FILLER                  PIC XX.
  6991         16  LA-CARRIER              PIC X.
  6992         16  LA-CLAIM-NO             PIC X(7).
  6993         16  LA-CERT-NO.
  6994             20  LA-CERT-PRIME       PIC X(10).
  6995             20  LA-CERT-SFX         PIC X.
  6996         16  LA-NO-OF-COPIES         PIC S9.
  6997         16  LA-RESEND-DATE          PIC XX.
  6998         16  LA-PROCESSOR-CD         PIC X(4).
  6999         16  LA-CREATION-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 125
* EL131.cbl
  7000         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7001         16  LA-RESEND-PRINT-DATE    PIC XX.
  7002         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7003         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7004*
  7005* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7006*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7007*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7008*   I        20  LA-DMD-RES-ST           PIC XX.
  7009*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7010*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7011*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7012*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7013*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7014*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7015*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7016*   I        20  LA-DMD-UND-CODE         PIC XX.
  7017*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7018*   V    16  FILLER                  PIC X(15).
  7019* -----
  7020*
  7021* REINSERTED  CSO  MODS
  7022*
  7023         16  FILLER.
  7024             20  FILLER                  PIC X(29).
  7025             20  LA-CSO-LETTER-STATUS    PIC X.
  7026                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7027                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7028                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7029             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7030             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7031*
  7032
  7033     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7034         16  FILLER                  PIC XX.
  7035         16  LA4-CARRIER             PIC X.
  7036         16  LA4-CLAIM-NO            PIC X(7).
  7037         16  LA4-CERT-NO.
  7038             20  LA4-CERT-PRIME      PIC X(10).
  7039             20  LA4-CERT-SFX        PIC X.
  7040         16  LA4-NO-OF-COPIES        PIC S9.
  7041         16  LA4-RESEND-DATE         PIC XX.
  7042         16  LA4-PROCESSOR-CD        PIC X(4).
  7043         16  LA4-CREATION-DT         PIC XX.
  7044         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7045         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7046         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7047         16  LA4-FORM-TYPE           PIC X.
  7048             88  LA4-INITIAL-FORM    VALUE '1'.
  7049             88  LA4-PROGRESS-FORM   VALUE '2'.
  7050         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7051         16  LA4-STATE               PIC X(02).
  7052         16  FILLER                  PIC X(31).
  7053******************************************************************
  7054
  7055*                                COPY ELCBENE.
  7056******************************************************************
  7057*                                                                *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 126
* EL131.cbl
  7058*                            ELCBENE.                            *
  7059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7060*                            VMOD=2.006                          *
  7061*                                                                *
  7062*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7063*                                                                *
  7064*   FILE TYPE = VSAM,KSDS                                        *
  7065*   RECORD SIZE = 500   RECFORM = FIX                            *
  7066*                                                                *
  7067*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7068*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7069*                                                                *
  7070*   LOG = YES                                                    *
  7071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7072*                                                                *
  7073*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7074******************************************************************
  7075*                   C H A N G E   L O G
  7076*
  7077* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7078*-----------------------------------------------------------------
  7079*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7080* EFFECTIVE    NUMBER
  7081*-----------------------------------------------------------------
  7082* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7083* 082317  CR2017082100003  PEMA  Add sub type
  7084* 032019  CR2019011400002  PEMA  Add email address for ach report
  7085******************************************************************
  7086
  7087 01  BENEFICIARY-MASTER.
  7088     12  BE-RECORD-ID                PIC XX.
  7089         88  VALID-BE-ID                VALUE 'BE'.
  7090
  7091     12  BE-CONTROL-PRIMARY.
  7092         16  BE-COMPANY-CD           PIC X.
  7093         16  BE-RECORD-TYPE          PIC X.
  7094             88  BENEFICIARY-RECORD  VALUE 'B'.
  7095             88  ADJUSTOR-RECORD     VALUE 'A'.
  7096         16  BE-BENEFICIARY          PIC X(10).
  7097     12  BE-CONTROL-BY-NAME.
  7098         16  BE-COMPANY-CD-A1        PIC X.
  7099         16  BE-RECORD-TYPE-A1       PIC X.
  7100         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7101         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7102
  7103     12  BE-LAST-MAINT-DT            PIC XX.
  7104     12  BE-LAST-MAINT-BY            PIC X(4).
  7105     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7106
  7107     12  BE-ADDRESS-DATA.
  7108         16  BE-MAIL-TO-NAME         PIC X(30).
  7109         16  BE-ADDRESS-LINE-1       PIC X(30).
  7110         16  BE-ADDRESS-LINE-2       PIC X(30).
  7111         16  BE-ADDRESS-LINE-3       PIC X(30).
  7112         16  BE-CITY-STATE.
  7113             20  BE-CITY             PIC X(28).
  7114             20  BE-STATE            PIC XX.
  7115         16  BE-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 127
* EL131.cbl
  7116             20  BE-ZIP-PRIME.
  7117                 24  BE-ZIP-1ST      PIC X.
  7118                     88  BE-CANADIAN-POST-CODE
  7119                                         VALUE 'A' THRU 'Z'.
  7120                 24  FILLER          PIC X(4).
  7121             20  BE-ZIP-PLUS4        PIC X(4).
  7122         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7123             20  BE-CAN-POSTAL-1     PIC XXX.
  7124             20  BE-CAN-POSTAL-2     PIC XXX.
  7125             20  FILLER              PIC XXX.
  7126         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7127         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7128
  7129******************************************************************
  7130*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7131*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7132******************************************************************
  7133     12  BE-CARRIER                  PIC X.
  7134
  7135     12  BE-ADDRESS-DATA2.
  7136         16  BE-MAIL-TO-NAME2        PIC X(30).
  7137         16  BE-ADDRESS-LINE-12      PIC X(30).
  7138         16  BE-ADDRESS-LINE-22      PIC X(30).
  7139         16  BE-ADDRESS-LINE-32      PIC X(30).
  7140         16  BE-CITY-STATE2.
  7141             20  BE-CITY2            PIC X(28).
  7142             20  BE-STATE2           PIC XX.
  7143         16  BE-ZIP-CODE2.
  7144             20  BE-ZIP-PRIME2.
  7145                 24  BE-ZIP-1ST2     PIC X.
  7146                     88  BE-CANADIAN-POST-CODE2
  7147                                         VALUE 'A' THRU 'Z'.
  7148                 24  FILLER          PIC X(4).
  7149             20  BE-ZIP-PLUS42       PIC X(4).
  7150         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7151             20  BE-CAN-POSTAL-12    PIC XXX.
  7152             20  BE-CAN-POSTAL-22    PIC XXX.
  7153             20  FILLER              PIC XXX.
  7154         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7155         16  BE-ACH-DATA.
  7156             20  BE-ACH-YES-OR-NO    PIC X.
  7157                 88  BE-ON-ACH       VALUE 'Y'.
  7158                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7159             20  BE-ACH-ABA-ROUTING-NUMBER
  7160                                     PIC X(15).
  7161             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7162                                     PIC X(20).
  7163             20  BE-ACH-SUB-TYPE     PIC XX.
  7164             20  BE-ACH-EMAIL-YN     PIC X.
  7165                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  7166             20  be-ach-email-addr   PIC X(40).
  7167         16  BE-BILLING-STMT-DATA.
  7168*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7169             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7170             20  BE-OUTPUT-TYPE      PIC X.
  7171                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7172                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7173
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 128
* EL131.cbl
  7174     12  filler                      PIC X(16).
  7175******************************************************************
  7176
  7177*                                COPY ELCDAR.
  7178******************************************************************
  7179*                                                                *
  7180*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7181*   FILE TYPE = VSAM,KSDS                                        *
  7182*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7183*   BASE CLUSTER = DLYACTV                                       *
  7184*   LOG = YES                                                    *
  7185*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7186*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7187*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7188*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7189*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7190*               BY PROGRAM "LGINFCE".                            *
  7191*                                                                *
  7192******************************************************************
  7193 01  DAILY-ACTIVITY-RECORD.
  7194     05  DA-KEY.
  7195         10  DA-COMP-CD          PIC X.
  7196         10  DA-CARRIER          PIC X.
  7197         10  DA-CLAIM-NO         PIC X(7).
  7198         10  DA-CERT-NO.
  7199             15  DA-CERT-PRIME   PIC X(10).
  7200             15  DA-CERT-SFX     PIC X.
  7201     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7202     05  DA-RECORD-TYPE          PIC X.
  7203     05  FILLER                  PIC X(2).
  7204******************************************************************
  7205
  7206*                                COPY ELCALPH.
  7207******************************************************************
  7208*                                                                *
  7209*                            ELCALPH.                            *
  7210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7211*                            VMOD=2.003                          *
  7212*                                                                *
  7213*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7214*                                                                *
  7215*   FILE TYPE = VSAM,KSDS                                        *
  7216*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7217*                                                                *
  7218*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7219*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7220*                                                                *
  7221*   LOG = YES                                                    *
  7222*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7223*                                                                *
  7224*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7225******************************************************************
  7226
  7227 01  ALPHA-INDEX.
  7228     12  AI-RECORD-ID                         PIC XX.
  7229         88  VALID-AI-ID                  VALUE 'AI'.
  7230     12  AI-CONTROL-PRIMARY.
  7231         16  AI-COMPANY-CD                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 129
* EL131.cbl
  7232         16  AI-SOURCE                         PIC X.
  7233             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7234             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7235         16  AI-NAME.
  7236             20  AI-LAST-NAME                  PIC X(15).
  7237             20  AI-FIRST-NAME.
  7238                 24  AI-FIRST-INITIAL          PIC X.
  7239                 24  FILLER                    PIC X(11).
  7240             20  AI-MIDDLE-INIT                PIC X.
  7241         16  AI-DATE                           PIC X(8).
  7242         16  AI-TIME                           PIC S9(07) COMP-3.
  7243
  7244     12  AI-CONTROL-BY-ADMIN-KEY.
  7245         16  AI-CM-COMPANY-CD                  PIC X.
  7246         16  AI-CM-SOURCE                      PIC X.
  7247         16  AI-CM-CARRIER                     PIC X.
  7248         16  AI-CM-GROUPING.
  7249             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7250             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7251         16  AI-CM-STATE                       PIC XX.
  7252         16  AI-CM-PRODUCER.
  7253             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7254             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7255         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7256         16  AI-CM-CERTIFICATE-NUMBER.
  7257             20  AI-CM-CERT-PRIME              PIC X(10).
  7258             20  AI-CM-CERT-SFX                PIC X.
  7259         16  AI-CM-DATE                        PIC X(8).
  7260         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7261         16  FILLER                            PIC X(11).
  7262
  7263     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7264         AI-CONTROL-BY-ADMIN-KEY.
  7265         16  AI-CL-COMPANY-CD                  PIC X.
  7266         16  AI-CL-SOURCE                      PIC X.
  7267         16  AI-CL-CARRIER                     PIC X.
  7268         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7269         16  AI-CL-CERTIFICATE-NUMBER.
  7270             20  AI-CL-CERT-PRIME              PIC X(10).
  7271             20  AI-CL-CERT-SFX                PIC X.
  7272         16  AI-CL-DATE                        PIC X(8).
  7273         16  AI-CL-INCURRED-DATE               PIC XX.
  7274         16  AI-CL-CLOSE-DATE                  PIC XX.
  7275         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7276         16  AI-CREDIT-CARD-NUMBER.
  7277             20  AI-CCN.
  7278                 24  AI-CCN-PREFIX             PIC X(4).
  7279                 24  AI-CCN-PRIME              PIC X(12).
  7280             20  AI-CCN-FILLER                 PIC X(4).
  7281
  7282     12  AI-MAINT-INFO.
  7283         16  AI-LAST-MAINT-BY                  PIC X(4).
  7284         16  AI-LAST-MAINT-DT                  PIC XX.
  7285         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7286
  7287     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7288
  7289     12  FILLER                                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 130
* EL131.cbl
  7290
  7291
  7292*                                COPY ERCDMDNT.
  7293******************************************************************
  7294*                                                                *
  7295*                            ERCDMDNT                            *
  7296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7297*                            VMOD=2.005                          *
  7298*                                                                *
  7299*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7300*                                                                *
  7301*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7302*                                                                *
  7303*        FILE TYPE= VSAM,KSDS                                    *
  7304*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7305*                                                                *
  7306*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7307*                                                                *
  7308*        LOG = YES                                               *
  7309*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7310*                                                                *
  7311******************************************************************
  7312
  7313 01  CERTIFICATE-NOTE.
  7314     12  CN-RECORD-ID                     PIC  XX.
  7315         88  VALID-CN-ID                      VALUE 'CN'.
  7316
  7317     12  CN-CONTROL-PRIMARY.
  7318         16  CN-COMPANY-CD                PIC X.
  7319         16  CN-CERT-KEY.
  7320             20  CN-CARRIER               PIC X.
  7321             20  CN-GROUPING.
  7322                 24  CN-GROUPING-PREFIX   PIC XXX.
  7323                 24  CN-GROUPING-PRIME    PIC XXX.
  7324             20  CN-STATE                 PIC XX.
  7325             20  CN-ACCOUNT.
  7326                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7327                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7328             20  CN-CERT-EFF-DT           PIC XX.
  7329             20  CN-CERT-NO.
  7330                 24  CN-CERT-PRIME        PIC X(10).
  7331                 24  CN-CERT-SFX          PIC X.
  7332
  7333     12  CN-BILLING-START-LINE-NO         PIC 99.
  7334     12  CN-BILLING-END-LINE-NO           PIC 99.
  7335
  7336     12  CN-LINES.
  7337         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7338
  7339     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7340         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7341         16  CN-CSI-GENERAL-DATA-AREA.
  7342             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7343
  7344         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7345             CN-CSI-GENERAL-DATA-AREA.
  7346             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7347             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 131
* EL131.cbl
  7348             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7349             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7350             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7351             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7352             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7353             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7354             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7355             20  FILLER                       PIC XX.
  7356             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7357             20  FILLER                       PIC X(38).
  7358
  7359         16  CN-CSI-PRODUCT-DATA-AREA.
  7360             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7361
  7362         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7363             CN-CSI-PRODUCT-DATA-AREA.
  7364             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7365             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7366             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7367             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7368             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7369             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7370             20  FILLER                   PIC XX.
  7371             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7372             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7373             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7374             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7375             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7376             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7377             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7378             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7379             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7380             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7381             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7382             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7383             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7384             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7385             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7386             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7387             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7388             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7389             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7390             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7391             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7392             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7393             20  FILLER                   PIC X(25).
  7394
  7395         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7396             CN-CSI-CREDIT-CARD-DATA.
  7397             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7398             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7399             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7400             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7401             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7402             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7403             20  FILLER                   PIC XX.
  7404             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7405             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 132
* EL131.cbl
  7406             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7407             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7408             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7409             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7410             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7411             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7412             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7413             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7414             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7415             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7416             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7417             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7418             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7419             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7420             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7421             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7422             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7423             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7424             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7425             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7426             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7427             20  FILLER                   PIC X(17).
  7428
  7429         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7430             CN-CSI-FAMILY-LEAVE-DATA.
  7431             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7432             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7433             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7434             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7435             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7436             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7437             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7438             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7439             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7440             20  CN-CSI-SL-INT-ON-PROCEEDS
  7441                                          PIC S9(5)V99  COMP-3.
  7442             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7443             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7444             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7445             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7446             20  CN-CSI-SL-POLICY-BENEFITS
  7447                                          PIC S9(5)V99  COMP-3.
  7448             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7449             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7450             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7451             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7452             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7453             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7454             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7455             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7456             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7457             20  CN-CSI-SL-STATE-NOT      PIC X.
  7458             20  FILLER                   PIC XX.
  7459
  7460         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7461             CN-CSI-SENIOR-LIFE-DATA.
  7462             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7463             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 133
* EL131.cbl
  7464             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7465                                          PIC S9(5)V99  COMP-3.
  7466             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7467             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7468             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7469             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7470             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7471             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7472             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7473             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7474             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7475             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7476             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7477             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7478             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7479             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7480             20  CN-CSI-PP-REPAIR         PIC X.
  7481             20  CN-CSI-PP-REPLACE        PIC X.
  7482             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7483             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7484             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7485             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7486             20  FILLER                   PIC X(5).
  7487
  7488         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7489             CN-CSI-PURCH-PROP-DATA.
  7490             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7491             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7492             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7493             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7494             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7495             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7496             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7497             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7498             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7499             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7500             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7501             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7502             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7503             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7504             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7505             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7506             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7507             20  CN-CSI-EW-REPLACE        PIC X.
  7508             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7509             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7510             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7511             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7512             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7513             20  FILLER                   PIC X(4).
  7514
  7515     12  CN-LAST-MAINT-DT                 PIC XX.
  7516     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7517     12  CN-LAST-MAINT-USER               PIC X(4).
  7518     12  FILLER                           PIC X(6).
  7519
  7520******************************************************************
  7521
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 134
* EL131.cbl
  7523 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7524                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7525                          CONTROL-FILE ACTIVITY-QUE
  7526                          ACCOUNT-MASTER CHECK-QUE
  7527                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7528                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7529                          CERTIFICATE-NOTE.
  7530 0000-DFHEXIT SECTION.
  7531     MOVE '9#                    $   ' TO DFHEIV0.
  7532     MOVE 'EL131' TO DFHEIV1.
  7533     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7534
  7535     IF EIBCALEN = ZERO
  7536         GO TO 8800-UNAUTHORIZED-ACCESS.
  7537
  7538     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7539     MOVE '5'                    TO DC-OPTION-CODE.
  7540     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7541     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7542     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7543     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7544
  7545     IF SAVE-DATE-YY GREATER 70
  7546         MOVE 19                 TO SAVE-DATE-CC
  7547      ELSE
  7548         MOVE 20                 TO SAVE-DATE-CC.
  7549
  7550
  7551* EXEC CICS HANDLE CONDITION
  7552*        PGMIDERR (8820-XCTL-ERROR)
  7553*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7554*        ERROR    (9990-ABEND)
  7555*    END-EXEC.
  7556*    MOVE '"$LI.                 ! " #00007546' TO DFHEIV0
  7557     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7558     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7559     MOVE X'2220233030303037353436' TO DFHEIV0(25:11)
  7560     CALL 'kxdfhei1' USING DFHEIV0
  7561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7562
  7563
  7564     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7565     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7566     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7567
  7568     INITIALIZE    EDIT-WORK-AREA.
  7569     MOVE '/'                    TO WORK-SLASH.
  7570     MOVE SPACES                 TO ERROR-SWITCHES.
  7571
  7572     MOVE TRAN-ID                TO TRANS-ID.
  7573     MOVE EIBTRMID               TO PI-TERM.
  7574     MOVE MAP-ID                 TO PI-QUAL.
  7575
  7576     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7577
  7578     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7579         MOVE LOW-VALUES         TO EL131AO
  7580         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 135
* EL131.cbl
  7581         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7582         MOVE -1                 TO MAINTL
  7583         GO TO 8110-SEND-DATA.
  7584
  7585     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7586         MOVE LOW-VALUES         TO EL131AO
  7587         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7588         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7589         MOVE 'X'                TO PI-RETURN-CD-1
  7590         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7591         MOVE -1                 TO MAINTL
  7592         IF WS-RETURNED-FROM = XCTL-EL114
  7593             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7594         END-IF
  7595         GO TO 8100-SEND-MAP.
  7596
  7597     IF EIBAID = DFHCLEAR
  7598         GO TO 8200-RETURN-PRIOR.
  7599
  7600     IF PI-PROCESSOR-ID = 'LGXX'
  7601         NEXT SENTENCE
  7602     ELSE
  7603
  7604* EXEC CICS READQ TS
  7605*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7606*            INTO    (SECURITY-CONTROL)
  7607*            LENGTH  (SC-COMM-LENGTH)
  7608*            ITEM    (SC-ITEM)
  7609*        END-EXEC
  7610*    MOVE '*$II   L              ''   #00007591' TO DFHEIV0
  7611     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7612     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7613     MOVE X'2020233030303037353931' TO DFHEIV0(25:11)
  7614     CALL 'kxdfhei1' USING DFHEIV0,
  7615           PI-SECURITY-TEMP-STORE-ID,
  7616           SECURITY-CONTROL,
  7617           SC-COMM-LENGTH,
  7618           SC-ITEM,
  7619           DFHEIV99,
  7620           DFHEIV99
  7621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7622         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7623         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7624         IF NOT DISPLAY-CAP
  7625             MOVE 'READ'               TO  SM-READ
  7626             PERFORM 9995-SECURITY-VIOLATION
  7627             MOVE ER-0070              TO  EMI-ERROR
  7628             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7629             GO TO 8100-SEND-MAP.
  7630
  7631
  7632* EXEC CICS RECEIVE
  7633*        MAP    ('EL131A')
  7634*        MAPSET ('EL131S')
  7635*    END-EXEC.
  7636     MOVE 'EL131A' TO DFHEIV1
  7637     MOVE 'EL131S' TO DFHEIV2
  7638*    MOVE '8"T                   ''   #00007606' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 136
* EL131.cbl
  7639     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7640     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7641     MOVE X'2020233030303037363036' TO DFHEIV0(25:11)
  7642     CALL 'kxdfhei1' USING DFHEIV0,
  7643           DFHEIV1,
  7644           EL131AI,
  7645           DFHEIV99,
  7646           DFHEIV2,
  7647           DFHEIV99,
  7648           DFHEIV99
  7649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7650
  7651
  7652     IF PFKEYL GREATER THAN ZERO
  7653         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7654
  7655     IF SCREEN-ERROR
  7656         MOVE ER-0004 TO EMI-ERROR
  7657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7658         MOVE -1 TO MAINTL
  7659         GO TO 8110-SEND-DATA.
  7660
  7661     IF EIBAID = DFHPF3
  7662         GO TO 8500-TRLR-MNT.
  7663
  7664     IF EIBAID = DFHPF4
  7665         GO TO 8600-ADDR-MNT.
  7666
  7667     IF EIBAID = DFHPF5
  7668         GO TO 8700-CERT-MNT.
  7669
  7670     IF PI-COMPANY-ID = 'DMD'
  7671       IF EIBAID = DFHPF6
  7672         GO TO 8750-DMD-CLM-FIX.
  7673
  7674     IF EIBAID = DFHPF7
  7675         GO TO 4000-FORCE-ERRORS.
  7676
  7677     IF EIBAID = DFHPF12
  7678         GO TO 8300-GET-HELP.
  7679
  7680     IF EIBAID = DFHPF15
  7681         GO TO 8725-BENEFICIARY-MNT
  7682     END-IF.
  7683
  7684     IF EIBAID = DFHPF23
  7685         GO TO 8810-PF23-ENTERED.
  7686
  7687     IF EIBAID = DFHPF24
  7688         GO TO 8400-RETURN-MASTER.
  7689
  7690     IF EIBAID NOT = DFHENTER
  7691         MOVE ER-0029            TO EMI-ERROR
  7692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7693         MOVE -1                 TO MAINTL
  7694         GO TO 8110-SEND-DATA.
  7695
  7696     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 137
* EL131.cbl
  7697         MOVE ER-0311            TO EMI-ERROR
  7698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7699         MOVE -1                 TO MAINTL
  7700         GO TO 8110-SEND-DATA.
  7701
  7702     IF MAINTI = 'A'
  7703         GO TO 0500-ADD-ALPHA-ONLY.
  7704
  7705     IF MAINTI = 'N'
  7706         GO TO 0600-CHANGE-NAME.
  7707
  7708     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7709     PERFORM 1030-EDIT-NAME THRU 1030-EXIT.
  7710
  7711     IF SCREEN-ERROR
  7712         GO TO 8110-SEND-DATA.
  7713
  7714     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7715         MOVE ER-0276            TO EMI-ERROR
  7716         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7717         MOVE -1                 TO MAINTL
  7718         GO TO 8110-SEND-DATA.
  7719
  7720     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7721
  7722     IF SCREEN-ERROR
  7723         GO TO 8110-SEND-DATA.
  7724
  7725     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7726
  7727     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7728
  7729     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7730         GO TO 8110-SEND-DATA.
  7731
  7732     IF EMI-FATAL-CTR GREATER THAN ZERO
  7733         GO TO 8110-SEND-DATA.
  7734
  7735     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7736
  7737     IF WS-OPEN-CLOSE-SW = 'Y'
  7738         IF PI-LETTER-SW = 'Y'
  7739             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7740             MOVE 'T'            TO  CNTL-REC-TYPE
  7741             MOVE SPACES         TO  CNTL-PROC-ID
  7742             MOVE +0             TO  CNTL-SEQ-NO
  7743
  7744* EXEC CICS READ
  7745*                DATASET   (CNTL-FILE-ID)
  7746*                RIDFLD    (CNTL-KEY)
  7747*                SET       (ADDRESS OF CONTROL-FILE)
  7748*            END-EXEC
  7749*    MOVE '&"S        E          (   #00007702' TO DFHEIV0
  7750     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7752     MOVE X'2020233030303037373032' TO DFHEIV0(25:11)
  7753     CALL 'kxdfhei1' USING DFHEIV0,
  7754           CNTL-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 138
* EL131.cbl
  7755           DFHEIV20,
  7756           DFHEIV99,
  7757           CNTL-KEY,
  7758           DFHEIV99,
  7759           DFHEIV99,
  7760           DFHEIV99
  7761     SET ADDRESS OF CONTROL-FILE TO
  7762         DFHEIV20
  7763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7764             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7765
  7766     MOVE ER-0000                TO EMI-ERROR.
  7767     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7768
  7769     MOVE SPACE                  TO MAINTO.
  7770     MOVE -1                     TO MAINTL.
  7771     GO TO 8100-SEND-MAP.
  7772
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 139
* EL131.cbl
  7774 0100-UPDATE-PI.
  7775
  7776     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7777     IF WS-RETURNED-FROM = XCTL-EL114
  7778***sometimes there is crap in positions 7-10 when no code was sele
  7779        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7780          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7781        END-IF
  7782     END-IF.
  7783
  7784     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7785         GO TO 0110-UPDATE-UP.
  7786
  7787     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7788     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7789     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7790     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7791     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7792     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7793     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7794     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7795     GO TO 0120-UPDATE-PI-EXIT.
  7796
  7797 0110-UPDATE-UP.
  7798     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7799     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7800     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7801     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7802     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7803     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7804     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7805     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7806
  7807
  7808* EXEC CICS HANDLE CONDITION
  7809*         QIDERR    (0130-TS-ERROR)
  7810*         ITEMERR   (0130-TS-ERROR)
  7811*    END-EXEC.
  7812*    MOVE '"$N<                  ! # #00007750' TO DFHEIV0
  7813     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7815     MOVE X'2320233030303037373530' TO DFHEIV0(25:11)
  7816     CALL 'kxdfhei1' USING DFHEIV0
  7817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7818
  7819
  7820     IF WS-RETURNED-FROM = XCTL-EL114
  7821
  7822* EXEC CICS READQ TS
  7823*            QUEUE    (PI-KEY)
  7824*            INTO     (EL131AI)
  7825*            LENGTH   (MAP-LENGTH)
  7826*       END-EXEC
  7827*    MOVE '*$I    L              ''   #00007756' TO DFHEIV0
  7828     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7830     MOVE X'2020233030303037373536' TO DFHEIV0(25:11)
  7831     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 140
* EL131.cbl
  7832           PI-KEY,
  7833           EL131AI,
  7834           MAP-LENGTH,
  7835           DFHEIV99,
  7836           DFHEIV99,
  7837           DFHEIV99
  7838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7839
  7840        IF WS-SAVE-BENEFICIARY > SPACES
  7841            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7842            MOVE +10            TO BENEL
  7843            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7844        END-IF
  7845        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7846     END-IF.
  7847
  7848
  7849* EXEC CICS READQ TS
  7850*         QUEUE    (PI-KEY)
  7851*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7852*         LENGTH   (PI-COMM-LENGTH)
  7853*    END-EXEC.
  7854*    MOVE '*$I    L              ''   #00007770' TO DFHEIV0
  7855     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7856     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7857     MOVE X'2020233030303037373730' TO DFHEIV0(25:11)
  7858     CALL 'kxdfhei1' USING DFHEIV0,
  7859           PI-KEY,
  7860           PROGRAM-INTERFACE-BLOCK,
  7861           PI-COMM-LENGTH,
  7862           DFHEIV99,
  7863           DFHEIV99,
  7864           DFHEIV99
  7865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7866
  7867
  7868
  7869* EXEC CICS DELETEQ TS
  7870*         QUEUE    (PI-KEY)
  7871*    END-EXEC.
  7872*    MOVE '*&                    #   #00007776' TO DFHEIV0
  7873     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7874     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7875     MOVE X'2020233030303037373736' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0,
  7877           PI-KEY,
  7878           DFHEIV99
  7879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7880
  7881
  7882 0120-UPDATE-PI-EXIT.
  7883     EXIT.
  7884
  7885 0130-TS-ERROR.
  7886     MOVE LOW-VALUES             TO EL131AO.
  7887     MOVE ER-0192                TO EMI-ERROR.
  7888
  7889     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 141
* EL131.cbl
  7890
  7891     GO TO 8100-SEND-MAP.
  7892
  7893 0200-TRANS-PF.
  7894     IF EIBAID NOT = DFHENTER
  7895         MOVE 'X'                TO ERROR-SWITCH
  7896         GO TO 0210-EXIT.
  7897
  7898     IF PFKEYI NOT NUMERIC
  7899         MOVE 'X'                TO ERROR-SWITCH
  7900         GO TO 0210-EXIT.
  7901
  7902     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7903
  7904     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7905         MOVE 'X' TO ERROR-SWITCH
  7906         GO TO 0210-EXIT.
  7907
  7908     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7909
  7910 0210-EXIT.
  7911     EXIT.
  7912
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 142
* EL131.cbl
  7914 0500-ADD-ALPHA-ONLY.
  7915******************************************************************
  7916*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7917*    RECORD.                                                     *
  7918******************************************************************
  7919
  7920     IF MLNAMEL = +0 AND
  7921        MFNAMEL = +0 AND
  7922        MMINITL = +0
  7923         MOVE ER-0797                TO  EMI-ERROR
  7924         MOVE -1                     TO  MAINTL
  7925         MOVE AL-UABON               TO  MAINTA
  7926         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7927         GO TO 8110-SEND-DATA.
  7928
  7929     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7930     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7931     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7932     MOVE PI-CERT-NO                 TO  CERT-NO.
  7933
  7934
  7935* EXEC CICS READ
  7936*        DATASET   (CLMS-FILE-ID)
  7937*        RIDFLD    (MSTR-KEY)
  7938*        SET       (ADDRESS OF CLAIM-MASTER)
  7939*    END-EXEC.
  7940*    MOVE '&"S        E          (   #00007832' TO DFHEIV0
  7941     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7942     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7943     MOVE X'2020233030303037383332' TO DFHEIV0(25:11)
  7944     CALL 'kxdfhei1' USING DFHEIV0,
  7945           CLMS-FILE-ID,
  7946           DFHEIV20,
  7947           DFHEIV99,
  7948           MSTR-KEY,
  7949           DFHEIV99,
  7950           DFHEIV99,
  7951           DFHEIV99
  7952     SET ADDRESS OF CLAIM-MASTER TO
  7953         DFHEIV20
  7954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7955
  7956
  7957
  7958* EXEC CICS GETMAIN
  7959*        SET       (ADDRESS OF ALPHA-INDEX)
  7960*        LENGTH    (ALPH-LENGTH)
  7961*        INITIMG   (GETMAIN-SPACE)
  7962*    END-EXEC.
  7963*    MOVE ',"IL                  $   #00007838' TO DFHEIV0
  7964     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7965     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7966     MOVE X'2020233030303037383338' TO DFHEIV0(25:11)
  7967     CALL 'kxdfhei1' USING DFHEIV0,
  7968           DFHEIV20,
  7969           ALPH-LENGTH,
  7970           GETMAIN-SPACE
  7971     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 143
* EL131.cbl
  7972         DFHEIV20
  7973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7974
  7975
  7976     MOVE 'AI'                       TO  AI-RECORD-ID.
  7977     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7978                                         AI-CL-COMPANY-CD.
  7979     MOVE 'C'                        TO  AI-SOURCE
  7980                                         AI-CL-SOURCE.
  7981
  7982     IF MLNAMEL IS GREATER THAN +0
  7983         MOVE MLNAMEI                TO  AI-LAST-NAME
  7984     ELSE
  7985         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7986
  7987     IF MFNAMEL IS GREATER THAN +0
  7988         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7989     ELSE
  7990         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7991
  7992     IF MMINITL IS GREATER THAN +0
  7993         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7994     ELSE
  7995         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7996
  7997     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7998     MOVE '5'                        TO  DC-OPTION-CODE.
  7999     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8000     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8001     IF BUILD-YEAR IS GREATER THAN 50
  8002         MOVE '19'                   TO  WS-ALPHA-YY-1
  8003         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8004         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8005         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8006     ELSE
  8007         MOVE '20'                   TO  WS-ALPHA-YY-1
  8008         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8009         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8010         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8011
  8012     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8013                                         AI-CL-DATE.
  8014
  8015     MOVE EIBTIME                    TO  AI-TIME
  8016                                         AI-CL-TIME.
  8017
  8018     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8019     MOVE 'C'                        TO  AI-CL-SOURCE.
  8020     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8021     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8022     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8023     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8024     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8025
  8026     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8027     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8028     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8029
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 144
* EL131.cbl
  8030
  8031* EXEC CICS WRITE
  8032*        DATASET   (ALPH-FILE-ID)
  8033*        RIDFLD    (AI-CONTROL-PRIMARY)
  8034*        FROM      (ALPHA-INDEX)
  8035*    END-EXEC.
  8036     MOVE LENGTH OF
  8037      ALPHA-INDEX
  8038       TO DFHEIV11
  8039*    MOVE '&$ L                  ''   #00007898' TO DFHEIV0
  8040     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8041     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8042     MOVE X'2020233030303037383938' TO DFHEIV0(25:11)
  8043     CALL 'kxdfhei1' USING DFHEIV0,
  8044           ALPH-FILE-ID,
  8045           ALPHA-INDEX,
  8046           DFHEIV11,
  8047           AI-CONTROL-PRIMARY,
  8048           DFHEIV99,
  8049           DFHEIV99
  8050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8051
  8052
  8053     MOVE LOW-VALUES                 TO  EL131AO.
  8054     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8055     MOVE ER-0000                    TO  EMI-ERROR.
  8056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8057     MOVE -1                         TO  MAINTL.
  8058     GO TO 8100-SEND-MAP.
  8059
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 145
* EL131.cbl
  8061 0600-CHANGE-NAME.
  8062******************************************************************
  8063*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  8064*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  8065******************************************************************
  8066
  8067     IF MLNAMEL = +0 AND
  8068        MFNAMEL = +0 AND
  8069        MMINITL = +0
  8070         MOVE ER-0276                TO  EMI-ERROR
  8071         MOVE -1                     TO  MAINTL
  8072         MOVE AL-UABON               TO  MAINTA
  8073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8074         GO TO 8110-SEND-DATA.
  8075
  8076     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8077     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8078     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8079     MOVE PI-CERT-NO                 TO  CERT-NO.
  8080
  8081
  8082* EXEC CICS READ
  8083*        DATASET   (CLMS-FILE-ID)
  8084*        RIDFLD    (MSTR-KEY)
  8085*        SET       (ADDRESS OF CLAIM-MASTER)
  8086*    END-EXEC.
  8087*    MOVE '&"S        E          (   #00007932' TO DFHEIV0
  8088     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8090     MOVE X'2020233030303037393332' TO DFHEIV0(25:11)
  8091     CALL 'kxdfhei1' USING DFHEIV0,
  8092           CLMS-FILE-ID,
  8093           DFHEIV20,
  8094           DFHEIV99,
  8095           MSTR-KEY,
  8096           DFHEIV99,
  8097           DFHEIV99,
  8098           DFHEIV99
  8099     SET ADDRESS OF CLAIM-MASTER TO
  8100         DFHEIV20
  8101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8102
  8103
  8104
  8105* EXEC CICS GETMAIN
  8106*        SET       (ADDRESS OF ALPHA-INDEX)
  8107*        LENGTH    (ALPH-LENGTH)
  8108*        INITIMG   (GETMAIN-SPACE)
  8109*    END-EXEC.
  8110*    MOVE ',"IL                  $   #00007938' TO DFHEIV0
  8111     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8112     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8113     MOVE X'2020233030303037393338' TO DFHEIV0(25:11)
  8114     CALL 'kxdfhei1' USING DFHEIV0,
  8115           DFHEIV20,
  8116           ALPH-LENGTH,
  8117           GETMAIN-SPACE
  8118     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 146
* EL131.cbl
  8119         DFHEIV20
  8120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8121
  8122
  8123     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  8124     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  8125     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  8126     MOVE CL-CERT-STATE          TO CERT-STATE
  8127     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  8128     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  8129     MOVE CL-CERT-NO             TO CERT-CERT
  8130
  8131
  8132* EXEC CICS READ
  8133*       DATASET   (CERT-FILE-ID)
  8134*       RIDFLD    (CERT-KEY)
  8135*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  8136*       RESP      (WS-RESPONSE)
  8137*    END-EXEC
  8138*    MOVE '&"S        E          (  N#00007952' TO DFHEIV0
  8139     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8140     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8141     MOVE X'204E233030303037393532' TO DFHEIV0(25:11)
  8142     CALL 'kxdfhei1' USING DFHEIV0,
  8143           CERT-FILE-ID,
  8144           DFHEIV20,
  8145           DFHEIV99,
  8146           CERT-KEY,
  8147           DFHEIV99,
  8148           DFHEIV99,
  8149           DFHEIV99
  8150     SET ADDRESS OF CERTIFICATE-MASTER TO
  8151         DFHEIV20
  8152     MOVE EIBRESP  TO WS-RESPONSE
  8153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8154
  8155     IF INSTYPEL > ZEROS
  8156        MOVE INSTYPEI TO CL-INSURED-TYPE
  8157     END-IF
  8158
  8159     IF MFNAMEL > +0
  8160        IF CL-INSURED-TYPE = 'C'
  8161          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  8162           MOVE ER-1675             TO EMI-ERROR
  8163           MOVE -1                  TO MFNAMEL
  8164           MOVE AL-UABON            TO MFNAMEA
  8165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8166           GO TO 8110-SEND-DATA
  8167        ELSE
  8168          IF CL-INSURED-TYPE = 'P'
  8169            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  8170             MOVE ER-1676             TO EMI-ERROR
  8171             MOVE -1                  TO MFNAMEL
  8172             MOVE AL-UABON            TO MFNAMEA
  8173             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8174             GO TO 8110-SEND-DATA
  8175          END-IF
  8176        END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 147
* EL131.cbl
  8177     END-IF
  8178     MOVE 'AI'                       TO  AI-RECORD-ID.
  8179     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8180                                         AI-CL-COMPANY-CD.
  8181     MOVE 'C'                        TO  AI-SOURCE
  8182                                         AI-CL-SOURCE.
  8183
  8184     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8185     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8186     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8187
  8188     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8189     MOVE '5'                        TO  DC-OPTION-CODE.
  8190     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8191     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8192     IF BUILD-YEAR IS GREATER THAN 50
  8193         MOVE '19'                   TO  WS-ALPHA-YY-1
  8194         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8195         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8196         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8197     ELSE
  8198         MOVE '20'                   TO  WS-ALPHA-YY-1
  8199         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8200         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8201         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8202
  8203     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8204                                         AI-CL-DATE.
  8205
  8206     MOVE EIBTIME                    TO  AI-TIME
  8207                                         AI-CL-TIME.
  8208
  8209     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8210     MOVE 'C'                        TO  AI-CL-SOURCE.
  8211     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8212     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8213     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8214     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8215     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8216
  8217     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8218     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8219     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8220
  8221     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8222         MOVE 'Y'                TO CL-YESNOSW
  8223     END-IF.
  8224
  8225
  8226* EXEC CICS WRITE
  8227*        DATASET   (ALPH-FILE-ID)
  8228*        RIDFLD    (AI-CONTROL-PRIMARY)
  8229*        FROM      (ALPHA-INDEX)
  8230*    END-EXEC.
  8231     MOVE LENGTH OF
  8232      ALPHA-INDEX
  8233       TO DFHEIV11
  8234*    MOVE '&$ L                  ''   #00008029' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 148
* EL131.cbl
  8235     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8236     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8237     MOVE X'2020233030303038303239' TO DFHEIV0(25:11)
  8238     CALL 'kxdfhei1' USING DFHEIV0,
  8239           ALPH-FILE-ID,
  8240           ALPHA-INDEX,
  8241           DFHEIV11,
  8242           AI-CONTROL-PRIMARY,
  8243           DFHEIV99,
  8244           DFHEIV99
  8245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8246
  8247
  8248
  8249* EXEC CICS READ
  8250*        DATASET   (CLMS-FILE-ID)
  8251*        RIDFLD    (MSTR-KEY)
  8252*        SET       (ADDRESS OF CLAIM-MASTER)
  8253*        UPDATE
  8254*    END-EXEC.
  8255*    MOVE '&"S        EU         (   #00008035' TO DFHEIV0
  8256     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8257     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8258     MOVE X'2020233030303038303335' TO DFHEIV0(25:11)
  8259     CALL 'kxdfhei1' USING DFHEIV0,
  8260           CLMS-FILE-ID,
  8261           DFHEIV20,
  8262           DFHEIV99,
  8263           MSTR-KEY,
  8264           DFHEIV99,
  8265           DFHEIV99,
  8266           DFHEIV99
  8267     SET ADDRESS OF CLAIM-MASTER TO
  8268         DFHEIV20
  8269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8270
  8271
  8272     if (cl-priority-cd = '8')
  8273        and (pi-processor-id not = 'PEMA'and 'JMS '
  8274             AND 'AMWA' AND 'KMSB')
  8275        MOVE ER-8003             TO EMI-ERROR
  8276        PERFORM 9900-ERROR-FORMAT
  8277                                 THRU 9900-EXIT
  8278        MOVE -1                  TO MAINTL
  8279        GO TO 8110-SEND-DATA
  8280     end-if
  8281
  8282     IF MLNAMEL IS GREATER THAN +0
  8283         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8284
  8285     IF MFNAMEL IS GREATER THAN +0
  8286         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8287
  8288     IF MMINITL IS GREATER THAN +0
  8289         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
  8290
  8291     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8292     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 149
* EL131.cbl
  8293     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8294     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8295
  8296     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8297         MOVE 'Y'                TO CL-YESNOSW
  8298     END-IF.
  8299
  8300
  8301* EXEC CICS HANDLE CONDITION
  8302*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8303*    END-EXEC.
  8304*    MOVE '"$$                   ! $ #00008070' TO DFHEIV0
  8305     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8307     MOVE X'2420233030303038303730' TO DFHEIV0(25:11)
  8308     CALL 'kxdfhei1' USING DFHEIV0
  8309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8310
  8311
  8312
  8313* EXEC CICS REWRITE
  8314*        DATASET   (CLMS-FILE-ID)
  8315*        FROM      (CLAIM-MASTER)
  8316*    END-EXEC.
  8317     MOVE LENGTH OF
  8318      CLAIM-MASTER
  8319       TO DFHEIV11
  8320*    MOVE '&& L                  %   #00008074' TO DFHEIV0
  8321     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8322     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8323     MOVE X'2020233030303038303734' TO DFHEIV0(25:11)
  8324     CALL 'kxdfhei1' USING DFHEIV0,
  8325           CLMS-FILE-ID,
  8326           CLAIM-MASTER,
  8327           DFHEIV11,
  8328           DFHEIV99
  8329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8330
  8331
  8332 0600-CONTINUE-NAME-UPDATE.
  8333
  8334     MOVE LOW-VALUES                 TO  EL131AO.
  8335     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8336     MOVE ER-0000                    TO  EMI-ERROR.
  8337     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8338     MOVE -1                         TO  MAINTL.
  8339     GO TO 8100-SEND-MAP.
  8340
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 150
* EL131.cbl
  8342 1000-EDIT-SCREEN.
  8343
  8344     MOVE MAINTI                 TO CHECK-MAINT.
  8345
  8346     IF NOT VALID-OPTIONS
  8347         MOVE 'X'                TO ERROR-SWITCH
  8348         MOVE -1                 TO MAINTL
  8349         MOVE AL-UABON           TO MAINTA
  8350         MOVE ER-0023            TO EMI-ERROR
  8351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8352         GO TO 1010-EXIT.
  8353
  8354     IF NOT MODIFY-CAP
  8355         MOVE 'UPDATE'           TO  SM-READ
  8356         PERFORM 9995-SECURITY-VIOLATION
  8357         MOVE ER-0070               TO  EMI-ERROR
  8358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8359         GO TO 8100-SEND-MAP.
  8360
  8361     IF DELETE-CLAIM
  8362         MOVE AL-UANON TO MAINTA
  8363         GO TO 1010-EXIT.
  8364
  8365     MOVE AL-UANON               TO MAINTA.
  8366
  8367     IF CCNOI GREATER THAN LOW-VALUES
  8368         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8369
  8370     IF PI-COMPANY-ID = 'CSL'
  8371        CONTINUE
  8372     ELSE
  8373        IF TYPEL > ZERO
  8374           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8375              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8376                    PI-LIFE-OVERRIDE-L1 OR 'O'))
  8377                       OR
  8378              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8379              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8380                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F' OR 'O'))
  8381              MOVE AL-UANON      TO TYPEA
  8382              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8383           ELSE
  8384              MOVE ER-0199       TO EMI-ERROR
  8385              PERFORM 9900-ERROR-FORMAT
  8386                                 THRU 9900-EXIT
  8387              MOVE AL-UABON      TO TYPEA
  8388              MOVE -1            TO TYPEL
  8389              MOVE 'X'           TO ERROR-SWITCH
  8390           END-IF
  8391        ELSE
  8392           MOVE AL-UANOF         TO TYPEA
  8393        END-IF
  8394     END-IF
  8395     IF STATUSI GREATER THAN LOW-VALUES
  8396         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8397             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8398             MOVE AL-UANON       TO STATUSA
  8399             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 151
* EL131.cbl
  8400             MOVE 'Y'            TO DLYACTV-SW
  8401         ELSE
  8402             MOVE ER-0333        TO EMI-ERROR
  8403             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8404             MOVE AL-UABON       TO STATUSA
  8405             MOVE -1             TO STATUSL
  8406             MOVE 'X'            TO ERROR-SWITCH
  8407         END-IF
  8408     ELSE
  8409         MOVE SPACE              TO TRLR-SWITCH
  8410         MOVE 'N'                TO DLYACTV-SW
  8411         MOVE AL-UANOF           TO STATUSA.
  8412
  8413     IF PROCI GREATER THAN LOW-VALUES
  8414         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8415     ELSE
  8416         MOVE AL-UANOF TO PROCA.
  8417
  8418     IF SEXI GREATER THAN LOW-VALUES
  8419         IF SEXI = 'F' OR 'M'
  8420             MOVE AL-UANON       TO SEXA
  8421             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8422           ELSE
  8423             MOVE ER-0219        TO EMI-ERROR
  8424             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8425             MOVE AL-UABON       TO SEXA
  8426             MOVE -1             TO SEXL
  8427             MOVE 'X'            TO ERROR-SWITCH
  8428       ELSE
  8429         MOVE AL-UANOF           TO SEXA.
  8430
  8431     IF BIRTHL = +0
  8432         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8433         MOVE AL-UANOF           TO  BIRTHA
  8434         GO TO 1000-CONTINUE-EDITS.
  8435
  8436     IF BIRTHI = SPACES
  8437         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8438         MOVE 'X'                TO  UPDATE-SWITCH
  8439                                     MSTR-SWITCH
  8440         GO TO 1000-CONTINUE-EDITS.
  8441
  8442     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8443     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8444     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8445     MOVE '4'                    TO  DC-OPTION-CODE.
  8446     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8447     IF DATE-CONVERSION-ERROR
  8448         MOVE ER-0220            TO  EMI-ERROR
  8449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8450         MOVE AL-UABON           TO  BIRTHA
  8451         MOVE -1                 TO  BIRTHL
  8452         MOVE 'X'                TO  ERROR-SWITCH
  8453         GO TO 1000-CONTINUE-EDITS.
  8454
  8455******************************************************************
  8456**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8457**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 152
* EL131.cbl
  8458**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8459******************************************************************
  8460     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8461         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8462         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8463         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8464         MOVE '4'                TO  DC-OPTION-CODE
  8465         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8466         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8467                                     DC-ELAPSED-DAYS
  8468         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8469         IF DATE-CONVERSION-ERROR
  8470             MOVE ER-0220        TO  EMI-ERROR
  8471             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8472             MOVE AL-UABON       TO  BIRTHA
  8473             MOVE -1             TO  BIRTHL
  8474             MOVE 'X'            TO  ERROR-SWITCH
  8475             GO TO 1000-CONTINUE-EDITS.
  8476
  8477     MOVE AL-UANON               TO  BIRTHA.
  8478     MOVE 'X'                    TO  UPDATE-SWITCH
  8479                                     MSTR-SWITCH.
  8480     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8481     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8482     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8483
  8484 1000-CONTINUE-EDITS.
  8485
  8486     IF SOCIALI GREATER THAN LOW-VALUES
  8487         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8488         IF WS-SOC-SEC-NO NUMERIC AND
  8489           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8490             NEXT SENTENCE
  8491         ELSE
  8492            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8493               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8494               WS-SSN-DASH2 = '-'
  8495                 NEXT SENTENCE
  8496            ELSE
  8497                 MOVE ER-0887        TO  EMI-ERROR
  8498                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8499                 MOVE AL-UABON       TO  SOCIALA
  8500                 MOVE -1             TO  SOCIALL
  8501                 MOVE 'X'            TO  ERROR-SWITCH
  8502            END-IF
  8503        END-IF
  8504     END-IF.
  8505     if critpl > zeros
  8506        and critpi numeric
  8507        move al-uanon            to critpa
  8508        move 'X'                 to update-switch
  8509     end-if
  8510     IF SOCIALI GREATER THAN LOW-VALUES
  8511         MOVE AL-UANON           TO SOCIALA
  8512         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8513     ELSE
  8514         MOVE AL-UANOF           TO SOCIALA.
  8515
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 153
* EL131.cbl
  8516     IF OCCI GREATER THAN LOW-VALUES
  8517         MOVE AL-UANON           TO OCCA
  8518         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8519     ELSE
  8520         MOVE AL-UANOF           TO OCCA.
  8521
  8522     IF BENEL NOT GREATER THAN ZERO
  8523            GO TO 1005-CONTINUE-EDITS.
  8524
  8525     IF BENEI = SPACES
  8526        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8527           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8528           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8529           IF AUTO-PAY-TO-BENE = 'Y'
  8530               MOVE ER-1773      TO  EMI-ERROR
  8531               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8532               MOVE 'X'          TO ERROR-SWITCH
  8533               MOVE AL-UABON     TO BENEA
  8534               MOVE -1           TO BENEL
  8535           ELSE
  8536               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8537           END-IF
  8538        ELSE
  8539           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8540           IF PAYMENT-PENDING
  8541               MOVE ER-1772      TO  EMI-ERROR
  8542               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8543               MOVE 'X'          TO ERROR-SWITCH
  8544               MOVE AL-UABON     TO BENEA
  8545               MOVE -1           TO BENEL
  8546           END-IF
  8547           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8548        END-IF
  8549        GO TO 1005-CONTINUE-EDITS.
  8550
  8551
  8552* EXEC CICS HANDLE CONDITION
  8553*        NOTFND (1004-BENE-NOT-FOUND)
  8554*    END-EXEC.
  8555*    MOVE '"$I                   ! % #00008298' TO DFHEIV0
  8556     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8558     MOVE X'2520233030303038323938' TO DFHEIV0(25:11)
  8559     CALL 'kxdfhei1' USING DFHEIV0
  8560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8561
  8562
  8563     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8564     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8565     MOVE BENEI                  TO  WS-ELBENE-ID.
  8566
  8567
  8568* EXEC CICS READ
  8569*        DATASET ('ELBENE')
  8570*        RIDFLD  (WS-ELBENE-KEY)
  8571*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8572*    END-EXEC.
  8573     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 154
* EL131.cbl
  8574*    MOVE '&"S        E          (   #00008306' TO DFHEIV0
  8575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8576     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8577     MOVE X'2020233030303038333036' TO DFHEIV0(25:11)
  8578     CALL 'kxdfhei1' USING DFHEIV0,
  8579           DFHEIV1,
  8580           DFHEIV20,
  8581           DFHEIV99,
  8582           WS-ELBENE-KEY,
  8583           DFHEIV99,
  8584           DFHEIV99,
  8585           DFHEIV99
  8586     SET ADDRESS OF BENEFICIARY-MASTER TO
  8587         DFHEIV20
  8588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8589
  8590
  8591     MOVE AL-UANON               TO  BENEA.
  8592     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8593
  8594     GO TO 1005-CONTINUE-EDITS.
  8595
  8596 1004-BENE-NOT-FOUND.
  8597     MOVE ER-0565                TO  EMI-ERROR.
  8598
  8599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8600     MOVE 'X'                    TO ERROR-SWITCH.
  8601     MOVE AL-UABON               TO BENEA.
  8602     MOVE -1                     TO BENEL.
  8603
  8604 1005-CONTINUE-EDITS.
  8605
  8606     IF DIAGI GREATER THAN LOW-VALUES
  8607         MOVE AL-UANON           TO DIAGA
  8608         MOVE 'X'                TO UPDATE-SWITCH
  8609                                    NINETY-TRLR-SWITCH
  8610     ELSE
  8611         MOVE AL-UANOF           TO DIAGA.
  8612
  8613     IF ICD1I GREATER THAN LOW-VALUES
  8614         IF (ICD1I GREATER THAN SPACES) AND
  8615            (ICD1I(4:1) NOT = '.')
  8616             IF ICD1I(4:1) = ' '
  8617                 MOVE '.' TO ICD1I(4:1)
  8618             ELSE
  8619                 IF ICD1I(8:1) = ' '
  8620                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8621                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8622                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8623                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8624                     MOVE '.'        TO ICD1I(4:1)
  8625                 END-IF
  8626             END-IF
  8627         END-IF
  8628         IF (ICD1I GREATER THAN SPACES) AND
  8629            (ICD1I(1:1) NOT > ' ' OR
  8630             ICD1I(2:1) NOT > ' ' OR
  8631             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 155
* EL131.cbl
  8632             ICD1I(4:1) NOT = '.')
  8633              MOVE ER-0992        TO  EMI-ERROR
  8634              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8635              MOVE 'X'            TO ERROR-SWITCH
  8636              MOVE AL-UABON       TO ICD1A
  8637              MOVE -1             TO ICD1L
  8638         ELSE
  8639             MOVE AL-UANON       TO ICD1A
  8640             MOVE 'X'            TO UPDATE-SWITCH
  8641                                    NINETY-TRLR-SWITCH
  8642         END-IF
  8643     ELSE
  8644         MOVE AL-UANOF           TO ICD1A
  8645     END-IF.
  8646
  8647     IF ICD2I GREATER THAN LOW-VALUES
  8648         IF (ICD2I GREATER THAN SPACES) AND
  8649            (ICD2I(4:1) NOT = '.')
  8650             IF ICD2I(4:1) = ' '
  8651                 MOVE '.' TO ICD2I(4:1)
  8652             ELSE
  8653                 IF ICD2I(8:1) = ' '
  8654                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8655                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8656                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8657                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8658                     MOVE '.'        TO ICD2I(4:1)
  8659                 END-IF
  8660             END-IF
  8661         END-IF
  8662         IF (ICD2I GREATER THAN SPACES) AND
  8663            (ICD2I(1:1) NOT > ' ' OR
  8664             ICD2I(2:1) NOT > ' ' OR
  8665             ICD2I(3:1) NOT > ' ' OR
  8666             ICD2I(4:1) NOT = '.')
  8667              MOVE ER-0992        TO EMI-ERROR
  8668              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8669              MOVE 'X'            TO ERROR-SWITCH
  8670              MOVE AL-UABON       TO ICD2A
  8671              MOVE -1             TO ICD2L
  8672         ELSE
  8673             MOVE AL-UANON       TO ICD2A
  8674             MOVE 'X'            TO UPDATE-SWITCH
  8675                                    NINETY-TRLR-SWITCH
  8676         END-IF
  8677     ELSE
  8678         MOVE AL-UANOF           TO ICD2A
  8679     END-IF.
  8680
  8681*    IF CAUSEI GREATER THAN LOW-VALUES
  8682*        MOVE AL-UANON           TO CAUSEA
  8683*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8684*    ELSE
  8685*        MOVE AL-UANOF           TO CAUSEA.
  8686
  8687*    IF ENDL GREATER THAN ZERO
  8688*        MOVE LOW-VALUES         TO HOLD-END
  8689*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 156
* EL131.cbl
  8690*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8691*        ELSE
  8692*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8693*            EXEC CICS BIF DEEDIT
  8694*                FIELD    (DEEDIT-DATE-INPUT)
  8695*                LENGTH   (DATE-LENGTH)
  8696*            END-EXEC
  8697*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8698*            MOVE '4'            TO DC-OPTION-CODE
  8699*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8700*            IF NOT DATE-CONVERSION-ERROR
  8701*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8702*                MOVE AL-UANON   TO ENDA
  8703*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8704*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8705*            ELSE
  8706*                MOVE ER-0224    TO EMI-ERROR
  8707*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8708*                MOVE AL-UABON   TO ENDA
  8709*                MOVE -1         TO ENDL
  8710*                MOVE 'X'        TO ERROR-SWITCH
  8711*      ELSE
  8712*          MOVE AL-UANOF         TO ENDA.
  8713
  8714     IF INCL GREATER THAN ZERO
  8715         MOVE LOW-VALUES         TO HOLD-INCUR
  8716         IF INCI = SPACES
  8717             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8718         ELSE
  8719             MOVE INCI           TO DEEDIT-DATE-INPUT
  8720
  8721* EXEC CICS BIF DEEDIT
  8722*                FIELD    (DEEDIT-DATE-INPUT)
  8723*                LENGTH   (DATE-LENGTH)
  8724*            END-EXEC
  8725*    MOVE '@"L                   #   #00008441' TO DFHEIV0
  8726     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8727     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8728     MOVE X'2020233030303038343431' TO DFHEIV0(25:11)
  8729     CALL 'kxdfhei1' USING DFHEIV0,
  8730           DEEDIT-DATE-INPUT,
  8731           DATE-LENGTH
  8732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8733             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8734             MOVE '4'            TO DC-OPTION-CODE
  8735             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8736             IF NOT DATE-CONVERSION-ERROR
  8737                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8738                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8739                 MOVE AL-UANON           TO INCA
  8740                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8741             ELSE
  8742                 MOVE ER-0222    TO EMI-ERROR
  8743                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8744                 MOVE AL-UABON   TO INCA
  8745                 MOVE -1         TO INCL
  8746                 MOVE 'X'        TO ERROR-SWITCH
  8747       ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 157
* EL131.cbl
  8748           IF PI-NO-PMTS = ZEROS
  8749               MOVE AL-UANOF     TO INCA.
  8750
  8751     IF REPL GREATER THAN ZERO
  8752         MOVE LOW-VALUES         TO HOLD-REPORTED
  8753         IF REPI = SPACES
  8754             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8755         ELSE
  8756             MOVE REPI           TO DEEDIT-DATE-INPUT
  8757
  8758* EXEC CICS BIF DEEDIT
  8759*                FIELD    (DEEDIT-DATE-INPUT)
  8760*                LENGTH   (DATE-LENGTH)
  8761*            END-EXEC
  8762*    MOVE '@"L                   #   #00008469' TO DFHEIV0
  8763     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8764     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8765     MOVE X'2020233030303038343639' TO DFHEIV0(25:11)
  8766     CALL 'kxdfhei1' USING DFHEIV0,
  8767           DEEDIT-DATE-INPUT,
  8768           DATE-LENGTH
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8770             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8771             MOVE '4'            TO DC-OPTION-CODE
  8772             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8773             IF NOT DATE-CONVERSION-ERROR
  8774                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8775                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8776                 MOVE AL-UANON   TO REPA
  8777                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8778             ELSE
  8779                 MOVE ER-0223    TO EMI-ERROR
  8780                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8781                 MOVE AL-UABON   TO REPA
  8782                 MOVE -1         TO REPL
  8783                 MOVE 'X'        TO ERROR-SWITCH
  8784       ELSE
  8785         MOVE AL-UANOF TO REPA.
  8786
  8787     IF PDTHRUI GREATER THAN LOW-VALUES
  8788        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8789        IF PDTHRUI = SPACES
  8790           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8791        ELSE
  8792           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8793
  8794* EXEC CICS BIF DEEDIT
  8795*               FIELD    (DEEDIT-DATE-INPUT)
  8796*               LENGTH   (DATE-LENGTH)
  8797*          END-EXEC
  8798*    MOVE '@"L                   #   #00008496' TO DFHEIV0
  8799     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8800     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8801     MOVE X'2020233030303038343936' TO DFHEIV0(25:11)
  8802     CALL 'kxdfhei1' USING DFHEIV0,
  8803           DEEDIT-DATE-INPUT,
  8804           DATE-LENGTH
  8805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 158
* EL131.cbl
  8806           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8807           MOVE '4'            TO DC-OPTION-CODE
  8808           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8809           IF NOT DATE-CONVERSION-ERROR
  8810              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8811              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8812              MOVE AL-UANON   TO PDTHRUA
  8813              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8814              IF PI-USES-PAID-TO
  8815                 MOVE '6'            TO DC-OPTION-CODE
  8816                 MOVE -1             TO DC-ELAPSED-DAYS
  8817                 MOVE +0             TO DC-ELAPSED-MONTHS
  8818                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8819                 IF NO-CONVERSION-ERROR
  8820                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8821                 ELSE
  8822                    NEXT SENTENCE
  8823              ELSE
  8824                 NEXT SENTENCE
  8825           ELSE
  8826              MOVE ER-0475    TO EMI-ERROR
  8827              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8828              MOVE AL-UABON   TO PDTHRUA
  8829              MOVE -1         TO PDTHRUL
  8830              MOVE 'X'        TO ERROR-SWITCH
  8831     ELSE
  8832        IF MODIFY-CAP
  8833           MOVE AL-UANOF        TO PDTHRUA.
  8834
  8835     IF PDAMTL GREATER THAN +0
  8836         MOVE ZEROS              TO HOLD-PDAMT
  8837
  8838* EXEC CICS BIF DEEDIT
  8839*            FIELD    (PDAMTI)
  8840*            LENGTH   (9)
  8841*        END-EXEC
  8842     MOVE 9
  8843       TO DFHEIV11
  8844*    MOVE '@"L                   #   #00008531' TO DFHEIV0
  8845     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8846     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8847     MOVE X'2020233030303038353331' TO DFHEIV0(25:11)
  8848     CALL 'kxdfhei1' USING DFHEIV0,
  8849           PDAMTI,
  8850           DFHEIV11
  8851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8852         IF PDAMTI NUMERIC
  8853             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8854             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8855             MOVE AL-UNNON       TO PDAMTA
  8856         ELSE
  8857             MOVE ER-0547        TO EMI-ERROR
  8858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8859             MOVE AL-UNBON       TO PDAMTA
  8860             MOVE -1             TO PDAMTL
  8861             MOVE 'X'            TO ERROR-SWITCH
  8862     ELSE
  8863         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 159
* EL131.cbl
  8864            MOVE AL-UNNOF        TO PDAMTA.
  8865
  8866     IF NODAYSI GREATER THAN LOW-VALUES
  8867         MOVE ZEROS              TO HOLD-NODAYS
  8868
  8869* EXEC CICS BIF DEEDIT
  8870*            FIELD (NODAYSI)
  8871*            LENGTH (5)
  8872*        END-EXEC
  8873     MOVE 5
  8874       TO DFHEIV11
  8875*    MOVE '@"L                   #   #00008551' TO DFHEIV0
  8876     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8877     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8878     MOVE X'2020233030303038353531' TO DFHEIV0(25:11)
  8879     CALL 'kxdfhei1' USING DFHEIV0,
  8880           NODAYSI,
  8881           DFHEIV11
  8882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8883         IF NODAYSI NUMERIC
  8884             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8885             MOVE AL-UNNON       TO NODAYSA
  8886             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8887         ELSE
  8888             MOVE ER-0491        TO EMI-ERROR
  8889             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8890             MOVE AL-UNBON       TO NODAYSA
  8891             MOVE -1             TO NODAYSL
  8892             MOVE 'X'            TO ERROR-SWITCH
  8893     ELSE
  8894         IF MODIFY-CAP
  8895            MOVE AL-UNNOF        TO NODAYSA.
  8896
  8897     IF NOPMTSI GREATER THAN LOW-VALUES
  8898         MOVE ZEROS              TO HOLD-NOPMTS
  8899
  8900* EXEC CICS BIF DEEDIT
  8901*            FIELD (NOPMTSI)
  8902*            LENGTH (4)
  8903*        END-EXEC
  8904     MOVE 4
  8905       TO DFHEIV11
  8906*    MOVE '@"L                   #   #00008571' TO DFHEIV0
  8907     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8908     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8909     MOVE X'2020233030303038353731' TO DFHEIV0(25:11)
  8910     CALL 'kxdfhei1' USING DFHEIV0,
  8911           NOPMTSI,
  8912           DFHEIV11
  8913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8914         IF NOPMTSI NUMERIC
  8915             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8916             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8917             MOVE AL-UNNON       TO NOPMTSA
  8918           ELSE
  8919             MOVE ER-0548        TO EMI-ERROR
  8920             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8921             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 160
* EL131.cbl
  8922             MOVE -1             TO NOPMTSL
  8923             MOVE 'X'            TO ERROR-SWITCH
  8924       ELSE
  8925         IF MODIFY-CAP
  8926            MOVE AL-UNNOF        TO NOPMTSA.
  8927
  8928     IF FORMTYPI GREATER THAN LOW-VALUES
  8929         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8930             MOVE AL-UANON       TO FORMTYPA
  8931             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8932           ELSE
  8933             MOVE ER-7650        TO EMI-ERROR
  8934             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8935             MOVE AL-UABON       TO FORMTYPA
  8936             MOVE -1             TO FORMTYPL
  8937             MOVE 'X'            TO ERROR-SWITCH
  8938       ELSE
  8939         MOVE AL-UANOF           TO FORMTYPA.
  8940
  8941     IF PRICDL GREATER THAN ZERO
  8942         IF (PRICDI = ' ') OR
  8943            (PRICDI GREATER THAN ZERO   AND
  8944             PRICDI NOT GREATER THAN '9')
  8945             MOVE AL-UANON       TO PRICDA
  8946             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8947         ELSE
  8948             MOVE ER-0274        TO EMI-ERROR
  8949             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8950             MOVE AL-UABON       TO PRICDA
  8951             MOVE -1             TO PRICDL
  8952             MOVE 'X'            TO ERROR-SWITCH
  8953     ELSE
  8954         MOVE AL-UANOF TO PRICDA.
  8955
  8956     IF PI-COMPANY-ID = 'DMD'
  8957     IF PRICDL GREATER THAN ZERO
  8958       IF SYSTEM-MODIFY-CAP  OR
  8959          PI-PROCESSOR-ID = 'LGXX'
  8960             NEXT SENTENCE
  8961           ELSE
  8962            IF CL-PRIORITY-CD = '9'  OR
  8963               PRICDI         = '9'
  8964                  MOVE ER-0938        TO EMI-ERROR
  8965                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8966                  MOVE AL-UABON       TO PRICDA
  8967                  MOVE -1             TO PRICDL
  8968                  MOVE 'X'            TO ERROR-SWITCH.
  8969
  8970     IF FILETOL GREATER THAN ZERO
  8971         MOVE AL-UANON           TO FILETOA
  8972         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8973     ELSE
  8974         MOVE AL-UANOF TO FILETOA.
  8975
  8976     IF SUPVL GREATER THAN ZERO
  8977         IF SUPVI = 'Y' OR 'N' OR SPACE
  8978             MOVE AL-UANON       TO SUPVA
  8979             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 161
* EL131.cbl
  8980         ELSE
  8981             MOVE ER-0230        TO EMI-ERROR
  8982             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8983             MOVE AL-UABON       TO SUPVA
  8984             MOVE -1             TO SUPVL
  8985             MOVE 'X'            TO ERROR-SWITCH
  8986     ELSE
  8987         MOVE AL-UANOF           TO SUPVA.
  8988
  8989     IF MLNAMEL GREATER THAN ZERO
  8990         IF MLNAMEI GREATER THAN SPACES
  8991            MOVE AL-UANON        TO MLNAMEA
  8992            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8993                                     MSTR-KEY-SWITCH
  8994         ELSE
  8995            MOVE ER-0236         TO EMI-ERROR
  8996            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8997            MOVE AL-UABON        TO MLNAMEA
  8998            MOVE -1              TO MLNAMEL
  8999            MOVE 'X'             TO ERROR-SWITCH
  9000     ELSE
  9001         MOVE AL-UANOF           TO MLNAMEA.
  9002
  9003     IF MFNAMEI GREATER THAN LOW-VALUES
  9004         MOVE AL-UANON           TO MFNAMEA
  9005         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  9006     ELSE
  9007         MOVE AL-UANOF           TO MFNAMEA.
  9008
  9009     IF MMINITI GREATER THAN LOW-VALUES
  9010         MOVE AL-UANON           TO MMINITA
  9011         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  9012     ELSE
  9013         MOVE AL-UANOF           TO MMINITA.
  9014
  9015     IF CRTLNMEI GREATER THAN LOW-VALUES
  9016         IF CRTLNMEI NOT = SPACES
  9017            MOVE AL-UANON        TO CRTLNMEA
  9018            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  9019                                     CERT-KEY-SWITCH
  9020        ELSE
  9021            MOVE ER-0236         TO EMI-ERROR
  9022            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9023            MOVE AL-UABON        TO CRTLNMEA
  9024            MOVE -1              TO CRTLNMEL
  9025            MOVE 'X'             TO ERROR-SWITCH
  9026     ELSE
  9027         MOVE AL-UANOF           TO CRTLNMEA.
  9028
  9029     IF CRTFNMEI GREATER THAN LOW-VALUES
  9030         MOVE AL-UANON           TO CRTFNMEA
  9031         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9032     ELSE
  9033         MOVE AL-UANOF           TO CRTFNMEA.
  9034
  9035     IF CRTINITI GREATER THAN LOW-VALUES
  9036         MOVE AL-UANON           TO CRTINITA
  9037         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 162
* EL131.cbl
  9038     ELSE
  9039         MOVE AL-UANOF           TO CRTINITA.
  9040
  9041     IF ISSAGEL GREATER THAN ZERO
  9042         IF ISSAGEI NUMERIC
  9043            MOVE AL-UANON        TO ISSAGEA
  9044            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9045         ELSE
  9046            MOVE ER-0237         TO EMI-ERROR
  9047            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9048            MOVE AL-UABON        TO ISSAGEA
  9049            MOVE -1              TO ISSAGEL
  9050            MOVE 'X'             TO ERROR-SWITCH
  9051     ELSE
  9052         MOVE AL-UANOF           TO ISSAGEA.
  9053
  9054     IF JNTFNMEI GREATER THAN LOW-VALUES
  9055         MOVE AL-UANON           TO JNTFNMEA
  9056         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9057     ELSE
  9058         MOVE AL-UANOF           TO JNTFNMEA.
  9059
  9060     IF JNTLNMEI GREATER THAN LOW-VALUES
  9061         MOVE AL-UANON           TO JNTLNMEA
  9062         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9063     ELSE
  9064         MOVE AL-UANOF           TO JNTLNMEA.
  9065
  9066     IF JNTINITI GREATER THAN LOW-VALUES
  9067         MOVE AL-UANON           TO JNTINITA
  9068         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9069     ELSE
  9070         MOVE AL-UANOF           TO JNTINITA.
  9071
  9072     IF JNTAGEL GREATER THAN ZERO
  9073         IF JNTAGEI NUMERIC
  9074            MOVE AL-UANON        TO JNTAGEA
  9075            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9076         ELSE
  9077            MOVE ER-0238         TO EMI-ERROR
  9078            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9079            MOVE AL-UABON        TO JNTAGEA
  9080            MOVE -1              TO JNTAGEL
  9081            MOVE 'X'             TO ERROR-SWITCH
  9082     ELSE
  9083         MOVE AL-UANOF           TO JNTAGEA.
  9084
  9085     IF ADDONDTI GREATER THAN LOW-VALUES
  9086         MOVE LOW-VALUES         TO HOLD-ADDON
  9087         IF ADDONDTI = SPACES
  9088             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  9089         ELSE
  9090             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  9091
  9092* EXEC CICS BIF DEEDIT
  9093*                FIELD    (DEEDIT-DATE-INPUT)
  9094*                LENGTH   (DATE-LENGTH)
  9095*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 163
* EL131.cbl
  9096*    MOVE '@"L                   #   #00008752' TO DFHEIV0
  9097     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9098     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9099     MOVE X'2020233030303038373532' TO DFHEIV0(25:11)
  9100     CALL 'kxdfhei1' USING DFHEIV0,
  9101           DEEDIT-DATE-INPUT,
  9102           DATE-LENGTH
  9103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9104             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9105             MOVE '4'            TO DC-OPTION-CODE
  9106             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9107             IF NOT DATE-CONVERSION-ERROR
  9108                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  9109                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  9110                                                  CERT-SWITCH
  9111                 MOVE AL-UANON   TO ADDONDTA
  9112                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  9113             ELSE
  9114                 MOVE ER-7651    TO EMI-ERROR
  9115                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9116                 MOVE AL-UABON   TO ADDONDTA
  9117                 MOVE -1         TO ADDONDTL
  9118                 MOVE 'X'        TO ERROR-SWITCH
  9119       ELSE
  9120         MOVE AL-UANOF TO ADDONDTA.
  9121
  9122     IF LCVCDI GREATER THAN LOW-VALUES
  9123         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9124         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9125     ELSE
  9126         MOVE AL-UANOF           TO LCVCDA.
  9127
  9128     IF ACVCDI GREATER THAN LOW-VALUES
  9129         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9130         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9131     ELSE
  9132         MOVE AL-UANOF           TO ACVCDA.
  9133
  9134     IF LCVOTRMI GREATER THAN LOW-VALUES
  9135
  9136* EXEC CICS BIF DEEDIT
  9137*            FIELD (LCVOTRMI)
  9138*            LENGTH(3)
  9139*        END-EXEC
  9140     MOVE 3
  9141       TO DFHEIV11
  9142*    MOVE '@"L                   #   #00008787' TO DFHEIV0
  9143     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9144     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9145     MOVE X'2020233030303038373837' TO DFHEIV0(25:11)
  9146     CALL 'kxdfhei1' USING DFHEIV0,
  9147           LCVOTRMI,
  9148           DFHEIV11
  9149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9150         IF LCVOTRMI IS NUMERIC
  9151             MOVE LCVOTRMI       TO LCVOTRMO
  9152             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9153             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 164
* EL131.cbl
  9154         ELSE
  9155             MOVE ER-0241        TO EMI-ERROR
  9156             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9157             MOVE AL-UNBON       TO LCVOTRMA
  9158             MOVE 'X'            TO ERROR-SWITCH
  9159             MOVE -1             TO LCVOTRML
  9160     ELSE
  9161         MOVE AL-UANOF           TO LCVOTRMA.
  9162
  9163     IF ACVOTRMI GREATER THAN LOW-VALUES
  9164
  9165* EXEC CICS BIF DEEDIT
  9166*            FIELD (ACVOTRMI)
  9167*            LENGTH(3)
  9168*        END-EXEC
  9169     MOVE 3
  9170       TO DFHEIV11
  9171*    MOVE '@"L                   #   #00008805' TO DFHEIV0
  9172     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9173     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9174     MOVE X'2020233030303038383035' TO DFHEIV0(25:11)
  9175     CALL 'kxdfhei1' USING DFHEIV0,
  9176           ACVOTRMI,
  9177           DFHEIV11
  9178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9179         IF ACVOTRMI IS NUMERIC
  9180             MOVE ACVOTRMI       TO ACVOTRMO
  9181             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9182             MOVE AL-UANON       TO ACVOTRMA
  9183         ELSE
  9184             MOVE ER-0241        TO EMI-ERROR
  9185             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9186             MOVE AL-UNBON       TO ACVOTRMA
  9187             MOVE 'X'            TO ERROR-SWITCH
  9188             MOVE -1             TO ACVOTRML
  9189     ELSE
  9190         MOVE AL-UANOF           TO ACVOTRMA.
  9191
  9192     IF LCVRATEL GREATER THAN +0
  9193
  9194* EXEC CICS BIF DEEDIT
  9195*            FIELD (LCVRATEI)
  9196*            LENGTH(6)
  9197*        END-EXEC
  9198     MOVE 6
  9199       TO DFHEIV11
  9200*    MOVE '@"L                   #   #00008823' TO DFHEIV0
  9201     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9202     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9203     MOVE X'2020233030303038383233' TO DFHEIV0(25:11)
  9204     CALL 'kxdfhei1' USING DFHEIV0,
  9205           LCVRATEI,
  9206           DFHEIV11
  9207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9208         IF LCVRATEI IS NUMERIC
  9209             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9210             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9211             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 165
* EL131.cbl
  9212         ELSE
  9213             MOVE ER-2280        TO EMI-ERROR
  9214             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9215             MOVE AL-UNBON       TO LCVRATEA
  9216             MOVE 'X'            TO ERROR-SWITCH
  9217             MOVE -1             TO LCVRATEL
  9218     ELSE
  9219         MOVE AL-UNNOF           TO LCVRATEA.
  9220
  9221     IF ACVRATEL GREATER THAN +0
  9222
  9223* EXEC CICS BIF DEEDIT
  9224*            FIELD (ACVRATEI)
  9225*            LENGTH(6)
  9226*        END-EXEC
  9227     MOVE 6
  9228       TO DFHEIV11
  9229*    MOVE '@"L                   #   #00008841' TO DFHEIV0
  9230     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9231     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9232     MOVE X'2020233030303038383431' TO DFHEIV0(25:11)
  9233     CALL 'kxdfhei1' USING DFHEIV0,
  9234           ACVRATEI,
  9235           DFHEIV11
  9236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9237         IF ACVRATEI IS NUMERIC
  9238             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9239             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9240             MOVE AL-UNNON       TO ACVRATEA
  9241         ELSE
  9242             MOVE ER-2280        TO EMI-ERROR
  9243             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9244             MOVE AL-UNBON       TO ACVRATEA
  9245             MOVE 'X'            TO ERROR-SWITCH
  9246             MOVE -1             TO ACVRATEL
  9247     ELSE
  9248         MOVE AL-UNNOF           TO ACVRATEA.
  9249
  9250     IF LCVBENEL GREATER THAN ZERO
  9251
  9252* EXEC CICS BIF DEEDIT
  9253*            FIELD (LCVBENEI)
  9254*            LENGTH (11)
  9255*        END-EXEC
  9256     MOVE 11
  9257       TO DFHEIV11
  9258*    MOVE '@"L                   #   #00008859' TO DFHEIV0
  9259     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9260     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9261     MOVE X'2020233030303038383539' TO DFHEIV0(25:11)
  9262     CALL 'kxdfhei1' USING DFHEIV0,
  9263           LCVBENEI,
  9264           DFHEIV11
  9265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9266         IF LCVBENEI IS NUMERIC
  9267            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9268            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9269            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 166
* EL131.cbl
  9270         ELSE
  9271            MOVE ER-0243         TO EMI-ERROR
  9272            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9273            MOVE AL-UNBON        TO LCVBENEA
  9274            MOVE -1              TO LCVBENEL
  9275            MOVE 'X'             TO ERROR-SWITCH
  9276     ELSE
  9277         MOVE AL-UANOF           TO LCVBENEA.
  9278
  9279     IF ACVBENEL GREATER THAN ZERO
  9280
  9281* EXEC CICS BIF DEEDIT
  9282*            FIELD (ACVBENEI)
  9283*            LENGTH (11)
  9284*        END-EXEC
  9285     MOVE 11
  9286       TO DFHEIV11
  9287*    MOVE '@"L                   #   #00008877' TO DFHEIV0
  9288     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9289     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9290     MOVE X'2020233030303038383737' TO DFHEIV0(25:11)
  9291     CALL 'kxdfhei1' USING DFHEIV0,
  9292           ACVBENEI,
  9293           DFHEIV11
  9294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9295         IF ACVBENEI IS NUMERIC
  9296            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9297            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9298            MOVE AL-UNNON        TO ACVBENEA
  9299         ELSE
  9300            MOVE ER-0243         TO EMI-ERROR
  9301            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9302            MOVE AL-UNBON        TO ACVBENEA
  9303            MOVE -1              TO ACVBENEL
  9304            MOVE 'X'             TO ERROR-SWITCH
  9305     ELSE
  9306         MOVE AL-UANOF           TO ACVBENEA.
  9307
  9308     IF LCVFORMI GREATER THAN LOW-VALUES
  9309        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9310        MOVE AL-UANON            TO LCVFORMA
  9311     ELSE
  9312        MOVE AL-UANOF            TO LCVFORMA.
  9313
  9314     IF ACVFORMI GREATER THAN LOW-VALUES
  9315        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9316        MOVE AL-UANON            TO ACVFORMA
  9317     ELSE
  9318        MOVE AL-UANOF            TO ACVFORMA.
  9319
  9320     IF LCVCNDTL GREATER THAN ZERO
  9321         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9322         IF LCVCNDTI = SPACES
  9323             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9324         ELSE
  9325             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9326             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9327             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 167
* EL131.cbl
  9328             MOVE '4'            TO DC-OPTION-CODE
  9329             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9330             IF NOT DATE-CONVERSION-ERROR
  9331                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9332                 MOVE AL-UANON   TO LCVCNDTA
  9333                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9334                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9335             ELSE
  9336                 MOVE ER-0246    TO EMI-ERROR
  9337                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9338                 MOVE AL-UABON   TO LCVCNDTA
  9339                 MOVE -1         TO LCVCNDTL
  9340                 MOVE 'X'        TO ERROR-SWITCH
  9341     ELSE
  9342         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9343         MOVE AL-UANOF           TO LCVCNDTA.
  9344
  9345     IF ACVCNDTL GREATER THAN ZERO
  9346         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9347         IF ACVCNDTI = SPACES
  9348             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9349         ELSE
  9350             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9351             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9352             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9353             MOVE '4'            TO DC-OPTION-CODE
  9354             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9355             IF NOT DATE-CONVERSION-ERROR
  9356                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9357                 MOVE AL-UANON   TO ACVCNDTA
  9358                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9359                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9360             ELSE
  9361                 MOVE ER-0246    TO EMI-ERROR
  9362                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9363                 MOVE AL-UABON   TO ACVCNDTA
  9364                 MOVE -1         TO ACVCNDTL
  9365                 MOVE 'X'        TO ERROR-SWITCH
  9366     ELSE
  9367         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9368         MOVE AL-UANOF           TO ACVCNDTA.
  9369
  9370     IF APRL GREATER THAN +0
  9371
  9372* EXEC CICS BIF DEEDIT
  9373*            FIELD    (APRI)
  9374*            LENGTH   (8)
  9375*        END-EXEC
  9376     MOVE 8
  9377       TO DFHEIV11
  9378*    MOVE '@"L                   #   #00008957' TO DFHEIV0
  9379     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9380     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9381     MOVE X'2020233030303038393537' TO DFHEIV0(25:11)
  9382     CALL 'kxdfhei1' USING DFHEIV0,
  9383           APRI,
  9384           DFHEIV11
  9385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 168
* EL131.cbl
  9386         IF APRI NUMERIC
  9387            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9388            MOVE APRI            TO HOLD-APR APRO
  9389            MOVE AL-UANON        TO APRA
  9390          ELSE
  9391            MOVE ER-0259         TO EMI-ERROR
  9392            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9393            MOVE AL-UABON        TO APRA
  9394            MOVE -1              TO APRL
  9395            MOVE 'X'             TO ERROR-SWITCH
  9396     ELSE
  9397         MOVE AL-UANOF           TO APRA.
  9398
  9399     IF PMTFREQL GREATER THAN ZERO
  9400
  9401* EXEC CICS BIF DEEDIT
  9402*            FIELD    (PMTFREQI)
  9403*            LENGTH   (2)
  9404*        END-EXEC
  9405     MOVE 2
  9406       TO DFHEIV11
  9407*    MOVE '@"L                   #   #00008975' TO DFHEIV0
  9408     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9409     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9410     MOVE X'2020233030303038393735' TO DFHEIV0(25:11)
  9411     CALL 'kxdfhei1' USING DFHEIV0,
  9412           PMTFREQI,
  9413           DFHEIV11
  9414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9415         IF PMTFREQI NUMERIC
  9416            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9417            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9418            MOVE AL-UANON        TO PMTFREQA
  9419          ELSE
  9420            MOVE ER-0427         TO EMI-ERROR
  9421            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9422            MOVE AL-UABON        TO PMTFREQA
  9423            MOVE -1              TO PMTFREQL
  9424            MOVE 'X'             TO ERROR-SWITCH
  9425     ELSE
  9426         MOVE AL-UANOF           TO PMTFREQA.
  9427
  9428     IF INDGRPL GREATER THAN ZERO
  9429         IF INDGRPI = 'I' OR 'G' OR SPACE
  9430             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9431             MOVE AL-UANON       TO INDGRPA
  9432          ELSE
  9433             MOVE ER-0260        TO EMI-ERROR
  9434             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9435             MOVE AL-UABON       TO INDGRPA
  9436             MOVE -1             TO INDGRPL
  9437             MOVE 'X'            TO ERROR-SWITCH
  9438     ELSE
  9439         MOVE AL-UANOF           TO INDGRPA.
  9440
  9441     IF PREMTYPL GREATER THAN ZERO
  9442         IF PREMTYPI = '1' OR '2' OR '3'
  9443            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 169
* EL131.cbl
  9444            MOVE AL-UNNON        TO PREMTYPA
  9445            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9446          ELSE
  9447            MOVE ER-0227         TO EMI-ERROR
  9448            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9449            MOVE AL-UNBON        TO PREMTYPA
  9450            MOVE -1              TO PREMTYPL
  9451            MOVE 'X'             TO ERROR-SWITCH
  9452     ELSE
  9453         MOVE AL-UANOF           TO PREMTYPA.
  9454
  9455     IF LOANBALL GREATER THAN ZERO
  9456
  9457* EXEC CICS BIF DEEDIT
  9458*             FIELD    (LOANBALI)
  9459*             LENGTH   (9)
  9460*        END-EXEC
  9461     MOVE 9
  9462       TO DFHEIV11
  9463*    MOVE '@"L                   #   #00009020' TO DFHEIV0
  9464     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9465     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9466     MOVE X'2020233030303039303230' TO DFHEIV0(25:11)
  9467     CALL 'kxdfhei1' USING DFHEIV0,
  9468           LOANBALI,
  9469           DFHEIV11
  9470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9471         IF LOANBALI NUMERIC
  9472             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9473             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9474             MOVE AL-UNNON TO LOANBALA
  9475         ELSE
  9476             MOVE ER-0639        TO EMI-ERROR
  9477             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9478             MOVE AL-UNBON       TO LOANBALA
  9479             MOVE -1             TO LOANBALL
  9480             MOVE 'X'            TO ERROR-SWITCH
  9481     ELSE
  9482         MOVE AL-UNNOF           TO LOANBALA.
  9483
  9484*    IF LOANNOL GREATER THAN ZERO
  9485*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9486*          MOVE AL-UANON            TO LOANNOA
  9487*       ELSE
  9488*          MOVE AL-UANOF            TO LOANNOA.
  9489
  9490     IF REINCDI GREATER THAN LOW-VALUES
  9491        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9492        MOVE AL-UANON            TO REINCDA
  9493     ELSE
  9494        MOVE AL-UANOF            TO REINCDA.
  9495
  9496     IF CERTI GREATER THAN LOW-VALUES
  9497         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9498     ELSE
  9499         MOVE AL-UANOF           TO CERTA.
  9500
  9501     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 170
* EL131.cbl
  9502         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9503     ELSE
  9504         MOVE AL-UANOF           TO CERTEFFA.
  9505
  9506     IF CERTACTI GREATER THAN LOW-VALUES
  9507         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9508     ELSE
  9509         MOVE AL-UANOF           TO CERTACTA.
  9510
  9511     IF CERTSTI GREATER THAN LOW-VALUES
  9512         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9513     ELSE
  9514         MOVE AL-UANOF           TO CERTSTA.
  9515
  9516     IF CERTCARI GREATER THAN LOW-VALUES
  9517         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9518     ELSE
  9519         MOVE AL-UANOF           TO CERTCARA.
  9520
  9521     IF DLYACTV-RECORD-NEEDED
  9522         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9523                 1150-EXIT
  9524     END-IF.
  9525
  9526     IF CERTEFFI GREATER LOW-VALUES OR
  9527        CERTACTI GREATER LOW-VALUES OR
  9528        CERTSTI  GREATER LOW-VALUES OR
  9529        CERTCARI GREATER LOW-VALUES OR
  9530        CERTGRPI GREATER LOW-VALUES
  9531        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9532
  9533*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9534*      IF PI-PREM-TYPE NOT = '1'  AND
  9535*         PI-NO-PMTS = ZEROS
  9536*          IF LOANBALL GREATER +0 OR
  9537*             ACVBENEL GREATER +0
  9538*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9539     if not acct-found
  9540        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9541     end-if
  9542     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9543     MOVE PI-CARRIER             TO CARRIER-CODE
  9544     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9545     MOVE PI-CERT-NO             TO CERT-NO
  9546
  9547* EXEC CICS READ
  9548*        DATASET   (CLMS-FILE-ID)
  9549*        RIDFLD    (MSTR-KEY)
  9550*        SET       (ADDRESS OF CLAIM-MASTER)
  9551*        RESP      (WS-RESPONSE)
  9552*    END-EXEC
  9553*    MOVE '&"S        E          (  N#00009099' TO DFHEIV0
  9554     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9555     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9556     MOVE X'204E233030303039303939' TO DFHEIV0(25:11)
  9557     CALL 'kxdfhei1' USING DFHEIV0,
  9558           CLMS-FILE-ID,
  9559           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 171
* EL131.cbl
  9560           DFHEIV99,
  9561           MSTR-KEY,
  9562           DFHEIV99,
  9563           DFHEIV99,
  9564           DFHEIV99
  9565     SET ADDRESS OF CLAIM-MASTER TO
  9566         DFHEIV20
  9567     MOVE EIBRESP  TO WS-RESPONSE
  9568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9569     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9570     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9571     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9572     MOVE CL-CERT-STATE          TO CERT-STATE
  9573     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9574     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9575     MOVE CL-CERT-NO             TO CERT-CERT
  9576
  9577* EXEC CICS READ
  9578*       DATASET   (CERT-FILE-ID)
  9579*       RIDFLD    (CERT-KEY)
  9580*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9581*       RESP      (WS-RESPONSE)
  9582*    END-EXEC
  9583*    MOVE '&"S        E          (  N#00009112' TO DFHEIV0
  9584     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9585     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9586     MOVE X'204E233030303039313132' TO DFHEIV0(25:11)
  9587     CALL 'kxdfhei1' USING DFHEIV0,
  9588           CERT-FILE-ID,
  9589           DFHEIV20,
  9590           DFHEIV99,
  9591           CERT-KEY,
  9592           DFHEIV99,
  9593           DFHEIV99,
  9594           DFHEIV99
  9595     SET ADDRESS OF CERTIFICATE-MASTER TO
  9596         DFHEIV20
  9597     MOVE EIBRESP  TO WS-RESPONSE
  9598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9599     if mfnamei > low-values
  9600        move mfnamei to w-name-first
  9601     else
  9602        move cl-insured-1st-name to w-name-first
  9603     end-if
  9604     if mlnamei > low-values
  9605        move mlnamei to w-name-last
  9606     else
  9607        move cl-insured-last-name to w-name-last
  9608     end-if
  9609     if instypel > zeros
  9610        evaluate true
  9611           when cl-no-of-days-paid > zeros
  9612              move er-1668       to emi-error
  9613              perform 9900-error-format
  9614                                 thru 9900-exit
  9615              move al-uabon      to instypea
  9616              move -1            to instypel
  9617              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 172
* EL131.cbl
  9618           when instypei = 'C'
  9619              if (w-name-first (1:10) = cm-insured-first-name)
  9620                 and (w-name-last = cm-insured-last-name)
  9621                 move er-1666    to emi-error
  9622                 PERFORM 9900-ERROR-FORMAT
  9623                                 THRU 9900-EXIT
  9624                 move al-uabon   to instypea
  9625                 move -1         to instypel
  9626                 move 'X'        to error-switch
  9627              end-if
  9628           when instypei = 'P'
  9629              if (w-name-first (1:10) <> cm-insured-first-name)
  9630                 or (w-name-last <> cm-insured-last-name)
  9631                 move er-1676    to emi-error
  9632                 PERFORM 9900-ERROR-FORMAT
  9633                                 THRU 9900-EXIT
  9634                 move al-uabon   to instypea
  9635                 move -1         to instypel
  9636                 move 'X'        to error-switch
  9637              end-if
  9638        end-evaluate
  9639     end-if
  9640*    if (instypel > zeros)
  9641*       and (cl-no-of-days-paid > zero)
  9642*       move er-1668             to emi-error
  9643*       perform 9900-error-format thru 9900-exit
  9644*       move al-uabon            to instypea
  9645*       move -1                  to instypel
  9646*       move 'X'                 to error-switch
  9647*    end-if
  9648*
  9649*    if instypel > zero
  9650*       if instypei = 'C'
  9651*          if w-name-first (1:10) = cm-insured-first-name
  9652*             move er-1666          to emi-error
  9653*             PERFORM 9900-ERROR-FORMAT
  9654*                                   THRU 9900-EXIT
  9655*             move al-uabon         to instypea
  9656*             move -1               to instypel
  9657*             move 'X'              to error-switch
  9658*          end-if
  9659*       end-if
  9660*    end-if
  9661     if (pi-company-id = 'DCC' OR 'VPP')
  9662        and (acct-found)
  9663        perform 2120-check-pdef  thru 2120-exit
  9664        IF EXTENSL > ZERO
  9665           IF EXTENSI NUMERIC
  9666              IF EXTENSI >  WS-MAX-EXTENSION
  9667                AND ERPDEF-FOUND
  9668                 MOVE ER-1678          TO EMI-ERROR
  9669                 PERFORM 9900-ERROR-FORMAT
  9670                                       THRU 9900-EXIT
  9671                 MOVE AL-UABON         TO EXTENSA
  9672                 MOVE -1               TO EXTENSL
  9673                 MOVE 'X'              TO ERROR-SWITCH
  9674              ELSE
  9675                 MOVE 'X'              TO UPDATE-SWITCH
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 173
* EL131.cbl
  9676              END-IF
  9677           ELSE
  9678              MOVE ER-1778          TO EMI-ERROR
  9679              PERFORM 9900-ERROR-FORMAT
  9680                                    THRU 9900-EXIT
  9681              MOVE AL-UABON         TO EXTENSA
  9682              MOVE -1               TO EXTENSL
  9683              MOVE 'X'              TO ERROR-SWITCH
  9684           END-IF
  9685        END-IF
  9686     end-if
  9687     if benperl > zeros
  9688        move al-uanon            to benpera
  9689     end-if
  9690     if benperl > zeros
  9691        if benperi numeric
  9692           perform 1015-edit-benefit-period
  9693                                 thru 1015-exit
  9694        else
  9695           move er-1669          to emi-error
  9696           PERFORM 9900-ERROR-FORMAT
  9697                                 THRU 9900-EXIT
  9698           move al-uabon         to benpera
  9699           move -1               to benperl
  9700           move 'X'              to error-switch
  9701        end-if
  9702    end-if
  9703     if instypel > zeros
  9704        if instypei = 'P' OR 'C'
  9705           move 'X'              to update-switch
  9706                                    mstr-switch
  9707           move al-uanon         to instypea
  9708        else
  9709            move er-1654          to emi-error
  9710           PERFORM 9900-ERROR-FORMAT
  9711                                 THRU 9900-EXIT
  9712           move al-uabon         to instypea
  9713           move -1               to instypel
  9714           move 'X'              to error-switch
  9715        end-if
  9716    end-if
  9717     if accswl > zeros
  9718        if accswi = 'Y' OR 'N'
  9719           MOVE 'X'              TO UPDATE-SWITCH
  9720                                    MSTR-SWITCH
  9721           MOVE AL-UANON         TO accswa
  9722*       else
  9723*          move er-1656          to emi-error
  9724*          PERFORM 9900-ERROR-FORMAT
  9725*                                THRU 9900-EXIT
  9726*          move al-uabon         to accswa
  9727*          move -1               to accswl
  9728*          move 'X'              to error-switch
  9729*          move al-uanof         to accswa
  9730        end-if
  9731     end-if
  9732     IF CERTL = ZEROS AND
  9733        SUFXL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 174
* EL131.cbl
  9734          GO TO 1010-EXIT.
  9735
  9736     IF CERTL GREATER THAN ZEROS
  9737         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9738             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9739             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9740             MOVE 'X'            TO ERROR-SWITCH
  9741             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9742
  9743     IF SUFXL GREATER THAN ZEROS
  9744         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9745             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9746             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9747             MOVE 'X'            TO ERROR-SWITCH
  9748             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9749
  9750 1010-EXIT.
  9751     EXIT.
  9752
  9753 1015-edit-benefit-period.
  9754     move ' '                    to ws-benper-sw
  9755     evaluate true
  9756        when not erpdef-found
  9757           set good-benper       to true
  9758        when pd-recurring-yn (a1) = 'Y'
  9759           set good-benper       to true
  9760        when pd-recurring-yn (a1) = 'N'
  9761           if benperi < 02
  9762              set good-benper    to true
  9763           end-if
  9764        when pd-rec-crit-period (a1) numeric
  9765           if benperi <= pd-rec-crit-period (a1)
  9766              set good-benper    to true
  9767           end-if
  9768     end-evaluate
  9769     MOVE CERT-KEY               TO ELCRTT-KEY
  9770     MOVE 'B'                    TO CTRLR-REC-TYPE
  9771
  9772* EXEC CICS READ
  9773*       DATASET   ('ELCRTT')
  9774*       RIDFLD    (ELCRTT-KEY)
  9775*       INTO      (CERTIFICATE-TRAILERS)
  9776*       RESP      (WS-RESPONSE)
  9777*    END-EXEC
  9778     MOVE LENGTH OF
  9779      CERTIFICATE-TRAILERS
  9780       TO DFHEIV11
  9781     MOVE 'ELCRTT' TO DFHEIV1
  9782*    MOVE '&"IL       E          (  N#00009290' TO DFHEIV0
  9783     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9785     MOVE X'204E233030303039323930' TO DFHEIV0(25:11)
  9786     CALL 'kxdfhei1' USING DFHEIV0,
  9787           DFHEIV1,
  9788           CERTIFICATE-TRAILERS,
  9789           DFHEIV11,
  9790           ELCRTT-KEY,
  9791           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 175
* EL131.cbl
  9792           DFHEIV99,
  9793           DFHEIV99
  9794     MOVE EIBRESP  TO WS-RESPONSE
  9795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9796     IF WS-RESP-NORMAL
  9797        perform varying s1 from +1 by +1 until
  9798           (s1 > +24)
  9799           or ((cs-claim-type (s1) = cl-claim-type)
  9800           and (cs-insured-type (s1) = cl-insured-type)
  9801           and (cs-benefit-period (s1) > benperi))
  9802        end-perform
  9803        if s1 < +25
  9804           move er-1665          to emi-error
  9805           PERFORM 9900-ERROR-FORMAT
  9806                                 THRU 9900-EXIT
  9807           move al-uabon         to benpera
  9808           move -1               to benperl
  9809           move 'X'              to error-switch
  9810           go to 1015-exit
  9811*       else
  9812*          set good-benper       to true
  9813        end-if
  9814     end-if
  9815     if good-benper
  9816        move 'X'                 to update-switch
  9817                                    mstr-switch
  9818        move al-uanon            to benpera
  9819     else
  9820        move er-1669             to emi-error
  9821        PERFORM 9900-ERROR-FORMAT
  9822                                 THRU 9900-EXIT
  9823        move al-uabon            to benpera
  9824        move -1                  to benperl
  9825        move 'X'                 to error-switch
  9826     end-if
  9827     .
  9828 1015-exit.
  9829     exit.
  9830 1030-EDIT-NAME.
  9831     IF INSTYPEL > ZEROS
  9832        MOVE INSTYPEI TO CL-INSURED-TYPE
  9833     END-IF
  9834     IF MFNAMEL > +0
  9835        IF CL-INSURED-TYPE = 'C'
  9836          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  9837           MOVE ER-1675             TO EMI-ERROR
  9838           MOVE -1                  TO MFNAMEL
  9839           MOVE AL-UABON            TO MFNAMEA
  9840           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9841           MOVE 'X'                 TO ERROR-SWITCH
  9842        ELSE
  9843          IF CL-INSURED-TYPE = 'P'
  9844            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  9845             MOVE ER-1676             TO EMI-ERROR
  9846             MOVE -1                  TO MFNAMEL
  9847             MOVE AL-UABON            TO MFNAMEA
  9848             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9849             MOVE 'X'                 TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 176
* EL131.cbl
  9850          END-IF
  9851        END-IF
  9852     END-IF.
  9853
  9854 1030-EXIT.
  9855     EXIT.
  9856 1050-EDIT-BENE.
  9857     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9858     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9859     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9860     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9861     MOVE 1000               TO TRLR-SEQ-NO.
  9862
  9863
  9864* EXEC CICS HANDLE CONDITION
  9865*         NOTFND    (1052-DONE)
  9866*         ENDFILE   (1052-DONE)
  9867*    END-EXEC.
  9868*    MOVE '"$I''                  ! & #00009363' TO DFHEIV0
  9869     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9871     MOVE X'2620233030303039333633' TO DFHEIV0(25:11)
  9872     CALL 'kxdfhei1' USING DFHEIV0
  9873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9874
  9875
  9876
  9877* EXEC CICS STARTBR
  9878*        DATASET (TRLR-FILE-ID)
  9879*        RIDFLD  (TRLR-KEY)
  9880*    END-EXEC
  9881     MOVE 0
  9882       TO DFHEIV11
  9883*    MOVE '&,         G          &   #00009368' TO DFHEIV0
  9884     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9885     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9886     MOVE X'2020233030303039333638' TO DFHEIV0(25:11)
  9887     CALL 'kxdfhei1' USING DFHEIV0,
  9888           TRLR-FILE-ID,
  9889           TRLR-KEY,
  9890           DFHEIV99,
  9891           DFHEIV11,
  9892           DFHEIV99
  9893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9894
  9895
  9896     MOVE SPACES TO WS-TRLR-FILE-EOF
  9897                    WS-PAYMENT-PENDING
  9898     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9899       UNTIL  TRLR-FILE-EOF
  9900         OR PAYMENT-PENDING
  9901
  9902
  9903* EXEC CICS ENDBR
  9904*        DATASET (TRLR-FILE-ID)
  9905*    END-EXEC.
  9906     MOVE 0
  9907       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 177
* EL131.cbl
  9908*    MOVE '&2                    $   #00009380' TO DFHEIV0
  9909     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9910     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9911     MOVE X'2020233030303039333830' TO DFHEIV0(25:11)
  9912     CALL 'kxdfhei1' USING DFHEIV0,
  9913           TRLR-FILE-ID,
  9914           DFHEIV11,
  9915           DFHEIV99
  9916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9917
  9918 1050-EXIT.
  9919     EXIT.
  9920
  9921 1052-READ-TRLR.
  9922
  9923* EXEC CICS READNEXT
  9924*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9925*         DATASET  (TRLR-FILE-ID)
  9926*         RIDFLD   (TRLR-KEY)
  9927*    END-EXEC.
  9928     MOVE 0
  9929       TO DFHEIV11
  9930*    MOVE '&.S                   )   #00009387' TO DFHEIV0
  9931     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9932     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9933     MOVE X'2020233030303039333837' TO DFHEIV0(25:11)
  9934     CALL 'kxdfhei1' USING DFHEIV0,
  9935           TRLR-FILE-ID,
  9936           DFHEIV20,
  9937           DFHEIV99,
  9938           TRLR-KEY,
  9939           DFHEIV99,
  9940           DFHEIV11,
  9941           DFHEIV99,
  9942           DFHEIV99
  9943     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9944         DFHEIV20
  9945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9946
  9947
  9948     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9949       AND PI-CARRIER  = TRLR-CARRIER
  9950       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9951       AND PI-CERT-NO  = TRLR-CERT-NO
  9952        CONTINUE
  9953     ELSE
  9954        GO TO 1052-DONE
  9955     END-IF.
  9956
  9957     IF PAYMENT-TR
  9958       AND BENEFICIARY-PAID
  9959       AND AT-VOID-DT = LOW-VALUES
  9960       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9961         SET PAYMENT-PENDING TO TRUE
  9962     END-IF.
  9963
  9964     IF CORRESPONDENCE-TR
  9965        IF AT-AUTH-RCVD = 'Y'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 178
* EL131.cbl
  9966           SET AUTH-RCVD TO TRUE
  9967        ELSE
  9968        IF AT-AUTH-RCVD = 'N'
  9969           SET NO-AUTH-RCVD TO TRUE
  9970        END-IF
  9971        END-IF
  9972     END-IF.
  9973
  9974     GO TO 1052-EXIT.
  9975
  9976 1052-DONE.
  9977     SET TRLR-FILE-EOF TO TRUE.
  9978 1052-EXIT.
  9979     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 179
* EL131.cbl
  9981 1120-EDIT-PROC.
  9982     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9983     MOVE '2'                    TO CNTL-REC-TYPE.
  9984     MOVE PROCI                  TO CNTL-PROC-ID.
  9985     MOVE ZERO                   TO CNTL-SEQ-NO.
  9986
  9987
  9988* EXEC CICS HANDLE CONDITION
  9989*         NOTFND    (1120-CNTL-NOTFND)
  9990*    END-EXEC.
  9991*    MOVE '"$I                   ! '' #00009432' TO DFHEIV0
  9992     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9994     MOVE X'2720233030303039343332' TO DFHEIV0(25:11)
  9995     CALL 'kxdfhei1' USING DFHEIV0
  9996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9997
  9998
  9999
 10000* EXEC CICS READ
 10001*         SET      (ADDRESS OF CONTROL-FILE)
 10002*         DATASET  (CNTL-FILE-ID)
 10003*         RIDFLD   (CNTL-KEY)
 10004*    END-EXEC.
 10005*    MOVE '&"S        E          (   #00009436' TO DFHEIV0
 10006     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10008     MOVE X'2020233030303039343336' TO DFHEIV0(25:11)
 10009     CALL 'kxdfhei1' USING DFHEIV0,
 10010           CNTL-FILE-ID,
 10011           DFHEIV20,
 10012           DFHEIV99,
 10013           CNTL-KEY,
 10014           DFHEIV99,
 10015           DFHEIV99,
 10016           DFHEIV99
 10017     SET ADDRESS OF CONTROL-FILE TO
 10018         DFHEIV20
 10019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10020
 10021
 10022     MOVE AL-UANON               TO PROCA.
 10023     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
 10024     GO TO 1120-EXIT.
 10025
 10026 1120-CNTL-NOTFND.
 10027     MOVE ER-0273                TO EMI-ERROR.
 10028     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10029     MOVE AL-UABON               TO PROCA.
 10030     MOVE -1                     TO PROCL.
 10031     MOVE 'X'                    TO ERROR-SWITCH.
 10032
 10033 1120-EXIT.
 10034     EXIT.
 10035
 10036*************************************************************
 10037*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
 10038*************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 180
* EL131.cbl
 10039
 10040 1150-OUTPUT-ACTIVITY-RECORD.
 10041
 10042
 10043* EXEC CICS GETMAIN
 10044*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 10045*        LENGTH (25)
 10046*        INITIMG (WS-BLANK)
 10047*    END-EXEC.
 10048     MOVE 25
 10049       TO DFHEIV11
 10050*    MOVE ',"IL                  $   #00009462' TO DFHEIV0
 10051     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10052     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10053     MOVE X'2020233030303039343632' TO DFHEIV0(25:11)
 10054     CALL 'kxdfhei1' USING DFHEIV0,
 10055           DFHEIV20,
 10056           DFHEIV11,
 10057           WS-BLANK
 10058     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 10059         DFHEIV20
 10060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10061
 10062
 10063     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 10064     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 10065     MOVE PI-CARRIER             TO DA-CARRIER.
 10066     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
 10067     MOVE PI-CERT-NO             TO DA-CERT-NO.
 10068     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
 10069     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
 10070
 10071
 10072* EXEC CICS HANDLE CONDITION
 10073*        NOTOPEN (1150-NOTOPEN-ERROR)
 10074*        DUPREC (1150-EXIT)
 10075*    END-EXEC.
 10076*    MOVE '"$J%                  ! ( #00009476' TO DFHEIV0
 10077     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10078     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10079     MOVE X'2820233030303039343736' TO DFHEIV0(25:11)
 10080     CALL 'kxdfhei1' USING DFHEIV0
 10081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10082
 10083     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
 10084     MOVE 'DLYACTV'              TO JP-FILE-ID.
 10085     MOVE 'A'                    TO JP-RECORD-TYPE.
 10086     MOVE +48                    TO JOURNAL-LENGTH.
 10087
 10088
 10089* EXEC CICS WRITE
 10090*        DATASET ('DLYACTV')
 10091*        RIDFLD (DA-KEY)
 10092*        FROM (DAILY-ACTIVITY-RECORD)
 10093*        LENGTH (25)
 10094*    END-EXEC.
 10095     MOVE 'DLYACTV' TO DFHEIV1
 10096     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 181
* EL131.cbl
 10097       TO DFHEIV11
 10098*    MOVE '&$ L                  ''   #00009485' TO DFHEIV0
 10099     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10100     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10101     MOVE X'2020233030303039343835' TO DFHEIV0(25:11)
 10102     CALL 'kxdfhei1' USING DFHEIV0,
 10103           DFHEIV1,
 10104           DAILY-ACTIVITY-RECORD,
 10105           DFHEIV11,
 10106           DA-KEY,
 10107           DFHEIV99,
 10108           DFHEIV99
 10109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10110
 10111
 10112     GO TO 1150-EXIT.
 10113
 10114 1150-NOTOPEN-ERROR.
 10115
 10116     MOVE '2955'                 TO EMI-ERROR.
 10117     MOVE -1                     TO MAINTL.
 10118     MOVE AL-UANON               TO MAINTA.
 10119     MOVE 'X'                    TO ERROR-SWITCH.
 10120     PERFORM 9900-ERROR-FORMAT THRU
 10121             9900-EXIT.
 10122
 10123 1150-EXIT.
 10124     EXIT.
 10125
 10126*************************************************************
 10127*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
 10128*************************************************************
 10129
 10130 1240-EDIT-LIFE-CODE.
 10131
 10132     IF INVALID-BENEFIT-CODE
 10133         GO TO 1240-SET-ERROR.
 10134
 10135     MOVE SPACES                 TO BENEFIT-KEY.
 10136     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10137     MOVE '4'                    TO BEN-REC-TYPE.
 10138     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10139     MOVE ZERO                   TO BEN-SEQ-NO.
 10140
 10141
 10142* EXEC CICS READ GTEQ
 10143*         DATASET  (CNTL-FILE-ID)
 10144*         RIDFLD   (BENEFIT-KEY)
 10145*         SET      (ADDRESS OF CONTROL-FILE)
 10146*    END-EXEC.
 10147*    MOVE '&"S        G          (   #00009521' TO DFHEIV0
 10148     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10150     MOVE X'2020233030303039353231' TO DFHEIV0(25:11)
 10151     CALL 'kxdfhei1' USING DFHEIV0,
 10152           CNTL-FILE-ID,
 10153           DFHEIV20,
 10154           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 182
* EL131.cbl
 10155           BENEFIT-KEY,
 10156           DFHEIV99,
 10157           DFHEIV99,
 10158           DFHEIV99
 10159     SET ADDRESS OF CONTROL-FILE TO
 10160         DFHEIV20
 10161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10162
 10163
 10164     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10165        CF-RECORD-TYPE NOT = '4'
 10166         GO TO 1240-SET-ERROR.
 10167
 10168     MOVE ZERO                   TO COUNT-2.
 10169     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10170
 10171     IF SCREEN-ERROR
 10172         GO TO 1240-SET-ERROR.
 10173
 10174 1240-SET-CODE-SWITCHES.
 10175     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10176     MOVE AL-UANON               TO LCVCDA.
 10177     GO TO 1240-EXIT.
 10178
 10179 1240-SET-ERROR.
 10180     MOVE ER-0240                TO EMI-ERROR.
 10181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10182     MOVE 'X'                    TO ERROR-SWITCH.
 10183     MOVE AL-UABON               TO LCVCDA.
 10184     MOVE -1                     TO LCVCDL.
 10185
 10186 1240-EXIT.
 10187     EXIT.
 10188
 10189 1310-EDIT-AH-CODE.
 10190     IF INVALID-BENEFIT-CODE
 10191         GO TO 1310-SET-ERROR.
 10192
 10193     MOVE SPACES                 TO BENEFIT-KEY.
 10194     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10195     MOVE '5'                    TO BEN-REC-TYPE.
 10196     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10197     MOVE ZERO                   TO BEN-SEQ-NO.
 10198
 10199
 10200* EXEC CICS READ GTEQ
 10201*         DATASET  (CNTL-FILE-ID)
 10202*         RIDFLD   (BENEFIT-KEY)
 10203*         SET      (ADDRESS OF CONTROL-FILE)
 10204*    END-EXEC.
 10205*    MOVE '&"S        G          (   #00009562' TO DFHEIV0
 10206     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10207     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10208     MOVE X'2020233030303039353632' TO DFHEIV0(25:11)
 10209     CALL 'kxdfhei1' USING DFHEIV0,
 10210           CNTL-FILE-ID,
 10211           DFHEIV20,
 10212           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 183
* EL131.cbl
 10213           BENEFIT-KEY,
 10214           DFHEIV99,
 10215           DFHEIV99,
 10216           DFHEIV99
 10217     SET ADDRESS OF CONTROL-FILE TO
 10218         DFHEIV20
 10219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10220
 10221
 10222     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10223        CF-RECORD-TYPE NOT = '5'
 10224         GO TO 1310-SET-ERROR.
 10225
 10226     MOVE ZERO                   TO COUNT-2.
 10227     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10228     IF SCREEN-ERROR
 10229         GO TO 1310-SET-ERROR.
 10230
 10231 1310-SET-CODE-SWITCHES.
 10232     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10233     MOVE AL-UANON               TO ACVCDA.
 10234     GO TO 1310-EXIT.
 10235
 10236 1310-SET-ERROR.
 10237     MOVE ER-0250                TO EMI-ERROR.
 10238     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10239     MOVE AL-UABON               TO ACVCDA.
 10240     MOVE 'X'                    TO ERROR-SWITCH.
 10241     MOVE -1                     TO ACVCDL.
 10242
 10243 1310-EXIT.
 10244     EXIT.
 10245
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 184
* EL131.cbl
 10247 1460-EDIT-CERT-NO.
 10248     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10249     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10250
 10251     IF WS-SAVE-CERT-NO = SPACES
 10252         MOVE ER-0203            TO EMI-ERROR
 10253         GO TO 1460-CERT-NO-ERROR.
 10254
 10255     IF WS-CERT-NO-PRIME = SPACES AND
 10256        WS-CERT-NO-SUFX GREATER THAN SPACE
 10257            MOVE ER-0210         TO EMI-ERROR
 10258            GO TO 1460-CERT-NO-ERROR.
 10259
 10260     MOVE 'X'                    TO UPDATE-SWITCH.
 10261     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10262     MOVE AL-UANON               TO CERTA.
 10263
 10264     IF SUFXL IS GREATER THAN 0
 10265         MOVE AL-UANON           TO SUFXA.
 10266
 10267     GO TO 1460-EXIT.
 10268
 10269 1460-CERT-NO-ERROR.
 10270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10271     MOVE AL-UABON               TO SUFXA.
 10272     MOVE AL-UABON               TO CERTA.
 10273     MOVE -1                     TO CERTL.
 10274     MOVE 'X'                    TO ERROR-SWITCH.
 10275
 10276 1460-EXIT.
 10277     EXIT.
 10278
 10279 1470-EDIT-EFF.
 10280     IF CERTEFFI = SPACES
 10281         GO TO 1470-DATE-ERROR.
 10282
 10283     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10284     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10285     IF DEEDIT-DATE = ZERO
 10286         GO TO 1470-DATE-ERROR.
 10287
 10288     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10289     MOVE '4'                    TO DC-OPTION-CODE.
 10290     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10291     IF NOT DATE-CONVERSION-ERROR
 10292         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10293         MOVE AL-UANON           TO CERTEFFA
 10294         MOVE 'X'                TO UPDATE-SWITCH
 10295         MOVE 'Y'                TO CERT-KEY-SWITCH
 10296         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10297         GO TO 1470-EXIT.
 10298
 10299 1470-DATE-ERROR.
 10300     MOVE ER-0215                TO EMI-ERROR.
 10301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10302     MOVE AL-UABON               TO CERTEFFA.
 10303     MOVE -1                     TO CERTEFFL.
 10304     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 185
* EL131.cbl
 10305
 10306 1470-EXIT.
 10307     EXIT.
 10308
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 186
* EL131.cbl
 10310 1480-EDIT-ACCT.
 10311     IF CERTACTI = SPACES
 10312         MOVE ER-0232            TO EMI-ERROR
 10313         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10314         MOVE AL-UABON           TO CERTACTA
 10315         MOVE -1                 TO CERTACTL
 10316         MOVE 'X'                TO ERROR-SWITCH
 10317     ELSE
 10318         MOVE 'X'                TO UPDATE-SWITCH
 10319         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10320
 10321 1480-EXIT.
 10322     EXIT.
 10323
 10324 1490-EDIT-STATE.
 10325     IF CERTSTI = SPACES
 10326         MOVE ER-0233            TO EMI-ERROR
 10327         GO TO 1490-STATE-ERROR.
 10328
 10329     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10330     MOVE '3'                    TO CNTL-REC-TYPE.
 10331     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10332     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10333     MOVE ZERO                   TO CNTL-SEQ-NO.
 10334
 10335
 10336* EXEC CICS HANDLE CONDITION
 10337*         NOTFND (1490-STATE-NOTFND)
 10338*    END-EXEC.
 10339*    MOVE '"$I                   ! ) #00009681' TO DFHEIV0
 10340     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10341     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10342     MOVE X'2920233030303039363831' TO DFHEIV0(25:11)
 10343     CALL 'kxdfhei1' USING DFHEIV0
 10344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10345
 10346
 10347
 10348* EXEC CICS READ
 10349*         SET        (ADDRESS OF CONTROL-FILE)
 10350*         DATASET    ('ELCNTL')
 10351*         RIDFLD     (CNTL-KEY)
 10352*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10353*         GENERIC
 10354*    END-EXEC.
 10355     MOVE 'ELCNTL' TO DFHEIV1
 10356*    MOVE '&"S  KG    E          (   #00009685' TO DFHEIV0
 10357     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10358     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10359     MOVE X'2020233030303039363835' TO DFHEIV0(25:11)
 10360     CALL 'kxdfhei1' USING DFHEIV0,
 10361           DFHEIV1,
 10362           DFHEIV20,
 10363           DFHEIV99,
 10364           CNTL-KEY,
 10365           CNTL-GENERIC-LENGTH,
 10366           DFHEIV99,
 10367           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 187
* EL131.cbl
 10368     SET ADDRESS OF CONTROL-FILE TO
 10369         DFHEIV20
 10370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10371
 10372
 10373     MOVE AL-UANON               TO CERTSTA.
 10374     MOVE 'X'                    TO UPDATE-SWITCH.
 10375     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10376     GO TO 1490-EXIT.
 10377
 10378 1490-STATE-NOTFND.
 10379     MOVE ER-0149                TO EMI-ERROR.
 10380
 10381 1490-STATE-ERROR.
 10382     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10383     MOVE AL-UABON               TO CERTSTA.
 10384     MOVE -1                     TO CERTSTL.
 10385     MOVE 'X'                    TO ERROR-SWITCH.
 10386
 10387 1490-EXIT.
 10388     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 188
* EL131.cbl
 10390 1500-EDIT-CARR.
 10391     IF CERTCARI = SPACES
 10392         GO TO 1500-CARR-NOTFND.
 10393
 10394     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10395     MOVE '6'                    TO CNTL-REC-TYPE.
 10396     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10397     MOVE CERTCARI               TO CNTL-CARRIER.
 10398     MOVE ZERO                   TO CNTL-SEQ-NO.
 10399
 10400
 10401* EXEC CICS HANDLE CONDITION
 10402*         NOTFND   (1500-CARR-NOTFND)
 10403*    END-EXEC.
 10404*    MOVE '"$I                   ! * #00009720' TO DFHEIV0
 10405     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10407     MOVE X'2A20233030303039373230' TO DFHEIV0(25:11)
 10408     CALL 'kxdfhei1' USING DFHEIV0
 10409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10410
 10411
 10412
 10413* EXEC CICS READ
 10414*         SET        (ADDRESS OF CONTROL-FILE)
 10415*         DATASET    ('ELCNTL')
 10416*         RIDFLD     (CNTL-KEY)
 10417*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10418*         GENERIC
 10419*    END-EXEC.
 10420     MOVE 'ELCNTL' TO DFHEIV1
 10421*    MOVE '&"S  KG    E          (   #00009724' TO DFHEIV0
 10422     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10424     MOVE X'2020233030303039373234' TO DFHEIV0(25:11)
 10425     CALL 'kxdfhei1' USING DFHEIV0,
 10426           DFHEIV1,
 10427           DFHEIV20,
 10428           DFHEIV99,
 10429           CNTL-KEY,
 10430           CNTL-GENERIC-LENGTH,
 10431           DFHEIV99,
 10432           DFHEIV99
 10433     SET ADDRESS OF CONTROL-FILE TO
 10434         DFHEIV20
 10435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10436
 10437
 10438     MOVE AL-UANON               TO CERTCARA.
 10439     MOVE 'X'                    TO UPDATE-SWITCH.
 10440     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10441     GO TO 1500-EXIT.
 10442
 10443 1500-CARR-NOTFND.
 10444     MOVE ER-0360                TO EMI-ERROR.
 10445     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10446     MOVE AL-UABON               TO CERTCARA.
 10447     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 189
* EL131.cbl
 10448     MOVE 'X'                    TO ERROR-SWITCH.
 10449
 10450 1500-EXIT.
 10451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 190
* EL131.cbl
 10453 1510-DEEDIT-DATE.
 10454
 10455* EXEC CICS BIF DEEDIT
 10456*         FIELD    (DEEDIT-DATE-INPUT)
 10457*         LENGTH   (DATE-LENGTH)
 10458*    END-EXEC.
 10459*    MOVE '@"L                   #   #00009748' TO DFHEIV0
 10460     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10461     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10462     MOVE X'2020233030303039373438' TO DFHEIV0(25:11)
 10463     CALL 'kxdfhei1' USING DFHEIV0,
 10464           DEEDIT-DATE-INPUT,
 10465           DATE-LENGTH
 10466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10467
 10468
 10469 1510-EXIT.
 10470     EXIT.
 10471
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 191
* EL131.cbl
 10473 1620-VERIFY-ACCT.
 10474
 10475     move ' '                    to ws-eracct-sw
 10476     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10477     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10478     MOVE PI-GROUPING            TO ACCT-GROUP.
 10479     MOVE PI-STATE               TO ACCT-STATE.
 10480     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10481
 10482     IF CERTEFFI GREATER THAN LOW-VALUES
 10483         MOVE HOLD-EFF           TO ACCT-DATE
 10484     ELSE
 10485         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10486
 10487     IF CERTACTI GREATER THAN LOW-VALUES
 10488         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10489     IF CERTSTI GREATER THAN LOW-VALUES
 10490         MOVE CERTSTI            TO  ACCT-STATE.
 10491     IF CERTCARI GREATER THAN LOW-VALUES
 10492         MOVE CERTCARI           TO  ACCT-CARRIER.
 10493     IF CERTGRPI GREATER THAN LOW-VALUES
 10494         MOVE CERTGRPI           TO ACCT-GROUP.
 10495
 10496     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10497
 10498
 10499* EXEC CICS HANDLE CONDITION
 10500*         NOTFND  (1620-ACCT-NOTFND)
 10501*    END-EXEC.
 10502*    MOVE '"$I                   ! + #00009782' TO DFHEIV0
 10503     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10505     MOVE X'2B20233030303039373832' TO DFHEIV0(25:11)
 10506     CALL 'kxdfhei1' USING DFHEIV0
 10507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10508
 10509
 10510
 10511* EXEC CICS STARTBR
 10512*         DATASET   (ACCT-FILE-ID)
 10513*         RIDFLD    (ACCT-KEY)
 10514*    END-EXEC.
 10515     MOVE 0
 10516       TO DFHEIV11
 10517*    MOVE '&,         G          &   #00009786' TO DFHEIV0
 10518     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10519     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10520     MOVE X'2020233030303039373836' TO DFHEIV0(25:11)
 10521     CALL 'kxdfhei1' USING DFHEIV0,
 10522           ACCT-FILE-ID,
 10523           ACCT-KEY,
 10524           DFHEIV99,
 10525           DFHEIV11,
 10526           DFHEIV99
 10527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10528
 10529
 10530 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 192
* EL131.cbl
 10531
 10532
 10533* EXEC CICS READNEXT
 10534*         DATASET  (ACCT-FILE-ID)
 10535*         RIDFLD   (ACCT-KEY)
 10536*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10537*    END-EXEC.
 10538     MOVE 0
 10539       TO DFHEIV11
 10540*    MOVE '&.S                   )   #00009793' TO DFHEIV0
 10541     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10542     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10543     MOVE X'2020233030303039373933' TO DFHEIV0(25:11)
 10544     CALL 'kxdfhei1' USING DFHEIV0,
 10545           ACCT-FILE-ID,
 10546           DFHEIV20,
 10547           DFHEIV99,
 10548           ACCT-KEY,
 10549           DFHEIV99,
 10550           DFHEIV11,
 10551           DFHEIV99,
 10552           DFHEIV99
 10553     SET ADDRESS OF ACCOUNT-MASTER TO
 10554         DFHEIV20
 10555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10556
 10557
 10558     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10559         GO TO 1620-ACCT-NOTFND.
 10560
 10561     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10562        HOLD-EFF     LESS AM-EXPIRATION-DT
 10563         NEXT SENTENCE
 10564     ELSE
 10565         GO TO 1620-ACCT-LOOP.
 10566
 10567     set acct-found to true
 10568     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10569         GO TO 1620-ACCT-END-BROWSE.
 10570
 10571     IF LOANBALL GREATER THAN +0
 10572         IF AM-MAX-TOT-BEN NUMERIC  AND
 10573            AM-MAX-TOT-BEN GREATER THAN ZERO
 10574             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10575                 MOVE AL-UNBON     TO LOANBALA
 10576                 MOVE -1           TO LOANBALL
 10577                 MOVE 'X'          TO ERROR-SWITCH
 10578                 MOVE ER-7641      TO EMI-ERROR
 10579                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10580
 10581     IF ACVBENEL GREATER THAN +0
 10582         IF AM-MAX-MON-BEN NUMERIC  AND
 10583            AM-MAX-MON-BEN GREATER THAN ZERO
 10584             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10585                 MOVE AL-UNBON     TO ACVBENEA
 10586                 MOVE -1           TO ACVBENEL
 10587                 MOVE 'X'          TO ERROR-SWITCH
 10588                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 193
* EL131.cbl
 10589                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10590
 10591 1620-ACCT-END-BROWSE.
 10592
 10593
 10594* EXEC CICS ENDBR
 10595*         DATASET (ACCT-FILE-ID)
 10596*    END-EXEC.
 10597     MOVE 0
 10598       TO DFHEIV11
 10599*    MOVE '&2                    $   #00009834' TO DFHEIV0
 10600     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10601     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10602     MOVE X'2020233030303039383334' TO DFHEIV0(25:11)
 10603     CALL 'kxdfhei1' USING DFHEIV0,
 10604           ACCT-FILE-ID,
 10605           DFHEIV11,
 10606           DFHEIV99
 10607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10608
 10609
 10610     GO TO 1620-EXIT.
 10611
 10612 1620-ACCT-NOTFND.
 10613
 10614     MOVE -1                     TO MAINTL.
 10615     MOVE 'X'                    TO ERROR-SWITCH.
 10616     MOVE ER-0426                TO EMI-ERROR.
 10617     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10618
 10619 1620-EXIT.
 10620     EXIT.
 10621
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 194
* EL131.cbl
 10623 2000-UPDATE-CLAIM.
 10624
 10625     MOVE SPACES                 TO ERROR-SWITCH.
 10626     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10627     MOVE PI-CARRIER             TO CARRIER-CODE.
 10628     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10629     MOVE PI-CERT-NO             TO CERT-NO.
 10630
 10631     IF DELETE-CLAIM
 10632         GO TO 3000-DELETE-CLAIM.
 10633
 10634     IF  NOT MODIFY-CAP
 10635         MOVE ER-0070            TO EMI-ERROR
 10636         MOVE 'X'                TO ERROR-SWITCH
 10637         MOVE -1                 TO MAINTL
 10638         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10639         GO TO 2000-EXIT.
 10640
 10641     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10642     MOVE ZERO                   TO TRLR-SEQ-NO.
 10643
 10644
 10645* EXEC CICS READ UPDATE
 10646*         SET       (ADDRESS OF CLAIM-MASTER)
 10647*         DATASET   (CLMS-FILE-ID)
 10648*         RIDFLD    (MSTR-KEY)
 10649*    END-EXEC.
 10650*    MOVE '&"S        EU         (   #00009872' TO DFHEIV0
 10651     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10652     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10653     MOVE X'2020233030303039383732' TO DFHEIV0(25:11)
 10654     CALL 'kxdfhei1' USING DFHEIV0,
 10655           CLMS-FILE-ID,
 10656           DFHEIV20,
 10657           DFHEIV99,
 10658           MSTR-KEY,
 10659           DFHEIV99,
 10660           DFHEIV99,
 10661           DFHEIV99
 10662     SET ADDRESS OF CLAIM-MASTER TO
 10663         DFHEIV20
 10664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10665
 10666
 10667     if (incl > zeros)
 10668        and (cl-no-of-pmts-made > 0)
 10669        and (hold-incur > low-values)
 10670        and (hold-incur not = cl-incurred-dt)
 10671        if hold-incur > cl-incurred-dt
 10672           move cl-incurred-dt   to dc-bin-date-1
 10673           move hold-incur       to dc-bin-date-2
 10674        else
 10675           move hold-incur       to dc-bin-date-1
 10676           move cl-incurred-dt   to dc-bin-date-2
 10677        end-if
 10678        move '1'                 to dc-option-code
 10679        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10680        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 195
* EL131.cbl
 10681           MOVE ER-1663             TO EMI-ERROR
 10682           PERFORM 9900-ERROR-FORMAT
 10683                                 THRU 9900-EXIT
 10684           MOVE -1                  TO MAINTL
 10685           GO TO 8110-SEND-DATA
 10686        end-if
 10687     end-if
 10688     IF (CL-PRIORITY-CD = '8')
 10689        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10690             AND 'AMWA' AND 'KMSB')
 10691        MOVE ER-8003             TO EMI-ERROR
 10692        PERFORM 9900-ERROR-FORMAT
 10693                                 THRU 9900-EXIT
 10694        MOVE -1                  TO MAINTL
 10695        GO TO 8110-SEND-DATA
 10696     END-IF
 10697
 10698     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10699         MOVE ER-0068            TO EMI-ERROR
 10700         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10701         GO TO 2000-EXIT.
 10702
 10703     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10704         MOVE ER-0068            TO EMI-ERROR
 10705         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10706         GO TO 2000-EXIT.
 10707
 10708     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10709         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10710
 10711     IF CL-PURGED-DT NOT = LOW-VALUES
 10712         MOVE ER-7691            TO EMI-ERROR
 10713         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10714         GO TO 2000-EXIT.
 10715
 10716     IF CERT-KEY-CHANGED
 10717         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10718
 10719     IF SCREEN-ERROR
 10720         MOVE ER-0068            TO EMI-ERROR
 10721         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10722         GO TO 2000-EXIT.
 10723
 10724     IF NINETY-TRLR-UPDATED
 10725         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10726
 10727     IF MSTR-KEY-CHANGED
 10728         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10729        ELSE
 10730         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10731
 10732     IF TRLR-UPDATE-REQUIRED
 10733         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10734
 10735 2000-CHECK-CERT.
 10736     IF NOT CERT-UPDATES
 10737         GO TO 2000-EXIT.
 10738
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 196
* EL131.cbl
 10739     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10740     MOVE PI-CARRIER             TO CERT-CARRIER.
 10741     MOVE PI-GROUPING            TO CERT-GROUP.
 10742     MOVE PI-STATE               TO CERT-STATE.
 10743     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10744     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10745     MOVE PI-CERT-NO             TO CERT-CERT.
 10746
 10747     IF CERT-ALT-KEY-CHANGED
 10748         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10749     ELSE
 10750         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10751
 10752 2000-EXIT.
 10753     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 197
* EL131.cbl
 10755 2010-RELEASE-REC.
 10756
 10757* EXEC CICS UNLOCK
 10758*         DATASET  (CLMS-FILE-ID)
 10759*    END-EXEC
 10760*    MOVE '&*                    #   #00009967' TO DFHEIV0
 10761     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10762     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10763     MOVE X'2020233030303039393637' TO DFHEIV0(25:11)
 10764     CALL 'kxdfhei1' USING DFHEIV0,
 10765           CLMS-FILE-ID,
 10766           DFHEIV99
 10767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10768
 10769     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10770     MOVE 'X'                    TO ERROR-SWITCH.
 10771
 10772 2010-EXIT.
 10773     EXIT.
 10774
 10775 2020-NORMAL-UPDATE.
 10776     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10777
 10778     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10779
 10780     IF WS-OPEN-CLOSE-SW = 'Y'
 10781       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10782       IF PI-REC-FOUND-SW = 'Y'
 10783         IF CL-ACTIVITY-CODE = 09
 10784           NEXT SENTENCE
 10785         ELSE
 10786           IF WS-RESET-SW = 'Y'
 10787             IF CL-CLAIM-STATUS = 'C'
 10788               MOVE 07               TO  CL-ACTIVITY-CODE
 10789               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10790               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10791             ELSE
 10792               MOVE 08               TO  CL-ACTIVITY-CODE
 10793               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10794               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10795
 10796     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10797         MOVE 'Y'                TO CL-YESNOSW
 10798     END-IF.
 10799
 10800     if pi-company-id = 'DCC' OR 'VPP'
 10801        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10802        perform 2120-check-pdef  thru 2120-exit
 10803     end-if
 10804     if ((benperl <> zeros)
 10805        and (benperi numeric))
 10806                  or
 10807            (instypel <> zeros)
 10808        perform 2140-update-elcrtt thru 2140-exit
 10809     end-if
 10810
 10811* EXEC CICS HANDLE CONDITION
 10812*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 198
* EL131.cbl
 10813*    END-EXEC.
 10814*    MOVE '"$$                   ! , #00010012' TO DFHEIV0
 10815     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10817     MOVE X'2C20233030303130303132' TO DFHEIV0(25:11)
 10818     CALL 'kxdfhei1' USING DFHEIV0
 10819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10820
 10821
 10822
 10823* EXEC CICS REWRITE
 10824*         DATASET   (CLMS-FILE-ID)
 10825*         FROM      (CLAIM-MASTER)
 10826*    END-EXEC.
 10827     MOVE LENGTH OF
 10828      CLAIM-MASTER
 10829       TO DFHEIV11
 10830*    MOVE '&& L                  %   #00010016' TO DFHEIV0
 10831     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10832     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10833     MOVE X'2020233030303130303136' TO DFHEIV0(25:11)
 10834     CALL 'kxdfhei1' USING DFHEIV0,
 10835           CLMS-FILE-ID,
 10836           CLAIM-MASTER,
 10837           DFHEIV11,
 10838           DFHEIV99
 10839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10840
 10841
 10842 2020-EXIT.
 10843     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 199
* EL131.cbl
 10845 2030-KEY-UPDATE.
 10846     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10847
 10848
 10849* EXEC CICS DELETE
 10850*        DATASET  (CLMS-FILE-ID)
 10851*    END-EXEC.
 10852*    MOVE '&(                    &   #00010027' TO DFHEIV0
 10853     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10854     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10855     MOVE X'2020233030303130303237' TO DFHEIV0(25:11)
 10856     CALL 'kxdfhei1' USING DFHEIV0,
 10857           CLMS-FILE-ID,
 10858           DFHEIV99,
 10859           DFHEIV99,
 10860           DFHEIV99,
 10861           DFHEIV99
 10862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10863
 10864
 10865
 10866* EXEC CICS GETMAIN
 10867*         SET      (ADDRESS OF CLAIM-MASTER)
 10868*         LENGTH   (MSTR-LENGTH)
 10869*         INITIMG  (GETMAIN-SPACE)
 10870*    END-EXEC.
 10871*    MOVE ',"IL                  $   #00010031' TO DFHEIV0
 10872     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10873     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10874     MOVE X'2020233030303130303331' TO DFHEIV0(25:11)
 10875     CALL 'kxdfhei1' USING DFHEIV0,
 10876           DFHEIV20,
 10877           MSTR-LENGTH,
 10878           GETMAIN-SPACE
 10879     SET ADDRESS OF CLAIM-MASTER TO
 10880         DFHEIV20
 10881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10882
 10883
 10884     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10885
 10886     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10887
 10888     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10889
 10890     IF WS-OPEN-CLOSE-SW = 'Y'
 10891       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10892         IF PI-REC-FOUND-SW = 'Y'
 10893           IF CL-ACTIVITY-CODE = 09
 10894             NEXT SENTENCE
 10895           ELSE
 10896             IF WS-RESET-SW = 'Y'
 10897               IF CL-CLAIM-STATUS = 'C'
 10898                 MOVE 07             TO  CL-ACTIVITY-CODE
 10899                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10900                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10901               ELSE
 10902                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 200
* EL131.cbl
 10903                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10904                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10905
 10906
 10907* EXEC CICS HANDLE CONDITION
 10908*         DUPKEY    (2030-EXIT)
 10909*    END-EXEC.
 10910*    MOVE '"$$                   ! - #00010059' TO DFHEIV0
 10911     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10913     MOVE X'2D20233030303130303539' TO DFHEIV0(25:11)
 10914     CALL 'kxdfhei1' USING DFHEIV0
 10915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10916
 10917
 10918** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10919*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10920
 10921     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10922         MOVE 'Y'                TO CL-YESNOSW
 10923     END-IF.
 10924
 10925
 10926* EXEC CICS WRITE
 10927*         DATASET   (CLMS-FILE-ID)
 10928*         RIDFLD    (MSTR-KEY)
 10929*         FROM      (CLAIM-MASTER)
 10930*    END-EXEC.
 10931     MOVE LENGTH OF
 10932      CLAIM-MASTER
 10933       TO DFHEIV11
 10934*    MOVE '&$ L                  ''   #00010070' TO DFHEIV0
 10935     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10936     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10937     MOVE X'2020233030303130303730' TO DFHEIV0(25:11)
 10938     CALL 'kxdfhei1' USING DFHEIV0,
 10939           CLMS-FILE-ID,
 10940           CLAIM-MASTER,
 10941           DFHEIV11,
 10942           MSTR-KEY,
 10943           DFHEIV99,
 10944           DFHEIV99
 10945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10946
 10947
 10948 2030-EXIT.
 10949     EXIT.
 10950
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 201
* EL131.cbl
 10952 2040-NORMAL-UPDATE.
 10953
 10954* EXEC CICS READ UPDATE
 10955*         DATASET  (CERT-FILE-ID)
 10956*         RIDFLD   (CERT-KEY)
 10957*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10958*    END-EXEC.
 10959*    MOVE '&"S        EU         (   #00010081' TO DFHEIV0
 10960     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10961     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10962     MOVE X'2020233030303130303831' TO DFHEIV0(25:11)
 10963     CALL 'kxdfhei1' USING DFHEIV0,
 10964           CERT-FILE-ID,
 10965           DFHEIV20,
 10966           DFHEIV99,
 10967           CERT-KEY,
 10968           DFHEIV99,
 10969           DFHEIV99,
 10970           DFHEIV99
 10971     SET ADDRESS OF CERTIFICATE-MASTER TO
 10972         DFHEIV20
 10973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10974
 10975
 10976     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10977
 10978
 10979* EXEC CICS HANDLE CONDITION
 10980*         DUPKEY   (2040-EXIT)
 10981*    END-EXEC.
 10982*    MOVE '"$$                   ! . #00010089' TO DFHEIV0
 10983     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10984     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10985     MOVE X'2E20233030303130303839' TO DFHEIV0(25:11)
 10986     CALL 'kxdfhei1' USING DFHEIV0
 10987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10988
 10989
 10990
 10991* EXEC CICS REWRITE
 10992*         DATASET  (CERT-FILE-ID)
 10993*         FROM     (CERTIFICATE-MASTER)
 10994*    END-EXEC.
 10995     MOVE LENGTH OF
 10996      CERTIFICATE-MASTER
 10997       TO DFHEIV11
 10998*    MOVE '&& L                  %   #00010093' TO DFHEIV0
 10999     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11000     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11001     MOVE X'2020233030303130303933' TO DFHEIV0(25:11)
 11002     CALL 'kxdfhei1' USING DFHEIV0,
 11003           CERT-FILE-ID,
 11004           CERTIFICATE-MASTER,
 11005           DFHEIV11,
 11006           DFHEIV99
 11007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11008
 11009
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 202
* EL131.cbl
 11010 2040-EXIT.
 11011     EXIT.
 11012
 11013 2050-KEY-UPDATE.
 11014
 11015* EXEC CICS READ UPDATE
 11016*         DATASET  (CERT-FILE-ID)
 11017*         RIDFLD   (CERT-KEY)
 11018*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11019*    END-EXEC.
 11020*    MOVE '&"S        EU         (   #00010102' TO DFHEIV0
 11021     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11022     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11023     MOVE X'2020233030303130313032' TO DFHEIV0(25:11)
 11024     CALL 'kxdfhei1' USING DFHEIV0,
 11025           CERT-FILE-ID,
 11026           DFHEIV20,
 11027           DFHEIV99,
 11028           CERT-KEY,
 11029           DFHEIV99,
 11030           DFHEIV99,
 11031           DFHEIV99
 11032     SET ADDRESS OF CERTIFICATE-MASTER TO
 11033         DFHEIV20
 11034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11035
 11036
 11037     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 11038
 11039
 11040* EXEC CICS DELETE
 11041*         DATASET   (CERT-FILE-ID)
 11042*    END-EXEC.
 11043*    MOVE '&(                    &   #00010110' TO DFHEIV0
 11044     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11045     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11046     MOVE X'2020233030303130313130' TO DFHEIV0(25:11)
 11047     CALL 'kxdfhei1' USING DFHEIV0,
 11048           CERT-FILE-ID,
 11049           DFHEIV99,
 11050           DFHEIV99,
 11051           DFHEIV99,
 11052           DFHEIV99
 11053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11054
 11055
 11056
 11057* EXEC CICS GETMAIN
 11058*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11059*         LENGTH    (CERT-LENGTH)
 11060*         INITIMG   (GETMAIN-SPACE)
 11061*    END-EXEC.
 11062*    MOVE ',"IL                  $   #00010114' TO DFHEIV0
 11063     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11064     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11065     MOVE X'2020233030303130313134' TO DFHEIV0(25:11)
 11066     CALL 'kxdfhei1' USING DFHEIV0,
 11067           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 203
* EL131.cbl
 11068           CERT-LENGTH,
 11069           GETMAIN-SPACE
 11070     SET ADDRESS OF CERTIFICATE-MASTER TO
 11071         DFHEIV20
 11072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11073
 11074
 11075     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 11076
 11077     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11078
 11079
 11080* EXEC CICS HANDLE CONDITION
 11081*         DUPKEY (2050-EXIT)
 11082*    END-EXEC.
 11083*    MOVE '"$$                   ! / #00010124' TO DFHEIV0
 11084     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11086     MOVE X'2F20233030303130313234' TO DFHEIV0(25:11)
 11087     CALL 'kxdfhei1' USING DFHEIV0
 11088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11089
 11090
 11091
 11092* EXEC CICS WRITE
 11093*         DATASET  (CERT-FILE-ID)
 11094*         RIDFLD   (CERT-KEY)
 11095*         FROM     (CERTIFICATE-MASTER)
 11096*    END-EXEC.
 11097     MOVE LENGTH OF
 11098      CERTIFICATE-MASTER
 11099       TO DFHEIV11
 11100*    MOVE '&$ L                  ''   #00010128' TO DFHEIV0
 11101     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11102     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11103     MOVE X'2020233030303130313238' TO DFHEIV0(25:11)
 11104     CALL 'kxdfhei1' USING DFHEIV0,
 11105           CERT-FILE-ID,
 11106           CERTIFICATE-MASTER,
 11107           DFHEIV11,
 11108           CERT-KEY,
 11109           DFHEIV99,
 11110           DFHEIV99
 11111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11112
 11113
 11114 2050-EXIT.
 11115     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 204
* EL131.cbl
 11117 2060-CHANGE-CERT.
 11118     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11119     MOVE PI-CARRIER             TO CERT-CARRIER.
 11120     MOVE PI-GROUPING            TO CERT-GROUP.
 11121     MOVE PI-STATE               TO CERT-STATE.
 11122     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11123     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11124     MOVE PI-CERT-NO             TO CERT-CERT.
 11125     IF CERTEFFI GREATER THAN LOW-VALUES
 11126         MOVE HOLD-EFF           TO CERT-DATE.
 11127     IF CERTACTI GREATER THAN LOW-VALUES
 11128         MOVE CERTACTI           TO CERT-ACCOUNT.
 11129     IF CERTSTI GREATER THAN LOW-VALUES
 11130         MOVE CERTSTI            TO CERT-STATE.
 11131     IF CERTCARI GREATER THAN LOW-VALUES
 11132         MOVE CERTCARI           TO CERT-CARRIER.
 11133     IF CERTGRPI GREATER THAN LOW-VALUES
 11134         MOVE CERTGRPI           TO CERT-GROUP.
 11135     IF CERTI GREATER THAN LOW-VALUES
 11136         MOVE CERTI              TO CERT-CERT-PRIME.
 11137     IF SUFXI GREATER THAN LOW-VALUES
 11138         MOVE SUFXI              TO CERT-CERT-SUFX.
 11139
 11140
 11141* EXEC CICS HANDLE CONDITION
 11142*         NOTFND   (2060-CERT-NOTFND)
 11143*    END-EXEC.
 11144*    MOVE '"$I                   ! 0 #00010160' TO DFHEIV0
 11145     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11146     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11147     MOVE X'3020233030303130313630' TO DFHEIV0(25:11)
 11148     CALL 'kxdfhei1' USING DFHEIV0
 11149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11150
 11151
 11152
 11153* EXEC CICS READ UPDATE
 11154*         DATASET  (CERT-FILE-ID)
 11155*         RIDFLD   (CERT-KEY)
 11156*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11157*    END-EXEC.
 11158*    MOVE '&"S        EU         (   #00010164' TO DFHEIV0
 11159     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11160     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11161     MOVE X'2020233030303130313634' TO DFHEIV0(25:11)
 11162     CALL 'kxdfhei1' USING DFHEIV0,
 11163           CERT-FILE-ID,
 11164           DFHEIV20,
 11165           DFHEIV99,
 11166           CERT-KEY,
 11167           DFHEIV99,
 11168           DFHEIV99,
 11169           DFHEIV99
 11170     SET ADDRESS OF CERTIFICATE-MASTER TO
 11171         DFHEIV20
 11172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11173
 11174
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 205
* EL131.cbl
 11175     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11176
 11177     IF CM-CLAIM-INTERFACE-SW = SPACES
 11178        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11179
 11180
 11181* EXEC CICS HANDLE CONDITION
 11182*         DUPKEY   (2060-DUPKEY)
 11183*    END-EXEC.
 11184*    MOVE '"$$                   ! 1 #00010175' TO DFHEIV0
 11185     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11186     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11187     MOVE X'3120233030303130313735' TO DFHEIV0(25:11)
 11188     CALL 'kxdfhei1' USING DFHEIV0
 11189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11190
 11191
 11192
 11193* EXEC CICS REWRITE
 11194*         DATASET  (CERT-FILE-ID)
 11195*         FROM     (CERTIFICATE-MASTER)
 11196*    END-EXEC.
 11197     MOVE LENGTH OF
 11198      CERTIFICATE-MASTER
 11199       TO DFHEIV11
 11200*    MOVE '&& L                  %   #00010179' TO DFHEIV0
 11201     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11202     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11203     MOVE X'2020233030303130313739' TO DFHEIV0(25:11)
 11204     CALL 'kxdfhei1' USING DFHEIV0,
 11205           CERT-FILE-ID,
 11206           CERTIFICATE-MASTER,
 11207           DFHEIV11,
 11208           DFHEIV99
 11209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11210
 11211
 11212 2060-DUPKEY.
 11213
 11214     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11215
 11216 2060-CHANGE-TRLR-ACTQ.
 11217     IF SCREEN-ERROR
 11218         GO TO 2060-EXIT.
 11219
 11220     IF CERTI    GREATER LOW-VALUES OR
 11221        SUFXI    GREATER LOW-VALUES OR
 11222        CERTCARI GREATER LOW-VALUES
 11223         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11224         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11225
 11226     MOVE SPACES                 TO CERT-KEY-SWITCH
 11227                                    CERT-SWITCH
 11228                                    TRLR-SWITCH
 11229                                    NINETY-TRLR-SWITCH.
 11230     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11231     GO TO 2060-EXIT.
 11232
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 206
* EL131.cbl
 11233 2060-CERT-NOTFND.
 11234     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11235
 11236     IF WS-REC-FOUND-SW = 'N'
 11237         MOVE ER-0206            TO  EMI-ERROR
 11238         MOVE -1                 TO  MAINTL
 11239         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11240
 11241* EXEC CICS UNLOCK
 11242*            DATASET   (CLMS-FILE-ID)
 11243*        END-EXEC
 11244*    MOVE '&*                    #   #00010212' TO DFHEIV0
 11245     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11246     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11247     MOVE X'2020233030303130323132' TO DFHEIV0(25:11)
 11248     CALL 'kxdfhei1' USING DFHEIV0,
 11249           CLMS-FILE-ID,
 11250           DFHEIV99
 11251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11252         GO TO 8110-SEND-DATA.
 11253
 11254     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11255
 11256     GO TO 2060-CHANGE-TRLR-ACTQ.
 11257
 11258 2060-EXIT.
 11259     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 207
* EL131.cbl
 11261 2070-CHECK-OLD.
 11262
 11263
 11264* EXEC CICS HANDLE CONDITION
 11265*        NOTFND   (2070-NOT-FOUND)
 11266*    END-EXEC.
 11267*    MOVE '"$I                   ! 2 #00010226' TO DFHEIV0
 11268     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11269     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11270     MOVE X'3220233030303130323236' TO DFHEIV0(25:11)
 11271     CALL 'kxdfhei1' USING DFHEIV0
 11272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11273
 11274
 11275     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11276     MOVE PI-CARRIER             TO CERT-CARRIER.
 11277     MOVE PI-GROUPING            TO CERT-GROUP.
 11278     MOVE PI-STATE               TO CERT-STATE.
 11279     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11280     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11281     MOVE PI-CERT-NO             TO CERT-CERT.
 11282
 11283
 11284* EXEC CICS READ UPDATE
 11285*         DATASET  (CERT-FILE-ID)
 11286*         RIDFLD   (CERT-KEY)
 11287*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11288*    END-EXEC.
 11289*    MOVE '&"S        EU         (   #00010238' TO DFHEIV0
 11290     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11291     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11292     MOVE X'2020233030303130323338' TO DFHEIV0(25:11)
 11293     CALL 'kxdfhei1' USING DFHEIV0,
 11294           CERT-FILE-ID,
 11295           DFHEIV20,
 11296           DFHEIV99,
 11297           CERT-KEY,
 11298           DFHEIV99,
 11299           DFHEIV99,
 11300           DFHEIV99
 11301     SET ADDRESS OF CERTIFICATE-MASTER TO
 11302         DFHEIV20
 11303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11304
 11305
 11306     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11307     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11308     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11309
 11310     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11311         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11312
 11313     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11314       AND
 11315        CERT-WAS-CREATED-FOR-CLAIM
 11316         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11317
 11318* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 208
* EL131.cbl
 11319*             DATASET   (CERT-FILE-ID)
 11320*        END-EXEC
 11321*    MOVE '&(                    &   #00010255' TO DFHEIV0
 11322     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11323     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11324     MOVE X'2020233030303130323535' TO DFHEIV0(25:11)
 11325     CALL 'kxdfhei1' USING DFHEIV0,
 11326           CERT-FILE-ID,
 11327           DFHEIV99,
 11328           DFHEIV99,
 11329           DFHEIV99,
 11330           DFHEIV99
 11331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11332         GO TO 2070-EXIT.
 11333
 11334     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11335         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11336
 11337
 11338* EXEC CICS HANDLE CONDITION
 11339*         DUPKEY   (2070-EXIT)
 11340*    END-EXEC.
 11341*    MOVE '"$$                   ! 3 #00010263' TO DFHEIV0
 11342     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11343     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11344     MOVE X'3320233030303130323633' TO DFHEIV0(25:11)
 11345     CALL 'kxdfhei1' USING DFHEIV0
 11346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11347
 11348
 11349
 11350* EXEC CICS REWRITE
 11351*         DATASET  (CERT-FILE-ID)
 11352*         FROM     (CERTIFICATE-MASTER)
 11353*    END-EXEC.
 11354     MOVE LENGTH OF
 11355      CERTIFICATE-MASTER
 11356       TO DFHEIV11
 11357*    MOVE '&& L                  %   #00010267' TO DFHEIV0
 11358     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11359     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11360     MOVE X'2020233030303130323637' TO DFHEIV0(25:11)
 11361     CALL 'kxdfhei1' USING DFHEIV0,
 11362           CERT-FILE-ID,
 11363           CERTIFICATE-MASTER,
 11364           DFHEIV11,
 11365           DFHEIV99
 11366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11367
 11368
 11369     GO TO 2070-EXIT.
 11370
 11371 2070-NOT-FOUND.
 11372     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11373
 11374 2070-EXIT.
 11375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 209
* EL131.cbl
 11377 2080-CREATE-CERT.
 11378
 11379* EXEC CICS GETMAIN
 11380*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11381*         LENGTH    (CERT-LENGTH)
 11382*         INITIMG   (GETMAIN-SPACE)
 11383*    END-EXEC.
 11384*    MOVE ',"IL                  $   #00010281' TO DFHEIV0
 11385     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11386     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11387     MOVE X'2020233030303130323831' TO DFHEIV0(25:11)
 11388     CALL 'kxdfhei1' USING DFHEIV0,
 11389           DFHEIV20,
 11390           CERT-LENGTH,
 11391           GETMAIN-SPACE
 11392     SET ADDRESS OF CERTIFICATE-MASTER TO
 11393         DFHEIV20
 11394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11395
 11396
 11397     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11398
 11399     IF CERTEFFI GREATER THAN LOW-VALUES
 11400         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11401                                    DC-BIN-DATE-1
 11402         MOVE '6'                TO DC-OPTION-CODE
 11403         MOVE +1                 TO DC-ELAPSED-MONTHS
 11404         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11405         IF NO-CONVERSION-ERROR
 11406             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11407
 11408     IF CERTACTI GREATER THAN LOW-VALUES
 11409         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11410     IF CERTSTI GREATER THAN LOW-VALUES
 11411         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11412     IF CERTCARI GREATER THAN LOW-VALUES
 11413         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11414     IF CERTGRPI GREATER THAN LOW-VALUES
 11415         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11416     IF CERTI GREATER THAN LOW-VALUES
 11417         MOVE CERTI              TO CERT-CERT-PRIME
 11418                                    CM-CERT-PRIME
 11419         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11420
 11421     IF SUFXI GREATER THAN LOW-VALUES
 11422         MOVE SUFXI              TO CERT-CERT-SUFX
 11423                                    CM-CERT-SFX
 11424         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11425
 11426     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11427
 11428     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11429
 11430     MOVE SPACES                 TO CM-ENTRY-BATCH
 11431                                    CM-LF-EXIT-BATCH
 11432                                    CM-AH-EXIT-BATCH
 11433                                    CM-CREDIT-INTERFACE-SW-1
 11434                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 210
* EL131.cbl
 11435
 11436     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11437                               '9' OR 'D' OR 'V'
 11438         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11439
 11440     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11441                               '9' OR 'D' OR 'V'
 11442         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11443
 11444     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11445                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11446     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11447
 11448
 11449* EXEC CICS HANDLE CONDITION
 11450*         DUPKEY (2080-EXIT)
 11451*    END-EXEC.
 11452*    MOVE '"$$                   ! 4 #00010338' TO DFHEIV0
 11453     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11455     MOVE X'3420233030303130333338' TO DFHEIV0(25:11)
 11456     CALL 'kxdfhei1' USING DFHEIV0
 11457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11458
 11459
 11460
 11461* EXEC CICS WRITE
 11462*         DATASET  (CERT-FILE-ID)
 11463*         RIDFLD   (CERT-KEY)
 11464*         FROM     (CERTIFICATE-MASTER)
 11465*    END-EXEC.
 11466     MOVE LENGTH OF
 11467      CERTIFICATE-MASTER
 11468       TO DFHEIV11
 11469*    MOVE '&$ L                  ''   #00010342' TO DFHEIV0
 11470     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11471     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11472     MOVE X'2020233030303130333432' TO DFHEIV0(25:11)
 11473     CALL 'kxdfhei1' USING DFHEIV0,
 11474           CERT-FILE-ID,
 11475           CERTIFICATE-MASTER,
 11476           DFHEIV11,
 11477           CERT-KEY,
 11478           DFHEIV99,
 11479           DFHEIV99
 11480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11481
 11482
 11483 2080-EXIT.
 11484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 211
* EL131.cbl
 11486 2100-MOVE-MSTR.
 11487     IF TYPEI GREATER THAN LOW-VALUES
 11488         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11489
 11490     IF STATUSI = LOW-VALUES
 11491         GO TO 2100-NO-STATUS-CHANGE.
 11492
 11493     IF STATUSI = 'OPEN' OR 'O'
 11494         IF CL-CLAIM-STATUS = 'O'
 11495             MOVE SPACES         TO TRLR-SWITCH
 11496                 GO TO 2100-NO-STATUS-CHANGE.
 11497
 11498     IF STATUSI = 'CLOSED' OR 'C'
 11499         IF CL-CLAIM-STATUS = 'C'
 11500             MOVE SPACES         TO TRLR-SWITCH
 11501                 GO TO 2100-NO-STATUS-CHANGE.
 11502
 11503     IF PI-COMPANY-ID = 'DMD'
 11504        IF STATUSI = 'OPEN' OR 'O'
 11505           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11506              MOVE ZERO       TO STATUSL
 11507              MOVE LOW-VALUES TO STATUSI
 11508              GO TO 2100-NO-STATUS-CHANGE.
 11509
 11510     IF PI-COMPANY-ID = 'DMD'
 11511         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11512
 11513     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11514
 11515 2100-NO-STATUS-CHANGE.
 11516
 11517     IF CCNOI GREATER THAN LOW-VALUES
 11518         MOVE CCNOI              TO CL-CCN.
 11519
 11520     IF PROCI GREATER THAN LOW-VALUES
 11521         MOVE PROCI              TO CL-PROCESSOR-ID.
 11522
 11523     if (accswi > low-values)
 11524        and (accswi = 'Y' OR 'N')
 11525        move accswi              to cl-accident-claim-sw
 11526     end-if
 11527     if benperi > low-values
 11528        and benperi numeric
 11529        move benperi             to cl-benefit-period
 11530     end-if
 11531     if instypei > low-values
 11532        move instypei            to cl-insured-type
 11533     end-if
 11534     IF SEXI GREATER THAN LOW-VALUES
 11535         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11536
 11537     IF BIRTHI GREATER THAN LOW-VALUES
 11538         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11539
 11540     IF SOCIALI GREATER THAN LOW-VALUES
 11541       AND
 11542        SOCIALI = SPACES
 11543         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 212
* EL131.cbl
 11544         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11545         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11546     ELSE
 11547         IF SOCIALI GREATER THAN LOW-VALUES
 11548             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11549
 11550     IF OCCI GREATER THAN LOW-VALUES
 11551         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11552
 11553     IF BENEL GREATER THAN ZERO
 11554         MOVE BENEI              TO CL-BENEFICIARY.
 11555
 11556     IF DIAGI GREATER THAN LOW-VALUES
 11557         MOVE DIAGI              TO WS-DIAGNOSIS.
 11558
 11559     IF ICD1I GREATER THAN LOW-VALUES
 11560         MOVE ICD1I              TO WS-ICD-CODE-1
 11561     END-IF.
 11562
 11563     IF ICD2I GREATER THAN LOW-VALUES
 11564         MOVE ICD2I              TO WS-ICD-CODE-2
 11565     END-IF.
 11566
 11567     IF PREMTYPI GREATER THAN LOW-VALUES
 11568         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11569
 11570*    IF CAUSEI GREATER THAN LOW-VALUES
 11571*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11572
 11573*    IF ENDI GREATER THAN LOW-VALUES
 11574*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11575
 11576     IF PDTHRUI GREATER THAN LOW-VALUES
 11577        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11578
 11579     IF PDAMTL GREATER THAN +0
 11580        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11581
 11582     IF NODAYSI GREATER THAN LOW-VALUES
 11583        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11584
 11585     IF NOPMTSI GREATER THAN LOW-VALUES
 11586        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11587
 11588     IF FORMTYPI GREATER THAN LOW-VALUES
 11589        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11590
 11591     IF INCI GREATER THAN LOW-VALUES
 11592        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11593
 11594     IF REPI GREATER THAN LOW-VALUES
 11595        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11596
 11597     IF ADDONDTI GREATER THAN LOW-VALUES
 11598        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11599
 11600     IF PRICDI GREATER THAN LOW-VALUES
 11601         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 213
* EL131.cbl
 11602
 11603     IF CRITPL  > ZEROS
 11604        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11605     END-IF
 11606
 11607     IF EXTENSL  > ZEROS
 11608        MOVE EXTENSI             TO CL-NO-OF-EXTENSIONS
 11609     END-IF
 11610*    IF CRITPTL > ZEROS
 11611*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11612*    END-IF
 11613
 11614*    IF RTWMOSL > ZEROS
 11615*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11616*    END-IF
 11617     IF FILETOI GREATER THAN LOW-VALUES
 11618         MOVE FILETOI            TO CL-FILE-LOCATION.
 11619
 11620     IF SUPVI GREATER THAN LOW-VALUES
 11621         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11622
 11623     IF MLNAMEI GREATER THAN LOW-VALUES
 11624         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11625
 11626     IF MFNAMEI GREATER THAN LOW-VALUES
 11627         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11628
 11629     IF MMINITI GREATER THAN LOW-VALUES
 11630         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11631
 11632     IF CERTEFFI GREATER THAN LOW-VALUES
 11633         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11634
 11635     IF CERTACTI GREATER THAN LOW-VALUES
 11636         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11637
 11638     IF CERTSTI GREATER THAN LOW-VALUES
 11639         MOVE CERTSTI            TO CL-CERT-STATE.
 11640
 11641     IF CERTCARI GREATER THAN LOW-VALUES
 11642         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11643                                    CL-CARRIER.
 11644
 11645     IF CERTGRPI GREATER THAN LOW-VALUES
 11646         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11647
 11648     IF CERTI GREATER THAN LOW-VALUES
 11649         MOVE CERTI              TO CERT-NO-PRIME.
 11650
 11651     IF SUFXI GREATER THAN LOW-VALUES
 11652         MOVE SUFXI              TO CERT-NO-SUFX.
 11653
 11654     MOVE CERT-NO                TO CL-CERT-NO
 11655                                    CL-CERT-NO-A4.
 11656
 11657     IF PI-COMPANY-ID = 'FLA'
 11658          NEXT SENTENCE
 11659     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 214
* EL131.cbl
 11660         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11661         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11662         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 11663         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11664
 11665     IF TRLR-UPDATE-REQUIRED
 11666        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11667        MOVE ZEROS              TO TRLR-SEQ-NO
 11668
 11669* EXEC CICS READ
 11670*            DATASET   (TRLR-FILE-ID)
 11671*            RIDFLD    (TRLR-KEY)
 11672*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11673*       END-EXEC
 11674*    MOVE '&"S        E          (   #00010533' TO DFHEIV0
 11675     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11677     MOVE X'2020233030303130353333' TO DFHEIV0(25:11)
 11678     CALL 'kxdfhei1' USING DFHEIV0,
 11679           TRLR-FILE-ID,
 11680           DFHEIV20,
 11681           DFHEIV99,
 11682           TRLR-KEY,
 11683           DFHEIV99,
 11684           DFHEIV99,
 11685           DFHEIV99
 11686     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11687         DFHEIV20
 11688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11689        IF AT-TRAILER-TYPE = '1'
 11690           MOVE +1 TO MISC-SUB
 11691           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11692           MISC-SUB GREATER THAN +6 OR
 11693           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11694           IF MISC-SUB GREATER THAN +1
 11695              SUBTRACT +1 FROM MISC-SUB
 11696              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11697                 GO TO 2100-BYPASS-LAST-UPDATE.
 11698
 11699     IF TRLR-UPDATE-REQUIRED AND
 11700        CLAIM-IS-OPEN
 11701         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11702     ELSE
 11703         IF TRLR-UPDATE-REQUIRED AND
 11704            CLAIM-IS-CLOSED
 11705             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11706             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11707
 11708 2100-BYPASS-LAST-UPDATE.
 11709     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11710     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11711
 11712     GO TO 2100-EXIT.
 11713
 11714 2100-BUMP-OPEN-CLOSE-HIST.
 11715     ADD +1                      TO MISC-SUB.
 11716
 11717 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 215
* EL131.cbl
 11718     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 216
* EL131.cbl
 11720 2120-check-pdef.
 11721     move +0                     to s1
 11722     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11723     move spaces                 to ws-dcc-error-line
 11724     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11725     IF ERPDEF-FOUND
 11726        perform 2130-check-trlr  thru 2130-exit
 11727        move +1                  to s1
 11728*       if cl-accident-claim-sw = ' '
 11729*          move er-1655             to ws-error-no (s1)
 11730*          add +1 to s1
 11731*       end-if
 11732        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11733        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11734        if (hold-incur > low-values)
 11735           and (incl > zeros)
 11736           and (hold-incur not = cl-incurred-dt)
 11737           move hold-incur       to dc-bin-date-2
 11738        end-if
 11739        MOVE '1'                 TO DC-OPTION-CODE
 11740        MOVE +0                  TO DC-ELAPSED-MONTHS
 11741                                    DC-ELAPSED-DAYS
 11742        PERFORM 9800-CONVERT-DATE
 11743                                 THRU 9800-EXIT
 11744        IF NO-CONVERSION-ERROR
 11745           MOVE DC-ELAPSED-MONTHS
 11746                                 TO WS-MONTHS-BETWEEN
 11747           IF DC-ELAPSED-DAYS > 1
 11748              ADD 1 TO WS-MONTHS-BETWEEN
 11749           END-IF
 11750        ELSE
 11751           display ' dte conv error ' dc-error-code
 11752           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11753        END-IF
 11754        IF (WS-EXCL-PERIOD = ZEROS)
 11755           OR (WS-MONTHS-BETWEEN = ZEROS)
 11756           CONTINUE
 11757        ELSE
 11758           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11759              MOVE ER-1651       TO ws-error-no (s1)
 11760              add +1             to s1
 11761           END-IF
 11762        END-IF
 11763        IF (WS-COV-ENDS = ZEROS)
 11764           OR (WS-MONTHS-BETWEEN = ZEROS)
 11765           CONTINUE
 11766        ELSE
 11767           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11768              MOVE -1            TO MAINTL
 11769              MOVE ER-1653       TO ws-error-no (s1)
 11770              add +1 to s1
 11771           END-IF
 11772        END-IF
 11773        IF (WS-ACC-PERIOD = ZEROS)
 11774           OR (WS-MONTHS-BETWEEN = ZEROS)
 11775           CONTINUE
 11776        ELSE
 11777           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 217
* EL131.cbl
 11778              and (accswi = spaces or low-values)
 11779*             and (cl-accident-claim-sw = ' ')
 11780              move er-1655       to ws-error-no (s1)
 11781              add +1             to s1
 11782           end-if
 11783           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11784*             if (cl-accident-claim-sw not = 'Y')
 11785              if (accswi not = 'Y')
 11786                 MOVE ER-1652    TO ws-error-no (s1)
 11787              else
 11788                 move er-1662    to ws-error-no (s1)
 11789              end-if
 11790              MOVE -1            TO MAINTL
 11791              add +1             to s1
 11792           END-IF
 11793        END-IF
 11794        if cl-claim-type  = 'I'
 11795           move er-1661          to ws-error-no (s1)
 11796           add +1                to s1
 11797        end-if
 11798        perform 2130-check-trlr  thru 2130-exit
 11799     END-IF
 11800
 11801     .
 11802 2120-exit.
 11803     exit.
 11804
 11805 2130-check-trlr.
 11806
 11807     evaluate true
 11808        when s1 = +0
 11809           move cl-control-primary
 11810                                 to trlr-key
 11811           MOVE +95              TO TRLR-SEQ-NO
 11812
 11813* EXEC CICS READ
 11814*             update
 11815*             DATASET  ('ELTRLR')
 11816*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11817*             RIDFLD   (TRLR-KEY)
 11818*             RESP     (WS-RESPONSE)
 11819*          END-EXEC
 11820     MOVE 'ELTRLR' TO DFHEIV1
 11821*    MOVE '&"S        EU         (  N#00010661' TO DFHEIV0
 11822     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11823     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11824     MOVE X'204E233030303130363631' TO DFHEIV0(25:11)
 11825     CALL 'kxdfhei1' USING DFHEIV0,
 11826           DFHEIV1,
 11827           DFHEIV20,
 11828           DFHEIV99,
 11829           TRLR-KEY,
 11830           DFHEIV99,
 11831           DFHEIV99,
 11832           DFHEIV99
 11833     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11834         DFHEIV20
 11835     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 218
* EL131.cbl
 11836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11837           if ws-resp-normal
 11838              move spaces        to at-info-line-1
 11839           end-if
 11840        when s1 = +1
 11841           if ws-resp-normal
 11842
 11843* exec cics rewrite
 11844*                dataset   ('ELTRLR')
 11845*                from      (activity-trailers)
 11846*             end-exec
 11847     MOVE LENGTH OF
 11848      activity-trailers
 11849       TO DFHEIV11
 11850     MOVE 'ELTRLR' TO DFHEIV1
 11851*    MOVE '&& L                  %   #00010673' TO DFHEIV0
 11852     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11853     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11854     MOVE X'2020233030303130363733' TO DFHEIV0(25:11)
 11855     CALL 'kxdfhei1' USING DFHEIV0,
 11856           DFHEIV1,
 11857           activity-trailers,
 11858           DFHEIV11,
 11859           DFHEIV99
 11860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11861           end-if
 11862        when s1 > +1
 11863           if ws-resp-normal
 11864              move ws-dcc-error-line
 11865                                 to at-info-line-1
 11866
 11867* exec cics rewrite
 11868*                dataset   ('ELTRLR')
 11869*                from      (activity-trailers)
 11870*             end-exec
 11871     MOVE LENGTH OF
 11872      activity-trailers
 11873       TO DFHEIV11
 11874     MOVE 'ELTRLR' TO DFHEIV1
 11875*    MOVE '&& L                  %   #00010682' TO DFHEIV0
 11876     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11877     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11878     MOVE X'2020233030303130363832' TO DFHEIV0(25:11)
 11879     CALL 'kxdfhei1' USING DFHEIV0,
 11880           DFHEIV1,
 11881           activity-trailers,
 11882           DFHEIV11,
 11883           DFHEIV99
 11884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11885           else
 11886
 11887* EXEC CICS GETMAIN
 11888*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11889*                LENGTH   (TRLR-LENGTH)
 11890*                INITIMG  (GETMAIN-SPACE)
 11891*             END-EXEC
 11892*    MOVE ',"IL                  $   #00010687' TO DFHEIV0
 11893     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 219
* EL131.cbl
 11894     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11895     MOVE X'2020233030303130363837' TO DFHEIV0(25:11)
 11896     CALL 'kxdfhei1' USING DFHEIV0,
 11897           DFHEIV20,
 11898           TRLR-LENGTH,
 11899           GETMAIN-SPACE
 11900     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11901         DFHEIV20
 11902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11903              move 'AT'          to at-record-id
 11904              move cl-control-primary
 11905                                 to at-control-primary
 11906              move +95           to at-sequence-no
 11907              move '6'           to at-trailer-type
 11908              move ws-dcc-error-line
 11909                                 to at-info-line-1
 11910              move 'E'           to at-info-trailer-type
 11911              move save-bin-date to at-recorded-dt
 11912                                    at-gen-info-last-maint-dt
 11913              move pi-processor-id
 11914                                 to at-recorded-by
 11915                                    at-gen-info-last-updated-by
 11916              move eibtime       to at-last-maint-hhmmss
 11917
 11918* exec cics write
 11919*                dataset   ('ELTRLR')
 11920*                from      (activity-trailers)
 11921*                ridfld    (trlr-key)
 11922*             end-exec
 11923     MOVE LENGTH OF
 11924      activity-trailers
 11925       TO DFHEIV11
 11926     MOVE 'ELTRLR' TO DFHEIV1
 11927*    MOVE '&$ L                  ''   #00010706' TO DFHEIV0
 11928     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11929     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11930     MOVE X'2020233030303130373036' TO DFHEIV0(25:11)
 11931     CALL 'kxdfhei1' USING DFHEIV0,
 11932           DFHEIV1,
 11933           activity-trailers,
 11934           DFHEIV11,
 11935           trlr-key,
 11936           DFHEIV99,
 11937           DFHEIV99
 11938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11939              perform varying s1 from +1 by +1 until
 11940                 ws-error-no (s1) = spaces
 11941                 move ws-error-no (s1)
 11942                                 to emi-error
 11943                 PERFORM 9900-ERROR-FORMAT
 11944                                 THRU 9900-EXIT
 11945              end-perform
 11946           end-if
 11947     end-evaluate
 11948
 11949     .
 11950 2130-exit.
 11951     exit.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 220
* EL131.cbl
 11952 2140-update-elcrtt.
 11953     move ' '                    to crtt-switch
 11954     MOVE CERT-KEY               TO ELCRTT-KEY
 11955     MOVE 'B'                    TO CTRLR-REC-TYPE
 11956
 11957* EXEC CICS READ
 11958*       UPDATE
 11959*       DATASET   ('ELCRTT')
 11960*       RIDFLD    (ELCRTT-KEY)
 11961*       INTO      (CERTIFICATE-TRAILERS)
 11962*       RESP      (WS-RESPONSE)
 11963*    END-EXEC
 11964     MOVE LENGTH OF
 11965      CERTIFICATE-TRAILERS
 11966       TO DFHEIV11
 11967     MOVE 'ELCRTT' TO DFHEIV1
 11968*    MOVE '&"IL       EU         (  N#00010728' TO DFHEIV0
 11969     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11970     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11971     MOVE X'204E233030303130373238' TO DFHEIV0(25:11)
 11972     CALL 'kxdfhei1' USING DFHEIV0,
 11973           DFHEIV1,
 11974           CERTIFICATE-TRAILERS,
 11975           DFHEIV11,
 11976           ELCRTT-KEY,
 11977           DFHEIV99,
 11978           DFHEIV99,
 11979           DFHEIV99
 11980     MOVE EIBRESP  TO WS-RESPONSE
 11981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11982     IF WS-RESP-NORMAL
 11983        perform varying s1 from +1 by +1 until
 11984           (s1 > +24)
 11985           or (cs-claim-no (s1) = cl-claim-no)
 11986        end-perform
 11987        if (s1 < +25)
 11988           if (benperl <> zeros)
 11989              and (cs-benefit-period (s1) not = benperi)
 11990              move benperi       to cs-benefit-period (s1)
 11991              set crtt-update    to true
 11992          end-if
 11993          if (instypel <> zeros)
 11994             and (instypei not = cs-insured-type (s1))
 11995             move instypei      to cs-insured-type (s1)
 11996             set crtt-update    to true
 11997          end-if
 11998          move cs-claim-type (s1) to ws-claim-type
 11999          move cs-benefit-period (s1) to ws-ben-per
 12000        end-if
 12001        if crtt-update
 12002           perform 2150-accum    thru 2150-exit
 12003
 12004* EXEC CICS REWRITE
 12005*             DATASET   ('ELCRTT')
 12006*             FROM      (CERTIFICATE-TRAILERS)
 12007*          END-EXEC
 12008     MOVE LENGTH OF
 12009      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 221
* EL131.cbl
 12010       TO DFHEIV11
 12011     MOVE 'ELCRTT' TO DFHEIV1
 12012*    MOVE '&& L                  %   #00010756' TO DFHEIV0
 12013     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12014     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12015     MOVE X'2020233030303130373536' TO DFHEIV0(25:11)
 12016     CALL 'kxdfhei1' USING DFHEIV0,
 12017           DFHEIV1,
 12018           CERTIFICATE-TRAILERS,
 12019           DFHEIV11,
 12020           DFHEIV99
 12021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12022        else
 12023
 12024* exec cics unlock
 12025*             dataset   ('ELCRTT')
 12026*          end-exec
 12027     MOVE 'ELCRTT' TO DFHEIV1
 12028*    MOVE '&*                    #   #00010761' TO DFHEIV0
 12029     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12030     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12031     MOVE X'2020233030303130373631' TO DFHEIV0(25:11)
 12032     CALL 'kxdfhei1' USING DFHEIV0,
 12033           DFHEIV1,
 12034           DFHEIV99
 12035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12036        end-if
 12037     end-if
 12038     .
 12039 2140-exit.
 12040     exit.
 12041 2150-accum.
 12042     if not erpdef-found
 12043        perform 3997-get-erpdef  thru 3997-exit
 12044     end-if
 12045     if (erpdef-found)
 12046        and (ws-max-moben not = zeros)
 12047        and (ws-max-moben < cm-ah-benefit-amt)
 12048        continue
 12049     else
 12050        move cm-ah-benefit-amt   to ws-max-moben
 12051     end-if
 12052     move cm-ah-orig-term        to ws-max-bens
 12053     if cl-critical-period not = zeros and spaces
 12054        move cl-critical-period  to ws-max-bens
 12055     end-if
 12056     move zeros to ws-tot-days-paid ws-tot-amt-paid
 12057     perform varying s2 from +1 by +1 until
 12058        (s2 > +24)
 12059        or (cs-claim-no (s2) = spaces)
 12060        if (cs-benefit-period (s2) = ws-ben-per)
 12061           and (cs-claim-type (s2) = ws-claim-type)
 12062           and (cs-insured-type (s2) = cl-insured-type)
 12063*          compute ws-tot-days-paid =
 12064*             ws-tot-days-paid + cs-days-paid (s2)
 12065           compute ws-tot-amt-paid =
 12066              ws-tot-amt-paid + cs-total-paid (s2)
 12067        end-if
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 222
* EL131.cbl
 12068     end-perform
 12069     if s2 < +25
 12070        compute ws-pd-bens rounded =
 12071           ws-tot-amt-paid / ws-max-moben
 12072        compute cs-remaining-bens (s1) =
 12073           ws-max-bens - ws-pd-bens
 12074        if cs-remaining-bens (s1) < zeros
 12075           move zeros            to cs-remaining-bens (s1)
 12076        end-if
 12077     end-if
 12078     .
 12079 2150-exit.
 12080     exit.
 12081 2200-MOVE-CERT.
 12082     IF CRTLNMEI GREATER THAN LOW-VALUES
 12083         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 12084
 12085     IF CRTFNMEI GREATER THAN LOW-VALUES
 12086         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 12087         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 12088
 12089     IF CRTINITI GREATER THAN LOW-VALUES
 12090         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 12091
 12092     IF CM-INSURED-INITIALS = SPACES
 12093         MOVE '**'               TO CM-INSURED-INITIALS.
 12094
 12095     IF ISSAGEI GREATER THAN LOW-VALUES
 12096         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 12097
 12098     IF JNTFNMEI GREATER THAN LOW-VALUES
 12099         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 12100
 12101     IF JNTLNMEI GREATER THAN LOW-VALUES
 12102         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 12103
 12104     IF JNTINITI GREATER THAN LOW-VALUES
 12105         MOVE JNTINITI           TO CM-JT-INITIAL.
 12106
 12107     IF JNTAGEI GREATER THAN LOW-VALUES
 12108         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 12109
 12110     IF ADDONDTI GREATER THAN LOW-VALUES
 12111        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 12112
 12113     IF LCVCDI GREATER THAN LOW-VALUES
 12114        IF LCVCDI = SPACES OR ZEROS
 12115           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 12116        ELSE
 12117           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 12118
 12119     IF LCVOTRMI GREATER THAN LOW-VALUES
 12120         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 12121
 12122     IF LCVRATEL GREATER THAN +0
 12123         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 12124
 12125     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 223
* EL131.cbl
 12126         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 12127
 12128     IF LCVFORMI GREATER THAN LOW-VALUES
 12129         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 12130
 12131     IF LCVCNDTI = LOW-VALUES
 12132        GO TO 2210-SET-STATUS.
 12133
 12134     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 12135        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 12136        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 12137        GO TO 2210-SET-STATUS.
 12138
 12139     IF CM-LF-CURRENT-STATUS = '7'
 12140        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 12141        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 12142        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12143                                    CM-LF-DEATH-DT
 12144        GO TO 2210-SET-STATUS.
 12145
 12146     IF CM-LF-CURRENT-STATUS = '8'
 12147        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 12148        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12149                                    CM-LF-CANCEL-DT.
 12150
 12151 2210-SET-STATUS.
 12152
 12153     IF CM-LF-CURRENT-STATUS = SPACES
 12154         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 12155
 12156     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 12157         MOVE '6'                TO DC-OPTION-CODE
 12158         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12159         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12160         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12161         IF NO-CONVERSION-ERROR
 12162             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 12163         ELSE
 12164             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 12165     ELSE
 12166         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 12167
 12168 2215-PROCESS-AH-SIDE.
 12169
 12170     IF ACVCDI GREATER THAN LOW-VALUES
 12171        IF ACVCDI = SPACES OR ZEROS
 12172           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 12173        ELSE
 12174           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 12175
 12176     IF ACVOTRMI GREATER THAN LOW-VALUES
 12177         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12178
 12179     IF ACVRATEL GREATER THAN +0
 12180         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12181
 12182     IF ACVBENEL GREATER THAN +0
 12183         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 224
* EL131.cbl
 12184                                    PI-PAYMENT-AMT.
 12185
 12186     IF ACVFORMI GREATER THAN LOW-VALUES
 12187         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12188
 12189     IF ACVCNDTI = LOW-VALUES
 12190        GO TO 2220-SET-STATUS.
 12191
 12192     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12193        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12194        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12195        GO TO 2220-SET-STATUS.
 12196
 12197     IF CM-AH-CURRENT-STATUS = '6'
 12198        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12199                                 TO CM-AH-CURRENT-STATUS
 12200        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12201        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12202                                    CM-AH-SETTLEMENT-DT
 12203        GO TO 2220-SET-STATUS.
 12204
 12205     IF CM-AH-CURRENT-STATUS = '8'
 12206        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12207        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12208                                    CM-AH-CANCEL-DT.
 12209
 12210 2220-SET-STATUS.
 12211     IF CM-AH-CURRENT-STATUS = SPACES
 12212         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12213
 12214     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12215         MOVE '6'                TO DC-OPTION-CODE
 12216         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12217         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12218         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12219         IF NO-CONVERSION-ERROR
 12220             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12221         ELSE
 12222             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12223     ELSE
 12224         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12225
 12226 2225-FINISH-CERT.
 12227     IF APRL GREATER THAN +0
 12228         MOVE HOLD-APR           TO CM-LOAN-APR.
 12229
 12230     IF PMTFREQI GREATER THAN LOW-VALUES
 12231         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12232
 12233     IF INDGRPI GREATER THAN LOW-VALUES
 12234         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12235
 12236*    IF LOANNOI GREATER THAN LOW-VALUES
 12237*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12238
 12239     IF LOANBALL GREATER THAN +0
 12240        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12241
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 225
* EL131.cbl
 12242     IF PREMTYPI GREATER THAN LOW-VALUES
 12243         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12244
 12245     IF REINCDI GREATER THAN LOW-VALUES
 12246         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12247                                    WS-REIN-1
 12248                                    WS-REIN-2
 12249                                    WS-REIN-3
 12250         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12251
 12252     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12253
 12254     MOVE ZEROS                  TO CM-LOAN-TERM
 12255                                    CM-LIFE-COMM-PCT
 12256                                    CM-AH-COMM-PCT.
 12257
 12258*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12259*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12260*         PI-NO-PMTS = ZEROS
 12261*          IF LOANBALL GREATER THAN +0          OR
 12262*             ACVBENEL GREATER THAN +0          OR
 12263*             APRL     GREATER THAN +0          OR
 12264*             LCVRATEL GREATER THAN +0          OR
 12265*             ACVRATEL GREATER THAN +0
 12266*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12267
 12268 2200-EXIT.
 12269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 226
* EL131.cbl
 12271 2300-UPDATE-TRLR.
 12272     MOVE ZERO                   TO TRLR-SEQ-NO.
 12273
 12274* EXEC CICS READ UPDATE
 12275*         DATASET  (TRLR-FILE-ID)
 12276*         RIDFLD   (TRLR-KEY)
 12277*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12278*    END-EXEC.
 12279*    MOVE '&"S        EU         (   #00011001' TO DFHEIV0
 12280     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12281     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12282     MOVE X'2020233030303131303031' TO DFHEIV0(25:11)
 12283     CALL 'kxdfhei1' USING DFHEIV0,
 12284           TRLR-FILE-ID,
 12285           DFHEIV20,
 12286           DFHEIV99,
 12287           TRLR-KEY,
 12288           DFHEIV99,
 12289           DFHEIV99,
 12290           DFHEIV99
 12291     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12292         DFHEIV20
 12293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12294
 12295
 12296     MOVE ZERO                   TO COUNT-2.
 12297
 12298     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12299         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12300
 12301     IF NOT UPDATE-MADE
 12302         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12303
 12304
 12305* EXEC CICS REWRITE
 12306*         DATASET  (TRLR-FILE-ID)
 12307*         FROM     (ACTIVITY-TRAILERS)
 12308*    END-EXEC.
 12309     MOVE LENGTH OF
 12310      ACTIVITY-TRAILERS
 12311       TO DFHEIV11
 12312*    MOVE '&& L                  %   #00011015' TO DFHEIV0
 12313     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12314     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12315     MOVE X'2020233030303131303135' TO DFHEIV0(25:11)
 12316     CALL 'kxdfhei1' USING DFHEIV0,
 12317           TRLR-FILE-ID,
 12318           ACTIVITY-TRAILERS,
 12319           DFHEIV11,
 12320           DFHEIV99
 12321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12322
 12323
 12324 2300-EXIT.
 12325     EXIT.
 12326
 12327 2310-INS-STATUS.
 12328     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 227
* EL131.cbl
 12329     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12330         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12331         MOVE 'Y'                TO TRLR-SWITCH.
 12332
 12333 2310-EXIT.
 12334     EXIT.
 12335
 12336 2320-SHIFT-STATUS.
 12337     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12338        MOVE 6                   TO COUNT-2
 12339        GO TO 2320-EXIT.
 12340
 12341     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12342     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12343     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12344     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12345     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12346     MOVE 6       TO COUNT-2.
 12347     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12348
 12349 2320-EXIT.
 12350     EXIT.
 12351
 12352 2330-ADD-UPDATE.
 12353
 12354     IF COUNT-2 GREATER THAN 1
 12355        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12356        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12357           GO TO 2330-EXIT.
 12358
 12359     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12360                                   AT-RESERVES-LAST-MAINT-DT
 12361
 12362     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12363     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12364     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12365     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12366
 12367 2330-EXIT.
 12368     EXIT.
 12369
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 228
* EL131.cbl
 12371 2400-UPDATE-TRLR.
 12372
 12373* EXEC CICS HANDLE CONDITION
 12374*         NOTFND    (2400-TRLR-NOTFND)
 12375*         ENDFILE   (2410-EXIT)
 12376*    END-EXEC.
 12377*    MOVE '"$I''                  ! 5 #00011068' TO DFHEIV0
 12378     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12380     MOVE X'3520233030303131303638' TO DFHEIV0(25:11)
 12381     CALL 'kxdfhei1' USING DFHEIV0
 12382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12383
 12384
 12385
 12386* EXEC CICS STARTBR
 12387*        DATASET (TRLR-FILE-ID)
 12388*        RIDFLD  (TRLR-KEY)
 12389*    END-EXEC.
 12390     MOVE 0
 12391       TO DFHEIV11
 12392*    MOVE '&,         G          &   #00011073' TO DFHEIV0
 12393     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12394     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12395     MOVE X'2020233030303131303733' TO DFHEIV0(25:11)
 12396     CALL 'kxdfhei1' USING DFHEIV0,
 12397           TRLR-FILE-ID,
 12398           TRLR-KEY,
 12399           DFHEIV99,
 12400           DFHEIV11,
 12401           DFHEIV99
 12402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12403
 12404
 12405
 12406* EXEC CICS GETMAIN
 12407*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12408*         LENGTH    (TRLR-LENGTH)
 12409*         INITIMG   (GETMAIN-SPACE)
 12410*    END-EXEC.
 12411*    MOVE ',"IL                  $   #00011078' TO DFHEIV0
 12412     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12413     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12414     MOVE X'2020233030303131303738' TO DFHEIV0(25:11)
 12415     CALL 'kxdfhei1' USING DFHEIV0,
 12416           DFHEIV20,
 12417           TRLR-LENGTH,
 12418           GETMAIN-SPACE
 12419     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12420         DFHEIV20
 12421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12422
 12423
 12424     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12425
 12426
 12427* EXEC CICS ENDBR
 12428*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 229
* EL131.cbl
 12429*    END-EXEC.
 12430     MOVE 0
 12431       TO DFHEIV11
 12432*    MOVE '&2                    $   #00011086' TO DFHEIV0
 12433     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12434     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12435     MOVE X'2020233030303131303836' TO DFHEIV0(25:11)
 12436     CALL 'kxdfhei1' USING DFHEIV0,
 12437           TRLR-FILE-ID,
 12438           DFHEIV11,
 12439           DFHEIV99
 12440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12441
 12442
 12443     GO TO 2400-EXIT.
 12444
 12445 2400-TRLR-NOTFND.
 12446     MOVE ER-0205                TO EMI-ERROR.
 12447     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12448     MOVE 'X'                    TO ERROR-SWITCH.
 12449
 12450 2400-EXIT.
 12451     EXIT.
 12452
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 230
* EL131.cbl
 12454 2410-CHANGE-TRLR.
 12455
 12456* EXEC CICS READNEXT
 12457*        DATASET (TRLR-FILE-ID)
 12458*        RIDFLD  (TRLR-KEY)
 12459*        INTO    (ACTIVITY-TRAILERS)
 12460*    END-EXEC.
 12461     MOVE LENGTH OF
 12462      ACTIVITY-TRAILERS
 12463       TO DFHEIV12
 12464     MOVE 0
 12465       TO DFHEIV11
 12466*    MOVE '&.IL                  )   #00011102' TO DFHEIV0
 12467     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12468     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12469     MOVE X'2020233030303131313032' TO DFHEIV0(25:11)
 12470     CALL 'kxdfhei1' USING DFHEIV0,
 12471           TRLR-FILE-ID,
 12472           ACTIVITY-TRAILERS,
 12473           DFHEIV12,
 12474           TRLR-KEY,
 12475           DFHEIV99,
 12476           DFHEIV11,
 12477           DFHEIV99,
 12478           DFHEIV99
 12479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12480
 12481
 12482     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12483        GO TO 2410-CHANGE-TRLR.
 12484
 12485     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12486                                    CHECK-KEY.
 12487
 12488     IF CHECK-KEY NOT = MSTR-KEY
 12489         GO TO 2410-EXIT.
 12490
 12491
 12492* EXEC CICS ENDBR
 12493*        DATASET (TRLR-FILE-ID)
 12494*    END-EXEC.
 12495     MOVE 0
 12496       TO DFHEIV11
 12497*    MOVE '&2                    $   #00011117' TO DFHEIV0
 12498     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12499     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12500     MOVE X'2020233030303131313137' TO DFHEIV0(25:11)
 12501     CALL 'kxdfhei1' USING DFHEIV0,
 12502           TRLR-FILE-ID,
 12503           DFHEIV11,
 12504           DFHEIV99
 12505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12506
 12507
 12508
 12509* EXEC CICS READ UPDATE
 12510*        DATASET (TRLR-FILE-ID)
 12511*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 231
* EL131.cbl
 12512*        INTO    (ACTIVITY-TRAILERS)
 12513*    END-EXEC.
 12514     MOVE LENGTH OF
 12515      ACTIVITY-TRAILERS
 12516       TO DFHEIV11
 12517*    MOVE '&"IL       EU         (   #00011121' TO DFHEIV0
 12518     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12519     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12520     MOVE X'2020233030303131313231' TO DFHEIV0(25:11)
 12521     CALL 'kxdfhei1' USING DFHEIV0,
 12522           TRLR-FILE-ID,
 12523           ACTIVITY-TRAILERS,
 12524           DFHEIV11,
 12525           TRLR-KEY,
 12526           DFHEIV99,
 12527           DFHEIV99,
 12528           DFHEIV99
 12529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12530
 12531
 12532
 12533* EXEC CICS DELETE
 12534*        DATASET (TRLR-FILE-ID)
 12535*    END-EXEC.
 12536*    MOVE '&(                    &   #00011127' TO DFHEIV0
 12537     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12538     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12539     MOVE X'2020233030303131313237' TO DFHEIV0(25:11)
 12540     CALL 'kxdfhei1' USING DFHEIV0,
 12541           TRLR-FILE-ID,
 12542           DFHEIV99,
 12543           DFHEIV99,
 12544           DFHEIV99,
 12545           DFHEIV99
 12546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12547
 12548
 12549     IF AT-SEQUENCE-NO = ZERO AND
 12550        TRLR-UPDATE-REQUIRED
 12551         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12552
 12553     IF CERTI GREATER THAN LOW-VALUES
 12554        MOVE CERTI               TO AT-CERT-PRIME.
 12555
 12556     IF SUFXI GREATER THAN LOW-VALUES
 12557        MOVE SUFXI               TO AT-CERT-SFX.
 12558
 12559     IF CERTCARI GREATER THAN LOW-VALUES
 12560        MOVE CERTCARI            TO AT-CARRIER.
 12561
 12562     IF PAYMENT-TR
 12563        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12564           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12565              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12566
 12567     IF CORRESPONDENCE-TR
 12568        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12569           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 232
* EL131.cbl
 12570
 12571
 12572* EXEC CICS WRITE
 12573*         DATASET  (TRLR-FILE-ID)
 12574*         RIDFLD   (AT-CONTROL-PRIMARY)
 12575*         FROM     (ACTIVITY-TRAILERS)
 12576*    END-EXEC.
 12577     MOVE LENGTH OF
 12578      ACTIVITY-TRAILERS
 12579       TO DFHEIV11
 12580*    MOVE '&$ L                  ''   #00011153' TO DFHEIV0
 12581     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12582     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12583     MOVE X'2020233030303131313533' TO DFHEIV0(25:11)
 12584     CALL 'kxdfhei1' USING DFHEIV0,
 12585           TRLR-FILE-ID,
 12586           ACTIVITY-TRAILERS,
 12587           DFHEIV11,
 12588           AT-CONTROL-PRIMARY,
 12589           DFHEIV99,
 12590           DFHEIV99
 12591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12592
 12593
 12594
 12595* EXEC CICS STARTBR
 12596*         DATASET  (TRLR-FILE-ID)
 12597*         RIDFLD   (TRLR-KEY)
 12598*    END-EXEC.
 12599     MOVE 0
 12600       TO DFHEIV11
 12601*    MOVE '&,         G          &   #00011159' TO DFHEIV0
 12602     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12603     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12604     MOVE X'2020233030303131313539' TO DFHEIV0(25:11)
 12605     CALL 'kxdfhei1' USING DFHEIV0,
 12606           TRLR-FILE-ID,
 12607           TRLR-KEY,
 12608           DFHEIV99,
 12609           DFHEIV11,
 12610           DFHEIV99
 12611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12612
 12613
 12614     GO TO 2410-CHANGE-TRLR.
 12615
 12616 2410-EXIT.
 12617     EXIT.
 12618
 12619 2420-UPDATE-TRLR.
 12620     MOVE ZERO TO COUNT-2.
 12621     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12622         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12623
 12624     IF NOT UPDATE-MADE
 12625         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12626
 12627 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 233
* EL131.cbl
 12628     EXIT.
 12629
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 234
* EL131.cbl
 12631 2425-UPDATE-NINETY-TRLR.
 12632
 12633     MOVE +90                    TO TRLR-SEQ-NO.
 12634
 12635
 12636* EXEC CICS HANDLE CONDITION
 12637*         NOTFND    (2425-NINETY-NOTFND)
 12638*         ENDFILE   (2425-NINETY-NOTFND)
 12639*    END-EXEC.
 12640*    MOVE '"$I''                  ! 6 #00011185' TO DFHEIV0
 12641     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12643     MOVE X'3620233030303131313835' TO DFHEIV0(25:11)
 12644     CALL 'kxdfhei1' USING DFHEIV0
 12645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12646
 12647
 12648
 12649* EXEC CICS READ UPDATE
 12650*        DATASET (TRLR-FILE-ID)
 12651*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12652*        RIDFLD  (TRLR-KEY)
 12653*    END-EXEC.
 12654*    MOVE '&"S        EU         (   #00011190' TO DFHEIV0
 12655     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12656     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12657     MOVE X'2020233030303131313930' TO DFHEIV0(25:11)
 12658     CALL 'kxdfhei1' USING DFHEIV0,
 12659           TRLR-FILE-ID,
 12660           DFHEIV20,
 12661           DFHEIV99,
 12662           TRLR-KEY,
 12663           DFHEIV99,
 12664           DFHEIV99,
 12665           DFHEIV99
 12666     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12667         DFHEIV20
 12668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12669
 12670     if (diagi > low-values)
 12671        and (diagi not = at-info-line-1)
 12672        and (cl-total-paid-amt > zeros)
 12673        move cl-cert-eff-dt      to dc-bin-date-1
 12674        move cl-paid-thru-dt     to dc-bin-date-2
 12675        move '1'                 to dc-option-code
 12676        perform 9800-convert-date
 12677                                 thru 9800-exit
 12678        if no-conversion-error
 12679           and dc-elapsed-months < +24
 12680           and (not emi-bypass-forcables)
 12681           move er-1581          to emi-error
 12682           perform 9900-error-format
 12683                                thru 9900-exit
 12684           move -1              to diagl
 12685           go to 8110-send-data
 12686        end-if
 12687     end-if
 12688     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 235
* EL131.cbl
 12689     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12690     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12691
 12692     IF DIAGI GREATER THAN LOW-VALUES
 12693         MOVE DIAGI             TO AT-INFO-LINE-1
 12694     END-IF.
 12695
 12696     IF ICD1I GREATER THAN LOW-VALUES
 12697         MOVE ICD1I             TO AT-ICD-CODE-1
 12698     END-IF.
 12699
 12700     IF ICD2I GREATER THAN LOW-VALUES
 12701         MOVE ICD2I             TO AT-ICD-CODE-2
 12702     END-IF.
 12703
 12704
 12705* EXEC CICS REWRITE
 12706*        DATASET (TRLR-FILE-ID)
 12707*        FROM    (ACTIVITY-TRAILERS)
 12708*    END-EXEC.
 12709     MOVE LENGTH OF
 12710      ACTIVITY-TRAILERS
 12711       TO DFHEIV11
 12712*    MOVE '&& L                  %   #00011229' TO DFHEIV0
 12713     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12714     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12715     MOVE X'2020233030303131323239' TO DFHEIV0(25:11)
 12716     CALL 'kxdfhei1' USING DFHEIV0,
 12717           TRLR-FILE-ID,
 12718           ACTIVITY-TRAILERS,
 12719           DFHEIV11,
 12720           DFHEIV99
 12721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12722
 12723
 12724     IF DIAGI GREATER THAN LOW-VALUES
 12725       AND DIAGI NOT = WS-DIAGNOSIS
 12726         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12727         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12728         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12729
 12730     IF ICD1I GREATER THAN LOW-VALUES
 12731       AND ICD1I NOT = WS-ICD-CODE-1
 12732         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12733         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12734         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12735     END-IF.
 12736
 12737     IF ICD2I GREATER THAN LOW-VALUES
 12738       AND ICD2I NOT = WS-ICD-CODE-2
 12739         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12740         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12741         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12742     END-IF.
 12743
 12744     GO TO 2425-EXIT.
 12745
 12746 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 236
* EL131.cbl
 12747
 12748
 12749* EXEC CICS GETMAIN
 12750*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12751*         LENGTH    (TRLR-LENGTH)
 12752*         INITIMG   (GETMAIN-SPACE)
 12753*    END-EXEC.
 12754*    MOVE ',"IL                  $   #00011258' TO DFHEIV0
 12755     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12756     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12757     MOVE X'2020233030303131323538' TO DFHEIV0(25:11)
 12758     CALL 'kxdfhei1' USING DFHEIV0,
 12759           DFHEIV20,
 12760           TRLR-LENGTH,
 12761           GETMAIN-SPACE
 12762     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12763         DFHEIV20
 12764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12765
 12766
 12767     MOVE +90                  TO TRLR-SEQ-NO.
 12768     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12769
 12770     MOVE 'AT'                 TO AT-RECORD-ID
 12771     MOVE '6'                  TO AT-TRAILER-TYPE
 12772     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12773                                  AT-GEN-INFO-LAST-MAINT-DT
 12774     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12775                                  AT-GEN-INFO-LAST-UPDATED-BY
 12776     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12777     MOVE DIAGI                TO AT-INFO-LINE-1.
 12778     MOVE ICD1I                TO AT-ICD-CODE-1.
 12779     MOVE ICD2I                TO AT-ICD-CODE-2.
 12780
 12781
 12782* EXEC CICS WRITE
 12783*        DATASET (TRLR-FILE-ID)
 12784*        FROM    (ACTIVITY-TRAILERS)
 12785*        RIDFLD  (TRLR-KEY)
 12786*    END-EXEC.
 12787     MOVE LENGTH OF
 12788      ACTIVITY-TRAILERS
 12789       TO DFHEIV11
 12790*    MOVE '&$ L                  ''   #00011278' TO DFHEIV0
 12791     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12792     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12793     MOVE X'2020233030303131323738' TO DFHEIV0(25:11)
 12794     CALL 'kxdfhei1' USING DFHEIV0,
 12795           TRLR-FILE-ID,
 12796           ACTIVITY-TRAILERS,
 12797           DFHEIV11,
 12798           TRLR-KEY,
 12799           DFHEIV99,
 12800           DFHEIV99
 12801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12802
 12803
 12804 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 237
* EL131.cbl
 12805     EXIT.
 12806
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 238
* EL131.cbl
 12808 2430-UPDATE-ACTQ.
 12809
 12810* EXEC CICS HANDLE CONDITION
 12811*         NOTFND    (2430-EXIT)
 12812*         ENDFILE   (2440-EXIT)
 12813*    END-EXEC.
 12814*    MOVE '"$I''                  ! 7 #00011289' TO DFHEIV0
 12815     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12817     MOVE X'3720233030303131323839' TO DFHEIV0(25:11)
 12818     CALL 'kxdfhei1' USING DFHEIV0
 12819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12820
 12821
 12822
 12823* EXEC CICS STARTBR
 12824*         DATASET  (ACTQ-FILE-ID)
 12825*         RIDFLD   (ACTQ-KEY)
 12826*    END-EXEC.
 12827     MOVE 0
 12828       TO DFHEIV11
 12829*    MOVE '&,         G          &   #00011294' TO DFHEIV0
 12830     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12831     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12832     MOVE X'2020233030303131323934' TO DFHEIV0(25:11)
 12833     CALL 'kxdfhei1' USING DFHEIV0,
 12834           ACTQ-FILE-ID,
 12835           ACTQ-KEY,
 12836           DFHEIV99,
 12837           DFHEIV11,
 12838           DFHEIV99
 12839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12840
 12841
 12842
 12843* EXEC CICS GETMAIN
 12844*         SET      (ADDRESS OF ACTIVITY-QUE)
 12845*         LENGTH   (ACTQ-LENGTH)
 12846*         INITIMG  (GETMAIN-SPACE)
 12847*    END-EXEC.
 12848*    MOVE ',"IL                  $   #00011299' TO DFHEIV0
 12849     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12850     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12851     MOVE X'2020233030303131323939' TO DFHEIV0(25:11)
 12852     CALL 'kxdfhei1' USING DFHEIV0,
 12853           DFHEIV20,
 12854           ACTQ-LENGTH,
 12855           GETMAIN-SPACE
 12856     SET ADDRESS OF ACTIVITY-QUE TO
 12857         DFHEIV20
 12858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12859
 12860
 12861     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12862
 12863 2430-EXIT.
 12864     EXIT.
 12865
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 239
* EL131.cbl
 12866 2440-CHANGE-ACTQ.
 12867
 12868
 12869* EXEC CICS READNEXT
 12870*         DATASET  (ACTQ-FILE-ID)
 12871*         RIDFLD   (ACTQ-KEY)
 12872*         INTO     (ACTIVITY-QUE)
 12873*    END-EXEC.
 12874     MOVE LENGTH OF
 12875      ACTIVITY-QUE
 12876       TO DFHEIV12
 12877     MOVE 0
 12878       TO DFHEIV11
 12879*    MOVE '&.IL                  )   #00011312' TO DFHEIV0
 12880     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12881     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12882     MOVE X'2020233030303131333132' TO DFHEIV0(25:11)
 12883     CALL 'kxdfhei1' USING DFHEIV0,
 12884           ACTQ-FILE-ID,
 12885           ACTIVITY-QUE,
 12886           DFHEIV12,
 12887           ACTQ-KEY,
 12888           DFHEIV99,
 12889           DFHEIV11,
 12890           DFHEIV99,
 12891           DFHEIV99
 12892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12893
 12894
 12895
 12896* EXEC CICS ENDBR
 12897*         DATASET (ACTQ-FILE-ID)
 12898*    END-EXEC.
 12899     MOVE 0
 12900       TO DFHEIV11
 12901*    MOVE '&2                    $   #00011318' TO DFHEIV0
 12902     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12904     MOVE X'2020233030303131333138' TO DFHEIV0(25:11)
 12905     CALL 'kxdfhei1' USING DFHEIV0,
 12906           ACTQ-FILE-ID,
 12907           DFHEIV11,
 12908           DFHEIV99
 12909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12910
 12911
 12912     IF ACTQ-KEY NOT = MSTR-KEY
 12913         GO TO 2440-EXIT.
 12914
 12915
 12916* EXEC CICS READ UPDATE
 12917*         DATASET  (ACTQ-FILE-ID)
 12918*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12919*         SET      (ADDRESS OF ACTIVITY-QUE)
 12920*    END-EXEC.
 12921*    MOVE '&"S        EU         (   #00011325' TO DFHEIV0
 12922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12923     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 240
* EL131.cbl
 12924     MOVE X'2020233030303131333235' TO DFHEIV0(25:11)
 12925     CALL 'kxdfhei1' USING DFHEIV0,
 12926           ACTQ-FILE-ID,
 12927           DFHEIV20,
 12928           DFHEIV99,
 12929           AQ-CONTROL-PRIMARY,
 12930           DFHEIV99,
 12931           DFHEIV99,
 12932           DFHEIV99
 12933     SET ADDRESS OF ACTIVITY-QUE TO
 12934         DFHEIV20
 12935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12936
 12937
 12938     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12939
 12940
 12941* EXEC CICS DELETE
 12942*         DATASET (ACTQ-FILE-ID)
 12943*    END-EXEC.
 12944*    MOVE '&(                    &   #00011333' TO DFHEIV0
 12945     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12946     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12947     MOVE X'2020233030303131333333' TO DFHEIV0(25:11)
 12948     CALL 'kxdfhei1' USING DFHEIV0,
 12949           ACTQ-FILE-ID,
 12950           DFHEIV99,
 12951           DFHEIV99,
 12952           DFHEIV99,
 12953           DFHEIV99
 12954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12955
 12956
 12957     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12958     IF CERTI GREATER THAN LOW-VALUES
 12959        MOVE CERTI               TO AQ-CERT-PRIME.
 12960     IF SUFXI GREATER THAN LOW-VALUES
 12961        MOVE SUFXI               TO AQ-CERT-SFX.
 12962     IF CERTCARI GREATER THAN LOW-VALUES
 12963        MOVE CERTCARI            TO AQ-CARRIER.
 12964
 12965
 12966* EXEC CICS HANDLE CONDITION
 12967*         DUPREC   (2440-EXIT)
 12968*    END-EXEC.
 12969*    MOVE '"$%                   ! 8 #00011345' TO DFHEIV0
 12970     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12972     MOVE X'3820233030303131333435' TO DFHEIV0(25:11)
 12973     CALL 'kxdfhei1' USING DFHEIV0
 12974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12975
 12976
 12977
 12978* EXEC CICS WRITE
 12979*         DATASET  (ACTQ-FILE-ID)
 12980*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12981*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 241
* EL131.cbl
 12982*    END-EXEC.
 12983     MOVE LENGTH OF
 12984      ACTIVITY-QUE
 12985       TO DFHEIV11
 12986*    MOVE '&$ L                  ''   #00011349' TO DFHEIV0
 12987     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12988     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12989     MOVE X'2020233030303131333439' TO DFHEIV0(25:11)
 12990     CALL 'kxdfhei1' USING DFHEIV0,
 12991           ACTQ-FILE-ID,
 12992           ACTIVITY-QUE,
 12993           DFHEIV11,
 12994           AQ-CONTROL-PRIMARY,
 12995           DFHEIV99,
 12996           DFHEIV99
 12997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12998
 12999
 13000 2440-EXIT.
 13001     EXIT.
 13002
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 242
* EL131.cbl
 13004 2460-UPDATE-CHECKQ.
 13005
 13006* EXEC CICS HANDLE CONDITION
 13007*         NOTFND   (2460-EXIT)
 13008*    END-EXEC.
 13009*    MOVE '"$I                   ! 9 #00011360' TO DFHEIV0
 13010     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13012     MOVE X'3920233030303131333630' TO DFHEIV0(25:11)
 13013     CALL 'kxdfhei1' USING DFHEIV0
 13014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13015
 13016
 13017     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 13018     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 13019     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 13020
 13021
 13022* EXEC CICS READ UPDATE
 13023*         DATASET   (CHKQ-FILE-ID)
 13024*         RIDFLD    (CHKQ-KEY)
 13025*         SET       (ADDRESS OF CHECK-QUE)
 13026*    END-EXEC.
 13027*    MOVE '&"S        EU         (   #00011368' TO DFHEIV0
 13028     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13029     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13030     MOVE X'2020233030303131333638' TO DFHEIV0(25:11)
 13031     CALL 'kxdfhei1' USING DFHEIV0,
 13032           CHKQ-FILE-ID,
 13033           DFHEIV20,
 13034           DFHEIV99,
 13035           CHKQ-KEY,
 13036           DFHEIV99,
 13037           DFHEIV99,
 13038           DFHEIV99
 13039     SET ADDRESS OF CHECK-QUE TO
 13040         DFHEIV20
 13041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13042
 13043
 13044     IF CERTI GREATER THAN LOW-VALUES
 13045        MOVE CERTI               TO CQ-CERT-PRIME.
 13046     IF SUFXI GREATER THAN LOW-VALUES
 13047        MOVE SUFXI               TO CQ-CERT-SFX.
 13048     IF CERTCARI GREATER THAN LOW-VALUES
 13049        MOVE CERTCARI            TO CQ-CARRIER.
 13050
 13051
 13052* EXEC CICS REWRITE
 13053*         DATASET  (CHKQ-FILE-ID)
 13054*         FROM     (CHECK-QUE)
 13055*    END-EXEC.
 13056     MOVE LENGTH OF
 13057      CHECK-QUE
 13058       TO DFHEIV11
 13059*    MOVE '&& L                  %   #00011381' TO DFHEIV0
 13060     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13061     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 243
* EL131.cbl
 13062     MOVE X'2020233030303131333831' TO DFHEIV0(25:11)
 13063     CALL 'kxdfhei1' USING DFHEIV0,
 13064           CHKQ-FILE-ID,
 13065           CHECK-QUE,
 13066           DFHEIV11,
 13067           DFHEIV99
 13068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13069
 13070
 13071 2460-EXIT.
 13072     EXIT.
 13073
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 244
* EL131.cbl
 13075 2475-UPDATE-LETTER.
 13076
 13077* EXEC CICS HANDLE CONDITION
 13078*         NOTFND   (2475-EXIT)
 13079*    END-EXEC.
 13080*    MOVE '"$I                   ! : #00011391' TO DFHEIV0
 13081     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13083     MOVE X'3A20233030303131333931' TO DFHEIV0(25:11)
 13084     CALL 'kxdfhei1' USING DFHEIV0
 13085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13086
 13087
 13088     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 13089     MOVE '1'                    TO ARCH-RECORD-TYPE.
 13090     MOVE ZEROS                  TO ARCH-SEQ-NO.
 13091     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 13092
 13093
 13094* EXEC CICS READ UPDATE
 13095*         DATASET   (ARCH-FILE-ID)
 13096*         RIDFLD    (ARCH-KEY)
 13097*         SET       (ADDRESS OF LETTER-ARCHIVE)
 13098*    END-EXEC.
 13099*    MOVE '&"S        EU         (   #00011400' TO DFHEIV0
 13100     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13101     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13102     MOVE X'2020233030303131343030' TO DFHEIV0(25:11)
 13103     CALL 'kxdfhei1' USING DFHEIV0,
 13104           ARCH-FILE-ID,
 13105           DFHEIV20,
 13106           DFHEIV99,
 13107           ARCH-KEY,
 13108           DFHEIV99,
 13109           DFHEIV99,
 13110           DFHEIV99
 13111     SET ADDRESS OF LETTER-ARCHIVE TO
 13112         DFHEIV20
 13113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13114
 13115
 13116* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 13117* TO THIS MASTER-KEY INFORMATION.
 13118
 13119     IF LA-CARRIER  = CARRIER-CODE AND
 13120        LA-CLAIM-NO = CLAIM-NO     AND
 13121        LA-CERT-NO  = CERT-NO
 13122        NEXT SENTENCE
 13123     ELSE
 13124        GO TO 2475-UNLOCK.
 13125
 13126     IF CERTI GREATER THAN LOW-VALUES
 13127        MOVE CERTI               TO LA-CERT-PRIME.
 13128     IF SUFXI GREATER THAN LOW-VALUES
 13129        MOVE SUFXI               TO LA-CERT-SFX.
 13130     IF CERTCARI GREATER THAN LOW-VALUES
 13131        MOVE CERTCARI            TO LA-CARRIER.
 13132
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 245
* EL131.cbl
 13133
 13134* EXEC CICS REWRITE
 13135*         DATASET  (ARCH-FILE-ID)
 13136*         FROM     (LETTER-ARCHIVE)
 13137*    END-EXEC.
 13138     MOVE LENGTH OF
 13139      LETTER-ARCHIVE
 13140       TO DFHEIV11
 13141*    MOVE '&& L                  %   #00011423' TO DFHEIV0
 13142     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13143     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13144     MOVE X'2020233030303131343233' TO DFHEIV0(25:11)
 13145     CALL 'kxdfhei1' USING DFHEIV0,
 13146           ARCH-FILE-ID,
 13147           LETTER-ARCHIVE,
 13148           DFHEIV11,
 13149           DFHEIV99
 13150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13151
 13152
 13153     GO TO 2475-EXIT.
 13154
 13155 2475-UNLOCK.
 13156
 13157* EXEC CICS UNLOCK
 13158*         DATASET  (ARCH-FILE-ID)
 13159*    END-EXEC.
 13160*    MOVE '&*                    #   #00011431' TO DFHEIV0
 13161     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13162     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13163     MOVE X'2020233030303131343331' TO DFHEIV0(25:11)
 13164     CALL 'kxdfhei1' USING DFHEIV0,
 13165           ARCH-FILE-ID,
 13166           DFHEIV99
 13167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13168
 13169
 13170 2475-EXIT.
 13171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 246
* EL131.cbl
 13173 2600-CREATE-MAINT-NOTE.
 13174     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13175     MOVE '1'                    TO CNTL-REC-TYPE.
 13176     MOVE SPACES                 TO CNTL-PROC-ID.
 13177     MOVE ZERO                   TO CNTL-SEQ-NO.
 13178
 13179
 13180* EXEC CICS READ
 13181*         SET        (ADDRESS OF CONTROL-FILE)
 13182*         DATASET    ('ELCNTL')
 13183*         RIDFLD     (CNTL-KEY)
 13184*    END-EXEC.
 13185     MOVE 'ELCNTL' TO DFHEIV1
 13186*    MOVE '&"S        E          (   #00011444' TO DFHEIV0
 13187     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13188     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13189     MOVE X'2020233030303131343434' TO DFHEIV0(25:11)
 13190     CALL 'kxdfhei1' USING DFHEIV0,
 13191           DFHEIV1,
 13192           DFHEIV20,
 13193           DFHEIV99,
 13194           CNTL-KEY,
 13195           DFHEIV99,
 13196           DFHEIV99,
 13197           DFHEIV99
 13198     SET ADDRESS OF CONTROL-FILE TO
 13199         DFHEIV20
 13200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13201
 13202
 13203     IF CO-NO-USE-AUDIT-CHANGES
 13204         GO TO 2600-EXIT.
 13205
 13206     IF PROCL GREATER ZERO
 13207     IF PROCI NOT = LOW-VALUES
 13208     IF PROCI NOT = CL-PROCESSOR-ID
 13209         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13210         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13211         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13212
 13213     IF SEXL GREATER ZERO
 13214     IF SEXI NOT = LOW-VALUES
 13215     IF SEXI NOT = CL-INSURED-SEX-CD
 13216         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13217         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13218         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13219
 13220     IF BIRTHL GREATER ZERO
 13221     IF HOLD-BIRTH NOT = LOW-VALUES
 13222     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13223         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13224         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13225         MOVE SPACES               TO DC-OPTION-CODE
 13226         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13227         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13228         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13229
 13230     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 247
* EL131.cbl
 13231     IF SOCIALI NOT = LOW-VALUES
 13232     IF SOCIALI NOT = CL-SOC-SEC-NO
 13233         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13234         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13235         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13236
 13237     IF OCCL GREATER ZERO
 13238     IF OCCI NOT = LOW-VALUES
 13239     IF OCCI NOT = CL-INSURED-OCC-CD
 13240         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13241         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13242         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13243
 13244     IF BENEL GREATER ZERO
 13245     IF BENEI NOT = LOW-VALUES
 13246     IF BENEI NOT = CL-BENEFICIARY
 13247         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13248         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13249         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13250
 13251     IF PREMTYPL GREATER ZERO
 13252     IF PREMTYPI NOT = LOW-VALUES
 13253     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13254         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13255         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13256         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13257
 13258*    IF CAUSEL GREATER ZERO
 13259*    IF CAUSEI NOT = LOW-VALUES
 13260*    IF CAUSEI NOT = CL-CAUSE-CD
 13261*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13262*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13263*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13264
 13265*    IF ENDL GREATER ZERO
 13266*    IF HOLD-END NOT = LOW-VALUES
 13267*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13268*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13269*        MOVE CL-EST-END-OF-DISAB-DT
 13270*                                  TO DC-BIN-DATE-1
 13271*        MOVE SPACES               TO DC-OPTION-CODE
 13272*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13273*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13274*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13275
 13276     IF PDTHRUL GREATER ZERO
 13277     IF HOLD-PDTHRU NOT = LOW-VALUES
 13278     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13279         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13280         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13281         MOVE SPACES               TO DC-OPTION-CODE
 13282         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13283         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13284         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13285
 13286     IF PDAMTL GREATER ZERO
 13287     IF HOLD-PDAMT NOT = ZEROS
 13288     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 248
* EL131.cbl
 13289         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13290         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13291         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13292         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13293
 13294     IF NODAYSL GREATER ZERO
 13295     IF HOLD-NODAYS NOT = ZEROS
 13296     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13297         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13298         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13299         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13300         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13301
 13302     IF NOPMTSL GREATER ZERO
 13303     IF HOLD-NOPMTS NOT = ZEROS
 13304     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13305         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13306         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13307         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13308         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13309
 13310     IF FORMTYPL GREATER ZERO
 13311     IF FORMTYPI NOT = LOW-VALUES
 13312     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13313         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13314         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13315         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13316
 13317     IF REPL GREATER ZERO
 13318     IF HOLD-REPORTED NOT = LOW-VALUES
 13319     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13320         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13321         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13322         MOVE SPACES               TO DC-OPTION-CODE
 13323         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13324         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13325         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13326
 13327     IF ADDONDTL GREATER ZERO
 13328     IF HOLD-ADDON NOT = LOW-VALUES
 13329     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13330         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13331         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13332         MOVE SPACES               TO DC-OPTION-CODE
 13333         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13334         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13335         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13336
 13337     IF PRICDL GREATER ZERO
 13338     IF PRICDI NOT = LOW-VALUES
 13339     IF PRICDI NOT = CL-PRIORITY-CD
 13340         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13341         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13342         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13343
 13344     IF FILETOL GREATER ZERO
 13345     IF FILETOI NOT = LOW-VALUES
 13346     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 249
* EL131.cbl
 13347         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13348         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13349         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13350
 13351     IF SUPVL GREATER ZERO
 13352     IF SUPVI NOT = LOW-VALUES
 13353     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13354         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13355         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13356         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13357*    IF (CRITPTL > ZERO)
 13358*       AND (CRITPTI NOT = LOW-VALUES)
 13359*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13360*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13361*       MOVE CL-CRIT-PER-RECURRENT
 13362*                                TO SPLIT-INFO-OLD
 13363*       PERFORM 2650-WRITE-MAINT-NOTE
 13364*                                THRU 2650-EXIT
 13365*    END-IF
 13366
 13367*    IF (RTWMOSL > ZERO)
 13368*       AND (RTWMOSI NOT = LOW-VALUES)
 13369*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13370*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13371*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13372*       PERFORM 2650-WRITE-MAINT-NOTE
 13373*                                THRU 2650-EXIT
 13374*    END-IF
 13375     IF MLNAMEL GREATER ZERO
 13376     IF MLNAMEI NOT = LOW-VALUES
 13377     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13378         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13379         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13380         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13381
 13382     IF MFNAMEL GREATER ZERO
 13383     IF MFNAMEI NOT = LOW-VALUES
 13384     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13385         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13386         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13387         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13388
 13389     IF MMINITL GREATER ZERO
 13390     IF MMINITI NOT = LOW-VALUES
 13391     IF MMINITI NOT = CL-INSURED-MID-INIT
 13392         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13393         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13394         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13395
 13396     IF CERTEFFL GREATER ZERO
 13397     IF HOLD-EFF NOT = LOW-VALUES
 13398     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13399         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13400         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13401         MOVE SPACES               TO DC-OPTION-CODE
 13402         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13403         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13404         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 250
* EL131.cbl
 13405
 13406     IF CERTACTL GREATER ZERO
 13407     IF CERTACTI NOT = LOW-VALUES
 13408     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13409         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13410         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13411         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13412
 13413     IF CERTSTL GREATER ZERO
 13414     IF CERTSTI NOT = LOW-VALUES
 13415     IF CERTSTI NOT = CL-CERT-STATE
 13416         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13417         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13418         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13419
 13420     IF CERTCARL GREATER ZERO
 13421     IF CERTCARI NOT = LOW-VALUES
 13422     IF CERTCARI NOT = CL-CERT-CARRIER
 13423         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13424         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13425         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13426
 13427     IF CERTGRPL GREATER ZERO
 13428     IF CERTGRPI NOT = LOW-VALUES
 13429     IF CERTGRPI NOT = CL-CERT-GROUPING
 13430         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13431         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13432         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13433
 13434     IF CERTL GREATER ZERO OR
 13435        SUFXL GREATER ZERO
 13436     IF (CERTI NOT = LOW-VALUES AND
 13437                     CL-CERT-PRIME)
 13438                OR
 13439        (SUFXI NOT = LOW-VALUES AND
 13440                     CL-CERT-SFX)
 13441         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13442         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13443         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13444     IF incl > zeros
 13445        IF (HOLD-INCUR NOT = LOW-VALUES)
 13446           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13447           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13448           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13449           MOVE SPACES           TO DC-OPTION-CODE
 13450           PERFORM 9800-CONVERT-DATE
 13451                                 THRU 9800-EXIT
 13452           MOVE DC-GREG-DATE-1-EDIT
 13453                                 TO SPLIT-INFO-OLD
 13454           PERFORM 2650-WRITE-MAINT-NOTE
 13455                                 THRU 2650-EXIT
 13456        END-IF
 13457     END-IF
 13458     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 13459       IF (REPL GREATER ZERO
 13460         AND HOLD-REPORTED NOT = LOW-VALUES
 13461         AND HOLD-REPORTED NOT = CL-REPORTED-DT)
 13462        OR (incl > zeros
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 251
* EL131.cbl
 13463          AND (HOLD-INCUR NOT = LOW-VALUES)
 13464             AND (HOLD-INCUR NOT = CL-INCURRED-DT))
 13465          PERFORM 2610-CHECK-2-YEAR-CONTESTABLE THRU 2610-EXIT
 13466       END-IF
 13467     END-IF
 13468*052918IF incl > zeros
 13469*052918  AND PI-COMPANY-ID = 'CID'
 13470*052918   IF (HOLD-INCUR NOT = LOW-VALUES)
 13471*052918      AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13472*052918      IF TYPEI = PI-AH-OVERRIDE-L1
 13473*052918         SET ELAPSED-BETWEEN-BIN TO TRUE
 13474*052918         MOVE ZERO               TO DC-ELAPSED-MONTHS
 13475*052918                                    DC-ELAPSED-DAYS
 13476*052918
 13477*052918         MOVE HOLD-INCUR  TO DC-BIN-DATE-1
 13478*052918         MOVE SAVE-BIN-DATE TO DC-BIN-DATE-2
 13479*052918         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13480*052918         IF DC-ODD-DAYS-OVER > ZERO
 13481*052918            ADD 1 TO DC-ELAPSED-MONTHS
 13482*052918         END-IF
 13483*052918
 13484*052918         IF PI-STATE = 'HI'
 13485*052918           AND DC-ELAPSED-MONTHS <= 18
 13486*052918            CONTINUE
 13487*052918         ELSE
 13488*052918            IF DC-ELAPSED-MONTHS > 15
 13489*052918               MOVE ER-7572            TO EMI-ERROR
 13490*052918               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13491*052918            END-IF
 13492*052918         END-IF
 13493*052918         PERFORM 2620-CHECK-TRLR THRU 2620-EXIT
 13494*052918      END-IF
 13495*052918   END-IF
 13496*052918END-IF
 13497     .
 13498 2600-EXIT.
 13499      EXIT.
 13500 2610-CHECK-2-YEAR-CONTESTABLE.
 13501     SET ELAPSED-BETWEEN-BIN TO TRUE
 13502     MOVE ZERO               TO DC-ELAPSED-MONTHS
 13503                                DC-ELAPSED-DAYS
 13504
 13505     MOVE HOLD-EFF TO DC-BIN-DATE-1.
 13506     IF HOLD-INCUR > SPACES
 13507        MOVE HOLD-INCUR TO DC-BIN-DATE-2
 13508     ELSE
 13509        MOVE CL-INCURRED-DT TO DC-BIN-DATE-2
 13510     END-IF
 13511     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13512     IF DC-ODD-DAYS-OVER > ZERO
 13513        ADD 1 TO DC-ELAPSED-MONTHS
 13514     END-IF
 13515
 13516     IF DC-ELAPSED-MONTHS <= 24
 13517        IF HOLD-REPORTED > SPACES
 13518           MOVE HOLD-REPORTED TO DC-BIN-DATE-2
 13519        ELSE
 13520           MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 252
* EL131.cbl
 13521        END-IF
 13522        MOVE ZERO           TO DC-ELAPSED-MONTHS
 13523                               DC-ELAPSED-DAYS
 13524        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13525        IF DC-ODD-DAYS-OVER > ZERO
 13526           ADD 1 TO DC-ELAPSED-MONTHS
 13527        END-IF
 13528        IF DC-ELAPSED-MONTHS > 24
 13529           MOVE ER-1679            TO EMI-ERROR
 13530           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13531        ELSE
 13532           MOVE 1                  TO EMI-ERROR
 13533        END-IF
 13534     END-IF.
 13535
 13536     PERFORM 2615-CHECK-TRLR THRU 2615-EXIT.
 13537
 13538 2610-EXIT.
 13539     EXIT.
 13540 2615-CHECK-TRLR.
 13541
 13542     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13543     MOVE +96              TO TRLR-SEQ-NO
 13544
 13545* EXEC CICS READ
 13546*       UPDATE
 13547*       DATASET  ('ELTRLR')
 13548*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13549*       RIDFLD   (TRLR-KEY)
 13550*       RESP     (WS-RESPONSE)
 13551*    END-EXEC
 13552     MOVE 'ELTRLR' TO DFHEIV1
 13553*    MOVE '&"S        EU         (  N#00011791' TO DFHEIV0
 13554     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13555     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13556     MOVE X'204E233030303131373931' TO DFHEIV0(25:11)
 13557     CALL 'kxdfhei1' USING DFHEIV0,
 13558           DFHEIV1,
 13559           DFHEIV20,
 13560           DFHEIV99,
 13561           TRLR-KEY,
 13562           DFHEIV99,
 13563           DFHEIV99,
 13564           DFHEIV99
 13565     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13566         DFHEIV20
 13567     MOVE EIBRESP  TO WS-RESPONSE
 13568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13569     IF WS-RESP-NORMAL
 13570        IF EMI-ERROR =  ER-1679
 13571           IF EMI-ERROR-NUMBER(1) = ER-1679
 13572              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13573           ELSE
 13574           IF EMI-ERROR-NUMBER(2) = ER-1679
 13575              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13576           ELSE
 13577           IF EMI-ERROR-NUMBER(3) = ER-1679
 13578              MOVE EMI-LINE3 TO AT-INFO-LINE-1
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 253
* EL131.cbl
 13579           END-IF
 13580           END-IF
 13581           END-IF
 13582
 13583* EXEC CICS REWRITE
 13584*             DATASET   ('ELTRLR')
 13585*             FROM      (ACTIVITY-TRAILERS)
 13586*          END-EXEC
 13587     MOVE LENGTH OF
 13588      ACTIVITY-TRAILERS
 13589       TO DFHEIV11
 13590     MOVE 'ELTRLR' TO DFHEIV1
 13591*    MOVE '&& L                  %   #00011811' TO DFHEIV0
 13592     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13593     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13594     MOVE X'2020233030303131383131' TO DFHEIV0(25:11)
 13595     CALL 'kxdfhei1' USING DFHEIV0,
 13596           DFHEIV1,
 13597           ACTIVITY-TRAILERS,
 13598           DFHEIV11,
 13599           DFHEIV99
 13600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13601        ELSE
 13602           IF EMI-ERROR = 1
 13603              MOVE WS-CONTEST-NOTE TO AT-INFO-LINE-1
 13604              MOVE ZERO TO EMI-ERROR
 13605
 13606* EXEC CICS REWRITE
 13607*                DATASET   ('ELTRLR')
 13608*                FROM      (ACTIVITY-TRAILERS)
 13609*             END-EXEC
 13610     MOVE LENGTH OF
 13611      ACTIVITY-TRAILERS
 13612       TO DFHEIV11
 13613     MOVE 'ELTRLR' TO DFHEIV1
 13614*    MOVE '&& L                  %   #00011819' TO DFHEIV0
 13615     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13616     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13617     MOVE X'2020233030303131383139' TO DFHEIV0(25:11)
 13618     CALL 'kxdfhei1' USING DFHEIV0,
 13619           DFHEIV1,
 13620           ACTIVITY-TRAILERS,
 13621           DFHEIV11,
 13622           DFHEIV99
 13623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13624           ELSE
 13625
 13626* EXEC CICS DELETE
 13627*                DATASET   ('ELTRLR')
 13628*             END-EXEC
 13629     MOVE 'ELTRLR' TO DFHEIV1
 13630*    MOVE '&(                    &   #00011824' TO DFHEIV0
 13631     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13632     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13633     MOVE X'2020233030303131383234' TO DFHEIV0(25:11)
 13634     CALL 'kxdfhei1' USING DFHEIV0,
 13635           DFHEIV1,
 13636           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 254
* EL131.cbl
 13637           DFHEIV99,
 13638           DFHEIV99,
 13639           DFHEIV99
 13640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13641           END-IF
 13642        END-IF
 13643     ELSE
 13644     IF EMI-ERROR =  ER-1679
 13645
 13646* EXEC CICS GETMAIN
 13647*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13648*          LENGTH   (TRLR-LENGTH)
 13649*          INITIMG  (GETMAIN-SPACE)
 13650*       END-EXEC
 13651*    MOVE ',"IL                  $   #00011831' TO DFHEIV0
 13652     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13653     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13654     MOVE X'2020233030303131383331' TO DFHEIV0(25:11)
 13655     CALL 'kxdfhei1' USING DFHEIV0,
 13656           DFHEIV20,
 13657           TRLR-LENGTH,
 13658           GETMAIN-SPACE
 13659     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13660         DFHEIV20
 13661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13662        MOVE 'AT'          TO AT-RECORD-ID
 13663        MOVE CL-CONTROL-PRIMARY
 13664                           TO AT-CONTROL-PRIMARY
 13665        MOVE +96           TO AT-SEQUENCE-NO
 13666        MOVE '6'           TO AT-TRAILER-TYPE
 13667        MOVE SPACES             TO AT-GENERAL-INFO-TR
 13668        INITIALIZE AT-GENERAL-INFO-TR
 13669        IF EMI-ERROR-NUMBER(1) = ER-1679
 13670           MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13671        ELSE
 13672        IF EMI-ERROR-NUMBER(2) = ER-1679
 13673           MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13674        ELSE
 13675        IF EMI-ERROR-NUMBER(3) = ER-1679
 13676           MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13677        END-IF
 13678        END-IF
 13679        END-IF
 13680        MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13681        MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13682                              AT-GEN-INFO-LAST-MAINT-DT
 13683        MOVE PI-PROCESSOR-ID
 13684                           TO AT-RECORDED-BY
 13685                              AT-GEN-INFO-LAST-UPDATED-BY
 13686        MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13687
 13688* EXEC CICS WRITE
 13689*          DATASET   ('ELTRLR')
 13690*          FROM      (ACTIVITY-TRAILERS)
 13691*          RIDFLD    (TRLR-KEY)
 13692*       END-EXEC
 13693     MOVE LENGTH OF
 13694      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 255
* EL131.cbl
 13695       TO DFHEIV11
 13696     MOVE 'ELTRLR' TO DFHEIV1
 13697*    MOVE '&$ L                  ''   #00011861' TO DFHEIV0
 13698     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13699     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13700     MOVE X'2020233030303131383631' TO DFHEIV0(25:11)
 13701     CALL 'kxdfhei1' USING DFHEIV0,
 13702           DFHEIV1,
 13703           ACTIVITY-TRAILERS,
 13704           DFHEIV11,
 13705           TRLR-KEY,
 13706           DFHEIV99,
 13707           DFHEIV99
 13708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13709     END-IF
 13710     END-IF
 13711     .
 13712 2615-EXIT.
 13713     EXIT.
 13714
 13715*0529182620-CHECK-TRLR.
 13716*052918
 13717*052918MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13718*052918MOVE +97                  TO TRLR-SEQ-NO
 13719*052918EXEC CICS READ
 13720*052918   UPDATE
 13721*052918   DATASET  ('ELTRLR')
 13722*052918   SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13723*052918   RIDFLD   (TRLR-KEY)
 13724*052918   RESP     (WS-RESPONSE)
 13725*052918END-EXEC
 13726*052918IF WS-RESP-NORMAL
 13727*052918   IF EMI-ERROR =  ER-7572
 13728*052918      MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13729*052918      EXEC CICS REWRITE
 13730*052918         DATASET   ('ELTRLR')
 13731*052918         FROM      (ACTIVITY-TRAILERS)
 13732*052918      END-EXEC
 13733*052918   ELSE
 13734*052918      MOVE WS-FILE-LIM-NOTE TO AT-INFO-LINE-1
 13735*052918         EXEC CICS REWRITE
 13736*052918            DATASET   ('ELTRLR')
 13737*052918            FROM      (ACTIVITY-TRAILERS)
 13738*052918         END-EXEC
 13739*052918   END-IF
 13740*052918ELSE
 13741*052918   IF EMI-ERROR =  ER-7572
 13742*052918      EXEC CICS GETMAIN
 13743*052918         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13744*052918         LENGTH   (TRLR-LENGTH)
 13745*052918         INITIMG  (GETMAIN-SPACE)
 13746*052918      END-EXEC
 13747*052918      MOVE 'AT'          TO AT-RECORD-ID
 13748*052918      MOVE CL-CONTROL-PRIMARY
 13749*052918                         TO AT-CONTROL-PRIMARY
 13750*052918      MOVE +97           TO AT-SEQUENCE-NO
 13751*052918      MOVE '6'           TO AT-TRAILER-TYPE
 13752*052918      MOVE SPACES             TO AT-GENERAL-INFO-TR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 256
* EL131.cbl
 13753*052918      INITIALIZE AT-GENERAL-INFO-TR
 13754*052918      MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13755*052918      MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13756*052918      MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13757*052918                            AT-GEN-INFO-LAST-MAINT-DT
 13758*052918      MOVE PI-PROCESSOR-ID
 13759*052918                         TO AT-RECORDED-BY
 13760*052918                            AT-GEN-INFO-LAST-UPDATED-BY
 13761*052918      MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13762*052918      EXEC CICS WRITE
 13763*052918         DATASET   ('ELTRLR')
 13764*052918         FROM      (ACTIVITY-TRAILERS)
 13765*052918         RIDFLD    (TRLR-KEY)
 13766*052918      END-EXEC
 13767*052918   END-IF
 13768*052918END-IF
 13769*052918.
 13770*0529182620-EXIT.
 13771*052918EXIT.
 13772
 13773 2650-WRITE-MAINT-NOTE.
 13774
 13775* EXEC CICS GETMAIN
 13776*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13777*         LENGTH   (TRLR-LENGTH)
 13778*         INITIMG  (GETMAIN-SPACE)
 13779*    END-EXEC.
 13780*    MOVE ',"IL                  $   #00011931' TO DFHEIV0
 13781     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13782     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13783     MOVE X'2020233030303131393331' TO DFHEIV0(25:11)
 13784     CALL 'kxdfhei1' USING DFHEIV0,
 13785           DFHEIV20,
 13786           TRLR-LENGTH,
 13787           GETMAIN-SPACE
 13788     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13789         DFHEIV20
 13790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13791
 13792
 13793
 13794* EXEC CICS HANDLE CONDITION
 13795*         DUPREC   (2650-EXIT)
 13796*    END-EXEC.
 13797*    MOVE '"$%                   ! ; #00011937' TO DFHEIV0
 13798     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13799     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13800     MOVE X'3B20233030303131393337' TO DFHEIV0(25:11)
 13801     CALL 'kxdfhei1' USING DFHEIV0
 13802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13803
 13804
 13805     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13806
 13807     IF CERTL GREATER ZERO
 13808         MOVE CERTI          TO CL-CERT-PRIME.
 13809
 13810     IF SUFXL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 257
* EL131.cbl
 13811         MOVE SUFXI          TO CL-CERT-SFX.
 13812
 13813     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13814
 13815     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13816     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13817
 13818     MOVE 'AT'               TO AT-RECORD-ID.
 13819
 13820     MOVE '6'                TO AT-TRAILER-TYPE.
 13821     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13822                                AT-GEN-INFO-LAST-MAINT-DT.
 13823     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13824                                AT-GEN-INFO-LAST-UPDATED-BY.
 13825     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13826     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13827     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13828
 13829
 13830* EXEC CICS WRITE
 13831*         DATASET  (TRLR-FILE-ID)
 13832*         RIDFLD   (AT-CONTROL-PRIMARY)
 13833*         FROM     (ACTIVITY-TRAILERS)
 13834*    END-EXEC.
 13835     MOVE LENGTH OF
 13836      ACTIVITY-TRAILERS
 13837       TO DFHEIV11
 13838*    MOVE '&$ L                  ''   #00011965' TO DFHEIV0
 13839     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13840     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13841     MOVE X'2020233030303131393635' TO DFHEIV0(25:11)
 13842     CALL 'kxdfhei1' USING DFHEIV0,
 13843           TRLR-FILE-ID,
 13844           ACTIVITY-TRAILERS,
 13845           DFHEIV11,
 13846           AT-CONTROL-PRIMARY,
 13847           DFHEIV99,
 13848           DFHEIV99
 13849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13850
 13851
 13852 2650-EXIT.
 13853      EXIT.
 13854
 13855 2800-CHECK-AUTO-PAY.
 13856
 13857     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13858     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13859     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13860     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13861     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13862
 13863
 13864* EXEC CICS HANDLE CONDITION
 13865*         NOTFND    (2800-EXIT)
 13866*         ENDFILE   (2800-EXIT)
 13867*    END-EXEC.
 13868*    MOVE '"$I''                  ! < #00011982' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 258
* EL131.cbl
 13869     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13871     MOVE X'3C20233030303131393832' TO DFHEIV0(25:11)
 13872     CALL 'kxdfhei1' USING DFHEIV0
 13873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13874
 13875
 13876
 13877* EXEC CICS READ
 13878*        DATASET (TRLR-FILE-ID)
 13879*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13880*        RIDFLD  (TRLR-KEY)
 13881*    END-EXEC.
 13882*    MOVE '&"S        E          (   #00011987' TO DFHEIV0
 13883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13885     MOVE X'2020233030303131393837' TO DFHEIV0(25:11)
 13886     CALL 'kxdfhei1' USING DFHEIV0,
 13887           TRLR-FILE-ID,
 13888           DFHEIV20,
 13889           DFHEIV99,
 13890           TRLR-KEY,
 13891           DFHEIV99,
 13892           DFHEIV99,
 13893           DFHEIV99
 13894     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13895         DFHEIV20
 13896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13897
 13898
 13899     IF BENEFICIARY-PAID-AUTO
 13900         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13901     END-IF.
 13902
 13903 2800-EXIT.
 13904      EXIT.
 13905
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 259
* EL131.cbl
 13907 3000-DELETE-CLAIM.
 13908     IF  NOT MODIFY-CAP
 13909         MOVE ER-0070            TO EMI-ERROR
 13910         MOVE -1                 TO MAINTL
 13911         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13912         GO TO 8110-SEND-DATA.
 13913
 13914
 13915* EXEC CICS READ
 13916*         SET      (ADDRESS OF CLAIM-MASTER)
 13917*         DATASET  (CLMS-FILE-ID)
 13918*         RIDFLD   (MSTR-KEY)
 13919*    END-EXEC.
 13920*    MOVE '&"S        E          (   #00012008' TO DFHEIV0
 13921     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13922     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13923     MOVE X'2020233030303132303038' TO DFHEIV0(25:11)
 13924     CALL 'kxdfhei1' USING DFHEIV0,
 13925           CLMS-FILE-ID,
 13926           DFHEIV20,
 13927           DFHEIV99,
 13928           MSTR-KEY,
 13929           DFHEIV99,
 13930           DFHEIV99,
 13931           DFHEIV99
 13932     SET ADDRESS OF CLAIM-MASTER TO
 13933         DFHEIV20
 13934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13935
 13936
 13937     IF CL-1ST-TRL-AVAIL
 13938         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13939     ELSE
 13940        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13941        MOVE 0                   TO TRLR-SEQ-NO
 13942
 13943* EXEC CICS STARTBR
 13944*            DATASET (TRLR-FILE-ID)
 13945*            RIDFLD  (TRLR-KEY)
 13946*        END-EXEC
 13947     MOVE 0
 13948       TO DFHEIV11
 13949*    MOVE '&,         G          &   #00012019' TO DFHEIV0
 13950     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13951     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13952     MOVE X'2020233030303132303139' TO DFHEIV0(25:11)
 13953     CALL 'kxdfhei1' USING DFHEIV0,
 13954           TRLR-FILE-ID,
 13955           TRLR-KEY,
 13956           DFHEIV99,
 13957           DFHEIV11,
 13958           DFHEIV99
 13959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13960         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13961
 13962* EXEC CICS ENDBR
 13963*            DATASET (TRLR-FILE-ID)
 13964*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 260
* EL131.cbl
 13965     MOVE 0
 13966       TO DFHEIV11
 13967*    MOVE '&2                    $   #00012024' TO DFHEIV0
 13968     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13969     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13970     MOVE X'2020233030303132303234' TO DFHEIV0(25:11)
 13971     CALL 'kxdfhei1' USING DFHEIV0,
 13972           TRLR-FILE-ID,
 13973           DFHEIV11,
 13974           DFHEIV99
 13975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13976        IF SCREEN-ERROR
 13977            MOVE ER-0208         TO EMI-ERROR
 13978            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13979            MOVE -1              TO MAINTL
 13980            GO TO 8110-SEND-DATA
 13981        ELSE
 13982            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13983
 13984     IF SCREEN-ERROR
 13985         MOVE -1                 TO MAINTL
 13986         GO TO 8110-SEND-DATA.
 13987
 13988     MOVE -1                     TO ONE-OR-MIN1.
 13989     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13990
 13991     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13992         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13993                                    WS-SAVE-CLAIM-KEY
 13994         MOVE +1                 TO ONE-OR-MIN1
 13995         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13996
 13997     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13998
 13999     MOVE LOW-VALUES             TO EL131AO.
 14000     MOVE ER-0000                TO EMI-ERROR.
 14001     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14002     MOVE 'X'                    TO PI-RETURN-CD-1.
 14003     MOVE -1                     TO MAINTL.
 14004     GO TO 8100-SEND-MAP.
 14005
 14006 3010-DEL-MSTR-TRLR.
 14007
 14008* EXEC CICS READ UPDATE
 14009*         SET       (ADDRESS OF CLAIM-MASTER)
 14010*         DATASET   (CLMS-FILE-ID)
 14011*         RIDFLD    (MSTR-KEY)
 14012*    END-EXEC.
 14013*    MOVE '&"S        EU         (   #00012058' TO DFHEIV0
 14014     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14015     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14016     MOVE X'2020233030303132303538' TO DFHEIV0(25:11)
 14017     CALL 'kxdfhei1' USING DFHEIV0,
 14018           CLMS-FILE-ID,
 14019           DFHEIV20,
 14020           DFHEIV99,
 14021           MSTR-KEY,
 14022           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 261
* EL131.cbl
 14023           DFHEIV99,
 14024           DFHEIV99
 14025     SET ADDRESS OF CLAIM-MASTER TO
 14026         DFHEIV20
 14027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14028
 14029
 14030     if (cl-priority-cd = '8')
 14031        and (pi-processor-id not = 'PEMA' and 'JMS '
 14032             AND 'AMWA')
 14033        MOVE ER-8003             TO EMI-ERROR
 14034        PERFORM 9900-ERROR-FORMAT
 14035                                 THRU 9900-EXIT
 14036        MOVE -1                  TO MAINTL
 14037        GO TO 8110-SEND-DATA
 14038     end-if
 14039
 14040     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 14041     MOVE ZERO                   TO TRLR-SEQ-NO.
 14042
 14043
 14044* EXEC CICS HANDLE CONDITION
 14045*         NOTFND    (3010-DEL-ACTQ)
 14046*         ENDFILE   (3040-EXIT)
 14047*    END-EXEC.
 14048*    MOVE '"$I''                  ! = #00012077' TO DFHEIV0
 14049     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14051     MOVE X'3D20233030303132303737' TO DFHEIV0(25:11)
 14052     CALL 'kxdfhei1' USING DFHEIV0
 14053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14054
 14055
 14056     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 14057
 14058 3010-DEL-ACTQ.
 14059
 14060
 14061* EXEC CICS HANDLE CONDITION
 14062*         NOTFND    (3010-NO-ACTIVITY)
 14063*         ENDFILE   (3050-EXIT)
 14064*    END-EXEC.
 14065*    MOVE '"$I''                  ! > #00012086' TO DFHEIV0
 14066     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14068     MOVE X'3E20233030303132303836' TO DFHEIV0(25:11)
 14069     CALL 'kxdfhei1' USING DFHEIV0
 14070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14071
 14072
 14073
 14074* EXEC CICS STARTBR
 14075*         DATASET  (ACTQ-FILE-ID)
 14076*         RIDFLD   (ACTQ-KEY)
 14077*    END-EXEC.
 14078     MOVE 0
 14079       TO DFHEIV11
 14080*    MOVE '&,         G          &   #00012091' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 262
* EL131.cbl
 14081     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14082     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14083     MOVE X'2020233030303132303931' TO DFHEIV0(25:11)
 14084     CALL 'kxdfhei1' USING DFHEIV0,
 14085           ACTQ-FILE-ID,
 14086           ACTQ-KEY,
 14087           DFHEIV99,
 14088           DFHEIV11,
 14089           DFHEIV99
 14090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14091
 14092
 14093
 14094* EXEC CICS GETMAIN
 14095*         SET      (ADDRESS OF ACTIVITY-QUE)
 14096*         LENGTH   (ACTQ-LENGTH)
 14097*         INITIMG  (GETMAIN-SPACE)
 14098*    END-EXEC.
 14099*    MOVE ',"IL                  $   #00012096' TO DFHEIV0
 14100     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14101     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14102     MOVE X'2020233030303132303936' TO DFHEIV0(25:11)
 14103     CALL 'kxdfhei1' USING DFHEIV0,
 14104           DFHEIV20,
 14105           ACTQ-LENGTH,
 14106           GETMAIN-SPACE
 14107     SET ADDRESS OF ACTIVITY-QUE TO
 14108         DFHEIV20
 14109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14110
 14111
 14112     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 14113
 14114
 14115* EXEC CICS ENDBR
 14116*         DATASET (ACTQ-FILE-ID)
 14117*    END-EXEC.
 14118     MOVE 0
 14119       TO DFHEIV11
 14120*    MOVE '&2                    $   #00012104' TO DFHEIV0
 14121     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14122     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14123     MOVE X'2020233030303132313034' TO DFHEIV0(25:11)
 14124     CALL 'kxdfhei1' USING DFHEIV0,
 14125           ACTQ-FILE-ID,
 14126           DFHEIV11,
 14127           DFHEIV99
 14128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14129
 14130
 14131 3010-NO-ACTIVITY.
 14132
 14133
 14134* EXEC CICS HANDLE CONDITION
 14135*        NOTFND   (3010-CERT-NOT-FOUND)
 14136*    END-EXEC.
 14137*    MOVE '"$I                   ! ? #00012110' TO DFHEIV0
 14138     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 263
* EL131.cbl
 14139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14140     MOVE X'3F20233030303132313130' TO DFHEIV0(25:11)
 14141     CALL 'kxdfhei1' USING DFHEIV0
 14142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14143
 14144
 14145     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 14146     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 14147     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 14148     MOVE CL-CERT-STATE          TO CERT-STATE.
 14149     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 14150     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 14151     MOVE CL-CERT-NO             TO CERT-CERT.
 14152
 14153
 14154* EXEC CICS READ
 14155*        DATASET   (CERT-FILE-ID)
 14156*        RIDFLD    (CERT-KEY)
 14157*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14158*    END-EXEC.
 14159*    MOVE '&"S        E          (   #00012122' TO DFHEIV0
 14160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14162     MOVE X'2020233030303132313232' TO DFHEIV0(25:11)
 14163     CALL 'kxdfhei1' USING DFHEIV0,
 14164           CERT-FILE-ID,
 14165           DFHEIV20,
 14166           DFHEIV99,
 14167           CERT-KEY,
 14168           DFHEIV99,
 14169           DFHEIV99,
 14170           DFHEIV99
 14171     SET ADDRESS OF CERTIFICATE-MASTER TO
 14172         DFHEIV20
 14173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14174
 14175
 14176     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 14177       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 14178         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 14179     ELSE
 14180         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 14181
 14182 3010-UPDATE-CERT-TRLR.
 14183
 14184     MOVE CERT-KEY               TO ELCRTT-KEY
 14185     MOVE 'B'                    TO CTRLR-REC-TYPE
 14186
 14187* EXEC CICS READ
 14188*       UPDATE
 14189*       DATASET   ('ELCRTT')
 14190*       RIDFLD    (ELCRTT-KEY)
 14191*       INTO      (CERTIFICATE-TRAILERS)
 14192*       RESP      (WS-RESPONSE)
 14193*    END-EXEC
 14194     MOVE LENGTH OF
 14195      CERTIFICATE-TRAILERS
 14196       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 264
* EL131.cbl
 14197     MOVE 'ELCRTT' TO DFHEIV1
 14198*    MOVE '&"IL       EU         (  N#00012138' TO DFHEIV0
 14199     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14200     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14201     MOVE X'204E233030303132313338' TO DFHEIV0(25:11)
 14202     CALL 'kxdfhei1' USING DFHEIV0,
 14203           DFHEIV1,
 14204           CERTIFICATE-TRAILERS,
 14205           DFHEIV11,
 14206           ELCRTT-KEY,
 14207           DFHEIV99,
 14208           DFHEIV99,
 14209           DFHEIV99
 14210     MOVE EIBRESP  TO WS-RESPONSE
 14211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14212     IF WS-RESP-NORMAL
 14213        perform varying s1 from +1 by +1 until
 14214           (s1 > +24)
 14215           or (cs-claim-no (s1) = cl-claim-no)
 14216        end-perform
 14217        if s1 < +25
 14218           move spaces           to cs-claim-no (s1)
 14219                                    cs-claim-type (s1)
 14220                                    cs-insured-type (s1)
 14221           move zeros            to cs-days-paid (s1)
 14222                                    cs-total-paid (s1)
 14223                                    cs-benefit-period (s1)
 14224           if s1 not = +24
 14225              compute s2 = s1 + +1
 14226              perform 3015-bump  thru 3015-exit
 14227           end-if
 14228
 14229* EXEC CICS REWRITE
 14230*             DATASET   ('ELCRTT')
 14231*             FROM      (CERTIFICATE-TRAILERS)
 14232*          END-EXEC
 14233     MOVE LENGTH OF
 14234      CERTIFICATE-TRAILERS
 14235       TO DFHEIV11
 14236     MOVE 'ELCRTT' TO DFHEIV1
 14237*    MOVE '&& L                  %   #00012161' TO DFHEIV0
 14238     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14239     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14240     MOVE X'2020233030303132313631' TO DFHEIV0(25:11)
 14241     CALL 'kxdfhei1' USING DFHEIV0,
 14242           DFHEIV1,
 14243           CERTIFICATE-TRAILERS,
 14244           DFHEIV11,
 14245           DFHEIV99
 14246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14247        end-if
 14248     end-if
 14249     .
 14250 3010-CERT-NOT-FOUND.
 14251
 14252
 14253* EXEC CICS DELETE
 14254*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 265
* EL131.cbl
 14255*    END-EXEC.
 14256*    MOVE '&(                    &   #00012170' TO DFHEIV0
 14257     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14259     MOVE X'2020233030303132313730' TO DFHEIV0(25:11)
 14260     CALL 'kxdfhei1' USING DFHEIV0,
 14261           CLMS-FILE-ID,
 14262           DFHEIV99,
 14263           DFHEIV99,
 14264           DFHEIV99,
 14265           DFHEIV99
 14266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14267
 14268
 14269 3010-EXIT.
 14270      EXIT.
 14271
 14272 3015-bump.
 14273     perform varying s2 from s2 by +1 until s2 > +24
 14274        move cs-mb-claim-data (s2)
 14275                                 to cs-mb-claim-data (s1)
 14276        move spaces              to cs-mb-claim-data (s2)
 14277        add +1 to s1
 14278     end-perform
 14279     .
 14280 3015-exit.
 14281     exit.
 14282 3020-UPDATE-CERT.
 14283
 14284* EXEC CICS READ UPDATE
 14285*         DATASET  (CERT-FILE-ID)
 14286*         RIDFLD   (CERT-KEY)
 14287*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14288*    END-EXEC.
 14289*    MOVE '&"S        EU         (   #00012188' TO DFHEIV0
 14290     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14291     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14292     MOVE X'2020233030303132313838' TO DFHEIV0(25:11)
 14293     CALL 'kxdfhei1' USING DFHEIV0,
 14294           CERT-FILE-ID,
 14295           DFHEIV20,
 14296           DFHEIV99,
 14297           CERT-KEY,
 14298           DFHEIV99,
 14299           DFHEIV99,
 14300           DFHEIV99
 14301     SET ADDRESS OF CERTIFICATE-MASTER TO
 14302         DFHEIV20
 14303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14304
 14305
 14306     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 14307
 14308
 14309* EXEC CICS HANDLE CONDITION
 14310*         DUPKEY   (3020-EXIT)
 14311*    END-EXEC.
 14312*    MOVE '"$$                   ! @ #00012196' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 266
* EL131.cbl
 14313     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 14314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14315     MOVE X'4020233030303132313936' TO DFHEIV0(25:11)
 14316     CALL 'kxdfhei1' USING DFHEIV0
 14317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14318
 14319
 14320
 14321* EXEC CICS REWRITE
 14322*         DATASET  (CERT-FILE-ID)
 14323*         FROM     (CERTIFICATE-MASTER)
 14324*    END-EXEC.
 14325     MOVE LENGTH OF
 14326      CERTIFICATE-MASTER
 14327       TO DFHEIV11
 14328*    MOVE '&& L                  %   #00012200' TO DFHEIV0
 14329     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14330     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14331     MOVE X'2020233030303132323030' TO DFHEIV0(25:11)
 14332     CALL 'kxdfhei1' USING DFHEIV0,
 14333           CERT-FILE-ID,
 14334           CERTIFICATE-MASTER,
 14335           DFHEIV11,
 14336           DFHEIV99
 14337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14338
 14339
 14340 3020-EXIT.
 14341     EXIT.
 14342
 14343 3030-DELETE-CERT.
 14344
 14345* EXEC CICS READ UPDATE
 14346*         DATASET  (CERT-FILE-ID)
 14347*         RIDFLD   (CERT-KEY)
 14348*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14349*    END-EXEC.
 14350*    MOVE '&"S        EU         (   #00012209' TO DFHEIV0
 14351     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14352     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14353     MOVE X'2020233030303132323039' TO DFHEIV0(25:11)
 14354     CALL 'kxdfhei1' USING DFHEIV0,
 14355           CERT-FILE-ID,
 14356           DFHEIV20,
 14357           DFHEIV99,
 14358           CERT-KEY,
 14359           DFHEIV99,
 14360           DFHEIV99,
 14361           DFHEIV99
 14362     SET ADDRESS OF CERTIFICATE-MASTER TO
 14363         DFHEIV20
 14364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14365
 14366
 14367
 14368* EXEC CICS DELETE
 14369*         DATASET   (CERT-FILE-ID)
 14370*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 267
* EL131.cbl
 14371*    MOVE '&(                    &   #00012215' TO DFHEIV0
 14372     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14373     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14374     MOVE X'2020233030303132323135' TO DFHEIV0(25:11)
 14375     CALL 'kxdfhei1' USING DFHEIV0,
 14376           CERT-FILE-ID,
 14377           DFHEIV99,
 14378           DFHEIV99,
 14379           DFHEIV99,
 14380           DFHEIV99
 14381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14382
 14383
 14384 3030-EXIT.
 14385     EXIT.
 14386
 14387 3040-DELETE-TRLR.
 14388
 14389* EXEC CICS READ
 14390*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14391*         DATASET  (TRLR-FILE-ID)
 14392*         RIDFLD   (TRLR-KEY)
 14393*         GTEQ
 14394*    END-EXEC.
 14395*    MOVE '&"S        G          (   #00012223' TO DFHEIV0
 14396     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14398     MOVE X'2020233030303132323233' TO DFHEIV0(25:11)
 14399     CALL 'kxdfhei1' USING DFHEIV0,
 14400           TRLR-FILE-ID,
 14401           DFHEIV20,
 14402           DFHEIV99,
 14403           TRLR-KEY,
 14404           DFHEIV99,
 14405           DFHEIV99,
 14406           DFHEIV99
 14407     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14408         DFHEIV20
 14409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14410
 14411
 14412     IF PI-COMPANY-CD = AT-COMPANY-CD
 14413        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 14414        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14415           GO TO 3040-EXIT
 14416        ELSE
 14417           NEXT SENTENCE
 14418     ELSE
 14419        GO TO 3040-EXIT.
 14420
 14421
 14422* EXEC CICS DELETE
 14423*         DATASET  (TRLR-FILE-ID)
 14424*         RIDFLD   (TRLR-KEY)
 14425*    END-EXEC.
 14426*    MOVE '&(  R                 &   #00012239' TO DFHEIV0
 14427     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14428     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 268
* EL131.cbl
 14429     MOVE X'2020233030303132323339' TO DFHEIV0(25:11)
 14430     CALL 'kxdfhei1' USING DFHEIV0,
 14431           TRLR-FILE-ID,
 14432           TRLR-KEY,
 14433           DFHEIV99,
 14434           DFHEIV99,
 14435           DFHEIV99
 14436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14437
 14438
 14439     GO TO 3040-DELETE-TRLR.
 14440
 14441 3040-EXIT.
 14442     EXIT.
 14443
 14444 3050-DELETE-ACTQ.
 14445
 14446* EXEC CICS READNEXT
 14447*         DATASET  (ACTQ-FILE-ID)
 14448*         RIDFLD   (ACTQ-KEY)
 14449*         INTO     (ACTIVITY-QUE)
 14450*    END-EXEC.
 14451     MOVE LENGTH OF
 14452      ACTIVITY-QUE
 14453       TO DFHEIV12
 14454     MOVE 0
 14455       TO DFHEIV11
 14456*    MOVE '&.IL                  )   #00012250' TO DFHEIV0
 14457     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14459     MOVE X'2020233030303132323530' TO DFHEIV0(25:11)
 14460     CALL 'kxdfhei1' USING DFHEIV0,
 14461           ACTQ-FILE-ID,
 14462           ACTIVITY-QUE,
 14463           DFHEIV12,
 14464           ACTQ-KEY,
 14465           DFHEIV99,
 14466           DFHEIV11,
 14467           DFHEIV99,
 14468           DFHEIV99
 14469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14470
 14471
 14472     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 14473         GO TO 3050-EXIT.
 14474
 14475
 14476* EXEC CICS ENDBR
 14477*         DATASET  (ACTQ-FILE-ID)
 14478*    END-EXEC.
 14479     MOVE 0
 14480       TO DFHEIV11
 14481*    MOVE '&2                    $   #00012259' TO DFHEIV0
 14482     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14483     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14484     MOVE X'2020233030303132323539' TO DFHEIV0(25:11)
 14485     CALL 'kxdfhei1' USING DFHEIV0,
 14486           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 269
* EL131.cbl
 14487           DFHEIV11,
 14488           DFHEIV99
 14489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14490
 14491
 14492
 14493* EXEC CICS DELETE
 14494*         DATASET   (ACTQ-FILE-ID)
 14495*         RIDFLD    (ACTQ-KEY)
 14496*    END-EXEC.
 14497*    MOVE '&(  R                 &   #00012263' TO DFHEIV0
 14498     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14499     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14500     MOVE X'2020233030303132323633' TO DFHEIV0(25:11)
 14501     CALL 'kxdfhei1' USING DFHEIV0,
 14502           ACTQ-FILE-ID,
 14503           ACTQ-KEY,
 14504           DFHEIV99,
 14505           DFHEIV99,
 14506           DFHEIV99
 14507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14508
 14509
 14510
 14511* EXEC CICS STARTBR
 14512*         DATASET   (ACTQ-FILE-ID)
 14513*         RIDFLD    (ACTQ-KEY)
 14514*    END-EXEC.
 14515     MOVE 0
 14516       TO DFHEIV11
 14517*    MOVE '&,         G          &   #00012268' TO DFHEIV0
 14518     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14519     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14520     MOVE X'2020233030303132323638' TO DFHEIV0(25:11)
 14521     CALL 'kxdfhei1' USING DFHEIV0,
 14522           ACTQ-FILE-ID,
 14523           ACTQ-KEY,
 14524           DFHEIV99,
 14525           DFHEIV11,
 14526           DFHEIV99
 14527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14528
 14529
 14530     GO TO 3050-DELETE-ACTQ.
 14531
 14532 3050-EXIT.
 14533     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 270
* EL131.cbl
 14535 3060-READ-TRLR.
 14536
 14537* EXEC CICS HANDLE CONDITION
 14538*         NOTFND    (3060-EXIT)
 14539*         ENDFILE   (3060-EXIT)
 14540*    END-EXEC.
 14541*    MOVE '"$I''                  ! A #00012279' TO DFHEIV0
 14542     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14544     MOVE X'4120233030303132323739' TO DFHEIV0(25:11)
 14545     CALL 'kxdfhei1' USING DFHEIV0
 14546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14547
 14548
 14549 3060-LOOP.
 14550
 14551* EXEC CICS READNEXT
 14552*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14553*         DATASET  (TRLR-FILE-ID)
 14554*         RIDFLD   (TRLR-KEY)
 14555*    END-EXEC.
 14556     MOVE 0
 14557       TO DFHEIV11
 14558*    MOVE '&.S                   )   #00012285' TO DFHEIV0
 14559     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14560     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14561     MOVE X'2020233030303132323835' TO DFHEIV0(25:11)
 14562     CALL 'kxdfhei1' USING DFHEIV0,
 14563           TRLR-FILE-ID,
 14564           DFHEIV20,
 14565           DFHEIV99,
 14566           TRLR-KEY,
 14567           DFHEIV99,
 14568           DFHEIV11,
 14569           DFHEIV99,
 14570           DFHEIV99
 14571     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14572         DFHEIV20
 14573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14574
 14575
 14576     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14577         GO TO 3060-EXIT.
 14578
 14579     IF FORM-CONTROL-TR
 14580         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14581             NEXT SENTENCE
 14582         ELSE
 14583             MOVE 'X'            TO ERROR-SWITCH
 14584             GO TO 3060-EXIT
 14585     ELSE
 14586         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14587            MOVE 'X'                 TO ERROR-SWITCH
 14588            GO TO 3060-EXIT.
 14589
 14590     GO TO 3060-LOOP.
 14591
 14592 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 271
* EL131.cbl
 14593     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 272
* EL131.cbl
 14595 3997-GET-ERPDEF.
 14596
 14597     move cl-company-cd          to cert-company-code
 14598     move cl-cert-key-data       to cert-key (2:21)
 14599     move cl-cert-no             to cert-cert
 14600
 14601
 14602* EXEC CICS READ
 14603*        DATASET   (CERT-FILE-ID)
 14604*        RIDFLD    (CERT-KEY)
 14605*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14606*        resp      (ws-response)
 14607*    END-EXEC
 14608*    MOVE '&"S        E          (  N#00012316' TO DFHEIV0
 14609     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14611     MOVE X'204E233030303132333136' TO DFHEIV0(25:11)
 14612     CALL 'kxdfhei1' USING DFHEIV0,
 14613           CERT-FILE-ID,
 14614           DFHEIV20,
 14615           DFHEIV99,
 14616           CERT-KEY,
 14617           DFHEIV99,
 14618           DFHEIV99,
 14619           DFHEIV99
 14620     SET ADDRESS OF CERTIFICATE-MASTER TO
 14621         DFHEIV20
 14622     MOVE EIBRESP  TO ws-response
 14623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14624
 14625     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14626                                    WS-ERPDEF-SW
 14627     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14628                                    WS-CRIT-PER-RTW-MOS
 14629
 14630     if cm-clp-state = spaces or low-values or zeros
 14631        move cm-state            to cm-clp-state
 14632     end-if
 14633     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14634     MOVE CM-clp-state           TO ERPDEF-STATE
 14635     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14636     evaluate true
 14637        when (cl-claim-type = 'L' or 'P' OR 'O')
 14638           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14639             and 'CU')
 14640           move 'L'              to erpdef-ben-type
 14641           move cm-lf-benefit-cd to erpdef-ben-code
 14642        when (cl-claim-type not = 'L' and 'P' AND 'O')
 14643           and (cm-ah-benefit-cd not = '00' and '  ')
 14644           move 'A'              to erpdef-ben-type
 14645           move cm-ah-benefit-cd to erpdef-ben-code
 14646        when (cl-claim-type not = 'L' and 'P' AND 'O')
 14647           and (cm-ah-benefit-cd = '00' or '  ')
 14648           move 'L'              to erpdef-ben-type
 14649           move cm-lf-benefit-cd to erpdef-ben-code
 14650        when (cl-claim-type = 'L' or 'P' OR 'O')
 14651           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14652           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 273
* EL131.cbl
 14653           move cm-ah-benefit-cd to erpdef-ben-code
 14654        when other
 14655           move 'A'              to erpdef-ben-type
 14656           move cm-ah-benefit-cd to erpdef-ben-code
 14657     end-evaluate
 14658
 14659*    if (cl-claim-type = 'L' or 'P')
 14660*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14661*          and 'CU')
 14662*       move 'L'                 to erpdef-ben-type
 14663*       move cm-lf-benefit-cd    to erpdef-ben-code
 14664*    else
 14665*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14666*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14667*    end-if
 14668     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14669     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14670
 14671
 14672* EXEC CICS STARTBR
 14673*        DATASET  ('ERPDEF')
 14674*        RIDFLD   (ERPDEF-KEY)
 14675*        GTEQ
 14676*        RESP     (WS-RESPONSE)
 14677*    END-EXEC
 14678     MOVE 'ERPDEF' TO DFHEIV1
 14679     MOVE 0
 14680       TO DFHEIV11
 14681*    MOVE '&,         G          &  N#00012369' TO DFHEIV0
 14682     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14683     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14684     MOVE X'204E233030303132333639' TO DFHEIV0(25:11)
 14685     CALL 'kxdfhei1' USING DFHEIV0,
 14686           DFHEIV1,
 14687           ERPDEF-KEY,
 14688           DFHEIV99,
 14689           DFHEIV11,
 14690           DFHEIV99
 14691     MOVE EIBRESP  TO WS-RESPONSE
 14692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14693
 14694     IF WS-RESP-NORMAL
 14695
 14696* EXEC CICS READNEXT
 14697*          DATASET  ('ERPDEF')
 14698*          INTO     (PRODUCT-MASTER)
 14699*          RIDFLD   (ERPDEF-KEY)
 14700*          RESP     (WS-RESPONSE)
 14701*       END-EXEC
 14702     MOVE LENGTH OF
 14703      PRODUCT-MASTER
 14704       TO DFHEIV12
 14705     MOVE 'ERPDEF' TO DFHEIV1
 14706     MOVE 0
 14707       TO DFHEIV11
 14708*    MOVE '&.IL                  )  N#00012377' TO DFHEIV0
 14709     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 274
* EL131.cbl
 14711     MOVE X'204E233030303132333737' TO DFHEIV0(25:11)
 14712     CALL 'kxdfhei1' USING DFHEIV0,
 14713           DFHEIV1,
 14714           PRODUCT-MASTER,
 14715           DFHEIV12,
 14716           ERPDEF-KEY,
 14717           DFHEIV99,
 14718           DFHEIV11,
 14719           DFHEIV99,
 14720           DFHEIV99
 14721     MOVE EIBRESP  TO WS-RESPONSE
 14722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14723        IF WS-RESP-NORMAL
 14724           IF (ERPDEF-KEY-SAVE (1:16) =
 14725              PD-CONTROL-PRIMARY (1:16))
 14726              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14727              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14728                 (A1 > +8)
 14729                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14730              END-PERFORM
 14731              IF A1 < +9
 14732                 SET ERPDEF-FOUND TO TRUE
 14733                 MOVE PD-CRIT-PERIOD (A1)
 14734                              TO WS-CRITICAL-PERIOD
 14735                 MOVE PD-REC-CRIT-PERIOD (A1)
 14736                              TO WS-CRIT-PER-RECURRENT
 14737                 IF PD-RTW-MOS (A1) NUMERIC
 14738                    MOVE PD-RTW-MOS (A1)
 14739                              TO WS-CRIT-PER-RTW-MOS
 14740                 ELSE
 14741                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14742                 END-IF
 14743                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14744                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14745                                 TO WS-EXCL-PERIOD
 14746                 END-IF
 14747                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14748                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14749                                 TO WS-COV-ENDS
 14750                 END-IF
 14751                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14752                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14753                                 TO WS-ACC-PERIOD
 14754                 END-IF
 14755                 if pd-max-extension (a1) numeric
 14756                    move pd-max-extension (a1)
 14757                                 to ws-max-extension
 14758                 end-if
 14759                 if pd-max-amt (a1) numeric
 14760                    move pd-max-amt (a1)
 14761                                 to ws-max-moben
 14762                 end-if
 14763              END-IF
 14764           END-IF
 14765        END-IF
 14766     END-IF
 14767
 14768     .
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 275
* EL131.cbl
 14769 3997-EXIT.
 14770     EXIT.
 14771 4000-FORCE-ERRORS.
 14772     IF PI-RETURN-CD-1 = 'X'
 14773         MOVE ER-0311            TO EMI-ERROR
 14774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14775         MOVE -1                 TO MAINTL
 14776         GO TO 8110-SEND-DATA.
 14777
 14778     IF NOT FORCE-CAP
 14779         MOVE ER-0416            TO EMI-ERROR
 14780         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14781         MOVE -1                 TO MAINTL
 14782         GO TO 8110-SEND-DATA.
 14783
 14784     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14785     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14786     IF EMI-FATAL-CTR GREATER THAN ZERO
 14787         GO TO 4000-FATAL-ERRORS.
 14788
 14789     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14790
 14791     IF EMI-FATAL-CTR GREATER THAN ZERO
 14792         GO TO 4000-FATAL-ERRORS.
 14793
 14794     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14795
 14796     IF EMI-FATAL-CTR GREATER THAN ZERO
 14797         GO TO 4000-FATAL-ERRORS.
 14798
 14799     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14800     MOVE AL-UANOF               TO CERTA.
 14801     MOVE ER-0000 TO EMI-ERROR.
 14802     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14803
 14804 4000-FATAL-ERRORS.
 14805     MOVE -1                     TO MAINTL.
 14806     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 276
* EL131.cbl
 14808
 14809 4100-SAVE-CHANGES.
 14810     IF MAINTL > 0
 14811         MOVE MAINTI  TO WS-SAVE-MAINTI
 14812         MOVE MAINTL  TO WS-SAVE-MAINTL
 14813     END-IF
 14814     IF STATUSL > 0
 14815         MOVE STATUSI  TO WS-SAVE-STATUSI
 14816         MOVE STATUSL  TO WS-SAVE-STATUSL
 14817     END-IF
 14818     IF REPL > 0
 14819         MOVE REPI  TO WS-SAVE-REPI
 14820         MOVE REPL  TO WS-SAVE-REPL
 14821     END-IF
 14822*    IF CAUSEL > 0
 14823*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14824*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14825*    END-IF
 14826*    IF ENDL > 0
 14827*        MOVE ENDI  TO WS-SAVE-ENDI
 14828*        MOVE ENDL  TO WS-SAVE-ENDL
 14829*    END-IF
 14830     IF DIAGL > 0
 14831         MOVE DIAGI  TO WS-SAVE-DIAGI
 14832         MOVE DIAGL  TO WS-SAVE-DIAGL
 14833     END-IF
 14834     IF ICD1L > 0
 14835         MOVE ICD1I  TO WS-SAVE-ICD1I
 14836         MOVE ICD1L  TO WS-SAVE-ICD1L
 14837     END-IF
 14838     IF ICD2L > 0
 14839         MOVE ICD2I  TO WS-SAVE-ICD2I
 14840         MOVE ICD2L  TO WS-SAVE-ICD2L
 14841     END-IF
 14842     IF BENEL > 0
 14843         MOVE BENEI  TO WS-SAVE-BENEI
 14844         MOVE BENEL  TO WS-SAVE-BENEL
 14845     END-IF
 14846     IF BIRTHL > 0
 14847         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14848         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14849     END-IF
 14850     IF SOCIALL > 0
 14851         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14852         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14853     END-IF
 14854     IF SEXL > 0
 14855         MOVE SEXI  TO WS-SAVE-SEXI
 14856         MOVE SEXL  TO WS-SAVE-SEXL
 14857     END-IF
 14858     IF MLNAMEL > 0
 14859         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14860         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14861     END-IF
 14862     IF MFNAMEL > 0
 14863         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14864         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14865     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 277
* EL131.cbl
 14866     IF MMINITL > 0
 14867         MOVE MMINITI  TO WS-SAVE-MMINITI
 14868         MOVE MMINITL  TO WS-SAVE-MMINITL
 14869     END-IF
 14870*    IF LOANNOL > 0
 14871*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14872*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14873*    END-IF
 14874     IF LOANBALL > 0
 14875         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14876         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14877     END-IF
 14878     IF PROCL > 0
 14879         MOVE PROCI  TO WS-SAVE-PROCI
 14880         MOVE PROCL  TO WS-SAVE-PROCL
 14881     END-IF
 14882     IF SUPVL > 0
 14883         MOVE SUPVI  TO WS-SAVE-SUPVI
 14884         MOVE SUPVL  TO WS-SAVE-SUPVL
 14885     END-IF
 14886     IF PRICDL > 0
 14887         MOVE PRICDI  TO WS-SAVE-PRICDI
 14888         MOVE PRICDL  TO WS-SAVE-PRICDL
 14889     END-IF
 14890     IF FILETOL > 0
 14891         MOVE FILETOI  TO WS-SAVE-FILETOI
 14892         MOVE FILETOL  TO WS-SAVE-FILETOL
 14893     END-IF
 14894     IF PDTHRUL > 0
 14895         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14896         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14897     END-IF
 14898     IF PDAMTL > 0
 14899         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14900         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14901     END-IF
 14902     IF NODAYSL > 0
 14903         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14904         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14905     END-IF
 14906     IF NOPMTSL > 0
 14907         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14908         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14909     END-IF
 14910     IF FORMTYPL > 0
 14911         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14912         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14913     END-IF
 14914     IF OCCL > 0
 14915         MOVE OCCI  TO WS-SAVE-OCCI
 14916         MOVE OCCL  TO WS-SAVE-OCCL
 14917     END-IF.
 14918 4100-EXIT.
 14919      EXIT.
 14920
 14921 4200-LOAD-CHANGES.
 14922     IF WS-SAVE-MAINTL > 0
 14923         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 278
* EL131.cbl
 14924         MOVE WS-SAVE-MAINTL  TO MAINTL
 14925         MOVE AL-UANON        TO MAINTA
 14926     END-IF
 14927     IF WS-SAVE-STATUSL > 0
 14928         MOVE WS-SAVE-STATUSI  TO STATUSI
 14929         MOVE WS-SAVE-STATUSL  TO STATUSL
 14930         MOVE AL-UANON         TO STATUSA
 14931     END-IF
 14932     IF WS-SAVE-REPL > 0
 14933         MOVE WS-SAVE-REPI  TO REPI
 14934         MOVE WS-SAVE-REPL  TO REPL
 14935         MOVE AL-UANON      TO REPA
 14936     END-IF
 14937*    IF WS-SAVE-CAUSEL > 0
 14938*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14939*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14940*        MOVE AL-UANON        TO CAUSEA
 14941*    END-IF
 14942*    IF WS-SAVE-ENDL > 0
 14943*        MOVE WS-SAVE-ENDI  TO ENDI
 14944*        MOVE WS-SAVE-ENDL  TO ENDL
 14945*        MOVE AL-UANON      TO ENDA
 14946*    END-IF
 14947     IF WS-SAVE-DIAGL > 0
 14948         MOVE WS-SAVE-DIAGI  TO DIAGI
 14949         MOVE WS-SAVE-DIAGL  TO DIAGL
 14950         MOVE AL-UANON       TO DIAGA
 14951     END-IF
 14952     IF WS-SAVE-ICD1L > 0
 14953         MOVE WS-SAVE-ICD1I  TO ICD1I
 14954         MOVE WS-SAVE-ICD1L  TO ICD1L
 14955         MOVE AL-UANON       TO ICD1A
 14956     END-IF
 14957     IF WS-SAVE-ICD2L > 0
 14958         MOVE WS-SAVE-ICD2I  TO ICD2I
 14959         MOVE WS-SAVE-ICD2L  TO ICD2L
 14960         MOVE AL-UANON       TO ICD2A
 14961     END-IF
 14962     IF WS-SAVE-BENEL > 0
 14963         MOVE WS-SAVE-BENEI  TO BENEI
 14964         MOVE WS-SAVE-BENEL  TO BENEL
 14965         MOVE AL-UANON       TO BENEA
 14966     END-IF
 14967     IF WS-SAVE-BIRTHL > 0
 14968         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14969         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14970         MOVE AL-UANON        TO BIRTHA
 14971     END-IF
 14972     IF WS-SAVE-SOCIALL > 0
 14973         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14974         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14975         MOVE AL-UANON         TO SOCIALA
 14976     END-IF
 14977     IF WS-SAVE-SEXL > 0
 14978         MOVE WS-SAVE-SEXI  TO SEXI
 14979         MOVE WS-SAVE-SEXL  TO SEXL
 14980         MOVE AL-UANON      TO SEXA
 14981     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 279
* EL131.cbl
 14982     IF WS-SAVE-MLNAMEL > 0
 14983         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14984         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14985         MOVE AL-UANON         TO MLNAMEA
 14986     END-IF
 14987     IF WS-SAVE-MFNAMEL > 0
 14988         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14989         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14990         MOVE AL-UANON         TO MFNAMEA
 14991     END-IF
 14992     IF WS-SAVE-MMINITL > 0
 14993         MOVE WS-SAVE-MMINITI  TO MMINITI
 14994         MOVE WS-SAVE-MMINITL  TO MMINITL
 14995         MOVE AL-UANON         TO MMINITA
 14996     END-IF
 14997*    IF WS-SAVE-LOANNOL > 0
 14998*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14999*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 15000*        MOVE AL-UANON         TO LOANNOA
 15001*    END-IF
 15002     IF WS-SAVE-LOANBALL > 0
 15003         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 15004         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 15005         MOVE AL-UANON          TO LOANBALA
 15006     END-IF
 15007     IF WS-SAVE-PROCL > 0
 15008         MOVE WS-SAVE-PROCI  TO PROCI
 15009         MOVE WS-SAVE-PROCL  TO PROCL
 15010         MOVE AL-UANON       TO PROCA
 15011     END-IF
 15012     IF WS-SAVE-SUPVL > 0
 15013         MOVE WS-SAVE-SUPVI  TO SUPVI
 15014         MOVE WS-SAVE-SUPVL  TO SUPVL
 15015         MOVE AL-UANON       TO SUPVA
 15016     END-IF
 15017     IF WS-SAVE-PRICDL > 0
 15018         MOVE WS-SAVE-PRICDI  TO PRICDI
 15019         MOVE WS-SAVE-PRICDL  TO PRICDL
 15020         MOVE AL-UANON        TO PRICDA
 15021     END-IF
 15022     IF WS-SAVE-FILETOL > 0
 15023         MOVE WS-SAVE-FILETOI  TO FILETOI
 15024         MOVE WS-SAVE-FILETOL  TO FILETOL
 15025         MOVE AL-UANON         TO FILETOA
 15026     END-IF
 15027     IF WS-SAVE-PDTHRUL > 0
 15028         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 15029         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 15030         MOVE AL-UANON         TO PDTHRUA
 15031     END-IF
 15032     IF WS-SAVE-PDAMTL > 0
 15033         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 15034         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 15035         MOVE AL-UANON        TO PDAMTA
 15036     END-IF
 15037     IF WS-SAVE-NODAYSL > 0
 15038         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 15039         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 280
* EL131.cbl
 15040         MOVE AL-UANON         TO NODAYSA
 15041     END-IF
 15042     IF WS-SAVE-NOPMTSL > 0
 15043         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 15044         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 15045         MOVE AL-UANON         TO NOPMTSA
 15046     END-IF
 15047     IF WS-SAVE-FORMTYPL > 0
 15048         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 15049         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 15050         MOVE AL-UANON          TO FORMTYPA
 15051     END-IF
 15052     IF WS-SAVE-OCCL > 0
 15053         MOVE WS-SAVE-OCCI  TO OCCI
 15054         MOVE WS-SAVE-OCCL  TO OCCL
 15055         MOVE AL-UANON      TO OCCA
 15056     END-IF.
 15057 4200-EXIT.
 15058      EXIT.
 15059
 15060 5000-BUILD-MAP.
 15061     IF PI-RETURN-CD-1 = SPACE
 15062         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 15063
 15064     MOVE SPACE                  TO PI-RETURN-CD-1.
 15065
 15066     MOVE LOW-VALUES             TO EL131AI.
 15067
 15068     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 15069     MOVE PI-CARRIER             TO CARRIER-CODE.
 15070     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 15071     MOVE PI-CERT-NO             TO CERT-NO.
 15072
 15073 5000-READ-CLAIM-MASTER.
 15074
 15075
 15076* EXEC CICS READ
 15077*         SET      (ADDRESS OF CLAIM-MASTER)
 15078*         DATASET  (CLMS-FILE-ID)
 15079*         RIDFLD   (MSTR-KEY)
 15080*    END-EXEC.
 15081*    MOVE '&"S        E          (   #00012735' TO DFHEIV0
 15082     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15084     MOVE X'2020233030303132373335' TO DFHEIV0(25:11)
 15085     CALL 'kxdfhei1' USING DFHEIV0,
 15086           CLMS-FILE-ID,
 15087           DFHEIV20,
 15088           DFHEIV99,
 15089           MSTR-KEY,
 15090           DFHEIV99,
 15091           DFHEIV99,
 15092           DFHEIV99
 15093     SET ADDRESS OF CLAIM-MASTER TO
 15094         DFHEIV20
 15095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15096
 15097
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 281
* EL131.cbl
 15098     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 15099
 15100 5000-READ-DIAGNOSIS-TRAILER.
 15101
 15102
 15103* EXEC CICS HANDLE CONDITION
 15104*         NOTFND (5000-TRLR-NOT-FOUND)
 15105*    END-EXEC.
 15106*    MOVE '"$I                   ! B #00012745' TO DFHEIV0
 15107     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15109     MOVE X'4220233030303132373435' TO DFHEIV0(25:11)
 15110     CALL 'kxdfhei1' USING DFHEIV0
 15111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15112
 15113
 15114     MOVE MSTR-KEY               TO TRLR-KEY.
 15115     MOVE NINETY                 TO TRLR-SEQ-NO.
 15116
 15117
 15118* EXEC CICS READ
 15119*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15120*         DATASET  (TRLR-FILE-ID)
 15121*         RIDFLD   (TRLR-KEY)
 15122*    END-EXEC.
 15123*    MOVE '&"S        E          (   #00012752' TO DFHEIV0
 15124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15126     MOVE X'2020233030303132373532' TO DFHEIV0(25:11)
 15127     CALL 'kxdfhei1' USING DFHEIV0,
 15128           TRLR-FILE-ID,
 15129           DFHEIV20,
 15130           DFHEIV99,
 15131           TRLR-KEY,
 15132           DFHEIV99,
 15133           DFHEIV99,
 15134           DFHEIV99
 15135     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15136         DFHEIV20
 15137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15138
 15139
 15140     MOVE AT-INFO-LINE-1         TO DIAGO.
 15141     MOVE AT-ICD-CODE-1          TO ICD1O.
 15142     MOVE AT-ICD-CODE-2          TO ICD2O.
 15143
 15144 5000-READ-CERTIFICATE-MASTER.
 15145
 15146     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 15147     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 15148     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 15149     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 15150     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 15151     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 15152     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 15153
 15154
 15155* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 282
* EL131.cbl
 15156*         NOTFND (5000-CERT-NOT-FOUND)
 15157*    END-EXEC.
 15158*    MOVE '"$I                   ! C #00012772' TO DFHEIV0
 15159     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15160     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15161     MOVE X'4320233030303132373732' TO DFHEIV0(25:11)
 15162     CALL 'kxdfhei1' USING DFHEIV0
 15163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15164
 15165
 15166
 15167* EXEC CICS READ
 15168*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15169*         DATASET  (CERT-FILE-ID)
 15170*         RIDFLD   (CERT-KEY)
 15171*    END-EXEC.
 15172*    MOVE '&"S        E          (   #00012776' TO DFHEIV0
 15173     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15175     MOVE X'2020233030303132373736' TO DFHEIV0(25:11)
 15176     CALL 'kxdfhei1' USING DFHEIV0,
 15177           CERT-FILE-ID,
 15178           DFHEIV20,
 15179           DFHEIV99,
 15180           CERT-KEY,
 15181           DFHEIV99,
 15182           DFHEIV99,
 15183           DFHEIV99
 15184     SET ADDRESS OF CERTIFICATE-MASTER TO
 15185         DFHEIV20
 15186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15187
 15188
 15189     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 15190     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 15191     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 15192
 15193     GO TO 5000-EXIT.
 15194
 15195 5000-TRLR-NOT-FOUND.
 15196     MOVE ER-7687                TO EMI-ERROR.
 15197     MOVE -1                     TO DIAGL.
 15198     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15199     GO TO 5000-EXIT.
 15200
 15201 5000-CERT-NOT-FOUND.
 15202     MOVE ER-0206                TO EMI-ERROR.
 15203     MOVE -1                     TO CERTL.
 15204     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15205
 15206 5000-EXIT.
 15207     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 283
* EL131.cbl
 15209 5010-RESET-PI-AREA.
 15210     IF CERTI GREATER THAN LOW-VALUES
 15211         MOVE CERTI              TO PI-CERT-PRIME.
 15212
 15213     IF SUFXI GREATER THAN LOW-VALUES
 15214         MOVE SUFXI              TO PI-CERT-SFX.
 15215
 15216     IF CERTEFFI GREATER THAN LOW-VALUES
 15217         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 15218
 15219     IF CERTACTI GREATER THAN LOW-VALUES
 15220         MOVE CERTACTI           TO PI-ACCOUNT.
 15221
 15222     IF CERTSTI GREATER THAN LOW-VALUES
 15223         MOVE CERTSTI            TO PI-STATE.
 15224
 15225     IF CERTCARI GREATER THAN LOW-VALUES
 15226         MOVE CERTCARI           TO PI-CARRIER.
 15227
 15228     IF CERTGRPI GREATER THAN LOW-VALUES
 15229         MOVE CERTGRPI           TO PI-GROUPING.
 15230
 15231 5010-EXIT.
 15232     EXIT.
 15233
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 284
* EL131.cbl
 15235 5020-MOVE-MSTR.
 15236
 15237     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 15238     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 15239     MOVE WS-CLAIM-SEQU          TO SEQUO.
 15240     MOVE AL-SABON               TO SEQUA.
 15241     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 15242     MOVE CL-CLAIM-TYPE          TO TYPEO
 15243                                    pi-claim-type
 15244
 15245     IF CL-TOTAL-PAID-AMT  = +0 AND
 15246        CL-LAST-PMT-AMT    = +0 AND
 15247        CL-NO-OF-PMTS-MADE = +0
 15248          MOVE AL-UANON          TO TYPEA.
 15249
 15250     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 15251     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 15252     MOVE CL-CERT-PRIME          TO CERTO.
 15253     MOVE CL-CERT-SFX            TO SUFXO.
 15254     MOVE CL-CERT-CARRIER        TO CARRO.
 15255
 15256     IF CL-CLAIM-STATUS = 'C'
 15257         MOVE 'CLOSED'           TO STATUSO
 15258     ELSE
 15259         MOVE 'OPEN  '           TO STATUSO.
 15260
 15261     move cl-accident-claim-sw   to accswo
 15262     if cl-benefit-period not numeric
 15263        move zeros               to cl-benefit-period
 15264     end-if
 15265     move cl-benefit-period      to benpero
 15266     move cl-insured-type        to instypeo
 15267     MOVE CL-PROCESSOR-ID        TO PROCO.
 15268
 15269     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 15270     MOVE CL-CCN                 TO CCNOO.
 15271
 15272     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 15273     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 15274     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 15275     MOVE CL-INSURED-SEX-CD      TO SEXO.
 15276
 15277     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 15278         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 15279         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15280         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15281         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 15282     ELSE
 15283         MOVE SPACES             TO BIRTHO.
 15284
 15285     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 15286        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 15287         NEXT SENTENCE
 15288       ELSE
 15289         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 15290
 15291     IF PI-COMPANY-ID = 'DMD'
 15292       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 285
* EL131.cbl
 15293          IF SOCIALO = SPACES OR LOW-VALUES
 15294            MOVE ER-0885         TO EMI-ERROR
 15295            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15296
 15297     MOVE CL-INSURED-OCC-CD      TO OCCO.
 15298*    MOVE CL-CAUSE-CD            TO CAUSEO.
 15299
 15300*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 15301*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 15302*        MOVE SPACES                 TO DC-OPTION-CODE
 15303*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15304*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 15305*    ELSE
 15306*        MOVE SPACES             TO ENDO.
 15307
 15308     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 15309        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15310        MOVE SPACES             TO DC-OPTION-CODE
 15311        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15312        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15313        IF PI-USES-PAID-TO
 15314           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15315           MOVE '6'                TO DC-OPTION-CODE
 15316           MOVE +1                 TO DC-ELAPSED-DAYS
 15317           MOVE +0                 TO DC-ELAPSED-MONTHS
 15318           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15319           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15320        ELSE
 15321           NEXT SENTENCE
 15322     ELSE
 15323        MOVE SPACES             TO PDTHRUO.
 15324
 15325     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 15326     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 15327     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 15328     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 15329
 15330     IF MODIFY-CAP
 15331        MOVE AL-UNNOF            TO PDAMTA
 15332                                    NODAYSA
 15333                                    NOPMTSA
 15334        MOVE AL-UANOF            TO PDTHRUA.
 15335     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 15336     MOVE '2'                    TO CNTL-REC-TYPE
 15337     MOVE +0                     TO CNTL-SEQ-NO
 15338     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 15339
 15340
 15341* EXEC CICS READ
 15342*         DATASET  (CNTL-FILE-ID)
 15343*         SET      (ADDRESS OF CONTROL-FILE)
 15344*         RIDFLD   (CNTL-KEY)
 15345*         RESP     (WS-RESPONSE)
 15346*    END-EXEC
 15347*    MOVE '&"S        E          (  N#00012933' TO DFHEIV0
 15348     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15349     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15350     MOVE X'204E233030303132393333' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 286
* EL131.cbl
 15351     CALL 'kxdfhei1' USING DFHEIV0,
 15352           CNTL-FILE-ID,
 15353           DFHEIV20,
 15354           DFHEIV99,
 15355           CNTL-KEY,
 15356           DFHEIV99,
 15357           DFHEIV99,
 15358           DFHEIV99
 15359     SET ADDRESS OF CONTROL-FILE TO
 15360         DFHEIV20
 15361     MOVE EIBRESP  TO WS-RESPONSE
 15362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15363
 15364     IF WS-RESP-NORMAL
 15365        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 15366     end-if
 15367     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 15368         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15369         MOVE SPACES             TO DC-OPTION-CODE
 15370         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15371         MOVE DC-GREG-DATE-1-EDIT TO INCO
 15372     ELSE
 15373         MOVE SPACES             TO INCO.
 15374
 15375     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 15376        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 15377        MOVE AL-UANOF            TO INCA
 15378     end-if
 15379     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 15380
 15381     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 15382         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 15383         MOVE SPACES             TO DC-OPTION-CODE
 15384         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15385         MOVE DC-GREG-DATE-1-EDIT TO REPO
 15386     ELSE
 15387         MOVE SPACES             TO REPO.
 15388
 15389     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 15390         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 15391         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15392         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15393         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 15394     ELSE
 15395         MOVE SPACES             TO ESTO.
 15396
 15397     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 15398         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 15399         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15400         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15401         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 15402     ELSE
 15403         MOVE SPACES             TO MNTDTO.
 15404
 15405
 15406     IF CL-LAST-MAINT-TYPE = SPACE
 15407         MOVE 'SET-UP'           TO MNTTYPEO
 15408     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 287
* EL131.cbl
 15409     IF CL-LAST-MAINT-TYPE = '1'
 15410         MOVE 'PAYMNT'           TO MNTTYPEO
 15411     ELSE
 15412     IF CL-LAST-MAINT-TYPE = '2'
 15413         MOVE 'LETTER'           TO MNTTYPEO
 15414     ELSE
 15415     IF CL-LAST-MAINT-TYPE = '3'
 15416         MOVE 'UPDATE'           TO MNTTYPEO
 15417     ELSE
 15418     IF CL-LAST-MAINT-TYPE = '4'
 15419         MOVE 'RESTOR'           TO MNTTYPEO
 15420     ELSE
 15421     IF CL-LAST-MAINT-TYPE = '5'
 15422         MOVE 'INC DT'           TO MNTTYPEO
 15423     ELSE
 15424     IF CL-LAST-MAINT-TYPE = '6'
 15425         MOVE ' CONV'            TO MNTTYPEO
 15426     ELSE
 15427     IF CL-LAST-MAINT-TYPE = 'C'
 15428         MOVE 'CHGBEN'           TO MNTTYPEO
 15429     ELSE
 15430     IF CL-LAST-MAINT-TYPE = 'E'
 15431         MOVE 'ERRCOR'           TO MNTTYPEO
 15432     ELSE
 15433         MOVE SPACES             TO MNTTYPEO.
 15434
 15435     MOVE CL-BENEFICIARY         TO BENEO.
 15436     MOVE CL-FILE-LOCATION       TO FILETOO.
 15437     IF CL-CRITICAL-PERIOD NOT NUMERIC
 15438        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 15439     END-IF
 15440     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 15441     IF CL-NO-OF-EXTENSIONS NOT NUMERIC
 15442        MOVE ZEROS               TO CL-NO-OF-EXTENSIONS
 15443     END-IF
 15444     MOVE CL-NO-OF-EXTENSIONS    TO EXTENSO
 15445*    MOVE CL-CRIT-PER-RECURRENT
 15446*                                TO CRITPTO
 15447*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 15448*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 15449*    END-IF
 15450*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 15451     MOVE CL-PRIORITY-CD         TO PRICDO.
 15452     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 15453     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15454     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15455     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 15456
 15457 5020-EXIT.
 15458     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 288
* EL131.cbl
 15460 5030-MOVE-CERT.
 15461
 15462     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 15463         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 15464         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15465         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15466         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 15467       ELSE
 15468         MOVE SPACES             TO CERTEFFO
 15469         MOVE ZERO               TO HOLD-DATE.
 15470
 15471     MOVE CM-ACCOUNT             TO CERTACTO.
 15472     MOVE CM-STATE               TO CERTSTO PI-STATE.
 15473     MOVE CM-GROUPING            TO CERTGRPO.
 15474     MOVE CM-CARRIER             TO CERTCARO.
 15475     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 15476     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 15477     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 15478     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 15479     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 15480     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 15481     MOVE CM-JT-INITIAL          TO JNTINITO.
 15482     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 15483
 15484*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 15485     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 15486     MOVE '3'                    TO CNTL-REC-TYPE.
 15487     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 15488     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 15489     MOVE ZERO                   TO CNTL-SEQ-NO.
 15490
 15491
 15492* EXEC CICS READ
 15493*         SET        (ADDRESS OF CONTROL-FILE)
 15494*         DATASET    ('ELCNTL')
 15495*         RIDFLD     (CNTL-KEY)
 15496*         RESP       (WS-RESPONSE)
 15497*    END-EXEC.
 15498     MOVE 'ELCNTL' TO DFHEIV1
 15499*    MOVE '&"S        E          (  N#00013067' TO DFHEIV0
 15500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15502     MOVE X'204E233030303133303637' TO DFHEIV0(25:11)
 15503     CALL 'kxdfhei1' USING DFHEIV0,
 15504           DFHEIV1,
 15505           DFHEIV20,
 15506           DFHEIV99,
 15507           CNTL-KEY,
 15508           DFHEIV99,
 15509           DFHEIV99,
 15510           DFHEIV99
 15511     SET ADDRESS OF CONTROL-FILE TO
 15512         DFHEIV20
 15513     MOVE EIBRESP  TO WS-RESPONSE
 15514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15515
 15516
 15517     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 289
* EL131.cbl
 15518        MOVE ZERO                TO CP-FREE-LOOK
 15519     ELSE
 15520        MOVE CF-ST-FREE-LOOK-PERIOD
 15521                                 TO CP-FREE-LOOK.
 15522
 15523     IF CM-LF-BENEFIT-CD = '00'
 15524        GO TO 5030-MOVE-CERT-AH.
 15525
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 290
* EL131.cbl
 15527     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15528     MOVE '5'                    TO DC-OPTION-CODE
 15529     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15530     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15531     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15532     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15533     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15534     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15535     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15536     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15537     MOVE '4'                    TO CP-REM-TERM-METHOD
 15538     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15539     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15540     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15541
 15542     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15543     IF CM-LF-PREMIUM-RATE NUMERIC
 15544         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15545     ELSE
 15546         MOVE ZEROS              TO LCVRATEO.
 15547
 15548     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15549         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15550
 15551     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15552
 15553     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15554
 15555     IF CM-LF-CURRENT-STATUS = '8'
 15556        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15557            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15558            MOVE ' '             TO DC-OPTION-CODE
 15559            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15560            IF NOT DATE-CONVERSION-ERROR
 15561                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15562
 15563     IF CM-LF-CURRENT-STATUS = '7'
 15564        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15565            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15566            MOVE ' '             TO DC-OPTION-CODE
 15567            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15568            IF NOT DATE-CONVERSION-ERROR
 15569                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15570
 15571     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15572         MOVE ' '                TO DC-OPTION-CODE
 15573         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15574         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15575         IF NOT DATE-CONVERSION-ERROR
 15576             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15577             MOVE HOLD-MONTH     TO WORK-MONTH
 15578             MOVE HOLD-YEAR      TO WORK-YEAR
 15579             MOVE WORK-DATE-MY   TO LCVEXITO.
 15580
 15581     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15582        IF CP-REMAINING-TERM-3 = ZEROS
 15583           MOVE 'EXPIRED'        TO LCVSTATO
 15584        ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 291
* EL131.cbl
 15585           MOVE 'ACTIVE'         TO LCVSTATO.
 15586
 15587     IF CM-LF-CURRENT-STATUS = '2'
 15588        MOVE 'PEND   '           TO LCVSTATO.
 15589     IF CM-LF-CURRENT-STATUS = '3'
 15590        MOVE 'RESTORE'           TO LCVSTATO.
 15591     IF CM-LF-CURRENT-STATUS = '5'
 15592        MOVE 'REISSUE'           TO LCVSTATO.
 15593     IF CM-LF-CURRENT-STATUS = '6'
 15594        MOVE 'LMPBEN'            TO LCVSTATO.
 15595     IF CM-LF-CURRENT-STATUS = '7'
 15596        MOVE 'DEATH  '           TO LCVSTATO.
 15597     IF CM-LF-CURRENT-STATUS = '8'
 15598        MOVE 'CANCEL '           TO LCVSTATO.
 15599     IF CM-LF-CURRENT-STATUS = '9'
 15600        MOVE 'RE-ONLY'           TO LCVSTATO.
 15601     IF CM-LF-CURRENT-STATUS = 'V'
 15602        MOVE 'VOID   '           TO LCVSTATO.
 15603     IF CM-LF-CURRENT-STATUS = 'D'
 15604        MOVE 'DECLINE'           TO LCVSTATO.
 15605
 15606     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15607     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15608     MOVE '4'                    TO BEN-REC-TYPE.
 15609     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15610     MOVE ZERO                   TO BEN-SEQ-NO.
 15611
 15612
 15613* EXEC CICS READ GTEQ
 15614*         DATASET  (CNTL-FILE-ID)
 15615*         RIDFLD   (BENEFIT-KEY)
 15616*         SET      (ADDRESS OF CONTROL-FILE)
 15617*    END-EXEC.
 15618*    MOVE '&"S        G          (   #00013169' TO DFHEIV0
 15619     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15620     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15621     MOVE X'2020233030303133313639' TO DFHEIV0(25:11)
 15622     CALL 'kxdfhei1' USING DFHEIV0,
 15623           CNTL-FILE-ID,
 15624           DFHEIV20,
 15625           DFHEIV99,
 15626           BENEFIT-KEY,
 15627           DFHEIV99,
 15628           DFHEIV99,
 15629           DFHEIV99
 15630     SET ADDRESS OF CONTROL-FILE TO
 15631         DFHEIV20
 15632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15633
 15634
 15635     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15636        CF-RECORD-TYPE NOT = '4'
 15637         MOVE ER-0240            TO EMI-ERROR
 15638         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15639         GO TO 5030-MOVE-CERT-FINISH.
 15640
 15641     MOVE ZERO                   TO COUNT-2.
 15642     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 292
* EL131.cbl
 15643
 15644     IF SCREEN-ERROR
 15645         MOVE ER-0282            TO EMI-ERROR
 15646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15647        ELSE
 15648         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15649
 15650 5030-MOVE-CERT-AH.
 15651
 15652     IF CM-LF-BENEFIT-CD = '00'
 15653         IF CM-AH-BENEFIT-CD = '00'
 15654             GO TO 5030-MOVE-CERT-FINISH.
 15655
 15656     IF CM-AH-BENEFIT-CD = '00'
 15657        MOVE SPACES             TO ACVKINDO
 15658        COMPUTE PI-PAYMENT-AMT =
 15659                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15660        GO TO 5030-MOVE-CERT-FINISH.
 15661
 15662     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15663     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15664     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15665     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15666     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15667     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15668     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15669     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15670
 15671**DMD **********************************************
 15672     IF PI-COMPANY-ID = 'DMD'
 15673         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15674                                   CM-PMT-EXTENSION-DAYS
 15675         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15676                                      CL-NO-OF-DAYS-PAID
 15677         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15678             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15679         MOVE WS-REM-MOS         TO ACVRTRMO
 15680                                    CP-REMAINING-TERM-3
 15681*        MOVE WS-REM-DAYS        TO DAYSPO
 15682         GO TO 5030-SKIP-RTRM.
 15683**DMD **********************************************
 15684
 15685     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15686     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15687     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15688     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15689
 15690 5030-SKIP-RTRM.
 15691     IF CM-AH-PREMIUM-RATE NUMERIC
 15692         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15693     ELSE
 15694         MOVE ZEROS              TO ACVRATEO.
 15695
 15696     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15697     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15698
 15699     IF CM-AH-CURRENT-STATUS = '8'
 15700        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 293
* EL131.cbl
 15701            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15702            MOVE ' '             TO DC-OPTION-CODE
 15703            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15704            IF NOT DATE-CONVERSION-ERROR
 15705                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15706
 15707     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15708        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15709            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15710            MOVE ' '             TO DC-OPTION-CODE
 15711            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15712            IF NOT DATE-CONVERSION-ERROR
 15713                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15714
 15715     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15716        IF CP-REMAINING-TERM-3 = ZEROS
 15717           MOVE 'EXPIRED'        TO ACVSTATO
 15718        ELSE
 15719           MOVE 'ACTIVE'         TO ACVSTATO.
 15720
 15721     IF CM-AH-CURRENT-STATUS = '2'
 15722        MOVE 'PEND   '           TO ACVSTATO.
 15723     IF CM-AH-CURRENT-STATUS = '3'
 15724        MOVE 'RESTORE'           TO ACVSTATO.
 15725     IF CM-AH-CURRENT-STATUS = '5'
 15726        MOVE 'REISSUE'           TO ACVSTATO.
 15727     IF CM-AH-CURRENT-STATUS = '6'
 15728        MOVE 'LMP DIS'           TO ACVSTATO.
 15729     IF CM-AH-CURRENT-STATUS = '7'
 15730        MOVE 'DEATH  '           TO ACVSTATO.
 15731     IF CM-AH-CURRENT-STATUS = '8'
 15732        MOVE 'CANCEL '           TO ACVSTATO.
 15733     IF CM-AH-CURRENT-STATUS = '9'
 15734        MOVE 'RE-ONLY'           TO ACVSTATO.
 15735     IF CM-AH-CURRENT-STATUS = 'V'
 15736        MOVE 'VOID   '           TO ACVSTATO.
 15737     IF CM-AH-CURRENT-STATUS = '9'
 15738        MOVE 'DECLINE'           TO ACVSTATO.
 15739
 15740     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15741         MOVE ' '                TO DC-OPTION-CODE
 15742         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15743         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15744         IF NOT DATE-CONVERSION-ERROR
 15745             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15746             MOVE HOLD-MONTH     TO WORK-MONTH
 15747             MOVE HOLD-YEAR      TO WORK-YEAR
 15748             MOVE WORK-DATE-MY   TO ACVEXITO.
 15749
 15750     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15751
 15752     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15753     MOVE '5'                    TO BEN-REC-TYPE.
 15754     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15755     MOVE ZERO                   TO BEN-SEQ-NO.
 15756
 15757
 15758* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 294
* EL131.cbl
 15759*         DATASET  (CNTL-FILE-ID)
 15760*         RIDFLD   (BENEFIT-KEY)
 15761*         SET      (ADDRESS OF CONTROL-FILE)
 15762*    END-EXEC.
 15763*    MOVE '&"S        G          (   #00013297' TO DFHEIV0
 15764     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15766     MOVE X'2020233030303133323937' TO DFHEIV0(25:11)
 15767     CALL 'kxdfhei1' USING DFHEIV0,
 15768           CNTL-FILE-ID,
 15769           DFHEIV20,
 15770           DFHEIV99,
 15771           BENEFIT-KEY,
 15772           DFHEIV99,
 15773           DFHEIV99,
 15774           DFHEIV99
 15775     SET ADDRESS OF CONTROL-FILE TO
 15776         DFHEIV20
 15777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15778
 15779
 15780     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15781        CF-RECORD-TYPE NOT = '5'
 15782         MOVE ER-0250            TO EMI-ERROR
 15783         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15784         GO TO 5030-MOVE-CERT-FINISH.
 15785
 15786     MOVE ZERO                   TO COUNT-2.
 15787     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15788
 15789     IF SCREEN-ERROR
 15790         MOVE ER-0283            TO EMI-ERROR
 15791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15792       ELSE
 15793         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15794
 15795 5030-MOVE-CERT-FINISH.
 15796
 15797     MOVE CM-LOAN-APR            TO APRO.
 15798     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15799     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15800     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15801*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15802     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15803     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15804
 15805     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15806         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15807         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15808         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15809         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15810     ELSE
 15811         MOVE SPACES               TO ADDONDTO.
 15812
 15813     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15814
 15815 5030-EXIT.
 15816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 295
* EL131.cbl
 15818 5040-FIND-BENEFIT.
 15819     ADD 1                       TO COUNT-2.
 15820     IF COUNT-2 GREATER THAN 8
 15821         GO TO 5050-BENEFIT-NOTFND.
 15822
 15823     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15824         GO TO 5060-EXIT.
 15825
 15826     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15827         GO TO 5050-BENEFIT-NOTFND.
 15828
 15829     GO TO 5040-FIND-BENEFIT.
 15830
 15831 5050-BENEFIT-NOTFND.
 15832     MOVE 'X'                    TO ERROR-SWITCH.
 15833
 15834 5060-EXIT.
 15835     EXIT.
 15836 5100-LOAD-CORR-TRLR.
 15837     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15838     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15839     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15840     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15841     MOVE 1000               TO TRLR-SEQ-NO.
 15842
 15843
 15844* EXEC CICS HANDLE CONDITION
 15845*         NOTFND    (1052-DONE)
 15846*         ENDFILE   (1052-DONE)
 15847*    END-EXEC.
 15848*    MOVE '"$I''                  ! D #00013366' TO DFHEIV0
 15849     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15851     MOVE X'4420233030303133333636' TO DFHEIV0(25:11)
 15852     CALL 'kxdfhei1' USING DFHEIV0
 15853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15854
 15855
 15856
 15857* EXEC CICS STARTBR
 15858*        DATASET (TRLR-FILE-ID)
 15859*        RIDFLD  (TRLR-KEY)
 15860*    END-EXEC
 15861     MOVE 0
 15862       TO DFHEIV11
 15863*    MOVE '&,         G          &   #00013371' TO DFHEIV0
 15864     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15865     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15866     MOVE X'2020233030303133333731' TO DFHEIV0(25:11)
 15867     CALL 'kxdfhei1' USING DFHEIV0,
 15868           TRLR-FILE-ID,
 15869           TRLR-KEY,
 15870           DFHEIV99,
 15871           DFHEIV11,
 15872           DFHEIV99
 15873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15874
 15875
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 296
* EL131.cbl
 15876     MOVE SPACES TO WS-TRLR-FILE-EOF
 15877                    WS-AUTH-RCVD
 15878     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15879       UNTIL  TRLR-FILE-EOF
 15880         OR WS-AUTH-RCVD > SPACES.
 15881
 15882
 15883* EXEC CICS ENDBR
 15884*        DATASET (TRLR-FILE-ID)
 15885*    END-EXEC.
 15886     MOVE 0
 15887       TO DFHEIV11
 15888*    MOVE '&2                    $   #00013383' TO DFHEIV0
 15889     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15890     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15891     MOVE X'2020233030303133333833' TO DFHEIV0(25:11)
 15892     CALL 'kxdfhei1' USING DFHEIV0,
 15893           TRLR-FILE-ID,
 15894           DFHEIV11,
 15895           DFHEIV99
 15896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15897
 15898
 15899     IF AUTH-RCVD
 15900        MOVE 'Y' TO AUTHRCVO
 15901     ELSE
 15902        MOVE 'N' TO AUTHRCVO
 15903     END-IF.
 15904
 15905
 15906 5100-EXIT.
 15907     EXIT.
 15908
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 297
* EL131.cbl
 15910 6000-CALCULATE-CERT-TERM.
 15911
 15912     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15913         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15914     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15915         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15916     IF CM-LOAN-APR NOT NUMERIC
 15917         MOVE ZEROS              TO CM-LOAN-APR.
 15918
 15919*    IF WS-CALC-METHOD  = 'G'
 15920         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15921*     ELSE
 15922*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15923
 15924     IF N GREATER 120
 15925         MOVE 120                TO N.
 15926
 15927     MOVE '6'                    TO DC-OPTION-CODE.
 15928     MOVE N                      TO DC-ELAPSED-MONTHS.
 15929     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15930     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15931
 15932     IF CM-LF-BENEFIT-CD NOT = ZERO
 15933         MOVE N                  TO CM-LF-ORIG-TERM
 15934         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15935         IF NO-CONVERSION-ERROR
 15936             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15937
 15938     IF CM-AH-BENEFIT-CD NOT = ZERO
 15939         MOVE N                  TO CM-AH-ORIG-TERM
 15940         IF NO-CONVERSION-ERROR
 15941             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15942
 15943 6000-EXIT.
 15944      EXIT.
 15945
 15946 6100-CALC-GROSS-TERM.
 15947     MOVE CM-LOAN-BALANCE         TO L.
 15948     MOVE PI-PAYMENT-AMT          TO M.
 15949
 15950     COMPUTE N = L / M.
 15951     IF N LESS 1
 15952         MOVE 1  TO N.
 15953
 15954     IF CM-LF-BENEFIT-CD NOT = ZERO
 15955         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15956     ELSE
 15957         MOVE ZEROS               TO WS-LF-RATE.
 15958
 15959     IF CM-AH-BENEFIT-CD NOT = ZERO
 15960         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15961     ELSE
 15962         MOVE ZEROS               TO WS-AH-RATE.
 15963
 15964     COMPUTE I = CM-LOAN-APR / +1200.
 15965
 15966 6105-LOOP.
 15967     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 298
* EL131.cbl
 15968         GO TO 6200-EXIT.
 15969     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15970     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15971         ADD 1 TO N
 15972         GO TO 6105-LOOP.
 15973
 15974 6200-EXIT.
 15975      EXIT.
 15976
 15977 6210-CALC-LEFT-RIGHTONE.
 15978      MOVE L         TO LEFT-TOT-1.
 15979      SUBTRACT 1 FROM N.
 15980      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15981      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15982      ADD 1 TO N.
 15983 6211-CALC-TERM1.
 15984      MOVE N         TO TERM1.
 15985      MULTIPLY M BY TERM1.
 15986 6212-LOOP.
 15987      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15988      ADD 1 TO A-N.
 15989      MULTIPLY A-N BY TERM1.
 15990      SUBTRACT 1 FROM A-N.
 15991      ADD TERM1 TO LEFT-TOT-1.
 15992 6213-CALC-TERM2.
 15993      MOVE M         TO TERM2.
 15994      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15995      MULTIPLY IA-N BY TERM2.
 15996      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15997 6215-CALC-RIGHTONE.
 15998      MOVE M         TO RIGHT-TOT-1.
 15999      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16000      MULTIPLY A-N BY RIGHT-TOT-1.
 16001 6220-EXIT.
 16002      EXIT.
 16003
 16004 6300-CALC-A-N.
 16005     IF N LESS 1
 16006         MOVE 0     TO A-N
 16007         GO TO 6300-EXIT.
 16008     IF I = 0
 16009         MOVE .00001 TO I.
 16010     ADD 1 TO I.
 16011     DIVIDE I INTO 1 GIVING V.
 16012     SUBTRACT 1 FROM I.
 16013     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16014     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 16015     DIVIDE I INTO TERM3 GIVING A-N.
 16016 6300-EXIT.
 16017      EXIT.
 16018
 16019 6350-CALC-IA-N.
 16020     IF N LESS 1
 16021         MOVE 0      TO IA-N
 16022         GO TO 6400-EXIT.
 16023     ADD 1 TO N.
 16024     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16025     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 299
* EL131.cbl
 16026     MULTIPLY N BY V-EX-N GIVING TERM3.
 16027     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 16028     SUBTRACT V FROM 1 GIVING TERM4.
 16029     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 16030 6400-EXIT.
 16031      EXIT.
 16032
 16033 6450-CALC-V-EX-N.
 16034     IF N LESS 1
 16035         MOVE 1    TO V-EX-N
 16036         GO TO 6490-EXIT.
 16037     MOVE N        TO NV-STORE.
 16038     IF V-EX-ONETIME = 1  OR
 16039        V NOT = V-EXPONENT (1)
 16040          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 16041 6460-LOOP.
 16042     IF N GREATER 248
 16043         MOVE 248 TO N.
 16044     IF N = 1
 16045         MOVE V               TO V-EX-N
 16046      ELSE
 16047         MOVE V-EXPONENT (N)  TO V-EX-N.
 16048     GO TO 6490-EXIT.
 16049
 16050 6470-BUILD-V-EX-TABLE.
 16051     MOVE 2      TO N.
 16052     MOVE V      TO V-EXPONENT (1)
 16053                    V-EX-N.
 16054 6471-LOOP.
 16055     MULTIPLY V BY V-EX-N.
 16056     MOVE V-EX-N   TO V-EXPONENT (N).
 16057     ADD 1 TO N.
 16058     IF N LESS 248
 16059         GO TO 6471-LOOP.
 16060     MOVE NV-STORE     TO N.
 16061     MOVE 0            TO V-EX-ONETIME.
 16062 6480-EXIT.
 16063      EXIT.
 16064
 16065 6490-EXIT.
 16066      EXIT.
 16067
 16068 6500-CALC-NET-TERM.
 16069     MOVE CM-LOAN-BALANCE         TO L.
 16070     MOVE PI-PAYMENT-AMT          TO M.
 16071
 16072     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 16073     IF WS-REMAIN GREATER ZERO
 16074         ADD 1 TO N.
 16075     IF N = 0
 16076         MOVE 1 TO N.
 16077
 16078 6700-EXIT.
 16079      EXIT.
 16080
 16081 6999-CALC-TERM-EXIT.
 16082     EXIT.
 16083
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 300
* EL131.cbl
 16085 7000-RESET-ATTRIBUTE.
 16086
 16087     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 16088                                    CERTSTA   CERTCARA
 16089                                    CERTGRPA.
 16090     MOVE -1                     TO CERTCARL.
 16091
 16092 7000-EXIT.
 16093     EXIT.
 16094
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 301
* EL131.cbl
 16096 7600-BROWSE-CLAIM.
 16097
 16098
 16099* EXEC CICS READ
 16100*        DATASET(CLMS-FILE-ID)
 16101*        SET    (ADDRESS OF CLAIM-MASTER)
 16102*        RIDFLD (MSTR-KEY)
 16103*        GENERIC
 16104*        EQUAL
 16105*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16106*    END-EXEC.
 16107*    MOVE '&"S  KG    E          (   #00013586' TO DFHEIV0
 16108     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16110     MOVE X'2020233030303133353836' TO DFHEIV0(25:11)
 16111     CALL 'kxdfhei1' USING DFHEIV0,
 16112           CLMS-FILE-ID,
 16113           DFHEIV20,
 16114           DFHEIV99,
 16115           MSTR-KEY,
 16116           ELMSTR-GENERIC-LENGTH,
 16117           DFHEIV99,
 16118           DFHEIV99
 16119     SET ADDRESS OF CLAIM-MASTER TO
 16120         DFHEIV20
 16121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16122
 16123
 16124     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 16125
 16126     if cl-assoc-cert-total = 0
 16127        move 1 to cl-assoc-cert-total
 16128     end-if
 16129     IF CL-ASSOC-CERT-SEQU = 0
 16130        MOVE 1 TO CL-ASSOC-CERT-SEQU
 16131     END-IF
 16132
 16133     IF CL-ASSOC-CERT-TOTAL = 1
 16134         MOVE AL-SADOF           TO BCERT1A
 16135                                    BSUFX1A
 16136                                    BCERT2A
 16137                                    BSUFX2A
 16138                                    BCERT3A
 16139                                    BSUFX3A
 16140                                    BCERT4A
 16141                                    BSUFX4A
 16142                                    BCERT5A
 16143                                    BSUFX5A
 16144                                    PCERTNOA
 16145                                    PSUFXA
 16146                                    LABEL1A
 16147                                    LABEL2A
 16148         GO TO 7699-EXIT.
 16149
 16150 7610-BROWSE-CLAIM-LOOP.
 16151
 16152     MOVE LOW-VALUES             TO BCERT1O
 16153                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 302
* EL131.cbl
 16154                                    BCERT2O
 16155                                    BSUFX2O
 16156                                    BCERT3O
 16157                                    BSUFX3O
 16158                                    BCERT4O
 16159                                    BSUFX4O
 16160                                    BCERT5O
 16161                                    BSUFX5O.
 16162
 16163
 16164* EXEC CICS HANDLE CONDITION
 16165*        ENDFILE  (7630-END-BROWSE)
 16166*    END-EXEC.
 16167*    MOVE '"$''                   ! E #00013634' TO DFHEIV0
 16168     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16170     MOVE X'4520233030303133363334' TO DFHEIV0(25:11)
 16171     CALL 'kxdfhei1' USING DFHEIV0
 16172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16173
 16174
 16175
 16176* EXEC CICS STARTBR
 16177*        DATASET    (CLMS-FILE-ID)
 16178*        RIDFLD     (MSTR-KEY)
 16179*    END-EXEC.
 16180     MOVE 0
 16181       TO DFHEIV11
 16182*    MOVE '&,         G          &   #00013638' TO DFHEIV0
 16183     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16184     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16185     MOVE X'2020233030303133363338' TO DFHEIV0(25:11)
 16186     CALL 'kxdfhei1' USING DFHEIV0,
 16187           CLMS-FILE-ID,
 16188           MSTR-KEY,
 16189           DFHEIV99,
 16190           DFHEIV11,
 16191           DFHEIV99
 16192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16193
 16194
 16195     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 16196
 16197 7620-READ-CLAIM-LOOP.
 16198
 16199
 16200* EXEC CICS READNEXT
 16201*        DATASET   (CLMS-FILE-ID)
 16202*        SET       (ADDRESS OF CLAIM-MASTER)
 16203*        RIDFLD    (MSTR-KEY)
 16204*    END-EXEC.
 16205     MOVE 0
 16206       TO DFHEIV11
 16207*    MOVE '&.S                   )   #00013647' TO DFHEIV0
 16208     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16209     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16210     MOVE X'2020233030303133363437' TO DFHEIV0(25:11)
 16211     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 303
* EL131.cbl
 16212           CLMS-FILE-ID,
 16213           DFHEIV20,
 16214           DFHEIV99,
 16215           MSTR-KEY,
 16216           DFHEIV99,
 16217           DFHEIV11,
 16218           DFHEIV99,
 16219           DFHEIV99
 16220     SET ADDRESS OF CLAIM-MASTER TO
 16221         DFHEIV20
 16222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16223
 16224
 16225     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 16226        CL-CARRIER     NOT = CARRI           OR
 16227        CL-CLAIM-NO    NOT = CLAIMI
 16228        GO TO 7630-END-BROWSE.
 16229
 16230     IF WS-ASSOCIATED-CERTS = 1
 16231         MOVE CL-CERT-PRIME      TO BCERT1O
 16232         MOVE CL-CERT-SFX        TO BSUFX1O.
 16233
 16234     IF WS-ASSOCIATED-CERTS = 2
 16235         MOVE CL-CERT-PRIME      TO BCERT2O
 16236         MOVE CL-CERT-SFX        TO BSUFX2O.
 16237
 16238     IF WS-ASSOCIATED-CERTS = 3
 16239         MOVE CL-CERT-PRIME      TO BCERT3O
 16240         MOVE CL-CERT-SFX        TO BSUFX3O.
 16241
 16242     IF WS-ASSOCIATED-CERTS = 4
 16243         MOVE CL-CERT-PRIME      TO BCERT4O
 16244         MOVE CL-CERT-SFX        TO BSUFX4O.
 16245
 16246     IF WS-ASSOCIATED-CERTS = 5
 16247         MOVE CL-CERT-PRIME      TO BCERT5O
 16248         MOVE CL-CERT-SFX        TO BSUFX5O
 16249     ELSE
 16250         ADD +1                  TO WS-ASSOCIATED-CERTS
 16251         GO TO 7620-READ-CLAIM-LOOP.
 16252
 16253 7630-END-BROWSE.
 16254
 16255
 16256* EXEC CICS ENDBR
 16257*        DATASET   (CLMS-FILE-ID)
 16258*    END-EXEC.
 16259     MOVE 0
 16260       TO DFHEIV11
 16261*    MOVE '&2                    $   #00013683' TO DFHEIV0
 16262     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16263     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16264     MOVE X'2020233030303133363833' TO DFHEIV0(25:11)
 16265     CALL 'kxdfhei1' USING DFHEIV0,
 16266           CLMS-FILE-ID,
 16267           DFHEIV11,
 16268           DFHEIV99
 16269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 304
* EL131.cbl
 16270
 16271
 16272 7640-HIGHLIGHT-CERT-DISPLAYED.
 16273
 16274     MOVE AL-SANON               TO BCERT1A
 16275                                    BSUFX1A
 16276                                    BCERT2A
 16277                                    BSUFX2A
 16278                                    BCERT3A
 16279                                    BSUFX3A
 16280                                    BCERT4A
 16281                                    BSUFX4A
 16282                                    BCERT5A
 16283                                    BSUFX5A.
 16284
 16285     IF BCERT1O = CERTI AND
 16286        BSUFX1O = SUFXI
 16287            MOVE AL-SABON        TO BCERT1A
 16288                                    BSUFX1A.
 16289
 16290     IF BCERT2O = CERTI AND
 16291        BSUFX2O = SUFXI
 16292            MOVE AL-SABON        TO BCERT2A
 16293                                    BSUFX2A.
 16294
 16295     IF BCERT3O = CERTI AND
 16296        BSUFX3O = SUFXI
 16297            MOVE AL-SABON        TO BCERT3A
 16298                                    BSUFX3A.
 16299
 16300     IF BCERT4O = CERTI AND
 16301        BSUFX4O = SUFXI
 16302            MOVE AL-SABON        TO BCERT4A
 16303                                    BSUFX4A.
 16304
 16305     IF BCERT5O = CERTI AND
 16306        BSUFX5O = SUFXI
 16307            MOVE AL-SABON        TO BCERT5A
 16308                                    BSUFX5A.
 16309
 16310 7699-EXIT.
 16311     EXIT.
 16312
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 305
* EL131.cbl
 16314 7700-CHECK-SEQUENCE.
 16315
 16316
 16317* EXEC CICS HANDLE CONDITION
 16318*        ENDFILE  (7799-EXIT)
 16319*        NOTFND   (7799-EXIT)
 16320*    END-EXEC.
 16321*    MOVE '"$''I                  ! F #00013731' TO DFHEIV0
 16322     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16323     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16324     MOVE X'4620233030303133373331' TO DFHEIV0(25:11)
 16325     CALL 'kxdfhei1' USING DFHEIV0
 16326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16327
 16328
 16329
 16330* EXEC CICS READ
 16331*        DATASET(CLMS-FILE-ID)
 16332*        SET    (ADDRESS OF CLAIM-MASTER)
 16333*        RIDFLD (MSTR-KEY)
 16334*        GENERIC
 16335*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16336*    END-EXEC.
 16337*    MOVE '&"S  KG    E          (   #00013736' TO DFHEIV0
 16338     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16340     MOVE X'2020233030303133373336' TO DFHEIV0(25:11)
 16341     CALL 'kxdfhei1' USING DFHEIV0,
 16342           CLMS-FILE-ID,
 16343           DFHEIV20,
 16344           DFHEIV99,
 16345           MSTR-KEY,
 16346           ELMSTR-GENERIC-LENGTH,
 16347           DFHEIV99,
 16348           DFHEIV99
 16349     SET ADDRESS OF CLAIM-MASTER TO
 16350         DFHEIV20
 16351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16352
 16353
 16354     COMPUTE WS-ASSOC-CERT-TOTAL =
 16355             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 16356
 16357     GO TO 7799-EXIT.
 16358
 16359 7710-RESEQUENCE-CLAIMS.
 16360
 16361
 16362* EXEC CICS HANDLE CONDITION
 16363*        ENDFILE  (7799-EXIT)
 16364*    END-EXEC.
 16365*    MOVE '"$''                   ! G #00013751' TO DFHEIV0
 16366     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16368     MOVE X'4720233030303133373531' TO DFHEIV0(25:11)
 16369     CALL 'kxdfhei1' USING DFHEIV0
 16370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16371
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 306
* EL131.cbl
 16372
 16373
 16374* EXEC CICS STARTBR
 16375*        DATASET(CLMS-FILE-ID)
 16376*        RIDFLD (MSTR-KEY)
 16377*    END-EXEC.
 16378     MOVE 0
 16379       TO DFHEIV11
 16380*    MOVE '&,         G          &   #00013755' TO DFHEIV0
 16381     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16382     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16383     MOVE X'2020233030303133373535' TO DFHEIV0(25:11)
 16384     CALL 'kxdfhei1' USING DFHEIV0,
 16385           CLMS-FILE-ID,
 16386           MSTR-KEY,
 16387           DFHEIV99,
 16388           DFHEIV11,
 16389           DFHEIV99
 16390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16391
 16392
 16393     COMPUTE WS-ASSOC-CERT-SEQU =
 16394             WS-ASSOC-CERT-SEQU + 1.
 16395
 16396     COMPUTE WS-READNEXT-SWITCH =
 16397             WS-READNEXT-SWITCH + 1.
 16398
 16399 7720-READ-CLAIM-LOOP.
 16400
 16401
 16402* EXEC CICS READNEXT
 16403*        DATASET(CLMS-FILE-ID)
 16404*        SET    (ADDRESS OF CLAIM-MASTER)
 16405*        RIDFLD (MSTR-KEY)
 16406*    END-EXEC.
 16407     MOVE 0
 16408       TO DFHEIV11
 16409*    MOVE '&.S                   )   #00013768' TO DFHEIV0
 16410     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16411     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16412     MOVE X'2020233030303133373638' TO DFHEIV0(25:11)
 16413     CALL 'kxdfhei1' USING DFHEIV0,
 16414           CLMS-FILE-ID,
 16415           DFHEIV20,
 16416           DFHEIV99,
 16417           MSTR-KEY,
 16418           DFHEIV99,
 16419           DFHEIV11,
 16420           DFHEIV99,
 16421           DFHEIV99
 16422     SET ADDRESS OF CLAIM-MASTER TO
 16423         DFHEIV20
 16424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16425
 16426
 16427     IF WS-READNEXT-SWITCH = 1
 16428         ADD 1                   TO WS-READNEXT-SWITCH
 16429         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 307
* EL131.cbl
 16430
 16431 7730-END-BROWSE.
 16432
 16433
 16434* EXEC CICS ENDBR
 16435*        DATASET(CLMS-FILE-ID)
 16436*    END-EXEC.
 16437     MOVE 0
 16438       TO DFHEIV11
 16439*    MOVE '&2                    $   #00013780' TO DFHEIV0
 16440     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16441     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16442     MOVE X'2020233030303133373830' TO DFHEIV0(25:11)
 16443     CALL 'kxdfhei1' USING DFHEIV0,
 16444           CLMS-FILE-ID,
 16445           DFHEIV11,
 16446           DFHEIV99
 16447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16448
 16449
 16450 7740-READ-CLAIM-UPDATE.
 16451
 16452     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 16453        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 16454        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 16455        GO TO 7799-EXIT
 16456     ELSE
 16457        MOVE ZERO                TO WS-READNEXT-SWITCH.
 16458
 16459
 16460* EXEC CICS READ
 16461*        DATASET(CLMS-FILE-ID)
 16462*        SET    (ADDRESS OF CLAIM-MASTER)
 16463*        RIDFLD (MSTR-KEY)
 16464*        UPDATE
 16465*    END-EXEC.
 16466*    MOVE '&"S        EU         (   #00013793' TO DFHEIV0
 16467     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16468     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16469     MOVE X'2020233030303133373933' TO DFHEIV0(25:11)
 16470     CALL 'kxdfhei1' USING DFHEIV0,
 16471           CLMS-FILE-ID,
 16472           DFHEIV20,
 16473           DFHEIV99,
 16474           MSTR-KEY,
 16475           DFHEIV99,
 16476           DFHEIV99,
 16477           DFHEIV99
 16478     SET ADDRESS OF CLAIM-MASTER TO
 16479         DFHEIV20
 16480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16481
 16482
 16483     if (cl-priority-cd = '8')
 16484        and (pi-processor-id not = 'PEMA' and 'JMS '
 16485             AND 'AMWA')
 16486        MOVE ER-8003             TO EMI-ERROR
 16487        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 308
* EL131.cbl
 16488                                 THRU 9900-EXIT
 16489        MOVE -1                  TO MAINTL
 16490        GO TO 8110-SEND-DATA
 16491     end-if
 16492
 16493     IF PI-COMPANY-ID = 'CID' or 'AHL'
 16494         MOVE 'Y'                TO CL-YESNOSW
 16495     END-IF.
 16496
 16497     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16498     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16499
 16500
 16501* EXEC CICS REWRITE
 16502*         DATASET(CLMS-FILE-ID)
 16503*         FROM   (CLAIM-MASTER)
 16504*    END-EXEC.
 16505     MOVE LENGTH OF
 16506      CLAIM-MASTER
 16507       TO DFHEIV11
 16508*    MOVE '&& L                  %   #00013817' TO DFHEIV0
 16509     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16510     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16511     MOVE X'2020233030303133383137' TO DFHEIV0(25:11)
 16512     CALL 'kxdfhei1' USING DFHEIV0,
 16513           CLMS-FILE-ID,
 16514           CLAIM-MASTER,
 16515           DFHEIV11,
 16516           DFHEIV99
 16517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16518
 16519
 16520     GO TO 7710-RESEQUENCE-CLAIMS.
 16521
 16522 7799-EXIT.
 16523     EXIT.
 16524
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 309
* EL131.cbl
 16526 7800-CHECK-AUTO-ACTIVITY.
 16527
 16528
 16529* EXEC CICS HANDLE CONDITION
 16530*        NOTFND   (7800-NOT-FOUND)
 16531*    END-EXEC.
 16532*    MOVE '"$I                   ! H #00013830' TO DFHEIV0
 16533     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16535     MOVE X'4820233030303133383330' TO DFHEIV0(25:11)
 16536     CALL 'kxdfhei1' USING DFHEIV0
 16537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16538
 16539
 16540     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16541     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16542     MOVE SPACES                     TO  CNTL-PROC-ID.
 16543     MOVE +0                         TO  CNTL-SEQ-NO.
 16544
 16545
 16546* EXEC CICS READ
 16547*        DATASET   (CNTL-FILE-ID)
 16548*        RIDFLD    (CNTL-KEY)
 16549*        SET       (ADDRESS OF CONTROL-FILE)
 16550*    END-EXEC.
 16551*    MOVE '&"S        E          (   #00013839' TO DFHEIV0
 16552     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16554     MOVE X'2020233030303133383339' TO DFHEIV0(25:11)
 16555     CALL 'kxdfhei1' USING DFHEIV0,
 16556           CNTL-FILE-ID,
 16557           DFHEIV20,
 16558           DFHEIV99,
 16559           CNTL-KEY,
 16560           DFHEIV99,
 16561           DFHEIV99,
 16562           DFHEIV99
 16563     SET ADDRESS OF CONTROL-FILE TO
 16564         DFHEIV20
 16565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16566
 16567
 16568     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16569         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16570
 16571     IF CL-ACTIVITY-CODE NOT = ZEROS
 16572         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16573         IF MISC-SUB IS GREATER THAN +9
 16574             SUBTRACT +9 FROM MISC-SUB
 16575             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16576         ELSE
 16577             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16578     ELSE
 16579         MOVE 'Y'                              TO  WS-RESET-SW.
 16580
 16581     IF STATUSI = 'C' OR 'CLOSED'
 16582         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16583             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 310
* EL131.cbl
 16584                                         PI-LETTER-SW
 16585             GO TO 7800-EXIT.
 16586
 16587     IF STATUSI = 'C' OR 'CLOSED'
 16588         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16589             MOVE 'N'                TO  PI-LETTER-SW
 16590         ELSE
 16591             MOVE 'Y'                TO  PI-LETTER-SW.
 16592
 16593     IF STATUSI = 'O' OR 'OPEN'
 16594         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16595             MOVE 'N'                TO  PI-REC-FOUND-SW
 16596                                         PI-LETTER-SW
 16597             GO TO 7800-EXIT.
 16598
 16599     IF STATUSI = 'O' OR 'OPEN'
 16600         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16601             MOVE 'N'                TO  PI-LETTER-SW
 16602         ELSE
 16603             MOVE 'Y'                TO  PI-LETTER-SW.
 16604
 16605     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16606     GO TO 7800-EXIT.
 16607
 16608 7800-NOT-FOUND.
 16609
 16610     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16611                                         PI-LETTER-SW.
 16612
 16613 7800-EXIT.
 16614     EXIT.
 16615
 16616 7850-AUTO-LETTER-WRITER.
 16617
 16618     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16619     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16620
 16621     IF STATUSI = 'C' OR 'CLOSED'
 16622         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16623     ELSE
 16624         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16625
 16626     IF STATUSI = 'C' OR 'CLOSED'
 16627         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16628             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16629             MOVE '6'                TO  DC-OPTION-CODE
 16630             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16631             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16632             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16633             IF NO-CONVERSION-ERROR
 16634                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16635             ELSE
 16636                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16637
 16638     IF STATUSI = 'C' OR 'CLOSED'
 16639         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16640             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16641             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 311
* EL131.cbl
 16642             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16643             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16644             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16645             IF NO-CONVERSION-ERROR
 16646                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16647             ELSE
 16648                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16649
 16650     IF STATUSI = 'O' OR 'OPEN'
 16651         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16652             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16653             MOVE '6'                TO  DC-OPTION-CODE
 16654             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16655             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16656             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16657             IF NO-CONVERSION-ERROR
 16658                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16659             ELSE
 16660                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16661
 16662     IF STATUSI = 'O' OR 'OPEN'
 16663         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16664             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16665             MOVE '6'                TO  DC-OPTION-CODE
 16666             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16667             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16668             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16669             IF NO-CONVERSION-ERROR
 16670                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16671             ELSE
 16672                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16673
 16674
 16675* EXEC CICS LINK
 16676*        PROGRAM    (LINK-1523)
 16677*        COMMAREA   (W-1523-LINKDATA)
 16678*        LENGTH     (W-1523-COMM-LENGTH)
 16679*    END-EXEC.
 16680*    MOVE '."C                   (   #00013951' TO DFHEIV0
 16681     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16683     MOVE X'2020233030303133393531' TO DFHEIV0(25:11)
 16684     CALL 'kxdfhei1' USING DFHEIV0,
 16685           LINK-1523,
 16686           W-1523-LINKDATA,
 16687           W-1523-COMM-LENGTH,
 16688           DFHEIV99,
 16689           DFHEIV99,
 16690           DFHEIV99,
 16691           DFHEIV99
 16692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16693
 16694
 16695     IF W-1523-ERROR-CODE = ZEROS
 16696         GO TO 7850-EXIT.
 16697
 16698     IF W-1523-FATAL-ERROR
 16699         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 312
* EL131.cbl
 16700         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16701
 16702     IF W-1523-ERROR-CODE = 0191
 16703         MOVE ER-0803                TO  EMI-ERROR
 16704         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16705
 16706 7850-EXIT.
 16707     EXIT.
 16708
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 313
* EL131.cbl
 16710 8000-CREATE-DMO-REC.
 16711     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16712     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16713     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16714
 16715
 16716* EXEC CICS HANDLE CONDITION
 16717*         NOTFND   (8000-NOTE-NOT-FOUND)
 16718*    END-EXEC.
 16719*    MOVE '"$I                   ! I #00013977' TO DFHEIV0
 16720     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16722     MOVE X'4920233030303133393737' TO DFHEIV0(25:11)
 16723     CALL 'kxdfhei1' USING DFHEIV0
 16724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16725
 16726
 16727
 16728* EXEC CICS READ
 16729*         DATASET(NOTE-FILE-ID)
 16730*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16731*         RIDFLD (NOTE-KEY)
 16732*    END-EXEC.
 16733*    MOVE '&"S        E          (   #00013981' TO DFHEIV0
 16734     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16736     MOVE X'2020233030303133393831' TO DFHEIV0(25:11)
 16737     CALL 'kxdfhei1' USING DFHEIV0,
 16738           NOTE-FILE-ID,
 16739           DFHEIV20,
 16740           DFHEIV99,
 16741           NOTE-KEY,
 16742           DFHEIV99,
 16743           DFHEIV99,
 16744           DFHEIV99
 16745     SET ADDRESS OF CERTIFICATE-NOTE TO
 16746         DFHEIV20
 16747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16748
 16749
 16750     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16751     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16752     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16753
 16754     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16755         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16756     ELSE
 16757         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16758
 16759     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16760     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16761
 16762
 16763* EXEC CICS LINK
 16764*        PROGRAM    ('DLO006')
 16765*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16766*        LENGTH     (WS-DCT-LENGTH)
 16767*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 314
* EL131.cbl
 16768     MOVE 'DLO006' TO DFHEIV1
 16769*    MOVE '."C                   (   #00013999' TO DFHEIV0
 16770     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16772     MOVE X'2020233030303133393939' TO DFHEIV0(25:11)
 16773     CALL 'kxdfhei1' USING DFHEIV0,
 16774           DFHEIV1,
 16775           DCT-COMMUNICATION-AREA,
 16776           WS-DCT-LENGTH,
 16777           DFHEIV99,
 16778           DFHEIV99,
 16779           DFHEIV99,
 16780           DFHEIV99
 16781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16782
 16783
 16784     IF  DCT-RETURN-CODE = 'OK'
 16785         GO TO 8000-CONT.
 16786
 16787     IF DCT-RETURN-CODE = '01' OR '02'
 16788         GO TO 8000-EXIT.
 16789
 16790     IF DCT-RETURN-CODE = '03'
 16791         MOVE ER-0951            TO EMI-ERROR
 16792         MOVE -1                 TO MAINTL
 16793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16794         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16795         GO TO 8110-SEND-DATA.
 16796
 16797     IF DCT-RETURN-CODE = '04'
 16798         MOVE ER-0946            TO EMI-ERROR
 16799         MOVE -1                 TO MAINTL
 16800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16801         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16802         GO TO 8110-SEND-DATA.
 16803
 16804     IF DCT-RETURN-CODE = '05'
 16805         MOVE ER-0947            TO EMI-ERROR
 16806         MOVE -1                 TO MAINTL
 16807         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16808         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16809         GO TO 8110-SEND-DATA.
 16810
 16811     IF DCT-RETURN-CODE = '06'
 16812         MOVE ER-0921            TO EMI-ERROR
 16813         MOVE -1                 TO MAINTL
 16814         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16815         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16816         GO TO 8110-SEND-DATA.
 16817
 16818     IF DCT-RETURN-CODE = '07'
 16819         MOVE ER-0919            TO EMI-ERROR
 16820         MOVE -1                 TO MAINTL
 16821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16822         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16823         GO TO 8110-SEND-DATA.
 16824
 16825     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 315
* EL131.cbl
 16826         MOVE ER-0948            TO EMI-ERROR
 16827         MOVE -1                 TO MAINTL
 16828         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16829         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16830         GO TO 8110-SEND-DATA.
 16831
 16832     IF DCT-RETURN-CODE = 'N1'
 16833         MOVE ER-0950            TO EMI-ERROR
 16834         MOVE -1                 TO MAINTL
 16835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16836         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16837         GO TO 8110-SEND-DATA.
 16838
 16839     IF DCT-RETURN-CODE = 'E1'
 16840         MOVE ER-0974            TO EMI-ERROR
 16841         MOVE -1                 TO MAINTL
 16842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16843         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16844         GO TO 8110-SEND-DATA.
 16845
 16846     IF DCT-RETURN-CODE = 'E2'
 16847         MOVE ER-0975            TO EMI-ERROR
 16848         MOVE -1                 TO MAINTL
 16849         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16850         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16851         GO TO 8110-SEND-DATA.
 16852
 16853     IF DCT-RETURN-CODE NOT = 'OK'
 16854         MOVE ER-0949            TO EMI-ERROR
 16855         MOVE -1                 TO MAINTL
 16856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16857         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16858         GO TO 8110-SEND-DATA.
 16859
 16860 8000-CONT.
 16861
 16862     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16863     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16864     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16865     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16866     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16867     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16868     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16869     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16870
 16871     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16872     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16873     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16874     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16875     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16876
 16877     IF STATUSI = 'OPEN' OR 'O'
 16878         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16879      ELSE
 16880         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16881
 16882     IF STATUSI = 'OPEN' OR 'O'
 16883        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 316
* EL131.cbl
 16884         MOVE '1'                TO DM-CLAIM-STATUS
 16885      ELSE
 16886         MOVE '2'                TO DM-CLAIM-STATUS.
 16887
 16888     IF STATUSI = 'CLOSED' OR 'C'
 16889        IF NOT FINAL-PAID
 16890         MOVE '3'                TO DM-CLAIM-STATUS
 16891      ELSE
 16892         MOVE '4'                TO DM-CLAIM-STATUS.
 16893
 16894     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16895
 16896
 16897* EXEC CICS LINK
 16898*        PROGRAM    ('DLO025')
 16899*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16900*        LENGTH     (WS-DMO-LENGTH)
 16901*    END-EXEC.
 16902     MOVE 'DLO025' TO DFHEIV1
 16903*    MOVE '."C                   (   #00014117' TO DFHEIV0
 16904     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16906     MOVE X'2020233030303134313137' TO DFHEIV0(25:11)
 16907     CALL 'kxdfhei1' USING DFHEIV0,
 16908           DFHEIV1,
 16909           DMO-COMMUNICATION-AREA,
 16910           WS-DMO-LENGTH,
 16911           DFHEIV99,
 16912           DFHEIV99,
 16913           DFHEIV99,
 16914           DFHEIV99
 16915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16916
 16917
 16918     IF  DM-RETURN-CODE = 'OK'
 16919         GO TO 8000-EXIT.
 16920
 16921     IF DM-RETURN-CODE = '01'
 16922         MOVE ER-8051            TO EMI-ERROR
 16923         MOVE -1                 TO MAINTL
 16924         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16925         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16926         GO TO 8110-SEND-DATA.
 16927
 16928     IF DM-RETURN-CODE = '02'
 16929         MOVE ER-8052            TO EMI-ERROR
 16930         MOVE -1                 TO MAINTL
 16931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16932         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16933         GO TO 8110-SEND-DATA.
 16934
 16935     IF DM-RETURN-CODE = '03'
 16936         MOVE ER-8053            TO EMI-ERROR
 16937         MOVE -1                 TO MAINTL
 16938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16939         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16940         GO TO 8110-SEND-DATA.
 16941
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 317
* EL131.cbl
 16942     IF DM-RETURN-CODE = '04'
 16943         MOVE ER-8054            TO EMI-ERROR
 16944         MOVE -1                 TO MAINTL
 16945         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16946         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16947         GO TO 8110-SEND-DATA.
 16948
 16949     IF DM-RETURN-CODE = '05'
 16950         MOVE ER-8055            TO EMI-ERROR
 16951         MOVE -1                 TO MAINTL
 16952         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16953         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16954         GO TO 8110-SEND-DATA.
 16955
 16956     IF DM-RETURN-CODE = '06'
 16957         MOVE ER-8056            TO EMI-ERROR
 16958         MOVE -1                 TO MAINTL
 16959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16960         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16961         GO TO 8110-SEND-DATA.
 16962
 16963     IF DM-RETURN-CODE = '07'
 16964         MOVE ER-8057            TO EMI-ERROR
 16965         MOVE -1                 TO MAINTL
 16966         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16967         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16968         GO TO 8110-SEND-DATA.
 16969
 16970     IF DM-RETURN-CODE = '08'
 16971         MOVE ER-8058            TO EMI-ERROR
 16972         MOVE -1                 TO MAINTL
 16973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16974         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16975         GO TO 8110-SEND-DATA.
 16976
 16977     IF DM-RETURN-CODE = '09'
 16978         MOVE ER-8059            TO EMI-ERROR
 16979         MOVE -1                 TO MAINTL
 16980         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16981         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16982         GO TO 8110-SEND-DATA.
 16983
 16984     IF DM-RETURN-CODE = '10'
 16985         MOVE ER-8060            TO EMI-ERROR
 16986         MOVE -1                 TO MAINTL
 16987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16988         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16989         GO TO 8110-SEND-DATA.
 16990
 16991     IF DM-RETURN-CODE = '11'
 16992         MOVE ER-8061            TO EMI-ERROR
 16993         MOVE -1                 TO MAINTL
 16994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16995         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16996         GO TO 8110-SEND-DATA.
 16997
 16998     IF DM-RETURN-CODE = '12'
 16999         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 318
* EL131.cbl
 17000         MOVE -1                 TO MAINTL
 17001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17002         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17003         GO TO 8110-SEND-DATA.
 17004
 17005     IF DM-RETURN-CODE = '13'
 17006         MOVE ER-8063            TO EMI-ERROR
 17007         MOVE -1                 TO MAINTL
 17008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17009         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17010         GO TO 8110-SEND-DATA.
 17011
 17012     IF DM-RETURN-CODE = '14'
 17013         MOVE ER-8064            TO EMI-ERROR
 17014         MOVE -1                 TO MAINTL
 17015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17016         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17017         GO TO 8110-SEND-DATA.
 17018
 17019     IF DM-RETURN-CODE = '15'
 17020         MOVE ER-8065            TO EMI-ERROR
 17021         MOVE -1                 TO MAINTL
 17022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17023         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17024         GO TO 8110-SEND-DATA.
 17025
 17026     IF DM-RETURN-CODE = '16'
 17027         MOVE ER-8154            TO EMI-ERROR
 17028         MOVE -1                 TO MAINTL
 17029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17030         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17031         GO TO 8110-SEND-DATA.
 17032
 17033     IF DM-RETURN-CODE = '17'
 17034         MOVE ER-8155            TO EMI-ERROR
 17035         MOVE -1                 TO MAINTL
 17036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17037         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17038         GO TO 8110-SEND-DATA.
 17039
 17040     IF DM-RETURN-CODE = 'N1'
 17041         MOVE ER-8152            TO EMI-ERROR
 17042         MOVE -1                 TO MAINTL
 17043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17044         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17045         GO TO 8110-SEND-DATA.
 17046
 17047     IF DM-RETURN-CODE = 'E1'
 17048         MOVE ER-8153            TO EMI-ERROR
 17049         MOVE -1                 TO MAINTL
 17050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17051         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17052         GO TO 8110-SEND-DATA.
 17053
 17054     MOVE ER-8066                TO EMI-ERROR.
 17055     MOVE -1                     TO MAINTL.
 17056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17057     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 319
* EL131.cbl
 17058     GO TO 8110-SEND-DATA.
 17059
 17060 8000-NOTE-NOT-FOUND.
 17061
 17062* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17063*    MOVE '6"R                   !   #00014266' TO DFHEIV0
 17064     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17065     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17066     MOVE X'2020233030303134323636' TO DFHEIV0(25:11)
 17067     CALL 'kxdfhei1' USING DFHEIV0
 17068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17069
 17070     MOVE ER-0954                TO EMI-ERROR.
 17071     MOVE -1                     TO MAINTL.
 17072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17073     GO TO 8110-SEND-DATA.
 17074
 17075 8000-EXIT.
 17076     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 320
* EL131.cbl
 17078 8050-FORMAT-LAST-NAME-1ST.
 17079*****************************************************************
 17080*             M O V E   N A M E   R O U T I N E                 *
 17081*                                                               *
 17082*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 17083*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 17084*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 17085*                                                               *
 17086*                  FIELD               VALUE                    *
 17087*                  -----               -----                    *
 17088*           W-NAME-LAST    (CL15)      SMITH                    *
 17089*           W-NAME-FIRST   (CL15)      JOHN                     *
 17090*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 17091*                                                               *
 17092*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 17093*                SMITH, JOHN ALLEN                              *
 17094*                     OR                                        *
 17095*                SMITH, JOHN A.                                 *
 17096*                                                               *
 17097*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 17098*     COPYBOOK, ELCNWA.                                         *
 17099*****************************************************************.
 17100
 17101     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 17102     MOVE ZERO                   TO WS-NAME-SW.
 17103     SET NWA-INDEX               TO +1.
 17104
 17105     IF W-NAME-LAST   = SPACES  AND
 17106        W-NAME-MIDDLE = SPACES
 17107          MOVE +1                TO WS-NAME-SW.
 17108
 17109     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 17110     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17111
 17112     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 17113     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17114
 17115     SET NWA-INDEX UP BY +1.
 17116
 17117     IF W-NAME-MIDDLE NOT = SPACES
 17118         IF W-NAME-MIDDLE-2 = SPACES
 17119             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 17120             SET NWA-INDEX UP BY +1
 17121             MOVE '.'            TO WS-NW (NWA-INDEX)
 17122             SET NWA-INDEX UP BY +2
 17123         ELSE
 17124             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 17125             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17126
 17127 8050-EXIT.
 17128     EXIT.
 17129
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 321
* EL131.cbl
 17131 8060-MOVE-NAME.
 17132     IF WS-NAME-SW GREATER THAN +1
 17133         GO TO 8060-EXIT.
 17134
 17135     IF WS-NAME-WORK2 = SPACES
 17136         GO TO 8060-EXIT.
 17137
 17138     SET NWA-INDEX2            TO +1.
 17139     SET NWA-INDEX3            TO +2.
 17140
 17141 8060-MOVE-NAME-CYCLE.
 17142     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 17143
 17144     IF NWA-INDEX LESS THAN +30
 17145         SET NWA-INDEX UP BY +1
 17146     ELSE
 17147         ADD +2 TO  WS-NAME-SW
 17148         GO TO 8060-EXIT.
 17149
 17150     IF NWA-INDEX2 LESS THAN +20
 17151         SET NWA-INDEX3 UP BY +1
 17152         SET NWA-INDEX2 UP BY +1.
 17153
 17154     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 17155        WS-NW2 (NWA-INDEX3) = SPACES
 17156         IF WS-NAME-SW = ZERO
 17157             MOVE ','            TO WS-NW (NWA-INDEX)
 17158             SET NWA-INDEX UP BY +2
 17159             MOVE +1             TO WS-NAME-SW
 17160             GO TO 8060-EXIT
 17161         ELSE
 17162             GO TO 8060-EXIT.
 17163
 17164     GO TO 8060-MOVE-NAME-CYCLE.
 17165
 17166 8060-EXIT.
 17167     EXIT.
 17168
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 322
* EL131.cbl
 17170
 17171 8070-UNLOCK-CLAIM-MSTR.
 17172
 17173* EXEC CICS UNLOCK
 17174*        DATASET   (CLMS-FILE-ID)
 17175*    END-EXEC.
 17176*    MOVE '&*                    #   #00014369' TO DFHEIV0
 17177     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 17178     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17179     MOVE X'2020233030303134333639' TO DFHEIV0(25:11)
 17180     CALL 'kxdfhei1' USING DFHEIV0,
 17181           CLMS-FILE-ID,
 17182           DFHEIV99
 17183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17184
 17185
 17186 8070-EXIT.
 17187      EXIT.
 17188
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 323
* EL131.cbl
 17190 8100-SEND-MAP.
 17191     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 17192
 17193     move al-uanon               to accswa
 17194     IF NOT PI-NO-CARRIER-SECURITY
 17195        MOVE AL-SANOF            TO CERTCARA.
 17196     IF NOT PI-NO-ACCOUNT-SECURITY
 17197        MOVE AL-SANOF            TO CERTACTA.
 17198
 17199     IF PI-PROCESSOR-ID = 'LGXX'
 17200        MOVE AL-UANON            TO CCNOA.
 17201
 17202     IF PI-COMPANY-ID = 'DMD'
 17203        NEXT SENTENCE
 17204     ELSE
 17205        MOVE AL-SADOF            TO PFKEY6A.
 17206     IF NOT (PI-COMPANY-ID = 'DCC' OR 'VPP')
 17207        MOVE AL-SANOF TO EXTENSA
 17208     END-IF
 17209
 17210     IF PI-USES-PAID-TO
 17211        MOVE 'PAID TO  :' TO PTHRHDGO.
 17212
 17213
 17214* EXEC CICS SEND
 17215*         MAP     ('EL131A')
 17216*         MAPSET  ('EL131S')
 17217*         ERASE
 17218*         FREEKB
 17219*         CURSOR
 17220*    END-EXEC.
 17221     MOVE 'EL131A' TO DFHEIV1
 17222     MOVE -1
 17223       TO DFHEIV11
 17224     MOVE 'EL131S' TO DFHEIV2
 17225*    MOVE '8$     CT  E F  H     ,   #00014400' TO DFHEIV0
 17226     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17227     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17228     MOVE X'2020233030303134343030' TO DFHEIV0(25:11)
 17229     CALL 'kxdfhei1' USING DFHEIV0,
 17230           DFHEIV1,
 17231           EL131AO,
 17232           DFHEIV99,
 17233           DFHEIV2,
 17234           DFHEIV99,
 17235           DFHEIV99,
 17236           DFHEIV99,
 17237           DFHEIV11,
 17238           DFHEIV99,
 17239           DFHEIV99,
 17240           DFHEIV99
 17241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17242
 17243
 17244     GO TO 9000-RETURN-TRANS.
 17245
 17246 8110-SEND-DATA.
 17247     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 324
* EL131.cbl
 17248
 17249     IF PI-USES-PAID-TO
 17250        MOVE 'PAID TO  :' TO PTHRHDGO.
 17251
 17252     IF PI-PROCESSOR-ID = 'LGXX'
 17253        MOVE AL-UANON            TO CCNOA.
 17254
 17255     IF PI-COMPANY-ID = 'DMD'
 17256        NEXT SENTENCE
 17257     ELSE
 17258        MOVE AL-SADOF            TO PFKEY6A.
 17259
 17260
 17261* EXEC CICS SEND
 17262*         MAP      ('EL131A')
 17263*         MAPSET   ('EL131S')
 17264*         DATAONLY
 17265*         FREEKB
 17266*         CURSOR
 17267*    END-EXEC.
 17268     MOVE 'EL131A' TO DFHEIV1
 17269     MOVE -1
 17270       TO DFHEIV11
 17271     MOVE 'EL131S' TO DFHEIV2
 17272*    MOVE '8$D    CT    F  H     ,   #00014424' TO DFHEIV0
 17273     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17274     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17275     MOVE X'2020233030303134343234' TO DFHEIV0(25:11)
 17276     CALL 'kxdfhei1' USING DFHEIV0,
 17277           DFHEIV1,
 17278           EL131AO,
 17279           DFHEIV99,
 17280           DFHEIV2,
 17281           DFHEIV99,
 17282           DFHEIV99,
 17283           DFHEIV99,
 17284           DFHEIV11,
 17285           DFHEIV99,
 17286           DFHEIV99,
 17287           DFHEIV99
 17288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17289
 17290
 17291     GO TO 9000-RETURN-TRANS.
 17292
 17293 8120-FORMAT-TIME-DATE.
 17294     perform 8140-check-for-prev-errors
 17295                                 thru 8140-exit
 17296     IF SKIP-ATTRIBUTE = 'Y'
 17297        MOVE SPACES              TO SKIP-ATTRIBUTE
 17298        MOVE ER-0598             TO EMI-ERROR
 17299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17300        GO TO 8125-SKIP-ATTRIBUTE.
 17301
 17302*     IF PI-COMPANY-ID = 'DMD'
 17303      IF PI-PROCESSOR-ID <> 'EMER'
 17304         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 17305                                    CERTCARA  CERTGRPA CERTA SUFXA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 325
* EL131.cbl
 17306
 17307     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 17308                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 17309                                    JNTINITA  JNTAGEA   APRA
 17310                                    LCVCDA    LCVOTRMA  LCVRTRMA
 17311                                    LCVBENEA  LCVFORMA  LCVCNDTA
 17312                                    LCVEXITA  LCVSTATA  LCVKINDA
 17313                                    ACVCDA    ACVOTRMA  ACVRTRMA
 17314                                    ACVBENEA  ACVFORMA  ACVCNDTA
 17315                                    ACVEXITA  ACVSTATA  ACVKINDA
 17316                                    PMTFREQA  INDGRPA   PREMTYPA
 17317                                    REINCDA   LCVRATEA  ACVRATEA
 17318                                    ADDONDTA.
 17319
 17320*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 17321*       IF PI-COMPANY-ID = 'DMD'
 17322*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 17323*                                   SUFXA
 17324*                                   PDAMTA    NODAYSA   NOPMTSA
 17325*                                   INCA      OCCA
 17326*          IF NOT SYSTEM-MODIFY-CAP
 17327*              MOVE AL-SANOF         TO PDTHRUA.
 17328
 17329     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 17330         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 17331
 17332 8125-SKIP-ATTRIBUTE.
 17333
 17334     MOVE SAVE-DATE              TO DATEO.
 17335
 17336* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 17337*    END-EXEC
 17338*    MOVE '0"A                   "   #00014476' TO DFHEIV0
 17339     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 17340     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 17341     MOVE X'2020233030303134343736' TO DFHEIV0(25:11)
 17342     CALL 'kxdfhei1' USING DFHEIV0,
 17343           LCP-CICS-TIME
 17344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17345
 17346* EXEC CICS FORMATTIME
 17347*              ABSTIME(LCP-CICS-TIME)
 17348*              TIME(LCP-TIME-OF-DAY-XX)
 17349*    END-EXEC
 17350*    MOVE 'j$(     (             #   #00014478' TO DFHEIV0
 17351     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 17352     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17353     MOVE X'2020233030303134343738' TO DFHEIV0(25:11)
 17354     CALL 'kxdfhei1' USING DFHEIV0,
 17355           LCP-CICS-TIME,
 17356           LCP-TIME-OF-DAY-XX
 17357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17358     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 17359     MOVE UN-HOURS               TO FOR-HOURS.
 17360     MOVE UN-MINUTES             TO FOR-MINUTES.
 17361     MOVE TIME-OUT               TO TIMEO.
 17362     MOVE PI-COMPANY-ID          TO COMPO.
 17363     MOVE PI-PROCESSOR-ID        TO USERIDO.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 326
* EL131.cbl
 17364     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 17365     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17366     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 17367     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 17368
 17369 8130-EXIT.
 17370     EXIT.
 17371
 17372 8140-check-for-prev-errors.
 17373
 17374     MOVE PI-COMPANY-CD          TO trlr-company-cd
 17375     MOVE PI-CARRIER             TO trlr-carrier
 17376     MOVE PI-CLAIM-NO            TO trlr-claim-no
 17377     MOVE PI-CERT-NO             TO trlr-cert-no
 17378     MOVE +95                    TO TRLR-SEQ-NO
 17379
 17380
 17381* EXEC CICS READ
 17382*       DATASET  ('ELTRLR')
 17383*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17384*       RIDFLD   (TRLR-KEY)
 17385*       RESP     (WS-RESPONSE)
 17386*    END-EXEC
 17387     MOVE 'ELTRLR' TO DFHEIV1
 17388*    MOVE '&"S        E          (  N#00014504' TO DFHEIV0
 17389     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17390     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17391     MOVE X'204E233030303134353034' TO DFHEIV0(25:11)
 17392     CALL 'kxdfhei1' USING DFHEIV0,
 17393           DFHEIV1,
 17394           DFHEIV20,
 17395           DFHEIV99,
 17396           TRLR-KEY,
 17397           DFHEIV99,
 17398           DFHEIV99,
 17399           DFHEIV99
 17400     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17401         DFHEIV20
 17402     MOVE EIBRESP  TO WS-RESPONSE
 17403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17404
 17405     if ws-resp-normal
 17406        perform varying s1 from +1 by +1 until
 17407           at-note-error-no (s1) = spaces
 17408           if at-note-error-no (s1) = '1652'
 17409              continue
 17410           else
 17411              move at-note-error-no (s1)
 17412                                 to emi-error
 17413              move -1 to maintl
 17414              if at-note-error-no (s1) = '1653'
 17415                 evaluate true
 17416                    when pi-claim-type = 'L'
 17417                       move '  LF  '
 17418                        to emi-claim-type
 17419                    when pi-claim-type = 'I'
 17420                       move '  IU  '
 17421                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 327
* EL131.cbl
 17422                    WHEN PI-CLAIM-TYPE = 'F'
 17423                       MOVE '  FL  '
 17424                        TO EMI-CLAIM-TYPE
 17425                    WHEN PI-CLAIM-TYPE = 'O'
 17426                       MOVE '  OT  '
 17427                        TO EMI-CLAIM-TYPE
 17428                    when other
 17429                       move '  AH  '
 17430                        to emi-claim-type
 17431                 end-evaluate
 17432              end-if
 17433              PERFORM 9900-ERROR-FORMAT
 17434                                 THRU 9900-EXIT
 17435           end-if
 17436*          if at-note-error-no (s1) = '1653'
 17437*             perform varying emi-sub from 1 by 1 until
 17438*                emi-sub > 3
 17439*                if emi-error-number (emi-sub) = '1653'
 17440*                   evaluate true
 17441*                      when pi-claim-type = 'L'
 17442*                         move '  LF  '
 17443*                          to emi-claim-type
 17444*                      when pi-claim-type = 'I'
 17445*                         move '  IU  '
 17446*                          to emi-claim-type
 17447*                      when other
 17448*                         move '  AH  '
 17449*                          to emi-claim-type
 17450*                   end-evaluate
 17451*                end-if
 17452*             end-perform
 17453*          end-if
 17454        end-perform
 17455     else
 17456        display ' resp not normal ' ws-response ' '
 17457        trlr-key (2:19)
 17458     end-if
 17459
 17460     .
 17461 8140-exit.
 17462     exit.
 17463 8150-ENTERED-CLAIM-NOTFOUND.
 17464
 17465     MOVE ER-0204                TO EMI-ERROR.
 17466     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17467     MOVE -1                     TO MAINTL.
 17468     GO TO 8100-SEND-MAP.
 17469
 17470 8200-RETURN-PRIOR.
 17471     MOVE SPACE                  TO PI-RETURN-CD-1.
 17472     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 17473     GO TO 9200-XCTL.
 17474
 17475 8300-GET-HELP.
 17476     MOVE XCTL-EL010             TO CALL-PGM.
 17477     GO TO 9200-XCTL.
 17478
 17479 8400-RETURN-MASTER.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 328
* EL131.cbl
 17480     MOVE SPACE                  TO PI-RETURN-CD-1.
 17481     MOVE XCTL-EL126             TO CALL-PGM.
 17482     GO TO 9200-XCTL.
 17483
 17484 8500-TRLR-MNT.
 17485     IF PI-RETURN-CD-1 = 'X'
 17486         MOVE ER-0311            TO EMI-ERROR
 17487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17488         MOVE -1                 TO MAINTL
 17489         GO TO 8110-SEND-DATA.
 17490
 17491
 17492* EXEC CICS WRITEQ TS
 17493*         QUEUE     (PI-KEY)
 17494*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17495*         LENGTH    (PI-COMM-LENGTH)
 17496*    END-EXEC.
 17497*    MOVE '*"     L              ''   #00014597' TO DFHEIV0
 17498     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17499     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17500     MOVE X'2020233030303134353937' TO DFHEIV0(25:11)
 17501     CALL 'kxdfhei1' USING DFHEIV0,
 17502           PI-KEY,
 17503           PROGRAM-INTERFACE-BLOCK,
 17504           PI-COMM-LENGTH,
 17505           DFHEIV99,
 17506           DFHEIV99,
 17507           DFHEIV99
 17508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17509
 17510
 17511     MOVE XCTL-EL142             TO CALL-PGM.
 17512     GO TO 9200-XCTL.
 17513
 17514 8600-ADDR-MNT.
 17515     IF PI-RETURN-CD-1 = 'X'
 17516         MOVE ER-0311            TO EMI-ERROR
 17517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17518         MOVE -1                 TO MAINTL
 17519         GO TO 8110-SEND-DATA.
 17520
 17521
 17522* EXEC CICS WRITEQ TS
 17523*         QUEUE     (PI-KEY)
 17524*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17525*         LENGTH    (PI-COMM-LENGTH)
 17526*    END-EXEC.
 17527*    MOVE '*"     L              ''   #00014613' TO DFHEIV0
 17528     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17529     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17530     MOVE X'2020233030303134363133' TO DFHEIV0(25:11)
 17531     CALL 'kxdfhei1' USING DFHEIV0,
 17532           PI-KEY,
 17533           PROGRAM-INTERFACE-BLOCK,
 17534           PI-COMM-LENGTH,
 17535           DFHEIV99,
 17536           DFHEIV99,
 17537           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 329
* EL131.cbl
 17538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17539
 17540
 17541     MOVE XCTL-EL141             TO CALL-PGM.
 17542     GO TO 9200-XCTL.
 17543
 17544 8700-CERT-MNT.
 17545     IF PI-RETURN-CD-1 = 'X'
 17546         MOVE ER-7690            TO EMI-ERROR
 17547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17548         MOVE -1                 TO MAINTL
 17549         GO TO 8110-SEND-DATA.
 17550
 17551
 17552* EXEC CICS WRITEQ TS
 17553*         QUEUE     (PI-KEY)
 17554*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17555*         LENGTH    (PI-COMM-LENGTH)
 17556*    END-EXEC.
 17557*    MOVE '*"     L              ''   #00014629' TO DFHEIV0
 17558     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17559     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17560     MOVE X'2020233030303134363239' TO DFHEIV0(25:11)
 17561     CALL 'kxdfhei1' USING DFHEIV0,
 17562           PI-KEY,
 17563           PROGRAM-INTERFACE-BLOCK,
 17564           PI-COMM-LENGTH,
 17565           DFHEIV99,
 17566           DFHEIV99,
 17567           DFHEIV99
 17568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17569
 17570
 17571     MOVE XCTL-EL1273            TO CALL-PGM.
 17572     GO TO 9200-XCTL.
 17573
 17574 8725-BENEFICIARY-MNT.
 17575     IF PI-RETURN-CD-1 = 'X'
 17576         MOVE ER-0311            TO EMI-ERROR
 17577         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17578         MOVE -1                 TO MAINTL
 17579         GO TO 8110-SEND-DATA.
 17580
 17581
 17582* EXEC CICS WRITEQ TS
 17583*         QUEUE     (PI-KEY)
 17584*         FROM      (EL131AI)
 17585*         LENGTH    (MAP-LENGTH)
 17586*    END-EXEC.
 17587*    MOVE '*"     L              ''   #00014645' TO DFHEIV0
 17588     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17589     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17590     MOVE X'2020233030303134363435' TO DFHEIV0(25:11)
 17591     CALL 'kxdfhei1' USING DFHEIV0,
 17592           PI-KEY,
 17593           EL131AI,
 17594           MAP-LENGTH,
 17595           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 330
* EL131.cbl
 17596           DFHEIV99,
 17597           DFHEIV99
 17598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17599
 17600
 17601
 17602* EXEC CICS WRITEQ TS
 17603*         QUEUE     (PI-KEY)
 17604*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17605*         LENGTH    (PI-COMM-LENGTH)
 17606*    END-EXEC.
 17607*    MOVE '*"     L              ''   #00014651' TO DFHEIV0
 17608     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17609     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17610     MOVE X'2020233030303134363531' TO DFHEIV0(25:11)
 17611     CALL 'kxdfhei1' USING DFHEIV0,
 17612           PI-KEY,
 17613           PROGRAM-INTERFACE-BLOCK,
 17614           PI-COMM-LENGTH,
 17615           DFHEIV99,
 17616           DFHEIV99,
 17617           DFHEIV99
 17618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17619
 17620
 17621     MOVE XCTL-EL114             TO CALL-PGM.
 17622     GO TO 9200-XCTL.
 17623
 17624 8750-DMD-CLM-FIX.
 17625
 17626* EXEC CICS WRITEQ TS
 17627*         QUEUE     (PI-KEY)
 17628*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17629*         LENGTH    (PI-COMM-LENGTH)
 17630*    END-EXEC.
 17631*    MOVE '*"     L              ''   #00014661' TO DFHEIV0
 17632     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17633     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17634     MOVE X'2020233030303134363631' TO DFHEIV0(25:11)
 17635     CALL 'kxdfhei1' USING DFHEIV0,
 17636           PI-KEY,
 17637           PROGRAM-INTERFACE-BLOCK,
 17638           PI-COMM-LENGTH,
 17639           DFHEIV99,
 17640           DFHEIV99,
 17641           DFHEIV99
 17642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17643
 17644
 17645     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17646     GO TO 9200-XCTL.
 17647
 17648 8800-UNAUTHORIZED-ACCESS.
 17649     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17650     GO TO 8990-SEND-TEXT.
 17651
 17652 8810-PF23-ENTERED.
 17653     MOVE EIBAID                 TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 331
* EL131.cbl
 17654     MOVE XCTL-EL005             TO CALL-PGM.
 17655     GO TO 9200-XCTL.
 17656
 17657 8820-XCTL-ERROR.
 17658
 17659* EXEC CICS HANDLE CONDITION
 17660*        PGMIDERR (8990-SEND-TEXT)
 17661*    END-EXEC.
 17662*    MOVE '"$L                   ! J #00014680' TO DFHEIV0
 17663     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17665     MOVE X'4A20233030303134363830' TO DFHEIV0(25:11)
 17666     CALL 'kxdfhei1' USING DFHEIV0
 17667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17668
 17669
 17670     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17671     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17672     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17673     MOVE XCTL-EL005            TO CALL-PGM.
 17674     GO TO 9200-XCTL.
 17675
 17676 8990-SEND-TEXT.
 17677
 17678* EXEC CICS SEND TEXT
 17679*         FROM      (LOGOFF-TEXT)
 17680*         LENGTH    (LOGOFF-LENGTH)
 17681*         ERASE
 17682*         FREEKB
 17683*    END-EXEC.
 17684*    MOVE '8&      T  E F  H   F -   #00014691' TO DFHEIV0
 17685     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17686     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17687     MOVE X'2020233030303134363931' TO DFHEIV0(25:11)
 17688     CALL 'kxdfhei1' USING DFHEIV0,
 17689           LOGOFF-TEXT,
 17690           LOGOFF-LENGTH,
 17691           DFHEIV99,
 17692           DFHEIV99,
 17693           DFHEIV99,
 17694           DFHEIV99,
 17695           DFHEIV99,
 17696           DFHEIV99,
 17697           DFHEIV99,
 17698           DFHEIV99,
 17699           DFHEIV99,
 17700           DFHEIV99
 17701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17702
 17703
 17704     GO TO 9100-RETURN-CICS.
 17705
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 332
* EL131.cbl
 17707 9000-RETURN-TRANS.
 17708
 17709* EXEC CICS RETURN
 17710*         TRANSID   (TRANS-ID)
 17711*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17712*         LENGTH    (PI-COMM-LENGTH)
 17713*    END-EXEC.
 17714*    MOVE '.(CT                  ''   #00014702' TO DFHEIV0
 17715     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17716     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17717     MOVE X'2020233030303134373032' TO DFHEIV0(25:11)
 17718     CALL 'kxdfhei1' USING DFHEIV0,
 17719           TRANS-ID,
 17720           PROGRAM-INTERFACE-BLOCK,
 17721           PI-COMM-LENGTH,
 17722           DFHEIV99,
 17723           DFHEIV99,
 17724           DFHEIV99
 17725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17726
 17727
 17728
 17729* GOBACK.
 17730     MOVE '9%                    "   ' TO DFHEIV0
 17731     MOVE 'EL131' TO DFHEIV1
 17732     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17733     GOBACK.
 17734
 17735 9100-RETURN-CICS.
 17736
 17737* EXEC CICS RETURN
 17738*    END-EXEC.
 17739*    MOVE '.(                    ''   #00014711' TO DFHEIV0
 17740     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17742     MOVE X'2020233030303134373131' TO DFHEIV0(25:11)
 17743     CALL 'kxdfhei1' USING DFHEIV0,
 17744           DFHEIV99,
 17745           DFHEIV99,
 17746           DFHEIV99,
 17747           DFHEIV99,
 17748           DFHEIV99,
 17749           DFHEIV99
 17750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17751
 17752
 17753
 17754* GOBACK.
 17755     MOVE '9%                    "   ' TO DFHEIV0
 17756     MOVE 'EL131' TO DFHEIV1
 17757     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17758     GOBACK.
 17759
 17760 9200-XCTL.
 17761
 17762* EXEC CICS XCTL
 17763*         PROGRAM    (CALL-PGM)
 17764*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 333
* EL131.cbl
 17765*         LENGTH     (PI-COMM-LENGTH)
 17766*    END-EXEC.
 17767*    MOVE '.$C                   %   #00014717' TO DFHEIV0
 17768     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17769     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17770     MOVE X'2020233030303134373137' TO DFHEIV0(25:11)
 17771     CALL 'kxdfhei1' USING DFHEIV0,
 17772           CALL-PGM,
 17773           PROGRAM-INTERFACE-BLOCK,
 17774           PI-COMM-LENGTH,
 17775           DFHEIV99
 17776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17777
 17778
 17779 9700-LINK-RTRM-FILE-ID.
 17780
 17781* EXEC CICS LINK
 17782*        PROGRAM  (RTRM-FILE-ID)
 17783*        COMMAREA (CALCULATION-PASS-AREA)
 17784*        LENGTH   (CP-COMM-LENGTH)
 17785*    END-EXEC.
 17786*    MOVE '."C                   (   #00014724' TO DFHEIV0
 17787     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17788     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17789     MOVE X'2020233030303134373234' TO DFHEIV0(25:11)
 17790     CALL 'kxdfhei1' USING DFHEIV0,
 17791           RTRM-FILE-ID,
 17792           CALCULATION-PASS-AREA,
 17793           CP-COMM-LENGTH,
 17794           DFHEIV99,
 17795           DFHEIV99,
 17796           DFHEIV99,
 17797           DFHEIV99
 17798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17799
 17800
 17801 9700-EXIT.
 17802      EXIT.
 17803
 17804 9800-CONVERT-DATE.
 17805     MOVE SPACES TO DC-ERROR-CODE.
 17806
 17807* EXEC CICS LINK
 17808*         PROGRAM    (DATE-CONV)
 17809*         COMMAREA   (DATE-CONVERSION-DATA)
 17810*         LENGTH     (DC-COMM-LENGTH)
 17811*    END-EXEC.
 17812*    MOVE '."C                   (   #00014735' TO DFHEIV0
 17813     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17814     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17815     MOVE X'2020233030303134373335' TO DFHEIV0(25:11)
 17816     CALL 'kxdfhei1' USING DFHEIV0,
 17817           DATE-CONV,
 17818           DATE-CONVERSION-DATA,
 17819           DC-COMM-LENGTH,
 17820           DFHEIV99,
 17821           DFHEIV99,
 17822           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 334
* EL131.cbl
 17823           DFHEIV99
 17824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17825
 17826
 17827 9800-EXIT.
 17828     EXIT.
 17829
 17830 9900-ERROR-FORMAT.
 17831
 17832* EXEC CICS LINK
 17833*         PROGRAM    (XCTL-EL001)
 17834*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17835*         LENGTH     (EMI-COMM-LENGTH)
 17836*    END-EXEC.
 17837*    MOVE '."C                   (   #00014745' TO DFHEIV0
 17838     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17840     MOVE X'2020233030303134373435' TO DFHEIV0(25:11)
 17841     CALL 'kxdfhei1' USING DFHEIV0,
 17842           XCTL-EL001,
 17843           ERROR-MESSAGE-INTERFACE-BLOCK,
 17844           EMI-COMM-LENGTH,
 17845           DFHEIV99,
 17846           DFHEIV99,
 17847           DFHEIV99,
 17848           DFHEIV99
 17849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17850
 17851
 17852 9900-EXIT.
 17853     EXIT.
 17854
 17855 9990-ABEND.
 17856     MOVE DFHEIBLK               TO EMI-LINE1.
 17857
 17858* EXEC CICS LINK
 17859*         PROGRAM   (XCTL-EL004)
 17860*         COMMAREA  (EMI-LINE1)
 17861*         LENGTH    (72)
 17862*     END-EXEC.
 17863     MOVE 72
 17864       TO DFHEIV11
 17865*    MOVE '."C                   (   #00014756' TO DFHEIV0
 17866     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17868     MOVE X'2020233030303134373536' TO DFHEIV0(25:11)
 17869     CALL 'kxdfhei1' USING DFHEIV0,
 17870           XCTL-EL004,
 17871           EMI-LINE1,
 17872           DFHEIV11,
 17873           DFHEIV99,
 17874           DFHEIV99,
 17875           DFHEIV99,
 17876           DFHEIV99
 17877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17878
 17879
 17880     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 335
* EL131.cbl
 17881
 17882     GO TO 8110-SEND-DATA.
 17883
 17884 9995-SECURITY-VIOLATION.
 17885*           COPY ELCSCTP.
 17886******************************************************************
 17887*                                                                *
 17888*                            ELCSCTP                             *
 17889*                            VMOD=2.001                          *
 17890*                                                                *
 17891*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17892******************************************************************
 17893
 17894
 17895     MOVE EIBDATE          TO SM-JUL-DATE.
 17896     MOVE EIBTRMID         TO SM-TERMID.
 17897     MOVE THIS-PGM         TO SM-PGM.
 17898     MOVE EIBTIME          TO TIME-IN.
 17899     MOVE TIME-OUT         TO SM-TIME.
 17900     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17901
 17902
 17903* EXEC CICS LINK
 17904*         PROGRAM  ('EL003')
 17905*         COMMAREA (SECURITY-MESSAGE)
 17906*         LENGTH   (80)
 17907*    END-EXEC.
 17908     MOVE 'EL003' TO DFHEIV1
 17909     MOVE 80
 17910       TO DFHEIV11
 17911*    MOVE '."C                   (   #00014784' TO DFHEIV0
 17912     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17914     MOVE X'2020233030303134373834' TO DFHEIV0(25:11)
 17915     CALL 'kxdfhei1' USING DFHEIV0,
 17916           DFHEIV1,
 17917           SECURITY-MESSAGE,
 17918           DFHEIV11,
 17919           DFHEIV99,
 17920           DFHEIV99,
 17921           DFHEIV99,
 17922           DFHEIV99
 17923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17924
 17925
 17926******************************************************************
 17927
 17928
 17929
 17930 9999-DFHBACK SECTION.
 17931     MOVE '9%                    "   ' TO DFHEIV0
 17932     MOVE 'EL131' TO DFHEIV1
 17933     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17934     GOBACK.
 17935 9999-DFHEXIT.
 17936     IF DFHEIGDJ EQUAL 0001
 17937         NEXT SENTENCE
 17938     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 336
* EL131.cbl
 17939         GO TO 8820-XCTL-ERROR,
 17940               8150-ENTERED-CLAIM-NOTFOUND,
 17941               9990-ABEND
 17942         DEPENDING ON DFHEIGDI
 17943     ELSE IF DFHEIGDJ EQUAL 3
 17944         GO TO 0130-TS-ERROR,
 17945               0130-TS-ERROR
 17946         DEPENDING ON DFHEIGDI
 17947     ELSE IF DFHEIGDJ EQUAL 4
 17948         GO TO 0600-CONTINUE-NAME-UPDATE
 17949         DEPENDING ON DFHEIGDI
 17950     ELSE IF DFHEIGDJ EQUAL 5
 17951         GO TO 1004-BENE-NOT-FOUND
 17952         DEPENDING ON DFHEIGDI
 17953     ELSE IF DFHEIGDJ EQUAL 6
 17954         GO TO 1052-DONE,
 17955               1052-DONE
 17956         DEPENDING ON DFHEIGDI
 17957     ELSE IF DFHEIGDJ EQUAL 7
 17958         GO TO 1120-CNTL-NOTFND
 17959         DEPENDING ON DFHEIGDI
 17960     ELSE IF DFHEIGDJ EQUAL 8
 17961         GO TO 1150-NOTOPEN-ERROR,
 17962               1150-EXIT
 17963         DEPENDING ON DFHEIGDI
 17964     ELSE IF DFHEIGDJ EQUAL 9
 17965         GO TO 1490-STATE-NOTFND
 17966         DEPENDING ON DFHEIGDI
 17967     ELSE IF DFHEIGDJ EQUAL 10
 17968         GO TO 1500-CARR-NOTFND
 17969         DEPENDING ON DFHEIGDI
 17970     ELSE IF DFHEIGDJ EQUAL 11
 17971         GO TO 1620-ACCT-NOTFND
 17972         DEPENDING ON DFHEIGDI
 17973     ELSE IF DFHEIGDJ EQUAL 12
 17974         GO TO 2020-EXIT
 17975         DEPENDING ON DFHEIGDI
 17976     ELSE IF DFHEIGDJ EQUAL 13
 17977         GO TO 2030-EXIT
 17978         DEPENDING ON DFHEIGDI
 17979     ELSE IF DFHEIGDJ EQUAL 14
 17980         GO TO 2040-EXIT
 17981         DEPENDING ON DFHEIGDI
 17982     ELSE IF DFHEIGDJ EQUAL 15
 17983         GO TO 2050-EXIT
 17984         DEPENDING ON DFHEIGDI
 17985     ELSE IF DFHEIGDJ EQUAL 16
 17986         GO TO 2060-CERT-NOTFND
 17987         DEPENDING ON DFHEIGDI
 17988     ELSE IF DFHEIGDJ EQUAL 17
 17989         GO TO 2060-DUPKEY
 17990         DEPENDING ON DFHEIGDI
 17991     ELSE IF DFHEIGDJ EQUAL 18
 17992         GO TO 2070-NOT-FOUND
 17993         DEPENDING ON DFHEIGDI
 17994     ELSE IF DFHEIGDJ EQUAL 19
 17995         GO TO 2070-EXIT
 17996         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 337
* EL131.cbl
 17997     ELSE IF DFHEIGDJ EQUAL 20
 17998         GO TO 2080-EXIT
 17999         DEPENDING ON DFHEIGDI
 18000     ELSE IF DFHEIGDJ EQUAL 21
 18001         GO TO 2400-TRLR-NOTFND,
 18002               2410-EXIT
 18003         DEPENDING ON DFHEIGDI
 18004     ELSE IF DFHEIGDJ EQUAL 22
 18005         GO TO 2425-NINETY-NOTFND,
 18006               2425-NINETY-NOTFND
 18007         DEPENDING ON DFHEIGDI
 18008     ELSE IF DFHEIGDJ EQUAL 23
 18009         GO TO 2430-EXIT,
 18010               2440-EXIT
 18011         DEPENDING ON DFHEIGDI
 18012     ELSE IF DFHEIGDJ EQUAL 24
 18013         GO TO 2440-EXIT
 18014         DEPENDING ON DFHEIGDI
 18015     ELSE IF DFHEIGDJ EQUAL 25
 18016         GO TO 2460-EXIT
 18017         DEPENDING ON DFHEIGDI
 18018     ELSE IF DFHEIGDJ EQUAL 26
 18019         GO TO 2475-EXIT
 18020         DEPENDING ON DFHEIGDI
 18021     ELSE IF DFHEIGDJ EQUAL 27
 18022         GO TO 2650-EXIT
 18023         DEPENDING ON DFHEIGDI
 18024     ELSE IF DFHEIGDJ EQUAL 28
 18025         GO TO 2800-EXIT,
 18026               2800-EXIT
 18027         DEPENDING ON DFHEIGDI
 18028     ELSE IF DFHEIGDJ EQUAL 29
 18029         GO TO 3010-DEL-ACTQ,
 18030               3040-EXIT
 18031         DEPENDING ON DFHEIGDI
 18032     ELSE IF DFHEIGDJ EQUAL 30
 18033         GO TO 3010-NO-ACTIVITY,
 18034               3050-EXIT
 18035         DEPENDING ON DFHEIGDI
 18036     ELSE IF DFHEIGDJ EQUAL 31
 18037         GO TO 3010-CERT-NOT-FOUND
 18038         DEPENDING ON DFHEIGDI
 18039     ELSE IF DFHEIGDJ EQUAL 32
 18040         GO TO 3020-EXIT
 18041         DEPENDING ON DFHEIGDI
 18042     ELSE IF DFHEIGDJ EQUAL 33
 18043         GO TO 3060-EXIT,
 18044               3060-EXIT
 18045         DEPENDING ON DFHEIGDI
 18046     ELSE IF DFHEIGDJ EQUAL 34
 18047         GO TO 5000-TRLR-NOT-FOUND
 18048         DEPENDING ON DFHEIGDI
 18049     ELSE IF DFHEIGDJ EQUAL 35
 18050         GO TO 5000-CERT-NOT-FOUND
 18051         DEPENDING ON DFHEIGDI
 18052     ELSE IF DFHEIGDJ EQUAL 36
 18053         GO TO 1052-DONE,
 18054               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:32 Page 338
* EL131.cbl
 18055         DEPENDING ON DFHEIGDI
 18056     ELSE IF DFHEIGDJ EQUAL 37
 18057         GO TO 7630-END-BROWSE
 18058         DEPENDING ON DFHEIGDI
 18059     ELSE IF DFHEIGDJ EQUAL 38
 18060         GO TO 7799-EXIT,
 18061               7799-EXIT
 18062         DEPENDING ON DFHEIGDI
 18063     ELSE IF DFHEIGDJ EQUAL 39
 18064         GO TO 7799-EXIT
 18065         DEPENDING ON DFHEIGDI
 18066     ELSE IF DFHEIGDJ EQUAL 40
 18067         GO TO 7800-NOT-FOUND
 18068         DEPENDING ON DFHEIGDI
 18069     ELSE IF DFHEIGDJ EQUAL 41
 18070         GO TO 8000-NOTE-NOT-FOUND
 18071         DEPENDING ON DFHEIGDI
 18072     ELSE IF DFHEIGDJ EQUAL 42
 18073         GO TO 8990-SEND-TEXT
 18074         DEPENDING ON DFHEIGDI.
 18075     MOVE '9%                    "   ' TO DFHEIV0
 18076     MOVE 'EL131' TO DFHEIV1
 18077     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18078     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14268     Code:       63109
