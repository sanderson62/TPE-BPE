* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29* 082014  IR2014081400001  PEMA  bypass manual request checks
    30* 082014  IR2015082100001  PEMA  bypass more manual request checks
    31* 092215  IR2015092200001  PEMA  modify determination of manual ch
    32* 091615  CR2015082000001  PEMA  Add Endorsement check processing
    33* 020816  IR2016020500001  PEMA  Add env to unikix cmd for cid1p
    34* 042517  IR2017042500001  PEMA  Reduce number of print lines per
    35* 060717  CR2017032900002  PEMA  CHANGE TEST DB
    36 environment division.
    37 INPUT-OUTPUT SECTION.
    38 FILE-CONTROL.
    39 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    40    FILE STATUS IS WRITTEN-STATUS
    41                            ORGANIZATION IS LINE SEQUENTIAL.
    42 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    43    FILE STATUS IS WRITRPT-STATUS
    44                            ORGANIZATION IS LINE SEQUENTIAL.
    45 data division.
    46 FILE SECTION.
    47 FD  CPS-WRITTEN-IN
    48     BLOCK CONTAINS 0
    49     RECORDING MODE F.
    50 01  CPS-WRITTEN-IN-REC          pic x(200).
    51 FD  CPS-WRITTEN-RPT
    52     BLOCK CONTAINS 0
    53     RECORDING MODE F.
    54 01  CPS-WRITTEN-RPT-REC         pic x(132).
    55 working-storage section.
    56 01  DFH-START PIC X(04).
    57 77  ws-process-sw               pic x value ' '.
    58     88  process-cashed            value 'C'.
    59     88  process-written           value 'W'.
    60 77  ws-writ-cnt                 pic 9(5) value zeros.
    61 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    62 77  s1                          pic s999 comp-3 value +0.
    63 77  s2                          pic s999 comp-3 value +0.
    64 77  i1                          pic s999 comp-3 value +0.
    65 77  o1                          pic s999 comp-3 value +0.
    66 77  ws-bin-cashed-dt            pic xx  value low-values.
    67 77  ws-bin-check-dt             pic xx  value low-values.
    68 77  ws-page-cntr                pic 999  value zeros.
    69 77  ws-line-cntr                pic 999  value 070.
    70 77  ws-max-lines                pic 999  value 055.
    71 77  ws-erchek-sw                pic x    value spaces.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   3
* EL201.cbl
    72     88  erchek-found              value 'Y'.
    73 77  ws-table-sw                 pic x    value spaces.
    74     88  table-found               value 'Y'.
    75 77  ws-continue-sw              pic x  value 'Y'.
    76     88  ok-to-continue            value 'Y'.
    77     88  not-ok-to-continue        value 'N'.
    78 77  ws-in-recs                  pic 9(5) value zeros.
    79 77  ws-eof-sw                   pic x  value spaces.
    80     88  end-of-input                  value 'Y'.
    81 77  ws-sql-code                 pic s9(7) value zeros.
    82 77  ws-dis-sql-code             pic -9999999 value zeros.
    83 01  ws-work-dynamic.
    84     05  ws-work-dir             pic x(27) value spaces.
    85     05  ws-work-env             pic x(8)  value spaces.
    86     05  ws-work-comp-id         pic xxx   value spaces.
    87     05  ws-work-file-in         pic x(16) value spaces.
    88     05  ws-work-rpt-out         pic x(13) value spaces.
    89     05  ws-work-job-name        pic x(8)  value spaces.
    90 01  ws-written-in               pic x(58).
    91 01  ws-written-rpt              pic x(58).
    92 01  P pointer.
    93 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    94 01  var-ptr pointer.
    95 01  env-var-len                 pic 9(4)  binary.
    96 01  rc                          pic 9(9)  binary.
    97
    98 01  WS-KIXSYS.
    99     05  WS-KIX-FIL1             PIC X(10).
   100     05  WS-KIX-APPS             PIC X(10).
   101     05  WS-KIX-ENV              PIC X(10).
   102     05  WS-KIX-MYENV            PIC X(10).
   103     05  WS-KIX-SYS              PIC X(10).
*  104 EXEC SQL
*  105    INCLUDE SQLDA
*  106 END-EXEC
   107 01 SQLDA sync.
   108    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   109    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   110    05 SQLN                  PIC S9(4) COMP-5 value 0.
   111    05 SQLD                  PIC S9(4) COMP-5 value 0.
   112    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   113       10 SQLTYPE            PIC S9(4) COMP-5.
   114       10 SQLLEN             PIC S9(4) COMP-5.
   115$IF P64 SET
   116X      *> For 64-bit environments, ensure that SQLDATA is
   117X      *> aligned on an 8-byte boundary.
   118X      10 FILLER             PIC S9(9) COMP-5.
   119$END
   120       10 SQLDATA            USAGE POINTER.
   121       10 SQLIND             USAGE POINTER.
   122       10 SQLNAME.
   123          15 SQLNAMEL        PIC S9(4) COMP-5.
   124          15 SQLNAMEC        PIC X(30).
   125
   126* Values for SQLTYPE
   127
   128 78  ESQL-DATE-CHAR              VALUE 384.
   129 78  ESQL-DATE-CHAR-NULL         VALUE 385.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-DATE-REC               VALUE 386.
   131 78  ESQL-DATE-REC-NULL          VALUE 387.
   132 78  ESQL-TIME-CHAR              VALUE 388.
   133 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   134 78  ESQL-TIME-REC               VALUE 390.
   135 78  ESQL-TIME-REC-NULL          VALUE 391.
   136 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   137 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   138 78  ESQL-TIMESTAMP-REC          VALUE 394.
   139 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   140 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   141 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   142 78  ESQL-TS-OFFSET-REC          VALUE 398.
   143 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   144 78  ESQL-LONGVARBINARY          VALUE 404.
   145 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   146 78  ESQL-LONGVARCHAR            VALUE 408.
   147 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   148 78  ESQL-BINARY                 VALUE 444.
   149 78  ESQL-BINARY-NULL            VALUE 445.
   150 78  ESQL-VARBINARY              VALUE 446.
   151 78  ESQL-VARBINARY-NULL         VALUE 447.
   152 78  ESQL-VARCHAR                VALUE 448.
   153 78  ESQL-VARCHAR-NULL           VALUE 449.
   154
   155 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   156 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   157
   158 78  ESQL-CHAR                   VALUE 452.
   159 78  ESQL-CHAR-NULL              VALUE 453.
   160
   161 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   162 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   163
   164 78  ESQL-DOUBLE                 VALUE 480.
   165 78  ESQL-DOUBLE-NULL            VALUE 481.
   166 78  ESQL-REAL                   VALUE 482.
   167 78  ESQL-REAL-NULL              VALUE 483.
   168 78  ESQL-DECIMAL                VALUE 484.
   169 78  ESQL-DECIMAL-NULL           VALUE 485.
   170 78  ESQL-INTEGER                VALUE 496.
   171 78  ESQL-INTEGER-NULL           VALUE 497.
   172 78  ESQL-SMALLINT               VALUE 500.
   173 78  ESQL-SMALLINT-NULL          VALUE 501.
   174 78  ESQL-TINYINT                VALUE 502.
   175 78  ESQL-TINYINT-NULL           VALUE 503.
*  176 EXEC SQL
*  177    INCLUDE SQLCA
*  178 END-EXEC
   179 01 SQLCA.
   180     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   181     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   182     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   183     05  SQLERRM.
   184         49  SQLERRML    PIC S9(4) COMP-5.
   185         49  SQLERRMC    PIC X(70).
   186     05  SQLERRP         PIC X(8).
   187     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   5
* EL201.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188     05  SQLWARN.
   189         10  SQLWARN0    PIC X.
   190         10  SQLWARN1    PIC X.
   191         10  SQLWARN2    PIC X.
   192         10  SQLWARN3    PIC X.
   193         10  SQLWARN4    PIC X.
   194         10  SQLWARN5    PIC X.
   195         10  SQLWARN6    PIC X.
   196         10  SQLWARN7    PIC X.
   197     05  SQLEXT.
   198         10  SQLWARN8    PIC X.
   199         10  SQLWARN9    PIC X.
   200         10  SQLWARN10   PIC X.
   201         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   202     05  SQLSTATE    PIC X(5).
   203 EXEC SQL
   204    BEGIN DECLARE SECTION
   205 END-EXEC
   206 01  ws-key-stuff.
   207     05  ws-check-key            pic 9(7).
   208     05  ws-check-no             pic x(7).
   209     05  ws-compid               pic xxx.
   210     05  ws-carrier              pic x.
   211     05  ws-grouping             pic x(6).
   212     05  ws-state                pic xx.
   213     05  ws-account              pic x(10).
   214     05  ws-eff-date             pic x(10).
   215     05  ws-certificate          pic x(10).
   216     05  ws-cert-sfx             pic x.
   217     05  ws-seq-no               pic 999.
   218     05  ws-type                 pic 999.
   219 01  sqlcmd                      pic x(1024).
   220 01  WS-MOE-DATE                 pic x(10).
   221 01  svr                         pic x(32).
   222 01  usr                         pic x(32).
   223 01  pass                        pic x(32).
   224 01  usr-pass                    pic x(64).
   225 01  ws-disp-code                pic s9(11).
   226***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   227***                                                            ***
   228***  These indicators are used to determine if a variable      ***
   229***  is passed nulls from sql. The indicator will be -1        ***
   230***  if the value on sql is nulls and +0 if the value is       ***
   231***  something other than nulls. Here is an example on how     ***
   232***  to use the indicator variables.                           ***
   233***                                                            ***
   234***     EXEC SQL                                               ***
   235***        fetch checkapp into                                 ***
   236***           :db-app-status :nu-app-status,                   ***
   237***           :db-app-by     :nu-app-by,                       ***
   238***           :db-app-date   :nu-app-date,                     ***
   239***           :db-app-batch  :nu-app-batch                     ***
   240***     END-EXEC                                               ***
   241***                                                            ***
   242***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   243 01  indicator-vaiables-for-nulls.
   244     05  nu-app-status           pic s9(4) comp value +0.
   245     05  nu-app-by               pic s9(4) comp value +0.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   6
* EL201.cbl
   246     05  nu-app-date             pic s9(4) comp value +0.
   247     05  nu-app-batch            pic s9(4) comp value +0.
   248     05  nu-fincar               pic s9(4) comp value +0.
   249     05  nu-checkno              pic s9(4) comp value +0.
   250 01  daily-check-request-rec.
   251     05  db-checkkey             pic x(7).
   252     05  db-compid               pic xxx.
   253     05  db-carrier              pic x.
   254     05  db-grouping             pic x(6).
   255     05  db-state                pic xx.
   256     05  db-account              pic x(10).
   257     05  db-effdate              pic x(24).
   258     05  db-certificate          pic x(10).
   259     05  db-cert-sfx             pic x.
   260     05  db-seq-no               pic x(7).
   261     05  db-type                 pic x(7).
   262     05  db-amount               pic x(10).
   263     05  db-amount-n redefines
   264         db-amount               pic 9(7).99.
   265     05  db-checkno              pic x(15).
   266     05  db-checkdate            pic x(10).
   267     05  db-checkstatus          pic 9(5).
   268     05  db-releasebatch         pic 9(5).
   269     05  db-releasedt            pic x(10).
   270     05  db-releaseby            pic x(4).
   271     05  db-payeename1           pic x(30).
   272     05  db-payeename2           pic x(30).
   273     05  db-payeeaddr1           pic x(30).
   274     05  db-payeeaddr2           pic x(30).
   275     05  db-payeecity            pic x(30).
   276     05  db-payeest              pic xx.
   277     05  db-payeezip             pic x(10).
   278     05  db-fincar               pic x.
   279     05  db-fingrp               pic x(6).
   280     05  db-finresp              pic x(10).
   281     05  db-finacct              pic x(10).
   282     05  db-preparer             pic x(4).
   283     05  db-app-status           pic x(9).
   284     05  dp-app-status-n redefines db-app-status
   285                                 pic 9(9).
   286     05  db-app-by               pic x(20).
   287     05  db-app-date             pic x(30).
   288     05  db-app-batch            pic x(10).
   289     05  db-return-to            pic x(30).
   290     05  db-check-sub-type       pic x.
   291 EXEC SQL
   292    END DECLARE SECTION
   293 END-EXEC
   294 01  FILE-KEYS.
   295     12  ELCNTL-KEY.
   296         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   297         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   298         16 ELCNTL-ACCESS.
   299             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   300             20  FILLER              PIC X       VALUE SPACES.
   301             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   302         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   303 01  f.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   7
* EL201.cbl
   304     05  ws-connect-sw               pic x  value ' '.
   305         88  connected-to-db             value 'Y'.
   306     05  written-status          pic xx.
   307     05  writrpt-status          pic xx.
   308     05  ws-comp-id              pic xxx.
   309     05  ws-comp-cd              pic x.
   310 01  ws-raw-record.
   311     05  raw-check-no            pic x(20).
   312     05  raw-check-dt            pic x(20).
   313     05  raw-check-amt           pic x(15).
   314     05  raw-vendor-id           pic x(20).
   315     05  raw-user-defined        pic x(30).
   316     05  raw-voucher-ref         pic x(35).
   317 01  ws-written-rec.
   318     05  wsw-check-no            pic x(20).
   319     05  wsw-check-dt            pic x(20).
   320     05  wsw-check-amt           pic x(15).
   321     05  wsw-vendor-id           pic x(20).
   322     05  wsw-user-defined        pic x(30).
   323     05  wsw-voucher-ref         pic x(35).
   324 01  filler.
   325     05  wsw-check-key           pic x(7).
   326     05  wsw-check-key-num redefines wsw-check-key
   327                                 pic 9(7).
   328 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   329     88  RESP-NORMAL                    VALUE +0.
   330     88  resp-file-notfnd               value +12.
   331     88  RESP-NOTFND                    VALUE +13.
   332     88  resp-duprec                    value +14.
   333     88  resp-dupkey                    value +15.
   334     88  resp-invreq                    value +16.
   335     88  RESP-NOTOPEN                   VALUE +19.
   336     88  RESP-ENDFILE                   VALUE +20.
   337     88  resp-lengtherr                 value +22.
   338 01  ws-work-amt-alpha           pic x(10).
   339 01  ws-work-amt-num redefines ws-work-amt-alpha
   340                                 pic 9(8)v99.
   341 01  ws-qry-string               pic x(80) value spaces.
   342 01  ws-qrystr-len               pic s9(8) comp value +60.
   343 01  ws-seq-alpha                pic x(5).
   344 01  ws-seq-no-num redefines ws-seq-alpha
   345                                 pic 9(5).
   346*                                copy ERCCHEK.
   347******************************************************************
   348*                                                                *
   349*                                                                *
   350*                            ERCCHEK                             *
   351*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   352*                            VMOD=2.008                          *
   353*                                                                *
   354*   FILE DESCRIPTION = CHECK RECORDS                             *
   355*                                                                *
   356*   FILE TYPE = VSAM,KSDS                                        *
   357*   RECORD SIZE = 600    RECFORM = FIXED                         *
   358*                                                                *
   359*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   360*       ALTERNATE INDEX = NONE                                   *
   361*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   8
* EL201.cbl
   362*   LOG = YES                                                    *
   363*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   364******************************************************************
   365*                   C H A N G E   L O G
   366*
   367* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   368*-----------------------------------------------------------------
   369*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   370* EFFECTIVE    NUMBER
   371*-----------------------------------------------------------------
   372* 021414    2003053000001  PEMA  changes for auto chk request
   373******************************************************************
   374 01  CHECK-RECORDS.
   375     12  CH-RECORD-ID                      PIC XX.
   376         88  VALID-CH-ID                      VALUE 'CH'.
   377
   378     12  CH-CONTROL-PRIMARY.
   379         16  CH-COMPANY-CD                 PIC X.
   380         16  CH-CARRIER                    PIC X.
   381         16  CH-GROUPING                   PIC X(6).
   382         16  CH-STATE                      PIC XX.
   383         16  CH-ACCOUNT                    PIC X(10).
   384         16  CH-CERT-EFF-DT                PIC XX.
   385         16  CH-CERT-NO.
   386             20  CH-CERT-PRIME             PIC X(10).
   387             20  CH-CERT-SFX               PIC X.
   388         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   389
   390     12  CH-RECORDED-DT                    PIC XX.
   391     12  CH-RECORDED-BY                    PIC X(4).
   392     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   393
   394     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   395     12  CH-CHECK-NO                       PIC X(7).
   396     12  CH-REASON-FOR-CHECK               PIC X(25).
   397     12  CH-CHECK-WRITTEN-DT               PIC XX.
   398     12  FILLER                            PIC X.
   399
   400     12  CH-PAYEE-INFO.
   401         16  CH-PAYEE-NAME-1               PIC X(30).
   402         16  CH-PAYEE-NAME-2               PIC X(30).
   403         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   404         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   405         16  CH-PAYEE-CITY-ST.
   406             20  CH-PAYEE-CITY             PIC X(28).
   407             20  CH-PAYEE-STATE            PIC XX.
   408         16  CH-PAYEE-ZIP-CODE.
   409             20  CH-PAYEE-ZIP.
   410                 24  CH-ZIP-PRI-1ST        PIC X.
   411                     88  CH-CANADIAN-POST-CODE
   412                                           VALUES 'A' THRU 'Z'.
   413                 24  FILLER                PIC X(4).
   414             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   415         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   416             20  CH-CAN-POSTAL-1           PIC XXX.
   417             20  CH-CAN-POSTAL-2           PIC XXX.
   418             20  FILLER                    PIC XXX.
   419
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   9
* EL201.cbl
   420     12  CH-CHECK-STUB-TEXT.
   421         16  CH-STUB-LINE-1                PIC X(30).
   422         16  CH-TEXT-LINE-1                PIC X(50).
   423         16  CH-TEXT-LINE-2                PIC X(50).
   424         16  CH-TEXT-LINE-3                PIC X(40).
   425     12  CH-RETURN-TO                      PIC X(30).
   426
   427     12  CH-COMPENSATION-CONTROL.
   428         16  CH-COMP-CARRIER               PIC X.
   429         16  CH-COMP-GROUPING              PIC X(6).
   430         16  CH-COMP-FIN-RESP              PIC X(10).
   431         16  CH-COMP-ACCOUNT               PIC X(10).
   432
   433     12  CH-CREDIT-SELECT-DT               PIC XX.
   434     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   435     12  CH-PAYEE-CODE                     PIC X(6).
   436
   437     12  CH-VOID-DATA.
   438         20  CH-VOID-DT                    PIC XX.
   439         20  CH-VOID-BY                    PIC X(4).
   440         20  CH-VOID-REASON                PIC X(25).
   441
   442     12  CH-APPROVAL-DATA.
   443         20  CH-APPROVAL-DT                PIC XX.
   444         20  CH-APPROVAL-STATUS            PIC X.
   445             88  CH-IN-LIMBO                  VALUE ' '.
   446             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   447             88  CH-APPROVED                  VALUE 'A'.
   448             88  CH-DENIED                    VALUE 'D'.
   449         20  CH-APPROVED-BY                PIC XXXX.
   450     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   451             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   452     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   453
   454     12  ch-released-dt                    pic xx.
   455     12  ch-check-cashed-dt                pic xx.
   456     12  FILLER                            PIC X.
   457*    12  CH-CHECK-REFERENCE                PIC X(12).
   458     12  CH-CHECK-ORIGIN-SW                PIC X.
   459             88  CH-REFUND-CHECK              VALUE 'R'.
   460             88  CH-MAINT-CHECK               VALUE 'M'.
   461
   462     12  CH-CANC-DT                        PIC XX.
   463     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   464     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   465
   466     12  CH-INSURED-NAME                   PIC X(28).
   467
   468     12  ch-released-by                    pic x(4).
   469     12  ch-csr                            pic x(4).
   470     12  ch-deduct-commission              pic x.
   471         88  ch-deduct-comm                  value 'Y'.
   472         88  ch-do-not-deduct-comm           value 'N'.
   473
   474     12  FILLER                            PIC X(11).
   475*    12  CH-LETTER-TABLE.
   476*        16  CH-LETTERS OCCURS 3 TIMES
   477*                       INDEXED BY CH-LT-NDX
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  10
* EL201.cbl
   478*                                          PIC X(04).
   479
   480     12  FILLER                            PIC X(07).
   481
   482*                                copy ELCFUNDT.
   483*****************************************************************
   484*                                                               *
   485*                            ELCFUNDT.                          *
   486*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   487*                            VMOD=2.001                         *
   488*                                                               *
   489*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   490*                                                               *
   491*****************************************************************
   492
   493
   494 01  FUNCTION-DATE.
   495     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   496     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   497         10  WS-FN-CCYR            PIC 9(4).
   498         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   499             15  WS-FN-CC          PIC 99.
   500             15  WS-FN-YR          PIC 99.
   501         10  WS-FN-MO              PIC 99.
   502         10  WS-FN-DA              PIC 99.
   503     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   504     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   505     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   506     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   507     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   508         88  WS-BEHIND-GMT                     VALUE '-'.
   509         88  WS-AFTER-GMT                      VALUE '+'.
   510         88  WS-NO-GMT                         VALUE ZERO.
   511     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   512     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   513*                                COPY ELCDATE.
   514******************************************************************
   515*                                                                *
   516*                                                                *
   517*                            ELCDATE.                            *
   518*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   519*                            VMOD=2.003
   520*                                                                *
   521*                                                                *
   522*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   523*                 LENGTH = 200                                   *
   524******************************************************************
   525
   526 01  DATE-CONVERSION-DATA.
   527     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   528     12  DC-OPTION-CODE                PIC X.
   529         88  BIN-TO-GREG                VALUE ' '.
   530         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   531         88  EDIT-GREG-TO-BIN           VALUE '2'.
   532         88  YMD-GREG-TO-BIN            VALUE '3'.
   533         88  MDY-GREG-TO-BIN            VALUE '4'.
   534         88  JULIAN-TO-BIN              VALUE '5'.
   535         88  BIN-PLUS-ELAPSED           VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  11
* EL201.cbl
   536         88  FIND-CENTURY               VALUE '7'.
   537         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   538         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   539         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   540         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   541         88  JULIAN-TO-BIN-3            VALUE 'C'.
   542         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   543         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   544         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   545         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   546         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   547         88  CHECK-LEAP-YEAR            VALUE 'H'.
   548         88  BIN-3-TO-GREG              VALUE 'I'.
   549         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   550         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   551         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   552         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   553         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   554         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   555         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   556         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   557         88  THREE-CHARACTER-BIN
   558                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   559         88  GREGORIAN-TO-BIN
   560                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   561         88  BIN-TO-GREGORIAN
   562                  VALUES ' ' '1' 'I' '8' 'G'.
   563         88  JULIAN-TO-BINARY
   564                  VALUES '5' 'C' 'E' 'F'.
   565     12  DC-ERROR-CODE                 PIC X.
   566         88  NO-CONVERSION-ERROR        VALUE ' '.
   567         88  DATE-CONVERSION-ERROR
   568                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   569         88  DATE-IS-ZERO               VALUE '1'.
   570         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   571         88  DATE-IS-INVALID            VALUE '3'.
   572         88  DATE1-GREATER-DATE2        VALUE '4'.
   573         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   574         88  DATE-INVALID-OPTION        VALUE '9'.
   575         88  INVALID-CENTURY            VALUE 'A'.
   576         88  ONLY-CENTURY               VALUE 'B'.
   577         88  ONLY-LEAP-YEAR             VALUE 'C'.
   578         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   579     12  DC-END-OF-MONTH               PIC X.
   580         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   581     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   582         88  USE-NORMAL-PROCESS         VALUE ' '.
   583         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   584         88  ADJUST-UP-100-YRS          VALUE '2'.
   585     12  FILLER                        PIC X.
   586     12  DC-CONVERSION-DATES.
   587         16  DC-BIN-DATE-1             PIC XX.
   588         16  DC-BIN-DATE-2             PIC XX.
   589         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   590         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   591                       DC-GREG-DATE-1-EDIT.
   592             20  DC-EDIT1-MONTH        PIC 99.
   593             20  SLASH1-1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  12
* EL201.cbl
   594             20  DC-EDIT1-DAY          PIC 99.
   595             20  SLASH1-2              PIC X.
   596             20  DC-EDIT1-YEAR         PIC 99.
   597         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   598         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   599                     DC-GREG-DATE-2-EDIT.
   600             20  DC-EDIT2-MONTH        PIC 99.
   601             20  SLASH2-1              PIC X.
   602             20  DC-EDIT2-DAY          PIC 99.
   603             20  SLASH2-2              PIC X.
   604             20  DC-EDIT2-YEAR         PIC 99.
   605         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   606         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   607                     DC-GREG-DATE-1-YMD.
   608             20  DC-YMD-YEAR           PIC 99.
   609             20  DC-YMD-MONTH          PIC 99.
   610             20  DC-YMD-DAY            PIC 99.
   611         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   612         16  DC-GREG-DATE-1-MDY-R REDEFINES
   613                      DC-GREG-DATE-1-MDY.
   614             20  DC-MDY-MONTH          PIC 99.
   615             20  DC-MDY-DAY            PIC 99.
   616             20  DC-MDY-YEAR           PIC 99.
   617         16  DC-GREG-DATE-1-ALPHA.
   618             20  DC-ALPHA-MONTH        PIC X(10).
   619             20  DC-ALPHA-DAY          PIC 99.
   620             20  FILLER                PIC XX.
   621             20  DC-ALPHA-CENTURY.
   622                 24 DC-ALPHA-CEN-N     PIC 99.
   623             20  DC-ALPHA-YEAR         PIC 99.
   624         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   625         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   626         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   627         16  DC-JULIAN-DATE            PIC 9(05).
   628         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   629                                       PIC 9(05).
   630         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   631             20  DC-JULIAN-YEAR        PIC 99.
   632             20  DC-JULIAN-DAYS        PIC 999.
   633         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   634         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   635         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   636     12  DATE-CONVERSION-VARIBLES.
   637         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   638         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   639             20  FILLER                PIC 9(3).
   640             20  HOLD-CEN-1-CCYY.
   641                 24  HOLD-CEN-1-CC     PIC 99.
   642                 24  HOLD-CEN-1-YY     PIC 99.
   643             20  HOLD-CEN-1-MO         PIC 99.
   644             20  HOLD-CEN-1-DA         PIC 99.
   645         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   646             20  HOLD-CEN-1-R-MO       PIC 99.
   647             20  HOLD-CEN-1-R-DA       PIC 99.
   648             20  HOLD-CEN-1-R-CCYY.
   649                 24  HOLD-CEN-1-R-CC   PIC 99.
   650                 24  HOLD-CEN-1-R-YY   PIC 99.
   651             20  FILLER                PIC 9(3).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  13
* EL201.cbl
   652         16  HOLD-CENTURY-1-X.
   653             20  FILLER                PIC X(3)  VALUE SPACES.
   654             20  HOLD-CEN-1-X-CCYY.
   655                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   656                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   657             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   658             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   659         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   660             20  HOLD-CEN-1-R-X-MO     PIC XX.
   661             20  HOLD-CEN-1-R-X-DA     PIC XX.
   662             20  HOLD-CEN-1-R-X-CCYY.
   663                 24  HOLD-CEN-1-R-X-CC PIC XX.
   664                 24  HOLD-CEN-1-R-X-YY PIC XX.
   665             20  FILLER                PIC XXX.
   666         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   667         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   668         16  DC-JULIAN-DATE-1          PIC 9(07).
   669         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   670             20  DC-JULIAN-1-CCYY.
   671                 24  DC-JULIAN-1-CC    PIC 99.
   672                 24  DC-JULIAN-1-YR    PIC 99.
   673             20  DC-JULIAN-DA-1        PIC 999.
   674         16  DC-JULIAN-DATE-2          PIC 9(07).
   675         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   676             20  DC-JULIAN-2-CCYY.
   677                 24  DC-JULIAN-2-CC    PIC 99.
   678                 24  DC-JULIAN-2-YR    PIC 99.
   679             20  DC-JULIAN-DA-2        PIC 999.
   680         16  DC-GREG-DATE-A-EDIT.
   681             20  DC-EDITA-MONTH        PIC 99.
   682             20  SLASHA-1              PIC X VALUE '/'.
   683             20  DC-EDITA-DAY          PIC 99.
   684             20  SLASHA-2              PIC X VALUE '/'.
   685             20  DC-EDITA-CCYY.
   686                 24  DC-EDITA-CENT     PIC 99.
   687                 24  DC-EDITA-YEAR     PIC 99.
   688         16  DC-GREG-DATE-B-EDIT.
   689             20  DC-EDITB-MONTH        PIC 99.
   690             20  SLASHB-1              PIC X VALUE '/'.
   691             20  DC-EDITB-DAY          PIC 99.
   692             20  SLASHB-2              PIC X VALUE '/'.
   693             20  DC-EDITB-CCYY.
   694                 24  DC-EDITB-CENT     PIC 99.
   695                 24  DC-EDITB-YEAR     PIC 99.
   696         16  DC-GREG-DATE-CYMD         PIC 9(08).
   697         16  DC-GREG-DATE-CYMD-R REDEFINES
   698                              DC-GREG-DATE-CYMD.
   699             20  DC-CYMD-CEN           PIC 99.
   700             20  DC-CYMD-YEAR          PIC 99.
   701             20  DC-CYMD-MONTH         PIC 99.
   702             20  DC-CYMD-DAY           PIC 99.
   703         16  DC-GREG-DATE-MDCY         PIC 9(08).
   704         16  DC-GREG-DATE-MDCY-R REDEFINES
   705                              DC-GREG-DATE-MDCY.
   706             20  DC-MDCY-MONTH         PIC 99.
   707             20  DC-MDCY-DAY           PIC 99.
   708             20  DC-MDCY-CEN           PIC 99.
   709             20  DC-MDCY-YEAR          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  14
* EL201.cbl
   710    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   711        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   712    12  DC-EL310-DATE                  PIC X(21).
   713    12  FILLER                         PIC X(28).
   714*                                COPY ELCCNTL.
   715******************************************************************
   716*                                                                *
   717*                                                                *
   718*                            ELCCNTL.                            *
   719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   720*                            VMOD=2.059                          *
   721*                                                                *
   722*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   723*                                                                *
   724*   FILE TYPE = VSAM,KSDS                                        *
   725*   RECORD SIZE = 750  RECFORM = FIXED                           *
   726*                                                                *
   727*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   728*       ALTERNATE INDEX = NONE                                   *
   729*                                                                *
   730*   LOG = YES                                                    *
   731*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   732******************************************************************
   733*                   C H A N G E   L O G
   734*
   735* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   736*-----------------------------------------------------------------
   737*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   738* EFFECTIVE    NUMBER
   739*-----------------------------------------------------------------
   740* 082503                   PEMA  ADD BENEFIT GROUP
   741* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   742* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   743* 092705    2005050300006  PEMA  ADD SPP LEASES
   744* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   745* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   746* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   747* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   748* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   749* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   750* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   751* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   752* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   753* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   754******************************************************************
   755*
   756 01  CONTROL-FILE.
   757     12  CF-RECORD-ID                       PIC XX.
   758         88  VALID-CF-ID                        VALUE 'CF'.
   759
   760     12  CF-CONTROL-PRIMARY.
   761         16  CF-COMPANY-ID                  PIC XXX.
   762         16  CF-RECORD-TYPE                 PIC X.
   763             88  CF-COMPANY-MASTER              VALUE '1'.
   764             88  CF-PROCESSOR-MASTER            VALUE '2'.
   765             88  CF-STATE-MASTER                VALUE '3'.
   766             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   767             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  15
* EL201.cbl
   768             88  CF-CARRIER-MASTER              VALUE '6'.
   769             88  CF-MORTALITY-MASTER            VALUE '7'.
   770             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   771             88  CF-TERMINAL-MASTER             VALUE '9'.
   772             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   773             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   774             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   775             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   776             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   777             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   778             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   779             88  CF-REMINDERS-MASTER            VALUE 'R'.
   780             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   781         16  CF-ACCESS-CD-GENL              PIC X(4).
   782         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   783             20  CF-PROCESSOR               PIC X(4).
   784         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   785             20  CF-STATE-CODE              PIC XX.
   786             20  FILLER                     PIC XX.
   787         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   788             20  FILLER                     PIC XX.
   789             20  CF-HI-BEN-IN-REC           PIC XX.
   790         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   791             20  FILLER                     PIC XXX.
   792             20  CF-CARRIER-CNTL            PIC X.
   793         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   794             20  FILLER                     PIC XX.
   795             20  CF-HI-TYPE-IN-REC          PIC 99.
   796         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   797             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   798                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   799             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   800             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   801         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   802             20  FILLER                     PIC X.
   803             20  CF-CUSTOM-REPORT-NO        PIC 999.
   804         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   805             20  FILLER                     PIC XX.
   806             20  CF-MORTGAGE-PLAN           PIC XX.
   807         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   808
   809     12  CF-LAST-MAINT-DT                   PIC XX.
   810     12  CF-LAST-MAINT-BY                   PIC X(4).
   811     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   812
   813     12  CF-RECORD-BODY                     PIC X(728).
   814
   815
   816****************************************************************
   817*             COMPANY MASTER RECORD                            *
   818****************************************************************
   819
   820     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   821         16  CF-COMPANY-ADDRESS.
   822             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   823             20  CF-CL-IN-CARE-OF           PIC X(30).
   824             20  CF-CL-ADDR-LINE-1          PIC X(30).
   825             20  CF-CL-ADDR-LINE-2          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  16
* EL201.cbl
   826             20  CF-CL-CITY-STATE           PIC X(30).
   827             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   828             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   829         16  CF-COMPANY-CD                  PIC X.
   830         16  CF-COMPANY-PASSWORD            PIC X(8).
   831         16  CF-SECURITY-OPTION             PIC X.
   832             88  ALL-SECURITY                   VALUE '1'.
   833             88  COMPANY-VERIFY                 VALUE '2'.
   834             88  PROCESSOR-VERIFY               VALUE '3'.
   835             88  NO-SECURITY                    VALUE '4'.
   836             88  ALL-BUT-TERM                   VALUE '5'.
   837         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   838             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   839         16  CF-LGX-INTERFACE-CNTL          PIC X.
   840             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   841         16  CF-INFORCE-LOCATION            PIC X.
   842             88  CERTS-ARE-ONLINE               VALUE '1'.
   843             88  CERTS-ARE-OFFLINE              VALUE '2'.
   844             88  NO-CERTS-AVAILABLE             VALUE '3'.
   845         16  CF-LOWER-CASE-LETTERS          PIC X.
   846         16  CF-CERT-ACCESS-CONTROL         PIC X.
   847             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   848             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   849             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   850             88  CF-ACCNT-CNTL                  VALUE '3'.
   851             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   852
   853         16  CF-FORMS-PRINTER-ID            PIC X(4).
   854         16  CF-CHECK-PRINTER-ID            PIC X(4).
   855
   856         16  CF-LGX-CREDIT-USER             PIC X.
   857             88  CO-IS-NOT-USER                 VALUE 'N'.
   858             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   859
   860         16 CF-CREDIT-CALC-CODES.
   861             20  CF-CR-REM-TERM-CALC PIC X.
   862               88  CR-EARN-AFTER-15TH           VALUE '1'.
   863               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   864               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   865               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   866               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   867               88  CR-EARN-AFTER-14TH           VALUE '6'.
   868               88  CR-EARN-AFTER-16TH           VALUE '7'.
   869             20  CF-CR-R78-METHOD           PIC X.
   870               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   871               88  DONT-USE-PLUS-ONE            VALUE '1'.
   872
   873         16  CF-CLAIM-CONTROL-COUNTS.
   874             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   875                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   876
   877             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   878                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   879
   880             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   881                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   882
   883             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  17
* EL201.cbl
   884                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   885
   886         16  CF-CURRENT-MONTH-END           PIC XX.
   887
   888         16  CF-CO-CALC-QUOTE-TOLERANCE.
   889             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   890             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   891             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   892             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   893                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   894                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   895             20  CF-CO-PREM-REJECT-SW       PIC X.
   896                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   897                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   898             20  CF-CO-REF-REJECT-SW        PIC X.
   899                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   900                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   901
   902         16  CF-CO-REPORTING-DT             PIC XX.
   903         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   904         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   905           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   906           88  CF-CO-MONTH-END                  VALUE '1'.
   907
   908         16  CF-LGX-CLAIM-USER              PIC X.
   909             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   910             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   911
   912         16  CF-CREDIT-EDIT-CONTROLS.
   913             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   914             20  CF-MIN-AGE                 PIC 99.
   915             20  CF-DEFAULT-AGE             PIC 99.
   916             20  CF-MIN-TERM                PIC S999      COMP-3.
   917             20  CF-MAX-TERM                PIC S999      COMP-3.
   918             20  CF-DEFAULT-SEX             PIC X.
   919             20  CF-JOINT-AGE-INPUT         PIC X.
   920                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   921             20  CF-BIRTH-DATE-INPUT        PIC X.
   922                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   923             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   924                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   925                 88  CF-ZERO-CARRIER            VALUE '1'.
   926                 88  CF-ZERO-GROUPING           VALUE '2'.
   927                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   928             20  CF-EDIT-SW                 PIC X.
   929                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   930             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   931             20  CF-CR-PR-METHOD            PIC X.
   932               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   933               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   934             20  FILLER                     PIC X.
   935
   936         16  CF-CREDIT-MISC-CONTROLS.
   937             20  CF-REIN-TABLE-SW           PIC X.
   938                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   939             20  CF-COMP-TABLE-SW           PIC X.
   940                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   941             20  CF-EXPERIENCE-RETENTION-AGE
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  18
* EL201.cbl
   942                                            PIC S9        COMP-3.
   943             20  CF-CONVERSION-DT           PIC XX.
   944             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   945             20  CF-RUN-FREQUENCY-SW        PIC X.
   946                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   947                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   948
   949             20  CF-CR-CHECK-NO-CONTROL.
   950                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   951                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   952                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   953                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   954                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   955                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   956
   957                 24  CF-CR-CHECK-COUNT       REDEFINES
   958                     CF-CR-CHECK-COUNTER      PIC X(4).
   959
   960                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   961                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   962
   963                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   964                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   965                 24  CF-MAIL-PROCESSING       PIC X.
   966                     88  MAIL-PROCESSING          VALUE 'Y'.
   967
   968         16  CF-MISC-SYSTEM-CONTROL.
   969             20  CF-SYSTEM-C                 PIC X.
   970                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   971             20  CF-SYSTEM-D                 PIC X.
   972                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   973             20  CF-SOC-SEC-NO-SW            PIC X.
   974                 88  SOC-SEC-NO-USED             VALUE '1'.
   975             20  CF-MEMBER-NO-SW             PIC X.
   976                 88  MEMBER-NO-USED              VALUE '1'.
   977             20  CF-TAX-ID-NUMBER            PIC X(11).
   978             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   979             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   980                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   981                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   982                 88  CF-ALL-APPROVED             VALUE 'Y'.
   983                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   984             20  CF-SYSTEM-E                 PIC X.
   985                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   986
   987         16  CF-LGX-LIFE-USER               PIC X.
   988             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   989             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   990
   991         16  CF-CR-MONTH-END-DT             PIC XX.
   992
   993         16  CF-FILE-MAINT-DATES.
   994             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   995                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   996             20  CF-LAST-BATCH       REDEFINES
   997                 CF-LAST-BATCH-NO               PIC X(4).
   998             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   999             20  CF-RATES-FILE-CREATE-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  19
* EL201.cbl
  1000             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1001             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1002             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1003             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1004             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1005             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1006             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1007             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1008
  1009         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1010         16  FILLER                         PIC X.
  1011
  1012         16  CF-ALT-MORT-CODE               PIC X(4).
  1013         16  CF-MEMBER-CAPTION              PIC X(10).
  1014
  1015         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1016             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1017             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1018             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1019             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1020             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1021
  1022         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1023
  1024         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1025         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1026         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1027         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1028
  1029         16  CF-AH-OVERRIDE-L1              PIC X.
  1030         16  CF-AH-OVERRIDE-L2              PIC XX.
  1031         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1032         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1033
  1034         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1035         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1036
  1037         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1038         16  CF-AR-LAST-EL860-DT            PIC XX.
  1039         16  CF-MP-MONTH-END-DT             PIC XX.
  1040
  1041         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1042         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1043             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1044
  1045         16  CF-AR-MONTH-END-DT             PIC XX.
  1046
  1047         16  CF-CRDTCRD-USER                PIC X.
  1048             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1049             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1050
  1051         16  CF-CC-MONTH-END-DT             PIC XX.
  1052
  1053         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1054
  1055         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1056             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1057             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  20
* EL201.cbl
  1058             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1059         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1060         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1061         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1062         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1063             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1064             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1065         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1066         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1067         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1068             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1069         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1070
  1071         16  CF-CL-ZIP-CODE.
  1072             20  CF-CL-ZIP-PRIME.
  1073                 24  CF-CL-ZIP-1ST          PIC X.
  1074                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1075                 24  FILLER                 PIC X(4).
  1076             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1077         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1078             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1079             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1080             20  FILLER                     PIC XXX.
  1081
  1082         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1083         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1084         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1085         16  CF-CO-OPTION-START-DATE        PIC XX.
  1086         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1087           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1088                                                      '3' '4'.
  1089           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1090           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1091           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1092           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1093           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1094           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1095
  1096         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1097
  1098         16  CF-PAYMENT-APPROVAL-LEVELS.
  1099             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1100             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1101             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1102             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1103             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1104             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1105
  1106         16  CF-END-USER-REPORTING-USER     PIC X.
  1107             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1108             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1109
  1110         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1111             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1112             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1113
  1114         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1115
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  21
* EL201.cbl
  1116         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1117         16  FILLER                         PIC X.
  1118
  1119         16  CF-CREDIT-ARCHIVE-CNTL.
  1120             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1121             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1122             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1123
  1124         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1125
  1126         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1127             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1128             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1129
  1130         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1131             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1132             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1133
  1134         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1135
  1136         16  CF-CO-ACH-ID-CODE              PIC  X.
  1137             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1138             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1139             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1140         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1141         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1142         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1143         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1144         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1145         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1146         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1147         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1148         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1149                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1150         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1151                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1152
  1153         16  CF-CO-OVER-SHORT.
  1154             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1155             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1156
  1157*         16  FILLER                         PIC X(102).
  1158         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1159             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1160             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1161
  1162         16  CF-AH-APPROVAL-DAYS.
  1163             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1164             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1165             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1166             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1167
  1168         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1169
  1170         16  CF-APPROV-LEV-5.
  1171             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1172             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1173             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  22
* EL201.cbl
  1174
  1175         16  FILLER                         PIC X(68).
  1176****************************************************************
  1177*             PROCESSOR/USER RECORD                            *
  1178****************************************************************
  1179
  1180     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1181         16  CF-PROCESSOR-NAME              PIC X(30).
  1182         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1183         16  CF-PROCESSOR-TITLE             PIC X(26).
  1184         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1185                 88  MESSAGE-YES                VALUE 'Y'.
  1186                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1187
  1188*****************************************************
  1189****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1190****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1191****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1192****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1193*****************************************************
  1194
  1195         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1196             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1197             20  CF-APPLICATION-FORCE       PIC X.
  1198             20  CF-INDIVIDUAL-APP.
  1199                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1200                     28  CF-BROWSE-APP      PIC X.
  1201                     28  CF-UPDATE-APP      PIC X.
  1202
  1203         16  CF-CURRENT-TERM-ON             PIC X(4).
  1204         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1205             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1206             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1207             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1208             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1209             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1210             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1211             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1212         16  CF-PROCESSOR-CARRIER           PIC X.
  1213             88  NO-CARRIER-SECURITY            VALUE ' '.
  1214         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1215             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1216         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1217             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1218         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1219             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1220
  1221         16  CF-PROC-SYS-ACCESS-SW.
  1222             20  CF-PROC-CREDIT-CLAIMS-SW.
  1223                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1224                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1225                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1226                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1227             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1228                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1229                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1230             20  CF-PROC-LIFE-GNRLDGR-SW.
  1231                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  23
* EL201.cbl
  1232                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1233                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1234                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1235             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1236                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1237                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1238         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1239             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1240             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1241         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1242
  1243         16  CF-APPROVAL-LEVEL                  PIC X.
  1244             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1245             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1246             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1247             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1248             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1249
  1250         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1251
  1252         16  CF-LANGUAGE-TYPE                   PIC X.
  1253             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1254             88  CF-LANG-IS-FR                      VALUE 'F'.
  1255
  1256         16  CF-CSR-IND                         PIC X.
  1257         16  FILLER                             PIC X(239).
  1258
  1259****************************************************************
  1260*             PROCESSOR/REMINDERS RECORD                       *
  1261****************************************************************
  1262
  1263     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1264         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1265             20  CF-START-REMIND-DT         PIC XX.
  1266             20  CF-END-REMIND-DT           PIC XX.
  1267             20  CF-REMINDER-TEXT           PIC X(50).
  1268         16  FILLER                         PIC X(296).
  1269
  1270
  1271****************************************************************
  1272*             STATE MASTER RECORD                              *
  1273****************************************************************
  1274
  1275     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1276         16  CF-STATE-ABBREVIATION          PIC XX.
  1277         16  CF-STATE-NAME                  PIC X(25).
  1278         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1279         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1280             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1281             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1282             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1283             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1284                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1285                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1286             20  CF-ST-PREM-REJECT-SW       PIC X.
  1287                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1288                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1289             20  CF-ST-REF-REJECT-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  24
* EL201.cbl
  1290                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1291                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1292         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1293         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1294         16  CF-ST-REFUND-RULES.
  1295             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1296             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1297             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1298         16  CF-ST-FST-PMT-EXTENSION.
  1299             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1300             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1301                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1302                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1303                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1304                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1305         16  CF-ST-STATE-CALL.
  1306             20  CF-ST-CALL-UNEARNED        PIC X.
  1307             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1308             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1309         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1310             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1311             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1312         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1313         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1314         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1315         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1316         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1317         16  FILLER                         PIC X.
  1318         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1319             20  CF-ST-BENEFIT-CD           PIC XX.
  1320             20  CF-ST-BENEFIT-KIND         PIC X.
  1321                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1322                 88  CF-ST-AH-KIND              VALUE 'A'.
  1323             20  CF-ST-REM-TERM-CALC        PIC X.
  1324                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1325                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1326                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1327                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1328                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1329                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1330                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1331                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1332
  1333             20  CF-ST-REFUND-CALC          PIC X.
  1334                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1335                 88  ST-REFD-BY-R78             VALUE '1'.
  1336                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1337                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1338                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1339                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1340                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1341                 88  ST-REFD-UTAH               VALUE '7'.
  1342                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1343                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1344                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1345
  1346             20  CF-ST-EARNING-CALC         PIC X.
  1347                 88  ST-EARNING-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  25
* EL201.cbl
  1348                 88  ST-EARN-BY-R78             VALUE '1'.
  1349                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1350                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1351                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1352                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1353                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1354                 88  ST-EARN-MEAN               VALUE '8'.
  1355                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1356
  1357             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1358                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1359                 88  ST-OVRD-BY-R78             VALUE '1'.
  1360                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1361                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1362                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1363                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1364                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1365                 88  ST-OVRD-MEAN               VALUE '8'.
  1366                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1367             20  cf-st-extra-periods        pic 9.
  1368*            20  FILLER                     PIC X.
  1369
  1370         16  CF-ST-COMMISSION-CAPS.
  1371             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1372             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1373             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1374             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1375         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1376                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1377
  1378         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1379
  1380         16  CF-ST-STATUTORY-INTEREST.
  1381             20  CF-ST-STAT-DATE-FROM       PIC X.
  1382                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1383                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1384             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1385             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1386             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1387             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1388             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1389
  1390         16  CF-ST-OVER-SHORT.
  1391             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1392             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1393
  1394         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1395
  1396         16  CF-ST-RT-CALC                  PIC X.
  1397
  1398         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1399         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1400         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1401         16  CF-ST-RF-LR-CALC               PIC X.
  1402         16  CF-ST-RF-LL-CALC               PIC X.
  1403         16  CF-ST-RF-LN-CALC               PIC X.
  1404         16  CF-ST-RF-AH-CALC               PIC X.
  1405         16  CF-ST-RF-CP-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  26
* EL201.cbl
  1406*        16  FILLER                         PIC X(206).
  1407*CIDMOD         16  FILLER                         PIC X(192).
  1408         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1409             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1410         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1411         16  CF-ST-VFY-2ND-BENE             PIC X.
  1412         16  CF-ST-CAUSAL-STATE             PIC X.
  1413         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1414         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1415         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1416             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1417         16  CF-ST-NET-ONLY-STATE           PIC X.
  1418             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1419         16  FILLER                         PIC X(181).
  1420
  1421****************************************************************
  1422*             BENEFIT MASTER RECORD                            *
  1423****************************************************************
  1424
  1425     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1426         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1427             20  CF-BENEFIT-CODE            PIC XX.
  1428             20  CF-BENEFIT-NUMERIC  REDEFINES
  1429                 CF-BENEFIT-CODE            PIC XX.
  1430             20  CF-BENEFIT-ALPHA           PIC XXX.
  1431             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1432             20  CF-BENEFIT-COMMENT         PIC X(10).
  1433
  1434             20  CF-LF-COVERAGE-TYPE        PIC X.
  1435                 88  CF-REDUCING                VALUE 'R'.
  1436                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1437
  1438             20  CF-SPECIAL-CALC-CD         PIC X.
  1439                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1440                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1441                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1442                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1443                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1444                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1445                 88  CF-FARM-PLAN               VALUE 'F'.
  1446                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1447                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1448                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1449                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1450                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1451                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1452                 88  CF-PRUDENTIAL              VALUE 'P'.
  1453                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1454                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1455                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1456                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1457                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1458                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1459
  1460             20  CF-JOINT-INDICATOR         PIC X.
  1461                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1462
  1463*            20  FILLER                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  27
* EL201.cbl
  1464             20  cf-maximum-benefits        pic s999 comp-3.
  1465             20  FILLER                     PIC X(09).
  1466             20  CF-BENEFIT-CATEGORY        PIC X.
  1467             20  CF-LOAN-TYPE               PIC X(8).
  1468
  1469             20  CF-CO-REM-TERM-CALC        PIC X.
  1470                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1471                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1472                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1473                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1474                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1475
  1476             20  CF-CO-EARNINGS-CALC        PIC X.
  1477                 88  CO-EARN-BY-R78             VALUE '1'.
  1478                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1479                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1480                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1481                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1482                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1483                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1484                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1485
  1486             20  CF-CO-REFUND-CALC          PIC X.
  1487                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1488                 88  CO-REFD-BY-R78             VALUE '1'.
  1489                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1490                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1491                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1492                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1493                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1494                 88  CO-REFD-MEAN               VALUE '8'.
  1495                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1496                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1497                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1498
  1499             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1500                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1501                 88  CO-OVRD-BY-R78             VALUE '1'.
  1502                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1503                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1504                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1505                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1506                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1507                 88  CO-OVRD-MEAN               VALUE '8'.
  1508                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1509
  1510             20  CF-CO-BEN-I-G-CD           PIC X.
  1511                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1512                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1513                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1514
  1515         16  FILLER                         PIC X(304).
  1516
  1517
  1518****************************************************************
  1519*             CARRIER MASTER RECORD                            *
  1520****************************************************************
  1521
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  28
* EL201.cbl
  1522     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1523         16  CF-ADDRESS-DATA.
  1524             20  CF-MAIL-TO-NAME            PIC X(30).
  1525             20  CF-IN-CARE-OF              PIC X(30).
  1526             20  CF-ADDRESS-LINE-1          PIC X(30).
  1527             20  CF-ADDRESS-LINE-2          PIC X(30).
  1528             20  CF-CITY-STATE              PIC X(30).
  1529             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1530             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1531
  1532         16  CF-CLAIM-NO-CONTROL.
  1533             20  CF-CLAIM-NO-METHOD         PIC X.
  1534                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1535                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1536                 88  CLAIM-NO-SEQ               VALUE '3'.
  1537                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1538             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1539                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1540                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1541                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1542
  1543         16  CF-CHECK-NO-CONTROL.
  1544             20  CF-CHECK-NO-METHOD         PIC X.
  1545                 88  CHECK-NO-MANUAL            VALUE '1'.
  1546                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1547                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1548                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1549             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1550                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1551
  1552         16  CF-DOMICILE-STATE              PIC XX.
  1553
  1554         16  CF-EXPENSE-CONTROLS.
  1555             20  CF-EXPENSE-METHOD          PIC X.
  1556                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1557                 88  DOLLARS-PER-PMT            VALUE '2'.
  1558                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1559                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1560             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1561             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1562
  1563         16  CF-CORRESPONDENCE-CONTROL.
  1564             20  CF-LETTER-RESEND-OPT       PIC X.
  1565                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1566                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1567             20  FILLER                     PIC X(4).
  1568
  1569         16  CF-RESERVE-CONTROLS.
  1570             20  CF-MANUAL-SW               PIC X.
  1571                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1572             20  CF-FUTURE-SW               PIC X.
  1573                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1574             20  CF-PTC-SW                  PIC X.
  1575                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1576             20  CF-IBNR-SW                 PIC X.
  1577                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1578             20  CF-PTC-LF-SW               PIC X.
  1579                 88  CF-LF-PTC-USED             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  29
* EL201.cbl
  1580             20  CF-CDT-ACCESS-METHOD       PIC X.
  1581                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1582                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1583                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1584             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1585
  1586         16  CF-CLAIM-CALC-METHOD           PIC X.
  1587             88  360-PLUS-MONTHS                VALUE '1'.
  1588             88  365-PLUS-MONTHS                VALUE '2'.
  1589             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1590             88  360-DAILY                      VALUE '4'.
  1591             88  365-DAILY                      VALUE '5'.
  1592
  1593         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1594         16  FILLER                         PIC X(11).
  1595
  1596         16  CF-LIMIT-AMOUNTS.
  1597             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1598             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1599             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1600             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1601             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1602             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1603             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1604             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1605             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1606             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1607
  1608         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1609         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1610         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1611
  1612         16  CF-ZIP-CODE.
  1613             20  CF-ZIP-PRIME.
  1614                 24  CF-ZIP-1ST             PIC X.
  1615                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1616                 24  FILLER                 PIC X(4).
  1617             20  CF-ZIP-PLUS4               PIC X(4).
  1618         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1619             20  CF-CAN-POSTAL-1            PIC XXX.
  1620             20  CF-CAN-POSTAL-2            PIC XXX.
  1621             20  FILLER                     PIC XXX.
  1622
  1623         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1624         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1625         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1626
  1627         16  CF-RATING-SWITCH               PIC X.
  1628             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1629             88  CF-NO-RATING                   VALUE 'N'.
  1630
  1631         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1632
  1633         16  CF-CARRIER-OVER-SHORT.
  1634             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1635             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1636
  1637         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  30
* EL201.cbl
  1638         16  CF-SECPAY-SWITCH               PIC X.
  1639             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1640             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1641         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1642         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1643         16  FILLER                         PIC X(444).
  1644*        16  FILLER                         PIC X(452).
  1645
  1646
  1647****************************************************************
  1648*             MORTALITY MASTER RECORD                          *
  1649****************************************************************
  1650
  1651     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1652         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1653                                INDEXED BY CF-MORT-NDX.
  1654             20  CF-MORT-TABLE              PIC X(5).
  1655             20  CF-MORT-TABLE-TYPE         PIC X.
  1656                 88  CF-MORT-JOINT              VALUE 'J'.
  1657                 88  CF-MORT-SINGLE             VALUE 'S'.
  1658                 88  CF-MORT-COMBINED           VALUE 'C'.
  1659                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1660                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1661             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1662             20  CF-MORT-AGE-METHOD         PIC XX.
  1663                 88  CF-AGE-LAST                VALUE 'AL'.
  1664                 88  CF-AGE-NEAR                VALUE 'AN'.
  1665             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1666             20  CF-MORT-ADJUSTMENT-DIRECTION
  1667                                            PIC X.
  1668                 88  CF-MINUS                   VALUE '-'.
  1669                 88  CF-PLUS                    VALUE '+'.
  1670             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1671             20  CF-MORT-JOINT-CODE         PIC X.
  1672                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1673             20  CF-MORT-PC-Q               PIC X.
  1674                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1675             20  CF-MORT-TABLE-CODE         PIC X(4).
  1676             20  CF-MORT-COMMENTS           PIC X(15).
  1677             20  FILLER                     PIC X(14).
  1678
  1679         16  FILLER                         PIC X(251).
  1680
  1681
  1682****************************************************************
  1683*             BUSSINESS TYPE MASTER RECORD                     *
  1684****************************************************************
  1685
  1686     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1687* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1688* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1689* AND RECORD 05 IS TYPES 81-99
  1690         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1691             20  CF-BUSINESS-TITLE          PIC  X(19).
  1692             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1693                                            PIC S9V9(4) COMP-3.
  1694             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1695             20  FILLER                     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  31
* EL201.cbl
  1696         16  FILLER                         PIC  X(248).
  1697
  1698
  1699****************************************************************
  1700*             TERMINAL MASTER RECORD                           *
  1701****************************************************************
  1702
  1703     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1704
  1705         16  CF-COMPANY-TERMINALS.
  1706             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1707                                  PIC X(4).
  1708         16  FILLER               PIC X(248).
  1709
  1710
  1711****************************************************************
  1712*             LIFE EDIT MASTER RECORD                          *
  1713****************************************************************
  1714
  1715     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1716         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1717             20  CF-LIFE-CODE-IN            PIC XX.
  1718             20  CF-LIFE-CODE-OUT           PIC XX.
  1719         16  FILLER                         PIC X(248).
  1720
  1721
  1722****************************************************************
  1723*             AH EDIT MASTER RECORD                            *
  1724****************************************************************
  1725
  1726     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1727         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1728             20  CF-AH-CODE-IN              PIC XXX.
  1729             20  CF-AH-CODE-OUT             PIC XX.
  1730         16  FILLER                         PIC X(248).
  1731
  1732
  1733****************************************************************
  1734*             CREDIBILITY TABLES                               *
  1735****************************************************************
  1736
  1737     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1738         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1739                             INDEXED BY CF-CRDB-NDX.
  1740             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1741             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1742             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1743         16  FILLER                         PIC  X(332).
  1744
  1745
  1746****************************************************************
  1747*             REPORT CUSTOMIZATION RECORD                      *
  1748****************************************************************
  1749
  1750     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1751         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1752             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1753             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  32
* EL201.cbl
  1754             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1755**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1756****       A T-TRANSFER.                                   ****
  1757             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1758
  1759         16  FILLER                         PIC XX.
  1760
  1761         16  CF-CARRIER-CNTL-OPT.
  1762             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1763                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1764                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1765             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1766                                            PIC X.
  1767         16  CF-GROUP-CNTL-OPT.
  1768             20  CF-GROUP-OPT-SEQ           PIC 9.
  1769                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1770                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1771             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1772                                            PIC X(6).
  1773         16  CF-STATE-CNTL-OPT.
  1774             20  CF-STATE-OPT-SEQ           PIC 9.
  1775                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1776                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1777             20  CF-STATE-SELECT OCCURS 3 TIMES
  1778                                            PIC XX.
  1779         16  CF-ACCOUNT-CNTL-OPT.
  1780             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1781                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1782                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1783             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1784                                            PIC X(10).
  1785         16  CF-BUS-TYP-CNTL-OPT.
  1786             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1787                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1788                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1789             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1790                                            PIC XX.
  1791         16  CF-LF-TYP-CNTL-OPT.
  1792             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1793                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1794                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1795             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1796                                            PIC XX.
  1797         16  CF-AH-TYP-CNTL-OPT.
  1798             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1799                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1800                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1801             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1802                                            PIC XX.
  1803         16  CF-REPTCD1-CNTL-OPT.
  1804             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1805                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1806                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1807             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1808                                            PIC X(10).
  1809         16  CF-REPTCD2-CNTL-OPT.
  1810             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1811                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  33
* EL201.cbl
  1812                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1813             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1814                                            PIC X(10).
  1815         16  CF-USER1-CNTL-OPT.
  1816             20  CF-USER1-OPT-SEQ           PIC 9.
  1817                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1818                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1819             20  CF-USER1-SELECT OCCURS 3 TIMES
  1820                                            PIC X(10).
  1821         16  CF-USER2-CNTL-OPT.
  1822             20  CF-USER2-OPT-SEQ           PIC 9.
  1823                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1824                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1825             20  CF-USER2-SELECT OCCURS 3 TIMES
  1826                                            PIC X(10).
  1827         16  CF-USER3-CNTL-OPT.
  1828             20  CF-USER3-OPT-SEQ           PIC 9.
  1829                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1830                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1831             20  CF-USER3-SELECT OCCURS 3 TIMES
  1832                                            PIC X(10).
  1833         16  CF-USER4-CNTL-OPT.
  1834             20  CF-USER4-OPT-SEQ           PIC 9.
  1835                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1836                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1837             20  CF-USER4-SELECT OCCURS 3 TIMES
  1838                                            PIC X(10).
  1839         16  CF-USER5-CNTL-OPT.
  1840             20  CF-USER5-OPT-SEQ           PIC 9.
  1841                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1842                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1843             20  CF-USER5-SELECT OCCURS 3 TIMES
  1844                                            PIC X(10).
  1845         16  CF-REINS-CNTL-OPT.
  1846             20  CF-REINS-OPT-SEQ           PIC 9.
  1847                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1848                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1849             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1850                 24  CF-REINS-PRIME         PIC XXX.
  1851                 24  CF-REINS-SUB           PIC XXX.
  1852
  1853         16  CF-AGENT-CNTL-OPT.
  1854             20  CF-AGENT-OPT-SEQ           PIC 9.
  1855                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1856                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1857             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1858                                            PIC X(10).
  1859
  1860         16  FILLER                         PIC X(43).
  1861
  1862         16  CF-LOSS-RATIO-SELECT.
  1863             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1864             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1865         16  CF-ENTRY-DATE-SELECT.
  1866             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1867             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1868         16  CF-EFFECTIVE-DATE-SELECT.
  1869             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  34
* EL201.cbl
  1870             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1871
  1872         16  CF-EXCEPTION-LIST-IND          PIC X.
  1873             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1874
  1875         16  FILLER                         PIC X(318).
  1876
  1877****************************************************************
  1878*                  EXCEPTION REPORTING RECORD                  *
  1879****************************************************************
  1880
  1881     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1882         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1883             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1884
  1885         16  CF-COMBINED-LIFE-AH-OPT.
  1886             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1887             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1888             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1889             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1890
  1891         16  CF-LIFE-OPT.
  1892             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1893             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1894             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1895             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1896             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1897             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1898             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1899             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1900             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1901             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1902
  1903         16  CF-AH-OPT.
  1904             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1905             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1906             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1907             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1908             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1909             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1910             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1911             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1912             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1913             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1914
  1915         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1916             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1917             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1918             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1919
  1920         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1921
  1922         16  FILLER                         PIC X(673).
  1923
  1924
  1925****************************************************************
  1926*             MORTGAGE SYSTEM PLAN RECORD                      *
  1927****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  35
* EL201.cbl
  1928
  1929     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1930         16  CF-PLAN-TYPE                   PIC X.
  1931             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1932             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1933             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1934         16  CF-PLAN-ABBREV                 PIC XXX.
  1935         16  CF-PLAN-DESCRIPT               PIC X(10).
  1936         16  CF-PLAN-NOTES                  PIC X(20).
  1937         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1938         16  CF-PLAN-UNDERWRITING.
  1939             20  CF-PLAN-TERM-DATA.
  1940                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1941                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1942             20  CF-PLAN-AGE-DATA.
  1943                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1944                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1945                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1946             20  CF-PLAN-BENEFIT-DATA.
  1947                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1948                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1949                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1950                                            PIC S9(7)V99  COMP-3.
  1951         16  CF-PLAN-POLICY-FORMS.
  1952             20  CF-POLICY-FORM             PIC X(12).
  1953             20  CF-MASTER-APPLICATION      PIC X(12).
  1954             20  CF-MASTER-POLICY           PIC X(12).
  1955         16  CF-PLAN-RATING.
  1956             20  CF-RATE-CODE               PIC X(5).
  1957             20  CF-SEX-RATING              PIC X.
  1958                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1959                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1960             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1961             20  CF-SUB-STD-TYPE            PIC X.
  1962                 88  CF-PCT-OF-PREM            VALUE '1'.
  1963                 88  CF-PCT-OF-BENE            VALUE '2'.
  1964         16  CF-PLAN-PREM-TOLERANCES.
  1965             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1966             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1967         16  CF-PLAN-PYMT-TOLERANCES.
  1968             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1969             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1970         16  CF-PLAN-MISC-DATA.
  1971             20  FILLER                     PIC X.
  1972             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1973             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1974         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1975         16  CF-PLAN-IND-GRP                PIC X.
  1976             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1977                                                     '1'.
  1978             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1979                                                     '2'.
  1980         16  CF-MIB-SEARCH-SW               PIC X.
  1981             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1982             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1983             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1984             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1985         16  CF-ALPHA-SEARCH-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  36
* EL201.cbl
  1986             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1987             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1988             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1989             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1990             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1991             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1992             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1993             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1994             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1995             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1996                                                     'A' 'B' 'C'
  1997                                                     'X' 'Y' 'Z'.
  1998         16  CF-EFF-DT-RULE-SW              PIC X.
  1999             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2000             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2001             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2002             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2003             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2004         16  FILLER                         PIC X(4).
  2005         16  CF-HEALTH-QUESTIONS            PIC X.
  2006             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2007         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2008         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2009         16  CF-PLAN-SNGL-JNT               PIC X.
  2010             88  CF-COMBINED-PLAN              VALUE 'C'.
  2011             88  CF-JNT-PLAN                   VALUE 'J'.
  2012             88  CF-SNGL-PLAN                  VALUE 'S'.
  2013         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2014         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2015         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2016         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2017         16  CF-RERATE-CNTL                 PIC  X.
  2018             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2019             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2020             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2021             88  CF-AUTO-RECALC                 VALUE '4'.
  2022         16  CF-BENEFIT-TYPE                PIC  X.
  2023             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2024             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2025         16  CF-POLICY-FEE                  PIC S999V99
  2026                                                    COMP-3.
  2027         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2028         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2029         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2030         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2031         16  FILLER                         PIC  X(32).
  2032         16  CF-TERMINATION-FORM            PIC  X(04).
  2033         16  FILLER                         PIC  X(08).
  2034         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2035                                                       COMP-3.
  2036         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2037         16  CF-ISSUE-LETTER                PIC  X(4).
  2038         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2039         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2040             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2041             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2042         16  CF-MP-REFUND-CALC              PIC X.
  2043             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  37
* EL201.cbl
  2044             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2045             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2046             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2047             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2048             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2049             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2050             88  CF-MP-REFD-MEAN                VALUE '8'.
  2051         16  CF-ALT-RATE-CODE               PIC  X(5).
  2052
  2053
  2054         16  FILLER                         PIC X(498).
  2055****************************************************************
  2056*             MORTGAGE COMPANY MASTER RECORD                   *
  2057****************************************************************
  2058
  2059     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2060         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2061         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2062             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2063             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2064             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2065             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2066             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2067
  2068         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2069         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2070         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2071         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2072         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2073
  2074         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2075             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2076         16  CF-MP-RECON-USE-IND            PIC X(1).
  2077             88  CF-MP-USE-RECON             VALUE 'Y'.
  2078         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2079             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2080         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2081             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2082             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2083         16  FILLER                         PIC X(1).
  2084         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2085             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2086         16  CF-MORTG-MIB-VERSION           PIC X.
  2087             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2088             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2089             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2090         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2091             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2092                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2093             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2094                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2095             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2096                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2097             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2098                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2099             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2100                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2101             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  38
* EL201.cbl
  2102                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2103         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2104         16  FILLER                         PIC X(7).
  2105         16  CF-MORTG-DESTINATION-SYMBOL.
  2106             20  CF-MORTG-MIB-COMM          PIC X(5).
  2107             20  CF-MORTG-MIB-TERM          PIC X(5).
  2108         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2109             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2110         16  FILLER                         PIC X(03).
  2111         16  CF-MP-CHECK-NO-CONTROL.
  2112             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2113                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2114                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2115                                                ' ' LOW-VALUES.
  2116                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2117                                               VALUE '3'.
  2118         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2119         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2120         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2121             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2122                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2123             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2124                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2125             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2126                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2127             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2128                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2129             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2130                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2131             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2132                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2133         16  CF-MORTG-BILLING-AREA.
  2134             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2135                                            PIC X.
  2136         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2137         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2138         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2139         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2140             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2141             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2142         16  FILLER                         PIC X.
  2143         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2144             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2145             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2146         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2147         16  FILLER                         PIC X(8).
  2148         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2149         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2150         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2151         16  CF-ACH-COMPANY-ID.
  2152             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2153                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2154                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2155                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2156             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2157         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2158             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2159         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  39
* EL201.cbl
  2160             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2161             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2162         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2163         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2164         16  FILLER                         PIC X(536).
  2165
  2166****************************************************************
  2167*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2168****************************************************************
  2169
  2170     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2171         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2172             20  CF-FEMALE-HEIGHT.
  2173                 24  CF-FEMALE-FT           PIC 99.
  2174                 24  CF-FEMALE-IN           PIC 99.
  2175             20  CF-FEMALE-MIN-WT           PIC 999.
  2176             20  CF-FEMALE-MAX-WT           PIC 999.
  2177         16  FILLER                         PIC X(428).
  2178
  2179     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2180         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2181             20  CF-MALE-HEIGHT.
  2182                 24  CF-MALE-FT             PIC 99.
  2183                 24  CF-MALE-IN             PIC 99.
  2184             20  CF-MALE-MIN-WT             PIC 999.
  2185             20  CF-MALE-MAX-WT             PIC 999.
  2186         16  FILLER                         PIC X(428).
  2187******************************************************************
  2188*             AUTOMATIC ACTIVITY RECORD                          *
  2189******************************************************************
  2190     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2191         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2192             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2193             20  CF-SYS-LETTER-ID           PIC X(04).
  2194             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2195             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2196             20  CF-SYS-RESET-SW            PIC X(01).
  2197             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2198             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2199
  2200         16  FILLER                         PIC X(50).
  2201
  2202         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2203             20  CF-USER-ACTIVE-SW          PIC X(01).
  2204             20  CF-USER-LETTER-ID          PIC X(04).
  2205             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2206             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2207             20  CF-USER-RESET-SW           PIC X(01).
  2208             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2209             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2210             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2211
  2212         16  FILLER                         PIC X(246).
  2213 01  ws-heading1.
  2214     05  ws-head1                pic x(120)  value '
  2215-     '                                   DAILY CHECK RECONCILIATI
  2216-     'ON                                            '.
  2217     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  40
* EL201.cbl
  2218 01  ws-heading2.
  2219     05  filler                  pic x(51) value spaces.
  2220     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
  2221     05  WS-H2-DATE              PIC X(10).
  2222     05  ws-h2-time              pic x(8).
  2223 01  ws-heading3.
  2224     05  filler                  pic x(53) value spaces.
  2225     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2226     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2227     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2228 01  ws-heading4.
  2229     05  filler                  pic x(117)   value ' CAR  GROUP
  2230-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2231-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2232 01  ws-hd1-written.
  2233     05  filler                  pic x(120)  value '
  2234-     '                                   DAILY WRITTEN CHECKS REP
  2235-     'ORT                                           '.
  2236 01  ws-hd4-written.
  2237     05  filler                  pic x(117)   value ' CAR  GROUP
  2238-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2239-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2240 01  ws-detail1.
  2241     05  filler                  pic xx value '  '.
  2242     05  ws-d1-carr              pic x(4) value spaces.
  2243     05  ws-d1-grp               pic x(7) value spaces.
  2244     05  ws-d1-state             pic x(4) value spaces.
  2245     05  ws-d1-account           pic x(12) value spaces.
  2246     05  ws-d1-eff-dt            pic x(12) value spaces.
  2247     05  ws-d1-cert-no           pic x(14) value spaces.
  2248     05  ws-d1-chk-type          pic x(5) value spaces.
  2249     05  ws-d1-chk-no            pic x(12) value spaces.
  2250     05  f                       pic xx value spaces.
  2251     05  ws-d1-writ-cash-dt      pic x(16) value spaces.
  2252     05  ws-d1-preparer          pic x(8) value spaces.
  2253     05  ws-d1-chk-amt-a         pic x(10) value spaces.
  2254     05  ws-d1-chk-amt redefines
  2255         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2256     05  filler                  pic xx value spaces.
  2257     05  ws-d1-message           pic x(20) value spaces.
  2258 01  ws-detail2.
  2259     05  filler                  pic x(12) value '    PAYEE - '.
  2260     05  ws-d2-addr-line         pic x(120) value spaces.
  2261 01  ws-total1.
  2262     05  filler                  pic x(5) value '     '.
  2263     05  ws-t1-cnt               pic zzzz9  value zeros.
  2264     05  ws-t1-chks              pic x(24)  value spaces.
  2265     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2266 01  w-doctoken                  pic x(16).
  2267 01 output-data.
  2268    05  filler                   pic x(6) value "TITLE=".
  2269    05  output-title             pic x(26) value 'Check Posting'.
  2270    05  filler                   pic x(8) value "&COMPID=".
  2271    05  out-comp-id              pic xxx.
  2272    05  filler                   pic x(5) value "&MSG=".
  2273    05  output-msg               pic x(50).
  2274 01  tran-data-line1             pic x(80) value spaces.
  2275 01  tran-data-line2             pic x(80) value spaces.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  41
* EL201.cbl
  2276* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2277**    'cd /apps/prod/cid1p/jcl'.
  2278*      'cd /apps/test/ahltst/jcl'.
  2279* 01  TRAN-DATA-LINE2.
  2280*     05  filler                  pic x(10) value 'unikixjob '.
  2281*     05  tdl2-job                pic x(8) value 'cilg201b'.
  2282**    05  filler                  pic x(9) value ' -k cid1p'.
  2283*     05  filler                  pic x(10) value ' -k ahltst'.
  2284*     05  filler                  pic x(50) value spaces.
  2285****************************************************************
  2286*
  2287* Copyright (c) 2007-2013 Dell Inc.
  2288* All rights reserved.
  2289*
  2290****************************************************************
  2291 01  DFHEIV.
  2292   02  DFHEIV0               PIC X(35).
  2293   02  DFHEIV1               PIC X(08).
  2294   02  DFHEIV2               PIC X(08).
  2295   02  DFHEIV3               PIC X(08).
  2296   02  DFHEIV4               PIC X(06).
  2297   02  DFHEIV5               PIC X(04).
  2298   02  DFHEIV6               PIC X(04).
  2299   02  DFHEIV7               PIC X(02).
  2300   02  DFHEIV8               PIC X(02).
  2301   02  DFHEIV9               PIC X(01).
  2302   02  DFHEIV10              PIC S9(7) COMP-3.
  2303   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2304   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2305   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2306   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2307   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2308   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2309   02  DFHEIV17              PIC X(04).
  2310   02  DFHEIV18              PIC X(04).
  2311   02  DFHEIV19              PIC X(04).
  2312   02  DFHEIV20              USAGE IS POINTER.
  2313   02  DFHEIV21              USAGE IS POINTER.
  2314   02  DFHEIV22              USAGE IS POINTER.
  2315   02  DFHEIV23              USAGE IS POINTER.
  2316   02  DFHEIV24              USAGE IS POINTER.
  2317   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2318   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2319   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2320   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2321   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2322   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2323   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2324   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2325   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2326   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2327   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2328   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2329   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2330   02  FILLER                PIC X(02).
  2331   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2332   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2333   02  DFHEIVL1              PIC X(48) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  42
* EL201.cbl
  2334   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2335   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2336   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2337   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2338 LINKAGE  SECTION.
  2339*****************************************************************
  2340*                                                               *
  2341* Copyright (c) 2007-2013 Dell Inc.                             *
  2342* All rights reserved.                                          *
  2343*                                                               *
  2344*****************************************************************
  2345 01  dfheiblk.
  2346     02  eibtime          pic s9(7) comp-3.
  2347     02  eibdate          pic s9(7) comp-3.
  2348     02  eibtrnid         pic x(4).
  2349     02  eibtaskn         pic s9(7) comp-3.
  2350     02  eibtrmid         pic x(4).
  2351     02  dfheigdi         pic s9(4) comp.
  2352     02  eibcposn         pic s9(4) comp.
  2353     02  eibcalen         pic s9(4) comp.
  2354     02  eibaid           pic x(1).
  2355     02  eibfiller1       pic x(1).
  2356     02  eibfn            pic x(2).
  2357     02  eibfiller2       pic x(2).
  2358     02  eibrcode         pic x(6).
  2359     02  eibfiller3       pic x(2).
  2360     02  eibds            pic x(8).
  2361     02  eibreqid         pic x(8).
  2362     02  eibrsrce         pic x(8).
  2363     02  eibsync          pic x(1).
  2364     02  eibfree          pic x(1).
  2365     02  eibrecv          pic x(1).
  2366     02  eibsend          pic x(1).
  2367     02  eibatt           pic x(1).
  2368     02  eibeoc           pic x(1).
  2369     02  eibfmh           pic x(1).
  2370     02  eibcompl         pic x(1).
  2371     02  eibsig           pic x(1).
  2372     02  eibconf          pic x(1).
  2373     02  eiberr           pic x(1).
  2374     02  eibrldbk         pic x(1).
  2375     02  eiberrcd         pic x(4).
  2376     02  eibsynrb         pic x(1).
  2377     02  eibnodat         pic x(1).
  2378     02  eibfiller5       pic x(2).
  2379     02  eibresp          pic s9(8) comp.
  2380     02  eibresp2         pic s9(8) comp.
  2381     02  dfheigdj         pic s9(4) comp.
  2382     02  dfheigdk         pic s9(4) comp.
  2383 01  DFHCOMMAREA       PIC X(01).
  2384 01  VAR                         PIC X(30).
  2385 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2386 0000-DFHEXIT SECTION.
  2387     MOVE '9#                    $   ' TO DFHEIV0.
  2388     MOVE 'EL201' TO DFHEIV1.
  2389     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2390***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2391***                                                            ***
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  43
* EL201.cbl
  2392***  Even though this program is using WEB Servies we don't    ***
  2393***  have any form fields to browse through, we are getting    ***
  2394***  the information we need through the variables that are    ***
  2395***  included in the URL. These variables are retrieved by     ***
  2396***  the           exec cics web extract                       ***
  2397***                   querystring  (data-value)                ***
  2398***                   querystrlen  (data-value)                ***
  2399***                end-exec                                    ***
  2400***  BTW, you must provide the length it isn't passed to you.  ***
  2401***  Allow for extra on the length or you will get a length    ***
  2402***  error instead of just truncation.                         ***
  2403***                                                            ***
  2404***  This program is expecting                                 ***
  2405*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2406*** http://slunikix:7003/cics/cwba/EL201?comp=CID&file=written***
  2407*** http://logictest:6007/cics/cwba/EL201?comp=CID&file=written***
  2408***                                                            ***
  2409***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2410     display ' Entering program EL201 '
  2411     set P to address of KIXSYS
  2412     CALL "getenv" using by value P returning var-ptr
  2413     if var-ptr = null then
  2414        display ' kixsys not set '
  2415     else
  2416        set address of var to var-ptr
  2417        move 0 to env-var-len
  2418        inspect var tallying env-var-len
  2419          for characters before X'00'
  2420        unstring var (1:env-var-len) delimited by '/'
  2421           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2422              WS-KIX-SYS
  2423        end-unstring
  2424     end-if
  2425     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2426     move ws-fn-cymd             to dc-greg-date-cymd
  2427     move 'L'                    to dc-option-code
  2428     perform 9700-date-convert   thru 9700-exit
  2429     if no-conversion-error
  2430        move dc-greg-date-1-alpha to ws-h3-date
  2431        move dc-greg-date-1-edit to ws-h2-date
  2432     else
  2433        display ' error current dt invalid ' dc-error-code
  2434     end-if
  2435     string ws-fn-hours   ':'
  2436            ws-fn-minutes ':'
  2437            ws-fn-seconds
  2438        delimited by size into ws-h2-time
  2439     end-string
  2440
  2441* exec cics web extract
  2442*       querystring  (ws-qry-string)
  2443*       querystrlen  (ws-qrystr-len)
  2444*    end-exec
  2445*    MOVE 'X0  QL                .   #00002343' TO DFHEIV0
  2446     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2447     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2448     MOVE X'2020233030303032333433' TO DFHEIV0(25:11)
  2449     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  44
* EL201.cbl
  2450           DFHEIV99,
  2451           DFHEIV99,
  2452           ws-qry-string,
  2453           ws-qrystr-len,
  2454           DFHEIV99,
  2455           DFHEIV99,
  2456           DFHEIV99,
  2457           DFHEIV99,
  2458           DFHEIV99,
  2459           DFHEIV99,
  2460           DFHEIV99,
  2461           DFHEIV99,
  2462           DFHEIV99
  2463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2464     move ws-qry-string (6:3)    to ws-comp-id
  2465                                    out-comp-id
  2466     move 'Successful Run   '    to output-msg
  2467     move ws-comp-id             to elcntl-key
  2468     move '1'                    to elcntl-rec-type
  2469     move +0                     to elcntl-seq
  2470
  2471* exec cics read
  2472*       dataset  ('ELCNTL')
  2473*       into     (control-file)
  2474*       ridfld   (elcntl-key)
  2475*       resp     (ws-response)
  2476*    end-exec
  2477     MOVE LENGTH OF
  2478      control-file
  2479       TO DFHEIV11
  2480     MOVE 'ELCNTL' TO DFHEIV1
  2481*    MOVE '&"IL       E          (  N#00002353' TO DFHEIV0
  2482     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2484     MOVE X'204E233030303032333533' TO DFHEIV0(25:11)
  2485     CALL 'kxdfhei1' USING DFHEIV0,
  2486           DFHEIV1,
  2487           control-file,
  2488           DFHEIV11,
  2489           elcntl-key,
  2490           DFHEIV99,
  2491           DFHEIV99,
  2492           DFHEIV99
  2493     MOVE EIBRESP  TO ws-response
  2494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2495     if resp-normal
  2496        move cf-cl-mail-to-name  to ws-h2-client-name
  2497        move cf-company-cd       to ws-comp-cd
  2498     else
  2499        move 'Company Rec not found ' to ws-h2-client-name
  2500                                         output-msg
  2501        display ' error elcntl read ' ws-response ' '
  2502           elcntl-key (1:8)
  2503        go to 0000-return
  2504     end-if
  2505     evaluate true
  2506        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2507           set process-written      to true
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  45
* EL201.cbl
  2508           perform 2000-process-written
  2509                                 thru 2000-exit
  2510        when other
  2511           move 'Invalid File ' to output-msg
  2512     end-evaluate
  2513     if connected-to-db
  2514        EXEC SQL
  2515            commit work release
  2516        END-EXEC
  2517        if sqlcode not = 0
  2518           move ' Failed to Commit DB '
  2519                                 to output-msg
  2520           display "Error: commit release "
  2521           display ' sql return code ' sqlcode
  2522           display ' sql err mess    ' sqlerrmc
  2523        end-if
  2524     end-if
  2525     .
  2526 0000-return.
  2527     perform 1030-send-form      thru 1030-exit
  2528
  2529* exec cics
  2530*       return
  2531*    end-exec
  2532*    MOVE '.(                    ''   #00002392' TO DFHEIV0
  2533     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2535     MOVE X'2020233030303032333932' TO DFHEIV0(25:11)
  2536     CALL 'kxdfhei1' USING DFHEIV0,
  2537           DFHEIV99,
  2538           DFHEIV99,
  2539           DFHEIV99,
  2540           DFHEIV99,
  2541           DFHEIV99,
  2542           DFHEIV99
  2543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2544     .
  2545 1000-CONNECT-DB.
  2546     string
  2547         usr delimited space
  2548         "." delimited size
  2549         pass delimited space into usr-pass
  2550     end-string
  2551     EXEC SQL
  2552        CONNECT TO :svr USER :usr-pass
  2553     END-EXEC
  2554     if sqlcode not = 0
  2555        display "Error: cannot connect "
  2556        display sqlcode
  2557        display sqlerrmc
  2558        move 'Failed to connect to DB'
  2559                                 to output-msg
  2560        go to 0000-return
  2561     else
  2562        set connected-to-db to true
  2563     end-if
  2564     .
  2565 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  46
* EL201.cbl
  2566     EXIT.
  2567 1020-read-erchek.
  2568     move ws-comp-cd             to ch-company-cd
  2569     move db-carrier             to ch-carrier
  2570     move db-grouping            to ch-grouping
  2571     move db-state               to ch-state
  2572     move db-account             to ch-account
  2573     move db-certificate         to ch-cert-prime
  2574     move db-cert-sfx            to ch-cert-sfx
  2575     string db-effdate (1:4)
  2576            db-effdate (6:2)
  2577            db-effdate (9:2)
  2578        delimited by size into dc-greg-date-cymd-r
  2579     end-string
  2580     move 'L'                    to dc-option-code
  2581     perform 9700-date-convert   thru 9700-exit
  2582     if no-conversion-error
  2583        move dc-bin-date-1       to ch-cert-eff-dt
  2584     else
  2585        display ' error cvtdte eff dt ' db-effdate ' '
  2586           dc-error-code
  2587     end-if
  2588     move zeros                  to ws-seq-alpha
  2589     move +5                     to s2
  2590     perform varying s1 from +5 by -1 until s1 < +1
  2591        if db-seq-no (s1:1) numeric
  2592           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2593           subtract +1 from s2
  2594        end-if
  2595     end-perform
  2596     move ws-seq-no-num          to ch-sequence-no
  2597*    display ' dte   **' db-effdate '**'
  2598*    display ' carrier ' ch-carrier
  2599*    display ' group   ' ch-grouping
  2600*    display ' state   ' ch-state
  2601*    display ' acct    ' ch-account
  2602*    display ' cert  **' ch-cert-no '**'
  2603*    display ' seq     ' ch-sequence-no
  2604
  2605* exec cics read
  2606*       update
  2607*       dataset    ('ERCHEK')
  2608*       into       (check-records)
  2609*       ridfld     (ch-control-primary)
  2610*       resp       (ws-response)
  2611*    end-exec
  2612     MOVE LENGTH OF
  2613      check-records
  2614       TO DFHEIV11
  2615     MOVE 'ERCHEK' TO DFHEIV1
  2616*    MOVE '&"IL       EU         (  N#00002455' TO DFHEIV0
  2617     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2618     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2619     MOVE X'204E233030303032343535' TO DFHEIV0(25:11)
  2620     CALL 'kxdfhei1' USING DFHEIV0,
  2621           DFHEIV1,
  2622           check-records,
  2623           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  47
* EL201.cbl
  2624           ch-control-primary,
  2625           DFHEIV99,
  2626           DFHEIV99,
  2627           DFHEIV99
  2628     MOVE EIBRESP  TO ws-response
  2629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2630     .
  2631 1020-exit.
  2632     exit.
  2633 1030-send-form.
  2634
  2635* exec cics document create
  2636*       doctoken   (w-doctoken)
  2637*       template   ('WCHECKS')
  2638*       symbollist (output-data)
  2639*       listlength (length of output-data)
  2640*    end-exec
  2641     MOVE 'WCHECKS' TO DFHEIV1
  2642     MOVE LENGTH OF
  2643      output-data TO DFHEIV16
  2644*    MOVE '\"D tSL               )   #00002466' TO DFHEIV0
  2645     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2646     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2647     MOVE X'2020233030303032343636' TO DFHEIV0(25:11)
  2648     CALL 'kxdfhei1' USING DFHEIV0,
  2649           w-doctoken,
  2650           DFHEIV99,
  2651           DFHEIV1,
  2652           output-data,
  2653           DFHEIV16,
  2654           DFHEIV99,
  2655           DFHEIV99,
  2656           DFHEIV99
  2657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2658
  2659* exec cics web send
  2660*       doctoken(w-doctoken)
  2661*    end-exec
  2662*    MOVE 'X$D                   *   #00002472' TO DFHEIV0
  2663     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2664     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2665     MOVE X'2020233030303032343732' TO DFHEIV0(25:11)
  2666     CALL 'kxdfhei1' USING DFHEIV0,
  2667           w-doctoken,
  2668           DFHEIV99,
  2669           DFHEIV99,
  2670           DFHEIV99,
  2671           DFHEIV99,
  2672           DFHEIV99,
  2673           DFHEIV99,
  2674           DFHEIV99,
  2675           DFHEIV99
  2676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2677     .
  2678 1030-exit.
  2679     exit.
  2680 1050-disconnect.
  2681     if connected-to-db
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  48
* EL201.cbl
  2682        EXEC SQL
  2683            disconnect all
  2684        END-EXEC
  2685        move ' ' to ws-connect-sw
  2686     end-if
  2687     .
  2688 1050-exit.
  2689     exit.
  2690 2000-process-written.
  2691     perform 2010-open-files     thru 2010-exit
  2692     perform 2020-init           thru 2020-exit
  2693     perform 2050-process-input  thru 2050-exit until
  2694        end-of-input
  2695     if ws-writ-cnt > zeros
  2696        move ws-writ-cnt         to ws-t1-cnt
  2697        move ' Written '         to ws-t1-chks
  2698        move ws-tot-writ-amt     to ws-t1-amount
  2699     else
  2700        perform 4010-write-headings
  2701                                 thru 4010-exit
  2702        move spaces              to ws-total1
  2703        string ' No checks for '
  2704           ws-work-comp-id
  2705           ' today. ' delimited by size into ws-total1
  2706        end-string
  2707     end-if
  2708     move spaces                 to cps-written-rpt-rec
  2709     perform 4020-write-a-line   thru 4020-exit
  2710     move ws-total1              to cps-written-rpt-rec
  2711     perform 4020-write-a-line   thru 4020-exit
  2712     perform 2500-close-files    thru 2500-exit
  2713     perform 5000-submit-job     thru 5000-exit
  2714     .
  2715 2000-exit.
  2716     exit.
  2717 2010-open-files.
  2718     if ws-kix-myenv = 'cid1p'
  2719        move 'NTCSO2_ChkApprv'   to svr
  2720        move 'sa'                to usr
  2721        move 'ntcso2'            to pass
  2722        move '/data/seqfiles/'   to ws-work-dir
  2723        move 'cd /apps/prod/cid1p/jcl'
  2724                                 to tran-data-line1
  2725        move ws-kix-myenv        to ws-work-env
  2726     else
  2727        move 'NTSQLTST2_ChkApprv' to svr
  2728        move 'sa'                to usr
  2729        move 'sql2008r2'         to pass
  2730        move ws-kix-myenv        to ws-work-env
  2731        string
  2732           '/data/test/' delimited by size
  2733           ws-work-env   delimited by space
  2734           '/seqfiles/'  delimited by size
  2735              into ws-work-dir
  2736        end-string
  2737        string
  2738           'cd /apps/test/' delimited by size
  2739           ws-work-env      delimited by space
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  49
* EL201.cbl
  2740           '/jcl'           delimited by size
  2741              into tran-data-line1
  2742        end-string
  2743     end-if
  2744     move function upper-case(ws-comp-id)
  2745                                 to ws-work-comp-id
  2746     move 'miscpymts.csv'        to ws-work-file-in
  2747     move 'cilg201b'             to ws-work-job-name
  2748     if ws-work-comp-id = 'AHL'
  2749        move 'miscpymtsahl.csv'  to ws-work-file-in
  2750        move 'ahlg201b'          to ws-work-job-name
  2751     end-if
  2752     move spaces                 to ws-written-in
  2753                                    ws-written-rpt
  2754     string
  2755        ws-work-dir delimited by space
  2756        ws-work-file-in delimited by space
  2757           into ws-written-in
  2758     end-string
  2759     move 'miscpymts.rpt'        to ws-work-rpt-out
  2760     string
  2761        ws-work-dir delimited by space
  2762        ws-work-comp-id delimited by size
  2763        ws-work-rpt-out delimited by size
  2764           into ws-written-rpt
  2765     end-string
  2766     string
  2767        'unikixjob '     delimited by size
  2768        ws-work-job-name delimited by size
  2769        ' -k '           delimited by size
  2770        ws-work-env      delimited by space
  2771           into tran-data-line2
  2772     end-string
  2773*     display ' svr    ' svr
  2774*     display ' user   ' usr
  2775*     display ' pw     ' pass
  2776*     display ' input  ' ws-written-in
  2777*     display ' output ' ws-written-rpt
  2778*     display ' line 1 ' tran-data-line1
  2779*     display ' line 2 ' tran-data-line2
  2780     open input CPS-WRITTEN-IN
  2781         output CPS-WRITTEN-RPT
  2782     if written-status not = '00'
  2783        display 'error written open ' written-status
  2784        move ' Invalid or missing file '
  2785                                 to output-msg
  2786        go to 0000-return
  2787     end-if
  2788     .
  2789 2010-exit.
  2790     exit.
  2791 2020-init.
  2792     move spaces                 to ws-detail1
  2793     move ws-hd1-written         to ws-head1
  2794     move 'EL201B'               to ws-h1-rpt-id
  2795     move ws-hd4-written         to ws-heading4
  2796     move 'Posting of Written Checks '
  2797                                 to output-title
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  50
* EL201.cbl
  2798*    if ws-comp-id = 'AHL'
  2799*       move 'ahlg201b'          to tdl2-job
  2800*    else
  2801*       move 'cilg201b'          to tdl2-job
  2802*    end-if
  2803     if not connected-to-db
  2804        perform 1000-connect-db  thru 1000-exit
  2805     end-if
  2806***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2807***                                                            ***
  2808**     I do 2 reads to bypass the header record                ***
  2809***                                                            ***
  2810***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2811     perform 2040-read-input     thru 2040-exit
  2812     perform 2040-read-input     thru 2040-exit
  2813     .
  2814 2020-exit.
  2815     exit.
  2816 2040-read-input.
  2817     read CPS-WRITTEN-IN at end
  2818        set end-of-input   to true
  2819     end-read
  2820     if not end-of-input
  2821        add 1 to ws-in-recs
  2822     end-if
  2823     .
  2824 2040-exit.
  2825     exit.
  2826 2050-process-input.
  2827     move spaces                 to ws-raw-record
  2828                                    ws-written-rec
  2829     unstring cps-written-in-rec
  2830        delimited by ',' into
  2831           raw-check-no
  2832           raw-check-dt
  2833           raw-check-amt
  2834           raw-vendor-id
  2835           raw-user-defined
  2836           raw-voucher-ref
  2837     end-unstring
  2838*    display ' chk no    **' wsw-check-no '**'
  2839*    display ' chk dt    **' wsw-check-dt '**'
  2840*    display ' chk amt   **' wsw-check-amt '**'
  2841*    display ' vend id   **' wsw-vendor-id '**'
  2842*    display ' user def  **' wsw-user-defined '**'
  2843*    display ' vouch ref **' wsw-voucher-ref '**'
  2844***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2845***                                                            ***
  2846***    Every now and then I get bogus records with quotes      ***
  2847***  so I am just going to remove them.  These are normally    ***
  2848***  a result of a manual process that should not be included  ***
  2849***  in this file.                                             ***
  2850***                                                            ***
  2851***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2852
  2853     move +1                     to o1
  2854     perform varying i1 from +1 by +1 until i1 > +20
  2855        if raw-check-no (i1:1) <> '"'
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  51
* EL201.cbl
  2856           move raw-check-no (i1:1)
  2857                                 to wsw-check-no (o1:1)
  2858           add +1 to o1
  2859        end-if
  2860     end-perform
  2861
  2862     move +1                     to o1
  2863     perform varying i1 from +1 by +1 until i1 > +20
  2864        if raw-check-dt (i1:1) <> '"'
  2865           move raw-check-dt (i1:1)
  2866                                 to wsw-check-dt (o1:1)
  2867           add +1 to o1
  2868        end-if
  2869     end-perform
  2870
  2871     move +1                     to o1
  2872     perform varying i1 from +1 by +1 until i1 > +15
  2873        if raw-check-amt (i1:1) <> '"'
  2874           move raw-check-amt (i1:1)
  2875                                 to wsw-check-amt (o1:1)
  2876           add +1 to o1
  2877        end-if
  2878     end-perform
  2879
  2880     move +1                     to o1
  2881     perform varying i1 from +1 by +1 until i1 > +20
  2882        if raw-vendor-id (i1:1) <> '"'
  2883           move raw-vendor-id (i1:1)
  2884                                 to wsw-vendor-id (o1:1)
  2885           add +1 to o1
  2886        end-if
  2887     end-perform
  2888
  2889     move +1                     to o1
  2890     perform varying i1 from +1 by +1 until i1 > +30
  2891        if raw-user-defined (i1:1) <> '"'
  2892           move raw-user-defined (i1:1)
  2893                                 to wsw-user-defined (o1:1)
  2894           add +1 to o1
  2895        end-if
  2896     end-perform
  2897
  2898     move +1                     to o1
  2899     perform varying i1 from +1 by +1 until i1 > +35
  2900        if raw-voucher-ref (i1:1) <> '"'
  2901           move raw-voucher-ref (i1:1)
  2902                                 to wsw-voucher-ref (o1:1)
  2903           add +1 to o1
  2904        end-if
  2905     end-perform
  2906     if (wsw-check-no = spaces)
  2907        and (wsw-check-dt = spaces)
  2908        and (wsw-check-amt = spaces)
  2909        display ' empty record ' cps-written-in-rec
  2910        go to 2050-read
  2911     end-if
  2912     string wsw-check-dt (1:4)
  2913            wsw-check-dt (6:2)
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  52
* EL201.cbl
  2914            wsw-check-dt (9:2)
  2915        delimited by size into dc-greg-date-cymd-r
  2916     end-string
  2917     move 'L'                    to dc-option-code
  2918     perform 9700-date-convert   thru 9700-exit
  2919     if no-conversion-error
  2920        move dc-bin-date-1       to ws-bin-check-dt
  2921     else
  2922        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2923           dc-error-code
  2924     end-if
  2925     perform varying s1 from +1 by +1 until
  2926        (s1 > +28)
  2927        or (wsw-voucher-ref (s1:6) = 'REF DI' or 'REFUND' or
  2928          'CANCEL')
  2929     end-perform
  2930     if s1 < +29
  2931        move 'Bypass- Manual Entry'    to ws-d1-message
  2932        move ' '                 to ws-table-sw
  2933        go to 2050-continue
  2934     end-if
  2935*    if wsw-user-defined (1:3) not numeric
  2936*       move 'Bypass- Manual Entry'
  2937*                                to ws-d1-message
  2938*       move ' '                 to ws-table-sw
  2939*       go to 2050-continue
  2940*    end-if
  2941     perform varying s1 from +1 by +1 until
  2942        (s1 > +30)
  2943        or (wsw-user-defined (s1:1) = ' ')
  2944     end-perform
  2945     if (s1 < +12)
  2946        and (s1 > +8)
  2947        continue
  2948     else
  2949        move 'Bypass- Manual Entry'
  2950                                 to ws-d1-message
  2951        move ' '                 to ws-table-sw
  2952        go to 2050-continue
  2953     end-if
  2954     move spaces                 to wsw-check-key
  2955     perform varying s1 from +30 by -1 until
  2956        (s1 < +1)
  2957        or (wsw-user-defined (s1:1) numeric)
  2958     end-perform
  2959     if s1 > +7
  2960        move wsw-user-defined (s1 - 6:7)
  2961                                 to wsw-check-key
  2962     else
  2963        move 'Invalid Input CK-KEY'    to ws-d1-message
  2964        go to 2050-continue
  2965     end-if
  2966*    go to 2050-read
  2967     move ' '                    to ws-erchek-sw
  2968                                    ws-table-sw
  2969     perform 2200-get-tbl-row    thru 2200-exit
  2970     if sqlcode = 0
  2971        set table-found          to true
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  53
* EL201.cbl
  2972        perform 1020-read-erchek thru 1020-exit
  2973        if resp-normal
  2974           set erchek-found to true
  2975           perform 2310-upd-erchek
  2976                                 thru 2310-exit
  2977           perform 2320-upd-table thru 2320-exit
  2978        else
  2979           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2980              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2981              ' ' ws-response
  2982           move ' chk rec not found ' to ws-d1-message
  2983        end-if
  2984     else
  2985        move ' tbl row not found ' to ws-d1-message
  2986     end-if
  2987     .
  2988 2050-continue.
  2989     perform 2400-build-print-line thru 2400-exit
  2990     .
  2991 2050-read.
  2992     perform 2040-read-input     thru 2040-exit
  2993     .
  2994 2050-exit.
  2995     exit.
  2996 2200-get-tbl-row.
  2997***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2998***                                                            ***
  2999***  I'm only expecting one row so no cursor is declared       ***
  3000***                                                            ***
  3001***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3002     move ws-comp-id             to ws-compid
  3003     move wsw-check-key-num      to ws-check-key
  3004     move 1                      to ws-type
  3005     exec sql
  3006        SELECT
  3007           CheckKey,
  3008           Company,
  3009           CertCarrier,
  3010           CertGroup,
  3011           CertState,
  3012           CertAccount,
  3013           CertEffDate,
  3014           CertNumber,
  3015           CertNumberSuf,
  3016           CheckSeqNbr,
  3017           CheckType,
  3018           CheckAmount,
  3019           Preparer,
  3020           CheckSubType
  3021        INTO
  3022           :db-checkkey,
  3023           :db-compid,
  3024           :db-carrier,
  3025           :db-grouping,
  3026           :db-state,
  3027           :db-account,
  3028           :db-effdate,
  3029           :db-certificate,
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  54
* EL201.cbl
  3030           :db-cert-sfx,
  3031           :db-seq-no,
  3032           :db-type,
  3033           :db-amount,
  3034           :db-preparer,
  3035           :db-check-sub-type
  3036        FROM
  3037           ChkApp_Check
  3038        WHERE
  3039           (CheckKey    = :ws-check-key)
  3040           and (Company = :ws-compid)
  3041     end-exec
  3042     if sqlcode not = 0
  3043        move sqlcode to ws-sql-code
  3044        move ws-sql-code to ws-dis-sql-code
  3045        display ' dis sql code ' ws-dis-sql-code
  3046        display "Error: cannot read row "
  3047        display ' sql return code ' sqlcode
  3048        display ' sql err mess    ' sqlerrmc
  3049     end-if
  3050     .
  3051 2200-exit.
  3052     exit.
  3053 2310-upd-erchek.
  3054     move ws-bin-check-dt        to ch-check-written-dt
  3055     if wsw-check-no (1:1) = '"'
  3056        move wsw-check-no (5:7)  to ch-check-no
  3057     else
  3058        move wsw-check-no (4:7)  to ch-check-no
  3059     end-if
  3060*    move zeros                  to ws-response
  3061
  3062* exec cics rewrite
  3063*       dataset     ('ERCHEK')
  3064*       from        (check-records)
  3065*       resp        (ws-response)
  3066*    end-exec
  3067     MOVE LENGTH OF
  3068      check-records
  3069       TO DFHEIV11
  3070     MOVE 'ERCHEK' TO DFHEIV1
  3071*    MOVE '&& L                  %  N#00002860' TO DFHEIV0
  3072     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3073     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3074     MOVE X'204E233030303032383630' TO DFHEIV0(25:11)
  3075     CALL 'kxdfhei1' USING DFHEIV0,
  3076           DFHEIV1,
  3077           check-records,
  3078           DFHEIV11,
  3079           DFHEIV99
  3080     MOVE EIBRESP  TO ws-response
  3081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3082     if resp-normal
  3083        add 1 to ws-writ-cnt
  3084        compute ws-tot-writ-amt =
  3085           ws-tot-writ-amt + ch-amount-paid
  3086        move 'Successful Post '  to ws-d1-message
  3087     else
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  55
* EL201.cbl
  3088        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  3089     end-if
  3090     .
  3091 2310-exit.
  3092     exit.
  3093 2320-upd-table.
  3094     string wsw-check-dt (6:2) '/'
  3095            wsw-check-dt (9:2) '/'
  3096            wsw-check-dt (1:4)
  3097        delimited by size into db-checkdate
  3098     move ch-check-no            to db-checkno
  3099*    move zeros to sqlcode
  3100     EXEC SQL
  3101        UPDATE
  3102           ChkApp_Check
  3103        SET
  3104           CheckNumber = :db-checkno,
  3105           CheckDate = :db-checkdate
  3106        WHERE
  3107           CheckKey = :db-checkkey
  3108     END-EXEC
  3109     if sqlcode not = 0
  3110        move 'Table not updated ' to ws-d1-message
  3111        display "Error: cannot update table   "
  3112        display ' sql retrun code ' sqlcode
  3113        display ' sql err mess    ' sqlerrmc
  3114     end-if
  3115     .
  3116 2320-exit.
  3117     exit.
  3118 2400-build-print-line.
  3119     if table-found
  3120        move db-carrier          to ws-d1-carr
  3121        move db-grouping         to ws-d1-grp
  3122        move db-state            to ws-d1-state
  3123        move db-account          to ws-d1-account
  3124        string
  3125           db-effdate (6:2)   '/'
  3126           db-effdate (9:2)   '/'
  3127           db-effdate (1:4)
  3128           delimited by size into ws-d1-eff-dt
  3129        end-string
  3130        move db-certificate      to ws-d1-cert-no
  3131        move db-cert-sfx         to ws-d1-cert-no (11:1)
  3132        if db-check-sub-type = '2'
  3133           move 'COR'            to ws-d1-chk-type
  3134        else
  3135           move 'REF'            to ws-d1-chk-type
  3136        end-if
  3137        move +10                 to s2
  3138        move zeros               to ws-work-amt-alpha
  3139        perform varying s1 from +10 by -1 until s1 < +1
  3140           if db-amount (s1:1) numeric
  3141              move db-amount (s1:1)
  3142                                 to ws-work-amt-alpha (s2:1)
  3143              subtract +1 from s2
  3144           end-if
  3145        end-perform
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  56
* EL201.cbl
  3146        move ws-work-amt-num     to ws-d1-chk-amt
  3147        move db-preparer         to ws-d1-preparer
  3148        move db-checkno          to ws-d1-chk-no
  3149        move db-checkdate        to ws-d1-writ-cash-dt
  3150     else
  3151        move wsw-check-no        to ws-d1-chk-no
  3152     end-if
  3153     perform 4000-write-report   thru 4000-exit
  3154     move spaces                 to ws-detail1
  3155     .
  3156 2400-exit.
  3157     exit.
  3158 2500-close-files.
  3159     close cps-written-in cps-written-rpt
  3160     .
  3161 2500-exit.
  3162     exit.
  3163 4000-write-report.
  3164     if ws-line-cntr > ws-max-lines
  3165        move zeros               to ws-line-cntr
  3166        perform 4010-write-headings thru 4010-exit
  3167     end-if
  3168     move ws-detail1             to cps-written-rpt-rec
  3169     perform 4020-write-a-line   thru 4020-exit
  3170     .
  3171 4000-exit.
  3172     exit.
  3173 4010-write-headings.
  3174     add 1 to ws-page-cntr
  3175     move ws-page-cntr           to ws-h3-page
  3176     move ws-heading1            to cps-written-rpt-rec
  3177     perform 4020-write-a-line   thru 4020-exit
  3178     move ws-heading2            to cps-written-rpt-rec
  3179     perform 4020-write-a-line   thru 4020-exit
  3180     move ws-heading3            to cps-written-rpt-rec
  3181     perform 4020-write-a-line   thru 4020-exit
  3182     move spaces                 to cps-written-rpt-rec
  3183     perform 4020-write-a-line   thru 4020-exit
  3184     move spaces                 to cps-written-rpt-rec
  3185     perform 4020-write-a-line   thru 4020-exit
  3186     move ws-heading4            to cps-written-rpt-rec
  3187     perform 4020-write-a-line   thru 4020-exit
  3188     move spaces                 to cps-written-rpt-rec
  3189     perform 4020-write-a-line   thru 4020-exit
  3190     .
  3191 4010-exit.
  3192     exit.
  3193 4020-write-a-line.
  3194     write cps-written-rpt-rec
  3195     add 1 to ws-line-cntr
  3196     .
  3197 4020-exit.
  3198     exit.
  3199 5000-submit-job.
  3200
  3201* EXEC CICS WRITEQ TD
  3202*       QUEUE ('BTCH')
  3203*       FROM (TRAN-DATA-LINE1)
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  57
* EL201.cbl
  3204*       LENGTH (80)
  3205*    END-EXEC
  3206     MOVE 80
  3207       TO DFHEIV11
  3208     MOVE 'BTCH' TO DFHEIV5
  3209*    MOVE '(" L   L              &   #00002983' TO DFHEIV0
  3210     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  3211     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3212     MOVE X'2020233030303032393833' TO DFHEIV0(25:11)
  3213     CALL 'kxdfhei1' USING DFHEIV0,
  3214           DFHEIV5,
  3215           TRAN-DATA-LINE1,
  3216           DFHEIV11,
  3217           DFHEIV99,
  3218           DFHEIV99
  3219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3220
  3221* EXEC CICS WRITEQ TD
  3222*       QUEUE ('BTCH')
  3223*       FROM (TRAN-DATA-LINE2)
  3224*       LENGTH (80)
  3225*    END-EXEC
  3226     MOVE 80
  3227       TO DFHEIV11
  3228     MOVE 'BTCH' TO DFHEIV5
  3229*    MOVE '(" L   L              &   #00002988' TO DFHEIV0
  3230     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  3231     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3232     MOVE X'2020233030303032393838' TO DFHEIV0(25:11)
  3233     CALL 'kxdfhei1' USING DFHEIV0,
  3234           DFHEIV5,
  3235           TRAN-DATA-LINE2,
  3236           DFHEIV11,
  3237           DFHEIV99,
  3238           DFHEIV99
  3239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3240     .
  3241 5000-exit.
  3242     exit.
  3243 9700-DATE-CONVERT.
  3244
  3245* EXEC CICS LINK
  3246*         PROGRAM  ('ELDATCV')
  3247*         COMMAREA (DATE-CONVERSION-DATA)
  3248*         LENGTH   (DC-COMM-LENGTH)
  3249*    END-EXEC.
  3250     MOVE 'ELDATCV' TO DFHEIV1
  3251*    MOVE '."C                   (   #00002997' TO DFHEIV0
  3252     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3254     MOVE X'2020233030303032393937' TO DFHEIV0(25:11)
  3255     CALL 'kxdfhei1' USING DFHEIV0,
  3256           DFHEIV1,
  3257           DATE-CONVERSION-DATA,
  3258           DC-COMM-LENGTH,
  3259           DFHEIV99,
  3260           DFHEIV99,
  3261           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  58
* EL201.cbl
  3262           DFHEIV99
  3263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3264
  3265 9700-EXIT.
  3266      EXIT.
  3267
  3268 9999-DFHBACK SECTION.
  3269     MOVE '9%                    "   ' TO DFHEIV0
  3270     MOVE 'EL201' TO DFHEIV1
  3271     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3272     GOBACK.
  3273 9999-DFHEXIT.
  3274     IF DFHEIGDJ EQUAL 0001
  3275         NEXT SENTENCE.
  3276     MOVE '9%                    "   ' TO DFHEIV0
  3277     MOVE 'EL201' TO DFHEIV1
  3278     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3279     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      140212     Code:       10699
