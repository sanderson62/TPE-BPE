* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84******************************************************************
    85
    86 ENVIRONMENT DIVISION.
    87
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page   4
* EL6311.cbl
    89 DATA DIVISION.
    90 WORKING-STORAGE SECTION.
    91 01  DFH-START PIC X(04).
    92 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    93 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    94 77  FILLER  PIC X(32)  VALUE '********************************'.
    95 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    96 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    97 77  A1                          PIC S999 COMP-3 VALUE +0.
    98 77  N1                          PIC S999 COMP-3 VALUE +0.
    99 77  N2                          PIC S999 COMP-3 VALUE +0.
   100 77  N3                          PIC S999 COMP-3 VALUE +0.
   101 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   102 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   103 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   104     88  REVERSAL                    VALUE 'Y'.
   105 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   106 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   107 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   108 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   109 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   110     88  ERMAIL-FOUND                 VALUE 'Y'.
   111 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   112 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   113 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   114 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   115     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   116 77  ws-stop-sw                  pic x value ' '.
   117     88  i-say-stop                 value 'Y'.
   118 77  ws-check-sw                 pic x value ' '.
   119     88  i-have-checks              value 'Y'.
   120 77  ws-proc-check-sw            pic x value ' '.
   121     88  i-have-processed-checks    value 'Y'.
   122 77  ws-any-check-sw             pic x value ' '.
   123     88  i-have-a-check-period      value 'Y'.
   124 77  ws-chek-browse-sw           pic x value ' '.
   125 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   126 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   127 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   128 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   129 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   130 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   131 77  ws-elcrtt-update-sw         pic x value ' '.
   132     88  update-elcrtt              value 'Y'.
   133 01  P pointer.
   134 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   135 01  var-ptr pointer.
   136 01  env-var-len                 pic 9(4)  binary.
   137 01  rc                          pic 9(9)  binary.
   138 01  WS-KIXSYS.
   139     05  WS-KIX-FIL1             PIC X(10).
   140     05  WS-KIX-APPS             PIC X(10).
   141     05  WS-KIX-ENV              PIC X(10).
   142     05  WS-KIX-MYENV            PIC X(10).
   143     05  WS-KIX-SYS              PIC X(10).
   144*    COPY ELCSCTM.
   145******************************************************************
   146*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page   5
* EL6311.cbl
   147*                                                                *
   148*                            ELCSCTM                             *
   149*                            VMOD=2.001                          *
   150*                                                                *
   151*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   152*                                                                *
   153******************************************************************
   154 01  SECURITY-MESSAGE.
   155     12  FILLER                          PIC X(30)
   156            VALUE '** LOGIC SECURITY VIOLATION -'.
   157     12  SM-READ                         PIC X(6).
   158     12  FILLER                          PIC X(5)
   159            VALUE ' PGM='.
   160     12  SM-PGM                          PIC X(6).
   161     12  FILLER                          PIC X(5)
   162            VALUE ' OPR='.
   163     12  SM-PROCESSOR-ID                 PIC X(4).
   164     12  FILLER                          PIC X(6)
   165            VALUE ' TERM='.
   166     12  SM-TERMID                       PIC X(4).
   167     12  FILLER                          PIC XX   VALUE SPACE.
   168     12  SM-JUL-DATE                     PIC 9(5).
   169     12  FILLER                          PIC X    VALUE SPACE.
   170     12  SM-TIME                         PIC 99.99.
   171
   172
   173*    COPY ELCSCRTY.
   174******************************************************************
   175*                                                                *
   176*                                                                *
   177*                            ELCSCRTY                            *
   178*                            VMOD=2.001                          *
   179*                                                                *
   180*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   181*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   182*        SAVED IN PI-SECURITY-ADDRESS.                           *
   183*                                                                *
   184******************************************************************
   185 01  SECURITY-CONTROL.
   186     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   187     12  FILLER                       PIC XX    VALUE 'SC'.
   188     12  SC-CREDIT-CODES.
   189         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   190             20  SC-CREDIT-DISPLAY    PIC X.
   191             20  SC-CREDIT-UPDATE     PIC X.
   192     12  SC-CLAIMS-CODES.
   193         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   194             20  SC-CLAIMS-DISPLAY    PIC X.
   195             20  SC-CLAIMS-UPDATE     PIC X.
   196
   197 01  WS-VA-NO-COMM-MESS.
   198     12  FILLER                  PIC X(41) VALUE
   199        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   200 01  WS-OC-MESSAGE.
   201     12  FILLER                  PIC X(43) VALUE
   202        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   203     12  WS-OC-DIS-AMT           PIC -----9.99.
   204     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page   6
* EL6311.cbl
   205     12  WS-OC-DATE              PIC X(10).
   206 01  WS-DATE-AREA.
   207     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   208     12  WS-CURRENT-DT.
   209         16  FILLER              PIC X(6)    VALUE SPACES.
   210         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   211     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   212     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   213     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   214
   215 01  STANDARD-AREAS.
   216     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   217     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   218     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   219     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   220     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   221     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   222     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   223     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   224     12  PGM-NAME                PIC X(8).
   225     12  TIME-IN                 PIC S9(7).
   226     12  TIME-OUT-R  REDEFINES TIME-IN.
   227         16  FILLER              PIC X.
   228         16  TIME-OUT            PIC 99V99.
   229         16  FILLER              PIC XX.
   230     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   231     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   232     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   233     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   234     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   235     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   236     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   237     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   238     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   239     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   240     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   241     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   242     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   243     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   244     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   245     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   246     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   247     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   248     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   249     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   250     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   251     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   252     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   253     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   254     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   255     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   256     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   257     12  FILE-ID                 PIC X(8).
   258     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   259     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   260     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   261     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   262     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page   7
* EL6311.cbl
   263     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   264     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   265     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   266     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   267     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   268     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   269     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   270     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   271     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   272     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   273
   274 01  WS-PASS-AREA.
   275     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   276     05  WS-PASS-VADS-REC    PIC X(350).
   277*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   278*                                COPY ELCZREC.
   279******************************************************************
   280*                                                                *
   281*                                                                *
   282*                            ELCZREC.                            *
   283*                                                                *
   284*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   285*                                                                *
   286******************************************************************
   287*-----------------------------------------------------------------
   288*                   C H A N G E   L O G
   289*
   290* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   291*-----------------------------------------------------------------
   292*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   293* EFFECTIVE    NUMBER
   294*-----------------------------------------------------------------
   295* 122011    2011022800001  AJRA  NEW FILE
   296* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   297* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   298* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   299* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   300*-----------------------------------------------------------------
   301 01  W-Z-CONTROL-DATA.
   302     05  W-NUMBER-OF-COPIES      PIC  9.
   303     05  FILLER                  PIC  X.
   304     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   305     05  FILLER                  PIC  X.
   306     05  W-DAYS-TO-RESEND        PIC  999.
   307     05  FILLER                  PIC  X.
   308     05  W-FORM-TO-RESEND        PIC  X(4).
   309     05  W-ADD-BAR-CODE          PIC  X.
   310     05  W-PROMPT-LETTER         PIC  X.
   311     05  W-HAS-RETURN-ENV        PIC  X.
   312     05  W-ENCLOSURE-CD          PIC  XXX.
   313     05  W-SIG-FLAG-DEFAULT      PIC  X.
   314     05  W-AUTO-CLOSE-IND        PIC  X.
   315     05  FILLER                  PIC  X.
   316     05  W-LETTER-TO-BENE        PIC  X.
   317     05  FILLER                  PIC  X.
   318     05  W-LETTER-TO-ACCT        PIC  X.
   319     05  FILLER                  PIC  X.
   320     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page   8
* EL6311.cbl
   321     05  FILLER                  PIC  X.
   322     05  W-PRINT-CERTIFICATE     PIC  X.
   323     05  FILLER                  PIC  X.
   324     05  W-REFUND-REQUIRED       PIC  X.
   325     05  FILLER                  PIC  X.
   326     05  W-ONBASE-CODE           PIC  XX.
   327     05  FILLER                  PIC  X.
   328     05  W-ACCT-SUMM             PIC  X.
   329     05  FILLER                  PIC  X.
   330     05  W-CSO-SUMM              PIC  X.
   331     05  FILLER                  PIC  X.
   332     05  W-REASONS-REQUIRED      PIC  X.
   333     05  FILLER                  PIC  X(29).
   334******************************************************************
   335*                                                                *
   336*              A C C E S S   K E Y S                             *
   337*                                                                *
   338******************************************************************
   339
   340 01  ACCESS-KEYS.
   341     12  ERPYAJ-KEY.
   342         16  ERPYAJ-COMPANY-CD       PIC X.
   343         16  ERPYAJ-CARRIER          PIC X.
   344         16  ERPYAJ-GROUPING         PIC X(6).
   345         16  ERPYAJ-FIN-RESP         PIC X(10).
   346         16  ERPYAJ-ACCOUNT          PIC X(10).
   347         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   348         16  ERPYAJ-TYPE             PIC X.
   349     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   350     12  ELCERT-KEY.
   351         16  ELCERT-COMPANY-CD       PIC X.
   352         16  ELCERT-CARRIER          PIC X.
   353         16  ELCERT-GROUPING         PIC X(6).
   354         16  ELCERT-STATE            PIC XX.
   355         16  ELCERT-ACCOUNT          PIC X(10).
   356         16  ELCERT-CERT-EFF-DT      PIC XX.
   357         16  ELCERT-CERT-NO.
   358             20  ELCERT-CERT-PRIME   PIC X(10).
   359             20  ELCERT-CERT-SFX     PIC X.
   360
   361     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   362     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   363     12  ELCRTO-KEY.
   364         16  ELCRTO-COMPANY-CD       PIC X.
   365         16  ELCRTO-CARRIER          PIC X.
   366         16  ELCRTO-GROUPING         PIC X(6).
   367         16  ELCRTO-STATE            PIC XX.
   368         16  ELCRTO-ACCOUNT          PIC X(10).
   369         16  ELCRTO-CERT-EFF-DT      PIC XX.
   370         16  ELCRTO-CERT-NO.
   371             20  ELCRTO-CERT-PRIME   PIC X(10).
   372             20  ELCRTO-CERT-SFX     PIC X.
   373         16  ELCRTO-RECORD-TYPE      PIC X.
   374         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   375
   376     12  ELCRTT-KEY.
   377         16  ELCRTT-PRIMARY          PIC X(33).
   378         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page   9
* EL6311.cbl
   379     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   380     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   381
   382     12  ERPNDB-KEY.
   383         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   384         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   385         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   386         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   387             ERPNDB-BATCH-SEQ-NO     PIC XX.
   388         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   389
   390     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   391     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   392     12  ERCHEK-KEY.
   393         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   394         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   395         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   396         16  CHEK-STATE              PIC XX      VALUE SPACES.
   397         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   398         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   399         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   400         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   401         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   402     12  ELLETR-KEY.
   403         16  LETR-COMPANY-CD     PIC X.
   404         16  LETR-LETTER-ID      PIC X(4).
   405         16  LETR-FILLER         PIC X(8).
   406         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   407     12  ERPNDM-KEY.
   408         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   409         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   410         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   411         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   412
   413*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   414     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   415*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   416     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   417
   418     12  ERPNDB-ALT-KEY.
   419         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   420         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   421         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   422         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   423         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   424         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   425         16  ERPNDB-CERT-NO.
   426             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   427             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   428         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   429         16  ERPNDB-RECORD-TYPE      PIC X.
   430
   431      12  ERPNDB-CSR-KEY.
   432          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   433          20  ERPNDB-CSR-ID                PIC X(4).
   434          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   435          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   436          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  10
* EL6311.cbl
   437
   438     12  ERNOTE-KEY.
   439         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   440         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   441         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   442         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   443         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   444         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   445         16  ERNOTE-CERT-NO.
   446             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   447             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   448
   449     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   450     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   451
   452     12  ERCNOT-KEY.
   453         16  ERCNOT-PART-KEY.
   454             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   455             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   456             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   457             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   458             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   459             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   460             20  ERCNOT-CERT-NO.
   461                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   462                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   463         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   464         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   465
   466     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   467     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   468
   469     12  ERMAIL-KEY.
   470         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   471         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   472         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   473         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   474         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   475         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   476         16  ERMAIL-CERT-NO.
   477             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   478             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   479
   480     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   481     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   482
   483     12  ERRQST-KEY.
   484         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   485         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   486
   487     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   488     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   489
   490     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   491
   492     12  ERLOFC-KEY.
   493         16  ERLOFC-COMPANY-CD          PIC  X.
   494         16  ERLOFC-CARRIER             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  11
* EL6311.cbl
   495         16  ERLOFC-GROUPING            PIC  X(6).
   496         16  ERLOFC-STATE               PIC  XX.
   497         16  ERLOFC-ACCOUNT             PIC  X(10).
   498         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   499*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   500
   501     12  ERACCT-KEY.
   502         16  ERACCT-COMPANY-CD          PIC  X.
   503         16  ERACCT-CARRIER             PIC  X.
   504         16  ERACCT-GROUPING            PIC  X(6).
   505         16  ERACCT-STATE               PIC  XX.
   506         16  ERACCT-ACCOUNT             PIC  X(10).
   507         16  ERACCT-EXP-DT.
   508             20  ERACCT-DT              PIC  XX.
   509             20  ERACCT-FILL            PIC  X(4).
   510     12  ERACNT-KEY.
   511         16  ERACNT-COMPANY-CD          PIC  X.
   512         16  ERACNT-CARRIER             PIC  X.
   513         16  ERACNT-GROUPING            PIC  X(6).
   514         16  ERACNT-STATE               PIC  XX.
   515         16  ERACNT-ACCOUNT             PIC  X(10).
   516         16  ERACNT-REC-TYPE            PIC  X.
   517         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   518     12  ERENDT-KEY.
   519         16  ENDT-COMPANY-CD       PIC X.
   520         16  ENDT-CARRIER          PIC X.
   521         16  ENDT-GROUPING         PIC X(6).
   522         16  ENDT-STATE            PIC XX.
   523         16  ENDT-ACCOUNT          PIC X(10).
   524         16  ENDT-CERT-EFF-DT      PIC XX.
   525         16  ENDT-CERT-PRIME       PIC X(10).
   526         16  ENDT-CERT-SFX         PIC X.
   527         16  ENDT-RECORD-TYPE      PIC X.
   528         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   529
   530 01  WS-ELMSTR-WORK.
   531     12  ELMSTR-KEY.
   532         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   533         16  MSTR-CERT-NO.
   534             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   535             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   536     12  W-CLAIM-KEY.
   537         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   538         16  W-CL-CERT-NO.
   539             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   540             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   541      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   542 01  CANCEL-GEN-PASS-AREA.
   543     05  CG-OPTION-CODE          PIC X.
   544         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   545         88  CG-FLAT-CANCEL        VALUE '1'.
   546         88  CG-CANCEL             VALUE '2'.
   547         88  CG-CANCEL-REISSUE     VALUE '3'.
   548     05  CG-ERROR-CODE           PIC 99.
   549         88  CG-SUCCESS            VALUE 00.
   550         88  CG-DATE-ERROR         VALUE 01.
   551         88  CG-CERT-NOT-FOUND     VALUE 02.
   552         88  CG-AMOUNT-ERROR       VALUE 04.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  12
* EL6311.cbl
   553         88  CG-OPTION-ERROR       VALUE 05.
   554         88  CG-PREV-CAN           VALUE 06.
   555         88  CG-INVALID-DATA       VALUE 07.
   556         88  CG-NO-ACCT-MSTR       VALUE 08.
   557         88  CG-SFX-A-EXIST        VALUE 09.
   558         88  CG-MISC-ERROR         VALUE 99.
   559     05  CG-COMPANY-ID           PIC XXX.
   560     05  CG-PROC-ID              PIC XXXX.
   561     05  CG-CURRENT-DT           PIC XX.
   562     05  CG-MONTH-END-DT         PIC XX.
   563     05  CG-CERT-KEY.
   564         10  CG-CERT-COMPANY-CD  PIC X.
   565         10  CG-CERT-CARRIER     PIC X.
   566         10  CG-CERT-GROUP       PIC X(6).
   567         10  CG-CERT-STATE       PIC XX.
   568         10  CG-CERT-ACCOUNT     PIC X(10).
   569         10  CG-CERT-EFF-DT      PIC XX.
   570         10  CG-CERT-CERT-NO     PIC X(11).
   571     05  CG-LF-CAN-DATA.
   572         10  CG-LF-CAN-DT        PIC XX.
   573         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   574     05  CG-AH-CAN-DATA.
   575         10  CG-AH-CAN-DT        PIC XX.
   576         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   577     05  CG-CERT-PROFILE-DATA.
   578         10  CG-INS-LNAME        PIC X(15).
   579         10  CG-INS-FNAME        PIC X(10).
   580         10  CG-INS-MID-INIT     PIC X.
   581         10  CG-INS-AGE          PIC 99.
   582         10  CG-JNT-LNAME        PIC X(15).
   583         10  CG-JNT-FNAME        PIC X(10).
   584         10  CG-JNT-MID-INIT     PIC X.
   585         10  CG-JNT-AGE          PIC 99.
   586     05  CG-LF-ISS-DATA.
   587         10  CG-LF-BENCD         PIC XX.
   588         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   589         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   590     05  CG-AH-ISS-DATA.
   591         10  CG-AH-BENCD         PIC XX.
   592         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   593     05  CG-BATCH-NO             PIC X(6).
   594     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   595     05  FILLER                  PIC X(306).
   596******************************************************************
   597*                                                                *
   598*            G E N E R A L   W O R K   A R E A                   *
   599*                                                                *
   600******************************************************************
   601
   602 01  WORK-AREA.
   603     12  WS-RESPONSE             PIC S9(8)   COMP.
   604         88  RESP-NORMAL           VALUE +0.
   605         88  resp-file-notfnd      value +12.
   606         88  RESP-NOTFND           VALUE +13.
   607         88  resp-duprec           value +14.
   608         88  resp-dupkey           value +15.
   609         88  resp-invreq           value +16.
   610         88  RESP-NOTOPEN          VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  13
* EL6311.cbl
   611         88  RESP-ENDFILE          VALUE +20.
   612         88  resp-lengtherr        value +22.
   613     12  DEEDIT-FIELD            PIC X(15).
   614     12  FILLER          REDEFINES DEEDIT-FIELD.
   615         16  FILLER              PIC X(4).
   616         16  DEEDIT-FIELD-X11    PIC X(11).
   617     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   618                                 PIC S9(15).
   619     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   620                                 PIC S9(13)V99.
   621     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   622                                 PIC S9(11)V9999.
   623     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   624     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   625     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   626         16  WS-CALC-TERM-WHOLE  PIC S999.
   627         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   628
   629     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   630     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   631         16  WS-HR-MINS          PIC 99V99.
   632         16  FILLER              PIC XX.
   633
   634     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   635     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   636
   637     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   638     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   639
   640     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   641     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   642     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   643     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   644     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   645     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   646     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   647
   648     12  QID.
   649         16  QID-TERM            PIC X(4).
   650         16  FILLER              PIC X(4)    VALUE '607B'.
   651
   652     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   653         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   654
   655     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   656         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   657
   658     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   659         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   660                                         'A'.
   661
   662     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   663
   664     12  WS-NUMERIC-SW           PIC X.
   665        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   666
   667     12  WS-EDIT-CSO-FIELD.
   668         16  WS-EDIT-BYTE  OCCURS 9 TIMES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  14
* EL6311.cbl
   669                                 PIC X.
   670
   671     12  WS-SAVE-INPUT-FIELDS.
   672         16  WS-BAGE             PIC 99       VALUE ZERO.
   673*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   674         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   675         16  FILLER REDEFINES WS-BAPR.
   676             20  WS-APR-WHOLE-NUM    PIC 99.
   677             20  WS-APR-DEC          PIC 9999.
   678         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   679         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   680
   681         16  WS-B-COVERAGE OCCURS 2 TIMES.
   682             20  WS-TERM-IN-DAYS-SW  PIC X.
   683                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   684             20  WS-BTERM        PIC 999       COMP-3.
   685             20  WS-BALT-TERM    PIC 999       COMP-3.
   686             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   687             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   688             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   689             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   690             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   691             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   692
   693         16  WS-C-FIELDS COMP-3.
   694             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   695             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   696             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   697
   698         16  WS-D-FIELDS COMP-3.
   699             20  WS-DRISS        PIC S9(5)    VALUE +0.
   700             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   701             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   702             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   703             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   704             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   705
   706     12  WS-SAVE-BIRTH-DATE.
   707         16  FILLER              PIC X(4)   VALUE SPACES.
   708         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   709
   710     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   711     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   712     12  FILLER REDEFINES WS-WORK-BIN-RED.
   713         16  FILLER              PIC X(02).
   714         16  WS-WORK-BIN-DT      PIC X(02).
   715     12  WS-SW-1                 PIC X     VALUE SPACE.
   716     12  WS-SW-2                 PIC X     VALUE SPACE.
   717     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   718         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   719     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   720         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   721
   722     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   723     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   724     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   725     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   726     12  WS-CONVERTED-CANCEL-DATES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  15
* EL6311.cbl
   727         16  WS-CONVERTED-CANDT1                  PIC XX.
   728         16  WS-CONVERTED-CANDT2                  PIC XX.
   729
   730     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   731
   732     12  WS-REC-FOUND-SW         PIC X.
   733         88  RECORD-NOT-FOUND    VALUE 'N'.
   734
   735     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   736         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   737         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   738
   739     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   740         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   741         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   742
   743     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   744         88  BROWSE-STARTED      VALUE 'Y'.
   745
   746     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   747         88  FIRST-TIME          VALUE 'Y'.
   748
   749     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   750         88  FIRST-ENTRY         VALUE 'Y'.
   751
   752     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   753         88  REC-BILLED          VALUE 'Y'.
   754
   755     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   756         88  NO-CURSOR-SET       VALUE +0.
   757         88  CURSOR-SET          VALUE +1.
   758
   759     12  WS-ERR-SW               PIC X.
   760         88  STD-ERRORS          VALUE 'S'.
   761         88  TRN-ERRORS          VALUE 'T'.
   762
   763     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   764         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   765
   766     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   767         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   768
   769     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   770         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   771
   772     12  WS-ERR-CODE.
   773         16  FILLER              PIC 99.
   774         16  WS-ERROR-SUB        PIC 99.
   775
   776     12  WS-DATE-WORK.
   777         16  WS-WORK-MM          PIC XX.
   778         16  WS-WORK-DD          PIC XX.
   779         16  WS-WORK-YY          PIC XX.
   780
   781     12  WS-MM-YY.
   782         16  WS-MM               PIC XX.
   783         16  FILLER              PIC X     VALUE '/'.
   784         16  WS-YY               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  16
* EL6311.cbl
   785
   786     12  WS-CERT-EFF-DT          PIC XX.
   787
   788     12  WS-MEMBER-NO            PIC X(12).
   789     12  FILLER  REDEFINES  WS-MEMBER-NO.
   790         16  WS-MEMBER-NO-1-8    PIC 9(8).
   791         16  FILLER              PIC X(4).
   792
   793     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   794
   795     12  WS-ERPNDB-ALT-KEY.
   796         16  WS-PB-COMPANY-CD-A1         PIC X.
   797         16  WS-PB-CARRIER               PIC X.
   798         16  WS-PB-GROUPING              PIC X(6).
   799         16  WS-PB-STATE                 PIC XX.
   800         16  WS-PB-ACCOUNT               PIC X(10).
   801         16  WS-PB-CERT-EFF-DT           PIC XX.
   802         16  WS-PB-CERT-NO.
   803             20  WS-PB-CERT-PRIME        PIC X(10).
   804             20  WS-PB-CERT-SFX          PIC X.
   805         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   806         16  WS-PB-RECORD-TYPE           PIC X.
   807
   808     12  WS-SHOW-SAVE-AREAS.
   809         16  WS-NEW-CERT-NO.
   810             20  WS-NEW-PRIME    PIC X(10).
   811             20  WS-NEW-SUFFIX   PIC X.
   812         16  WS-NEW-CERT-EFF-DT  PIC XX.
   813         16  WS-NEW-RECORD-TYPE  PIC X.
   814         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   815             88   SHOW-RECORD            VALUE 'Y'.
   816
   817     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   818
   819     12  WS-BATCH-NO.
   820         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   821         16  FILLER              PIC X(5) VALUE SPACES.
   822
   823     12  WS-FIRST-NAME.
   824         16  WS-1ST-INIT         PIC X.
   825         16  FILLER              PIC X(9).
   826
   827     12  WS-INITIALS.
   828         16  WS-INITIAL-1        PIC X.
   829         16  WS-INITIAL-2        PIC X.
   830
   831     12  WS-C-HDG.
   832         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   833         16  FILLER              PIC X(4) VALUE '-REF'.
   834
   835     12  WS-D-PREM-HDG.
   836         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   837         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   838
   839     12  WS-D-REFUND-HDG.
   840         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   841         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   842
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  17
* EL6311.cbl
   843     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   844
   845     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   846     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   847     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   848     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   849     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   850     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   851     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   852
   853     12  WS-01-CANCEL-ERR        PIC X(25)
   854         VALUE 'CANCEL DATE ERROR'.
   855     12  WS-02-CANCEL-ERR        PIC X(25)
   856         VALUE 'CERT NOT FOUND'.
   857     12  WS-04-CANCEL-ERR        PIC X(25)
   858         VALUE 'CANCEL AMOUNT ERROR'.
   859     12  WS-05-CANCEL-ERR        PIC X(25)
   860         VALUE 'CANCEL OPTION ERROR'.
   861     12  WS-06-CANCEL-ERR        PIC X(25)
   862         VALUE 'PREVIOUSLY CANCELLED'.
   863     12  WS-07-CANCEL-ERR        PIC X(25)
   864         VALUE 'INVALID DATA'.
   865     12  WS-08-CANCEL-ERR        PIC X(25)
   866         VALUE 'NO ACCOUNT MASTER'.
   867     12  WS-09-CANCEL-ERR        PIC X(25)
   868         VALUE 'SUFFIX ALREADY EXISTS'.
   869     12  WS-99-CANCEL-ERR        PIC X(25)
   870         VALUE 'MISC CANCEL ERROR'.
   871
   872     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   873     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   874
   875     12  WS-AGE-FIELDS.
   876         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   877         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   878         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   879         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   880
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  18
* EL6311.cbl
   882
   883******************************************************************
   884*                                                                *
   885*                 B A T C H   T O T A L S                        *
   886*                                                                *
   887******************************************************************
   888
   889     12  WS-BATCH-RECORD.
   890         16  FILLER                       PIC X(10).
   891         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   892         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   893         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   894         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   895         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   896         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   897         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   898         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   899         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   900         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   901         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   902         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   903         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   904         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   905         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   906         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   907         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   908         16  WS-ACCOUNT-NAME              PIC X(30).
   909         16  FILLER                       PIC X.
   910         16  WS-REFERENCE                 PIC X(12).
   911         16  FILLER                       PIC X(197).
   912
   913     12  WS-BATCH-TOTALS.
   914         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   915         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   916         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   917         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   918         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   919         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   920         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   921         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   922         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   923         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   924         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   925         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   926         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   927         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   928         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   929         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   930         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   931         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   932         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   933
   934     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   935
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  19
* EL6311.cbl
   937
   938******************************************************************
   939*                                                                *
   940*                E R R O R   M E S S A G E S                     *
   941*                                                                *
   942******************************************************************
   943
   944 01  ERROR-MESSAGES.
   945     12  ER-0004                 PIC  9(4) VALUE 0004.
   946     12  ER-0008                 PIC  9(4) VALUE 0008.
   947     12  ER-0023                 PIC  9(4) VALUE 0023.
   948     12  ER-0029                 PIC  9(4) VALUE 0029.
   949     12  ER-0033                 PIC  9(4) VALUE 0033.
   950     12  ER-0070                 PIC  9(4) VALUE 0070.
   951     12  ER-0220                 PIC  9(4) VALUE 0220.
   952     12  ER-0248                 PIC  9(4) VALUE 0248.
   953     12  ER-0280                 PIC  9(4) VALUE 0280.
   954     12  ER-0348                 PIC  9(4) VALUE 0348.
   955     12  ER-0582                 PIC  9(4) VALUE 0582.
   956     12  ER-0877                 PIC  9(4) VALUE 0877.
   957     12  ER-1236                 PIC  9(4) VALUE 1236.
   958     12  ER-1570                 PIC  9(4) VALUE 1570.
   959     12  ER-1575                 PIC  9(4) VALUE 1575.
   960     12  ER-1609                 PIC  9(4) VALUE 1609.
   961     12  er-1762                 pic  9(4) value 1762.
   962     12  ER-1819                 PIC  9(4) VALUE 1819.
   963     12  ER-2077                 PIC  9(4) VALUE 2077.
   964     12  ER-2129                 PIC  9(4) VALUE 2129.
   965     12  ER-2188                 PIC  9(4) VALUE 2188.
   966     12  ER-2192                 PIC  9(4) VALUE 2192.
   967     12  ER-2196                 PIC  9(4) VALUE 2196.
   968     12  ER-2197                 PIC  9(4) VALUE 2197.
   969     12  ER-2198                 PIC  9(4) VALUE 2198.
   970     12  ER-2200                 PIC  9(4) VALUE 2200.
   971     12  ER-2212                 PIC  9(4) VALUE 2212.
   972     12  ER-2218                 PIC  9(4) VALUE 2218.
   973     12  ER-2220                 PIC  9(4) VALUE 2220.
   974     12  ER-2222                 PIC  9(4) VALUE 2222.
   975     12  ER-2223                 PIC  9(4) VALUE 2223.
   976     12  ER-2224                 PIC  9(4) VALUE 2224.
   977     12  ER-2225                 PIC  9(4) VALUE 2225.
   978     12  ER-2226                 PIC  9(4) VALUE 2226.
   979     12  ER-2227                 PIC  9(4) VALUE 2227.
   980     12  ER-2228                 PIC  9(4) VALUE 2228.
   981     12  ER-2240                 PIC  9(4) VALUE 2240.
   982     12  ER-2241                 PIC  9(4) VALUE 2241.
   983     12  ER-2242                 PIC  9(4) VALUE 2242.
   984     12  ER-2243                 PIC  9(4) VALUE 2243.
   985     12  ER-2244                 PIC  9(4) VALUE 2244.
   986     12  ER-2245                 PIC  9(4) VALUE 2245.
   987     12  ER-2246                 PIC  9(4) VALUE 2246.
   988     12  ER-2247                 PIC  9(4) VALUE 2247.
   989     12  ER-2251                 PIC  9(4) VALUE 2251.
   990     12  ER-2252                 PIC  9(4) VALUE 2252.
   991     12  ER-2253                 PIC  9(4) VALUE 2253.
   992     12  ER-2254                 PIC  9(4) VALUE 2254.
   993     12  ER-2255                 PIC  9(4) VALUE 2255.
   994     12  ER-2256                 PIC  9(4) VALUE 2256.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  20
* EL6311.cbl
   995     12  ER-2257                 PIC  9(4) VALUE 2257.
   996     12  ER-2258                 PIC  9(4) VALUE 2258.
   997     12  ER-2259                 PIC  9(4) VALUE 2259.
   998     12  ER-2260                 PIC  9(4) VALUE 2260.
   999     12  ER-2261                 PIC  9(4) VALUE 2261.
  1000     12  ER-2287                 PIC  9(4) VALUE 2287.
  1001     12  ER-2336                 PIC  9(4) VALUE 2336.
  1002     12  ER-2337                 PIC  9(4) VALUE 2337.
  1003     12  ER-2437                 PIC  9(4) VALUE 2437.
  1004     12  ER-2471                 PIC  9(4) VALUE 2471.
  1005     12  ER-2530                 PIC  9(4) VALUE 2530.
  1006     12  ER-2531                 PIC  9(4) VALUE 2531.
  1007     12  ER-2532                 PIC  9(4) VALUE 2532.
  1008     12  ER-2533                 PIC  9(4) VALUE 2533.
  1009     12  ER-2547                 PIC  9(4) VALUE 2547.
  1010     12  ER-2591                 PIC  9(4) VALUE 2591.
  1011     12  ER-2592                 PIC  9(4) VALUE 2592.
  1012     12  ER-2593                 PIC  9(4) VALUE 2593.
  1013     12  ER-2600                 PIC  9(4) VALUE 2600.
  1014     12  ER-2601                 PIC  9(4) VALUE 2601.
  1015     12  ER-2604                 PIC  9(4) VALUE 2604.
  1016     12  ER-2605                 PIC  9(4) VALUE 2605.
  1017     12  ER-2606                 PIC  9(4) VALUE 2606.
  1018     12  ER-2607                 PIC  9(4) VALUE 2607.
  1019     12  ER-2622                 PIC  9(4) VALUE 2622.
  1020     12  ER-2625                 PIC  9(4) VALUE 2625.
  1021     12  ER-2626                 PIC  9(4) VALUE 2626.
  1022     12  ER-2627                 PIC  9(4) VALUE 2627.
  1023     12  ER-2628                 PIC  9(4) VALUE 2628.
  1024     12  ER-2629                 PIC  9(4) VALUE 2629.
  1025     12  ER-2630                 PIC  9(4) VALUE 2630.
  1026     12  ER-2631                 PIC  9(4) VALUE 2631.
  1027     12  ER-2632                 PIC  9(4) VALUE 2632.
  1028     12  ER-2633                 PIC  9(4) VALUE 2633.
  1029     12  ER-2634                 PIC  9(4) VALUE 2634.
  1030     12  ER-2635                 PIC  9(4) VALUE 2635.
  1031     12  ER-2636                 PIC  9(4) VALUE 2636.
  1032     12  ER-2639                 PIC  9(4) VALUE 2639.
  1033     12  ER-2640                 PIC  9(4) VALUE 2640.
  1034     12  ER-2647                 PIC  9(4) VALUE 2647.
  1035     12  ER-2648                 PIC  9(4) VALUE 2648.
  1036     12  ER-2649                 PIC  9(4) VALUE 2649.
  1037     12  ER-2650                 PIC  9(4) VALUE 2650.
  1038     12  ER-2653                 PIC  9(4) VALUE 2653.
  1039     12  ER-2654                 PIC  9(4) VALUE 2654.
  1040     12  ER-2655                 PIC  9(4) VALUE 2655.
  1041     12  ER-2656                 PIC  9(4) VALUE 2656.
  1042     12  ER-2657                 PIC  9(4) VALUE 2657.
  1043     12  ER-2660                 PIC  9(4) VALUE 2660.
  1044     12  ER-2661                 PIC  9(4) VALUE 2661.
  1045     12  ER-2662                 PIC  9(4) VALUE 2662.
  1046     12  ER-2663                 PIC  9(4) VALUE 2663.
  1047     12  ER-2664                 PIC  9(4) VALUE 2664.
  1048     12  ER-2667                 PIC  9(4) VALUE 2667.
  1049     12  ER-2668                 PIC  9(4) VALUE 2668.
  1050     12  ER-2669                 PIC  9(4) VALUE 2669.
  1051     12  ER-2670                 PIC  9(4) VALUE 2670.
  1052     12  ER-2671                 PIC  9(4) VALUE 2671.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  21
* EL6311.cbl
  1053     12  ER-2672                 PIC  9(4) VALUE 2672.
  1054     12  ER-2673                 PIC  9(4) VALUE 2673.
  1055     12  ER-2677                 PIC  9(4) VALUE 2677.
  1056     12  ER-2678                 PIC  9(4) VALUE 2678.
  1057     12  ER-2679                 PIC  9(4) VALUE 2679.
  1058     12  ER-2680                 PIC  9(4) VALUE 2680.
  1059     12  ER-2681                 PIC  9(4) VALUE 2681.
  1060     12  ER-2682                 PIC  9(4) VALUE 2682.
  1061     12  ER-2683                 PIC  9(4) VALUE 2683.
  1062     12  ER-2684                 PIC  9(4) VALUE 2684.
  1063     12  ER-2686                 PIC  9(4) VALUE 2686.
  1064     12  ER-2689                 PIC  9(4) VALUE 2689.
  1065     12  ER-2690                 PIC  9(4) VALUE 2690.
  1066     12  ER-2693                 PIC  9(4) VALUE 2693.
  1067     12  ER-2695                 PIC  9(4) VALUE 2695.
  1068     12  ER-2701                 PIC  9(4) VALUE 2701.
  1069     12  ER-2720                 PIC  9(4) VALUE 2720.
  1070     12  ER-2709                 PIC  9(4) VALUE 2709.
  1071     12  ER-2704                 PIC  9(4) VALUE 2704.
  1072     12  ER-2725                 PIC  9(4) VALUE 2725.
  1073     12  ER-2726                 PIC  9(4) VALUE 2726.
  1074     12  ER-2728                 PIC  9(4) VALUE 2728.
  1075     12  ER-2729                 PIC  9(4) VALUE 2729.
  1076     12  ER-2731                 PIC  9(4) VALUE 2731.
  1077     12  ER-2732                 PIC  9(4) VALUE 2732.
  1078     12  ER-2733                 PIC  9(4) VALUE 2733.
  1079     12  ER-2735                 PIC  9(4) VALUE 2735.
  1080     12  ER-2738                 PIC  9(4) VALUE 2738.
  1081     12  ER-2742                 PIC  9(4) VALUE 2742.
  1082     12  ER-2743                 PIC  9(4) VALUE 2743.
  1083     12  ER-2744                 PIC  9(4) VALUE 2744.
  1084     12  ER-2747                 PIC  9(4) VALUE 2747.
  1085     12  ER-2749                 PIC  9(4) VALUE 2749.
  1086     12  ER-2753                 PIC  9(4) VALUE 2753.
  1087     12  ER-2755                 PIC  9(4) VALUE 2755.
  1088     12  ER-2757                 PIC  9(4) VALUE 2757.
  1089     12  ER-2771                 PIC  9(4) VALUE 2771.
  1090     12  ER-2774                 PIC  9(4) VALUE 2774.
  1091     12  ER-2775                 PIC  9(4) VALUE 2775.
  1092     12  ER-2776                 PIC  9(4) VALUE 2776.
  1093     12  ER-2777                 PIC  9(4) VALUE 2777.
  1094     12  ER-2794                 PIC  9(4) VALUE 2794.
  1095     12  ER-2799                 PIC  9(4) VALUE 2799.
  1096     12  ER-2900                 PIC  9(4) VALUE 2900.
  1097     12  ER-2902                 PIC  9(4) VALUE 2902.
  1098     12  ER-2945                 PIC  9(4) VALUE 2945.
  1099     12  ER-3000                 PIC  9(4) VALUE 3000.
  1100     12  ER-3006                 PIC  9(4) VALUE 3006.
  1101     12  ER-3054                 PIC  9(4) VALUE 3054.
  1102     12  ER-3224                 PIC  9(4) VALUE 3224.
  1103     12  ER-3269                 PIC  9(4) VALUE 3269.
  1104     12  er-3444                 pic  9(4) value 3444.
  1105     12  er-3446                 pic  9(4) value 3446.
  1106     12  er-3447                 pic  9(4) value 3447.
  1107     12  er-3448                 pic  9(4) value 3448.
  1108     12  er-3449                 pic  9(4) value 3449.
  1109     12  ER-3456                 PIC  9(4) VALUE 3456.
  1110     12  ER-3457                 PIC  9(4) VALUE 3457.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  22
* EL6311.cbl
  1111     12  ER-3458                 PIC  9(4) VALUE 3458.
  1112     12  ER-3504                 PIC  9(4) VALUE 3504.
  1113     12  ER-3513                 PIC  9(4) VALUE 3513.
  1114     12  ER-3831                 PIC  9(4) VALUE 3831.
  1115     12  ER-3834                 PIC  9(4) VALUE 3834.
  1116     12  ER-3835                 PIC  9(4) VALUE 3835.
  1117     12  ER-4005                 PIC  9(4) VALUE 4005.
  1118     12  ER-7144                 PIC  9(4) VALUE 7144.
  1119     12  ER-7401                 PIC  9(4) VALUE 7401.
  1120     12  ER-7402                 PIC  9(4) VALUE 7402.
  1121     12  ER-7403                 PIC  9(4) VALUE 7403.
  1122     12  ER-7404                 PIC  9(4) VALUE 7404.
  1123     12  ER-7423                 PIC  9(4) VALUE 7423.
  1124     12  ER-7424                 PIC  9(4) VALUE 7424.
  1125     12  ER-7433                 PIC  9(4) VALUE 7433.
  1126     12  ER-7450                 PIC  9(4) VALUE 7450.
  1127     12  ER-7451                 PIC  9(4) VALUE 7451.
  1128     12  ER-7530                 PIC  9(4) VALUE 7530.
  1129     12  ER-7573                 PIC  9(4) VALUE 7573.
  1130     12  ER-7631                 PIC  9(4) VALUE 7631.
  1131     12  ER-7632                 PIC  9(4) VALUE 7632.
  1132     12  ER-7633                 PIC  9(4) VALUE 7633.
  1133     12  ER-7537                 PIC  9(4) VALUE 7537.
  1134     12  ER-7538                 PIC  9(4) VALUE 7538.
  1135     12  ER-7574                 PIC  9(4) VALUE 7574.
  1136     12  ER-7997                 PIC  9(4) VALUE 7997.
  1137     12  ER-7998                 PIC  9(4) VALUE 7998.
  1138     12  ER-8148                 PIC  9(4) VALUE 8148.
  1139     12  ER-9063                 PIC  9(4) VALUE 9063.
  1140     12  ER-9076                 PIC  9(4) VALUE 9076.
  1141     12  ER-9618                 PIC  9(4) VALUE 9618.
  1142     12  ER-9841                 PIC  9(4) VALUE 9841.
  1143
  1144*                                COPY ELCTEXT.
  1145******************************************************************
  1146*                                                                *
  1147*                                                                *
  1148*                            ELCTEXT.                            *
  1149*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1150*                            VMOD=2.008                          *
  1151*                                                                *
  1152*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1153*                                     FORM LETTERS,              *
  1154*                                     CERT FORM DISPLAY.
  1155*                                                                *
  1156*   FILE TYPE = VSAM,KSDS                                        *
  1157*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1158*                                                                *
  1159*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1160*       ALTERNATE INDEX = NONE                                   *
  1161*                                                                *
  1162*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1163*       ALTERNATE INDEX = NONE                                   *
  1164*                                                                *
  1165*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1166*       ALTERNATE INDEX = NONE                                   *
  1167*                                                                *
  1168*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  23
* EL6311.cbl
  1169*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1170******************************************************************
  1171 01  TEXT-FILES.
  1172     12  TEXT-FILE-ID                PIC XX.
  1173         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1174         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1175         88  HELP-FILE-TEXT             VALUE 'TH'.
  1176
  1177     12  TX-CONTROL-PRIMARY.
  1178         16  TX-COMPANY-CD           PIC X.
  1179             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1180         16  TX-ACCESS-CD-GENL       PIC X(12).
  1181
  1182         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1183             20  TX-LETTER-NO        PIC X(4).
  1184             20  FILLER              PIC X(8).
  1185
  1186         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1187             20  TX-FORM-NO          PIC X(12).
  1188
  1189         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1190             20  TX-HELP-TYPE        PIC X.
  1191                 88  HELP-FOR-GENERAL   VALUE ' '.
  1192                 88  HELP-BY-SCREEN     VALUE 'S'.
  1193                 88  HELP-BY-ERROR      VALUE 'E'.
  1194             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1195                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1196             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1197                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1198             20  FILLER              PIC X(4).
  1199
  1200         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1201
  1202     12  TX-PROCESS-CONTROL          PIC XX.
  1203         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1204
  1205     12  TX-TEXT-LINE                PIC X(70).
  1206
  1207     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1208         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1209         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1210         88  TX-VALID-FORM-SQUEEZE-VALUE
  1211                                        VALUE 'Y' ' '.
  1212
  1213     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1214         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1215         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1216         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1217         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1218         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1219         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1220         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1221                                              'K' 'N' ' '
  1222                                              'Z'.
  1223
  1224     12  TX-ARCHIVE-SW               PIC X.
  1225         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1226         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  24
* EL6311.cbl
  1227         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1228
  1229     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1230     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1231
  1232     12  TX-BSR-CODE                 PIC X.
  1233         88  TX-BSR-LETTER              VALUE 'B'.
  1234         88  TX-NON-BSR-LETTER          VALUE ' '.
  1235
  1236     12  FILLER                      PIC X.
  1237*****************************************************************
  1238*                                COPY ELCCRTO.
  1239******************************************************************
  1240*                                                                *
  1241*                            ELCCRTO.                            *
  1242*                                                                *
  1243*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1244*                                                                *
  1245*   FILE TYPE = VSAM,KSDS                                        *
  1246*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1247*                                                                *
  1248*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1249*                                                                *
  1250*   LOG = YES                                                    *
  1251*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1252******************************************************************
  1253*                   C H A N G E   L O G
  1254*
  1255* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1256*-----------------------------------------------------------------
  1257*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1258* EFFECTIVE    NUMBER
  1259*-----------------------------------------------------------------
  1260* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1261* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1262* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1263* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1264* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1265******************************************************************
  1266 01  ORIGINAL-CERTIFICATE.
  1267     12  OC-RECORD-ID                      PIC XX.
  1268         88  VALID-OC-ID                      VALUE 'OC'.
  1269     12  OC-CONTROL-PRIMARY.
  1270         16  OC-COMPANY-CD                 PIC X.
  1271         16  OC-CARRIER                    PIC X.
  1272         16  OC-GROUPING                   PIC X(6).
  1273         16  OC-STATE                      PIC XX.
  1274         16  OC-ACCOUNT                    PIC X(10).
  1275         16  OC-CERT-EFF-DT                PIC XX.
  1276         16  OC-CERT-NO.
  1277             20  OC-CERT-PRIME             PIC X(10).
  1278             20  OC-CERT-SFX               PIC X.
  1279         16  OC-RECORD-TYPE                PIC X.
  1280         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1281     12  OC-LAST-MAINT-DT                  PIC XX.
  1282     12  OC-LAST-MAINT-BY                  PIC X(4).
  1283     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1284     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  25
* EL6311.cbl
  1285     12  FILLER                            PIC X(49).
  1286     12  OC-ORIG-REC.
  1287         16  OC-INS-LAST-NAME              PIC X(15).
  1288         16  OC-INS-FIRST-NAME             PIC X(10).
  1289         16  OC-INS-MIDDLE-INIT            PIC X.
  1290         16  OC-INS-AGE                    PIC S999     COMP-3.
  1291         16  OC-JNT-LAST-NAME              PIC X(15).
  1292         16  OC-JNT-FIRST-NAME             PIC X(10).
  1293         16  OC-JNT-MIDDLE-INIT            PIC X.
  1294         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1295         16  OC-LF-BENCD                   PIC XX.
  1296         16  OC-LF-TERM                    PIC S999      COMP-3.
  1297         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1298         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1299         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1300         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1301         16  OC-LF-EXP-DT                  PIC XX.
  1302         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1303         16  OC-LF-CANCEL-DT               PIC XX.
  1304         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1305         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1306         16  OC-AH-BENCD                   PIC XX.
  1307         16  OC-AH-TERM                    PIC S999      COMP-3.
  1308         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1309         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1310         16  OC-AH-EXP-DT                  PIC XX.
  1311         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1312         16  OC-AH-CP                      PIC 99.
  1313         16  OC-AH-CANCEL-DT               PIC XX.
  1314         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1315         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1316         16  OC-CRED-BENE-NAME             PIC X(25).
  1317         16  OC-1ST-PMT-DT                 PIC XX.
  1318         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1319         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1320         16  OC-ISSUE-TRAN-IND             PIC X.
  1321         16  OC-CANCEL-TRAN-IND            PIC X.
  1322         16  FILLER                        PIC X(211).
  1323
  1324     12  FILLER                            PIC X(50).
  1325******************************************************************
  1326*                                COPY ERCACCT.
  1327******************************************************************
  1328*                                                                *
  1329*                                                                *
  1330*                            ERCACCT                             *
  1331*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1332*                            VMOD=2.031                          *
  1333*                                                                *
  1334*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1335*                                                                *
  1336*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1337*   VSAM ACCOUNT MASTER FILES.                                   *
  1338*                                                                *
  1339*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1340*                                                                *
  1341*   FILE TYPE = VSAM,KSDS                                        *
  1342*   RECORD SIZE = 2000  RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  26
* EL6311.cbl
  1343*                                                                *
  1344*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1345*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1346*                                                                *
  1347*   LOG = NO                                                     *
  1348*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1349*                                                                *
  1350*                                                                *
  1351******************************************************************
  1352*                   C H A N G E   L O G
  1353*
  1354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1355*-----------------------------------------------------------------
  1356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1357* EFFECTIVE    NUMBER
  1358*-----------------------------------------------------------------
  1359* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1360* 092705    2005050300006  PEMA  ADD SPP LEASES
  1361* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1362* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1363* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1364* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1365* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1366* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1367******************************************************************
  1368
  1369 01  ACCOUNT-MASTER.
  1370     12  AM-RECORD-ID                      PIC XX.
  1371         88  VALID-AM-ID                      VALUE 'AM'.
  1372
  1373     12  AM-CONTROL-PRIMARY.
  1374         16  AM-COMPANY-CD                 PIC X.
  1375         16  AM-MSTR-CNTRL.
  1376             20  AM-CONTROL-A.
  1377                 24  AM-CARRIER            PIC X.
  1378                 24  AM-GROUPING.
  1379                     28 AM-GROUPING-PREFIX PIC XXX.
  1380                     28 AM-GROUPING-PRIME  PIC XXX.
  1381                 24  AM-STATE              PIC XX.
  1382                 24  AM-ACCOUNT.
  1383                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1384                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1385             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1386                                           PIC X(19).
  1387             20  AM-CNTRL-B.
  1388                 24  AM-EXPIRATION-DT      PIC XX.
  1389                 24  FILLER                PIC X(4).
  1390             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1391                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1392
  1393     12  AM-CONTROL-BY-VAR-GRP.
  1394         16  AM-COMPANY-CD-A1              PIC X.
  1395         16  AM-VG-CARRIER                 PIC X.
  1396         16  AM-VG-GROUPING                PIC X(6).
  1397         16  AM-VG-STATE                   PIC XX.
  1398         16  AM-VG-ACCOUNT                 PIC X(10).
  1399         16  AM-VG-DATE.
  1400             20  AM-VG-EXPIRATION-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  27
* EL6311.cbl
  1401             20  FILLER                    PIC X(4).
  1402         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1403                                           PIC 9(11)      COMP-3.
  1404     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1405         16  FILLER                        PIC X(10).
  1406         16  AM-VG-KEY3.
  1407             20  AM-VG3-ACCOUNT            PIC X(10).
  1408             20  AM-VG3-EXP-DT             PIC XX.
  1409         16  FILLER                        PIC X(4).
  1410     12  AM-MAINT-INFORMATION.
  1411         16  AM-LAST-MAINT-DT              PIC XX.
  1412         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1413         16  AM-LAST-MAINT-USER            PIC X(4).
  1414         16  FILLER                        PIC XX.
  1415
  1416     12  AM-EFFECTIVE-DT                   PIC XX.
  1417     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1418
  1419     12  AM-PREV-DATES  COMP-3.
  1420         16  AM-PREV-EXP-DT                PIC 9(11).
  1421         16  AM-PREV-EFF-DT                PIC 9(11).
  1422
  1423     12  AM-REPORT-CODE-1                  PIC X(10).
  1424     12  AM-REPORT-CODE-2                  PIC X(10).
  1425
  1426     12  AM-CITY-CODE                      PIC X(4).
  1427     12  AM-COUNTY-PARISH                  PIC X(6).
  1428
  1429     12  AM-NAME                           PIC X(30).
  1430     12  AM-PERSON                         PIC X(30).
  1431     12  AM-ADDRS                          PIC X(30).
  1432     12  AM-CITY.
  1433         16  AM-ADDR-CITY                  PIC X(28).
  1434         16  AM-ADDR-STATE                 PIC XX.
  1435     12  AM-ZIP.
  1436         16  AM-ZIP-PRIME.
  1437             20  AM-ZIP-PRI-1ST            PIC X.
  1438                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1439             20  FILLER                    PIC X(4).
  1440         16  AM-ZIP-PLUS4                  PIC X(4).
  1441     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1442         16  AM-CAN-POSTAL-1               PIC XXX.
  1443         16  AM-CAN-POSTAL-2               PIC XXX.
  1444         16  FILLER                        PIC XXX.
  1445     12  AM-TEL-NO.
  1446         16  AM-AREA-CODE                  PIC 999.
  1447         16  AM-TEL-PRE                    PIC 999.
  1448         16  AM-TEL-NBR                    PIC 9(4).
  1449     12  AM-TEL-LOC                        PIC X.
  1450         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1451         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1452
  1453     12  AM-COMM-STRUCTURE.
  1454         16  AM-DEFN-1.
  1455             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1456                 24  AM-AGT.
  1457                     28  AM-AGT-PREFIX     PIC X(4).
  1458                     28  AM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  28
* EL6311.cbl
  1459                 24  AM-COM-TYP            PIC X.
  1460                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1461                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1462                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1463                 24  AM-RECALC-LV-INDIC    PIC X.
  1464                 24  AM-RETRO-LV-INDIC     PIC X.
  1465                 24  AM-GL-CODES           PIC X.
  1466                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1467                 24  FILLER                PIC X(01).
  1468         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1469             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1470                 24  FILLER                PIC X(11).
  1471                 24  AM-L-COMA             PIC XXX.
  1472                 24  AM-J-COMA             PIC XXX.
  1473                 24  AM-A-COMA             PIC XXX.
  1474                 24  FILLER                PIC X(6).
  1475
  1476     12  AM-COMM-CHANGE-STATUS             PIC X.
  1477         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1478
  1479     12  AM-CSR-CODE                       PIC X(4).
  1480
  1481     12  AM-BILLING-STATUS                 PIC X.
  1482         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1483         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1484     12  AM-AUTO-REFUND-SW                 PIC X.
  1485         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1486         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1487     12  AM-GPCD                           PIC 99.
  1488     12  AM-IG                             PIC X.
  1489         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1490         88  AM-HAS-GROUP                     VALUE '2'.
  1491     12  AM-STATUS                         PIC X.
  1492         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1493         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1494         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1495         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1496         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1497         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1498         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1499         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1500         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1501         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1502     12  AM-REMIT-TO                       PIC 99.
  1503     12  AM-ID-NO                          PIC X(11).
  1504
  1505     12  AM-CAL-TABLE                      PIC XX.
  1506     12  AM-LF-DEVIATION                   PIC XXX.
  1507     12  AM-AH-DEVIATION                   PIC XXX.
  1508     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1509     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1510     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1511     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1512     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1513     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1514
  1515     12  AM-USER-FIELDS.
  1516         16  AM-FLD-1                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  29
* EL6311.cbl
  1517         16  AM-FLD-2                      PIC XX.
  1518         16  AM-FLD-3                      PIC XX.
  1519         16  AM-FLD-4                      PIC XX.
  1520         16  AM-FLD-5                      PIC XX.
  1521
  1522     12  AM-1ST-PROD-DATE.
  1523         16  AM-1ST-PROD-YR                PIC XX.
  1524         16  AM-1ST-PROD-MO                PIC XX.
  1525         16  AM-1ST-PROD-DA                PIC XX.
  1526     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1527     12  AM-CERTS-PURGED-DATE.
  1528         16  AM-PUR-YR                     PIC XX.
  1529         16  AM-PUR-MO                     PIC XX.
  1530         16  AM-PUR-DA                     PIC XX.
  1531     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1532     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1533     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1534     12  AM-INACTIVE-DATE.
  1535         16  AM-INA-MO                     PIC 99.
  1536         16  AM-INA-DA                     PIC 99.
  1537         16  AM-INA-YR                     PIC 99.
  1538     12  AM-AR-HI-CERT-DATE                PIC XX.
  1539
  1540     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1541     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1542
  1543     12  AM-OB-PAYMENT-MODE                PIC X.
  1544         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1545         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1546         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1547         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1548
  1549     12  AM-AH-ONLY-INDICATOR              PIC X.
  1550         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1551         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1552
  1553     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1554
  1555     12  AM-OVER-SHORT.
  1556         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1557         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1558
  1559     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1560     12  AM-DCC-CLP-STATE                  PIC XX.
  1561
  1562     12  AM-RECALC-COMM                    PIC X.
  1563     12  AM-RECALC-REIN                    PIC X.
  1564
  1565     12  AM-REI-TABLE                      PIC XXX.
  1566     12  AM-REI-ET-LF                      PIC X.
  1567     12  AM-REI-ET-AH                      PIC X.
  1568     12  AM-REI-PE-LF                      PIC X.
  1569     12  AM-REI-PE-AH                      PIC X.
  1570     12  AM-REI-PRT-ST                     PIC X.
  1571     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1572     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1573     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1574     12  AM-REI-GROUP-A                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  30
* EL6311.cbl
  1575     12  AM-REI-MORT                       PIC X(4).
  1576     12  AM-REI-PRT-OW                     PIC X.
  1577     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1578     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1579     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1580     12  AM-REI-GROUP-B                    PIC X(6).
  1581
  1582     12  AM-TRUST-TYPE                     PIC X(2).
  1583
  1584     12  AM-EMPLOYER-STMT-USED             PIC X.
  1585     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1586
  1587     12  AM-STD-AH-TYPE                    PIC XX.
  1588     12  AM-EARN-METHODS.
  1589         16  AM-EARN-METHOD-R              PIC X.
  1590             88 AM-REF-RL-R78                 VALUE 'R'.
  1591             88 AM-REF-RL-PR                  VALUE 'P'.
  1592             88 AM-REF-RL-MEAN                VALUE 'M'.
  1593             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1594         16  AM-EARN-METHOD-L              PIC X.
  1595             88 AM-REF-LL-R78                 VALUE 'R'.
  1596             88 AM-REF-LL-PR                  VALUE 'P'.
  1597             88 AM-REF-LL-MEAN                VALUE 'M'.
  1598             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1599         16  AM-EARN-METHOD-A              PIC X.
  1600             88 AM-REF-AH-R78                 VALUE 'R'.
  1601             88 AM-REF-AH-PR                  VALUE 'P'.
  1602             88 AM-REF-AH-MEAN                VALUE 'M'.
  1603             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1604             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1605             88 AM-REF-AH-NET                 VALUE 'N'.
  1606
  1607     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1608     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1609     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1610
  1611     12  AM-RET-Y-N                        PIC X.
  1612     12  AM-RET-P-E                        PIC X.
  1613     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1614     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1615     12  AM-RET-GRP                        PIC X(6).
  1616     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1617         16  AM-POOL-PRIME                 PIC XXX.
  1618         16  AM-POOL-SUB                   PIC XXX.
  1619     12  AM-RETRO-EARNINGS.
  1620         16  AM-RET-EARN-R                 PIC X.
  1621         16  AM-RET-EARN-L                 PIC X.
  1622         16  AM-RET-EARN-A                 PIC X.
  1623     12  AM-RET-ST-TAX-USE                 PIC X.
  1624         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1625         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1626     12  AM-RETRO-BEG-EARNINGS.
  1627         16  AM-RET-BEG-EARN-R             PIC X.
  1628         16  AM-RET-BEG-EARN-L             PIC X.
  1629         16  AM-RET-BEG-EARN-A             PIC X.
  1630     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1631     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1632
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  31
* EL6311.cbl
  1633     12  AM-USER-SELECT-OPTIONS.
  1634         16  AM-USER-SELECT-1              PIC X(10).
  1635         16  AM-USER-SELECT-2              PIC X(10).
  1636         16  AM-USER-SELECT-3              PIC X(10).
  1637         16  AM-USER-SELECT-4              PIC X(10).
  1638         16  AM-USER-SELECT-5              PIC X(10).
  1639
  1640     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1641
  1642     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1643
  1644     12  AM-RPT045A-SWITCH                 PIC X.
  1645         88  RPT045A-OFF                   VALUE 'N'.
  1646
  1647     12  AM-INSURANCE-LIMITS.
  1648         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1649         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1650
  1651     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1652         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1653
  1654     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1655         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1656         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1657
  1658     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1659
  1660     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1661     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1662     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1663     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1664     12  AM-DCC-UEF-STATE                  PIC XX.
  1665     12  FILLER                            PIC XXX.
  1666     12  AM-REPORT-CODE-3                  PIC X(10).
  1667*    12  FILLER                            PIC X(22).
  1668
  1669     12  AM-RESERVE-DATE.
  1670         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1671         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1672         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1673
  1674     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1675     12  AM-NOTIFICATION-TYPES.
  1676         16  AM-NOTIF-OF-LETTERS           PIC X.
  1677         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1678         16  AM-NOTIF-OF-REPORTS           PIC X.
  1679         16  AM-NOTIF-OF-STATUS            PIC X.
  1680
  1681     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1682         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1683         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1684         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1685         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1686
  1687     12  AM-BENEFIT-CONTROLS.
  1688         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1689             20  AM-BENEFIT-CODE           PIC XX.
  1690             20  AM-BENEFIT-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  32
* EL6311.cbl
  1691             20  AM-BENEFIT-REVISION       PIC XXX.
  1692             20  AM-BENEFIT-REM-TERM       PIC X.
  1693             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1694             20  FILLER                    PIC XX.
  1695         16  FILLER                        PIC X(80).
  1696
  1697     12  AM-TRANSFER-DATA.
  1698         16  AM-TRANSFERRED-FROM.
  1699             20  AM-TRNFROM-CARRIER        PIC X.
  1700             20  AM-TRNFROM-GROUPING.
  1701                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1702                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1703             20  AM-TRNFROM-STATE          PIC XX.
  1704             20  AM-TRNFROM-ACCOUNT.
  1705                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1706                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1707             20  AM-TRNFROM-DTE            PIC XX.
  1708         16  AM-TRANSFERRED-TO.
  1709             20  AM-TRNTO-CARRIER          PIC X.
  1710             20  AM-TRNTO-GROUPING.
  1711                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1712                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1713             20  AM-TRNTO-STATE            PIC XX.
  1714             20  AM-TRNTO-ACCOUNT.
  1715                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1716                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1717             20  AM-TRNTO-DTE              PIC XX.
  1718         16  FILLER                        PIC X(10).
  1719
  1720     12  AM-SAVED-REMIT-TO                 PIC 99.
  1721
  1722     12  AM-COMM-STRUCTURE-SAVED.
  1723         16  AM-DEFN-1-SAVED.
  1724             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1725                 24  AM-AGT-SV             PIC X(10).
  1726                 24  AM-COM-TYP-SV         PIC X.
  1727                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1728                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1729                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1730                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1731                 24  FILLER                PIC X.
  1732                 24  AM-GL-CODES-SV        PIC X.
  1733                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1734                 24  FILLER                PIC X.
  1735         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1736             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1737                 24  FILLER                PIC X(11).
  1738                 24  AM-L-COMA-SV          PIC XXX.
  1739                 24  AM-J-COMA-SV          PIC XXX.
  1740                 24  AM-A-COMA-SV          PIC XXX.
  1741                 24  FILLER                PIC X(6).
  1742
  1743     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1744         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1745            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1746            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1747            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1748
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  33
* EL6311.cbl
  1749     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1750     12  FILLER                            PIC X(120).
  1751
  1752     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1753         16  AM-CONTROL-NAME               PIC X(30).
  1754         16  AM-EXECUTIVE-ONE.
  1755             20  AM-EXEC1-NAME             PIC X(15).
  1756             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1757                                                          COMP-3.
  1758             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1759                                                          COMP-3.
  1760         16  AM-EXECUTIVE-TWO.
  1761             20  AM-EXEC2-NAME             PIC X(15).
  1762             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1763                                                          COMP-3.
  1764             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1765                                                          COMP-3.
  1766
  1767     12  AM-RETRO-ADDITIONAL-DATA.
  1768         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1769         16  AM-RETRO-PREM-P-E             PIC X.
  1770         16  AM-RETRO-CLMS-P-I             PIC X.
  1771         16  AM-RETRO-RET-BRACKET-LF.
  1772             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1773                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1774                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1775             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1776                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1777                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1778             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1779                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1780                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1781         16  AM-RETRO-RET-BRACKET-AH.
  1782             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1783                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1784                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1785                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1786             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1787                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1788                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1789             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1790                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1791                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1792
  1793     12  AM-COMMENTS.
  1794         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1795
  1796     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1797         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1798         16  AM-FLI-BILLING-CODE           PIC X.
  1799         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1800         16  AM-FLI-UNITED-IDENT           PIC X.
  1801         16  AM-FLI-INTEREST-LOST-DATA.
  1802             20  AM-FLI-BANK-NO            PIC X(5).
  1803             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1804             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1805             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1806         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  34
* EL6311.cbl
  1807             20  AM-FLI-AGT                PIC X(9).
  1808             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1809             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1810         16  FILLER                        PIC X(102).
  1811
  1812     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1813         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1814             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1815             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1816             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1817             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1818             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1819         16  FILLER                          PIC X(10).
  1820******************************************************************
  1821*                                copy ERCACNT.
  1822******************************************************************
  1823*                                                                *
  1824*                                                                *
  1825*                            ERCACNT.                            *
  1826*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1827*                            VMOD=2.002                          *
  1828*                                                                *
  1829*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1830*                                                                *
  1831*   FILE TYPE = VSAM,KSDS                                        *
  1832*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1833*                                                                *
  1834*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1835*       ALTERNATE INDEX = NONE                                   *
  1836*                                                                *
  1837*                                                                *
  1838*   LOG = YES                                                    *
  1839*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1840******************************************************************
  1841*                   C H A N G E   L O G
  1842*
  1843* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1844*-----------------------------------------------------------------
  1845*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1846* EFFECTIVE    NUMBER
  1847*-----------------------------------------------------------------
  1848* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1849*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1850******************************************************************
  1851 01  NOTE-FILE.
  1852     12  NT-FILE-ID                  PIC XX.
  1853         88  VALID-NOTE-ID              VALUE 'NT'.
  1854
  1855     12  NT-CONTROL-PRIMARY.
  1856         16  NT-COMPANY-CD           PIC X.
  1857         16  NT-ACCT-NOTE-KEY.
  1858             18  NT-CARRIER              PIC X.
  1859             18  NT-GROUPING             PIC X(06).
  1860             18  NT-STATE                PIC XX.
  1861             18  NT-ACCOUNT              PIC X(10).
  1862         16  NT-RECORD-TYPE          PIC X.
  1863              88  ACCT-NOTE          VALUE '1'.
  1864              88  ACCT-BRANCH-LOC    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  35
* EL6311.cbl
  1865              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1866         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1867
  1868     12  NT-LAST-MAINT-DT            PIC XX.
  1869     12  NT-LAST-MAINT-BY            PIC X(4).
  1870     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1871
  1872*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1873*     SEQUENCE NUMBERS
  1874     12  NT-NOTE-INFORMATION.
  1875         16  NT-NOTE-LINE            PIC X(60).
  1876         16  FILLER                  PIC X(25).
  1877*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1878     12  NT-LOCATION-INFORMATION REDEFINES
  1879                         NT-NOTE-INFORMATION.
  1880         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1881         16  FILLER                  PIC X(25).
  1882* Account special indicator is record type '2', sequence 3
  1883     12  filler REDEFINES NT-NOTE-INFORMATION.
  1884         16  nt-account-special      PIC X.
  1885         16  FILLER                  PIC X(84).
  1886*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1887*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1888*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1889*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1890*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1891*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1892*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1893     12  NT-SHIPPING-INFORMATION REDEFINES
  1894                         NT-NOTE-INFORMATION.
  1895         16  NT-SHIPPING-LINE        PIC X(60).
  1896         16  NT-SHIP-STATE           PIC XX.
  1897         16  NT-SHIP-ZIP             PIC X(10).
  1898         16  FILLER                  PIC X(13).
  1899*****************************************************************
  1900*                                COPY ELCVADS.
  1901******************************************************************
  1902*                                                                *
  1903*                                                                *
  1904*                            ELCVADS.                            *
  1905*                                                                *
  1906*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1907*   ELVADS                  LENGTH = 350                         *
  1908******************************************************************
  1909******************************************************************
  1910*                   C H A N G E   L O G
  1911*
  1912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1913*-----------------------------------------------------------------
  1914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1915* EFFECTIVE    NUMBER
  1916*-----------------------------------------------------------------
  1917* 100111    2011022800001  AJRA  NAPERSOFT
  1918******************************************************************
  1919
  1920 01  VIRGINIA-DISCLOSURE.
  1921     12  VD-COMPANY-CD              PIC X.
  1922     12  VD-CARRIER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  36
* EL6311.cbl
  1923     12  VD-GROUPING.
  1924         20  VD-GROUPING-PREFIX     PIC XXX.
  1925         20  VD-GROUPING-PRIME      PIC XXX.
  1926     12  VD-STATE                   PIC XX.
  1927     12  VD-ACCOUNT.
  1928         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1929         20  VD-ACCOUNT-PRIME       PIC X(6).
  1930     12  VD-CERT-EFF-DT             PIC XX.
  1931     12  VD-CERT-NO.
  1932         20  VD-CERT-PRIME          PIC X(10).
  1933         20  VD-CERT-SFX            PIC X.
  1934     12  VD-ENTRY-BATCH             PIC X(6).
  1935     12  VD-CSR-ID                  PIC X(4).
  1936     12  VD-NAME.
  1937         20  VD-INSURED-LAST-NAME   PIC X(15).
  1938         20  VD-INSURED-FIRST-NAME.
  1939             24  VD-INSURED-1ST-INIT PIC X.
  1940             24  FILLER             PIC X(9).
  1941         20  VD-INSURED-MIDDLE-INIT PIC X.
  1942     12  VD-JOINT-INSURED.
  1943         20 VD-JOINT-LAST-NAME      PIC X(15).
  1944         20 VD-JOINT-FIRST-NAME.
  1945            24  VD-JOINT-FIRST-INIT PIC X.
  1946            24  FILLER              PIC X(9).
  1947         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1948     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1949     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1950     12  VD-INSURED-CITY-STATE.
  1951         20  VD-INSURED-CITY        PIC X(28).
  1952         20  VD-INSURED-STATE       PIC XX.
  1953     12  VD-INSURED-ZIP-CODE.
  1954         20  VD-INSURED-ZIP-PRIME.
  1955             24  VD-INSURED-ZIP-1   PIC X.
  1956                 88  VD-CANADIAN-POST-CODE
  1957                                       VALUE 'A' THRU 'Z'.
  1958             24  FILLER             PIC X(4).
  1959         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1960     12  VD-BENEFICIARY-NAME        PIC X(30).
  1961     12  VD-ACCOUNT-NAME            PIC X(30).
  1962     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1963     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1964     12  VD-1ST-PMT-DT              PIC XX.
  1965     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1966         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1967         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1968                                             '90' THRU '99'.
  1969     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1970                                    PIC XX.
  1971     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1972     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1973     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1974     12  VD-LF-TERM                 PIC S999   COMP-3.
  1975     12  VD-AH-BENEFIT-CD           PIC XX.
  1976         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1977         88  VD-INVALID-AH             VALUE '  ' '00'
  1978                                             '90' THRU '99'.
  1979     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1980     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  37
* EL6311.cbl
  1981     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1982     12  VD-AH-TERM                 PIC S999   COMP-3.
  1983     12  VD-LETTER-ID               PIC X(4).
  1984     12  VD-PROC-ID                 PIC X(4).
  1985     12  VD-COMP-ID                 PIC X(3).
  1986     12  VD-CURRENT-DATE            PIC XX.
  1987     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1988     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1989     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  38
* EL6311.cbl
  1991*    COPY ELCDATE.
  1992******************************************************************
  1993*                                                                *
  1994*                                                                *
  1995*                            ELCDATE.                            *
  1996*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1997*                            VMOD=2.003
  1998*                                                                *
  1999*                                                                *
  2000*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2001*                 LENGTH = 200                                   *
  2002******************************************************************
  2003
  2004 01  DATE-CONVERSION-DATA.
  2005     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2006     12  DC-OPTION-CODE                PIC X.
  2007         88  BIN-TO-GREG                VALUE ' '.
  2008         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2009         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2010         88  YMD-GREG-TO-BIN            VALUE '3'.
  2011         88  MDY-GREG-TO-BIN            VALUE '4'.
  2012         88  JULIAN-TO-BIN              VALUE '5'.
  2013         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2014         88  FIND-CENTURY               VALUE '7'.
  2015         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2016         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2017         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2018         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2019         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2020         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2021         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2022         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2023         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2024         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2025         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2026         88  BIN-3-TO-GREG              VALUE 'I'.
  2027         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2028         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2029         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2030         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2031         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2032         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2033         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2034         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2035         88  THREE-CHARACTER-BIN
  2036                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2037         88  GREGORIAN-TO-BIN
  2038                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2039         88  BIN-TO-GREGORIAN
  2040                  VALUES ' ' '1' 'I' '8' 'G'.
  2041         88  JULIAN-TO-BINARY
  2042                  VALUES '5' 'C' 'E' 'F'.
  2043     12  DC-ERROR-CODE                 PIC X.
  2044         88  NO-CONVERSION-ERROR        VALUE ' '.
  2045         88  DATE-CONVERSION-ERROR
  2046                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2047         88  DATE-IS-ZERO               VALUE '1'.
  2048         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  39
* EL6311.cbl
  2049         88  DATE-IS-INVALID            VALUE '3'.
  2050         88  DATE1-GREATER-DATE2        VALUE '4'.
  2051         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2052         88  DATE-INVALID-OPTION        VALUE '9'.
  2053         88  INVALID-CENTURY            VALUE 'A'.
  2054         88  ONLY-CENTURY               VALUE 'B'.
  2055         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2056         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2057     12  DC-END-OF-MONTH               PIC X.
  2058         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2059     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2060         88  USE-NORMAL-PROCESS         VALUE ' '.
  2061         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2062         88  ADJUST-UP-100-YRS          VALUE '2'.
  2063     12  FILLER                        PIC X.
  2064     12  DC-CONVERSION-DATES.
  2065         16  DC-BIN-DATE-1             PIC XX.
  2066         16  DC-BIN-DATE-2             PIC XX.
  2067         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2068         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2069                       DC-GREG-DATE-1-EDIT.
  2070             20  DC-EDIT1-MONTH        PIC 99.
  2071             20  SLASH1-1              PIC X.
  2072             20  DC-EDIT1-DAY          PIC 99.
  2073             20  SLASH1-2              PIC X.
  2074             20  DC-EDIT1-YEAR         PIC 99.
  2075         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2076         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2077                     DC-GREG-DATE-2-EDIT.
  2078             20  DC-EDIT2-MONTH        PIC 99.
  2079             20  SLASH2-1              PIC X.
  2080             20  DC-EDIT2-DAY          PIC 99.
  2081             20  SLASH2-2              PIC X.
  2082             20  DC-EDIT2-YEAR         PIC 99.
  2083         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2084         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2085                     DC-GREG-DATE-1-YMD.
  2086             20  DC-YMD-YEAR           PIC 99.
  2087             20  DC-YMD-MONTH          PIC 99.
  2088             20  DC-YMD-DAY            PIC 99.
  2089         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2090         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2091                      DC-GREG-DATE-1-MDY.
  2092             20  DC-MDY-MONTH          PIC 99.
  2093             20  DC-MDY-DAY            PIC 99.
  2094             20  DC-MDY-YEAR           PIC 99.
  2095         16  DC-GREG-DATE-1-ALPHA.
  2096             20  DC-ALPHA-MONTH        PIC X(10).
  2097             20  DC-ALPHA-DAY          PIC 99.
  2098             20  FILLER                PIC XX.
  2099             20  DC-ALPHA-CENTURY.
  2100                 24 DC-ALPHA-CEN-N     PIC 99.
  2101             20  DC-ALPHA-YEAR         PIC 99.
  2102         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2103         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2104         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2105         16  DC-JULIAN-DATE            PIC 9(05).
  2106         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  40
* EL6311.cbl
  2107                                       PIC 9(05).
  2108         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2109             20  DC-JULIAN-YEAR        PIC 99.
  2110             20  DC-JULIAN-DAYS        PIC 999.
  2111         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2112         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2113         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2114     12  DATE-CONVERSION-VARIBLES.
  2115         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2116         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2117             20  FILLER                PIC 9(3).
  2118             20  HOLD-CEN-1-CCYY.
  2119                 24  HOLD-CEN-1-CC     PIC 99.
  2120                 24  HOLD-CEN-1-YY     PIC 99.
  2121             20  HOLD-CEN-1-MO         PIC 99.
  2122             20  HOLD-CEN-1-DA         PIC 99.
  2123         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2124             20  HOLD-CEN-1-R-MO       PIC 99.
  2125             20  HOLD-CEN-1-R-DA       PIC 99.
  2126             20  HOLD-CEN-1-R-CCYY.
  2127                 24  HOLD-CEN-1-R-CC   PIC 99.
  2128                 24  HOLD-CEN-1-R-YY   PIC 99.
  2129             20  FILLER                PIC 9(3).
  2130         16  HOLD-CENTURY-1-X.
  2131             20  FILLER                PIC X(3)  VALUE SPACES.
  2132             20  HOLD-CEN-1-X-CCYY.
  2133                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2134                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2135             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2136             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2137         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2138             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2139             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2140             20  HOLD-CEN-1-R-X-CCYY.
  2141                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2142                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2143             20  FILLER                PIC XXX.
  2144         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2145         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2146         16  DC-JULIAN-DATE-1          PIC 9(07).
  2147         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2148             20  DC-JULIAN-1-CCYY.
  2149                 24  DC-JULIAN-1-CC    PIC 99.
  2150                 24  DC-JULIAN-1-YR    PIC 99.
  2151             20  DC-JULIAN-DA-1        PIC 999.
  2152         16  DC-JULIAN-DATE-2          PIC 9(07).
  2153         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2154             20  DC-JULIAN-2-CCYY.
  2155                 24  DC-JULIAN-2-CC    PIC 99.
  2156                 24  DC-JULIAN-2-YR    PIC 99.
  2157             20  DC-JULIAN-DA-2        PIC 999.
  2158         16  DC-GREG-DATE-A-EDIT.
  2159             20  DC-EDITA-MONTH        PIC 99.
  2160             20  SLASHA-1              PIC X VALUE '/'.
  2161             20  DC-EDITA-DAY          PIC 99.
  2162             20  SLASHA-2              PIC X VALUE '/'.
  2163             20  DC-EDITA-CCYY.
  2164                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  41
* EL6311.cbl
  2165                 24  DC-EDITA-YEAR     PIC 99.
  2166         16  DC-GREG-DATE-B-EDIT.
  2167             20  DC-EDITB-MONTH        PIC 99.
  2168             20  SLASHB-1              PIC X VALUE '/'.
  2169             20  DC-EDITB-DAY          PIC 99.
  2170             20  SLASHB-2              PIC X VALUE '/'.
  2171             20  DC-EDITB-CCYY.
  2172                 24  DC-EDITB-CENT     PIC 99.
  2173                 24  DC-EDITB-YEAR     PIC 99.
  2174         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2175         16  DC-GREG-DATE-CYMD-R REDEFINES
  2176                              DC-GREG-DATE-CYMD.
  2177             20  DC-CYMD-CEN           PIC 99.
  2178             20  DC-CYMD-YEAR          PIC 99.
  2179             20  DC-CYMD-MONTH         PIC 99.
  2180             20  DC-CYMD-DAY           PIC 99.
  2181         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2182         16  DC-GREG-DATE-MDCY-R REDEFINES
  2183                              DC-GREG-DATE-MDCY.
  2184             20  DC-MDCY-MONTH         PIC 99.
  2185             20  DC-MDCY-DAY           PIC 99.
  2186             20  DC-MDCY-CEN           PIC 99.
  2187             20  DC-MDCY-YEAR          PIC 99.
  2188    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2189        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2190    12  DC-EL310-DATE                  PIC X(21).
  2191    12  FILLER                         PIC X(28).
  2192
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  42
* EL6311.cbl
  2194*    COPY ELCLOGOF.
  2195******************************************************************
  2196*                                                                *
  2197*                                                                *
  2198*                            ELCLOGOF.                           *
  2199*                            VMOD=2.001                          *
  2200*                                                                *
  2201*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2202*                                                                *
  2203******************************************************************
  2204 01  CLASIC-LOGOFF.
  2205     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2206     12  LOGOFF-TEXT.
  2207         16  FILLER          PIC X(5)    VALUE SPACES.
  2208         16  LOGOFF-MSG.
  2209             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2210             20  FILLER      PIC X       VALUE SPACES.
  2211             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2212         16  FILLER          PIC X(80)
  2213           VALUE '* YOU ARE NOW LOGGED OFF'.
  2214         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2215         16  FILLER          PIC X       VALUE QUOTE.
  2216         16  LOGOFF-SYS-MSG  PIC X(17)
  2217           VALUE 'S CLAS-IC SYSTEM '.
  2218     12  TEXT-MESSAGES.
  2219         16  UNACCESS-MSG    PIC X(29)
  2220             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2221         16  PGMIDERR-MSG    PIC X(17)
  2222             VALUE 'PROGRAM NOT FOUND'.
  2223
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  43
* EL6311.cbl
  2225*    COPY ELCATTR.
  2226******************************************************************
  2227*                                                                *
  2228*                            ELCATTR.                            *
  2229*                            VMOD=2.001                          *
  2230*                                                                *
  2231*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2232*                                                                *
  2233*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2234*                                                                *
  2235*                   POS 1   P=PROTECTED                          *
  2236*                           U=UNPROTECTED                        *
  2237*                           S=ASKIP                              *
  2238*                   POS 2   A=ALPHA/NUMERIC                      *
  2239*                           N=NUMERIC                            *
  2240*                   POS 3   N=NORMAL                             *
  2241*                           B=BRIGHT                             *
  2242*                           D=DARK                               *
  2243*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2244*                           OF=MODIFIED DATA TAG OFF             *
  2245*                                                                *
  2246*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2247******************************************************************
  2248 01  ATTRIBUTE-LIST.
  2249     12  AL-PABOF            PIC X       VALUE 'Y'.
  2250     12  AL-PABON            PIC X       VALUE 'Z'.
  2251     12  AL-PADOF            PIC X       VALUE '%'.
  2252     12  AL-PADON            PIC X       VALUE '_'.
  2253     12  AL-PANOF            PIC X       VALUE '-'.
  2254     12  AL-PANON            PIC X       VALUE '/'.
  2255     12  AL-SABOF            PIC X       VALUE '8'.
  2256     12  AL-SABON            PIC X       VALUE '9'.
  2257     12  AL-SADOF            PIC X       VALUE '@'.
  2258     12  AL-SADON            PIC X       VALUE QUOTE.
  2259     12  AL-SANOF            PIC X       VALUE '0'.
  2260     12  AL-SANON            PIC X       VALUE '1'.
  2261     12  AL-UABOF            PIC X       VALUE 'H'.
  2262     12  AL-UABON            PIC X       VALUE 'I'.
  2263     12  AL-UADOF            PIC X       VALUE '<'.
  2264     12  AL-UADON            PIC X       VALUE '('.
  2265     12  AL-UANOF            PIC X       VALUE ' '.
  2266     12  AL-UANON            PIC X       VALUE 'A'.
  2267     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2268     12  AL-UNBON            PIC X       VALUE 'R'.
  2269     12  AL-UNDOF            PIC X       VALUE '*'.
  2270     12  AL-UNDON            PIC X       VALUE ')'.
  2271     12  AL-UNNOF            PIC X       VALUE '&'.
  2272     12  AL-UNNON            PIC X       VALUE 'J'.
  2273
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  44
* EL6311.cbl
  2275*    COPY ELCEMIB.
  2276******************************************************************
  2277*                                                                *
  2278*                                                                *
  2279*                            ELCEMIB.                            *
  2280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2281*                            VMOD=2.005                          *
  2282*                                                                *
  2283*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2284*                                                                *
  2285******************************************************************
  2286 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2287     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2288     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2289     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2290     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2291     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2292     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2293     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2294     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2295     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2296         88  EMI-NO-ERRORS                    VALUE '1'.
  2297         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2298         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2299     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2300         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2301     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2302         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2303         88  EMI-AREA1-FULL                   VALUE '2'.
  2304     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2305         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2306         88  EMI-AREA2-FULL                   VALUE '2'.
  2307     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2308         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2309         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2310         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2311         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2312         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2313     12  EMI-ERROR-LINES.
  2314         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2315         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2316         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2317         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2318             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2319                 24  EMI-ERR-NUM         PIC X(4).
  2320                 24  EMI-FILLER          PIC X.
  2321                 24  EMI-SEV             PIC X.
  2322                 24  FILLER              PIC X.
  2323             20  FILLER                  PIC X(02).
  2324     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2325         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2326             20  EMI-ERROR-NUMBER    PIC X(4).
  2327             20  EMI-FILL            PIC X.
  2328             20  EMI-SEVERITY        PIC X.
  2329             20  FILLER              PIC X.
  2330             20  EMI-ERROR-TEXT.
  2331                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2332                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  45
* EL6311.cbl
  2333     12  EMI-SEVERITY-SAVE           PIC X.
  2334         88  EMI-NOTE                    VALUE 'N'.
  2335         88  EMI-WARNING                 VALUE 'W'.
  2336         88  EMI-FORCABLE                VALUE 'F'.
  2337         88  EMI-FATAL                   VALUE 'X'.
  2338     12  EMI-MESSAGE-FLAG            PIC X.
  2339         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2340         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2341     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2342     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2343         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2344         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2345         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2346     12  emi-claim-no                pic x(7).
  2347     12  emi-claim-type              pic x(6).
  2348     12  FILLER                      PIC X(124)  VALUE SPACES.
  2349     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2350     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2351     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2352     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2353
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  46
* EL6311.cbl
  2355*    COPY ELCINTF.
  2356******************************************************************
  2357*                                                                *
  2358*                                                                *
  2359*                            ELCINTF.                            *
  2360*                            VMOD=2.017                          *
  2361*                                                                *
  2362*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2363*                                                                *
  2364*       LENGTH = 1024                                            *
  2365*                                                                *
  2366******************************************************************
  2367*                   C H A N G E   L O G
  2368*
  2369* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2370*-----------------------------------------------------------------
  2371*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2372* EFFECTIVE    NUMBER
  2373*-----------------------------------------------------------------
  2374* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2375******************************************************************
  2376 01  PROGRAM-INTERFACE-BLOCK.
  2377     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2378     12  PI-CALLING-PROGRAM              PIC X(8).
  2379     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2380     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2381     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2382     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2383     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2384     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2385     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2386     12  PI-COMPANY-ID                   PIC XXX.
  2387     12  PI-COMPANY-CD                   PIC X.
  2388
  2389     12  PI-COMPANY-PASSWORD             PIC X(8).
  2390
  2391     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2392
  2393     12  PI-CONTROL-IN-PROGRESS.
  2394         16  PI-CARRIER                  PIC X.
  2395         16  PI-GROUPING                 PIC X(6).
  2396         16  PI-STATE                    PIC XX.
  2397         16  PI-ACCOUNT                  PIC X(10).
  2398         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2399                                         PIC X(10).
  2400         16  PI-CLAIM-CERT-GRP.
  2401             20  PI-CLAIM-NO             PIC X(7).
  2402             20  PI-CERT-NO.
  2403                 25  PI-CERT-PRIME       PIC X(10).
  2404                 25  PI-CERT-SFX         PIC X.
  2405             20  PI-CERT-EFF-DT          PIC XX.
  2406         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2407             20  PI-PLAN-CODE            PIC X(2).
  2408             20  PI-REVISION-NUMBER      PIC X(3).
  2409             20  PI-PLAN-EFF-DT          PIC X(2).
  2410             20  PI-PLAN-EXP-DT          PIC X(2).
  2411             20  FILLER                  PIC X(11).
  2412         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  47
* EL6311.cbl
  2413             20  PI-OE-REFERENCE-1.
  2414                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2415                 25  PI-OE-REF-1-SUFF    PIC XX.
  2416
  2417     12  PI-SESSION-IN-PROGRESS          PIC X.
  2418         88  CLAIM-SESSION                   VALUE '1'.
  2419         88  CREDIT-SESSION                  VALUE '2'.
  2420         88  WARRANTY-SESSION                VALUE '3'.
  2421         88  MORTGAGE-SESSION                VALUE '4'.
  2422         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2423
  2424
  2425*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2426
  2427     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2428     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2429
  2430     12  PI-CREDIT-USER                  PIC X.
  2431         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2432         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2433
  2434     12  PI-CLAIM-USER                   PIC X.
  2435         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2436         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2437
  2438     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2439         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2440         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2441         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2442         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2443         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2444
  2445     12  PI-PROCESSOR-ID                 PIC X(4).
  2446
  2447     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2448
  2449     12  PI-MEMBER-CAPTION               PIC X(10).
  2450
  2451     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2452         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2453
  2454     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2455     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2456     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2457     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2458
  2459     12  PI-AH-OVERRIDE-L1               PIC X.
  2460     12  PI-AH-OVERRIDE-L2               PIC XX.
  2461     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2462     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2463
  2464     12  PI-NEW-SYSTEM                   PIC X(2).
  2465
  2466     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2467     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2468         88  PI-USES-PAID-TO                 VALUE '1'.
  2469     12  PI-CRDTCRD-SYSTEM.
  2470         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  48
* EL6311.cbl
  2471             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2472             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2473         16  PI-CC-MONTH-END-DT          PIC XX.
  2474     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2475
  2476     12  PI-OE-REFERENCE-2.
  2477         16  PI-OE-REF-2-PRIME           PIC X(10).
  2478         16  PI-OE-REF-2-SUFF            PIC X.
  2479
  2480     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2481
  2482     12  PI-LANGUAGE-TYPE                PIC X.
  2483             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2484             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2485             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2486
  2487     12  PI-POLICY-LINKAGE-IND           PIC X.
  2488         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2489         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2490                                                   LOW-VALUES.
  2491
  2492     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2493     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2494         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2495         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2496
  2497     12  PI-PROCESSOR-CSR-IND            PIC X.
  2498         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2499         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2500
  2501     12  FILLER                          PIC X(3).
  2502
  2503     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2504
  2505     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2506         PI-SYSTEM-LEVEL.
  2507
  2508         16  PI-ENTRY-CODES.
  2509             20  PI-ENTRY-CD-1           PIC X.
  2510             20  PI-ENTRY-CD-2           PIC X.
  2511
  2512         16  PI-RETURN-CODES.
  2513             20  PI-RETURN-CD-1          PIC X.
  2514             20  PI-RETURN-CD-2          PIC X.
  2515
  2516         16  PI-UPDATE-STATUS-SAVE.
  2517             20  PI-UPDATE-BY            PIC X(4).
  2518             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2519
  2520         16  PI-LOWER-CASE-LETTERS       PIC X.
  2521             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2522
  2523*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2524*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2525*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2526
  2527         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2528             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  49
* EL6311.cbl
  2529             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2530             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2531             88  ACCNT-CNTL                  VALUE '3'.
  2532             88  CARR-ACCNT-CNTL             VALUE '4'.
  2533
  2534         16  PI-PROCESSOR-CAP-LIST.
  2535             20  PI-SYSTEM-CONTROLS.
  2536                24 PI-SYSTEM-DISPLAY     PIC X.
  2537                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2538                24 PI-SYSTEM-MODIFY      PIC X.
  2539                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2540             20  FILLER                  PIC XX.
  2541             20  PI-DISPLAY-CAP          PIC X.
  2542                 88  DISPLAY-CAP             VALUE 'Y'.
  2543             20  PI-MODIFY-CAP           PIC X.
  2544                 88  MODIFY-CAP              VALUE 'Y'.
  2545             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2546                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2547             20  PI-FORCE-CAP            PIC X.
  2548                 88  FORCE-CAP               VALUE 'Y'.
  2549
  2550         16  PI-PROGRAM-CONTROLS.
  2551             20  PI-PGM-PRINT-OPT        PIC X.
  2552             20  PI-PGM-FORMAT-OPT       PIC X.
  2553             20  PI-PGM-PROCESS-OPT      PIC X.
  2554             20  PI-PGM-TOTALS-OPT       PIC X.
  2555
  2556         16  PI-HELP-INTERFACE.
  2557             20  PI-LAST-ERROR-NO        PIC X(4).
  2558             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2559
  2560         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2561             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2562
  2563         16  PI-CR-CONTROL-IN-PROGRESS.
  2564             20  PI-CR-CARRIER           PIC X.
  2565             20  PI-CR-GROUPING          PIC X(6).
  2566             20  PI-CR-STATE             PIC XX.
  2567             20  PI-CR-ACCOUNT           PIC X(10).
  2568             20  PI-CR-FIN-RESP          PIC X(10).
  2569             20  PI-CR-TYPE              PIC X.
  2570
  2571         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2572
  2573         16  PI-CR-MONTH-END-DT          PIC XX.
  2574
  2575         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2576             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2577             88  PI-ZERO-CARRIER             VALUE '1'.
  2578             88  PI-ZERO-GROUPING            VALUE '2'.
  2579             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2580
  2581         16  PI-CARRIER-SECURITY         PIC X.
  2582             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2583
  2584         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2585             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2586             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  50
* EL6311.cbl
  2587
  2588         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2589             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2590                                         INDEXED BY PI-ACCESS-NDX
  2591                                         PIC X.
  2592
  2593         16  PI-GA-BILLING-CONTROL       PIC X.
  2594             88  PI-GA-BILLING               VALUE '1'.
  2595
  2596         16  PI-MAIL-PROCESSING          PIC X.
  2597             88  PI-MAIL-YES                 VALUE 'Y'.
  2598
  2599         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2600
  2601         16  PI-AR-SYSTEM.
  2602             20  PI-AR-PROCESSING-CNTL   PIC X.
  2603                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2604             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2605             20  PI-AR-MONTH-END-DT      PIC XX.
  2606
  2607         16  PI-MP-SYSTEM.
  2608             20  PI-MORTGAGE-USER            PIC X.
  2609                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2610                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2611             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2612                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2613                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2614                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2615                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2616                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2617             20  PI-MP-MONTH-END-DT          PIC XX.
  2618             20  PI-MP-REFERENCE-NO.
  2619                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2620                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2621
  2622         16  PI-LABEL-CONTROL            PIC X(01).
  2623             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2624             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2625
  2626         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2627             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2628
  2629         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2630             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2631             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2632
  2633         16  FILLER                      PIC X(14).
  2634
  2635     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2636******************************************************************
  2637
  2638     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2639*    COPY ELC631PI.
  2640******************************************************************
  2641*                                                                *
  2642*                                                                *
  2643*                            ELC631PI                            *
  2644*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  51
* EL6311.cbl
  2645*                                                                *
  2646*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2647*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2648*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2649*                                                                *
  2650*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2651*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2652*    BETWEEN PROGRAMS.                                           *
  2653*                                                                *
  2654*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2655*                                                                *
  2656*               EL631 - EL6311 - EL6312 - EL6313                 *
  2657*                                                                *
  2658******************************************************************
  2659*                   C H A N G E   L O G
  2660*
  2661* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2662*-----------------------------------------------------------------
  2663*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2664* EFFECTIVE    NUMBER
  2665*-----------------------------------------------------------------
  2666* 021414    2003053000001  PEMA  changes for auto chk request
  2667******************************************************************
  2668
  2669         16  PI-631-DATA.
  2670             20  PI-ERPNDB-KEY.
  2671                 24  PI-PB-COMPANY-CD     PIC X.
  2672                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2673                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2674                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2675
  2676             20  PI-ERPNDB-ALT-KEY.
  2677                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2678                 24  PI-PB-CARRIER        PIC X.
  2679                 24  PI-PB-GROUPING       PIC X(6).
  2680                 24  PI-PB-STATE          PIC XX.
  2681                 24  PI-PB-ACCOUNT        PIC X(10).
  2682                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2683                 24  PI-PB-CERT-NO.
  2684                     28  PI-PB-CERT-PRIME PIC X(10).
  2685                     28  PI-PB-CERT-SFX   PIC X.
  2686                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2687                 24  PI-PB-RECORD-TYPE    PIC X.
  2688
  2689             20  PI-ERPNDB-CSR-KEY.
  2690                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2691                 24  PI-PB-CSR-ID             PIC X(4).
  2692                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2693                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2694                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2695
  2696             20  PI-BROWSE-TYPE               PIC X.
  2697                 88  PI-FILE-BROWSE             VALUE ' '.
  2698                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2699                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2700                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2701                 88  PI-CSR-BROWSE              VALUE '4'.
  2702
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  52
* EL6311.cbl
  2703             20  PI-MAINT-FUNCTION            PIC X.
  2704                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2705                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2706                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2707                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2708                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2709                 88  PI-PF5-FUNCTION            VALUE '5'.
  2710                 88  PI-PF6-FUNCTION            VALUE '6'.
  2711
  2712             20  PI-FILE-SWITCHES.
  2713                 24  PI-ALL-ISSUES-SW         PIC X.
  2714                     88  ALL-ISSUES             VALUE 'Y'.
  2715                 24  PI-ALL-CANCELS-SW        PIC X.
  2716                     88  ALL-CANCELS            VALUE 'Y'.
  2717                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2718                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2719                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2720                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2721                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2722                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2723                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2724                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2725                 24  PI-HOLD-REC-SW           PIC X.
  2726                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2727                 24  PI-CHANGE-REC-SW         PIC X.
  2728                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2729                 24  PI-CHK-REQ-REC-SW        PIC X.
  2730                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2731                 24  PI-ISSUE-WARNING-SW      PIC X.
  2732                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2733                 24  PI-CANCEL-WARNING-SW     PIC X.
  2734                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2735             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2736                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2737             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2738                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2739
  2740             20  PI-MAP-NAME                  PIC X(8).
  2741
  2742             20  PI-CURSOR                    PIC S9(4) COMP.
  2743
  2744             20  PI-PREV-ALT-KEY              PIC X(36).
  2745             20  PI-PREV-CSR-KEY              PIC X(15).
  2746             20  PI-PREV-KEY.
  2747                 24  PI-PREV-COMPANY-CD       PIC X.
  2748                 24  PI-PREV-BATCH            PIC X(6).
  2749                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2750                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2751             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2752             20  PI-BROWSE-SW                 PIC X.
  2753                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2754                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2755             20  PI-SV-CARRIER                PIC X.
  2756             20  PI-SV-GROUPING               PIC X(6).
  2757             20  PI-SV-STATE                  PIC XX.
  2758             20  PI-EDIT-SW                   PIC X.
  2759             20  PI-DISPLAY-SW                PIC XX.
  2760                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  53
* EL6311.cbl
  2761                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2762             20  PI-CRITERIA-DATA             PIC X(350).
  2763             20  PI-BMODE                     PIC X.
  2764             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2765             20  PI-BPMTS                     PIC S999     COMP-3.
  2766             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2767             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2768             20  PI-CSR-SESSION-SW            PIC X.
  2769                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2770             20  PI-ERRORS-SW                 PIC X.
  2771                 88  FATAL-ERRORS               VALUE 'X'.
  2772*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2773             20  pi-unforced-sw               pic x.
  2774                 88  unforced-errors            value 'X'.
  2775             20  FILLER                       PIC X(4).
  2776
  2777        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2778        16  FILLER             PIC X(92).
  2779
  2780 01  W-LETTER-COMMUNICATION-AREAS.
  2781*    COPY ELC1042.
  2782******************************************************************
  2783*                                                                *
  2784*                                                                *
  2785*                           ELC1042                              *
  2786*                            VMOD=2.002                          *
  2787*                                                                *
  2788*    NOTE                                                        *
  2789*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2790*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2791*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2792*        TO THESE PROGRAMS.                                      *
  2793*                                                                *
  2794*    NOTE                                                        *
  2795*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2796*        USE ONLY!                                               *
  2797*                                                                *
  2798******************************************************************
  2799
  2800         16  PI-1042-WA.
  2801             20  PI-ACTION       PIC  X(01).
  2802                 88 PI-SHOW-MODE           VALUE '1'.
  2803                 88 PI-CLEAR-MODE          VALUE '2'.
  2804                 88 PI-CREATE-MODE         VALUE '3'.
  2805             20  PI-COMM-CONTROL PIC  X(12).
  2806             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2807             20  PI-EOF-SW       PIC  X(01).
  2808                 88  PI-FILE-EOF           VALUE 'Y'.
  2809             20  PI-FILETYP      PIC  X(01).
  2810             20  PI-FORM-SQUEEZE-CONTROL
  2811                                 PIC  X(01).
  2812                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2813                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2814             20  PI-LAST-CONTROL PIC  X(12).
  2815             20  PI-TEMP-STOR-ITEMS
  2816                                 PIC S9(04) COMP.
  2817             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2818             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  54
* EL6311.cbl
  2819                 88 ANY-UPDATES            VALUE 1.
  2820             20  PI-104-SCREEN-SENT-IND
  2821                                 PIC  X(01).
  2822                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2823                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2824             20  PI-1042-SCREEN-SENT-IND
  2825                                 PIC  X(01).
  2826                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2827                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2828             20  PI-1042-ARCHIVE-IND
  2829                                 PIC  X(01).
  2830                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2831             20  FILLER          PIC  X(29).
  2832*    COPY ELC689PI.
  2833******************************************************************
  2834*                                                                *
  2835*                            ELC689PI                            *
  2836*                            VMOD=2.003                          *
  2837*                                                                *
  2838*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2839*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2840*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2841*                                                                *
  2842*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2843*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2844*    BETWEEN PROGRAMS.                                           *
  2845*                                                                *
  2846*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2847*                                                                *
  2848*               EL631 - EL689  - EL6891 - EL6892                 *
  2849*                                                                *
  2850******************************************************************
  2851*                   C H A N G E   L O G
  2852*
  2853* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2854*-----------------------------------------------------------------
  2855*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2856* EFFECTIVE    NUMBER
  2857*-----------------------------------------------------------------
  2858* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2859* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2860* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2861******************************************************************
  2862
  2863
  2864         16  PI-689-WORK-AREA.
  2865             20  PI-689-ALT-PRINTER-ID
  2866                                 PIC  X(04).
  2867             20  PI-689-ARCHIVE-NUMBER
  2868                                 PIC  9(08).
  2869             20  PI-689-ARCHIVE-SW
  2870                                 PIC  X(01).
  2871                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2872             20  PI-689-DATA-SOURCE
  2873                                 PIC  X(01).
  2874                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2875                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2876                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  55
* EL6311.cbl
  2877                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2878                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2879             20  PI-689-ERROR-IND
  2880                                 PIC  X(01).
  2881                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2882             20  PI-689-ERROR    PIC  9(04).
  2883                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2884                 88  PI-689-FATAL-ERROR
  2885                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2886                            0042 0047 0051 0066 0067 0070
  2887                            0168 0169 0174 0175 0176 0177 0179
  2888                            0180 0181 0182 0184 0185 0189 0190
  2889                            0191
  2890                            0215 0279 0280
  2891                            0412 0413 0454
  2892                            0533 0537
  2893                            2055 2114 2208 2209 2216 2232 2369
  2894                            2398 2433 2908 2999
  2895                            3000 3770 3771 3775
  2896                            7250 7365 7367 7368 7369 7370 7371
  2897                            7272 7373 7374 7376 7377 7378 7379
  2898                            7381 7388 7390 7393 7395 7396 7398
  2899                            9095 9096 9281 9298 9299 9320 9327
  2900                            9426 9427.
  2901                 88  PI-689-STOP-ERROR
  2902                     VALUES 0004 0008 0013 0023 0029 0033
  2903                            0042 0047 0066 0067 0070
  2904                            0168 0169 0174 0175 0176 0177
  2905                            0181 0182 0184 0185 0189 0190
  2906                            0279 0280
  2907                            0412 0413 0454
  2908                            2055 2208 2209 2216 2232
  2909                            2398 2999
  2910                            3000 3770 3771 3775
  2911                            7250 7365 7369 7370 7371
  2912                            7272 7373 7374 7376 7377 7378 7379
  2913                            7381 7388 7390 7393 7396 7398
  2914                            9095 9096 9299 9320 9426.
  2915             20  PI-689-FOLLOW-UP-DATE
  2916                                 PIC  X(02).
  2917             20  PI-689-FORM-NUMBER
  2918                                 PIC  X(04).
  2919             20  PI-689-LABEL-SOURCE
  2920                                 PIC X(01).
  2921                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2922                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2923                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2924                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2925                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2926                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2927                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2928             20  PI-689-NUMBER-COPIES
  2929                                 PIC  9(01).
  2930             20  PI-689-NUMBER-LABEL-LINES
  2931                                 PIC  9(01).
  2932             20  PI-689-NUMBER-TEXT-RECORDS
  2933                                 PIC  9(03).
  2934             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  56
* EL6311.cbl
  2935                                 PIC  X(01).
  2936                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2937                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2938                 88  PI-689-PRINT-LATER     VALUE '3'.
  2939                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2940             20  PI-689-PRINT-RESTRICTION
  2941                                 PIC  X(01).
  2942                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2943                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2944                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2945             20  PI-689-PRINT-SW PIC  X(01).
  2946                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2947             20  PI-689-RESEND-DATE-1
  2948                                 PIC  X(02).
  2949             20  PI-689-RESEND-LETR-1
  2950                                 PIC X(4).
  2951             20  PI-689-TEMP-STOR-ID
  2952                                 PIC  X(08).
  2953             20  PI-689-USE-SCREEN-IND
  2954                                 PIC  X(01).
  2955                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2956             20  PI-689-ARCH-POINTER
  2957                                 PIC S9(08) COMP.
  2958                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2959             20  PI-689-ARCT-POINTER
  2960                                 PIC S9(08) COMP.
  2961                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2962             20  PI-689-VARIABLE-DATA-GRP.
  2963                 24  PI-689-VARIABLE-DATA-1
  2964                                 PIC  X(30).
  2965                 24  PI-689-VARIABLE-DATA-2
  2966                                 PIC  X(30).
  2967                 24  PI-689-VARIABLE-DATA-3
  2968                                 PIC  X(30).
  2969                 24  PI-689-VARIABLE-DATA-4
  2970                                 PIC  X(30).
  2971
  2972         16  PI-689-KEY-DATA-FIELDS.
  2973             20  PI-689-ACCOUNT  PIC  X(10).
  2974             20  PI-689-CARRIER  PIC  X(01).
  2975             20  PI-689-CERT-NO.
  2976                 24  PI-689-CERT-PRIME
  2977                                 PIC  X(10).
  2978                 24  PI-689-CERT-SFX
  2979                                 PIC  X(01).
  2980             20  PI-689-CHG-SEQ-NO
  2981                                 PIC S9(04)    COMP.
  2982             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2983                                 PIC  X(02).
  2984             20  PI-689-ENTRY-BATCH
  2985                                 PIC  X(06).
  2986             20  PI-689-EFF-DATE PIC  X(02).
  2987             20  PI-689-EXP-DATE PIC  X(02).
  2988             20  PI-689-GROUPING PIC  X(06).
  2989             20  PI-689-RESP-PERSON
  2990                                 PIC  X(10).
  2991             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2992             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  57
* EL6311.cbl
  2993                                 PIC  X(04).
  2994             20  PI-689-STATE    PIC  X(02).
  2995             20  PI-689-TYPE     PIC  X(01).
  2996             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2997             20  PI-689-ALT-SEQ-NO
  2998                                 PIC S9(04)    COMP.
  2999         16  PI-689-DATE-EDIT    PIC  X(08).
  3000         16  PI-689-FOLLOW-UP-EDIT
  3001                                 PIC  X(08).
  3002         16  PI-689-RESEND1-EDIT PIC  X(08).
  3003         16  PI-689-SEQ-EDIT     PIC  X(08).
  3004         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3005         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3006             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3007         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3008         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  58
* EL6311.cbl
  3010
  3011 01  WS-EL6315-PASS-AREA.
  3012        16  PI-6315-ISS-CAN-SW      PIC X.
  3013        16  FILLER                  PIC X(120).
  3014        16  PI-RES-REF-CLM-TYPE     PIC X.
  3015        16  FILLER                  PIC X.
  3016        16  PI-6315-PASS-AREA.
  3017            20 FILLER               PIC X(236).
  3018            20 PI-6315-FINALIZED    PIC X.
  3019            20 FILLER               PIC X(280).
  3020
  3021 01  WS-EL6316-PASS-AREA.
  3022        16  PI-ISS-CAN-SW           PIC X.
  3023        16  FILLER                  PIC X(121).
  3024        16  PI-CLM-RESC-IND         PIC X.
  3025        16  PI-6316-PASS-AREA.
  3026            20 FILLER               PIC X(236).
  3027            20 PI-6316-FINALIZED    PIC X.
  3028            20 FILLER               PIC X(280).
  3029
  3030******************************************************************
  3031*                                                                *
  3032*         P A S S   A R E A   F O R   E D I T                    *
  3033*                                                                *
  3034******************************************************************
  3035
  3036 01  PASSED-RECORD.
  3037     12  RECORD-SAVE                  PIC X(585).
  3038* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3039*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3040*                    BY  WK-CURRENT-DATE.
  3041******************************************************************
  3042*                                                                *
  3043*                                                                *
  3044*                             ELC50W1                            *
  3045*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3046*                            VMOD=2.004                          *
  3047*                                                                *
  3048*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3049*                                                                *
  3050*                                                                *
  3051******************************************************************
  3052
  3053     12  WK-WORK-AREA.
  3054         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3055         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3056         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3057         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3058         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3059         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3060         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3061         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3062         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3063         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3064         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3065         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3066         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3067         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  59
* EL6311.cbl
  3068         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3069         16  WK-CREDIT-EDIT-CONTROLS.
  3070             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3071             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3072             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3073             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3074             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3075             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3076         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3077         16  WK-SAVE-REIN-DATA.
  3078             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3079             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3080             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3081         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3082             88  ENTRY-FROM-EL6311       VALUE '6'.
  3083         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3084         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3085     12  WK-RECORD-ADDRESSES.
  3086         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3087         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3088         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3089         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3090         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3091         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3092         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3093         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3094     12  WK-OVER-SHORT-AREA.
  3095         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3096         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3097         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3098             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3099         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  60
* EL6311.cbl
  3101
  3102*    COPY ELCEDITC.
  3103******************************************************************
  3104*                                                                *
  3105*                                                                *
  3106*                            ELCEDITC                            *
  3107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3108*                            VMOD=2.012                          *
  3109*                                                                *
  3110*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3111*                     EL6313, EL050 AND EL517.                   *
  3112*                                                                *
  3113******************************************************************
  3114******************************************************************
  3115*                   C H A N G E   L O G
  3116*
  3117* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3118*-----------------------------------------------------------------
  3119*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3120* EFFECTIVE    NUMBER
  3121*-----------------------------------------------------------------
  3122* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3123******************************************************************
  3124
  3125     12  EDIT-CRITERIA-DATA.
  3126         16  EC-CO-MONTH-END-DT       PIC XX.
  3127         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3128         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3129         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3130         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3131         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3132         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3133         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3134         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3135         16  EC-CO-REM-TERM-CALC      PIC X.
  3136               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3137               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3138               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3139               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3140
  3141         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3142               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3143               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3144               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3145               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3146               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3147               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3148               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3149               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3150               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3151               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3152
  3153         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3154               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3155               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3156               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3157               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3158               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  61
* EL6311.cbl
  3159               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3160               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3161               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3162
  3163         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3164                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3165                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3166
  3167         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3168                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3169                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3170                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3171                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3172                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3173                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3174                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3175                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3176
  3177         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3178               88  EC-BR-REDUCING                   VALUE 'R'.
  3179               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3180
  3181         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3182         16  EC-BR-LF-DESC             PIC X(10).
  3183         16  EC-BR-AH-DESC             PIC X(10).
  3184         16  EC-BR-LF-COMMENT          PIC X(10).
  3185         16  EC-BR-AH-COMMENT          PIC X(10).
  3186
  3187         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3188               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3189               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3190               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3191               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3192
  3193         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3194               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3195               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3196               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3197               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3198
  3199         16  EC-BR-LF-REFUND-CALC      PIC X.
  3200                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3201                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3202                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3203                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3204                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3205                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3206                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3207
  3208         16  EC-BR-AH-REFUND-CALC      PIC X.
  3209                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3210                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3211                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3212                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3213                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3214                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3215                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3216                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  62
* EL6311.cbl
  3217
  3218         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3219                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3220                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3221                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3222
  3223         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3224                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3225                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3226                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3227
  3228         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3229         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3230         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3231         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3232
  3233         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3234         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3235                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3236                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3237                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3238                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3239
  3240         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3241               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3242               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3243               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3244               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3245               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3246
  3247         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3248               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3249               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3250               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3251               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3252               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3253
  3254         16  EC-ST-LF-REFUND-CALC      PIC X.
  3255                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3256                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3257                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3258                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3259                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3260                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3261                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3262                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3263
  3264         16  EC-ST-AH-REFUND-CALC      PIC X.
  3265                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3266                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3267                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3268                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3269                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3270                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3271                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3272                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3273
  3274         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  63
* EL6311.cbl
  3275         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3276         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3277         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3278         16  EC-AM-EXPIRATION-DT       PIC XX.
  3279         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3280         16  EC-AM-CLASS-CD            PIC XX.
  3281         16  EC-AM-LF-DEVIATION        PIC XXX.
  3282         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3283         16  EC-AM-AH-DEVIATION        PIC XXX.
  3284         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3285         16  EC-AM-PHONE-NO            PIC X(10).
  3286
  3287         16  EC-AM-LF-REFUND-CALC      PIC X.
  3288                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3289                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3290                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3291                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3292                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3293                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3294                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3295
  3296         16  EC-AM-AH-REFUND-CALC      PIC X.
  3297                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3298                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3299                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3300                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3301                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3302                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3303                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3304
  3305         16  EC-AM-BEN-I-G-CD          PIC X.
  3306                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3307                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3308                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3309
  3310         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3311         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3312         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3313         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3314         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3315         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3316         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3317         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3318         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3319
  3320         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3321         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3322         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3323         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3324         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3325         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3326         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3327         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3328         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3329         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3330         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3331         16  EC-RT-LF-NSP-ST           PIC XX.
  3332         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  64
* EL6311.cbl
  3333         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3334         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3335
  3336         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3337             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3338                                             'M' '5' '9' '2'.
  3339             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3340             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3341             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3342             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3343             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3344             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3345             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3346             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3347             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3348             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3349
  3350         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3351             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3352                                             'M' '5' '9' '2'.
  3353             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3354             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3355             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3356             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3357             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3358             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3359             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3360             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3361             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3362             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3363
  3364         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3365         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3366         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3367         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3368         16  EC-CM-DEATH-DT            PIC XX.
  3369
  3370*DMD CUSTOM CODING FIELDS BELOW
  3371*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3372         16  EC-BR-DMD-RATING-SW       PIC X.
  3373                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3374                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3375                 88  NO-DMD-RATING               VALUE 'N'.
  3376
  3377         16  EC-NEW-CERT               PIC X(11).
  3378         16  EC-NEW-STATE              PIC XX.
  3379         16  FILLER                    PIC X.
  3380*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3381         16  OVER-SHORT-EDIT-FIELDS.
  3382             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3383             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3384             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3385             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3386             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3387             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3388             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3389             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3390             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  65
* EL6311.cbl
  3391         16  FILLER                    PIC X(71).
  3392
  3393******************************************************************
  3394
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  66
* EL6311.cbl
  3396
  3397*    COPY ELCJPFX.
  3398******************************************************************
  3399*                                                                *
  3400*                                                                *
  3401*                            ELCJPFX.                            *
  3402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3403*                            VMOD=2.002                          *
  3404*                                                                *
  3405*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3406*                                                                *
  3407*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3408*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3409*        ELCNTL - CONTROL FILE                                   *
  3410*        ELMSTR - CLAIM MASTERS                                  *
  3411*        ELTRLR - ACTIVITY TRAILERS                              *
  3412*        ELCHKQ - CHECK QUE                                      *
  3413******************************************************************
  3414 01  JOURNAL-RECORD.
  3415     12  jp-date                     pic s9(5) comp-3.
  3416     12  jp-time                     pic s9(7) comp-3.
  3417     12  JP-USER-ID                  PIC X(4).
  3418     12  JP-FILE-ID                  PIC X(8).
  3419     12  JP-PROGRAM-ID               PIC X(8).
  3420     12  JP-RECORD-TYPE              PIC X.
  3421         88 JP-ADD              VALUE 'A'.
  3422         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3423         88 JP-AFTER-CHANGE     VALUE 'C'.
  3424         88 JP-DELETE           VALUE 'D'.
  3425         88 JP-GENERIC-DELETE   VALUE 'G'.
  3426         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3427         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3428     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3429     12  JP-RECORD-AREA
  3430
  3431
  3432                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  67
* EL6311.cbl
  3434*    COPY ELCAID.
  3435******************************************************************
  3436*                                                                *
  3437*                            ELCAID.                             *
  3438*                            VMOD=2.001                          *
  3439*                                                                *
  3440*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3441*                                                                *
  3442*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3443*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3444******************************************************************
  3445
  3446 01  DFHAID.
  3447   02  DFHNULL   PIC  X  VALUE  ' '.
  3448   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3449   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3450   02  DFHPEN    PIC  X  VALUE  '='.
  3451   02  DFHOPID   PIC  X  VALUE  'W'.
  3452   02  DFHPA1    PIC  X  VALUE  '%'.
  3453   02  DFHPA2    PIC  X  VALUE  '>'.
  3454   02  DFHPA3    PIC  X  VALUE  ','.
  3455   02  DFHPF1    PIC  X  VALUE  '1'.
  3456   02  DFHPF2    PIC  X  VALUE  '2'.
  3457   02  DFHPF3    PIC  X  VALUE  '3'.
  3458   02  DFHPF4    PIC  X  VALUE  '4'.
  3459   02  DFHPF5    PIC  X  VALUE  '5'.
  3460   02  DFHPF6    PIC  X  VALUE  '6'.
  3461   02  DFHPF7    PIC  X  VALUE  '7'.
  3462   02  DFHPF8    PIC  X  VALUE  '8'.
  3463   02  DFHPF9    PIC  X  VALUE  '9'.
  3464   02  DFHPF10   PIC  X  VALUE  ':'.
  3465   02  DFHPF11   PIC  X  VALUE  '#'.
  3466   02  DFHPF12   PIC  X  VALUE  '@'.
  3467   02  DFHPF13   PIC  X  VALUE  'A'.
  3468   02  DFHPF14   PIC  X  VALUE  'B'.
  3469   02  DFHPF15   PIC  X  VALUE  'C'.
  3470   02  DFHPF16   PIC  X  VALUE  'D'.
  3471   02  DFHPF17   PIC  X  VALUE  'E'.
  3472   02  DFHPF18   PIC  X  VALUE  'F'.
  3473   02  DFHPF19   PIC  X  VALUE  'G'.
  3474   02  DFHPF20   PIC  X  VALUE  'H'.
  3475   02  DFHPF21   PIC  X  VALUE  'I'.
  3476*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3477   02  DFHPF22   PIC  X  VALUE  '['.
  3478   02  DFHPF23   PIC  X  VALUE  '.'.
  3479   02  DFHPF24   PIC  X  VALUE  '<'.
  3480   02  DFHMSRE   PIC  X  VALUE  'X'.
  3481   02  DFHSTRF   PIC  X  VALUE  'h'.
  3482   02  DFHTRIG   PIC  X  VALUE  '"'.
  3483
  3484 01  FILLER    REDEFINES DFHAID.
  3485     12  FILLER              PIC X(8).
  3486     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3487
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  68
* EL6311.cbl
  3489*    COPY EL6311S.
  3490 01  EL631BI.
  3491     05  FILLER            PIC  X(0012).
  3492*    -------------------------------
  3493     05  BDATEL PIC S9(0004) COMP.
  3494     05  BDATEF PIC  X(0001).
  3495     05  FILLER REDEFINES BDATEF.
  3496         10  BDATEA PIC  X(0001).
  3497     05  BDATEI PIC  X(0008).
  3498*    -------------------------------
  3499     05  BTIMEL PIC S9(0004) COMP.
  3500     05  BTIMEF PIC  X(0001).
  3501     05  FILLER REDEFINES BTIMEF.
  3502         10  BTIMEA PIC  X(0001).
  3503     05  BTIMEI PIC  X(0005).
  3504*    -------------------------------
  3505     05  BHEADL PIC S9(0004) COMP.
  3506     05  BHEADF PIC  X(0001).
  3507     05  FILLER REDEFINES BHEADF.
  3508         10  BHEADA PIC  X(0001).
  3509     05  BHEADI PIC  X(0038).
  3510*    -------------------------------
  3511     05  BNCERTLL PIC S9(0004) COMP.
  3512     05  BNCERTLF PIC  X(0001).
  3513     05  FILLER REDEFINES BNCERTLF.
  3514         10  BNCERTLA PIC  X(0001).
  3515     05  BNCERTLI PIC  X(0008).
  3516*    -------------------------------
  3517     05  BNCERTL PIC S9(0004) COMP.
  3518     05  BNCERTF PIC  X(0001).
  3519     05  FILLER REDEFINES BNCERTF.
  3520         10  BNCERTA PIC  X(0001).
  3521     05  BNCERTI PIC  X(0011).
  3522*    -------------------------------
  3523     05  BNSTATLL PIC S9(0004) COMP.
  3524     05  BNSTATLF PIC  X(0001).
  3525     05  FILLER REDEFINES BNSTATLF.
  3526         10  BNSTATLA PIC  X(0001).
  3527     05  BNSTATLI PIC  X(0009).
  3528*    -------------------------------
  3529     05  BNSTATL PIC S9(0004) COMP.
  3530     05  BNSTATF PIC  X(0001).
  3531     05  FILLER REDEFINES BNSTATF.
  3532         10  BNSTATA PIC  X(0001).
  3533     05  BNSTATI PIC  X(0002).
  3534*    -------------------------------
  3535     05  BCHGTL PIC S9(0004) COMP.
  3536     05  BCHGTF PIC  X(0001).
  3537     05  FILLER REDEFINES BCHGTF.
  3538         10  BCHGTA PIC  X(0001).
  3539     05  BCHGTI PIC  X(0004).
  3540*    -------------------------------
  3541     05  BCHGL PIC S9(0004) COMP.
  3542     05  BCHGF PIC  X(0001).
  3543     05  FILLER REDEFINES BCHGF.
  3544         10  BCHGA PIC  X(0001).
  3545     05  BCHGI PIC  X(0004).
  3546*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  69
* EL6311.cbl
  3547     05  BCOMPIDL PIC S9(0004) COMP.
  3548     05  BCOMPIDF PIC  X(0001).
  3549     05  FILLER REDEFINES BCOMPIDF.
  3550         10  BCOMPIDA PIC  X(0001).
  3551     05  BCOMPIDI PIC  X(0003).
  3552*    -------------------------------
  3553     05  BREGIONL PIC S9(0004) COMP.
  3554     05  BREGIONF PIC  X(0001).
  3555     05  FILLER REDEFINES BREGIONF.
  3556         10  BREGIONA PIC  X(0001).
  3557     05  BREGIONI PIC  X(0006).
  3558*    -------------------------------
  3559     05  BUSERL PIC S9(0004) COMP.
  3560     05  BUSERF PIC  X(0001).
  3561     05  FILLER REDEFINES BUSERF.
  3562         10  BUSERA PIC  X(0001).
  3563     05  BUSERI PIC  X(0004).
  3564*    -------------------------------
  3565     05  BMAINTL PIC S9(0004) COMP.
  3566     05  BMAINTF PIC  X(0001).
  3567     05  FILLER REDEFINES BMAINTF.
  3568         10  BMAINTA PIC  X(0001).
  3569     05  BMAINTI PIC  X(0001).
  3570*    -------------------------------
  3571     05  BMANTBYL PIC S9(0004) COMP.
  3572     05  BMANTBYF PIC  X(0001).
  3573     05  FILLER REDEFINES BMANTBYF.
  3574         10  BMANTBYA PIC  X(0001).
  3575     05  BMANTBYI PIC  X(0004).
  3576*    -------------------------------
  3577     05  BCHGHDGL PIC S9(0004) COMP.
  3578     05  BCHGHDGF PIC  X(0001).
  3579     05  FILLER REDEFINES BCHGHDGF.
  3580         10  BCHGHDGA PIC  X(0001).
  3581     05  BCHGHDGI PIC  X(0003).
  3582*    -------------------------------
  3583     05  BMANTDTL PIC S9(0004) COMP.
  3584     05  BMANTDTF PIC  X(0001).
  3585     05  FILLER REDEFINES BMANTDTF.
  3586         10  BMANTDTA PIC  X(0001).
  3587     05  BMANTDTI PIC  X(0008).
  3588*    -------------------------------
  3589     05  BMANTATL PIC S9(0004) COMP.
  3590     05  BMANTATF PIC  X(0001).
  3591     05  FILLER REDEFINES BMANTATF.
  3592         10  BMANTATA PIC  X(0001).
  3593     05  BMANTATI PIC  X(0005).
  3594*    -------------------------------
  3595     05  BCSRL PIC S9(0004) COMP.
  3596     05  BCSRF PIC  X(0001).
  3597     05  FILLER REDEFINES BCSRF.
  3598         10  BCSRA PIC  X(0001).
  3599     05  BCSRI PIC  X(0004).
  3600*    -------------------------------
  3601     05  BBATCHL PIC S9(0004) COMP.
  3602     05  BBATCHF PIC  X(0001).
  3603     05  FILLER REDEFINES BBATCHF.
  3604         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  70
* EL6311.cbl
  3605     05  BBATCHI PIC  X(0006).
  3606*    -------------------------------
  3607     05  BSEQL PIC S9(0004) COMP.
  3608     05  BSEQF PIC  X(0001).
  3609     05  FILLER REDEFINES BSEQF.
  3610         10  BSEQA PIC  X(0001).
  3611     05  BSEQI PIC  X(0004).
  3612*    -------------------------------
  3613     05  BMOENDTL PIC S9(0004) COMP.
  3614     05  BMOENDTF PIC  X(0001).
  3615     05  FILLER REDEFINES BMOENDTF.
  3616         10  BMOENDTA PIC  X(0001).
  3617     05  BMOENDTI PIC  X(0008).
  3618*    -------------------------------
  3619     05  BCARRL PIC S9(0004) COMP.
  3620     05  BCARRF PIC  X(0001).
  3621     05  FILLER REDEFINES BCARRF.
  3622         10  BCARRA PIC  X(0001).
  3623     05  BCARRI PIC  X(0001).
  3624*    -------------------------------
  3625     05  BGROUPL PIC S9(0004) COMP.
  3626     05  BGROUPF PIC  X(0001).
  3627     05  FILLER REDEFINES BGROUPF.
  3628         10  BGROUPA PIC  X(0001).
  3629     05  BGROUPI PIC  X(0006).
  3630*    -------------------------------
  3631     05  BSTATEL PIC S9(0004) COMP.
  3632     05  BSTATEF PIC  X(0001).
  3633     05  FILLER REDEFINES BSTATEF.
  3634         10  BSTATEA PIC  X(0001).
  3635     05  BSTATEI PIC  X(0002).
  3636*    -------------------------------
  3637     05  BACCTL PIC S9(0004) COMP.
  3638     05  BACCTF PIC  X(0001).
  3639     05  FILLER REDEFINES BACCTF.
  3640         10  BACCTA PIC  X(0001).
  3641     05  BACCTI PIC  X(0010).
  3642*    -------------------------------
  3643     05  BVINHL PIC S9(0004) COMP.
  3644     05  BVINHF PIC  X(0001).
  3645     05  FILLER REDEFINES BVINHF.
  3646         10  BVINHA PIC  X(0001).
  3647     05  BVINHI PIC  X(0004).
  3648*    -------------------------------
  3649     05  BVINL PIC S9(0004) COMP.
  3650     05  BVINF PIC  X(0001).
  3651     05  FILLER REDEFINES BVINF.
  3652         10  BVINA PIC  X(0001).
  3653     05  BVINI PIC  X(0017).
  3654*    -------------------------------
  3655     05  BREFHDGL PIC S9(0004) COMP.
  3656     05  BREFHDGF PIC  X(0001).
  3657     05  FILLER REDEFINES BREFHDGF.
  3658         10  BREFHDGA PIC  X(0001).
  3659     05  BREFHDGI PIC  X(0004).
  3660*    -------------------------------
  3661     05  BREFL PIC S9(0004) COMP.
  3662     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  71
* EL6311.cbl
  3663     05  FILLER REDEFINES BREFF.
  3664         10  BREFA PIC  X(0001).
  3665     05  BREFI PIC  X(0012).
  3666*    -------------------------------
  3667     05  BAGEDEFL PIC S9(0004) COMP.
  3668     05  BAGEDEFF PIC  X(0001).
  3669     05  FILLER REDEFINES BAGEDEFF.
  3670         10  BAGEDEFA PIC  X(0001).
  3671     05  BAGEDEFI PIC  X(0004).
  3672*    -------------------------------
  3673     05  BCERTNOL PIC S9(0004) COMP.
  3674     05  BCERTNOF PIC  X(0001).
  3675     05  FILLER REDEFINES BCERTNOF.
  3676         10  BCERTNOA PIC  X(0001).
  3677     05  BCERTNOI PIC  X(0010).
  3678*    -------------------------------
  3679     05  BSUFIXL PIC S9(0004) COMP.
  3680     05  BSUFIXF PIC  X(0001).
  3681     05  FILLER REDEFINES BSUFIXF.
  3682         10  BSUFIXA PIC  X(0001).
  3683     05  BSUFIXI PIC  X(0001).
  3684*    -------------------------------
  3685     05  BEFFDTL PIC S9(0004) COMP.
  3686     05  BEFFDTF PIC  X(0001).
  3687     05  FILLER REDEFINES BEFFDTF.
  3688         10  BEFFDTA PIC  X(0001).
  3689     05  BEFFDTI PIC  X(0008).
  3690*    -------------------------------
  3691     05  BLSTNML PIC S9(0004) COMP.
  3692     05  BLSTNMF PIC  X(0001).
  3693     05  FILLER REDEFINES BLSTNMF.
  3694         10  BLSTNMA PIC  X(0001).
  3695     05  BLSTNMI PIC  X(0015).
  3696*    -------------------------------
  3697     05  B1STNML PIC S9(0004) COMP.
  3698     05  B1STNMF PIC  X(0001).
  3699     05  FILLER REDEFINES B1STNMF.
  3700         10  B1STNMA PIC  X(0001).
  3701     05  B1STNMI PIC  X(0010).
  3702*    -------------------------------
  3703     05  BINITL PIC S9(0004) COMP.
  3704     05  BINITF PIC  X(0001).
  3705     05  FILLER REDEFINES BINITF.
  3706         10  BINITA PIC  X(0001).
  3707     05  BINITI PIC  X(0001).
  3708*    -------------------------------
  3709     05  BSEXL PIC S9(0004) COMP.
  3710     05  BSEXF PIC  X(0001).
  3711     05  FILLER REDEFINES BSEXF.
  3712         10  BSEXA PIC  X(0001).
  3713     05  BSEXI PIC  X(0001).
  3714*    -------------------------------
  3715     05  BAGEL PIC S9(0004) COMP.
  3716     05  BAGEF PIC  X(0001).
  3717     05  FILLER REDEFINES BAGEF.
  3718         10  BAGEA PIC  X(0001).
  3719     05  BAGEI PIC  X(0002).
  3720*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  72
* EL6311.cbl
  3721     05  BBIRTHL PIC S9(0004) COMP.
  3722     05  BBIRTHF PIC  X(0001).
  3723     05  FILLER REDEFINES BBIRTHF.
  3724         10  BBIRTHA PIC  X(0001).
  3725     05  BBIRTHI PIC  X(0008).
  3726*    -------------------------------
  3727     05  B1STPMTL PIC S9(0004) COMP.
  3728     05  B1STPMTF PIC  X(0001).
  3729     05  FILLER REDEFINES B1STPMTF.
  3730         10  B1STPMTA PIC  X(0001).
  3731     05  B1STPMTI PIC  X(0008).
  3732*    -------------------------------
  3733     05  BDAYSL PIC S9(0004) COMP.
  3734     05  BDAYSF PIC  X(0001).
  3735     05  FILLER REDEFINES BDAYSF.
  3736         10  BDAYSA PIC  X(0001).
  3737     05  BDAYSI PIC  X(0003).
  3738*    -------------------------------
  3739     05  BLNTRML PIC S9(0004) COMP.
  3740     05  BLNTRMF PIC  X(0001).
  3741     05  FILLER REDEFINES BLNTRMF.
  3742         10  BLNTRMA PIC  X(0001).
  3743     05  BLNTRMI PIC  X(0003).
  3744*    -------------------------------
  3745     05  BLNOFCRL PIC S9(0004) COMP.
  3746     05  BLNOFCRF PIC  X(0001).
  3747     05  FILLER REDEFINES BLNOFCRF.
  3748         10  BLNOFCRA PIC  X(0001).
  3749     05  BLNOFCRI PIC  X(0005).
  3750*    -------------------------------
  3751     05  BMODEL PIC S9(0004) COMP.
  3752     05  BMODEF PIC  X(0001).
  3753     05  FILLER REDEFINES BMODEF.
  3754         10  BMODEA PIC  X(0001).
  3755     05  BMODEI PIC  X(0001).
  3756*    -------------------------------
  3757     05  BFREQL PIC S9(0004) COMP.
  3758     05  BFREQF PIC  X(0001).
  3759     05  FILLER REDEFINES BFREQF.
  3760         10  BFREQA PIC  X(0001).
  3761     05  BFREQI PIC  X(0002).
  3762*    -------------------------------
  3763     05  BPMTSL PIC S9(0004) COMP.
  3764     05  BPMTSF PIC  X(0001).
  3765     05  FILLER REDEFINES BPMTSF.
  3766         10  BPMTSA PIC  X(0001).
  3767     05  BPMTSI PIC  999.
  3768*    -------------------------------
  3769     05  BPMTAMTL PIC S9(0004) COMP.
  3770     05  BPMTAMTF PIC  X(0001).
  3771     05  FILLER REDEFINES BPMTAMTF.
  3772         10  BPMTAMTA PIC  X(0001).
  3773     05  BPMTAMTI PIC  9(7)V99.
  3774*    -------------------------------
  3775     05  BAPRL PIC S9(0004) COMP.
  3776     05  BAPRF PIC  X(0001).
  3777     05  FILLER REDEFINES BAPRF.
  3778         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  73
* EL6311.cbl
  3779     05  BAPRI PIC  X(7).
  3780*    -------------------------------
  3781     05  BLIVESL PIC S9(0004) COMP.
  3782     05  BLIVESF PIC  X(0001).
  3783     05  FILLER REDEFINES BLIVESF.
  3784         10  BLIVESA PIC  X(0001).
  3785     05  BLIVESI PIC  X(0009).
  3786*    -------------------------------
  3787     05  BMEMCAPL PIC S9(0004) COMP.
  3788     05  BMEMCAPF PIC  X(0001).
  3789     05  FILLER REDEFINES BMEMCAPF.
  3790         10  BMEMCAPA PIC  X(0001).
  3791     05  BMEMCAPI PIC  X(0011).
  3792*    -------------------------------
  3793     05  BORIGHDL PIC S9(0004) COMP.
  3794     05  BORIGHDF PIC  X(0001).
  3795     05  FILLER REDEFINES BORIGHDF.
  3796         10  BORIGHDA PIC  X(0001).
  3797     05  BORIGHDI PIC  X(0009).
  3798*    -------------------------------
  3799     05  DMDBILL PIC S9(0004) COMP.
  3800     05  DMDBILF PIC  X(0001).
  3801     05  FILLER REDEFINES DMDBILF.
  3802         10  DMDBILA PIC  X(0001).
  3803     05  DMDBILI PIC  X(0006).
  3804*    -------------------------------
  3805     05  BFORCEL PIC S9(0004) COMP.
  3806     05  BFORCEF PIC  X(0001).
  3807     05  FILLER REDEFINES BFORCEF.
  3808         10  BFORCEA PIC  X(0001).
  3809     05  BFORCEI PIC  X(0001).
  3810*    -------------------------------
  3811     05  BENTRYL PIC S9(0004) COMP.
  3812     05  BENTRYF PIC  X(0001).
  3813     05  FILLER REDEFINES BENTRYF.
  3814         10  BENTRYA PIC  X(0001).
  3815     05  BENTRYI PIC  X(0001).
  3816*    -------------------------------
  3817     05  BREINL PIC S9(0004) COMP.
  3818     05  BREINF PIC  X(0001).
  3819     05  FILLER REDEFINES BREINF.
  3820         10  BREINA PIC  X(0001).
  3821     05  BREINI PIC  X(0001).
  3822*    -------------------------------
  3823     05  BBILCDL PIC S9(0004) COMP.
  3824     05  BBILCDF PIC  X(0001).
  3825     05  FILLER REDEFINES BBILCDF.
  3826         10  BBILCDA PIC  X(0001).
  3827     05  BBILCDI PIC  X(0001).
  3828*    -------------------------------
  3829     05  BUNWRITL PIC S9(0004) COMP.
  3830     05  BUNWRITF PIC  X(0001).
  3831     05  FILLER REDEFINES BUNWRITF.
  3832         10  BUNWRITA PIC  X(0001).
  3833     05  BUNWRITI PIC  X(0001).
  3834*    -------------------------------
  3835     05  BSKPCDL PIC S9(0004) COMP.
  3836     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  74
* EL6311.cbl
  3837     05  FILLER REDEFINES BSKPCDF.
  3838         10  BSKPCDA PIC  X(0001).
  3839     05  BSKPCDI PIC  X(0001).
  3840*    -------------------------------
  3841     05  BINDGRPL PIC S9(0004) COMP.
  3842     05  BINDGRPF PIC  X(0001).
  3843     05  FILLER REDEFINES BINDGRPF.
  3844         10  BINDGRPA PIC  X(0001).
  3845     05  BINDGRPI PIC  X(0001).
  3846*    -------------------------------
  3847     05  BSIGL PIC S9(0004) COMP.
  3848     05  BSIGF PIC  X(0001).
  3849     05  FILLER REDEFINES BSIGF.
  3850         10  BSIGA PIC  X(0001).
  3851     05  BSIGI PIC  X(0001).
  3852*    -------------------------------
  3853     05  BRTCLSL PIC S9(0004) COMP.
  3854     05  BRTCLSF PIC  X(0001).
  3855     05  FILLER REDEFINES BRTCLSF.
  3856         10  BRTCLSA PIC  X(0001).
  3857     05  BRTCLSI PIC  X(0002).
  3858*    -------------------------------
  3859     05  BCHGCNTL PIC S9(0004) COMP.
  3860     05  BCHGCNTF PIC  X(0001).
  3861     05  FILLER REDEFINES BCHGCNTF.
  3862         10  BCHGCNTA PIC  X(0001).
  3863     05  BCHGCNTI PIC  X(0003).
  3864*    -------------------------------
  3865     05  BMEMBERL PIC S9(0004) COMP.
  3866     05  BMEMBERF PIC  X(0001).
  3867     05  FILLER REDEFINES BMEMBERF.
  3868         10  BMEMBERA PIC  X(0001).
  3869     05  BMEMBERI PIC  X(0012).
  3870*    -------------------------------
  3871     05  BORGNOL PIC S9(0004) COMP.
  3872     05  BORGNOF PIC  X(0001).
  3873     05  FILLER REDEFINES BORGNOF.
  3874         10  BORGNOA PIC  X(0001).
  3875     05  BORGNOI PIC  X(0006).
  3876*    -------------------------------
  3877     05  BORGSEQL PIC S9(0004) COMP.
  3878     05  BORGSEQF PIC  X(0001).
  3879     05  FILLER REDEFINES BORGSEQF.
  3880         10  BORGSEQA PIC  X(0001).
  3881     05  BORGSEQI PIC  X(0004).
  3882*    -------------------------------
  3883     05  BBILLEDL PIC S9(0004) COMP.
  3884     05  BBILLEDF PIC  X(0001).
  3885     05  FILLER REDEFINES BBILLEDF.
  3886         10  BBILLEDA PIC  X(0001).
  3887     05  BBILLEDI PIC  9(9).
  3888*    -------------------------------
  3889     05  BKIND1L PIC S9(0004) COMP.
  3890     05  BKIND1F PIC  X(0001).
  3891     05  FILLER REDEFINES BKIND1F.
  3892         10  BKIND1A PIC  X(0001).
  3893     05  BKIND1I PIC  X(0002).
  3894*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  75
* EL6311.cbl
  3895     05  BTYPE1L PIC S9(0004) COMP.
  3896     05  BTYPE1F PIC  X(0001).
  3897     05  FILLER REDEFINES BTYPE1F.
  3898         10  BTYPE1A PIC  X(0001).
  3899     05  BTYPE1I PIC  X(0003).
  3900*    -------------------------------
  3901     05  BTERM1L PIC S9(0004) COMP.
  3902     05  BTERM1F PIC  X(0001).
  3903     05  FILLER REDEFINES BTERM1F.
  3904         10  BTERM1A PIC  X(0001).
  3905     05  BTERM1I PIC  X(0003).
  3906*    -------------------------------
  3907     05  BBEN1L PIC S9(0004) COMP.
  3908     05  BBEN1F PIC  X(0001).
  3909     05  FILLER REDEFINES BBEN1F.
  3910         10  BBEN1A PIC  X(0001).
  3911     05  BBEN1I PIC  X(0012).
  3912*    -------------------------------
  3913     05  BPREM1L PIC S9(0004) COMP.
  3914     05  BPREM1F PIC  X(0001).
  3915     05  FILLER REDEFINES BPREM1F.
  3916         10  BPREM1A PIC  X(0001).
  3917     05  BPREM1I PIC  X(0011).
  3918*    -------------------------------
  3919     05  BEXPIR1L PIC S9(0004) COMP.
  3920     05  BEXPIR1F PIC  X(0001).
  3921     05  FILLER REDEFINES BEXPIR1F.
  3922         10  BEXPIR1A PIC  X(0001).
  3923     05  BEXPIR1I PIC  X(0008).
  3924*    -------------------------------
  3925     05  BCP1L PIC S9(0004) COMP.
  3926     05  BCP1F PIC  X(0001).
  3927     05  FILLER REDEFINES BCP1F.
  3928         10  BCP1A PIC  X(0001).
  3929     05  BCP1I PIC  X(0002).
  3930*    -------------------------------
  3931     05  BALTBN1L PIC S9(0004) COMP.
  3932     05  BALTBN1F PIC  X(0001).
  3933     05  FILLER REDEFINES BALTBN1F.
  3934         10  BALTBN1A PIC  X(0001).
  3935     05  BALTBN1I PIC  X(0012).
  3936*    -------------------------------
  3937     05  BALTPR1L PIC S9(0004) COMP.
  3938     05  BALTPR1F PIC  X(0001).
  3939     05  FILLER REDEFINES BALTPR1F.
  3940         10  BALTPR1A PIC  X(0001).
  3941     05  BALTPR1I PIC  X(0011).
  3942*    -------------------------------
  3943     05  BBNCD1L PIC S9(0004) COMP.
  3944     05  BBNCD1F PIC  X(0001).
  3945     05  FILLER REDEFINES BBNCD1F.
  3946         10  BBNCD1A PIC  X(0001).
  3947     05  BBNCD1I PIC  X(0003).
  3948*    -------------------------------
  3949     05  BCPRM1L PIC S9(0004) COMP.
  3950     05  BCPRM1F PIC  X(0001).
  3951     05  FILLER REDEFINES BCPRM1F.
  3952         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  76
* EL6311.cbl
  3953     05  BCPRM1I PIC  X(0011).
  3954*    -------------------------------
  3955     05  BCAPRM1L PIC S9(0004) COMP.
  3956     05  BCAPRM1F PIC  X(0001).
  3957     05  FILLER REDEFINES BCAPRM1F.
  3958         10  BCAPRM1A PIC  X(0001).
  3959     05  BCAPRM1I PIC  X(0011).
  3960*    -------------------------------
  3961     05  BENABR1L PIC S9(0004) COMP.
  3962     05  BENABR1F PIC  X(0001).
  3963     05  FILLER REDEFINES BENABR1F.
  3964         10  BENABR1A PIC  X(0001).
  3965     05  BENABR1I PIC  X(0005).
  3966*    -------------------------------
  3967     05  BDIFF1L PIC S9(0004) COMP.
  3968     05  BDIFF1F PIC  X(0001).
  3969     05  FILLER REDEFINES BDIFF1F.
  3970         10  BDIFF1A PIC  X(0001).
  3971     05  BDIFF1I PIC  X(0011).
  3972*    -------------------------------
  3973     05  BBILIT1L PIC S9(0004) COMP.
  3974     05  BBILIT1F PIC  X(0001).
  3975     05  FILLER REDEFINES BBILIT1F.
  3976         10  BBILIT1A PIC  X(0001).
  3977     05  BBILIT1I PIC  X(0008).
  3978*    -------------------------------
  3979     05  BADIFF1L PIC S9(0004) COMP.
  3980     05  BADIFF1F PIC  X(0001).
  3981     05  FILLER REDEFINES BADIFF1F.
  3982         10  BADIFF1A PIC  X(0001).
  3983     05  BADIFF1I PIC  X(0011).
  3984*    -------------------------------
  3985     05  BKIND2L PIC S9(0004) COMP.
  3986     05  BKIND2F PIC  X(0001).
  3987     05  FILLER REDEFINES BKIND2F.
  3988         10  BKIND2A PIC  X(0001).
  3989     05  BKIND2I PIC  X(0002).
  3990*    -------------------------------
  3991     05  BTYPE2L PIC S9(0004) COMP.
  3992     05  BTYPE2F PIC  X(0001).
  3993     05  FILLER REDEFINES BTYPE2F.
  3994         10  BTYPE2A PIC  X(0001).
  3995     05  BTYPE2I PIC  X(0003).
  3996*    -------------------------------
  3997     05  BTERM2L PIC S9(0004) COMP.
  3998     05  BTERM2F PIC  X(0001).
  3999     05  FILLER REDEFINES BTERM2F.
  4000         10  BTERM2A PIC  X(0001).
  4001     05  BTERM2I PIC  X(0003).
  4002*    -------------------------------
  4003     05  BBEN2L PIC S9(0004) COMP.
  4004     05  BBEN2F PIC  X(0001).
  4005     05  FILLER REDEFINES BBEN2F.
  4006         10  BBEN2A PIC  X(0001).
  4007     05  BBEN2I PIC  X(0012).
  4008*    -------------------------------
  4009     05  BPREM2L PIC S9(0004) COMP.
  4010     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  77
* EL6311.cbl
  4011     05  FILLER REDEFINES BPREM2F.
  4012         10  BPREM2A PIC  X(0001).
  4013     05  BPREM2I PIC  X(0011).
  4014*    -------------------------------
  4015     05  BEXPIR2L PIC S9(0004) COMP.
  4016     05  BEXPIR2F PIC  X(0001).
  4017     05  FILLER REDEFINES BEXPIR2F.
  4018         10  BEXPIR2A PIC  X(0001).
  4019     05  BEXPIR2I PIC  X(0008).
  4020*    -------------------------------
  4021     05  BCP2L PIC S9(0004) COMP.
  4022     05  BCP2F PIC  X(0001).
  4023     05  FILLER REDEFINES BCP2F.
  4024         10  BCP2A PIC  X(0001).
  4025     05  BCP2I PIC  X(0002).
  4026*    -------------------------------
  4027     05  BALTBN2L PIC S9(0004) COMP.
  4028     05  BALTBN2F PIC  X(0001).
  4029     05  FILLER REDEFINES BALTBN2F.
  4030         10  BALTBN2A PIC  X(0001).
  4031     05  BALTBN2I PIC  X(0012).
  4032*    -------------------------------
  4033     05  BALTPR2L PIC S9(0004) COMP.
  4034     05  BALTPR2F PIC  X(0001).
  4035     05  FILLER REDEFINES BALTPR2F.
  4036         10  BALTPR2A PIC  X(0001).
  4037     05  BALTPR2I PIC  X(0011).
  4038*    -------------------------------
  4039     05  BBNCD2L PIC S9(0004) COMP.
  4040     05  BBNCD2F PIC  X(0001).
  4041     05  FILLER REDEFINES BBNCD2F.
  4042         10  BBNCD2A PIC  X(0001).
  4043     05  BBNCD2I PIC  X(0003).
  4044*    -------------------------------
  4045     05  BCPRM2L PIC S9(0004) COMP.
  4046     05  BCPRM2F PIC  X(0001).
  4047     05  FILLER REDEFINES BCPRM2F.
  4048         10  BCPRM2A PIC  X(0001).
  4049     05  BCPRM2I PIC  X(0011).
  4050*    -------------------------------
  4051     05  BCAPRM2L PIC S9(0004) COMP.
  4052     05  BCAPRM2F PIC  X(0001).
  4053     05  FILLER REDEFINES BCAPRM2F.
  4054         10  BCAPRM2A PIC  X(0001).
  4055     05  BCAPRM2I PIC  X(0011).
  4056*    -------------------------------
  4057     05  BENABR2L PIC S9(0004) COMP.
  4058     05  BENABR2F PIC  X(0001).
  4059     05  FILLER REDEFINES BENABR2F.
  4060         10  BENABR2A PIC  X(0001).
  4061     05  BENABR2I PIC  X(0005).
  4062*    -------------------------------
  4063     05  BDIFF2L PIC S9(0004) COMP.
  4064     05  BDIFF2F PIC  X(0001).
  4065     05  FILLER REDEFINES BDIFF2F.
  4066         10  BDIFF2A PIC  X(0001).
  4067     05  BDIFF2I PIC  X(0011).
  4068*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  78
* EL6311.cbl
  4069     05  BBILIT2L PIC S9(0004) COMP.
  4070     05  BBILIT2F PIC  X(0001).
  4071     05  FILLER REDEFINES BBILIT2F.
  4072         10  BBILIT2A PIC  X(0001).
  4073     05  BBILIT2I PIC  X(0008).
  4074*    -------------------------------
  4075     05  BADIFF2L PIC S9(0004) COMP.
  4076     05  BADIFF2F PIC  X(0001).
  4077     05  FILLER REDEFINES BADIFF2F.
  4078         10  BADIFF2A PIC  X(0001).
  4079     05  BADIFF2I PIC  X(0011).
  4080*    -------------------------------
  4081     05  BERMSG1L PIC S9(0004) COMP.
  4082     05  BERMSG1F PIC  X(0001).
  4083     05  FILLER REDEFINES BERMSG1F.
  4084         10  BERMSG1A PIC  X(0001).
  4085     05  BERMSG1I PIC  X(0078).
  4086*    -------------------------------
  4087     05  BERMSG2L PIC S9(0004) COMP.
  4088     05  BERMSG2F PIC  X(0001).
  4089     05  FILLER REDEFINES BERMSG2F.
  4090         10  BERMSG2A PIC  X(0001).
  4091     05  BERMSG2I PIC  X(0078).
  4092*    -------------------------------
  4093     05  BERMSG3L PIC S9(0004) COMP.
  4094     05  BERMSG3F PIC  X(0001).
  4095     05  FILLER REDEFINES BERMSG3F.
  4096         10  BERMSG3A PIC  X(0001).
  4097     05  BERMSG3I PIC  X(0078).
  4098*    -------------------------------
  4099     05  BPFENTRL PIC S9(0004) COMP.
  4100     05  BPFENTRF PIC  X(0001).
  4101     05  FILLER REDEFINES BPFENTRF.
  4102         10  BPFENTRA PIC  X(0001).
  4103     05  BPFENTRI PIC  9(2).
  4104*    -------------------------------
  4105     05  BPF5HDRL PIC S9(0004) COMP.
  4106     05  BPF5HDRF PIC  X(0001).
  4107     05  FILLER REDEFINES BPF5HDRF.
  4108         10  BPF5HDRA PIC  X(0001).
  4109     05  BPF5HDRI PIC  X(0005).
  4110*    -------------------------------
  4111     05  BPF4HDRL PIC S9(0004) COMP.
  4112     05  BPF4HDRF PIC  X(0001).
  4113     05  FILLER REDEFINES BPF4HDRF.
  4114         10  BPF4HDRA PIC  X(0001).
  4115     05  BPF4HDRI PIC  X(0013).
  4116*    -------------------------------
  4117     05  BF15HDRL PIC S9(0004) COMP.
  4118     05  BF15HDRF PIC  X(0001).
  4119     05  FILLER REDEFINES BF15HDRF.
  4120         10  BF15HDRA PIC  X(0001).
  4121     05  BF15HDRI PIC  X(0010).
  4122 01  EL631BO REDEFINES EL631BI.
  4123     05  FILLER            PIC  X(0012).
  4124*    -------------------------------
  4125     05  FILLER            PIC  X(0003).
  4126     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  79
* EL6311.cbl
  4127*    -------------------------------
  4128     05  FILLER            PIC  X(0003).
  4129     05  BTIMEO PIC  99.99.
  4130*    -------------------------------
  4131     05  FILLER            PIC  X(0003).
  4132     05  BHEADO PIC  X(0038).
  4133*    -------------------------------
  4134     05  FILLER            PIC  X(0003).
  4135     05  BNCERTLO PIC  X(0008).
  4136*    -------------------------------
  4137     05  FILLER            PIC  X(0003).
  4138     05  BNCERTO PIC  X(0011).
  4139*    -------------------------------
  4140     05  FILLER            PIC  X(0003).
  4141     05  BNSTATLO PIC  X(0009).
  4142*    -------------------------------
  4143     05  FILLER            PIC  X(0003).
  4144     05  BNSTATO PIC  X(0002).
  4145*    -------------------------------
  4146     05  FILLER            PIC  X(0003).
  4147     05  BCHGTO PIC  X(0004).
  4148*    -------------------------------
  4149     05  FILLER            PIC  X(0003).
  4150     05  BCHGO PIC  ZZZ9.
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BCOMPIDO PIC  X(0003).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BREGIONO PIC  X(0006).
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BUSERO PIC  X(0004).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BMAINTO PIC  X(0001).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BMANTBYO PIC  X(0004).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BCHGHDGO PIC  X(0003).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BMANTDTO PIC  X(0008).
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BMANTATO PIC  99.99.
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BCSRO PIC  X(0004).
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BBATCHO PIC  X(0006).
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BSEQO PIC  X(0004).
  4184*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  80
* EL6311.cbl
  4185     05  FILLER            PIC  X(0003).
  4186     05  BMOENDTO PIC  X(0008).
  4187*    -------------------------------
  4188     05  FILLER            PIC  X(0003).
  4189     05  BCARRO PIC  X(0001).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BGROUPO PIC  X(0006).
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BSTATEO PIC  X(0002).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BACCTO PIC  X(0010).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BVINHO PIC  X(0004).
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BVINO PIC  X(0017).
  4205*    -------------------------------
  4206     05  FILLER            PIC  X(0003).
  4207     05  BREFHDGO PIC  X(0004).
  4208*    -------------------------------
  4209     05  FILLER            PIC  X(0003).
  4210     05  BREFO PIC  X(0012).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BAGEDEFO PIC  X(0004).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BCERTNOO PIC  X(0010).
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BSUFIXO PIC  X(0001).
  4220*    -------------------------------
  4221     05  FILLER            PIC  X(0003).
  4222     05  BEFFDTO PIC  X(0008).
  4223*    -------------------------------
  4224     05  FILLER            PIC  X(0003).
  4225     05  BLSTNMO PIC  X(0015).
  4226*    -------------------------------
  4227     05  FILLER            PIC  X(0003).
  4228     05  B1STNMO PIC  X(0010).
  4229*    -------------------------------
  4230     05  FILLER            PIC  X(0003).
  4231     05  BINITO PIC  X(0001).
  4232*    -------------------------------
  4233     05  FILLER            PIC  X(0003).
  4234     05  BSEXO PIC  X(0001).
  4235*    -------------------------------
  4236     05  FILLER            PIC  X(0003).
  4237     05  BAGEO PIC  X(0002).
  4238*    -------------------------------
  4239     05  FILLER            PIC  X(0003).
  4240     05  BBIRTHO PIC  X(0008).
  4241*    -------------------------------
  4242     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  81
* EL6311.cbl
  4243     05  B1STPMTO PIC  X(0008).
  4244*    -------------------------------
  4245     05  FILLER            PIC  X(0003).
  4246     05  BDAYSO PIC  X(0003).
  4247*    -------------------------------
  4248     05  FILLER            PIC  X(0003).
  4249     05  BLNTRMO PIC  X(0003).
  4250*    -------------------------------
  4251     05  FILLER            PIC  X(0003).
  4252     05  BLNOFCRO PIC  X(0005).
  4253*    -------------------------------
  4254     05  FILLER            PIC  X(0003).
  4255     05  BMODEO PIC  X(0001).
  4256*    -------------------------------
  4257     05  FILLER            PIC  X(0003).
  4258     05  BFREQO PIC  X(0002).
  4259*    -------------------------------
  4260     05  FILLER            PIC  X(0003).
  4261     05  BPMTSO PIC  X(0003).
  4262*    -------------------------------
  4263     05  FILLER            PIC  X(0003).
  4264     05  BPMTAMTO PIC  ZZZZZ9.99.
  4265*    -------------------------------
  4266     05  FILLER            PIC  X(0003).
  4267     05  BAPRO PIC  99.9999.
  4268*    -------------------------------
  4269     05  FILLER            PIC  X(0003).
  4270     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4271*    -------------------------------
  4272     05  FILLER            PIC  X(0003).
  4273     05  BMEMCAPO PIC  X(0011).
  4274*    -------------------------------
  4275     05  FILLER            PIC  X(0003).
  4276     05  BORIGHDO PIC  X(0009).
  4277*    -------------------------------
  4278     05  FILLER            PIC  X(0003).
  4279     05  DMDBILO PIC  X(0006).
  4280*    -------------------------------
  4281     05  FILLER            PIC  X(0003).
  4282     05  BFORCEO PIC  X(0001).
  4283*    -------------------------------
  4284     05  FILLER            PIC  X(0003).
  4285     05  BENTRYO PIC  X(0001).
  4286*    -------------------------------
  4287     05  FILLER            PIC  X(0003).
  4288     05  BREINO PIC  X(0001).
  4289*    -------------------------------
  4290     05  FILLER            PIC  X(0003).
  4291     05  BBILCDO PIC  X(0001).
  4292*    -------------------------------
  4293     05  FILLER            PIC  X(0003).
  4294     05  BUNWRITO PIC  X(0001).
  4295*    -------------------------------
  4296     05  FILLER            PIC  X(0003).
  4297     05  BSKPCDO PIC  X(0001).
  4298*    -------------------------------
  4299     05  FILLER            PIC  X(0003).
  4300     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  82
* EL6311.cbl
  4301*    -------------------------------
  4302     05  FILLER            PIC  X(0003).
  4303     05  BSIGO PIC  X(0001).
  4304*    -------------------------------
  4305     05  FILLER            PIC  X(0003).
  4306     05  BRTCLSO PIC  X(0002).
  4307*    -------------------------------
  4308     05  FILLER            PIC  X(0003).
  4309     05  BCHGCNTO PIC  X(0003).
  4310*    -------------------------------
  4311     05  FILLER            PIC  X(0003).
  4312     05  BMEMBERO PIC  X(0012).
  4313*    -------------------------------
  4314     05  FILLER            PIC  X(0003).
  4315     05  BORGNOO PIC  X(0006).
  4316*    -------------------------------
  4317     05  FILLER            PIC  X(0003).
  4318     05  BORGSEQO PIC  X(0004).
  4319*    -------------------------------
  4320     05  FILLER            PIC  X(0003).
  4321     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4322*    -------------------------------
  4323     05  FILLER            PIC  X(0003).
  4324     05  BKIND1O PIC  X(0002).
  4325*    -------------------------------
  4326     05  FILLER            PIC  X(0003).
  4327     05  BTYPE1O PIC  X(0003).
  4328*    -------------------------------
  4329     05  FILLER            PIC  X(0003).
  4330     05  BTERM1O PIC  X(0003).
  4331*    -------------------------------
  4332     05  FILLER            PIC  X(0003).
  4333     05  BBEN1O PIC  X(0012).
  4334*    -------------------------------
  4335     05  FILLER            PIC  X(0003).
  4336     05  BPREM1O PIC  X(0011).
  4337*    -------------------------------
  4338     05  FILLER            PIC  X(0003).
  4339     05  BEXPIR1O PIC  X(0008).
  4340*    -------------------------------
  4341     05  FILLER            PIC  X(0003).
  4342     05  BCP1O PIC  X(0002).
  4343*    -------------------------------
  4344     05  FILLER            PIC  X(0003).
  4345     05  BALTBN1O PIC  X(0012).
  4346*    -------------------------------
  4347     05  FILLER            PIC  X(0003).
  4348     05  BALTPR1O PIC  X(0011).
  4349*    -------------------------------
  4350     05  FILLER            PIC  X(0003).
  4351     05  BBNCD1O PIC  X(0003).
  4352*    -------------------------------
  4353     05  FILLER            PIC  X(0003).
  4354     05  BCPRM1O PIC  X(0011).
  4355*    -------------------------------
  4356     05  FILLER            PIC  X(0003).
  4357     05  BCAPRM1O PIC  X(0011).
  4358*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  83
* EL6311.cbl
  4359     05  FILLER            PIC  X(0003).
  4360     05  BENABR1O PIC  X(0005).
  4361*    -------------------------------
  4362     05  FILLER            PIC  X(0003).
  4363     05  BDIFF1O PIC  X(0011).
  4364*    -------------------------------
  4365     05  FILLER            PIC  X(0003).
  4366     05  BBILIT1O PIC  X(0008).
  4367*    -------------------------------
  4368     05  FILLER            PIC  X(0003).
  4369     05  BADIFF1O PIC  X(0011).
  4370*    -------------------------------
  4371     05  FILLER            PIC  X(0003).
  4372     05  BKIND2O PIC  X(0002).
  4373*    -------------------------------
  4374     05  FILLER            PIC  X(0003).
  4375     05  BTYPE2O PIC  X(0003).
  4376*    -------------------------------
  4377     05  FILLER            PIC  X(0003).
  4378     05  BTERM2O PIC  X(0003).
  4379*    -------------------------------
  4380     05  FILLER            PIC  X(0003).
  4381     05  BBEN2O PIC  X(0012).
  4382*    -------------------------------
  4383     05  FILLER            PIC  X(0003).
  4384     05  BPREM2O PIC  X(0011).
  4385*    -------------------------------
  4386     05  FILLER            PIC  X(0003).
  4387     05  BEXPIR2O PIC  X(0008).
  4388*    -------------------------------
  4389     05  FILLER            PIC  X(0003).
  4390     05  BCP2O PIC  X(0002).
  4391*    -------------------------------
  4392     05  FILLER            PIC  X(0003).
  4393     05  BALTBN2O PIC  X(0012).
  4394*    -------------------------------
  4395     05  FILLER            PIC  X(0003).
  4396     05  BALTPR2O PIC  X(0011).
  4397*    -------------------------------
  4398     05  FILLER            PIC  X(0003).
  4399     05  BBNCD2O PIC  X(0003).
  4400*    -------------------------------
  4401     05  FILLER            PIC  X(0003).
  4402     05  BCPRM2O PIC  X(0011).
  4403*    -------------------------------
  4404     05  FILLER            PIC  X(0003).
  4405     05  BCAPRM2O PIC  X(0011).
  4406*    -------------------------------
  4407     05  FILLER            PIC  X(0003).
  4408     05  BENABR2O PIC  X(0005).
  4409*    -------------------------------
  4410     05  FILLER            PIC  X(0003).
  4411     05  BDIFF2O PIC  X(0011).
  4412*    -------------------------------
  4413     05  FILLER            PIC  X(0003).
  4414     05  BBILIT2O PIC  X(0008).
  4415*    -------------------------------
  4416     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  84
* EL6311.cbl
  4417     05  BADIFF2O PIC  X(0011).
  4418*    -------------------------------
  4419     05  FILLER            PIC  X(0003).
  4420     05  BERMSG1O PIC  X(0078).
  4421*    -------------------------------
  4422     05  FILLER            PIC  X(0003).
  4423     05  BERMSG2O PIC  X(0078).
  4424*    -------------------------------
  4425     05  FILLER            PIC  X(0003).
  4426     05  BERMSG3O PIC  X(0078).
  4427*    -------------------------------
  4428     05  FILLER            PIC  X(0003).
  4429     05  BPFENTRO PIC  X(0002).
  4430*    -------------------------------
  4431     05  FILLER            PIC  X(0003).
  4432     05  BPF5HDRO PIC  X(0005).
  4433*    -------------------------------
  4434     05  FILLER            PIC  X(0003).
  4435     05  BPF4HDRO PIC  X(0013).
  4436*    -------------------------------
  4437     05  FILLER            PIC  X(0003).
  4438     05  BF15HDRO PIC  X(0010).
  4439*    -------------------------------
  4440 01  EL631CI REDEFINES EL631BI.
  4441     05  FILLER            PIC  X(0012).
  4442*    -------------------------------
  4443     05  CDATEL PIC S9(0004) COMP.
  4444     05  CDATEF PIC  X(0001).
  4445     05  FILLER REDEFINES CDATEF.
  4446         10  CDATEA PIC  X(0001).
  4447     05  CDATEI PIC  X(0008).
  4448*    -------------------------------
  4449     05  CTIMEL PIC S9(0004) COMP.
  4450     05  CTIMEF PIC  X(0001).
  4451     05  FILLER REDEFINES CTIMEF.
  4452         10  CTIMEA PIC  X(0001).
  4453     05  CTIMEI PIC  X(0005).
  4454*    -------------------------------
  4455     05  CHEADL PIC S9(0004) COMP.
  4456     05  CHEADF PIC  X(0001).
  4457     05  FILLER REDEFINES CHEADF.
  4458         10  CHEADA PIC  X(0001).
  4459     05  CHEADI PIC  X(0038).
  4460*    -------------------------------
  4461     05  CCHGTL PIC S9(0004) COMP.
  4462     05  CCHGTF PIC  X(0001).
  4463     05  FILLER REDEFINES CCHGTF.
  4464         10  CCHGTA PIC  X(0001).
  4465     05  CCHGTI PIC  X(0004).
  4466*    -------------------------------
  4467     05  CCHGL PIC S9(0004) COMP.
  4468     05  CCHGF PIC  X(0001).
  4469     05  FILLER REDEFINES CCHGF.
  4470         10  CCHGA PIC  X(0001).
  4471     05  CCHGI PIC  X(0004).
  4472*    -------------------------------
  4473     05  CMAINTL PIC S9(0004) COMP.
  4474     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  85
* EL6311.cbl
  4475     05  FILLER REDEFINES CMAINTF.
  4476         10  CMAINTA PIC  X(0001).
  4477     05  CMAINTI PIC  X(0001).
  4478*    -------------------------------
  4479     05  CMANTBYL PIC S9(0004) COMP.
  4480     05  CMANTBYF PIC  X(0001).
  4481     05  FILLER REDEFINES CMANTBYF.
  4482         10  CMANTBYA PIC  X(0001).
  4483     05  CMANTBYI PIC  X(0004).
  4484*    -------------------------------
  4485     05  CCHGHDGL PIC S9(0004) COMP.
  4486     05  CCHGHDGF PIC  X(0001).
  4487     05  FILLER REDEFINES CCHGHDGF.
  4488         10  CCHGHDGA PIC  X(0001).
  4489     05  CCHGHDGI PIC  X(0003).
  4490*    -------------------------------
  4491     05  CMANTDTL PIC S9(0004) COMP.
  4492     05  CMANTDTF PIC  X(0001).
  4493     05  FILLER REDEFINES CMANTDTF.
  4494         10  CMANTDTA PIC  X(0001).
  4495     05  CMANTDTI PIC  X(0008).
  4496*    -------------------------------
  4497     05  CMANTATL PIC S9(0004) COMP.
  4498     05  CMANTATF PIC  X(0001).
  4499     05  FILLER REDEFINES CMANTATF.
  4500         10  CMANTATA PIC  X(0001).
  4501     05  CMANTATI PIC  X(0005).
  4502*    -------------------------------
  4503     05  CCSRL PIC S9(0004) COMP.
  4504     05  CCSRF PIC  X(0001).
  4505     05  FILLER REDEFINES CCSRF.
  4506         10  CCSRA PIC  X(0001).
  4507     05  CCSRI PIC  X(0004).
  4508*    -------------------------------
  4509     05  CBATCHL PIC S9(0004) COMP.
  4510     05  CBATCHF PIC  X(0001).
  4511     05  FILLER REDEFINES CBATCHF.
  4512         10  CBATCHA PIC  X(0001).
  4513     05  CBATCHI PIC  X(0006).
  4514*    -------------------------------
  4515     05  CSEQL PIC S9(0004) COMP.
  4516     05  CSEQF PIC  X(0001).
  4517     05  FILLER REDEFINES CSEQF.
  4518         10  CSEQA PIC  X(0001).
  4519     05  CSEQI PIC  X(0004).
  4520*    -------------------------------
  4521     05  CMOENDTL PIC S9(0004) COMP.
  4522     05  CMOENDTF PIC  X(0001).
  4523     05  FILLER REDEFINES CMOENDTF.
  4524         10  CMOENDTA PIC  X(0001).
  4525     05  CMOENDTI PIC  X(0008).
  4526*    -------------------------------
  4527     05  CCARRL PIC S9(0004) COMP.
  4528     05  CCARRF PIC  X(0001).
  4529     05  FILLER REDEFINES CCARRF.
  4530         10  CCARRA PIC  X(0001).
  4531     05  CCARRI PIC  X(0001).
  4532*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  86
* EL6311.cbl
  4533     05  CGROUPL PIC S9(0004) COMP.
  4534     05  CGROUPF PIC  X(0001).
  4535     05  FILLER REDEFINES CGROUPF.
  4536         10  CGROUPA PIC  X(0001).
  4537     05  CGROUPI PIC  X(0006).
  4538*    -------------------------------
  4539     05  CSTATEL PIC S9(0004) COMP.
  4540     05  CSTATEF PIC  X(0001).
  4541     05  FILLER REDEFINES CSTATEF.
  4542         10  CSTATEA PIC  X(0001).
  4543     05  CSTATEI PIC  X(0002).
  4544*    -------------------------------
  4545     05  CACCTL PIC S9(0004) COMP.
  4546     05  CACCTF PIC  X(0001).
  4547     05  FILLER REDEFINES CACCTF.
  4548         10  CACCTA PIC  X(0001).
  4549     05  CACCTI PIC  X(0010).
  4550*    -------------------------------
  4551     05  CORIGHDL PIC S9(0004) COMP.
  4552     05  CORIGHDF PIC  X(0001).
  4553     05  FILLER REDEFINES CORIGHDF.
  4554         10  CORIGHDA PIC  X(0001).
  4555     05  CORIGHDI PIC  X(0011).
  4556*    -------------------------------
  4557     05  CORGNOL PIC S9(0004) COMP.
  4558     05  CORGNOF PIC  X(0001).
  4559     05  FILLER REDEFINES CORGNOF.
  4560         10  CORGNOA PIC  X(0001).
  4561     05  CORGNOI PIC  X(0006).
  4562*    -------------------------------
  4563     05  CORGSEQL PIC S9(0004) COMP.
  4564     05  CORGSEQF PIC  X(0001).
  4565     05  FILLER REDEFINES CORGSEQF.
  4566         10  CORGSEQA PIC  X(0001).
  4567     05  CORGSEQI PIC  X(0004).
  4568*    -------------------------------
  4569     05  CREFHDGL PIC S9(0004) COMP.
  4570     05  CREFHDGF PIC  X(0001).
  4571     05  FILLER REDEFINES CREFHDGF.
  4572         10  CREFHDGA PIC  X(0001).
  4573     05  CREFHDGI PIC  X(0010).
  4574*    -------------------------------
  4575     05  CREFL PIC S9(0004) COMP.
  4576     05  CREFF PIC  X(0001).
  4577     05  FILLER REDEFINES CREFF.
  4578         10  CREFA PIC  X(0001).
  4579     05  CREFI PIC  X(0012).
  4580*    -------------------------------
  4581     05  CNHINTL PIC S9(0004) COMP.
  4582     05  CNHINTF PIC  X(0001).
  4583     05  FILLER REDEFINES CNHINTF.
  4584         10  CNHINTA PIC  X(0001).
  4585     05  CNHINTI PIC  9(7)V99.
  4586*    -------------------------------
  4587     05  CCERTNOL PIC S9(0004) COMP.
  4588     05  CCERTNOF PIC  X(0001).
  4589     05  FILLER REDEFINES CCERTNOF.
  4590         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  87
* EL6311.cbl
  4591     05  CCERTNOI PIC  X(0010).
  4592*    -------------------------------
  4593     05  CSUFIXL PIC S9(0004) COMP.
  4594     05  CSUFIXF PIC  X(0001).
  4595     05  FILLER REDEFINES CSUFIXF.
  4596         10  CSUFIXA PIC  X(0001).
  4597     05  CSUFIXI PIC  X(0001).
  4598*    -------------------------------
  4599     05  CEFFDTL PIC S9(0004) COMP.
  4600     05  CEFFDTF PIC  X(0001).
  4601     05  FILLER REDEFINES CEFFDTF.
  4602         10  CEFFDTA PIC  X(0001).
  4603     05  CEFFDTI PIC  X(0008).
  4604*    -------------------------------
  4605     05  CLSTNML PIC S9(0004) COMP.
  4606     05  CLSTNMF PIC  X(0001).
  4607     05  FILLER REDEFINES CLSTNMF.
  4608         10  CLSTNMA PIC  X(0001).
  4609     05  CLSTNMI PIC  X(0015).
  4610*    -------------------------------
  4611     05  CPCYNL PIC S9(0004) COMP.
  4612     05  CPCYNF PIC  X(0001).
  4613     05  FILLER REDEFINES CPCYNF.
  4614         10  CPCYNA PIC  X(0001).
  4615     05  CPCYNI PIC  X(0001).
  4616*    -------------------------------
  4617     05  CINAMEL PIC S9(0004) COMP.
  4618     05  CINAMEF PIC  X(0001).
  4619     05  FILLER REDEFINES CINAMEF.
  4620         10  CINAMEA PIC  X(0001).
  4621     05  CINAMEI PIC  X(0015).
  4622*    -------------------------------
  4623     05  CINITSL PIC S9(0004) COMP.
  4624     05  CINITSF PIC  X(0001).
  4625     05  FILLER REDEFINES CINITSF.
  4626         10  CINITSA PIC  X(0001).
  4627     05  CINITSI PIC  X(0010).
  4628*    -------------------------------
  4629     05  CCANREAL PIC S9(0004) COMP.
  4630     05  CCANREAF PIC  X(0001).
  4631     05  FILLER REDEFINES CCANREAF.
  4632         10  CCANREAA PIC  X(0001).
  4633     05  CCANREAI PIC  X(0001).
  4634*    -------------------------------
  4635     05  ACTSPCL PIC S9(0004) COMP.
  4636     05  ACTSPCF PIC  X(0001).
  4637     05  FILLER REDEFINES ACTSPCF.
  4638         10  ACTSPCA PIC  X(0001).
  4639     05  ACTSPCI PIC  X(0001).
  4640*    -------------------------------
  4641     05  CKIND1L PIC S9(0004) COMP.
  4642     05  CKIND1F PIC  X(0001).
  4643     05  FILLER REDEFINES CKIND1F.
  4644         10  CKIND1A PIC  X(0001).
  4645     05  CKIND1I PIC  X(0002).
  4646*    -------------------------------
  4647     05  CCANDT1L PIC S9(0004) COMP.
  4648     05  CCANDT1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  88
* EL6311.cbl
  4649     05  FILLER REDEFINES CCANDT1F.
  4650         10  CCANDT1A PIC  X(0001).
  4651     05  CCANDT1I PIC  X(0008).
  4652*    -------------------------------
  4653     05  CREFND1L PIC S9(0004) COMP.
  4654     05  CREFND1F PIC  X(0001).
  4655     05  FILLER REDEFINES CREFND1F.
  4656         10  CREFND1A PIC  X(0001).
  4657     05  CREFND1I PIC  S9(9)V99.
  4658*    -------------------------------
  4659     05  CMTHD1L PIC S9(0004) COMP.
  4660     05  CMTHD1F PIC  X(0001).
  4661     05  FILLER REDEFINES CMTHD1F.
  4662         10  CMTHD1A PIC  X(0001).
  4663     05  CMTHD1I PIC  X(0001).
  4664*    -------------------------------
  4665     05  CKIND2L PIC S9(0004) COMP.
  4666     05  CKIND2F PIC  X(0001).
  4667     05  FILLER REDEFINES CKIND2F.
  4668         10  CKIND2A PIC  X(0001).
  4669     05  CKIND2I PIC  X(0002).
  4670*    -------------------------------
  4671     05  CCANDT2L PIC S9(0004) COMP.
  4672     05  CCANDT2F PIC  X(0001).
  4673     05  FILLER REDEFINES CCANDT2F.
  4674         10  CCANDT2A PIC  X(0001).
  4675     05  CCANDT2I PIC  X(0008).
  4676*    -------------------------------
  4677     05  CREFND2L PIC S9(0004) COMP.
  4678     05  CREFND2F PIC  X(0001).
  4679     05  FILLER REDEFINES CREFND2F.
  4680         10  CREFND2A PIC  X(0001).
  4681     05  CREFND2I PIC  S9(9)V99.
  4682*    -------------------------------
  4683     05  CMTHD2L PIC S9(0004) COMP.
  4684     05  CMTHD2F PIC  X(0001).
  4685     05  FILLER REDEFINES CMTHD2F.
  4686         10  CMTHD2A PIC  X(0001).
  4687     05  CMTHD2I PIC  X(0001).
  4688*    -------------------------------
  4689     05  CLIVESL PIC S9(0004) COMP.
  4690     05  CLIVESF PIC  X(0001).
  4691     05  FILLER REDEFINES CLIVESF.
  4692         10  CLIVESA PIC  X(0001).
  4693     05  CLIVESI PIC  X(0003).
  4694*    -------------------------------
  4695     05  CFORCEL PIC S9(0004) COMP.
  4696     05  CFORCEF PIC  X(0001).
  4697     05  FILLER REDEFINES CFORCEF.
  4698         10  CFORCEA PIC  X(0001).
  4699     05  CFORCEI PIC  X(0001).
  4700*    -------------------------------
  4701     05  CBILCDL PIC S9(0004) COMP.
  4702     05  CBILCDF PIC  X(0001).
  4703     05  FILLER REDEFINES CBILCDF.
  4704         10  CBILCDA PIC  X(0001).
  4705     05  CBILCDI PIC  X(0001).
  4706*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  89
* EL6311.cbl
  4707     05  CCRFND1L PIC S9(0004) COMP.
  4708     05  CCRFND1F PIC  X(0001).
  4709     05  FILLER REDEFINES CCRFND1F.
  4710         10  CCRFND1A PIC  X(0001).
  4711     05  CCRFND1I PIC  X(0011).
  4712*    -------------------------------
  4713     05  CCRFND2L PIC S9(0004) COMP.
  4714     05  CCRFND2F PIC  X(0001).
  4715     05  FILLER REDEFINES CCRFND2F.
  4716         10  CCRFND2A PIC  X(0001).
  4717     05  CCRFND2I PIC  X(0011).
  4718*    -------------------------------
  4719     05  CBILIT1L PIC S9(0004) COMP.
  4720     05  CBILIT1F PIC  X(0001).
  4721     05  FILLER REDEFINES CBILIT1F.
  4722         10  CBILIT1A PIC  X(0001).
  4723     05  CBILIT1I PIC  X(0008).
  4724*    -------------------------------
  4725     05  CDRFND1L PIC S9(0004) COMP.
  4726     05  CDRFND1F PIC  X(0001).
  4727     05  FILLER REDEFINES CDRFND1F.
  4728         10  CDRFND1A PIC  X(0001).
  4729     05  CDRFND1I PIC  X(0011).
  4730*    -------------------------------
  4731     05  CBILIT2L PIC S9(0004) COMP.
  4732     05  CBILIT2F PIC  X(0001).
  4733     05  FILLER REDEFINES CBILIT2F.
  4734         10  CBILIT2A PIC  X(0001).
  4735     05  CBILIT2I PIC  X(0008).
  4736*    -------------------------------
  4737     05  CDRFND2L PIC S9(0004) COMP.
  4738     05  CDRFND2F PIC  X(0001).
  4739     05  FILLER REDEFINES CDRFND2F.
  4740         10  CDRFND2A PIC  X(0001).
  4741     05  CDRFND2I PIC  X(0011).
  4742*    -------------------------------
  4743     05  CCANTXTL PIC S9(0004) COMP.
  4744     05  CCANTXTF PIC  X(0001).
  4745     05  FILLER REDEFINES CCANTXTF.
  4746         10  CCANTXTA PIC  X(0001).
  4747     05  CCANTXTI PIC  X(0005).
  4748*    -------------------------------
  4749     05  CCANFEEL PIC S9(0004) COMP.
  4750     05  CCANFEEF PIC  X(0001).
  4751     05  FILLER REDEFINES CCANFEEF.
  4752         10  CCANFEEA PIC  X(0001).
  4753     05  CCANFEEI PIC  X(0002).
  4754*    -------------------------------
  4755     05  CTERM1L PIC S9(0004) COMP.
  4756     05  CTERM1F PIC  X(0001).
  4757     05  FILLER REDEFINES CTERM1F.
  4758         10  CTERM1A PIC  X(0001).
  4759     05  CTERM1I PIC  X(0003).
  4760*    -------------------------------
  4761     05  CRTERM1L PIC S9(0004) COMP.
  4762     05  CRTERM1F PIC  X(0001).
  4763     05  FILLER REDEFINES CRTERM1F.
  4764         10  CRTERM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  90
* EL6311.cbl
  4765     05  CRTERM1I PIC  X(0003).
  4766*    -------------------------------
  4767     05  CPREM1L PIC S9(0004) COMP.
  4768     05  CPREM1F PIC  X(0001).
  4769     05  FILLER REDEFINES CPREM1F.
  4770         10  CPREM1A PIC  X(0001).
  4771     05  CPREM1I PIC  X(0011).
  4772*    -------------------------------
  4773     05  CTERM2L PIC S9(0004) COMP.
  4774     05  CTERM2F PIC  X(0001).
  4775     05  FILLER REDEFINES CTERM2F.
  4776         10  CTERM2A PIC  X(0001).
  4777     05  CTERM2I PIC  X(0003).
  4778*    -------------------------------
  4779     05  CRTERM2L PIC S9(0004) COMP.
  4780     05  CRTERM2F PIC  X(0001).
  4781     05  FILLER REDEFINES CRTERM2F.
  4782         10  CRTERM2A PIC  X(0001).
  4783     05  CRTERM2I PIC  X(0003).
  4784*    -------------------------------
  4785     05  CPREM2L PIC S9(0004) COMP.
  4786     05  CPREM2F PIC  X(0001).
  4787     05  FILLER REDEFINES CPREM2F.
  4788         10  CPREM2A PIC  X(0001).
  4789     05  CPREM2I PIC  X(0011).
  4790*    -------------------------------
  4791     05  CENTRDTL PIC S9(0004) COMP.
  4792     05  CENTRDTF PIC  X(0001).
  4793     05  FILLER REDEFINES CENTRDTF.
  4794         10  CENTRDTA PIC  X(0001).
  4795     05  CENTRDTI PIC  X(0008).
  4796*    -------------------------------
  4797     05  CPAYEEL PIC S9(0004) COMP.
  4798     05  CPAYEEF PIC  X(0001).
  4799     05  FILLER REDEFINES CPAYEEF.
  4800         10  CPAYEEA PIC  X(0001).
  4801     05  CPAYEEI PIC  X(0006).
  4802*    -------------------------------
  4803     05  CRFNDSWL PIC S9(0004) COMP.
  4804     05  CRFNDSWF PIC  X(0001).
  4805     05  FILLER REDEFINES CRFNDSWF.
  4806         10  CRFNDSWA PIC  X(0001).
  4807     05  CRFNDSWI PIC  X(0003).
  4808*    -------------------------------
  4809     05  CLFHDGL PIC S9(0004) COMP.
  4810     05  CLFHDGF PIC  X(0001).
  4811     05  FILLER REDEFINES CLFHDGF.
  4812         10  CLFHDGA PIC  X(0001).
  4813     05  CLFHDGI PIC  X(0006).
  4814*    -------------------------------
  4815     05  CAHHDGL PIC S9(0004) COMP.
  4816     05  CAHHDGF PIC  X(0001).
  4817     05  FILLER REDEFINES CAHHDGF.
  4818         10  CAHHDGA PIC  X(0001).
  4819     05  CAHHDGI PIC  X(0006).
  4820*    -------------------------------
  4821     05  CENTDTL PIC S9(0004) COMP.
  4822     05  CENTDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  91
* EL6311.cbl
  4823     05  FILLER REDEFINES CENTDTF.
  4824         10  CENTDTA PIC  X(0001).
  4825     05  CENTDTI PIC  X(0008).
  4826*    -------------------------------
  4827     05  CENTBYL PIC S9(0004) COMP.
  4828     05  CENTBYF PIC  X(0001).
  4829     05  FILLER REDEFINES CENTBYF.
  4830         10  CENTBYA PIC  X(0001).
  4831     05  CENTBYI PIC  X(0004).
  4832*    -------------------------------
  4833     05  CCHGCNTL PIC S9(0004) COMP.
  4834     05  CCHGCNTF PIC  X(0001).
  4835     05  FILLER REDEFINES CCHGCNTF.
  4836         10  CCHGCNTA PIC  X(0001).
  4837     05  CCHGCNTI PIC  X(0003).
  4838*    -------------------------------
  4839     05  CLFREFNL PIC S9(0004) COMP.
  4840     05  CLFREFNF PIC  X(0001).
  4841     05  FILLER REDEFINES CLFREFNF.
  4842         10  CLFREFNA PIC  X(0001).
  4843     05  CLFREFNI PIC  X(0006).
  4844*    -------------------------------
  4845     05  CAHREFNL PIC S9(0004) COMP.
  4846     05  CAHREFNF PIC  X(0001).
  4847     05  FILLER REDEFINES CAHREFNF.
  4848         10  CAHREFNA PIC  X(0001).
  4849     05  CAHREFNI PIC  X(0006).
  4850*    -------------------------------
  4851     05  CREINCDL PIC S9(0004) COMP.
  4852     05  CREINCDF PIC  X(0001).
  4853     05  FILLER REDEFINES CREINCDF.
  4854         10  CREINCDA PIC  X(0001).
  4855     05  CREINCDI PIC  X(0003).
  4856*    -------------------------------
  4857     05  CAEFFDTL PIC S9(0004) COMP.
  4858     05  CAEFFDTF PIC  X(0001).
  4859     05  FILLER REDEFINES CAEFFDTF.
  4860         10  CAEFFDTA PIC  X(0001).
  4861     05  CAEFFDTI PIC  X(0008).
  4862*    -------------------------------
  4863     05  CAEXPDTL PIC S9(0004) COMP.
  4864     05  CAEXPDTF PIC  X(0001).
  4865     05  FILLER REDEFINES CAEXPDTF.
  4866         10  CAEXPDTA PIC  X(0001).
  4867     05  CAEXPDTI PIC  X(0008).
  4868*    -------------------------------
  4869     05  COMMLFL PIC S9(0004) COMP.
  4870     05  COMMLFF PIC  X(0001).
  4871     05  FILLER REDEFINES COMMLFF.
  4872         10  COMMLFA PIC  X(0001).
  4873     05  COMMLFI PIC  X(0006).
  4874*    -------------------------------
  4875     05  COMMAHL PIC S9(0004) COMP.
  4876     05  COMMAHF PIC  X(0001).
  4877     05  FILLER REDEFINES COMMAHF.
  4878         10  COMMAHA PIC  X(0001).
  4879     05  COMMAHI PIC  X(0006).
  4880*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  92
* EL6311.cbl
  4881     05  CERMSG1L PIC S9(0004) COMP.
  4882     05  CERMSG1F PIC  X(0001).
  4883     05  FILLER REDEFINES CERMSG1F.
  4884         10  CERMSG1A PIC  X(0001).
  4885     05  CERMSG1I PIC  X(0078).
  4886*    -------------------------------
  4887     05  CERMSG2L PIC S9(0004) COMP.
  4888     05  CERMSG2F PIC  X(0001).
  4889     05  FILLER REDEFINES CERMSG2F.
  4890         10  CERMSG2A PIC  X(0001).
  4891     05  CERMSG2I PIC  X(0078).
  4892*    -------------------------------
  4893     05  CERMSG3L PIC S9(0004) COMP.
  4894     05  CERMSG3F PIC  X(0001).
  4895     05  FILLER REDEFINES CERMSG3F.
  4896         10  CERMSG3A PIC  X(0001).
  4897     05  CERMSG3I PIC  X(0078).
  4898*    -------------------------------
  4899     05  CPFENTRL PIC S9(0004) COMP.
  4900     05  CPFENTRF PIC  X(0001).
  4901     05  FILLER REDEFINES CPFENTRF.
  4902         10  CPFENTRA PIC  X(0001).
  4903     05  CPFENTRI PIC  9(2).
  4904*    -------------------------------
  4905     05  CPF5HDRL PIC S9(0004) COMP.
  4906     05  CPF5HDRF PIC  X(0001).
  4907     05  FILLER REDEFINES CPF5HDRF.
  4908         10  CPF5HDRA PIC  X(0001).
  4909     05  CPF5HDRI PIC  X(0005).
  4910*    -------------------------------
  4911     05  CPF4HDRL PIC S9(0004) COMP.
  4912     05  CPF4HDRF PIC  X(0001).
  4913     05  FILLER REDEFINES CPF4HDRF.
  4914         10  CPF4HDRA PIC  X(0001).
  4915     05  CPF4HDRI PIC  X(0013).
  4916*    -------------------------------
  4917     05  CF15HDRL PIC S9(0004) COMP.
  4918     05  CF15HDRF PIC  X(0001).
  4919     05  FILLER REDEFINES CF15HDRF.
  4920         10  CF15HDRA PIC  X(0001).
  4921     05  CF15HDRI PIC  X(0022).
  4922 01  EL631CO REDEFINES EL631BI.
  4923     05  FILLER            PIC  X(0012).
  4924*    -------------------------------
  4925     05  FILLER            PIC  X(0003).
  4926     05  CDATEO PIC  X(0008).
  4927*    -------------------------------
  4928     05  FILLER            PIC  X(0003).
  4929     05  CTIMEO PIC  99.99.
  4930*    -------------------------------
  4931     05  FILLER            PIC  X(0003).
  4932     05  CHEADO PIC  X(0038).
  4933*    -------------------------------
  4934     05  FILLER            PIC  X(0003).
  4935     05  CCHGTO PIC  X(0004).
  4936*    -------------------------------
  4937     05  FILLER            PIC  X(0003).
  4938     05  CCHGO PIC  ZZZ9.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  93
* EL6311.cbl
  4939*    -------------------------------
  4940     05  FILLER            PIC  X(0003).
  4941     05  CMAINTO PIC  X(0001).
  4942*    -------------------------------
  4943     05  FILLER            PIC  X(0003).
  4944     05  CMANTBYO PIC  X(0004).
  4945*    -------------------------------
  4946     05  FILLER            PIC  X(0003).
  4947     05  CCHGHDGO PIC  X(0003).
  4948*    -------------------------------
  4949     05  FILLER            PIC  X(0003).
  4950     05  CMANTDTO PIC  X(0008).
  4951*    -------------------------------
  4952     05  FILLER            PIC  X(0003).
  4953     05  CMANTATO PIC  99.99.
  4954*    -------------------------------
  4955     05  FILLER            PIC  X(0003).
  4956     05  CCSRO PIC  X(0004).
  4957*    -------------------------------
  4958     05  FILLER            PIC  X(0003).
  4959     05  CBATCHO PIC  X(0006).
  4960*    -------------------------------
  4961     05  FILLER            PIC  X(0003).
  4962     05  CSEQO PIC  X(0004).
  4963*    -------------------------------
  4964     05  FILLER            PIC  X(0003).
  4965     05  CMOENDTO PIC  X(0008).
  4966*    -------------------------------
  4967     05  FILLER            PIC  X(0003).
  4968     05  CCARRO PIC  X(0001).
  4969*    -------------------------------
  4970     05  FILLER            PIC  X(0003).
  4971     05  CGROUPO PIC  X(0006).
  4972*    -------------------------------
  4973     05  FILLER            PIC  X(0003).
  4974     05  CSTATEO PIC  X(0002).
  4975*    -------------------------------
  4976     05  FILLER            PIC  X(0003).
  4977     05  CACCTO PIC  X(0010).
  4978*    -------------------------------
  4979     05  FILLER            PIC  X(0003).
  4980     05  CORIGHDO PIC  X(0011).
  4981*    -------------------------------
  4982     05  FILLER            PIC  X(0003).
  4983     05  CORGNOO PIC  X(0006).
  4984*    -------------------------------
  4985     05  FILLER            PIC  X(0003).
  4986     05  CORGSEQO PIC  X(0004).
  4987*    -------------------------------
  4988     05  FILLER            PIC  X(0003).
  4989     05  CREFHDGO PIC  X(0010).
  4990*    -------------------------------
  4991     05  FILLER            PIC  X(0003).
  4992     05  CREFO PIC  X(0012).
  4993*    -------------------------------
  4994     05  FILLER            PIC  X(0003).
  4995     05  CNHINTO PIC  ZZZZZ9.99.
  4996*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  94
* EL6311.cbl
  4997     05  FILLER            PIC  X(0003).
  4998     05  CCERTNOO PIC  X(0010).
  4999*    -------------------------------
  5000     05  FILLER            PIC  X(0003).
  5001     05  CSUFIXO PIC  X(0001).
  5002*    -------------------------------
  5003     05  FILLER            PIC  X(0003).
  5004     05  CEFFDTO PIC  X(0008).
  5005*    -------------------------------
  5006     05  FILLER            PIC  X(0003).
  5007     05  CLSTNMO PIC  X(0015).
  5008*    -------------------------------
  5009     05  FILLER            PIC  X(0003).
  5010     05  CPCYNO PIC  X(0001).
  5011*    -------------------------------
  5012     05  FILLER            PIC  X(0003).
  5013     05  CINAMEO PIC  X(0015).
  5014*    -------------------------------
  5015     05  FILLER            PIC  X(0003).
  5016     05  CINITSO PIC  X(0010).
  5017*    -------------------------------
  5018     05  FILLER            PIC  X(0003).
  5019     05  CCANREAO PIC  X(0001).
  5020*    -------------------------------
  5021     05  FILLER            PIC  X(0003).
  5022     05  ACTSPCO PIC  X(0001).
  5023*    -------------------------------
  5024     05  FILLER            PIC  X(0003).
  5025     05  CKIND1O PIC  X(0002).
  5026*    -------------------------------
  5027     05  FILLER            PIC  X(0003).
  5028     05  CCANDT1O PIC  X(0008).
  5029*    -------------------------------
  5030     05  FILLER            PIC  X(0003).
  5031     05  CREFND1O PIC  Z(7).99-.
  5032*    -------------------------------
  5033     05  FILLER            PIC  X(0003).
  5034     05  CMTHD1O PIC  X(0001).
  5035*    -------------------------------
  5036     05  FILLER            PIC  X(0003).
  5037     05  CKIND2O PIC  X(0002).
  5038*    -------------------------------
  5039     05  FILLER            PIC  X(0003).
  5040     05  CCANDT2O PIC  X(0008).
  5041*    -------------------------------
  5042     05  FILLER            PIC  X(0003).
  5043     05  CREFND2O PIC  Z(7).99-.
  5044*    -------------------------------
  5045     05  FILLER            PIC  X(0003).
  5046     05  CMTHD2O PIC  X(0001).
  5047*    -------------------------------
  5048     05  FILLER            PIC  X(0003).
  5049     05  CLIVESO PIC  X(0003).
  5050*    -------------------------------
  5051     05  FILLER            PIC  X(0003).
  5052     05  CFORCEO PIC  X(0001).
  5053*    -------------------------------
  5054     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  95
* EL6311.cbl
  5055     05  CBILCDO PIC  X(0001).
  5056*    -------------------------------
  5057     05  FILLER            PIC  X(0003).
  5058     05  CCRFND1O PIC  Z(7).99-.
  5059*    -------------------------------
  5060     05  FILLER            PIC  X(0003).
  5061     05  CCRFND2O PIC  Z(7).99-.
  5062*    -------------------------------
  5063     05  FILLER            PIC  X(0003).
  5064     05  CBILIT1O PIC  X(0008).
  5065*    -------------------------------
  5066     05  FILLER            PIC  X(0003).
  5067     05  CDRFND1O PIC  Z(7).99-.
  5068*    -------------------------------
  5069     05  FILLER            PIC  X(0003).
  5070     05  CBILIT2O PIC  X(0008).
  5071*    -------------------------------
  5072     05  FILLER            PIC  X(0003).
  5073     05  CDRFND2O PIC  Z(7).99-.
  5074*    -------------------------------
  5075     05  FILLER            PIC  X(0003).
  5076     05  CCANTXTO PIC  X(0005).
  5077*    -------------------------------
  5078     05  FILLER            PIC  X(0003).
  5079     05  CCANFEEO PIC  Z9.
  5080*    -------------------------------
  5081     05  FILLER            PIC  X(0003).
  5082     05  CTERM1O PIC  ZZ9.
  5083*    -------------------------------
  5084     05  FILLER            PIC  X(0003).
  5085     05  CRTERM1O PIC  ZZ9.
  5086*    -------------------------------
  5087     05  FILLER            PIC  X(0003).
  5088     05  CPREM1O PIC  ZZZZZZ9.99-.
  5089*    -------------------------------
  5090     05  FILLER            PIC  X(0003).
  5091     05  CTERM2O PIC  ZZ9.
  5092*    -------------------------------
  5093     05  FILLER            PIC  X(0003).
  5094     05  CRTERM2O PIC  ZZ9.
  5095*    -------------------------------
  5096     05  FILLER            PIC  X(0003).
  5097     05  CPREM2O PIC  ZZZZZZ9.99-.
  5098*    -------------------------------
  5099     05  FILLER            PIC  X(0003).
  5100     05  CENTRDTO PIC  X(0008).
  5101*    -------------------------------
  5102     05  FILLER            PIC  X(0003).
  5103     05  CPAYEEO PIC  X(0006).
  5104*    -------------------------------
  5105     05  FILLER            PIC  X(0003).
  5106     05  CRFNDSWO PIC  X(0003).
  5107*    -------------------------------
  5108     05  FILLER            PIC  X(0003).
  5109     05  CLFHDGO PIC  X(0006).
  5110*    -------------------------------
  5111     05  FILLER            PIC  X(0003).
  5112     05  CAHHDGO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  96
* EL6311.cbl
  5113*    -------------------------------
  5114     05  FILLER            PIC  X(0003).
  5115     05  CENTDTO PIC  X(0008).
  5116*    -------------------------------
  5117     05  FILLER            PIC  X(0003).
  5118     05  CENTBYO PIC  X(0004).
  5119*    -------------------------------
  5120     05  FILLER            PIC  X(0003).
  5121     05  CCHGCNTO PIC  X(0003).
  5122*    -------------------------------
  5123     05  FILLER            PIC  X(0003).
  5124     05  CLFREFNO PIC  X(0006).
  5125*    -------------------------------
  5126     05  FILLER            PIC  X(0003).
  5127     05  CAHREFNO PIC  X(0006).
  5128*    -------------------------------
  5129     05  FILLER            PIC  X(0003).
  5130     05  CREINCDO PIC  X(0003).
  5131*    -------------------------------
  5132     05  FILLER            PIC  X(0003).
  5133     05  CAEFFDTO PIC  X(0008).
  5134*    -------------------------------
  5135     05  FILLER            PIC  X(0003).
  5136     05  CAEXPDTO PIC  X(0008).
  5137*    -------------------------------
  5138     05  FILLER            PIC  X(0003).
  5139     05  COMMLFO PIC  .99999.
  5140*    -------------------------------
  5141     05  FILLER            PIC  X(0003).
  5142     05  COMMAHO PIC  .99999.
  5143*    -------------------------------
  5144     05  FILLER            PIC  X(0003).
  5145     05  CERMSG1O PIC  X(0078).
  5146*    -------------------------------
  5147     05  FILLER            PIC  X(0003).
  5148     05  CERMSG2O PIC  X(0078).
  5149*    -------------------------------
  5150     05  FILLER            PIC  X(0003).
  5151     05  CERMSG3O PIC  X(0078).
  5152*    -------------------------------
  5153     05  FILLER            PIC  X(0003).
  5154     05  CPFENTRO PIC  X(0002).
  5155*    -------------------------------
  5156     05  FILLER            PIC  X(0003).
  5157     05  CPF5HDRO PIC  X(0005).
  5158*    -------------------------------
  5159     05  FILLER            PIC  X(0003).
  5160     05  CPF4HDRO PIC  X(0013).
  5161*    -------------------------------
  5162     05  FILLER            PIC  X(0003).
  5163     05  CF15HDRO PIC  X(0022).
  5164*    -------------------------------
  5165 01  EL631DI REDEFINES EL631BI.
  5166     05  FILLER            PIC  X(0012).
  5167*    -------------------------------
  5168     05  DDATEL PIC S9(0004) COMP.
  5169     05  DDATEF PIC  X(0001).
  5170     05  FILLER REDEFINES DDATEF.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  97
* EL6311.cbl
  5171         10  DDATEA PIC  X(0001).
  5172     05  DDATEI PIC  X(0008).
  5173*    -------------------------------
  5174     05  DTIMEL PIC S9(0004) COMP.
  5175     05  DTIMEF PIC  X(0001).
  5176     05  FILLER REDEFINES DTIMEF.
  5177         10  DTIMEA PIC  X(0001).
  5178     05  DTIMEI PIC  X(0005).
  5179*    -------------------------------
  5180     05  DHEADL PIC S9(0004) COMP.
  5181     05  DHEADF PIC  X(0001).
  5182     05  FILLER REDEFINES DHEADF.
  5183         10  DHEADA PIC  X(0001).
  5184     05  DHEADI PIC  X(0038).
  5185*    -------------------------------
  5186     05  DLDATEL PIC S9(0004) COMP.
  5187     05  DLDATEF PIC  X(0001).
  5188     05  FILLER REDEFINES DLDATEF.
  5189         10  DLDATEA PIC  X(0001).
  5190     05  DLDATEI PIC  X(0010).
  5191*    -------------------------------
  5192     05  DBATCHL PIC S9(0004) COMP.
  5193     05  DBATCHF PIC  X(0001).
  5194     05  FILLER REDEFINES DBATCHF.
  5195         10  DBATCHA PIC  X(0001).
  5196     05  DBATCHI PIC  X(0011).
  5197*    -------------------------------
  5198     05  DACCTNML PIC S9(0004) COMP.
  5199     05  DACCTNMF PIC  X(0001).
  5200     05  FILLER REDEFINES DACCTNMF.
  5201         10  DACCTNMA PIC  X(0001).
  5202     05  DACCTNMI PIC  X(0030).
  5203*    -------------------------------
  5204     05  DPROCDTL PIC S9(0004) COMP.
  5205     05  DPROCDTF PIC  X(0001).
  5206     05  FILLER REDEFINES DPROCDTF.
  5207         10  DPROCDTA PIC  X(0001).
  5208     05  DPROCDTI PIC  X(0008).
  5209*    -------------------------------
  5210     05  DINPUTL PIC S9(0004) COMP.
  5211     05  DINPUTF PIC  X(0001).
  5212     05  FILLER REDEFINES DINPUTF.
  5213         10  DINPUTA PIC  X(0001).
  5214     05  DINPUTI PIC  X(0008).
  5215*    -------------------------------
  5216     05  DMAINDTL PIC S9(0004) COMP.
  5217     05  DMAINDTF PIC  X(0001).
  5218     05  FILLER REDEFINES DMAINDTF.
  5219         10  DMAINDTA PIC  X(0001).
  5220     05  DMAINDTI PIC  X(0008).
  5221*    -------------------------------
  5222     05  DCARRL PIC S9(0004) COMP.
  5223     05  DCARRF PIC  X(0001).
  5224     05  FILLER REDEFINES DCARRF.
  5225         10  DCARRA PIC  X(0001).
  5226     05  DCARRI PIC  X(0001).
  5227*    -------------------------------
  5228     05  DGROUPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  98
* EL6311.cbl
  5229     05  DGROUPF PIC  X(0001).
  5230     05  FILLER REDEFINES DGROUPF.
  5231         10  DGROUPA PIC  X(0001).
  5232     05  DGROUPI PIC  X(0006).
  5233*    -------------------------------
  5234     05  DSTATEL PIC S9(0004) COMP.
  5235     05  DSTATEF PIC  X(0001).
  5236     05  FILLER REDEFINES DSTATEF.
  5237         10  DSTATEA PIC  X(0001).
  5238     05  DSTATEI PIC  X(0002).
  5239*    -------------------------------
  5240     05  DACCTL PIC S9(0004) COMP.
  5241     05  DACCTF PIC  X(0001).
  5242     05  FILLER REDEFINES DACCTF.
  5243         10  DACCTA PIC  X(0001).
  5244     05  DACCTI PIC  X(0010).
  5245*    -------------------------------
  5246     05  DRECVDTL PIC S9(0004) COMP.
  5247     05  DRECVDTF PIC  X(0001).
  5248     05  FILLER REDEFINES DRECVDTF.
  5249         10  DRECVDTA PIC  X(0001).
  5250     05  DRECVDTI PIC  X(0008).
  5251*    -------------------------------
  5252     05  DCSRL PIC S9(0004) COMP.
  5253     05  DCSRF PIC  X(0001).
  5254     05  FILLER REDEFINES DCSRF.
  5255         10  DCSRA PIC  X(0001).
  5256     05  DCSRI PIC  X(0004).
  5257*    -------------------------------
  5258     05  DREFHDGL PIC S9(0004) COMP.
  5259     05  DREFHDGF PIC  X(0001).
  5260     05  FILLER REDEFINES DREFHDGF.
  5261         10  DREFHDGA PIC  X(0001).
  5262     05  DREFHDGI PIC  X(0010).
  5263*    -------------------------------
  5264     05  DREFL PIC S9(0004) COMP.
  5265     05  DREFF PIC  X(0001).
  5266     05  FILLER REDEFINES DREFF.
  5267         10  DREFA PIC  X(0001).
  5268     05  DREFI PIC  X(0012).
  5269*    -------------------------------
  5270     05  DLFPHDGL PIC S9(0004) COMP.
  5271     05  DLFPHDGF PIC  X(0001).
  5272     05  FILLER REDEFINES DLFPHDGF.
  5273         10  DLFPHDGA PIC  X(0001).
  5274     05  DLFPHDGI PIC  X(0010).
  5275*    -------------------------------
  5276     05  DAHPHDGL PIC S9(0004) COMP.
  5277     05  DAHPHDGF PIC  X(0001).
  5278     05  FILLER REDEFINES DAHPHDGF.
  5279         10  DAHPHDGA PIC  X(0001).
  5280     05  DAHPHDGI PIC  X(0010).
  5281*    -------------------------------
  5282     05  DLFRHDGL PIC S9(0004) COMP.
  5283     05  DLFRHDGF PIC  X(0001).
  5284     05  FILLER REDEFINES DLFRHDGF.
  5285         10  DLFRHDGA PIC  X(0001).
  5286     05  DLFRHDGI PIC  X(0009).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page  99
* EL6311.cbl
  5287*    -------------------------------
  5288     05  DAHRHDGL PIC S9(0004) COMP.
  5289     05  DAHRHDGF PIC  X(0001).
  5290     05  FILLER REDEFINES DAHRHDGF.
  5291         10  DAHRHDGA PIC  X(0001).
  5292     05  DAHRHDGI PIC  X(0009).
  5293*    -------------------------------
  5294     05  DRISSL PIC S9(0004) COMP.
  5295     05  DRISSF PIC  X(0001).
  5296     05  FILLER REDEFINES DRISSF.
  5297         10  DRISSA PIC  X(0001).
  5298     05  DRISSI PIC  X(0005).
  5299*    -------------------------------
  5300     05  DRLFPRML PIC S9(0004) COMP.
  5301     05  DRLFPRMF PIC  X(0001).
  5302     05  FILLER REDEFINES DRLFPRMF.
  5303         10  DRLFPRMA PIC  X(0001).
  5304     05  DRLFPRMI PIC  S9(9)V99.
  5305*    -------------------------------
  5306     05  DRAHPRML PIC S9(0004) COMP.
  5307     05  DRAHPRMF PIC  X(0001).
  5308     05  FILLER REDEFINES DRAHPRMF.
  5309         10  DRAHPRMA PIC  X(0001).
  5310     05  DRAHPRMI PIC  S9(9)V99.
  5311*    -------------------------------
  5312     05  DRCANCL PIC S9(0004) COMP.
  5313     05  DRCANCF PIC  X(0001).
  5314     05  FILLER REDEFINES DRCANCF.
  5315         10  DRCANCA PIC  X(0001).
  5316     05  DRCANCI PIC  X(0005).
  5317*    -------------------------------
  5318     05  DRLFRFDL PIC S9(0004) COMP.
  5319     05  DRLFRFDF PIC  X(0001).
  5320     05  FILLER REDEFINES DRLFRFDF.
  5321         10  DRLFRFDA PIC  X(0001).
  5322     05  DRLFRFDI PIC  S9(9)V99.
  5323*    -------------------------------
  5324     05  DRAHRFDL PIC S9(0004) COMP.
  5325     05  DRAHRFDF PIC  X(0001).
  5326     05  FILLER REDEFINES DRAHRFDF.
  5327         10  DRAHRFDA PIC  X(0001).
  5328     05  DRAHRFDI PIC  S9(9)V99.
  5329*    -------------------------------
  5330     05  DEISSL PIC S9(0004) COMP.
  5331     05  DEISSF PIC  X(0001).
  5332     05  FILLER REDEFINES DEISSF.
  5333         10  DEISSA PIC  X(0001).
  5334     05  DEISSI PIC  X(0005).
  5335*    -------------------------------
  5336     05  DELFPRML PIC S9(0004) COMP.
  5337     05  DELFPRMF PIC  X(0001).
  5338     05  FILLER REDEFINES DELFPRMF.
  5339         10  DELFPRMA PIC  X(0001).
  5340     05  DELFPRMI PIC  X(0011).
  5341*    -------------------------------
  5342     05  DEAHPRML PIC S9(0004) COMP.
  5343     05  DEAHPRMF PIC  X(0001).
  5344     05  FILLER REDEFINES DEAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 100
* EL6311.cbl
  5345         10  DEAHPRMA PIC  X(0001).
  5346     05  DEAHPRMI PIC  X(0011).
  5347*    -------------------------------
  5348     05  DECANCL PIC S9(0004) COMP.
  5349     05  DECANCF PIC  X(0001).
  5350     05  FILLER REDEFINES DECANCF.
  5351         10  DECANCA PIC  X(0001).
  5352     05  DECANCI PIC  X(0005).
  5353*    -------------------------------
  5354     05  DELFRFDL PIC S9(0004) COMP.
  5355     05  DELFRFDF PIC  X(0001).
  5356     05  FILLER REDEFINES DELFRFDF.
  5357         10  DELFRFDA PIC  X(0001).
  5358     05  DELFRFDI PIC  X(0011).
  5359*    -------------------------------
  5360     05  DEAHRFDL PIC S9(0004) COMP.
  5361     05  DEAHRFDF PIC  X(0001).
  5362     05  FILLER REDEFINES DEAHRFDF.
  5363         10  DEAHRFDA PIC  X(0001).
  5364     05  DEAHRFDI PIC  X(0011).
  5365*    -------------------------------
  5366     05  DCISSL PIC S9(0004) COMP.
  5367     05  DCISSF PIC  X(0001).
  5368     05  FILLER REDEFINES DCISSF.
  5369         10  DCISSA PIC  X(0001).
  5370     05  DCISSI PIC  X(0005).
  5371*    -------------------------------
  5372     05  DCLFPRML PIC S9(0004) COMP.
  5373     05  DCLFPRMF PIC  X(0001).
  5374     05  FILLER REDEFINES DCLFPRMF.
  5375         10  DCLFPRMA PIC  X(0001).
  5376     05  DCLFPRMI PIC  X(0011).
  5377*    -------------------------------
  5378     05  DCAHPRML PIC S9(0004) COMP.
  5379     05  DCAHPRMF PIC  X(0001).
  5380     05  FILLER REDEFINES DCAHPRMF.
  5381         10  DCAHPRMA PIC  X(0001).
  5382     05  DCAHPRMI PIC  X(0011).
  5383*    -------------------------------
  5384     05  DCCANCL PIC S9(0004) COMP.
  5385     05  DCCANCF PIC  X(0001).
  5386     05  FILLER REDEFINES DCCANCF.
  5387         10  DCCANCA PIC  X(0001).
  5388     05  DCCANCI PIC  X(0005).
  5389*    -------------------------------
  5390     05  DCLFRFDL PIC S9(0004) COMP.
  5391     05  DCLFRFDF PIC  X(0001).
  5392     05  FILLER REDEFINES DCLFRFDF.
  5393         10  DCLFRFDA PIC  X(0001).
  5394     05  DCLFRFDI PIC  X(0011).
  5395*    -------------------------------
  5396     05  DCAHRFDL PIC S9(0004) COMP.
  5397     05  DCAHRFDF PIC  X(0001).
  5398     05  FILLER REDEFINES DCAHRFDF.
  5399         10  DCAHRFDA PIC  X(0001).
  5400     05  DCAHRFDI PIC  X(0011).
  5401*    -------------------------------
  5402     05  DOISSL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 101
* EL6311.cbl
  5403     05  DOISSF PIC  X(0001).
  5404     05  FILLER REDEFINES DOISSF.
  5405         10  DOISSA PIC  X(0001).
  5406     05  DOISSI PIC  X(0005).
  5407*    -------------------------------
  5408     05  DOLFPRML PIC S9(0004) COMP.
  5409     05  DOLFPRMF PIC  X(0001).
  5410     05  FILLER REDEFINES DOLFPRMF.
  5411         10  DOLFPRMA PIC  X(0001).
  5412     05  DOLFPRMI PIC  X(0011).
  5413*    -------------------------------
  5414     05  DOAHPRML PIC S9(0004) COMP.
  5415     05  DOAHPRMF PIC  X(0001).
  5416     05  FILLER REDEFINES DOAHPRMF.
  5417         10  DOAHPRMA PIC  X(0001).
  5418     05  DOAHPRMI PIC  X(0011).
  5419*    -------------------------------
  5420     05  DOCANCL PIC S9(0004) COMP.
  5421     05  DOCANCF PIC  X(0001).
  5422     05  FILLER REDEFINES DOCANCF.
  5423         10  DOCANCA PIC  X(0001).
  5424     05  DOCANCI PIC  X(0005).
  5425*    -------------------------------
  5426     05  DOLFRFDL PIC S9(0004) COMP.
  5427     05  DOLFRFDF PIC  X(0001).
  5428     05  FILLER REDEFINES DOLFRFDF.
  5429         10  DOLFRFDA PIC  X(0001).
  5430     05  DOLFRFDI PIC  X(0011).
  5431*    -------------------------------
  5432     05  DOAHRFDL PIC S9(0004) COMP.
  5433     05  DOAHRFDF PIC  X(0001).
  5434     05  FILLER REDEFINES DOAHRFDF.
  5435         10  DOAHRFDA PIC  X(0001).
  5436     05  DOAHRFDI PIC  X(0011).
  5437*    -------------------------------
  5438     05  DITOTALL PIC S9(0004) COMP.
  5439     05  DITOTALF PIC  X(0001).
  5440     05  FILLER REDEFINES DITOTALF.
  5441         10  DITOTALA PIC  X(0001).
  5442     05  DITOTALI PIC  X(0005).
  5443*    -------------------------------
  5444     05  DIFATALL PIC S9(0004) COMP.
  5445     05  DIFATALF PIC  X(0001).
  5446     05  FILLER REDEFINES DIFATALF.
  5447         10  DIFATALA PIC  X(0001).
  5448     05  DIFATALI PIC  X(0005).
  5449*    -------------------------------
  5450     05  DIFORCEL PIC S9(0004) COMP.
  5451     05  DIFORCEF PIC  X(0001).
  5452     05  FILLER REDEFINES DIFORCEF.
  5453         10  DIFORCEA PIC  X(0001).
  5454     05  DIFORCEI PIC  X(0005).
  5455*    -------------------------------
  5456     05  DIHOLDL PIC S9(0004) COMP.
  5457     05  DIHOLDF PIC  X(0001).
  5458     05  FILLER REDEFINES DIHOLDF.
  5459         10  DIHOLDA PIC  X(0001).
  5460     05  DIHOLDI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 102
* EL6311.cbl
  5461*    -------------------------------
  5462     05  DIAVAILL PIC S9(0004) COMP.
  5463     05  DIAVAILF PIC  X(0001).
  5464     05  FILLER REDEFINES DIAVAILF.
  5465         10  DIAVAILA PIC  X(0001).
  5466     05  DIAVAILI PIC  X(0005).
  5467*    -------------------------------
  5468     05  DIGPREML PIC S9(0004) COMP.
  5469     05  DIGPREMF PIC  X(0001).
  5470     05  FILLER REDEFINES DIGPREMF.
  5471         10  DIGPREMA PIC  X(0001).
  5472     05  DIGPREMI PIC  X(0011).
  5473*    -------------------------------
  5474     05  DIBPREML PIC S9(0004) COMP.
  5475     05  DIBPREMF PIC  X(0001).
  5476     05  FILLER REDEFINES DIBPREMF.
  5477         10  DIBPREMA PIC  X(0001).
  5478     05  DIBPREMI PIC  X(0011).
  5479*    -------------------------------
  5480     05  DCTOTALL PIC S9(0004) COMP.
  5481     05  DCTOTALF PIC  X(0001).
  5482     05  FILLER REDEFINES DCTOTALF.
  5483         10  DCTOTALA PIC  X(0001).
  5484     05  DCTOTALI PIC  X(0005).
  5485*    -------------------------------
  5486     05  DCFATALL PIC S9(0004) COMP.
  5487     05  DCFATALF PIC  X(0001).
  5488     05  FILLER REDEFINES DCFATALF.
  5489         10  DCFATALA PIC  X(0001).
  5490     05  DCFATALI PIC  X(0005).
  5491*    -------------------------------
  5492     05  DCFORCEL PIC S9(0004) COMP.
  5493     05  DCFORCEF PIC  X(0001).
  5494     05  FILLER REDEFINES DCFORCEF.
  5495         10  DCFORCEA PIC  X(0001).
  5496     05  DCFORCEI PIC  X(0005).
  5497*    -------------------------------
  5498     05  DCHOLDL PIC S9(0004) COMP.
  5499     05  DCHOLDF PIC  X(0001).
  5500     05  FILLER REDEFINES DCHOLDF.
  5501         10  DCHOLDA PIC  X(0001).
  5502     05  DCHOLDI PIC  X(0005).
  5503*    -------------------------------
  5504     05  DCAVAILL PIC S9(0004) COMP.
  5505     05  DCAVAILF PIC  X(0001).
  5506     05  FILLER REDEFINES DCAVAILF.
  5507         10  DCAVAILA PIC  X(0001).
  5508     05  DCAVAILI PIC  X(0005).
  5509*    -------------------------------
  5510     05  DCGPREML PIC S9(0004) COMP.
  5511     05  DCGPREMF PIC  X(0001).
  5512     05  FILLER REDEFINES DCGPREMF.
  5513         10  DCGPREMA PIC  X(0001).
  5514     05  DCGPREMI PIC  X(0011).
  5515*    -------------------------------
  5516     05  DCBPREML PIC S9(0004) COMP.
  5517     05  DCBPREMF PIC  X(0001).
  5518     05  FILLER REDEFINES DCBPREMF.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 103
* EL6311.cbl
  5519         10  DCBPREMA PIC  X(0001).
  5520     05  DCBPREMI PIC  X(0011).
  5521*    -------------------------------
  5522     05  DNTOTALL PIC S9(0004) COMP.
  5523     05  DNTOTALF PIC  X(0001).
  5524     05  FILLER REDEFINES DNTOTALF.
  5525         10  DNTOTALA PIC  X(0001).
  5526     05  DNTOTALI PIC  X(0005).
  5527*    -------------------------------
  5528     05  DNFATALL PIC S9(0004) COMP.
  5529     05  DNFATALF PIC  X(0001).
  5530     05  FILLER REDEFINES DNFATALF.
  5531         10  DNFATALA PIC  X(0001).
  5532     05  DNFATALI PIC  X(0005).
  5533*    -------------------------------
  5534     05  DNFORCEL PIC S9(0004) COMP.
  5535     05  DNFORCEF PIC  X(0001).
  5536     05  FILLER REDEFINES DNFORCEF.
  5537         10  DNFORCEA PIC  X(0001).
  5538     05  DNFORCEI PIC  X(0005).
  5539*    -------------------------------
  5540     05  DNHOLDL PIC S9(0004) COMP.
  5541     05  DNHOLDF PIC  X(0001).
  5542     05  FILLER REDEFINES DNHOLDF.
  5543         10  DNHOLDA PIC  X(0001).
  5544     05  DNHOLDI PIC  X(0005).
  5545*    -------------------------------
  5546     05  DNAVAILL PIC S9(0004) COMP.
  5547     05  DNAVAILF PIC  X(0001).
  5548     05  FILLER REDEFINES DNAVAILF.
  5549         10  DNAVAILA PIC  X(0001).
  5550     05  DNAVAILI PIC  X(0005).
  5551*    -------------------------------
  5552     05  DNGPREML PIC S9(0004) COMP.
  5553     05  DNGPREMF PIC  X(0001).
  5554     05  FILLER REDEFINES DNGPREMF.
  5555         10  DNGPREMA PIC  X(0001).
  5556     05  DNGPREMI PIC  X(0011).
  5557*    -------------------------------
  5558     05  DNBPREML PIC S9(0004) COMP.
  5559     05  DNBPREMF PIC  X(0001).
  5560     05  FILLER REDEFINES DNBPREMF.
  5561         10  DNBPREMA PIC  X(0001).
  5562     05  DNBPREMI PIC  X(0011).
  5563*    -------------------------------
  5564     05  DERMSGL PIC S9(0004) COMP.
  5565     05  DERMSGF PIC  X(0001).
  5566     05  FILLER REDEFINES DERMSGF.
  5567         10  DERMSGA PIC  X(0001).
  5568     05  DERMSGI PIC  X(0075).
  5569*    -------------------------------
  5570     05  DPFENTRL PIC S9(0004) COMP.
  5571     05  DPFENTRF PIC  X(0001).
  5572     05  FILLER REDEFINES DPFENTRF.
  5573         10  DPFENTRA PIC  X(0001).
  5574     05  DPFENTRI PIC  9(2).
  5575 01  EL631DO REDEFINES EL631BI.
  5576     05  FILLER            PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 104
* EL6311.cbl
  5577*    -------------------------------
  5578     05  FILLER            PIC  X(0003).
  5579     05  DDATEO PIC  X(0008).
  5580*    -------------------------------
  5581     05  FILLER            PIC  X(0003).
  5582     05  DTIMEO PIC  99.99.
  5583*    -------------------------------
  5584     05  FILLER            PIC  X(0003).
  5585     05  DHEADO PIC  X(0038).
  5586*    -------------------------------
  5587     05  FILLER            PIC  X(0003).
  5588     05  DLDATEO PIC  X(0010).
  5589*    -------------------------------
  5590     05  FILLER            PIC  X(0003).
  5591     05  DBATCHO PIC  X(0011).
  5592*    -------------------------------
  5593     05  FILLER            PIC  X(0003).
  5594     05  DACCTNMO PIC  X(0030).
  5595*    -------------------------------
  5596     05  FILLER            PIC  X(0003).
  5597     05  DPROCDTO PIC  X(0008).
  5598*    -------------------------------
  5599     05  FILLER            PIC  X(0003).
  5600     05  DINPUTO PIC  X(0008).
  5601*    -------------------------------
  5602     05  FILLER            PIC  X(0003).
  5603     05  DMAINDTO PIC  X(0008).
  5604*    -------------------------------
  5605     05  FILLER            PIC  X(0003).
  5606     05  DCARRO PIC  X(0001).
  5607*    -------------------------------
  5608     05  FILLER            PIC  X(0003).
  5609     05  DGROUPO PIC  X(0006).
  5610*    -------------------------------
  5611     05  FILLER            PIC  X(0003).
  5612     05  DSTATEO PIC  X(0002).
  5613*    -------------------------------
  5614     05  FILLER            PIC  X(0003).
  5615     05  DACCTO PIC  X(0010).
  5616*    -------------------------------
  5617     05  FILLER            PIC  X(0003).
  5618     05  DRECVDTO PIC  X(0008).
  5619*    -------------------------------
  5620     05  FILLER            PIC  X(0003).
  5621     05  DCSRO PIC  X(0004).
  5622*    -------------------------------
  5623     05  FILLER            PIC  X(0003).
  5624     05  DREFHDGO PIC  X(0010).
  5625*    -------------------------------
  5626     05  FILLER            PIC  X(0003).
  5627     05  DREFO PIC  X(0012).
  5628*    -------------------------------
  5629     05  FILLER            PIC  X(0003).
  5630     05  DLFPHDGO PIC  X(0010).
  5631*    -------------------------------
  5632     05  FILLER            PIC  X(0003).
  5633     05  DAHPHDGO PIC  X(0010).
  5634*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 105
* EL6311.cbl
  5635     05  FILLER            PIC  X(0003).
  5636     05  DLFRHDGO PIC  X(0009).
  5637*    -------------------------------
  5638     05  FILLER            PIC  X(0003).
  5639     05  DAHRHDGO PIC  X(0009).
  5640*    -------------------------------
  5641     05  FILLER            PIC  X(0003).
  5642     05  DRISSO PIC  ZZ99-.
  5643*    -------------------------------
  5644     05  FILLER            PIC  X(0003).
  5645     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5646*    -------------------------------
  5647     05  FILLER            PIC  X(0003).
  5648     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5649*    -------------------------------
  5650     05  FILLER            PIC  X(0003).
  5651     05  DRCANCO PIC  ZZ99-.
  5652*    -------------------------------
  5653     05  FILLER            PIC  X(0003).
  5654     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5655*    -------------------------------
  5656     05  FILLER            PIC  X(0003).
  5657     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5658*    -------------------------------
  5659     05  FILLER            PIC  X(0003).
  5660     05  DEISSO PIC  ZZ99-.
  5661*    -------------------------------
  5662     05  FILLER            PIC  X(0003).
  5663     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5664*    -------------------------------
  5665     05  FILLER            PIC  X(0003).
  5666     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5667*    -------------------------------
  5668     05  FILLER            PIC  X(0003).
  5669     05  DECANCO PIC  ZZ99-.
  5670*    -------------------------------
  5671     05  FILLER            PIC  X(0003).
  5672     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5673*    -------------------------------
  5674     05  FILLER            PIC  X(0003).
  5675     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5676*    -------------------------------
  5677     05  FILLER            PIC  X(0003).
  5678     05  DCISSO PIC  ZZ99-.
  5679*    -------------------------------
  5680     05  FILLER            PIC  X(0003).
  5681     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5682*    -------------------------------
  5683     05  FILLER            PIC  X(0003).
  5684     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5685*    -------------------------------
  5686     05  FILLER            PIC  X(0003).
  5687     05  DCCANCO PIC  ZZ99-.
  5688*    -------------------------------
  5689     05  FILLER            PIC  X(0003).
  5690     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5691*    -------------------------------
  5692     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 106
* EL6311.cbl
  5693     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5694*    -------------------------------
  5695     05  FILLER            PIC  X(0003).
  5696     05  DOISSO PIC  ZZ99-.
  5697*    -------------------------------
  5698     05  FILLER            PIC  X(0003).
  5699     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5700*    -------------------------------
  5701     05  FILLER            PIC  X(0003).
  5702     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5703*    -------------------------------
  5704     05  FILLER            PIC  X(0003).
  5705     05  DOCANCO PIC  ZZ99-.
  5706*    -------------------------------
  5707     05  FILLER            PIC  X(0003).
  5708     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5709*    -------------------------------
  5710     05  FILLER            PIC  X(0003).
  5711     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5712*    -------------------------------
  5713     05  FILLER            PIC  X(0003).
  5714     05  DITOTALO PIC  ZZZ99.
  5715*    -------------------------------
  5716     05  FILLER            PIC  X(0003).
  5717     05  DIFATALO PIC  ZZZ99.
  5718*    -------------------------------
  5719     05  FILLER            PIC  X(0003).
  5720     05  DIFORCEO PIC  ZZZ99.
  5721*    -------------------------------
  5722     05  FILLER            PIC  X(0003).
  5723     05  DIHOLDO PIC  ZZZ99.
  5724*    -------------------------------
  5725     05  FILLER            PIC  X(0003).
  5726     05  DIAVAILO PIC  ZZZ99.
  5727*    -------------------------------
  5728     05  FILLER            PIC  X(0003).
  5729     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5730*    -------------------------------
  5731     05  FILLER            PIC  X(0003).
  5732     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5733*    -------------------------------
  5734     05  FILLER            PIC  X(0003).
  5735     05  DCTOTALO PIC  ZZZ99.
  5736*    -------------------------------
  5737     05  FILLER            PIC  X(0003).
  5738     05  DCFATALO PIC  ZZZ99.
  5739*    -------------------------------
  5740     05  FILLER            PIC  X(0003).
  5741     05  DCFORCEO PIC  ZZZ99.
  5742*    -------------------------------
  5743     05  FILLER            PIC  X(0003).
  5744     05  DCHOLDO PIC  ZZZ99.
  5745*    -------------------------------
  5746     05  FILLER            PIC  X(0003).
  5747     05  DCAVAILO PIC  ZZZ99.
  5748*    -------------------------------
  5749     05  FILLER            PIC  X(0003).
  5750     05  DCGPREMO PIC  ZZZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 107
* EL6311.cbl
  5751*    -------------------------------
  5752     05  FILLER            PIC  X(0003).
  5753     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5754*    -------------------------------
  5755     05  FILLER            PIC  X(0003).
  5756     05  DNTOTALO PIC  ---99.
  5757*    -------------------------------
  5758     05  FILLER            PIC  X(0003).
  5759     05  DNFATALO PIC  ---99.
  5760*    -------------------------------
  5761     05  FILLER            PIC  X(0003).
  5762     05  DNFORCEO PIC  ---99.
  5763*    -------------------------------
  5764     05  FILLER            PIC  X(0003).
  5765     05  DNHOLDO PIC  ---99.
  5766*    -------------------------------
  5767     05  FILLER            PIC  X(0003).
  5768     05  DNAVAILO PIC  ---99.
  5769*    -------------------------------
  5770     05  FILLER            PIC  X(0003).
  5771     05  DNGPREMO PIC  -------9.99.
  5772*    -------------------------------
  5773     05  FILLER            PIC  X(0003).
  5774     05  DNBPREMO PIC  -------9.99.
  5775*    -------------------------------
  5776     05  FILLER            PIC  X(0003).
  5777     05  DERMSGO PIC  X(0075).
  5778*    -------------------------------
  5779     05  FILLER            PIC  X(0003).
  5780     05  DPFENTRO PIC  X(0002).
  5781*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 108
* EL6311.cbl
  5783 01  MAP-B REDEFINES EL631BI.
  5784     12  FILLER                  PIC X(591).
  5785*    12  FILLER                  PIC X(512).
  5786*    12  FILLER                  PIC X(510).
  5787     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5788         16  BKIND-LEN               PIC S9(4)  COMP.
  5789         16  BKIND-ATTRB             PIC X.
  5790         16  BKIND                   PIC XX.
  5791         16  BTYPE-LEN               PIC S9(4)  COMP.
  5792         16  BTYPE-ATTRB             PIC X.
  5793         16  BTYPE                   PIC X(3).
  5794         16  BTERM-LEN               PIC S9(4)  COMP.
  5795         16  BTERM-ATTRB             PIC X.
  5796         16  BTERMI                  PIC 999.
  5797         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5798         16  BBEN-LEN                PIC S9(4)  COMP.
  5799         16  BBEN-ATTRB              PIC X.
  5800         16  BBENI                   PIC 9(10)V99.
  5801*        16  BBENI                   PIC 9(12).
  5802         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5803         16  BPREM-LEN               PIC S9(4)  COMP.
  5804         16  BPREM-ATTRB             PIC X.
  5805         16  BPREMI                  PIC S9(9)V99.
  5806*        16  BPREMI                  PIC 9(11).
  5807         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5808         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5809         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5810         16  BEXPIRE-ATTRB           PIC X.
  5811         16  BEXPIRE                 PIC X(8).
  5812         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5813         16  BCRIT-PERD-ATTRB        PIC X.
  5814         16  BCRIT-PERDI             PIC 99.
  5815         16  BCRIT-PERDO REDEFINES
  5816                         BCRIT-PERDI PIC ZZ.
  5817         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5818         16  BALT-BEN-ATTRB          PIC X.
  5819         16  BALT-BENI               PIC 9(10)V99.
  5820*        16  BALT-BENI               PIC 9(12).
  5821         16  BALT-BENO REDEFINES
  5822                           BALT-BENI PIC Z(9).ZZ.
  5823         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5824         16  BALT-PREM-ATTRB         PIC X.
  5825         16  BALT-PREMI              PIC 9(9)V99.
  5826*        16  BALT-PREMI              PIC 9(11).
  5827         16  BALT-PREMO REDEFINES
  5828                          BALT-PREMI PIC Z(7).ZZ-.
  5829         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5830         16  BBEN-CD-ATTRB           PIC X.
  5831         16  BBEN-CD                 PIC XXX.
  5832         16  BCPREM-LEN              PIC S9(4)  COMP.
  5833         16  BCPREM-ATTRB            PIC X.
  5834         16  BCPREMI                 PIC S9(9)V99.
  5835*        16  BCPREMI                 PIC X(11).
  5836         16  BCPREMO REDEFINES BCPREMI
  5837                                     PIC Z(7).99-.
  5838         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5839         16  BCALT-PREM-ATTRB        PIC X.
  5840         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 109
* EL6311.cbl
  5841         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5842         16  BBEN-ABBR-ATTRB         PIC X.
  5843         16  BBEN-ABBR               PIC X(5).
  5844         16  BDIFF-LEN               PIC S9(4)  COMP.
  5845         16  BDIFF-ATTRB             PIC X.
  5846         16  BDIFFO                  PIC Z(7).99-.
  5847         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5848         16  BBILL-LIT-ATTRB         PIC X.
  5849         16  BBILL-LIT               PIC X(8).
  5850         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5851         16  BDALT-PREM-ATTRB        PIC X.
  5852         16  BDALT-PREM              PIC Z(7).99-.
  5853
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 110
* EL6311.cbl
  5855
  5856****************************************************************
  5857*
  5858* Copyright (c) 2007-2013 Dell Inc.
  5859* All rights reserved.
  5860*
  5861****************************************************************
  5862 01  DFHEIV.
  5863   02  DFHEIV0               PIC X(35).
  5864   02  DFHEIV1               PIC X(08).
  5865   02  DFHEIV2               PIC X(08).
  5866   02  DFHEIV3               PIC X(08).
  5867   02  DFHEIV4               PIC X(06).
  5868   02  DFHEIV5               PIC X(04).
  5869   02  DFHEIV6               PIC X(04).
  5870   02  DFHEIV7               PIC X(02).
  5871   02  DFHEIV8               PIC X(02).
  5872   02  DFHEIV9               PIC X(01).
  5873   02  DFHEIV10              PIC S9(7) COMP-3.
  5874   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5875   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5876   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5877   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5878   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5879   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5880   02  DFHEIV17              PIC X(04).
  5881   02  DFHEIV18              PIC X(04).
  5882   02  DFHEIV19              PIC X(04).
  5883   02  DFHEIV20              USAGE IS POINTER.
  5884   02  DFHEIV21              USAGE IS POINTER.
  5885   02  DFHEIV22              USAGE IS POINTER.
  5886   02  DFHEIV23              USAGE IS POINTER.
  5887   02  DFHEIV24              USAGE IS POINTER.
  5888   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5889   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5890   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5891   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5892   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5893   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5894   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5895   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5896   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5897   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5898   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5899   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5900   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5901   02  FILLER                PIC X(02).
  5902   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5903   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5904   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5905   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5906   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5907   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5908   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5909 LINKAGE  SECTION.
  5910*****************************************************************
  5911*                                                               *
  5912* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 111
* EL6311.cbl
  5913* All rights reserved.                                          *
  5914*                                                               *
  5915*****************************************************************
  5916 01  dfheiblk.
  5917     02  eibtime          pic s9(7) comp-3.
  5918     02  eibdate          pic s9(7) comp-3.
  5919     02  eibtrnid         pic x(4).
  5920     02  eibtaskn         pic s9(7) comp-3.
  5921     02  eibtrmid         pic x(4).
  5922     02  dfheigdi         pic s9(4) comp.
  5923     02  eibcposn         pic s9(4) comp.
  5924     02  eibcalen         pic s9(4) comp.
  5925     02  eibaid           pic x(1).
  5926     02  eibfiller1       pic x(1).
  5927     02  eibfn            pic x(2).
  5928     02  eibfiller2       pic x(2).
  5929     02  eibrcode         pic x(6).
  5930     02  eibfiller3       pic x(2).
  5931     02  eibds            pic x(8).
  5932     02  eibreqid         pic x(8).
  5933     02  eibrsrce         pic x(8).
  5934     02  eibsync          pic x(1).
  5935     02  eibfree          pic x(1).
  5936     02  eibrecv          pic x(1).
  5937     02  eibsend          pic x(1).
  5938     02  eibatt           pic x(1).
  5939     02  eibeoc           pic x(1).
  5940     02  eibfmh           pic x(1).
  5941     02  eibcompl         pic x(1).
  5942     02  eibsig           pic x(1).
  5943     02  eibconf          pic x(1).
  5944     02  eiberr           pic x(1).
  5945     02  eibrldbk         pic x(1).
  5946     02  eiberrcd         pic x(4).
  5947     02  eibsynrb         pic x(1).
  5948     02  eibnodat         pic x(1).
  5949     02  eibfiller5       pic x(2).
  5950     02  eibresp          pic s9(8) comp.
  5951     02  eibresp2         pic s9(8) comp.
  5952     02  dfheigdj         pic s9(4) comp.
  5953     02  dfheigdk         pic s9(4) comp.
  5954 01  DFHCOMMAREA                 PIC X(1300).
  5955*                                COPY ERCPNDB.
  5956******************************************************************
  5957*                                                                *
  5958*                                                                *
  5959*                            ERCPNDB.                            *
  5960*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5961*                            VMOD=2.025                          *
  5962*                                                                *
  5963*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5964*                                                                *
  5965******************************************************************
  5966*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5967*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5968******************************************************************
  5969*                                                                *
  5970*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 112
* EL6311.cbl
  5971*   FILE TYPE = VSAM,KSDS                                        *
  5972*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5973*                                                                *
  5974*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5975*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5976*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5977*                                                 RKP=13,LEN=36  *
  5978*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5979*                                      AND CHG-SEQ.)             *
  5980*                                                RKP=49,LEN=11   *
  5981*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5982*                                      AND CHG-SEQ.)             *
  5983*                                                RKP=60,LEN=15   *
  5984*                                                                *
  5985*   LOG = NO                                                     *
  5986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5987******************************************************************
  5988******************************************************************
  5989*                   C H A N G E   L O G
  5990*
  5991* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5992*-----------------------------------------------------------------
  5993*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5994* EFFECTIVE    NUMBER
  5995*-----------------------------------------------------------------
  5996* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5997* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5998* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5999* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6000* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6001* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6002* 032306                   PEMA  ADD BOW LOAN NUMBER
  6003* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6004* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6005* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6006* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6007* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6008* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6009* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6010* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6011* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6012* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6013* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6014* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6015******************************************************************
  6016
  6017 01  PENDING-BUSINESS.
  6018     12  PB-RECORD-ID                     PIC XX.
  6019         88  VALID-PB-ID                        VALUE 'PB'.
  6020
  6021     12  PB-CONTROL-PRIMARY.
  6022         16  PB-COMPANY-CD                PIC X.
  6023         16  PB-ENTRY-BATCH               PIC X(6).
  6024         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6025         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6026
  6027     12  PB-CONTROL-BY-ACCOUNT.
  6028         16  PB-COMPANY-CD-A1             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 113
* EL6311.cbl
  6029         16  PB-CARRIER                   PIC X.
  6030         16  PB-GROUPING.
  6031             20  PB-GROUPING-PREFIX       PIC XXX.
  6032             20  PB-GROUPING-PRIME        PIC XXX.
  6033         16  PB-STATE                     PIC XX.
  6034         16  PB-ACCOUNT.
  6035             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6036             20  PB-ACCOUNT-PRIME         PIC X(6).
  6037         16  PB-CERT-EFF-DT               PIC XX.
  6038         16  PB-CERT-NO.
  6039             20  PB-CERT-PRIME            PIC X(10).
  6040             20  PB-CERT-SFX              PIC X.
  6041         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6042
  6043         16  PB-RECORD-TYPE               PIC X.
  6044             88  PB-MAILING-DATA                VALUE '0'.
  6045             88  PB-ISSUE                       VALUE '1'.
  6046             88  PB-CANCELLATION                VALUE '2'.
  6047             88  PB-BATCH-TRAILER               VALUE '9'.
  6048
  6049     12  PB-CONTROL-BY-ORIG-BATCH.
  6050         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6051         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6052         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6053         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6054
  6055     12  PB-CONTROL-BY-CSR.
  6056         16  PB-CSR-COMPANY-CD            PIC X.
  6057         16  PB-CSR-ID                    PIC X(4).
  6058         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6059         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6060         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6061******************************************************************
  6062*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6063******************************************************************
  6064
  6065     12  PB-LAST-MAINT-DT                 PIC XX.
  6066     12  PB-LAST-MAINT-BY                 PIC X(4).
  6067     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6068
  6069     12  PB-RECORD-BODY                   PIC X(375).
  6070
  6071     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6072         16  PB-CERT-ORIGIN               PIC X.
  6073             88  CLASIC-CREATED-CERT         VALUE '1'.
  6074         16  PB-I-NAME.
  6075             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6076             20  PB-I-INSURED-FIRST-NAME.
  6077                 24  PB-I-INSURED-1ST-INIT PIC X.
  6078                 24  FILLER                PIC X(9).
  6079             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6080         16  PB-I-AGE                     PIC S99   COMP-3.
  6081         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6082         16  PB-I-BIRTHDAY                PIC XX.
  6083         16  PB-I-INSURED-SEX             PIC X.
  6084             88  PB-SEX-MALE     VALUE 'M'.
  6085             88  PB-SEX-FEMALE   VALUE 'F'.
  6086
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 114
* EL6311.cbl
  6087         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6088         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6089         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6090         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6091         16  PB-I-SKIP-CODE               PIC X.
  6092             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6093             88  PB-SKIP-JULY              VALUE '1'.
  6094             88  PB-SKIP-AUGUST            VALUE '2'.
  6095             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6096             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6097             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6098             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6099             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6100             88  PB-SKIP-JUNE              VALUE '8'.
  6101             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6102             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6103             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6104         16  PB-I-TERM-TYPE               PIC X.
  6105             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6106             88  PB-PAID-WEEKLY            VALUE 'W'.
  6107             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6108             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6109             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6110         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6111         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6112         16  PB-I-DATA-ENTRY-SW           PIC X.
  6113             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6114             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6115             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6116             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6117         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6118         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6119*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6120         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6121         16  FILLER                       PIC X.
  6122
  6123         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6124             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6125             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6126                                                   '90' THRU '99'.
  6127         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6128                                          PIC XX.
  6129         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6130         16  PB-I-AMOUNT-FINANCED REDEFINES
  6131                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6132         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6133         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6134                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6135         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6136         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6137         16  PB-I-CLP-AMOUNT REDEFINES
  6138                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6139         16  PB-I-LF-CALC-FLAG            PIC X.
  6140             88 PB-COMP-LF-PREM               VALUE '?'.
  6141         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6142         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6143         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6144         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 115
* EL6311.cbl
  6145         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6146         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6147         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6148         16  PB-I-LF-ABBR                 PIC XXX.
  6149         16  PB-I-LF-INPUT-CD             PIC XX.
  6150
  6151         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6152             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6153             88  PB-INVALID-AH               VALUE '  ' '00'
  6154                                                   '90' THRU '99'.
  6155         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6156         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6157         16  PB-I-AH-CALC-FLAG            PIC X.
  6158             88 PB-COMP-AH-PREM                  VALUE '?'.
  6159         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6160         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6161         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6162         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6163         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6164         16  PB-I-AH-ABBR                 PIC XXX.
  6165         16  PB-I-AH-INPUT-CD             PIC XXX.
  6166
  6167         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6168         16  PB-I-REIN-TABLE              PIC XXX.
  6169         16  PB-I-BUSINESS-TYPE           PIC 99.
  6170         16  PB-I-INDV-GRP-CD             PIC X.
  6171         16  PB-I-MORT-CODE.
  6172             20  PB-I-TABLE               PIC X.
  6173             20  PB-I-INTEREST            PIC XX.
  6174             20  PB-I-MORT-TYP            PIC X.
  6175         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6176         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6177         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6178         16  PB-I-INDV-GRP-OVRD           PIC X.
  6179         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6180         16  PB-I-SIG-SW                  PIC X.
  6181             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6182         16  PB-I-RATE-CLASS              PIC XX.
  6183         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6184         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6185         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6186         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6187         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6188         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6189         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6190         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6191         16  PB-I-OB-FLAG                 PIC X.
  6192             88  PB-I-OB                      VALUE 'B'.
  6193             88  PB-I-SUMMARY                 VALUE 'Z'.
  6194         16  PB-I-ENTRY-STATUS            PIC X.
  6195             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6196                                              'M' '5' '9' '2'.
  6197             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6198             88  PB-I-POLICY-PENDING          VALUE '2'.
  6199             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6200             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6201             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6202             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 116
* EL6311.cbl
  6203             88  PB-I-REIN-ONLY               VALUE '9'.
  6204             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6205             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6206             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6207             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6208         16  PB-I-INT-CODE                PIC X.
  6209             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6210             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6211         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6212         16  PB-I-SOC-SEC-NO              PIC X(11).
  6213         16  PB-I-MEMBER-NO               PIC X(12).
  6214         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6215*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6216         16  PB-I-OLD-LOF                 PIC XXX.
  6217         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6218         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6219         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6220         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6221         16  PB-I-LIFE-INDICATOR          PIC X.
  6222             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6223         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6224         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6225                                          PIC S9(5)V99    COMP-3.
  6226         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6227             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6228             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6229         16  PB-I-1ST-PMT-DT              PIC XX.
  6230         16  PB-I-JOINT-INSURED.
  6231             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6232             20 PB-I-JOINT-FIRST-NAME.
  6233                24  PB-I-JOINT-FIRST-INIT PIC X.
  6234                24  FILLER                PIC X(9).
  6235             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6236*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6237         16  PB-I-BENEFICIARY-NAME.
  6238             20  PB-I-BANK-NUMBER         PIC X(10).
  6239             20  FILLER                   PIC X(15).
  6240         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6241         16  PB-I-REFERENCE               PIC X(12).
  6242         16  FILLER REDEFINES PB-I-REFERENCE.
  6243             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6244             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6245             20  PB-I-CLP-STATE           PIC XX.
  6246         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6247             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6248             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6249             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6250         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6251         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6252         16  PB-I-RESIDENT-STATE          PIC XX.
  6253         16  PB-I-RATE-CODE               PIC X(4).
  6254         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6255         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6256         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6257         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6258         16  PB-I-BANK-NOCHRGB            PIC 99.
  6259         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6260         16  PB-I-JOINT-BIRTHDAY          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 117
* EL6311.cbl
  6261
  6262     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6263         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6264             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6265         16  PB-C-CANCEL-ORIGIN           PIC X.
  6266             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6267         16  PB-C-LF-CANCEL-DT            PIC XX.
  6268         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6269         16  PB-C-LF-CALC-REQ             PIC X.
  6270             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6271         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6272         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6273         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6274             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6275         16  PB-C-AH-CANCEL-DT            PIC XX.
  6276         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6277         16  PB-C-AH-CALC-REQ             PIC X.
  6278             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6279         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6280         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6281         16  PB-C-LAST-NAME               PIC X(15).
  6282         16  PB-C-REFUND-SW               PIC X.
  6283             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6284             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6285         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6286         16  PB-C-PAYEE-CODE              PIC X(6).
  6287         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6288         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6289         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6290         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6291         16  PB-C-REFERENCE               PIC X(12).
  6292         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6293         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6294         16  PB-C-POST-CARD-IND           PIC X.
  6295         16  PB-C-CANCEL-REASON           PIC X.
  6296         16  PB-C-REF-INTERFACE-SW        PIC X.
  6297         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6298         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6299         16  FILLER                       PIC X(01).
  6300*        16  FILLER                       PIC X(18).
  6301         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6302*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6303         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6304         16  PB-CANCELED-CERT-DATA.
  6305             20  PB-CI-INSURED-NAME.
  6306                 24  PB-CI-LAST-NAME      PIC X(15).
  6307                 24  PB-CI-INITIALS       PIC XX.
  6308             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6309             20  PB-CI-INSURED-SEX        PIC X.
  6310             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6311             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6312             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6313             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6314             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6315             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6316             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6317             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6318             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 118
* EL6311.cbl
  6319             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6320             20  PB-CI-RATE-CLASS         PIC XX.
  6321             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6322             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6323             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6324             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6325             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6326             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6327             20  PB-CI-LF-ABBR            PIC X(3).
  6328             20  PB-CI-AH-ABBR            PIC X(3).
  6329             20  PB-CI-OB-FLAG            PIC X.
  6330                 88  PB-CI-OB                VALUE 'B'.
  6331             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6332                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6333                                           'M' '4' '5' '9' '2'.
  6334                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6335                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6336                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6337                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6338                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6339                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6340                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6341                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6342                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6343                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6344                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6345                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6346                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6347             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6348                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6349                                           'M' '4' '5' '9' '2'.
  6350                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6351                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6352                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6353                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6354                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6355                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6356                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6357                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6358                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6359                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6360                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6361                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6362                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6363             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6364             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6365             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6366             20  PB-CI-MEMBER-NO          PIC X(12).
  6367             20  PB-CI-INT-CODE           PIC X.
  6368                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6369                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6370             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6371             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6372             20  PB-CI-COMP-EXCP-SW       PIC X.
  6373                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6374                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6375             20  PB-CI-ENTRY-STATUS       PIC X.
  6376             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 119
* EL6311.cbl
  6377             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6378             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6379             20  PB-CI-DEATH-DT           PIC XX.
  6380             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6381             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6382             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6383             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6384             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6385             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6386             20  PB-CI-ENTRY-DT              PIC XX.
  6387             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6388             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6389             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6390             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6391             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6392             20  PB-CI-OLD-LOF               PIC XXX.
  6393*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6394             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6395             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6396             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6397             20  PB-CI-INDV-GRP-CD           PIC X.
  6398             20  PB-CI-BENEFICIARY-NAME.
  6399                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6400                 24  FILLER                  PIC X(15).
  6401             20  PB-CI-NOTE-SW               PIC X.
  6402             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6403             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6404             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6405             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6406             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6407             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6408             20  PB-CI-FIRST-NAME            PIC X(10).
  6409             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6410
  6411         16  FILLER                       PIC X(13).
  6412*032306  16  FILLER                       PIC X(27).
  6413*        16  FILLER                       PIC X(46).
  6414
  6415     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6416         16  FILLER                       PIC X(10).
  6417         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6418         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6419         16  PB-M-INSURED-MID-INIT        PIC X.
  6420         16  PB-M-INSURED-AGE             PIC 99.
  6421         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6422         16  PB-M-INSURED-SEX             PIC X.
  6423         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6424         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6425         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6426         16  PB-M-INSURED-CITY-STATE.
  6427             20  PB-M-INSURED-CITY        PIC X(28).
  6428             20  PB-M-INSURED-STATE       PIC XX.
  6429         16  PB-M-INSURED-ZIP-CODE.
  6430             20  PB-M-INSURED-ZIP-PRIME.
  6431                 24  PB-M-INSURED-ZIP-1   PIC X.
  6432                     88  PB-M-CANADIAN-POST-CODE
  6433                                             VALUE 'A' THRU 'Z'.
  6434                 24  FILLER               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 120
* EL6311.cbl
  6435             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6436         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6437                                        PB-M-INSURED-ZIP-CODE.
  6438             20  PM-M-INS-CAN-POST1       PIC XXX.
  6439             20  PM-M-INS-CAN-POST2       PIC XXX.
  6440             20  FILLER                   PIC XXX.
  6441         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6442         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6443         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6444         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6445         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6446         16  PB-M-CRED-BENE-CITYST.
  6447             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6448             20  PB-M-CRED-BENE-STATE     PIC XX.
  6449         16  FILLER                       PIC X(92).
  6450
  6451     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6452         16  FILLER                       PIC X(10).
  6453         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6454         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6455         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6456         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6457         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6458         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6459         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6460         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6461         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6462         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6463         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6464         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6465         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6466         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6467         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6468         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6469         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6470         16  PB-ACCOUNT-NAME              PIC X(30).
  6471         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6472         16  PB-REFERENCE                 PIC X(12).
  6473         16  PB-B-RECEIVED-DT             PIC XX.
  6474         16  FILLER                       PIC X(234).
  6475
  6476     12  PB-RECORD-STATUS.
  6477         16  PB-CREDIT-SELECT-DT          PIC XX.
  6478         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6479         16  PB-BILLED-DT                 PIC XX.
  6480         16  PB-BILLING-STATUS            PIC X.
  6481             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6482             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6483             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6484         16  PB-RECORD-BILL               PIC X.
  6485             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6486             88  PB-RECORD-RETURNED           VALUE 'R'.
  6487             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6488             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6489             88  PB-OVERRIDE-AH               VALUE 'A'.
  6490             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6491         16  PB-BATCH-ENTRY               PIC X.
  6492             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 121
* EL6311.cbl
  6493             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6494             88  PB-REISSUED-CERT             VALUE 'E'.
  6495             88  PB-CASH-CERT                 VALUE 'C'.
  6496             88  PB-MONTHLY-CERT              VALUE 'M'.
  6497             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6498             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6499             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6500         16  PB-FORCE-CODE                PIC X.
  6501             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6502             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6503             88  PB-CANCEL-FORCE              VALUE '8'.
  6504             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6505             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6506             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6507             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6508             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6509             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6510             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6511             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6512         16  PB-FATAL-FLAG                PIC X.
  6513             88  PB-FATAL-ERRORS              VALUE 'X'.
  6514         16  PB-FORCE-ER-CD               PIC X.
  6515             88  PB-FORCE-ERRORS              VALUE 'F'.
  6516             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6517         16  PB-WARN-ER-CD                PIC X.
  6518             88  PB-WARNING-ERRORS            VALUE 'W'.
  6519         16  FILLER                       PIC X.
  6520         16  PB-OUT-BAL-CD                PIC X.
  6521             88  PB-OUT-OF-BAL                VALUE 'O'.
  6522         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6523         16  PB-AH-OVERRIDE-L1            PIC X.
  6524         16  PB-INPUT-DT                  PIC XX.
  6525         16  PB-INPUT-BY                  PIC X(4).
  6526         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6527         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6528         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6529         16  PB-LF-EARNING-METHOD         PIC X.
  6530         16  PB-AH-EARNING-METHOD         PIC X.
  6531         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6532         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6533         16  PB-REIN-CD                   PIC XXX.
  6534         16  PB-LF-REFUND-TYPE            PIC X.
  6535         16  PB-AH-REFUND-TYPE            PIC X.
  6536         16  PB-ACCT-EFF-DT               PIC XX.
  6537         16  PB-ACCT-EXP-DT               PIC XX.
  6538         16  PB-COMPANY-ID                PIC X(3).
  6539         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6540         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6541         16  PB-SV-CARRIER                PIC X.
  6542         16  PB-SV-GROUPING               PIC X(6).
  6543         16  PB-SV-STATE                  PIC XX.
  6544         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6545         16  PB-GA-BILLING-INFO.
  6546             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6547                                          PIC XX.
  6548         16  PB-SV-REMIT-TO  REDEFINES
  6549             PB-GA-BILLING-INFO           PIC X(10).
  6550         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 122
* EL6311.cbl
  6551         16  PB-I-LOAN-OFFICER            PIC X(5).
  6552         16  PB-I-VIN                     PIC X(17).
  6553
  6554         16  FILLER                       PIC X(04).
  6555         16  IMNET-BYPASS-SW              PIC X.
  6556
  6557******************************************************************
  6558*                COMMON EDIT ERRORS                              *
  6559******************************************************************
  6560
  6561     12  PB-COMMON-ERRORS.
  6562         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6563                                           PIC S9(4)     COMP.
  6564
  6565******************************************************************
  6566*                                COPY ELCCERT.
  6567******************************************************************
  6568*                                                                *
  6569*                            ELCCERT.                            *
  6570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6571*                            VMOD=2.013                          *
  6572*                                                                *
  6573*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6574*                                                                *
  6575*   FILE TYPE = VSAM,KSDS                                        *
  6576*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6577*                                                                *
  6578*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6579*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6580*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6581*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6582*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6583*                                                                *
  6584*   LOG = YES                                                    *
  6585*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6586******************************************************************
  6587*                   C H A N G E   L O G
  6588*
  6589* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6590*-----------------------------------------------------------------
  6591*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6592* EFFECTIVE    NUMBER
  6593*-----------------------------------------------------------------
  6594* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6595* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6596* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6597* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6598* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6599* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6600* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6601* 032612  CR2011110200001  PEMA  AHL CHANGES
  6602* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6603* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6604* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6605******************************************************************
  6606
  6607 01  CERTIFICATE-MASTER.
  6608     12  CM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 123
* EL6311.cbl
  6609         88  VALID-CM-ID                      VALUE 'CM'.
  6610
  6611     12  CM-CONTROL-PRIMARY.
  6612         16  CM-COMPANY-CD                 PIC X.
  6613         16  CM-CARRIER                    PIC X.
  6614         16  CM-GROUPING.
  6615             20  CM-GROUPING-PREFIX        PIC X(3).
  6616             20  CM-GROUPING-PRIME         PIC X(3).
  6617         16  CM-STATE                      PIC XX.
  6618         16  CM-ACCOUNT.
  6619             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6620             20  CM-ACCOUNT-PRIME          PIC X(6).
  6621         16  CM-CERT-EFF-DT                PIC XX.
  6622         16  CM-CERT-NO.
  6623             20  CM-CERT-PRIME             PIC X(10).
  6624             20  CM-CERT-SFX               PIC X.
  6625
  6626     12  CM-CONTROL-BY-NAME.
  6627         16  CM-COMPANY-CD-A1              PIC X.
  6628         16  CM-INSURED-LAST-NAME          PIC X(15).
  6629         16  CM-INSURED-INITIALS.
  6630             20  CM-INSURED-INITIAL1       PIC X.
  6631             20  CM-INSURED-INITIAL2       PIC X.
  6632
  6633     12  CM-CONTROL-BY-SSN.
  6634         16  CM-COMPANY-CD-A2              PIC X.
  6635         16  CM-SOC-SEC-NO.
  6636             20  CM-SSN-STATE              PIC XX.
  6637             20  CM-SSN-ACCOUNT            PIC X(6).
  6638             20  CM-SSN-LN3.
  6639                 25  CM-INSURED-INITIALS-A2.
  6640                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6641                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6642                 25 CM-PART-LAST-NAME-A2         PIC X.
  6643
  6644     12  CM-CONTROL-BY-CERT-NO.
  6645         16  CM-COMPANY-CD-A4              PIC X.
  6646         16  CM-CERT-NO-A4                 PIC X(11).
  6647
  6648     12  CM-CONTROL-BY-MEMB.
  6649         16  CM-COMPANY-CD-A5              PIC X.
  6650         16  CM-MEMBER-NO.
  6651             20  CM-MEMB-STATE             PIC XX.
  6652             20  CM-MEMB-ACCOUNT           PIC X(6).
  6653             20  CM-MEMB-LN4.
  6654                 25  CM-INSURED-INITIALS-A5.
  6655                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6656                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6657                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6658
  6659     12  CM-INSURED-PROFILE-DATA.
  6660         16  CM-INSURED-FIRST-NAME.
  6661             20  CM-INSURED-1ST-INIT       PIC X.
  6662             20  FILLER                    PIC X(9).
  6663         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6664         16  CM-INSURED-SEX                PIC X.
  6665             88  CM-SEX-MALE                  VALUE 'M'.
  6666             88  CM-SEX-FEMAL                 VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 124
* EL6311.cbl
  6667         16  CM-INSURED-JOINT-AGE          PIC 99.
  6668         16  CM-JOINT-INSURED-NAME.
  6669             20  CM-JT-LAST-NAME           PIC X(15).
  6670             20  CM-JT-FIRST-NAME.
  6671                 24  CM-JT-1ST-INIT        PIC X.
  6672                 24  FILLER                PIC X(9).
  6673             20  CM-JT-INITIAL             PIC X.
  6674
  6675     12  CM-LIFE-DATA.
  6676         16  CM-LF-BENEFIT-CD              PIC XX.
  6677         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6678         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6679         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6680         16  CM-LF-DEV-CODE                PIC XXX.
  6681         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6682         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6683         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6684         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6685         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6686         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6687         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6688         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6689         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6690         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6691         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6692         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6693         16  cm-temp-epiq                  pic xx.
  6694             88  EPIQ-CLASS                  value 'EQ'.
  6695*        16  FILLER                        PIC XX.
  6696
  6697     12  CM-AH-DATA.
  6698         16  CM-AH-BENEFIT-CD              PIC XX.
  6699         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6700         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6701         16  CM-AH-DEV-CODE                PIC XXX.
  6702         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6703         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6704         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6705         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6706         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6707         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6708         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6709         16  CM-AH-PAID-THRU-DT            PIC XX.
  6710             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6711         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6712         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6713         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6714         16  FILLER                        PIC X.
  6715
  6716     12  CM-LOAN-INFORMATION.
  6717         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6718         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6719                                           PIC S9(5)V99  COMP-3.
  6720         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6721         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6722         16  CM-PAY-FREQUENCY              PIC S99.
  6723         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6724         16  CM-RATE-CLASS                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 125
* EL6311.cbl
  6725         16  CM-BENEFICIARY                PIC X(25).
  6726         16  CM-POLICY-FORM-NO             PIC X(12).
  6727         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6728         16  CM-LAST-ADD-ON-DT             PIC XX.
  6729         16  CM-DEDUCTIBLE-AMOUNTS.
  6730             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6731             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6732         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6733             20  CM-RESIDENT-STATE         PIC XX.
  6734             20  CM-RATE-CODE              PIC X(4).
  6735             20  FILLER                    PIC XX.
  6736         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6737             20  CM-LOAN-OFFICER           PIC X(5).
  6738             20  FILLER                    PIC XXX.
  6739         16  CM-CSR-CODE                   PIC XXX.
  6740         16  CM-UNDERWRITING-CODE          PIC X.
  6741             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6742         16  CM-POST-CARD-IND              PIC X.
  6743         16  CM-REF-INTERFACE-SW           PIC X.
  6744         16  CM-PREMIUM-TYPE               PIC X.
  6745             88  CM-SING-PRM                  VALUE '1'.
  6746             88  CM-O-B-COVERAGE              VALUE '2'.
  6747             88  CM-OPEN-END                  VALUE '3'.
  6748         16  CM-IND-GRP-TYPE               PIC X.
  6749             88  CM-INDIVIDUAL                VALUE 'I'.
  6750             88  CM-GROUP                     VALUE 'G'.
  6751         16  CM-SKIP-CODE                  PIC X.
  6752             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6753             88  SKIP-JULY                    VALUE '1'.
  6754             88  SKIP-AUGUST                  VALUE '2'.
  6755             88  SKIP-SEPTEMBER               VALUE '3'.
  6756             88  SKIP-JULY-AUG                VALUE '4'.
  6757             88  SKIP-AUG-SEPT                VALUE '5'.
  6758             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6759             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6760             88  SKIP-JUNE                    VALUE '8'.
  6761             88  SKIP-JUNE-JULY               VALUE '9'.
  6762             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6763             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6764         16  CM-PAYMENT-MODE               PIC X.
  6765             88  PAY-MONTHLY                  VALUE SPACE.
  6766             88  PAY-WEEKLY                   VALUE '1'.
  6767             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6768             88  PAY-BI-WEEKLY                VALUE '3'.
  6769             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6770         16  CM-LOAN-NUMBER                PIC X(8).
  6771         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6772         16  CM-OLD-LOF                    PIC XXX.
  6773*        16  CM-LOAN-OFFICER               PIC XXX.
  6774         16  CM-REIN-TABLE                 PIC XXX.
  6775         16  CM-SPECIAL-REIN-CODE          PIC X.
  6776         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6777         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6778         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6779
  6780     12  CM-STATUS-DATA.
  6781         16  CM-ENTRY-STATUS               PIC X.
  6782         16  CM-ENTRY-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 126
* EL6311.cbl
  6783
  6784         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6785         16  CM-LF-CANCEL-DT               PIC XX.
  6786         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6787
  6788         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6789         16  CM-LF-DEATH-DT                PIC XX.
  6790         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6791
  6792         16  CM-LF-CURRENT-STATUS          PIC X.
  6793             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6794                                                'M' '4' '5' '9'.
  6795             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6796             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6797             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6798             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6799             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6800             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6801             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6802             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6803             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6804             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6805             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6806             88  CM-LF-DECLINED               VALUE 'D'.
  6807             88  CM-LF-VOIDED                 VALUE 'V'.
  6808
  6809         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6810         16  CM-AH-CANCEL-DT               PIC XX.
  6811         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6812
  6813         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6814         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6815         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6816
  6817         16  CM-AH-CURRENT-STATUS          PIC X.
  6818             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6819                                                'M' '4' '5' '9'.
  6820             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6821             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6822             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6823             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6824             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6825             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6826             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6827             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6828             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6829             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6830             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6831             88  CM-AH-DECLINED               VALUE 'D'.
  6832             88  CM-AH-VOIDED                 VALUE 'V'.
  6833
  6834         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6835             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6836             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6837             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6838         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6839
  6840         16  CM-ENTRY-BATCH                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 127
* EL6311.cbl
  6841         16  CM-LF-EXIT-BATCH              PIC X(6).
  6842         16  CM-AH-EXIT-BATCH              PIC X(6).
  6843         16  CM-LAST-MONTH-END             PIC XX.
  6844
  6845     12  CM-NOTE-SW                        PIC X.
  6846         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6847         88  CERT-NOTES-PRESENT               VALUE '1'.
  6848         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6849         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6850         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6851         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6852         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6853         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6854     12  CM-COMP-EXCP-SW                   PIC X.
  6855         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6856         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6857     12  CM-INSURED-ADDRESS-SW             PIC X.
  6858         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6859         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6860
  6861*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6862     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6863     12  FILLER                            PIC X.
  6864
  6865*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6866     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6867     12  FILLER                            PIC X.
  6868*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6869     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6870
  6871     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6872         88  CERT-ADDED-BATCH                 VALUE ' '.
  6873         88  CERT-ADDED-ONLINE                VALUE '1'.
  6874         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6875         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6876         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6877     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6878         88  CERT-AS-LOADED                   VALUE ' '.
  6879         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6880         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6881         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6882         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6883         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6884         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6885         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6886
  6887     12  CM-ACCOUNT-COMM-PCTS.
  6888         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6889         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6890
  6891     12  CM-USER-FIELD                     PIC X.
  6892     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6893     12  CM-CLP-STATE                      PIC XX.
  6894     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6895     12  CM-USER-RESERVED                  PIC XXX.
  6896     12  FILLER REDEFINES CM-USER-RESERVED.
  6897         16  CM-AH-CLASS-CD                PIC XX.
  6898         16  F                             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 128
* EL6311.cbl
  6899******************************************************************
  6900*                                COPY ERCNOTE.
  6901******************************************************************
  6902*                                                                *
  6903*                                                                *
  6904*                            ERCNOTE                             *
  6905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6906*                            VMOD=2.003                          *
  6907*                                                                *
  6908*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6909*                                                                *
  6910*        FILE TYPE= VSAM,KSDS                                    *
  6911*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6912*                                                                *
  6913*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6914*                                                                *
  6915*        LOG = YES                                               *
  6916*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6917*                                                                *
  6918******************************************************************
  6919*                   C H A N G E   L O G
  6920*
  6921* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6922*-----------------------------------------------------------------
  6923*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6924* EFFECTIVE    NUMBER
  6925*-----------------------------------------------------------------
  6926* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6927*                                FILE WILL CONTAIN BILLING NOTES O
  6928******************************************************************
  6929
  6930 01  CERTIFICATE-NOTE.
  6931     12  CN-RECORD-ID                PIC  XX.
  6932         88  VALID-CN-ID                  VALUE 'CN'.
  6933
  6934     12  CN-CONTROL-PRIMARY.
  6935         16  CN-COMPANY-CD           PIC X.
  6936         16  CN-CARRIER              PIC X.
  6937         16  CN-GROUPING.
  6938             20 CN-GROUPING-PREFIX   PIC XXX.
  6939             20 CN-GROUPING-PRIME    PIC XXX.
  6940         16  CN-STATE                PIC XX.
  6941         16  CN-ACCOUNT.
  6942             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6943             20 CN-ACCOUNT-PRIME     PIC X(6).
  6944         16  CN-CERT-EFF-DT          PIC XX.
  6945         16  CN-CERT-NO.
  6946             20  CN-CERT-PRIME       PIC X(10).
  6947             20  CN-CERT-SFX         PIC X.
  6948
  6949     12  CN-BILLING-START-LINE-NO    PIC 99.
  6950     12  CN-BILLING-END-LINE-NO      PIC 99.
  6951
  6952     12  CN-LINES.
  6953         16  CN-LINE OCCURS 10       PIC X(77).
  6954
  6955     12  CN-LAST-MAINT-DT            PIC XX.
  6956     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 129
* EL6311.cbl
  6957     12  CN-LAST-MAINT-USER          PIC X(4).
  6958     12  FILLER                      PIC X(6).
  6959******************************************************************
  6960*                                COPY ERCPNDM.
  6961******************************************************************
  6962*                                                                *
  6963*                                                                *
  6964*                            ERCPNDM                             *
  6965*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6966*                            VMOD=2.003                          *
  6967*                                                                *
  6968*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6969*                                                                *
  6970*   FILE TYPE = VSAM,KSDS                                        *
  6971*   RECORD SIZE = 374   RECFORM = FIX                            *
  6972*                                                                *
  6973*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6974*   ALTERNATE PATH    = NOT USED                                 *
  6975*                                                                *
  6976*   LOG = YES                                                    *
  6977*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6978******************************************************************
  6979*                   C H A N G E   L O G
  6980*
  6981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6982*-----------------------------------------------------------------
  6983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6984* EFFECTIVE    NUMBER
  6985*-----------------------------------------------------------------
  6986* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6987* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6988* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6989* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  6990******************************************************************
  6991
  6992 01  PENDING-MAILING-DATA.
  6993     12  PM-RECORD-ID                      PIC XX.
  6994         88  VALID-MA-ID                       VALUE 'PM'.
  6995
  6996     12  PM-CONTROL-PRIMARY.
  6997         16  PM-COMPANY-CD                 PIC X.
  6998         16  PM-ENTRY-BATCH                PIC X(6).
  6999         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7000         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7001
  7002     12  FILLER                            PIC X(14).
  7003
  7004     12  PM-ACCESS-CONTROL.
  7005         16  PM-SOURCE-SYSTEM              PIC XX.
  7006             88  PM-FROM-CREDIT                VALUE 'CR'.
  7007             88  PM-FROM-VSI                   VALUE 'VS'.
  7008             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7009             88  PM-FROM-OTHER                 VALUE 'OT'.
  7010         16  PM-RECORD-ADD-DT              PIC XX.
  7011         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7012         16  PM-LAST-MAINT-DT              PIC XX.
  7013         16  PM-LAST-MAINT-BY              PIC XXXX.
  7014         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 130
* EL6311.cbl
  7015
  7016     12  PM-PROFILE-INFO.
  7017         16  PM-QUALIFY-CODE-1             PIC XX.
  7018         16  PM-QUALIFY-CODE-2             PIC XX.
  7019         16  PM-QUALIFY-CODE-3             PIC XX.
  7020         16  PM-QUALIFY-CODE-4             PIC XX.
  7021         16  PM-QUALIFY-CODE-5             PIC XX.
  7022
  7023         16  PM-INSURED-LAST-NAME          PIC X(15).
  7024         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7025         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7026         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7027         16  PM-INSURED-BIRTH-DT           PIC XX.
  7028         16  PM-INSURED-SEX                PIC X.
  7029             88  PM-SEX-MALE                   VALUE 'M'.
  7030             88  PM-SEX-FEMALE                 VALUE 'F'.
  7031         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7032
  7033         16  PM-ADDRESS-CORRECTED          PIC X.
  7034         16  PM-JOINT-BIRTH-DT             PIC XX.
  7035*        16  FILLER                        PIC X(12).
  7036
  7037         16  PM-ADDRESS-LINE-1             PIC X(30).
  7038         16  PM-ADDRESS-LINE-2             PIC X(30).
  7039         16  PM-CITY-STATE.
  7040             20  PM-CITY                   PIC X(28).
  7041             20  PM-STATE                  PIC XX.
  7042         16  PM-ZIP.
  7043             20  PM-ZIP-CODE.
  7044                 24  PM-ZIP-1              PIC X.
  7045                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7046                 24  FILLER                PIC X(4).
  7047             20  PM-ZIP-PLUS4              PIC X(4).
  7048         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7049             20  PM-CAN-POST1              PIC XXX.
  7050             20  PM-CAN-POST2              PIC XXX.
  7051             20  FILLER                    PIC XXX.
  7052
  7053         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7054         16  pm-city-st-zip-verified       pic x.
  7055         16  FILLER                        PIC XX.
  7056
  7057     12  PM-CRED-BENE-INFO.
  7058         16  PM-CRED-BENE-NAME             PIC X(25).
  7059         16  PM-CRED-BENE-ADDR             PIC X(30).
  7060         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7061         16  PM-CRED-BENE-CTYST.
  7062             20  PM-CRED-BENE-CITY         PIC X(28).
  7063             20  PM-CRED-BENE-STATE        PIC XX.
  7064         16  PM-CRED-BENE-ZIP.
  7065             20  PM-CB-ZIP-CODE.
  7066                 24  PM-CB-ZIP-1           PIC X.
  7067                     88  PM-CB-CANADIAN-POST-CODE
  7068                                  VALUE 'A' THRU 'Z'.
  7069                 24  FILLER                PIC X(4).
  7070             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7071         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  7072             20  PM-CB-CAN-POST1           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 131
* EL6311.cbl
  7073             20  PM-CB-CAN-POST2           PIC XXX.
  7074             20  FILLER                    PIC XXX.
  7075     12  PM-POST-CARD-MAIL-DATA.
  7076         16  PM-MAIL-DATA OCCURS 7.
  7077             20  PM-MAIL-TYPE              PIC X.
  7078                 88  PM-12MO-MAILING           VALUE '1'.
  7079                 88  PM-EXP-MAILING            VALUE '2'.
  7080             20  PM-MAIL-STATUS            PIC X.
  7081                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7082                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7083                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7084             20  PM-MAIL-DATE              PIC XX.
  7085     12  FILLER                            PIC XX.
  7086     12  FILLER                            PIC X(12).
  7087*    12  FILLER                            PIC X(30).
  7088
  7089******************************************************************
  7090*                                COPY ERCMAIL.
  7091******************************************************************
  7092*                                                                *
  7093*                                                                *
  7094*                            ERCMAIL                             *
  7095*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7096*                            VMOD=2.003                          *
  7097*                                                                *
  7098*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7099*                                                                *
  7100*   FILE TYPE = VSAM,KSDS                                        *
  7101*   RECORD SIZE = 374   RECFORM = FIX                            *
  7102*                                                                *
  7103*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7104*   ALTERNATE PATH    = NOT USED                                 *
  7105*                                                                *
  7106*   LOG = YES                                                    *
  7107*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7108******************************************************************
  7109*                   C H A N G E   L O G
  7110*
  7111* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7112*-----------------------------------------------------------------
  7113*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7114* EFFECTIVE    NUMBER
  7115*-----------------------------------------------------------------
  7116* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7117* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7118* 111108                   PEMA  ADD CRED BENE ADDR2
  7119******************************************************************
  7120
  7121 01  MAILING-DATA.
  7122     12  MA-RECORD-ID                      PIC XX.
  7123         88  VALID-MA-ID                       VALUE 'MA'.
  7124
  7125     12  MA-CONTROL-PRIMARY.
  7126         16  MA-COMPANY-CD                 PIC X.
  7127         16  MA-CARRIER                    PIC X.
  7128         16  MA-GROUPING.
  7129             20  MA-GROUPING-PREFIX        PIC XXX.
  7130             20  MA-GROUPING-PRIME         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 132
* EL6311.cbl
  7131         16  MA-STATE                      PIC XX.
  7132         16  MA-ACCOUNT.
  7133             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7134             20  MA-ACCOUNT-PRIME          PIC X(6).
  7135         16  MA-CERT-EFF-DT                PIC XX.
  7136         16  MA-CERT-NO.
  7137             20  MA-CERT-PRIME             PIC X(10).
  7138             20  MA-CERT-SFX               PIC X.
  7139
  7140     12  FILLER                            PIC XX.
  7141
  7142     12  MA-ACCESS-CONTROL.
  7143         16  MA-SOURCE-SYSTEM              PIC XX.
  7144             88  MA-FROM-CREDIT                VALUE 'CR'.
  7145             88  MA-FROM-VSI                   VALUE 'VS'.
  7146             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7147             88  MA-FROM-OTHER                 VALUE 'OT'.
  7148         16  MA-RECORD-ADD-DT              PIC XX.
  7149         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7150         16  MA-LAST-MAINT-DT              PIC XX.
  7151         16  MA-LAST-MAINT-BY              PIC XXXX.
  7152         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7153
  7154     12  MA-PROFILE-INFO.
  7155         16  MA-QUALIFY-CODE-1             PIC XX.
  7156         16  MA-QUALIFY-CODE-2             PIC XX.
  7157         16  MA-QUALIFY-CODE-3             PIC XX.
  7158         16  MA-QUALIFY-CODE-4             PIC XX.
  7159         16  MA-QUALIFY-CODE-5             PIC XX.
  7160
  7161         16  MA-INSURED-LAST-NAME          PIC X(15).
  7162         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7163         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7164         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7165         16  MA-INSURED-BIRTH-DT           PIC XX.
  7166         16  MA-INSURED-SEX                PIC X.
  7167             88  MA-SEX-MALE                   VALUE 'M'.
  7168             88  MA-SEX-FEMALE                 VALUE 'F'.
  7169         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7170
  7171         16  MA-ADDRESS-CORRECTED          PIC X.
  7172         16  MA-JOINT-BIRTH-DT             PIC XX.
  7173*        16  FILLER                        PIC X(12).
  7174
  7175         16  MA-ADDRESS-LINE-1             PIC X(30).
  7176         16  MA-ADDRESS-LINE-2             PIC X(30).
  7177         16  MA-CITY-STATE.
  7178             20  MA-CITY                   PIC X(28).
  7179             20  MA-ADDR-STATE             PIC XX.
  7180         16  MA-ZIP.
  7181             20  MA-ZIP-CODE.
  7182                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7183                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7184                 24  FILLER                PIC X(4).
  7185             20  MA-ZIP-PLUS4              PIC X(4).
  7186         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7187             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7188             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 133
* EL6311.cbl
  7189             20  FILLER                    PIC X(3).
  7190
  7191         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7192
  7193         16  FILLER                        PIC XXX.
  7194*        16  FILLER                        PIC X(10).
  7195
  7196     12  MA-CRED-BENE-INFO.
  7197         16  MA-CRED-BENE-NAME                 PIC X(25).
  7198         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7199         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7200         16  MA-CRED-BENE-CTYST.
  7201             20  MA-CRED-BENE-CITY             PIC X(28).
  7202             20  MA-CRED-BENE-STATE            PIC XX.
  7203         16  MA-CRED-BENE-ZIP.
  7204             20  MA-CB-ZIP-CODE.
  7205                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7206                     88  MA-CB-CANADIAN-POST-CODE
  7207                                           VALUE 'A' THRU 'Z'.
  7208                 24  FILLER                    PIC X(4).
  7209             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7210         16  MA-CB-CANADIAN-POSTAL-CODE
  7211                            REDEFINES MA-CRED-BENE-ZIP.
  7212             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7213             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7214             20  FILLER                        PIC X(3).
  7215     12  MA-POST-CARD-MAIL-DATA.
  7216         16  MA-MAIL-DATA OCCURS 7.
  7217             20  MA-MAIL-TYPE              PIC X.
  7218                 88  MA-12MO-MAILING           VALUE '1'.
  7219                 88  MA-EXP-MAILING            VALUE '2'.
  7220             20  MA-MAIL-STATUS            PIC X.
  7221                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7222                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7223                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7224             20  MA-MAIL-DATE              PIC XX.
  7225     12  FILLER                            PIC XX.
  7226     12  FILLER                            PIC XX.
  7227*    12  FILLER                            PIC X(30).
  7228******************************************************************
  7229*                                COPY ERCRQST.
  7230******************************************************************
  7231*                                                                *
  7232*                                                                *
  7233*                            ERCRQST.                            *
  7234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7235*                            VMOD=2.002                          *
  7236*                                                                *
  7237*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7238*                                                                *
  7239*   FILE TYPE = VSAM,KSDS                                        *
  7240*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7241*                                                                *
  7242*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7243*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7244*                                   ACCOUNT, REF, BATCH)         *
  7245*                                                RKP=9, LEN=38   *
  7246*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 134
* EL6311.cbl
  7247*                                   ACCOUNT, REF, BATCH)         *
  7248*                                                RKP=47, LEN=46  *
  7249*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7250*                                   BATCH)                       *
  7251*                                                RKP=93, LEN=24  *
  7252*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7253*                                   REF, BATCH)                  *
  7254*                                                RKP=117, LEN=35 *
  7255*   LOG = NO                                                     *
  7256*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7257******************************************************************
  7258
  7259 01  AR-REQUEST-RECORD.
  7260     12  RQ-RECORD-ID                     PIC XX.
  7261         88  VALID-RQ-ID                        VALUE 'RQ'.
  7262
  7263     12  RQ-CONTROL-PRIMARY.
  7264         16  RQ-COMPANY-CD                PIC X.
  7265         16  RQ-ENTRY-BATCH               PIC X(6).
  7266
  7267     12  RQ-CONTROL-BY-ACCT-REF.
  7268         16  RQ-COMPANY-CD-A1             PIC X.
  7269         16  RQ-CARRIER-A1                PIC X.
  7270         16  RQ-GROUPING-A1               PIC X(6).
  7271         16  RQ-STATE-A1                  PIC XX.
  7272         16  RQ-ACCOUNT-A1                PIC X(10).
  7273         16  RQ-REFERENCE-A1              PIC X(12).
  7274         16  RQ-BATCH-A1                  PIC X(6).
  7275
  7276     12  RQ-CONTROL-BY-FIN-RESP.
  7277         16  RQ-COMPANY-CD-A2             PIC X.
  7278         16  RQ-CARRIER-A2                PIC X.
  7279         16  RQ-GROUPING-A2               PIC X(6).
  7280         16  RQ-FIN-RESP-A2               PIC X(10).
  7281         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7282         16  RQ-REFERENCE-A2              PIC X(12).
  7283         16  RQ-BATCH-A2                  PIC X(6).
  7284
  7285     12  RQ-CONTROL-BY-ACCT-AGENT.
  7286         16  RQ-COMPANY-CD-A3             PIC X.
  7287         16  RQ-CARRIER-A3                PIC X.
  7288         16  RQ-GROUPING-A3               PIC X(6).
  7289         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7290         16  RQ-BATCH-A3                  PIC X(6).
  7291
  7292     12  RQ-CONTROL-BY-SUMMARY.
  7293         16  RQ-COMPANY-CD-A4             PIC X.
  7294         16  RQ-SUMMARY-CODE              PIC X(6).
  7295         16  RQ-ACCOUNT-A4                PIC X(10).
  7296         16  RQ-REFERENCE-A4              PIC X(12).
  7297         16  RQ-BATCH-A4                  PIC X(6).
  7298
  7299     12  RQ-REQUEST-METHOD                PIC X.
  7300         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7301         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7302         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7303         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7304     12  FILLER                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 135
* EL6311.cbl
  7305     12  RQ-STATUS                        PIC X.
  7306         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7307         88  RQ-RESUBMIT                      VALUE 'R'.
  7308     12  RQ-PROCESSOR-ID                  PIC X(4).
  7309     12  RQ-ENTRY-DT                      PIC XX.
  7310     12  RQ-MO-END-DT                     PIC XX.
  7311     12  RQ-REQUEST-DT                    PIC XX.
  7312     12  RQ-STMT-DT                       PIC XX.
  7313     12  RQ-REVERSAL-DT                   PIC XX.
  7314     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7315     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7316
  7317     12  FILLER                           PIC X(27).
  7318
  7319******************************************************************
  7320
  7321*                                COPY ERCLOFC.
  7322******************************************************************
  7323*                                                                *
  7324*                                                                *
  7325*                            ERCLOFC                             *
  7326*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7327*                            VMOD=2.003                          *
  7328*                                                                *
  7329*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7330*                                                                *
  7331*   FILE TYPE = VSAM,KSDS                                        *
  7332*   RECORD SIZE = 670   RECFORM = FIX                            *
  7333*                                                                *
  7334*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7335*                                                                *
  7336*   LOG = YES                                                    *
  7337*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7338*                                                                *
  7339******************************************************************
  7340
  7341 01  LOAN-OFFICER-MASTER.
  7342     12  LO-RECORD-ID                PIC XX.
  7343         88  VALID-LO-ID                VALUE 'LO'.
  7344
  7345     12  LO-CONTROL-PRIMARY.
  7346         16  LO-COMPANY-CD           PIC X.
  7347         16  LO-CARRIER              PIC X.
  7348         16  LO-GROUPING.
  7349             20  LO-GROUPING-PREFIX  PIC XXX.
  7350             20  LO-GROUPING-PRIME   PIC XXX.
  7351         16  LO-STATE                PIC XX.
  7352         16  LO-ACCOUNT.
  7353             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7354             20  LO-ACCOUNT-PRIME    PIC X(6).
  7355         16  LO-OFFICER-CODE         PIC X(5).
  7356
  7357     12  LO-OFFICER-NAME             PIC X(30).
  7358
  7359     12  LO-LAST-MAINT-DT            PIC XX.
  7360     12  LO-LAST-USER                PIC X(4).
  7361     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7362
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 136
* EL6311.cbl
  7363     12  LO-COMP-CONTROL             PIC X.
  7364             88  LO-SHOW-COMP           VALUE 'Y'.
  7365             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7366     12  LO-DETAIL-CONTROL           PIC X.
  7367             88  LO-PRINT-DETAIL        VALUE 'D'.
  7368             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7369
  7370     12  LO-SV-CARRIER               PIC X.
  7371     12  LO-SV-GROUPING              PIC X(6).
  7372     12  LO-SV-STATE                 PIC XX.
  7373
  7374     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7375     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7376
  7377     12  LO-OFFICER-INFO.
  7378         16  FILLER OCCURS 12 TIMES.
  7379             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7380             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7381             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7382             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7383             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7384             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7385             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7386             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7387     12  FILLER                      PIC X(198).
  7388******************************************************************
  7389*                                COPY ERCPYAJ.
  7390******************************************************************
  7391*                                                                *
  7392*                            ERCPYAJ                             *
  7393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7394*                            VMOD=2.015                          *
  7395*                                                                *
  7396*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7397*                                                                *
  7398*                                                                *
  7399*   FILE TYPE = VSAM,KSDS                                        *
  7400*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7401*                                                                *
  7402*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7403*       ALTERNATE PATHS = NONE                                   *
  7404*                                                                *
  7405*   LOG = YES                                                    *
  7406*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7407******************************************************************
  7408******************************************************************
  7409*                   C H A N G E   L O G
  7410*
  7411* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7412*-----------------------------------------------------------------
  7413*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7414* EFFECTIVE    NUMBER
  7415*-----------------------------------------------------------------
  7416* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7417* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7418******************************************************************
  7419
  7420 01  PENDING-PAY-ADJ.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 137
* EL6311.cbl
  7421     12  PY-RECORD-ID                     PIC XX.
  7422         88  VALID-PY-ID                        VALUE 'PY'.
  7423
  7424     12  PY-CONTROL-PRIMARY.
  7425         16  PY-COMPANY-CD                PIC X.
  7426         16  PY-CARRIER                   PIC X.
  7427         16  PY-GROUPING                  PIC X(6).
  7428         16  PY-FIN-RESP                  PIC X(10).
  7429         16  PY-ACCOUNT                   PIC X(10).
  7430         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7431                                          PIC X(10).
  7432         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7433         16  PY-RECORD-TYPE               PIC X.
  7434             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7435             88  PY-DEPOSIT                   VALUE 'D'.
  7436             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7437             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7438             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7439             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7440             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7441             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7442             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7443             88  PY-FICA-ENTRY                VALUE 'F'.
  7444             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7445             88  PY-POLICY-FEE                VALUE 'W'.
  7446             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7447
  7448     12  PY-PYMT-TYPE                     PIC X.
  7449             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7450             88  PY-REINS-PYMT                VALUE 'R'.
  7451             88  PY-EXP-PYMT                  VALUE 'E'.
  7452
  7453     12  PY-BIL-INV                       PIC X(6).
  7454     12  PY-REF-NO                        PIC X(12).
  7455
  7456     12  PY-LAST-MAINT-DT                 PIC XX.
  7457     12  PY-LAST-MAINT-BY                 PIC X(4).
  7458     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7459
  7460     12  PY-PYADJ-RECORD.
  7461         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7462         16  PY-ENTRY-COMMENT             PIC X(30).
  7463         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7464             20  PY-GL-ACCOUNT            PIC X(10).
  7465             20  PY-GL-STATE              PIC X(02).
  7466             20  PY-GL-CANC-SW            PIC X(01).
  7467                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7468                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7469             20  PY-GL-COMMENT            PIC X(10).
  7470             20  FILLER      REDEFINES PY-GL-COMMENT.
  7471                 24  PY-GL-CHECK-NO       PIC 9(06).
  7472                 24  FILLER               PIC X(04).
  7473             20  FILLER                   PIC X(07).
  7474         16  PY-SAVE-ACCOUNT              PIC X(10).
  7475         16  PY-SAVE-TYPE                 PIC X(01).
  7476
  7477         16  PY-LETTERS.
  7478             20  PY-LETTER OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 138
* EL6311.cbl
  7479                           INDEXED BY PY-LET-NDX
  7480                                          PIC X(04).
  7481
  7482         16  PY-ERCOMP-TYPE               PIC X.
  7483             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7484             88  PY-GA-TYPE                   VALUE 'G'.
  7485             88  PY-BANK-TYPE                 VALUE 'B'.
  7486         16  FILLER                       PIC X(05).
  7487
  7488     12  PY-RECORD-STATUS.
  7489         16  PY-CREDIT-SELECT-DT          PIC XX.
  7490         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7491         16  PY-BILLED-DATE               PIC XX.
  7492         16  PY-REPORTED-DT               PIC XX.
  7493         16  PY-PMT-APPLIED               PIC X.
  7494             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7495             88  PY-GA-PMT                    VALUE 'G'.
  7496             88  PY-OVWRITE-PMT               VALUE 'O'.
  7497             88  PY-NON-AR-PMT                VALUE 'N'.
  7498         16  FILLER                       PIC X(5).
  7499         16  PY-INPUT-DT                  PIC XX.
  7500         16  PY-CHECK-NUMBER              PIC X(6).
  7501         16  PY-VOID-SW                   PIC X.
  7502             88  PY-CHECK-VOIDED              VALUE 'V'.
  7503         16  PY-CHECK-ORIGIN-SW           PIC X.
  7504             88  PY-BILLING-CHECK             VALUE 'B'.
  7505             88  PY-REFUND-CHECK              VALUE 'R'.
  7506             88  PY-GA-CHECK                  VALUE 'G'.
  7507             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7508             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7509         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7510         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7511         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7512         16  PY-BILL-FLAG                 PIC X.
  7513             88  PY-BILLED                    VALUE 'B'.
  7514         16  PY-AR-FLAG                   PIC X.
  7515             88  PY-AR-CYCLE                  VALUE 'C'.
  7516             88  PY-AR-MONTH-END              VALUE 'M'.
  7517         16  PY-AR-DATE                   PIC XX.
  7518
  7519     12  PY-GL-CODES.
  7520         16  PY-GL-DB                     PIC X(14).
  7521         16  PY-GL-CR                     PIC X(14).
  7522         16  PY-GL-FLAG                   PIC X.
  7523         16  PY-GL-DATE                   PIC XX.
  7524
  7525     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7526     12  FILLER                           PIC X(3).
  7527******************************************************************
  7528*                                COPY ERCCNOT.
  7529******************************************************************
  7530*                                                                *
  7531*                            ERCCNOT                             *
  7532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7533*                            VMOD=2.003                          *
  7534*                                                                *
  7535*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7536*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 139
* EL6311.cbl
  7537*        FILE TYPE= VSAM,KSDS                                    *
  7538*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7539*                                                                *
  7540*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7541*                                                                *
  7542*        LOG = YES                                               *
  7543*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7544*                                                                *
  7545******************************************************************
  7546*                   C H A N G E   L O G
  7547*
  7548* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7549*-----------------------------------------------------------------
  7550*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7551* EFFECTIVE    NUMBER
  7552*-----------------------------------------------------------------
  7553* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7554******************************************************************
  7555
  7556 01  CERT-NOTE-FILE.
  7557     12  CZ-RECORD-ID                PIC  XX.
  7558         88  VALID-CZ-ID                  VALUE 'CZ'.
  7559
  7560     12  CZ-CONTROL-PRIMARY.
  7561         16  CZ-COMPANY-CD           PIC X.
  7562         16  CZ-CARRIER              PIC X.
  7563         16  CZ-GROUPING.
  7564             20 CZ-GROUPING-PREFIX   PIC XXX.
  7565             20 CZ-GROUPING-PRIME    PIC XXX.
  7566         16  CZ-STATE                PIC XX.
  7567         16  CZ-ACCOUNT.
  7568             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7569             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7570         16  CZ-CERT-EFF-DT          PIC XX.
  7571         16  CZ-CERT-NO.
  7572             20  CZ-CERT-PRIME       PIC X(10).
  7573             20  CZ-CERT-SFX         PIC X.
  7574         16  CZ-RECORD-TYPE          PIC X.
  7575             88  CERT-NOTE           VALUE '1'.
  7576             88  CLAIM-CERT-NOTE     VALUE '2'.
  7577         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7578
  7579     12  CZ-LAST-MAINT-DT            PIC XX.
  7580     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7581     12  CZ-LAST-MAINT-USER          PIC X(4).
  7582
  7583     12  CZ-NOTE-INFORMATION.
  7584         16  CZ-NOTE                 PIC X(63).
  7585         16  FILLER                  PIC X(39).
  7586******************************************************************
  7587*                                COPY ELCMSTR.
  7588******************************************************************
  7589*                                                                *
  7590*                            ELCMSTR.                            *
  7591*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7592*                            VMOD=2.012                          *
  7593*                                                                *
  7594*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 140
* EL6311.cbl
  7595*                                                                *
  7596*   FILE TYPE = VSAM,KSDS                                        *
  7597*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7598*                                                                *
  7599*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7600*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7601*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7602*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7603*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7604*                                                 RKP=75,LEN=21  *
  7605*                                                                *
  7606*   **** NOTE ****                                               *
  7607*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7608*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7609*                                                                *
  7610*   LOG = YES                                                    *
  7611*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7612******************************************************************
  7613*                   C H A N G E   L O G
  7614*
  7615* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7616*-----------------------------------------------------------------
  7617*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7618* EFFECTIVE    NUMBER
  7619*-----------------------------------------------------------------
  7620* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7621* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7622* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7623* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7624* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7625* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7626******************************************************************
  7627 01  CLAIM-MASTER.
  7628     12  CL-RECORD-ID                PIC XX.
  7629         88  VALID-CL-ID         VALUE 'CL'.
  7630
  7631     12  CL-CONTROL-PRIMARY.
  7632         16  CL-COMPANY-CD           PIC X.
  7633         16  CL-CARRIER              PIC X.
  7634         16  CL-CLAIM-NO             PIC X(7).
  7635         16  CL-CERT-NO.
  7636             20  CL-CERT-PRIME       PIC X(10).
  7637             20  CL-CERT-SFX         PIC X.
  7638
  7639     12  CL-CONTROL-BY-NAME.
  7640         16  CL-COMPANY-CD-A1        PIC X.
  7641         16  CL-INSURED-LAST-NAME    PIC X(15).
  7642         16  CL-INSURED-NAME.
  7643             20  CL-INSURED-1ST-NAME PIC X(12).
  7644             20  CL-INSURED-MID-INIT PIC X.
  7645
  7646     12  CL-CONTROL-BY-SSN.
  7647         16  CL-COMPANY-CD-A2        PIC X.
  7648         16  CL-SOC-SEC-NO.
  7649             20  CL-SSN-STATE        PIC XX.
  7650             20  CL-SSN-ACCOUNT      PIC X(6).
  7651             20  CL-SSN-LN3          PIC X(3).
  7652
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 141
* EL6311.cbl
  7653     12  CL-CONTROL-BY-CERT-NO.
  7654         16  CL-COMPANY-CD-A4        PIC X.
  7655         16  CL-CERT-NO-A4.
  7656             20  CL-CERT-A4-PRIME    PIC X(10).
  7657             20  CL-CERT-A4-SFX      PIC X.
  7658
  7659     12  CL-CONTROL-BY-CCN.
  7660         16  CL-COMPANY-CD-A5        PIC X.
  7661         16  CL-CCN-A5.
  7662             20  CL-CCN.
  7663                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7664                 24  CL-CCN-PRIME-A5 PIC X(12).
  7665             20  CL-CCN-FILLER-A5    PIC X(4).
  7666
  7667     12  CL-INSURED-PROFILE-DATA.
  7668         16  CL-INSURED-BIRTH-DT     PIC XX.
  7669         16  CL-INSURED-SEX-CD       PIC X.
  7670             88  INSURED-IS-MALE        VALUE 'M'.
  7671             88  INSURED-IS-FEMALE      VALUE 'F'.
  7672             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7673         16  CL-INSURED-OCC-CD       PIC X(6).
  7674         16  FILLER                  PIC X(5).
  7675
  7676     12  CL-PROCESSING-INFO.
  7677         16  CL-PROCESSOR-ID         PIC X(4).
  7678         16  CL-CLAIM-STATUS         PIC X.
  7679             88  CLAIM-IS-OPEN          VALUE 'O'.
  7680             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7681         16  CL-CLAIM-TYPE           PIC X.
  7682*            88  AH-CLAIM               VALUE 'A'.
  7683*            88  LIFE-CLAIM             VALUE 'L'.
  7684*            88  PROPERTY-CLAIM         VALUE 'P'.
  7685*            88  IUI-CLAIM              VALUE 'I'.
  7686*            88  GAP-CLAIM              VALUE 'G'.
  7687*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7688         16  CL-CLAIM-PREM-TYPE      PIC X.
  7689             88  SINGLE-PREMIUM         VALUE '1'.
  7690             88  O-B-COVERAGE           VALUE '2'.
  7691             88  OPEN-END-COVERAGE      VALUE '3'.
  7692         16  CL-INCURRED-DT          PIC XX.
  7693         16  CL-REPORTED-DT          PIC XX.
  7694         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7695         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7696         16  CL-LAST-PMT-DT          PIC XX.
  7697         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7698         16  CL-PAID-THRU-DT         PIC XX.
  7699         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7700         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7701         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7702         16  CL-PMT-CALC-METHOD      PIC X.
  7703             88  CL-360-DAY-YR          VALUE '1'.
  7704             88  CL-365-DAY-YR          VALUE '2'.
  7705             88  CL-FULL-MONTHS         VALUE '3'.
  7706         16  CL-CAUSE-CD             PIC X(6).
  7707
  7708         16  CL-PRIME-CERT-NO.
  7709             20  CL-PRIME-CERT-PRIME PIC X(10).
  7710             20  CL-PRIME-CERT-SFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 142
* EL6311.cbl
  7711
  7712         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7713             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7714             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7715
  7716         16  CL-MICROFILM-NO         PIC X(10).
  7717         16  FILLER REDEFINES CL-MICROFILM-NO.
  7718             20  CL-BENEFIT-PERIOD   PIC 99.
  7719             20  FILLER              PIC X(8).
  7720         16  CL-PROG-FORM-TYPE       PIC X.
  7721         16  CL-LAST-ADD-ON-DT       PIC XX.
  7722
  7723         16  CL-LAST-REOPEN-DT       PIC XX.
  7724         16  CL-LAST-CLOSE-DT        PIC XX.
  7725         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7726             88  FINAL-PAID             VALUE '1'.
  7727             88  CLAIM-DENIED           VALUE '2'.
  7728             88  AUTO-CLOSE             VALUE '3'.
  7729             88  MANUAL-CLOSE           VALUE '4'.
  7730             88  BENEFITS-CHANGED       VALUE 'C'.
  7731             88  SETUP-ERRORS           VALUE 'E'.
  7732         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7733         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7734         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7735             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7736         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7737         16  FILLER                  PIC X.
  7738
  7739     12  CL-CERTIFICATE-DATA.
  7740         16  CL-CERT-ORIGIN          PIC X.
  7741             88  CERT-WAS-ONLINE        VALUE '1'.
  7742             88  CERT-WAS-CREATED       VALUE '2'.
  7743             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7744         16  CL-CERT-KEY-DATA.
  7745             20  CL-CERT-CARRIER     PIC X.
  7746             20  CL-CERT-GROUPING    PIC X(6).
  7747             20  CL-CERT-STATE       PIC XX.
  7748             20  CL-CERT-ACCOUNT.
  7749                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7750                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7751             20  CL-CERT-EFF-DT      PIC XX.
  7752
  7753     12  CL-STATUS-CONTROLS.
  7754         16  CL-PRIORITY-CD          PIC X.
  7755             88  CONFIDENTIAL-DATA      VALUE '8'.
  7756             88  HIGHEST-PRIORITY       VALUE '9'.
  7757         16  CL-SUPV-ATTN-CD         PIC X.
  7758             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7759             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7760         16  CL-PURGED-DT            PIC XX.
  7761         16  CL-RESTORED-DT          PIC XX.
  7762         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7763         16  CL-NEXT-RESEND-DT       PIC XX.
  7764         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7765         16  CL-CRITICAL-PERIOD      PIC 99.
  7766*        16  FILLER                  PIC XX.
  7767         16  CL-LAST-MAINT-DT        PIC XX.
  7768         16  CL-LAST-MAINT-USER      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 143
* EL6311.cbl
  7769         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7770         16  CL-LAST-MAINT-TYPE      PIC X.
  7771             88  CLAIM-SET-UP           VALUE ' '.
  7772             88  PAYMENT-MADE           VALUE '1'.
  7773             88  LETTER-SENT            VALUE '2'.
  7774             88  MASTER-WAS-ALTERED     VALUE '3'.
  7775             88  MASTER-WAS-RESTORED    VALUE '4'.
  7776             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7777             88  FILE-CONVERTED         VALUE '6'.
  7778             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7779             88  ERROR-CORRECTION       VALUE 'E'.
  7780         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7781         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7782         16  CL-BENEFICIARY          PIC X(10).
  7783         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7784         16  CL-DENIAL-TYPE          PIC X.
  7785             88  CL-TYPE-DENIAL          VALUE '1'.
  7786             88  CL-TYPE-RESCISSION      VALUE '2'.
  7787             88  CL-TYPE-REFORMATION     VALUE '3'.
  7788             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7789             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7790         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7791         16  filler                  pic x(3).
  7792*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7793*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7794*        16  CL-RTW-DT               PIC XX.
  7795
  7796     12  CL-TRAILER-CONTROLS.
  7797         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7798             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7799             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7800             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7801         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7802         16  FILLER                  PIC XX.
  7803         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7804         16  CL-ADDRESS-TRAILER-CNT.
  7805             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7806                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7807             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7808                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7809             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7810                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7811             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7812                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7813             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7814                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7815             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7816                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7817             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7818                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7819
  7820     12  CL-CV-REFERENCE-NO.
  7821         16  CL-CV-REFNO-PRIME       PIC X(18).
  7822         16  CL-CV-REFNO-SFX         PIC XX.
  7823
  7824     12  CL-FILE-LOCATION            PIC X(4).
  7825
  7826     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 144
* EL6311.cbl
  7827         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7828             88  NO-FATAL-ERRORS        VALUE ZERO.
  7829         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7830             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7831
  7832     12  CL-PRODUCT-CD               PIC X.
  7833
  7834     12  CL-CURRENT-KEY-DATA.
  7835         16  CL-CURRENT-CARRIER      PIC X.
  7836         16  CL-CURRENT-GROUPING     PIC X(6).
  7837         16  CL-CURRENT-STATE        PIC XX.
  7838         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7839
  7840     12  CL-ASSOCIATES               PIC X.
  7841         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7842         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7843         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7844         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7845
  7846     12  CL-ACTIVITY-CODE            PIC 99.
  7847     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7848     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7849
  7850     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7851     12  CL-LAG-REPORT-CODE          PIC 9.
  7852     12  CL-LOAN-TYPE                PIC XX.
  7853     12  CL-LEGAL-STATE              PIC XX.
  7854
  7855     12  CL-YESNOSW                  PIC X.
  7856     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7857         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7858         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7859         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7860     12  cl-insured-type             pic x.
  7861         88  cl-claim-on-primary         value 'P'.
  7862         88  cl-claim-on-co-borrower     value 'C'.
  7863     12  cl-benefit-expiration-dt    PIC XX.
  7864*                                COPY ERCENDT.
  7865******************************************************************
  7866*                                                                *
  7867*                                                                *
  7868*                            ERCENDT.                            *
  7869*                            VMOD=2.001                          *
  7870*                                                                *
  7871*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7872*                                                                *
  7873*   FILE TYPE = VSAM,KSDS                                        *
  7874*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7875*                                                                *
  7876*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7877*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7878*                                                                *
  7879*   LOG = NO                                                     *
  7880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7881******************************************************************
  7882*-----------------------------------------------------------------
  7883*                   C H A N G E   L O G
  7884*
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 145
* EL6311.cbl
  7885* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7886*-----------------------------------------------------------------
  7887*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7888* EFFECTIVE    NUMBER
  7889*-----------------------------------------------------------------
  7890* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7891*                                WITH OPEN CLAIMS
  7892* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7893* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7894* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7895* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7896*-----------------------------------------------------------------
  7897 01  ENDORSEMENT-RECORD.
  7898     12  EN-RECORD-ID                PIC XX.
  7899         88  VALID-EN-ID                VALUE 'EN'.
  7900     12  EN-CONTROL-PRIMARY.
  7901         16  EN-COMPANY-CD           PIC X.
  7902         16  EN-CARRIER              PIC X.
  7903         16  EN-GROUPING             PIC X(6).
  7904         16  EN-STATE                PIC XX.
  7905         16  EN-ACCOUNT              PIC X(10).
  7906         16  EN-CERT-EFF-DT          PIC XX.
  7907         16  EN-CERT-NO.
  7908             20  EN-CERT-PRIME       PIC X(10).
  7909             20  EN-CERT-SFX         PIC X.
  7910         16  EN-REC-TYPE             PIC X.
  7911             88  EN-ISSUE               VALUE 'I'.
  7912             88  EN-CANCELLATION        VALUE 'C'.
  7913         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7914     12  EN-CONTROL-BY-ARCH-NO.
  7915         16  EN-COMPANY-CD-A1              PIC X.
  7916         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7917     12  EN-LAST-MAINT-DT            PIC XX.
  7918     12  EN-LAST-MAINT-BY            PIC X(4).
  7919     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7920     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7921     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7922         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7923         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7924         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7925         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7926         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7927         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7928         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7929         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7930         16  EN-LF-ORIG-BENCD        PIC XX.
  7931         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7932         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7933         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7934         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7935         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7936         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7937*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7938         16  EN-ORIG-CRED-BENE       PIC X(25).
  7939         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7940         16  FILLER                  PIC X.
  7941         16  EN-AH-ORIG-BENCD        PIC XX.
  7942         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 146
* EL6311.cbl
  7943         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7944         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7945         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7946*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7947*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7948         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7949         16  F                       PIC X(09).
  7950         16  EN-AH-ORIG-CP           PIC 99.
  7951         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7952         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7953         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7954         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7955         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7956         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7957         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7958         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7959         16  EN-LF-NEW-BENCD         PIC XX.
  7960         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7961         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7962         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7963         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7964         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7965         16  EN-LF-NEW-EXP-DT        PIC XX.
  7966         16  EN-NEW-CRED-BENE        PIC X(25).
  7967         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7968         16  FILLER                  PIC X.
  7969         16  EN-AH-NEW-BENCD         PIC XX.
  7970         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7971         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7972         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7973         16  EN-AH-NEW-EXP-DT        PIC XX.
  7974*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7975*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7976*        16  F                       PIC X(12).
  7977         16  EN-AH-NEW-CP            PIC 99.
  7978         16  EN-SIG-SW               PIC X.
  7979         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7980         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7981         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7982         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7983         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7984         16  FILLER                  PIC X(33).
  7985     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7986         16  EN-LF-ORIG-REF-DT       PIC XX.
  7987         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7988         16  EN-AH-ORIG-REF-DT       PIC XX.
  7989         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7990         16  EN-LF-NEW-REF-DT        PIC XX.
  7991         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7992         16  EN-AH-NEW-REF-DT        PIC XX.
  7993         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7994         16  EN-FLAG-CERT            PIC X.
  7995         16  EN-INS-LAST-NAME        PIC X(15).
  7996         16  EN-INS-FIRST-NAME       PIC X(10).
  7997         16  EN-INS-MIDDLE-INIT      PIC X.
  7998         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7999         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8000         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 147
* EL6311.cbl
  8001         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8002         16  FILLER                  PIC X(262).
  8003     12  EN-MONEY-SW             PIC X.
  8004     12  EN-HEALTH-APP           PIC X.
  8005     12  EN-VOUCHER-SW           PIC X.
  8006     12  EN-PAYEE                PIC X(14).
  8007     12  EN-INPUT-DT             PIC XX.
  8008     12  EN-PROCESS-DT           PIC XX.
  8009     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8010     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8011     12  EN-REASON-CODES.
  8012         16  F OCCURS 12.
  8013             20  EN-REASON-CODE  PIC X(4).
  8014     12  EN-TEMPLATE-USED        PIC X(8).
  8015     12  EN-DOCU-TYPE            PIC X.
  8016         88  EN-VERI-DOCU          VALUE 'V'.
  8017         88  EN-GCE-DOCU           VALUE 'G'.
  8018         88  EN-CANC-DOCU          VALUE 'C'.
  8019     12  EN-COMMENTS1            PIC X(13).
  8020     12  EN-COMMENTS2            PIC X(70).
  8021     12  EN-COMM-CHGBK           PIC X.
  8022         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8023         88  EN-CHG-ACCT           VALUE 'Y'.
  8024     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8025     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8026     12  EN-BATCH-NUMBER         PIC X(6).
  8027     12  EN-ACCT-SUMM            PIC X.
  8028     12  EN-CSO-SUMM             PIC X.
  8029     12  en-check-type           pic x.
  8030     12  FILLER                  PIC X(12).
  8031******************************************************************
  8032*                                COPY ELCCRTT.
  8033******************************************************************
  8034*                                                                *
  8035*                            ELCCRTT.                            *
  8036*                                                                *
  8037*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8038*                                                                *
  8039*   FILE TYPE = VSAM,KSDS                                        *
  8040*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8041*                                                                *
  8042*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8043*                                                                *
  8044*   LOG = YES                                                    *
  8045*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8046******************************************************************
  8047*                   C H A N G E   L O G
  8048*
  8049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8050*-----------------------------------------------------------------
  8051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8052* EFFECTIVE    NUMBER
  8053*-----------------------------------------------------------------
  8054* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8055* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8056* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8057* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8058* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 148
* EL6311.cbl
  8059* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8060* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8061* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8062* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8063* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8064******************************************************************
  8065
  8066 01  CERTIFICATE-TRAILERS.
  8067     12  CS-RECORD-ID                      PIC XX.
  8068         88  VALID-CS-ID                      VALUE 'CS'.
  8069
  8070     12  CS-CONTROL-PRIMARY.
  8071         16  CS-COMPANY-CD                 PIC X.
  8072         16  CS-CARRIER                    PIC X.
  8073         16  CS-GROUPING                   PIC X(6).
  8074         16  CS-STATE                      PIC XX.
  8075         16  CS-ACCOUNT                    PIC X(10).
  8076         16  CS-CERT-EFF-DT                PIC XX.
  8077         16  CS-CERT-NO.
  8078             20  CS-CERT-PRIME             PIC X(10).
  8079             20  CS-CERT-SFX               PIC X.
  8080         16  CS-TRAILER-TYPE               PIC X.
  8081             88  COMM-TRLR           VALUE 'A'.
  8082             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8083             88  CERT-DATA-TRLR      VALUE 'C'.
  8084
  8085     12  CS-DATA-AREA                      PIC X(516).
  8086
  8087     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8088         16  CS-BANK-COMMISSION-AREA.
  8089             20  CS-BANK-COMMS       OCCURS 10.
  8090                 24  CS-AGT                PIC X(10).
  8091                 24  CS-COM-TYP            PIC X.
  8092                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8093                 24  CS-RECALC-LV-INDIC    PIC X.
  8094                 24  FILLER                PIC X(10).
  8095         16  FILLER                        PIC X(256).
  8096
  8097     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8098****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8099         16  CS-MB-CLAIM-DATA OCCURS 24.
  8100             20  CS-CLAIM-NO               PIC X(7).
  8101             20  CS-CLAIM-TYPE             PIC X.
  8102                 88  CS-AH-CLM               VALUE 'A'.
  8103                 88  CS-IU-CLM               VALUE 'I'.
  8104                 88  CS-GP-CLM               VALUE 'G'.
  8105                 88  CS-LF-CLM               VALUE 'L'.
  8106                 88  CS-PR-CLM               VALUE 'P'.
  8107                 88  CS-FL-CLM               VALUE 'F'.
  8108             20  CS-INSURED-TYPE           PIC X.
  8109                 88  CS-PRIM-INSURED          VALUE 'P'.
  8110                 88  CS-CO-BORROWER           VALUE 'C'.
  8111             20  CS-BENEFIT-PERIOD         PIC 99.
  8112             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8113             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8114             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8115         16  FILLER                        PIC X(12).
  8116     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 149
* EL6311.cbl
  8117         16  CS-VIN-NUMBER                 PIC X(17).
  8118         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8119         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8120         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8121         16  cs-agent-name.
  8122             20  cs-agent-fname            pic x(20).
  8123             20  cs-agent-mi               pic x.
  8124             20  cs-agent-lname            pic x(25).
  8125         16  cs-license-no                 pic x(15).
  8126         16  cs-npn-number                 pic x(10).
  8127         16  cs-agent-edit-status          pic x.
  8128             88  cs-ae-refer-to-manager      value 'M'.
  8129             88  cs-ae-cover-sheet           value 'C'.
  8130             88  cs-ae-sig-form              value 'S'.
  8131             88  cs-ae-verified              value 'V'.
  8132             88  cs-unidentified-signature   value 'U'.
  8133             88  cs-cert-returned            value 'R'.
  8134             88  cs-accept-no-commission     value 'N'.
  8135         16  cs-year                       pic 9999.
  8136         16  cs-make                       pic x(20).
  8137         16  cs-model                      pic x(20).
  8138         16  cs-future                     pic x(20).
  8139         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8140         16  cs-claim-verification-status  pic x.
  8141             88  cs-clm-ver-eligible         value 'A'.
  8142             88  cs-clm-ver-partial-elig     value 'B'.
  8143             88  cs-clm-ver-not-eligible     value 'C'.
  8144             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8145             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8146             88  cs-clm-ver-ND-CERT          value 'F'.
  8147             88  cs-clm-ver-spec-other       value 'G'.
  8148             88  cs-clam-ver-pratial-corrected
  8149                                             value 'H'.
  8150             88  cs-clm-ver-no-matches       value 'I'.
  8151             88  cs-clm-ver-not-elig-corrected
  8152                                             value 'J'.
  8153             88  cs-clm-ver-needs-review     value 'R'.
  8154             88  cs-clm-ver-sent-to-claims   value 'W'.
  8155         16  FILLER                        PIC X(355). *> was 420
  8156*        16  FILLER                        PIC X(496).
  8157*                                COPY ERCCHEK.
  8158******************************************************************
  8159*                                                                *
  8160*                                                                *
  8161*                            ERCCHEK                             *
  8162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8163*                            VMOD=2.008                          *
  8164*                                                                *
  8165*   FILE DESCRIPTION = CHECK RECORDS                             *
  8166*                                                                *
  8167*   FILE TYPE = VSAM,KSDS                                        *
  8168*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8169*                                                                *
  8170*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8171*       ALTERNATE INDEX = NONE                                   *
  8172*                                                                *
  8173*   LOG = YES                                                    *
  8174*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 150
* EL6311.cbl
  8175******************************************************************
  8176*                   C H A N G E   L O G
  8177*
  8178* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8179*-----------------------------------------------------------------
  8180*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8181* EFFECTIVE    NUMBER
  8182*-----------------------------------------------------------------
  8183* 021414    2003053000001  PEMA  changes for auto chk request
  8184******************************************************************
  8185 01  CHECK-RECORDS.
  8186     12  CH-RECORD-ID                      PIC XX.
  8187         88  VALID-CH-ID                      VALUE 'CH'.
  8188
  8189     12  CH-CONTROL-PRIMARY.
  8190         16  CH-COMPANY-CD                 PIC X.
  8191         16  CH-CARRIER                    PIC X.
  8192         16  CH-GROUPING                   PIC X(6).
  8193         16  CH-STATE                      PIC XX.
  8194         16  CH-ACCOUNT                    PIC X(10).
  8195         16  CH-CERT-EFF-DT                PIC XX.
  8196         16  CH-CERT-NO.
  8197             20  CH-CERT-PRIME             PIC X(10).
  8198             20  CH-CERT-SFX               PIC X.
  8199         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8200
  8201     12  CH-RECORDED-DT                    PIC XX.
  8202     12  CH-RECORDED-BY                    PIC X(4).
  8203     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8204
  8205     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8206     12  CH-CHECK-NO                       PIC X(7).
  8207     12  CH-REASON-FOR-CHECK               PIC X(25).
  8208     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8209     12  FILLER                            PIC X.
  8210
  8211     12  CH-PAYEE-INFO.
  8212         16  CH-PAYEE-NAME-1               PIC X(30).
  8213         16  CH-PAYEE-NAME-2               PIC X(30).
  8214         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8215         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8216         16  CH-PAYEE-CITY-ST.
  8217             20  CH-PAYEE-CITY             PIC X(28).
  8218             20  CH-PAYEE-STATE            PIC XX.
  8219         16  CH-PAYEE-ZIP-CODE.
  8220             20  CH-PAYEE-ZIP.
  8221                 24  CH-ZIP-PRI-1ST        PIC X.
  8222                     88  CH-CANADIAN-POST-CODE
  8223                                           VALUES 'A' THRU 'Z'.
  8224                 24  FILLER                PIC X(4).
  8225             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8226         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8227             20  CH-CAN-POSTAL-1           PIC XXX.
  8228             20  CH-CAN-POSTAL-2           PIC XXX.
  8229             20  FILLER                    PIC XXX.
  8230
  8231     12  CH-CHECK-STUB-TEXT.
  8232         16  CH-STUB-LINE-1                PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 151
* EL6311.cbl
  8233         16  CH-TEXT-LINE-1                PIC X(50).
  8234         16  CH-TEXT-LINE-2                PIC X(50).
  8235         16  CH-TEXT-LINE-3                PIC X(40).
  8236     12  CH-RETURN-TO                      PIC X(30).
  8237
  8238     12  CH-COMPENSATION-CONTROL.
  8239         16  CH-COMP-CARRIER               PIC X.
  8240         16  CH-COMP-GROUPING              PIC X(6).
  8241         16  CH-COMP-FIN-RESP              PIC X(10).
  8242         16  CH-COMP-ACCOUNT               PIC X(10).
  8243
  8244     12  CH-CREDIT-SELECT-DT               PIC XX.
  8245     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8246     12  CH-PAYEE-CODE                     PIC X(6).
  8247
  8248     12  CH-VOID-DATA.
  8249         20  CH-VOID-DT                    PIC XX.
  8250         20  CH-VOID-BY                    PIC X(4).
  8251         20  CH-VOID-REASON                PIC X(25).
  8252
  8253     12  CH-APPROVAL-DATA.
  8254         20  CH-APPROVAL-DT                PIC XX.
  8255         20  CH-APPROVAL-STATUS            PIC X.
  8256             88  CH-IN-LIMBO                  VALUE ' '.
  8257             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8258             88  CH-APPROVED                  VALUE 'A'.
  8259             88  CH-DENIED                    VALUE 'D'.
  8260         20  CH-APPROVED-BY                PIC XXXX.
  8261     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8262             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8263     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8264
  8265     12  ch-released-dt                    pic xx.
  8266     12  ch-check-cashed-dt                pic xx.
  8267     12  FILLER                            PIC X.
  8268*    12  CH-CHECK-REFERENCE                PIC X(12).
  8269     12  CH-CHECK-ORIGIN-SW                PIC X.
  8270             88  CH-REFUND-CHECK              VALUE 'R'.
  8271             88  CH-MAINT-CHECK               VALUE 'M'.
  8272
  8273     12  CH-CANC-DT                        PIC XX.
  8274     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8275     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8276
  8277     12  CH-INSURED-NAME                   PIC X(28).
  8278
  8279     12  ch-released-by                    pic x(4).
  8280     12  ch-csr                            pic x(4).
  8281     12  ch-deduct-commission              pic x.
  8282         88  ch-deduct-comm                  value 'Y'.
  8283         88  ch-do-not-deduct-comm           value 'N'.
  8284
  8285     12  FILLER                            PIC X(11).
  8286*    12  CH-LETTER-TABLE.
  8287*        16  CH-LETTERS OCCURS 3 TIMES
  8288*                       INDEXED BY CH-LT-NDX
  8289*                                          PIC X(04).
  8290
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 152
* EL6311.cbl
  8291     12  FILLER                            PIC X(07).
  8292
  8293 01  var                         pic x(30).
  8294 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8295                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8296                          PENDING-MAILING-DATA MAILING-DATA
  8297                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8298                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8299                          CLAIM-MASTER ENDORSEMENT-RECORD
  8300                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8301                          VAR.
  8302 0000-DFHEXIT SECTION.
  8303     MOVE '9#                    $   ' TO DFHEIV0.
  8304     MOVE 'EL6311' TO DFHEIV1.
  8305     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8306
  8307     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8308     MOVE EIBTRMID               TO QID-TERM.
  8309     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8310     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8311     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8312     MOVE 2                      TO EMI-SWITCH2.
  8313
  8314     move spaces to ws-kix-myenv
  8315     set P to address of KIXSYS
  8316     CALL "getenv" using by value P returning var-ptr
  8317     if var-ptr = null then
  8318        display ' kixsys not set '
  8319     else
  8320        set address of var to var-ptr
  8321        move 0 to env-var-len
  8322        inspect var tallying env-var-len
  8323          for characters before X'00'
  8324        unstring var (1:env-var-len) delimited by '/'
  8325           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8326              WS-KIX-SYS
  8327        end-unstring
  8328     end-if
  8329     perform varying a1 from +1 by +1 until a1 > +10
  8330        if ws-kix-myenv (a1:1) = low-values or high-values
  8331           display ' found low or hi val '
  8332           move spaces to ws-kix-myenv (a1:1)
  8333        end-if
  8334     end-perform
  8335*    display ' env *' ws-kix-myenv '*'
  8336     IF EIBCALEN = 0
  8337         GO TO 8800-UNAUTHORIZED-ACCESS.
  8338
  8339     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8340     MOVE '5'                   TO DC-OPTION-CODE.
  8341     PERFORM 9700-DATE-LINK.
  8342     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8343     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8344
  8345     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8346     MOVE SPACE                  TO DC-OPTION-CODE.
  8347     PERFORM 9700-DATE-LINK.
  8348     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 153
* EL6311.cbl
  8349     MOVE LOW-VALUES             TO EL631BI.
  8350
  8351
  8352* EXEC CICS HANDLE CONDITION
  8353*        PGMIDERR  (9600-PGMID-ERROR)
  8354*        ERROR     (9990-ABEND)
  8355*        INVREQ    (9990-ABEND)
  8356*        QIDERR    (0010-MAIN-LOGIC)
  8357*    END-EXEC.
  8358*    MOVE '"$L.8N                ! " #00008347' TO DFHEIV0
  8359     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8361     MOVE X'2220233030303038333437' TO DFHEIV0(25:11)
  8362     CALL 'kxdfhei1' USING DFHEIV0
  8363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8364
  8365
  8366     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8367         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8368             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8369             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8370             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8371             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8372             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8373             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8374             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8375             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8376
  8377             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8378                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8379
  8380             ELSE
  8381                 NEXT SENTENCE
  8382
  8383         ELSE
  8384             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8385             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8386             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8387             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8388             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8389             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8390             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8391             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8392             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8393             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8394             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8395             GO TO 3900-RE-DISPLAY-RECORD
  8396     ELSE
  8397         GO TO 0020-MAIN-LOGIC.
  8398
  8399 0010-MAIN-LOGIC.
  8400     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8401                                    WS-FIRST-ENTRY-SW.
  8402
  8403     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8404
  8405     MOVE LOW-VALUES             TO EC-NEW-CERT
  8406                                    EC-NEW-STATE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 154
* EL6311.cbl
  8407
  8408     IF PI-DISPLAY-ORIGINAL-BATCH
  8409         NEXT SENTENCE
  8410     ELSE
  8411         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8412             GO TO 5000-BROWSE-BATCH-HEADERS.
  8413
  8414     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8415         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8416
  8417     IF PI-CSR-BROWSE
  8418        GO TO 4200-BROWSE-CSR-FORWARD.
  8419
  8420     IF PI-FILE-BROWSE
  8421         GO TO 4300-BROWSE-FILE-FORWARD.
  8422
  8423     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8424
  8425 0020-MAIN-LOGIC.
  8426     IF EIBAID = DFHCLEAR
  8427         GO TO 9400-CLEAR.
  8428
  8429     MOVE LOW-VALUES             TO EC-NEW-CERT
  8430                                    EC-NEW-STATE.
  8431
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 155
* EL6311.cbl
  8433
  8434******************************************************************
  8435*                                                                *
  8436*              R E C E I V E   M A P                             *
  8437*                                                                *
  8438******************************************************************
  8439
  8440 0200-RECEIVE.
  8441     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8442         MOVE ER-0008            TO EMI-ERROR
  8443         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8444         IF PI-MAP-NAME = EL631B
  8445             MOVE -1                 TO BMAINTL
  8446             GO TO 8200-SEND-DATAONLY
  8447         ELSE
  8448             IF PI-MAP-NAME = EL631C
  8449                 MOVE -1                 TO CMAINTL
  8450                 GO TO 8200-SEND-DATAONLY
  8451             ELSE
  8452                 IF PI-MAP-NAME = EL631D
  8453                     MOVE -1                 TO DPFENTRL
  8454                     GO TO 8200-SEND-DATAONLY.
  8455
  8456
  8457* EXEC CICS RECEIVE
  8458*        MAP      (PI-MAP-NAME)
  8459*        MAPSET   (MAPSET-EL6311S)
  8460*        INTO     (EL631BI)
  8461*    END-EXEC.
  8462     MOVE LENGTH OF
  8463      EL631BI
  8464       TO DFHEIV11
  8465*    MOVE '8"T I  L              ''   #00008444' TO DFHEIV0
  8466     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8467     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8468     MOVE X'2020233030303038343434' TO DFHEIV0(25:11)
  8469     CALL 'kxdfhei1' USING DFHEIV0,
  8470           PI-MAP-NAME,
  8471           EL631BI,
  8472           DFHEIV11,
  8473           MAPSET-EL6311S,
  8474           DFHEIV99,
  8475           DFHEIV99
  8476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8477
  8478
  8479******************************************************************
  8480*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8481******************************************************************
  8482
  8483     IF BTYPE-LEN (1) EQUAL +3
  8484        IF BTYPE (1) EQUAL ALL ' '
  8485            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8486
  8487     IF BTYPE-LEN (2) EQUAL +3
  8488        IF BTYPE (2) EQUAL ALL ' '
  8489            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8490
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 156
* EL6311.cbl
  8491     INSPECT EL631BI CONVERTING '_' TO ' '.
  8492
  8493     IF PI-MAP-NAME = EL631B
  8494         IF BPFENTRL GREATER THAN ZEROS
  8495             IF EIBAID NOT = DFHENTER
  8496                 MOVE ER-0004       TO EMI-ERROR
  8497                 MOVE -1            TO BPFENTRL
  8498                 MOVE AL-UNBOF      TO BPFENTRA
  8499                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8500                 GO TO 8200-SEND-DATAONLY
  8501             ELSE
  8502                 IF BPFENTRI NUMERIC AND
  8503                   (BPFENTRI GREATER 0 AND LESS 25)
  8504                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8505                 ELSE
  8506                     MOVE ER-0029  TO EMI-ERROR
  8507                     MOVE AL-UNBON TO BPFENTRA
  8508                     MOVE -1       TO BPFENTRL
  8509                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8510                     GO TO 8200-SEND-DATAONLY
  8511         ELSE
  8512             NEXT SENTENCE
  8513     ELSE
  8514         IF PI-MAP-NAME = EL631C
  8515            IF CPFENTRL GREATER THAN ZEROS
  8516                IF EIBAID NOT = DFHENTER
  8517                 MOVE ER-0004         TO EMI-ERROR
  8518                 MOVE -1              TO CPFENTRL
  8519                 MOVE AL-UNBOF        TO CPFENTRA
  8520                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8521                 GO TO 8200-SEND-DATAONLY
  8522             ELSE
  8523                 IF CPFENTRI NUMERIC AND
  8524                   (CPFENTRI GREATER 0 AND LESS 25)
  8525                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8526                 ELSE
  8527                     MOVE ER-0029      TO EMI-ERROR
  8528                     MOVE AL-UNBON     TO CPFENTRA
  8529                     MOVE -1           TO CPFENTRL
  8530                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8531                     GO TO 8200-SEND-DATAONLY
  8532         ELSE
  8533             NEXT SENTENCE
  8534     ELSE
  8535     IF PI-MAP-NAME = EL631D
  8536         IF DPFENTRL GREATER THAN ZEROS
  8537             IF EIBAID NOT = DFHENTER
  8538                 MOVE ER-0004         TO EMI-ERROR
  8539                 MOVE -1              TO DPFENTRL
  8540                 MOVE AL-UNBOF        TO DPFENTRA
  8541                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8542                 GO TO 8200-SEND-DATAONLY
  8543             ELSE
  8544                 IF DPFENTRI NUMERIC AND
  8545                   (DPFENTRI GREATER 0 AND LESS 25)
  8546                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8547                 ELSE
  8548                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 157
* EL6311.cbl
  8549                     MOVE AL-UNBON     TO DPFENTRA
  8550                     MOVE -1           TO DPFENTRL
  8551                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8552                     GO TO 8200-SEND-DATAONLY.
  8553
  8554     IF EIBAID = DFHPF23
  8555         GO TO 8810-PF23.
  8556
  8557     IF EIBAID = DFHPF24
  8558         GO TO 9200-RETURN-MAIN-MENU.
  8559
  8560     IF EIBAID = DFHPF12
  8561         GO TO 9500-PF12.
  8562
  8563     IF PI-MAP-NAME = EL631B
  8564        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8565
  8566     IF PI-MAP-NAME = EL631C
  8567        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8568
  8569     IF PI-MAP-NAME = EL631D
  8570        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8571
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 158
* EL6311.cbl
  8573
  8574******************************************************************
  8575*                                                                *
  8576*      ISSUE SCREEN PF KEY CHECKING                              *
  8577*                                                                *
  8578******************************************************************
  8579
  8580******************************************************************
  8581*                                                                *
  8582*      PF KEY FUNCTIONS:                                         *
  8583*                                                                *
  8584*      PF1  = BROWSE FORWARD                                     *
  8585*      PF2  = BROWSE BACKWARD                                    *
  8586*      PF3  = CERTIFICATE LOOKUP                                 *
  8587*      PF4  = DISPLAY BATCH HEADER                               *
  8588*      PF5  = ADD ISSUE  SCREEN                                  *
  8589*      PF6  = ADD CANCEL SCREEN                                  *
  8590*      PF7  = CERTIFICATE DISPLAY                                *
  8591*      PF8  = CERTIFICATE NOTES                                  *
  8592*      PF9  = EDIT CONTROL                                       *
  8593*      PF10 = DISPLAY LETTER SCREEN                              *
  8594*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8595*      PF12 = HELP SCREEN                                        *
  8596*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8597*      PF14 = ACCOUNT MASTER                                     *
  8598*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8599*      PF16 = DISPLAY LETTER REVIEW                              *
  8600*                                                                *
  8601******************************************************************
  8602
  8603 0300-CHECK-ISSUE-PF-KEYS.
  8604     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8605        MOVE ER-2337            TO EMI-ERROR
  8606        MOVE -1                  TO BMAINTL
  8607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8608        GO TO 8200-SEND-DATAONLY.
  8609
  8610     IF EIBAID = DFHPF1
  8611        MOVE '0'                TO PI-EDIT-SW
  8612        IF PI-PRIMARY-BROWSE
  8613           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8614        ELSE
  8615           IF PI-PRIMARY-WITH-SELECT
  8616              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8617           ELSE
  8618              IF PI-FILE-BROWSE
  8619                 GO TO 4300-BROWSE-FILE-FORWARD
  8620              ELSE
  8621                 IF PI-CSR-BROWSE
  8622                    GO TO 4200-BROWSE-CSR-FORWARD
  8623                 ELSE
  8624                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8625
  8626     IF EIBAID = DFHPF2
  8627        MOVE '0'                TO PI-EDIT-SW
  8628        IF PI-PRIMARY-BROWSE
  8629           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8630        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 159
* EL6311.cbl
  8631           IF PI-PRIMARY-WITH-SELECT
  8632              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8633           ELSE
  8634              IF PI-FILE-BROWSE
  8635                 GO TO 4800-BROWSE-FILE-BACKWARD
  8636              ELSE
  8637                 IF PI-CSR-BROWSE
  8638                    GO TO 4900-BROWSE-CSR-BACKWARD
  8639                 ELSE
  8640                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8641
  8642     IF EIBAID = DFHPF3
  8643        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8644        MOVE XCTL-EL127         TO PGM-NAME
  8645        GO TO 9300-XCTL.
  8646
  8647     IF (EIBAID = DFHPF15 OR DFHPF6)
  8648        AND (CSR-EDIT-SESSION)
  8649*       AND (FATAL-OR-UNFORCED)
  8650*       AND (FATAL-ERRORS)
  8651        and (pi-6311-fatal-ctr <> +0)
  8652        MOVE ER-1819             TO EMI-ERROR
  8653        MOVE -1                  TO BMAINTL
  8654        MOVE AL-UANON            TO BMAINTA
  8655        PERFORM 9900-ERROR-FORMAT
  8656                                 THRU 9900-EXIT
  8657        GO TO 8200-SEND-DATAONLY
  8658     END-IF
  8659     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8660      OR (EIBAID = DFHPF10)
  8661        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8662        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8663        IF (RESP-NORMAL)
  8664           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8665              AM-CONTROL-PRIMARY (1:20))
  8666            IF AM-NAME NOT GREATER THAN SPACES OR
  8667               AM-ADDRS NOT GREATER THAN SPACES  OR
  8668               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8669               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8670               AM-ZIP NOT GREATER THAN SPACES
  8671               MOVE ER-3834             TO EMI-ERROR
  8672               MOVE -1                  TO BMAINTL
  8673               MOVE AL-UANON            TO BMAINTA
  8674               PERFORM 9900-ERROR-FORMAT
  8675                                 THRU 9900-EXIT
  8676               GO TO 8200-SEND-DATAONLY
  8677            END-IF
  8678        ELSE
  8679           MOVE ER-1609             TO EMI-ERROR
  8680           MOVE -1                  TO BMAINTL
  8681           MOVE AL-UANON            TO BMAINTA
  8682           PERFORM 9900-ERROR-FORMAT
  8683                                THRU 9900-EXIT
  8684           GO TO 8200-SEND-DATAONLY
  8685        END-IF
  8686
  8687        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8688        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 160
* EL6311.cbl
  8689        IF (ERMAIL-FOUND)
  8690            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8691               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8692               MA-CITY NOT GREATER THAN SPACES OR
  8693               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8694               MA-ZIP-CODE NOT GREATER THAN SPACES
  8695               MOVE ER-3835             TO EMI-ERROR
  8696               MOVE -1                  TO BMAINTL
  8697               MOVE AL-UANON            TO BMAINTA
  8698               PERFORM 9900-ERROR-FORMAT
  8699                                 THRU 9900-EXIT
  8700               GO TO 8200-SEND-DATAONLY
  8701            END-IF
  8702        ELSE
  8703           MOVE ER-3000             TO EMI-ERROR
  8704           MOVE -1                  TO BMAINTL
  8705           MOVE AL-UANON            TO BMAINTA
  8706           PERFORM 9900-ERROR-FORMAT
  8707                                THRU 9900-EXIT
  8708           GO TO 8200-SEND-DATAONLY
  8709        END-IF
  8710
  8711     END-IF
  8712     IF (EIBAID = DFHPF15)
  8713        AND (CSR-EDIT-SESSION)
  8714        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8715        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8716        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8717        MOVE PI-SV-STATE         TO PI-STATE
  8718        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8719        MOVE BCERTNOI            TO PI-CERT-PRIME
  8720        MOVE BSUFIXI             TO PI-CERT-SFX
  8721        MOVE BEFFDTI             TO DEEDIT-FIELD
  8722        PERFORM 8600-DEEDIT
  8723        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8724        MOVE '4'                 TO DC-OPTION-CODE
  8725        PERFORM 9700-DATE-LINK
  8726        IF DATE-CONVERSION-ERROR
  8727           MOVE ER-0348          TO EMI-ERROR
  8728           MOVE -1               TO BEFFDTL
  8729           MOVE AL-UABON         TO BEFFDTA
  8730           PERFORM 9900-ERROR-FORMAT
  8731                                 THRU 9900-EXIT
  8732           GO TO 8200-SEND-DATAONLY
  8733        ELSE
  8734           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8735           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8736           MOVE XCTL-EL6315      TO PGM-NAME
  8737           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8738           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8739           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8740           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8741           GO TO 9300-XCTL
  8742        END-IF
  8743     END-IF
  8744
  8745     IF EIBAID = DFHPF4
  8746        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 161
* EL6311.cbl
  8747        IF PI-DISPLAY-ORIGINAL-BATCH
  8748           NEXT SENTENCE
  8749        ELSE
  8750           GO TO 7200-DISPLAY-BATCHES.
  8751
  8752     IF EIBAID = DFHPF5
  8753        MOVE ER-0029                TO EMI-ERROR
  8754        MOVE -1                     TO BPFENTRL
  8755        MOVE AL-UNBON               TO BPFENTRA
  8756        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8757        GO TO 8200-SEND-DATAONLY.
  8758*        MOVE '0'                TO PI-EDIT-SW
  8759*        IF PI-DISPLAY-ORIGINAL-BATCH
  8760*           NEXT SENTENCE
  8761*        ELSE
  8762*           MOVE EL631B              TO PI-MAP-NAME
  8763*           MOVE LOW-VALUES          TO EL631BI
  8764*           MOVE 'A'                 TO BMAINTO
  8765*           MOVE AL-UANON            TO BMAINTA
  8766*           MOVE -1                  TO BMAINTL
  8767*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8768*           GO TO 8100-SEND-INITIAL-MAP.
  8769
  8770     IF EIBAID = DFHPF6
  8771        IF NOT CSR-EDIT-SESSION
  8772           MOVE ER-0029                TO EMI-ERROR
  8773           MOVE -1                     TO BPFENTRL
  8774           MOVE AL-UNBON               TO BPFENTRA
  8775           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8776           GO TO 8200-SEND-DATAONLY
  8777*           MOVE '0'              TO PI-EDIT-SW
  8778*           IF PI-DISPLAY-ORIGINAL-BATCH
  8779*              NEXT SENTENCE
  8780*           ELSE
  8781*              MOVE EL631C        TO PI-MAP-NAME
  8782*              MOVE LOW-VALUES    TO EL631CI
  8783*              MOVE 'A'           TO CMAINTO
  8784*              MOVE AL-UANON      TO CMAINTA
  8785*              MOVE -1            TO CMAINTL
  8786*              MOVE '6'           TO PI-MAINT-FUNCTION
  8787*              GO TO 8100-SEND-INITIAL-MAP
  8788*           END-IF
  8789        ELSE
  8790           PERFORM 5100-PROCESS-POL-RESC
  8791                                 THRU 5100-EXIT
  8792           MOVE  PI-PREV-CONTROL-PRIMARY
  8793                                 TO ERPNDB-KEY
  8794
  8795* EXEC CICS READ
  8796*              SET     (ADDRESS OF PENDING-BUSINESS)
  8797*              DATASET (FILE-ID-ERPNDB)
  8798*              RIDFLD  (ERPNDB-KEY)
  8799*          END-EXEC
  8800*    MOVE '&"S        E          (   #00008765' TO DFHEIV0
  8801     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8803     MOVE X'2020233030303038373635' TO DFHEIV0(25:11)
  8804     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 162
* EL6311.cbl
  8805           FILE-ID-ERPNDB,
  8806           DFHEIV20,
  8807           DFHEIV99,
  8808           ERPNDB-KEY,
  8809           DFHEIV99,
  8810           DFHEIV99,
  8811           DFHEIV99
  8812     SET ADDRESS OF PENDING-BUSINESS TO
  8813         DFHEIV20
  8814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8815           PERFORM 9800-LINK-PENDING-EDIT
  8816                                 THRU 9800-EXIT
  8817           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8818           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8819                                    PI-PREV-SEQ-NO
  8820           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8821*                                    WS-CANCEL-LETTER-SW
  8822                                    PI-ALL-ISSUES-SW
  8823                                    PI-ALL-CANCELS-SW
  8824           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8825        END-IF
  8826     END-IF
  8827     IF EIBAID = DFHPF7
  8828        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8829        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8830        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8831        MOVE PI-SV-STATE            TO PI-STATE
  8832        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8833        MOVE BCERTNOI               TO PI-CERT-PRIME
  8834        MOVE BSUFIXI                TO PI-CERT-SFX
  8835        MOVE BEFFDTI                TO DEEDIT-FIELD
  8836        PERFORM 8600-DEEDIT
  8837        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8838        MOVE '4'                    TO DC-OPTION-CODE
  8839        PERFORM 9700-DATE-LINK
  8840        IF DATE-CONVERSION-ERROR
  8841           MOVE ER-0348            TO EMI-ERROR
  8842           MOVE -1                  TO BEFFDTL
  8843           MOVE AL-UABON            TO BEFFDTA
  8844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8845           GO TO 8200-SEND-DATAONLY
  8846        ELSE
  8847           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8848           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8849           MOVE XCTL-EL1273        TO PGM-NAME
  8850           GO TO 9300-XCTL.
  8851
  8852     IF EIBAID = DFHPF8
  8853        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8854        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8855        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8856        MOVE PI-SV-STATE            TO PI-STATE
  8857        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8858        MOVE BCERTNOI               TO PI-CERT-PRIME
  8859        MOVE BSUFIXI                TO PI-CERT-SFX
  8860        MOVE BEFFDTI                TO DEEDIT-FIELD
  8861        PERFORM 8600-DEEDIT
  8862        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 163
* EL6311.cbl
  8863        MOVE '4'                    TO DC-OPTION-CODE
  8864        PERFORM 9700-DATE-LINK
  8865        IF DATE-CONVERSION-ERROR
  8866           MOVE ER-0348            TO EMI-ERROR
  8867           MOVE -1                  TO BEFFDTL
  8868           MOVE AL-UABON            TO BEFFDTA
  8869           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8870           GO TO 8200-SEND-DATAONLY
  8871        ELSE
  8872           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8873           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8874           IF PI-COMPANY-ID = 'DMD'
  8875               MOVE XCTL-EL401DMD      TO PGM-NAME
  8876             ELSE
  8877               MOVE XCTL-EL1279        TO PGM-NAME
  8878           END-IF
  8879           GO TO 9300-XCTL.
  8880
  8881     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8882        MOVE XCTL-EL6312         TO PGM-NAME
  8883
  8884* EXEC CICS XCTL
  8885*           PROGRAM   (PGM-NAME)
  8886*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8887*           LENGTH    (WS-COMM-LENGTH)
  8888*       END-EXEC
  8889*    MOVE '.$C                   %   #00008838' TO DFHEIV0
  8890     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8891     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8892     MOVE X'2020233030303038383338' TO DFHEIV0(25:11)
  8893     CALL 'kxdfhei1' USING DFHEIV0,
  8894           PGM-NAME,
  8895           PROGRAM-INTERFACE-BLOCK,
  8896           WS-COMM-LENGTH,
  8897           DFHEIV99
  8898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8899     ELSE
  8900        MOVE '0'                 TO  PI-EDIT-SW.
  8901
  8902     IF  EIBAID = DFHPF10
  8903         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8904         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8905         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8906                                    PI-1042-WA
  8907         MOVE 4                  TO PI-689-DATA-SOURCE
  8908         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8909         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8910         MOVE PI-SV-STATE        TO PI-689-STATE
  8911         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8912         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8913         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8914         MOVE PI-PB-ALT-CHG-SEQ-NO
  8915                                 TO PI-689-ALT-SEQ-NO
  8916         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8917         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8918         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8919         MOVE +0                 TO PI-689-CONTROL
  8920         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 164
* EL6311.cbl
  8921                                    PI-689-EXP-DATE
  8922                                    PI-689-RESP-PERSON
  8923                                    PI-689-TYPE
  8924                                    PI-689-FOLLOW-UP-EDIT
  8925                                    PI-689-RESEND1-EDIT
  8926                                    PI-689-SEQ-EDIT
  8927                                    PI-689-BCSEQ-EDIT
  8928                                    PI-689-LBL-OVERRIDE
  8929         MOVE W-LETTER-COMMUNICATION-AREAS
  8930                                 TO PI-PROGRAM-WORK-AREA
  8931         MOVE XCTL-EL689         TO PGM-NAME
  8932         GO TO 9300-XCTL.
  8933
  8934     IF  EIBAID = DFHPF16
  8935         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8936         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8937         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8938                                    PI-1042-WA
  8939         MOVE 4                  TO PI-689-DATA-SOURCE
  8940         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8941         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8942         MOVE PI-SV-STATE        TO PI-689-STATE
  8943         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8944         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8945         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8946         MOVE PI-PB-ALT-CHG-SEQ-NO
  8947                                 TO PI-689-ALT-SEQ-NO
  8948         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8949         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8950         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8951         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8952         MOVE W-LETTER-COMMUNICATION-AREAS
  8953                                 TO PI-PROGRAM-WORK-AREA
  8954         MOVE XCTL-EL690         TO PGM-NAME
  8955         GO TO 9300-XCTL.
  8956
  8957     IF EIBAID = DFHPF13
  8958         MOVE XCTL-EL6313        TO PGM-NAME
  8959         GO TO 9300-XCTL.
  8960
  8961     IF EIBAID = DFHPF17
  8962        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8963        IF (PB-I-LOAN-APR numeric)
  8964           and (pb-i-loan-apr < 99.9999)
  8965           AND (PB-I-BENEFICIARY-NAME NOT
  8966              = SPACES AND LOW-VALUES)
  8967
  8968           MOVE LINK-ELVADS          TO PGM-NAME
  8969
  8970* EXEC CICS LINK
  8971*              PROGRAM    (PGM-NAME)
  8972*              COMMAREA   (WS-PASS-AREA)
  8973*              LENGTH     (WS-PASS-AREA-LENGTH)
  8974*          END-EXEC
  8975*    MOVE '."C                   (   #00008913' TO DFHEIV0
  8976     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8977     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8978     MOVE X'2020233030303038393133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 165
* EL6311.cbl
  8979     CALL 'kxdfhei1' USING DFHEIV0,
  8980           PGM-NAME,
  8981           WS-PASS-AREA,
  8982           WS-PASS-AREA-LENGTH,
  8983           DFHEIV99,
  8984           DFHEIV99,
  8985           DFHEIV99,
  8986           DFHEIV99
  8987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8988
  8989           MOVE 0000             TO EMI-ERROR
  8990           MOVE -1               TO BMAINTL
  8991           PERFORM 9900-ERROR-FORMAT
  8992                                 THRU 9900-EXIT
  8993           GO TO 8200-SEND-DATAONLY
  8994        ELSE
  8995           MOVE ER-0877            TO EMI-ERROR
  8996           MOVE -1                  TO BEFFDTL
  8997           MOVE AL-UABON            TO BEFFDTA
  8998           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8999           GO TO 8200-SEND-DATAONLY
  9000        END-IF
  9001     END-IF
  9002     IF EIBAID = DFHPF14
  9003        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9004        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9005        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9006        MOVE PI-SV-STATE            TO PI-CR-STATE
  9007        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9008        MOVE SPACE                  TO PI-EDIT-SW
  9009        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9010        MOVE XCTL-EL650             TO PGM-NAME
  9011        GO TO 9300-XCTL.
  9012
  9013     IF EIBAID = DFHPF15
  9014        IF PI-COMPANY-ID  =  'HER'
  9015            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9016            MOVE XCTL-EL680         TO PGM-NAME
  9017            GO TO 9300-XCTL.
  9018
  9019     IF EIBAID = DFHENTER OR DFHPF11
  9020        GO TO 1000-ISSUE-MAINLINE.
  9021
  9022     MOVE ER-0029                TO EMI-ERROR
  9023     MOVE -1                     TO BPFENTRL
  9024     MOVE AL-UNBON               TO BPFENTRA
  9025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9026     GO TO 8200-SEND-DATAONLY.
  9027
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 166
* EL6311.cbl
  9029
  9030******************************************************************
  9031*                                                                *
  9032*      CANCEL SCREEN PF KEY CHECKING                             *
  9033*                                                                *
  9034******************************************************************
  9035
  9036******************************************************************
  9037*                                                                *
  9038*      PF KEY FUNCTIONS:                                         *
  9039*                                                                *
  9040*      PF1  = BROWSE FORWARD                                     *
  9041*      PF2  = BROWSE BACKWARD                                    *
  9042*      PF3  = CERTIFICATE LOOKUP                                 *
  9043*      PF4  = DISPLAY BATCH HEADER                               *
  9044*      PF5  = ADD ISSUE SCREEN                                   *
  9045*      PF6  = ADD CANCEL SCREEN                                  *
  9046*      PF7  = CERTIFICATE DISPLAY                                *
  9047*      PF8  = CERTIFICATE NOTES                                  *
  9048*      PF9  = EDIT CONTROL                                       *
  9049*      PF10 = DISPLAY LETTER SCREEN                              *
  9050*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9051*      PF12 = DISPLAY HELP SCREEN                                *
  9052*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9053*      PF14 = ACCOUNT MASTER                                     *
  9054*      PF16 = LETTER REVIEW                                      *
  9055*                                                                *
  9056******************************************************************
  9057
  9058 0400-CHECK-CANCEL-PF-KEYS.
  9059     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9060        MOVE ER-2337             TO EMI-ERROR
  9061        MOVE -1                  TO CMAINTL
  9062        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9063        GO TO 8200-SEND-DATAONLY.
  9064
  9065     IF EIBAID = DFHPF1
  9066        MOVE '0'                TO PI-EDIT-SW
  9067        IF PI-PRIMARY-BROWSE
  9068           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9069        ELSE
  9070           IF PI-PRIMARY-WITH-SELECT
  9071              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9072           ELSE
  9073              IF PI-FILE-BROWSE
  9074                 GO TO 4300-BROWSE-FILE-FORWARD
  9075              ELSE
  9076                 IF PI-CSR-BROWSE
  9077                    GO TO 4200-BROWSE-CSR-FORWARD
  9078                 ELSE
  9079                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9080
  9081     IF EIBAID = DFHPF2
  9082        MOVE '0'                TO PI-EDIT-SW
  9083        IF PI-PRIMARY-BROWSE
  9084           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9085        ELSE
  9086           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 167
* EL6311.cbl
  9087              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9088           ELSE
  9089              IF PI-FILE-BROWSE
  9090                 GO TO 4800-BROWSE-FILE-BACKWARD
  9091              ELSE
  9092                 IF PI-CSR-BROWSE
  9093                    GO TO 4900-BROWSE-CSR-BACKWARD
  9094                 ELSE
  9095                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9096
  9097     IF EIBAID = DFHPF3
  9098        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9099        MOVE XCTL-EL127         TO PGM-NAME
  9100        GO TO 9300-XCTL.
  9101
  9102     IF (EIBAID = DFHPF15 OR DFHPF17)
  9103        AND (CSR-EDIT-SESSION)
  9104*       AND (FATAL-OR-UNFORCED)
  9105        AND (FATAL-ERRORS)
  9106        MOVE ER-1819             TO EMI-ERROR
  9107        MOVE -1                  TO CMAINTL
  9108        MOVE AL-UANON            TO CMAINTA
  9109        PERFORM 9900-ERROR-FORMAT
  9110                                 THRU 9900-EXIT
  9111        GO TO 8200-SEND-DATAONLY
  9112     END-IF
  9113     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9114       AND (CSR-EDIT-SESSION)
  9115        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9116        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9117        IF (RESP-NORMAL)
  9118           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9119              AM-CONTROL-PRIMARY (1:20))
  9120            IF AM-NAME NOT GREATER THAN SPACES OR
  9121               AM-ADDRS NOT GREATER THAN SPACES  OR
  9122               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9123               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9124               AM-ZIP NOT GREATER THAN SPACES
  9125               MOVE ER-3834             TO EMI-ERROR
  9126               MOVE -1                  TO BMAINTL
  9127               MOVE AL-UANON            TO BMAINTA
  9128               PERFORM 9900-ERROR-FORMAT
  9129                                 THRU 9900-EXIT
  9130               GO TO 8200-SEND-DATAONLY
  9131            END-IF
  9132        ELSE
  9133           MOVE ER-1609             TO EMI-ERROR
  9134           MOVE -1                  TO BMAINTL
  9135           MOVE AL-UANON            TO BMAINTA
  9136           PERFORM 9900-ERROR-FORMAT
  9137                                THRU 9900-EXIT
  9138           GO TO 8200-SEND-DATAONLY
  9139        END-IF
  9140
  9141        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9142        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9143        IF (ERMAIL-FOUND)
  9144            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 168
* EL6311.cbl
  9145               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9146               MA-CITY NOT GREATER THAN SPACES OR
  9147               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9148               MA-ZIP-CODE NOT GREATER THAN SPACES
  9149               MOVE ER-3835             TO EMI-ERROR
  9150               MOVE -1                  TO BMAINTL
  9151               MOVE AL-UANON            TO BMAINTA
  9152               PERFORM 9900-ERROR-FORMAT
  9153                                 THRU 9900-EXIT
  9154               GO TO 8200-SEND-DATAONLY
  9155            END-IF
  9156        ELSE
  9157           MOVE ER-3000             TO EMI-ERROR
  9158           MOVE -1                  TO BMAINTL
  9159           MOVE AL-UANON            TO BMAINTA
  9160           PERFORM 9900-ERROR-FORMAT
  9161                                THRU 9900-EXIT
  9162           GO TO 8200-SEND-DATAONLY
  9163        END-IF
  9164
  9165     END-IF
  9166     IF (EIBAID = DFHPF15 OR DFHPF17)
  9167        AND (CSR-EDIT-SESSION)
  9168        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9169        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9170        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9171        MOVE PI-SV-STATE         TO PI-STATE
  9172        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9173        MOVE CCERTNOI            TO PI-CERT-PRIME
  9174        MOVE CSUFIXI             TO PI-CERT-SFX
  9175        MOVE CEFFDTI             TO DEEDIT-FIELD
  9176        PERFORM 8600-DEEDIT
  9177        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9178        MOVE '4'                 TO DC-OPTION-CODE
  9179        PERFORM 9700-DATE-LINK
  9180        IF DATE-CONVERSION-ERROR
  9181           MOVE ER-0348          TO EMI-ERROR
  9182           MOVE -1               TO CEFFDTL
  9183           MOVE AL-UABON         TO CEFFDTA
  9184           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9185           GO TO 8200-SEND-DATAONLY
  9186        ELSE
  9187           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9188           PERFORM 6000-CREATE-TEMP-STORAGE
  9189                                 THRU 6000-EXIT
  9190           IF EIBAID = DFHPF17
  9191               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9192                                  THRU 6400-EXIT
  9193               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9194                                 '2' AND '3' AND '4'
  9195                  MOVE ER-3831     TO  EMI-ERROR
  9196                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9197                  GO TO 8200-SEND-DATAONLY
  9198               END-IF
  9199               MOVE 'Y'          TO PI-CLM-RESC-IND
  9200           ELSE
  9201               MOVE 'N'          TO PI-CLM-RESC-IND
  9202           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 169
* EL6311.cbl
  9203           MOVE XCTL-EL6316      TO PGM-NAME
  9204           MOVE '2'              TO PI-ISS-CAN-SW
  9205           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9206           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9207           GO TO 9300-XCTL
  9208        END-IF
  9209     END-IF
  9210
  9211     IF EIBAID = DFHPF4
  9212        MOVE '0'                TO PI-EDIT-SW
  9213        IF PI-DISPLAY-ORIGINAL-BATCH
  9214           NEXT SENTENCE
  9215        ELSE
  9216           GO TO 7200-DISPLAY-BATCHES.
  9217
  9218     IF EIBAID = DFHPF5
  9219        MOVE ER-0029                TO EMI-ERROR
  9220        MOVE -1                     TO BPFENTRL
  9221        MOVE AL-UNBON               TO BPFENTRA
  9222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9223        GO TO 8200-SEND-DATAONLY.
  9224*        MOVE '0'                TO PI-EDIT-SW
  9225*        IF PI-DISPLAY-ORIGINAL-BATCH
  9226*           NEXT SENTENCE
  9227*        ELSE
  9228*           MOVE EL631B              TO PI-MAP-NAME
  9229*           MOVE LOW-VALUES          TO EL631BI
  9230*           MOVE 'A'                 TO BMAINTO
  9231*           MOVE AL-UANON            TO BMAINTA
  9232*           MOVE -1                  TO BMAINTL
  9233*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9234*           GO TO 8100-SEND-INITIAL-MAP.
  9235
  9236     IF EIBAID = DFHPF6
  9237        MOVE ER-0029                TO EMI-ERROR
  9238        MOVE -1                     TO BPFENTRL
  9239        MOVE AL-UNBON               TO BPFENTRA
  9240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9241        GO TO 8200-SEND-DATAONLY.
  9242*        MOVE '0'                TO PI-EDIT-SW
  9243*        IF PI-DISPLAY-ORIGINAL-BATCH
  9244*           NEXT SENTENCE
  9245*        ELSE
  9246*           MOVE EL631C              TO PI-MAP-NAME
  9247*           MOVE LOW-VALUES          TO EL631CI
  9248*           MOVE 'A'                 TO CMAINTO
  9249*           MOVE AL-UANON            TO CMAINTA
  9250*           MOVE -1                  TO CMAINTL
  9251*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9252*           GO TO 8100-SEND-INITIAL-MAP.
  9253
  9254     IF EIBAID = DFHPF7
  9255        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9256        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9257        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9258        MOVE PI-SV-STATE            TO PI-STATE
  9259        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9260        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 170
* EL6311.cbl
  9261        MOVE CSUFIXI                TO PI-CERT-SFX
  9262        MOVE CEFFDTI                TO DEEDIT-FIELD
  9263        PERFORM 8600-DEEDIT
  9264        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9265        MOVE '4'                    TO DC-OPTION-CODE
  9266        PERFORM 9700-DATE-LINK
  9267        IF DATE-CONVERSION-ERROR
  9268           MOVE ER-0348            TO EMI-ERROR
  9269           MOVE -1                  TO BEFFDTL
  9270           MOVE AL-UABON            TO BEFFDTA
  9271           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9272           GO TO 8200-SEND-DATAONLY
  9273        ELSE
  9274           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9275           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9276           MOVE XCTL-EL1273        TO PGM-NAME
  9277           GO TO 9300-XCTL.
  9278
  9279     IF EIBAID = DFHPF8
  9280        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9281        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9282        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9283        MOVE PI-SV-STATE            TO PI-STATE
  9284        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9285        MOVE CCERTNOI               TO PI-CERT-PRIME
  9286        MOVE CSUFIXI                TO PI-CERT-SFX
  9287        MOVE CEFFDTI                TO DEEDIT-FIELD
  9288        PERFORM 8600-DEEDIT
  9289        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9290        MOVE '4'                    TO DC-OPTION-CODE
  9291        PERFORM 9700-DATE-LINK
  9292        IF DATE-CONVERSION-ERROR
  9293           MOVE ER-0348             TO EMI-ERROR
  9294           MOVE -1                  TO BEFFDTL
  9295           MOVE AL-UABON            TO BEFFDTA
  9296           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9297           GO TO 8200-SEND-DATAONLY
  9298        ELSE
  9299           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9300           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9301           IF PI-COMPANY-ID = 'DMD'
  9302               MOVE XCTL-EL401DMD      TO PGM-NAME
  9303             ELSE
  9304               MOVE XCTL-EL1279        TO PGM-NAME
  9305           END-IF
  9306           GO TO 9300-XCTL.
  9307
  9308     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9309        MOVE XCTL-EL6312     TO PGM-NAME
  9310
  9311* EXEC CICS XCTL
  9312*           PROGRAM  (PGM-NAME)
  9313*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9314*           LENGTH   (WS-COMM-LENGTH)
  9315*       END-EXEC
  9316*    MOVE '.$C                   %   #00009240' TO DFHEIV0
  9317     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9318     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 171
* EL6311.cbl
  9319     MOVE X'2020233030303039323430' TO DFHEIV0(25:11)
  9320     CALL 'kxdfhei1' USING DFHEIV0,
  9321           PGM-NAME,
  9322           PROGRAM-INTERFACE-BLOCK,
  9323           WS-COMM-LENGTH,
  9324           DFHEIV99
  9325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9326     ELSE
  9327        MOVE '0'                 TO  PI-EDIT-SW.
  9328
  9329     IF EIBAID = DFHPF10
  9330         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9331         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9332         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9333         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9334                                    PI-1042-WA
  9335         MOVE 4                  TO PI-689-DATA-SOURCE
  9336         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9337         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9338         MOVE PI-SV-STATE        TO PI-689-STATE
  9339         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9340         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9341         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9342         MOVE PI-PB-ALT-CHG-SEQ-NO
  9343                                 TO PI-689-ALT-SEQ-NO
  9344         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9345         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9346         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9347         MOVE +0                 TO PI-689-CONTROL
  9348         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9349                                    PI-689-EXP-DATE
  9350                                    PI-689-RESP-PERSON
  9351                                    PI-689-TYPE
  9352                                    PI-689-FOLLOW-UP-EDIT
  9353                                    PI-689-RESEND1-EDIT
  9354                                    PI-689-SEQ-EDIT
  9355                                    PI-689-BCSEQ-EDIT
  9356                                    PI-689-LBL-OVERRIDE
  9357         MOVE W-LETTER-COMMUNICATION-AREAS
  9358                                 TO PI-PROGRAM-WORK-AREA
  9359         MOVE XCTL-EL689         TO PGM-NAME
  9360         GO TO 9300-XCTL.
  9361
  9362     IF  EIBAID = DFHPF16
  9363         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9364         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9365         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9366                                    PI-1042-WA
  9367         MOVE 4                  TO PI-689-DATA-SOURCE
  9368         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9369         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9370         MOVE PI-SV-STATE        TO PI-689-STATE
  9371         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9372         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9373         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9374         MOVE PI-PB-ALT-CHG-SEQ-NO
  9375                                 TO PI-689-ALT-SEQ-NO
  9376         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 172
* EL6311.cbl
  9377         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9378         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9379         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9380         MOVE W-LETTER-COMMUNICATION-AREAS
  9381                                 TO PI-PROGRAM-WORK-AREA
  9382         MOVE XCTL-EL690         TO PGM-NAME
  9383         GO TO 9300-XCTL.
  9384     IF (EIBAID = DFHPF13)
  9385        if (not fatal-errors)
  9386           and (not unforced-errors)
  9387           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9388           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9389           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9390           MOVE PI-SV-STATE      TO PI-STATE
  9391           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9392           MOVE CCERTNOI         TO PI-CERT-PRIME
  9393           MOVE CSUFIXI          TO PI-CERT-SFX
  9394           MOVE CEFFDTI          TO DEEDIT-FIELD
  9395           PERFORM 8600-DEEDIT
  9396           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9397           MOVE '4'              TO DC-OPTION-CODE
  9398           PERFORM 9700-DATE-LINK
  9399           IF DATE-CONVERSION-ERROR
  9400              MOVE ER-0348       TO EMI-ERROR
  9401              MOVE -1            TO CEFFDTL
  9402              MOVE AL-UABON      TO CEFFDTA
  9403              PERFORM 9900-ERROR-FORMAT
  9404                                 THRU 9900-EXIT
  9405              GO TO 8200-SEND-DATAONLY
  9406           ELSE
  9407              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9408              MOVE AL-UANON      TO CEFFDTA
  9409              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9410              PERFORM 6000-CREATE-TEMP-STORAGE
  9411                                 THRU 6000-EXIT
  9412              MOVE XCTL-EL677    TO PGM-NAME
  9413              GO TO 9300-XCTL
  9414           end-if
  9415        else
  9416           MOVE ER-3444          TO EMI-ERROR
  9417           MOVE -1               TO CPFENTRL
  9418           MOVE AL-UNBON         TO CPFENTRA
  9419           PERFORM 9900-ERROR-FORMAT
  9420                                 THRU 9900-EXIT
  9421           GO TO 8200-SEND-DATAONLY
  9422        end-if
  9423     end-if
  9424
  9425     IF EIBAID = DFHPF14
  9426        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9427        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9428        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9429        MOVE PI-SV-STATE            TO PI-CR-STATE
  9430        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9431        MOVE SPACE                  TO PI-EDIT-SW
  9432        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9433        MOVE XCTL-EL650             TO PGM-NAME
  9434        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 173
* EL6311.cbl
  9435
  9436     IF EIBAID = DFHENTER OR DFHPF11
  9437        GO TO 2000-CANCEL-MAINLINE.
  9438
  9439     MOVE ER-0029                TO EMI-ERROR.
  9440     MOVE -1                     TO CPFENTRL.
  9441     MOVE AL-UNBON               TO CPFENTRA.
  9442     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9443     GO TO 8200-SEND-DATAONLY.
  9444
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 174
* EL6311.cbl
  9446
  9447******************************************************************
  9448*                                                                *
  9449*      BATCH SCREEN PF KEY CHECKING                              *
  9450*                                                                *
  9451******************************************************************
  9452
  9453******************************************************************
  9454*                                                                *
  9455*      PF KEY FUNCTIONS:                                         *
  9456*                                                                *
  9457*      PF1 = BROWSE FORWARD                                      *
  9458*      PF2 = BROWSE BACKWARD                                     *
  9459*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9460*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9461*                                                                *
  9462*                                                                *
  9463******************************************************************
  9464
  9465 0500-CHECK-BATCH-PF-KEYS.
  9466     IF EIBAID = DFHPF1
  9467        MOVE '0'                TO PI-EDIT-SW
  9468        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9469           GO TO 5000-BROWSE-BATCH-HEADERS
  9470        ELSE
  9471           IF PI-GOOD-BROWSE
  9472              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9473                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9474              ELSE
  9475                 IF PI-FILE-BROWSE
  9476                    GO TO 4300-BROWSE-FILE-FORWARD
  9477                 ELSE
  9478                    IF PI-CSR-BROWSE
  9479                       GO TO 4200-BROWSE-CSR-FORWARD
  9480                    ELSE
  9481                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9482           ELSE
  9483              GO TO 0800-BROWSE-ERROR.
  9484
  9485     IF EIBAID = DFHPF2
  9486        MOVE '0'                TO PI-EDIT-SW
  9487        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9488           GO TO 5500-BROWSE-BATCH-BACKWARD
  9489        ELSE
  9490           IF PI-GOOD-BROWSE
  9491              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9492                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9493              ELSE
  9494                 IF PI-FILE-BROWSE
  9495                    GO TO 4800-BROWSE-FILE-BACKWARD
  9496                 ELSE
  9497                    IF PI-CSR-BROWSE
  9498                       GO TO 4900-BROWSE-CSR-BACKWARD
  9499                    ELSE
  9500                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9501           ELSE
  9502              GO TO 0800-BROWSE-ERROR.
  9503
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 175
* EL6311.cbl
  9504     IF EIBAID = DFHPF3
  9505        GO TO 3000-BATCH-MAINLINE.
  9506
  9507     IF  EIBAID = DFHPF4
  9508        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9509        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9510        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9511        MOVE PI-SV-STATE            TO PI-CR-STATE
  9512        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9513                                       PI-CR-FIN-RESP
  9514        MOVE 'A'                    TO PI-CR-TYPE
  9515        MOVE SPACE                  TO PI-EDIT-SW
  9516        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9517        MOVE XCTL-EL640             TO PGM-NAME
  9518        GO TO 9300-XCTL.
  9519
  9520     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9521       AND
  9522        (EIBAID = DFHENTER)
  9523           GO TO 3500-EDIT-BATCH-DATA.
  9524
  9525     IF EIBAID = DFHENTER
  9526        GO TO 3500-EDIT-BATCH-DATA.
  9527
  9528     MOVE ER-0029             TO EMI-ERROR.
  9529     MOVE -1                  TO DPFENTRL.
  9530     MOVE AL-UNBON            TO DPFENTRA.
  9531     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9532     GO TO 8200-SEND-DATAONLY.
  9533
  9534 0800-BROWSE-ERROR.
  9535     MOVE ER-2258                TO EMI-ERROR.
  9536     MOVE -1                     TO DPFENTRL.
  9537     MOVE AL-UNBON               TO DPFENTRA.
  9538     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9539     GO TO 8200-SEND-DATAONLY.
  9540
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 176
* EL6311.cbl
  9542
  9543******************************************************************
  9544*                                                                *
  9545*                I S S U E   M A I N L I N E                     *
  9546*                                                                *
  9547******************************************************************
  9548
  9549 1000-ISSUE-MAINLINE.
  9550     IF PI-DISPLAY-ORIGINAL-BATCH
  9551        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9552           MOVE ER-0023             TO EMI-ERROR
  9553           MOVE -1                  TO BMAINTL
  9554           MOVE AL-UABON            TO BMAINTA
  9555           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9556           GO TO 8200-SEND-DATAONLY
  9557        ELSE
  9558           NEXT SENTENCE
  9559     ELSE
  9560        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9561           MOVE ER-0023             TO EMI-ERROR
  9562           MOVE -1                  TO BMAINTL
  9563           MOVE AL-UABON            TO BMAINTA
  9564           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9565           GO TO 8200-SEND-DATAONLY.
  9566
  9567     IF BMAINTI = 'S'
  9568        GO TO 1100-SHOW-REQUEST.
  9569
  9570     IF NOT MODIFY-CAP
  9571         MOVE 'UPDATE'       TO SM-READ
  9572         PERFORM 9995-SECURITY-VIOLATION
  9573         MOVE ER-0070        TO EMI-ERROR
  9574         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9575         GO TO 8100-SEND-INITIAL-MAP.
  9576
  9577     IF BMAINTL GREATER THAN ZEROS
  9578        IF PI-PF5-FUNCTION
  9579           IF BMAINTI NOT = 'A'
  9580              MOVE AL-UABON  TO BMAINTA
  9581              MOVE -1        TO BMAINTL
  9582              MOVE ER-2260   TO EMI-ERROR
  9583              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9584              GO TO 8200-SEND-DATAONLY.
  9585
  9586     IF BCERTNOL = ZEROS
  9587       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9588         NEXT SENTENCE
  9589     ELSE
  9590         IF BCERTNOL NOT = ZEROS
  9591             MOVE AL-UANON       TO BCERTNOA
  9592         ELSE
  9593             MOVE -1             TO BCERTNOL
  9594             MOVE  1             TO SET-CURSOR-SW
  9595             MOVE ER-2218        TO EMI-ERROR
  9596             MOVE AL-UABON       TO BCERTNOA
  9597             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9598
  9599     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 177
* EL6311.cbl
  9600         MOVE AL-UANON       TO BSUFIXA
  9601     ELSE
  9602         MOVE AL-SANOF       TO BSUFIXA.
  9603
  9604     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9605        NEXT SENTENCE
  9606     ELSE
  9607        IF BEFFDTL NOT = ZEROS
  9608           MOVE AL-UNNON             TO BEFFDTA
  9609           MOVE BEFFDTI              TO DEEDIT-FIELD
  9610           PERFORM 8600-DEEDIT
  9611           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9612           MOVE 4                    TO DC-OPTION-CODE
  9613           PERFORM 9700-DATE-LINK
  9614           IF NO-CONVERSION-ERROR
  9615              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9616              ELSE
  9617              MOVE -1                TO BEFFDTL
  9618              MOVE  1                TO SET-CURSOR-SW
  9619              MOVE ER-2226           TO EMI-ERROR
  9620              MOVE AL-UNBON          TO BEFFDTA
  9621              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9622           ELSE
  9623              MOVE -1                TO BEFFDTL
  9624              MOVE  1                TO SET-CURSOR-SW
  9625              MOVE ER-2220           TO EMI-ERROR
  9626              MOVE AL-UNBON          TO BEFFDTA
  9627              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9628
  9629     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9630
  9631     IF BCERTNOL NOT = ZEROS
  9632        MOVE BCERTNOI                TO WS-NEW-PRIME
  9633     ELSE
  9634        MOVE SPACES                  TO WS-NEW-PRIME.
  9635
  9636     IF BSUFIXL NOT = ZEROS
  9637        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9638     ELSE
  9639        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9640
  9641     IF BEFFDTL NOT = ZEROS
  9642        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9643     ELSE
  9644        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9645
  9646     IF BMAINTI = 'A' OR 'K' OR 'S'
  9647        NEXT SENTENCE
  9648     ELSE
  9649        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9650        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9651           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9652           WS-PB-RECORD-TYPE NOT = '1'
  9653           IF BMAINTI = 'C'
  9654               MOVE ER-2287          TO EMI-ERROR
  9655               MOVE -1               TO BCERTNOL
  9656               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9657               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 178
* EL6311.cbl
  9658               GO TO 8200-SEND-DATAONLY
  9659             ELSE
  9660               MOVE ER-2260          TO EMI-ERROR
  9661               MOVE -1               TO BCERTNOL
  9662               MOVE AL-UABON         TO BCERTNOA
  9663               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9664               GO TO 8200-SEND-DATAONLY.
  9665
  9666     IF BMAINTI = 'D'
  9667         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9668
  9669*    IF BMICRNOL  NOT =  ZEROS
  9670*        IF BMICRNOI  NUMERIC
  9671*            MOVE AL-UNNON       TO  BMICRNOA
  9672*        ELSE
  9673*            MOVE -1             TO  BMICRNOL
  9674*            MOVE 1              TO  SET-CURSOR-SW
  9675*            MOVE AL-UNBON       TO  BMICRNOA
  9676*            MOVE ER-2701        TO  EMI-ERROR
  9677*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9678     IF BVINL NOT = ZEROS
  9679        MOVE AL-UANON            TO BVINA
  9680     END-IF
  9681     IF B1STNML NOT = ZEROS
  9682         MOVE AL-UANON                TO B1STNMA.
  9683
  9684     IF BINITL  NOT = ZEROS
  9685        MOVE AL-UANON                TO BINITA.
  9686
  9687     IF BSEXL NOT = ZEROS
  9688        IF BSEXI = 'M' OR 'F'
  9689           MOVE AL-UANON             TO BSEXA
  9690        ELSE
  9691           MOVE -1               TO BSEXL
  9692           MOVE ER-2629          TO EMI-ERROR
  9693           MOVE AL-UABON         TO BSEXA
  9694           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9695
  9696     IF BAGEL NOT = ZEROS
  9697         IF BAGEI NUMERIC
  9698             MOVE BAGEI              TO WS-BAGE
  9699             MOVE AL-UNNON           TO BAGEA
  9700         ELSE
  9701             MOVE -1                 TO BAGEL
  9702             MOVE  1                 TO SET-CURSOR-SW
  9703             MOVE ER-2223            TO EMI-ERROR
  9704             MOVE AL-UNBON           TO BAGEA
  9705             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9706
  9707     IF BLSTNML NOT = ZERO  OR
  9708        B1STNML NOT = ZERO  OR
  9709        BINITL NOT = ZERO
  9710         IF BAGEL = ZEROS
  9711             MOVE -1                 TO BAGEL
  9712             MOVE  1                 TO SET-CURSOR-SW
  9713             MOVE ER-3269            TO EMI-ERROR
  9714             MOVE AL-UNBON           TO BAGEA
  9715             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 179
* EL6311.cbl
  9716         END-IF
  9717     END-IF.
  9718
  9719     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9720
  9721     IF (BBIRTHL GREATER THAN +0) AND
  9722        (BBIRTHI NOT EQUAL SPACES)
  9723        NEXT SENTENCE
  9724     ELSE
  9725        GO TO 1010-CHECK-AGE.
  9726
  9727     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9728     PERFORM 8600-DEEDIT.
  9729     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9730     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9731     MOVE AL-UNNON               TO BBIRTHA.
  9732     MOVE '4'                    TO DC-OPTION-CODE.
  9733     PERFORM 9700-DATE-LINK.
  9734     IF DATE-CONVERSION-ERROR
  9735        MOVE -1                  TO BBIRTHL
  9736        MOVE  1                  TO SET-CURSOR-SW
  9737        MOVE ER-2228             TO EMI-ERROR
  9738        MOVE AL-UNBON            TO BBIRTHA
  9739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9740        GO TO 1010-CHECK-AGE.
  9741
  9742     IF (NO-CONVERSION-ERROR) AND
  9743        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9744        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9745        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9746        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9747                                    WS-CONVERTED-BIRTH
  9748        MOVE AL-UANON            TO BBIRTHA
  9749     ELSE
  9750        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9751        MOVE AL-UANON            TO BBIRTHA.
  9752
  9753 1010-CHECK-AGE.
  9754
  9755*    IF BAGEL = ZERO
  9756*       IF BBIRTHL GREATER THAN ZERO
  9757*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9758
  9759     IF B1STPMTL NOT = ZEROS
  9760        IF B1STPMTI = SPACES
  9761           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9762        ELSE
  9763           MOVE B1STPMTI             TO DEEDIT-FIELD
  9764           PERFORM 8600-DEEDIT
  9765           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9766           MOVE AL-UNNON             TO B1STPMTA
  9767           MOVE 4                    TO DC-OPTION-CODE
  9768           PERFORM 9700-DATE-LINK
  9769           IF NO-CONVERSION-ERROR
  9770              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9771              MOVE AL-UANON          TO B1STPMTA
  9772           ELSE
  9773              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 180
* EL6311.cbl
  9774              MOVE  1                TO SET-CURSOR-SW
  9775              MOVE ER-2200           TO EMI-ERROR
  9776              MOVE AL-UNBON          TO B1STPMTA
  9777              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9778
  9779     IF BDAYSL NOT = ZEROS
  9780         IF BDAYSI NUMERIC
  9781             MOVE AL-UNNON           TO BDAYSA
  9782         ELSE
  9783             MOVE -1                 TO BDAYSL
  9784             MOVE ER-2530            TO EMI-ERROR
  9785             MOVE AL-UNBON           TO BDAYSA
  9786             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9787
  9788     IF BLNTRML NOT = ZEROS
  9789         IF BLNTRMI NUMERIC
  9790             MOVE AL-UNNON       TO BLNTRMA
  9791         ELSE
  9792             MOVE -1             TO BLNTRML
  9793             MOVE ER-2533        TO EMI-ERROR
  9794             MOVE AL-UNBON       TO BLNTRMA
  9795             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9796
  9797**   IF PI-COMPANY-ID = 'DMD'
  9798     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9799        NEXT SENTENCE
  9800     ELSE
  9801         IF BLNOFCRL NOT = ZEROS
  9802            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9803            IF LOAN-OFFICER-FOUND
  9804                MOVE AL-UANON        TO BLNOFCRA
  9805             ELSE
  9806                 MOVE SPACE          TO WS-LOAN-OFFICER
  9807                 MOVE -1             TO BLNOFCRL
  9808                 MOVE  1             TO SET-CURSOR-SW
  9809                 MOVE ER-3006        TO EMI-ERROR
  9810                 MOVE AL-UNBON       TO BLNOFCRA
  9811                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9812
  9813     IF BFREQL NOT = ZEROS
  9814         IF BFREQI NUMERIC
  9815             MOVE AL-UNNON       TO BFREQA
  9816         ELSE
  9817             MOVE -1             TO BFREQL
  9818             MOVE  1             TO SET-CURSOR-SW
  9819             MOVE ER-2223        TO EMI-ERROR
  9820             MOVE AL-UNBON       TO BFREQA
  9821             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9822
  9823     IF BMODEL NOT = ZEROS
  9824         MOVE BMODEI             TO WS-MODE-CODE
  9825                                    PI-BMODE
  9826         IF WS-MODE-CODE-VALID
  9827             MOVE AL-UANON       TO BMODEA
  9828         ELSE
  9829             MOVE -1             TO BMODEL
  9830             MOVE ER-2591        TO EMI-ERROR
  9831             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 181
* EL6311.cbl
  9832             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9833
  9834     IF BPMTSL NOT = ZEROS
  9835         IF BPMTSI NUMERIC
  9836             MOVE AL-UNNON           TO BPMTSA
  9837             MOVE BPMTSI             TO PI-BPMTS
  9838         ELSE
  9839             MOVE -1                 TO BPMTSL
  9840             MOVE ER-2592            TO EMI-ERROR
  9841             MOVE AL-UNBON           TO BPMTSA
  9842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9843
  9844     IF BPMTAMTL NOT = ZEROS
  9845
  9846* EXEC CICS BIF DEEDIT
  9847*            FIELD  (BPMTAMTI)
  9848*            LENGTH (9)
  9849*       END-EXEC
  9850     MOVE 9
  9851       TO DFHEIV11
  9852*    MOVE '@"L                   #   #00009764' TO DFHEIV0
  9853     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9854     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9855     MOVE X'2020233030303039373634' TO DFHEIV0(25:11)
  9856     CALL 'kxdfhei1' USING DFHEIV0,
  9857           BPMTAMTI,
  9858           DFHEIV11
  9859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9860        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9861*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9862*        PERFORM 8600-DEEDIT
  9863*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9864
  9865*    IF BAPRL NOT = ZEROS
  9866*        EXEC CICS BIF DEEDIT
  9867*            FIELD  (BAPRI)
  9868*            LENGTH (7)
  9869*        END-EXEC
  9870*        MOVE BAPRI              TO WS-BAPR.
  9871
  9872     IF BAPRL > 0
  9873        MOVE +0                  TO  WS-BAPR
  9874        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9875           (WS-SUB > 7)
  9876           OR (BAPRI (WS-SUB:1) NUMERIC)
  9877           OR (BAPRI (WS-SUB:1) = '.')
  9878        END-PERFORM
  9879        IF WS-SUB > 7
  9880           MOVE ER-2471       TO EMI-ERROR
  9881           MOVE -1            TO BAPRL
  9882           MOVE AL-UNBON      TO BAPRA
  9883           PERFORM 9900-ERROR-FORMAT
  9884                                 THRU 9900-EXIT
  9885        ELSE
  9886           IF BAPRI (WS-SUB:1) NUMERIC
  9887              MOVE WS-SUB           TO WS-BEG
  9888              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9889                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 182
* EL6311.cbl
  9890                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9891              END-PERFORM
  9892              COMPUTE WS-END = WS-SUB - WS-BEG
  9893              MOVE BAPRI (WS-BEG:WS-END)
  9894                                 TO WS-APR-WHOLE-NUM
  9895           END-IF
  9896           IF BAPRI (WS-SUB:1) = '.'
  9897              COMPUTE WS-BEG = WS-SUB + 1
  9898              IF (WS-BEG < 8)
  9899                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9900                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9901                    (WS-SUB > 7)
  9902                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9903                 END-PERFORM
  9904                 COMPUTE WS-END = WS-SUB - WS-BEG
  9905                 MOVE BAPRI (WS-BEG:WS-END)
  9906                                 TO WS-APR-DEC (1:WS-END)
  9907              END-IF
  9908           END-IF
  9909           MOVE AL-UNNON      TO BAPRA
  9910           MOVE WS-BAPR       TO BAPRO
  9911        END-IF
  9912     END-IF
  9913*     IF BAPRL NOT = ZEROS
  9914*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9915*        PERFORM 8600-DEEDIT
  9916*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9917
  9918     IF BLIVESL NOT = ZEROS
  9919        MOVE BLIVESI             TO DEEDIT-FIELD
  9920        PERFORM 8600-DEEDIT
  9921        IF DEEDIT-FIELD-V0 NUMERIC
  9922           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9923           MOVE AL-UNNON         TO BLIVESA
  9924        ELSE
  9925           MOVE -1               TO BLIVESL
  9926           MOVE AL-UNBON         TO BLIVESA
  9927           MOVE ER-2223          TO EMI-ERROR
  9928           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9929
  9930*DMD CUSTOM CODING*************START
  9931*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9932     IF PI-COMPANY-ID NOT = 'DMD'
  9933         MOVE ZEROS               TO BBILLEDL
  9934         GO TO 1010-EDIT-CONT.
  9935
  9936     IF BBILLEDL NOT = ZEROS
  9937        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9938        MOVE 'Y'                 TO WS-NUMERIC-SW
  9939        MOVE +1                  TO WS-CSO-SUB
  9940        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9941        IF CSO-NUMERIC-FIELD
  9942
  9943* EXEC CICS BIF DEEDIT
  9944*              FIELD  (BBILLEDI)
  9945*              LENGTH (9)
  9946*          END-EXEC
  9947     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 183
* EL6311.cbl
  9948       TO DFHEIV11
  9949*    MOVE '@"L                   #   #00009850' TO DFHEIV0
  9950     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9951     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9952     MOVE X'2020233030303039383530' TO DFHEIV0(25:11)
  9953     CALL 'kxdfhei1' USING DFHEIV0,
  9954           BBILLEDI,
  9955           DFHEIV11
  9956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9957           MOVE BBILLEDI         TO WS-BILLED
  9958           MOVE AL-UNNON         TO BBILLEDA
  9959        ELSE
  9960           MOVE -1               TO BBILLEDL
  9961           MOVE AL-UNBON         TO BBILLEDA
  9962           MOVE ER-2547          TO EMI-ERROR
  9963           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9964     ELSE
  9965        IF BMAINTI EQUAL 'A'
  9966           MOVE -1               TO BBILLEDL
  9967           MOVE AL-UNBON         TO BBILLEDA
  9968           MOVE ER-8148          TO EMI-ERROR
  9969           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9970
  9971 1010-EDIT-CONT.
  9972
  9973     IF BFORCEL  NOT = ZEROS
  9974         IF FORCE-CAP
  9975            MOVE AL-UANON            TO BFORCEA
  9976         ELSE
  9977            MOVE ER-2945             TO EMI-ERROR
  9978            MOVE AL-UABON            TO BFORCEA
  9979            MOVE -1                  TO BFORCEL
  9980            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9981
  9982     if (bforcel not = zeros)
  9983        and (bforcei = 'L')
  9984        and (not csr-edit-session)
  9985        and (emi-error <> er-2945)
  9986        MOVE ER-2670             TO EMI-ERROR
  9987        MOVE AL-UABON            TO BFORCEA
  9988        MOVE -1                  TO BFORCEL
  9989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9990     end-if
  9991     IF BENTRYL NOT = ZEROS
  9992        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9993                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9994           MOVE ER-2224              TO EMI-ERROR
  9995           MOVE AL-UABON             TO BENTRYA
  9996           MOVE -1                   TO BENTRYL
  9997           MOVE  1                   TO SET-CURSOR-SW
  9998           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9999        ELSE
 10000           MOVE AL-UANON             TO BENTRYA.
 10001
 10002     IF BUNWRITL NOT = ZEROS
 10003        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10004           MOVE ER-7574              TO EMI-ERROR
 10005           MOVE AL-UABON             TO BUNWRITA
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 184
* EL6311.cbl
 10006           MOVE -1                   TO BUNWRITL
 10007           MOVE  1                   TO SET-CURSOR-SW
 10008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10009        ELSE
 10010           MOVE AL-UANON             TO BUNWRITA.
 10011
 10012     IF BREINL  NOT = ZEROS
 10013         MOVE AL-UANON               TO BREINA.
 10014
 10015     IF BBILCDL NOT = ZEROS
 10016        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10017                             AND 'A' AND 'B' AND 'E'
 10018           MOVE ER-2225              TO EMI-ERROR
 10019           MOVE AL-UABON             TO BBILCDA
 10020           MOVE -1                   TO BBILCDL
 10021           MOVE  1                   TO SET-CURSOR-SW
 10022           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10023        ELSE
 10024           MOVE AL-UANON             TO BBILCDA.
 10025
 10026     IF BSKPCDL NOT = ZEROS
 10027         MOVE AL-UANON               TO BSKPCDA.
 10028
 10029     IF BINDGRPL NOT = ZEROS
 10030         MOVE AL-UANON               TO BINDGRPA.
 10031
 10032     IF BSIGL   NOT = ZEROS
 10033         MOVE AL-UANON               TO BSIGA.
 10034
 10035     IF BRTCLSL NOT = ZEROS
 10036         MOVE AL-UANON               TO BRTCLSA.
 10037
 10038     IF BMEMBERL NOT = ZEROS
 10039         MOVE AL-UANON               TO BMEMBERA.
 10040
 10041     MOVE +0                         TO WS-SUB1.
 10042
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 185
* EL6311.cbl
 10044
 10045******************************************************************
 10046*                                                                *
 10047*           E D I T   I S S U E   C O V E R A G E S              *
 10048*                                                                *
 10049******************************************************************
 10050
 10051 1020-EDIT-COVERAGES.
 10052     ADD +1                      TO WS-SUB1.
 10053
 10054     IF WS-SUB1 GREATER +2
 10055        GO TO 1025-EDIT-CONTINUE
 10056     END-IF
 10057
 10058     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10059       IF (BMODEL   GREATER ZERO  OR
 10060            BPMTSL   GREATER ZERO  OR
 10061            BPMTAMTL GREATER ZERO)
 10062          AND
 10063            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10064               GO TO 1021-CONT-EDIT.
 10065
 10066     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10067        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10068        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10069        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10070        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10071        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10072        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10073        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10074        NEXT SENTENCE
 10075         ELSE
 10076            GO TO 1020-EDIT-COVERAGES.
 10077
 10078 1021-CONT-EDIT.
 10079
 10080     IF BMAINTI = 'A'
 10081        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10082           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10083        ELSE
 10084           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10085           MOVE ER-7404          TO EMI-ERROR
 10086           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10087           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10088     ELSE
 10089        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10090           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10091
 10092     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10093        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10094        PERFORM 8600-DEEDIT
 10095        IF DEEDIT-FIELD-V0 NUMERIC
 10096           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10097        ELSE
 10098           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10099
 10100     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10101*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 186
* EL6311.cbl
 10102        IF BMODEL  GREATER THAN ZEROS  AND
 10103           BPMTSL  GREATER THAN ZEROS
 10104           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10105
 10106     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10107         IF BMODEL   GREATER THAN ZEROS  OR
 10108            BPMTSL   GREATER THAN ZEROS  OR
 10109            BPMTAMTL GREATER THAN ZEROS
 10110             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10111
 10112     IF BMAINTI = ('C' OR 'K')
 10113        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10114           NEXT SENTENCE
 10115        ELSE
 10116           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10117           PERFORM 8600-DEEDIT
 10118           IF DEEDIT-FIELD-V0 NUMERIC
 10119              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10120              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10121                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10122              ELSE
 10123                    MOVE ER-2241      TO EMI-ERROR
 10124                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10125                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10126                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10127           ELSE
 10128              MOVE ER-2223          TO EMI-ERROR
 10129              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10130              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10131              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10132     ELSE
 10133        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10134            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10135            PERFORM 8600-DEEDIT
 10136            IF DEEDIT-FIELD-V0      NUMERIC
 10137               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10138                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10139                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10140               ELSE
 10141                  MOVE ER-2241         TO EMI-ERROR
 10142                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10143                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10144                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10145            ELSE
 10146              MOVE ER-2223             TO EMI-ERROR
 10147              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10148              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10149              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10150        ELSE
 10151            MOVE ER-2240               TO EMI-ERROR
 10152            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10153            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10154*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10155*        IF BMODEL  GREATER THAN ZEROS  AND
 10156*           BPMTSL  GREATER THAN ZEROS
 10157*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10158
 10159     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 187
* EL6311.cbl
 10160        AND BMAINTI = ('C' OR 'K')
 10161           NEXT SENTENCE
 10162     ELSE
 10163        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10164           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10165
 10166* EXEC CICS BIF DEEDIT
 10167*              FIELD  (BBENI (WS-SUB1))
 10168*              LENGTH (12)
 10169*          END-EXEC
 10170     MOVE 12
 10171       TO DFHEIV11
 10172*    MOVE '@"L                   #   #00010062' TO DFHEIV0
 10173     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10174     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10175     MOVE X'2020233030303130303632' TO DFHEIV0(25:11)
 10176     CALL 'kxdfhei1' USING DFHEIV0,
 10177           BBENI(WS-SUB1),
 10178           DFHEIV11
 10179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10180           IF BBENI (WS-SUB1)  NUMERIC
 10181              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10182                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10183*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10184*          PERFORM 8600-DEEDIT
 10185*          IF DEEDIT-FIELD-V2  NUMERIC
 10186*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10187*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10188              ELSE
 10189                 MOVE ER-7632    TO EMI-ERROR
 10190                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10191                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10192                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10193           ELSE
 10194              MOVE ER-2223         TO EMI-ERROR
 10195              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10196              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10197              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10198        ELSE
 10199           MOVE ER-7632    TO EMI-ERROR
 10200           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10201           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10202           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10203
 10204     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10205        AND (BMAINTI = ('C' OR 'K'))
 10206        CONTINUE
 10207     ELSE
 10208        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10209           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10210           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10211              FOR ALL '.'
 10212           IF WS-TALLY > 1
 10213              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10214                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10215              END-PERFORM
 10216              IF A1 < 9
 10217                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 188
* EL6311.cbl
 10218                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10219              END-IF
 10220           ELSE
 10221              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10222                (A1 > 11)
 10223                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10224                  LOW-VALUES OR SPACES)
 10225              END-PERFORM
 10226              IF A1 > 1 AND < 12
 10227                 MOVE SPACES
 10228                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10229              END-IF
 10230           END-IF
 10231
 10232* EXEC CICS BIF DEEDIT
 10233*              FIELD  (BPREMI (WS-SUB1))
 10234*              LENGTH (11)
 10235*          END-EXEC
 10236     MOVE 11
 10237       TO DFHEIV11
 10238*    MOVE '@"L                   #   #00010117' TO DFHEIV0
 10239     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10240     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10241     MOVE X'2020233030303130313137' TO DFHEIV0(25:11)
 10242     CALL 'kxdfhei1' USING DFHEIV0,
 10243           BPREMI(WS-SUB1),
 10244           DFHEIV11
 10245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10246           IF BPREMI (WS-SUB1) NUMERIC
 10247              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10248                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10249*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10250*          PERFORM 8600-DEEDIT
 10251*          IF DEEDIT-FIELD-V2  NUMERIC
 10252*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10253*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10254              ELSE
 10255                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10256                    MOVE ER-7633    TO EMI-ERROR
 10257                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10258                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10259                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10260                 END-IF
 10261              END-IF
 10262           ELSE
 10263              MOVE ER-2223         TO EMI-ERROR
 10264              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10265              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10266              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10267           END-IF
 10268        ELSE
 10269           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10270              MOVE ER-7633         TO EMI-ERROR
 10271              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10272              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10273              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10274           END-IF
 10275        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 189
* EL6311.cbl
 10276     END-IF
 10277
 10278     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10279        NEXT SENTENCE
 10280     ELSE
 10281        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10282
 10283* EXEC CICS BIF DEEDIT
 10284*           FIELD  (BCPREMI (WS-SUB1))
 10285*           LENGTH (11)
 10286*       END-EXEC
 10287     MOVE 11
 10288       TO DFHEIV11
 10289*    MOVE '@"L                   #   #00010157' TO DFHEIV0
 10290     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10291     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10292     MOVE X'2020233030303130313537' TO DFHEIV0(25:11)
 10293     CALL 'kxdfhei1' USING DFHEIV0,
 10294           BCPREMI(WS-SUB1),
 10295           DFHEIV11
 10296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10297        IF BCPREMI (WS-SUB1) NUMERIC
 10298           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10299*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10300*       PERFORM 8600-DEEDIT
 10301*       IF DEEDIT-FIELD-V2  NUMERIC
 10302*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10303        ELSE
 10304           MOVE ER-2223         TO EMI-ERROR
 10305           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10306           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10308
 10309     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10310        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10311        PERFORM 8600-DEEDIT
 10312        IF DEEDIT-FIELD-V0 NUMERIC
 10313           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10314           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10315         ELSE
 10316           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10317           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10318           MOVE ER-2223              TO EMI-ERROR
 10319           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10320
 10321     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10322        IF BEXPIRE   (WS-SUB1) = SPACES
 10323           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10324        ELSE
 10325           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10326           PERFORM 8600-DEEDIT
 10327           IF DEEDIT-FIELD-V0        NUMERIC
 10328              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10329              MOVE 4                TO DC-OPTION-CODE
 10330              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10331              PERFORM 9700-DATE-LINK
 10332              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10333                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 190
* EL6311.cbl
 10334              IF NO-CONVERSION-ERROR
 10335                 NEXT SENTENCE
 10336              ELSE
 10337                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10338                 MOVE ER-2531    TO EMI-ERROR
 10339                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10340                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10341           ELSE
 10342             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10343             MOVE ER-2532        TO EMI-ERROR
 10344             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10345             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10346
 10347     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10348        NEXT SENTENCE
 10349     ELSE
 10350
 10351* EXEC CICS BIF DEEDIT
 10352*           FIELD  (BALT-BENI (WS-SUB1))
 10353*           LENGTH (12)
 10354*       END-EXEC
 10355     MOVE 12
 10356       TO DFHEIV11
 10357*    MOVE '@"L                   #   #00010214' TO DFHEIV0
 10358     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10359     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10360     MOVE X'2020233030303130323134' TO DFHEIV0(25:11)
 10361     CALL 'kxdfhei1' USING DFHEIV0,
 10362           BALT-BENI(WS-SUB1),
 10363           DFHEIV11
 10364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10365        IF BALT-BENI (WS-SUB1) NUMERIC
 10366           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10367*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10368*       PERFORM 8600-DEEDIT
 10369*       IF DEEDIT-FIELD-V0 NUMERIC
 10370*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10371        ELSE
 10372           MOVE ER-2223         TO EMI-ERROR
 10373           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10374           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10375           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10376
 10377     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10378        NEXT SENTENCE
 10379     ELSE
 10380
 10381* EXEC CICS BIF DEEDIT
 10382*           FIELD  (BALT-PREMI (WS-SUB1))
 10383*           LENGTH (11)
 10384*       END-EXEC
 10385     MOVE 11
 10386       TO DFHEIV11
 10387*    MOVE '@"L                   #   #00010233' TO DFHEIV0
 10388     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10389     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10390     MOVE X'2020233030303130323333' TO DFHEIV0(25:11)
 10391     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 191
* EL6311.cbl
 10392           BALT-PREMI(WS-SUB1),
 10393           DFHEIV11
 10394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10395        IF BALT-PREMI (WS-SUB1) NUMERIC
 10396           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10397*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10398*       PERFORM 8600-DEEDIT
 10399*       IF DEEDIT-FIELD-V0 NUMERIC
 10400*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10401        ELSE
 10402           MOVE ER-2223         TO EMI-ERROR
 10403           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10404           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10405           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10406
 10407      GO TO 1020-EDIT-COVERAGES.
 10408     .
 10409 1025-edit-continue.
 10410     IF PI-COMPANY-ID  =  'DMD'
 10411        MOVE LOW-VALUES             TO BNCERTI
 10412                                       BNSTATI.
 10413
 10414     IF EMI-ERROR = ZEROS
 10415         NEXT SENTENCE
 10416     ELSE
 10417         GO TO 8200-SEND-DATAONLY.
 10418
 10419     IF BMAINTI = 'A'
 10420         GO TO 1200-ADD-ISSUE-ROUTINE.
 10421
 10422     IF BMAINTI = 'C'
 10423         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10424
 10425     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10426
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 192
* EL6311.cbl
 10428
 10429 1030-EDIT-FOR-NUMERICS.
 10430     IF WS-CSO-SUB EQUAL 10
 10431        GO TO 1030-EDIT-EXIT.
 10432
 10433     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10434        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10435        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10436           ADD +1               TO WS-CSO-SUB
 10437           GO TO 1030-EDIT-FOR-NUMERICS.
 10438
 10439     MOVE 'N'                   TO WS-NUMERIC-SW.
 10440
 10441 1030-EDIT-EXIT.
 10442******************************************************************
 10443*                                                                *
 10444*                 C A L C U L A T E   A G E                      *
 10445*                                                                *
 10446******************************************************************
 10447
 10448
 10449 1095-CALC-AGE.
 10450
 10451     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10452     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10453     MOVE 1                  TO DC-OPTION-CODE.
 10454     PERFORM 9700-DATE-LINK
 10455     IF NO-CONVERSION-ERROR
 10456         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10457         MOVE WS-BAGE            TO BAGEI
 10458         MOVE +2                 TO BAGEL
 10459         MOVE AL-UNNON TO BAGEA.
 10460
 10461 1099-EXIT.
 10462     EXIT.
 10463
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 193
* EL6311.cbl
 10465
 10466******************************************************************
 10467*                                                                *
 10468*                   S H O W   I S S U E                          *
 10469*                                                                *
 10470******************************************************************
 10471
 10472 1100-SHOW-REQUEST.
 10473     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10474
 10475     IF BCERTNOL = ZEROS AND
 10476        BEFFDTL  = ZEROS
 10477        MOVE -1                  TO BMAINTL
 10478        GO TO 8200-SEND-DATAONLY.
 10479
 10480     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10481
 10482     IF BSUFIXL NOT = ZEROS
 10483        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10484     ELSE
 10485        MOVE SPACE               TO WS-NEW-SUFFIX.
 10486
 10487     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10488     PERFORM 8600-DEEDIT.
 10489     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10490     MOVE '4'                    TO DC-OPTION-CODE.
 10491     PERFORM 9700-DATE-LINK.
 10492     IF DATE-CONVERSION-ERROR
 10493        MOVE ER-0348             TO EMI-ERROR
 10494        MOVE -1                  TO BEFFDTL
 10495        MOVE AL-UABON            TO BEFFDTA
 10496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10497        GO TO 8200-SEND-DATAONLY
 10498     ELSE
 10499        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10500        MOVE AL-UANON            TO BEFFDTA
 10501        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10502
 10503     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10504
 10505     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10506        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10507          MOVE 'Y'                    TO WS-SHOW-SW
 10508          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10509             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10510           ELSE
 10511             IF PI-FILE-BROWSE
 10512                GO TO 4300-BROWSE-FILE-FORWARD
 10513              ELSE
 10514                IF PI-CSR-BROWSE
 10515                   GO TO 4200-BROWSE-CSR-FORWARD
 10516                ELSE
 10517                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10518        ELSE
 10519           GO TO 3900-RE-DISPLAY-RECORD.
 10520
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 194
* EL6311.cbl
 10522
 10523******************************************************************
 10524*                                                                *
 10525*            A D D   I S S U E   R O U T I N E                   *
 10526*                                                                *
 10527******************************************************************
 10528
 10529***************************************************************
 10530*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10531*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10532*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10533*     4. LINK TO THE EDIT ROUTINE.                            *
 10534*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10535*     6. WRITE THE NEW ISSUE RECORD.                          *
 10536*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10537*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10538*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10539*        ELSE                                                 *
 10540*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10541***************************************************************
 10542
 10543 1200-ADD-ISSUE-ROUTINE.
 10544     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10545
 10546
 10547* EXEC CICS GETMAIN
 10548*        SET     (ADDRESS OF PENDING-BUSINESS)
 10549*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10550*    END-EXEC.
 10551*    MOVE '," L                  $   #00010388' TO DFHEIV0
 10552     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10553     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10554     MOVE X'2020233030303130333838' TO DFHEIV0(25:11)
 10555     CALL 'kxdfhei1' USING DFHEIV0,
 10556           DFHEIV20,
 10557           ERPNDB-RECORD-LENGTH,
 10558           DFHEIV99
 10559     SET ADDRESS OF PENDING-BUSINESS TO
 10560         DFHEIV20
 10561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10562
 10563
 10564
 10565* EXEC CICS HANDLE CONDITION
 10566*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10567*    END-EXEC.
 10568*    MOVE '"$I                   ! # #00010393' TO DFHEIV0
 10569     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10571     MOVE X'2320233030303130333933' TO DFHEIV0(25:11)
 10572     CALL 'kxdfhei1' USING DFHEIV0
 10573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10574
 10575
 10576     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10577     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10578     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10579
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 195
* EL6311.cbl
 10580
 10581* EXEC CICS READ
 10582*        INTO    (PENDING-BUSINESS)
 10583*        DATASET (FILE-ID-ERPNDB)
 10584*        RIDFLD  (ERPNDB-KEY)
 10585*    END-EXEC.
 10586     MOVE LENGTH OF
 10587      PENDING-BUSINESS
 10588       TO DFHEIV11
 10589*    MOVE '&"IL       E          (   #00010401' TO DFHEIV0
 10590     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10592     MOVE X'2020233030303130343031' TO DFHEIV0(25:11)
 10593     CALL 'kxdfhei1' USING DFHEIV0,
 10594           FILE-ID-ERPNDB,
 10595           PENDING-BUSINESS,
 10596           DFHEIV11,
 10597           ERPNDB-KEY,
 10598           DFHEIV99,
 10599           DFHEIV99,
 10600           DFHEIV99
 10601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10602
 10603
 10604     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10605
 10606     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10607     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10608     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10609     MOVE SPACES                 TO PENDING-BUSINESS.
 10610     MOVE 'PB'                   TO PB-RECORD-ID.
 10611     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10612     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10613     MOVE SPACES                 TO PB-CERT-SFX.
 10614     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10615     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10616                                    PB-ALT-CHG-SEQ-NO.
 10617
 10618     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10619     MOVE '1'                    TO PB-RECORD-TYPE.
 10620
 10621     IF BSUFIXL NOT = ZEROS
 10622        MOVE BSUFIXI             TO PB-CERT-SFX.
 10623
 10624     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10625
 10626     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10627     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10628
 10629     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10630                                    PB-I-LF-PREM-CALC
 10631                                    PB-I-LF-ALT-PREM-CALC
 10632                                    PB-I-LF-RATE
 10633                                    PB-I-LF-ALT-RATE
 10634                                    PB-I-LF-REI-RATE
 10635                                    PB-I-LF-ALT-REI-RATE
 10636                                    PB-I-RATE-DEV-PCT-LF
 10637                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 196
* EL6311.cbl
 10638                                    PB-I-AH-RATE
 10639                                    PB-I-AH-REI-RATE
 10640                                    PB-I-AH-RATE-TRM
 10641                                    PB-I-RATE-DEV-PCT-AH
 10642                                    PB-I-BUSINESS-TYPE
 10643                                    PB-I-LIFE-COMMISSION
 10644                                    PB-I-JOINT-COMMISSION
 10645                                    PB-I-JOINT-AGE
 10646                                    PB-I-AH-COMMISSION
 10647                                    PB-I-CURR-SEQ
 10648                                    PB-CHG-COUNT
 10649                                    PB-LF-BILLED-AMTS
 10650                                    PB-AH-BILLED-AMTS
 10651                                    PB-CALC-TOLERANCE
 10652                                    PB-I-EXTENTION-DAYS
 10653*                                   PB-I-MICROFILM-NO
 10654                                    PB-I-TERM-IN-DAYS.
 10655
 10656     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10657                                    PB-I-LF-EXPIRE-DT
 10658                                    PB-I-AH-EXPIRE-DT
 10659                                    PB-BILLED-DT
 10660                                    PB-ACCT-EFF-DT
 10661                                    PB-ACCT-EXP-DT
 10662                                    PB-I-1ST-PMT-DT.
 10663
 10664     MOVE 'X'                    TO PB-FATAL-FLAG.
 10665
 10666     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10667
 10668     IF BLSTNML GREATER THAN ZEROS
 10669         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10670
 10671*    IF BMICRNOL  GREATER  ZEROS
 10672*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10673*    ELSE
 10674*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10675     IF BVINL > ZEROS
 10676        MOVE BVINI               TO PB-I-VIN
 10677     END-IF
 10678     IF B1STNML GREATER THAN ZEROS
 10679         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10680
 10681     IF BINITL  GREATER THAN ZEROS
 10682         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10683
 10684     IF BBIRTHL GREATER THAN ZERO
 10685         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10686     ELSE
 10687         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10688
 10689     IF B1STPMTL GREATER THAN ZERO
 10690         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10691     ELSE
 10692         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10693
 10694     IF BAGEL    GREATER THAN ZEROS
 10695         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 197
* EL6311.cbl
 10696        ELSE
 10697         MOVE ZEROS              TO PB-I-AGE.
 10698
 10699     IF BSEXL    GREATER THAN ZEROS
 10700         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10701
 10702     IF BTERM-LEN (1) GREATER THAN ZEROS
 10703        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10704     ELSE
 10705        MOVE ZEROS               TO PB-I-LF-TERM.
 10706
 10707     IF BTERM-LEN (2) GREATER THAN ZEROS
 10708        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10709     ELSE
 10710        MOVE ZEROS               TO PB-I-AH-TERM.
 10711
 10712     IF BLNTRML       GREATER THAN ZEROS
 10713         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10714        ELSE
 10715         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10716
 10717     IF BFREQL        GREATER THAN ZEROS
 10718         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10719        ELSE
 10720         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10721
 10722     IF BSKPCDL       GREATER THAN ZEROS
 10723         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10724
 10725     IF BMODEL        GREATER THAN ZEROS
 10726         MOVE BMODEI             TO PB-I-TERM-TYPE
 10727                                    PI-BMODE.
 10728
 10729     IF BPMTSL        GREATER THAN ZEROS
 10730         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10731                                    PI-BPMTS
 10732        ELSE
 10733         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10734                                    PI-BPMTS.
 10735
 10736     IF BPMTAMTL      GREATER THAN ZEROS
 10737         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10738        ELSE
 10739         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10740
 10741     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10742        IF BTYPE  (1)   NOT = ZEROS
 10743           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10744                                    PI-BTYPE (1)
 10745           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10746           MOVE SPACES           TO PB-I-LF-ABBR
 10747        ELSE
 10748           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10749                                    PB-I-LF-ABBR
 10750           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10751     ELSE
 10752        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10753                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 198
* EL6311.cbl
 10754        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10755
 10756     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10757         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10758     ELSE
 10759         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10760
 10761     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10762         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10763     ELSE
 10764         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10765
 10766     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10767         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10768            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10769            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10770         ELSE
 10771            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10772*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10773*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10774         END-IF
 10775     ELSE
 10776         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10777
 10778     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10779         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10780
 10781     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10782         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10783         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10784     ELSE
 10785         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10786
 10787     IF  BALT-PREM-LEN     (2) > ZEROS
 10788         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10789     ELSE
 10790         MOVE ZEROS            TO PB-I-TOT-FEES.
 10791
 10792     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10793        IF BTYPE      (2)   NOT = ZEROS
 10794           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10795                                  PI-BTYPE (2)
 10796           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10797           MOVE SPACES         TO PB-I-AH-ABBR
 10798        ELSE
 10799           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10800                                  PB-I-AH-ABBR
 10801           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10802     ELSE
 10803        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10804                                  PB-I-AH-ABBR
 10805        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10806
 10807     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10808         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10809     ELSE
 10810         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10811
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 199
* EL6311.cbl
 10812     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10813         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10814            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10815            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10816         ELSE
 10817            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10818*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10819*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10820         END-IF
 10821     ELSE
 10822         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10823
 10824     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10825         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10826
 10827     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10828        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10829     ELSE
 10830        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10831
 10832     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10833        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10834     ELSE
 10835        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10836
 10837     IF BINDGRPL  GREATER THAN ZEROS
 10838         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10839
 10840     IF BRTCLSL   GREATER THAN ZEROS
 10841         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10842
 10843     IF BSIGL     GREATER THAN ZEROS
 10844         MOVE BSIGI              TO PB-I-SIG-SW.
 10845     IF BAPRL > ZEROS
 10846         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10847     ELSE
 10848        if pi-company-id = 'CID'
 10849           move +99.9999         to pb-i-loan-apr
 10850        else
 10851           MOVE ZEROS            TO PB-I-LOAN-APR
 10852        end-if
 10853     end-if
 10854     IF BMEMBERL  GREATER THAN ZEROS
 10855         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10856
 10857     IF BLNOFCRL  GREATER THAN ZEROS
 10858         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10859
 10860     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10861        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10862     ELSE
 10863        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10864
 10865     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10866        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10867     ELSE
 10868        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10869
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 200
* EL6311.cbl
 10870     IF BDAYSL   GREATER THAN ZEROS
 10871        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10872                                    PB-I-EXTENTION-DAYS
 10873     ELSE
 10874        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10875                                    PB-I-EXTENTION-DAYS.
 10876
 10877     IF BDAYSL GREATER THAN ZEROS
 10878        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10879
 10880     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10881        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10882           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10883
 10884     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10885        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10886           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10887
 10888     IF B1STPMTL GREATER THAN ZEROS
 10889        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10890
 10891     IF PB-EXT-DAYS-PROCESSING
 10892        IF PB-I-EXTENTION-DAYS = ZEROS
 10893           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10894
 10895     IF PB-EXPIRE-DT-PROCESSING
 10896        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10897           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10898             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10899
 10900     IF PB-1ST-PMT-DT-PROCESSING
 10901        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10902           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10903
 10904     IF BREINL GREATER THAN ZEROS
 10905        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10906
 10907     IF BENTRYL NOT = ZEROS
 10908        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10909        IF PI-COMPANY-ID = 'CID'
 10910           AND (PB-BATCH-ENTRY = 'P')
 10911           AND (PB-STATE = 'VA')
 10912           PERFORM 1500-UPDATE-ERNOTE
 10913                                 THRU 1500-EXIT
 10914        END-IF
 10915     END-IF
 10916     IF BUNWRITL NOT = ZEROS
 10917        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10918
 10919     IF BFORCEL NOT = ZEROS
 10920        MOVE BFORCEI             TO PB-FORCE-CODE.
 10921
 10922     IF BBILCDL NOT = ZEROS
 10923        MOVE BBILCDI             TO PB-RECORD-BILL.
 10924
 10925     IF BLIVESL GREATER THAN ZEROS
 10926        MOVE WS-BLIVES           TO PB-I-LIVES
 10927     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 201
* EL6311.cbl
 10928        MOVE ZEROS               TO PB-I-LIVES.
 10929
 10930     IF BBILLEDL GREATER THAN ZEROS
 10931        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10932     ELSE
 10933        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10934
 10935*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10936
 10937 1260-WRITE-PB-RECORD.
 10938     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10939                                    PB-INPUT-BY.
 10940     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10941     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10942                                    PB-INPUT-DT.
 10943
 10944     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10945     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10946                                    PB-CONTROL-BY-ORIG-BATCH.
 10947
 10948
 10949     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10950     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10951     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10952     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10953     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10954
 10955     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10956
 10957     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10958
 10959     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10960     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10961     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10962
 10963     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10964     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10965
 10966 1275-WRITE-PENDING-BUSINESS.
 10967     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10968     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10969     MOVE 'A'                    TO JP-RECORD-TYPE.
 10970     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10971
 10972
 10973* EXEC CICS HANDLE CONDITION
 10974*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10975*    END-EXEC.
 10976*    MOVE '"$%                   ! $ #00010775' TO DFHEIV0
 10977     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10978     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10979     MOVE X'2420233030303130373735' TO DFHEIV0(25:11)
 10980     CALL 'kxdfhei1' USING DFHEIV0
 10981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10982
 10983
 10984
 10985* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 202
* EL6311.cbl
 10986*        DATASET (FILE-ID-ERPNDB)
 10987*        FROM    (PENDING-BUSINESS)
 10988*        RIDFLD  (PB-CONTROL-PRIMARY)
 10989*    END-EXEC.
 10990     MOVE LENGTH OF
 10991      PENDING-BUSINESS
 10992       TO DFHEIV11
 10993*    MOVE '&$ L                  ''   #00010779' TO DFHEIV0
 10994     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10995     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10996     MOVE X'2020233030303130373739' TO DFHEIV0(25:11)
 10997     CALL 'kxdfhei1' USING DFHEIV0,
 10998           FILE-ID-ERPNDB,
 10999           PENDING-BUSINESS,
 11000           DFHEIV11,
 11001           PB-CONTROL-PRIMARY,
 11002           DFHEIV99,
 11003           DFHEIV99
 11004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11005
 11006
 11007     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11008
 11009     PERFORM 8400-LOG-JOURNAL-RECORD.
 11010
 11011******************************************************************
 11012*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11013******************************************************************
 11014     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11015     MOVE ' '                    TO WS-ERMAIL-SW
 11016
 11017* EXEC CICS READ
 11018*       DATASET   (FILE-ID-ERMAIL)
 11019*       SET       (ADDRESS OF MAILING-DATA)
 11020*       RIDFLD    (ERMAIL-KEY)
 11021*       RESP      (WS-RESPONSE)
 11022*    END-EXEC
 11023*    MOVE '&"S        E          (  N#00010795' TO DFHEIV0
 11024     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11025     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11026     MOVE X'204E233030303130373935' TO DFHEIV0(25:11)
 11027     CALL 'kxdfhei1' USING DFHEIV0,
 11028           FILE-ID-ERMAIL,
 11029           DFHEIV20,
 11030           DFHEIV99,
 11031           ERMAIL-KEY,
 11032           DFHEIV99,
 11033           DFHEIV99,
 11034           DFHEIV99
 11035     SET ADDRESS OF MAILING-DATA TO
 11036         DFHEIV20
 11037     MOVE EIBRESP  TO WS-RESPONSE
 11038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11039     IF RESP-NORMAL
 11040        SET ERMAIL-FOUND TO TRUE
 11041     END-IF
 11042
 11043     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 203
* EL6311.cbl
 11044     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11045     MOVE 'OC'                   TO OC-RECORD-ID
 11046     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11047                                 TO OC-CONTROL-PRIMARY (1:33)
 11048     MOVE 'I'                    TO OC-RECORD-TYPE
 11049     MOVE +4096                  TO OC-KEY-SEQ-NO
 11050     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11051     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11052     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11053     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11054     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11055     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11056     MOVE PB-I-AGE               TO OC-INS-AGE
 11057     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11058     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11059     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11060     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11061     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11062     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11063     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11064     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11065     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11066     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11067     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11068     IF PB-I-JOINT-COMMISSION > +0
 11069         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11070     ELSE
 11071         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11072     END-IF
 11073     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11074     MOVE +0                     TO OC-LF-CANCEL-AMT
 11075                                    OC-LF-ITD-CANCEL-AMT
 11076     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11077     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11078     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11079     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11080     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11081     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11082     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11083     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11084     MOVE +0                     TO OC-AH-CANCEL-AMT
 11085                                    OC-AH-ITD-CANCEL-AMT
 11086     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11087     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11088     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11089     IF ERMAIL-FOUND
 11090        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11091     END-IF
 11092     IF NOT CERT-TRL-REC-NOT-FOUND
 11093        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11094                           OC-INS-AGE-DEFAULT-FLAG
 11095        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11096                           OC-JNT-AGE-DEFAULT-FLAG
 11097     END-IF
 11098     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11099     .
 11100 1275-WRITE-ELCRTO.
 11101
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 204
* EL6311.cbl
 11102* EXEC CICS WRITE
 11103*       DATASET   ('ELCRTO')
 11104*       FROM      (ORIGINAL-CERTIFICATE)
 11105*       RIDFLD    (OC-CONTROL-PRIMARY)
 11106*       RESP      (WS-RESPONSE)
 11107*    END-EXEC
 11108     MOVE LENGTH OF
 11109      ORIGINAL-CERTIFICATE
 11110       TO DFHEIV11
 11111     MOVE 'ELCRTO' TO DFHEIV1
 11112*    MOVE '&$ L                  ''  N#00010863' TO DFHEIV0
 11113     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11114     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11115     MOVE X'204E233030303130383633' TO DFHEIV0(25:11)
 11116     CALL 'kxdfhei1' USING DFHEIV0,
 11117           DFHEIV1,
 11118           ORIGINAL-CERTIFICATE,
 11119           DFHEIV11,
 11120           OC-CONTROL-PRIMARY,
 11121           DFHEIV99,
 11122           DFHEIV99
 11123     MOVE EIBRESP  TO WS-RESPONSE
 11124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11125*    display ' just wrote 1275 ' ws-response
 11126     IF RESP-DUPKEY
 11127        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11128        GO TO 1275-WRITE-ELCRTO
 11129     ELSE
 11130        IF NOT RESP-NORMAL
 11131           MOVE -1               TO BMAINTL
 11132           MOVE ER-7450          TO EMI-ERROR
 11133           PERFORM 9900-ERROR-FORMAT
 11134                                 THRU 9900-EXIT
 11135           GO TO 8200-SEND-DATAONLY
 11136        END-IF
 11137     END-IF
 11138******************************************************************
 11139*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11140******************************************************************
 11141
 11142
 11143* EXEC CICS READ
 11144*        INTO    (PENDING-BUSINESS)
 11145*        DATASET (FILE-ID-ERPNDB)
 11146*        RIDFLD  (ERPNDB-KEY)
 11147*        UPDATE
 11148*    END-EXEC.
 11149     MOVE LENGTH OF
 11150      PENDING-BUSINESS
 11151       TO DFHEIV11
 11152*    MOVE '&"IL       EU         (   #00010886' TO DFHEIV0
 11153     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11154     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11155     MOVE X'2020233030303130383836' TO DFHEIV0(25:11)
 11156     CALL 'kxdfhei1' USING DFHEIV0,
 11157           FILE-ID-ERPNDB,
 11158           PENDING-BUSINESS,
 11159           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 205
* EL6311.cbl
 11160           ERPNDB-KEY,
 11161           DFHEIV99,
 11162           DFHEIV99,
 11163           DFHEIV99
 11164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11165
 11166
 11167     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11168     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11169     MOVE 'B'                    TO JP-RECORD-TYPE.
 11170     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11171
 11172     PERFORM 8400-LOG-JOURNAL-RECORD.
 11173
 11174     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11175
 11176
 11177* EXEC CICS REWRITE
 11178*        DATASET (FILE-ID-ERPNDB)
 11179*        FROM    (PENDING-BUSINESS)
 11180*    END-EXEC.
 11181     MOVE LENGTH OF
 11182      PENDING-BUSINESS
 11183       TO DFHEIV11
 11184*    MOVE '&& L                  %   #00010902' TO DFHEIV0
 11185     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11186     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11187     MOVE X'2020233030303130393032' TO DFHEIV0(25:11)
 11188     CALL 'kxdfhei1' USING DFHEIV0,
 11189           FILE-ID-ERPNDB,
 11190           PENDING-BUSINESS,
 11191           DFHEIV11,
 11192           DFHEIV99
 11193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11194
 11195
 11196     MOVE 'C'                    TO JP-RECORD-TYPE.
 11197     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11198
 11199     PERFORM 8400-LOG-JOURNAL-RECORD.
 11200
 11201     IF WS-ERRORS-PRESENT
 11202         GO TO 3900-RE-DISPLAY-RECORD.
 11203
 11204     MOVE ZEROS                  TO EMI-ERROR.
 11205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11206     MOVE LOW-VALUES             TO EL631BI.
 11207     MOVE  -1                    TO BMAINTL.
 11208     GO TO 8100-SEND-INITIAL-MAP.
 11209
 11210 1280-BATCH-HDR-NOT-FOUND.
 11211     MOVE -1                     TO BMAINTL.
 11212     MOVE ER-7450                TO EMI-ERROR.
 11213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11214     GO TO 8200-SEND-DATAONLY.
 11215
 11216 1290-DUPLICATE-ALT-INDEX.
 11217
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 206
* EL6311.cbl
 11218******************************************************************
 11219*                                                                *
 11220*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11221*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11222*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11223*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11224*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11225*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11226*                                                                *
 11227******************************************************************
 11228
 11229     IF LCP-ONCTR-01 =  0
 11230         ADD 1 TO LCP-ONCTR-01
 11231        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11232
 11233     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11234
 11235     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11236         NEXT SENTENCE
 11237     ELSE
 11238         ADD +1 TO PB-BATCH-SEQ-NO
 11239                   PB-CSR-BATCH-SEQ-NO
 11240         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11241         GO TO 1275-WRITE-PENDING-BUSINESS.
 11242
 11243     MOVE -1                     TO BCERTNOL.
 11244     MOVE AL-UABON               TO BCERTNOA.
 11245     MOVE AL-UNBON               TO BEFFDTA.
 11246
 11247     MOVE 1                      TO EMI-SUB
 11248                                    EMI-SWITCH1
 11249                                    EMI-SWITCH-AREA-1
 11250                                    EMI-SWITCH-AREA-2.
 11251
 11252     MOVE SPACES                 TO EMI-ERROR-LINES.
 11253
 11254
 11255* EXEC CICS SYNCPOINT ROLLBACK
 11256*    END-EXEC.
 11257*    MOVE '6"R                   !   #00010965' TO DFHEIV0
 11258     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11260     MOVE X'2020233030303130393635' TO DFHEIV0(25:11)
 11261     CALL 'kxdfhei1' USING DFHEIV0
 11262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11263
 11264
 11265     MOVE ER-2247                TO EMI-ERROR.
 11266     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11267     GO TO 8200-SEND-DATAONLY.
 11268
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 207
* EL6311.cbl
 11270
 11271
 11272 1295-READ-CERT-TRAILER.
 11273
 11274
 11275* EXEC CICS GETMAIN
 11276*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11277*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11278*        INITIMG (GETMAIN-SPACE)
 11279*    END-EXEC
 11280*    MOVE ',"IL                  $   #00010977' TO DFHEIV0
 11281     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11282     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11283     MOVE X'2020233030303130393737' TO DFHEIV0(25:11)
 11284     CALL 'kxdfhei1' USING DFHEIV0,
 11285           DFHEIV20,
 11286           ELCRTT-RECORD-LENGTH,
 11287           GETMAIN-SPACE
 11288     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11289         DFHEIV20
 11290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11291
 11292     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11293     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11294     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11295
 11296
 11297* EXEC CICS HANDLE CONDITION
 11298*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11299*    END-EXEC.
 11300*    MOVE '"$I                   ! % #00010987' TO DFHEIV0
 11301     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11302     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11303     MOVE X'2520233030303130393837' TO DFHEIV0(25:11)
 11304     CALL 'kxdfhei1' USING DFHEIV0
 11305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11306
 11307
 11308
 11309* EXEC CICS READ
 11310*        DATASET  (CRTT-ID)
 11311*        RIDFLD   (ELCRTT-KEY)
 11312*        INTO     (CERTIFICATE-TRAILERS)
 11313*    END-EXEC.
 11314     MOVE LENGTH OF
 11315      CERTIFICATE-TRAILERS
 11316       TO DFHEIV11
 11317*    MOVE '&"IL       E          (   #00010991' TO DFHEIV0
 11318     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11320     MOVE X'2020233030303130393931' TO DFHEIV0(25:11)
 11321     CALL 'kxdfhei1' USING DFHEIV0,
 11322           CRTT-ID,
 11323           CERTIFICATE-TRAILERS,
 11324           DFHEIV11,
 11325           ELCRTT-KEY,
 11326           DFHEIV99,
 11327           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 208
* EL6311.cbl
 11328           DFHEIV99
 11329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11330
 11331
 11332     GO TO 1295-EXIT.
 11333
 11334 1295-CERT-TRL-REC-NOTFND.
 11335     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11336
 11337 1295-EXIT.
 11338     EXIT.
 11339
 11340******************************************************************
 11341*                                                                *
 11342*          C H A N G E   I S S U E   R O U T I N E               *
 11343*                                                                *
 11344******************************************************************
 11345
 11346***************************************************************
 11347*                                                             *
 11348*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11349*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11350*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11351*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11352*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11353*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11354*     5. LINK TO THE EDIT ROUTINE.                            *
 11355*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11356*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11357*              THE EDIT ROUTINE.                              *
 11358*     7. REWRITE THE NEW ISSUE                                *
 11359*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11360*                                                             *
 11361***************************************************************
 11362
 11363 1300-CHANGE-ISSUE-ROUTINE.
 11364     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11365
 11366     IF BCHGL NOT = ZEROS
 11367        MOVE ER-2196             TO EMI-ERROR
 11368        MOVE AL-UABON            TO BMAINTA
 11369        MOVE -1                  TO BMAINTL
 11370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11371        GO TO 8200-SEND-DATAONLY.
 11372
 11373     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11374
 11375     IF BSUFIXL NOT = ZEROS
 11376        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11377     ELSE
 11378        MOVE SPACE               TO WS-NEW-SUFFIX.
 11379
 11380     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11381     PERFORM 8600-DEEDIT.
 11382     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11383     MOVE '4'                    TO DC-OPTION-CODE.
 11384     PERFORM 9700-DATE-LINK.
 11385     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 209
* EL6311.cbl
 11386        MOVE ER-0348             TO EMI-ERROR
 11387        MOVE -1                  TO BEFFDTL
 11388        MOVE AL-UABON            TO BEFFDTA
 11389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11390        GO TO 8200-SEND-DATAONLY
 11391     ELSE
 11392        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11393        MOVE AL-UANON            TO BEFFDTA
 11394        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11395
 11396 1325-PROCESS-ISSUE-CHANGES.
 11397
 11398* EXEC CICS HANDLE CONDITION
 11399*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11400*    END-EXEC.
 11401*    MOVE '"$I                   ! & #00011062' TO DFHEIV0
 11402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11404     MOVE X'2620233030303131303632' TO DFHEIV0(25:11)
 11405     CALL 'kxdfhei1' USING DFHEIV0
 11406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11407
 11408
 11409     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11410     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11411     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11412
 11413
 11414* EXEC CICS GETMAIN
 11415*        SET      (ADDRESS OF PENDING-BUSINESS)
 11416*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11417*        INITIMG  (GETMAIN-SPACE)
 11418*     END-EXEC.
 11419*    MOVE ',"IL                  $   #00011070' TO DFHEIV0
 11420     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11421     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11422     MOVE X'2020233030303131303730' TO DFHEIV0(25:11)
 11423     CALL 'kxdfhei1' USING DFHEIV0,
 11424           DFHEIV20,
 11425           ERPNDB-RECORD-LENGTH,
 11426           GETMAIN-SPACE
 11427     SET ADDRESS OF PENDING-BUSINESS TO
 11428         DFHEIV20
 11429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11430
 11431
 11432
 11433* EXEC CICS READ
 11434*        INTO    (PENDING-BUSINESS)
 11435*        DATASET (FILE-ID-ERPNDB)
 11436*        RIDFLD  (ERPNDB-KEY)
 11437*    END-EXEC.
 11438     MOVE LENGTH OF
 11439      PENDING-BUSINESS
 11440       TO DFHEIV11
 11441*    MOVE '&"IL       E          (   #00011076' TO DFHEIV0
 11442     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11443     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 210
* EL6311.cbl
 11444     MOVE X'2020233030303131303736' TO DFHEIV0(25:11)
 11445     CALL 'kxdfhei1' USING DFHEIV0,
 11446           FILE-ID-ERPNDB,
 11447           PENDING-BUSINESS,
 11448           DFHEIV11,
 11449           ERPNDB-KEY,
 11450           DFHEIV99,
 11451           DFHEIV99,
 11452           DFHEIV99
 11453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11454
 11455
 11456     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11457
 11458
 11459* EXEC CICS HANDLE CONDITION
 11460*         NOTFND     (1385-REC-NOT-FOUND)
 11461*    END-EXEC.
 11462*    MOVE '"$I                   ! '' #00011084' TO DFHEIV0
 11463     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11465     MOVE X'2720233030303131303834' TO DFHEIV0(25:11)
 11466     CALL 'kxdfhei1' USING DFHEIV0
 11467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11468
 11469
 11470**********************************************************
 11471*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11472*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11473**********************************************************
 11474
 11475
 11476* EXEC CICS READ
 11477*        DATASET (FILE-ID-ERPNDB)
 11478*        INTO    (PENDING-BUSINESS)
 11479*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11480*    END-EXEC.
 11481     MOVE LENGTH OF
 11482      PENDING-BUSINESS
 11483       TO DFHEIV11
 11484*    MOVE '&"IL       E          (   #00011093' TO DFHEIV0
 11485     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11487     MOVE X'2020233030303131303933' TO DFHEIV0(25:11)
 11488     CALL 'kxdfhei1' USING DFHEIV0,
 11489           FILE-ID-ERPNDB,
 11490           PENDING-BUSINESS,
 11491           DFHEIV11,
 11492           PI-PREV-CONTROL-PRIMARY,
 11493           DFHEIV99,
 11494           DFHEIV99,
 11495           DFHEIV99
 11496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11497
 11498
 11499********** DO NOT ALLOW CHANGES IF THRU A/R
 11500     IF BMAINTI = 'C'
 11501         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 211
* EL6311.cbl
 11502             MOVE ER-4005          TO EMI-ERROR
 11503             MOVE -1               TO BMAINTL
 11504             MOVE AL-UABON         TO BMAINTA
 11505             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11506             GO TO 8200-SEND-DATAONLY.
 11507**********
 11508
 11509     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11510        MOVE -1                 TO BMAINTL
 11511        MOVE ER-2197            TO EMI-ERROR
 11512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11513        GO TO 8200-SEND-DATAONLY.
 11514
 11515     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11516        MOVE ER-2196             TO EMI-ERROR
 11517        MOVE AL-UABON            TO BMAINTA
 11518        MOVE -1                  TO BMAINTL
 11519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11520        GO TO 8200-SEND-DATAONLY.
 11521
 11522     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11523
 11524     IF PB-BILLED-DT = LOW-VALUES AND
 11525        PB-CHG-COUNT = ZEROS
 11526        NEXT SENTENCE
 11527     ELSE
 11528        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11529            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11530           OR
 11531           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11532            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11533           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11534     move zeros                  to ws-check-amts
 11535     move ' '                    to ws-stop-sw
 11536                                    ws-check-sw
 11537                                    ws-proc-check-sw
 11538                                    ws-any-check-sw
 11539                                    ws-chek-browse-sw
 11540
 11541     perform 2500-browse-checks  thru 2500-exit
 11542
 11543     if i-have-processed-checks
 11544        or i-have-checks
 11545        continue
 11546     else
 11547        go to 1330-continue
 11548     end-if
 11549
 11550     compute ws-tot-orig-prem =
 11551        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11552        pb-i-lf-alt-premium-amt
 11553
 11554     if bprem1l <> zeros
 11555        MOVE AL-UNNON            TO bprem1a
 11556        move ws-bprem (1)        to ws-new-iss-total
 11557     else
 11558        move pb-i-lf-premium-amt to ws-new-iss-total
 11559     end-if
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 212
* EL6311.cbl
 11560     display ' new iss totala ' ws-new-iss-total
 11561
 11562     if baltpr1l <> zeros
 11563        MOVE AL-UNNON            TO baltpr1a
 11564        compute ws-new-iss-total =
 11565           ws-new-iss-total + ws-balt-prem(1)
 11566     else
 11567        compute ws-new-iss-total =
 11568           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11569     end-if
 11570
 11571     if bprem2l <> zeros
 11572        MOVE AL-UNNON            TO bprem2a
 11573        compute ws-new-iss-total = ws-new-iss-total +
 11574           ws-bprem (2)
 11575     else
 11576        compute ws-new-iss-total = ws-new-iss-total +
 11577           pb-i-ah-premium-amt
 11578     end-if
 11579
 11580     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11581        if ((bprem1l <> zeros)
 11582           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11583                      or
 11584           ((bprem2l <> zeros)
 11585           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11586           move er-3456          to emi-error
 11587           perform 9900-error-format
 11588                                 thru 9900-exit
 11589           go to 1330-continue
 11590        end-if
 11591     end-if
 11592
 11593     if ws-new-iss-total > ws-tot-orig-prem
 11594        move er-3458             to emi-error
 11595        perform 9900-error-format thru 9900-exit
 11596        move al-uabon            to bmainta
 11597        move -1                  to bmaintl
 11598        go to 8200-send-dataonly
 11599     end-if
 11600
 11601     if ws-new-iss-total < ws-tot-orig-prem
 11602        move er-3457             to emi-error
 11603        move al-uabon            to bprem1a
 11604                                    bprem2a
 11605        move +0 to bprem1l bprem2l
 11606        perform 9900-error-format thru 9900-exit
 11607        move -1                  to bmaintl
 11608        go to 1330-continue
 11609     end-if
 11610
 11611     .
 11612 1330-continue.
 11613
 11614
 11615* EXEC CICS READ
 11616*        DATASET (FILE-ID-ERPNDB)
 11617*        INTO    (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 213
* EL6311.cbl
 11618*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11619*        UPDATE
 11620*    END-EXEC.
 11621     MOVE LENGTH OF
 11622      PENDING-BUSINESS
 11623       TO DFHEIV11
 11624*    MOVE '&"IL       EU         (   #00011214' TO DFHEIV0
 11625     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11626     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11627     MOVE X'2020233030303131323134' TO DFHEIV0(25:11)
 11628     CALL 'kxdfhei1' USING DFHEIV0,
 11629           FILE-ID-ERPNDB,
 11630           PENDING-BUSINESS,
 11631           DFHEIV11,
 11632           PI-PREV-CONTROL-PRIMARY,
 11633           DFHEIV99,
 11634           DFHEIV99,
 11635           DFHEIV99
 11636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11637
 11638
 11639     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11640     MOVE 'B'                    TO JP-RECORD-TYPE
 11641     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11642     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11643
 11644     PERFORM 8400-LOG-JOURNAL-RECORD.
 11645
 11646     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11647        PB-CHG-COUNT NOT = ZEROS
 11648        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11649            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11650           OR
 11651           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11652            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11653            MOVE LOW-VALUES             TO PB-BILLED-DT
 11654            ADD +1                      TO PB-CHG-COUNT.
 11655
 11656     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11657     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11658     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11659     MOVE '5'                    TO DC-OPTION-CODE.
 11660     PERFORM 9700-DATE-LINK
 11661     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11662
 11663*    IF BMICRNOL  GREATER  ZEROS
 11664*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11665
 11666     IF BVINL > ZEROS
 11667        MOVE BVINI               TO PB-I-VIN
 11668     END-IF
 11669     IF (BFORCEL NOT = ZEROS)
 11670        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11671        AND (BFORCEI = ' ')
 11672        AND (PB-FORCE-CODE = 'O')
 11673        COMPUTE PB-I-AH-PREMIUM-AMT =
 11674           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11675        PERFORM 1800-REMOVE-CERT-NOTES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 214
* EL6311.cbl
 11676                                 THRU 1800-EXIT
 11677        PERFORM 1900-DELETE-ERPYAJ
 11678                                 THRU 1900-EXIT
 11679        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11680     END-IF
 11681     IF (BFORCEL NOT = ZEROS)
 11682        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11683        AND (BFORCEI = 'O')
 11684        AND (PB-FORCE-CODE NOT = 'O')
 11685        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11686           PB-I-AH-PREM-CALC
 11687        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11688        MOVE SPACE               TO DC-OPTION-CODE
 11689        PERFORM 9700-DATE-LINK
 11690        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11691        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11692        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11693        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11694        PERFORM 1500-UPDATE-ERNOTE
 11695                                 THRU 1500-EXIT
 11696        PERFORM 1600-UPDATE-ERPYAJ
 11697                                 THRU 1600-EXIT
 11698     END-IF
 11699     IF BLSTNML  GREATER THAN ZEROS
 11700         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11701
 11702     IF B1STNML  GREATER THAN ZEROS
 11703         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11704
 11705     IF BINITL   GREATER THAN ZEROS
 11706         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11707
 11708     IF BBIRTHL  GREATER THAN ZERO
 11709         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11710
 11711     IF B1STPMTL GREATER THAN ZERO
 11712         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11713
 11714     IF BAGEL    GREATER THAN ZEROS
 11715         MOVE BAGEI              TO PB-I-AGE.
 11716
 11717     MOVE 'N'                    TO WS-INS-AGE-SET
 11718                                    WS-JNT-AGE-SET.
 11719     IF BAGEL    GREATER THAN ZEROS
 11720        MOVE 'Y'                TO WS-INS-AGE-SET
 11721        IF BAGEI = ZERO AND
 11722             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11723           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11724           MOVE 'AGE*'          TO BAGEDEFO
 11725        ELSE
 11726           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11727           MOVE 'AGE '          TO BAGEDEFO
 11728        END-IF
 11729        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11730     END-IF.
 11731
 11732     IF BSEXL    GREATER THAN ZEROS
 11733         MOVE BSEXI              TO PB-I-INSURED-SEX.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 215
* EL6311.cbl
 11734
 11735     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11736        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11737
 11738     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11739        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11740
 11741     IF BLNTRML  GREATER THAN ZEROS
 11742         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11743
 11744     IF BFREQL   GREATER THAN ZEROS
 11745         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11746
 11747     IF BSKPCDL  GREATER THAN ZEROS
 11748         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11749
 11750     IF BMODEL   GREATER THAN ZEROS
 11751         MOVE BMODEI             TO PB-I-TERM-TYPE
 11752                                    PI-BMODE.
 11753
 11754     IF BPMTSL   GREATER THAN ZEROS
 11755         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11756                                    PI-BPMTS.
 11757
 11758     IF BPMTAMTL GREATER THAN ZEROS
 11759         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11760
 11761     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11762         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11763
 11764     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11765         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11766
 11767     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11768
 11769     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11770         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11771            SUBTRACT PB-I-LF-PREMIUM-AMT
 11772                     FROM WS-B-LF-ISS-PRM-ENTERED
 11773            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11774            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11775            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11776         ELSE
 11777            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11778*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11779*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11780         END-IF
 11781     END-IF.
 11782
 11783     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11784            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11785                     FROM WS-B-LF-ISS-PRM-ENTERED
 11786         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11787         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11788
 11789     IF  BALT-PREM-LEN     (2)  > ZEROS
 11790         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11791
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 216
* EL6311.cbl
 11792     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11793         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11794
 11795     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11796         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11797            SUBTRACT PB-I-AH-PREMIUM-AMT
 11798                     FROM WS-B-AH-ISS-PRM-ENTERED
 11799            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11800            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11801            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11802         ELSE
 11803            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11804*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11805*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11806         END-IF
 11807     END-IF
 11808
 11809     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11810        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11811
 11812     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11813        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11814
 11815     IF BINDGRPL            GREATER THAN ZEROS
 11816         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11817
 11818     IF BRTCLSL             GREATER THAN ZEROS
 11819         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11820
 11821     IF BSIGL               GREATER THAN ZEROS
 11822         MOVE BSIGI              TO PB-I-SIG-SW.
 11823
 11824     IF BAPRL               GREATER THAN ZEROS
 11825         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11826
 11827     IF BMEMBERL            GREATER THAN ZEROS
 11828         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11829
 11830     IF BLNOFCRL            GREATER THAN ZEROS
 11831         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11832
 11833     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11834        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11835
 11836     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11837        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11838
 11839     IF BDAYSL              GREATER THAN ZEROS
 11840        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11841                                    PB-I-EXTENTION-DAYS.
 11842
 11843     IF BDAYSL GREATER THAN ZEROS
 11844        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11845
 11846     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11847        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11848           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11849
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 217
* EL6311.cbl
 11850     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11851        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11852           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11853
 11854     IF B1STPMTL GREATER THAN ZEROS
 11855        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11856
 11857     IF PB-EXT-DAYS-PROCESSING
 11858        IF PB-I-EXTENTION-DAYS = ZEROS
 11859           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11860
 11861     IF PB-EXPIRE-DT-PROCESSING
 11862        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11863           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11864             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11865
 11866     IF PB-1ST-PMT-DT-PROCESSING
 11867        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11868           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11869
 11870     IF BREINL GREATER THAN ZEROS
 11871        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11872
 11873     IF BFORCEL NOT = ZEROS
 11874        MOVE BFORCEI             TO PB-FORCE-CODE.
 11875     IF (BENTRYL NOT = ZEROS)
 11876        AND (PB-COMPANY-ID = 'CID')
 11877        AND (PB-STATE = 'VA')
 11878        AND (BENTRYI NOT = 'P')
 11879        AND (PB-BATCH-ENTRY = 'P')
 11880        PERFORM 1800-REMOVE-CERT-NOTES
 11881                                 THRU 1800-EXIT
 11882     END-IF
 11883     IF BENTRYL NOT = ZEROS
 11884        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11885        IF PI-COMPANY-ID = 'CID'
 11886           AND (PB-BATCH-ENTRY = 'P')
 11887           AND (PB-STATE = 'VA')
 11888           PERFORM 1500-UPDATE-ERNOTE
 11889                                 THRU 1500-EXIT
 11890        END-IF
 11891     END-IF
 11892
 11893     IF BUNWRITL NOT = ZEROS
 11894        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11895
 11896     IF BBILCDL NOT = ZEROS
 11897        MOVE BBILCDI             TO PB-RECORD-BILL.
 11898
 11899     IF BLIVESL GREATER THAN ZEROS
 11900        MOVE WS-BLIVES           TO PB-I-LIVES.
 11901
 11902
 11903*DMD CUSTOM CODING*************START
 11904     IF PI-COMPANY-ID NOT = 'DMD'
 11905         MOVE ZEROS               TO BBILLEDL.
 11906*DMD CUSTOM CODING*************END
 11907
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 218
* EL6311.cbl
 11908     IF BBILLEDL GREATER THAN ZEROS
 11909        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11910
 11911
 11912*****************************************************************
 11913*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11914*****************************************************************
 11915
 11916     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11917        IF BTYPE  (1)   = ZEROS OR SPACES
 11918           IF REMOVE-LF-COVERAGE
 11919               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11920                                        PI-BTYPE (1)
 11921               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11922                                        WS-B-LF-ISS-PRM-ENTERED
 11923               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11924                                        WS-B-LF-ISS-PRM-ENTERED
 11925               SUBTRACT PB-I-LF-PREM-CALC FROM
 11926                                        WS-B-LF-ISS-PRM-COMPUTED
 11927               MOVE ZEROS            TO PB-I-LF-TERM
 11928                                        PB-I-LF-BENEFIT-AMT
 11929                                        PB-I-LF-PREMIUM-AMT
 11930                                        PB-I-LF-BENEFIT-CD
 11931                                        PB-I-LF-PREM-CALC
 11932                                        PB-I-LF-CRIT-PER
 11933                                        PB-I-LF-ALT-BENEFIT-AMT
 11934                                        PB-I-LF-ALT-PREMIUM-AMT
 11935               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11936           ELSE
 11937               NEXT SENTENCE
 11938        ELSE
 11939           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11940                                    PI-BTYPE (1).
 11941     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11942        IF BTYPE  (2)   = ZEROS OR SPACES
 11943           IF  REMOVE-AH-COVERAGE
 11944               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11945                                        PI-BTYPE (2)
 11946               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11947                                        WS-B-AH-ISS-PRM-ENTERED
 11948               SUBTRACT PB-I-AH-PREM-CALC FROM
 11949                                        WS-B-AH-ISS-PRM-COMPUTED
 11950               MOVE ZEROS            TO PB-I-AH-TERM
 11951                                        PB-I-AH-BENEFIT-AMT
 11952                                        PB-I-AH-PREMIUM-AMT
 11953                                        PB-I-AH-BENEFIT-CD
 11954                                        PB-I-AH-PREM-CALC
 11955                                        PB-I-AH-CRIT-PER
 11956               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11957           ELSE
 11958               NEXT SENTENCE
 11959        ELSE
 11960           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11961                                    PI-BTYPE (2).
 11962 1360-REWRITE-PB-RECORD.
 11963     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11964
 11965     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 219
* EL6311.cbl
 11966     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11967
 11968     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11969
 11970     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11971     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11972
 11973     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11974         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11975
 11976     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11977         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11978
 11979     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11980
 11981     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11982
 11983     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11984
 11985     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11986     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11987     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11988
 11989     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11990     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11991
 11992 1375-REWRITE-PB-RECORD.
 11993     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11994     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11995     MOVE 'C'                    TO JP-RECORD-TYPE.
 11996     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11997
 11998
 11999* EXEC CICS REWRITE
 12000*        DATASET (FILE-ID-ERPNDB)
 12001*        FROM    (PENDING-BUSINESS)
 12002*    END-EXEC.
 12003     MOVE LENGTH OF
 12004      PENDING-BUSINESS
 12005       TO DFHEIV11
 12006*    MOVE '&& L                  %   #00011580' TO DFHEIV0
 12007     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12008     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12009     MOVE X'2020233030303131353830' TO DFHEIV0(25:11)
 12010     CALL 'kxdfhei1' USING DFHEIV0,
 12011           FILE-ID-ERPNDB,
 12012           PENDING-BUSINESS,
 12013           DFHEIV11,
 12014           DFHEIV99
 12015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12016
 12017
 12018     PERFORM 8400-LOG-JOURNAL-RECORD.
 12019******************************************************************
 12020*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12021******************************************************************
 12022     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12023     MOVE ' '                    TO WS-ERMAIL-SW
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 220
* EL6311.cbl
 12024
 12025* EXEC CICS READ
 12026*       DATASET   (FILE-ID-ERMAIL)
 12027*       SET       (ADDRESS OF MAILING-DATA)
 12028*       RIDFLD    (ERMAIL-KEY)
 12029*       RESP      (WS-RESPONSE)
 12030*    END-EXEC
 12031*    MOVE '&"S        E          (  N#00011591' TO DFHEIV0
 12032     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12034     MOVE X'204E233030303131353931' TO DFHEIV0(25:11)
 12035     CALL 'kxdfhei1' USING DFHEIV0,
 12036           FILE-ID-ERMAIL,
 12037           DFHEIV20,
 12038           DFHEIV99,
 12039           ERMAIL-KEY,
 12040           DFHEIV99,
 12041           DFHEIV99,
 12042           DFHEIV99
 12043     SET ADDRESS OF MAILING-DATA TO
 12044         DFHEIV20
 12045     MOVE EIBRESP  TO WS-RESPONSE
 12046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12047     IF RESP-NORMAL
 12048        SET ERMAIL-FOUND TO TRUE
 12049     END-IF
 12050
 12051     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12052     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12053                                 TO ELCRTO-KEY
 12054     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12055     MOVE +0                     TO ELCRTO-SEQ-NO
 12056
 12057* EXEC CICS READ
 12058*       DATASET   ('ELCRTO')
 12059*       INTO      (ORIGINAL-CERTIFICATE)
 12060*       RIDFLD    (ELCRTO-KEY)
 12061*       GTEQ
 12062*       RESP      (WS-RESPONSE)
 12063*    END-EXEC
 12064     MOVE LENGTH OF
 12065      ORIGINAL-CERTIFICATE
 12066       TO DFHEIV11
 12067     MOVE 'ELCRTO' TO DFHEIV1
 12068*    MOVE '&"IL       G          (  N#00011606' TO DFHEIV0
 12069     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12071     MOVE X'204E233030303131363036' TO DFHEIV0(25:11)
 12072     CALL 'kxdfhei1' USING DFHEIV0,
 12073           DFHEIV1,
 12074           ORIGINAL-CERTIFICATE,
 12075           DFHEIV11,
 12076           ELCRTO-KEY,
 12077           DFHEIV99,
 12078           DFHEIV99,
 12079           DFHEIV99
 12080     MOVE EIBRESP  TO WS-RESPONSE
 12081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 221
* EL6311.cbl
 12082*    display ' just read gteq ' ws-response
 12083     IF RESP-NORMAL
 12084        AND (OC-CONTROL-PRIMARY (1:33) =
 12085                 PB-CONTROL-BY-ACCOUNT (1:33))
 12086        AND (OC-RECORD-TYPE = 'I')
 12087        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12088           display ' csr edit session ' PI-CSR-SESSION-SW
 12089           IF NOT CSR-EDIT-SESSION
 12090
 12091* EXEC CICS READ
 12092*                DATASET   ('ELCRTO')
 12093*                INTO      (ORIGINAL-CERTIFICATE)
 12094*                RIDFLD    (OC-CONTROL-PRIMARY)
 12095*                UPDATE
 12096*                RESP      (WS-RESPONSE)
 12097*             END-EXEC
 12098     MOVE LENGTH OF
 12099      ORIGINAL-CERTIFICATE
 12100       TO DFHEIV11
 12101     MOVE 'ELCRTO' TO DFHEIV1
 12102*    MOVE '&"IL       EU         (  N#00011623' TO DFHEIV0
 12103     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12104     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12105     MOVE X'204E233030303131363233' TO DFHEIV0(25:11)
 12106     CALL 'kxdfhei1' USING DFHEIV0,
 12107           DFHEIV1,
 12108           ORIGINAL-CERTIFICATE,
 12109           DFHEIV11,
 12110           OC-CONTROL-PRIMARY,
 12111           DFHEIV99,
 12112           DFHEIV99,
 12113           DFHEIV99
 12114     MOVE EIBRESP  TO WS-RESPONSE
 12115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12116              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12117              IF RESP-NORMAL
 12118                 display ' good read upd '
 12119                 MOVE PB-I-INSURED-LAST-NAME TO
 12120                         OC-INS-LAST-NAME
 12121                 MOVE PB-I-INSURED-FIRST-NAME TO
 12122                         OC-INS-FIRST-NAME
 12123                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 12124                         OC-INS-MIDDLE-INIT
 12125                 MOVE PB-I-AGE         TO OC-INS-AGE
 12126                 MOVE PB-I-JOINT-LAST-NAME   TO
 12127                         OC-JNT-LAST-NAME
 12128                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12129                         OC-JNT-FIRST-NAME
 12130                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12131                         OC-JNT-MIDDLE-INIT
 12132                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12133                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12134                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12135                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12136                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12137                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12138                         OC-LF-ALT-BEN-AMT
 12139                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 222
* EL6311.cbl
 12140                         OC-LF-ALT-PRM-AMT
 12141                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12142                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12143                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12144                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12145                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12146                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12147                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12148                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12149                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12150                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12151                 IF OC-CANCEL-TRAN-IND = 'N'
 12152                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12153                    MOVE +0            TO OC-LF-CANCEL-AMT
 12154                                          OC-LF-ITD-CANCEL-AMT
 12155                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12156                    MOVE +0            TO OC-AH-CANCEL-AMT
 12157                                          OC-AH-ITD-CANCEL-AMT
 12158                 END-IF
 12159                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12160                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12161                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12162                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12163                 IF ERMAIL-FOUND
 12164                    MOVE MA-CRED-BENE-NAME
 12165                                 TO OC-CRED-BENE-NAME
 12166                 END-IF
 12167                 IF NOT CERT-TRL-REC-NOT-FOUND
 12168                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12169                           OC-INS-AGE-DEFAULT-FLAG
 12170                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12171                           OC-JNT-AGE-DEFAULT-FLAG
 12172                 END-IF
 12173
 12174* EXEC CICS REWRITE
 12175*                   DATASET   ('ELCRTO')
 12176*                   FROM      (ORIGINAL-CERTIFICATE)
 12177*                   RESP      (WS-RESPONSE)
 12178*                END-EXEC
 12179     MOVE LENGTH OF
 12180      ORIGINAL-CERTIFICATE
 12181       TO DFHEIV11
 12182     MOVE 'ELCRTO' TO DFHEIV1
 12183*    MOVE '&& L                  %  N#00011687' TO DFHEIV0
 12184     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12185     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12186     MOVE X'204E233030303131363837' TO DFHEIV0(25:11)
 12187     CALL 'kxdfhei1' USING DFHEIV0,
 12188           DFHEIV1,
 12189           ORIGINAL-CERTIFICATE,
 12190           DFHEIV11,
 12191           DFHEIV99
 12192     MOVE EIBRESP  TO WS-RESPONSE
 12193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12194                 display ' just rewrote ' ws-response
 12195              END-IF
 12196           END-IF
 12197        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 223
* EL6311.cbl
 12198           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12199           MOVE 'OC'             TO OC-RECORD-ID
 12200           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12201           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12202           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12203           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12204           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12205           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12206           MOVE PB-I-AGE         TO OC-INS-AGE
 12207           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12208           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12209           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12210           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12211           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12212           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12213           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12214           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12215           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12216           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12217           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12218           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12219           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12220           MOVE +0               TO OC-LF-CANCEL-AMT
 12221                                    OC-LF-ITD-CANCEL-AMT
 12222           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12223           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12224           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12225           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12226           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12227           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12228           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12229           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12230           MOVE +0               TO OC-AH-CANCEL-AMT
 12231                                    OC-AH-ITD-CANCEL-AMT
 12232           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12233           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12234           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12235           IF ERMAIL-FOUND
 12236              MOVE MA-CRED-BENE-NAME
 12237                                 TO OC-CRED-BENE-NAME
 12238           END-IF
 12239           IF NOT CERT-TRL-REC-NOT-FOUND
 12240              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12241                           OC-INS-AGE-DEFAULT-FLAG
 12242              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12243                           OC-JNT-AGE-DEFAULT-FLAG
 12244           END-IF
 12245           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12246
 12247* EXEC CICS WRITE
 12248*             DATASET   ('ELCRTO')
 12249*             FROM      (ORIGINAL-CERTIFICATE)
 12250*             RIDFLD    (OC-CONTROL-PRIMARY)
 12251*             RESP      (WS-RESPONSE)
 12252*          END-EXEC
 12253     MOVE LENGTH OF
 12254      ORIGINAL-CERTIFICATE
 12255       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 224
* EL6311.cbl
 12256     MOVE 'ELCRTO' TO DFHEIV1
 12257*    MOVE '&$ L                  ''  N#00011744' TO DFHEIV0
 12258     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12259     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12260     MOVE X'204E233030303131373434' TO DFHEIV0(25:11)
 12261     CALL 'kxdfhei1' USING DFHEIV0,
 12262           DFHEIV1,
 12263           ORIGINAL-CERTIFICATE,
 12264           DFHEIV11,
 12265           OC-CONTROL-PRIMARY,
 12266           DFHEIV99,
 12267           DFHEIV99
 12268     MOVE EIBRESP  TO WS-RESPONSE
 12269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12270        END-IF
 12271     ELSE
 12272        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12273        MOVE 'OC'                TO OC-RECORD-ID
 12274        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12275                                 TO OC-CONTROL-PRIMARY (1:33)
 12276        MOVE 'I'                 TO OC-RECORD-TYPE
 12277        MOVE +4096               TO OC-KEY-SEQ-NO
 12278        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12279        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12280        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12281        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12282        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12283        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12284        MOVE PB-I-AGE            TO OC-INS-AGE
 12285        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12286        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12287        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12288        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12289        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12290        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12291        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12292        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12293        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12294        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12295        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12296        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12297        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12298        MOVE +0                  TO OC-LF-CANCEL-AMT
 12299                                    OC-LF-ITD-CANCEL-AMT
 12300        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12301        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12302        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12303        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12304        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12305        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12306        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12307        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12308        MOVE +0                  TO OC-AH-CANCEL-AMT
 12309                                    OC-AH-ITD-CANCEL-AMT
 12310        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12311        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12312        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12313        IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 225
* EL6311.cbl
 12314           MOVE MA-CRED-BENE-NAME
 12315                                 TO OC-CRED-BENE-NAME
 12316        END-IF
 12317        IF NOT CERT-TRL-REC-NOT-FOUND
 12318           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12319                           OC-INS-AGE-DEFAULT-FLAG
 12320           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12321                           OC-JNT-AGE-DEFAULT-FLAG
 12322        END-IF
 12323        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12324
 12325* EXEC CICS WRITE
 12326*          DATASET   ('ELCRTO')
 12327*          FROM      (ORIGINAL-CERTIFICATE)
 12328*          RIDFLD    (OC-CONTROL-PRIMARY)
 12329*          RESP      (WS-RESPONSE)
 12330*       END-EXEC
 12331     MOVE LENGTH OF
 12332      ORIGINAL-CERTIFICATE
 12333       TO DFHEIV11
 12334     MOVE 'ELCRTO' TO DFHEIV1
 12335*    MOVE '&$ L                  ''  N#00011804' TO DFHEIV0
 12336     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12337     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12338     MOVE X'204E233030303131383034' TO DFHEIV0(25:11)
 12339     CALL 'kxdfhei1' USING DFHEIV0,
 12340           DFHEIV1,
 12341           ORIGINAL-CERTIFICATE,
 12342           DFHEIV11,
 12343           OC-CONTROL-PRIMARY,
 12344           DFHEIV99,
 12345           DFHEIV99
 12346     MOVE EIBRESP  TO WS-RESPONSE
 12347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12348     END-IF
 12349******************************************************************
 12350*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12351******************************************************************
 12352
 12353     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12354     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12355
 12356
 12357* EXEC CICS READ
 12358*        INTO    (PENDING-BUSINESS)
 12359*        DATASET (FILE-ID-ERPNDB)
 12360*        RIDFLD  (ERPNDB-KEY)
 12361*        UPDATE
 12362*    END-EXEC.
 12363     MOVE LENGTH OF
 12364      PENDING-BUSINESS
 12365       TO DFHEIV11
 12366*    MOVE '&"IL       EU         (   #00011818' TO DFHEIV0
 12367     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12368     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12369     MOVE X'2020233030303131383138' TO DFHEIV0(25:11)
 12370     CALL 'kxdfhei1' USING DFHEIV0,
 12371           FILE-ID-ERPNDB,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 226
* EL6311.cbl
 12372           PENDING-BUSINESS,
 12373           DFHEIV11,
 12374           ERPNDB-KEY,
 12375           DFHEIV99,
 12376           DFHEIV99,
 12377           DFHEIV99
 12378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12379
 12380
 12381     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12382     MOVE 'B'                    TO JP-RECORD-TYPE.
 12383     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12384
 12385     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12386
 12387     PERFORM 8400-LOG-JOURNAL-RECORD.
 12388
 12389     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12390
 12391     MOVE 'C'                    TO JP-RECORD-TYPE.
 12392     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12393
 12394
 12395* EXEC CICS REWRITE
 12396*        DATASET    (FILE-ID-ERPNDB)
 12397*        FROM       (PENDING-BUSINESS)
 12398*    END-EXEC.
 12399     MOVE LENGTH OF
 12400      PENDING-BUSINESS
 12401       TO DFHEIV11
 12402*    MOVE '&& L                  %   #00011838' TO DFHEIV0
 12403     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12404     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12405     MOVE X'2020233030303131383338' TO DFHEIV0(25:11)
 12406     CALL 'kxdfhei1' USING DFHEIV0,
 12407           FILE-ID-ERPNDB,
 12408           PENDING-BUSINESS,
 12409           DFHEIV11,
 12410           DFHEIV99
 12411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12412
 12413
 12414     PERFORM 8400-LOG-JOURNAL-RECORD.
 12415
 12416     IF WS-ERRORS-PRESENT
 12417        GO TO 3900-RE-DISPLAY-RECORD.
 12418
 12419     MOVE ZEROS                  TO EMI-ERROR.
 12420     MOVE -1                     TO BMAINTL.
 12421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12422     GO TO 3900-RE-DISPLAY-RECORD.
 12423
 12424 1380-BATCH-HDR-NOT-FOUND.
 12425     MOVE -1                     TO BMAINTL.
 12426     MOVE ER-7450                TO EMI-ERROR.
 12427     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12428     GO TO 8200-SEND-DATAONLY.
 12429
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 227
* EL6311.cbl
 12430 1385-REC-NOT-FOUND.
 12431     MOVE -1                     TO BMAINTL.
 12432     MOVE ER-7451                TO EMI-ERROR.
 12433     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12434     GO TO 8200-SEND-DATAONLY.
 12435
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 228
* EL6311.cbl
 12437
 12438 1386-UPDATE-AGE-FLAGS.
 12439
 12440
 12441* EXEC CICS GETMAIN
 12442*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12443*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12444*        INITIMG (GETMAIN-SPACE)
 12445*    END-EXEC
 12446*    MOVE ',"IL                  $   #00011869' TO DFHEIV0
 12447     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12448     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12449     MOVE X'2020233030303131383639' TO DFHEIV0(25:11)
 12450     CALL 'kxdfhei1' USING DFHEIV0,
 12451           DFHEIV20,
 12452           ELCRTT-RECORD-LENGTH,
 12453           GETMAIN-SPACE
 12454     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12455         DFHEIV20
 12456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12457
 12458
 12459* EXEC CICS HANDLE CONDITION
 12460*        NOTFND   (1386-NOTFND)
 12461*    END-EXEC.
 12462*    MOVE '"$I                   ! ( #00011875' TO DFHEIV0
 12463     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12465     MOVE X'2820233030303131383735' TO DFHEIV0(25:11)
 12466     CALL 'kxdfhei1' USING DFHEIV0
 12467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12468
 12469
 12470     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12471     MOVE 'C'                TO ELCRTT-REC-TYPE
 12472
 12473
 12474* EXEC CICS READ
 12475*        UPDATE
 12476*        DATASET  (CRTT-ID)
 12477*        RIDFLD   (ELCRTT-KEY)
 12478*        INTO     (CERTIFICATE-TRAILERS)
 12479*    END-EXEC.
 12480     MOVE LENGTH OF
 12481      CERTIFICATE-TRAILERS
 12482       TO DFHEIV11
 12483*    MOVE '&"IL       EU         (   #00011882' TO DFHEIV0
 12484     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12485     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12486     MOVE X'2020233030303131383832' TO DFHEIV0(25:11)
 12487     CALL 'kxdfhei1' USING DFHEIV0,
 12488           CRTT-ID,
 12489           CERTIFICATE-TRAILERS,
 12490           DFHEIV11,
 12491           ELCRTT-KEY,
 12492           DFHEIV99,
 12493           DFHEIV99,
 12494           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 229
* EL6311.cbl
 12495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12496
 12497
 12498     IF WS-INS-AGE-SET = 'Y'
 12499        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12500     END-IF
 12501     IF WS-JNT-AGE-SET = 'Y'
 12502        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12503     END-IF
 12504
 12505
 12506* EXEC CICS REWRITE
 12507*       DATASET  (CRTT-ID)
 12508*       FROM     (CERTIFICATE-TRAILERS)
 12509*    END-EXEC.
 12510     MOVE LENGTH OF
 12511      CERTIFICATE-TRAILERS
 12512       TO DFHEIV11
 12513*    MOVE '&& L                  %   #00011896' TO DFHEIV0
 12514     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12515     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12516     MOVE X'2020233030303131383936' TO DFHEIV0(25:11)
 12517     CALL 'kxdfhei1' USING DFHEIV0,
 12518           CRTT-ID,
 12519           CERTIFICATE-TRAILERS,
 12520           DFHEIV11,
 12521           DFHEIV99
 12522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12523
 12524
 12525     GO TO 1386-EXIT.
 12526
 12527 1386-NOTFND.
 12528
 12529     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12530     MOVE 'CS'         TO CS-RECORD-ID.
 12531     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12532     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12533     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12534     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12535     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12536
 12537* EXEC CICS WRITE
 12538*       DATASET  (CRTT-ID)
 12539*       RIDFLD   (ELCRTT-KEY)
 12540*       FROM     (CERTIFICATE-TRAILERS)
 12541*    END-EXEC.
 12542     MOVE LENGTH OF
 12543      CERTIFICATE-TRAILERS
 12544       TO DFHEIV11
 12545*    MOVE '&$ L                  ''   #00011912' TO DFHEIV0
 12546     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12547     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12548     MOVE X'2020233030303131393132' TO DFHEIV0(25:11)
 12549     CALL 'kxdfhei1' USING DFHEIV0,
 12550           CRTT-ID,
 12551           CERTIFICATE-TRAILERS,
 12552           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 230
* EL6311.cbl
 12553           ELCRTT-KEY,
 12554           DFHEIV99,
 12555           DFHEIV99
 12556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12557
 12558
 12559 1386-EXIT.
 12560     EXIT.
 12561
 12562 1390-UPDATE-ERPNDM.
 12563
 12564
 12565* EXEC CICS HANDLE CONDITION
 12566*        NOTFND (1399-EXIT)
 12567*    END-EXEC.
 12568*    MOVE '"$I                   ! ) #00011923' TO DFHEIV0
 12569     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12571     MOVE X'2920233030303131393233' TO DFHEIV0(25:11)
 12572     CALL 'kxdfhei1' USING DFHEIV0
 12573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12574
 12575
 12576     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12577
 12578
 12579* EXEC CICS READ
 12580*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12581*        DATASET (FILE-ID-ERPNDM)
 12582*        RIDFLD  (ERPNDM-KEY)
 12583*        UPDATE
 12584*    END-EXEC.
 12585*    MOVE '&"S        EU         (   #00011929' TO DFHEIV0
 12586     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12587     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12588     MOVE X'2020233030303131393239' TO DFHEIV0(25:11)
 12589     CALL 'kxdfhei1' USING DFHEIV0,
 12590           FILE-ID-ERPNDM,
 12591           DFHEIV20,
 12592           DFHEIV99,
 12593           ERPNDM-KEY,
 12594           DFHEIV99,
 12595           DFHEIV99,
 12596           DFHEIV99
 12597     SET ADDRESS OF PENDING-MAILING-DATA TO
 12598         DFHEIV20
 12599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12600
 12601
 12602     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12603     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12604     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12605
 12606     IF BLSTNML GREATER THAN ZEROS
 12607         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12608
 12609     IF B1STNML GREATER  THAN ZEROS
 12610         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 231
* EL6311.cbl
 12611
 12612     IF BINITL GREATER THAN ZEROS
 12613         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12614
 12615     IF BAGEL GREATER THAN ZEROS
 12616         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12617
 12618     IF BBIRTHL GREATER THAN ZEROS
 12619         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12620
 12621     IF BSEXL GREATER THAN ZEROS
 12622         MOVE  BSEXI             TO PM-INSURED-SEX.
 12623
 12624
 12625* EXEC CICS REWRITE
 12626*        DATASET (FILE-ID-ERPNDM)
 12627*        FROM    (PENDING-MAILING-DATA)
 12628*    END-EXEC.
 12629     MOVE LENGTH OF
 12630      PENDING-MAILING-DATA
 12631       TO DFHEIV11
 12632*    MOVE '&& L                  %   #00011958' TO DFHEIV0
 12633     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12634     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12635     MOVE X'2020233030303131393538' TO DFHEIV0(25:11)
 12636     CALL 'kxdfhei1' USING DFHEIV0,
 12637           FILE-ID-ERPNDM,
 12638           PENDING-MAILING-DATA,
 12639           DFHEIV11,
 12640           DFHEIV99
 12641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12642
 12643
 12644 1399-EXIT.
 12645     EXIT.
 12646
 12647******************************************************************
 12648*                                                                *
 12649*          D E L E T E   I S S U E   R O U T I N E               *
 12650*                                                                *
 12651******************************************************************
 12652
 12653 1400-DELETE-ISSUE-ROUTINE.
 12654     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12655
 12656     IF BCHGL NOT = ZEROS
 12657        MOVE ER-2196             TO EMI-ERROR
 12658        MOVE AL-UABON            TO BMAINTA
 12659        MOVE -1                  TO BMAINTL
 12660        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12661        GO TO 8200-SEND-DATAONLY.
 12662
 12663
 12664* EXEC CICS HANDLE CONDITION
 12665*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12666*    END-EXEC.
 12667*    MOVE '"$I                   ! * #00011982' TO DFHEIV0
 12668     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 232
* EL6311.cbl
 12669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12670     MOVE X'2A20233030303131393832' TO DFHEIV0(25:11)
 12671     CALL 'kxdfhei1' USING DFHEIV0
 12672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12673
 12674
 12675     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12676     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12677     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12678
 12679
 12680* EXEC CICS READ
 12681*        SET     (ADDRESS OF PENDING-BUSINESS)
 12682*        DATASET (FILE-ID-ERPNDB)
 12683*        RIDFLD  (ERPNDB-KEY)
 12684*    END-EXEC.
 12685*    MOVE '&"S        E          (   #00011990' TO DFHEIV0
 12686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12688     MOVE X'2020233030303131393930' TO DFHEIV0(25:11)
 12689     CALL 'kxdfhei1' USING DFHEIV0,
 12690           FILE-ID-ERPNDB,
 12691           DFHEIV20,
 12692           DFHEIV99,
 12693           ERPNDB-KEY,
 12694           DFHEIV99,
 12695           DFHEIV99,
 12696           DFHEIV99
 12697     SET ADDRESS OF PENDING-BUSINESS TO
 12698         DFHEIV20
 12699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12700
 12701
 12702     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12703
 12704     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12705
 12706     IF BSUFIXL NOT = ZEROS
 12707        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12708     ELSE
 12709        MOVE SPACE               TO WS-NEW-SUFFIX.
 12710
 12711     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12712     PERFORM 8600-DEEDIT.
 12713     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12714     MOVE '4'                    TO DC-OPTION-CODE.
 12715     PERFORM 9700-DATE-LINK.
 12716     IF DATE-CONVERSION-ERROR
 12717        MOVE ER-0348             TO EMI-ERROR
 12718        MOVE -1                  TO BEFFDTL
 12719        MOVE AL-UABON            TO BEFFDTA
 12720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12721        GO TO 8200-SEND-DATAONLY
 12722     ELSE
 12723        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12724        MOVE AL-UANON            TO BEFFDTA
 12725        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12726
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 233
* EL6311.cbl
 12727
 12728* EXEC CICS HANDLE CONDITION
 12729*         NOTFND    (1490-RECORD-NOT-FOUND)
 12730*    END-EXEC.
 12731*    MOVE '"$I                   ! + #00012021' TO DFHEIV0
 12732     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12734     MOVE X'2B20233030303132303231' TO DFHEIV0(25:11)
 12735     CALL 'kxdfhei1' USING DFHEIV0
 12736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12737
 12738
 12739
 12740* EXEC CICS READ
 12741*        SET     (ADDRESS OF PENDING-BUSINESS)
 12742*        DATASET (FILE-ID-ERPNDB)
 12743*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12744*        UPDATE
 12745*    END-EXEC.
 12746*    MOVE '&"S        EU         (   #00012025' TO DFHEIV0
 12747     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12748     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12749     MOVE X'2020233030303132303235' TO DFHEIV0(25:11)
 12750     CALL 'kxdfhei1' USING DFHEIV0,
 12751           FILE-ID-ERPNDB,
 12752           DFHEIV20,
 12753           DFHEIV99,
 12754           PI-PREV-CONTROL-PRIMARY,
 12755           DFHEIV99,
 12756           DFHEIV99,
 12757           DFHEIV99
 12758     SET ADDRESS OF PENDING-BUSINESS TO
 12759         DFHEIV20
 12760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12761
 12762
 12763     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12764        MOVE -1                 TO BMAINTL
 12765        MOVE ER-2197            TO EMI-ERROR
 12766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12767        GO TO 8200-SEND-DATAONLY.
 12768
 12769     IF PB-BILLED-DT NOT = LOW-VALUES
 12770        MOVE -1                 TO BMAINTL
 12771        MOVE ER-2129            TO EMI-ERROR
 12772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12773        GO TO 8200-SEND-DATAONLY.
 12774
 12775     IF PB-CHG-COUNT NOT = ZEROS
 12776        MOVE ER-2336            TO EMI-ERROR
 12777        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12778        MOVE AL-UABON            TO BMAINTA
 12779        MOVE -1                  TO BMAINTL
 12780        GO TO 8200-SEND-DATAONLY.
 12781
 12782     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12783        PB-CHG-COUNT NOT = ZEROS
 12784        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 234
* EL6311.cbl
 12785        MOVE AL-UABON            TO BMAINTA
 12786        MOVE -1                  TO BMAINTL
 12787        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12788        GO TO 8200-SEND-DATAONLY.
 12789******************************************************************
 12790*                                                                *
 12791*       Determine if there have been any checks created          *
 12792*                                                                *
 12793******************************************************************
 12794
 12795     perform 2500-browse-checks  thru 2500-exit
 12796
 12797     if i-have-processed-checks
 12798        or i-have-checks
 12799        or i-have-a-check-period
 12800        move er-3446             to emi-error
 12801        perform 9900-error-format thru 9900-exit
 12802        move al-uabon            to bmainta
 12803        move -1                  to bmaintl
 12804        go to 8200-send-dataonly
 12805     end-if
 12806******************************************************************
 12807*                                                                *
 12808*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12809*                                                                *
 12810******************************************************************
 12811     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12812     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12813     MOVE +0                     TO ELCRTO-SEQ-NO
 12814
 12815* EXEC CICS READ
 12816*       DATASET   ('ELCRTO')
 12817*       INTO      (ORIGINAL-CERTIFICATE)
 12818*       RIDFLD    (ELCRTO-KEY)
 12819*       GTEQ
 12820*       RESP      (WS-RESPONSE)
 12821*    END-EXEC
 12822     MOVE LENGTH OF
 12823      ORIGINAL-CERTIFICATE
 12824       TO DFHEIV11
 12825     MOVE 'ELCRTO' TO DFHEIV1
 12826*    MOVE '&"IL       G          (  N#00012083' TO DFHEIV0
 12827     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12828     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12829     MOVE X'204E233030303132303833' TO DFHEIV0(25:11)
 12830     CALL 'kxdfhei1' USING DFHEIV0,
 12831           DFHEIV1,
 12832           ORIGINAL-CERTIFICATE,
 12833           DFHEIV11,
 12834           ELCRTO-KEY,
 12835           DFHEIV99,
 12836           DFHEIV99,
 12837           DFHEIV99
 12838     MOVE EIBRESP  TO WS-RESPONSE
 12839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12840     IF RESP-NORMAL
 12841        AND (OC-CONTROL-PRIMARY (1:33) =
 12842                 PB-CONTROL-BY-ACCOUNT (1:33))
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 235
* EL6311.cbl
 12843        AND (OC-RECORD-TYPE = 'I')
 12844
 12845* EXEC CICS READ
 12846*          DATASET   ('ELCRTO')
 12847*          INTO      (ORIGINAL-CERTIFICATE)
 12848*          RIDFLD    (ELCRTO-KEY)
 12849*          UPDATE
 12850*          RESP      (WS-RESPONSE)
 12851*       END-EXEC
 12852     MOVE LENGTH OF
 12853      ORIGINAL-CERTIFICATE
 12854       TO DFHEIV11
 12855     MOVE 'ELCRTO' TO DFHEIV1
 12856*    MOVE '&"IL       EU         (  N#00012094' TO DFHEIV0
 12857     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12858     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12859     MOVE X'204E233030303132303934' TO DFHEIV0(25:11)
 12860     CALL 'kxdfhei1' USING DFHEIV0,
 12861           DFHEIV1,
 12862           ORIGINAL-CERTIFICATE,
 12863           DFHEIV11,
 12864           ELCRTO-KEY,
 12865           DFHEIV99,
 12866           DFHEIV99,
 12867           DFHEIV99
 12868     MOVE EIBRESP  TO WS-RESPONSE
 12869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12870        IF RESP-NORMAL
 12871
 12872* EXEC CICS DELETE
 12873*             DATASET   ('ELCRTO')
 12874*          END-EXEC
 12875     MOVE 'ELCRTO' TO DFHEIV1
 12876*    MOVE '&(                    &   #00012102' TO DFHEIV0
 12877     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12878     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12879     MOVE X'2020233030303132313032' TO DFHEIV0(25:11)
 12880     CALL 'kxdfhei1' USING DFHEIV0,
 12881           DFHEIV1,
 12882           DFHEIV99,
 12883           DFHEIV99,
 12884           DFHEIV99,
 12885           DFHEIV99
 12886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12887        END-IF
 12888     END-IF
 12889******************************************************************
 12890*                                                                *
 12891*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12892*                                                                *
 12893******************************************************************
 12894
 12895* EXEC CICS HANDLE CONDITION
 12896*        NOTFND    (1405-DELETE-CERTIFICATE)
 12897*    END-EXEC.
 12898*    MOVE '"$I                   ! , #00012112' TO DFHEIV0
 12899     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 236
* EL6311.cbl
 12901     MOVE X'2C20233030303132313132' TO DFHEIV0(25:11)
 12902     CALL 'kxdfhei1' USING DFHEIV0
 12903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12904
 12905
 12906
 12907* EXEC CICS READ
 12908*        EQUAL
 12909*        DATASET   (FILE-ID-ERPNDM)
 12910*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12911*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12912*        UPDATE
 12913*    END-EXEC.
 12914*    MOVE '&"S        EU         (   #00012116' TO DFHEIV0
 12915     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12916     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12917     MOVE X'2020233030303132313136' TO DFHEIV0(25:11)
 12918     CALL 'kxdfhei1' USING DFHEIV0,
 12919           FILE-ID-ERPNDM,
 12920           DFHEIV20,
 12921           DFHEIV99,
 12922           PI-PREV-CONTROL-PRIMARY,
 12923           DFHEIV99,
 12924           DFHEIV99,
 12925           DFHEIV99
 12926     SET ADDRESS OF PENDING-MAILING-DATA TO
 12927         DFHEIV20
 12928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12929
 12930
 12931     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12932     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12933     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12934
 12935     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12936
 12937
 12938* EXEC CICS DELETE
 12939*        DATASET   (FILE-ID-ERPNDM)
 12940*    END-EXEC.
 12941*    MOVE '&(                    &   #00012130' TO DFHEIV0
 12942     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12943     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12944     MOVE X'2020233030303132313330' TO DFHEIV0(25:11)
 12945     CALL 'kxdfhei1' USING DFHEIV0,
 12946           FILE-ID-ERPNDM,
 12947           DFHEIV99,
 12948           DFHEIV99,
 12949           DFHEIV99,
 12950           DFHEIV99
 12951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12952
 12953
 12954******************************************************************
 12955*                PROCESS   CERTIFICATE                           *
 12956******************************************************************
 12957
 12958 1405-DELETE-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 237
* EL6311.cbl
 12959
 12960* EXEC CICS HANDLE CONDITION
 12961*         NOTFND  (1420-CONTINUE-DELETE)
 12962*    END-EXEC.
 12963*    MOVE '"$I                   ! - #00012139' TO DFHEIV0
 12964     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12965     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12966     MOVE X'2D20233030303132313339' TO DFHEIV0(25:11)
 12967     CALL 'kxdfhei1' USING DFHEIV0
 12968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12969
 12970
 12971     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12972     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12973     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12974     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12975
 12976
 12977* EXEC CICS READ
 12978*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12979*        DATASET (FILE-ID-ELCERT)
 12980*        RIDFLD  (ELCERT-KEY)
 12981*        UPDATE
 12982*    END-EXEC.
 12983*    MOVE '&"S        EU         (   #00012148' TO DFHEIV0
 12984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12985     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12986     MOVE X'2020233030303132313438' TO DFHEIV0(25:11)
 12987     CALL 'kxdfhei1' USING DFHEIV0,
 12988           FILE-ID-ELCERT,
 12989           DFHEIV20,
 12990           DFHEIV99,
 12991           ELCERT-KEY,
 12992           DFHEIV99,
 12993           DFHEIV99,
 12994           DFHEIV99
 12995     SET ADDRESS OF CERTIFICATE-MASTER TO
 12996         DFHEIV20
 12997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12998
 12999
 13000     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13001
 13002     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13003     MOVE 'B'                    TO JP-RECORD-TYPE
 13004     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13005
 13006     PERFORM 8400-LOG-JOURNAL-RECORD.
 13007
 13008     IF CERT-NOTES-ARE-NOT-PRESENT
 13009        MOVE ' '                 TO WS-CERT-NOTE-SW
 13010     ELSE
 13011        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13012
 13013     IF INSURED-ADDR-PRESENT
 13014        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13015
 13016******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 238
* EL6311.cbl
 13017******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13018******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13019******************************************************************
 13020******************************************************************
 13021
 13022     IF CERT-ADDED-BATCH AND
 13023        (NOT NO-CLAIM-ATTACHED
 13024         OR
 13025         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13026        GO TO 1410-REWRITE-CERT.
 13027
 13028******************************************************************
 13029******************************************************************
 13030
 13031     IF CERT-ADDED-BATCH  AND
 13032        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13033        GO TO 1410-REWRITE-CERT.
 13034
 13035     IF NO-CLAIM-ATTACHED
 13036        NEXT SENTENCE
 13037     ELSE
 13038        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13039        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13040        GO TO 1410-REWRITE-CERT.
 13041
 13042     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13043     MOVE 'D'                      TO JP-RECORD-TYPE.
 13044     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13045
 13046
 13047* EXEC CICS DELETE
 13048*         DATASET    (FILE-ID-ELCERT)
 13049*    END-EXEC.
 13050*    MOVE '&(                    &   #00012201' TO DFHEIV0
 13051     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13052     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13053     MOVE X'2020233030303132323031' TO DFHEIV0(25:11)
 13054     CALL 'kxdfhei1' USING DFHEIV0,
 13055           FILE-ID-ELCERT,
 13056           DFHEIV99,
 13057           DFHEIV99,
 13058           DFHEIV99,
 13059           DFHEIV99
 13060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13061
 13062
 13063     PERFORM 8400-LOG-JOURNAL-RECORD.
 13064
 13065******************************************************************
 13066*                                                                *
 13067*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13068*                                                                *
 13069******************************************************************
 13070
 13071     IF  CERT-NOTES-ARE-PRESENT
 13072         NEXT SENTENCE
 13073     ELSE
 13074         GO TO 1407-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 239
* EL6311.cbl
 13075
 13076
 13077* EXEC CICS HANDLE CONDITION
 13078*         NOTFND  (1406-DELETE-ERNOTE)
 13079*    END-EXEC.
 13080*    MOVE '"$I                   ! . #00012218' TO DFHEIV0
 13081     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13083     MOVE X'2E20233030303132323138' TO DFHEIV0(25:11)
 13084     CALL 'kxdfhei1' USING DFHEIV0
 13085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13086
 13087
 13088     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13089     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13090     MOVE 0                     TO ERCNOT-SEQUENCE.
 13091
 13092 1406-DELETE-ERCNOT-LOOP.
 13093
 13094
 13095* EXEC CICS READ
 13096*        GTEQ
 13097*        DATASET   (FILE-ID-ERCNOT)
 13098*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13099*        RIDFLD    (ERCNOT-KEY)
 13100*    END-EXEC.
 13101*    MOVE '&"S        G          (   #00012228' TO DFHEIV0
 13102     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13103     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13104     MOVE X'2020233030303132323238' TO DFHEIV0(25:11)
 13105     CALL 'kxdfhei1' USING DFHEIV0,
 13106           FILE-ID-ERCNOT,
 13107           DFHEIV20,
 13108           DFHEIV99,
 13109           ERCNOT-KEY,
 13110           DFHEIV99,
 13111           DFHEIV99,
 13112           DFHEIV99
 13113     SET ADDRESS OF CERT-NOTE-FILE TO
 13114         DFHEIV20
 13115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13116
 13117
 13118     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13119     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13120         GO TO 1406-DELETE-ERNOTE
 13121     END-IF.
 13122
 13123     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13124     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13125     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13126
 13127     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13128
 13129
 13130* EXEC CICS DELETE
 13131*        DATASET   (FILE-ID-ERCNOT)
 13132*        RIDFLD    (ERCNOT-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 240
* EL6311.cbl
 13133*        END-EXEC.
 13134*    MOVE '&(  R                 &   #00012246' TO DFHEIV0
 13135     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13136     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13137     MOVE X'2020233030303132323436' TO DFHEIV0(25:11)
 13138     CALL 'kxdfhei1' USING DFHEIV0,
 13139           FILE-ID-ERCNOT,
 13140           ERCNOT-KEY,
 13141           DFHEIV99,
 13142           DFHEIV99,
 13143           DFHEIV99
 13144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13145
 13146
 13147     PERFORM 8400-LOG-JOURNAL-RECORD.
 13148
 13149     GO TO 1406-DELETE-ERCNOT-LOOP.
 13150
 13151 1406-DELETE-ERNOTE.
 13152
 13153
 13154* EXEC CICS HANDLE CONDITION
 13155*         NOTFND  (1407-DELETE-MAILING)
 13156*    END-EXEC.
 13157*    MOVE '"$I                   ! / #00012257' TO DFHEIV0
 13158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13160     MOVE X'2F20233030303132323537' TO DFHEIV0(25:11)
 13161     CALL 'kxdfhei1' USING DFHEIV0
 13162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13163
 13164
 13165
 13166* EXEC CICS READ
 13167*        EQUAL
 13168*        DATASET   (FILE-ID-ERNOTE)
 13169*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13170*        RIDFLD    (ELCERT-KEY)
 13171*        UPDATE
 13172*    END-EXEC.
 13173*    MOVE '&"S        EU         (   #00012261' TO DFHEIV0
 13174     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13175     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13176     MOVE X'2020233030303132323631' TO DFHEIV0(25:11)
 13177     CALL 'kxdfhei1' USING DFHEIV0,
 13178           FILE-ID-ERNOTE,
 13179           DFHEIV20,
 13180           DFHEIV99,
 13181           ELCERT-KEY,
 13182           DFHEIV99,
 13183           DFHEIV99,
 13184           DFHEIV99
 13185     SET ADDRESS OF CERTIFICATE-NOTE TO
 13186         DFHEIV20
 13187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13188
 13189
 13190     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 241
* EL6311.cbl
 13191     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13192     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13193
 13194     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13195
 13196
 13197* EXEC CICS DELETE
 13198*        DATASET   (FILE-ID-ERNOTE)
 13199*        END-EXEC.
 13200*    MOVE '&(                    &   #00012275' TO DFHEIV0
 13201     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13202     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13203     MOVE X'2020233030303132323735' TO DFHEIV0(25:11)
 13204     CALL 'kxdfhei1' USING DFHEIV0,
 13205           FILE-ID-ERNOTE,
 13206           DFHEIV99,
 13207           DFHEIV99,
 13208           DFHEIV99,
 13209           DFHEIV99
 13210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13211
 13212
 13213     PERFORM 8400-LOG-JOURNAL-RECORD.
 13214
 13215******************************************************************
 13216*                                                                *
 13217*                DELETE MAILING ADDRESS RECORDS                  *
 13218*                                                                *
 13219******************************************************************
 13220
 13221 1407-DELETE-MAILING.
 13222     IF CERT-ADDRESS-PRESENT
 13223        NEXT SENTENCE
 13224     ELSE
 13225        GO TO 1420-CONTINUE-DELETE.
 13226
 13227
 13228* EXEC CICS HANDLE CONDITION
 13229*         NOTFND  (1420-CONTINUE-DELETE)
 13230*    END-EXEC.
 13231*    MOVE '"$I                   ! 0 #00012293' TO DFHEIV0
 13232     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13234     MOVE X'3020233030303132323933' TO DFHEIV0(25:11)
 13235     CALL 'kxdfhei1' USING DFHEIV0
 13236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13237
 13238
 13239
 13240* EXEC CICS READ
 13241*        EQUAL
 13242*        DATASET   (FILE-ID-ERMAIL)
 13243*        SET       (ADDRESS OF MAILING-DATA)
 13244*        RIDFLD    (ELCERT-KEY)
 13245*        UPDATE
 13246*    END-EXEC.
 13247*    MOVE '&"S        EU         (   #00012297' TO DFHEIV0
 13248     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 242
* EL6311.cbl
 13249     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13250     MOVE X'2020233030303132323937' TO DFHEIV0(25:11)
 13251     CALL 'kxdfhei1' USING DFHEIV0,
 13252           FILE-ID-ERMAIL,
 13253           DFHEIV20,
 13254           DFHEIV99,
 13255           ELCERT-KEY,
 13256           DFHEIV99,
 13257           DFHEIV99,
 13258           DFHEIV99
 13259     SET ADDRESS OF MAILING-DATA TO
 13260         DFHEIV20
 13261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13262
 13263
 13264     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13265     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13266     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13267
 13268     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13269
 13270
 13271* EXEC CICS DELETE
 13272*        DATASET   (FILE-ID-ERMAIL)
 13273*    END-EXEC.
 13274*    MOVE '&(                    &   #00012311' TO DFHEIV0
 13275     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13276     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13277     MOVE X'2020233030303132333131' TO DFHEIV0(25:11)
 13278     CALL 'kxdfhei1' USING DFHEIV0,
 13279           FILE-ID-ERMAIL,
 13280           DFHEIV99,
 13281           DFHEIV99,
 13282           DFHEIV99,
 13283           DFHEIV99
 13284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13285
 13286
 13287     GO TO 1420-CONTINUE-DELETE.
 13288
 13289 1410-REWRITE-CERT.
 13290     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13291     MOVE 'C'                      TO JP-RECORD-TYPE.
 13292     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13293     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13294
 13295
 13296* EXEC CICS REWRITE
 13297*         DATASET    (FILE-ID-ELCERT)
 13298*         FROM       (CERTIFICATE-MASTER)
 13299*         END-EXEC.
 13300     MOVE LENGTH OF
 13301      CERTIFICATE-MASTER
 13302       TO DFHEIV11
 13303*    MOVE '&& L                  %   #00012323' TO DFHEIV0
 13304     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13305     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13306     MOVE X'2020233030303132333233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 243
* EL6311.cbl
 13307     CALL 'kxdfhei1' USING DFHEIV0,
 13308           FILE-ID-ELCERT,
 13309           CERTIFICATE-MASTER,
 13310           DFHEIV11,
 13311           DFHEIV99
 13312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13313
 13314
 13315     PERFORM 8400-LOG-JOURNAL-RECORD.
 13316
 13317 1420-CONTINUE-DELETE.
 13318     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13319     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13320
 13321     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13322     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13323
 13324     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13325
 13326 1450-DELETE-PB-RECORD.
 13327     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13328     MOVE 'D'                      TO JP-RECORD-TYPE
 13329     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13330
 13331
 13332* EXEC CICS DELETE
 13333*        DATASET    (FILE-ID-ERPNDB)
 13334*    END-EXEC.
 13335*    MOVE '&(                    &   #00012344' TO DFHEIV0
 13336     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13337     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13338     MOVE X'2020233030303132333434' TO DFHEIV0(25:11)
 13339     CALL 'kxdfhei1' USING DFHEIV0,
 13340           FILE-ID-ERPNDB,
 13341           DFHEIV99,
 13342           DFHEIV99,
 13343           DFHEIV99,
 13344           DFHEIV99
 13345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13346
 13347
 13348     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13349
 13350     PERFORM 8400-LOG-JOURNAL-RECORD.
 13351
 13352     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13353     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13354     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13355
 13356
 13357* EXEC CICS HANDLE CONDITION
 13358*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13359*    END-EXEC.
 13360*    MOVE '"$I                   ! 1 #00012356' TO DFHEIV0
 13361     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13362     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13363     MOVE X'3120233030303132333536' TO DFHEIV0(25:11)
 13364     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 244
* EL6311.cbl
 13365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13366
 13367
 13368
 13369* EXEC CICS READ
 13370*        SET     (ADDRESS OF PENDING-BUSINESS)
 13371*        DATASET (FILE-ID-ERPNDB)
 13372*        RIDFLD  (ERPNDB-KEY)
 13373*        UPDATE
 13374*    END-EXEC.
 13375*    MOVE '&"S        EU         (   #00012360' TO DFHEIV0
 13376     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13377     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13378     MOVE X'2020233030303132333630' TO DFHEIV0(25:11)
 13379     CALL 'kxdfhei1' USING DFHEIV0,
 13380           FILE-ID-ERPNDB,
 13381           DFHEIV20,
 13382           DFHEIV99,
 13383           ERPNDB-KEY,
 13384           DFHEIV99,
 13385           DFHEIV99,
 13386           DFHEIV99
 13387     SET ADDRESS OF PENDING-BUSINESS TO
 13388         DFHEIV20
 13389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13390
 13391
 13392     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13393
 13394     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13395
 13396     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13397        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13398        MOVE 'D'                   TO JP-RECORD-TYPE
 13399        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13400
 13401* EXEC CICS DELETE
 13402*            DATASET    (FILE-ID-ERPNDB)
 13403*       END-EXEC
 13404*    MOVE '&(                    &   #00012375' TO DFHEIV0
 13405     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13406     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13407     MOVE X'2020233030303132333735' TO DFHEIV0(25:11)
 13408     CALL 'kxdfhei1' USING DFHEIV0,
 13409           FILE-ID-ERPNDB,
 13410           DFHEIV99,
 13411           DFHEIV99,
 13412           DFHEIV99,
 13413           DFHEIV99
 13414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13415        PERFORM 8400-LOG-JOURNAL-RECORD
 13416     ELSE
 13417        MOVE 'B'                 TO JP-RECORD-TYPE
 13418        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13419        PERFORM 8400-LOG-JOURNAL-RECORD
 13420        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13421        MOVE 'C'                 TO JP-RECORD-TYPE
 13422        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 245
* EL6311.cbl
 13423
 13424* EXEC CICS REWRITE
 13425*            DATASET    (FILE-ID-ERPNDB)
 13426*            FROM       (PENDING-BUSINESS)
 13427*       END-EXEC
 13428     MOVE LENGTH OF
 13429      PENDING-BUSINESS
 13430       TO DFHEIV11
 13431*    MOVE '&& L                  %   #00012386' TO DFHEIV0
 13432     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13433     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13434     MOVE X'2020233030303132333836' TO DFHEIV0(25:11)
 13435     CALL 'kxdfhei1' USING DFHEIV0,
 13436           FILE-ID-ERPNDB,
 13437           PENDING-BUSINESS,
 13438           DFHEIV11,
 13439           DFHEIV99
 13440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13441        PERFORM 8400-LOG-JOURNAL-RECORD.
 13442
 13443******************************************************************
 13444*                                                                *
 13445*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13446*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13447*                                                                *
 13448******************************************************************
 13449
 13450     IF NOT PI-AR-PROCESSING
 13451        GO TO 1475-DELETE-FINISHED.
 13452
 13453     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13454        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13455        NEXT SENTENCE
 13456     ELSE
 13457        GO TO 1475-DELETE-FINISHED.
 13458
 13459
 13460* EXEC CICS HANDLE CONDITION
 13461*         NOTFND    (1475-DELETE-FINISHED)
 13462*         END-EXEC.
 13463*    MOVE '"$I                   ! 2 #00012408' TO DFHEIV0
 13464     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13466     MOVE X'3220233030303132343038' TO DFHEIV0(25:11)
 13467     CALL 'kxdfhei1' USING DFHEIV0
 13468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13469
 13470
 13471     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13472     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13473
 13474
 13475* EXEC CICS READ
 13476*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13477*        DATASET (FILE-ID-ERRQST)
 13478*        RIDFLD  (ERRQST-KEY)
 13479*        UPDATE
 13480*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 246
* EL6311.cbl
 13481*    MOVE '&"S        EU         (   #00012415' TO DFHEIV0
 13482     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13483     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13484     MOVE X'2020233030303132343135' TO DFHEIV0(25:11)
 13485     CALL 'kxdfhei1' USING DFHEIV0,
 13486           FILE-ID-ERRQST,
 13487           DFHEIV20,
 13488           DFHEIV99,
 13489           ERRQST-KEY,
 13490           DFHEIV99,
 13491           DFHEIV99,
 13492           DFHEIV99
 13493     SET ADDRESS OF AR-REQUEST-RECORD TO
 13494         DFHEIV20
 13495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13496
 13497
 13498     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13499
 13500     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13501
 13502     MOVE 'D'                      TO JP-RECORD-TYPE.
 13503     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13504
 13505
 13506* EXEC CICS DELETE
 13507*         DATASET    (FILE-ID-ERRQST)
 13508*    END-EXEC.
 13509*    MOVE '&(                    &   #00012429' TO DFHEIV0
 13510     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13511     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13512     MOVE X'2020233030303132343239' TO DFHEIV0(25:11)
 13513     CALL 'kxdfhei1' USING DFHEIV0,
 13514           FILE-ID-ERRQST,
 13515           DFHEIV99,
 13516           DFHEIV99,
 13517           DFHEIV99,
 13518           DFHEIV99
 13519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13520
 13521
 13522     PERFORM 8400-LOG-JOURNAL-RECORD.
 13523
 13524 1475-DELETE-FINISHED.
 13525     MOVE ZEROS                  TO EMI-ERROR.
 13526     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13527     MOVE LOW-VALUES             TO EL631BI.
 13528     MOVE -1                     TO BMAINTL.
 13529     GO TO 8100-SEND-INITIAL-MAP.
 13530
 13531 1480-BATCH-HDR-NOT-FOUND.
 13532     MOVE -1                     TO BMAINTL.
 13533     MOVE ER-7450                TO EMI-ERROR.
 13534     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13535     GO TO 8200-SEND-DATAONLY.
 13536
 13537 1490-RECORD-NOT-FOUND.
 13538     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 247
* EL6311.cbl
 13539     MOVE ER-7451                TO EMI-ERROR.
 13540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13541     GO TO 8200-SEND-DATAONLY.
 13542
 13543******************************************************************
 13544*            O V E R   C H A R G E   P R O C E S S I N G         *
 13545******************************************************************
 13546 1500-UPDATE-ERNOTE.
 13547     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13548     MOVE 'A'                    TO WS-NOTE-SW
 13549     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13550     .
 13551 1500-EXIT.
 13552     EXIT.
 13553 1510-ADD-ERNOTE-REC.
 13554
 13555* EXEC CICS GETMAIN
 13556*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13557*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13558*        INITIMG (GETMAIN-SPACE)
 13559*    END-EXEC
 13560*    MOVE ',"IL                  $   #00012465' TO DFHEIV0
 13561     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13562     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13563     MOVE X'2020233030303132343635' TO DFHEIV0(25:11)
 13564     CALL 'kxdfhei1' USING DFHEIV0,
 13565           DFHEIV20,
 13566           ERNOTE-RECORD-LENGTH,
 13567           GETMAIN-SPACE
 13568     SET ADDRESS OF CERTIFICATE-NOTE TO
 13569         DFHEIV20
 13570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13571     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13572                                 TO ERNOTE-KEY
 13573
 13574* EXEC CICS READ
 13575*       DATASET    (FILE-ID-ERNOTE)
 13576*       RIDFLD     (ERNOTE-KEY)
 13577*       INTO       (CERTIFICATE-NOTE)
 13578*       RESP       (WS-RESPONSE)
 13579*       UPDATE
 13580*    END-EXEC
 13581     MOVE LENGTH OF
 13582      CERTIFICATE-NOTE
 13583       TO DFHEIV11
 13584*    MOVE '&"IL       EU         (  N#00012472' TO DFHEIV0
 13585     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13586     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13587     MOVE X'204E233030303132343732' TO DFHEIV0(25:11)
 13588     CALL 'kxdfhei1' USING DFHEIV0,
 13589           FILE-ID-ERNOTE,
 13590           CERTIFICATE-NOTE,
 13591           DFHEIV11,
 13592           ERNOTE-KEY,
 13593           DFHEIV99,
 13594           DFHEIV99,
 13595           DFHEIV99
 13596     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 248
* EL6311.cbl
 13597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13598     IF RESP-NORMAL
 13599        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13600           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13601        END-IF
 13602        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13603           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13604        END-IF
 13605        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13606           (N1 > +10)
 13607           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13608           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13609        END-PERFORM
 13610        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13611          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13612
 13613* EXEC CICS UNLOCK
 13614*            DATASET    (FILE-ID-ERNOTE)
 13615*          END-EXEC
 13616*    MOVE '&*                    #   #00012493' TO DFHEIV0
 13617     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13618     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13619     MOVE X'2020233030303132343933' TO DFHEIV0(25:11)
 13620     CALL 'kxdfhei1' USING DFHEIV0,
 13621           FILE-ID-ERNOTE,
 13622           DFHEIV99
 13623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13624        ELSE
 13625          PERFORM VARYING N1 FROM +1 BY +1
 13626           UNTIL (N1 > +10)
 13627           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13628          END-PERFORM
 13629          IF (N1 < +11)
 13630            IF N1 >= CN-BILLING-START-LINE-NO AND
 13631              N1 <= CN-BILLING-END-LINE-NO
 13632              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13633                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13634              ELSE
 13635                 MOVE WS-VA-NO-COMM-MESS
 13636                                    TO CN-LINE (N1)
 13637              END-IF
 13638            ELSE
 13639              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13640               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13641                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13642                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13643                ELSE
 13644                  MOVE WS-VA-NO-COMM-MESS
 13645                                    TO CN-LINE (N1)
 13646                END-IF
 13647                MOVE N1             TO CN-BILLING-END-LINE-NO
 13648              ELSE
 13649                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13650                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13651                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13652                  ELSE
 13653                     MOVE WS-VA-NO-COMM-MESS
 13654                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 249
* EL6311.cbl
 13655                  END-IF
 13656                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13657                                      CN-BILLING-START-LINE-NO
 13658                ELSE
 13659                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13660                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13661                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13662                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13663                     ELSE
 13664                       MOVE WS-VA-NO-COMM-MESS
 13665                                    TO CN-LINE (N1)
 13666                     END-IF
 13667                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13668                  ELSE
 13669                     PERFORM 1700-SQUEEZE-IT-IN
 13670                                 THRU 1700-EXIT
 13671                  END-IF
 13672                END-IF
 13673              END-IF
 13674            END-IF
 13675            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13676            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13677            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13678
 13679* EXEC CICS REWRITE
 13680*              DATASET    (FILE-ID-ERNOTE)
 13681*              FROM       (CERTIFICATE-NOTE)
 13682*              RESP       (WS-RESPONSE)
 13683*           END-EXEC
 13684     MOVE LENGTH OF
 13685      CERTIFICATE-NOTE
 13686       TO DFHEIV11
 13687*    MOVE '&& L                  %  N#00012550' TO DFHEIV0
 13688     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13689     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13690     MOVE X'204E233030303132353530' TO DFHEIV0(25:11)
 13691     CALL 'kxdfhei1' USING DFHEIV0,
 13692           FILE-ID-ERNOTE,
 13693           CERTIFICATE-NOTE,
 13694           DFHEIV11,
 13695           DFHEIV99
 13696     MOVE EIBRESP  TO WS-RESPONSE
 13697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13698          END-IF
 13699        END-IF
 13700     ELSE
 13701        MOVE SPACES              TO CERTIFICATE-NOTE
 13702        MOVE 'CN'                TO CN-RECORD-ID
 13703        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13704                                 TO CN-CONTROL-PRIMARY
 13705                                    ERNOTE-KEY
 13706        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13707                                    CN-BILLING-END-LINE-NO
 13708        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13709           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13710        ELSE
 13711           MOVE WS-VA-NO-COMM-MESS
 13712                                 TO CN-LINE (1)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 250
* EL6311.cbl
 13713        END-IF
 13714        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13715        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13716        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13717
 13718* EXEC CICS WRITE
 13719*          DATASET    (FILE-ID-ERNOTE)
 13720*          FROM       (CERTIFICATE-NOTE)
 13721*          RIDFLD     (ERNOTE-KEY)
 13722*          RESP       (WS-RESPONSE)
 13723*       END-EXEC
 13724     MOVE LENGTH OF
 13725      CERTIFICATE-NOTE
 13726       TO DFHEIV11
 13727*    MOVE '&$ L                  ''  N#00012574' TO DFHEIV0
 13728     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13729     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13730     MOVE X'204E233030303132353734' TO DFHEIV0(25:11)
 13731     CALL 'kxdfhei1' USING DFHEIV0,
 13732           FILE-ID-ERNOTE,
 13733           CERTIFICATE-NOTE,
 13734           DFHEIV11,
 13735           ERNOTE-KEY,
 13736           DFHEIV99,
 13737           DFHEIV99
 13738     MOVE EIBRESP  TO WS-RESPONSE
 13739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13740     END-IF
 13741     .
 13742 1510-EXIT.
 13743     EXIT.
 13744 1520-UPDATE-ELCERT.
 13745     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13746                                 TO ELCERT-KEY
 13747
 13748* EXEC CICS READ
 13749*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13750*        DATASET (FILE-ID-ELCERT)
 13751*        RIDFLD  (ELCERT-KEY)
 13752*        UPDATE
 13753*        RESP    (WS-RESPONSE)
 13754*    END-EXEC
 13755*    MOVE '&"S        EU         (  N#00012587' TO DFHEIV0
 13756     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13757     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13758     MOVE X'204E233030303132353837' TO DFHEIV0(25:11)
 13759     CALL 'kxdfhei1' USING DFHEIV0,
 13760           FILE-ID-ELCERT,
 13761           DFHEIV20,
 13762           DFHEIV99,
 13763           ELCERT-KEY,
 13764           DFHEIV99,
 13765           DFHEIV99,
 13766           DFHEIV99
 13767     SET ADDRESS OF CERTIFICATE-MASTER TO
 13768         DFHEIV20
 13769     MOVE EIBRESP  TO WS-RESPONSE
 13770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 251
* EL6311.cbl
 13771     IF RESP-NORMAL
 13772        IF WS-NOTE-SW = 'A'
 13773           IF CM-NOTE-SW = ' '
 13774              MOVE '2'             TO CM-NOTE-SW
 13775           ELSE
 13776             IF CM-NOTE-SW = '1'
 13777                MOVE '3'           TO CM-NOTE-SW
 13778             ELSE
 13779               IF CM-NOTE-SW = '4'
 13780                  MOVE '6'         TO CM-NOTE-SW
 13781               ELSE
 13782                 IF CM-NOTE-SW = '5'
 13783                    MOVE '7'       TO CM-NOTE-SW
 13784                 END-IF
 13785               END-IF
 13786             END-IF
 13787           END-IF
 13788        ELSE
 13789           IF CM-NOTE-SW = '2'
 13790              MOVE ' '             TO CM-NOTE-SW
 13791           ELSE
 13792             IF CM-NOTE-SW = '3'
 13793                MOVE '1'           TO CM-NOTE-SW
 13794             ELSE
 13795               IF CM-NOTE-SW = '6'
 13796                  MOVE '4'         TO CM-NOTE-SW
 13797               ELSE
 13798                 IF CM-NOTE-SW = '7'
 13799                    MOVE '5'       TO CM-NOTE-SW
 13800                 END-IF
 13801               END-IF
 13802             END-IF
 13803           END-IF
 13804        END-IF
 13805
 13806* EXEC CICS REWRITE
 13807*          DATASET    (FILE-ID-ELCERT)
 13808*          FROM       (CERTIFICATE-MASTER)
 13809*          RESP       (WS-RESPONSE)
 13810*       END-EXEC
 13811     MOVE LENGTH OF
 13812      CERTIFICATE-MASTER
 13813       TO DFHEIV11
 13814*    MOVE '&& L                  %  N#00012628' TO DFHEIV0
 13815     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13816     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13817     MOVE X'204E233030303132363238' TO DFHEIV0(25:11)
 13818     CALL 'kxdfhei1' USING DFHEIV0,
 13819           FILE-ID-ELCERT,
 13820           CERTIFICATE-MASTER,
 13821           DFHEIV11,
 13822           DFHEIV99
 13823     MOVE EIBRESP  TO WS-RESPONSE
 13824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13825        IF RESP-NORMAL
 13826           CONTINUE
 13827        ELSE
 13828           MOVE WS-RESPONSE TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 252
* EL6311.cbl
 13829           PERFORM 9900-ERROR-FORMAT
 13830                                 THRU 9900-EXIT
 13831           GO TO 8200-SEND-DATAONLY
 13832        END-IF
 13833     ELSE
 13834        MOVE -1                  TO BMAINTL
 13835        MOVE 0249                TO EMI-ERROR
 13836        PERFORM 9900-ERROR-FORMAT
 13837                                 THRU 9900-EXIT
 13838        GO TO 8200-SEND-DATAONLY
 13839     END-IF
 13840     .
 13841 1520-EXIT.
 13842     EXIT.
 13843 1600-UPDATE-ERPYAJ.
 13844     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13845                                 THRU 1610-EXIT
 13846     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13847                                 THRU 1620-EXIT
 13848     .
 13849 1600-EXIT.
 13850     EXIT.
 13851 1610-ADD-ERPYAJ-BANK-REC.
 13852
 13853* EXEC CICS GETMAIN
 13854*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13855*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13856*        INITIMG (GETMAIN-SPACE)
 13857*    END-EXEC
 13858*    MOVE ',"IL                  $   #00012660' TO DFHEIV0
 13859     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13860     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13861     MOVE X'2020233030303132363630' TO DFHEIV0(25:11)
 13862     CALL 'kxdfhei1' USING DFHEIV0,
 13863           DFHEIV20,
 13864           ERPYAJ-RECORD-LENGTH,
 13865           GETMAIN-SPACE
 13866     SET ADDRESS OF PENDING-PAY-ADJ TO
 13867         DFHEIV20
 13868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13869     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13870     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13871     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13872     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13873     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13874     MOVE +10                    TO ERPYAJ-SEQ-NO
 13875     MOVE 'R'                    TO ERPYAJ-TYPE
 13876     IF REVERSAL
 13877        MOVE 'C'                 TO ERPYAJ-TYPE
 13878     END-IF
 13879     MOVE SPACES                 TO PENDING-PAY-ADJ
 13880     MOVE 'PY'                   TO PY-RECORD-ID
 13881     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13882     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13883     IF REVERSAL
 13884        MOVE PB-I-DCC-OVER-CHG-AMT
 13885                                 TO PY-ENTRY-AMT
 13886     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 253
* EL6311.cbl
 13887     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13888                                    PY-INPUT-DT
 13889*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13890*                                   PY-INPUT-DT
 13891     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13892     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13893     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13894     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13895     IF PB-CARRIER = '2'
 13896        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13897     ELSE
 13898        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13899     END-IF
 13900     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13901                                    PY-BILLED-DATE
 13902                                    PY-AR-DATE
 13903                                    PY-REPORTED-DT
 13904                                    PY-CHECK-WRITTEN-DT
 13905     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13906                                    PY-CHECK-QUE-SEQUENCE
 13907     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13908     PERFORM WITH TEST AFTER
 13909        UNTIL (NOT RESP-DUPKEY)
 13910           AND (NOT RESP-DUPREC)
 13911
 13912* EXEC CICS WRITE
 13913*          DATASET    (FILE-ID-ERPYAJ)
 13914*          FROM       (PENDING-PAY-ADJ)
 13915*          RIDFLD     (ERPYAJ-KEY)
 13916*          RESP       (WS-RESPONSE)
 13917*       END-EXEC
 13918     MOVE LENGTH OF
 13919      PENDING-PAY-ADJ
 13920       TO DFHEIV11
 13921*    MOVE '&$ L                  ''  N#00012707' TO DFHEIV0
 13922     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13923     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13924     MOVE X'204E233030303132373037' TO DFHEIV0(25:11)
 13925     CALL 'kxdfhei1' USING DFHEIV0,
 13926           FILE-ID-ERPYAJ,
 13927           PENDING-PAY-ADJ,
 13928           DFHEIV11,
 13929           ERPYAJ-KEY,
 13930           DFHEIV99,
 13931           DFHEIV99
 13932     MOVE EIBRESP  TO WS-RESPONSE
 13933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13934        IF RESP-DUPKEY OR RESP-DUPREC
 13935           ADD +1                TO ERPYAJ-SEQ-NO
 13936           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13937        END-IF
 13938     END-PERFORM
 13939     .
 13940 1610-EXIT.
 13941     EXIT.
 13942 1620-ADD-ERPYAJ-DLR-REC.
 13943     MOVE 'C'                    TO ERPYAJ-TYPE
 13944     IF REVERSAL
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 254
* EL6311.cbl
 13945        MOVE 'R'                 TO ERPYAJ-TYPE
 13946     END-IF
 13947     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13948                                    ERPYAJ-ACCOUNT
 13949     ADD +1                      TO ERPYAJ-SEQ-NO
 13950     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13951     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13952     IF PB-CARRIER = '2'
 13953        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13954     ELSE
 13955        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13956     END-IF
 13957     PERFORM WITH TEST AFTER
 13958        UNTIL (NOT RESP-DUPKEY)
 13959           AND (NOT RESP-DUPREC)
 13960
 13961* EXEC CICS WRITE
 13962*          DATASET    (FILE-ID-ERPYAJ)
 13963*          FROM       (PENDING-PAY-ADJ)
 13964*          RIDFLD     (ERPYAJ-KEY)
 13965*          RESP       (WS-RESPONSE)
 13966*       END-EXEC
 13967     MOVE LENGTH OF
 13968      PENDING-PAY-ADJ
 13969       TO DFHEIV11
 13970*    MOVE '&$ L                  ''  N#00012739' TO DFHEIV0
 13971     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13972     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13973     MOVE X'204E233030303132373339' TO DFHEIV0(25:11)
 13974     CALL 'kxdfhei1' USING DFHEIV0,
 13975           FILE-ID-ERPYAJ,
 13976           PENDING-PAY-ADJ,
 13977           DFHEIV11,
 13978           ERPYAJ-KEY,
 13979           DFHEIV99,
 13980           DFHEIV99
 13981     MOVE EIBRESP  TO WS-RESPONSE
 13982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13983        IF RESP-DUPKEY OR RESP-DUPREC
 13984           ADD +1                TO ERPYAJ-SEQ-NO
 13985           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13986        END-IF
 13987     END-PERFORM
 13988     .
 13989 1620-EXIT.
 13990     EXIT.
 13991 1700-SQUEEZE-IT-IN.
 13992     IF (N1 > CN-BILLING-END-LINE-NO)
 13993        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13994           N1 = +1
 13995           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13996           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13997              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13998                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13999              ELSE
 14000                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14001              END-IF
 14002              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 255
* EL6311.cbl
 14003              MOVE +2 TO N1
 14004           END-IF
 14005        END-PERFORM
 14006     ELSE
 14007        IF (N1 < CN-BILLING-START-LINE-NO)
 14008           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14009              N1 = +10
 14010              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14011              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 14012                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14013                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14014                 ELSE
 14015                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14016                 END-IF
 14017                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14018                 MOVE +9 TO N1
 14019              END-IF
 14020           END-PERFORM
 14021        END-IF
 14022     END-IF
 14023     .
 14024 1700-EXIT.
 14025     EXIT.
 14026 1800-REMOVE-CERT-NOTES.
 14027     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14028                                 TO ERNOTE-KEY
 14029
 14030* EXEC CICS READ
 14031*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14032*       DATASET    (FILE-ID-ERNOTE)
 14033*       RIDFLD     (ERNOTE-KEY)
 14034*       RESP       (WS-RESPONSE)
 14035*       UPDATE
 14036*    END-EXEC
 14037*    MOVE '&"S        EU         (  N#00012791' TO DFHEIV0
 14038     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14039     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14040     MOVE X'204E233030303132373931' TO DFHEIV0(25:11)
 14041     CALL 'kxdfhei1' USING DFHEIV0,
 14042           FILE-ID-ERNOTE,
 14043           DFHEIV20,
 14044           DFHEIV99,
 14045           ERNOTE-KEY,
 14046           DFHEIV99,
 14047           DFHEIV99,
 14048           DFHEIV99
 14049     SET ADDRESS OF CERTIFICATE-NOTE TO
 14050         DFHEIV20
 14051     MOVE EIBRESP  TO WS-RESPONSE
 14052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14053     IF RESP-NORMAL
 14054        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14055           (N1 > +10)
 14056           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14057           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14058        END-PERFORM
 14059        IF N1 < +11
 14060           MOVE SPACES              TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 256
* EL6311.cbl
 14061           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14062              N1 <= CN-BILLING-END-LINE-NO
 14063              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14064              IF CN-BILLING-END-LINE-NO <
 14065                               CN-BILLING-START-LINE-NO
 14066                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14067                                     CN-BILLING-START-LINE-NO
 14068              END-IF
 14069              PERFORM 1820-SQUEEZE-ERNOTE
 14070                                  THRU 1820-EXIT
 14071           END-IF
 14072           IF CN-LINES = SPACES
 14073
 14074* EXEC CICS DELETE
 14075*                DATASET    (FILE-ID-ERNOTE)
 14076*                RESP       (WS-RESPONSE)
 14077*             END-EXEC
 14078*    MOVE '&(                    &  N#00012818' TO DFHEIV0
 14079     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14080     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14081     MOVE X'204E233030303132383138' TO DFHEIV0(25:11)
 14082     CALL 'kxdfhei1' USING DFHEIV0,
 14083           FILE-ID-ERNOTE,
 14084           DFHEIV99,
 14085           DFHEIV99,
 14086           DFHEIV99,
 14087           DFHEIV99
 14088     MOVE EIBRESP  TO WS-RESPONSE
 14089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14090              IF RESP-NORMAL
 14091                 MOVE 'D'        TO WS-NOTE-SW
 14092                 PERFORM 1520-UPDATE-ELCERT
 14093                                 THRU 1520-EXIT
 14094              END-IF
 14095           ELSE
 14096
 14097* EXEC CICS REWRITE
 14098*                DATASET    (FILE-ID-ERNOTE)
 14099*                FROM       (CERTIFICATE-NOTE)
 14100*                RESP       (WS-RESPONSE)
 14101*             END-EXEC
 14102     MOVE LENGTH OF
 14103      CERTIFICATE-NOTE
 14104       TO DFHEIV11
 14105*    MOVE '&& L                  %  N#00012828' TO DFHEIV0
 14106     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14107     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14108     MOVE X'204E233030303132383238' TO DFHEIV0(25:11)
 14109     CALL 'kxdfhei1' USING DFHEIV0,
 14110           FILE-ID-ERNOTE,
 14111           CERTIFICATE-NOTE,
 14112           DFHEIV11,
 14113           DFHEIV99
 14114     MOVE EIBRESP  TO WS-RESPONSE
 14115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14116           END-IF
 14117        END-IF
 14118     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 257
* EL6311.cbl
 14119     .
 14120 1800-EXIT.
 14121     EXIT.
 14122 1820-SQUEEZE-ERNOTE.
 14123     MOVE CN-BILLING-START-LINE-NO TO N2
 14124     IF N2 = 0
 14125         MOVE +1                 TO N2
 14126     END-IF
 14127     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14128        (N1 > +9)
 14129        IF CN-LINE (N1) = SPACES
 14130           MOVE CN-LINE (N1 + +1)
 14131                                 TO CN-LINE (N1)
 14132           MOVE SPACES           TO CN-LINE (N1 + +1)
 14133        END-IF
 14134     END-PERFORM
 14135     .
 14136 1820-EXIT.
 14137     EXIT.
 14138 1900-DELETE-ERPYAJ.
 14139     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14140     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14141     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14142     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14143     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14144     MOVE +10                    TO ERPYAJ-SEQ-NO
 14145     MOVE 'R'                    TO ERPYAJ-TYPE
 14146     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14147
 14148* EXEC CICS STARTBR
 14149*       DATASET    (FILE-ID-ERPYAJ)
 14150*       RIDFLD     (ERPYAJ-KEY)
 14151*       RESP       (WS-RESPONSE)
 14152*    END-EXEC
 14153     MOVE 0
 14154       TO DFHEIV11
 14155*    MOVE '&,         G          &  N#00012864' TO DFHEIV0
 14156     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14157     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14158     MOVE X'204E233030303132383634' TO DFHEIV0(25:11)
 14159     CALL 'kxdfhei1' USING DFHEIV0,
 14160           FILE-ID-ERPYAJ,
 14161           ERPYAJ-KEY,
 14162           DFHEIV99,
 14163           DFHEIV11,
 14164           DFHEIV99
 14165     MOVE EIBRESP  TO WS-RESPONSE
 14166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14167     IF RESP-NORMAL
 14168        CONTINUE
 14169     ELSE
 14170        GO TO 1900-GET-DEALER
 14171     END-IF
 14172     .
 14173 1900-READNEXT-ERPYAJ-B.
 14174*  GET THE BANK ERPYAJ RECORD
 14175
 14176* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 258
* EL6311.cbl
 14177*       DATASET    (FILE-ID-ERPYAJ)
 14178*       RIDFLD     (ERPYAJ-KEY)
 14179*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14180*       RESP       (WS-RESPONSE)
 14181*    END-EXEC
 14182     MOVE 0
 14183       TO DFHEIV11
 14184*    MOVE '&.S                   )  N#00012877' TO DFHEIV0
 14185     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14186     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14187     MOVE X'204E233030303132383737' TO DFHEIV0(25:11)
 14188     CALL 'kxdfhei1' USING DFHEIV0,
 14189           FILE-ID-ERPYAJ,
 14190           DFHEIV20,
 14191           DFHEIV99,
 14192           ERPYAJ-KEY,
 14193           DFHEIV99,
 14194           DFHEIV11,
 14195           DFHEIV99,
 14196           DFHEIV99
 14197     SET ADDRESS OF PENDING-PAY-ADJ TO
 14198         DFHEIV20
 14199     MOVE EIBRESP  TO WS-RESPONSE
 14200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14201     IF RESP-NORMAL
 14202        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14203           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14204              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14205                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14206
 14207* EXEC CICS READ
 14208*                   DATASET    (FILE-ID-ERPYAJ)
 14209*                   RIDFLD     (ERPYAJ-KEY)
 14210*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14211*                   RESP       (WS-RESPONSE)
 14212*                   UPDATE
 14213*                END-EXEC
 14214*    MOVE '&"S        EU         (  N#00012888' TO DFHEIV0
 14215     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14216     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14217     MOVE X'204E233030303132383838' TO DFHEIV0(25:11)
 14218     CALL 'kxdfhei1' USING DFHEIV0,
 14219           FILE-ID-ERPYAJ,
 14220           DFHEIV20,
 14221           DFHEIV99,
 14222           ERPYAJ-KEY,
 14223           DFHEIV99,
 14224           DFHEIV99,
 14225           DFHEIV99
 14226     SET ADDRESS OF PENDING-PAY-ADJ TO
 14227         DFHEIV20
 14228     MOVE EIBRESP  TO WS-RESPONSE
 14229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14230                 IF RESP-NORMAL
 14231
 14232* EXEC CICS DELETE
 14233*                      DATASET   (FILE-ID-ERPYAJ)
 14234*                      RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 259
* EL6311.cbl
 14235*                   END-EXEC
 14236*    MOVE '&(                    &  N#00012896' TO DFHEIV0
 14237     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14238     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14239     MOVE X'204E233030303132383936' TO DFHEIV0(25:11)
 14240     CALL 'kxdfhei1' USING DFHEIV0,
 14241           FILE-ID-ERPYAJ,
 14242           DFHEIV99,
 14243           DFHEIV99,
 14244           DFHEIV99,
 14245           DFHEIV99
 14246     MOVE EIBRESP  TO WS-RESPONSE
 14247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14248                 END-IF
 14249              ELSE
 14250                 SET REVERSAL    TO TRUE
 14251                 PERFORM 1600-UPDATE-ERPYAJ
 14252                                 THRU 1600-EXIT
 14253                 GO TO 1900-EXIT
 14254              END-IF
 14255           ELSE
 14256              GO TO 1900-READNEXT-ERPYAJ-B
 14257           END-IF
 14258        END-IF
 14259
 14260* EXEC CICS ENDBR
 14261*          DATASET   (FILE-ID-ERPYAJ)
 14262*       END-EXEC
 14263     MOVE 0
 14264       TO DFHEIV11
 14265*    MOVE '&2                    $   #00012911' TO DFHEIV0
 14266     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14267     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14268     MOVE X'2020233030303132393131' TO DFHEIV0(25:11)
 14269     CALL 'kxdfhei1' USING DFHEIV0,
 14270           FILE-ID-ERPYAJ,
 14271           DFHEIV11,
 14272           DFHEIV99
 14273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14274     END-IF
 14275     .
 14276 1900-GET-DEALER.
 14277     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14278     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14279     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14280     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14281     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14282     MOVE +10                    TO ERPYAJ-SEQ-NO
 14283     MOVE 'C'                    TO ERPYAJ-TYPE
 14284     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14285
 14286* EXEC CICS STARTBR
 14287*       DATASET    (FILE-ID-ERPYAJ)
 14288*       RIDFLD     (ERPYAJ-KEY)
 14289*       RESP       (WS-RESPONSE)
 14290*    END-EXEC
 14291     MOVE 0
 14292       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 260
* EL6311.cbl
 14293*    MOVE '&,         G          &  N#00012925' TO DFHEIV0
 14294     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14295     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14296     MOVE X'204E233030303132393235' TO DFHEIV0(25:11)
 14297     CALL 'kxdfhei1' USING DFHEIV0,
 14298           FILE-ID-ERPYAJ,
 14299           ERPYAJ-KEY,
 14300           DFHEIV99,
 14301           DFHEIV11,
 14302           DFHEIV99
 14303     MOVE EIBRESP  TO WS-RESPONSE
 14304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14305     IF RESP-NORMAL
 14306        CONTINUE
 14307     ELSE
 14308        GO TO 1900-EXIT
 14309     END-IF
 14310     .
 14311 1900-READNEXT-ERPYAJ-D.
 14312*  GET THE DEALER ERPYAJ RECORD
 14313
 14314* EXEC CICS READNEXT
 14315*       DATASET    (FILE-ID-ERPYAJ)
 14316*       RIDFLD     (ERPYAJ-KEY)
 14317*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14318*       RESP       (WS-RESPONSE)
 14319*    END-EXEC
 14320     MOVE 0
 14321       TO DFHEIV11
 14322*    MOVE '&.S                   )  N#00012938' TO DFHEIV0
 14323     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14324     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14325     MOVE X'204E233030303132393338' TO DFHEIV0(25:11)
 14326     CALL 'kxdfhei1' USING DFHEIV0,
 14327           FILE-ID-ERPYAJ,
 14328           DFHEIV20,
 14329           DFHEIV99,
 14330           ERPYAJ-KEY,
 14331           DFHEIV99,
 14332           DFHEIV11,
 14333           DFHEIV99,
 14334           DFHEIV99
 14335     SET ADDRESS OF PENDING-PAY-ADJ TO
 14336         DFHEIV20
 14337     MOVE EIBRESP  TO WS-RESPONSE
 14338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14339     IF RESP-NORMAL
 14340        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14341           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14342              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14343                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14344
 14345* EXEC CICS READ
 14346*                   DATASET    (FILE-ID-ERPYAJ)
 14347*                   RIDFLD     (ERPYAJ-KEY)
 14348*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14349*                   RESP       (WS-RESPONSE)
 14350*                   UPDATE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 261
* EL6311.cbl
 14351*                END-EXEC
 14352*    MOVE '&"S        EU         (  N#00012949' TO DFHEIV0
 14353     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14354     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14355     MOVE X'204E233030303132393439' TO DFHEIV0(25:11)
 14356     CALL 'kxdfhei1' USING DFHEIV0,
 14357           FILE-ID-ERPYAJ,
 14358           DFHEIV20,
 14359           DFHEIV99,
 14360           ERPYAJ-KEY,
 14361           DFHEIV99,
 14362           DFHEIV99,
 14363           DFHEIV99
 14364     SET ADDRESS OF PENDING-PAY-ADJ TO
 14365         DFHEIV20
 14366     MOVE EIBRESP  TO WS-RESPONSE
 14367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14368                 IF RESP-NORMAL
 14369
 14370* EXEC CICS DELETE
 14371*                      DATASET   (FILE-ID-ERPYAJ)
 14372*                      RESP      (WS-RESPONSE)
 14373*                   END-EXEC
 14374*    MOVE '&(                    &  N#00012957' TO DFHEIV0
 14375     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14376     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14377     MOVE X'204E233030303132393537' TO DFHEIV0(25:11)
 14378     CALL 'kxdfhei1' USING DFHEIV0,
 14379           FILE-ID-ERPYAJ,
 14380           DFHEIV99,
 14381           DFHEIV99,
 14382           DFHEIV99,
 14383           DFHEIV99
 14384     MOVE EIBRESP  TO WS-RESPONSE
 14385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14386                 END-IF
 14387              ELSE
 14388                 SET REVERSAL    TO TRUE
 14389              END-IF
 14390           ELSE
 14391              GO TO 1900-READNEXT-ERPYAJ-D
 14392           END-IF
 14393        END-IF
 14394
 14395* EXEC CICS ENDBR
 14396*          DATASET   (FILE-ID-ERPYAJ)
 14397*       END-EXEC
 14398     MOVE 0
 14399       TO DFHEIV11
 14400*    MOVE '&2                    $   #00012969' TO DFHEIV0
 14401     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14402     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14403     MOVE X'2020233030303132393639' TO DFHEIV0(25:11)
 14404     CALL 'kxdfhei1' USING DFHEIV0,
 14405           FILE-ID-ERPYAJ,
 14406           DFHEIV11,
 14407           DFHEIV99
 14408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 262
* EL6311.cbl
 14409     END-IF
 14410     .
 14411 1900-EXIT.
 14412     EXIT.
 14413******************************************************************
 14414*            C A N C E L   M A I N L I N E                       *
 14415******************************************************************
 14416
 14417 2000-CANCEL-MAINLINE.
 14418     IF PI-DISPLAY-ORIGINAL-BATCH
 14419        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14420           MOVE ER-0023             TO EMI-ERROR
 14421           MOVE -1                  TO CMAINTL
 14422           MOVE AL-UABON            TO CMAINTA
 14423           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14424           GO TO 8200-SEND-DATAONLY
 14425        ELSE
 14426           NEXT SENTENCE
 14427     ELSE
 14428        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14429           MOVE ER-0023             TO EMI-ERROR
 14430           MOVE -1                  TO CMAINTL
 14431           MOVE AL-UABON            TO CMAINTA
 14432           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14433           GO TO 8200-SEND-DATAONLY.
 14434
 14435     IF CMAINTI = 'S'
 14436        GO TO 2100-SHOW-REQUEST.
 14437
 14438     IF NOT MODIFY-CAP
 14439         MOVE 'UPDATE'       TO SM-READ
 14440         PERFORM 9995-SECURITY-VIOLATION
 14441         MOVE ER-0070        TO EMI-ERROR
 14442         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14443         GO TO 8100-SEND-INITIAL-MAP.
 14444
 14445     IF CMAINTL GREATER THAN ZEROS
 14446        IF PI-PF6-FUNCTION
 14447           IF CMAINTI NOT = 'A'
 14448              MOVE AL-UABON  TO CMAINTA
 14449              MOVE -1        TO CMAINTL
 14450              MOVE ER-2260   TO EMI-ERROR
 14451              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14452              GO TO 8200-SEND-DATAONLY.
 14453
 14454     IF CCERTNOL = ZEROS
 14455       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14456         NEXT SENTENCE
 14457     ELSE
 14458         IF CCERTNOL NOT = ZEROS
 14459             MOVE AL-UANON       TO CCERTNOA
 14460         ELSE
 14461             MOVE -1             TO CCERTNOL
 14462             MOVE  1             TO SET-CURSOR-SW
 14463             MOVE ER-2218       TO EMI-ERROR
 14464             MOVE AL-UABON       TO CCERTNOA
 14465             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14466
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 263
* EL6311.cbl
 14467     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14468        NEXT SENTENCE
 14469     ELSE
 14470        IF CEFFDTL NOT = ZEROS
 14471           MOVE AL-UNNON         TO CEFFDTA
 14472           MOVE CEFFDTI TO DEEDIT-FIELD
 14473           PERFORM 8600-DEEDIT
 14474           MOVE 4                TO DC-OPTION-CODE
 14475           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14476           PERFORM 9700-DATE-LINK
 14477           IF NO-CONVERSION-ERROR
 14478              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14479              ELSE
 14480              MOVE -1            TO CEFFDTL
 14481              MOVE  1            TO SET-CURSOR-SW
 14482              MOVE ER-2226      TO EMI-ERROR
 14483              MOVE AL-UNBON      TO CEFFDTA
 14484              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14485          ELSE
 14486          MOVE -1                 TO CEFFDTL
 14487          MOVE  1                 TO SET-CURSOR-SW
 14488          MOVE ER-2220            TO EMI-ERROR
 14489          MOVE AL-UNBON           TO CEFFDTA
 14490          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14491
 14492     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14493
 14494     IF CCERTNOL NOT = ZEROS
 14495        MOVE CCERTNOI                TO WS-NEW-PRIME
 14496     ELSE
 14497        MOVE SPACES                  TO WS-NEW-PRIME.
 14498
 14499     IF CSUFIXL NOT = ZEROS
 14500        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14501     ELSE
 14502        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14503
 14504     IF CEFFDTL NOT = ZEROS
 14505        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14506     ELSE
 14507        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14508
 14509     IF CMAINTI = 'A' OR 'K' OR 'S'
 14510        NEXT SENTENCE
 14511     ELSE
 14512        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14513        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14514           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14515           WS-PB-RECORD-TYPE NOT = '2'
 14516           IF CMAINTI = 'C'
 14517              MOVE ER-2287          TO EMI-ERROR
 14518              MOVE -1               TO CCERTNOL
 14519              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14520              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14521              GO TO 8200-SEND-DATAONLY
 14522             ELSE
 14523              MOVE ER-2260          TO EMI-ERROR
 14524              MOVE -1               TO CCERTNOL
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 264
* EL6311.cbl
 14525              MOVE AL-UABON         TO CCERTNOA
 14526              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14527              GO TO 8200-SEND-DATAONLY.
 14528
 14529     IF CMAINTI = 'D'
 14530        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14531
 14532     IF CLSTNML GREATER THAN ZEROS
 14533         MOVE AL-UANON           TO CLSTNMA.
 14534
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 265
* EL6311.cbl
 14536
 14537******************************************************************
 14538*                                                                *
 14539*           E D I T   C A N C E L   C O V E R A G E S            *
 14540*                                                                *
 14541******************************************************************
 14542
 14543 2015-EDIT-COVERAGES.
 14544     IF CCANDT1L      GREATER THAN ZEROS OR
 14545        CREFND1L      GREATER THAN ZEROS OR
 14546        CCANDT2L      GREATER THAN ZEROS OR
 14547        CREFND2L      GREATER THAN ZEROS OR
 14548        CMTHD1L       GREATER THAN ZEROS OR
 14549        CMTHD2L       GREATER THAN ZEROS OR
 14550        CLIVESL       GREATER THAN ZEROS OR
 14551        CPAYEEL       GREATER THAN ZEROS OR
 14552        CFORCEL       GREATER THAN ZEROS OR
 14553        CBILCDL       GREATER THAN ZEROS OR
 14554        CCANREAL      GREATER THAN ZEROS
 14555            NEXT SENTENCE
 14556         ELSE
 14557            GO TO 2030-EDIT-COMPLETE.
 14558
 14559     IF CCANDT1L = ZEROS
 14560        AND (CMAINTI = 'C' OR 'K')
 14561        NEXT SENTENCE
 14562     ELSE
 14563        IF CCANDT1L      GREATER THAN ZEROS
 14564            MOVE AL-UNNON            TO CCANDT1A
 14565            IF CCANDT1I = SPACES
 14566               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14567            ELSE
 14568               MOVE CCANDT1I            TO DEEDIT-FIELD
 14569               PERFORM 8600-DEEDIT
 14570               IF DEEDIT-FIELD-V0   NUMERIC
 14571                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14572                  MOVE 4                TO DC-OPTION-CODE
 14573                  PERFORM 9700-DATE-LINK
 14574                  IF NO-CONVERSION-ERROR
 14575                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14576                  ELSE
 14577                      MOVE -1        TO CCANDT1L
 14578                      MOVE ER-2227   TO EMI-ERROR
 14579                      MOVE AL-UNBON  TO CCANDT1A
 14580                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14581               ELSE
 14582                  MOVE -1         TO CCANDT1L
 14583                  MOVE ER-2223    TO EMI-ERROR
 14584                  MOVE AL-UNBON   TO CCANDT1A
 14585                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14586        ELSE
 14587            IF CREFND1L GREATER THAN ZEROS
 14588               MOVE -1             TO CCANDT1L
 14589               MOVE ER-2222        TO EMI-ERROR
 14590               MOVE AL-UNBOF       TO CCANDT1A
 14591               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14592
 14593     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 266
* EL6311.cbl
 14594        AND (CMAINTI = 'C' OR 'K')
 14595         NEXT SENTENCE
 14596     ELSE
 14597         IF CREFND1L NOT = ZEROS
 14598            MOVE AL-UNNON        TO CREFND1A
 14599
 14600* EXEC CICS BIF DEEDIT
 14601*               FIELD  (CREFND1I)
 14602*               LENGTH (11)
 14603*           END-EXEC
 14604     MOVE 11
 14605       TO DFHEIV11
 14606*    MOVE '@"L                   #   #00013162' TO DFHEIV0
 14607     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14608     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14609     MOVE X'2020233030303133313632' TO DFHEIV0(25:11)
 14610     CALL 'kxdfhei1' USING DFHEIV0,
 14611           CREFND1I,
 14612           DFHEIV11
 14613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14614            MOVE CREFND1I        TO WS-CREFND1
 14615*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14616*           PERFORM 8600-DEEDIT
 14617*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14618            IF WS-CREFND1  = ZEROS
 14619               AND CMAINTI = 'A'
 14620             MOVE ER-2437        TO EMI-ERROR
 14621             MOVE -1             TO CREFND1L
 14622             MOVE AL-UNBON       TO CREFND1A
 14623             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14624
 14625     IF CCANREAL > +0
 14626        MOVE AL-UANON            TO CCANREAA
 14627        IF CCANREAI = 'R' OR ' '
 14628           CONTINUE
 14629        ELSE
 14630           MOVE ER-9841        TO EMI-ERROR
 14631           MOVE -1             TO CCANREAL
 14632           MOVE AL-UABON       TO CCANREAA
 14633           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14634        END-IF
 14635     END-IF
 14636     IF CMTHD1L EQUAL +0
 14637        NEXT SENTENCE
 14638     ELSE
 14639        IF CMTHD1L NOT = +0
 14640           MOVE AL-UNNON        TO CMTHD1A
 14641           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14642                         OR '5' OR '6' OR '8' OR '9'
 14643                         OR 'R' OR ' '
 14644              NEXT SENTENCE
 14645           ELSE
 14646              MOVE ER-0582        TO EMI-ERROR
 14647              MOVE -1             TO CMTHD1L
 14648              MOVE AL-UNBON       TO CMTHD1A
 14649              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14650
 14651     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 267
* EL6311.cbl
 14652        AND (CMAINTI = 'C' OR 'K')
 14653         NEXT SENTENCE
 14654     ELSE
 14655         IF CCANDT2L  GREATER THAN ZEROS
 14656             MOVE AL-UNNON       TO CCANDT2A
 14657             IF CCANDT2I = SPACES
 14658                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14659             ELSE
 14660                MOVE CCANDT2I       TO DEEDIT-FIELD
 14661                PERFORM 8600-DEEDIT
 14662                IF DEEDIT-FIELD-V0   NUMERIC
 14663                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14664                   MOVE 4                TO DC-OPTION-CODE
 14665                   PERFORM 9700-DATE-LINK
 14666                   IF NO-CONVERSION-ERROR
 14667                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14668                   ELSE
 14669                      MOVE -1       TO CCANDT2L
 14670                      MOVE ER-2227  TO EMI-ERROR
 14671                      MOVE AL-UNBON TO CCANDT2A
 14672                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14673                ELSE
 14674                   MOVE -1         TO CCANDT2L
 14675                   MOVE ER-2223    TO EMI-ERROR
 14676                   MOVE AL-UNBON   TO CCANDT2A
 14677                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14678         ELSE
 14679            IF CREFND2L GREATER THAN ZEROS
 14680               MOVE -1             TO CCANDT2L
 14681               MOVE ER-2222        TO EMI-ERROR
 14682               MOVE AL-UNBOF       TO CCANDT2A
 14683               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14684
 14685     IF CREFND2L = ZEROS
 14686        AND (CMAINTI = 'C' OR 'K')
 14687         NEXT SENTENCE
 14688     ELSE
 14689         IF CREFND2L NOT = ZEROS
 14690            MOVE AL-UNNON        TO CREFND2A
 14691
 14692* EXEC CICS BIF DEEDIT
 14693*               FIELD  (CREFND2I)
 14694*               LENGTH (11)
 14695*           END-EXEC
 14696     MOVE 11
 14697       TO DFHEIV11
 14698*    MOVE '@"L                   #   #00013243' TO DFHEIV0
 14699     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14700     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14701     MOVE X'2020233030303133323433' TO DFHEIV0(25:11)
 14702     CALL 'kxdfhei1' USING DFHEIV0,
 14703           CREFND2I,
 14704           DFHEIV11
 14705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14706            MOVE CREFND2I        TO WS-CREFND2
 14707*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14708*           PERFORM 8600-DEEDIT
 14709*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 268
* EL6311.cbl
 14710            IF WS-CREFND2  = ZEROS
 14711               AND CMAINTI = 'A'
 14712             MOVE ER-2437        TO EMI-ERROR
 14713             MOVE -1             TO CREFND2L
 14714             MOVE AL-UNBON       TO CREFND2A
 14715             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14716
 14717     IF CMTHD2L EQUAL +0
 14718        NEXT SENTENCE
 14719     ELSE
 14720        IF CMTHD2L NOT = +0
 14721           MOVE AL-UNNON        TO CMTHD2A
 14722           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14723                         OR '5' OR '6' OR '8' OR '9'
 14724                         OR ' ' OR 'R'
 14725              NEXT SENTENCE
 14726           ELSE
 14727              MOVE ER-0582        TO EMI-ERROR
 14728              MOVE -1             TO CMTHD2L
 14729              MOVE AL-UNBON       TO CMTHD2A
 14730              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14731
 14732     IF CLIVESL GREATER THAN ZEROS
 14733         MOVE CLIVESI            TO DEEDIT-FIELD
 14734         PERFORM 8600-DEEDIT
 14735         IF DEEDIT-FIELD-V0 NUMERIC
 14736             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14737             MOVE AL-UNNON       TO CLIVESA
 14738         ELSE
 14739             MOVE -1             TO CLIVESL
 14740             MOVE AL-UNBON       TO CLIVESA
 14741             MOVE ER-2223        TO EMI-ERROR
 14742             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14743
 14744     IF CFORCEL  NOT = ZEROS
 14745         IF FORCE-CAP
 14746            MOVE AL-UANON            TO CFORCEA
 14747         ELSE
 14748            MOVE ER-2945             TO EMI-ERROR
 14749            MOVE AL-UABON            TO CFORCEA
 14750            MOVE -1                  TO CFORCEL
 14751            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14752
 14753     IF CPAYEEL GREATER THAN ZEROS
 14754        MOVE AL-UANON            TO CPAYEEA.
 14755
 14756     IF CBILCDL NOT = ZEROS
 14757        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14758                             AND 'A' AND 'B' AND 'E'
 14759           MOVE ER-2225              TO EMI-ERROR
 14760           MOVE AL-UABON             TO CBILCDA
 14761           MOVE -1                   TO CBILCDL
 14762           MOVE  1                   TO SET-CURSOR-SW
 14763           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14764        ELSE
 14765           MOVE AL-UANON             TO CBILCDA.
 14766
 14767 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 269
* EL6311.cbl
 14768     IF EMI-ERROR = ZEROS
 14769         NEXT SENTENCE
 14770     ELSE
 14771         GO TO 8200-SEND-DATAONLY.
 14772
 14773     IF CMAINTI = 'A'
 14774        GO TO 2200-ADD-CANCEL-ROUTINE.
 14775
 14776     IF CMAINTI = 'C'
 14777        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14778
 14779     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14780
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 270
* EL6311.cbl
 14782
 14783******************************************************************
 14784*                                                                *
 14785*                   S H O W   C A N C E L                        *
 14786*                                                                *
 14787******************************************************************
 14788
 14789 2100-SHOW-REQUEST.
 14790     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14791
 14792     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14793        MOVE -1                  TO CMAINTL
 14794        GO TO 8200-SEND-DATAONLY.
 14795
 14796     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14797
 14798     IF CSUFIXL NOT = ZEROS
 14799        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14800       ELSE
 14801        MOVE SPACE            TO WS-NEW-SUFFIX.
 14802
 14803     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14804     PERFORM 8600-DEEDIT.
 14805     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14806     MOVE '4'                    TO DC-OPTION-CODE.
 14807     PERFORM 9700-DATE-LINK.
 14808     IF DATE-CONVERSION-ERROR
 14809        MOVE ER-0348             TO EMI-ERROR
 14810        MOVE -1                  TO CEFFDTL
 14811        MOVE AL-UABON            TO CEFFDTA
 14812        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14813        GO TO 8200-SEND-DATAONLY
 14814     ELSE
 14815        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14816        MOVE AL-UANON            TO CEFFDTA
 14817        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14818
 14819     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14820
 14821     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14822        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14823        MOVE 'Y'                    TO WS-SHOW-SW
 14824        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14825           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14826        ELSE
 14827           IF PI-FILE-BROWSE
 14828              GO TO 4300-BROWSE-FILE-FORWARD
 14829           ELSE
 14830              IF PI-CSR-BROWSE
 14831                 GO TO 4200-BROWSE-CSR-FORWARD
 14832              ELSE
 14833                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14834     ELSE
 14835        GO TO 3900-RE-DISPLAY-RECORD.
 14836
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 271
* EL6311.cbl
 14838
 14839
 14840******************************************************************
 14841*                                                                *
 14842*            A D D   C A N C E L   R O U T I N E                 *
 14843*                                                                *
 14844******************************************************************
 14845
 14846 2200-ADD-CANCEL-ROUTINE.
 14847     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14848
 14849
 14850* EXEC CICS GETMAIN
 14851*        SET     (ADDRESS OF PENDING-BUSINESS)
 14852*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14853*    END-EXEC.
 14854*    MOVE '," L                  $   #00013390' TO DFHEIV0
 14855     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14856     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14857     MOVE X'2020233030303133333930' TO DFHEIV0(25:11)
 14858     CALL 'kxdfhei1' USING DFHEIV0,
 14859           DFHEIV20,
 14860           ERPNDB-RECORD-LENGTH,
 14861           DFHEIV99
 14862     SET ADDRESS OF PENDING-BUSINESS TO
 14863         DFHEIV20
 14864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14865
 14866
 14867
 14868* EXEC CICS HANDLE CONDITION
 14869*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14870*    END-EXEC.
 14871*    MOVE '"$I                   ! 3 #00013395' TO DFHEIV0
 14872     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14874     MOVE X'3320233030303133333935' TO DFHEIV0(25:11)
 14875     CALL 'kxdfhei1' USING DFHEIV0
 14876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14877
 14878
 14879     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14880     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14881     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14882
 14883
 14884* EXEC CICS READ
 14885*        INTO    (PENDING-BUSINESS)
 14886*        DATASET (FILE-ID-ERPNDB)
 14887*        RIDFLD  (ERPNDB-KEY)
 14888*    END-EXEC.
 14889     MOVE LENGTH OF
 14890      PENDING-BUSINESS
 14891       TO DFHEIV11
 14892*    MOVE '&"IL       E          (   #00013403' TO DFHEIV0
 14893     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14894     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14895     MOVE X'2020233030303133343033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 272
* EL6311.cbl
 14896     CALL 'kxdfhei1' USING DFHEIV0,
 14897           FILE-ID-ERPNDB,
 14898           PENDING-BUSINESS,
 14899           DFHEIV11,
 14900           ERPNDB-KEY,
 14901           DFHEIV99,
 14902           DFHEIV99,
 14903           DFHEIV99
 14904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14905
 14906
 14907     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14908
 14909     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14910     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14911     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14912     MOVE SPACES                 TO PENDING-BUSINESS.
 14913     MOVE 'PB'                   TO PB-RECORD-ID.
 14914     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14915     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14916     MOVE SPACES                 TO PB-CERT-SFX.
 14917     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14918     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14919                                    PB-ALT-CHG-SEQ-NO.
 14920
 14921     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14922     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14923     MOVE '2'                    TO PB-RECORD-TYPE.
 14924
 14925     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14926     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14927
 14928
 14929     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14930                                    PB-ALT-CHG-SEQ-NO
 14931                                    PB-C-LF-REF-CALC
 14932                                    PB-C-AH-REF-CALC
 14933                                    PB-C-LF-RFND-CLP
 14934                                    PB-C-AH-RFND-CLP
 14935                                    PB-CI-INSURED-AGE
 14936                                    PB-CI-LF-TERM
 14937                                    PB-CI-AH-TERM
 14938                                    PB-CI-LF-BENEFIT-CD
 14939                                    PB-CI-LF-BENEFIT-AMT
 14940                                    PB-CI-LF-ALT-BENEFIT-AMT
 14941                                    PB-CI-LF-PREMIUM-AMT
 14942                                    PB-CI-LF-ALT-PREMIUM-AMT
 14943                                    PB-CI-AH-BENEFIT-CD
 14944                                    PB-CI-AH-BENEFIT-AMT
 14945                                    PB-CI-AH-PREMIUM-AMT
 14946                                    PB-CI-PAY-FREQUENCY
 14947                                    PB-CI-LOAN-APR
 14948                                    PB-CI-LOAN-TERM
 14949                                    PB-CI-LIFE-COMMISSION
 14950                                    PB-CI-AH-COMMISSION
 14951                                    PB-CI-CURR-SEQ
 14952                                    PB-CI-AH-CANCEL-AMT
 14953                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 273
* EL6311.cbl
 14954                                    PB-CI-RATE-DEV-PCT-LF
 14955                                    PB-CI-RATE-DEV-PCT-AH
 14956                                    PB-CI-EXTENTION-DAYS
 14957                                    PB-CI-TERM-IN-DAYS
 14958                                    PB-CI-LIVES
 14959                                    PB-CI-LF-CRIT-PER
 14960                                    PB-CI-AH-CRIT-PER
 14961                                    PB-C-LF-REM-TERM
 14962                                    PB-C-AH-REM-TERM
 14963                                    PB-CHG-COUNT
 14964                                    PB-LF-BILLED-AMTS
 14965                                    PB-AH-BILLED-AMTS
 14966                                    PB-C-INT-ON-REFS
 14967*                                   PB-C-MICROFILM-NO
 14968                                    PB-CALC-TOLERANCE.
 14969
 14970     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14971                                    PB-CI-AH-SETTLEMENT-DT
 14972                                    PB-CI-DEATH-DT
 14973                                    PB-CI-LF-PRIOR-CANCEL-DT
 14974                                    PB-CI-AH-PRIOR-CANCEL-DT
 14975                                    PB-CI-ENTRY-DT
 14976                                    PB-CI-LF-EXPIRE-DT
 14977                                    PB-CI-AH-EXPIRE-DT
 14978                                    PB-CI-LOAN-1ST-PMT-DT
 14979                                    PB-C-LF-CANCEL-DT
 14980                                    PB-C-AH-CANCEL-DT
 14981                                    PB-CREDIT-ACCEPT-DT
 14982                                    PB-BILLED-DT
 14983                                    PB-ACCT-EFF-DT
 14984                                    PB-ACCT-EXP-DT.
 14985
 14986     MOVE 'X'                    TO PB-FATAL-FLAG.
 14987
 14988     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14989
 14990     IF CSUFIXL     GREATER THAN ZEROS
 14991        MOVE CSUFIXI             TO PB-CERT-SFX.
 14992
 14993*    IF CMICRNOL  GREATER  ZEROS
 14994*        IF CMICRNOI  NUMERIC
 14995*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14996*            MOVE AL-UNNON       TO  CMICRNOA
 14997*        ELSE
 14998*            MOVE -1             TO  CMICRNOL
 14999*            MOVE AL-UNBON       TO  CMICRNOA
 15000*            MOVE ER-2701        TO  EMI-ERROR
 15001*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15002
 15003     IF CLSTNML     GREATER THAN ZEROS
 15004        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15005
 15006     IF CCANREAL > ZEROS
 15007        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15008     END-IF
 15009     IF CPCYNL > ZEROS
 15010        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15011     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 274
* EL6311.cbl
 15012     IF CCANDT1L    GREATER THAN ZEROS
 15013        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15014
 15015     IF CCANDT2L    GREATER THAN ZEROS
 15016        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15017
 15018     IF CMTHD1L    GREATER THAN +0
 15019        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15020
 15021     IF CMTHD2L    GREATER THAN +0
 15022        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15023
 15024     IF CREFND1L    GREATER THAN ZEROS
 15025        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15026        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15027     ELSE
 15028        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15029
 15030     IF CREFND2L    GREATER THAN ZEROS
 15031        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15032        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15033     ELSE
 15034        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15035
 15036     IF CLIVESL     GREATER THAN ZEROS
 15037        MOVE WS-CLIVES           TO PB-C-LIVES
 15038     ELSE
 15039        MOVE ZEROS               TO PB-C-LIVES.
 15040
 15041     IF CPAYEEL     GREATER THAN ZEROS
 15042        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15043
 15044     IF CFORCEL     GREATER THAN ZEROS
 15045        MOVE CFORCEI             TO PB-FORCE-CODE.
 15046
 15047     IF CBILCDL     GREATER THAN ZEROS
 15048        MOVE CBILCDI             TO PB-RECORD-BILL.
 15049
 15050*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15051
 15052 2260-WRITE-PB-RECORD.
 15053     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15054                                    PB-INPUT-BY.
 15055     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15056     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15057                                    PB-INPUT-DT.
 15058
 15059     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15060     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15061                                    PB-CONTROL-BY-ORIG-BATCH.
 15062
 15063     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15064     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15065     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15066     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15067     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15068
 15069     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 275
* EL6311.cbl
 15070
 15071     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15072
 15073     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15074     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15075     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15076
 15077     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15078     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15079
 15080 2275-WRITE-PENDING-BUSINESS.
 15081     MOVE 'A'                    TO JP-RECORD-TYPE.
 15082     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15083     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15084     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15085
 15086
 15087* EXEC CICS HANDLE CONDITION
 15088*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15089*    END-EXEC.
 15090*    MOVE '"$%                   ! 4 #00013588' TO DFHEIV0
 15091     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15093     MOVE X'3420233030303133353838' TO DFHEIV0(25:11)
 15094     CALL 'kxdfhei1' USING DFHEIV0
 15095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15096
 15097
 15098
 15099* EXEC CICS WRITE
 15100*        DATASET (FILE-ID-ERPNDB)
 15101*        FROM    (PENDING-BUSINESS)
 15102*        RIDFLD  (PB-CONTROL-PRIMARY)
 15103*    END-EXEC.
 15104     MOVE LENGTH OF
 15105      PENDING-BUSINESS
 15106       TO DFHEIV11
 15107*    MOVE '&$ L                  ''   #00013592' TO DFHEIV0
 15108     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15110     MOVE X'2020233030303133353932' TO DFHEIV0(25:11)
 15111     CALL 'kxdfhei1' USING DFHEIV0,
 15112           FILE-ID-ERPNDB,
 15113           PENDING-BUSINESS,
 15114           DFHEIV11,
 15115           PB-CONTROL-PRIMARY,
 15116           DFHEIV99,
 15117           DFHEIV99
 15118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15119
 15120
 15121     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15122
 15123     PERFORM 8400-LOG-JOURNAL-RECORD.
 15124
 15125******************************************************************
 15126*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15127******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 276
* EL6311.cbl
 15128
 15129     display ' made it to add orig CANCEL cert '
 15130     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15131     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15132     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15133     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15134
 15135
 15136* EXEC CICS READ
 15137*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15138*        DATASET (FILE-ID-ELCERT)
 15139*        RIDFLD  (ELCERT-KEY)
 15140*        RESP    (WS-RESPONSE)
 15141*    END-EXEC.
 15142*    MOVE '&"S        E          (  N#00013612' TO DFHEIV0
 15143     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15144     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15145     MOVE X'204E233030303133363132' TO DFHEIV0(25:11)
 15146     CALL 'kxdfhei1' USING DFHEIV0,
 15147           FILE-ID-ELCERT,
 15148           DFHEIV20,
 15149           DFHEIV99,
 15150           ELCERT-KEY,
 15151           DFHEIV99,
 15152           DFHEIV99,
 15153           DFHEIV99
 15154     SET ADDRESS OF CERTIFICATE-MASTER TO
 15155         DFHEIV20
 15156     MOVE EIBRESP  TO WS-RESPONSE
 15157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15158
 15159
 15160     IF NOT RESP-NORMAL
 15161        GO TO 2276-BYPASS-CRTO
 15162     END-IF
 15163
 15164     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15165     MOVE ' '                    TO WS-ERMAIL-SW
 15166
 15167
 15168* EXEC CICS READ
 15169*       DATASET   (FILE-ID-ERMAIL)
 15170*       SET       (ADDRESS OF MAILING-DATA)
 15171*       RIDFLD    (ERMAIL-KEY)
 15172*       RESP      (WS-RESPONSE)
 15173*    END-EXEC
 15174*    MOVE '&"S        E          (  N#00013626' TO DFHEIV0
 15175     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15177     MOVE X'204E233030303133363236' TO DFHEIV0(25:11)
 15178     CALL 'kxdfhei1' USING DFHEIV0,
 15179           FILE-ID-ERMAIL,
 15180           DFHEIV20,
 15181           DFHEIV99,
 15182           ERMAIL-KEY,
 15183           DFHEIV99,
 15184           DFHEIV99,
 15185           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 277
* EL6311.cbl
 15186     SET ADDRESS OF MAILING-DATA TO
 15187         DFHEIV20
 15188     MOVE EIBRESP  TO WS-RESPONSE
 15189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15190
 15191     IF RESP-NORMAL
 15192        SET ERMAIL-FOUND TO TRUE
 15193     END-IF
 15194
 15195     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15196
 15197     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15198     MOVE 'OC'                   TO OC-RECORD-ID
 15199     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15200                                 TO OC-CONTROL-PRIMARY (1:33)
 15201     MOVE 'I'                    TO OC-RECORD-TYPE
 15202     MOVE +4096                  TO OC-KEY-SEQ-NO
 15203     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15204     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15205     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15206
 15207     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15208     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15209     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15210     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15211     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15212     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15213     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15214     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15215     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15216     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15217     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15218     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15219     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15220     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15221     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15222     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15223     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15224     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15225     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15226     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15227     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15228     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15229     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15230     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15231     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15232     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15233     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15234     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15235     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15236     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15237     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15238     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15239
 15240     IF ERMAIL-FOUND
 15241        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15242     END-IF
 15243     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 278
* EL6311.cbl
 15244        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15245                           OC-INS-AGE-DEFAULT-FLAG
 15246        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15247                           OC-JNT-AGE-DEFAULT-FLAG
 15248     END-IF
 15249     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15250     .
 15251 2275-WRITE-ELCRTO.
 15252
 15253
 15254* EXEC CICS WRITE
 15255*       DATASET   ('ELCRTO')
 15256*       FROM      (ORIGINAL-CERTIFICATE)
 15257*       RIDFLD    (OC-CONTROL-PRIMARY)
 15258*       RESP      (WS-RESPONSE)
 15259*    END-EXEC
 15260     MOVE LENGTH OF
 15261      ORIGINAL-CERTIFICATE
 15262       TO DFHEIV11
 15263     MOVE 'ELCRTO' TO DFHEIV1
 15264*    MOVE '&$ L                  ''  N#00013695' TO DFHEIV0
 15265     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15267     MOVE X'204E233030303133363935' TO DFHEIV0(25:11)
 15268     CALL 'kxdfhei1' USING DFHEIV0,
 15269           DFHEIV1,
 15270           ORIGINAL-CERTIFICATE,
 15271           DFHEIV11,
 15272           OC-CONTROL-PRIMARY,
 15273           DFHEIV99,
 15274           DFHEIV99
 15275     MOVE EIBRESP  TO WS-RESPONSE
 15276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15277
 15278     display ' just wrote 2275 ' ws-response
 15279     IF RESP-DUPKEY
 15280        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15281        GO TO 2275-WRITE-ELCRTO
 15282     ELSE
 15283        IF NOT RESP-NORMAL
 15284           MOVE -1               TO BMAINTL
 15285           MOVE ER-7450          TO EMI-ERROR
 15286           PERFORM 9900-ERROR-FORMAT
 15287                                 THRU 9900-EXIT
 15288           GO TO 8200-SEND-DATAONLY
 15289        END-IF
 15290     END-IF.
 15291
 15292 2276-BYPASS-CRTO.
 15293******************************************************************
 15294*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15295******************************************************************
 15296
 15297
 15298* EXEC CICS READ
 15299*        INTO    (PENDING-BUSINESS)
 15300*        DATASET (FILE-ID-ERPNDB)
 15301*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 279
* EL6311.cbl
 15302*        UPDATE
 15303*    END-EXEC.
 15304     MOVE LENGTH OF
 15305      PENDING-BUSINESS
 15306       TO DFHEIV11
 15307*    MOVE '&"IL       EU         (   #00013721' TO DFHEIV0
 15308     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15309     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15310     MOVE X'2020233030303133373231' TO DFHEIV0(25:11)
 15311     CALL 'kxdfhei1' USING DFHEIV0,
 15312           FILE-ID-ERPNDB,
 15313           PENDING-BUSINESS,
 15314           DFHEIV11,
 15315           ERPNDB-KEY,
 15316           DFHEIV99,
 15317           DFHEIV99,
 15318           DFHEIV99
 15319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15320
 15321
 15322     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15323     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15324     MOVE 'B'                    TO JP-RECORD-TYPE.
 15325     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15326
 15327     PERFORM 8400-LOG-JOURNAL-RECORD.
 15328
 15329     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15330
 15331
 15332* EXEC CICS REWRITE
 15333*        DATASET (FILE-ID-ERPNDB)
 15334*        FROM    (PENDING-BUSINESS)
 15335*    END-EXEC.
 15336     MOVE LENGTH OF
 15337      PENDING-BUSINESS
 15338       TO DFHEIV11
 15339*    MOVE '&& L                  %   #00013737' TO DFHEIV0
 15340     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15341     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15342     MOVE X'2020233030303133373337' TO DFHEIV0(25:11)
 15343     CALL 'kxdfhei1' USING DFHEIV0,
 15344           FILE-ID-ERPNDB,
 15345           PENDING-BUSINESS,
 15346           DFHEIV11,
 15347           DFHEIV99
 15348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15349
 15350
 15351     MOVE 'C'                    TO JP-RECORD-TYPE.
 15352     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15353
 15354     PERFORM 8400-LOG-JOURNAL-RECORD.
 15355
 15356     IF WS-ERRORS-PRESENT
 15357        GO TO 3900-RE-DISPLAY-RECORD.
 15358
 15359     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 280
* EL6311.cbl
 15360     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15361     MOVE LOW-VALUES             TO EL631CI.
 15362     MOVE  -1                    TO CMAINTL.
 15363     GO TO 8100-SEND-INITIAL-MAP.
 15364
 15365 2280-BATCH-HDR-NOT-FOUND.
 15366     MOVE -1                     TO BMAINTL.
 15367     MOVE ER-7450                TO EMI-ERROR.
 15368     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15369     GO TO 8200-SEND-DATAONLY.
 15370
 15371 2290-DUPLICATE-ALT-INDEX.
 15372
 15373******************************************************************
 15374*                                                                *
 15375*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15376*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15377*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15378*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15379*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15380*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15381*                                                                *
 15382******************************************************************
 15383
 15384     IF LCP-ONCTR-02 =  0
 15385         ADD 1 TO LCP-ONCTR-02
 15386        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15387
 15388     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15389
 15390     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15391         NEXT SENTENCE
 15392     ELSE
 15393         ADD +1 TO PB-BATCH-SEQ-NO
 15394                   PB-CSR-BATCH-SEQ-NO
 15395         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15396         GO TO 2275-WRITE-PENDING-BUSINESS.
 15397
 15398     MOVE -1                     TO CCERTNOL.
 15399     MOVE AL-UABON               TO CCERTNOA.
 15400     MOVE AL-UNBON               TO CEFFDTA.
 15401
 15402     MOVE 1                      TO EMI-SUB
 15403                                    EMI-SWITCH1
 15404                                    EMI-SWITCH-AREA-1
 15405                                    EMI-SWITCH-AREA-2.
 15406
 15407     MOVE SPACES                 TO EMI-ERROR-LINES.
 15408
 15409
 15410* EXEC CICS SYNCPOINT ROLLBACK
 15411*    END-EXEC.
 15412*    MOVE '6"R                   !   #00013800' TO DFHEIV0
 15413     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15414     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15415     MOVE X'2020233030303133383030' TO DFHEIV0(25:11)
 15416     CALL 'kxdfhei1' USING DFHEIV0
 15417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 281
* EL6311.cbl
 15418
 15419
 15420     MOVE ER-2247                TO EMI-ERROR.
 15421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15422     GO TO 8200-SEND-DATAONLY.
 15423
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 282
* EL6311.cbl
 15425
 15426******************************************************************
 15427*                                                                *
 15428*          C H A N G E   C A N C E L   R O U T I N E             *
 15429*                                                                *
 15430******************************************************************
 15431
 15432***************************************************************
 15433*                                                             *
 15434*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15435*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15436*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15437*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15438*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15439*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15440*     5. LINK TO THE EDIT ROUTINE.                            *
 15441*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15442*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15443*              THE EDIT ROUTINE.                              *
 15444*     7. REWRITE THE NEW ISSUE                                *
 15445*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15446*                                                             *
 15447***************************************************************
 15448 2300-CHANGE-CANCEL-ROUTINE.
 15449     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15450
 15451     IF CCHGL NOT = ZEROS
 15452        MOVE ER-2196             TO EMI-ERROR
 15453        MOVE AL-UABON            TO CMAINTA
 15454        MOVE -1                  TO CMAINTL
 15455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15456        GO TO 8200-SEND-DATAONLY.
 15457
 15458     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15459
 15460     IF CSUFIXL NOT = ZEROS
 15461        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15462     ELSE
 15463        MOVE SPACE               TO WS-NEW-SUFFIX.
 15464
 15465     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15466     PERFORM 8600-DEEDIT.
 15467     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15468     MOVE '4'                    TO DC-OPTION-CODE.
 15469
 15470     PERFORM 9700-DATE-LINK.
 15471
 15472     IF DATE-CONVERSION-ERROR
 15473        MOVE ER-0348             TO EMI-ERROR
 15474        MOVE -1                  TO CEFFDTL
 15475        MOVE AL-UABON            TO CEFFDTA
 15476        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15477        GO TO 8200-SEND-DATAONLY
 15478     ELSE
 15479        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15480        MOVE AL-UANON            TO CEFFDTA
 15481        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15482
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 283
* EL6311.cbl
 15483 2325-PROCESS-CANCEL-CHANGES.
 15484
 15485* EXEC CICS HANDLE CONDITION
 15486*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15487*    END-EXEC.
 15488*    MOVE '"$I                   ! 5 #00013867' TO DFHEIV0
 15489     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15491     MOVE X'3520233030303133383637' TO DFHEIV0(25:11)
 15492     CALL 'kxdfhei1' USING DFHEIV0
 15493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15494
 15495
 15496     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15497     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15498     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15499
 15500
 15501* EXEC CICS GETMAIN
 15502*        SET      (ADDRESS OF PENDING-BUSINESS)
 15503*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15504*        INITIMG  (GETMAIN-SPACE)
 15505*     END-EXEC.
 15506*    MOVE ',"IL                  $   #00013875' TO DFHEIV0
 15507     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15508     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15509     MOVE X'2020233030303133383735' TO DFHEIV0(25:11)
 15510     CALL 'kxdfhei1' USING DFHEIV0,
 15511           DFHEIV20,
 15512           ERPNDB-RECORD-LENGTH,
 15513           GETMAIN-SPACE
 15514     SET ADDRESS OF PENDING-BUSINESS TO
 15515         DFHEIV20
 15516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15517
 15518
 15519
 15520* EXEC CICS READ
 15521*        INTO    (PENDING-BUSINESS)
 15522*        DATASET (FILE-ID-ERPNDB)
 15523*        RIDFLD  (ERPNDB-KEY)
 15524*    END-EXEC.
 15525     MOVE LENGTH OF
 15526      PENDING-BUSINESS
 15527       TO DFHEIV11
 15528*    MOVE '&"IL       E          (   #00013881' TO DFHEIV0
 15529     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15531     MOVE X'2020233030303133383831' TO DFHEIV0(25:11)
 15532     CALL 'kxdfhei1' USING DFHEIV0,
 15533           FILE-ID-ERPNDB,
 15534           PENDING-BUSINESS,
 15535           DFHEIV11,
 15536           ERPNDB-KEY,
 15537           DFHEIV99,
 15538           DFHEIV99,
 15539           DFHEIV99
 15540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 284
* EL6311.cbl
 15541
 15542
 15543     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15544
 15545
 15546* EXEC CICS HANDLE CONDITION
 15547*         NOTFND     (2385-REC-NOT-FOUND)
 15548*    END-EXEC.
 15549*    MOVE '"$I                   ! 6 #00013889' TO DFHEIV0
 15550     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15552     MOVE X'3620233030303133383839' TO DFHEIV0(25:11)
 15553     CALL 'kxdfhei1' USING DFHEIV0
 15554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15555
 15556
 15557**********************************************************
 15558*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15559*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15560**********************************************************
 15561
 15562
 15563* EXEC CICS READ
 15564*        DATASET (FILE-ID-ERPNDB)
 15565*        INTO    (PENDING-BUSINESS)
 15566*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15567*    END-EXEC.
 15568     MOVE LENGTH OF
 15569      PENDING-BUSINESS
 15570       TO DFHEIV11
 15571*    MOVE '&"IL       E          (   #00013898' TO DFHEIV0
 15572     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15574     MOVE X'2020233030303133383938' TO DFHEIV0(25:11)
 15575     CALL 'kxdfhei1' USING DFHEIV0,
 15576           FILE-ID-ERPNDB,
 15577           PENDING-BUSINESS,
 15578           DFHEIV11,
 15579           PI-PREV-CONTROL-PRIMARY,
 15580           DFHEIV99,
 15581           DFHEIV99,
 15582           DFHEIV99
 15583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15584
 15585
 15586********** DO NOT ALLOW CHANGES IF THRU A/R
 15587     IF BMAINTI = 'C'
 15588         IF PB-EL860-INTERNAL-PROCESS
 15589             MOVE ER-4005          TO EMI-ERROR
 15590             MOVE -1               TO BMAINTL
 15591             MOVE AL-UABON         TO BMAINTA
 15592             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15593             GO TO 8200-SEND-DATAONLY.
 15594**********
 15595
 15596     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15597        MOVE -1                 TO CMAINTL
 15598        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 285
* EL6311.cbl
 15599        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15600        GO TO 8200-SEND-DATAONLY.
 15601
 15602     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15603        MOVE ER-2196             TO EMI-ERROR
 15604        MOVE AL-UABON            TO CMAINTA
 15605        MOVE -1                  TO CMAINTL
 15606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15607        GO TO 8200-SEND-DATAONLY.
 15608     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15609
 15610     IF PB-BILLED-DT = LOW-VALUES AND
 15611        PB-CHG-COUNT = ZEROS
 15612        NEXT SENTENCE
 15613     ELSE
 15614        IF (CREFND1L GREATER THAN ZEROS AND
 15615            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15616           OR
 15617           (CREFND2L GREATER THAN ZEROS AND
 15618            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15619           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15620     if ((crefnd1l <> zeros)
 15621        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15622                      or
 15623        ((crefnd2l <> zeros)
 15624        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15625        continue
 15626     else
 15627        go to 2330-continue-change
 15628     end-if
 15629
 15630     move zeros                  to ws-check-amts
 15631     move ' '                    to ws-stop-sw
 15632                                    ws-check-sw
 15633                                    ws-any-check-sw
 15634                                    ws-proc-check-sw
 15635                                    ws-chek-browse-sw
 15636
 15637     perform 2500-browse-checks  thru 2500-exit
 15638
 15639     if i-have-processed-checks
 15640        or i-have-checks
 15641        continue
 15642     else
 15643        go to 2330-continue-change
 15644     end-if
 15645
 15646     if crefnd1l <> zeros
 15647        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15648        move ws-crefnd1 to ws-new-ref-total
 15649     else
 15650        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15651     end-if
 15652     if crefnd2l <> zeros
 15653        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15654        compute ws-new-ref-total = ws-new-ref-total +
 15655           ws-crefnd2
 15656     else
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 286
* EL6311.cbl
 15657        compute ws-new-ref-total = ws-new-ref-total +
 15658           pb-c-ah-cancel-amt
 15659     end-if
 15660
 15661     if zeros = (ws-lf-diff + ws-ah-diff)
 15662        move er-3449             to emi-error
 15663        perform 9900-error-format thru 9900-exit
 15664        go to 2330-continue-change
 15665     end-if
 15666
 15667     if (ws-new-ref-total < ws-check-amts)
 15668        and (pb-c-refund-sw = 'Y')
 15669        move er-3447             to emi-error
 15670        perform 9900-error-format thru 9900-exit
 15671        move al-uabon            to cmainta
 15672        move -1                  to cmaintl
 15673        go to 8200-send-dataonly
 15674     end-if
 15675
 15676     if (ws-new-ref-total > ws-check-amts)
 15677        and (ws-check-amts not = zeros)
 15678        move er-3448             to emi-error
 15679        move al-uabon            to crefnd1a
 15680                                    crefnd2a
 15681        perform 9900-error-format thru 9900-exit
 15682     end-if
 15683
 15684*     if (ws-lf-diff + ws-ah-diff) < zeros
 15685*        move er-3447             to emi-error
 15686*        perform 9900-error-format thru 9900-exit
 15687*        move al-uabon            to cmainta
 15688*        move -1                  to cmaintl
 15689*        go to 8200-send-dataonly
 15690*     end-if
 15691     .
 15692 2330-continue-change.
 15693
 15694
 15695* EXEC CICS READ
 15696*        DATASET (FILE-ID-ERPNDB)
 15697*        INTO    (PENDING-BUSINESS)
 15698*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15699*        UPDATE
 15700*    END-EXEC.
 15701     MOVE LENGTH OF
 15702      PENDING-BUSINESS
 15703       TO DFHEIV11
 15704*    MOVE '&"IL       EU         (   #00014012' TO DFHEIV0
 15705     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15706     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15707     MOVE X'2020233030303134303132' TO DFHEIV0(25:11)
 15708     CALL 'kxdfhei1' USING DFHEIV0,
 15709           FILE-ID-ERPNDB,
 15710           PENDING-BUSINESS,
 15711           DFHEIV11,
 15712           PI-PREV-CONTROL-PRIMARY,
 15713           DFHEIV99,
 15714           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 287
* EL6311.cbl
 15715           DFHEIV99
 15716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15717
 15718
 15719     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15720     MOVE 'B'                    TO JP-RECORD-TYPE
 15721     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15722     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15723
 15724     PERFORM 8400-LOG-JOURNAL-RECORD.
 15725
 15726     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15727          PB-CHG-COUNT NOT = ZEROS
 15728        IF (CREFND1L GREATER THAN ZEROS AND
 15729            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15730           OR
 15731           (CREFND2L GREATER THAN ZEROS AND
 15732            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15733            ADD +1                      TO PB-CHG-COUNT
 15734            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15735
 15736*    IF CMICRNOL  GREATER  ZEROS
 15737*        IF CMICRNOI  NUMERIC
 15738*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15739*            MOVE AL-UNNON       TO  CMICRNOA
 15740*        ELSE
 15741*            MOVE -1             TO  CMICRNOL
 15742*            MOVE AL-UNBON       TO  CMICRNOA
 15743*            MOVE ER-2701        TO  EMI-ERROR
 15744*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15745
 15746     IF CSUFIXL GREATER THAN ZEROS
 15747        MOVE CSUFIXI             TO PB-CERT-SFX.
 15748
 15749     IF CLSTNML GREATER THAN ZEROS
 15750         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15751
 15752     IF CCANREAL > ZEROS
 15753        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15754     END-IF
 15755     IF CPCYNL > ZEROS
 15756        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15757     END-IF
 15758     IF CCANDT1L    GREATER THAN ZEROS
 15759        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15760
 15761     IF CCANDT2L    GREATER THAN ZEROS
 15762        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15763
 15764     IF CMTHD1L    GREATER THAN +0
 15765        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15766
 15767     IF CMTHD2L    GREATER THAN +0
 15768        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15769
 15770     IF CREFND1L    GREATER THAN ZEROS
 15771        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15772        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 288
* EL6311.cbl
 15773        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15774        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15775
 15776     IF CREFND2L    GREATER THAN ZEROS
 15777        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15778        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15779        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15780        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15781
 15782     IF CLIVESL     GREATER THAN ZEROS
 15783        MOVE WS-CLIVES           TO PB-C-LIVES.
 15784
 15785     IF CPAYEEL     GREATER THAN ZEROS
 15786        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15787
 15788     IF CFORCEL     GREATER THAN ZEROS
 15789        MOVE CFORCEI             TO PB-FORCE-CODE.
 15790
 15791     IF CBILCDL     GREATER THAN ZEROS
 15792        MOVE CBILCDI             TO PB-RECORD-BILL.
 15793
 15794 2360-REWRITE-PB-RECORD.
 15795     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15796     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15797     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15798     MOVE 'C'                    TO JP-RECORD-TYPE.
 15799     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15800     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15801     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15802
 15803     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15804
 15805     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15806     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15807
 15808     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15809
 15810     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15811
 15812     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15813     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15814     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15815
 15816     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15817     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15818
 15819 2375-REWRITE-PENDING-BUSINESS.
 15820     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15821     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15822     MOVE 'C'                    TO JP-RECORD-TYPE.
 15823     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15824
 15825
 15826* EXEC CICS REWRITE
 15827*        DATASET (FILE-ID-ERPNDB)
 15828*        FROM    (PENDING-BUSINESS)
 15829*    END-EXEC.
 15830     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 289
* EL6311.cbl
 15831      PENDING-BUSINESS
 15832       TO DFHEIV11
 15833*    MOVE '&& L                  %   #00014125' TO DFHEIV0
 15834     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15835     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15836     MOVE X'2020233030303134313235' TO DFHEIV0(25:11)
 15837     CALL 'kxdfhei1' USING DFHEIV0,
 15838           FILE-ID-ERPNDB,
 15839           PENDING-BUSINESS,
 15840           DFHEIV11,
 15841           DFHEIV99
 15842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15843
 15844
 15845     PERFORM 8400-LOG-JOURNAL-RECORD.
 15846
 15847******************************************************************
 15848*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15849******************************************************************
 15850
 15851     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15852     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15853     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15854     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15855
 15856
 15857* EXEC CICS READ
 15858*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15859*        DATASET (FILE-ID-ELCERT)
 15860*        RIDFLD  (ELCERT-KEY)
 15861*        RESP    (WS-RESPONSE)
 15862*    END-EXEC.
 15863*    MOVE '&"S        E          (  N#00014141' TO DFHEIV0
 15864     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15866     MOVE X'204E233030303134313431' TO DFHEIV0(25:11)
 15867     CALL 'kxdfhei1' USING DFHEIV0,
 15868           FILE-ID-ELCERT,
 15869           DFHEIV20,
 15870           DFHEIV99,
 15871           ELCERT-KEY,
 15872           DFHEIV99,
 15873           DFHEIV99,
 15874           DFHEIV99
 15875     SET ADDRESS OF CERTIFICATE-MASTER TO
 15876         DFHEIV20
 15877     MOVE EIBRESP  TO WS-RESPONSE
 15878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15879
 15880
 15881     IF NOT RESP-NORMAL
 15882        GO TO 2376-BYPASS-CRTO
 15883     END-IF
 15884
 15885
 15886     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15887     MOVE ' '                    TO WS-ERMAIL-SW
 15888
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 290
* EL6311.cbl
 15889
 15890* EXEC CICS READ
 15891*       DATASET   (FILE-ID-ERMAIL)
 15892*       SET       (ADDRESS OF MAILING-DATA)
 15893*       RIDFLD    (ERMAIL-KEY)
 15894*       RESP      (WS-RESPONSE)
 15895*    END-EXEC
 15896*    MOVE '&"S        E          (  N#00014156' TO DFHEIV0
 15897     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15899     MOVE X'204E233030303134313536' TO DFHEIV0(25:11)
 15900     CALL 'kxdfhei1' USING DFHEIV0,
 15901           FILE-ID-ERMAIL,
 15902           DFHEIV20,
 15903           DFHEIV99,
 15904           ERMAIL-KEY,
 15905           DFHEIV99,
 15906           DFHEIV99,
 15907           DFHEIV99
 15908     SET ADDRESS OF MAILING-DATA TO
 15909         DFHEIV20
 15910     MOVE EIBRESP  TO WS-RESPONSE
 15911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15912
 15913     IF RESP-NORMAL
 15914        SET ERMAIL-FOUND TO TRUE
 15915     END-IF
 15916
 15917     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15918
 15919     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15920                                 TO ELCRTO-KEY
 15921     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15922     MOVE +0                     TO ELCRTO-SEQ-NO
 15923
 15924
 15925* EXEC CICS READ
 15926*       DATASET   ('ELCRTO')
 15927*       INTO      (ORIGINAL-CERTIFICATE)
 15928*       RIDFLD    (ELCRTO-KEY)
 15929*       GTEQ
 15930*       RESP      (WS-RESPONSE)
 15931*    END-EXEC
 15932     MOVE LENGTH OF
 15933      ORIGINAL-CERTIFICATE
 15934       TO DFHEIV11
 15935     MOVE 'ELCRTO' TO DFHEIV1
 15936*    MOVE '&"IL       G          (  N#00014174' TO DFHEIV0
 15937     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15938     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15939     MOVE X'204E233030303134313734' TO DFHEIV0(25:11)
 15940     CALL 'kxdfhei1' USING DFHEIV0,
 15941           DFHEIV1,
 15942           ORIGINAL-CERTIFICATE,
 15943           DFHEIV11,
 15944           ELCRTO-KEY,
 15945           DFHEIV99,
 15946           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 291
* EL6311.cbl
 15947           DFHEIV99
 15948     MOVE EIBRESP  TO WS-RESPONSE
 15949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15950
 15951     IF RESP-NORMAL
 15952        AND (OC-CONTROL-PRIMARY (1:33) =
 15953                 PB-CONTROL-BY-ACCOUNT (1:33))
 15954        AND (OC-RECORD-TYPE = 'I')
 15955        display ' resp norm, key =, type i '
 15956        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15957           display ' end proc blank '
 15958           display ' csr edit session ' PI-CSR-SESSION-SW
 15959           IF NOT CSR-EDIT-SESSION
 15960
 15961* EXEC CICS READ
 15962*                DATASET   ('ELCRTO')
 15963*                INTO      (ORIGINAL-CERTIFICATE)
 15964*                RIDFLD    (OC-CONTROL-PRIMARY)
 15965*                UPDATE
 15966*                RESP      (WS-RESPONSE)
 15967*             END-EXEC
 15968     MOVE LENGTH OF
 15969      ORIGINAL-CERTIFICATE
 15970       TO DFHEIV11
 15971     MOVE 'ELCRTO' TO DFHEIV1
 15972*    MOVE '&"IL       EU         (  N#00014191' TO DFHEIV0
 15973     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15974     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15975     MOVE X'204E233030303134313931' TO DFHEIV0(25:11)
 15976     CALL 'kxdfhei1' USING DFHEIV0,
 15977           DFHEIV1,
 15978           ORIGINAL-CERTIFICATE,
 15979           DFHEIV11,
 15980           OC-CONTROL-PRIMARY,
 15981           DFHEIV99,
 15982           DFHEIV99,
 15983           DFHEIV99
 15984     MOVE EIBRESP  TO WS-RESPONSE
 15985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15986              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15987              IF RESP-NORMAL
 15988                 display ' good read upd '
 15989                 IF OC-ISSUE-TRAN-IND = 'N'
 15990                    MOVE CM-INSURED-LAST-NAME   TO
 15991                         OC-INS-LAST-NAME
 15992                    MOVE CM-INSURED-FIRST-NAME  TO
 15993                         OC-INS-FIRST-NAME
 15994                    MOVE CM-INSURED-INITIAL2    TO
 15995                         OC-INS-MIDDLE-INIT
 15996                    MOVE CM-INSURED-ISSUE-AGE   TO
 15997                         OC-INS-AGE
 15998                    MOVE CM-JT-LAST-NAME        TO
 15999                         OC-JNT-LAST-NAME
 16000                    MOVE CM-JT-FIRST-NAME       TO
 16001                         OC-JNT-FIRST-NAME
 16002                    MOVE CM-JT-INITIAL          TO
 16003                         OC-JNT-MIDDLE-INIT
 16004                    MOVE CM-INSURED-JOINT-AGE   TO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 292
* EL6311.cbl
 16005                         OC-JNT-AGE
 16006                    MOVE CM-LF-BENEFIT-CD       TO
 16007                         OC-LF-BENCD
 16008                    MOVE CM-LF-ORIG-TERM        TO
 16009                         OC-LF-TERM
 16010                    MOVE CM-LF-BENEFIT-AMT      TO
 16011                         OC-LF-BEN-AMT
 16012                    MOVE CM-LF-PREMIUM-AMT      TO
 16013                         OC-LF-PRM-AMT
 16014                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16015                         OC-LF-ALT-BEN-AMT
 16016                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16017                         OC-LF-ALT-PRM-AMT
 16018                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16019                         OC-LF-EXP-DT
 16020                    MOVE CM-LIFE-COMM-PCT       TO
 16021                         OC-LF-COMM-PCT
 16022                    MOVE CM-AH-BENEFIT-CD       TO
 16023                         OC-AH-BENCD
 16024                    MOVE CM-AH-ORIG-TERM        TO
 16025                         OC-AH-TERM
 16026                    MOVE CM-AH-BENEFIT-AMT      TO
 16027                         OC-AH-BEN-AMT
 16028                    MOVE CM-AH-PREMIUM-AMT      TO
 16029                         OC-AH-PRM-AMT
 16030                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16031                         OC-AH-EXP-DT
 16032                    MOVE CM-AH-COMM-PCT         TO
 16033                         OC-AH-COMM-PCT
 16034                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16035                         OC-AH-CP
 16036                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16037                         OC-1ST-PMT-DT
 16038                 END-IF
 16039                 MOVE PB-C-LF-CANCEL-DT      TO
 16040                         OC-LF-CANCEL-DT
 16041                 MOVE PB-C-LF-CANCEL-AMT     TO
 16042                         OC-LF-CANCEL-AMT
 16043                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16044                         OC-LF-ITD-CANCEL-AMT
 16045                 MOVE PB-C-AH-CANCEL-DT      TO
 16046                         OC-AH-CANCEL-DT
 16047                 MOVE PB-C-AH-CANCEL-AMT     TO
 16048                         OC-AH-CANCEL-AMT
 16049                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16050                         OC-AH-ITD-CANCEL-AMT
 16051                 MOVE 'Y'                    TO
 16052                         OC-CANCEL-TRAN-IND
 16053                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16054                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16055                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16056                 IF ERMAIL-FOUND
 16057                    MOVE MA-CRED-BENE-NAME
 16058                                 TO OC-CRED-BENE-NAME
 16059                 END-IF
 16060                 IF NOT CERT-TRL-REC-NOT-FOUND
 16061                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16062                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 293
* EL6311.cbl
 16063                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16064                           OC-JNT-AGE-DEFAULT-FLAG
 16065                 END-IF
 16066
 16067* EXEC CICS REWRITE
 16068*                   DATASET   ('ELCRTO')
 16069*                   FROM      (ORIGINAL-CERTIFICATE)
 16070*                   RESP      (WS-RESPONSE)
 16071*                END-EXEC
 16072     MOVE LENGTH OF
 16073      ORIGINAL-CERTIFICATE
 16074       TO DFHEIV11
 16075     MOVE 'ELCRTO' TO DFHEIV1
 16076*    MOVE '&& L                  %  N#00014278' TO DFHEIV0
 16077     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16078     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16079     MOVE X'204E233030303134323738' TO DFHEIV0(25:11)
 16080     CALL 'kxdfhei1' USING DFHEIV0,
 16081           DFHEIV1,
 16082           ORIGINAL-CERTIFICATE,
 16083           DFHEIV11,
 16084           DFHEIV99
 16085     MOVE EIBRESP  TO WS-RESPONSE
 16086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16087                 display ' just rewrote ' ws-response
 16088              END-IF
 16089           END-IF
 16090        ELSE
 16091           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16092           MOVE 'OC'             TO OC-RECORD-ID
 16093           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16094           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16095           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16096           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16097           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16098           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16099           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16100           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16101           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16102           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16103           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16104           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16105           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16106           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16107           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16108           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16109           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16110           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16111           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16112           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16113           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16114           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16115           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16116           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16117           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16118           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16119           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16120           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 294
* EL6311.cbl
 16121           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16122           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16123           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16124           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16125           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16126           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16127           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16128           IF ERMAIL-FOUND
 16129              MOVE MA-CRED-BENE-NAME
 16130                                 TO OC-CRED-BENE-NAME
 16131           END-IF
 16132           IF NOT CERT-TRL-REC-NOT-FOUND
 16133              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16134                           OC-INS-AGE-DEFAULT-FLAG
 16135              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16136                           OC-JNT-AGE-DEFAULT-FLAG
 16137           END-IF
 16138           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16139
 16140* EXEC CICS WRITE
 16141*             DATASET   ('ELCRTO')
 16142*             FROM      (ORIGINAL-CERTIFICATE)
 16143*             RIDFLD    (OC-CONTROL-PRIMARY)
 16144*             RESP      (WS-RESPONSE)
 16145*          END-EXEC
 16146     MOVE LENGTH OF
 16147      ORIGINAL-CERTIFICATE
 16148       TO DFHEIV11
 16149     MOVE 'ELCRTO' TO DFHEIV1
 16150*    MOVE '&$ L                  ''  N#00014335' TO DFHEIV0
 16151     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16152     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16153     MOVE X'204E233030303134333335' TO DFHEIV0(25:11)
 16154     CALL 'kxdfhei1' USING DFHEIV0,
 16155           DFHEIV1,
 16156           ORIGINAL-CERTIFICATE,
 16157           DFHEIV11,
 16158           OC-CONTROL-PRIMARY,
 16159           DFHEIV99,
 16160           DFHEIV99
 16161     MOVE EIBRESP  TO WS-RESPONSE
 16162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16163        END-IF
 16164     ELSE
 16165        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16166        MOVE 'OC'                TO OC-RECORD-ID
 16167        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16168                                 TO OC-CONTROL-PRIMARY (1:33)
 16169        MOVE 'I'                 TO OC-RECORD-TYPE
 16170        MOVE +4096               TO OC-KEY-SEQ-NO
 16171        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16172        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16173        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16174        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16175        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16176        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16177        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16178        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 295
* EL6311.cbl
 16179        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16180        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16181        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16182        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16183        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16184        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16185        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16186        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16187        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16188        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16189        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16190        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16191        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16192        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16193        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16194        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16195        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16196        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16197        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16198        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16199        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16200        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16201        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16202        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16203        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16204        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16205        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16206        IF ERMAIL-FOUND
 16207           MOVE MA-CRED-BENE-NAME
 16208                                 TO OC-CRED-BENE-NAME
 16209        END-IF
 16210        IF NOT CERT-TRL-REC-NOT-FOUND
 16211           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16212                           OC-INS-AGE-DEFAULT-FLAG
 16213           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16214                           OC-JNT-AGE-DEFAULT-FLAG
 16215        END-IF
 16216        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16217
 16218
 16219* EXEC CICS WRITE
 16220*          DATASET   ('ELCRTO')
 16221*          FROM      (ORIGINAL-CERTIFICATE)
 16222*          RIDFLD    (OC-CONTROL-PRIMARY)
 16223*          RESP      (WS-RESPONSE)
 16224*       END-EXEC
 16225     MOVE LENGTH OF
 16226      ORIGINAL-CERTIFICATE
 16227       TO DFHEIV11
 16228     MOVE 'ELCRTO' TO DFHEIV1
 16229*    MOVE '&$ L                  ''  N#00014396' TO DFHEIV0
 16230     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16231     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16232     MOVE X'204E233030303134333936' TO DFHEIV0(25:11)
 16233     CALL 'kxdfhei1' USING DFHEIV0,
 16234           DFHEIV1,
 16235           ORIGINAL-CERTIFICATE,
 16236           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 296
* EL6311.cbl
 16237           OC-CONTROL-PRIMARY,
 16238           DFHEIV99,
 16239           DFHEIV99
 16240     MOVE EIBRESP  TO WS-RESPONSE
 16241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16242     END-IF.
 16243
 16244 2376-BYPASS-CRTO.
 16245******************************************************************
 16246*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16247******************************************************************
 16248
 16249
 16250* EXEC CICS HANDLE CONDITION
 16251*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16252*    END-EXEC.
 16253*    MOVE '"$I                   ! 7 #00014409' TO DFHEIV0
 16254     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16255     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16256     MOVE X'3720233030303134343039' TO DFHEIV0(25:11)
 16257     CALL 'kxdfhei1' USING DFHEIV0
 16258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16259
 16260
 16261
 16262* EXEC CICS READ
 16263*        INTO    (PENDING-BUSINESS)
 16264*        DATASET (FILE-ID-ERPNDB)
 16265*        RIDFLD  (ERPNDB-KEY)
 16266*        UPDATE
 16267*    END-EXEC.
 16268     MOVE LENGTH OF
 16269      PENDING-BUSINESS
 16270       TO DFHEIV11
 16271*    MOVE '&"IL       EU         (   #00014413' TO DFHEIV0
 16272     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16273     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16274     MOVE X'2020233030303134343133' TO DFHEIV0(25:11)
 16275     CALL 'kxdfhei1' USING DFHEIV0,
 16276           FILE-ID-ERPNDB,
 16277           PENDING-BUSINESS,
 16278           DFHEIV11,
 16279           ERPNDB-KEY,
 16280           DFHEIV99,
 16281           DFHEIV99,
 16282           DFHEIV99
 16283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16284
 16285
 16286     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16287     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16288     MOVE 'B'                    TO JP-RECORD-TYPE.
 16289     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16290
 16291     PERFORM 8400-LOG-JOURNAL-RECORD.
 16292
 16293     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16294
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 297
* EL6311.cbl
 16295
 16296* EXEC CICS REWRITE
 16297*        DATASET (FILE-ID-ERPNDB)
 16298*        FROM    (PENDING-BUSINESS)
 16299*    END-EXEC.
 16300     MOVE LENGTH OF
 16301      PENDING-BUSINESS
 16302       TO DFHEIV11
 16303*    MOVE '&& L                  %   #00014429' TO DFHEIV0
 16304     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16305     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16306     MOVE X'2020233030303134343239' TO DFHEIV0(25:11)
 16307     CALL 'kxdfhei1' USING DFHEIV0,
 16308           FILE-ID-ERPNDB,
 16309           PENDING-BUSINESS,
 16310           DFHEIV11,
 16311           DFHEIV99
 16312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16313
 16314
 16315     MOVE 'C'                    TO JP-RECORD-TYPE.
 16316     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16317
 16318     PERFORM 8400-LOG-JOURNAL-RECORD.
 16319
 16320     IF WS-ERRORS-PRESENT
 16321         GO TO 3900-RE-DISPLAY-RECORD.
 16322
 16323     MOVE ZEROS                  TO EMI-ERROR
 16324     MOVE -1                     TO CMAINTL
 16325     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16326     GO TO 3900-RE-DISPLAY-RECORD.
 16327
 16328 2380-BATCH-HDR-NOT-FOUND.
 16329     MOVE -1                     TO BMAINTL.
 16330     MOVE ER-7450                TO EMI-ERROR.
 16331     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16332     GO TO 8200-SEND-DATAONLY.
 16333
 16334 2385-REC-NOT-FOUND.
 16335     MOVE -1                     TO BMAINTL.
 16336     MOVE ER-7451                TO EMI-ERROR.
 16337     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16338     GO TO 8200-SEND-DATAONLY.
 16339
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 298
* EL6311.cbl
 16341
 16342******************************************************************
 16343*                                                                *
 16344*          D E L E T E   C A N C E L   R O U T I N E             *
 16345*                                                                *
 16346******************************************************************
 16347
 16348 2400-DELETE-CANCEL-ROUTINE.
 16349     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16350
 16351     IF CCHGL NOT = ZEROS
 16352        MOVE ER-2196             TO EMI-ERROR
 16353        MOVE AL-UABON            TO CMAINTA
 16354        MOVE -1                  TO CMAINTL
 16355        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16356        GO TO 8200-SEND-DATAONLY.
 16357
 16358
 16359* EXEC CICS HANDLE CONDITION
 16360*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16361*    END-EXEC.
 16362*    MOVE '"$I                   ! 8 #00014477' TO DFHEIV0
 16363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16365     MOVE X'3820233030303134343737' TO DFHEIV0(25:11)
 16366     CALL 'kxdfhei1' USING DFHEIV0
 16367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16368
 16369
 16370     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16371     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16372     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16373
 16374
 16375* EXEC CICS READ
 16376*        SET     (ADDRESS OF PENDING-BUSINESS)
 16377*        DATASET (FILE-ID-ERPNDB)
 16378*        RIDFLD  (ERPNDB-KEY)
 16379*    END-EXEC.
 16380*    MOVE '&"S        E          (   #00014485' TO DFHEIV0
 16381     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16382     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16383     MOVE X'2020233030303134343835' TO DFHEIV0(25:11)
 16384     CALL 'kxdfhei1' USING DFHEIV0,
 16385           FILE-ID-ERPNDB,
 16386           DFHEIV20,
 16387           DFHEIV99,
 16388           ERPNDB-KEY,
 16389           DFHEIV99,
 16390           DFHEIV99,
 16391           DFHEIV99
 16392     SET ADDRESS OF PENDING-BUSINESS TO
 16393         DFHEIV20
 16394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16395
 16396
 16397     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16398
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 299
* EL6311.cbl
 16399     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16400
 16401     IF CSUFIXL NOT = ZEROS
 16402        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16403     ELSE
 16404        MOVE SPACE               TO WS-NEW-SUFFIX.
 16405
 16406     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16407
 16408     PERFORM 8600-DEEDIT.
 16409     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16410     MOVE '4'                    TO DC-OPTION-CODE.
 16411     PERFORM 9700-DATE-LINK.
 16412
 16413     IF DATE-CONVERSION-ERROR
 16414        MOVE ER-0348             TO EMI-ERROR
 16415        MOVE -1                  TO CEFFDTL
 16416        MOVE AL-UABON            TO CEFFDTA
 16417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16418        GO TO 8200-SEND-DATAONLY
 16419     ELSE
 16420        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16421        MOVE AL-UANON            TO CEFFDTA
 16422        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16423
 16424
 16425* EXEC CICS HANDLE CONDITION
 16426*         NOTFND    (2490-RECORD-NOT-FOUND)
 16427*    END-EXEC.
 16428*    MOVE '"$I                   ! 9 #00014518' TO DFHEIV0
 16429     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16431     MOVE X'3920233030303134353138' TO DFHEIV0(25:11)
 16432     CALL 'kxdfhei1' USING DFHEIV0
 16433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16434
 16435
 16436
 16437* EXEC CICS READ
 16438*        SET     (ADDRESS OF PENDING-BUSINESS)
 16439*        DATASET (FILE-ID-ERPNDB)
 16440*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16441*        UPDATE
 16442*    END-EXEC.
 16443*    MOVE '&"S        EU         (   #00014522' TO DFHEIV0
 16444     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16445     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16446     MOVE X'2020233030303134353232' TO DFHEIV0(25:11)
 16447     CALL 'kxdfhei1' USING DFHEIV0,
 16448           FILE-ID-ERPNDB,
 16449           DFHEIV20,
 16450           DFHEIV99,
 16451           PI-PREV-CONTROL-PRIMARY,
 16452           DFHEIV99,
 16453           DFHEIV99,
 16454           DFHEIV99
 16455     SET ADDRESS OF PENDING-BUSINESS TO
 16456         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 300
* EL6311.cbl
 16457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16458
 16459
 16460     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16461        MOVE -1                 TO CMAINTL
 16462        MOVE ER-2197            TO EMI-ERROR
 16463        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16464        GO TO 8200-SEND-DATAONLY.
 16465
 16466     IF PB-BILLED-DT NOT = LOW-VALUES
 16467        MOVE -1                 TO CMAINTL
 16468        MOVE ER-2129            TO EMI-ERROR
 16469        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16470        GO TO 8200-SEND-DATAONLY.
 16471
 16472     IF PB-CHG-COUNT NOT = ZEROS
 16473        MOVE ER-2336            TO EMI-ERROR
 16474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16475        MOVE AL-UABON            TO CMAINTA
 16476        MOVE -1                  TO CMAINTL
 16477        GO TO 8200-SEND-DATAONLY.
 16478
 16479     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16480        PB-CHG-COUNT NOT = ZEROS
 16481        MOVE ER-2196             TO EMI-ERROR
 16482        MOVE AL-UABON            TO CMAINTA
 16483        MOVE -1                  TO CMAINTL
 16484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16485        GO TO 8200-SEND-DATAONLY.
 16486
 16487     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16488        MOVE ER-2900 TO EMI-ERROR
 16489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16490        MOVE AL-UABON         TO CMAINTA
 16491        MOVE -1               TO CMAINTL
 16492        GO TO 8200-SEND-DATAONLY.
 16493     move ' '                    to ws-stop-sw
 16494                                    ws-check-sw
 16495                                    ws-any-check-sw
 16496                                    ws-proc-check-sw
 16497                                    ws-chek-browse-sw
 16498
 16499     perform 2500-browse-checks  thru 2500-exit
 16500     if (i-have-processed-checks)
 16501        and (pb-c-refund-sw = 'Y')
 16502        move er-3446             to emi-error
 16503        perform 9900-error-format thru 9900-exit
 16504        move al-uabon            to cmainta
 16505        move -1                  to cmaintl
 16506        go to 8200-send-dataonly
 16507     end-if
 16508
 16509* EXEC CICS HANDLE CONDITION
 16510*         NOTFND  (2475-CONTINUE-DELETE)
 16511*    END-EXEC
 16512*    MOVE '"$I                   ! : #00014577' TO DFHEIV0
 16513     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 301
* EL6311.cbl
 16515     MOVE X'3A20233030303134353737' TO DFHEIV0(25:11)
 16516     CALL 'kxdfhei1' USING DFHEIV0
 16517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16518
 16519     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16520     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16521     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16522     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16523
 16524
 16525* EXEC CICS READ
 16526*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16527*        DATASET (FILE-ID-ELCERT)
 16528*        RIDFLD  (ELCERT-KEY)
 16529*        UPDATE
 16530*    END-EXEC.
 16531*    MOVE '&"S        EU         (   #00014586' TO DFHEIV0
 16532     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16533     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16534     MOVE X'2020233030303134353836' TO DFHEIV0(25:11)
 16535     CALL 'kxdfhei1' USING DFHEIV0,
 16536           FILE-ID-ELCERT,
 16537           DFHEIV20,
 16538           DFHEIV99,
 16539           ELCERT-KEY,
 16540           DFHEIV99,
 16541           DFHEIV99,
 16542           DFHEIV99
 16543     SET ADDRESS OF CERTIFICATE-MASTER TO
 16544         DFHEIV20
 16545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16546
 16547
 16548     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16549
 16550     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16551     MOVE 'B'                    TO JP-RECORD-TYPE.
 16552     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16553     PERFORM 8400-LOG-JOURNAL-RECORD.
 16554
 16555     IF PB-CI-LIVES NOT NUMERIC
 16556         MOVE ZERO                    TO PB-CI-LIVES.
 16557
 16558     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16559        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16560           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16561           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16562           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16563                                            CM-LF-CANCEL-DT
 16564           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16565        ELSE
 16566           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16567           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16568           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16569           MOVE PB-CI-LIVES              TO CM-LIVES.
 16570
 16571     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16572        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 302
* EL6311.cbl
 16573           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16574               MOVE CM-LF-STATUS-AT-CANCEL
 16575                                        TO CM-LF-CURRENT-STATUS
 16576               MOVE SPACE
 16577                                        TO CM-LF-STATUS-AT-CANCEL
 16578           ELSE
 16579               MOVE PB-CI-LF-POLICY-STATUS
 16580                                        TO CM-LF-CURRENT-STATUS
 16581        ELSE
 16582           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16583
 16584
 16585     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16586        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16587           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16588           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16589           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16590                                            CM-AH-CANCEL-DT
 16591           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16592        ELSE
 16593           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16594           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16595           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16596           MOVE PB-CI-LIVES              TO CM-LIVES.
 16597
 16598     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16599        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16600           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16601               MOVE CM-AH-STATUS-AT-CANCEL
 16602                                        TO CM-AH-CURRENT-STATUS
 16603               MOVE SPACE
 16604                                        TO CM-AH-STATUS-AT-CANCEL
 16605           ELSE
 16606               MOVE PB-CI-AH-POLICY-STATUS
 16607                                        TO CM-AH-CURRENT-STATUS
 16608        ELSE
 16609           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16610
 16611 2450-REWRITE-CERT.
 16612     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16613     MOVE 'C'                      TO JP-RECORD-TYPE.
 16614     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16615
 16616
 16617* EXEC CICS REWRITE
 16618*        DATASET  (FILE-ID-ELCERT)
 16619*        FROM     (CERTIFICATE-MASTER)
 16620*    END-EXEC.
 16621     MOVE LENGTH OF
 16622      CERTIFICATE-MASTER
 16623       TO DFHEIV11
 16624*    MOVE '&& L                  %   #00014661' TO DFHEIV0
 16625     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16626     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16627     MOVE X'2020233030303134363631' TO DFHEIV0(25:11)
 16628     CALL 'kxdfhei1' USING DFHEIV0,
 16629           FILE-ID-ELCERT,
 16630           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 303
* EL6311.cbl
 16631           DFHEIV11,
 16632           DFHEIV99
 16633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16634
 16635
 16636     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16637
 16638     PERFORM 8400-LOG-JOURNAL-RECORD.
 16639
 16640     move ' '                    to ws-stop-sw
 16641                                    ws-any-check-sw
 16642                                    ws-proc-check-sw
 16643                                    ws-chek-browse-sw
 16644
 16645     if i-have-checks
 16646        perform until i-say-stop
 16647           perform 2510-startbr-erchek
 16648                                 thru 2510-exit
 16649           if resp-normal
 16650              perform 2520-readnext-erchek
 16651                                 thru 2520-exit
 16652           end-if
 16653           if (not resp-normal)
 16654              or (pb-control-by-account (1:33) not =
 16655                 ch-control-primary (1:33))
 16656                 set i-say-stop to true
 16657           else
 16658              perform 2530-readupd-erchek
 16659                                 thru 2530-exit
 16660              if resp-normal
 16661                 perform 2540-delete-erchek
 16662                                 thru 2540-exit
 16663              end-if
 16664              if ws-chek-browse-sw = 'Y'
 16665                 perform 2525-endbr-erchek
 16666                                 thru 2525-exit
 16667                 move ' '        to ws-chek-browse-sw
 16668              end-if
 16669           end-if
 16670        end-perform
 16671     end-if
 16672
 16673     if ws-chek-browse-sw = 'Y'
 16674        perform 2525-endbr-erchek thru 2525-exit
 16675     end-if
 16676     .
 16677 2475-CONTINUE-DELETE.
 16678     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16679     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16680
 16681     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16682     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16683
 16684     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16685
 16686     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16687     MOVE 'D'                    TO JP-RECORD-TYPE
 16688     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 304
* EL6311.cbl
 16689
 16690
 16691* EXEC CICS DELETE
 16692*        DATASET    (FILE-ID-ERPNDB)
 16693*    END-EXEC.
 16694*    MOVE '&(                    &   #00014720' TO DFHEIV0
 16695     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16696     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16697     MOVE X'2020233030303134373230' TO DFHEIV0(25:11)
 16698     CALL 'kxdfhei1' USING DFHEIV0,
 16699           FILE-ID-ERPNDB,
 16700           DFHEIV99,
 16701           DFHEIV99,
 16702           DFHEIV99,
 16703           DFHEIV99
 16704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16705
 16706
 16707     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16708
 16709     PERFORM 8400-LOG-JOURNAL-RECORD.
 16710
 16711     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16712     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16713
 16714
 16715* EXEC CICS HANDLE CONDITION
 16716*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16717*    END-EXEC.
 16718*    MOVE '"$I                   ! ; #00014731' TO DFHEIV0
 16719     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16721     MOVE X'3B20233030303134373331' TO DFHEIV0(25:11)
 16722     CALL 'kxdfhei1' USING DFHEIV0
 16723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16724
 16725
 16726
 16727* EXEC CICS READ
 16728*        SET     (ADDRESS OF PENDING-BUSINESS)
 16729*        DATASET (FILE-ID-ERPNDB)
 16730*        RIDFLD  (ERPNDB-KEY)
 16731*        UPDATE
 16732*    END-EXEC.
 16733*    MOVE '&"S        EU         (   #00014735' TO DFHEIV0
 16734     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16735     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16736     MOVE X'2020233030303134373335' TO DFHEIV0(25:11)
 16737     CALL 'kxdfhei1' USING DFHEIV0,
 16738           FILE-ID-ERPNDB,
 16739           DFHEIV20,
 16740           DFHEIV99,
 16741           ERPNDB-KEY,
 16742           DFHEIV99,
 16743           DFHEIV99,
 16744           DFHEIV99
 16745     SET ADDRESS OF PENDING-BUSINESS TO
 16746         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 305
* EL6311.cbl
 16747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16748
 16749
 16750     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16751     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16752
 16753     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16754        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16755        MOVE 'D'                 TO JP-RECORD-TYPE
 16756        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16757
 16758* EXEC CICS DELETE
 16759*            DATASET    (FILE-ID-ERPNDB)
 16760*       END-EXEC
 16761*    MOVE '&(                    &   #00014749' TO DFHEIV0
 16762     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16763     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16764     MOVE X'2020233030303134373439' TO DFHEIV0(25:11)
 16765     CALL 'kxdfhei1' USING DFHEIV0,
 16766           FILE-ID-ERPNDB,
 16767           DFHEIV99,
 16768           DFHEIV99,
 16769           DFHEIV99,
 16770           DFHEIV99
 16771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16772        PERFORM 8400-LOG-JOURNAL-RECORD
 16773     ELSE
 16774        MOVE 'B'                 TO JP-RECORD-TYPE
 16775        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16776        PERFORM 8400-LOG-JOURNAL-RECORD
 16777        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16778        MOVE 'C'                 TO JP-RECORD-TYPE
 16779        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16780
 16781* EXEC CICS REWRITE
 16782*            DATASET    (FILE-ID-ERPNDB)
 16783*            FROM       (PENDING-BUSINESS)
 16784*       END-EXEC
 16785     MOVE LENGTH OF
 16786      PENDING-BUSINESS
 16787       TO DFHEIV11
 16788*    MOVE '&& L                  %   #00014760' TO DFHEIV0
 16789     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16790     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16791     MOVE X'2020233030303134373630' TO DFHEIV0(25:11)
 16792     CALL 'kxdfhei1' USING DFHEIV0,
 16793           FILE-ID-ERPNDB,
 16794           PENDING-BUSINESS,
 16795           DFHEIV11,
 16796           DFHEIV99
 16797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16798        PERFORM 8400-LOG-JOURNAL-RECORD.
 16799
 16800******************************************************************
 16801*                                                                *
 16802*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16803*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16804*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 306
* EL6311.cbl
 16805******************************************************************
 16806
 16807     IF NOT PI-AR-PROCESSING
 16808        GO TO 2480-DELETE-FINISHED.
 16809
 16810     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16811        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16812        NEXT SENTENCE
 16813     ELSE
 16814        GO TO 2480-DELETE-FINISHED.
 16815
 16816
 16817* EXEC CICS HANDLE CONDITION
 16818*         NOTFND    (2480-DELETE-FINISHED)
 16819*    END-EXEC.
 16820*    MOVE '"$I                   ! < #00014782' TO DFHEIV0
 16821     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16822     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16823     MOVE X'3C20233030303134373832' TO DFHEIV0(25:11)
 16824     CALL 'kxdfhei1' USING DFHEIV0
 16825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16826
 16827
 16828     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16829     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16830
 16831
 16832* EXEC CICS READ
 16833*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16834*        DATASET (FILE-ID-ERRQST)
 16835*        RIDFLD  (ERRQST-KEY)
 16836*        UPDATE
 16837*    END-EXEC.
 16838*    MOVE '&"S        EU         (   #00014789' TO DFHEIV0
 16839     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16840     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16841     MOVE X'2020233030303134373839' TO DFHEIV0(25:11)
 16842     CALL 'kxdfhei1' USING DFHEIV0,
 16843           FILE-ID-ERRQST,
 16844           DFHEIV20,
 16845           DFHEIV99,
 16846           ERRQST-KEY,
 16847           DFHEIV99,
 16848           DFHEIV99,
 16849           DFHEIV99
 16850     SET ADDRESS OF AR-REQUEST-RECORD TO
 16851         DFHEIV20
 16852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16853
 16854
 16855     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16856
 16857     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16858
 16859     MOVE 'D'                      TO JP-RECORD-TYPE.
 16860     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16861
 16862
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 307
* EL6311.cbl
 16863* EXEC CICS DELETE
 16864*         DATASET    (FILE-ID-ERRQST)
 16865*    END-EXEC.
 16866*    MOVE '&(                    &   #00014803' TO DFHEIV0
 16867     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16869     MOVE X'2020233030303134383033' TO DFHEIV0(25:11)
 16870     CALL 'kxdfhei1' USING DFHEIV0,
 16871           FILE-ID-ERRQST,
 16872           DFHEIV99,
 16873           DFHEIV99,
 16874           DFHEIV99,
 16875           DFHEIV99
 16876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16877
 16878
 16879     PERFORM 8400-LOG-JOURNAL-RECORD.
 16880
 16881 2480-DELETE-FINISHED.
 16882     MOVE ZEROS                  TO EMI-ERROR.
 16883     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16884     MOVE LOW-VALUES             TO EL631CI.
 16885     MOVE -1                     TO CMAINTL.
 16886     GO TO 8100-SEND-INITIAL-MAP.
 16887
 16888 2485-BATCH-HDR-NOT-FOUND.
 16889     MOVE -1                     TO CMAINTL
 16890     MOVE AL-UABON               TO CMAINTA.
 16891     MOVE ER-7450                TO EMI-ERROR.
 16892     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16893     GO TO 8200-SEND-DATAONLY.
 16894
 16895 2490-RECORD-NOT-FOUND.
 16896     MOVE -1                     TO CMAINTL
 16897     MOVE AL-UABON               TO CMAINTA.
 16898     MOVE ER-7451                TO EMI-ERROR.
 16899     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16900     GO TO 8200-SEND-DATAONLY.
 16901***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16902***                                                            ***
 16903***     2500  B R O W S E   C H E C K S                        ***
 16904***  We perform this routine from 2 different places.          ***
 16905***  1. If the user changes the refund amount on a cancel, we  ***
 16906***    want to.........                                        ***
 16907***    a. determine if prior checks have been processed        ***
 16908***    b. If the amt is larger, display message instructing    ***
 16909***     them to create another check to make up the difference.***
 16910***    c. If the amt is less, do not allow the change and      ***
 16911***     display a FATAL error suggesting they deal with check  ***
 16912***     records befor continuing.                              ***
 16913***  2. If the user wants to delete a cancel record we......   ***
 16914***    a. browse through all the checks and if there is a      ***
 16915***     processed check, send FATAL message.                   ***
 16916***    b. If there is a non-released check, then delete that   ***
 16917***     check after you delete the pending cancel record.      ***
 16918***                                                            ***
 16919***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16920
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 308
* EL6311.cbl
 16921 2500-browse-checks.
 16922
 16923     perform 2510-startbr-erchek thru 2510-exit
 16924
 16925     if not resp-normal
 16926        go to 2500-exit
 16927     end-if
 16928
 16929     perform until i-say-stop
 16930        perform 2520-readnext-erchek
 16931                                 thru 2520-exit
 16932        if (not resp-normal)
 16933           or (pb-control-by-account (1:33) not =
 16934              ch-control-primary (1:33))
 16935              set i-say-stop to true
 16936        else
 16937           set i-have-a-check-period to true
 16938           if (ch-approval-status) = ' '
 16939              and (ch-void-dt = low-values)
 16940              and (ch-released-dt = low-values)
 16941              set i-have-checks to true
 16942           else
 16943              if ch-void-dt = low-values
 16944                 set i-have-processed-checks to true
 16945              end-if
 16946           end-if
 16947           if (ch-credit-accept-dt = low-values)
 16948              and (ch-void-dt = low-values)
 16949              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16950              if (ch-check-origin-sw not = 'R')
 16951                 and (pb-record-type = '2')
 16952                 continue
 16953              else
 16954                 compute ws-check-amts =
 16955                    ws-check-amts + ch-amount-paid
 16956              end-if
 16957           end-if
 16958        end-if
 16959     end-perform
 16960
 16961     if ws-chek-browse-sw = 'Y'
 16962        perform 2525-endbr-erchek thru 2525-exit
 16963     end-if
 16964
 16965    .
 16966 2500-exit.
 16967     exit.
 16968
 16969 2510-startbr-erchek.
 16970
 16971     move pb-control-by-account  to erchek-key
 16972     move +0                     to chek-record-seq
 16973
 16974
 16975* exec cics startbr
 16976*       dataset   ('ERCHEK')
 16977*       ridfld    (erchek-key)
 16978*       gteq
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 309
* EL6311.cbl
 16979*       resp      (ws-response)
 16980*    end-exec
 16981     MOVE 'ERCHEK' TO DFHEIV1
 16982     MOVE 0
 16983       TO DFHEIV11
 16984*    MOVE '&,         G          &  N#00014902' TO DFHEIV0
 16985     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16986     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16987     MOVE X'204E233030303134393032' TO DFHEIV0(25:11)
 16988     CALL 'kxdfhei1' USING DFHEIV0,
 16989           DFHEIV1,
 16990           erchek-key,
 16991           DFHEIV99,
 16992           DFHEIV11,
 16993           DFHEIV99
 16994     MOVE EIBRESP  TO ws-response
 16995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16996
 16997     IF RESP-NORMAL
 16998        move 'Y'                 to ws-chek-browse-sw
 16999     end-if
 17000
 17001     .
 17002 2510-exit.
 17003     exit.
 17004
 17005 2520-readnext-erchek.
 17006
 17007
 17008* EXEC CICS READNEXT
 17009*       SET     (ADDRESS OF CHECK-RECORDS)
 17010*       DATASET ('ERCHEK')
 17011*       RIDFLD  (ERCHEK-KEY)
 17012*       RESP    (WS-RESPONSE)
 17013*    END-EXEC
 17014     MOVE 'ERCHEK' TO DFHEIV1
 17015     MOVE 0
 17016       TO DFHEIV11
 17017*    MOVE '&.S                   )  N#00014919' TO DFHEIV0
 17018     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17019     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17020     MOVE X'204E233030303134393139' TO DFHEIV0(25:11)
 17021     CALL 'kxdfhei1' USING DFHEIV0,
 17022           DFHEIV1,
 17023           DFHEIV20,
 17024           DFHEIV99,
 17025           ERCHEK-KEY,
 17026           DFHEIV99,
 17027           DFHEIV11,
 17028           DFHEIV99,
 17029           DFHEIV99
 17030     SET ADDRESS OF CHECK-RECORDS TO
 17031         DFHEIV20
 17032     MOVE EIBRESP  TO WS-RESPONSE
 17033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17034
 17035     .
 17036 2520-exit.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 310
* EL6311.cbl
 17037     exit.
 17038
 17039 2525-endbr-erchek.
 17040
 17041
 17042* exec cics endbr
 17043*       dataset  ('ERCHEK')
 17044*    end-exec
 17045     MOVE 'ERCHEK' TO DFHEIV1
 17046     MOVE 0
 17047       TO DFHEIV11
 17048*    MOVE '&2                    $   #00014932' TO DFHEIV0
 17049     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17050     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17051     MOVE X'2020233030303134393332' TO DFHEIV0(25:11)
 17052     CALL 'kxdfhei1' USING DFHEIV0,
 17053           DFHEIV1,
 17054           DFHEIV11,
 17055           DFHEIV99
 17056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17057
 17058     .
 17059 2525-exit.
 17060     exit.
 17061
 17062 2530-readupd-erchek.
 17063
 17064
 17065* EXEC CICS READ
 17066*       UPDATE
 17067*       SET     (ADDRESS OF CHECK-RECORDS)
 17068*       DATASET ('ERCHEK')
 17069*       RIDFLD  (ERCHEK-KEY)
 17070*       RESP    (WS-RESPONSE)
 17071*    END-EXEC
 17072     MOVE 'ERCHEK' TO DFHEIV1
 17073*    MOVE '&"S        EU         (  N#00014942' TO DFHEIV0
 17074     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17075     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17076     MOVE X'204E233030303134393432' TO DFHEIV0(25:11)
 17077     CALL 'kxdfhei1' USING DFHEIV0,
 17078           DFHEIV1,
 17079           DFHEIV20,
 17080           DFHEIV99,
 17081           ERCHEK-KEY,
 17082           DFHEIV99,
 17083           DFHEIV99,
 17084           DFHEIV99
 17085     SET ADDRESS OF CHECK-RECORDS TO
 17086         DFHEIV20
 17087     MOVE EIBRESP  TO WS-RESPONSE
 17088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17089
 17090     .
 17091 2530-exit.
 17092     exit.
 17093
 17094 2540-delete-erchek.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 311
* EL6311.cbl
 17095
 17096
 17097* EXEC CICS DELETE
 17098*       DATASET ('ERCHEK')
 17099*       RESP    (WS-RESPONSE)
 17100*    END-EXEC
 17101     MOVE 'ERCHEK' TO DFHEIV1
 17102*    MOVE '&(                    &  N#00014956' TO DFHEIV0
 17103     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17104     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17105     MOVE X'204E233030303134393536' TO DFHEIV0(25:11)
 17106     CALL 'kxdfhei1' USING DFHEIV0,
 17107           DFHEIV1,
 17108           DFHEIV99,
 17109           DFHEIV99,
 17110           DFHEIV99,
 17111           DFHEIV99
 17112     MOVE EIBRESP  TO WS-RESPONSE
 17113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17114
 17115     .
 17116 2540-exit.
 17117     exit.
 17118***************************************************************
 17119*                                                             *
 17120*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17121*                                                             *
 17122***************************************************************
 17123
 17124***************************************************************
 17125*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17126*     AN ALREADY BILLED RECORD.                               *
 17127***************************************************************
 17128
 17129 2700-BUILD-CORRECTION-RECORD.
 17130     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17131     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17132     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17133     MOVE '5'                    TO DC-OPTION-CODE.
 17134     PERFORM 9700-DATE-LINK.
 17135     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17136
 17137     IF PB-CHG-COUNT = ZEROS
 17138        MOVE +1                  TO WS-SEQ-SAVE
 17139     ELSE
 17140        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17141
 17142     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17143     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17144
 17145     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17146
 17147     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17148     MOVE 'A'                    TO JP-RECORD-TYPE.
 17149     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17150
 17151
 17152* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 312
* EL6311.cbl
 17153*        DATASET    (FILE-ID-ERPNDB)
 17154*        FROM       (PENDING-BUSINESS)
 17155*        RIDFLD     (PB-CONTROL-PRIMARY)
 17156*    END-EXEC.
 17157     MOVE LENGTH OF
 17158      PENDING-BUSINESS
 17159       TO DFHEIV11
 17160*    MOVE '&$ L                  ''   #00014997' TO DFHEIV0
 17161     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17162     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17163     MOVE X'2020233030303134393937' TO DFHEIV0(25:11)
 17164     CALL 'kxdfhei1' USING DFHEIV0,
 17165           FILE-ID-ERPNDB,
 17166           PENDING-BUSINESS,
 17167           DFHEIV11,
 17168           PB-CONTROL-PRIMARY,
 17169           DFHEIV99,
 17170           DFHEIV99
 17171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17172
 17173
 17174     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17175
 17176     PERFORM 8400-LOG-JOURNAL-RECORD.
 17177
 17178 2799-EXIT.
 17179      EXIT.
 17180
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 313
* EL6311.cbl
 17182
 17183******************************************************************
 17184*                                                                *
 17185*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17186*                                                                *
 17187******************************************************************
 17188
 17189 2800-REWRITE-ISSUE-CERT-KEY.
 17190     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17191
 17192     IF  BCERTNOL GREATER THAN ZEROS
 17193         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17194
 17195     IF  BSUFIXL  GREATER THAN ZEROS
 17196         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17197
 17198     IF  BEFFDTL  GREATER THAN ZEROS
 17199         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17200
 17201 2810-READ-BY-ACCOUNT.
 17202
 17203* EXEC CICS HANDLE CONDITION
 17204*         NOTFND    (2820-PROCESS-REWRITE)
 17205*    END-EXEC.
 17206*    MOVE '"$I                   ! = #00015031' TO DFHEIV0
 17207     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17209     MOVE X'3D20233030303135303331' TO DFHEIV0(25:11)
 17210     CALL 'kxdfhei1' USING DFHEIV0
 17211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17212
 17213
 17214***  read pndb using new key
 17215
 17216* EXEC CICS READ
 17217*        SET     (ADDRESS OF PENDING-BUSINESS)
 17218*        DATASET (FILE-ID-ERPNDB2)
 17219*        RIDFLD  (ERPNDB-ALT-KEY)
 17220*    END-EXEC.
 17221*    MOVE '&"S        E          (   #00015036' TO DFHEIV0
 17222     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17224     MOVE X'2020233030303135303336' TO DFHEIV0(25:11)
 17225     CALL 'kxdfhei1' USING DFHEIV0,
 17226           FILE-ID-ERPNDB2,
 17227           DFHEIV20,
 17228           DFHEIV99,
 17229           ERPNDB-ALT-KEY,
 17230           DFHEIV99,
 17231           DFHEIV99,
 17232           DFHEIV99
 17233     SET ADDRESS OF PENDING-BUSINESS TO
 17234         DFHEIV20
 17235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17236
 17237
 17238     GO TO 2890-DUPLICATE-RECORD.
 17239
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 314
* EL6311.cbl
 17240  2820-PROCESS-REWRITE.
 17241
 17242* EXEC CICS HANDLE CONDITION
 17243*         NOTFND    (2885-RECORD-MISSING)
 17244*    END-EXEC.
 17245*    MOVE '"$I                   ! > #00015045' TO DFHEIV0
 17246     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17248     MOVE X'3E20233030303135303435' TO DFHEIV0(25:11)
 17249     CALL 'kxdfhei1' USING DFHEIV0
 17250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17251
 17252
 17253     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17254
 17255***  read pndb using original key
 17256
 17257* EXEC CICS READ
 17258*        SET     (ADDRESS OF PENDING-BUSINESS)
 17259*        DATASET (FILE-ID-ERPNDB)
 17260*        RIDFLD  (ERPNDB-KEY)
 17261*        UPDATE
 17262*    END-EXEC.
 17263*    MOVE '&"S        EU         (   #00015052' TO DFHEIV0
 17264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17265     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17266     MOVE X'2020233030303135303532' TO DFHEIV0(25:11)
 17267     CALL 'kxdfhei1' USING DFHEIV0,
 17268           FILE-ID-ERPNDB,
 17269           DFHEIV20,
 17270           DFHEIV99,
 17271           ERPNDB-KEY,
 17272           DFHEIV99,
 17273           DFHEIV99,
 17274           DFHEIV99
 17275     SET ADDRESS OF PENDING-BUSINESS TO
 17276         DFHEIV20
 17277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17278
 17279
 17280     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17281     MOVE 'D'                    TO JP-RECORD-TYPE.
 17282     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17283     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17284
 17285     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17286
 17287     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17288     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17289     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17290
 17291***  delete pndb using original key
 17292
 17293* EXEC CICS DELETE
 17294*        DATASET    (FILE-ID-ERPNDB)
 17295*    END-EXEC.
 17296*    MOVE '&(                    &   #00015071' TO DFHEIV0
 17297     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 315
* EL6311.cbl
 17298     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17299     MOVE X'2020233030303135303731' TO DFHEIV0(25:11)
 17300     CALL 'kxdfhei1' USING DFHEIV0,
 17301           FILE-ID-ERPNDB,
 17302           DFHEIV99,
 17303           DFHEIV99,
 17304           DFHEIV99,
 17305           DFHEIV99
 17306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17307
 17308
 17309     PERFORM 8400-LOG-JOURNAL-RECORD.
 17310
 17311
 17312* EXEC CICS GETMAIN
 17313*        SET      (ADDRESS OF PENDING-BUSINESS)
 17314*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17315*        INITIMG  (GETMAIN-SPACE)
 17316*    END-EXEC.
 17317*    MOVE ',"IL                  $   #00015077' TO DFHEIV0
 17318     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17319     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17320     MOVE X'2020233030303135303737' TO DFHEIV0(25:11)
 17321     CALL 'kxdfhei1' USING DFHEIV0,
 17322           DFHEIV20,
 17323           ERPNDB-RECORD-LENGTH,
 17324           GETMAIN-SPACE
 17325     SET ADDRESS OF PENDING-BUSINESS TO
 17326         DFHEIV20
 17327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17328
 17329
 17330***  pending-business now has original record
 17331     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17332
 17333
 17334* EXEC CICS HANDLE CONDITION
 17335*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17336*    END-EXEC.
 17337*    MOVE '"$I                   ! ? #00015086' TO DFHEIV0
 17338     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17339     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17340     MOVE X'3F20233030303135303836' TO DFHEIV0(25:11)
 17341     CALL 'kxdfhei1' USING DFHEIV0
 17342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17343
 17344
 17345***  read elcert using original key
 17346
 17347* EXEC CICS READ
 17348*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17349*        DATASET (FILE-ID-ELCERT)
 17350*        RIDFLD  (ELCERT-KEY)
 17351*        UPDATE
 17352*    END-EXEC.
 17353*    MOVE '&"S        EU         (   #00015091' TO DFHEIV0
 17354     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17355     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 316
* EL6311.cbl
 17356     MOVE X'2020233030303135303931' TO DFHEIV0(25:11)
 17357     CALL 'kxdfhei1' USING DFHEIV0,
 17358           FILE-ID-ELCERT,
 17359           DFHEIV20,
 17360           DFHEIV99,
 17361           ELCERT-KEY,
 17362           DFHEIV99,
 17363           DFHEIV99,
 17364           DFHEIV99
 17365     SET ADDRESS OF CERTIFICATE-MASTER TO
 17366         DFHEIV20
 17367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17368
 17369
 17370     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17371     MOVE 'B'                    TO JP-RECORD-TYPE
 17372     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17373     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17374
 17375     IF INSURED-ADDR-PRESENT
 17376        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17377
 17378     IF CERT-NOTES-ARE-NOT-PRESENT
 17379        MOVE SPACE               TO WS-CERT-NOTE-SW
 17380     ELSE
 17381        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17382
 17383     IF CERT-ADDED-BATCH      OR
 17384        CERT-AND-CLAIM-ONLINE OR
 17385        CERT-WAS-CREATED-FOR-CLAIM
 17386        NEXT SENTENCE
 17387     ELSE
 17388        GO TO 2825-DELETE-CERTIFICATE.
 17389
 17390     PERFORM 8400-LOG-JOURNAL-RECORD.
 17391
 17392*********************************************************
 17393** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17394     IF CERT-ADDED-BATCH
 17395         GO TO 2822-REWRITE-ELCERT.
 17396*********************************************************
 17397
 17398     IF NO-CLAIM-ATTACHED
 17399        NEXT SENTENCE
 17400     ELSE
 17401        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17402        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17403
 17404 2822-REWRITE-ELCERT.
 17405     MOVE 'C'                    TO JP-RECORD-TYPE
 17406     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17407
 17408     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17409
 17410
 17411* EXEC CICS REWRITE
 17412*         DATASET    (FILE-ID-ELCERT)
 17413*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 317
* EL6311.cbl
 17414*    END-EXEC.
 17415     MOVE LENGTH OF
 17416      CERTIFICATE-MASTER
 17417       TO DFHEIV11
 17418*    MOVE '&& L                  %   #00015138' TO DFHEIV0
 17419     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17420     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17421     MOVE X'2020233030303135313338' TO DFHEIV0(25:11)
 17422     CALL 'kxdfhei1' USING DFHEIV0,
 17423           FILE-ID-ELCERT,
 17424           CERTIFICATE-MASTER,
 17425           DFHEIV11,
 17426           DFHEIV99
 17427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17428
 17429
 17430     PERFORM 8400-LOG-JOURNAL-RECORD.
 17431
 17432     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17433
 17434 2825-DELETE-CERTIFICATE.
 17435     MOVE 'D'                      TO JP-RECORD-TYPE.
 17436     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17437
 17438     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17439
 17440
 17441* EXEC CICS DELETE
 17442*         DATASET    (FILE-ID-ELCERT)
 17443*    END-EXEC.
 17444*    MOVE '&(                    &   #00015153' TO DFHEIV0
 17445     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17446     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17447     MOVE X'2020233030303135313533' TO DFHEIV0(25:11)
 17448     CALL 'kxdfhei1' USING DFHEIV0,
 17449           FILE-ID-ELCERT,
 17450           DFHEIV99,
 17451           DFHEIV99,
 17452           DFHEIV99,
 17453           DFHEIV99
 17454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17455
 17456
 17457     PERFORM 8400-LOG-JOURNAL-RECORD.
 17458
 17459******************************************************************
 17460*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17461******************************************************************
 17462
 17463     IF CERT-NOTES-ARE-PRESENT
 17464        NEXT SENTENCE
 17465     ELSE
 17466        GO TO 2827-DELETE-MAILING.
 17467
 17468
 17469* EXEC CICS HANDLE CONDITION
 17470*         NOTFND  (2827-DELETE-MAILING)
 17471*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 318
* EL6311.cbl
 17472*    MOVE '"$I                   ! @ #00015168' TO DFHEIV0
 17473     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17475     MOVE X'4020233030303135313638' TO DFHEIV0(25:11)
 17476     CALL 'kxdfhei1' USING DFHEIV0
 17477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17478
 17479
 17480
 17481* EXEC CICS READ
 17482*        EQUAL
 17483*        DATASET   (FILE-ID-ERNOTE)
 17484*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17485*        RIDFLD    (ELCERT-KEY)
 17486*        UPDATE
 17487*    END-EXEC.
 17488*    MOVE '&"S        EU         (   #00015172' TO DFHEIV0
 17489     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17490     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17491     MOVE X'2020233030303135313732' TO DFHEIV0(25:11)
 17492     CALL 'kxdfhei1' USING DFHEIV0,
 17493           FILE-ID-ERNOTE,
 17494           DFHEIV20,
 17495           DFHEIV99,
 17496           ELCERT-KEY,
 17497           DFHEIV99,
 17498           DFHEIV99,
 17499           DFHEIV99
 17500     SET ADDRESS OF CERTIFICATE-NOTE TO
 17501         DFHEIV20
 17502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17503
 17504
 17505     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17506     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17507     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17508
 17509     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17510
 17511
 17512* EXEC CICS DELETE
 17513*        DATASET   (FILE-ID-ERNOTE)
 17514*    END-EXEC.
 17515*    MOVE '&(                    &   #00015186' TO DFHEIV0
 17516     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17517     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17518     MOVE X'2020233030303135313836' TO DFHEIV0(25:11)
 17519     CALL 'kxdfhei1' USING DFHEIV0,
 17520           FILE-ID-ERNOTE,
 17521           DFHEIV99,
 17522           DFHEIV99,
 17523           DFHEIV99,
 17524           DFHEIV99
 17525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17526
 17527
 17528     PERFORM 8400-LOG-JOURNAL-RECORD.
 17529
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 319
* EL6311.cbl
 17530******************************************************************
 17531*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17532******************************************************************
 17533
 17534 2827-DELETE-MAILING.
 17535     IF CERT-ADDRESS-PRESENT
 17536        NEXT SENTENCE
 17537     ELSE
 17538        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17539
 17540
 17541* EXEC CICS HANDLE CONDITION
 17542*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17543*    END-EXEC.
 17544*    MOVE '"$I                   ! A #00015202' TO DFHEIV0
 17545     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17547     MOVE X'4120233030303135323032' TO DFHEIV0(25:11)
 17548     CALL 'kxdfhei1' USING DFHEIV0
 17549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17550
 17551
 17552     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17553
 17554
 17555* EXEC CICS READ
 17556*        EQUAL
 17557*        DATASET   (FILE-ID-ERMAIL)
 17558*        SET       (ADDRESS OF MAILING-DATA)
 17559*        RIDFLD    (ERMAIL-KEY)
 17560*        UPDATE
 17561*    END-EXEC.
 17562*    MOVE '&"S        EU         (   #00015208' TO DFHEIV0
 17563     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17564     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17565     MOVE X'2020233030303135323038' TO DFHEIV0(25:11)
 17566     CALL 'kxdfhei1' USING DFHEIV0,
 17567           FILE-ID-ERMAIL,
 17568           DFHEIV20,
 17569           DFHEIV99,
 17570           ERMAIL-KEY,
 17571           DFHEIV99,
 17572           DFHEIV99,
 17573           DFHEIV99
 17574     SET ADDRESS OF MAILING-DATA TO
 17575         DFHEIV20
 17576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17577
 17578
 17579     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17580     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17581     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17582
 17583     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17584
 17585
 17586* EXEC CICS DELETE
 17587*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 320
* EL6311.cbl
 17588*    END-EXEC.
 17589*    MOVE '&(                    &   #00015222' TO DFHEIV0
 17590     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17591     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17592     MOVE X'2020233030303135323232' TO DFHEIV0(25:11)
 17593     CALL 'kxdfhei1' USING DFHEIV0,
 17594           FILE-ID-ERMAIL,
 17595           DFHEIV99,
 17596           DFHEIV99,
 17597           DFHEIV99,
 17598           DFHEIV99
 17599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17600
 17601
 17602     PERFORM 8400-LOG-JOURNAL-RECORD.
 17603
 17604 2830-BUILD-NEW-ISSUE-RECORD.
 17605     MOVE SPACES                 TO ELCERT-KEY.
 17606
 17607     IF  BCERTNOL GREATER THAN ZEROS
 17608         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17609
 17610     IF  BSUFIXL  GREATER THAN ZEROS
 17611         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17612
 17613     IF BEFFDTL GREATER THAN ZEROS
 17614        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17615
 17616 2870-WRITE-PENDING-BUSINESS.
 17617     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17618     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17619     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17620     MOVE '5'                    TO DC-OPTION-CODE.
 17621     PERFORM 9700-DATE-LINK.
 17622     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17623
 17624     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17625
 17626     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17627     MOVE 'A'                    TO JP-RECORD-TYPE.
 17628     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17629
 17630
 17631* EXEC CICS WRITE
 17632*        DATASET  (FILE-ID-ERPNDB)
 17633*        FROM     (PENDING-BUSINESS)
 17634*        RIDFLD   (PB-CONTROL-PRIMARY)
 17635*    END-EXEC.
 17636     MOVE LENGTH OF
 17637      PENDING-BUSINESS
 17638       TO DFHEIV11
 17639*    MOVE '&$ L                  ''   #00015254' TO DFHEIV0
 17640     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17641     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17642     MOVE X'2020233030303135323534' TO DFHEIV0(25:11)
 17643     CALL 'kxdfhei1' USING DFHEIV0,
 17644           FILE-ID-ERPNDB,
 17645           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 321
* EL6311.cbl
 17646           DFHEIV11,
 17647           PB-CONTROL-PRIMARY,
 17648           DFHEIV99,
 17649           DFHEIV99
 17650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17651
 17652
 17653     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17654
 17655     PERFORM 8400-LOG-JOURNAL-RECORD.
 17656
 17657     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17658
 17659 2885-RECORD-MISSING.
 17660     MOVE -1                     TO BMAINTL
 17661     MOVE AL-UABON               TO BMAINTA
 17662     MOVE ER-2902                TO EMI-ERROR.
 17663     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17664     GO TO 8200-SEND-DATAONLY.
 17665
 17666 2890-DUPLICATE-RECORD.
 17667     MOVE -1                     TO BMAINTL.
 17668     MOVE AL-UABON               TO BCERTNOA.
 17669     MOVE AL-UNBON               TO BEFFDTA.
 17670     MOVE SPACE                  TO BMAINTI.
 17671
 17672     MOVE 1                      TO EMI-SUB
 17673                                    EMI-SWITCH1
 17674                                    EMI-SWITCH-AREA-1
 17675                                    EMI-SWITCH-AREA-2.
 17676
 17677     MOVE SPACES                 TO EMI-ERROR-LINES.
 17678
 17679
 17680* EXEC CICS SYNCPOINT ROLLBACK
 17681*    END-EXEC.
 17682*    MOVE '6"R                   !   #00015286' TO DFHEIV0
 17683     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17685     MOVE X'2020233030303135323836' TO DFHEIV0(25:11)
 17686     CALL 'kxdfhei1' USING DFHEIV0
 17687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17688
 17689
 17690     MOVE ER-2247                TO EMI-ERROR.
 17691     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17692     GO TO 8200-SEND-DATAONLY.
 17693
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 322
* EL6311.cbl
 17695
 17696******************************************************************
 17697*                                                                *
 17698*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17699*                                                                *
 17700******************************************************************
 17701
 17702 2900-REWRITE-CAN-CERT-KEY.
 17703     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17704
 17705     IF  CCERTNOL GREATER THAN ZEROS
 17706         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17707
 17708     IF  CSUFIXL  GREATER THAN ZEROS
 17709         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17710
 17711     IF  CEFFDTL  GREATER THAN ZEROS
 17712         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17713
 17714 2910-READ-BY-ACCOUNT.
 17715
 17716* EXEC CICS HANDLE CONDITION
 17717*         NOTFND    (2920-PROCESS-REWRITE)
 17718*    END-EXEC.
 17719*    MOVE '"$I                   ! B #00015314' TO DFHEIV0
 17720     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17722     MOVE X'4220233030303135333134' TO DFHEIV0(25:11)
 17723     CALL 'kxdfhei1' USING DFHEIV0
 17724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17725
 17726
 17727
 17728* EXEC CICS READ
 17729*        SET     (ADDRESS OF PENDING-BUSINESS)
 17730*        DATASET (FILE-ID-ERPNDB2)
 17731*        RIDFLD  (ERPNDB-ALT-KEY)
 17732*    END-EXEC.
 17733*    MOVE '&"S        E          (   #00015318' TO DFHEIV0
 17734     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17736     MOVE X'2020233030303135333138' TO DFHEIV0(25:11)
 17737     CALL 'kxdfhei1' USING DFHEIV0,
 17738           FILE-ID-ERPNDB2,
 17739           DFHEIV20,
 17740           DFHEIV99,
 17741           ERPNDB-ALT-KEY,
 17742           DFHEIV99,
 17743           DFHEIV99,
 17744           DFHEIV99
 17745     SET ADDRESS OF PENDING-BUSINESS TO
 17746         DFHEIV20
 17747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17748
 17749
 17750     GO TO 2990-DUPLICATE-RECORD.
 17751
 17752  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 323
* EL6311.cbl
 17753
 17754* EXEC CICS HANDLE CONDITION
 17755*         NOTFND    (2985-RECORD-MISSING)
 17756*    END-EXEC.
 17757*    MOVE '"$I                   ! C #00015327' TO DFHEIV0
 17758     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17760     MOVE X'4320233030303135333237' TO DFHEIV0(25:11)
 17761     CALL 'kxdfhei1' USING DFHEIV0
 17762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17763
 17764
 17765     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17766
 17767
 17768* EXEC CICS READ
 17769*        SET     (ADDRESS OF PENDING-BUSINESS)
 17770*        DATASET (FILE-ID-ERPNDB)
 17771*        RIDFLD  (ERPNDB-KEY)
 17772*        UPDATE
 17773*    END-EXEC.
 17774*    MOVE '&"S        EU         (   #00015333' TO DFHEIV0
 17775     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17776     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17777     MOVE X'2020233030303135333333' TO DFHEIV0(25:11)
 17778     CALL 'kxdfhei1' USING DFHEIV0,
 17779           FILE-ID-ERPNDB,
 17780           DFHEIV20,
 17781           DFHEIV99,
 17782           ERPNDB-KEY,
 17783           DFHEIV99,
 17784           DFHEIV99,
 17785           DFHEIV99
 17786     SET ADDRESS OF PENDING-BUSINESS TO
 17787         DFHEIV20
 17788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17789
 17790
 17791     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17792     MOVE 'D'                    TO JP-RECORD-TYPE.
 17793     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17794     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17795
 17796     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17797
 17798     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17799     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17800     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17801
 17802
 17803* EXEC CICS DELETE
 17804*        DATASET    (FILE-ID-ERPNDB)
 17805*    END-EXEC.
 17806*    MOVE '&(                    &   #00015351' TO DFHEIV0
 17807     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17808     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17809     MOVE X'2020233030303135333531' TO DFHEIV0(25:11)
 17810     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 324
* EL6311.cbl
 17811           FILE-ID-ERPNDB,
 17812           DFHEIV99,
 17813           DFHEIV99,
 17814           DFHEIV99,
 17815           DFHEIV99
 17816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17817
 17818
 17819     PERFORM 8400-LOG-JOURNAL-RECORD.
 17820
 17821
 17822* EXEC CICS GETMAIN
 17823*        SET      (ADDRESS OF PENDING-BUSINESS)
 17824*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17825*        INITIMG  (GETMAIN-SPACE)
 17826*    END-EXEC.
 17827*    MOVE ',"IL                  $   #00015357' TO DFHEIV0
 17828     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17829     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17830     MOVE X'2020233030303135333537' TO DFHEIV0(25:11)
 17831     CALL 'kxdfhei1' USING DFHEIV0,
 17832           DFHEIV20,
 17833           ERPNDB-RECORD-LENGTH,
 17834           GETMAIN-SPACE
 17835     SET ADDRESS OF PENDING-BUSINESS TO
 17836         DFHEIV20
 17837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17838
 17839
 17840     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17841
 17842 2950-PROCESS-CANCELS.
 17843
 17844
 17845* EXEC CICS HANDLE CONDITION
 17846*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17847*    END-EXEC.
 17848*    MOVE '"$I                   ! D #00015367' TO DFHEIV0
 17849     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17851     MOVE X'4420233030303135333637' TO DFHEIV0(25:11)
 17852     CALL 'kxdfhei1' USING DFHEIV0
 17853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17854
 17855
 17856
 17857* EXEC CICS READ
 17858*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17859*        DATASET (FILE-ID-ELCERT)
 17860*        RIDFLD  (ELCERT-KEY)
 17861*        UPDATE
 17862*    END-EXEC.
 17863*    MOVE '&"S        EU         (   #00015371' TO DFHEIV0
 17864     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17865     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17866     MOVE X'2020233030303135333731' TO DFHEIV0(25:11)
 17867     CALL 'kxdfhei1' USING DFHEIV0,
 17868           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 325
* EL6311.cbl
 17869           DFHEIV20,
 17870           DFHEIV99,
 17871           ELCERT-KEY,
 17872           DFHEIV99,
 17873           DFHEIV99,
 17874           DFHEIV99
 17875     SET ADDRESS OF CERTIFICATE-MASTER TO
 17876         DFHEIV20
 17877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17878
 17879
 17880     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17881
 17882     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17883     MOVE 'B'                      TO JP-RECORD-TYPE.
 17884     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17885     PERFORM 8400-LOG-JOURNAL-RECORD.
 17886
 17887     IF PB-CI-LIVES NOT NUMERIC
 17888         MOVE ZERO                    TO PB-CI-LIVES.
 17889
 17890     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17891        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17892        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17893        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17894                                         CM-LF-CANCEL-DT
 17895     ELSE
 17896        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17897        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17898        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17899        MOVE PB-CI-LIVES              TO CM-LIVES.
 17900
 17901     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17902        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17903            MOVE CM-LF-STATUS-AT-CANCEL
 17904                                     TO CM-LF-CURRENT-STATUS
 17905            MOVE SPACE
 17906                                     TO CM-LF-STATUS-AT-CANCEL
 17907        ELSE
 17908            MOVE PB-CI-LF-POLICY-STATUS
 17909                                     TO CM-LF-CURRENT-STATUS
 17910     ELSE
 17911        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17912
 17913     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17914        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17915        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17916        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17917                                         CM-AH-CANCEL-DT
 17918     ELSE
 17919        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17920        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17921        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17922        MOVE PB-CI-LIVES              TO CM-LIVES.
 17923
 17924     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17925        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17926            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 326
* EL6311.cbl
 17927                                     TO CM-AH-CURRENT-STATUS
 17928            MOVE SPACE
 17929                                     TO CM-AH-STATUS-AT-CANCEL
 17930        ELSE
 17931            MOVE PB-CI-AH-POLICY-STATUS
 17932                                     TO CM-AH-CURRENT-STATUS
 17933     ELSE
 17934        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17935
 17936 2975-REWRITE-CERT.
 17937     MOVE 'C'                      TO JP-RECORD-TYPE.
 17938     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17939
 17940
 17941* EXEC CICS REWRITE
 17942*        DATASET    (FILE-ID-ELCERT)
 17943*        FROM       (CERTIFICATE-MASTER)
 17944*    END-EXEC.
 17945     MOVE LENGTH OF
 17946      CERTIFICATE-MASTER
 17947       TO DFHEIV11
 17948*    MOVE '&& L                  %   #00015438' TO DFHEIV0
 17949     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17950     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17951     MOVE X'2020233030303135343338' TO DFHEIV0(25:11)
 17952     CALL 'kxdfhei1' USING DFHEIV0,
 17953           FILE-ID-ELCERT,
 17954           CERTIFICATE-MASTER,
 17955           DFHEIV11,
 17956           DFHEIV99
 17957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17958
 17959
 17960     PERFORM 8400-LOG-JOURNAL-RECORD.
 17961
 17962 2960-BUILD-NEW-CANCEL-RECORD.
 17963     IF  CCERTNOL GREATER THAN ZEROS
 17964         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17965
 17966     IF  CSUFIXL  GREATER THAN ZEROS
 17967         MOVE CSUFIXI             TO PB-CERT-SFX.
 17968
 17969     IF  CEFFDTL  GREATER  THAN ZEROS
 17970         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17971
 17972 2970-WRITE-PENDING-BUSINESS.
 17973     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17974     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17975     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17976     MOVE '5'                    TO DC-OPTION-CODE.
 17977     PERFORM 9700-DATE-LINK.
 17978     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17979
 17980     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17981
 17982     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17983                                    PB-CI-INSURED-SEX
 17984                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 327
* EL6311.cbl
 17985                                    PB-CI-AH-BENEFIT-CD
 17986                                    PB-CI-RATE-CLASS
 17987                                    PB-CI-RATE-DEV-LF
 17988                                    PB-CI-RATE-DEV-AH
 17989                                    PB-CI-LF-ABBR
 17990                                    PB-CI-AH-ABBR
 17991                                    PB-CI-OB-FLAG
 17992                                    PB-CI-LF-POLICY-STATUS
 17993                                    PB-CI-AH-POLICY-STATUS
 17994                                    PB-CI-INDV-GRP-CD
 17995                                    PB-CI-BENEFICIARY-NAME
 17996                                    PB-CI-NOTE-SW
 17997                                    PB-CI-SOC-SEC-NO
 17998                                    PB-CI-MEMBER-NO
 17999                                    PB-CI-INT-CODE
 18000                                    PB-CI-COMP-EXCP-SW
 18001                                    PB-CI-ENTRY-STATUS
 18002                                    PB-CI-CREDIT-INTERFACE-SW-1
 18003                                    PB-CI-CREDIT-INTERFACE-SW-2
 18004                                    PB-CI-ENTRY-BATCH.
 18005
 18006     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 18007                                    PB-CI-AH-SETTLEMENT-DT
 18008                                    PB-CI-DEATH-DT
 18009                                    PB-CI-LF-PRIOR-CANCEL-DT
 18010                                    PB-CI-AH-PRIOR-CANCEL-DT
 18011                                    PB-CI-LOAN-1ST-PMT-DT
 18012                                    PB-CI-ENTRY-DT
 18013                                    PB-CI-LF-EXPIRE-DT
 18014                                    PB-CI-AH-EXPIRE-DT.
 18015
 18016     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 18017                                    PB-CI-LF-TERM
 18018                                    PB-CI-LF-BENEFIT-AMT
 18019                                    PB-CI-LF-ALT-BENEFIT-AMT
 18020                                    PB-CI-LF-PREMIUM-AMT
 18021                                    PB-CI-LF-ALT-PREMIUM-AMT
 18022                                    PB-CI-AH-TERM
 18023                                    PB-CI-AH-BENEFIT-AMT
 18024                                    PB-CI-AH-PREMIUM-AMT
 18025                                    PB-CI-RATE-DEV-PCT-LF
 18026                                    PB-CI-RATE-DEV-PCT-AH
 18027                                    PB-CI-LIFE-COMMISSION
 18028                                    PB-CI-AH-COMMISSION
 18029                                    PB-CI-PAY-FREQUENCY
 18030                                    PB-CI-LOAN-APR
 18031                                    PB-CI-LOAN-TERM
 18032                                    PB-CI-CURR-SEQ
 18033                                    PB-CI-AH-CANCEL-AMT
 18034                                    PB-CI-LF-CANCEL-AMT
 18035                                    PB-CI-EXTENTION-DAYS
 18036                                    PB-CI-TERM-IN-DAYS
 18037                                    PB-CI-LOAN-OFFICER
 18038                                    PB-CI-LIVES
 18039                                    PB-CI-LF-CRIT-PER
 18040                                    PB-CI-AH-CRIT-PER
 18041                                    PB-C-LF-REM-TERM
 18042                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 328
* EL6311.cbl
 18043
 18044     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 18045     MOVE 'A'                    TO JP-RECORD-TYPE.
 18046     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18047
 18048
 18049* EXEC CICS HANDLE CONDITION
 18050*        DUPREC   (2990-DUPLICATE-RECORD)
 18051*    END-EXEC.
 18052*    MOVE '"$%                   ! E #00015531' TO DFHEIV0
 18053     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18055     MOVE X'4520233030303135353331' TO DFHEIV0(25:11)
 18056     CALL 'kxdfhei1' USING DFHEIV0
 18057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18058
 18059
 18060
 18061* EXEC CICS WRITE
 18062*        DATASET  (FILE-ID-ERPNDB)
 18063*        FROM     (PENDING-BUSINESS)
 18064*        RIDFLD   (PB-CONTROL-PRIMARY)
 18065*    END-EXEC.
 18066     MOVE LENGTH OF
 18067      PENDING-BUSINESS
 18068       TO DFHEIV11
 18069*    MOVE '&$ L                  ''   #00015535' TO DFHEIV0
 18070     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18071     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18072     MOVE X'2020233030303135353335' TO DFHEIV0(25:11)
 18073     CALL 'kxdfhei1' USING DFHEIV0,
 18074           FILE-ID-ERPNDB,
 18075           PENDING-BUSINESS,
 18076           DFHEIV11,
 18077           PB-CONTROL-PRIMARY,
 18078           DFHEIV99,
 18079           DFHEIV99
 18080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18081
 18082
 18083     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18084
 18085     PERFORM 8400-LOG-JOURNAL-RECORD.
 18086
 18087     GO TO 2325-PROCESS-CANCEL-CHANGES.
 18088
 18089 2985-RECORD-MISSING.
 18090     MOVE -1                     TO CMAINTL
 18091     MOVE AL-UABON               TO CMAINTA.
 18092
 18093     MOVE ER-2902                TO EMI-ERROR.
 18094     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18095     GO TO 8200-SEND-DATAONLY.
 18096
 18097 2990-DUPLICATE-RECORD.
 18098     MOVE SPACE                  TO CMAINTI.
 18099     MOVE -1                     TO CMAINTL.
 18100     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 329
* EL6311.cbl
 18101     MOVE AL-UNBON               TO CEFFDTA.
 18102
 18103     MOVE 1                      TO EMI-SUB
 18104                                    EMI-SWITCH1
 18105                                    EMI-SWITCH-AREA-1
 18106                                    EMI-SWITCH-AREA-2.
 18107     MOVE SPACES                 TO EMI-ERROR-LINES.
 18108
 18109
 18110* EXEC CICS SYNCPOINT ROLLBACK
 18111*    END-EXEC.
 18112*    MOVE '6"R                   !   #00015567' TO DFHEIV0
 18113     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18115     MOVE X'2020233030303135353637' TO DFHEIV0(25:11)
 18116     CALL 'kxdfhei1' USING DFHEIV0
 18117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18118
 18119
 18120     MOVE ER-2247                TO EMI-ERROR.
 18121     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18122     GO TO 8200-SEND-DATAONLY.
 18123
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 330
* EL6311.cbl
 18125
 18126***************************************************************
 18127*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 18128*     PREMIUM FOR A SINGLE BATCH.                             *
 18129*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 18130***************************************************************
 18131
 18132 3000-BATCH-MAINLINE.
 18133     IF PI-PREV-KEY NOT = SPACES
 18134         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 18135     ELSE
 18136         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 18137
 18138     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 18139
 18140 3010-READNEXT.
 18141
 18142* EXEC CICS READ
 18143*         DATASET    (FILE-ID-ERPNDB)
 18144*         SET        (ADDRESS OF PENDING-BUSINESS)
 18145*         RIDFLD     (ERPNDB-KEY)
 18146*         GTEQ
 18147*    END-EXEC.
 18148*    MOVE '&"S        G          (   #00015591' TO DFHEIV0
 18149     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18151     MOVE X'2020233030303135353931' TO DFHEIV0(25:11)
 18152     CALL 'kxdfhei1' USING DFHEIV0,
 18153           FILE-ID-ERPNDB,
 18154           DFHEIV20,
 18155           DFHEIV99,
 18156           ERPNDB-KEY,
 18157           DFHEIV99,
 18158           DFHEIV99,
 18159           DFHEIV99
 18160     SET ADDRESS OF PENDING-BUSINESS TO
 18161         DFHEIV20
 18162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18163
 18164
 18165     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18166        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18167          GO TO 3030-END-BATCH.
 18168
 18169     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18170
 18171     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18172        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18173          GO TO 3020-BUMP-SEQ.
 18174
 18175     IF PB-ISSUE
 18176        ADD +1                   TO WS-ISS-TOTAL-CNT
 18177        IF PB-FATAL-ERRORS
 18178           ADD +1                      TO WS-ISS-FATAL-CNT
 18179           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18180           GO TO 3020-BUMP-SEQ
 18181        ELSE
 18182           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 331
* EL6311.cbl
 18183              ADD +1                      TO WS-ISS-FORCE-CNT
 18184              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18185              GO TO 3020-BUMP-SEQ
 18186           ELSE
 18187              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18188                 ADD +1                      TO WS-ISS-HOLD-CNT
 18189                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18190                 GO TO 3020-BUMP-SEQ
 18191              ELSE
 18192                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18193                     THRU  3299-EXIT
 18194                 GO TO 3020-BUMP-SEQ.
 18195
 18196     IF PB-CANCELLATION
 18197        ADD +1                   TO WS-CAN-TOTAL-CNT
 18198        IF PB-FATAL-ERRORS
 18199           ADD +1                 TO WS-CAN-FATAL-CNT
 18200           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18201           GO TO 3020-BUMP-SEQ
 18202        ELSE
 18203           IF PB-UNFORCED-ERRORS
 18204              ADD +1                 TO WS-CAN-FORCE-CNT
 18205              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18206              GO TO 3020-BUMP-SEQ
 18207           ELSE
 18208              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18209                 ADD +1                 TO WS-CAN-HOLD-CNT
 18210                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18211                 GO TO 3020-BUMP-SEQ
 18212              ELSE
 18213                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18214                     THRU  3499-EXIT
 18215                 GO TO 3020-BUMP-SEQ.
 18216
 18217     IF PB-BATCH-TRAILER
 18218         GO TO 3030-END-BATCH.
 18219
 18220 3020-BUMP-SEQ.
 18221     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18222     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18223     GO TO 3010-READNEXT.
 18224
 18225 3030-END-BATCH.
 18226     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18227     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18228     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18229     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18230
 18231     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18232                                          - WS-ISS-FORCE-CNT
 18233                                          - WS-ISS-HOLD-CNT).
 18234
 18235     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18236     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18237
 18238     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18239     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18240     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 332
* EL6311.cbl
 18241     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18242     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18243                                          - WS-CAN-FORCE-CNT
 18244                                          - WS-CAN-HOLD-CNT).
 18245     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18246     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18247
 18248     COMPUTE WS-NET-TOTAL-CNT
 18249         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18250     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18251     COMPUTE WS-NET-FATAL-CNT
 18252         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18253     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18254     COMPUTE WS-NET-FORCE-CNT
 18255         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18256     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18257     COMPUTE WS-NET-HOLD-CNT
 18258         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18259     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18260
 18261     COMPUTE WS-NET-AVAIL-CNT
 18262          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18263                              - WS-ISS-FORCE-CNT
 18264                              - WS-ISS-HOLD-CNT)
 18265          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18266                              - WS-CAN-FORCE-CNT
 18267                              - WS-CAN-HOLD-CNT).
 18268     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18269
 18270     COMPUTE WS-NET-GOOD-PREM
 18271         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18272     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18273     COMPUTE WS-NET-BAD-PREM
 18274         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18275     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18276
 18277     MOVE 0000                   TO EMI-ERROR.
 18278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18279     MOVE -1                     TO DPFENTRL.
 18280     GO TO 8200-SEND-DATAONLY.
 18281
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 333
* EL6311.cbl
 18283
 18284******************************************************************
 18285*                                                                *
 18286*           A D D    B A D   I S S U E   P R E M I U M           *
 18287*                                                                *
 18288******************************************************************
 18289
 18290 3100-ADD-BAD-ISSUE-PREM.
 18291     IF PB-OVERRIDE-LIFE
 18292       OR PB-OVERRIDE-BOTH
 18293           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18294           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18295       ELSE
 18296           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18297           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18298
 18299     IF PB-OVERRIDE-AH
 18300       OR PB-OVERRIDE-BOTH
 18301           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18302       ELSE
 18303           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18304
 18305 3199-EXIT.
 18306     EXIT.
 18307
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 334
* EL6311.cbl
 18309
 18310******************************************************************
 18311*                                                                *
 18312*       A D D   G O O D   I S S U E   P R E M I U M              *
 18313*                                                                *
 18314******************************************************************
 18315
 18316 3200-ADD-GOOD-ISSUE-PREM.
 18317     IF PB-OVERRIDE-LIFE
 18318       OR PB-OVERRIDE-BOTH
 18319           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18320           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18321       ELSE
 18322           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18323           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18324
 18325     IF PB-OVERRIDE-AH
 18326       OR PB-OVERRIDE-BOTH
 18327           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18328       ELSE
 18329           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18330
 18331 3299-EXIT.
 18332     EXIT.
 18333
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 335
* EL6311.cbl
 18335
 18336
 18337******************************************************************
 18338*                                                                *
 18339*        A D D   B A D   C A N C E L   P R E M I U M             *
 18340*                                                                *
 18341******************************************************************
 18342
 18343 3300-ADD-BAD-CANCEL-PREM.
 18344     IF PB-OVERRIDE-LIFE
 18345       OR PB-OVERRIDE-BOTH
 18346           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18347       ELSE
 18348           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18349
 18350     IF PB-OVERRIDE-AH
 18351       OR PB-OVERRIDE-BOTH
 18352           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18353       ELSE
 18354           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18355
 18356 3399-EXIT.
 18357     EXIT.
 18358
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 336
* EL6311.cbl
 18360
 18361******************************************************************
 18362*                                                                *
 18363*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18364*                                                                *
 18365******************************************************************
 18366
 18367 3400-ADD-GOOD-CANCEL-PREM.
 18368     IF PB-OVERRIDE-LIFE
 18369       OR PB-OVERRIDE-BOTH
 18370           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18371       ELSE
 18372           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18373
 18374     IF PB-OVERRIDE-AH
 18375       OR PB-OVERRIDE-BOTH
 18376           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18377       ELSE
 18378           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18379
 18380 3499-EXIT.
 18381     EXIT.
 18382
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 337
* EL6311.cbl
 18384
 18385******************************************************************
 18386*                                                                *
 18387*           E D I T   B A T C H   D A T A                        *
 18388*                                                                *
 18389******************************************************************
 18390
 18391 3500-EDIT-BATCH-DATA.
 18392     IF PI-PREV-KEY NOT = SPACES
 18393        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18394     ELSE
 18395        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18396
 18397     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18398     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18399
 18400
 18401* EXEC CICS HANDLE CONDITION
 18402*         NOTFND      (3590-NOT-FOUND)
 18403*    END-EXEC.
 18404*    MOVE '"$I                   ! F #00015833' TO DFHEIV0
 18405     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18407     MOVE X'4620233030303135383333' TO DFHEIV0(25:11)
 18408     CALL 'kxdfhei1' USING DFHEIV0
 18409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18410
 18411
 18412     IF DRISSL   GREATER THAN ZEROS OR
 18413        DRISSL   GREATER THAN ZEROS OR
 18414        DRLFPRML GREATER THAN ZEROS OR
 18415        DRAHPRML GREATER THAN ZEROS OR
 18416        DRCANCL  GREATER THAN ZEROS OR
 18417        DRLFRFDL GREATER THAN ZEROS OR
 18418        DRAHRFDL GREATER THAN ZEROS
 18419              NEXT SENTENCE
 18420          ELSE
 18421              MOVE ER-3224    TO EMI-ERROR
 18422              MOVE -1         TO DPFENTRL
 18423              MOVE AL-UNBON   TO DPFENTRA
 18424              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18425              GO TO 8200-SEND-DATAONLY.
 18426
 18427     IF NOT MODIFY-CAP
 18428         MOVE 'UPDATE'       TO SM-READ
 18429         PERFORM 9995-SECURITY-VIOLATION
 18430         MOVE ER-0070        TO EMI-ERROR
 18431         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18432         GO TO 8100-SEND-INITIAL-MAP.
 18433
 18434        IF DRISSL GREATER THAN ZEROS
 18435           MOVE AL-UNNON         TO DRISSA
 18436           MOVE DRISSI           TO DEEDIT-FIELD
 18437           PERFORM 8600-DEEDIT
 18438           IF DEEDIT-FIELD-V0  NUMERIC
 18439              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18440           ELSE
 18441              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 338
* EL6311.cbl
 18442              MOVE -1         TO DRISSL
 18443              MOVE AL-UNBON   TO DRISSA
 18444              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18445
 18446        IF DRLFPRML GREATER THAN ZEROS
 18447           MOVE AL-UNNON         TO DRLFPRMA
 18448
 18449* EXEC CICS BIF DEEDIT
 18450*              FIELD  (DRLFPRMI)
 18451*              LENGTH (11)
 18452*          END-EXEC
 18453     MOVE 11
 18454       TO DFHEIV11
 18455*    MOVE '@"L                   #   #00015873' TO DFHEIV0
 18456     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18457     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18458     MOVE X'2020233030303135383733' TO DFHEIV0(25:11)
 18459     CALL 'kxdfhei1' USING DFHEIV0,
 18460           DRLFPRMI,
 18461           DFHEIV11
 18462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18463           IF DRLFPRMI NUMERIC
 18464              MOVE DRLFPRMI   TO WS-DRLFPRM
 18465*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18466*          PERFORM 8600-DEEDIT
 18467*          IF DEEDIT-FIELD-V2  NUMERIC
 18468*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18469           ELSE
 18470              MOVE ER-2223    TO EMI-ERROR
 18471              MOVE -1         TO DRLFPRML
 18472              MOVE AL-UNBON   TO DRLFPRMA
 18473              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18474
 18475        IF DRAHPRML GREATER THAN ZEROS
 18476           MOVE AL-UNNON         TO DRAHPRMA
 18477
 18478* EXEC CICS BIF DEEDIT
 18479*              FIELD  (DRAHPRMI)
 18480*              LENGTH (11)
 18481*          END-EXEC
 18482     MOVE 11
 18483       TO DFHEIV11
 18484*    MOVE '@"L                   #   #00015891' TO DFHEIV0
 18485     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18486     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18487     MOVE X'2020233030303135383931' TO DFHEIV0(25:11)
 18488     CALL 'kxdfhei1' USING DFHEIV0,
 18489           DRAHPRMI,
 18490           DFHEIV11
 18491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18492           IF DRAHPRMI NUMERIC
 18493              MOVE DRAHPRMI   TO WS-DRAHPRM
 18494*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18495*          PERFORM 8600-DEEDIT
 18496*          IF DEEDIT-FIELD-V2  NUMERIC
 18497*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18498           ELSE
 18499              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 339
* EL6311.cbl
 18500              MOVE -1         TO DRAHPRML
 18501              MOVE AL-UNBON   TO DRAHPRMA
 18502              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18503
 18504        IF DRCANCL GREATER THAN ZEROS
 18505           MOVE AL-UNNON         TO DRCANCA
 18506           MOVE DRCANCI          TO DEEDIT-FIELD
 18507           PERFORM 8600-DEEDIT
 18508           IF DEEDIT-FIELD-V0  NUMERIC
 18509              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18510           ELSE
 18511              MOVE ER-2223    TO EMI-ERROR
 18512              MOVE -1         TO DRCANCL
 18513              MOVE AL-UNBON   TO DRCANCL
 18514              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18515
 18516        IF DRLFRFDL GREATER THAN ZEROS
 18517           MOVE AL-UNNON         TO DRLFRFDA
 18518
 18519* EXEC CICS BIF DEEDIT
 18520*              FIELD  (DRLFRFDI)
 18521*              LENGTH (11)
 18522*          END-EXEC
 18523     MOVE 11
 18524       TO DFHEIV11
 18525*    MOVE '@"L                   #   #00015921' TO DFHEIV0
 18526     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18527     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18528     MOVE X'2020233030303135393231' TO DFHEIV0(25:11)
 18529     CALL 'kxdfhei1' USING DFHEIV0,
 18530           DRLFRFDI,
 18531           DFHEIV11
 18532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18533           IF DRLFRFDI NUMERIC
 18534              MOVE DRLFRFDI   TO WS-DRLFRFD
 18535*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18536*          PERFORM 8600-DEEDIT
 18537*          IF DEEDIT-FIELD-V2  NUMERIC
 18538*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18539           ELSE
 18540              MOVE ER-2223    TO EMI-ERROR
 18541              MOVE -1         TO DRLFRFDL
 18542              MOVE AL-UNBON   TO DRLFRFDA
 18543              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18544
 18545        IF DRAHRFDL GREATER THAN ZEROS
 18546           MOVE AL-UNNON         TO DRAHRFDA
 18547
 18548* EXEC CICS BIF DEEDIT
 18549*              FIELD  (DRAHRFDI)
 18550*              LENGTH (11)
 18551*          END-EXEC
 18552     MOVE 11
 18553       TO DFHEIV11
 18554*    MOVE '@"L                   #   #00015939' TO DFHEIV0
 18555     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18556     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18557     MOVE X'2020233030303135393339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 340
* EL6311.cbl
 18558     CALL 'kxdfhei1' USING DFHEIV0,
 18559           DRAHRFDI,
 18560           DFHEIV11
 18561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18562           IF DRAHRFDI NUMERIC
 18563              MOVE DRAHRFDI   TO WS-DRAHRFD
 18564*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18565*          PERFORM 8600-DEEDIT
 18566*          IF DEEDIT-FIELD-V2  NUMERIC
 18567*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18568           ELSE
 18569              MOVE ER-2223    TO EMI-ERROR
 18570              MOVE -1         TO DRAHRFDL
 18571              MOVE AL-UNBON   TO DRAHRFDA
 18572              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18573
 18574     IF EMI-ERROR = ZEROS
 18575        GO 3600-UPDATE-BATCH-HEADER.
 18576
 18577     GO TO 8200-SEND-DATAONLY.
 18578
 18579 3590-NOT-FOUND.
 18580     MOVE ER-2192                TO EMI-ERROR.
 18581     MOVE -1                     TO DPFENTRL.
 18582     MOVE AL-UNBON               TO DPFENTRA.
 18583     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18584     GO TO 8200-SEND-DATAONLY.
 18585
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 341
* EL6311.cbl
 18587
 18588******************************************************************
 18589*                                                                *
 18590*           U P D A T E   B A T C H   H E A D E R                *
 18591*                                                                *
 18592******************************************************************
 18593
 18594 3600-UPDATE-BATCH-HEADER.
 18595
 18596* EXEC CICS HANDLE CONDITION
 18597*         NOTFND      (3690-NOT-FOUND)
 18598*    END-EXEC.
 18599*    MOVE '"$I                   ! G #00015976' TO DFHEIV0
 18600     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18602     MOVE X'4720233030303135393736' TO DFHEIV0(25:11)
 18603     CALL 'kxdfhei1' USING DFHEIV0
 18604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18605
 18606
 18607
 18608* EXEC CICS READ
 18609*        DATASET (FILE-ID-ERPNDB)
 18610*        RIDFLD  (ERPNDB-KEY)
 18611*        SET     (ADDRESS OF PENDING-BUSINESS)
 18612*        UPDATE
 18613*    END-EXEC.
 18614*    MOVE '&"S        EU         (   #00015980' TO DFHEIV0
 18615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18616     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18617     MOVE X'2020233030303135393830' TO DFHEIV0(25:11)
 18618     CALL 'kxdfhei1' USING DFHEIV0,
 18619           FILE-ID-ERPNDB,
 18620           DFHEIV20,
 18621           DFHEIV99,
 18622           ERPNDB-KEY,
 18623           DFHEIV99,
 18624           DFHEIV99,
 18625           DFHEIV99
 18626     SET ADDRESS OF PENDING-BUSINESS TO
 18627         DFHEIV20
 18628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18629
 18630
 18631     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18632     MOVE 'B'                    TO JP-RECORD-TYPE.
 18633     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18634
 18635     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18636
 18637     PERFORM 8400-LOG-JOURNAL-RECORD.
 18638
 18639     IF DRISSL GREATER THAN ZEROS
 18640        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18641
 18642     IF DRCANCL GREATER THAN ZEROS
 18643        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18644
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 342
* EL6311.cbl
 18645
 18646     IF DRLFPRML GREATER THAN ZEROS
 18647        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18648
 18649     IF DRAHPRML GREATER THAN ZEROS
 18650        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18651
 18652     IF DRLFRFDL GREATER THAN ZEROS
 18653        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18654
 18655     IF DRAHRFDL GREATER THAN ZEROS
 18656        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18657
 18658 3670-REWRITE-BATCH-HEADER.
 18659     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18660        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18661        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18662        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18663        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18664        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18665        MOVE SPACE               TO PB-OUT-BAL-CD
 18666     ELSE
 18667        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18668
 18669     MOVE 'C'                    TO JP-RECORD-TYPE.
 18670     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18671
 18672
 18673* EXEC CICS REWRITE
 18674*         DATASET      (FILE-ID-ERPNDB)
 18675*         FROM         (PENDING-BUSINESS)
 18676*    END-EXEC.
 18677     MOVE LENGTH OF
 18678      PENDING-BUSINESS
 18679       TO DFHEIV11
 18680*    MOVE '&& L                  %   #00016028' TO DFHEIV0
 18681     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18682     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18683     MOVE X'2020233030303136303238' TO DFHEIV0(25:11)
 18684     CALL 'kxdfhei1' USING DFHEIV0,
 18685           FILE-ID-ERPNDB,
 18686           PENDING-BUSINESS,
 18687           DFHEIV11,
 18688           DFHEIV99
 18689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18690
 18691
 18692     PERFORM 8400-LOG-JOURNAL-RECORD.
 18693
 18694     GO TO 7200-DISPLAY-BATCHES.
 18695
 18696 3690-NOT-FOUND.
 18697     MOVE ER-2192                TO EMI-ERROR.
 18698     MOVE -1                     TO DPFENTRL.
 18699     MOVE AL-UNBON               TO DPFENTRA.
 18700     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18701     GO TO 8200-SEND-DATAONLY.
 18702
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 343
* EL6311.cbl
 18704
 18705******************************************************************
 18706*                                                                *
 18707*           R E - D I S P L A Y   R E C O R D                    *
 18708*                                                                *
 18709******************************************************************
 18710
 18711 3900-RE-DISPLAY-RECORD.
 18712
 18713* EXEC CICS HANDLE CONDITION
 18714*         NOTFND   (3990-NOT-FOUND)
 18715*    END-EXEC.
 18716*    MOVE '"$I                   ! H #00016053' TO DFHEIV0
 18717     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18718     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18719     MOVE X'4820233030303136303533' TO DFHEIV0(25:11)
 18720     CALL 'kxdfhei1' USING DFHEIV0
 18721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18722
 18723
 18724     IF PI-DISPLAY-ORIGINAL-BATCH
 18725         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18726     ELSE
 18727         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18728
 18729
 18730* EXEC CICS READ
 18731*         DATASET   (FILE-ID)
 18732*         RIDFLD    (PI-PREV-KEY)
 18733*         SET       (ADDRESS OF PENDING-BUSINESS)
 18734*    END-EXEC.
 18735*    MOVE '&"S        E          (   #00016062' TO DFHEIV0
 18736     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18737     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18738     MOVE X'2020233030303136303632' TO DFHEIV0(25:11)
 18739     CALL 'kxdfhei1' USING DFHEIV0,
 18740           FILE-ID,
 18741           DFHEIV20,
 18742           DFHEIV99,
 18743           PI-PREV-KEY,
 18744           DFHEIV99,
 18745           DFHEIV99,
 18746           DFHEIV99
 18747     SET ADDRESS OF PENDING-BUSINESS TO
 18748         DFHEIV20
 18749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18750
 18751
 18752     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18753
 18754     IF PB-ISSUE
 18755         GO TO 7000-DISPLAY-ISSUES.
 18756
 18757     IF PB-CANCELLATION
 18758         GO TO 7100-DISPLAY-CANCELS.
 18759
 18760     IF PB-BATCH-TRAILER
 18761         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 344
* EL6311.cbl
 18762
 18763 3990-NOT-FOUND.
 18764     MOVE LOW-VALUES             TO EL631BI.
 18765
 18766     IF PI-MAP-NAME = EL631B
 18767         MOVE -1                  TO BMAINTL
 18768     ELSE
 18769         MOVE -1                  TO CMAINTL.
 18770
 18771     GO TO 8100-SEND-INITIAL-MAP.
 18772
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 345
* EL6311.cbl
 18774
 18775***************************************************************
 18776*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18777*                                                             *
 18778*      1. START BROWSE WITH                                   *
 18779*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18780*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18781*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18782*                                                             *
 18783*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18784*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18785*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18786*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18787*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18788*               AND IS IT TO BE DISPLAYED.                    *
 18789*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18790*               DISPLAYED.                                    *
 18791*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18792*               DISPLAYED.                                    *
 18793*                                                             *
 18794*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18795*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18796***************************************************************
 18797
 18798 4000-BROWSE-DETAIL-FORWARD.
 18799     IF FIRST-TIME
 18800        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18801     ELSE
 18802        IF SHOW-RECORD
 18803           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18804           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18805           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18806           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18807           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18808        ELSE
 18809           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18810
 18811
 18812* EXEC CICS HANDLE CONDITION
 18813*         NOTFND   (4050-END-RECORDS)
 18814*         ENDFILE  (4050-END-RECORDS)
 18815*    END-EXEC.
 18816*    MOVE '"$I''                  ! I #00016127' TO DFHEIV0
 18817     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18819     MOVE X'4920233030303136313237' TO DFHEIV0(25:11)
 18820     CALL 'kxdfhei1' USING DFHEIV0
 18821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18822
 18823
 18824
 18825* EXEC CICS STARTBR
 18826*         DATASET   (FILE-ID-ERPNDB2)
 18827*         RIDFLD    (ERPNDB-ALT-KEY)
 18828*    END-EXEC.
 18829     MOVE 0
 18830       TO DFHEIV11
 18831*    MOVE '&,         G          &   #00016132' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 346
* EL6311.cbl
 18832     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18833     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18834     MOVE X'2020233030303136313332' TO DFHEIV0(25:11)
 18835     CALL 'kxdfhei1' USING DFHEIV0,
 18836           FILE-ID-ERPNDB2,
 18837           ERPNDB-ALT-KEY,
 18838           DFHEIV99,
 18839           DFHEIV11,
 18840           DFHEIV99
 18841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18842
 18843
 18844     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18845
 18846     IF FIRST-TIME OR SHOW-RECORD
 18847        MOVE SPACE               TO WS-FIRST-TIME-SW
 18848        GO TO 4005-READ-NEXT-RECORD.
 18849
 18850
 18851* EXEC CICS READNEXT
 18852*         DATASET    (FILE-ID-ERPNDB2)
 18853*         SET        (ADDRESS OF PENDING-BUSINESS)
 18854*         RIDFLD     (ERPNDB-ALT-KEY)
 18855*    END-EXEC.
 18856     MOVE 0
 18857       TO DFHEIV11
 18858*    MOVE '&.S                   )   #00016143' TO DFHEIV0
 18859     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18860     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18861     MOVE X'2020233030303136313433' TO DFHEIV0(25:11)
 18862     CALL 'kxdfhei1' USING DFHEIV0,
 18863           FILE-ID-ERPNDB2,
 18864           DFHEIV20,
 18865           DFHEIV99,
 18866           ERPNDB-ALT-KEY,
 18867           DFHEIV99,
 18868           DFHEIV11,
 18869           DFHEIV99,
 18870           DFHEIV99
 18871     SET ADDRESS OF PENDING-BUSINESS TO
 18872         DFHEIV20
 18873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18874
 18875
 18876 4005-READ-NEXT-RECORD.
 18877
 18878* EXEC CICS READNEXT
 18879*         DATASET    (FILE-ID-ERPNDB2)
 18880*         SET        (ADDRESS OF PENDING-BUSINESS)
 18881*         RIDFLD     (ERPNDB-ALT-KEY)
 18882*    END-EXEC.
 18883     MOVE 0
 18884       TO DFHEIV11
 18885*    MOVE '&.S                   )   #00016150' TO DFHEIV0
 18886     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18887     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18888     MOVE X'2020233030303136313530' TO DFHEIV0(25:11)
 18889     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 347
* EL6311.cbl
 18890           FILE-ID-ERPNDB2,
 18891           DFHEIV20,
 18892           DFHEIV99,
 18893           ERPNDB-ALT-KEY,
 18894           DFHEIV99,
 18895           DFHEIV11,
 18896           DFHEIV99,
 18897           DFHEIV99
 18898     SET ADDRESS OF PENDING-BUSINESS TO
 18899         DFHEIV20
 18900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18901
 18902
 18903     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18904
 18905     IF WS-BATCH-PREFIX = '#CL'
 18906        GO TO 4005-READ-NEXT-RECORD.
 18907
 18908     IF SHOW-RECORD
 18909        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18910           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18911           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18912           PB-STATE         NOT = PI-PB-STATE          OR
 18913           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18914           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18915           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18916           GO TO 4050-END-RECORDS
 18917        ELSE
 18918           GO TO 4010-CHECK-REC-TYPE.
 18919
 18920     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18921        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18922        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18923        PB-STATE            NOT = PI-PB-STATE          OR
 18924        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18925        GO TO 4050-END-RECORDS.
 18926
 18927     IF PB-BATCH-TRAILER
 18928        GO TO 4005-READ-NEXT-RECORD.
 18929
 18930     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18931        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18932           GO TO 4005-READ-NEXT-RECORD
 18933        ELSE
 18934           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18935              GO TO 4010-CHECK-REC-TYPE
 18936           ELSE
 18937              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18938                 GO TO 4010-CHECK-REC-TYPE
 18939              ELSE
 18940                 GO TO 4005-READ-NEXT-RECORD.
 18941
 18942     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18943        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18944           GO TO 4005-READ-NEXT-RECORD.
 18945
 18946 4010-CHECK-REC-TYPE.
 18947     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 348
* EL6311.cbl
 18948         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18949             NEXT SENTENCE
 18950         ELSE
 18951             GO TO 4005-READ-NEXT-RECORD.
 18952
 18953     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18954         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18955             NEXT SENTENCE
 18956        ELSE
 18957             GO TO 4005-READ-NEXT-RECORD.
 18958
 18959     IF NOT DISPLAY-CHANGE-RECORDS AND
 18960            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18961        GO TO 4005-READ-NEXT-RECORD.
 18962
 18963     IF DISPLAY-HOLD-RECORDS AND
 18964        NOT PB-RECORD-ON-HOLD
 18965          GO TO 4005-READ-NEXT-RECORD.
 18966
 18967     IF PB-ISSUE
 18968        IF DISPLAY-CHK-REQ-RECORDS
 18969            GO TO 4005-READ-NEXT-RECORD.
 18970
 18971     IF PB-ISSUE
 18972        IF ISSUE-WITH-WARNING
 18973           IF PB-WARNING-ERRORS
 18974              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18975                  GO TO 4005-READ-NEXT-RECORD
 18976              ELSE
 18977                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18978                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18979                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18980                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18981                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18982                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18983                 GO TO 7000-DISPLAY-ISSUES
 18984           ELSE
 18985              GO TO 4005-READ-NEXT-RECORD.
 18986
 18987     IF PB-ISSUE
 18988        IF (ISSUES-IN-ERROR AND
 18989            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18990            ALL-ISSUES
 18991            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18992            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18993            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18994            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18995            MOVE PB-SV-STATE            TO PI-SV-STATE
 18996            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18997            GO TO 7000-DISPLAY-ISSUES
 18998        ELSE
 18999            GO TO 4005-READ-NEXT-RECORD.
 19000
 19001     IF PB-CANCELLATION
 19002        IF DISPLAY-CHK-REQ-RECORDS
 19003           IF PB-C-REFUND-REQUESTED
 19004              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19005              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 349
* EL6311.cbl
 19006              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19007              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19008              MOVE PB-SV-STATE            TO PI-SV-STATE
 19009              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19010              GO TO 7100-DISPLAY-CANCELS
 19011           ELSE
 19012               GO TO 4005-READ-NEXT-RECORD.
 19013
 19014     IF PB-CANCELLATION
 19015        IF CANCEL-WITH-WARNING
 19016           IF PB-WARNING-ERRORS
 19017              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19018                  GO TO 4005-READ-NEXT-RECORD
 19019              ELSE
 19020                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19021                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19022                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19023                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19024                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19025                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19026                 GO TO 7100-DISPLAY-CANCELS
 19027           ELSE
 19028              GO TO 4005-READ-NEXT-RECORD.
 19029
 19030     IF PB-CANCELLATION
 19031        IF (CANCEL-IN-ERROR  AND
 19032            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19033            ALL-CANCELS
 19034            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19035            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19036            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19037            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19038            MOVE PB-SV-STATE            TO PI-SV-STATE
 19039            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19040            GO TO 7100-DISPLAY-CANCELS.
 19041
 19042     GO TO 4005-READ-NEXT-RECORD.
 19043
 19044 4050-END-RECORDS.
 19045******************************************************************
 19046*                                                                *
 19047*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19048*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19049*         PROGRAM.                                               *
 19050*                                                                *
 19051******************************************************************
 19052
 19053     IF BROWSE-STARTED
 19054        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19055
 19056* EXEC CICS ENDBR
 19057*            DATASET  (FILE-ID-ERPNDB2)
 19058*       END-EXEC.
 19059     MOVE 0
 19060       TO DFHEIV11
 19061*    MOVE '&2                    $   #00016308' TO DFHEIV0
 19062     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19063     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 350
* EL6311.cbl
 19064     MOVE X'2020233030303136333038' TO DFHEIV0(25:11)
 19065     CALL 'kxdfhei1' USING DFHEIV0,
 19066           FILE-ID-ERPNDB2,
 19067           DFHEIV11,
 19068           DFHEIV99
 19069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19070
 19071
 19072     IF  EIBTRNID NOT = TRANS-EXB1
 19073         IF PENDING-BUS-RECS-FOUND
 19074             NEXT SENTENCE
 19075           ELSE
 19076             MOVE '9'            TO PI-BROWSE-SW
 19077             GO TO 9400-CLEAR.
 19078
 19079     IF SHOW-RECORD
 19080        MOVE ER-2253            TO EMI-ERROR
 19081       ELSE
 19082        MOVE ER-2254            TO EMI-ERROR.
 19083
 19084     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19085
 19086     IF PI-MAP-NAME = SPACES
 19087        MOVE -1                  TO DPFENTRL
 19088        MOVE EL631D               TO PI-MAP-NAME
 19089        GO TO 8100-SEND-INITIAL-MAP.
 19090
 19091     IF PI-MAP-NAME = EL631B
 19092        MOVE -1                  TO BMAINTL
 19093     ELSE
 19094        IF PI-MAP-NAME = EL631C
 19095           MOVE -1               TO CMAINTL
 19096        ELSE
 19097           MOVE -1               TO DPFENTRL.
 19098
 19099     GO TO 8200-SEND-DATAONLY.
 19100
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 351
* EL6311.cbl
 19102
 19103***************************************************************
 19104*                                                             *
 19105*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 19106*                                                             *
 19107*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 19108*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19109*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19110*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 19111*                                                             *
 19112*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19113*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19114*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 19115*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19116*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19117*                AND IS IT TO BE DISPLAYED.                   *
 19118*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19119*                DISPLAYED.                                   *
 19120*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19121*                DISPLAYED.                                   *
 19122*                                                             *
 19123*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19124*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19125*                                                             *
 19126*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19127*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19128*                THEY ARE NOT TO BE DISPLAYED.                *
 19129*                                                             *
 19130***************************************************************
 19131
 19132 4100-BROWSE-PRIMARY-FORWARD.
 19133     IF FIRST-TIME  OR SHOW-RECORD
 19134        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 19135        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 19136        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 19137     ELSE
 19138        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 19139        IF ERPNDB-BATCH-SEQ-NO = +9999
 19140           GO TO 4150-END-BATCH
 19141        ELSE
 19142           IF DISPLAY-CHANGE-RECORDS
 19143              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19144           ELSE
 19145              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19146              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19147
 19148     IF FIRST-TIME
 19149         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 19150            PI-PB-BATCH-SEQ-NO NOT = ZERO
 19151              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 19152
 19153
 19154* EXEC CICS HANDLE CONDITION
 19155*         ENDFILE  (4150-END-BATCH)
 19156*    END-EXEC.
 19157*    MOVE '"$''                   ! J #00016393' TO DFHEIV0
 19158     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 352
* EL6311.cbl
 19160     MOVE X'4A20233030303136333933' TO DFHEIV0(25:11)
 19161     CALL 'kxdfhei1' USING DFHEIV0
 19162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19163
 19164
 19165 4105-READ-NEXT.
 19166
 19167* EXEC CICS HANDLE CONDITION
 19168*         NOTFND    (4150-END-BATCH)
 19169*    END-EXEC.
 19170*    MOVE '"$I                   ! K #00016398' TO DFHEIV0
 19171     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19173     MOVE X'4B20233030303136333938' TO DFHEIV0(25:11)
 19174     CALL 'kxdfhei1' USING DFHEIV0
 19175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19176
 19177
 19178     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19179
 19180     IF PI-DISPLAY-ORIGINAL-BATCH
 19181        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19182     ELSE
 19183        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19184
 19185
 19186* EXEC CICS READ
 19187*         DATASET   (FILE-ID)
 19188*         SET       (ADDRESS OF PENDING-BUSINESS)
 19189*         RIDFLD    (ERPNDB-KEY)
 19190*         GTEQ
 19191*    END-EXEC.
 19192*    MOVE '&"S        G          (   #00016409' TO DFHEIV0
 19193     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19194     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19195     MOVE X'2020233030303136343039' TO DFHEIV0(25:11)
 19196     CALL 'kxdfhei1' USING DFHEIV0,
 19197           FILE-ID,
 19198           DFHEIV20,
 19199           DFHEIV99,
 19200           ERPNDB-KEY,
 19201           DFHEIV99,
 19202           DFHEIV99,
 19203           DFHEIV99
 19204     SET ADDRESS OF PENDING-BUSINESS TO
 19205         DFHEIV20
 19206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19207
 19208
 19209     IF PI-DISPLAY-ORIGINAL-BATCH
 19210        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19211           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19212           GO TO 4150-END-BATCH
 19213        ELSE
 19214           IF PB-BATCH-TRAILER
 19215              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19216              GO TO 4105-READ-NEXT
 19217           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 353
* EL6311.cbl
 19218              NEXT SENTENCE
 19219     ELSE
 19220        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19221           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19222           GO TO 4150-END-BATCH.
 19223
 19224     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19225
 19226     IF WS-BATCH-PREFIX = '#CL'
 19227         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19228         GO TO 4105-READ-NEXT.
 19229
 19230     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19231     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19232     MOVE PB-STATE               TO PI-PB-STATE.
 19233     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19234
 19235     IF PB-BATCH-TRAILER
 19236        IF SHOW-RECORD
 19237           GO TO 4150-END-BATCH
 19238        ELSE
 19239           MOVE ER-2251         TO EMI-ERROR
 19240           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19241           MOVE 1               TO PI-BROWSE-TYPE
 19242           GO TO 7200-DISPLAY-BATCHES.
 19243
 19244     IF SHOW-RECORD
 19245           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19246              GO TO 4110-BUMP-SEQ
 19247           ELSE
 19248              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19249                 GO TO 4110-BUMP-SEQ
 19250              ELSE
 19251                 GO TO 4107-CHECK-REC-TYPE.
 19252
 19253     IF NOT  PI-PRIMARY-WITH-SELECT
 19254        GO TO 4107-CHECK-REC-TYPE.
 19255
 19256     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19257        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19258           GO TO 4110-BUMP-SEQ
 19259        ELSE
 19260           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19261              GO TO 4107-CHECK-REC-TYPE
 19262           ELSE
 19263              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19264                 GO TO 4107-CHECK-REC-TYPE
 19265              ELSE
 19266                 GO TO 4110-BUMP-SEQ.
 19267
 19268     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19269        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19270           GO TO 4110-BUMP-SEQ.
 19271
 19272 4107-CHECK-REC-TYPE.
 19273     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19274         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19275             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 354
* EL6311.cbl
 19276           ELSE
 19277             GO TO 4110-BUMP-SEQ.
 19278
 19279     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19280         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19281             NEXT SENTENCE
 19282           ELSE
 19283             GO TO 4110-BUMP-SEQ.
 19284
 19285     IF NOT DISPLAY-CHANGE-RECORDS AND
 19286        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19287           GO TO 4110-BUMP-SEQ.
 19288
 19289     IF DISPLAY-HOLD-RECORDS AND
 19290        NOT PB-RECORD-ON-HOLD
 19291          GO TO 4110-BUMP-SEQ.
 19292
 19293     IF PB-ISSUE
 19294        IF DISPLAY-CHK-REQ-RECORDS
 19295            GO TO 4110-BUMP-SEQ.
 19296
 19297     IF PB-ISSUE
 19298        IF ISSUE-WITH-WARNING
 19299           IF PB-WARNING-ERRORS
 19300              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19301                  GO TO 4110-BUMP-SEQ
 19302              ELSE
 19303                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19304                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19305                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19306                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19307                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19308                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19309                 GO TO 7000-DISPLAY-ISSUES
 19310        ELSE
 19311            GO TO 4110-BUMP-SEQ.
 19312
 19313     IF PB-ISSUE
 19314        IF (ISSUES-IN-ERROR AND
 19315            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19316            ALL-ISSUES
 19317            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19318            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19319            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19320            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19321            MOVE PB-SV-STATE            TO PI-SV-STATE
 19322            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19323            GO TO 7000-DISPLAY-ISSUES
 19324        ELSE
 19325            GO TO 4110-BUMP-SEQ.
 19326
 19327     IF PB-CANCELLATION
 19328        IF DISPLAY-CHK-REQ-RECORDS
 19329           IF PB-C-REFUND-REQUESTED
 19330              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19331              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19332              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19333              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 355
* EL6311.cbl
 19334              MOVE PB-SV-STATE            TO PI-SV-STATE
 19335              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19336              GO TO 7100-DISPLAY-CANCELS
 19337           ELSE
 19338              GO TO 4110-BUMP-SEQ.
 19339
 19340     IF PB-CANCELLATION
 19341        IF CANCEL-WITH-WARNING
 19342           IF PB-WARNING-ERRORS
 19343              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19344                  GO TO 4110-BUMP-SEQ
 19345              ELSE
 19346                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19347                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19348                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19349                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19350                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19351                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19352                 GO TO 7100-DISPLAY-CANCELS
 19353           ELSE
 19354              GO TO 4110-BUMP-SEQ.
 19355
 19356     IF PB-CANCELLATION
 19357        IF (CANCEL-IN-ERROR  AND
 19358            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19359            ALL-CANCELS
 19360            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19361            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19362            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19363            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19364            MOVE PB-SV-STATE            TO PI-SV-STATE
 19365            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19366            GO TO 7100-DISPLAY-CANCELS.
 19367
 19368 4110-BUMP-SEQ.
 19369     IF NOT DISPLAY-CHANGE-RECORDS
 19370        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19371        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19372     ELSE
 19373        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19374           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19375           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19376        ELSE
 19377           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19378           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19379
 19380     GO TO 4105-READ-NEXT.
 19381
 19382 4150-END-BATCH.
 19383******************************************************************
 19384*                                                                *
 19385*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19386*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19387*         PROGRAM.                                               *
 19388*                                                                *
 19389******************************************************************
 19390
 19391     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 356
* EL6311.cbl
 19392         IF PENDING-BUS-RECS-FOUND
 19393             NEXT SENTENCE
 19394           ELSE
 19395             MOVE '9'            TO PI-BROWSE-SW
 19396             GO TO 9400-CLEAR.
 19397
 19398     IF SHOW-RECORD
 19399        MOVE ER-2253             TO EMI-ERROR
 19400     ELSE
 19401        MOVE ER-2251             TO EMI-ERROR.
 19402
 19403     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19404
 19405     IF PI-MAP-NAME = SPACES
 19406        MOVE -1                  TO BMAINTL
 19407        MOVE EL631B              TO PI-MAP-NAME
 19408        GO TO 8100-SEND-INITIAL-MAP.
 19409
 19410     IF PI-MAP-NAME = EL631B
 19411        MOVE -1                  TO BMAINTL
 19412     ELSE
 19413        IF PI-MAP-NAME = EL631C
 19414           MOVE -1               TO CMAINTL
 19415        ELSE
 19416           MOVE -1               TO DPFENTRL.
 19417
 19418     GO TO 8200-SEND-DATAONLY.
 19419
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 357
* EL6311.cbl
 19421
 19422***************************************************************
 19423*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19424*                                                             *
 19425*      1. START BROWSE WITH                                   *
 19426*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19427*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19428*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19429*                                                             *
 19430*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19431*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19432*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19433*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19434*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19435*               AND IS IT TO BE DISPLAYED.                    *
 19436*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19437*               DISPLAYED.                                    *
 19438*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19439*               DISPLAYED.                                    *
 19440*                                                             *
 19441*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19442*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19443***************************************************************
 19444
 19445 4200-BROWSE-CSR-FORWARD.
 19446
 19447     IF FIRST-TIME
 19448        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19449     ELSE
 19450        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19451
 19452
 19453* EXEC CICS HANDLE CONDITION
 19454*         NOTFND   (4250-END-RECORDS)
 19455*         ENDFILE  (4250-END-RECORDS)
 19456*    END-EXEC.
 19457*    MOVE '"$I''                  ! L #00016659' TO DFHEIV0
 19458     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19460     MOVE X'4C20233030303136363539' TO DFHEIV0(25:11)
 19461     CALL 'kxdfhei1' USING DFHEIV0
 19462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19463
 19464
 19465
 19466* EXEC CICS STARTBR
 19467*         DATASET   (FILE-ID-ERPNDB4)
 19468*         RIDFLD    (ERPNDB-CSR-KEY)
 19469*    END-EXEC.
 19470     MOVE 0
 19471       TO DFHEIV11
 19472*    MOVE '&,         G          &   #00016664' TO DFHEIV0
 19473     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19474     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19475     MOVE X'2020233030303136363634' TO DFHEIV0(25:11)
 19476     CALL 'kxdfhei1' USING DFHEIV0,
 19477           FILE-ID-ERPNDB4,
 19478           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 358
* EL6311.cbl
 19479           DFHEIV99,
 19480           DFHEIV11,
 19481           DFHEIV99
 19482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19483
 19484
 19485     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19486
 19487     IF FIRST-TIME
 19488        MOVE SPACE               TO WS-FIRST-TIME-SW
 19489        GO TO 4205-READ-NEXT-RECORD.
 19490
 19491
 19492* EXEC CICS READNEXT
 19493*         DATASET    (FILE-ID-ERPNDB4)
 19494*         SET        (ADDRESS OF PENDING-BUSINESS)
 19495*         RIDFLD     (ERPNDB-CSR-KEY)
 19496*    END-EXEC.
 19497     MOVE 0
 19498       TO DFHEIV11
 19499*    MOVE '&.S                   )   #00016675' TO DFHEIV0
 19500     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19501     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19502     MOVE X'2020233030303136363735' TO DFHEIV0(25:11)
 19503     CALL 'kxdfhei1' USING DFHEIV0,
 19504           FILE-ID-ERPNDB4,
 19505           DFHEIV20,
 19506           DFHEIV99,
 19507           ERPNDB-CSR-KEY,
 19508           DFHEIV99,
 19509           DFHEIV11,
 19510           DFHEIV99,
 19511           DFHEIV99
 19512     SET ADDRESS OF PENDING-BUSINESS TO
 19513         DFHEIV20
 19514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19515
 19516
 19517 4205-READ-NEXT-RECORD.
 19518
 19519
 19520* EXEC CICS READNEXT
 19521*         DATASET    (FILE-ID-ERPNDB4)
 19522*         SET        (ADDRESS OF PENDING-BUSINESS)
 19523*         RIDFLD     (ERPNDB-CSR-KEY)
 19524*    END-EXEC.
 19525     MOVE 0
 19526       TO DFHEIV11
 19527*    MOVE '&.S                   )   #00016683' TO DFHEIV0
 19528     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19529     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19530     MOVE X'2020233030303136363833' TO DFHEIV0(25:11)
 19531     CALL 'kxdfhei1' USING DFHEIV0,
 19532           FILE-ID-ERPNDB4,
 19533           DFHEIV20,
 19534           DFHEIV99,
 19535           ERPNDB-CSR-KEY,
 19536           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 359
* EL6311.cbl
 19537           DFHEIV11,
 19538           DFHEIV99,
 19539           DFHEIV99
 19540     SET ADDRESS OF PENDING-BUSINESS TO
 19541         DFHEIV20
 19542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19543
 19544
 19545     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19546
 19547     IF WS-BATCH-PREFIX = '#CL'
 19548        GO TO 4205-READ-NEXT-RECORD.
 19549
 19550     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19551        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19552        GO TO 4250-END-RECORDS.
 19553
 19554     IF PB-BATCH-TRAILER
 19555        GO TO 4205-READ-NEXT-RECORD.
 19556
 19557     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19558        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19559           GO TO 4205-READ-NEXT-RECORD
 19560        ELSE
 19561           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19562              GO TO 4210-CHECK-REC-TYPE
 19563           ELSE
 19564              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19565                 GO TO 4210-CHECK-REC-TYPE
 19566              ELSE
 19567                 GO TO 4205-READ-NEXT-RECORD.
 19568
 19569     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19570        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19571           GO TO 4205-READ-NEXT-RECORD.
 19572
 19573 4210-CHECK-REC-TYPE.
 19574     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19575         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19576             NEXT SENTENCE
 19577         ELSE
 19578             GO TO 4205-READ-NEXT-RECORD.
 19579
 19580     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19581         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19582             NEXT SENTENCE
 19583        ELSE
 19584             GO TO 4205-READ-NEXT-RECORD.
 19585
 19586     IF NOT DISPLAY-CHANGE-RECORDS AND
 19587            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19588        GO TO 4205-READ-NEXT-RECORD.
 19589
 19590     IF DISPLAY-HOLD-RECORDS AND
 19591        NOT PB-RECORD-ON-HOLD
 19592          GO TO 4205-READ-NEXT-RECORD.
 19593
 19594     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 360
* EL6311.cbl
 19595        IF DISPLAY-CHK-REQ-RECORDS
 19596            GO TO 4205-READ-NEXT-RECORD.
 19597
 19598     IF PB-ISSUE
 19599        IF ISSUE-WITH-WARNING
 19600           IF PB-WARNING-ERRORS
 19601              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19602                  GO TO 4205-READ-NEXT-RECORD
 19603              ELSE
 19604                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19605                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19606                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19607                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19608                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19609                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19610                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19611                 GO TO 7000-DISPLAY-ISSUES
 19612           ELSE
 19613              GO TO 4205-READ-NEXT-RECORD.
 19614
 19615     IF PB-ISSUE
 19616        IF (ISSUES-IN-ERROR AND
 19617            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19618            ALL-ISSUES
 19619            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19620            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19621            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19622            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19623            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19624            MOVE PB-SV-STATE            TO PI-SV-STATE
 19625            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19626            GO TO 7000-DISPLAY-ISSUES
 19627        ELSE
 19628            GO TO 4205-READ-NEXT-RECORD.
 19629
 19630     IF PB-CANCELLATION
 19631        IF DISPLAY-CHK-REQ-RECORDS
 19632           IF PB-C-REFUND-REQUESTED
 19633              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19634              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19635              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19636              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19637              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19638              MOVE PB-SV-STATE            TO PI-SV-STATE
 19639              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19640              GO TO 7100-DISPLAY-CANCELS
 19641           ELSE
 19642               GO TO 4205-READ-NEXT-RECORD.
 19643
 19644     IF PB-CANCELLATION
 19645        IF CANCEL-WITH-WARNING
 19646           IF PB-WARNING-ERRORS
 19647              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19648                  GO TO 4205-READ-NEXT-RECORD
 19649              ELSE
 19650                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19651                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19652                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 361
* EL6311.cbl
 19653                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19654                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19655                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19656                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19657                 GO TO 7100-DISPLAY-CANCELS
 19658           ELSE
 19659              GO TO 4205-READ-NEXT-RECORD.
 19660
 19661     IF PB-CANCELLATION
 19662        IF (CANCEL-IN-ERROR  AND
 19663            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19664            ALL-CANCELS
 19665            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19666            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19667            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19668            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19669            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19670            MOVE PB-SV-STATE            TO PI-SV-STATE
 19671            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19672            GO TO 7100-DISPLAY-CANCELS.
 19673
 19674     GO TO 4205-READ-NEXT-RECORD.
 19675
 19676 4250-END-RECORDS.
 19677******************************************************************
 19678*                                                                *
 19679*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19680*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19681*         PROGRAM.                                               *
 19682*                                                                *
 19683******************************************************************
 19684
 19685     IF BROWSE-STARTED
 19686        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19687
 19688* EXEC CICS ENDBR
 19689*            DATASET  (FILE-ID-ERPNDB4)
 19690*       END-EXEC.
 19691     MOVE 0
 19692       TO DFHEIV11
 19693*    MOVE '&2                    $   #00016831' TO DFHEIV0
 19694     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19695     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19696     MOVE X'2020233030303136383331' TO DFHEIV0(25:11)
 19697     CALL 'kxdfhei1' USING DFHEIV0,
 19698           FILE-ID-ERPNDB4,
 19699           DFHEIV11,
 19700           DFHEIV99
 19701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19702
 19703
 19704     IF  EIBTRNID NOT = TRANS-EXB1
 19705         IF PENDING-BUS-RECS-FOUND
 19706             NEXT SENTENCE
 19707           ELSE
 19708             MOVE '9'            TO PI-BROWSE-SW
 19709             GO TO 9400-CLEAR.
 19710
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 362
* EL6311.cbl
 19711     IF SHOW-RECORD
 19712        MOVE ER-2253            TO EMI-ERROR
 19713       ELSE
 19714        MOVE ER-2254            TO EMI-ERROR.
 19715
 19716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19717
 19718     IF PI-MAP-NAME = SPACES
 19719        MOVE -1                  TO DPFENTRL
 19720        MOVE EL631D               TO PI-MAP-NAME
 19721        GO TO 8100-SEND-INITIAL-MAP.
 19722
 19723     IF PI-MAP-NAME = EL631B
 19724        MOVE -1                  TO BMAINTL
 19725     ELSE
 19726        IF PI-MAP-NAME = EL631C
 19727           MOVE -1               TO CMAINTL
 19728        ELSE
 19729           MOVE -1               TO DPFENTRL.
 19730
 19731     GO TO 8200-SEND-DATAONLY.
 19732
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 363
* EL6311.cbl
 19734
 19735***************************************************************
 19736*                                                             *
 19737*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19738*                                                             *
 19739*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19740*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19741*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19742*                                                             *
 19743*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19744*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19745*          A. IS IT WITHIN THE SAME COMPANY                   *
 19746*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19747*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19748*                AND IS IT TO BE DISPLAYED.                   *
 19749*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19750*                DISPLAYED.                                   *
 19751*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19752*                DISPLAYED.                                   *
 19753*                                                             *
 19754*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19755*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19756*                                                             *
 19757*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19758*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19759*                THEY ARE NOT TO BE DISPLAYED.                *
 19760*                                                             *
 19761***************************************************************
 19762
 19763 4300-BROWSE-FILE-FORWARD.
 19764     IF FIRST-TIME OR SHOW-RECORD
 19765        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19766        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19767        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19768     ELSE
 19769        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19770        IF ERPNDB-BATCH-SEQ-NO = +9999
 19771           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19772        ELSE
 19773           IF DISPLAY-CHANGE-RECORDS
 19774              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19775           ELSE
 19776              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19777              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19778
 19779
 19780* EXEC CICS HANDLE CONDITION
 19781*         ENDFILE  (4350-END-BATCH)
 19782*         NOTFND   (4350-END-BATCH)
 19783*    END-EXEC.
 19784*    MOVE '"$''I                  ! M #00016910' TO DFHEIV0
 19785     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19786     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19787     MOVE X'4D20233030303136393130' TO DFHEIV0(25:11)
 19788     CALL 'kxdfhei1' USING DFHEIV0
 19789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19790
 19791
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 364
* EL6311.cbl
 19792 4305-READ-NEXT.
 19793     IF PI-DISPLAY-ORIGINAL-BATCH
 19794        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19795     ELSE
 19796        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19797
 19798
 19799* EXEC CICS READ
 19800*         DATASET   (FILE-ID)
 19801*         SET       (ADDRESS OF PENDING-BUSINESS)
 19802*         RIDFLD    (ERPNDB-KEY)
 19803*         GTEQ
 19804*    END-EXEC.
 19805*    MOVE '&"S        G          (   #00016921' TO DFHEIV0
 19806     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19808     MOVE X'2020233030303136393231' TO DFHEIV0(25:11)
 19809     CALL 'kxdfhei1' USING DFHEIV0,
 19810           FILE-ID,
 19811           DFHEIV20,
 19812           DFHEIV99,
 19813           ERPNDB-KEY,
 19814           DFHEIV99,
 19815           DFHEIV99,
 19816           DFHEIV99
 19817     SET ADDRESS OF PENDING-BUSINESS TO
 19818         DFHEIV20
 19819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19820
 19821
 19822     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19823        GO TO 4350-END-BATCH.
 19824
 19825     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19826                                    WS-BATCH-NO.
 19827
 19828     IF  WS-BATCH-PREFIX = '#CL'
 19829         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19830         GO TO 4305-READ-NEXT.
 19831
 19832     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19833     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19834     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19835     MOVE PB-STATE               TO PI-PB-STATE.
 19836     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19837
 19838     IF PB-BATCH-TRAILER
 19839        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19840        GO TO 4305-READ-NEXT.
 19841
 19842     IF SHOW-RECORD
 19843           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19844              GO TO 4310-BUMP-SEQ
 19845           ELSE
 19846              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19847                 GO TO 4310-BUMP-SEQ
 19848              ELSE
 19849                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 365
* EL6311.cbl
 19850
 19851     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19852        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19853           GO TO 4310-BUMP-SEQ
 19854        ELSE
 19855           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19856              GO TO 4307-CHECK-REC-TYPE
 19857           ELSE
 19858              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19859                 GO TO 4307-CHECK-REC-TYPE
 19860              ELSE
 19861                 GO TO 4310-BUMP-SEQ.
 19862
 19863     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19864        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19865           GO TO 4310-BUMP-SEQ.
 19866
 19867 4307-CHECK-REC-TYPE.
 19868     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19869         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19870             NEXT SENTENCE
 19871         ELSE
 19872             GO TO 4310-BUMP-SEQ.
 19873
 19874     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19875         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19876             NEXT SENTENCE
 19877        ELSE
 19878             GO TO 4310-BUMP-SEQ.
 19879
 19880     IF NOT DISPLAY-CHANGE-RECORDS AND
 19881            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19882        GO TO 4310-BUMP-SEQ.
 19883
 19884     IF DISPLAY-HOLD-RECORDS AND
 19885        NOT PB-RECORD-ON-HOLD
 19886          GO TO 4310-BUMP-SEQ.
 19887
 19888     IF PB-ISSUE
 19889        IF DISPLAY-CHK-REQ-RECORDS
 19890           GO TO 4310-BUMP-SEQ.
 19891
 19892     IF PB-ISSUE
 19893        IF ISSUE-WITH-WARNING
 19894           IF PB-WARNING-ERRORS
 19895              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19896                  GO TO 4310-BUMP-SEQ
 19897              ELSE
 19898                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19899                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19900                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19901                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19902                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19903                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19904                 GO TO 7000-DISPLAY-ISSUES
 19905           ELSE
 19906              GO TO 4310-BUMP-SEQ.
 19907
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 366
* EL6311.cbl
 19908     IF PB-ISSUE
 19909        IF (ISSUES-IN-ERROR AND
 19910            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19911            ALL-ISSUES
 19912            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19913            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19914            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19915            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19916            MOVE PB-SV-STATE            TO PI-SV-STATE
 19917            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19918            GO TO 7000-DISPLAY-ISSUES
 19919        ELSE
 19920            GO TO 4310-BUMP-SEQ.
 19921
 19922     IF PB-CANCELLATION
 19923        IF DISPLAY-CHK-REQ-RECORDS
 19924           IF PB-C-REFUND-REQUESTED
 19925              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19926              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19927              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19928              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19929              MOVE PB-SV-STATE            TO PI-SV-STATE
 19930              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19931              GO TO 7100-DISPLAY-CANCELS
 19932           ELSE
 19933              GO TO 4310-BUMP-SEQ.
 19934
 19935     IF PB-CANCELLATION
 19936        IF CANCEL-WITH-WARNING
 19937           IF PB-WARNING-ERRORS
 19938              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19939                  GO TO 4310-BUMP-SEQ
 19940              ELSE
 19941                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19942                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19943                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19944                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19945                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19946                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19947                 GO TO 7100-DISPLAY-CANCELS
 19948           ELSE
 19949              GO TO 4310-BUMP-SEQ.
 19950
 19951     IF PB-CANCELLATION
 19952        IF (CANCEL-IN-ERROR  AND
 19953            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19954            ALL-CANCELS
 19955            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19956            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19957            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19958            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19959            MOVE PB-SV-STATE            TO PI-SV-STATE
 19960            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19961            GO TO 7100-DISPLAY-CANCELS.
 19962
 19963 4310-BUMP-SEQ.
 19964     IF NOT DISPLAY-CHANGE-RECORDS
 19965        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 367
* EL6311.cbl
 19966        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19967     ELSE
 19968        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19969           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19970           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19971        ELSE
 19972           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19973           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19974
 19975     GO TO 4305-READ-NEXT.
 19976
 19977 4350-END-BATCH.
 19978
 19979******************************************************************
 19980*                                                                *
 19981*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19982*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19983*         PROGRAM.                                               *
 19984*                                                                *
 19985******************************************************************
 19986
 19987     IF  EIBTRNID NOT = TRANS-EXB1
 19988         IF PENDING-BUS-RECS-FOUND
 19989             NEXT SENTENCE
 19990           ELSE
 19991             MOVE '9'            TO PI-BROWSE-SW
 19992             GO TO 9400-CLEAR.
 19993
 19994     IF SHOW-RECORD
 19995        MOVE ER-2253            TO EMI-ERROR
 19996     ELSE
 19997        MOVE ER-2251            TO EMI-ERROR.
 19998
 19999     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20000
 20001     IF PI-MAP-NAME = SPACES
 20002        MOVE -1                  TO BMAINTL
 20003        MOVE EL631B               TO PI-MAP-NAME
 20004        GO TO 8100-SEND-INITIAL-MAP.
 20005
 20006     IF PI-MAP-NAME = EL631B
 20007        MOVE -1                  TO BMAINTL
 20008     ELSE
 20009        IF PI-MAP-NAME = EL631C
 20010           MOVE -1               TO CMAINTL
 20011        ELSE
 20012           MOVE -1               TO DPFENTRL.
 20013
 20014     GO TO 8200-SEND-DATAONLY.
 20015
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 368
* EL6311.cbl
 20017
 20018******************************************************************
 20019*                                                                *
 20020*        B R O W S E   D E T A I L   B A C K W A R D             *
 20021*                                                                *
 20022******************************************************************
 20023
 20024 4500-BROWSE-DETAIL-BACKWARD.
 20025
 20026     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 20027
 20028
 20029* EXEC CICS HANDLE CONDITION
 20030*         NOTFND   (4570-NOT-FOUND)
 20031*         ENDFILE  (4550-END-RECORDS)
 20032*    END-EXEC
 20033*    MOVE '"$I''                  ! N #00017134' TO DFHEIV0
 20034     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20035     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20036     MOVE X'4E20233030303137313334' TO DFHEIV0(25:11)
 20037     CALL 'kxdfhei1' USING DFHEIV0
 20038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20039
 20040
 20041* EXEC CICS STARTBR
 20042*         DATASET   (FILE-ID-ERPNDB2)
 20043*         RIDFLD    (ERPNDB-ALT-KEY)
 20044*    END-EXEC.
 20045     MOVE 0
 20046       TO DFHEIV11
 20047*    MOVE '&,         G          &   #00017139' TO DFHEIV0
 20048     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20049     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20050     MOVE X'2020233030303137313339' TO DFHEIV0(25:11)
 20051     CALL 'kxdfhei1' USING DFHEIV0,
 20052           FILE-ID-ERPNDB2,
 20053           ERPNDB-ALT-KEY,
 20054           DFHEIV99,
 20055           DFHEIV11,
 20056           DFHEIV99
 20057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20058
 20059
 20060     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20061                                    WS-FIRST-TIME-SW.
 20062
 20063 4505-READ-PREV-RECORD.
 20064
 20065* EXEC CICS READPREV
 20066*         DATASET    (FILE-ID-ERPNDB2)
 20067*         SET        (ADDRESS OF PENDING-BUSINESS)
 20068*         RIDFLD     (ERPNDB-ALT-KEY)
 20069*    END-EXEC.
 20070     MOVE 0
 20071       TO DFHEIV11
 20072*    MOVE '&0S                   )   #00017148' TO DFHEIV0
 20073     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20074     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 369
* EL6311.cbl
 20075     MOVE X'2020233030303137313438' TO DFHEIV0(25:11)
 20076     CALL 'kxdfhei1' USING DFHEIV0,
 20077           FILE-ID-ERPNDB2,
 20078           DFHEIV20,
 20079           DFHEIV99,
 20080           ERPNDB-ALT-KEY,
 20081           DFHEIV99,
 20082           DFHEIV11,
 20083           DFHEIV99,
 20084           DFHEIV99
 20085     SET ADDRESS OF PENDING-BUSINESS TO
 20086         DFHEIV20
 20087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20088
 20089
 20090     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20091
 20092     IF WS-BATCH-PREFIX = '#CL'
 20093         GO TO 4505-READ-PREV-RECORD.
 20094
 20095     IF FIRST-TIME
 20096         MOVE SPACE               TO WS-FIRST-TIME-SW
 20097         GO TO 4505-READ-PREV-RECORD.
 20098
 20099     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 20100        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 20101        PB-GROUPING      NOT = PI-PB-GROUPING OR
 20102        PB-STATE         NOT = PI-PB-STATE    OR
 20103        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 20104          GO TO 4550-END-RECORDS.
 20105
 20106
 20107     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20108
 20109     IF PB-BATCH-TRAILER
 20110        GO TO 4505-READ-PREV-RECORD.
 20111
 20112     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20113
 20114     IF  WS-BATCH-PREFIX = '#CL'
 20115         GO TO 4505-READ-PREV-RECORD.
 20116
 20117     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20118        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20119           GO TO 4505-READ-PREV-RECORD
 20120        ELSE
 20121           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20122              GO TO 4510-CHECK-REC-TYPE
 20123           ELSE
 20124              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20125                 GO TO 4510-CHECK-REC-TYPE
 20126              ELSE
 20127                 GO TO 4505-READ-PREV-RECORD.
 20128
 20129     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20130        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20131           GO TO 4505-READ-PREV-RECORD.
 20132
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 370
* EL6311.cbl
 20133 4510-CHECK-REC-TYPE.
 20134     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20135         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20136             NEXT SENTENCE
 20137         ELSE
 20138             GO TO 4505-READ-PREV-RECORD.
 20139
 20140     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20141         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20142             NEXT SENTENCE
 20143        ELSE
 20144             GO TO 4505-READ-PREV-RECORD.
 20145
 20146     IF NOT DISPLAY-CHANGE-RECORDS AND
 20147            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20148        GO TO 4505-READ-PREV-RECORD.
 20149
 20150     IF DISPLAY-HOLD-RECORDS AND
 20151        NOT PB-RECORD-ON-HOLD
 20152          GO TO 4505-READ-PREV-RECORD.
 20153
 20154     IF PB-ISSUE
 20155        IF DISPLAY-CHK-REQ-RECORDS
 20156           GO TO 4505-READ-PREV-RECORD.
 20157
 20158     IF PB-ISSUE
 20159        IF ISSUE-WITH-WARNING
 20160           IF PB-WARNING-ERRORS
 20161              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20162                  GO TO 4505-READ-PREV-RECORD
 20163              ELSE
 20164                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20165                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20166                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20167                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20168                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20169                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20170                 GO TO 7000-DISPLAY-ISSUES
 20171           ELSE
 20172              GO TO 4505-READ-PREV-RECORD.
 20173
 20174     IF PB-ISSUE
 20175        IF (ISSUES-IN-ERROR AND
 20176            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20177            ALL-ISSUES
 20178            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20179            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20180            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20181            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20182            MOVE PB-SV-STATE            TO PI-SV-STATE
 20183            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20184            GO TO 7000-DISPLAY-ISSUES
 20185        ELSE
 20186            GO TO 4505-READ-PREV-RECORD.
 20187
 20188     IF PB-CANCELLATION
 20189        IF DISPLAY-CHK-REQ-RECORDS
 20190           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 371
* EL6311.cbl
 20191              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20192              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20193              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20194              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20195              MOVE PB-SV-STATE            TO PI-SV-STATE
 20196              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20197              GO TO 7100-DISPLAY-CANCELS
 20198           ELSE
 20199              GO TO 4505-READ-PREV-RECORD.
 20200
 20201     IF PB-CANCELLATION
 20202        IF CANCEL-WITH-WARNING
 20203           IF PB-WARNING-ERRORS
 20204              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20205                  GO TO 4505-READ-PREV-RECORD
 20206              ELSE
 20207                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20208                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20209                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20210                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20211                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20212                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20213                 GO TO 7100-DISPLAY-CANCELS
 20214           ELSE
 20215              GO TO 4505-READ-PREV-RECORD.
 20216
 20217     IF PB-CANCELLATION
 20218        IF (CANCEL-IN-ERROR  AND
 20219            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20220            ALL-CANCELS
 20221            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20222            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20223            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20224            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20225            MOVE PB-SV-STATE            TO PI-SV-STATE
 20226            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20227            GO TO 7100-DISPLAY-CANCELS.
 20228
 20229     GO TO 4505-READ-PREV-RECORD.
 20230
 20231 4550-END-RECORDS.
 20232     IF PI-MAP-NAME = EL631B
 20233        MOVE -1                  TO BMAINTL
 20234     ELSE
 20235        IF PI-MAP-NAME = EL631C
 20236           MOVE -1               TO CMAINTL
 20237        ELSE
 20238           MOVE -1               TO DPFENTRL.
 20239
 20240     MOVE ER-2255               TO EMI-ERROR.
 20241     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20242     GO TO 8200-SEND-DATAONLY.
 20243
 20244 4570-NOT-FOUND.
 20245
 20246******************************************************************
 20247*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20248******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 372
* EL6311.cbl
 20249
 20250
 20251* EXEC CICS RESETBR
 20252*         DATASET    (FILE-ID-ERPNDB2)
 20253*         RIDFLD     (ERPNDB-ALT-KEY)
 20254*    END-EXEC.
 20255     MOVE 0
 20256       TO DFHEIV11
 20257*    MOVE '&4         G          &   #00017314' TO DFHEIV0
 20258     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20259     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20260     MOVE X'2020233030303137333134' TO DFHEIV0(25:11)
 20261     CALL 'kxdfhei1' USING DFHEIV0,
 20262           FILE-ID-ERPNDB2,
 20263           ERPNDB-ALT-KEY,
 20264           DFHEIV99,
 20265           DFHEIV11,
 20266           DFHEIV99
 20267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20268
 20269
 20270
 20271* EXEC CICS READNEXT
 20272*         DATASET    (FILE-ID-ERPNDB2)
 20273*         SET        (ADDRESS OF PENDING-BUSINESS)
 20274*         RIDFLD     (ERPNDB-ALT-KEY)
 20275*    END-EXEC.
 20276     MOVE 0
 20277       TO DFHEIV11
 20278*    MOVE '&.S                   )   #00017319' TO DFHEIV0
 20279     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20280     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20281     MOVE X'2020233030303137333139' TO DFHEIV0(25:11)
 20282     CALL 'kxdfhei1' USING DFHEIV0,
 20283           FILE-ID-ERPNDB2,
 20284           DFHEIV20,
 20285           DFHEIV99,
 20286           ERPNDB-ALT-KEY,
 20287           DFHEIV99,
 20288           DFHEIV11,
 20289           DFHEIV99,
 20290           DFHEIV99
 20291     SET ADDRESS OF PENDING-BUSINESS TO
 20292         DFHEIV20
 20293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20294
 20295
 20296
 20297* EXEC CICS READPREV
 20298*         DATASET    (FILE-ID-ERPNDB2)
 20299*         SET        (ADDRESS OF PENDING-BUSINESS)
 20300*         RIDFLD     (ERPNDB-ALT-KEY)
 20301*    END-EXEC.
 20302     MOVE 0
 20303       TO DFHEIV11
 20304*    MOVE '&0S                   )   #00017325' TO DFHEIV0
 20305     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20306     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 373
* EL6311.cbl
 20307     MOVE X'2020233030303137333235' TO DFHEIV0(25:11)
 20308     CALL 'kxdfhei1' USING DFHEIV0,
 20309           FILE-ID-ERPNDB2,
 20310           DFHEIV20,
 20311           DFHEIV99,
 20312           ERPNDB-ALT-KEY,
 20313           DFHEIV99,
 20314           DFHEIV11,
 20315           DFHEIV99,
 20316           DFHEIV99
 20317     SET ADDRESS OF PENDING-BUSINESS TO
 20318         DFHEIV20
 20319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20320
 20321
 20322 4580-READ-PREV-RECORD.
 20323
 20324* EXEC CICS READPREV
 20325*         DATASET    (FILE-ID-ERPNDB2)
 20326*         SET        (ADDRESS OF PENDING-BUSINESS)
 20327*         RIDFLD     (ERPNDB-ALT-KEY)
 20328*    END-EXEC.
 20329     MOVE 0
 20330       TO DFHEIV11
 20331*    MOVE '&0S                   )   #00017332' TO DFHEIV0
 20332     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20333     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20334     MOVE X'2020233030303137333332' TO DFHEIV0(25:11)
 20335     CALL 'kxdfhei1' USING DFHEIV0,
 20336           FILE-ID-ERPNDB2,
 20337           DFHEIV20,
 20338           DFHEIV99,
 20339           ERPNDB-ALT-KEY,
 20340           DFHEIV99,
 20341           DFHEIV11,
 20342           DFHEIV99,
 20343           DFHEIV99
 20344     SET ADDRESS OF PENDING-BUSINESS TO
 20345         DFHEIV20
 20346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20347
 20348
 20349     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20350
 20351     IF WS-BATCH-PREFIX = '#CL'
 20352        GO TO 4580-READ-PREV-RECORD.
 20353
 20354     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20355     GO TO 4505-READ-PREV-RECORD.
 20356
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 374
* EL6311.cbl
 20358
 20359******************************************************************
 20360*                                                                *
 20361*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20362*                                                                *
 20363******************************************************************
 20364
 20365 4600-BROWSE-PRIMARY-BACKWARD.
 20366        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20367
 20368     IF ERPNDB-BATCH-SEQ-NO = +9999
 20369        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20370
 20371        IF ERPNDB-BATCH-SEQ-NO = +0000
 20372           GO TO 4650-END-BATCH
 20373        ELSE
 20374           IF PI-MAP-NAME NOT = EL631D
 20375              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20376                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20377              ELSE
 20378                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20379                 IF DISPLAY-CHANGE-RECORDS
 20380                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20381                 ELSE
 20382                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20383
 20384
 20385* EXEC CICS HANDLE CONDITION
 20386*         NOTFND    (4680-NOT-FOUND)
 20387*         ENDFILE   (4680-NOT-FOUND)
 20388*    END-EXEC.
 20389*    MOVE '"$I''                  ! O #00017373' TO DFHEIV0
 20390     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20392     MOVE X'4F20233030303137333733' TO DFHEIV0(25:11)
 20393     CALL 'kxdfhei1' USING DFHEIV0
 20394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20395
 20396
 20397 4605-READ-NEXT.
 20398     IF ERPNDB-BATCH-SEQ-NO = +0000
 20399        GO TO 4650-END-BATCH.
 20400
 20401     IF PI-DISPLAY-ORIGINAL-BATCH
 20402        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20403     ELSE
 20404        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20405
 20406
 20407* EXEC CICS READ
 20408*         DATASET   (FILE-ID)
 20409*         SET       (ADDRESS OF PENDING-BUSINESS)
 20410*         RIDFLD    (ERPNDB-KEY)
 20411*    END-EXEC.
 20412*    MOVE '&"S        E          (   #00017387' TO DFHEIV0
 20413     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20415     MOVE X'2020233030303137333837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 375
* EL6311.cbl
 20416     CALL 'kxdfhei1' USING DFHEIV0,
 20417           FILE-ID,
 20418           DFHEIV20,
 20419           DFHEIV99,
 20420           ERPNDB-KEY,
 20421           DFHEIV99,
 20422           DFHEIV99,
 20423           DFHEIV99
 20424     SET ADDRESS OF PENDING-BUSINESS TO
 20425         DFHEIV20
 20426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20427
 20428
 20429     IF NOT  PI-PRIMARY-WITH-SELECT
 20430        GO TO 4607-CHECK-REC-TYPE.
 20431
 20432     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20433
 20434     IF  WS-BATCH-PREFIX = '#CL'
 20435         GO TO 4610-BUMP-SEQ.
 20436
 20437     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20438        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20439           GO TO 4610-BUMP-SEQ
 20440        ELSE
 20441           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20442              GO TO 4607-CHECK-REC-TYPE
 20443           ELSE
 20444              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20445                 GO TO 4607-CHECK-REC-TYPE
 20446              ELSE
 20447                 GO TO 4610-BUMP-SEQ.
 20448
 20449     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20450        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20451           GO TO 4610-BUMP-SEQ.
 20452
 20453 4607-CHECK-REC-TYPE.
 20454     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20455         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20456             NEXT SENTENCE
 20457         ELSE
 20458             GO TO 4610-BUMP-SEQ.
 20459
 20460     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20461         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20462             NEXT SENTENCE
 20463        ELSE
 20464             GO TO 4610-BUMP-SEQ.
 20465
 20466     IF NOT DISPLAY-CHANGE-RECORDS AND
 20467            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20468        GO TO 4610-BUMP-SEQ.
 20469
 20470     IF DISPLAY-HOLD-RECORDS AND
 20471        NOT PB-RECORD-ON-HOLD
 20472          GO TO 4610-BUMP-SEQ.
 20473
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 376
* EL6311.cbl
 20474     IF PB-ISSUE
 20475        IF DISPLAY-CHK-REQ-RECORDS
 20476           GO TO 4610-BUMP-SEQ.
 20477
 20478     IF PB-ISSUE
 20479        IF ISSUE-WITH-WARNING
 20480           IF PB-WARNING-ERRORS
 20481              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20482                  GO TO 4610-BUMP-SEQ
 20483              ELSE
 20484                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20485                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20486                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20487                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20488                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20489                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20490                 GO TO 7000-DISPLAY-ISSUES
 20491           ELSE
 20492              GO TO 4610-BUMP-SEQ.
 20493
 20494     IF PB-ISSUE
 20495        IF (ISSUES-IN-ERROR AND
 20496            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20497            ALL-ISSUES
 20498            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20499            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20500            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20501            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20502            MOVE PB-SV-STATE            TO PI-SV-STATE
 20503            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20504            GO TO 7000-DISPLAY-ISSUES
 20505        ELSE
 20506            GO TO 4610-BUMP-SEQ.
 20507
 20508     IF PB-CANCELLATION
 20509        IF DISPLAY-CHK-REQ-RECORDS
 20510           IF PB-C-REFUND-REQUESTED
 20511              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20512              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20513              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20514              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20515              MOVE PB-SV-STATE            TO PI-SV-STATE
 20516              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20517              GO TO 7100-DISPLAY-CANCELS
 20518           ELSE
 20519              GO TO 4610-BUMP-SEQ.
 20520
 20521     IF PB-CANCELLATION
 20522        IF CANCEL-WITH-WARNING
 20523           IF PB-WARNING-ERRORS
 20524              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20525                  GO TO 4610-BUMP-SEQ
 20526              ELSE
 20527                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20528                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20529                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20530                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20531                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 377
* EL6311.cbl
 20532                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20533                 GO TO 7100-DISPLAY-CANCELS
 20534           ELSE
 20535              GO TO 4610-BUMP-SEQ.
 20536
 20537     IF PB-CANCELLATION
 20538        IF (CANCEL-IN-ERROR  AND
 20539            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20540            ALL-CANCELS
 20541            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20542            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20543            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20544            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20545            MOVE PB-SV-STATE            TO PI-SV-STATE
 20546            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20547            GO TO 7100-DISPLAY-CANCELS.
 20548
 20549 4610-BUMP-SEQ.
 20550     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20551        GO TO 4650-END-BATCH.
 20552
 20553     IF DISPLAY-CHANGE-RECORDS
 20554        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20555           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20556        ELSE
 20557           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20558           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20559        ELSE
 20560           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20561           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20562
 20563        GO TO 4605-READ-NEXT.
 20564
 20565 4650-END-BATCH.
 20566     IF PI-MAP-NAME = EL631B
 20567        MOVE -1                  TO BMAINTL
 20568     ELSE
 20569        IF PI-MAP-NAME = EL631C
 20570           MOVE -1               TO CMAINTL
 20571        ELSE
 20572           MOVE -1               TO DPFENTRL.
 20573
 20574     MOVE ER-2252               TO EMI-ERROR.
 20575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20576     GO TO 8200-SEND-DATAONLY.
 20577
 20578 4680-NOT-FOUND.
 20579     IF DISPLAY-CHANGE-RECORDS
 20580        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20581           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20582        ELSE
 20583           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20584           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20585     ELSE
 20586        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20587
 20588     GO TO 4605-READ-NEXT.
 20589
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 378
* EL6311.cbl
 20591
 20592******************************************************************
 20593*                                                                *
 20594*        B R O W S E   F I L E   B A C K W A R D S               *
 20595*                                                                *
 20596******************************************************************
 20597
 20598 4800-BROWSE-FILE-BACKWARD.
 20599
 20600* EXEC CICS HANDLE CONDITION
 20601*         NOTFND   (4860-NOT-FOUND)
 20602*         ENDFILE  (4850-END-RECORDS)
 20603*    END-EXEC.
 20604*    MOVE '"$I''                  ! P #00017563' TO DFHEIV0
 20605     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20607     MOVE X'5020233030303137353633' TO DFHEIV0(25:11)
 20608     CALL 'kxdfhei1' USING DFHEIV0
 20609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20610
 20611
 20612     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20613
 20614     IF PI-DISPLAY-ORIGINAL-BATCH
 20615        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20616     ELSE
 20617        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20618
 20619
 20620* EXEC CICS STARTBR
 20621*         DATASET   (FILE-ID)
 20622*         RIDFLD    (ERPNDB-KEY)
 20623*    END-EXEC.
 20624     MOVE 0
 20625       TO DFHEIV11
 20626*    MOVE '&,         G          &   #00017575' TO DFHEIV0
 20627     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20628     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20629     MOVE X'2020233030303137353735' TO DFHEIV0(25:11)
 20630     CALL 'kxdfhei1' USING DFHEIV0,
 20631           FILE-ID,
 20632           ERPNDB-KEY,
 20633           DFHEIV99,
 20634           DFHEIV11,
 20635           DFHEIV99
 20636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20637
 20638
 20639     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20640
 20641
 20642* EXEC CICS READPREV
 20643*         DATASET    (FILE-ID-ERPNDB)
 20644*         SET        (ADDRESS OF PENDING-BUSINESS)
 20645*         RIDFLD     (ERPNDB-KEY)
 20646*    END-EXEC.
 20647     MOVE 0
 20648       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 379
* EL6311.cbl
 20649*    MOVE '&0S                   )   #00017582' TO DFHEIV0
 20650     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20651     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20652     MOVE X'2020233030303137353832' TO DFHEIV0(25:11)
 20653     CALL 'kxdfhei1' USING DFHEIV0,
 20654           FILE-ID-ERPNDB,
 20655           DFHEIV20,
 20656           DFHEIV99,
 20657           ERPNDB-KEY,
 20658           DFHEIV99,
 20659           DFHEIV11,
 20660           DFHEIV99,
 20661           DFHEIV99
 20662     SET ADDRESS OF PENDING-BUSINESS TO
 20663         DFHEIV20
 20664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20665
 20666
 20667 4810-READ-PREV-RECORD.
 20668
 20669* EXEC CICS READPREV
 20670*         DATASET    (FILE-ID-ERPNDB)
 20671*         SET        (ADDRESS OF PENDING-BUSINESS)
 20672*         RIDFLD     (ERPNDB-KEY)
 20673*    END-EXEC.
 20674     MOVE 0
 20675       TO DFHEIV11
 20676*    MOVE '&0S                   )   #00017589' TO DFHEIV0
 20677     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20678     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20679     MOVE X'2020233030303137353839' TO DFHEIV0(25:11)
 20680     CALL 'kxdfhei1' USING DFHEIV0,
 20681           FILE-ID-ERPNDB,
 20682           DFHEIV20,
 20683           DFHEIV99,
 20684           ERPNDB-KEY,
 20685           DFHEIV99,
 20686           DFHEIV11,
 20687           DFHEIV99,
 20688           DFHEIV99
 20689     SET ADDRESS OF PENDING-BUSINESS TO
 20690         DFHEIV20
 20691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20692
 20693
 20694     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20695        GO TO 4850-END-RECORDS.
 20696
 20697     IF PB-BATCH-TRAILER
 20698        GO TO 4810-READ-PREV-RECORD.
 20699
 20700     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20701
 20702     IF  WS-BATCH-PREFIX = '#CL'
 20703         GO TO 4810-READ-PREV-RECORD.
 20704
 20705     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20706        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 380
* EL6311.cbl
 20707           GO TO 4810-READ-PREV-RECORD
 20708        ELSE
 20709           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20710              GO TO 4820-CHECK-REC-TYPE
 20711           ELSE
 20712              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20713                 GO TO 4820-CHECK-REC-TYPE
 20714              ELSE
 20715                 GO TO 4810-READ-PREV-RECORD.
 20716
 20717     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20718        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20719           GO TO 4810-READ-PREV-RECORD.
 20720
 20721 4820-CHECK-REC-TYPE.
 20722     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20723         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20724             NEXT SENTENCE
 20725         ELSE
 20726             GO TO 4810-READ-PREV-RECORD.
 20727
 20728     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20729         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20730             NEXT SENTENCE
 20731        ELSE
 20732             GO TO 4810-READ-PREV-RECORD.
 20733
 20734     IF NOT DISPLAY-CHANGE-RECORDS AND
 20735            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20736        GO TO 4810-READ-PREV-RECORD.
 20737
 20738     IF DISPLAY-HOLD-RECORDS AND
 20739        NOT PB-RECORD-ON-HOLD
 20740          GO TO 4810-READ-PREV-RECORD.
 20741
 20742     IF PB-ISSUE
 20743        IF DISPLAY-CHK-REQ-RECORDS
 20744           GO TO 4810-READ-PREV-RECORD.
 20745
 20746     IF PB-ISSUE
 20747        IF ISSUE-WITH-WARNING
 20748           IF PB-WARNING-ERRORS
 20749              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20750                  GO TO 4810-READ-PREV-RECORD
 20751              ELSE
 20752                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20753                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20754                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20755                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20756                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20757                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20758                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20759                 GO TO 7000-DISPLAY-ISSUES
 20760           ELSE
 20761              GO TO 4810-READ-PREV-RECORD.
 20762
 20763     IF PB-ISSUE
 20764        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 381
* EL6311.cbl
 20765            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20766            ALL-ISSUES
 20767            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20768            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20769            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20770            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20771            MOVE PB-SV-STATE            TO PI-SV-STATE
 20772            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20773            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20774            GO TO 7000-DISPLAY-ISSUES
 20775        ELSE
 20776            GO TO 4810-READ-PREV-RECORD.
 20777
 20778     IF PB-CANCELLATION
 20779        IF DISPLAY-CHK-REQ-RECORDS
 20780           IF PB-C-REFUND-REQUESTED
 20781              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20782              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20783              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20784              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20785              MOVE PB-SV-STATE            TO PI-SV-STATE
 20786              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20787              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20788              GO TO 7100-DISPLAY-CANCELS
 20789           ELSE
 20790              GO TO 4810-READ-PREV-RECORD.
 20791
 20792     IF PB-CANCELLATION
 20793        IF CANCEL-WITH-WARNING
 20794           IF PB-WARNING-ERRORS
 20795              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20796                  GO TO 4810-READ-PREV-RECORD
 20797              ELSE
 20798                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20799                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20800                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20801                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20802                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20803                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20804                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20805                 GO TO 7100-DISPLAY-CANCELS
 20806           ELSE
 20807              GO TO 4810-READ-PREV-RECORD.
 20808
 20809     IF PB-CANCELLATION
 20810        IF (CANCEL-IN-ERROR  AND
 20811            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20812            ALL-CANCELS
 20813            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20814            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20815            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20816            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20817            MOVE PB-SV-STATE            TO PI-SV-STATE
 20818            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20819            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20820            GO TO 7100-DISPLAY-CANCELS.
 20821
 20822     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 382
* EL6311.cbl
 20823
 20824 4850-END-RECORDS.
 20825     MOVE ER-2252                TO EMI-ERROR.
 20826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20827
 20828     IF PI-MAP-NAME = EL631B
 20829        MOVE -1                  TO BPFENTRL
 20830     ELSE
 20831        MOVE -1                  TO CPFENTRL.
 20832
 20833     GO TO 8200-SEND-DATAONLY.
 20834
 20835 4860-NOT-FOUND.
 20836
 20837******************************************************************
 20838*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20839******************************************************************
 20840
 20841
 20842* EXEC CICS RESETBR
 20843*         DATASET    (FILE-ID-ERPNDB)
 20844*         RIDFLD     (ERPNDB-KEY)
 20845*     END-EXEC.
 20846     MOVE 0
 20847       TO DFHEIV11
 20848*    MOVE '&4         G          &   #00017742' TO DFHEIV0
 20849     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20850     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20851     MOVE X'2020233030303137373432' TO DFHEIV0(25:11)
 20852     CALL 'kxdfhei1' USING DFHEIV0,
 20853           FILE-ID-ERPNDB,
 20854           ERPNDB-KEY,
 20855           DFHEIV99,
 20856           DFHEIV11,
 20857           DFHEIV99
 20858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20859
 20860
 20861
 20862* EXEC CICS READNEXT
 20863*         DATASET    (FILE-ID-ERPNDB)
 20864*         SET        (ADDRESS OF PENDING-BUSINESS)
 20865*         RIDFLD     (ERPNDB-KEY)
 20866*    END-EXEC.
 20867     MOVE 0
 20868       TO DFHEIV11
 20869*    MOVE '&.S                   )   #00017747' TO DFHEIV0
 20870     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20871     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20872     MOVE X'2020233030303137373437' TO DFHEIV0(25:11)
 20873     CALL 'kxdfhei1' USING DFHEIV0,
 20874           FILE-ID-ERPNDB,
 20875           DFHEIV20,
 20876           DFHEIV99,
 20877           ERPNDB-KEY,
 20878           DFHEIV99,
 20879           DFHEIV11,
 20880           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 383
* EL6311.cbl
 20881           DFHEIV99
 20882     SET ADDRESS OF PENDING-BUSINESS TO
 20883         DFHEIV20
 20884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20885
 20886
 20887
 20888* EXEC CICS READPREV
 20889*         DATASET    (FILE-ID-ERPNDB)
 20890*         SET        (ADDRESS OF PENDING-BUSINESS)
 20891*         RIDFLD     (ERPNDB-KEY)
 20892*    END-EXEC.
 20893     MOVE 0
 20894       TO DFHEIV11
 20895*    MOVE '&0S                   )   #00017753' TO DFHEIV0
 20896     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20897     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20898     MOVE X'2020233030303137373533' TO DFHEIV0(25:11)
 20899     CALL 'kxdfhei1' USING DFHEIV0,
 20900           FILE-ID-ERPNDB,
 20901           DFHEIV20,
 20902           DFHEIV99,
 20903           ERPNDB-KEY,
 20904           DFHEIV99,
 20905           DFHEIV11,
 20906           DFHEIV99,
 20907           DFHEIV99
 20908     SET ADDRESS OF PENDING-BUSINESS TO
 20909         DFHEIV20
 20910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20911
 20912
 20913     GO TO 4810-READ-PREV-RECORD.
 20914
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 384
* EL6311.cbl
 20916
 20917******************************************************************
 20918*                                                                *
 20919*           B R O W S E   C S R   B A C K W A R D                *
 20920*                                                                *
 20921******************************************************************
 20922
 20923 4900-BROWSE-CSR-BACKWARD.
 20924
 20925     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20926
 20927
 20928* EXEC CICS HANDLE CONDITION
 20929*         NOTFND   (4970-NOT-FOUND)
 20930*         ENDFILE  (4950-END-RECORDS)
 20931*    END-EXEC
 20932*    MOVE '"$I''                  ! Q #00017773' TO DFHEIV0
 20933     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20935     MOVE X'5120233030303137373733' TO DFHEIV0(25:11)
 20936     CALL 'kxdfhei1' USING DFHEIV0
 20937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20938
 20939
 20940* EXEC CICS STARTBR
 20941*         DATASET   (FILE-ID-ERPNDB4)
 20942*         RIDFLD    (ERPNDB-CSR-KEY)
 20943*    END-EXEC.
 20944     MOVE 0
 20945       TO DFHEIV11
 20946*    MOVE '&,         G          &   #00017778' TO DFHEIV0
 20947     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20948     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20949     MOVE X'2020233030303137373738' TO DFHEIV0(25:11)
 20950     CALL 'kxdfhei1' USING DFHEIV0,
 20951           FILE-ID-ERPNDB4,
 20952           ERPNDB-CSR-KEY,
 20953           DFHEIV99,
 20954           DFHEIV11,
 20955           DFHEIV99
 20956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20957
 20958
 20959     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20960                                    WS-FIRST-TIME-SW.
 20961
 20962 4905-READ-PREV-RECORD.
 20963
 20964* EXEC CICS READPREV
 20965*         DATASET    (FILE-ID-ERPNDB4)
 20966*         SET        (ADDRESS OF PENDING-BUSINESS)
 20967*         RIDFLD     (ERPNDB-CSR-KEY)
 20968*    END-EXEC.
 20969     MOVE 0
 20970       TO DFHEIV11
 20971*    MOVE '&0S                   )   #00017787' TO DFHEIV0
 20972     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20973     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 385
* EL6311.cbl
 20974     MOVE X'2020233030303137373837' TO DFHEIV0(25:11)
 20975     CALL 'kxdfhei1' USING DFHEIV0,
 20976           FILE-ID-ERPNDB4,
 20977           DFHEIV20,
 20978           DFHEIV99,
 20979           ERPNDB-CSR-KEY,
 20980           DFHEIV99,
 20981           DFHEIV11,
 20982           DFHEIV99,
 20983           DFHEIV99
 20984     SET ADDRESS OF PENDING-BUSINESS TO
 20985         DFHEIV20
 20986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20987
 20988
 20989     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20990
 20991     IF WS-BATCH-PREFIX = '#CL'
 20992         GO TO 4905-READ-PREV-RECORD.
 20993
 20994     IF FIRST-TIME
 20995         MOVE SPACE               TO WS-FIRST-TIME-SW
 20996         GO TO 4905-READ-PREV-RECORD.
 20997
 20998     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20999        PB-CSR-ID           NOT = PI-PB-CSR-ID
 21000        GO TO 4950-END-RECORDS.
 21001
 21002     IF PB-BATCH-TRAILER
 21003        GO TO 4905-READ-PREV-RECORD.
 21004
 21005     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21006
 21007     IF  WS-BATCH-PREFIX = '#CL'
 21008         GO TO 4905-READ-PREV-RECORD.
 21009
 21010     IF PI-PB-CERT-NO NOT = LOW-VALUES
 21011        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 21012           GO TO 4905-READ-PREV-RECORD
 21013        ELSE
 21014           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 21015              GO TO 4910-CHECK-REC-TYPE
 21016           ELSE
 21017              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 21018                 GO TO 4910-CHECK-REC-TYPE
 21019              ELSE
 21020                 GO TO 4905-READ-PREV-RECORD.
 21021
 21022     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 21023        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 21024           GO TO 4905-READ-PREV-RECORD.
 21025
 21026 4910-CHECK-REC-TYPE.
 21027     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21028         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21029             NEXT SENTENCE
 21030         ELSE
 21031             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 386
* EL6311.cbl
 21032
 21033     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21034         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21035             NEXT SENTENCE
 21036        ELSE
 21037             GO TO 4905-READ-PREV-RECORD.
 21038
 21039     IF NOT DISPLAY-CHANGE-RECORDS AND
 21040            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21041        GO TO 4905-READ-PREV-RECORD.
 21042
 21043     IF DISPLAY-HOLD-RECORDS AND
 21044        NOT PB-RECORD-ON-HOLD
 21045          GO TO 4905-READ-PREV-RECORD.
 21046
 21047     IF PB-ISSUE
 21048        IF DISPLAY-CHK-REQ-RECORDS
 21049           GO TO 4905-READ-PREV-RECORD.
 21050
 21051     IF PB-ISSUE
 21052        IF ISSUE-WITH-WARNING
 21053           IF PB-WARNING-ERRORS
 21054              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21055                  GO TO 4505-READ-PREV-RECORD
 21056              ELSE
 21057                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21058                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21059                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21060                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21061                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21062                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21063                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21064                 GO TO 7000-DISPLAY-ISSUES
 21065           ELSE
 21066              GO TO 4905-READ-PREV-RECORD.
 21067
 21068     IF PB-ISSUE
 21069        IF (ISSUES-IN-ERROR AND
 21070            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21071            ALL-ISSUES
 21072            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21073            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21074            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21075            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21076            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21077            MOVE PB-SV-STATE            TO PI-SV-STATE
 21078            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21079            GO TO 7000-DISPLAY-ISSUES
 21080        ELSE
 21081            GO TO 4905-READ-PREV-RECORD.
 21082
 21083     IF PB-CANCELLATION
 21084        IF DISPLAY-CHK-REQ-RECORDS
 21085           IF PB-C-REFUND-REQUESTED
 21086              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21087              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21088              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21089              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 387
* EL6311.cbl
 21090              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21091              MOVE PB-SV-STATE            TO PI-SV-STATE
 21092              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21093              GO TO 7100-DISPLAY-CANCELS
 21094           ELSE
 21095              GO TO 4905-READ-PREV-RECORD.
 21096
 21097     IF PB-CANCELLATION
 21098        IF CANCEL-WITH-WARNING
 21099           IF PB-WARNING-ERRORS
 21100              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21101                  GO TO 4505-READ-PREV-RECORD
 21102              ELSE
 21103                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21104                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21105                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21106                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21107                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21108                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21109                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21110                 GO TO 7100-DISPLAY-CANCELS
 21111           ELSE
 21112              GO TO 4905-READ-PREV-RECORD.
 21113
 21114     IF PB-CANCELLATION
 21115        IF (CANCEL-IN-ERROR  AND
 21116            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21117            ALL-CANCELS
 21118            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21119            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21120            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21121            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21122            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21123            MOVE PB-SV-STATE            TO PI-SV-STATE
 21124            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21125            GO TO 7100-DISPLAY-CANCELS.
 21126
 21127     GO TO 4905-READ-PREV-RECORD.
 21128
 21129 4950-END-RECORDS.
 21130     IF PI-MAP-NAME = EL631B
 21131        MOVE -1                  TO BMAINTL
 21132     ELSE
 21133        IF PI-MAP-NAME = EL631C
 21134           MOVE -1               TO CMAINTL
 21135        ELSE
 21136           MOVE -1               TO DPFENTRL.
 21137
 21138     MOVE ER-2255               TO EMI-ERROR.
 21139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21140     GO TO 8200-SEND-DATAONLY.
 21141
 21142 4970-NOT-FOUND.
 21143
 21144******************************************************************
 21145*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 21146******************************************************************
 21147
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 388
* EL6311.cbl
 21148
 21149* EXEC CICS RESETBR
 21150*         DATASET    (FILE-ID-ERPNDB4)
 21151*         RIDFLD     (ERPNDB-CSR-KEY)
 21152*    END-EXEC.
 21153     MOVE 0
 21154       TO DFHEIV11
 21155*    MOVE '&4         G          &   #00017952' TO DFHEIV0
 21156     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21157     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21158     MOVE X'2020233030303137393532' TO DFHEIV0(25:11)
 21159     CALL 'kxdfhei1' USING DFHEIV0,
 21160           FILE-ID-ERPNDB4,
 21161           ERPNDB-CSR-KEY,
 21162           DFHEIV99,
 21163           DFHEIV11,
 21164           DFHEIV99
 21165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21166
 21167
 21168
 21169* EXEC CICS READNEXT
 21170*         DATASET    (FILE-ID-ERPNDB4)
 21171*         SET        (ADDRESS OF PENDING-BUSINESS)
 21172*         RIDFLD     (ERPNDB-CSR-KEY)
 21173*    END-EXEC.
 21174     MOVE 0
 21175       TO DFHEIV11
 21176*    MOVE '&.S                   )   #00017957' TO DFHEIV0
 21177     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21178     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21179     MOVE X'2020233030303137393537' TO DFHEIV0(25:11)
 21180     CALL 'kxdfhei1' USING DFHEIV0,
 21181           FILE-ID-ERPNDB4,
 21182           DFHEIV20,
 21183           DFHEIV99,
 21184           ERPNDB-CSR-KEY,
 21185           DFHEIV99,
 21186           DFHEIV11,
 21187           DFHEIV99,
 21188           DFHEIV99
 21189     SET ADDRESS OF PENDING-BUSINESS TO
 21190         DFHEIV20
 21191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21192
 21193
 21194
 21195* EXEC CICS READPREV
 21196*         DATASET    (FILE-ID-ERPNDB4)
 21197*         SET        (ADDRESS OF PENDING-BUSINESS)
 21198*         RIDFLD     (ERPNDB-CSR-KEY)
 21199*    END-EXEC.
 21200     MOVE 0
 21201       TO DFHEIV11
 21202*    MOVE '&0S                   )   #00017963' TO DFHEIV0
 21203     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21204     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21205     MOVE X'2020233030303137393633' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 389
* EL6311.cbl
 21206     CALL 'kxdfhei1' USING DFHEIV0,
 21207           FILE-ID-ERPNDB4,
 21208           DFHEIV20,
 21209           DFHEIV99,
 21210           ERPNDB-CSR-KEY,
 21211           DFHEIV99,
 21212           DFHEIV11,
 21213           DFHEIV99,
 21214           DFHEIV99
 21215     SET ADDRESS OF PENDING-BUSINESS TO
 21216         DFHEIV20
 21217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21218
 21219
 21220 4980-READ-PREV-RECORD.
 21221
 21222* EXEC CICS READPREV
 21223*         DATASET    (FILE-ID-ERPNDB4)
 21224*         SET        (ADDRESS OF PENDING-BUSINESS)
 21225*         RIDFLD     (ERPNDB-CSR-KEY)
 21226*    END-EXEC.
 21227     MOVE 0
 21228       TO DFHEIV11
 21229*    MOVE '&0S                   )   #00017970' TO DFHEIV0
 21230     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21231     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21232     MOVE X'2020233030303137393730' TO DFHEIV0(25:11)
 21233     CALL 'kxdfhei1' USING DFHEIV0,
 21234           FILE-ID-ERPNDB4,
 21235           DFHEIV20,
 21236           DFHEIV99,
 21237           ERPNDB-CSR-KEY,
 21238           DFHEIV99,
 21239           DFHEIV11,
 21240           DFHEIV99,
 21241           DFHEIV99
 21242     SET ADDRESS OF PENDING-BUSINESS TO
 21243         DFHEIV20
 21244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21245
 21246
 21247     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21248
 21249     IF WS-BATCH-PREFIX = '#CL'
 21250        GO TO 4980-READ-PREV-RECORD.
 21251
 21252     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21253     GO TO 4905-READ-PREV-RECORD.
 21254
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 390
* EL6311.cbl
 21256
 21257
 21258******************************************************************
 21259*                                                                *
 21260*        B R O W S E   B A T C H   H E A D E R S                 *
 21261*                                                                *
 21262******************************************************************
 21263
 21264 5000-BROWSE-BATCH-HEADERS.
 21265
 21266     IF EIBTRNID NOT = TRANS-EXB1
 21267        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21268        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21269        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21270        GO TO 5010-READ-NEXT-RECORD.
 21271
 21272     IF EIBAID = DFHPF4
 21273        MOVE '0'                TO PI-EDIT-SW
 21274        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21275        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21276        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21277        GO TO 5010-READ-NEXT-RECORD.
 21278
 21279     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21280     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21281     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21282
 21283
 21284* EXEC CICS HANDLE CONDITION
 21285*         ENDFILE  (5050-NOT-FOUND)
 21286*    END-EXEC.
 21287*    MOVE '"$''                   ! R #00018012' TO DFHEIV0
 21288     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21290     MOVE X'5220233030303138303132' TO DFHEIV0(25:11)
 21291     CALL 'kxdfhei1' USING DFHEIV0
 21292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21293
 21294
 21295 5010-READ-NEXT-RECORD.
 21296
 21297* EXEC CICS HANDLE CONDITION
 21298*         NOTFND    (5050-NOT-FOUND)
 21299*    END-EXEC.
 21300*    MOVE '"$I                   ! S #00018017' TO DFHEIV0
 21301     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21302     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21303     MOVE X'5320233030303138303137' TO DFHEIV0(25:11)
 21304     CALL 'kxdfhei1' USING DFHEIV0
 21305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21306
 21307
 21308
 21309* EXEC CICS READ
 21310*         DATASET   (FILE-ID-ERPNDB)
 21311*         SET       (ADDRESS OF PENDING-BUSINESS)
 21312*         RIDFLD    (ERPNDB-KEY)
 21313*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 391
* EL6311.cbl
 21314*    END-EXEC.
 21315*    MOVE '&"S        G          (   #00018021' TO DFHEIV0
 21316     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21318     MOVE X'2020233030303138303231' TO DFHEIV0(25:11)
 21319     CALL 'kxdfhei1' USING DFHEIV0,
 21320           FILE-ID-ERPNDB,
 21321           DFHEIV20,
 21322           DFHEIV99,
 21323           ERPNDB-KEY,
 21324           DFHEIV99,
 21325           DFHEIV99,
 21326           DFHEIV99
 21327     SET ADDRESS OF PENDING-BUSINESS TO
 21328         DFHEIV20
 21329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21330
 21331
 21332     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21333         GO TO 5050-NOT-FOUND.
 21334
 21335     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21336
 21337     IF WS-BATCH-PREFIX = '#CL'
 21338         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21339         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21340         GO TO 5010-READ-NEXT-RECORD.
 21341
 21342     IF NOT PB-BATCH-TRAILER
 21343         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21344         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21345         GO TO 5010-READ-NEXT-RECORD.
 21346
 21347     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21348         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21349             NEXT SENTENCE
 21350         ELSE
 21351             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21352             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21353             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21354             GO TO 5010-READ-NEXT-RECORD.
 21355
 21356     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21357         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21358             NEXT SENTENCE
 21359        ELSE
 21360             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21361             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21362             GO TO 5010-READ-NEXT-RECORD.
 21363
 21364     IF EIBAID = DFHPF4
 21365        MOVE '0'                TO PI-EDIT-SW
 21366        GO TO 7200-DISPLAY-BATCHES.
 21367
 21368     IF PI-CSR-BROWSE
 21369        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21370           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21371           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 392
* EL6311.cbl
 21372           GO TO 5010-READ-NEXT-RECORD.
 21373
 21374     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21375       IF PI-PB-CARRIER    = SPACES AND
 21376          PI-PB-GROUPING   = SPACES AND
 21377          PI-PB-STATE      = SPACES AND
 21378          PI-PB-ACCOUNT    = SPACES
 21379            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21380            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21381            GO TO 7200-DISPLAY-BATCHES
 21382         ELSE
 21383           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21384              PI-PB-GROUPING   = PB-GROUPING AND
 21385              PI-PB-STATE      = PB-STATE    AND
 21386              PI-PB-ACCOUNT    = PB-ACCOUNT
 21387              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21388              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21389              GO TO 7200-DISPLAY-BATCHES.
 21390
 21391     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21392     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21393
 21394
 21395* EXEC CICS HANDLE CONDITION
 21396*         NOTFND    (5050-NOT-FOUND)
 21397*    END-EXEC.
 21398*    MOVE '"$I                   ! T #00018090' TO DFHEIV0
 21399     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21401     MOVE X'5420233030303138303930' TO DFHEIV0(25:11)
 21402     CALL 'kxdfhei1' USING DFHEIV0
 21403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21404
 21405
 21406
 21407* EXEC CICS READ
 21408*         DATASET   (FILE-ID-ERPNDB)
 21409*         SET       (ADDRESS OF PENDING-BUSINESS)
 21410*         RIDFLD    (ERPNDB-KEY)
 21411*         GTEQ
 21412*    END-EXEC.
 21413*    MOVE '&"S        G          (   #00018094' TO DFHEIV0
 21414     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21416     MOVE X'2020233030303138303934' TO DFHEIV0(25:11)
 21417     CALL 'kxdfhei1' USING DFHEIV0,
 21418           FILE-ID-ERPNDB,
 21419           DFHEIV20,
 21420           DFHEIV99,
 21421           ERPNDB-KEY,
 21422           DFHEIV99,
 21423           DFHEIV99,
 21424           DFHEIV99
 21425     SET ADDRESS OF PENDING-BUSINESS TO
 21426         DFHEIV20
 21427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21428
 21429
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 393
* EL6311.cbl
 21430     GO TO 5010-READ-NEXT-RECORD.
 21431
 21432 5050-NOT-FOUND.
 21433
 21434******************************************************************
 21435*                                                                *
 21436*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21437*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21438*         PROGRAM.                                               *
 21439*                                                                *
 21440******************************************************************
 21441
 21442     IF EIBTRNID NOT = TRANS-EXB1
 21443        IF PENDING-BUS-RECS-FOUND
 21444            NEXT SENTENCE
 21445          ELSE
 21446            MOVE '9'            TO PI-BROWSE-SW
 21447            GO TO 9400-CLEAR.
 21448
 21449     MOVE ER-2256                TO EMI-ERROR.
 21450     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21451
 21452     IF PI-MAP-NAME = SPACES
 21453        MOVE EL631D              TO PI-MAP-NAME
 21454        MOVE -1                  TO DPFENTRL
 21455        GO TO 8100-SEND-INITIAL-MAP.
 21456
 21457     IF PI-MAP-NAME = EL631B
 21458        MOVE -1                  TO BMAINTL
 21459     ELSE
 21460        IF PI-MAP-NAME = EL631C
 21461           MOVE -1               TO CMAINTL
 21462        ELSE
 21463           MOVE -1               TO DPFENTRL
 21464           GO TO 8200-SEND-DATAONLY.
 21465
 21466     GO TO 8100-SEND-INITIAL-MAP.
 21467
 21468     .
 21469 5100-PROCESS-POL-RESC.
 21470     MOVE ZEROS                  TO CG-LF-BENCD
 21471                                    CG-AH-BENCD
 21472                                    CG-LF-CAN-AMT
 21473                                    CG-AH-CAN-AMT
 21474     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21475                                    CG-AH-CAN-DT
 21476     MOVE SPACES                 TO CG-BATCH-NO
 21477     MOVE '4'                    TO CG-OPTION-CODE
 21478     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21479     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21480     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21481     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21482     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21483     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21484     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21485     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21486     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21487     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 394
* EL6311.cbl
 21488     MOVE PI-PREV-ALT-KEY (1:33)
 21489                                 TO CG-CERT-KEY
 21490     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21491     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21492                                    CG-AH-CAN-AMT
 21493     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21494                                    CG-AH-CAN-DT
 21495     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21496     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21497      display 'about to cancel ' cg-cert-key
 21498
 21499* EXEC CICS LINK
 21500*        PROGRAM  ('ELCANC')
 21501*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21502*    END-EXEC
 21503     MOVE LENGTH OF
 21504      CANCEL-GEN-PASS-AREA
 21505       TO DFHEIV11
 21506     MOVE 'ELCANC' TO DFHEIV1
 21507*    MOVE '."C                   (   #00018169' TO DFHEIV0
 21508     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21510     MOVE X'2020233030303138313639' TO DFHEIV0(25:11)
 21511     CALL 'kxdfhei1' USING DFHEIV0,
 21512           DFHEIV1,
 21513           CANCEL-GEN-PASS-AREA,
 21514           DFHEIV11,
 21515           DFHEIV99,
 21516           DFHEIV99,
 21517           DFHEIV99,
 21518           DFHEIV99
 21519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21520     IF CG-SUCCESS
 21521        CONTINUE
 21522     ELSE
 21523        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21524        MOVE '3'                 TO EMI-SWITCH1
 21525        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21526        EVALUATE TRUE
 21527           WHEN CG-DATE-ERROR
 21528             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21529           WHEN CG-CERT-NOT-FOUND
 21530             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21531           WHEN CG-AMOUNT-ERROR
 21532             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21533           WHEN CG-OPTION-ERROR
 21534             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21535           WHEN CG-PREV-CAN
 21536             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21537           WHEN CG-INVALID-DATA
 21538             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21539           WHEN CG-NO-ACCT-MSTR
 21540             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21541           WHEN CG-SFX-A-EXIST
 21542             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21543           WHEN CG-MISC-ERROR
 21544             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21545           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 395
* EL6311.cbl
 21546             MOVE ' ERROR - ELCANC - RETURN '
 21547                                 TO EMI-ERROR-TEXT (1) (12:25)
 21548        END-EVALUATE
 21549        GO TO 8200-SEND-DATAONLY
 21550     END-IF
 21551
 21552* EXEC CICS GETMAIN
 21553*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21554*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21555*        INITIMG (GETMAIN-SPACE)
 21556*    END-EXEC
 21557*    MOVE ',"IL                  $   #00018204' TO DFHEIV0
 21558     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21559     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21560     MOVE X'2020233030303138323034' TO DFHEIV0(25:11)
 21561     CALL 'kxdfhei1' USING DFHEIV0,
 21562           DFHEIV20,
 21563           ELCRTT-RECORD-LENGTH,
 21564           GETMAIN-SPACE
 21565     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21566         DFHEIV20
 21567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21568
 21569     move ' '                    to ws-elcrtt-update-sw
 21570     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21571     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21572
 21573
 21574* EXEC CICS READ
 21575*        UPDATE
 21576*        DATASET  (CRTT-ID)
 21577*        RIDFLD   (ELCRTT-KEY)
 21578*        INTO     (CERTIFICATE-TRAILERS)
 21579*        resp     (ws-response)
 21580*    END-EXEC
 21581     MOVE LENGTH OF
 21582      CERTIFICATE-TRAILERS
 21583       TO DFHEIV11
 21584*    MOVE '&"IL       EU         (  N#00018214' TO DFHEIV0
 21585     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21586     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21587     MOVE X'204E233030303138323134' TO DFHEIV0(25:11)
 21588     CALL 'kxdfhei1' USING DFHEIV0,
 21589           CRTT-ID,
 21590           CERTIFICATE-TRAILERS,
 21591           DFHEIV11,
 21592           ELCRTT-KEY,
 21593           DFHEIV99,
 21594           DFHEIV99,
 21595           DFHEIV99
 21596     MOVE EIBRESP  TO ws-response
 21597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21598
 21599     if resp-normal
 21600        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21601                  'E' or 'F' or 'G'
 21602           move 'J'              to cs-claim-verification-status
 21603           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 396
* EL6311.cbl
 21604        end-if
 21605        if update-elcrtt
 21606
 21607* EXEC CICS REWRITE
 21608*             DATASET    (crtt-ID)
 21609*             FROM       (CERTIFICATE-TRAILERS)
 21610*          END-EXEC
 21611     MOVE LENGTH OF
 21612      CERTIFICATE-TRAILERS
 21613       TO DFHEIV11
 21614*    MOVE '&& L                  %   #00018229' TO DFHEIV0
 21615     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21616     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21617     MOVE X'2020233030303138323239' TO DFHEIV0(25:11)
 21618     CALL 'kxdfhei1' USING DFHEIV0,
 21619           crtt-ID,
 21620           CERTIFICATE-TRAILERS,
 21621           DFHEIV11,
 21622           DFHEIV99
 21623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21624        else
 21625
 21626* exec cics unlock
 21627*             dataset    (crtt-ID)
 21628*          end-exec
 21629*    MOVE '&*                    #   #00018234' TO DFHEIV0
 21630     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21631     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21632     MOVE X'2020233030303138323334' TO DFHEIV0(25:11)
 21633     CALL 'kxdfhei1' USING DFHEIV0,
 21634           crtt-ID,
 21635           DFHEIV99
 21636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21637        end-if
 21638     end-if
 21639     .
 21640 5100-EXIT.
 21641     EXIT.
 21642
 21643******************************************************************
 21644*                                                                *
 21645*        B R O W S E   B A T C H   B A C K W A R D S             *
 21646*                                                                *
 21647******************************************************************
 21648
 21649 5500-BROWSE-BATCH-BACKWARD.
 21650
 21651* EXEC CICS HANDLE CONDITION
 21652*         NOTFND   (5550-END-RECORDS)
 21653*         ENDFILE  (5550-END-RECORDS)
 21654*    END-EXEC.
 21655*    MOVE '"$I''                  ! U #00018250' TO DFHEIV0
 21656     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21658     MOVE X'5520233030303138323530' TO DFHEIV0(25:11)
 21659     CALL 'kxdfhei1' USING DFHEIV0
 21660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21661
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 397
* EL6311.cbl
 21662
 21663 5505-START-BROWSE.
 21664     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21665     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21666     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21667
 21668
 21669* EXEC CICS STARTBR
 21670*         DATASET   (FILE-ID-ERPNDB)
 21671*         RIDFLD    (ERPNDB-ALT-KEY)
 21672*    END-EXEC.
 21673     MOVE 0
 21674       TO DFHEIV11
 21675*    MOVE '&,         G          &   #00018260' TO DFHEIV0
 21676     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21677     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21678     MOVE X'2020233030303138323630' TO DFHEIV0(25:11)
 21679     CALL 'kxdfhei1' USING DFHEIV0,
 21680           FILE-ID-ERPNDB,
 21681           ERPNDB-ALT-KEY,
 21682           DFHEIV99,
 21683           DFHEIV11,
 21684           DFHEIV99
 21685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21686
 21687
 21688     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21689
 21690
 21691* EXEC CICS READNEXT
 21692*         DATASET    (FILE-ID-ERPNDB)
 21693*         SET        (ADDRESS OF PENDING-BUSINESS)
 21694*         RIDFLD     (ERPNDB-KEY)
 21695*    END-EXEC.
 21696     MOVE 0
 21697       TO DFHEIV11
 21698*    MOVE '&.S                   )   #00018267' TO DFHEIV0
 21699     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21700     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21701     MOVE X'2020233030303138323637' TO DFHEIV0(25:11)
 21702     CALL 'kxdfhei1' USING DFHEIV0,
 21703           FILE-ID-ERPNDB,
 21704           DFHEIV20,
 21705           DFHEIV99,
 21706           ERPNDB-KEY,
 21707           DFHEIV99,
 21708           DFHEIV11,
 21709           DFHEIV99,
 21710           DFHEIV99
 21711     SET ADDRESS OF PENDING-BUSINESS TO
 21712         DFHEIV20
 21713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21714
 21715
 21716
 21717* EXEC CICS READPREV
 21718*         DATASET    (FILE-ID-ERPNDB)
 21719*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 398
* EL6311.cbl
 21720*         RIDFLD     (ERPNDB-KEY)
 21721*    END-EXEC.
 21722     MOVE 0
 21723       TO DFHEIV11
 21724*    MOVE '&0S                   )   #00018273' TO DFHEIV0
 21725     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21726     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21727     MOVE X'2020233030303138323733' TO DFHEIV0(25:11)
 21728     CALL 'kxdfhei1' USING DFHEIV0,
 21729           FILE-ID-ERPNDB,
 21730           DFHEIV20,
 21731           DFHEIV99,
 21732           ERPNDB-KEY,
 21733           DFHEIV99,
 21734           DFHEIV11,
 21735           DFHEIV99,
 21736           DFHEIV99
 21737     SET ADDRESS OF PENDING-BUSINESS TO
 21738         DFHEIV20
 21739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21740
 21741
 21742
 21743* EXEC CICS READPREV
 21744*         DATASET    (FILE-ID-ERPNDB)
 21745*         SET        (ADDRESS OF PENDING-BUSINESS)
 21746*         RIDFLD     (ERPNDB-KEY)
 21747*    END-EXEC.
 21748     MOVE 0
 21749       TO DFHEIV11
 21750*    MOVE '&0S                   )   #00018279' TO DFHEIV0
 21751     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21752     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21753     MOVE X'2020233030303138323739' TO DFHEIV0(25:11)
 21754     CALL 'kxdfhei1' USING DFHEIV0,
 21755           FILE-ID-ERPNDB,
 21756           DFHEIV20,
 21757           DFHEIV99,
 21758           ERPNDB-KEY,
 21759           DFHEIV99,
 21760           DFHEIV11,
 21761           DFHEIV99,
 21762           DFHEIV99
 21763     SET ADDRESS OF PENDING-BUSINESS TO
 21764         DFHEIV20
 21765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21766
 21767
 21768     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21769        GO TO 5550-END-RECORDS.
 21770
 21771     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21772
 21773     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21774
 21775     IF  WS-BATCH-PREFIX = '#CL'
 21776             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21777
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 399
* EL6311.cbl
 21778* EXEC CICS ENDBR
 21779*                 DATASET  (FILE-ID-ERPNDB)
 21780*            END-EXEC
 21781     MOVE 0
 21782       TO DFHEIV11
 21783*    MOVE '&2                    $   #00018294' TO DFHEIV0
 21784     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21785     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21786     MOVE X'2020233030303138323934' TO DFHEIV0(25:11)
 21787     CALL 'kxdfhei1' USING DFHEIV0,
 21788           FILE-ID-ERPNDB,
 21789           DFHEIV11,
 21790           DFHEIV99
 21791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21792         GO TO 5505-START-BROWSE.
 21793
 21794     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21795         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21796             NEXT SENTENCE
 21797         ELSE
 21798             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21799
 21800* EXEC CICS ENDBR
 21801*                 DATASET  (FILE-ID-ERPNDB)
 21802*            END-EXEC
 21803     MOVE 0
 21804       TO DFHEIV11
 21805*    MOVE '&2                    $   #00018304' TO DFHEIV0
 21806     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21807     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21808     MOVE X'2020233030303138333034' TO DFHEIV0(25:11)
 21809     CALL 'kxdfhei1' USING DFHEIV0,
 21810           FILE-ID-ERPNDB,
 21811           DFHEIV11,
 21812           DFHEIV99
 21813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21814             GO TO 5505-START-BROWSE.
 21815
 21816
 21817     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21818         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21819             NEXT SENTENCE
 21820        ELSE
 21821             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21822
 21823* EXEC CICS ENDBR
 21824*                 DATASET  (FILE-ID-ERPNDB)
 21825*            END-EXEC
 21826     MOVE 0
 21827       TO DFHEIV11
 21828*    MOVE '&2                    $   #00018315' TO DFHEIV0
 21829     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21830     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21831     MOVE X'2020233030303138333135' TO DFHEIV0(25:11)
 21832     CALL 'kxdfhei1' USING DFHEIV0,
 21833           FILE-ID-ERPNDB,
 21834           DFHEIV11,
 21835           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 400
* EL6311.cbl
 21836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21837             GO TO 5505-START-BROWSE.
 21838
 21839     IF NOT PB-BATCH-TRAILER
 21840        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21841
 21842* EXEC CICS ENDBR
 21843*            DATASET  (FILE-ID-ERPNDB)
 21844*       END-EXEC
 21845     MOVE 0
 21846       TO DFHEIV11
 21847*    MOVE '&2                    $   #00018322' TO DFHEIV0
 21848     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21849     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21850     MOVE X'2020233030303138333232' TO DFHEIV0(25:11)
 21851     CALL 'kxdfhei1' USING DFHEIV0,
 21852           FILE-ID-ERPNDB,
 21853           DFHEIV11,
 21854           DFHEIV99
 21855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21856        GO TO 5505-START-BROWSE.
 21857
 21858     IF PI-CSR-BROWSE
 21859        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21860           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21861
 21862* EXEC CICS ENDBR
 21863*               DATASET  (FILE-ID-ERPNDB)
 21864*          END-EXEC
 21865     MOVE 0
 21866       TO DFHEIV11
 21867*    MOVE '&2                    $   #00018330' TO DFHEIV0
 21868     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21869     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21870     MOVE X'2020233030303138333330' TO DFHEIV0(25:11)
 21871     CALL 'kxdfhei1' USING DFHEIV0,
 21872           FILE-ID-ERPNDB,
 21873           DFHEIV11,
 21874           DFHEIV99
 21875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21876           GO TO 5505-START-BROWSE.
 21877
 21878     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21879        IF PI-PB-CARRIER    = SPACES AND
 21880           PI-PB-GROUPING   = SPACES AND
 21881           PI-PB-STATE      = SPACES AND
 21882           PI-PB-ACCOUNT    = SPACES
 21883             GO TO 7200-DISPLAY-BATCHES
 21884          ELSE
 21885            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21886               PI-PB-GROUPING   = PB-GROUPING AND
 21887               PI-PB-STATE      = PB-STATE    AND
 21888               PI-PB-ACCOUNT    = PB-ACCOUNT
 21889                 GO TO 7200-DISPLAY-BATCHES.
 21890
 21891     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21892
 21893
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 401
* EL6311.cbl
 21894* EXEC CICS ENDBR
 21895*         DATASET  (FILE-ID-ERPNDB)
 21896*    END-EXEC.
 21897     MOVE 0
 21898       TO DFHEIV11
 21899*    MOVE '&2                    $   #00018350' TO DFHEIV0
 21900     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21901     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21902     MOVE X'2020233030303138333530' TO DFHEIV0(25:11)
 21903     CALL 'kxdfhei1' USING DFHEIV0,
 21904           FILE-ID-ERPNDB,
 21905           DFHEIV11,
 21906           DFHEIV99
 21907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21908
 21909
 21910     GO TO 5505-START-BROWSE.
 21911
 21912 5550-END-RECORDS.
 21913     MOVE ER-2257                TO EMI-ERROR.
 21914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21915     MOVE -1                     TO DPFENTRL.
 21916
 21917     GO TO 8200-SEND-DATAONLY.
 21918
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 402
* EL6311.cbl
 21920
 21921******************************************************************
 21922*                                                                *
 21923*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21924*                                                                *
 21925******************************************************************
 21926
 21927 6000-CREATE-TEMP-STORAGE.
 21928
 21929
 21930* EXEC CICS HANDLE CONDITION
 21931*        QIDERR  (6050-QID-ERROR)
 21932*    END-EXEC.
 21933*    MOVE '"$N                   ! V #00018373' TO DFHEIV0
 21934     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21936     MOVE X'5620233030303138333733' TO DFHEIV0(25:11)
 21937     CALL 'kxdfhei1' USING DFHEIV0
 21938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21939
 21940
 21941
 21942* EXEC CICS WRITEQ TS
 21943*        QUEUE    (QID)
 21944*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21945*        LENGTH   (WS-COMM-LENGTH)
 21946*        ITEM     (W-ONE)
 21947*    END-EXEC.
 21948*    MOVE '*" I   L              ''   #00018377' TO DFHEIV0
 21949     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21950     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21951     MOVE X'2020233030303138333737' TO DFHEIV0(25:11)
 21952     CALL 'kxdfhei1' USING DFHEIV0,
 21953           QID,
 21954           PROGRAM-INTERFACE-BLOCK,
 21955           WS-COMM-LENGTH,
 21956           W-ONE,
 21957           DFHEIV99,
 21958           DFHEIV99
 21959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21960
 21961
 21962 6000-EXIT.
 21963      EXIT.
 21964
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 403
* EL6311.cbl
 21966
 21967******************************************************************
 21968*                                                                *
 21969*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21970*                                                                *
 21971******************************************************************
 21972
 21973 6050-RECOVER-TEMP-STORAGE.
 21974     IF PGM-NAME = XCTL-EL6312
 21975        GO TO 6050-EXIT.
 21976
 21977     IF PGM-NAME = XCTL-EL6313
 21978        GO TO 6050-EXIT.
 21979
 21980     IF PGM-NAME = XCTL-EL6315
 21981         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21982     END-IF
 21983
 21984     IF PGM-NAME = XCTL-EL6316
 21985         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21986     END-IF
 21987
 21988
 21989* EXEC CICS HANDLE CONDITION
 21990*        QIDERR  (6050-QID-ERROR)
 21991*    END-EXEC.
 21992*    MOVE '"$N                   ! W #00018410' TO DFHEIV0
 21993     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21995     MOVE X'5720233030303138343130' TO DFHEIV0(25:11)
 21996     CALL 'kxdfhei1' USING DFHEIV0
 21997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21998
 21999
 22000
 22001* EXEC CICS READQ TS
 22002*         QUEUE   (QID)
 22003*         INTO    (PROGRAM-INTERFACE-BLOCK)
 22004*         LENGTH  (WS-COMM-LENGTH)
 22005*         ITEM    (W-ONE)
 22006*     END-EXEC.
 22007*    MOVE '*$II   L              ''   #00018414' TO DFHEIV0
 22008     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 22009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22010     MOVE X'2020233030303138343134' TO DFHEIV0(25:11)
 22011     CALL 'kxdfhei1' USING DFHEIV0,
 22012           QID,
 22013           PROGRAM-INTERFACE-BLOCK,
 22014           WS-COMM-LENGTH,
 22015           W-ONE,
 22016           DFHEIV99,
 22017           DFHEIV99
 22018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22019
 22020
 22021 6050-DELETE-TEMP-STORAGE.
 22022
 22023
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 404
* EL6311.cbl
 22024* EXEC CICS DELETEQ TS
 22025*        QUEUE   (QID)
 22026*    END-EXEC.
 22027*    MOVE '*&                    #   #00018423' TO DFHEIV0
 22028     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 22029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22030     MOVE X'2020233030303138343233' TO DFHEIV0(25:11)
 22031     CALL 'kxdfhei1' USING DFHEIV0,
 22032           QID,
 22033           DFHEIV99
 22034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22035
 22036
 22037     GO TO 6050-EXIT.
 22038
 22039 6050-QID-ERROR.
 22040     MOVE ER-0033                TO EMI-ERROR
 22041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22042
 22043 6050-EXIT.
 22044      EXIT.
 22045
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 405
* EL6311.cbl
 22047
 22048******************************************************************
 22049*                                                                *
 22050*            T E R M   C O N V E R S I O N                       *
 22051*                                                                *
 22052******************************************************************
 22053
 22054 6100-TERM-CONVERSION.
 22055
 22056     IF PI-BPMTS = ZERO
 22057         GO TO 6199-EXIT.
 22058
 22059     IF PI-BMODE = ' ' OR 'M'
 22060         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 22061         GO TO 6105-ROUND-TERM.
 22062
 22063     IF PI-BMODE = 'S'
 22064         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 22065         GO TO 6105-ROUND-TERM.
 22066
 22067     IF PI-BMODE = 'W'
 22068         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 22069         GO TO 6105-ROUND-TERM.
 22070
 22071     IF PI-BMODE = 'B'
 22072         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 22073         GO TO 6105-ROUND-TERM.
 22074
 22075     IF PI-BMODE = 'T'
 22076         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 22077
 22078 6105-ROUND-TERM.
 22079
 22080     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 22081         ADD +1                  TO WS-CALC-TERM-WHOLE
 22082         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 22083
 22084     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 22085         GO TO 6125-COMPUTE-TERM-BENEFIT.
 22086
 22087     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 22088         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 22089                                      WS-BTERM    (WS-SUB1)
 22090         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 22091
 22092     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 22093         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 22094             MOVE -1               TO BMODEL
 22095             MOVE ER-2593          TO EMI-ERROR
 22096             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 22097             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22098
 22099 6124-CHECK-BENEFIT.
 22100
 22101     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 22102        GO TO 6126-COMPUTE-BENEFIT.
 22103
 22104     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 406
* EL6311.cbl
 22105
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 407
* EL6311.cbl
 22107******************************************************************
 22108**         COMPUTE TERM AND BENEFIT
 22109******************************************************************
 22110 6125-COMPUTE-TERM-BENEFIT.
 22111
 22112     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 22113        PI-BPMTAMT = ZERO
 22114         GO TO 6199-EXIT.
 22115
 22116     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 22117                                     WS-BTERM  (WS-SUB1).
 22118     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 22119
 22120 6126-COMPUTE-BENEFIT.
 22121
 22122     IF PI-BMODE = 'M' OR  ' '
 22123         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 22124
 22125     IF PI-BMODE = 'W'
 22126         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 22127
 22128     IF PI-BMODE = 'S'
 22129         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 22130
 22131     IF PI-BMODE = 'B'
 22132         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 22133
 22134     IF PI-BMODE = 'T'
 22135         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 22136
 22137     IF WS-SUB1 = +1
 22138        COMPUTE WS-BBEN (WS-SUB1) =
 22139                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 22140
 22141     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 22142     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 22143     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 22144
 22145 6199-EXIT.
 22146     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 408
* EL6311.cbl
 22148
 22149******************************************************************
 22150*                                                                *
 22151*             D I S P L A Y   I S S U E S                        *
 22152*                                                                *
 22153******************************************************************
 22154
 22155 6200-CREATE-VADS.
 22156     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 22157     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 22158     MOVE SPACES                 TO WS-PASS-VADS-REC
 22159
 22160* EXEC CICS GETMAIN
 22161*       SET      (ADDRESS OF PENDING-BUSINESS)
 22162*       LENGTH   (ERPNDB-RECORD-LENGTH)
 22163*       INITIMG  (GETMAIN-SPACE)
 22164*       RESP     (WS-RESPONSE)
 22165*    END-EXEC
 22166*    MOVE ',"IL                  $  N#00018549' TO DFHEIV0
 22167     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22168     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22169     MOVE X'204E233030303138353439' TO DFHEIV0(25:11)
 22170     CALL 'kxdfhei1' USING DFHEIV0,
 22171           DFHEIV20,
 22172           ERPNDB-RECORD-LENGTH,
 22173           GETMAIN-SPACE
 22174     SET ADDRESS OF PENDING-BUSINESS TO
 22175         DFHEIV20
 22176     MOVE EIBRESP  TO WS-RESPONSE
 22177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22178
 22179* EXEC CICS READ
 22180*       INTO    (PENDING-BUSINESS)
 22181*       DATASET (FILE-ID-ERPNDB)
 22182*       RIDFLD  (ERPNDB-KEY)
 22183*       RESP    (WS-RESPONSE)
 22184*    END-EXEC
 22185     MOVE LENGTH OF
 22186      PENDING-BUSINESS
 22187       TO DFHEIV11
 22188*    MOVE '&"IL       E          (  N#00018555' TO DFHEIV0
 22189     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22191     MOVE X'204E233030303138353535' TO DFHEIV0(25:11)
 22192     CALL 'kxdfhei1' USING DFHEIV0,
 22193           FILE-ID-ERPNDB,
 22194           PENDING-BUSINESS,
 22195           DFHEIV11,
 22196           ERPNDB-KEY,
 22197           DFHEIV99,
 22198           DFHEIV99,
 22199           DFHEIV99
 22200     MOVE EIBRESP  TO WS-RESPONSE
 22201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22202     IF RESP-NORMAL
 22203        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22204        IF (RESP-NORMAL)
 22205           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 409
* EL6311.cbl
 22206              AM-CONTROL-PRIMARY (1:20))
 22207           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 22208        ELSE
 22209           MOVE 'ACCOUNT NOT FOUND'
 22210                                 TO VD-ACCOUNT-NAME
 22211        END-IF
 22212        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 22213                                    TO M1
 22214        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 22215        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 22216           (A2 > M1)
 22217           OR (WS-WORK-FIELD (A2:1) = '*')
 22218           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 22219           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 22220        END-PERFORM
 22221        IF A2 > M1
 22222           CONTINUE
 22223        ELSE
 22224           MOVE WS-WORK-FIELD (1:A2 - 1)
 22225                                    TO VD-ACCOUNT-NAME
 22226        END-IF
 22227        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 22228        MOVE PB-CARRIER          TO VD-CARRIER
 22229        MOVE PB-GROUPING         TO VD-GROUPING
 22230        MOVE PB-STATE            TO VD-STATE
 22231        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 22232        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 22233        MOVE PB-CERT-NO          TO VD-CERT-NO
 22234        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 22235        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 22236        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22237        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22238        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22239        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22240        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22241        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22242        MOVE PB-CSR-ID           TO VD-CSR-ID
 22243        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22244        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22245        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22246        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22247        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22248        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22249        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22250        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22251        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22252        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22253        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22254        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22255        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22256     END-IF
 22257     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22258
 22259
 22260* EXEC CICS GETMAIN
 22261*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22262*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22263*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 410
* EL6311.cbl
 22264*       RESP     (WS-RESPONSE)
 22265*    END-EXEC
 22266*    MOVE ',"IL                  $  N#00018618' TO DFHEIV0
 22267     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22269     MOVE X'204E233030303138363138' TO DFHEIV0(25:11)
 22270     CALL 'kxdfhei1' USING DFHEIV0,
 22271           DFHEIV20,
 22272           ERPNDM-RECORD-LENGTH,
 22273           GETMAIN-SPACE
 22274     SET ADDRESS OF PENDING-MAILING-DATA TO
 22275         DFHEIV20
 22276     MOVE EIBRESP  TO WS-RESPONSE
 22277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22278
 22279
 22280* EXEC CICS READ
 22281*       INTO    (PENDING-MAILING-DATA)
 22282*       DATASET (FILE-ID-ERPNDM)
 22283*       RIDFLD  (ERPNDM-KEY)
 22284*       RESP    (WS-RESPONSE)
 22285*    END-EXEC
 22286     MOVE LENGTH OF
 22287      PENDING-MAILING-DATA
 22288       TO DFHEIV11
 22289*    MOVE '&"IL       E          (  N#00018625' TO DFHEIV0
 22290     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22292     MOVE X'204E233030303138363235' TO DFHEIV0(25:11)
 22293     CALL 'kxdfhei1' USING DFHEIV0,
 22294           FILE-ID-ERPNDM,
 22295           PENDING-MAILING-DATA,
 22296           DFHEIV11,
 22297           ERPNDM-KEY,
 22298           DFHEIV99,
 22299           DFHEIV99,
 22300           DFHEIV99
 22301     MOVE EIBRESP  TO WS-RESPONSE
 22302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22303
 22304     IF RESP-NORMAL
 22305        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22306        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22307        MOVE PM-CITY              TO VD-INSURED-CITY
 22308        MOVE PM-STATE             TO VD-INSURED-STATE
 22309        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22310     END-IF
 22311
 22312     MOVE 'VAC1'                  TO VD-LETTER-ID
 22313     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22314     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22315     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22316     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22317     MOVE +0                      TO VD-ARCHIVE-NO
 22318     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22319     .
 22320 6200-EXIT.
 22321     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 411
* EL6311.cbl
 22322 6210-READ-ERACCT.
 22323     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22324     MOVE LOW-VALUES             TO ERACCT-FILL
 22325
 22326* EXEC CICS READ
 22327*         DATASET   ('ERACCT')
 22328*         INTO      (ACCOUNT-MASTER)
 22329*         RIDFLD    (ERACCT-KEY)
 22330*         GTEQ
 22331*         RESP      (WS-RESPONSE)
 22332*    END-EXEC
 22333     MOVE LENGTH OF
 22334      ACCOUNT-MASTER
 22335       TO DFHEIV11
 22336     MOVE 'ERACCT' TO DFHEIV1
 22337*    MOVE '&"IL       G          (  N#00018653' TO DFHEIV0
 22338     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22340     MOVE X'204E233030303138363533' TO DFHEIV0(25:11)
 22341     CALL 'kxdfhei1' USING DFHEIV0,
 22342           DFHEIV1,
 22343           ACCOUNT-MASTER,
 22344           DFHEIV11,
 22345           ERACCT-KEY,
 22346           DFHEIV99,
 22347           DFHEIV99,
 22348           DFHEIV99
 22349     MOVE EIBRESP  TO WS-RESPONSE
 22350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22351     .
 22352 6210-EXIT.
 22353     EXIT.
 22354
 22355 6220-READ-ERMAIL.
 22356
 22357     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22358     MOVE ' '                    TO WS-ERMAIL-SW
 22359
 22360
 22361* EXEC CICS READ
 22362*       DATASET   (FILE-ID-ERMAIL)
 22363*       SET       (ADDRESS OF MAILING-DATA)
 22364*       RIDFLD    (ERMAIL-KEY)
 22365*       RESP      (WS-RESPONSE)
 22366*    END-EXEC
 22367*    MOVE '&"S        E          (  N#00018669' TO DFHEIV0
 22368     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22370     MOVE X'204E233030303138363639' TO DFHEIV0(25:11)
 22371     CALL 'kxdfhei1' USING DFHEIV0,
 22372           FILE-ID-ERMAIL,
 22373           DFHEIV20,
 22374           DFHEIV99,
 22375           ERMAIL-KEY,
 22376           DFHEIV99,
 22377           DFHEIV99,
 22378           DFHEIV99
 22379     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 412
* EL6311.cbl
 22380         DFHEIV20
 22381     MOVE EIBRESP  TO WS-RESPONSE
 22382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22383
 22384     IF RESP-NORMAL
 22385        SET ERMAIL-FOUND TO TRUE
 22386     END-IF
 22387     .
 22388 6220-EXIT.
 22389     EXIT.
 22390
 22391 6400-CHECK-FOR-RES-REF-CLAIM.
 22392     display 'made it to 6400- for ' pi-cert-no
 22393     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22394
 22395     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22396                                    W-CL-COMP-CD.
 22397     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22398                                    W-CL-CERT-NO.
 22399     MOVE SPACES                 TO MSTR-CERT-SFX.
 22400
 22401
 22402* EXEC CICS HANDLE CONDITION
 22403*        NOTFND  (6400-CONTINUE)
 22404*        ENDFILE (6400-CONTINUE)
 22405*    END-EXEC.
 22406*    MOVE '"$I''                  ! X #00018693' TO DFHEIV0
 22407     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22409     MOVE X'5820233030303138363933' TO DFHEIV0(25:11)
 22410     CALL 'kxdfhei1' USING DFHEIV0
 22411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22412
 22413
 22414
 22415* EXEC CICS IGNORE CONDITION
 22416*        DUPKEY
 22417*    END-EXEC.
 22418*    MOVE '"*$                   !   #00018698' TO DFHEIV0
 22419     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22421     MOVE X'2020233030303138363938' TO DFHEIV0(25:11)
 22422     CALL 'kxdfhei1' USING DFHEIV0
 22423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22424
 22425
 22426
 22427* EXEC CICS STARTBR
 22428*        DATASET   (CLMS-ID)
 22429*        RIDFLD    (ELMSTR-KEY)
 22430*        GENERIC   EQUAL
 22431*        KEYLENGTH (ELMSTR-LENGTH)
 22432*    END-EXEC.
 22433     MOVE 0
 22434       TO DFHEIV11
 22435*    MOVE '&,   KG    E          &   #00018702' TO DFHEIV0
 22436     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22437     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 413
* EL6311.cbl
 22438     MOVE X'2020233030303138373032' TO DFHEIV0(25:11)
 22439     CALL 'kxdfhei1' USING DFHEIV0,
 22440           CLMS-ID,
 22441           ELMSTR-KEY,
 22442           ELMSTR-LENGTH,
 22443           DFHEIV11,
 22444           DFHEIV99
 22445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22446
 22447
 22448     display 'browse started'
 22449     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22450
 22451 6400-NEXT-CLAIM.
 22452
 22453
 22454* EXEC CICS READNEXT
 22455*        DATASET   (CLMS-ID)
 22456*        RIDFLD    (ELMSTR-KEY)
 22457*        SET       (ADDRESS OF CLAIM-MASTER)
 22458*    END-EXEC.
 22459     MOVE 0
 22460       TO DFHEIV11
 22461*    MOVE '&.S                   )   #00018714' TO DFHEIV0
 22462     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22463     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22464     MOVE X'2020233030303138373134' TO DFHEIV0(25:11)
 22465     CALL 'kxdfhei1' USING DFHEIV0,
 22466           CLMS-ID,
 22467           DFHEIV20,
 22468           DFHEIV99,
 22469           ELMSTR-KEY,
 22470           DFHEIV99,
 22471           DFHEIV11,
 22472           DFHEIV99,
 22473           DFHEIV99
 22474     SET ADDRESS OF CLAIM-MASTER TO
 22475         DFHEIV20
 22476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22477
 22478
 22479     display 'read claim for ' mstr-cert-no
 22480     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22481        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22482         GO TO 6400-CONTINUE
 22483     END-IF.
 22484
 22485     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22486        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22487        PI-STATE       NOT = CL-CERT-STATE     OR
 22488        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22489        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22490         GO TO 6400-NEXT-CLAIM
 22491     END-IF.
 22492
 22493     display 'found claim ' cl-claim-no
 22494        ' with denial type ' cl-denial-type
 22495     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 414
* EL6311.cbl
 22496         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22497         GO TO 6400-CONTINUE
 22498     END-IF.
 22499
 22500     GO TO 6400-NEXT-CLAIM.
 22501
 22502 6400-CONTINUE.
 22503
 22504     IF WS-BROWSE-STARTED-SW = 'Y'
 22505
 22506* EXEC CICS ENDBR
 22507*            DATASET   (CLMS-ID)
 22508*        END-EXEC
 22509     MOVE 0
 22510       TO DFHEIV11
 22511*    MOVE '&2                    $   #00018746' TO DFHEIV0
 22512     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22514     MOVE X'2020233030303138373436' TO DFHEIV0(25:11)
 22515     CALL 'kxdfhei1' USING DFHEIV0,
 22516           CLMS-ID,
 22517           DFHEIV11,
 22518           DFHEIV99
 22519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22520         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22521     END-IF.
 22522
 22523 6400-EXIT.
 22524     EXIT.
 22525
 22526 7000-DISPLAY-ISSUES.
 22527
 22528     IF PI-DISPLAY-ORIGINAL-BATCH
 22529        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22530        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22531     ELSE
 22532        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22533
 22534     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22535
 22536     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22537     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22538
 22539     MOVE LOW-VALUES                 TO EL631BI.
 22540     MOVE ZEROS                      TO PI-BPMTAMT
 22541                                        PI-BPMTS.
 22542     MOVE SPACE                      TO PI-BMODE
 22543                                        PI-BTYPE (1)
 22544                                        PI-BTYPE (2).
 22545     MOVE EL631B                     TO PI-MAP-NAME.
 22546     MOVE 'Y'                        TO PI-BROWSE-SW.
 22547     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22548                                        PI-HIGH-SEQ-NO.
 22549
 22550     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22551        MOVE AL-SABOF                TO BCHGTA
 22552        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22553        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 415
* EL6311.cbl
 22554     ELSE
 22555        MOVE AL-SADOF                TO BCHGTA
 22556                                        BCHGA
 22557        MOVE PB-CHG-COUNT            TO BCHGO.
 22558
 22559     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22560     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22561     MOVE WS-HR-MINS                 TO BMANTATO.
 22562
 22563     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22564        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22565        MOVE SPACE                   TO DC-OPTION-CODE
 22566        PERFORM 9700-DATE-LINK
 22567        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22568        MOVE 'INACTIVE'              TO BMOENDTO
 22569     ELSE
 22570        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22571        MOVE SPACE                   TO DC-OPTION-CODE
 22572        PERFORM 9700-DATE-LINK
 22573        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22574        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22575        MOVE SPACE                   TO DC-OPTION-CODE
 22576        PERFORM 9700-DATE-LINK
 22577        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22578
 22579*    MOVE PB-I-REFERENCE             TO BREFO.
 22580
 22581*    IF PI-COMPANY-ID EQUAL 'HER'
 22582*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22583*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22584*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22585*                MOVE WS-MEMBER-NO-1-8
 22586*                                TO  BMICRNOO.
 22587
 22588*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22589*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22590*            MOVE PB-I-MICROFILM-NO
 22591*                                TO  BMICRNOO.
 22592     IF PB-I-VIN NOT = SPACES
 22593        MOVE PB-I-VIN            TO BVINO
 22594     END-IF
 22595
 22596     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22597     MOVE PB-CERT-SFX                TO BSUFIXO.
 22598     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22599     MOVE SPACE                      TO DC-OPTION-CODE.
 22600     PERFORM 9700-DATE-LINK.
 22601     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22602
 22603     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22604     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22605     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22606     MOVE PB-I-INSURED-SEX           TO BSEXO
 22607
 22608     IF PB-I-AGE NOT = ZEROS
 22609         MOVE PB-I-AGE               TO BAGEO.
 22610
 22611     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 416
* EL6311.cbl
 22612                                 TO ELCERT-KEY
 22613     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22614     IF NOT CERT-TRL-REC-NOT-FOUND
 22615         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22616             MOVE 'AGE*'             TO BAGEDEFO
 22617         ELSE
 22618             MOVE 'AGE '             TO BAGEDEFO
 22619         END-IF
 22620     ELSE
 22621         MOVE 'AGE '             TO BAGEDEFO
 22622     END-IF
 22623
 22624     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22625         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22626         MOVE SPACE                  TO DC-OPTION-CODE
 22627         PERFORM 9700-DATE-LINK
 22628         IF NO-CONVERSION-ERROR
 22629            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22630
 22631     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22632         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22633         MOVE SPACE                  TO DC-OPTION-CODE
 22634         PERFORM 9700-DATE-LINK
 22635         IF NO-CONVERSION-ERROR
 22636            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22637
 22638     IF PB-I-EXTENTION-DAYS NUMERIC
 22639        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22640           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22641        ELSE
 22642           IF PB-I-TERM-IN-DAYS NUMERIC
 22643              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22644                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22645
 22646     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22647        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22648
 22649     MOVE PB-FORCE-CODE              TO BFORCEO.
 22650     MOVE PB-I-TERM-TYPE             TO BMODEO
 22651                                        PI-BMODE.
 22652
 22653     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22654        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22655
 22656     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22657         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22658                                        PI-BPMTS.
 22659
 22660     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22661         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22662           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22663                                        PI-BPMTAMT.
 22664
 22665     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22666     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22667     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22668     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22669     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 417
* EL6311.cbl
 22670     MOVE PB-I-SIG-SW                TO BSIGO.
 22671     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22672     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22673     MOVE PB-RECORD-BILL             TO BBILCDO.
 22674     MOVE PB-FORCE-CODE              TO BFORCEO.
 22675
 22676     IF (PB-I-LIVES NUMERIC)
 22677        AND (PB-I-LIVES > ZEROS)
 22678        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22679        IF (RESP-NORMAL)
 22680           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22681           CONTINUE
 22682        ELSE
 22683           MOVE PB-I-LIVES       TO BLIVESO
 22684        END-IF
 22685     END-IF
 22686
 22687     IF PB-I-NUM-BILLED NUMERIC AND
 22688        PB-I-NUM-BILLED GREATER THAN ZEROS
 22689        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22690*    ELSE
 22691*       MOVE ZEROS                   TO BBILLEDO.
 22692
 22693     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22694
 22695     IF PB-I-LOAN-APR NOT = +99.9999
 22696        MOVE PB-I-LOAN-APR           TO BAPRO.
 22697
 22698     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22699        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22700
 22701     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22702        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22703           MOVE AL-SANOF                TO BORIGHDA
 22704           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22705           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22706
 22707     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22708
 22709     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22710        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22711
 22712     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22713        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22714                                        PI-BTYPE (1).
 22715
 22716     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22717        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22718
 22719     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22720        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22721
 22722     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22723        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22724
 22725     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22726        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22727
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 418
* EL6311.cbl
 22728     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22729        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22730
 22731     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22732         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22733         MOVE SPACE                  TO DC-OPTION-CODE
 22734         PERFORM 9700-DATE-LINK
 22735         IF NO-CONVERSION-ERROR
 22736            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22737
 22738     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22739        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22740        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22741        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22742        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22743                 GIVING BDIFFO (1)
 22744     ELSE
 22745        MOVE SPACES                  TO BBEN-CD     (1)
 22746                                        BBEN-ABBR   (1).
 22747
 22748     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22749        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22750        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22751                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22752
 22753     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22754       IF PB-RECORD-ON-HOLD
 22755          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22756
 22757     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22758       IF PB-RECORD-RETURNED
 22759          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22760
 22761     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22762        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22763             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22764
 22765     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22766
 22767     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22768        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22769
 22770     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22771        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22772                                        PI-BTYPE (2).
 22773
 22774     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22775        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22776
 22777     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22778        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22779
 22780     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22781        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22782
 22783     IF PB-I-TOT-FEES NOT NUMERIC
 22784        MOVE ZEROS               TO PB-I-TOT-FEES
 22785     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 419
* EL6311.cbl
 22786     IF PB-I-TOT-FEES > ZEROS
 22787        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22788
 22789     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22790         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22791         MOVE SPACE                  TO DC-OPTION-CODE
 22792         PERFORM 9700-DATE-LINK
 22793         IF NO-CONVERSION-ERROR
 22794            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22795
 22796     IF PB-I-TOT-FEES > ZEROS
 22797        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22798        SUBTRACT PB-I-TOT-FEES FROM
 22799                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22800
 22801     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22802        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22803        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22804        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22805        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22806                 GIVING BDIFFO (2)
 22807     ELSE
 22808        MOVE SPACES                  TO BBEN-CD     (2)
 22809                                        BBEN-ABBR   (2).
 22810
 22811     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22812       IF PB-RECORD-ON-HOLD
 22813          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22814
 22815     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22816       IF PB-RECORD-RETURNED
 22817          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22818
 22819     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22820        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22821             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22822
 22823     MOVE PB-CSR-ID                  TO BCSRO.
 22824
 22825     IF PI-COMPANY-ID  =  'DMD'
 22826        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22827            NEXT SENTENCE
 22828        ELSE
 22829            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22830               MOVE 'NEW CERT'       TO BNCERTLI
 22831               MOVE EC-NEW-CERT      TO BNCERTO.
 22832
 22833     IF PI-COMPANY-ID  =  'DMD'
 22834        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22835            NEXT SENTENCE
 22836        ELSE
 22837           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22838               MOVE 'NEW STATE'      TO BNSTATLI
 22839               MOVE EC-NEW-STATE     TO BNSTATO.
 22840
 22841 7000-CONTINUE.
 22842     MOVE 'C'                        TO BMAINTI.
 22843     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 420
* EL6311.cbl
 22844
 22845     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22846        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22847
 22848     IF PI-6315-FINALIZED = 'Y'   AND
 22849        PB-UNFORCED-ERRORS
 22850          MOVE -1                TO BFORCEL
 22851          MOVE  1                TO SET-CURSOR-SW
 22852     END-IF
 22853
 22854     IF NO-CURSOR-SET
 22855        MOVE -1                      TO BMAINTL.
 22856
 22857     GO TO 8100-SEND-INITIAL-MAP.
 22858
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 421
* EL6311.cbl
 22860
 22861******************************************************************
 22862*                                                                *
 22863*             D I S P L A Y   C A N C E L S                      *
 22864*                                                                *
 22865******************************************************************
 22866
 22867 7100-DISPLAY-CANCELS.
 22868     IF PI-DISPLAY-ORIGINAL-BATCH
 22869        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22870        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22871     ELSE
 22872        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22873
 22874     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22875
 22876     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22877     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22878
 22879     MOVE LOW-VALUES                 TO EL631CI.
 22880     MOVE EL631C                     TO PI-MAP-NAME.
 22881     MOVE 'Y'                        TO PI-BROWSE-SW.
 22882     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22883                                        PI-HIGH-SEQ-NO.
 22884
 22885     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22886        MOVE AL-SABOF                TO CCHGTA
 22887        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22888        MOVE AL-SANON                TO CCHGA
 22889      ELSE
 22890        MOVE AL-SADOF                TO CCHGTA
 22891                                        CCHGA
 22892        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22893
 22894*    MOVE PB-C-REFERENCE             TO CREFO.
 22895
 22896*    IF PB-C-MICROFILM-NO IS NUMERIC
 22897*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22898*          MOVE PB-C-MICROFILM-NO
 22899*                                TO CMICRNOO
 22900*          MOVE AL-UNNON         TO CMICRNOA
 22901*       END-IF
 22902*    END-IF
 22903     IF PB-C-INT-ON-REFS NUMERIC
 22904        IF PB-C-INT-ON-REFS NOT = ZEROS
 22905           MOVE PB-C-INT-ON-REFS
 22906                                 TO CNHINTO
 22907           MOVE AL-SANOF         TO CNHINTA
 22908        END-IF
 22909     END-IF
 22910     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22911     MOVE PB-CERT-SFX                TO CSUFIXO.
 22912     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22913     MOVE SPACE                      TO DC-OPTION-CODE.
 22914     PERFORM 9700-DATE-LINK.
 22915     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22916
 22917     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 422
* EL6311.cbl
 22918        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22919        MOVE SPACE                   TO DC-OPTION-CODE
 22920        PERFORM 9700-DATE-LINK
 22921        IF NO-CONVERSION-ERROR
 22922           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22923
 22924     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22925        NEXT SENTENCE
 22926     ELSE
 22927        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22928
 22929     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22930        NEXT SENTENCE
 22931     ELSE
 22932        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22933
 22934     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22935        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22936        MOVE SPACE                   TO DC-OPTION-CODE
 22937        PERFORM 9700-DATE-LINK
 22938        IF NO-CONVERSION-ERROR
 22939           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22940
 22941     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22942         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22943
 22944     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22945         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22946
 22947     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22948        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22949        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22950                 GIVING CDRFND1O.
 22951
 22952     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22953        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22954        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22955                 GIVING CDRFND2O.
 22956
 22957     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22958       IF PB-RECORD-ON-HOLD
 22959          MOVE 'ON HOLD'             TO CBILIT1O.
 22960
 22961     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22962       IF PB-RECORD-RETURNED
 22963          MOVE 'RETURNED'            TO CBILIT1O.
 22964
 22965     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22966        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22967             MOVE 'OVERRIDE'         TO CBILIT1O.
 22968
 22969     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22970       IF PB-RECORD-ON-HOLD
 22971          MOVE 'ON HOLD'             TO CBILIT2O.
 22972
 22973     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22974       IF PB-RECORD-RETURNED
 22975          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 423
* EL6311.cbl
 22976
 22977     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22978        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22979             MOVE 'OVERRIDE'         TO CBILIT2O.
 22980
 22981     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22982     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22983     IF PB-C-POST-CARD-IND = 'Y'
 22984        MOVE 'Y'                     TO CPCYNO
 22985     ELSE
 22986        MOVE 'N'                     TO CPCYNO
 22987     END-IF
 22988     MOVE PB-FORCE-CODE              TO CFORCEO.
 22989     MOVE PB-RECORD-BILL             TO CBILCDO.
 22990     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22991     MOVE SPACES                     TO CINITSO.
 22992     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22993         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22994     ELSE
 22995         MOVE PB-CI-INITIALS         TO CINITSO
 22996     END-IF.
 22997
 22998     IF PB-CI-CANCEL-FEE NUMERIC
 22999        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 23000        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 23001     ELSE
 23002        MOVE ZEROES                  TO W-CANCEL-FEE.
 23003
 23004     MOVE W-CANCEL-FEE               TO CCANFEEO.
 23005
 23006     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 23007        ADD PB-CI-LF-PREMIUM-AMT
 23008             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 23009
 23010     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 23011        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 23012
 23013     MOVE PB-CI-LF-TERM              TO CTERM1O.
 23014     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 23015     MOVE PB-CI-AH-TERM              TO CTERM2O.
 23016     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 23017
 23018     IF PB-C-LIVES NUMERIC
 23019        MOVE PB-C-LIVES              TO CLIVESO.
 23020
 23021     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 23022        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 23023
 23024     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 23025        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 23026        MOVE SPACE                   TO DC-OPTION-CODE
 23027        PERFORM 9700-DATE-LINK
 23028        IF NO-CONVERSION-ERROR
 23029           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 23030
 23031     IF  PB-C-REFUND-CREATED
 23032         MOVE 'YES'                  TO CRFNDSWO
 23033     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 424
* EL6311.cbl
 23034         IF PB-C-REFUND-REQUESTED
 23035            MOVE 'REQ'               TO CRFNDSWO
 23036         ELSE
 23037            MOVE 'NO'                TO CRFNDSWO.
 23038
 23039     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 23040     MOVE SPACE                      TO DC-OPTION-CODE.
 23041     PERFORM 9700-DATE-LINK.
 23042     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 23043     MOVE PB-INPUT-BY                TO CENTBYO.
 23044
 23045     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23046        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 23047        MOVE SPACE                   TO DC-OPTION-CODE
 23048        PERFORM 9700-DATE-LINK
 23049        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23050        MOVE 'INACTIVE'              TO CMOENDTO
 23051     ELSE
 23052        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 23053        MOVE SPACE                   TO DC-OPTION-CODE
 23054        PERFORM 9700-DATE-LINK
 23055        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23056        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 23057        MOVE SPACE                   TO DC-OPTION-CODE
 23058        PERFORM 9700-DATE-LINK
 23059        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 23060
 23061     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 23062
 23063     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 23064     MOVE WS-HR-MINS                 TO CMANTATO.
 23065
 23066     EVALUATE PB-LF-REFUND-TYPE
 23067        WHEN '1'
 23068           MOVE 'RULE78'            TO CLFREFNO
 23069        WHEN '2'
 23070           MOVE 'PRORAT'            TO CLFREFNO
 23071        WHEN '3'
 23072           MOVE 'CALIF'             TO CLFREFNO
 23073        WHEN '4'
 23074           MOVE 'IRREG'             TO CLFREFNO
 23075        WHEN '5'
 23076           MOVE 'NETPAY'            TO CLFREFNO
 23077        WHEN '6'
 23078           MOVE 'ATCP'              TO CLFREFNO
 23079        WHEN '7'
 23080           MOVE 'UTAH'              TO CLFREFNO
 23081        WHEN '8'
 23082           MOVE 'MEAN'              TO CLFREFNO
 23083        WHEN '9'
 23084           MOVE 'SUM '              TO CLFREFNO
 23085        WHEN 'B'
 23086           MOVE 'BALN'              TO CLFREFNO
 23087     END-EVALUATE.
 23088
 23089     EVALUATE TRUE
 23090        WHEN PB-AH-REFUND-TYPE =  '1'
 23091           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 425
* EL6311.cbl
 23092        WHEN PB-AH-REFUND-TYPE =  '2'
 23093           MOVE 'PRORAT'            TO CAHREFNO
 23094        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 23095           MOVE 'CALIF'             TO CAHREFNO
 23096        WHEN PB-AH-REFUND-TYPE =  '4'
 23097           MOVE 'IRREG'             TO CAHREFNO
 23098        WHEN PB-AH-REFUND-TYPE =  '5'
 23099           MOVE 'NETPAY'            TO CAHREFNO
 23100        WHEN PB-AH-REFUND-TYPE =  '6'
 23101           MOVE 'ATCP'              TO CAHREFNO
 23102        WHEN PB-AH-REFUND-TYPE =  '7'
 23103           MOVE 'UTAH'              TO CAHREFNO
 23104        WHEN PB-AH-REFUND-TYPE =  '8'
 23105           MOVE 'MEAN'              TO CAHREFNO
 23106        WHEN PB-AH-REFUND-TYPE =  '9'
 23107           MOVE 'SUM '              TO CAHREFNO
 23108        WHEN PB-AH-REFUND-TYPE =  'B'
 23109           MOVE 'BALN'              TO CAHREFNO
 23110     END-EVALUATE.
 23111
 23112     MOVE PB-REIN-CD                 TO CREINCDO.
 23113
 23114     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 23115        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 23116        MOVE SPACE                   TO DC-OPTION-CODE
 23117        PERFORM 9700-DATE-LINK
 23118        IF NO-CONVERSION-ERROR
 23119           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 23120
 23121     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 23122        MOVE 999999                  TO WS-EXP-DT-EDIT
 23123        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 23124        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 23125     ELSE
 23126        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 23127           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 23128           MOVE SPACE                   TO DC-OPTION-CODE
 23129           PERFORM 9700-DATE-LINK
 23130           IF NO-CONVERSION-ERROR
 23131              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 23132
 23133     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 23134        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 23135           MOVE AL-SANOF                TO CORIGHDA
 23136           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 23137           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 23138
 23139     MOVE PB-CSR-ID              TO CCSRO.
 23140
 23141     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 23142     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 23143     MOVE 'N'                    TO ACTSPCO
 23144     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 23145     MOVE '2'                    TO ERACNT-REC-TYPE
 23146     MOVE +3                     TO ERACNT-SEQ-NO
 23147
 23148
 23149* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 426
* EL6311.cbl
 23150*         DATASET   ('ERACNT')
 23151*         INTO      (NOTE-FILE)
 23152*         RIDFLD    (ERACNT-KEY)
 23153*         RESP      (WS-RESPONSE)
 23154*    END-EXEC
 23155     MOVE LENGTH OF
 23156      NOTE-FILE
 23157       TO DFHEIV11
 23158     MOVE 'ERACNT' TO DFHEIV1
 23159*    MOVE '&"IL       E          (  N#00019377' TO DFHEIV0
 23160     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23162     MOVE X'204E233030303139333737' TO DFHEIV0(25:11)
 23163     CALL 'kxdfhei1' USING DFHEIV0,
 23164           DFHEIV1,
 23165           NOTE-FILE,
 23166           DFHEIV11,
 23167           ERACNT-KEY,
 23168           DFHEIV99,
 23169           DFHEIV99,
 23170           DFHEIV99
 23171     MOVE EIBRESP  TO WS-RESPONSE
 23172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23173
 23174     IF RESP-NORMAL
 23175        IF NT-account-special = 'Y'
 23176           MOVE 'Y'              TO actspcO
 23177           MOVE ER-1762          TO EMI-ERROR
 23178           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23179        END-IF
 23180     END-IF
 23181     MOVE 'C'                    TO CMAINTI.
 23182     MOVE AL-UANON               TO CMAINTA.
 23183
 23184     IF PI-6316-FINALIZED = 'Y'  AND
 23185        PB-UNFORCED-ERRORS
 23186          MOVE -1                TO CFORCEL
 23187          MOVE  1                TO SET-CURSOR-SW
 23188     END-IF
 23189
 23190     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23191        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23192
 23193     IF NO-CURSOR-SET
 23194        MOVE -1                  TO CMAINTL.
 23195
 23196     GO TO 8100-SEND-INITIAL-MAP.
 23197
 23198
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 427
* EL6311.cbl
 23200***************************************************************
 23201*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23202*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23203***************************************************************
 23204
 23205 7200-DISPLAY-BATCHES.
 23206     MOVE EL631D                 TO PI-MAP-NAME.
 23207     MOVE LOW-VALUES             TO EL631DI.
 23208
 23209     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23210
 23211
 23212* EXEC CICS HANDLE CONDITION
 23213*         NOTFND   (3690-NOT-FOUND)
 23214*    END-EXEC.
 23215*    MOVE '"$I                   ! Y #00019421' TO DFHEIV0
 23216     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23218     MOVE X'5920233030303139343231' TO DFHEIV0(25:11)
 23219     CALL 'kxdfhei1' USING DFHEIV0
 23220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23221
 23222
 23223     IF PI-DISPLAY-SCREEN
 23224        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23225     ELSE
 23226        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23227
 23228     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23229     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23230
 23231
 23232* EXEC CICS READ
 23233*         DATASET   (FILE-ID-ERPNDB)
 23234*         RIDFLD    (ERPNDB-KEY)
 23235*         SET       (ADDRESS OF PENDING-BUSINESS)
 23236*    END-EXEC.
 23237*    MOVE '&"S        E          (   #00019433' TO DFHEIV0
 23238     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23240     MOVE X'2020233030303139343333' TO DFHEIV0(25:11)
 23241     CALL 'kxdfhei1' USING DFHEIV0,
 23242           FILE-ID-ERPNDB,
 23243           DFHEIV20,
 23244           DFHEIV99,
 23245           ERPNDB-KEY,
 23246           DFHEIV99,
 23247           DFHEIV99,
 23248           DFHEIV99
 23249     SET ADDRESS OF PENDING-BUSINESS TO
 23250         DFHEIV20
 23251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23252
 23253
 23254     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23255     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23256     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23257     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 428
* EL6311.cbl
 23258     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23259
 23260     MOVE EL631D                 TO PI-MAP-NAME.
 23261     MOVE LOW-VALUES             TO EL631DI.
 23262     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23263
 23264*    IF PI-AR-PROCESSING
 23265*       MOVE PB-REFERENCE        TO DREFO.
 23266
 23267     MOVE PB-CSR-ID              TO DCSRO.
 23268
 23269     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23270        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23271        MOVE SPACE               TO DC-OPTION-CODE
 23272        PERFORM 9700-DATE-LINK
 23273        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23274        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23275        MOVE 'INACTIVE'          TO DLDATEO
 23276     ELSE
 23277        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23278        MOVE SPACE               TO DC-OPTION-CODE
 23279        PERFORM 9700-DATE-LINK
 23280        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23281
 23282     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23283     MOVE SPACE                  TO DC-OPTION-CODE.
 23284     PERFORM 9700-DATE-LINK.
 23285     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23286
 23287     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23288        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23289     ELSE
 23290        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23291        MOVE SPACE               TO DC-OPTION-CODE
 23292        PERFORM 9700-DATE-LINK
 23293        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23294
 23295     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23296     MOVE SPACE                  TO DC-OPTION-CODE.
 23297     PERFORM 9700-DATE-LINK.
 23298     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23299
 23300     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23301     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23302
 23303     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23304        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23305                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23306
 23307     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23308     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23309     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23310
 23311     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23312        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23313                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23314
 23315     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 429
* EL6311.cbl
 23316     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23317     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23318
 23319     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23320        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23321                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23322
 23323     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23324     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23325
 23326     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23327        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23328                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23329
 23330     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23331     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23332     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23333
 23334     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23335        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23336                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23337
 23338     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23339     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23340     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23341
 23342     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23343        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23344                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23345
 23346     MOVE -1                     TO DPFENTRL.
 23347     GO TO 8100-SEND-INITIAL-MAP.
 23348
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 430
* EL6311.cbl
 23350
 23351***************************************************************
 23352*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23353*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23354*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23355*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23356*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23357*     ARE THEN SET ACCORDINGLY.                               *
 23358*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23359*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23360*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23361***************************************************************
 23362
 23363******************************************************************
 23364*                                                                *
 23365*            E R R O R   A N A L Y S I S                         *
 23366*                                                                *
 23367******************************************************************
 23368
 23369******************************************************************
 23370*                                                                *
 23371*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23372*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23373*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23374*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23375*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23376*                                                                *
 23377*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23378*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23379*                                                                *
 23380******************************************************************
 23381
 23382 7300-FORMAT-ERRORS.
 23383     MOVE ' '                    TO PI-ERRORS-SW
 23384     IF PB-COMMON-ERRORS = LOW-VALUES
 23385        IF PB-FATAL-ERRORS
 23386           MOVE ER-2695          TO EMI-ERROR
 23387           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23388           GO TO 7399-EXIT.
 23389
 23390     MOVE +0                     TO WS-SUB4
 23391     move +0                     to pi-6311-fatal-ctr
 23392     .
 23393 7310-ERROR-LOOP.
 23394
 23395     ADD +1                      TO WS-SUB4.
 23396
 23397     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23398        GO TO 7350-SET-ERROR-FLAGS.
 23399
 23400     IF PI-COMPANY-ID = 'UCL'
 23401         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23402             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23403             MOVE ' '                   TO DC-OPTION-CODE
 23404             PERFORM 9700-DATE-LINK
 23405             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23406
 23407     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 431
* EL6311.cbl
 23408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23409     if (emi-fatal)
 23410        and (emi-error not = 1753 and 1754 and 1757 and
 23411                             1758 and 1759 and 1760)
 23412        add +1                   to pi-6311-fatal-ctr
 23413     end-if
 23414     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23415
 23416     GO TO 7310-ERROR-LOOP.
 23417
 23418
 23419 7350-SET-ERROR-FLAGS.
 23420
 23421     IF EMI-FATAL-CTR NOT = ZEROS
 23422        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23423        MOVE 'X'                 TO PB-FATAL-FLAG
 23424                                    PI-ERRORS-SW
 23425        GO TO 7355-SET-ERROR-FLAGS.
 23426
 23427     move ' ' to pi-unforced-sw
 23428     IF EMI-FORCABLE-CTR NOT = ZEROS
 23429        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23430        IF PB-ISSUE
 23431           IF PB-ISSUE-FORCE
 23432              MOVE 'F'           TO PB-FORCE-ER-CD
 23433              MOVE ER-2600       TO EMI-ERROR
 23434              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23435             ELSE
 23436              MOVE 'X'           TO PB-FORCE-ER-CD
 23437*                                   PI-ERRORS-SW
 23438          ELSE
 23439           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23440              MOVE 'F'           TO PB-FORCE-ER-CD
 23441                                    pi-unforced-sw
 23442              MOVE ER-2600       TO EMI-ERROR
 23443              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23444             ELSE
 23445              MOVE 'X'           TO PB-FORCE-ER-CD
 23446                                    pi-unforced-sw.
 23447*                                   PI-ERRORS-SW.
 23448
 23449     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23450     IF PB-ISSUE
 23451         MOVE 'I'                TO ENDT-RECORD-TYPE
 23452     ELSE
 23453         MOVE 'C'                TO ENDT-RECORD-TYPE
 23454     END-IF
 23455     MOVE +0                     TO ENDT-SEQ-NO
 23456
 23457
 23458* EXEC CICS READ
 23459*        DATASET   (FILE-ID-ERENDT)
 23460*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23461*        RIDFLD    (ERENDT-KEY)
 23462*        RESP      (WS-RESPONSE)
 23463*        GTEQ
 23464*    END-EXEC
 23465*    MOVE '&"S        G          (  N#00019642' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 432
* EL6311.cbl
 23466     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23468     MOVE X'204E233030303139363432' TO DFHEIV0(25:11)
 23469     CALL 'kxdfhei1' USING DFHEIV0,
 23470           FILE-ID-ERENDT,
 23471           DFHEIV20,
 23472           DFHEIV99,
 23473           ERENDT-KEY,
 23474           DFHEIV99,
 23475           DFHEIV99,
 23476           DFHEIV99
 23477     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23478         DFHEIV20
 23479     MOVE EIBRESP  TO WS-RESPONSE
 23480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23481
 23482     IF RESP-NORMAL
 23483        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23484        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23485            MOVE ER-0280          TO EMI-ERROR
 23486            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23487            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23488            EVALUATE TRUE
 23489              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23490                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23491              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23492                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23493              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23494                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23495            END-EVALUATE
 23496        END-IF
 23497     END-IF
 23498
 23499
 23500
 23501     IF FIRST-ENTRY OR
 23502        EIBAID = DFHPF1 OR DFHPF2
 23503        MOVE '0'                TO PI-EDIT-SW
 23504        GO TO 7399-EXIT.
 23505
 23506 7355-SET-ERROR-FLAGS.
 23507
 23508     IF EMI-WARNING-CTR NOT = ZEROS
 23509        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23510        MOVE 'W'                 TO PB-WARN-ER-CD.
 23511
 23512     IF PB-UNFORCED-ERRORS OR
 23513        PB-FATAL-ERRORS    OR
 23514        PB-RECORD-ON-HOLD  OR
 23515        PB-RECORD-RETURNED OR
 23516        PB-CANCELLATION
 23517          NEXT SENTENCE
 23518        ELSE
 23519          GO TO 7399-EXIT.
 23520
 23521
 23522* EXEC CICS  HANDLE CONDITION
 23523*           NOTFND   (7399-EXIT)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 433
* EL6311.cbl
 23524*    END-EXEC.
 23525*    MOVE '"$I                   ! Z #00019689' TO DFHEIV0
 23526     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23528     MOVE X'5A20233030303139363839' TO DFHEIV0(25:11)
 23529     CALL 'kxdfhei1' USING DFHEIV0
 23530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23531
 23532
 23533     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23534     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23535     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23536     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23537
 23538
 23539* EXEC CICS READ
 23540*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23541*        DATASET (FILE-ID-ELCERT)
 23542*        RIDFLD  (ELCERT-KEY)
 23543*        UPDATE
 23544*    END-EXEC.
 23545*    MOVE '&"S        EU         (   #00019698' TO DFHEIV0
 23546     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23547     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23548     MOVE X'2020233030303139363938' TO DFHEIV0(25:11)
 23549     CALL 'kxdfhei1' USING DFHEIV0,
 23550           FILE-ID-ELCERT,
 23551           DFHEIV20,
 23552           DFHEIV99,
 23553           ELCERT-KEY,
 23554           DFHEIV99,
 23555           DFHEIV99,
 23556           DFHEIV99
 23557     SET ADDRESS OF CERTIFICATE-MASTER TO
 23558         DFHEIV20
 23559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23560
 23561
 23562
 23563     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23564     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23565
 23566     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23567        GO TO 7360-REWRITE-CERT-MASTER.
 23568
 23569     IF PB-ISSUE
 23570        IF PB-RECORD-RETURNED
 23571            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23572            GO TO 7360-REWRITE-CERT-MASTER
 23573        ELSE
 23574            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23575            GO TO 7360-REWRITE-CERT-MASTER.
 23576
 23577     IF PB-RECORD-RETURNED
 23578         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23579         GO TO 7360-REWRITE-CERT-MASTER.
 23580
 23581     IF (PB-C-LF-CANCEL-VOIDED)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 434
* EL6311.cbl
 23582        or (pb-c-ah-cancel-voided)
 23583        IF (PB-UNFORCED-ERRORS OR
 23584            PB-FATAL-ERRORS    OR
 23585            PB-RECORD-ON-HOLD)
 23586            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23587            GO TO 7360-REWRITE-CERT-MASTER
 23588        ELSE
 23589            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23590            GO TO 7360-REWRITE-CERT-MASTER.
 23591
 23592     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23593                            OR PB-RECORD-ON-HOLD)
 23594        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23595     ELSE
 23596        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23597
 23598 7360-REWRITE-CERT-MASTER.
 23599
 23600     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23601        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23602
 23603* EXEC CICS UNLOCK
 23604*            DATASET    (FILE-ID-ELCERT)
 23605*       END-EXEC
 23606*    MOVE '&*                    #   #00019745' TO DFHEIV0
 23607     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23608     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23609     MOVE X'2020233030303139373435' TO DFHEIV0(25:11)
 23610     CALL 'kxdfhei1' USING DFHEIV0,
 23611           FILE-ID-ELCERT,
 23612           DFHEIV99
 23613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23614        GO TO 7399-EXIT.
 23615
 23616
 23617* EXEC CICS REWRITE
 23618*         DATASET    (FILE-ID-ELCERT)
 23619*         FROM       (CERTIFICATE-MASTER)
 23620*    END-EXEC.
 23621     MOVE LENGTH OF
 23622      CERTIFICATE-MASTER
 23623       TO DFHEIV11
 23624*    MOVE '&& L                  %   #00019750' TO DFHEIV0
 23625     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23626     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23627     MOVE X'2020233030303139373530' TO DFHEIV0(25:11)
 23628     CALL 'kxdfhei1' USING DFHEIV0,
 23629           FILE-ID-ELCERT,
 23630           CERTIFICATE-MASTER,
 23631           DFHEIV11,
 23632           DFHEIV99
 23633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23634
 23635
 23636 7399-EXIT.
 23637      EXIT.
 23638
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 435
* EL6311.cbl
 23640
 23641*************************************************************
 23642*                                                           *
 23643*              S E T   A T T R I B U T E S                  *
 23644*                                                           *
 23645*************************************************************
 23646
 23647 7400-SET-ATTRIBUTES.
 23648
 23649     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23650        GO TO 7499-EXIT.
 23651
 23652**2601**
 23653
 23654     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23655        IF PB-ISSUE
 23656           MOVE AL-UABON         TO BEFFDTA
 23657           GO TO 7499-EXIT
 23658         ELSE
 23659           MOVE AL-UABON         TO CEFFDTA
 23660           GO TO 7499-EXIT.
 23661
 23662**2604**
 23663
 23664     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23665        IF PB-ISSUE
 23666           MOVE AL-UABON         TO BTYPE1A
 23667           MOVE -1               TO BTYPE1L
 23668           MOVE  1               TO SET-CURSOR-SW
 23669           GO TO 7499-EXIT.
 23670
 23671**2605**
 23672
 23673     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23674        IF PB-ISSUE
 23675           MOVE AL-UABON         TO BTYPE2A
 23676           MOVE -1               TO BTYPE2L
 23677           MOVE  1               TO SET-CURSOR-SW
 23678           GO TO 7499-EXIT.
 23679
 23680**2606**
 23681
 23682     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23683        IF PB-ISSUE
 23684           MOVE AL-UABON         TO BSIGA
 23685           MOVE -1               TO BSIGL
 23686           MOVE  1               TO SET-CURSOR-SW
 23687           GO TO 7499-EXIT.
 23688
 23689**2607**
 23690
 23691     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23692        IF PB-ISSUE
 23693           MOVE AL-UABON         TO BSIGA
 23694           MOVE -1               TO BSIGL
 23695           MOVE  1               TO SET-CURSOR-SW
 23696           GO TO 7499-EXIT.
 23697
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 436
* EL6311.cbl
 23698**2615**
 23699
 23700     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23701        IF PB-ISSUE
 23702           MOVE AL-UABOF         TO BREINA
 23703           MOVE -1               TO BREINL
 23704           GO TO 7499-EXIT.
 23705
 23706**2622**
 23707
 23708     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23709        IF PB-ISSUE
 23710           MOVE AL-UABON         TO BEFFDTA
 23711           GO TO 7499-EXIT
 23712        ELSE
 23713           MOVE AL-UABON         TO CEFFDTA
 23714           GO TO 7499-EXIT.
 23715
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 437
* EL6311.cbl
 23717
 23718*************************************************************
 23719*                                                           *
 23720*              I S S U E   E R R O R S                      *
 23721*                                                           *
 23722*************************************************************
 23723
 23724 7420-ISSUE-ERRORS.
 23725
 23726**2626**
 23727
 23728     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23729        MOVE AL-UABON            TO BCERTNOA
 23730        GO TO 7499-EXIT.
 23731
 23732**2627**
 23733
 23734     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23735        MOVE AL-UNBON            TO BAGEA
 23736        MOVE -1                  TO BAGEL
 23737        MOVE  1                  TO SET-CURSOR-SW
 23738        GO TO 7499-EXIT.
 23739
 23740**2628**
 23741
 23742     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23743        MOVE AL-UNBON            TO BAGEA
 23744        MOVE -1                  TO BAGEL
 23745        MOVE  1                  TO SET-CURSOR-SW
 23746        GO TO 7499-EXIT.
 23747
 23748**2629**
 23749
 23750     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23751        MOVE AL-UABON            TO BSEXA
 23752        MOVE -1                  TO BSEXL
 23753        MOVE  1                  TO SET-CURSOR-SW
 23754        GO TO 7499-EXIT.
 23755
 23756**2630**
 23757
 23758     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23759        MOVE -1                  TO BTYPE1L
 23760        MOVE  1                  TO SET-CURSOR-SW
 23761        GO TO 7499-EXIT.
 23762
 23763**2631**
 23764
 23765     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23766        MOVE -1                  TO BTYPE1L
 23767        MOVE  1                  TO SET-CURSOR-SW
 23768        GO TO 7499-EXIT.
 23769
 23770**2632**
 23771
 23772     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23773        MOVE AL-UNBON            TO BBEN1A
 23774        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 438
* EL6311.cbl
 23775        MOVE  1                  TO SET-CURSOR-SW
 23776        GO TO 7499-EXIT.
 23777
 23778**2633**
 23779
 23780     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23781        MOVE AL-UNBON            TO BPREM1A
 23782        MOVE -1                  TO BPREM1L
 23783        MOVE  1                  TO SET-CURSOR-SW
 23784        GO TO 7499-EXIT.
 23785
 23786**2634**
 23787
 23788     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23789        MOVE -1                  TO BTYPE2L
 23790        MOVE  1                  TO SET-CURSOR-SW
 23791        GO TO 7499-EXIT.
 23792
 23793**2635**
 23794
 23795     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23796        MOVE AL-UNBON            TO BBEN2A
 23797        MOVE -1                  TO BBEN2L
 23798        MOVE  1                  TO SET-CURSOR-SW
 23799        GO TO 7499-EXIT.
 23800
 23801**2636**
 23802
 23803     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23804        MOVE AL-UNBON            TO BPREM2A
 23805        MOVE -1                  TO BPREM2L
 23806        MOVE  1                  TO SET-CURSOR-SW
 23807        GO TO 7499-EXIT.
 23808
 23809**2639**
 23810
 23811     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23812        MOVE AL-UNBON            TO BBEN1A
 23813        MOVE -1                  TO BBEN1L
 23814        MOVE  1                  TO SET-CURSOR-SW
 23815        GO TO 7499-EXIT.
 23816
 23817**2640**
 23818
 23819     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23820        MOVE AL-UNBON            TO BBEN2A
 23821        MOVE -1                  TO BBEN2L
 23822        MOVE  1                  TO SET-CURSOR-SW
 23823        GO TO 7499-EXIT.
 23824
 23825**2647**
 23826
 23827     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23828        MOVE AL-UNBON            TO BTERM1A
 23829        MOVE -1                  TO BTERM1L
 23830        MOVE  1                  TO SET-CURSOR-SW
 23831        GO TO 7499-EXIT.
 23832
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 439
* EL6311.cbl
 23833**2648**
 23834
 23835     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23836        MOVE AL-UNBON            TO BLNTRMA
 23837        MOVE -1                  TO BLNTRML
 23838        MOVE  1                  TO SET-CURSOR-SW
 23839        GO TO 7499-EXIT.
 23840
 23841**2649**
 23842
 23843     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23844        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23845            MOVE AL-UNBON            TO BPREM1A
 23846            MOVE -1                  TO BPREM1L
 23847            MOVE  1                  TO SET-CURSOR-SW
 23848            GO TO 7499-EXIT
 23849     ELSE
 23850        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23851           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23852            MOVE AL-UNBON            TO BPREM2A
 23853            MOVE -1                  TO BPREM2L
 23854            MOVE  1                  TO SET-CURSOR-SW
 23855            GO TO 7499-EXIT.
 23856
 23857**2650**
 23858
 23859     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23860        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23861            MOVE AL-UNBON        TO BPREM1A
 23862            MOVE -1              TO BPREM1L
 23863            MOVE  1              TO SET-CURSOR-SW
 23864            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23865                MOVE AL-UNBON        TO BPREM2A
 23866                MOVE -1              TO BPREM2L
 23867                MOVE  1              TO SET-CURSOR-SW
 23868                GO TO 7499-EXIT
 23869            ELSE
 23870                GO TO 7499-EXIT
 23871        ELSE
 23872            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23873                MOVE AL-UNBON        TO BPREM2A
 23874                MOVE -1              TO BPREM2L
 23875                MOVE  1              TO SET-CURSOR-SW
 23876                GO TO 7499-EXIT
 23877            ELSE
 23878                GO TO 7499-EXIT.
 23879
 23880**2651**
 23881
 23882     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23883        MOVE AL-UABON            TO BSIGA
 23884        MOVE -1                  TO BSIGL
 23885        MOVE  1                  TO SET-CURSOR-SW
 23886        GO TO 7499-EXIT.
 23887
 23888**2653**
 23889
 23890     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 440
* EL6311.cbl
 23891        MOVE AL-UABON            TO BFREQA
 23892        MOVE -1                  TO BFREQL
 23893        MOVE  1                  TO SET-CURSOR-SW
 23894        GO TO 7499-EXIT.
 23895
 23896**2654**
 23897
 23898     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23899        MOVE AL-UABON            TO BFREQA
 23900        MOVE -1                  TO BFREQL
 23901        MOVE  1                  TO SET-CURSOR-SW
 23902        GO TO 7499-EXIT.
 23903
 23904**2655**
 23905
 23906     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23907        MOVE AL-UABON            TO BFREQA
 23908        MOVE -1                  TO BFREQL
 23909        MOVE  1                  TO SET-CURSOR-SW
 23910        GO TO 7499-EXIT.
 23911
 23912**2656**
 23913
 23914     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23915        MOVE AL-UNBON            TO BAPRA
 23916        MOVE -1                  TO BAPRL
 23917        MOVE  1                  TO SET-CURSOR-SW
 23918        GO TO 7499-EXIT.
 23919
 23920**2657**
 23921
 23922     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23923        MOVE AL-UNBON            TO BAPRA
 23924        MOVE -1                  TO BAPRL
 23925        MOVE  1                  TO SET-CURSOR-SW
 23926        GO TO 7499-EXIT.
 23927
 23928**2658**
 23929
 23930     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23931        MOVE AL-UNBON            TO BTERM2A
 23932        MOVE -1                  TO BTERM2L
 23933        MOVE  1                  TO SET-CURSOR-SW
 23934        GO TO 7499-EXIT.
 23935
 23936**2660**
 23937
 23938     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23939        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23940        MOVE -1                  TO BLSTNML
 23941        MOVE  1                  TO SET-CURSOR-SW
 23942        GO TO 7499-EXIT.
 23943
 23944
 23945**2662**
 23946
 23947     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23948        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 441
* EL6311.cbl
 23949        MOVE -1                  TO BAGEL
 23950        MOVE  1                  TO SET-CURSOR-SW
 23951        GO TO 7499-EXIT.
 23952
 23953**2663**
 23954
 23955     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23956        MOVE AL-UNBON            TO BAGEA
 23957        MOVE -1                  TO BAGEL
 23958        MOVE  1                  TO SET-CURSOR-SW
 23959        GO TO 7499-EXIT.
 23960
 23961**2664**
 23962
 23963     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23964        MOVE AL-UABON            TO BREINA
 23965        MOVE -1                  TO BREINL
 23966        MOVE  1                  TO SET-CURSOR-SW
 23967        GO TO 7499-EXIT.
 23968
 23969**2667**
 23970
 23971     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23972        MOVE AL-UNBON            TO BBEN2A
 23973        MOVE -1                  TO BBEN2L
 23974        MOVE  1                  TO SET-CURSOR-SW
 23975        GO TO 7499-EXIT.
 23976
 23977**2668**
 23978
 23979     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23980        MOVE AL-UABON            TO BEFFDTA
 23981        GO TO 7499-EXIT.
 23982
 23983**2669**
 23984
 23985     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23986       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23987       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23988        MOVE AL-UNBON            TO BAGEA
 23989        MOVE -1                  TO BAGEL
 23990        MOVE  1                  TO SET-CURSOR-SW
 23991        GO TO 7499-EXIT.
 23992
 23993**2670**
 23994
 23995     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23996        MOVE AL-UABON            TO BFORCEA
 23997        MOVE -1                  TO BFORCEL
 23998        MOVE  1                  TO SET-CURSOR-SW
 23999        GO TO 7499-EXIT.
 24000
 24001**2671**
 24002
 24003     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 24004        MOVE AL-UABON            TO BEFFDTA
 24005        GO TO 7499-EXIT.
 24006
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 442
* EL6311.cbl
 24007**2672**
 24008
 24009     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 24010        MOVE AL-UABON            TO BEFFDTA
 24011        GO TO 7499-EXIT.
 24012
 24013**2673**
 24014
 24015     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24016        MOVE AL-UABON            TO BEFFDTA
 24017        GO TO 7499-EXIT.
 24018
 24019**2674**
 24020
 24021     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24022        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 24023        MOVE -1                  TO BTYPE1L
 24024        MOVE  1                  TO SET-CURSOR-SW
 24025        GO TO 7499-EXIT.
 24026
 24027**2677**
 24028
 24029     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 24030        MOVE AL-UNBON            TO BTERM1A
 24031        MOVE -1                  TO BTERM1L
 24032        MOVE  1                  TO SET-CURSOR-SW
 24033        GO TO 7499-EXIT.
 24034
 24035**2678**
 24036
 24037     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 24038        MOVE AL-UNBON            TO BTERM2A
 24039        MOVE -1                  TO BTERM2L
 24040        MOVE  1                  TO SET-CURSOR-SW
 24041        GO TO 7499-EXIT.
 24042
 24043**2679**
 24044
 24045     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 24046        MOVE AL-UABON            TO BTYPE1A
 24047        MOVE -1                  TO BTYPE1L
 24048        MOVE  1                  TO SET-CURSOR-SW
 24049        GO TO 7499-EXIT.
 24050
 24051**2680**
 24052
 24053     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 24054        MOVE AL-UABOF            TO B1STPMTA
 24055        MOVE -1                  TO B1STPMTL
 24056        MOVE  1                  TO SET-CURSOR-SW
 24057        GO TO 7499-EXIT.
 24058
 24059**2681**
 24060
 24061     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 24062        MOVE AL-UABON            TO BDAYSA
 24063        MOVE -1                  TO BDAYSL
 24064        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 443
* EL6311.cbl
 24065        GO TO 7499-EXIT.
 24066
 24067**2682**
 24068
 24069     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 24070        MOVE AL-UABON            TO BTERM1A
 24071        MOVE -1                  TO BTERM1L
 24072        MOVE  1                  TO SET-CURSOR-SW
 24073        GO TO 7499-EXIT.
 24074
 24075**2683**
 24076
 24077     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 24078        MOVE AL-UABON            TO BSKPCDA
 24079        MOVE -1                  TO BSKPCDL
 24080        MOVE  1                  TO SET-CURSOR-SW
 24081        GO TO 7499-EXIT.
 24082
 24083**2684**
 24084
 24085     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 24086        MOVE AL-UABON            TO BTYPE2A
 24087        MOVE -1                  TO BTYPE2L
 24088        MOVE  1                  TO SET-CURSOR-SW
 24089        GO TO 7499-EXIT.
 24090
 24091**2686**
 24092
 24093     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 24094        MOVE AL-UABON            TO BTYPE2A
 24095        MOVE -1                  TO BTYPE2L
 24096        MOVE  1                  TO SET-CURSOR-SW
 24097        GO TO 7499-EXIT.
 24098
 24099**2689**
 24100
 24101     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 24102        MOVE AL-UABON            TO BSIGA
 24103        MOVE -1                  TO BSIGL
 24104        MOVE  1                  TO SET-CURSOR-SW
 24105        GO TO 7499-EXIT.
 24106
 24107**2690**
 24108
 24109     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 24110        MOVE AL-UABOF            TO BLNOFCRA
 24111        MOVE -1                  TO BLNOFCRL
 24112        MOVE  1                  TO SET-CURSOR-SW
 24113        GO TO 7499-EXIT.
 24114
 24115**2693**
 24116
 24117     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 24118        MOVE AL-UABOF            TO BLNOFCRA
 24119        MOVE AL-UNBON            TO BBEN1A
 24120        MOVE -1                  TO BBEN1L
 24121        MOVE  1                  TO SET-CURSOR-SW
 24122        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 444
* EL6311.cbl
 24123
 24124**2720**
 24125
 24126     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 24127        MOVE AL-UNBON            TO BBEN1A
 24128        MOVE -1                  TO BBEN1L
 24129        MOVE  1                  TO SET-CURSOR-SW
 24130        GO TO 7499-EXIT.
 24131
 24132**2709**
 24133
 24134*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 24135*       MOVE AL-UNBON            TO BBEN1A
 24136*       MOVE -1                  TO BBEN1L
 24137*       MOVE  1                  TO SET-CURSOR-SW
 24138*       GO TO 7499-EXIT.
 24139
 24140*************************************************************
 24141*                                                           *
 24142*            C A N C E L   E R R O R S                      *
 24143*                                                           *
 24144*************************************************************
 24145
 24146**2726**
 24147
 24148     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 24149        MOVE AL-UABON            TO CCERTNOA
 24150        GO TO 7499-EXIT.
 24151
 24152**2728**
 24153
 24154     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 24155        MOVE AL-UABON            TO CCERTNOA
 24156        GO TO 7499-EXIT.
 24157
 24158**2729**
 24159
 24160     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24161        MOVE AL-UABON            TO CCERTNOA
 24162        GO TO 7499-EXIT.
 24163
 24164**2730**
 24165
 24166     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24167        MOVE AL-UABON            TO CCERTNOA
 24168        GO TO 7499-EXIT.
 24169
 24170**2731**
 24171
 24172     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24173        MOVE AL-UABON            TO CCANDT1A
 24174        MOVE -1                  TO CCANDT1L
 24175        MOVE  1                  TO SET-CURSOR-SW
 24176        GO TO 7499-EXIT.
 24177
 24178**2732**
 24179
 24180     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 445
* EL6311.cbl
 24181        MOVE AL-UABON            TO CCANDT1A
 24182        MOVE -1                  TO CCANDT1L
 24183        MOVE  1                  TO SET-CURSOR-SW
 24184        GO TO 7499-EXIT.
 24185
 24186**2733**
 24187
 24188     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24189        MOVE AL-UABON            TO CCANDT1A
 24190        MOVE -1                  TO CCANDT1L
 24191        MOVE  1                  TO SET-CURSOR-SW
 24192        GO TO 7499-EXIT.
 24193
 24194**2734**
 24195
 24196     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24197        MOVE AL-UNBON            TO CREFND1A
 24198        MOVE -1                  TO CREFND1L
 24199        MOVE  1                  TO SET-CURSOR-SW
 24200        GO TO 7499-EXIT.
 24201
 24202**2735**
 24203
 24204     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24205        MOVE AL-UABON            TO CCANDT2A
 24206        MOVE -1                  TO CCANDT2L
 24207        MOVE  1                  TO SET-CURSOR-SW
 24208        GO TO 7499-EXIT.
 24209
 24210**2736**
 24211
 24212     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24213        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24214            MOVE AL-UNBON        TO CREFND1A
 24215            MOVE -1              TO CREFND1L
 24216            MOVE  1              TO SET-CURSOR-SW
 24217            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24218                MOVE AL-UNBON        TO CREFND2A
 24219                MOVE -1              TO CREFND2L
 24220                MOVE  1              TO SET-CURSOR-SW
 24221                GO TO 7499-EXIT
 24222            ELSE
 24223                GO TO 7499-EXIT
 24224        ELSE
 24225            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24226                MOVE AL-UNBON        TO CREFND2A
 24227                MOVE -1              TO CREFND2L
 24228                MOVE  1              TO SET-CURSOR-SW
 24229                GO TO 7499-EXIT
 24230            ELSE
 24231                GO TO 7499-EXIT.
 24232
 24233**2738**
 24234
 24235     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24236        MOVE -1                  TO CREFND2L
 24237        MOVE  1                  TO SET-CURSOR-SW
 24238        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 446
* EL6311.cbl
 24239
 24240**2739**
 24241
 24242     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24243        MOVE -1                  TO CREFND1L
 24244        MOVE  1                  TO SET-CURSOR-SW
 24245        GO TO 7499-EXIT.
 24246
 24247**2741**
 24248
 24249     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24250        MOVE -1                  TO CREFND1L
 24251        MOVE  1                  TO SET-CURSOR-SW
 24252        GO TO 7499-EXIT.
 24253
 24254**2743**
 24255
 24256     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24257        MOVE AL-UNBON            TO CCANDT1A
 24258        MOVE -1                  TO CCANDT1L
 24259        MOVE  1                  TO SET-CURSOR-SW
 24260        GO TO 7499-EXIT.
 24261
 24262**2744**
 24263
 24264     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24265        MOVE AL-UNBON            TO CCANDT2A
 24266        MOVE -1                  TO CCANDT2L
 24267        MOVE  1                  TO SET-CURSOR-SW
 24268        GO TO 7499-EXIT.
 24269
 24270**2747**
 24271
 24272     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24273        MOVE AL-UABON            TO CLSTNMA
 24274        MOVE -1                  TO CLSTNML
 24275        MOVE  1                  TO SET-CURSOR-SW
 24276        GO TO 7499-EXIT.
 24277
 24278**2749**
 24279
 24280     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24281        MOVE AL-UABON            TO CFORCEA
 24282        MOVE -1                  TO CFORCEL
 24283        MOVE  1                  TO SET-CURSOR-SW
 24284        GO TO 7499-EXIT.
 24285
 24286**2753**
 24287
 24288     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24289        MOVE AL-UNBON            TO CCANDT1A
 24290        MOVE -1                  TO CCANDT1L
 24291        MOVE  1                  TO SET-CURSOR-SW
 24292        GO TO 7499-EXIT.
 24293
 24294**2755**
 24295
 24296     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 447
* EL6311.cbl
 24297        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24298            MOVE AL-UNBON        TO CREFND1A
 24299            MOVE -1              TO CREFND1L
 24300            MOVE  1              TO SET-CURSOR-SW
 24301            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24302                MOVE AL-UNBON        TO CREFND2A
 24303                MOVE -1              TO CREFND2L
 24304                MOVE  1              TO SET-CURSOR-SW
 24305                GO TO 7499-EXIT
 24306            ELSE
 24307                GO TO 7499-EXIT
 24308        ELSE
 24309            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24310                MOVE AL-UNBON        TO CREFND2A
 24311                MOVE -1              TO CREFND2L
 24312                MOVE  1              TO SET-CURSOR-SW
 24313            ELSE
 24314                GO TO 7499-EXIT.
 24315
 24316**2757**
 24317
 24318     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24319        MOVE AL-UNBON            TO CLIVESA
 24320        MOVE -1                  TO CLIVESL
 24321        MOVE  1                  TO SET-CURSOR-SW
 24322        GO TO 7499-EXIT.
 24323
 24324**2771**
 24325
 24326     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24327        MOVE AL-UABON            TO CCANDT2A
 24328        MOVE -1                  TO CCANDT2L
 24329        MOVE  1                  TO SET-CURSOR-SW
 24330        GO TO 7499-EXIT.
 24331
 24332**2774**
 24333
 24334     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24335        MOVE AL-UABON            TO CCANDT1A
 24336        MOVE -1                  TO CCANDT1L
 24337        MOVE  1                  TO SET-CURSOR-SW
 24338        GO TO 7499-EXIT.
 24339
 24340**2775**
 24341
 24342     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24343        MOVE AL-UABON            TO CCANDT2A
 24344        MOVE -1                  TO CCANDT2L
 24345        MOVE  1                  TO SET-CURSOR-SW
 24346        GO TO 7499-EXIT.
 24347
 24348**2776**
 24349
 24350     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24351        MOVE AL-UABON            TO CCANDT1A
 24352        MOVE -1                  TO CCANDT1L
 24353        MOVE  1                  TO SET-CURSOR-SW
 24354        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 448
* EL6311.cbl
 24355
 24356
 24357**2777**
 24358
 24359     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24360        MOVE AL-UABON            TO CCANDT2A
 24361        MOVE -1                  TO CCANDT2L
 24362        MOVE  1                  TO SET-CURSOR-SW
 24363        GO TO 7499-EXIT.
 24364
 24365**2794**
 24366
 24367     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24368        MOVE AL-UABON            TO CFORCEA
 24369        MOVE -1                  TO CFORCEL
 24370        MOVE  1                  TO SET-CURSOR-SW
 24371        GO TO 7499-EXIT.
 24372
 24373**2799**
 24374
 24375     IF PI-COMPANY-ID = 'UCL'
 24376         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24377             MOVE AL-UNBON            TO BEFFDTA
 24378             MOVE -1                  TO BEFFDTL
 24379             MOVE  1                  TO SET-CURSOR-SW
 24380             GO TO 7499-EXIT.
 24381
 24382 7499-EXIT.
 24383      EXIT.
 24384
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 449
* EL6311.cbl
 24386
 24387 7500-READ-ERLOFC.
 24388     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24389                                     ERLOFC-KEY.
 24390
 24391     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24392
 24393     IF ST-ACCNT-CNTL
 24394         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24395
 24396     IF CARR-GROUP-ST-ACCNT-CNTL
 24397         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24398         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24399         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24400
 24401     IF CARR-ST-ACCNT-CNTL
 24402         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24403         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24404
 24405     IF CARR-ACCNT-CNTL
 24406         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24407
 24408     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24409
 24410     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24411
 24412
 24413* EXEC CICS HANDLE CONDITION
 24414*        NOTFND   (7550-OFFICER-NOTFND)
 24415*    END-EXEC.
 24416*    MOVE '"$I                   ! [ #00020531' TO DFHEIV0
 24417     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24419     MOVE X'5B20233030303230353331' TO DFHEIV0(25:11)
 24420     CALL 'kxdfhei1' USING DFHEIV0
 24421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24422
 24423
 24424
 24425* EXEC CICS READ
 24426*        DATASET   (FILE-ID-ERLOFC)
 24427*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24428*        RIDFLD    (ERLOFC-KEY)
 24429*        EQUAL
 24430*    END-EXEC.
 24431*    MOVE '&"S        E          (   #00020535' TO DFHEIV0
 24432     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24434     MOVE X'2020233030303230353335' TO DFHEIV0(25:11)
 24435     CALL 'kxdfhei1' USING DFHEIV0,
 24436           FILE-ID-ERLOFC,
 24437           DFHEIV20,
 24438           DFHEIV99,
 24439           ERLOFC-KEY,
 24440           DFHEIV99,
 24441           DFHEIV99,
 24442           DFHEIV99
 24443     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 450
* EL6311.cbl
 24444         DFHEIV20
 24445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24446
 24447
 24448     GO TO 7599-EXIT.
 24449
 24450 7550-OFFICER-NOTFND.
 24451     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24452
 24453 7599-EXIT.
 24454      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 451
* EL6311.cbl
 24456******************************************************************
 24457*                                                                *
 24458*            S  E N D    I N I T I A L   M A P                   *
 24459*                                                                *
 24460******************************************************************
 24461
 24462 8100-SEND-INITIAL-MAP.
 24463     MOVE EIBTIME                TO TIME-IN.
 24464
 24465     IF EIBAID = DFHPF11
 24466        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24467        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24468
 24469
 24470     IF PI-COMPANY-ID = CLIENT-GIC
 24471        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24472                                       BCPREM-ATTRB (2).
 24473
 24474     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24475                         CLIENT-PEM OR
 24476                         CLIENT-CSO)
 24477        AND PI-DISPLAY-ORIGINAL-BATCH
 24478          IF PI-MAP-NAME = EL631B
 24479             MOVE AL-SADOF               TO BPF5HDRA
 24480                                            BPF4HDRA
 24481          ELSE
 24482             IF PI-MAP-NAME = EL631C
 24483                MOVE AL-SADOF            TO CPF5HDRA
 24484                                            CPF4HDRA.
 24485
 24486     IF PI-MAP-NAME = EL631B
 24487        MOVE AL-SADOF               TO BPF5HDRA
 24488     ELSE
 24489        MOVE AL-SADOF               TO CPF5HDRA
 24490     END-IF
 24491
 24492*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24493     IF PI-MAP-NAME = EL631B
 24494          IF PI-COMPANY-ID NOT = 'DMD'
 24495             MOVE AL-SANOF            TO BBILLEDA
 24496             MOVE AL-SADOF            TO DMDBILA.
 24497*DMD CUSTOM CODING*************END
 24498
 24499     IF PI-PROCESSOR-ID = 'LGXX'
 24500        IF PI-MAP-NAME = EL631B
 24501           MOVE AL-SABOF                    TO BREFHDGA
 24502           MOVE AL-SANOF                    TO BREFA
 24503        ELSE
 24504           IF PI-MAP-NAME = EL631C
 24505              MOVE AL-SABOF                 TO CREFHDGA
 24506              MOVE AL-SANOF                 TO CREFA.
 24507
 24508     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24509        continue
 24510     ELSE
 24511        IF PI-MAP-NAME = EL631C
 24512           MOVE AL-SADOF         TO CCANTXTA
 24513                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 452
* EL6311.cbl
 24514        end-if
 24515     end-if
 24516     IF PI-MAP-NAME = EL631D
 24517        IF PI-AR-PROCESSING
 24518           MOVE AL-SANOF            TO DREFHDGA
 24519        ELSE
 24520           MOVE AL-SADOF            TO DREFHDGA.
 24521
 24522     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24523        AND (PI-MAP-NAME = EL631B)
 24524        MOVE AL-SADOF            TO BVINHA
 24525                                    BVINA
 24526     END-IF
 24527     IF PI-MAP-NAME = EL631B
 24528        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24529        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24530                                 TO BREGIONO
 24531        MOVE PI-PROCESSOR-ID     TO BUSERO
 24532        IF CSR-EDIT-SESSION
 24533           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24534                                 TO BHEADO
 24535           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24536        ELSE
 24537           MOVE AL-SADOF         TO BF15HDRA
 24538           MOVE '4=B-HDR      '  TO BPF4HDRO
 24539        END-IF
 24540        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24541        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24542        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24543        MOVE WS-CURRENT-DT          TO BDATEO
 24544        MOVE TIME-OUT               TO BTIMEO
 24545        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24546        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24547        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24548        IF   WS-DISPLAY-SCREEN
 24549             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24550             MOVE PB-SV-CARRIER     TO BCARRO
 24551             MOVE PB-SV-GROUPING    TO BGROUPO
 24552             MOVE PB-SV-STATE       TO BSTATEO
 24553             MOVE PB-ACCOUNT        TO BACCTO
 24554        ELSE
 24555             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24556     ELSE
 24557        IF PI-MAP-NAME = EL631C
 24558           MOVE '4=B-HDR      '     TO CPF4HDRO
 24559           IF CSR-EDIT-SESSION
 24560              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24561                                 TO CHEADO
 24562           ELSE
 24563              MOVE AL-SADOF      TO CF15HDRA
 24564           END-IF
 24565           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24566           MOVE WS-CURRENT-DT          TO CDATEO
 24567           MOVE TIME-OUT               TO CTIMEO
 24568           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24569           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24570           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24571           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 453
* EL6311.cbl
 24572           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24573           MOVE WS-C-HDG               TO CAHHDGO
 24574           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24575           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24576           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24577           IF   WS-DISPLAY-SCREEN
 24578                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24579                MOVE PB-SV-CARRIER     TO CCARRO
 24580                MOVE PB-SV-GROUPING    TO CGROUPO
 24581                MOVE PB-SV-STATE       TO CSTATEO
 24582                MOVE PB-ACCOUNT        TO CACCTO
 24583           ELSE
 24584                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24585        ELSE
 24586           MOVE WS-CURRENT-DT          TO DDATEO
 24587           MOVE TIME-OUT               TO DTIMEO
 24588           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24589                                          WS-REFUND-HDG-OVERRIDE
 24590           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24591           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24592           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24593                                          WS-REFUND-HDG-OVERRIDE
 24594           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24595           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24596           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24597           IF CSR-EDIT-SESSION
 24598              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24599                                 TO DHEADO
 24600           END-IF
 24601           IF  WS-DISPLAY-SCREEN
 24602               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24603               MOVE PB-CARRIER         TO DCARRO
 24604               MOVE PB-GROUPING        TO DGROUPO
 24605               MOVE PB-STATE           TO DSTATEO
 24606               MOVE PB-ACCOUNT         TO DACCTO
 24607               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24608           ELSE
 24609               MOVE EL631D             TO PI-MAP-NAME
 24610               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24611               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24612
 24613     MOVE SPACE                        TO WS-DISPLAY-SW.
 24614
 24615
 24616* EXEC CICS SEND
 24617*        MAP      (PI-MAP-NAME)
 24618*        MAPSET   (MAPSET-EL6311S)
 24619*        FROM     (EL631BI)
 24620*        ERASE
 24621*        CURSOR
 24622*    END-EXEC.
 24623     MOVE LENGTH OF
 24624      EL631BI
 24625       TO DFHEIV12
 24626     MOVE -1
 24627       TO DFHEIV11
 24628*    MOVE '8$     CT  E    H L F ,   #00020709' TO DFHEIV0
 24629     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 454
* EL6311.cbl
 24630     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24631     MOVE X'2020233030303230373039' TO DFHEIV0(25:11)
 24632     CALL 'kxdfhei1' USING DFHEIV0,
 24633           PI-MAP-NAME,
 24634           EL631BI,
 24635           DFHEIV12,
 24636           MAPSET-EL6311S,
 24637           DFHEIV99,
 24638           DFHEIV99,
 24639           DFHEIV99,
 24640           DFHEIV11,
 24641           DFHEIV99,
 24642           DFHEIV99,
 24643           DFHEIV99
 24644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24645
 24646
 24647     GO TO 9100-RETURN-TRAN.
 24648
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 455
* EL6311.cbl
 24650
 24651******************************************************************
 24652*                                                                *
 24653*              S E N D    D A T A O N L Y                        *
 24654*                                                                *
 24655******************************************************************
 24656
 24657 8200-SEND-DATAONLY.
 24658     MOVE EIBTIME                TO TIME-IN.
 24659
 24660     IF PI-COMPANY-ID = CLIENT-GIC
 24661        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24662                                       BCPREM-ATTRB (2).
 24663
 24664     IF PI-MAP-NAME = EL631B
 24665        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24666        MOVE WS-CURRENT-DT          TO BDATEO
 24667        MOVE TIME-OUT               TO BTIMEO
 24668        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24669        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24670        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24671        MOVE SPACES                 TO BPFENTRO
 24672        MOVE AL-UANOF               TO BPFENTRA
 24673
 24674*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24675        IF PI-COMPANY-ID NOT = 'DMD'
 24676             MOVE AL-SANOF            TO BBILLEDA
 24677             MOVE AL-SADOF            TO DMDBILA
 24678         ELSE
 24679            NEXT SENTENCE
 24680*DMD CUSTOM CODING*************END
 24681     ELSE
 24682        IF PI-MAP-NAME = EL631C
 24683           MOVE WS-CURRENT-DT          TO CDATEO
 24684           MOVE TIME-OUT               TO CTIMEO
 24685           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24686           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24687           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24688           MOVE SPACES                 TO CPFENTRO
 24689           MOVE AL-UANOF               TO CPFENTRA
 24690        ELSE
 24691           MOVE WS-CURRENT-DT          TO DDATEO
 24692           MOVE TIME-OUT               TO DTIMEO
 24693           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24694
 24695
 24696* EXEC CICS SEND
 24697*        MAP      (PI-MAP-NAME)
 24698*        MAPSET   (MAPSET-EL6311S)
 24699*        FROM     (EL631BI)
 24700*        DATAONLY
 24701*        CURSOR
 24702*    END-EXEC.
 24703     MOVE LENGTH OF
 24704      EL631BI
 24705       TO DFHEIV12
 24706     MOVE -1
 24707       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 456
* EL6311.cbl
 24708*    MOVE '8$D    CT       H L F ,   #00020765' TO DFHEIV0
 24709     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24710     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24711     MOVE X'2020233030303230373635' TO DFHEIV0(25:11)
 24712     CALL 'kxdfhei1' USING DFHEIV0,
 24713           PI-MAP-NAME,
 24714           EL631BI,
 24715           DFHEIV12,
 24716           MAPSET-EL6311S,
 24717           DFHEIV99,
 24718           DFHEIV99,
 24719           DFHEIV99,
 24720           DFHEIV11,
 24721           DFHEIV99,
 24722           DFHEIV99,
 24723           DFHEIV99
 24724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24725
 24726
 24727     GO TO 9100-RETURN-TRAN.
 24728
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 457
* EL6311.cbl
 24730
 24731******************************************************************
 24732*                                                                *
 24733*           U T I L I T Y   R O U T I N E S                      *
 24734*                                                                *
 24735******************************************************************
 24736
 24737 8300-SEND-TEXT.
 24738
 24739* EXEC CICS SEND TEXT
 24740*        FROM     (LOGOFF-TEXT)
 24741*        LENGTH   (LOGOFF-LENGTH)
 24742*        ERASE
 24743*        FREEKB
 24744*    END-EXEC.
 24745*    MOVE '8&      T  E F  H   F -   #00020784' TO DFHEIV0
 24746     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24747     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24748     MOVE X'2020233030303230373834' TO DFHEIV0(25:11)
 24749     CALL 'kxdfhei1' USING DFHEIV0,
 24750           LOGOFF-TEXT,
 24751           LOGOFF-LENGTH,
 24752           DFHEIV99,
 24753           DFHEIV99,
 24754           DFHEIV99,
 24755           DFHEIV99,
 24756           DFHEIV99,
 24757           DFHEIV99,
 24758           DFHEIV99,
 24759           DFHEIV99,
 24760           DFHEIV99,
 24761           DFHEIV99
 24762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24763
 24764
 24765
 24766* EXEC CICS RETURN
 24767*    END-EXEC.
 24768*    MOVE '.(                    ''   #00020791' TO DFHEIV0
 24769     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24771     MOVE X'2020233030303230373931' TO DFHEIV0(25:11)
 24772     CALL 'kxdfhei1' USING DFHEIV0,
 24773           DFHEIV99,
 24774           DFHEIV99,
 24775           DFHEIV99,
 24776           DFHEIV99,
 24777           DFHEIV99,
 24778           DFHEIV99
 24779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24780
 24781
 24782 8400-LOG-JOURNAL-RECORD.
 24783     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24784     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24785
 24786*    EXEC CICS JOURNAL
 24787*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 458
* EL6311.cbl
 24788*        JTYPEID     ('EL')
 24789*        FROM        (JOURNAL-RECORD)
 24790*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24791*    END-EXEC.
 24792
 24793 8600-DEEDIT.
 24794
 24795* EXEC CICS BIF DEEDIT
 24796*         FIELD   (DEEDIT-FIELD)
 24797*         LENGTH  (15)
 24798*    END-EXEC.
 24799     MOVE 15
 24800       TO DFHEIV11
 24801*    MOVE '@"L                   #   #00020806' TO DFHEIV0
 24802     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24803     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24804     MOVE X'2020233030303230383036' TO DFHEIV0(25:11)
 24805     CALL 'kxdfhei1' USING DFHEIV0,
 24806           DEEDIT-FIELD,
 24807           DFHEIV11
 24808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24809
 24810
 24811 8800-UNAUTHORIZED-ACCESS.
 24812     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24813     GO TO 8300-SEND-TEXT.
 24814
 24815 8810-PF23.
 24816     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24817     MOVE XCTL-EL005             TO PGM-NAME.
 24818     GO TO 9300-XCTL.
 24819
 24820 9100-RETURN-TRAN.
 24821     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24822
 24823     IF  PI-MAP-NAME =  EL631B
 24824         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24825
 24826     IF  PI-MAP-NAME =  EL631C
 24827         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24828
 24829     IF  PI-MAP-NAME =  EL631D
 24830         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24831
 24832
 24833* EXEC CICS RETURN
 24834*        TRANSID    (TRANS-EXB1)
 24835*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24836*        LENGTH     (1300)
 24837*    END-EXEC.
 24838     MOVE 1300
 24839       TO DFHEIV11
 24840*    MOVE '.(CT                  ''   #00020832' TO DFHEIV0
 24841     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24842     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24843     MOVE X'2020233030303230383332' TO DFHEIV0(25:11)
 24844     CALL 'kxdfhei1' USING DFHEIV0,
 24845           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 459
* EL6311.cbl
 24846           PROGRAM-INTERFACE-BLOCK,
 24847           DFHEIV11,
 24848           DFHEIV99,
 24849           DFHEIV99,
 24850           DFHEIV99
 24851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24852
 24853
 24854 9200-RETURN-MAIN-MENU.
 24855     MOVE XCTL-EL626             TO PGM-NAME.
 24856     GO TO 9300-XCTL.
 24857
 24858 9300-XCTL.
 24859
 24860* EXEC CICS XCTL
 24861*        PROGRAM    (PGM-NAME)
 24862*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24863*        LENGTH     (PI-COMM-LENGTH)
 24864*    END-EXEC.
 24865*    MOVE '.$C                   %   #00020843' TO DFHEIV0
 24866     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24867     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24868     MOVE X'2020233030303230383433' TO DFHEIV0(25:11)
 24869     CALL 'kxdfhei1' USING DFHEIV0,
 24870           PGM-NAME,
 24871           PROGRAM-INTERFACE-BLOCK,
 24872           PI-COMM-LENGTH,
 24873           DFHEIV99
 24874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24875
 24876
 24877 9400-CLEAR.
 24878     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24879     GO TO 9300-XCTL.
 24880
 24881 9500-PF12.
 24882     MOVE XCTL-EL010             TO PGM-NAME.
 24883     GO TO 9300-XCTL.
 24884
 24885 9600-PGMID-ERROR.
 24886
 24887* EXEC CICS HANDLE CONDITION
 24888*        PGMIDERR    (8300-SEND-TEXT)
 24889*    END-EXEC.
 24890*    MOVE '"$L                   ! \ #00020858' TO DFHEIV0
 24891     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24893     MOVE X'5C20233030303230383538' TO DFHEIV0(25:11)
 24894     CALL 'kxdfhei1' USING DFHEIV0
 24895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24896
 24897
 24898     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24899     MOVE ' '                    TO PI-ENTRY-CD-1.
 24900     MOVE XCTL-EL005             TO PGM-NAME.
 24901     MOVE PGM-NAME               TO LOGOFF-PGM.
 24902     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24903     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 460
* EL6311.cbl
 24904
 24905 9700-DATE-LINK.
 24906     MOVE LINK-ELDATCV           TO PGM-NAME.
 24907
 24908* EXEC CICS LINK
 24909*        PROGRAM    (PGM-NAME)
 24910*        COMMAREA   (DATE-CONVERSION-DATA)
 24911*        LENGTH     (DC-COMM-LENGTH)
 24912*    END-EXEC.
 24913*    MOVE '."C                   (   #00020871' TO DFHEIV0
 24914     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24916     MOVE X'2020233030303230383731' TO DFHEIV0(25:11)
 24917     CALL 'kxdfhei1' USING DFHEIV0,
 24918           PGM-NAME,
 24919           DATE-CONVERSION-DATA,
 24920           DC-COMM-LENGTH,
 24921           DFHEIV99,
 24922           DFHEIV99,
 24923           DFHEIV99,
 24924           DFHEIV99
 24925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24926
 24927
 24928 9800-LINK-PENDING-EDIT.
 24929     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24930     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24931
 24932     MOVE LINK-EL050             TO PGM-NAME
 24933     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24934     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24935                                    WK-CO-TOL-CLAIM
 24936                                    WK-CO-TOL-PREM
 24937                                    WK-CO-TOL-REFUND
 24938                                    WK-CO-TOL-PREM-PCT
 24939                                    WK-CO-TOL-REFUND-PCT
 24940                                    WK-REFUND-OVS-AMT
 24941                                    WK-REFUND-OVS-PCT
 24942                                    WK-ACCT-ADDR
 24943                                    WK-LIFE-EDIT-ADDR
 24944                                    WK-AH-EDIT-ADDR
 24945                                    WK-LIFE-BEN-ADDR
 24946                                    WK-AH-BEN-ADDR
 24947                                    WK-STATE-ADDR
 24948                                    WK-PLAN-ADDR
 24949                                    WK-FORM-ADDR
 24950     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24951
 24952     MOVE '6'                    TO WK-ENTRY-SW.
 24953
 24954     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24955
 24956     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24957                                    EC-AM-EXPIRATION-DT
 24958                                    EC-AM-EFFECTIVE-DT
 24959                                    EC-CM-LF-CANCEL-DT
 24960                                    EC-CM-AH-CANCEL-DT
 24961                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 461
* EL6311.cbl
 24962
 24963     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24964                                    EC-CO-TOL-REFUND
 24965                                    EC-CO-MIN-AGE
 24966                                    EC-CO-MIN-PREMIUM
 24967                                    EC-CO-MIN-TERM
 24968                                    EC-CO-MAX-TERM
 24969                                    EC-ST-TOL-PREM
 24970                                    EC-ST-TOL-REFUND
 24971                                    EC-AM-LF-TOL-PREM
 24972                                    EC-AM-AH-TOL-PREM
 24973                                    EC-AM-LF-MAX-ATT-AGE
 24974                                    EC-AM-LF-MAX-AGE
 24975                                    EC-AM-LF-MAX-TERM
 24976                                    EC-AM-LF-MAX-TOT-BEN
 24977                                    EC-AM-AH-MAX-ATT-AGE
 24978                                    EC-AM-AH-MAX-AGE
 24979                                    EC-AM-AH-MAX-TERM
 24980                                    EC-AM-AH-MAX-TOT-BEN
 24981                                    EC-AM-AH-MAX-MON-BEN
 24982                                    EC-RT-LF-MAX-ATT-AGE
 24983                                    EC-RT-LF-MAX-AGE
 24984                                    EC-RT-LF-MAX-TERM
 24985                                    EC-RT-LF-MAX-TOT-BEN
 24986                                    EC-RT-AH-MAX-ATT-AGE
 24987                                    EC-RT-AH-MAX-AGE
 24988                                    EC-RT-AH-MAX-TERM
 24989                                    EC-RT-AH-MAX-TOT-BEN
 24990                                    EC-RT-AH-MAX-MON-BEN
 24991                                    EC-RT-AH-RATE
 24992                                    EC-RT-LF-RATE
 24993                                    EC-RT-LF-NSP-RATE
 24994                                    EC-RT-AH-NSP-RATE
 24995                                    EC-CM-LF-PRIOR-REFUND
 24996                                    EC-CM-AH-PRIOR-REFUND.
 24997
 24998     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24999                                    EC-ST-TOL-PREM-PCT
 25000                                    EC-AM-LF-TOL-REFUND
 25001                                    EC-AM-LF-DEV-PERCENT
 25002                                    EC-CO-TOL-REFUND-PCT
 25003                                    EC-ST-TOL-REFUND-PCT
 25004                                    EC-AM-AH-TOL-REFUND
 25005                                    EC-AM-AH-DEV-PERCENT.
 25006
 25007
 25008* EXEC CICS LINK
 25009*         PROGRAM   (PGM-NAME)
 25010*         COMMAREA  (PASSED-RECORD)
 25011*         LENGTH    (WS-EDIT-PASS-LENGTH)
 25012*    END-EXEC.
 25013*    MOVE '."C                   (   #00020956' TO DFHEIV0
 25014     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25015     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25016     MOVE X'2020233030303230393536' TO DFHEIV0(25:11)
 25017     CALL 'kxdfhei1' USING DFHEIV0,
 25018           PGM-NAME,
 25019           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 462
* EL6311.cbl
 25020           WS-EDIT-PASS-LENGTH,
 25021           DFHEIV99,
 25022           DFHEIV99,
 25023           DFHEIV99,
 25024           DFHEIV99
 25025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25026
 25027
 25028     MOVE '1'                    TO PI-EDIT-SW.
 25029     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 25030
 25031     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 25032
 25033     IF PI-COMPANY-ID = 'UCL'
 25034         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 25035
 25036     IF VALID-PB-ID
 25037        GO TO 9800-EXIT.
 25038
 25039     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 25040
 25041     IF PI-MAP-NAME = EL631B
 25042        MOVE -1                  TO BMAINTL
 25043       ELSE
 25044        MOVE -1                  TO CMAINTL.
 25045
 25046     GO TO 8200-SEND-DATAONLY.
 25047
 25048 9800-EXIT.
 25049      EXIT.
 25050
 25051 9900-ERROR-FORMAT.
 25052
 25053     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 25054
 25055     IF NOT EMI-ERRORS-COMPLETE
 25056         MOVE LINK-EL001         TO PGM-NAME
 25057
 25058* EXEC CICS LINK
 25059*            PROGRAM    (PGM-NAME)
 25060*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 25061*            LENGTH     (EMI-COMM-LENGTH)
 25062*        END-EXEC.
 25063*    MOVE '."C                   (   #00020991' TO DFHEIV0
 25064     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25065     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25066     MOVE X'2020233030303230393931' TO DFHEIV0(25:11)
 25067     CALL 'kxdfhei1' USING DFHEIV0,
 25068           PGM-NAME,
 25069           ERROR-MESSAGE-INTERFACE-BLOCK,
 25070           EMI-COMM-LENGTH,
 25071           DFHEIV99,
 25072           DFHEIV99,
 25073           DFHEIV99,
 25074           DFHEIV99
 25075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25076
 25077
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 463
* EL6311.cbl
 25078 9900-EXIT.
 25079     EXIT.
 25080
 25081 9990-ABEND.
 25082     MOVE LINK-EL004             TO PGM-NAME.
 25083     MOVE DFHEIBLK               TO EMI-LINE1.
 25084
 25085* EXEC CICS LINK
 25086*        PROGRAM   (PGM-NAME)
 25087*        COMMAREA  (EMI-LINE1)
 25088*        LENGTH    (72)
 25089*    END-EXEC.
 25090     MOVE 72
 25091       TO DFHEIV11
 25092*    MOVE '."C                   (   #00021003' TO DFHEIV0
 25093     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25095     MOVE X'2020233030303231303033' TO DFHEIV0(25:11)
 25096     CALL 'kxdfhei1' USING DFHEIV0,
 25097           PGM-NAME,
 25098           EMI-LINE1,
 25099           DFHEIV11,
 25100           DFHEIV99,
 25101           DFHEIV99,
 25102           DFHEIV99,
 25103           DFHEIV99
 25104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25105
 25106
 25107     IF PI-MAP-NAME = EL631B
 25108        MOVE -1                  TO BMAINTL
 25109       ELSE
 25110        MOVE -1                  TO CMAINTL.
 25111
 25112     IF EIBTRNID NOT = TRANS-EXB1
 25113        GO TO 8100-SEND-INITIAL-MAP
 25114       ELSE
 25115        GO TO 8200-SEND-DATAONLY.
 25116
 25117 9995-SECURITY-VIOLATION.
 25118*                            COPY ELCSCTP.
 25119******************************************************************
 25120*                                                                *
 25121*                            ELCSCTP                             *
 25122*                            VMOD=2.001                          *
 25123*                                                                *
 25124*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25125******************************************************************
 25126
 25127
 25128     MOVE EIBDATE          TO SM-JUL-DATE.
 25129     MOVE EIBTRMID         TO SM-TERMID.
 25130     MOVE THIS-PGM         TO SM-PGM.
 25131     MOVE EIBTIME          TO TIME-IN.
 25132     MOVE TIME-OUT         TO SM-TIME.
 25133     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25134
 25135
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 464
* EL6311.cbl
 25136* EXEC CICS LINK
 25137*         PROGRAM  ('EL003')
 25138*         COMMAREA (SECURITY-MESSAGE)
 25139*         LENGTH   (80)
 25140*    END-EXEC.
 25141     MOVE 'EL003' TO DFHEIV1
 25142     MOVE 80
 25143       TO DFHEIV11
 25144*    MOVE '."C                   (   #00021037' TO DFHEIV0
 25145     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25147     MOVE X'2020233030303231303337' TO DFHEIV0(25:11)
 25148     CALL 'kxdfhei1' USING DFHEIV0,
 25149           DFHEIV1,
 25150           SECURITY-MESSAGE,
 25151           DFHEIV11,
 25152           DFHEIV99,
 25153           DFHEIV99,
 25154           DFHEIV99,
 25155           DFHEIV99
 25156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25157
 25158
 25159******************************************************************
 25160
 25161
 25162 9999-DFHBACK SECTION.
 25163     MOVE '9%                    "   ' TO DFHEIV0
 25164     MOVE 'EL6311' TO DFHEIV1
 25165     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25166     GOBACK.
 25167 9999-DFHEXIT.
 25168     IF DFHEIGDJ EQUAL 0001
 25169         NEXT SENTENCE
 25170     ELSE IF DFHEIGDJ EQUAL 2
 25171         GO TO 9600-PGMID-ERROR,
 25172               9990-ABEND,
 25173               9990-ABEND,
 25174               0010-MAIN-LOGIC
 25175         DEPENDING ON DFHEIGDI
 25176     ELSE IF DFHEIGDJ EQUAL 3
 25177         GO TO 1280-BATCH-HDR-NOT-FOUND
 25178         DEPENDING ON DFHEIGDI
 25179     ELSE IF DFHEIGDJ EQUAL 4
 25180         GO TO 1290-DUPLICATE-ALT-INDEX
 25181         DEPENDING ON DFHEIGDI
 25182     ELSE IF DFHEIGDJ EQUAL 5
 25183         GO TO 1295-CERT-TRL-REC-NOTFND
 25184         DEPENDING ON DFHEIGDI
 25185     ELSE IF DFHEIGDJ EQUAL 6
 25186         GO TO 1380-BATCH-HDR-NOT-FOUND
 25187         DEPENDING ON DFHEIGDI
 25188     ELSE IF DFHEIGDJ EQUAL 7
 25189         GO TO 1385-REC-NOT-FOUND
 25190         DEPENDING ON DFHEIGDI
 25191     ELSE IF DFHEIGDJ EQUAL 8
 25192         GO TO 1386-NOTFND
 25193         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 465
* EL6311.cbl
 25194     ELSE IF DFHEIGDJ EQUAL 9
 25195         GO TO 1399-EXIT
 25196         DEPENDING ON DFHEIGDI
 25197     ELSE IF DFHEIGDJ EQUAL 10
 25198         GO TO 1480-BATCH-HDR-NOT-FOUND
 25199         DEPENDING ON DFHEIGDI
 25200     ELSE IF DFHEIGDJ EQUAL 11
 25201         GO TO 1490-RECORD-NOT-FOUND
 25202         DEPENDING ON DFHEIGDI
 25203     ELSE IF DFHEIGDJ EQUAL 12
 25204         GO TO 1405-DELETE-CERTIFICATE
 25205         DEPENDING ON DFHEIGDI
 25206     ELSE IF DFHEIGDJ EQUAL 13
 25207         GO TO 1420-CONTINUE-DELETE
 25208         DEPENDING ON DFHEIGDI
 25209     ELSE IF DFHEIGDJ EQUAL 14
 25210         GO TO 1406-DELETE-ERNOTE
 25211         DEPENDING ON DFHEIGDI
 25212     ELSE IF DFHEIGDJ EQUAL 15
 25213         GO TO 1407-DELETE-MAILING
 25214         DEPENDING ON DFHEIGDI
 25215     ELSE IF DFHEIGDJ EQUAL 16
 25216         GO TO 1420-CONTINUE-DELETE
 25217         DEPENDING ON DFHEIGDI
 25218     ELSE IF DFHEIGDJ EQUAL 17
 25219         GO TO 1480-BATCH-HDR-NOT-FOUND
 25220         DEPENDING ON DFHEIGDI
 25221     ELSE IF DFHEIGDJ EQUAL 18
 25222         GO TO 1475-DELETE-FINISHED
 25223         DEPENDING ON DFHEIGDI
 25224     ELSE IF DFHEIGDJ EQUAL 19
 25225         GO TO 2280-BATCH-HDR-NOT-FOUND
 25226         DEPENDING ON DFHEIGDI
 25227     ELSE IF DFHEIGDJ EQUAL 20
 25228         GO TO 2290-DUPLICATE-ALT-INDEX
 25229         DEPENDING ON DFHEIGDI
 25230     ELSE IF DFHEIGDJ EQUAL 21
 25231         GO TO 2380-BATCH-HDR-NOT-FOUND
 25232         DEPENDING ON DFHEIGDI
 25233     ELSE IF DFHEIGDJ EQUAL 22
 25234         GO TO 2385-REC-NOT-FOUND
 25235         DEPENDING ON DFHEIGDI
 25236     ELSE IF DFHEIGDJ EQUAL 23
 25237         GO TO 2380-BATCH-HDR-NOT-FOUND
 25238         DEPENDING ON DFHEIGDI
 25239     ELSE IF DFHEIGDJ EQUAL 24
 25240         GO TO 2485-BATCH-HDR-NOT-FOUND
 25241         DEPENDING ON DFHEIGDI
 25242     ELSE IF DFHEIGDJ EQUAL 25
 25243         GO TO 2490-RECORD-NOT-FOUND
 25244         DEPENDING ON DFHEIGDI
 25245     ELSE IF DFHEIGDJ EQUAL 26
 25246         GO TO 2475-CONTINUE-DELETE
 25247         DEPENDING ON DFHEIGDI
 25248     ELSE IF DFHEIGDJ EQUAL 27
 25249         GO TO 2485-BATCH-HDR-NOT-FOUND
 25250         DEPENDING ON DFHEIGDI
 25251     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 466
* EL6311.cbl
 25252         GO TO 2480-DELETE-FINISHED
 25253         DEPENDING ON DFHEIGDI
 25254     ELSE IF DFHEIGDJ EQUAL 29
 25255         GO TO 2820-PROCESS-REWRITE
 25256         DEPENDING ON DFHEIGDI
 25257     ELSE IF DFHEIGDJ EQUAL 30
 25258         GO TO 2885-RECORD-MISSING
 25259         DEPENDING ON DFHEIGDI
 25260     ELSE IF DFHEIGDJ EQUAL 31
 25261         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25262         DEPENDING ON DFHEIGDI
 25263     ELSE IF DFHEIGDJ EQUAL 32
 25264         GO TO 2827-DELETE-MAILING
 25265         DEPENDING ON DFHEIGDI
 25266     ELSE IF DFHEIGDJ EQUAL 33
 25267         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25268         DEPENDING ON DFHEIGDI
 25269     ELSE IF DFHEIGDJ EQUAL 34
 25270         GO TO 2920-PROCESS-REWRITE
 25271         DEPENDING ON DFHEIGDI
 25272     ELSE IF DFHEIGDJ EQUAL 35
 25273         GO TO 2985-RECORD-MISSING
 25274         DEPENDING ON DFHEIGDI
 25275     ELSE IF DFHEIGDJ EQUAL 36
 25276         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25277         DEPENDING ON DFHEIGDI
 25278     ELSE IF DFHEIGDJ EQUAL 37
 25279         GO TO 2990-DUPLICATE-RECORD
 25280         DEPENDING ON DFHEIGDI
 25281     ELSE IF DFHEIGDJ EQUAL 38
 25282         GO TO 3590-NOT-FOUND
 25283         DEPENDING ON DFHEIGDI
 25284     ELSE IF DFHEIGDJ EQUAL 39
 25285         GO TO 3690-NOT-FOUND
 25286         DEPENDING ON DFHEIGDI
 25287     ELSE IF DFHEIGDJ EQUAL 40
 25288         GO TO 3990-NOT-FOUND
 25289         DEPENDING ON DFHEIGDI
 25290     ELSE IF DFHEIGDJ EQUAL 41
 25291         GO TO 4050-END-RECORDS,
 25292               4050-END-RECORDS
 25293         DEPENDING ON DFHEIGDI
 25294     ELSE IF DFHEIGDJ EQUAL 42
 25295         GO TO 4150-END-BATCH
 25296         DEPENDING ON DFHEIGDI
 25297     ELSE IF DFHEIGDJ EQUAL 43
 25298         GO TO 4150-END-BATCH
 25299         DEPENDING ON DFHEIGDI
 25300     ELSE IF DFHEIGDJ EQUAL 44
 25301         GO TO 4250-END-RECORDS,
 25302               4250-END-RECORDS
 25303         DEPENDING ON DFHEIGDI
 25304     ELSE IF DFHEIGDJ EQUAL 45
 25305         GO TO 4350-END-BATCH,
 25306               4350-END-BATCH
 25307         DEPENDING ON DFHEIGDI
 25308     ELSE IF DFHEIGDJ EQUAL 46
 25309         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 22-Aug-18 13:16 Page 467
* EL6311.cbl
 25310               4550-END-RECORDS
 25311         DEPENDING ON DFHEIGDI
 25312     ELSE IF DFHEIGDJ EQUAL 47
 25313         GO TO 4680-NOT-FOUND,
 25314               4680-NOT-FOUND
 25315         DEPENDING ON DFHEIGDI
 25316     ELSE IF DFHEIGDJ EQUAL 48
 25317         GO TO 4860-NOT-FOUND,
 25318               4850-END-RECORDS
 25319         DEPENDING ON DFHEIGDI
 25320     ELSE IF DFHEIGDJ EQUAL 49
 25321         GO TO 4970-NOT-FOUND,
 25322               4950-END-RECORDS
 25323         DEPENDING ON DFHEIGDI
 25324     ELSE IF DFHEIGDJ EQUAL 50
 25325         GO TO 5050-NOT-FOUND
 25326         DEPENDING ON DFHEIGDI
 25327     ELSE IF DFHEIGDJ EQUAL 51
 25328         GO TO 5050-NOT-FOUND
 25329         DEPENDING ON DFHEIGDI
 25330     ELSE IF DFHEIGDJ EQUAL 52
 25331         GO TO 5050-NOT-FOUND
 25332         DEPENDING ON DFHEIGDI
 25333     ELSE IF DFHEIGDJ EQUAL 53
 25334         GO TO 5550-END-RECORDS,
 25335               5550-END-RECORDS
 25336         DEPENDING ON DFHEIGDI
 25337     ELSE IF DFHEIGDJ EQUAL 54
 25338         GO TO 6050-QID-ERROR
 25339         DEPENDING ON DFHEIGDI
 25340     ELSE IF DFHEIGDJ EQUAL 55
 25341         GO TO 6050-QID-ERROR
 25342         DEPENDING ON DFHEIGDI
 25343     ELSE IF DFHEIGDJ EQUAL 56
 25344         GO TO 6400-CONTINUE,
 25345               6400-CONTINUE
 25346         DEPENDING ON DFHEIGDI
 25347     ELSE IF DFHEIGDJ EQUAL 57
 25348         GO TO 3690-NOT-FOUND
 25349         DEPENDING ON DFHEIGDI
 25350     ELSE IF DFHEIGDJ EQUAL 58
 25351         GO TO 7399-EXIT
 25352         DEPENDING ON DFHEIGDI
 25353     ELSE IF DFHEIGDJ EQUAL 59
 25354         GO TO 7550-OFFICER-NOTFND
 25355         DEPENDING ON DFHEIGDI
 25356     ELSE IF DFHEIGDJ EQUAL 60
 25357         GO TO 8300-SEND-TEXT
 25358         DEPENDING ON DFHEIGDI.
 25359     MOVE '9%                    "   ' TO DFHEIV0
 25360     MOVE 'EL6311' TO DFHEIV1
 25361     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25362     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15972     Code:      100253
