* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    59* 092618  CR2018050200001  PEMA  Add check for open clm on issue
    60* 101019  CR2019100700001  PEMA  Disallow V status with claim
    61******************************************************************
    62 ENVIRONMENT DIVISION.
    63
    64 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page   3
* EL050.cbl
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68
    69 77  FILLER   PIC X(32) VALUE '********************************'.
    70 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    71 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    72
    73 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    74 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    75                                   USAGE POINTER.
    76 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    77 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    79                                   USAGE IS POINTER.
    80 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    82                                   USAGE IS POINTER.
    83 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    88 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    89                                   USAGE IS POINTER.
    90
    91*    COPY ELC50WS.
    92*****************************************************************
    93*                                                               *
    94*                            ELC50WS.                           *
    95*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    96*                            VMOD=2.061.                        *
    97*                                                               *
    98*   THIS IS THE WORKING STORAGE FOR EL050                       *
    99*                                   EL517                       *
   100*****************************************************************
   101******************************************************************
   102*                   C H A N G E   L O G
   103*
   104* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   105*-----------------------------------------------------------------
   106*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   107* EFFECTIVE    NUMBER
   108*-----------------------------------------------------------------
   109* 123102                   PEMA  ADD DCC PROCESSING
   110* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   111* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   112* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   113* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   114* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   115* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   116* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   117* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   118* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   119* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   120* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   121* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   122* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   123* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page   4
* EL050.cbl
   124* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   125* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   126* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   127* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   128* 030309  CR2009021700001  PEMA  ADD ER-2883
   129* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   130* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   132* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   133* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   134* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   135* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   136* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   137* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   138* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   139* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   140* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   141* 061412  CR2011022800001  AJRA  NAPERSOFT
   142* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   143* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   144* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   145* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   146* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   147* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   148* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   149* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   150* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   151* 091114  IR2014091000001  TANA  ADD ERROR 2898
   152* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   153* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   154* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   155* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   156* 100617  CR2017062000003  PEMA  Inforce state comm cap
   157* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   158* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   159* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   160* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   161* 100518  CR2017061500001  TANA  ADD NEW ERROR MSGS
   162* 092618  CR2018050200001  PEMA  Add check for open clm on issue
   163* 101019  CR2019100700001  PEMA  Add error 3281 V stat on claim
   164* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
   165* 012220  CR2018092700002  TANA  ADD NEW ERROR MSGS
   166* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM ERROR MSG.
   167* 030920  IR2020030500001  PEMA  ADD ERROR 3071
   168*-----------------------------------------------------------------
   169
   170 01  WORK-AREAS.
   171
   172*****************************************************************
   173*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   174*****************************************************************
   175
   176     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   177     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   178     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   179     12  WS-NAME-EDIT-WORK-AREA.
   180         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   181         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page   5
* EL050.cbl
   182             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   183         16  WS-WORK-NAME.
   184             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   185             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   186             20  FILLER           PIC X(10)     VALUE SPACES.
   187         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   188             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   189
   190*****************************************************************
   191*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   192*****************************************************************
   193
   194     12  WS-ERRESC-KEY.
   195         16 WS-ERRESC-SEARCH-KEY.
   196             20  WS-ERRESC-COMPANY-CD PIC  X.
   197             20  WS-ERRESC-CARRIER    PIC  X.
   198             20  WS-ERRESC-GROUP      PIC X(6).
   199             20  WS-ERRESC-STATE      PIC XX.
   200             20  WS-ERRESC-ACCOUNT    PIC X(10).
   201         16 WS-ERRESC-RESIDUAL-KEY.
   202             20  WS-ERRESC-AGENT      PIC X(10).
   203             20  WS-ERRESC-RES-STATE  PIC XX.
   204             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   205*                                          YYYYMMDD
   206     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   207     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   208
   209*RESIDENT STATE TAX MASTER(ERRESS)
   210*
   211     12  WS-ERRESS-KEY.
   212         16  WS-ERRESS-COMPANY-CD      PIC  X.
   213         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   214         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   215         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   216*                                          YYYYMMDD
   217
   218     12  WS-CONTRACT-DATE              PIC 9(8).
   219*                                          YYYYMMDD
   220     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   221     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   222         16 WS-YEAR-YY                 PIC   9999.
   223         16 FILLER                     PIC 9(4).
   224*                                          YYYYMMDD
   225     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   226     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   227     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   228     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   229
   230     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   231         88  DPRB-1ST-TIME                      VALUE ' '.
   232
   233*****************************************************************
   234*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   235*****************************************************************
   236
   237     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   238     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   239     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page   6
* EL050.cbl
   240     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   241     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   242     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   243     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   244     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   245     12  ws-st-agent-sig-edit    pic x          value spaces.
   246     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   247     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   250         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   251         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   252     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   253         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   254         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   255     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   256
   257     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   258     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   259
   260     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   261     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   266     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   269     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   270     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   274     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   275     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   281     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   282     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   283     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   284     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   285     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   286     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   287     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   288     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   289     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   290     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   291     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   292     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   293     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   294     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   295     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   296     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   297     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page   7
* EL050.cbl
   298     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   299     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   300     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   301     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   302     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   303     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   304     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   305     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   306     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   307     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   308     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   309     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   310     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   311     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   312     12  WS-2671-SW               PIC X         VALUE SPACE.
   313     12  WS-2672-SW               PIC X         VALUE SPACE.
   314     12  ws-9813-sw               pic x         value spaces.
   315     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   316         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   317     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   318         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   319     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   320
   321     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   322         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   323         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   324         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   325         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   326
   327     12  WS-CREDIT-EDIT-CONTROLS.
   328         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   329         16  WS-MIN-AGE           PIC 99                VALUE  0.
   330         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   331         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   332         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   333         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   334
   335     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   336     12  WS-AGE-FIELDS.
   337         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   338         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   339         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   340         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   341
   342     12  WS-SAVE-ALLOWABLE-BENEFIT.
   343         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   344         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   345         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   346         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   347         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   348         16  FILLER                      PIC XX.
   349
   350     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   351     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   352     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   353     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   354     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page   8
* EL050.cbl
   356     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   357     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   358     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   359     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   360
   361     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   362     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   363     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   364     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   365     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   366     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   367     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   368     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   369         88  WS-REDUCING              VALUE 'R'.
   370         88  WS-LEVEL                 VALUE 'L' 'P'.
   371     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   372
   373     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   374     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   375     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   376     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   377     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   378     12  ws-ah-max-bens           pic 99        value zeros.
   379     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   380     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   381     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   382     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   383
   384     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   385     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   386     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   387     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   388     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   389     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   390     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   391     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   392     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   393     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   394     12  WS-ACCT-SIG-SW.
   395         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   396         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   397     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   398     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   399     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   400     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   401     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   402     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   403     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   404     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   405     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   406     12  WS-INITIALS.
   407         16  WS-INIT-1            PIC X         VALUE SPACES.
   408         16  WS-INIT-2            PIC X         VALUE SPACES.
   409
   410     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   411     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   412     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   413     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page   9
* EL050.cbl
   414     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   415*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   416     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   417     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   418     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   419     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   420     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   421     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   422     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   423     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   424     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   425     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   426     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   427     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   428     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   429     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   430     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   431     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   432     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   433     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   434     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   435     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   436     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   437     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   438******** FLA
   439     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   440     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   441     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   442     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   443     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   444********
   445     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   446     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   447     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   448     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   449     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   450     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   451     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   452     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   453     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   454     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   455
   456     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   457         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   458                                         '0' THRU '9'.
   459
   460     12  NUMBER-OF-MONTHS.
   461         16  SK-MO OCCURS 12 TIMES PIC X.
   462
   463     12  WS-WORK-DATE.
   464         16  WS-YEAR            PIC 99    VALUE 00.
   465         16  WS-MONTH           PIC 99    VALUE 00.
   466         16  WS-DAY             PIC 99    VALUE 00.
   467
   468     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   469     12  WS-WORK-CRIT-DEV       REDEFINES
   470         WS-WORK-LF-CRIT-PER    PIC X(03).
   471
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  10
* EL050.cbl
   472     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   473     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   474
   475     12  WS-WORK-DATE-FROM.
   476         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   477         16  FILLER             PIC X  VALUE SPACE.
   478         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   479         16  FILLER             PIC X         VALUE SPACE.
   480         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   481
   482     12  WS-WORK-DATE-THRU.
   483         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   484         16  FILLER             PIC X         VALUE SPACE.
   485         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   486         16  FILLER             PIC X         VALUE SPACE.
   487         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   488
   489     12  WS-LF-INPUT-CD.
   490         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   491         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   492
   493     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   494     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   495         16  WS-AH-INPUT-CD-1   PIC X.
   496         16  WS-AH-INPUT-CD-2-3 PIC XX.
   497
   498     12  WS-SWITCHES.
   499         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   500         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   501             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   502         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   503             88  BANK-ACCT-FOUND          VALUE 'Y'.
   504         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   505             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   506         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   507             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   508         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   509             88  COMP-MASTER-FOUND        VALUE 'Y'.
   510         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   511             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   512         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   513             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   514         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   515             88  STAT-MASTER-FOUND        VALUE 'Y'.
   516         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   517             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   518         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   519             88  ELCRTT-FOUND             VALUE 'Y'.
   520         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   521             88  ELCRTT-UPDATE            VALUE 'Y'.
   522         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   523             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   524         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   525             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   526         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   527             88  FORM-MASTER-FOUND        VALUE 'Y'.
   528         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   529             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  11
* EL050.cbl
   530         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   531             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   532         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   533             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   534         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   535             88  NO-BENEFIT-FOUND         VALUE 'N'.
   536         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   537             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   538         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   539             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   540         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   541             88  AH-BENEFIT-FOUND         VALUE ' '.
   542             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   543         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   544             88  LF-BENEFIT-FOUND         VALUE ' '.
   545             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   546         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   547             88  NO-STATE-RECORD          VALUE '1'.
   548         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   549             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   550         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   551             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   552         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   553             88  CERT-WAS-FOUND           VALUE ' '.
   554             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   555         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   556             88  BROWSE-STARTED           VALUE 'Y'.
   557         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   558             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   559         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   560             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   561         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   562             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   563         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   564             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   565         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   566             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   567         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   568             88  APP-CERT-USED            VALUE 'Y' 'A'.
   569         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   570             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   571             88  FIRST-TIME-THROUGH       VALUE '1'.
   572             88  CTBL-NOT-FOUND           VALUE '2'.
   573
   574         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   575             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   576
   577         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   578             88  DLO-ERROR-FOUND          VALUE 'Y'.
   579
   580********FLA
   581     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   582     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   583********
   584     12  RC-SW-1                  PIC X           VALUE '0'.
   585     12  RC-SW-2                  PIC X           VALUE '0'.
   586     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   587     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  12
* EL050.cbl
   588     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   589     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   590     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   591     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   592     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   593     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   594     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   595     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   596     12  LIT-SPACES               PIC X           VALUE SPACES.
   597     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   598     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   599     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   600     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   601     12  erpndm-unlock-sw         pic x           value spaces.
   602         88  need-to-unlock-erpndm  value 'Y'.
   603     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   604     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   605     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   606         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   607         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   608     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   609         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   610
   611 01  WS-EXTRA-PERIODS-BY-STATE.
   612     12  WS-INT-PERIODS          PIC 9.
   613     12  WS-EXTRA-PMTS           PIC 9.
   614 01  ws-net-only-state           pic x value 'N'.
   615 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   616     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   617     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   618 01  WS-CRI-SSN-WORK-AREA.
   619     05  WS-CRI-SOC-SEC-NO.
   620         10  WS-SS-REPT-CD       PIC X(5).
   621         10  WS-SS-LAST-NAME     PIC X(5).
   622         10  WS-SS-INITIAL       PIC X.
   623
   624     05  WS-CRI-REPORT-CODE.
   625         10  FILLER              PIC X(5).
   626         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   627
   628     05  WS-CRI-LAST-NAME.
   629         10  WS-CRI-NAME-MOVE    PIC X(5).
   630         10  FILLER              PIC X(10).
   631
   632 01  ws-state-commission-caps.
   633     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   634     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   635     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   636     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   637     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   638     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   639     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   640     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   641     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   642     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   643     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   644     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   645     05  ws-st-cap-limit-to      pic x.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  13
* EL050.cbl
   646     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   647     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   648     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   649     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   650     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   651     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   652     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   653     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   654     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   655     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   656     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   657     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   658 01  WS-NUM-TABLE                PIC X(26)  VALUE
   659     '12345678012345070923456789'.
   660 01  FILLER REDEFINES WS-NUM-TABLE.
   661     05  WS-NUM OCCURS 26        PIC 9.
   662 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   663 01  V1                          PIC S999 COMP-3.
   664 01  V2                          PIC S999 COMP-3.
   665 01  V3                          PIC S999 COMP-3.
   666 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   667 01  FILLER REDEFINES WS-WORK-VIN.
   668     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   669 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   670 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   671 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   672 01  WS-HEX-WORK.
   673     05  FILLER                  PIC X  VALUE LOW-VALUES.
   674     05  WS-HEX-BYTE             PIC X.
   675 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   676 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   677 01  WS-WORK-HIN-ROW-B.
   678     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   679
   680 01  ws-benefit-cd-chg-sw      pic x value spaces.
   681     88  benefit-code-chg           value 'Y'.
   682 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   683 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   684     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   685 01  WS-ROW-D-TABLE.
   686     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   687
   688 01  WS-HIN-TABLE-B.
   689     05  F                       PIC XX VALUE 'A2'.
   690     05  F                       PIC XX VALUE 'B3'.
   691     05  F                       PIC XX VALUE 'C4'.
   692     05  F                       PIC XX VALUE 'D5'.
   693     05  F                       PIC XX VALUE 'E6'.
   694     05  F                       PIC XX VALUE 'F7'.
   695     05  F                       PIC XX VALUE 'G8'.
   696     05  F                       PIC XX VALUE 'H9'.
   697     05  F                       PIC XX VALUE 'I1'.
   698     05  F                       PIC XX VALUE 'J2'.
   699     05  F                       PIC XX VALUE 'K3'.
   700     05  F                       PIC XX VALUE 'L4'.
   701     05  F                       PIC XX VALUE 'M5'.
   702     05  F                       PIC XX VALUE 'N6'.
   703     05  F                       PIC XX VALUE 'O0'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  14
* EL050.cbl
   704     05  F                       PIC XX VALUE 'P7'.
   705     05  F                       PIC XX VALUE 'Q0'.
   706     05  F                       PIC XX VALUE 'R8'.
   707     05  F                       PIC XX VALUE 'S9'.
   708     05  F                       PIC XX VALUE 'T2'.
   709     05  F                       PIC XX VALUE 'U3'.
   710     05  F                       PIC XX VALUE 'V4'.
   711     05  F                       PIC XX VALUE 'W5'.
   712     05  F                       PIC XX VALUE 'X6'.
   713     05  F                       PIC XX VALUE 'Y7'.
   714     05  F                       PIC XX VALUE 'Z8'.
   715 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   716     05  WS-VAL-IN               PIC X.
   717     05  WS-VAL-OUT              PIC 9.
   718 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   719 01  ws-greg-eff-date            pic x(10) value ' '.
   720 01  WS-COMPARE-BINARY-DATES.
   721     05  WS-971231                PIC XX VALUE X'92FF'.
   722     05  WS-931231                PIC XX VALUE X'8CFF'.
   723     05  WS-791231                PIC XX VALUE X'77FF'.
   724     05  WS-771001                PIC XX VALUE X'74A1'.
   725     05  WS-820301                PIC XX VALUE X'7B41'.
   726     05  WS-831031                PIC XX VALUE X'7DBF'.
   727     05  WS-831231                PIC XX VALUE X'7DFF'.
   728     05  WS-810831                PIC XX VALUE X'7A7F'.
   729     05  WS-830901                PIC XX VALUE X'7D81'.
   730
   731 01  FILE-ACCESS-IDS.
   732     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   733     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   734     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   735     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   736     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   737     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   738     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   739     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   740     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   741     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   742     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   743     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   744     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   745     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   746     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   747     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   748     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   749 01  DD-IU-SW                    PIC X   VALUE ' '.
   750     88  DD-IU-PRESENT                 VALUE 'Y'.
   751
   752 01  ACCESS-KEYS.
   753     12  ELMSTR-KEY.
   754         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   755         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   756     12  W-CLAIM-KEY.
   757         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   758         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   759
   760     12  ELCNTL-KEY.
   761         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  15
* EL050.cbl
   762         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   763         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   764         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   765
   766     12  ELCERT-KEY.
   767         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   768         16  CERT-CARRIER         PIC X       VALUE SPACE.
   769         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   770         16  CERT-STATE           PIC XX      VALUE SPACES.
   771         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   772         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   773         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   774
   775     12  ELCERT2-KEY.
   776         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   777         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   778
   779     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   780
   781     12  ELCERT-SAVE.
   782         16  FILLER                      PIC XX    VALUE SPACES.
   783
   784         16  WCS-CONTROL-PRIMARY.
   785             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   786             20  WCS-CARRIER             PIC X     VALUE SPACE.
   787             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   788             20  WCS-STATE               PIC XX    VALUE SPACES.
   789             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   790             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   791             20  WCS-CERT-NO.
   792                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   793                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   794
   795         16  CS-CONTROL-BY-NAME.
   796             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   797             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   798             20  CS-INSURED-INITIALS.
   799                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   800                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   801
   802         16  CS-CONTROL-BY-SSN.
   803             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   804             20  CS-SOC-SEC-NO.
   805                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   806                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   807                 24  CS-SSN-LN3.
   808                     28 CS-INSURED-INITIALS-A2   PIC XX
   809                                     VALUE SPACES.
   810                     28 CS-PART-LAST-NAME-A2     PIC X
   811                                     VALUE SPACE.
   812
   813         16  CS-CONTROL-BY-CERT-NO.
   814             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   815             20  CS-CERT-NO-A4           PIC X(11)
   816                                     VALUE SPACES.
   817
   818         16  CS-CONTROL-BY-MEMB.
   819             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  16
* EL050.cbl
   820             20  CS-MEMBER-NO.
   821                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   822                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   823                 24  CS-MEMB-LN4.
   824                     28 CS-INSURED-INITIALS-A5   PIC XX
   825                                      VALUE SPACES.
   826                     28 CS-PART-LAST-NAME-A5     PIC XX
   827                                      VALUE SPACES.
   828
   829         16  FILLER              PIC X(360) VALUE SPACES.
   830
   831     12  ERACCT-KEY.
   832         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   833         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   834         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   835         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   836         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   837         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   838
   839     12  ERCOMP-KEY.
   840         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   841         16  COMP-CARRIER         PIC X     VALUE SPACES.
   842         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   843         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   844         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   845         16  COMP-TYPE            PIC X     VALUE SPACES.
   846
   847     12  ERLOFC-KEY.
   848         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   849         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   850         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   851         16  LOFC-STATE           PIC XX    VALUE SPACES.
   852         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   853         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   854
   855     12  WS-ELCRTT-KEY.
   856         16  WS-ELCRTT-PRIMARY       PIC X(33).
   857         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   858
   859     12  ERBXRF-KEY.
   860         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   861         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   862         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   863         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   864
   865     12  ERAGTC-KEY.
   866         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   867         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   868         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   869         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   870         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   871         16  AGTC-TYPE            PIC X     VALUE SPACES.
   872
   873     12  ERPLAN-KEY.
   874         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   875         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   876         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   877         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  17
* EL050.cbl
   878         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   879         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   880         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   881         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   882
   883     12  ERFORM-KEY.
   884         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   885         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   886         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   887         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   888
   889     12  ERREIN-KEY.
   890         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   891         16  REIN-TYPE            PIC X     VALUE SPACES.
   892         16  REIN-TABLE-CO.
   893             20  REIN-CODE-1      PIC X     VALUE SPACE.
   894             20  REIN-CODE-2      PIC X     VALUE SPACE.
   895             20  REIN-CODE-3      PIC X     VALUE SPACE.
   896         16  FILLER               PIC X(3)  VALUE SPACES.
   897
   898     12  ERCTBL-KEY.
   899         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   900         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   901         16  CTBL-CNTRL-2.
   902             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   903             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   904
   905     12  ELCRTO-KEY.
   906         16  ELCRTO-COMPANY-CD       PIC X.
   907         16  ELCRTO-CARRIER          PIC X.
   908         16  ELCRTO-GROUPING         PIC X(6).
   909         16  ELCRTO-STATE            PIC XX.
   910         16  ELCRTO-ACCOUNT          PIC X(10).
   911         16  ELCRTO-CERT-EFF-DT      PIC XX.
   912         16  ELCRTO-CERT-NO.
   913             20  ELCRTO-CERT-PRIME   PIC X(10).
   914             20  ELCRTO-CERT-SFX     PIC X.
   915         16  ELCRTO-RECORD-TYPE      PIC X.
   916         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   917
   918
   919     12  WS-ACCESS.
   920         16  FILLER               PIC XX    VALUE SPACES.
   921         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   922
   923     12  WS-CARR-ACCESS.
   924         16  FILLER               PIC X(3)  VALUE SPACES.
   925         16  WS-CARR              PIC X     VALUE SPACE.
   926*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   927*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   928     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   929         88  WS-DMD-LF-RATING   VALUE 'Y'.
   930         88  WS-DMD-AH-RATING   VALUE 'Y'.
   931         88  WS-DMD-NO-RATING   VALUE 'N'.
   932
   933     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   934         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   935                                         'NJ' 'NL'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  18
* EL050.cbl
   936                                         'PJ' 'PL'
   937                                         'SJ' 'SL'.
   938     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   939         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   940                                         'NI' 'NJ' 'NL' 'NU'
   941                                         'PJ' 'PL' 'PI' 'PU'
   942                                         'SI' 'SJ' 'SL' 'SU'
   943                                         'MX' 'MY' 'MZ'.
   944 01  ERPDEF-KEY-SAVE             PIC X(18).
   945 01  ERPDEF-KEY.
   946     12  ERPDEF-COMPANY-CD       PIC X.
   947     12  ERPDEF-STATE            PIC XX.
   948     12  ERPDEF-PROD-CD          PIC XXX.
   949     12  F                       PIC X(7).
   950     12  ERPDEF-BEN-TYPE         PIC X.
   951     12  ERPDEF-BEN-CODE         PIC XX.
   952     12  ERPDEF-EXP-DT           PIC XX.
   953
   954 01  ELSTAT-KEY-SAVE             PIC X(20).
   955 01  ELSTAT-KEY.
   956     12  ELSTAT-COMPANY-ID       PIC XXX.
   957     12  ELSTAT-CARRIER          PIC X.
   958     12  ELSTAT-GROUP            PIC X(6).
   959     12  ELSTAT-STATE            PIC XX.
   960     12  ELSTAT-EXP-DT           PIC 9(8).
   961 01  WS-ERROR-VALUES.
   962     12  ER-1570                     PIC S9(4)   VALUE +1570.
   963     12  ER-1571                     PIC S9(4)   VALUE +1571.
   964     12  er-1572                     pic s9(4)   value +1572.
   965     12  er-1573                     pic s9(4)   value +1573.
   966     12  er-1574                     pic s9(4)   value +1574.
   967     12  ER-1575                     PIC S9(4)   VALUE +1575.
   968     12  er-1576                     pic s9(4)   value +1576.
   969     12  er-1577                     pic s9(4)   value +1577.
   970     12  er-1583                     pic s9(4)   value +1583.
   971     12  er-1584                     pic s9(4)   value +1584.
   972     12  er-1743                     pic s9(4)   value +1743.
   973     12  er-1744                     pic s9(4)   value +1744.
   974     12  er-1745                     pic s9(4)   value +1745.
   975     12  er-1746                     pic s9(4)   value +1746.
   976     12  er-1747                     pic s9(4)   value +1747.
   977     12  er-1748                     pic s9(4)   value +1748.
   978     12  er-1749                     pic s9(4)   value +1749.
   979     12  er-1750                     pic s9(4)   value +1750.
   980     12  er-1751                     pic s9(4)   value +1751.
   981     12  er-1752                     pic s9(4)   value +1752.
   982     12  er-1753                     pic s9(4)   value +1753.
   983     12  er-1754                     pic s9(4)   value +1754.
   984     12  er-1755                     pic s9(4)   value +1755.
   985     12  er-1756                     pic s9(4)   value +1756.
   986     12  er-1757                     pic s9(4)   value +1757.
   987     12  er-1758                     pic s9(4)   value +1758.
   988     12  er-1759                     pic s9(4)   value +1759.
   989     12  er-1760                     pic s9(4)   value +1760.
   990     12  er-1761                     pic s9(4)   value +1761.
   991     12  ER-1891                     PIC S9(4)   VALUE +1891.
   992     12  ER-1892                     PIC S9(4)   VALUE +1892.
   993     12  ER-1893                     PIC S9(4)   VALUE +1893.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  19
* EL050.cbl
   994     12  ER-1894                     PIC S9(4)   VALUE +1894.
   995     12  ER-1895                     PIC S9(4)   VALUE +1895.
   996     12  ER-1896                     PIC S9(4)   VALUE +1896.
   997     12  ER-1897                     PIC S9(4)   VALUE +1897.
   998     12  ER-1898                     PIC S9(4)   VALUE +1898.
   999     12  ER-1899                     PIC S9(4)   VALUE +1899.
  1000     12  ER-1900                     PIC S9(4)   VALUE +1900.
  1001     12  ER-1901                     PIC S9(4)   VALUE +1901.
  1002     12  ER-1902                     PIC S9(4)   VALUE +1902.
  1003     12  ER-1903                     PIC S9(4)   VALUE +1903.
  1004     12  ER-1904                     PIC S9(4)   VALUE +1904.
  1005     12  ER-1905                     PIC S9(4)   VALUE +1905.
  1006     12  ER-1906                     PIC S9(4)   VALUE +1906.
  1007     12  ER-1907                     PIC S9(4)   VALUE +1907.
  1008     12  ER-1909                     PIC S9(4)   VALUE +1909.
  1009     12  ER-1910                     PIC S9(4)   VALUE +1910.
  1010     12  ER-1911                     PIC S9(4)   VALUE +1911.
  1011     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1012     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1013     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1014     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1015     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1016     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1017     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1018     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1019     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1020     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1021     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1022     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1023     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1024     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1025     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1026     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1027     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1028     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1029     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1030     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1031     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1032     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1033     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1034     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1035     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1036     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1037     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1038     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1039     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1040     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1041     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1042     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1043     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1044     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1045     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1046     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1047     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1048     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1049     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1050     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1051     12  ER-2614                     PIC S9(4)   VALUE +2614.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  20
* EL050.cbl
  1052     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1053     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1054     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1055     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1056     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1057     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1058     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1059     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1060     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1061     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1062     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1063     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1064     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1065     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1066     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1067     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1068     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1069     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1070     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1071     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1072     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1073     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1074     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1075     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1076     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1077     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1078     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1079     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1080     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1081     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1082     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1083     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1084     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1085     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1086     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1087     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1088     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1089     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1090     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1091     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1092     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1093     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1094     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1095     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1096     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1097     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1098     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1099     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1100     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1101     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1102     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1103     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1104     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1105     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1106     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1107     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1108     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1109     12  ER-2672                     PIC S9(4)   VALUE +2672.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  21
* EL050.cbl
  1110     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1111     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1112     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1113     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1114     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1115     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1116     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1117     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1118     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1119     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1120     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1121     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1122     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1123     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1124     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1125     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1126     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1127     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1128     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1129     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1130     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1131     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1132     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1133     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1134     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1135     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1136     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1137     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1138     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1139     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1140     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1141     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1142     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1143     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1144     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1145     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1146     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1147     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1148     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1149     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1150     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1151     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1152     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1153     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1154     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1155     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1156     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1157     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1158     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1159     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1160     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1161     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1162     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1163     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1164     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1165     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1166     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1167     12  ER-2740                     PIC S9(4)   VALUE +2740.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  22
* EL050.cbl
  1168     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1169     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1170     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1171     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1172     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1173     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1174     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1175     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1176     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1177     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1178     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1179     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1180     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1181     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1182     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1183     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1184     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1185     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1186     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1187     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1188     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1189     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1190     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1191     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1192     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1193     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1194     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1195     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1196     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1197     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1198     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1199     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1200     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1201     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1202     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1203     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1204     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1205     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1206     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1207     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1208     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1209     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1210     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1211     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1212     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1213     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1214     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1215     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1216     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1217     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1218     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1219     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1220     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1221     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1222     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1223     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1224     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1225     12  ER-2883                     PIC S9(4)   VALUE +2883.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  23
* EL050.cbl
  1226     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1227     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1228     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1229     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1230     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1231     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1232     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1233     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1234     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1235     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1236     12  ER-2894                     PIC S9(4)   VALUE +2894.
  1237     12  ER-2895                     PIC S9(4)   VALUE +2895.
  1238     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1239     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1240     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1241     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1242     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1243     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1244     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1245     12  ER-2998                     PIC S9(4)   VALUE +2998.
  1246     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1247     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1248     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1249     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1250     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1251     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1252     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1253     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1254     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1255     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1256     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1257     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1258     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1259     12  ER-3069                     PIC S9(4)   VALUE +3069.
  1260     12  er-3070                     pic s9(4)   value +3070.
  1261     12  er-3071                     pic s9(4)   value +3071.
  1262     12  er-3270                     pic s9(4)   value +3270.
  1263     12  er-3273                     pic s9(4)   value +3273.
  1264     12  er-3281                     pic s9(4)   value +3281.
  1265     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1266     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1267     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1268     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1269     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1270     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1271     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1272     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1273     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1274     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1275     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1276     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1277     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1278     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1279     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1280     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1281     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1282     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1283     12  ER-7823                     PIC S9(4)   VALUE +7823.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  24
* EL050.cbl
  1284     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1285     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1286     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1287     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1288     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1289     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1290     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1291     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1292     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1293     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1294     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1295     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1296     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1297     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1298     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1299     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1300     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1301     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1302     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1303     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1304     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1305     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1306     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1307     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1308     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1309     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1310     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1311     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1312     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1313     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1314     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1315     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1316     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1317     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1318     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1319     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1320     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1321     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1322     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1323     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1324     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1325     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1326     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1327     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1328     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1329     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1330     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1331     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1332     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1333     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1334     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1335     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1336     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1337     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1338     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1339     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1340     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1341     12  ER-8301                     PIC S9(4)   VALUE +8301.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  25
* EL050.cbl
  1342     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1343     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1344     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1345     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1346     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1347     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1348     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1349     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1350     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1351     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1352     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1353     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1354     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1355     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1356     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1357     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1358     12  er-9823                     pic s9(4)   value +9823.
  1359     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1360******************************************************************
  1361***************   END OF ELC50WS     ****************************
  1362******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  26
* EL050.cbl
  1365 01  WORKING-STORAGE-WORK-AREAS.
  1366     12  WS-RESPONSE             PIC S9(8)  COMP.
  1367         88  WS-RESP-NORMAL           VALUE +00.
  1368         88  WS-RESP-ERROR            VALUE +01.
  1369         88  WS-RESP-NOTFND           VALUE +13.
  1370         88  WS-RESP-DUPREC           VALUE +14.
  1371         88  WS-RESP-ENDFILE          VALUE +20.
  1372     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1373     12  WORK-AREAS.
  1374         16  WK-CONV-GREG.
  1375             24  WCG-CENT             PIC XX.
  1376             24  WCG-REST             PIC X(4).
  1377         16  WORK-GREGORIAN-DATE.
  1378             24  WK-GREG-CENT         PIC XX.
  1379             24  WK-GREG-DATE-YYMMDD.
  1380                 28  WK-GREG-YYMM     PIC X(4).
  1381                 28  WK-GREG-DD       PIC XX.
  1382
  1383         16  WORK-SELECT-DATE.
  1384             24  WK-SELECT-CENT            PIC XX.
  1385             24  WK-SELECT-DATE-YYMMDD.
  1386                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1387                 28  FILLER                PIC XX.
  1388
  1389         16  WK-FORM-NO.
  1390             24  WK-FORM-BANK-ID       PIC X(5).
  1391             24  WK-FORM-UNDRWRTR      PIC X(1).
  1392             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1393
  1394         16  WK-MEMBER-NO.
  1395             24  WK-MEMBER-1-6        PIC X(6).
  1396             24  WK-MEMBER-7-12       PIC X(6).
  1397
  1398         16  WK-FULL-CERT-NO.
  1399             24  WK-CERT-POS-1-2      PIC X(2).
  1400             24  WK-CERT-POS-3        PIC X(1).
  1401             24  WK-CERT-POS-4        PIC X(1).
  1402             24  WK-CERT-POS-5-6      PIC X(2).
  1403             24  WK-CERT-POS-7        PIC X(1).
  1404             24  WK-CERT-POS-8-11     PIC X(4).
  1405
  1406         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1407             88  VALID-RATE-CODE        VALUE 'Y'.
  1408             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1409
  1410         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1411         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1412         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1413         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1414         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1415         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1416         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1417         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1418         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1419         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1420
  1421* DLO001
  1422 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  27
* EL050.cbl
  1423     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1424     12  DMPF-RETURN-CODE          PIC XX.
  1425         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1426         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1427         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1428         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1429         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1430         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1431
  1432* DLO002
  1433 01  WS-DLO-INTERNAL-POLICY-FORM.
  1434     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1435     12  DIPF-RETURN-CODE          PIC XX.
  1436         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1437         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1438         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1439         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1440         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1441         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1442
  1443* DLO003
  1444 01  WS-DLO-VALID-BANK-ID.
  1445     12  DVBI-BANK-ID              PIC X(5).
  1446     12  DVBI-BANK-ID-TYPE         PIC X.
  1447         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1448         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1449         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1450         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1451         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1452     12  DVBI-RETURN-CODE          PIC XX.
  1453         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1454         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1455         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1456         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1457         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1458         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1459         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1460         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1461         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1462
  1463* DLO007
  1464 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1465     12  DCUA-RES-STATE            PIC XX.
  1466     12  DCUA-BEN-TYPE             PIC XX.
  1467     12  DCUA-SYS-IDENT            PIC X.
  1468         88  DCUA-CLAIM                        VALUE 'C'.
  1469         88  DCUA-PREMIUM                      VALUE 'P'.
  1470     12  DCUA-COVERAGE-RULE        PIC X.
  1471     12  DCUA-CLIENT-ID            PIC X(10).
  1472     12  DCUA-EFF-DATE             PIC X(8).
  1473     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1474     12  DCUA-RETURN-CODE          PIC XX.
  1475         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1476     12  DCUA-CERT-NUMBER          PIC X(11).
  1477     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1478     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1479
  1480* DLO011
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  28
* EL050.cbl
  1481 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1482     12  DPRB-RATE-CODE            PIC X(4).
  1483     12  DPRB-COVERAGE-CATEG       PIC X.
  1484     12  DPRB-RETURN-CODE          PIC XX.
  1485         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1486         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1487         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1488         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1489         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1490         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1491         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1492         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1493         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1494     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1495     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1496     12  DPRB-BEN-TYPE             PIC XX.
  1497
  1498* DLO017
  1499 01  WS-DLO-VALID-RATE-CODE.
  1500     12  DVRC-RATE-CODE            PIC X(4).
  1501     12  DVRC-RETURN-CODE          PIC XX.
  1502         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1503         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1504         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1505         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1506         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1507         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1508
  1509* DLO019
  1510 01  WS-DLO-ORIG-COV-CAT.
  1511     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1512     12  DOCC-RETURN-CODE          PIC XX.
  1513     12  DOCC-ORIG-COV-CAT         PIC X.
  1514     12  DOCC-UNDERWITER           PIC XX.
  1515     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1516     12  DOCC-FILLER               PIC X(6).
  1517
  1518* DLO021
  1519 01  WS-DLO-VALID-LOAN-OFFICER.
  1520     12  DVLO-LOAN-OFFICER.
  1521         16  DVLO-BILL-TYPE        PIC X.
  1522         16  DVLO-BILL-SOURCE      PIC X.
  1523         16  DVLO-BATCH-TYPE       PIC X.
  1524     12  DVLO-RETURN-CODE          PIC XX.
  1525         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1526         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1527         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1528         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1529         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1530         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1531
  1532* DLO022
  1533 01  WS-DLO-VALID-STATE-CODE.
  1534     12  DVSC-STATE-CODE           PIC XX.
  1535     12  DVSC-RETURN-CODE          PIC XX.
  1536         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1537
  1538* DLO023
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  29
* EL050.cbl
  1539 01  WS-DLO-VALID-CODE-VALUES.
  1540     12  DVCV-SYSTEM-ID            PIC XX.
  1541         88  DVCV-CLAIMS                       VALUE 'CL'.
  1542         88  DVCV-CREDIT                       VALUE 'CR'.
  1543     12  DVCV-RECORD-TYPE          PIC XX.
  1544         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1545         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1546         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1547         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1548         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1549         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1550         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1551         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1552     12  DVCV-RECORD-KEY           PIC X(6).
  1553     12  DVCV-RETURN-CODE          PIC XX.
  1554         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1555         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1556         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1557         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1558         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1559         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1560         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1561     12  DVCV-CODE-DESC            PIC X(60).
  1562     12  DVCV-GEN-DESC-1           PIC X(20).
  1563     12  DVCV-GEN-DESC-2           PIC X(20).
  1564     12  DVCV-GEN-DESC-3           PIC X(20).
  1565
  1566 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1567 01  hldi-pass-area.
  1568     03  PA-VIN                  PIC X(17).
  1569     03  PA-ErrorCode            PIC X(10).
  1570     03  PA-ErrorDesc            PIC X(30).
  1571     03  PA-ModelYear            PIC 9(7).
  1572     03  PA-MakeName             PIC X(50).
  1573     03  PA-ModelName            PIC X(50).
  1574     03  PA-SeriesName           PIC X(50).
  1575 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1576 01  zipcd-pass-area.
  1577     03  PA-zip                  PIC X(5).
  1578     03  PA-ErrorCode-zip        PIC X(10).
  1579     03  PA-city                 PIC x(50).
  1580     03  PA-state                PIC Xx.
  1581 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1582 01  clmhs-pass-area.
  1583     03  pa-clmhs-state          pic xx.
  1584     03  pa-account              pic x(10).
  1585     03  pa-eff-dt               pic x(10).
  1586     03  pa-cert-no              pic x(11).
  1587     03  pa-clm-count            pic 9(5).
  1588****  this is for aggregate report.
  1589****  Length is erpndb + 100 of passed-key-area
  1590 01  ws-passed-key-length        pic s9(4) comp value +587.
  1591 01  ws-pass-to-pemaggo.
  1592     05  ws-passed-erpndb        pic x(585).
  1593     05  ws-exceed-limit-yn      pic x.
  1594     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  30
* EL050.cbl
  1596*    COPY ERCBXRF.
  1597******************************************************************
  1598*                                                                *
  1599*                                                                *
  1600*                            ERCBXRF                             *
  1601*                                                                *
  1602*   ONLINE CREDIT SYSTEM                                         *
  1603*                                                                *
  1604*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1605*                                                                *
  1606*   FILE TYPE = VSAM,KSDS                                        *
  1607*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1608*                                                                *
  1609*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1610*       ALTERNATE PATH = NONE                                    *
  1611*                                                                *
  1612*   LOG = NO                                                     *
  1613*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1614*                                                                *
  1615******************************************************************
  1616
  1617 01  BANK-CROSS-REFERENCE.
  1618     12  BK-RECORD-ID                PIC XX.
  1619         88  VALID-BK-ID             VALUE 'BK'.
  1620
  1621     12  BK-CONTROL-PRIMARY.
  1622         16  BK-COMPANY-CD           PIC X.
  1623         16  BK-CARRIER              PIC X.
  1624         16  BK-GROUPING             PIC X(6).
  1625         16  BK-BANK-NO              PIC X(10).
  1626
  1627     12  BK-MAINT-INFORMATION.
  1628         16  BK-LAST-MAINT-DT        PIC XX.
  1629         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1630         16  BK-LAST-MAINT-USER      PIC X(4).
  1631         16  FILLER                  PIC X(9).
  1632
  1633     12  FILLER                      PIC X(37).
  1634
  1635     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1636
  1637     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1638                            DEPENDING ON BK-BANK-POINTER-CNT.
  1639         16  BK-AM-ACCOUNT           PIC X(10).
  1640         16  BK-AM-EXP-DT            PIC XX.
  1641         16  BK-AM-EFF-DT            PIC XX.
  1642         16  BK-AM-STATE             PIC XX.
  1643         16  FILLER                  PIC X(20).
  1644
  1645******************************************************************
  1646
  1647*    COPY ERCCOMP.
  1648******************************************************************
  1649*                                                                *
  1650*                                                                *
  1651*                            ERCCOMP                             *
  1652*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1653*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  31
* EL050.cbl
  1654*                                                                *
  1655*   ONLINE CREDIT SYSTEM                                         *
  1656*                                                                *
  1657*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1658*                                                                *
  1659*   FILE TYPE = VSAM,KSDS                                        *
  1660*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1661*                                                                *
  1662*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1663*       ALTERNATE PATH = NONE                                    *
  1664*                                                                *
  1665*   LOG = NO                                                     *
  1666*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1667*                                                                *
  1668******************************************************************
  1669*                   C H A N G E   L O G
  1670*
  1671* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1672*-----------------------------------------------------------------
  1673*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1674* EFFECTIVE    NUMBER
  1675*-----------------------------------------------------------------
  1676* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1677* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1678* 092205    2005050300006  PEMA  ADD LEASE FEE
  1679* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1680* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1681* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1682* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1683* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1684* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1685******************************************************************
  1686
  1687 01  COMPENSATION-MASTER.
  1688     12  CO-RECORD-ID                          PIC XX.
  1689         88  VALID-CO-ID                          VALUE 'CO'.
  1690
  1691     12  CO-CONTROL-PRIMARY.
  1692         16  CO-COMPANY-CD                     PIC X.
  1693         16  CO-CONTROL.
  1694             20  CO-CTL-1.
  1695                 24  CO-CARR-GROUP.
  1696                     28  CO-CARRIER            PIC X.
  1697                     28  CO-GROUPING.
  1698                         32  CO-GROUP-PREFIX   PIC XXX.
  1699                         32  CO-GROUP-PRIME    PIC XXX.
  1700                 24  CO-RESP-NO.
  1701                     28  CO-RESP-PREFIX        PIC X(4).
  1702                     28  CO-RESP-PRIME         PIC X(6).
  1703             20  CO-CTL-2.
  1704                 24  CO-ACCOUNT.
  1705                     28  CO-ACCT-PREFIX        PIC X(4).
  1706                     28  CO-ACCT-PRIME         PIC X(6).
  1707         16  CO-TYPE                           PIC X.
  1708             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1709             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1710             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1711
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  32
* EL050.cbl
  1712     12  CO-MAINT-INFORMATION.
  1713         16  CO-LAST-MAINT-DT                  PIC XX.
  1714         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1715         16  CO-LAST-MAINT-USER                PIC X(4).
  1716     12  FILLER                                PIC XX.
  1717     12  CO-STMT-TYPE                          PIC XXX.
  1718     12  CO-COMP-TYPE                          PIC X.
  1719         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1720     12  CO-STMT-OWNER                         PIC X(4).
  1721     12  CO-BALANCE-CONTROL                    PIC X.
  1722         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1723         88  CO-NO-BALANCE                        VALUE 'N'.
  1724
  1725     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1726         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1727         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1728         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1729
  1730     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1731         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1732         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1733
  1734     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1735     12  CO-GA-DIRECT-DEP                      PIC X.
  1736     12  CO-FUTURE-SPACE                       PIC X.
  1737         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1738
  1739     12  CO-ACCT-NAME                          PIC X(30).
  1740     12  CO-MAIL-NAME                          PIC X(30).
  1741     12  CO-ADDR-1                             PIC X(30).
  1742     12  CO-ADDR-2                             PIC X(30).
  1743     12  CO-ADDR-3.
  1744         16  CO-ADDR-CITY                      PIC X(27).
  1745         16  CO-ADDR-STATE                     PIC XX.
  1746     12  CO-CSO-1099                           PIC X.
  1747     12  CO-ZIP.
  1748         16  CO-ZIP-PRIME.
  1749             20  CO-ZIP-PRI-1ST                PIC X.
  1750                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1751             20  FILLER                        PIC X(4).
  1752         16  CO-ZIP-PLUS4                      PIC X(4).
  1753     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1754         16  CO-CAN-POSTAL-1                   PIC XXX.
  1755         16  CO-CAN-POSTAL-2                   PIC XXX.
  1756         16  FILLER                            PIC XXX.
  1757     12  CO-SOC-SEC                            PIC X(13).
  1758     12  CO-TELEPHONE.
  1759         16  CO-AREA-CODE                      PIC XXX.
  1760         16  CO-PREFIX                         PIC XXX.
  1761         16  CO-PHONE                          PIC X(4).
  1762
  1763     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1764
  1765     12  CO-AR-BAL-LEVEL                       PIC X.
  1766         88  CO-AR-REF-LVL                        VALUE '1'.
  1767         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1768         88  CO-AR-BILL-LVL                       VALUE '2'.
  1769         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  33
* EL050.cbl
  1770         88  CO-AR-FR-LVL                         VALUE '4'.
  1771
  1772     12  CO-AR-NORMAL-PRINT                    PIC X.
  1773         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1774         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1775
  1776     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1777
  1778     12  CO-AR-REPORTING                       PIC X.
  1779         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1780         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1781
  1782     12  CO-AR-PULL-CHECK                      PIC X.
  1783         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1784         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1785
  1786     12  CO-AR-BALANCE-PRINT                   PIC X.
  1787         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1788
  1789     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1790         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1791         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1792         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1793
  1794     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1795
  1796     12  CO-USER-CODE                          PIC X.
  1797     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1798
  1799******************************************************************
  1800*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1801*    THE LAST MONTH END RUN.
  1802******************************************************************
  1803
  1804     12  CO-LAST-ACTIVITY-DATE.
  1805         16  CO-ACT-YEAR                       PIC 99.
  1806         16  CO-ACT-MONTH                      PIC 99.
  1807         16  CO-ACT-DAY                        PIC 99.
  1808
  1809     12  CO-LAST-STMT-DT.
  1810         16  CO-LAST-STMT-YEAR                 PIC 99.
  1811         16  CO-LAST-STMT-MONTH                PIC 99.
  1812         16  CO-LAST-STMT-DAY                  PIC 99.
  1813
  1814     12  CO-MO-END-TOTALS.
  1815         16  CO-MONTHLY-TOTALS.
  1816             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1817             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1818             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1819             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1820             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1821
  1822         16  CO-AGING-TOTALS.
  1823             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1824             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1825             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1826             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1827
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  34
* EL050.cbl
  1828         16  CO-YTD-TOTALS.
  1829             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1830             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1831
  1832         16  CO-OVER-UNDER-TOTALS.
  1833             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1834             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1835
  1836     12  CO-MISCELLANEOUS-TOTALS.
  1837         16  CO-FICA-TOTALS.
  1838             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1839             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1840
  1841         16  CO-CLAIM-TOTALS.
  1842             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1843             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1844
  1845******************************************************************
  1846*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1847*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1848******************************************************************
  1849
  1850     12  CO-CURRENT-TOTALS.
  1851         16  CO-CURRENT-LAST-STMT-DT.
  1852             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1853             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1854             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1855
  1856         16  CO-CURRENT-MONTHLY-TOTALS.
  1857             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1858             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1859             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1860             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1861             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1862
  1863         16  CO-CURRENT-AGING-TOTALS.
  1864             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1865             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1866             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1867             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1868
  1869         16  CO-CURRENT-YTD-TOTALS.
  1870             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1871             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1872
  1873     12  CO-PAID-COMM-TOTALS.
  1874         16  CO-YTD-PAID-COMMS.
  1875             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1876             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1877
  1878     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1879         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1880         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1881
  1882     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1883         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1884         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1885         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  35
* EL050.cbl
  1886         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1887         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1888         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1889         88  CO-FINAL-LETTER                  VALUE 'F'.
  1890         88  CO-RECONCILING                   VALUE 'R'.
  1891         88  CO-PHONE-CALL                    VALUE 'P'.
  1892         88  CO-LEGAL                         VALUE 'L'.
  1893         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1894         88  CO-WRITE-OFF                     VALUE 'W'.
  1895         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1896
  1897     12  CO-CSR-CODE                       PIC X(4).
  1898
  1899     12  CO-GA-STATUS-INFO.
  1900         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1901         16  CO-GA-TERMINATION-DT          PIC XX.
  1902         16  CO-GA-STATUS-CODE             PIC X.
  1903             88  CO-GA-ACTIVE                 VALUE 'A'.
  1904             88  CO-GA-INACTIVE               VALUE 'I'.
  1905             88  CO-GA-PENDING                VALUE 'P'.
  1906         16  CO-GA-COMMENTS.
  1907             20  CO-GA-COMMENT-1           PIC X(40).
  1908             20  CO-GA-COMMENT-2           PIC X(40).
  1909             20  CO-GA-COMMENT-3           PIC X(40).
  1910             20  CO-GA-COMMENT-4           PIC X(40).
  1911
  1912     12  CO-RPTCD2                         PIC X(10).
  1913     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1914         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1915         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1916
  1917     12  CO-TYPE-AGENT                     PIC X(01).
  1918         88  CO-CORPORATION                   VALUE 'C'.
  1919         88  CO-PARTNERSHIP                   VALUE 'P'.
  1920         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1921         88  CO-TRUST                         VALUE 'T'.
  1922         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1923
  1924     12  CO-FAXNO.
  1925         16  CO-FAX-AREA-CODE                  PIC XXX.
  1926         16  CO-FAX-PREFIX                     PIC XXX.
  1927         16  CO-FAX-PHONE                      PIC X(4).
  1928
  1929     12  CO-BANK-INFORMATION.
  1930         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1931         16  CO-BANK-TRANSIT-NON REDEFINES
  1932             CO-BANK-TRANSIT-NO                PIC 9(8).
  1933
  1934         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1935     12  CO-MISC-DEDUCT-INFO REDEFINES
  1936                  CO-BANK-INFORMATION.
  1937         16  CO-MD-GL-ACCT                     PIC X(10).
  1938         16  CO-MD-DIV                         PIC XX.
  1939         16  CO-MD-CENTER                      PIC X(4).
  1940         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1941         16  CO-CREATE-AP-CHECK                PIC X.
  1942         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1943         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  36
* EL050.cbl
  1944     12  CO-ACH-STATUS                         PIC X.
  1945         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1946         88  CO-ACH-PENDING                        VALUE 'P'.
  1947
  1948     12  CO-BILL-SW                            PIC X.
  1949     12  CO-CONTROL-NAME                       PIC X(30).
  1950     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1951     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1952     12  CO-CLP-STATE                          PIC XX.
  1953     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1954     12  CO-SPP-REFUND-EDIT                    PIC X.
  1955
  1956******************************************************************
  1957
  1958*    COPY ERCAGTC.
  1959******************************************************************
  1960*                                                                *
  1961*                                                                *
  1962*                            ERCAGTC                             *
  1963*                            VMOD=2.001                          *
  1964*                                                                *
  1965*   ONLINE CREDIT SYSTEM                                         *
  1966*                                                                *
  1967*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1968*                                                                *
  1969*   FILE TYPE = VSAM,KSDS                                        *
  1970*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1971*                                                                *
  1972*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1973*       ALTERNATE PATH = NONE                                    *
  1974*                                                                *
  1975*   LOG = NO                                                     *
  1976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1977*                                                                *
  1978******************************************************************
  1979*                   C H A N G E   L O G
  1980*
  1981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1982*-----------------------------------------------------------------
  1983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1984* EFFECTIVE    NUMBER
  1985*-----------------------------------------------------------------
  1986* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1987* 111004                         NEW FILE AND COPYBOOK
  1988* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1989******************************************************************
  1990 01  AGENT-COMMISSIONS.
  1991     12  AG-RECORD-ID                          PIC XX.
  1992         88  VALID-CO-ID                          VALUE 'AG'.
  1993     12  AG-CONTROL-PRIMARY.
  1994         16  AG-COMPANY-CD                     PIC X.
  1995         16  AG-CONTROL.
  1996             20  AG-CTL-1.
  1997                 24  AG-CARR-GROUP.
  1998                     28  AG-CARRIER            PIC X.
  1999                     28  AG-GROUPING           PIC X(6).
  2000                 24  AG-BANK                   PIC X(10).
  2001             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  37
* EL050.cbl
  2002                 24  AG-EXP-DT                 PIC XX.
  2003         16  AG-TYPE                           PIC X.
  2004             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2005             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2006     12  AG-MAINT-INFORMATION.
  2007         16  AG-LAST-MAINT-DT                  PIC XX.
  2008         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2009         16  AG-LAST-MAINT-USER                PIC X(4).
  2010         16  FILLER                            PIC X(10).
  2011     12  AG-EFF-DT                             PIC XX.
  2012     12  AG-COMM-STRUCTURE.
  2013         16  AG-AGT-COMMS OCCURS 10.
  2014             20  AG-AGT                PIC X(10).
  2015             20  AG-COM-TYP            PIC X.
  2016             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2017             20  AG-RECALC-LV-INDIC    PIC X.
  2018             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2019             20  AG-LRCALC-LV-INDIC    PIC X.
  2020             20  FILLER                PIC X(05).
  2021     12  FILLER                  PIC X(145).
  2022******************************************************************
  2023*    COPY ERCRESS.
  2024******************************************************************
  2025*                                                                *
  2026*                            ERCRESS                             *
  2027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2028*                            VMOD=2.002                          *
  2029*                                                                *
  2030*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2031*                                                                *
  2032*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2033*   VSAM RESIDENT STATE TAX MASTER                              *
  2034*                                                                *
  2035*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2036*                                                                *
  2037*   FILE TYPE = VSAM,KSDS                                        *
  2038*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2039*                                                                *
  2040*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2041*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2042*                                                                *
  2043*   LOG = NO                                                     *
  2044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2045*                                                                *
  2046*                                                                *
  2047******************************************************************
  2048
  2049 01  RESIDENT-STATE-TAX-MASTER.
  2050
  2051     10  ERRESS-PRIMARY-KEY.
  2052         15  RES-COMPANY-CD        PIC X.
  2053         15  RES-RESIDENT-STATE    PIC XX.
  2054         15  RES-COVERAGE-CATEGORY PIC X.
  2055         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2056*                                      YYYYMMDD
  2057*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2058
  2059     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  38
* EL050.cbl
  2060
  2061         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2062         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2063         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2064         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2065
  2066     10 RES-RECALC-SW              PIC   X.
  2067         88 RECALC                VALUE 'Y'.
  2068         88 NO-RECALC             VALUE 'N'.
  2069     10  RES-MAINT-BY              PIC X(4).
  2070     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2071     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2072*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  39
* EL050.cbl
  2074*    COPY ERCRESC.
  2075******************************************************************
  2076*                                                                *
  2077*                            ERCRESC                             *
  2078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2079*                            VMOD=2.003                          *
  2080*                                                                *
  2081*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2082*                                                                *
  2083*   FILE TYPE = VSAM,KSDS                                        *
  2084*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2085*                                                                *
  2086*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2087*       ALTERNATE PATH1 = NONE                                   *
  2088*                                                                *
  2089*   LOG = NO                                                     *
  2090*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2091*                                                                *
  2092******************************************************************
  2093
  2094 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2095
  2096     10  ERRESC-RECORD-KEY.
  2097         15  RESC-COMPANY-CD           PIC   X.
  2098         15  RESC-CARRIER              PIC   X.
  2099         15  RESC-GROUP                PIC   X(6).
  2100         15  RESC-STATE                PIC   XX.
  2101         15  RESC-ACCOUNT              PIC   X(10).
  2102         15  RESC-AGENT                PIC   X(10).
  2103         15  RESC-RESIDENT-STATE       PIC   XX.
  2104         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2105*                                           YYYYMMDD
  2106     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2107
  2108     10  RESC-COMM-RECORD-DATA.
  2109         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2110             20 RESC-COVERAGE-CAT      PIC    X.
  2111             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2112             20 RESC-COMMISSION-TAB REDEFINES
  2113                RESC-COMMISSION-PER    PIC  XXX.
  2114
  2115     10  RESC-MAINT-BY                 PIC X(4).
  2116     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2117     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2118*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  40
* EL050.cbl
  2120*    COPY ERCPLAN.
  2121******************************************************************
  2122*                                                                *
  2123*                                                                *
  2124*                            ERCPLAN                             *
  2125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2126*                            VMOD=2.003                          *
  2127*                                                                *
  2128*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2129*                                                                *
  2130*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2131*   PLAN MASTER                                                  *
  2132*                                                                *
  2133*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2134*                                                                *
  2135*   FILE TYPE = VSAM,KSDS                                        *
  2136*   RECORD SIZE = 420   RECFORM = FIX                            *
  2137*                                                                *
  2138*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2139*       ALTERNATE PATH1 = N/A                                    *
  2140*                                                                *
  2141*   LOG = NO                                                     *
  2142*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2143*                                                                *
  2144*                                                                *
  2145******************************************************************
  2146
  2147 01  PLAN-MASTER.
  2148     12  PL-RECORD-ID                      PIC XX.
  2149         88  VALID-PL-ID                      VALUE 'PL'.
  2150
  2151     12  PL-CONTROL-PRIMARY.
  2152         16  PL-COMPANY-CD                 PIC X.
  2153         16  PL-MSTR-CNTRL.
  2154             20  PL-CONTROL-A.
  2155                 24  PL-CARRIER            PIC X.
  2156                 24  PL-GROUPING           PIC X(6).
  2157                 24  PL-STATE              PIC XX.
  2158                 24  PL-ACCOUNT            PIC X(10).
  2159             20  PL-BENEFIT-TYPE           PIC X.
  2160             20  PL-BENEFIT-CODE           PIC XX.
  2161             20  PL-REVISION-NO            PIC X(3).
  2162
  2163     12  PL-CONTROL-BY-VAR-GRP.
  2164         16  PL-COMPANY-CD-A1              PIC X.
  2165         16  PL-VG-CARRIER                 PIC X.
  2166         16  PL-VG-GROUPING                PIC X(6).
  2167         16  PL-VG-STATE                   PIC XX.
  2168         16  PL-VG-ACCOUNT                 PIC X(10).
  2169         16  PL-BENEFIT-TYPE-A1            PIC X.
  2170         16  PL-BENEFIT-CODE-A1            PIC XX.
  2171         16  PL-REVISION-NO-A1             PIC 999.
  2172
  2173     12  PL-MAINT-INFORMATION.
  2174         16  PL-LAST-MAINT-DT              PIC XX.
  2175         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2176         16  PL-LAST-MAINT-USER            PIC X(4).
  2177         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  41
* EL050.cbl
  2178
  2179     12  PL-LIABILITY-LIMITS.
  2180         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2181         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2182             20  PL-LM-AGE                 PIC S99        COMP-3.
  2183             20  PL-LM-DUR                 PIC S999       COMP-3.
  2184             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2185             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2186
  2187     12  FILLER                            PIC X(30).
  2188
  2189     12  PL-GL-ACCOUNT-NOS.
  2190         16  PL-PREMIUM-GL                 PIC X(8).
  2191         16  PL-COMM-GL                    PIC X(8).
  2192         16  PL-CLAIM-GL                   PIC X(8).
  2193     12  FILLER                            PIC X(24).
  2194     12  PL-TOLERANCES.
  2195         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2196         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2197         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2198         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2199         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2200         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2201     12  PL-OVER-SHORT.
  2202         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2203         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2204     12  FILLER                            PIC X(24).
  2205     12  PLAN-MISC.
  2206         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2207         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2208         16  PL-IG                         PIC X.
  2209         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2210         16  PL-POLICY-FORM                PIC X(12).
  2211         16  PL-EDIT-FOR-FORM              PIC X(01).
  2212         16  PL-DEV-CODE                   PIC XXX.
  2213         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2214         16  PL-CALC-METHOD                PIC X.
  2215         16  PL-BENEFIT-GROUP              PIC X(05).
  2216         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2217
  2218         16  FILLER                        PIC X(99).
  2219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  42
* EL050.cbl
  2221*    COPY ELCCERT.
  2222******************************************************************
  2223*                                                                *
  2224*                            ELCCERT.                            *
  2225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2226*                            VMOD=2.013                          *
  2227*                                                                *
  2228*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2229*                                                                *
  2230*   FILE TYPE = VSAM,KSDS                                        *
  2231*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2232*                                                                *
  2233*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2234*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2235*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2236*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2237*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2238*                                                                *
  2239*   LOG = YES                                                    *
  2240*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2241******************************************************************
  2242*                   C H A N G E   L O G
  2243*
  2244* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2245*-----------------------------------------------------------------
  2246*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2247* EFFECTIVE    NUMBER
  2248*-----------------------------------------------------------------
  2249* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2250* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2251* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2252* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2253* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2254* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2255* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2256* 032612  CR2011110200001  PEMA  AHL CHANGES
  2257* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2258* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2259* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2260******************************************************************
  2261
  2262 01  CERTIFICATE-MASTER.
  2263     12  CM-RECORD-ID                      PIC XX.
  2264         88  VALID-CM-ID                      VALUE 'CM'.
  2265
  2266     12  CM-CONTROL-PRIMARY.
  2267         16  CM-COMPANY-CD                 PIC X.
  2268         16  CM-CARRIER                    PIC X.
  2269         16  CM-GROUPING.
  2270             20  CM-GROUPING-PREFIX        PIC X(3).
  2271             20  CM-GROUPING-PRIME         PIC X(3).
  2272         16  CM-STATE                      PIC XX.
  2273         16  CM-ACCOUNT.
  2274             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2275             20  CM-ACCOUNT-PRIME          PIC X(6).
  2276         16  CM-CERT-EFF-DT                PIC XX.
  2277         16  CM-CERT-NO.
  2278             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  43
* EL050.cbl
  2279             20  CM-CERT-SFX               PIC X.
  2280
  2281     12  CM-CONTROL-BY-NAME.
  2282         16  CM-COMPANY-CD-A1              PIC X.
  2283         16  CM-INSURED-LAST-NAME          PIC X(15).
  2284         16  CM-INSURED-INITIALS.
  2285             20  CM-INSURED-INITIAL1       PIC X.
  2286             20  CM-INSURED-INITIAL2       PIC X.
  2287
  2288     12  CM-CONTROL-BY-SSN.
  2289         16  CM-COMPANY-CD-A2              PIC X.
  2290         16  CM-SOC-SEC-NO.
  2291             20  CM-SSN-STATE              PIC XX.
  2292             20  CM-SSN-ACCOUNT            PIC X(6).
  2293             20  CM-SSN-LN3.
  2294                 25  CM-INSURED-INITIALS-A2.
  2295                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2296                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2297                 25 CM-PART-LAST-NAME-A2         PIC X.
  2298
  2299     12  CM-CONTROL-BY-CERT-NO.
  2300         16  CM-COMPANY-CD-A4              PIC X.
  2301         16  CM-CERT-NO-A4                 PIC X(11).
  2302
  2303     12  CM-CONTROL-BY-MEMB.
  2304         16  CM-COMPANY-CD-A5              PIC X.
  2305         16  CM-MEMBER-NO.
  2306             20  CM-MEMB-STATE             PIC XX.
  2307             20  CM-MEMB-ACCOUNT           PIC X(6).
  2308             20  CM-MEMB-LN4.
  2309                 25  CM-INSURED-INITIALS-A5.
  2310                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2311                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2312                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2313
  2314     12  CM-INSURED-PROFILE-DATA.
  2315         16  CM-INSURED-FIRST-NAME.
  2316             20  CM-INSURED-1ST-INIT       PIC X.
  2317             20  FILLER                    PIC X(9).
  2318         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2319         16  CM-INSURED-SEX                PIC X.
  2320             88  CM-SEX-MALE                  VALUE 'M'.
  2321             88  CM-SEX-FEMAL                 VALUE 'F'.
  2322         16  CM-INSURED-JOINT-AGE          PIC 99.
  2323         16  CM-JOINT-INSURED-NAME.
  2324             20  CM-JT-LAST-NAME           PIC X(15).
  2325             20  CM-JT-FIRST-NAME.
  2326                 24  CM-JT-1ST-INIT        PIC X.
  2327                 24  FILLER                PIC X(9).
  2328             20  CM-JT-INITIAL             PIC X.
  2329
  2330     12  CM-LIFE-DATA.
  2331         16  CM-LF-BENEFIT-CD              PIC XX.
  2332         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2333         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2334         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2335         16  CM-LF-DEV-CODE                PIC XXX.
  2336         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  44
* EL050.cbl
  2337         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2338         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2339         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2340         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2341         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2342         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2343         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2344         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2345         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2346         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2347         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2348         16  cm-temp-epiq                  pic xx.
  2349             88  EPIQ-CLASS                  value 'EQ'.
  2350*        16  FILLER                        PIC XX.
  2351
  2352     12  CM-AH-DATA.
  2353         16  CM-AH-BENEFIT-CD              PIC XX.
  2354         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2355         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2356         16  CM-AH-DEV-CODE                PIC XXX.
  2357         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2358         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2359         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2360         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2361         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2362         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2363         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2364         16  CM-AH-PAID-THRU-DT            PIC XX.
  2365             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2366         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2367         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2368         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2369         16  FILLER                        PIC X.
  2370
  2371     12  CM-LOAN-INFORMATION.
  2372         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2373         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2374                                           PIC S9(5)V99  COMP-3.
  2375         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2376         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2377         16  CM-PAY-FREQUENCY              PIC S99.
  2378         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2379         16  CM-RATE-CLASS                 PIC XX.
  2380         16  CM-BENEFICIARY                PIC X(25).
  2381         16  CM-POLICY-FORM-NO             PIC X(12).
  2382         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2383         16  CM-LAST-ADD-ON-DT             PIC XX.
  2384         16  CM-DEDUCTIBLE-AMOUNTS.
  2385             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2386             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2387         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2388             20  CM-RESIDENT-STATE         PIC XX.
  2389             20  CM-RATE-CODE              PIC X(4).
  2390             20  FILLER                    PIC XX.
  2391         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2392             20  CM-LOAN-OFFICER           PIC X(5).
  2393             20  FILLER                    PIC XXX.
  2394         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  45
* EL050.cbl
  2395         16  CM-UNDERWRITING-CODE          PIC X.
  2396             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2397         16  CM-POST-CARD-IND              PIC X.
  2398         16  CM-REF-INTERFACE-SW           PIC X.
  2399         16  CM-PREMIUM-TYPE               PIC X.
  2400             88  CM-SING-PRM                  VALUE '1'.
  2401             88  CM-O-B-COVERAGE              VALUE '2'.
  2402             88  CM-OPEN-END                  VALUE '3'.
  2403         16  CM-IND-GRP-TYPE               PIC X.
  2404             88  CM-INDIVIDUAL                VALUE 'I'.
  2405             88  CM-GROUP                     VALUE 'G'.
  2406         16  CM-SKIP-CODE                  PIC X.
  2407             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2408             88  SKIP-JULY                    VALUE '1'.
  2409             88  SKIP-AUGUST                  VALUE '2'.
  2410             88  SKIP-SEPTEMBER               VALUE '3'.
  2411             88  SKIP-JULY-AUG                VALUE '4'.
  2412             88  SKIP-AUG-SEPT                VALUE '5'.
  2413             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2414             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2415             88  SKIP-JUNE                    VALUE '8'.
  2416             88  SKIP-JUNE-JULY               VALUE '9'.
  2417             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2418             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2419         16  CM-PAYMENT-MODE               PIC X.
  2420             88  PAY-MONTHLY                  VALUE SPACE.
  2421             88  PAY-WEEKLY                   VALUE '1'.
  2422             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2423             88  PAY-BI-WEEKLY                VALUE '3'.
  2424             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2425         16  CM-LOAN-NUMBER                PIC X(8).
  2426         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2427         16  CM-OLD-LOF                    PIC XXX.
  2428*        16  CM-LOAN-OFFICER               PIC XXX.
  2429         16  CM-REIN-TABLE                 PIC XXX.
  2430         16  CM-SPECIAL-REIN-CODE          PIC X.
  2431         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2432         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2433         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2434
  2435     12  CM-STATUS-DATA.
  2436         16  CM-ENTRY-STATUS               PIC X.
  2437         16  CM-ENTRY-DT                   PIC XX.
  2438
  2439         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2440         16  CM-LF-CANCEL-DT               PIC XX.
  2441         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2442
  2443         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2444         16  CM-LF-DEATH-DT                PIC XX.
  2445         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2446
  2447         16  CM-LF-CURRENT-STATUS          PIC X.
  2448             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2449                                                'M' '4' '5' '9'.
  2450             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2451             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2452             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  46
* EL050.cbl
  2453             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2454             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2455             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2456             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2457             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2458             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2459             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2460             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2461             88  CM-LF-DECLINED               VALUE 'D'.
  2462             88  CM-LF-VOIDED                 VALUE 'V'.
  2463
  2464         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2465         16  CM-AH-CANCEL-DT               PIC XX.
  2466         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2467
  2468         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2469         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2470         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2471
  2472         16  CM-AH-CURRENT-STATUS          PIC X.
  2473             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2474                                                'M' '4' '5' '9'.
  2475             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2476             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2477             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2478             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2479             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2480             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2481             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2482             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2483             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2484             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2485             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2486             88  CM-AH-DECLINED               VALUE 'D'.
  2487             88  CM-AH-VOIDED                 VALUE 'V'.
  2488
  2489         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2490             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2491             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2492             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2493         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2494
  2495         16  CM-ENTRY-BATCH                PIC X(6).
  2496         16  CM-LF-EXIT-BATCH              PIC X(6).
  2497         16  CM-AH-EXIT-BATCH              PIC X(6).
  2498         16  CM-LAST-MONTH-END             PIC XX.
  2499
  2500     12  CM-NOTE-SW                        PIC X.
  2501         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2502         88  CERT-NOTES-PRESENT               VALUE '1'.
  2503         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2504         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2505         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2506         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2507         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2508         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2509     12  CM-COMP-EXCP-SW                   PIC X.
  2510         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  47
* EL050.cbl
  2511         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2512     12  CM-INSURED-ADDRESS-SW             PIC X.
  2513         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2514         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2515
  2516*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2517     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2518     12  FILLER                            PIC X.
  2519
  2520*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2521     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2522     12  FILLER                            PIC X.
  2523*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2524     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2525
  2526     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2527         88  CERT-ADDED-BATCH                 VALUE ' '.
  2528         88  CERT-ADDED-ONLINE                VALUE '1'.
  2529         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2530         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2531         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2532     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2533         88  CERT-AS-LOADED                   VALUE ' '.
  2534         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2535         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2536         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2537         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2538         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2539         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2540         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2541
  2542     12  CM-ACCOUNT-COMM-PCTS.
  2543         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2544         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2545
  2546     12  CM-USER-FIELD                     PIC X.
  2547     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2548     12  CM-CLP-STATE                      PIC XX.
  2549     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2550     12  CM-USER-RESERVED                  PIC XXX.
  2551     12  FILLER REDEFINES CM-USER-RESERVED.
  2552         16  CM-AH-CLASS-CD                PIC XX.
  2553         16  F                             PIC X.
  2554******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  48
* EL050.cbl
  2556*    COPY ERCMAIL.
  2557******************************************************************
  2558*                                                                *
  2559*                                                                *
  2560*                            ERCMAIL                             *
  2561*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2562*                            VMOD=2.003                          *
  2563*                                                                *
  2564*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2565*                                                                *
  2566*   FILE TYPE = VSAM,KSDS                                        *
  2567*   RECORD SIZE = 374   RECFORM = FIX                            *
  2568*                                                                *
  2569*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2570*   ALTERNATE PATH    = NOT USED                                 *
  2571*                                                                *
  2572*   LOG = YES                                                    *
  2573*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2574******************************************************************
  2575*                   C H A N G E   L O G
  2576*
  2577* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2578*-----------------------------------------------------------------
  2579*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2580* EFFECTIVE    NUMBER
  2581*-----------------------------------------------------------------
  2582* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2583* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2584* 111108                   PEMA  ADD CRED BENE ADDR2
  2585******************************************************************
  2586
  2587 01  MAILING-DATA.
  2588     12  MA-RECORD-ID                      PIC XX.
  2589         88  VALID-MA-ID                       VALUE 'MA'.
  2590
  2591     12  MA-CONTROL-PRIMARY.
  2592         16  MA-COMPANY-CD                 PIC X.
  2593         16  MA-CARRIER                    PIC X.
  2594         16  MA-GROUPING.
  2595             20  MA-GROUPING-PREFIX        PIC XXX.
  2596             20  MA-GROUPING-PRIME         PIC XXX.
  2597         16  MA-STATE                      PIC XX.
  2598         16  MA-ACCOUNT.
  2599             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2600             20  MA-ACCOUNT-PRIME          PIC X(6).
  2601         16  MA-CERT-EFF-DT                PIC XX.
  2602         16  MA-CERT-NO.
  2603             20  MA-CERT-PRIME             PIC X(10).
  2604             20  MA-CERT-SFX               PIC X.
  2605
  2606     12  FILLER                            PIC XX.
  2607
  2608     12  MA-ACCESS-CONTROL.
  2609         16  MA-SOURCE-SYSTEM              PIC XX.
  2610             88  MA-FROM-CREDIT                VALUE 'CR'.
  2611             88  MA-FROM-VSI                   VALUE 'VS'.
  2612             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2613             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  49
* EL050.cbl
  2614         16  MA-RECORD-ADD-DT              PIC XX.
  2615         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2616         16  MA-LAST-MAINT-DT              PIC XX.
  2617         16  MA-LAST-MAINT-BY              PIC XXXX.
  2618         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2619
  2620     12  MA-PROFILE-INFO.
  2621         16  MA-QUALIFY-CODE-1             PIC XX.
  2622         16  MA-QUALIFY-CODE-2             PIC XX.
  2623         16  MA-QUALIFY-CODE-3             PIC XX.
  2624         16  MA-QUALIFY-CODE-4             PIC XX.
  2625         16  MA-QUALIFY-CODE-5             PIC XX.
  2626
  2627         16  MA-INSURED-LAST-NAME          PIC X(15).
  2628         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2629         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2630         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2631         16  MA-INSURED-BIRTH-DT           PIC XX.
  2632         16  MA-INSURED-SEX                PIC X.
  2633             88  MA-SEX-MALE                   VALUE 'M'.
  2634             88  MA-SEX-FEMALE                 VALUE 'F'.
  2635         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2636
  2637         16  MA-ADDRESS-CORRECTED          PIC X.
  2638         16  MA-JOINT-BIRTH-DT             PIC XX.
  2639*        16  FILLER                        PIC X(12).
  2640
  2641         16  MA-ADDRESS-LINE-1             PIC X(30).
  2642         16  MA-ADDRESS-LINE-2             PIC X(30).
  2643         16  MA-CITY-STATE.
  2644             20  MA-CITY                   PIC X(28).
  2645             20  MA-ADDR-STATE             PIC XX.
  2646         16  MA-ZIP.
  2647             20  MA-ZIP-CODE.
  2648                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2649                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2650                 24  FILLER                PIC X(4).
  2651             20  MA-ZIP-PLUS4              PIC X(4).
  2652         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2653             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2654             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2655             20  FILLER                    PIC X(3).
  2656
  2657         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2658
  2659         16  FILLER                        PIC XXX.
  2660*        16  FILLER                        PIC X(10).
  2661
  2662     12  MA-CRED-BENE-INFO.
  2663         16  MA-CRED-BENE-NAME                 PIC X(25).
  2664         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2665         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2666         16  MA-CRED-BENE-CTYST.
  2667             20  MA-CRED-BENE-CITY             PIC X(28).
  2668             20  MA-CRED-BENE-STATE            PIC XX.
  2669         16  MA-CRED-BENE-ZIP.
  2670             20  MA-CB-ZIP-CODE.
  2671                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  50
* EL050.cbl
  2672                     88  MA-CB-CANADIAN-POST-CODE
  2673                                           VALUE 'A' THRU 'Z'.
  2674                 24  FILLER                    PIC X(4).
  2675             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2676         16  MA-CB-CANADIAN-POSTAL-CODE
  2677                            REDEFINES MA-CRED-BENE-ZIP.
  2678             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2679             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2680             20  FILLER                        PIC X(3).
  2681     12  MA-POST-CARD-MAIL-DATA.
  2682         16  MA-MAIL-DATA OCCURS 7.
  2683             20  MA-MAIL-TYPE              PIC X.
  2684                 88  MA-12MO-MAILING           VALUE '1'.
  2685                 88  MA-EXP-MAILING            VALUE '2'.
  2686             20  MA-MAIL-STATUS            PIC X.
  2687                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2688                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2689                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2690             20  MA-MAIL-DATE              PIC XX.
  2691     12  FILLER                            PIC XX.
  2692     12  FILLER                            PIC XX.
  2693*    12  FILLER                            PIC X(30).
  2694******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  51
* EL050.cbl
  2696*    COPY ERCPNDM.
  2697******************************************************************
  2698*                                                                *
  2699*                                                                *
  2700*                            ERCPNDM                             *
  2701*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2702*                            VMOD=2.003                          *
  2703*                                                                *
  2704*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2705*                                                                *
  2706*   FILE TYPE = VSAM,KSDS                                        *
  2707*   RECORD SIZE = 374   RECFORM = FIX                            *
  2708*                                                                *
  2709*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2710*   ALTERNATE PATH    = NOT USED                                 *
  2711*                                                                *
  2712*   LOG = YES                                                    *
  2713*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2714******************************************************************
  2715*                   C H A N G E   L O G
  2716*
  2717* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2718*-----------------------------------------------------------------
  2719*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2720* EFFECTIVE    NUMBER
  2721*-----------------------------------------------------------------
  2722* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2723* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2724* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2725* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2726******************************************************************
  2727
  2728 01  PENDING-MAILING-DATA.
  2729     12  PM-RECORD-ID                      PIC XX.
  2730         88  VALID-MA-ID                       VALUE 'PM'.
  2731
  2732     12  PM-CONTROL-PRIMARY.
  2733         16  PM-COMPANY-CD                 PIC X.
  2734         16  PM-ENTRY-BATCH                PIC X(6).
  2735         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2736         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2737
  2738     12  FILLER                            PIC X(14).
  2739
  2740     12  PM-ACCESS-CONTROL.
  2741         16  PM-SOURCE-SYSTEM              PIC XX.
  2742             88  PM-FROM-CREDIT                VALUE 'CR'.
  2743             88  PM-FROM-VSI                   VALUE 'VS'.
  2744             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2745             88  PM-FROM-OTHER                 VALUE 'OT'.
  2746         16  PM-RECORD-ADD-DT              PIC XX.
  2747         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2748         16  PM-LAST-MAINT-DT              PIC XX.
  2749         16  PM-LAST-MAINT-BY              PIC XXXX.
  2750         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2751
  2752     12  PM-PROFILE-INFO.
  2753         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  52
* EL050.cbl
  2754         16  PM-QUALIFY-CODE-2             PIC XX.
  2755         16  PM-QUALIFY-CODE-3             PIC XX.
  2756         16  PM-QUALIFY-CODE-4             PIC XX.
  2757         16  PM-QUALIFY-CODE-5             PIC XX.
  2758
  2759         16  PM-INSURED-LAST-NAME          PIC X(15).
  2760         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2761         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2762         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2763         16  PM-INSURED-BIRTH-DT           PIC XX.
  2764         16  PM-INSURED-SEX                PIC X.
  2765             88  PM-SEX-MALE                   VALUE 'M'.
  2766             88  PM-SEX-FEMALE                 VALUE 'F'.
  2767         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2768
  2769         16  PM-ADDRESS-CORRECTED          PIC X.
  2770         16  PM-JOINT-BIRTH-DT             PIC XX.
  2771*        16  FILLER                        PIC X(12).
  2772
  2773         16  PM-ADDRESS-LINE-1             PIC X(30).
  2774         16  PM-ADDRESS-LINE-2             PIC X(30).
  2775         16  PM-CITY-STATE.
  2776             20  PM-CITY                   PIC X(28).
  2777             20  PM-STATE                  PIC XX.
  2778         16  PM-ZIP.
  2779             20  PM-ZIP-CODE.
  2780                 24  PM-ZIP-1              PIC X.
  2781                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2782                 24  FILLER                PIC X(4).
  2783             20  PM-ZIP-PLUS4              PIC X(4).
  2784         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2785             20  PM-CAN-POST1              PIC XXX.
  2786             20  PM-CAN-POST2              PIC XXX.
  2787             20  FILLER                    PIC XXX.
  2788
  2789         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2790         16  pm-city-st-zip-verified       pic x.
  2791         16  FILLER                        PIC XX.
  2792
  2793     12  PM-CRED-BENE-INFO.
  2794         16  PM-CRED-BENE-NAME             PIC X(25).
  2795         16  PM-CRED-BENE-ADDR             PIC X(30).
  2796         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2797         16  PM-CRED-BENE-CTYST.
  2798             20  PM-CRED-BENE-CITY         PIC X(28).
  2799             20  PM-CRED-BENE-STATE        PIC XX.
  2800         16  PM-CRED-BENE-ZIP.
  2801             20  PM-CB-ZIP-CODE.
  2802                 24  PM-CB-ZIP-1           PIC X.
  2803                     88  PM-CB-CANADIAN-POST-CODE
  2804                                  VALUE 'A' THRU 'Z'.
  2805                 24  FILLER                PIC X(4).
  2806             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2807         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2808             20  PM-CB-CAN-POST1           PIC XXX.
  2809             20  PM-CB-CAN-POST2           PIC XXX.
  2810             20  FILLER                    PIC XXX.
  2811     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  53
* EL050.cbl
  2812         16  PM-MAIL-DATA OCCURS 7.
  2813             20  PM-MAIL-TYPE              PIC X.
  2814                 88  PM-12MO-MAILING           VALUE '1'.
  2815                 88  PM-EXP-MAILING            VALUE '2'.
  2816             20  PM-MAIL-STATUS            PIC X.
  2817                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2818                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2819                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2820             20  PM-MAIL-DATE              PIC XX.
  2821     12  FILLER                            PIC XX.
  2822     12  FILLER                            PIC X(12).
  2823*    12  FILLER                            PIC X(30).
  2824
  2825******************************************************************
  2826*                                COPY ERCLOFC.
  2827******************************************************************
  2828*                                                                *
  2829*                                                                *
  2830*                            ERCLOFC                             *
  2831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2832*                            VMOD=2.003                          *
  2833*                                                                *
  2834*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2835*                                                                *
  2836*   FILE TYPE = VSAM,KSDS                                        *
  2837*   RECORD SIZE = 670   RECFORM = FIX                            *
  2838*                                                                *
  2839*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2840*                                                                *
  2841*   LOG = YES                                                    *
  2842*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2843*                                                                *
  2844******************************************************************
  2845
  2846 01  LOAN-OFFICER-MASTER.
  2847     12  LO-RECORD-ID                PIC XX.
  2848         88  VALID-LO-ID                VALUE 'LO'.
  2849
  2850     12  LO-CONTROL-PRIMARY.
  2851         16  LO-COMPANY-CD           PIC X.
  2852         16  LO-CARRIER              PIC X.
  2853         16  LO-GROUPING.
  2854             20  LO-GROUPING-PREFIX  PIC XXX.
  2855             20  LO-GROUPING-PRIME   PIC XXX.
  2856         16  LO-STATE                PIC XX.
  2857         16  LO-ACCOUNT.
  2858             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2859             20  LO-ACCOUNT-PRIME    PIC X(6).
  2860         16  LO-OFFICER-CODE         PIC X(5).
  2861
  2862     12  LO-OFFICER-NAME             PIC X(30).
  2863
  2864     12  LO-LAST-MAINT-DT            PIC XX.
  2865     12  LO-LAST-USER                PIC X(4).
  2866     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2867
  2868     12  LO-COMP-CONTROL             PIC X.
  2869             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  54
* EL050.cbl
  2870             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2871     12  LO-DETAIL-CONTROL           PIC X.
  2872             88  LO-PRINT-DETAIL        VALUE 'D'.
  2873             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2874
  2875     12  LO-SV-CARRIER               PIC X.
  2876     12  LO-SV-GROUPING              PIC X(6).
  2877     12  LO-SV-STATE                 PIC XX.
  2878
  2879     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2880     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2881
  2882     12  LO-OFFICER-INFO.
  2883         16  FILLER OCCURS 12 TIMES.
  2884             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2885             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2886             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2887             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2888             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2889             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2890             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2891             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2892     12  FILLER                      PIC X(198).
  2893******************************************************************
  2894*                                COPY ERCPDEF.
  2895******************************************************************
  2896*                                                                *
  2897*                                                                *
  2898*                            ERCPDEF.                            *
  2899*                                                                *
  2900*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2901*                                                                *
  2902*    FILE TYPE = VSAM,KSDS                                       *
  2903*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2904*                                                                *
  2905*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2906*                                                                *
  2907*    LOG = YES                                                   *
  2908*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2909******************************************************************
  2910*                   C H A N G E   L O G
  2911*
  2912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2913*-----------------------------------------------------------------
  2914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2915* EFFECTIVE    NUMBER
  2916*-----------------------------------------------------------------
  2917* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2918* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2919* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2920* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  2921******************************************************************
  2922 01  PRODUCT-MASTER.
  2923    12  PD-RECORD-ID                 PIC X(02).
  2924        88  VALID-PD-ID                  VALUE 'PD'.
  2925    12  PD-CONTROL-PRIMARY.
  2926        16  PD-COMPANY-CD            PIC X.
  2927        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  55
* EL050.cbl
  2928        16  PD-PRODUCT-CD            PIC XXX.
  2929        16  PD-FILLER                PIC X(7).
  2930        16  PD-BEN-TYPE              PIC X.
  2931        16  PD-BEN-CODE              PIC XX.
  2932        16  PD-PROD-EXP-DT           PIC XX.
  2933    12  FILLER                       PIC X(50).
  2934    12  PD-PRODUCT-DATA OCCURS 8.
  2935        16  PD-PROD-CODE             PIC X.
  2936            88  PD-PROD-LIFE           VALUE 'L'.
  2937            88  PD-PROD-PROP           VALUE 'P'.
  2938            88  PD-PROD-AH             VALUE 'A'.
  2939            88  PD-PROD-IU             VALUE 'I'.
  2940            88  PD-PROD-GAP            VALUE 'G'.
  2941            88  PD-PROD-FAML           VALUE 'F'.
  2942            88  PD-PROD-OTH            VALUE 'O'.
  2943        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2944        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2945        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2946        16  PD-MAX-TERM              PIC S999        COMP-3.
  2947        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2948        16  FILLER                   PIC X.
  2949        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2950        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2951        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2952        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2953        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2954        16  PD-REC-CRIT-PERIOD       PIC 99.
  2955        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2956            20  PD-RECURRING-YN      PIC X.
  2957            20  FILLER               PIC X.
  2958        16  PD-RTW-MOS               PIC 99.
  2959        16  PD-MAX-EXTENSION         PIC 99.
  2960        16  pd-ben-pct               pic sv999 comp-3.
  2961*       16  FILLER                   PIC XX.
  2962    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2963    12  PD-TERM-LIMITS OCCURS 15.
  2964        16  PD-LOW-TERM              PIC S999        COMP-3.
  2965        16  PD-HI-TERM               PIC S999        COMP-3.
  2966*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2967    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2968        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2969        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2970    12  PD-EARN-FACTORS.
  2971        16  FILLER OCCURS 15.
  2972            20  FILLER OCCURS 15.
  2973                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2974    12  PD-PRODUCT-DESC              PIC X(80).
  2975    12  PD-TRUNCATED                 PIC X.
  2976    12  FILLER                       PIC X(59).
  2977    12  PD-MAINT-INFORMATION.
  2978        16  PD-LAST-MAINT-DT         PIC X(02).
  2979        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2980        16  PD-LAST-MAINT-BY         PIC X(04).
  2981*                                COPY ELCSTATE.
  2982******************************************************************
  2983*                                                                *
  2984*                                                                *
  2985*                            ELCSTATE.                           *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  56
* EL050.cbl
  2986*                                                                *
  2987*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2988*                                                                *
  2989*   FILE TYPE = VSAM,KSDS                                        *
  2990*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2991*                                                                *
  2992*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2993*       ALTERNATE INDEX = NONE                                   *
  2994*                                                                *
  2995*   LOG = YES                                                    *
  2996*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2997******************************************************************
  2998*                   C H A N G E   L O G
  2999*
  3000* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3001*-----------------------------------------------------------------
  3002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3003* EFFECTIVE    NUMBER
  3004*-----------------------------------------------------------------
  3005* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  3006******************************************************************
  3007*
  3008 01  STATE-FILE.
  3009     12  SF-RECORD-ID                       PIC XX.
  3010         88  VALID-CF-ID                        VALUE 'SF'.
  3011     12  SF-CONTROL-PRIMARY.
  3012         16  SF-COMPANY-ID                  PIC XXX.
  3013         16  SF-CARRIER-CODE                PIC X.
  3014         16  SF-GROUPING                    PIC X(6).
  3015         16  SF-STATE-CODE                  PIC XX.
  3016         16  SF-EXPIRE-DATE                 PIC 9(8).
  3017****************************************************************
  3018*             STATE CONTROLS
  3019****************************************************************
  3020     12  SF-LAST-MAINT-DT                   PIC XX.
  3021     12  SF-LAST-MAINT-BY                   PIC X(4).
  3022     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3023     12  SF-STATE-RT-CONTROLS.
  3024         16  SF-ST-RT-CALC                  PIC X.
  3025     12  SF-ST-TAX-CONTROLS.
  3026         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3027         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3028         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3029     12  SF-ST-REFUND-OPTIONS.
  3030         16  SF-ST-RF-LR-CALC               PIC X.
  3031         16  SF-ST-RF-LL-CALC               PIC X.
  3032         16  SF-ST-RF-LN-CALC               PIC X.
  3033         16  SF-ST-RF-AH-CALC               PIC X.
  3034         16  SF-ST-RF-CP-CALC               PIC X.
  3035     12  SF-ST-UNEARN-PREM-OPTIONS.
  3036         16  SF-ST-LUEP-R78                 PIC X.
  3037         16  SF-ST-LUEP-PRO                 PIC X.
  3038         16  SF-ST-LUEP-ST                  PIC X.
  3039         16  SF-ST-LUEP-DOM                 PIC X.
  3040         16  SF-ST-AUEP-R78                 PIC X.
  3041         16  SF-ST-AUEP-PRO                 PIC X.
  3042         16  SF-ST-AUEP-ST                  PIC X.
  3043         16  SF-ST-AUEP-DOM                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  57
* EL050.cbl
  3044         16  SF-ST-CUEP-R78                 PIC X.
  3045         16  SF-ST-CUEP-PRO                 PIC X.
  3046         16  SF-ST-CUEP-ST                  PIC X.
  3047         16  SF-ST-CUEP-DOM                 PIC X.
  3048     12  SF-ST-EARN-PREM-OPTIONS.
  3049         16  SF-ST-LEP-R78                  PIC X.
  3050         16  SF-ST-LEP-PRO                  PIC X.
  3051         16  SF-ST-LEP-ST                   PIC X.
  3052         16  SF-ST-LEP-DOM                  PIC X.
  3053         16  SF-ST-AEP-R78                  PIC X.
  3054         16  SF-ST-AEP-PRO                  PIC X.
  3055         16  SF-ST-AEP-ST                   PIC X.
  3056         16  SF-ST-AEP-DOM                  PIC X.
  3057         16  SF-ST-CEP-R78                  PIC X.
  3058         16  SF-ST-CEP-PRO                  PIC X.
  3059         16  SF-ST-CEP-ST                   PIC X.
  3060         16  SF-ST-CEP-DOM                  PIC X.
  3061     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  58
* EL050.cbl
  3063*    COPY ELCCRTT.
  3064******************************************************************
  3065*                                                                *
  3066*                            ELCCRTT.                            *
  3067*                                                                *
  3068*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3069*                                                                *
  3070*   FILE TYPE = VSAM,KSDS                                        *
  3071*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3072*                                                                *
  3073*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3074*                                                                *
  3075*   LOG = YES                                                    *
  3076*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3077******************************************************************
  3078*                   C H A N G E   L O G
  3079*
  3080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3081*-----------------------------------------------------------------
  3082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3083* EFFECTIVE    NUMBER
  3084*-----------------------------------------------------------------
  3085* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3086* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3087* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3088* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3089* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3090* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3091* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3092* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3093* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3094* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3095* 091318  CR2018073000001  PEMA  ADD Refund methods
  3096* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3097******************************************************************
  3098
  3099 01  CERTIFICATE-TRAILERS.
  3100     12  CS-RECORD-ID                      PIC XX.
  3101         88  VALID-CS-ID                      VALUE 'CS'.
  3102
  3103     12  CS-CONTROL-PRIMARY.
  3104         16  CS-COMPANY-CD                 PIC X.
  3105         16  CS-CARRIER                    PIC X.
  3106         16  CS-GROUPING                   PIC X(6).
  3107         16  CS-STATE                      PIC XX.
  3108         16  CS-ACCOUNT                    PIC X(10).
  3109         16  CS-CERT-EFF-DT                PIC XX.
  3110         16  CS-CERT-NO.
  3111             20  CS-CERT-PRIME             PIC X(10).
  3112             20  CS-CERT-SFX               PIC X.
  3113         16  CS-TRAILER-TYPE               PIC X.
  3114             88  COMM-TRLR           VALUE 'A'.
  3115             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3116             88  CERT-DATA-TRLR      VALUE 'C'.
  3117
  3118     12  CS-DATA-AREA                      PIC X(516).
  3119
  3120     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  59
* EL050.cbl
  3121         16  CS-BANK-COMMISSION-AREA.
  3122             20  CS-BANK-COMMS       OCCURS 10.
  3123                 24  CS-AGT                PIC X(10).
  3124                 24  CS-COM-TYP            PIC X.
  3125                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3126                 24  CS-RECALC-LV-INDIC    PIC X.
  3127                 24  FILLER                PIC X(10).
  3128         16  FILLER                        PIC X(256).
  3129
  3130     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3131****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3132         16  CS-MB-CLAIM-DATA OCCURS 24.
  3133             20  CS-CLAIM-NO               PIC X(7).
  3134             20  CS-CLAIM-TYPE             PIC X.
  3135                 88  CS-AH-CLM               VALUE 'A'.
  3136                 88  CS-IU-CLM               VALUE 'I'.
  3137                 88  CS-GP-CLM               VALUE 'G'.
  3138                 88  CS-LF-CLM               VALUE 'L'.
  3139                 88  CS-PR-CLM               VALUE 'P'.
  3140                 88  CS-FL-CLM               VALUE 'F'.
  3141                 88  CS-OT-CLM               VALUE 'O'.
  3142             20  CS-INSURED-TYPE           PIC X.
  3143                 88  CS-PRIM-INSURED          VALUE 'P'.
  3144                 88  CS-CO-BORROWER           VALUE 'C'.
  3145             20  CS-BENEFIT-PERIOD         PIC 99.
  3146             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3147             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3148             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3149         16  FILLER                        PIC X(12).
  3150     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3151         16  CS-VIN-NUMBER                 PIC X(17).
  3152         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3153         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3154         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3155         16  cs-agent-name.
  3156             20  cs-agent-fname            pic x(20).
  3157             20  cs-agent-mi               pic x.
  3158             20  cs-agent-lname            pic x(25).
  3159         16  cs-license-no                 pic x(15).
  3160         16  cs-npn-number                 pic x(10).
  3161         16  cs-agent-edit-status          pic x.
  3162             88  cs-ae-refer-to-manager      value 'M'.
  3163             88  cs-ae-cover-sheet           value 'C'.
  3164             88  cs-ae-sig-form              value 'S'.
  3165             88  cs-ae-verified              value 'V'.
  3166             88  cs-unidentified-signature   value 'U'.
  3167             88  cs-cert-returned            value 'R'.
  3168             88  cs-accept-no-commission     value 'N'.
  3169         16  cs-year                       pic 9999.
  3170         16  cs-make                       pic x(20).
  3171         16  cs-model                      pic x(20).
  3172         16  cs-future                     pic x(20).
  3173         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3174         16  cs-claim-verification-status  pic x.
  3175             88  cs-clm-ver-eligible         value 'A'.
  3176             88  cs-clm-ver-partial-elig     value 'B'.
  3177             88  cs-clm-ver-not-eligible     value 'C'.
  3178             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  60
* EL050.cbl
  3179             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3180             88  cs-clm-ver-ND-CERT          value 'F'.
  3181             88  cs-clm-ver-spec-other       value 'G'.
  3182             88  cs-clam-ver-pratial-corrected
  3183                                             value 'H'.
  3184             88  cs-clm-ver-no-matches       value 'I'.
  3185             88  cs-clm-ver-not-elig-corrected
  3186                                             value 'J'.
  3187             88  cs-clm-ver-needs-review     value 'R'.
  3188             88  cs-clm-ver-sent-to-claims   value 'W'.
  3189         16  CS-LF-REFUND-METHOD           PIC X.
  3190         16  CS-AH-REFUND-METHOD           PIC X.
  3191         16  FILLER                        PIC X(353). *> was 420
  3192*        16  FILLER                        PIC X(496).
  3193*    COPY ELCCRTO.
  3194******************************************************************
  3195*                                                                *
  3196*                            ELCCRTO.                            *
  3197*                                                                *
  3198*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3199*                                                                *
  3200*   FILE TYPE = VSAM,KSDS                                        *
  3201*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3202*                                                                *
  3203*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3204*                                                                *
  3205*   LOG = YES                                                    *
  3206*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3207******************************************************************
  3208*                   C H A N G E   L O G
  3209*
  3210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3211*-----------------------------------------------------------------
  3212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3213* EFFECTIVE    NUMBER
  3214*-----------------------------------------------------------------
  3215* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3216* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3217* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3218* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3219* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3220******************************************************************
  3221 01  ORIGINAL-CERTIFICATE.
  3222     12  OC-RECORD-ID                      PIC XX.
  3223         88  VALID-OC-ID                      VALUE 'OC'.
  3224     12  OC-CONTROL-PRIMARY.
  3225         16  OC-COMPANY-CD                 PIC X.
  3226         16  OC-CARRIER                    PIC X.
  3227         16  OC-GROUPING                   PIC X(6).
  3228         16  OC-STATE                      PIC XX.
  3229         16  OC-ACCOUNT                    PIC X(10).
  3230         16  OC-CERT-EFF-DT                PIC XX.
  3231         16  OC-CERT-NO.
  3232             20  OC-CERT-PRIME             PIC X(10).
  3233             20  OC-CERT-SFX               PIC X.
  3234         16  OC-RECORD-TYPE                PIC X.
  3235         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3236     12  OC-LAST-MAINT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  61
* EL050.cbl
  3237     12  OC-LAST-MAINT-BY                  PIC X(4).
  3238     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3239     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3240     12  FILLER                            PIC X(49).
  3241     12  OC-ORIG-REC.
  3242         16  OC-INS-LAST-NAME              PIC X(15).
  3243         16  OC-INS-FIRST-NAME             PIC X(10).
  3244         16  OC-INS-MIDDLE-INIT            PIC X.
  3245         16  OC-INS-AGE                    PIC S999     COMP-3.
  3246         16  OC-JNT-LAST-NAME              PIC X(15).
  3247         16  OC-JNT-FIRST-NAME             PIC X(10).
  3248         16  OC-JNT-MIDDLE-INIT            PIC X.
  3249         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3250         16  OC-LF-BENCD                   PIC XX.
  3251         16  OC-LF-TERM                    PIC S999      COMP-3.
  3252         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3253         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3254         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3255         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3256         16  OC-LF-EXP-DT                  PIC XX.
  3257         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3258         16  OC-LF-CANCEL-DT               PIC XX.
  3259         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3260         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3261         16  OC-AH-BENCD                   PIC XX.
  3262         16  OC-AH-TERM                    PIC S999      COMP-3.
  3263         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3264         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3265         16  OC-AH-EXP-DT                  PIC XX.
  3266         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3267         16  OC-AH-CP                      PIC 99.
  3268         16  OC-AH-CANCEL-DT               PIC XX.
  3269         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3270         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3271         16  OC-CRED-BENE-NAME             PIC X(25).
  3272         16  OC-1ST-PMT-DT                 PIC XX.
  3273         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3274         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3275         16  OC-ISSUE-TRAN-IND             PIC X.
  3276         16  OC-CANCEL-TRAN-IND            PIC X.
  3277         16  FILLER                        PIC X(211).
  3278
  3279     12  FILLER                            PIC X(50).
  3280******************************************************************
  3281
  3282*    COPY ELCDATE.
  3283******************************************************************
  3284*                                                                *
  3285*                                                                *
  3286*                            ELCDATE.                            *
  3287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3288*                            VMOD=2.003
  3289*                                                                *
  3290*                                                                *
  3291*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3292*                 LENGTH = 200                                   *
  3293******************************************************************
  3294
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  62
* EL050.cbl
  3295 01  DATE-CONVERSION-DATA.
  3296     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3297     12  DC-OPTION-CODE                PIC X.
  3298         88  BIN-TO-GREG                VALUE ' '.
  3299         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3300         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3301         88  YMD-GREG-TO-BIN            VALUE '3'.
  3302         88  MDY-GREG-TO-BIN            VALUE '4'.
  3303         88  JULIAN-TO-BIN              VALUE '5'.
  3304         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3305         88  FIND-CENTURY               VALUE '7'.
  3306         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3307         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3308         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3309         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3310         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3311         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3312         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3313         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3314         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3315         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3316         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3317         88  BIN-3-TO-GREG              VALUE 'I'.
  3318         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3319         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3320         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3321         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3322         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3323         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3324         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3325         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3326         88  THREE-CHARACTER-BIN
  3327                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3328         88  GREGORIAN-TO-BIN
  3329                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3330         88  BIN-TO-GREGORIAN
  3331                  VALUES ' ' '1' 'I' '8' 'G'.
  3332         88  JULIAN-TO-BINARY
  3333                  VALUES '5' 'C' 'E' 'F'.
  3334     12  DC-ERROR-CODE                 PIC X.
  3335         88  NO-CONVERSION-ERROR        VALUE ' '.
  3336         88  DATE-CONVERSION-ERROR
  3337                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3338         88  DATE-IS-ZERO               VALUE '1'.
  3339         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3340         88  DATE-IS-INVALID            VALUE '3'.
  3341         88  DATE1-GREATER-DATE2        VALUE '4'.
  3342         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3343         88  DATE-INVALID-OPTION        VALUE '9'.
  3344         88  INVALID-CENTURY            VALUE 'A'.
  3345         88  ONLY-CENTURY               VALUE 'B'.
  3346         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3347         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3348     12  DC-END-OF-MONTH               PIC X.
  3349         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3350     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3351         88  USE-NORMAL-PROCESS         VALUE ' '.
  3352         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  63
* EL050.cbl
  3353         88  ADJUST-UP-100-YRS          VALUE '2'.
  3354     12  FILLER                        PIC X.
  3355     12  DC-CONVERSION-DATES.
  3356         16  DC-BIN-DATE-1             PIC XX.
  3357         16  DC-BIN-DATE-2             PIC XX.
  3358         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3359         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3360                       DC-GREG-DATE-1-EDIT.
  3361             20  DC-EDIT1-MONTH        PIC 99.
  3362             20  SLASH1-1              PIC X.
  3363             20  DC-EDIT1-DAY          PIC 99.
  3364             20  SLASH1-2              PIC X.
  3365             20  DC-EDIT1-YEAR         PIC 99.
  3366         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3367         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3368                     DC-GREG-DATE-2-EDIT.
  3369             20  DC-EDIT2-MONTH        PIC 99.
  3370             20  SLASH2-1              PIC X.
  3371             20  DC-EDIT2-DAY          PIC 99.
  3372             20  SLASH2-2              PIC X.
  3373             20  DC-EDIT2-YEAR         PIC 99.
  3374         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3375         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3376                     DC-GREG-DATE-1-YMD.
  3377             20  DC-YMD-YEAR           PIC 99.
  3378             20  DC-YMD-MONTH          PIC 99.
  3379             20  DC-YMD-DAY            PIC 99.
  3380         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3381         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3382                      DC-GREG-DATE-1-MDY.
  3383             20  DC-MDY-MONTH          PIC 99.
  3384             20  DC-MDY-DAY            PIC 99.
  3385             20  DC-MDY-YEAR           PIC 99.
  3386         16  DC-GREG-DATE-1-ALPHA.
  3387             20  DC-ALPHA-MONTH        PIC X(10).
  3388             20  DC-ALPHA-DAY          PIC 99.
  3389             20  FILLER                PIC XX.
  3390             20  DC-ALPHA-CENTURY.
  3391                 24 DC-ALPHA-CEN-N     PIC 99.
  3392             20  DC-ALPHA-YEAR         PIC 99.
  3393         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3394         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3395         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3396         16  DC-JULIAN-DATE            PIC 9(05).
  3397         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3398                                       PIC 9(05).
  3399         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3400             20  DC-JULIAN-YEAR        PIC 99.
  3401             20  DC-JULIAN-DAYS        PIC 999.
  3402         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3403         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3404         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3405     12  DATE-CONVERSION-VARIBLES.
  3406         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3407         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3408             20  FILLER                PIC 9(3).
  3409             20  HOLD-CEN-1-CCYY.
  3410                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  64
* EL050.cbl
  3411                 24  HOLD-CEN-1-YY     PIC 99.
  3412             20  HOLD-CEN-1-MO         PIC 99.
  3413             20  HOLD-CEN-1-DA         PIC 99.
  3414         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3415             20  HOLD-CEN-1-R-MO       PIC 99.
  3416             20  HOLD-CEN-1-R-DA       PIC 99.
  3417             20  HOLD-CEN-1-R-CCYY.
  3418                 24  HOLD-CEN-1-R-CC   PIC 99.
  3419                 24  HOLD-CEN-1-R-YY   PIC 99.
  3420             20  FILLER                PIC 9(3).
  3421         16  HOLD-CENTURY-1-X.
  3422             20  FILLER                PIC X(3)  VALUE SPACES.
  3423             20  HOLD-CEN-1-X-CCYY.
  3424                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3425                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3426             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3427             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3428         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3429             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3430             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3431             20  HOLD-CEN-1-R-X-CCYY.
  3432                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3433                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3434             20  FILLER                PIC XXX.
  3435         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3436         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3437         16  DC-JULIAN-DATE-1          PIC 9(07).
  3438         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3439             20  DC-JULIAN-1-CCYY.
  3440                 24  DC-JULIAN-1-CC    PIC 99.
  3441                 24  DC-JULIAN-1-YR    PIC 99.
  3442             20  DC-JULIAN-DA-1        PIC 999.
  3443         16  DC-JULIAN-DATE-2          PIC 9(07).
  3444         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3445             20  DC-JULIAN-2-CCYY.
  3446                 24  DC-JULIAN-2-CC    PIC 99.
  3447                 24  DC-JULIAN-2-YR    PIC 99.
  3448             20  DC-JULIAN-DA-2        PIC 999.
  3449         16  DC-GREG-DATE-A-EDIT.
  3450             20  DC-EDITA-MONTH        PIC 99.
  3451             20  SLASHA-1              PIC X VALUE '/'.
  3452             20  DC-EDITA-DAY          PIC 99.
  3453             20  SLASHA-2              PIC X VALUE '/'.
  3454             20  DC-EDITA-CCYY.
  3455                 24  DC-EDITA-CENT     PIC 99.
  3456                 24  DC-EDITA-YEAR     PIC 99.
  3457         16  DC-GREG-DATE-B-EDIT.
  3458             20  DC-EDITB-MONTH        PIC 99.
  3459             20  SLASHB-1              PIC X VALUE '/'.
  3460             20  DC-EDITB-DAY          PIC 99.
  3461             20  SLASHB-2              PIC X VALUE '/'.
  3462             20  DC-EDITB-CCYY.
  3463                 24  DC-EDITB-CENT     PIC 99.
  3464                 24  DC-EDITB-YEAR     PIC 99.
  3465         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3466         16  DC-GREG-DATE-CYMD-R REDEFINES
  3467                              DC-GREG-DATE-CYMD.
  3468             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  65
* EL050.cbl
  3469             20  DC-CYMD-YEAR          PIC 99.
  3470             20  DC-CYMD-MONTH         PIC 99.
  3471             20  DC-CYMD-DAY           PIC 99.
  3472         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3473         16  DC-GREG-DATE-MDCY-R REDEFINES
  3474                              DC-GREG-DATE-MDCY.
  3475             20  DC-MDCY-MONTH         PIC 99.
  3476             20  DC-MDCY-DAY           PIC 99.
  3477             20  DC-MDCY-CEN           PIC 99.
  3478             20  DC-MDCY-YEAR          PIC 99.
  3479    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3480        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3481    12  DC-EL310-DATE                  PIC X(21).
  3482    12  FILLER                         PIC X(28).
  3483
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  66
* EL050.cbl
  3485*    COPY ELCCALC.
  3486******************************************************************
  3487*                                                                *
  3488*                           ELCCALC.                            *
  3489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3490*                            VMOD=2.025                          *
  3491*                                                                *
  3492*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3493*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3494*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3495*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3496*                                                                *
  3497*  PASSED TO ELRTRM                                              *
  3498*  -----------------                                             *
  3499*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3500*  ORIGINAL TERM                                                 *
  3501*  BEGINNING DATE                                                *
  3502*  ENDING DATE                                                   *
  3503*  COMPANY I.D.                                                  *
  3504*  ACCOUNT MASTER USER FIELD                                     *
  3505*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3506*  FREE LOOK DAYS                                                *
  3507*                                                                *
  3508*  RETURNED FROM ELRTRM                                          *
  3509*  ---------------------                                         *
  3510*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3511*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3512*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3513*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3514*----------------------------------------------------------------*
  3515*  PASSED TO ELRAMT                                              *
  3516*  ----------------                                              *
  3517*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3518*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3519*  ORIGINAL AMOUNT                                               *
  3520*  ALTERNATE BENEFIT (BALLON)                                    *
  3521*  A.P.R. - NET PAY ONLY                                         *
  3522*  METHOD
  3523*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3524*  COMPANY I.D.                                                  *
  3525*  BENEFIT TYPE                                                  *
  3526*                                                                *
  3527*  RETURNED FROM ELRAMT                                          *
  3528*  --------------------                                          *
  3529*  REMAINING AMOUNT 1 - CURRENT                                  *
  3530*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3531*  REMAINING AMOUNT FACTOR
  3532*----------------------------------------------------------------*
  3533*  PASSED TO ELRESV                                              *
  3534*  -----------------                                             *
  3535*  CERTIFICATE EFFECTIVE DATE                                    *
  3536*  VALUATION DATE                                                *
  3537*  PAID THRU DATE                                                *
  3538*  BENEFIT                                                       *
  3539*  INCURRED DATE                                                 *
  3540*  REPORTED DATE                                                 *
  3541*  ISSUE AGE                                                     *
  3542*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  67
* EL050.cbl
  3543*  CDT PERCENT                                                   *
  3544*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3545* *CLAIM TYPE (LIFE, A/H)                                        *
  3546* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3547* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3548*                                                                *
  3549*  RETURNED FROM ELRESV                                          *
  3550*  --------------------                                          *
  3551*  CDT TABLE USED                                                *
  3552*  CDT FACTOR USED                                               *
  3553*  PAY TO CURRENT RESERVE                                        *
  3554*  I.B.N.R. - A/H ONLY                                           *
  3555*  FUTURE (ACCRUED) AH ONLY                                      *
  3556*----------------------------------------------------------------*
  3557*  PASSED TO ELRATE                                              *
  3558*  ----------------                                              *
  3559*  CERT ISSUE DATE                                               *
  3560*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3561*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3562*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3563*  STATE CODE (CLIENT DEFINED)                                   *
  3564*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3565*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3566*  DEVIATION CODE                                                *
  3567*  ISSUE AGE                                                     *
  3568*  ORIGINAL BENEFIT AMOUNT                                       *
  3569*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3570*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3571*  BENEFIT KIND (LIFE OR A/H)                                    *
  3572*  A.P.R.                                                        *
  3573*  METHOD
  3574*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3575*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3576*  COMPANY I.D. (3 CHARACTER)                                    *
  3577*  BENEFIT CODE                                                  *
  3578*  BENEFIT OVERRIDE CODE                                         *
  3579*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3580*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3581*  JOINT INDICATOR (CSL ONLY)                                    *
  3582*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3583*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3584*                                                                *
  3585*  RETURNED FROM ELRATE                                          *
  3586*  --------------------                                          *
  3587*  CALCULATED PREMIUM                                            *
  3588*  PREMIUM RATE                                                  *
  3589*  MORTALITY CODE                                                *
  3590*  MAX ATTAINED AGE                                              *
  3591*  MAX AGE                                                       *
  3592*  MAX TERM                                                      *
  3593*  MAX MONTHLY BENEFIT                                           *
  3594*  MAX TOTAL BENIFIT                                             *
  3595*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3596*----------------------------------------------------------------*
  3597*  PASSED TO ELRFND                                              *
  3598*  ----------------                                              *
  3599*  CERT ISSUE DATE                                               *
  3600*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  68
* EL050.cbl
  3601*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3602*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3603*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3604*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3605*  STATE CODE (CLIENT DEFINED)                                   *
  3606*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3607*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3608*  DEVIATION CODE                                                *
  3609*  ISSUE AGE                                                     *
  3610*  ORIGINAL BENEFIT AMOUNT                                       *
  3611*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3612*  PROCESS TYPE (CANCEL)                                         *
  3613*  BENEFIT KIND (LIFE OR A/H)                                    *
  3614*  A.P.R.                                                        *
  3615*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3616*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3617*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3618*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3619*  COMPANY I.D. (3 CHARACTER)                                    *
  3620*  BENEFIT CODE                                                  *
  3621*  BENEFIT OVERRIDE CODE                                         *
  3622*                                                                *
  3623*  RETURNED FROM ELRFND                                          *
  3624*  --------------------                                          *
  3625*  CALCULATED REFUND                                             *
  3626*----------------------------------------------------------------*
  3627*  PASSED TO ELEARN                                              *
  3628*  ----------------                                              *
  3629*  CERT ISSUE DATE                                               *
  3630*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3631*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3632*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3633*  STATE CODE (CLIENT DEFINED)                                   *
  3634*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3635*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3636*  DEVIATION CODE                                                *
  3637*  ISSUE AGE                                                     *
  3638*  ORIGINAL BENEFIT AMOUNT                                       *
  3639*  BENEFIT KIND (LIFE OR A/H)                                    *
  3640*  A.P.R.                                                        *
  3641*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3642*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3643*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3644*  COMPANY I.D. (3 CHARACTER)                                    *
  3645*  BENEFIT CODE                                                  *
  3646*  BENEFIT OVERRIDE CODE                                         *
  3647*                                                                *
  3648*  RETURNED FROM ELEARN                                          *
  3649*  --------------------                                          *
  3650*  INDICATED  EARNINGS                                           *
  3651*----------------------------------------------------------------*
  3652*                 LENGTH = 450                                   *
  3653*                                                                *
  3654******************************************************************
  3655******************************************************************
  3656*                   C H A N G E   L O G
  3657*
  3658* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  69
* EL050.cbl
  3659*-----------------------------------------------------------------
  3660*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3661* EFFECTIVE    NUMBER
  3662*-----------------------------------------------------------------
  3663* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3664* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3665* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3666* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3667* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3668* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3669* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3670* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3671* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3672* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3673* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3674* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  3675******************************************************************
  3676
  3677 01  CALCULATION-PASS-AREA.
  3678     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3679                                     COMP.
  3680
  3681     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3682       88  NO-CP-ERROR                             VALUE ZERO.
  3683       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3684                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  3685       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3686       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3687       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3688       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3689       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3690       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3691       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3692       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3693       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3694       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3695       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3696       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3697       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3698       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3699       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3700       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3701       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3702       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  3703
  3704     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3705       88  NO-CP-ERROR-2                           VALUE ZERO.
  3706***********************  INPUT AREAS ****************************
  3707
  3708     12  CP-CALCULATION-AREA.
  3709         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3710         16  CP-CERT-EFF-DT        PIC XX.
  3711         16  CP-VALUATION-DT       PIC XX.
  3712         16  CP-PAID-THRU-DT       PIC XX.
  3713         16  CP-BENEFIT-TYPE       PIC X.
  3714           88  CP-AH                               VALUE 'A' 'D'
  3715                                                   'I' 'U'.
  3716           88  CP-REDUCING-LIFE                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  70
* EL050.cbl
  3717           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3718         16  CP-INCURRED-DT        PIC XX.
  3719         16  CP-REPORTED-DT        PIC XX.
  3720         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3721         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3722         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-CDT-METHOD         PIC X.
  3727           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3728           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3729           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3730         16  CP-CLAIM-TYPE         PIC X.
  3731           88  CP-AH-CLAIM                         VALUE 'A'.
  3732           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3733         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3734                                     COMP-3.
  3735         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3742                                     COMP-3.
  3743         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-REM-TERM-METHOD    PIC X.
  3748           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3749           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3750           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3751           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3752           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3753           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3754           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3755         16  CP-EARNING-METHOD     PIC X.
  3756           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3757           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3758           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3759           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3760           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3761           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3762           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3763           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3764           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3765           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3766           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3767           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3768           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3769           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3770         16  CP-PROCESS-TYPE       PIC X.
  3771           88  CP-CLAIM                            VALUE '1'.
  3772           88  CP-CANCEL                           VALUE '2'.
  3773           88  CP-ISSUE                            VALUE '3'.
  3774         16  CP-SPECIAL-CALC-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  71
* EL050.cbl
  3775           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3776           88  CP-1-MTH-INTEREST               VALUE ' '.
  3777           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3778           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3779           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3780           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3781           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3782           88  CP-FARM-PLAN                    VALUE 'F'.
  3783           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3784           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3785           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3786           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3787           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3788           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3789           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3790           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3791           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3792           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3793                                                     'W' 'X'.
  3794           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3795           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3796           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3797           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3798           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3799           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3800           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3801           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3802           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3803           88  CP-CSL-METH-1                   VALUE '5'.
  3804           88  CP-CSL-METH-2                   VALUE '6'.
  3805           88  CP-CSL-METH-3                   VALUE '7'.
  3806           88  CP-CSL-METH-4                   VALUE '8'.
  3807
  3808         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3809                                     COMP-3.
  3810         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3811         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3812         16  CP-STATE              PIC XX          VALUE SPACE.
  3813         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3814         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3815           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3816               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3817         16  CP-R78-OPTION         PIC X.
  3818           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3819           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3820
  3821         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3822         16  CP-IBNR-RESERVE-SW    PIC X.
  3823         16  CP-CLAIM-STATUS       PIC X.
  3824         16  CP-RATE-FILE          PIC X.
  3825         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3826                                     COMP-3.
  3827
  3828         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3829         16  CP-AH-OVERRIDE-CODE   PIC X.
  3830
  3831         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3832                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  72
* EL050.cbl
  3833         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3834                                   PIC S9(5)V99 COMP-3.
  3835         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3836                                     COMP-3.
  3837         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3838                                     COMP-3.
  3839         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3840                                     COMP-3.
  3841         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3842                                  PIC S9(7)V99 COMP-3.
  3843
  3844         16  CP-PAID-FROM-DATE     PIC X(02).
  3845         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3846         16  CP-EXT-DAYS-CALC      PIC X.
  3847           88  CP-EXT-NO-CHG                   VALUE ' '.
  3848           88  CP-EXT-CHG-LF                   VALUE '1'.
  3849           88  CP-EXT-CHG-AH                   VALUE '2'.
  3850           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3851         16  CP-DOMICILE-STATE     PIC XX.
  3852         16  CP-CARRIER            PIC X.
  3853         16  CP-REIN-FLAG          PIC X.
  3854         16  CP-REM-TRM-CALC-OPTION PIC X.
  3855           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3856                      '2' '3' '4' '5'.
  3857           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3858           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3859           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3860           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3861           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3862           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3863           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3864           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3865         16  CP-SIG-SWITCH         PIC X.
  3866         16  CP-RATING-METHOD      PIC X.
  3867           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3868           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3869           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3870           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3871           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3872           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3873           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3874           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3875           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3876         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3877                                     COMP-3.
  3878         16  CP-BEN-CATEGORY       PIC X.
  3879         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3880         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3881                                   PIC S99V9(5) COMP-3.
  3882         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3883         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3884                                   PIC S99V9(5) COMP-3.
  3885         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3886         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3887         16  CP-EXPIRE-DT          PIC XX.
  3888         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3889         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3890         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  73
* EL050.cbl
  3891         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3892         16  CP-DDF-SPEC-CALC      PIC X.
  3893             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3894             88  CP-CALC-CLP              VALUE 'C'.
  3895         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3896         16  CP-CANCEL-REASON      PIC X.
  3897         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3898         16  CP-PMT-MODE           PIC X.
  3899         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3900         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3901         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3902         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3903         16  FILLER                PIC X.
  3904
  3905***************    OUTPUT FROM ELRESV   ************************
  3906
  3907         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3908
  3909         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3912                                     COMP-3.
  3913         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3914                                     COMP-3.
  3915         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3916                                     COMP-3.
  3917         16  FILLER                PIC X(09).
  3918***************    OUTPUT FROM ELRTRM   *************************
  3919
  3920         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3923                                     COMP-3.
  3924         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3925                                     COMP-3.
  3926         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3927                                     COMP-3.
  3928         16  FILLER                PIC X(12).
  3929
  3930***************    OUTPUT FROM ELRAMT   *************************
  3931
  3932         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3933                                     COMP-3.
  3934         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3935                                     COMP-3.
  3936         16  FILLER                PIC X(12).
  3937
  3938***************    OUTPUT FROM ELRATE   *************************
  3939
  3940         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3943                                     COMP-3.
  3944         16  CP-MORTALITY-CODE     PIC X(4).
  3945         16  CP-RATE-EDIT-FLAG     PIC X.
  3946             88  CP-RATES-NEED-APR                  VALUE '1'.
  3947         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3948                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  74
* EL050.cbl
  3949         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3950         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3951         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3952                                   PIC S9(7)V99 COMP-3.
  3953         16  FILLER                PIC X(07).
  3954
  3955***************    OUTPUT FROM ELRFND   *************************
  3956
  3957         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3958                                     COMP-3.
  3959         16  CP-REFUND-TYPE-USED   PIC X.
  3960           88  CP-R-AS-R78                         VALUE '1'.
  3961           88  CP-R-AS-PRORATA                     VALUE '2'.
  3962           88  CP-R-AS-CALIF                       VALUE '3'.
  3963           88  CP-R-AS-TEXAS                       VALUE '4'.
  3964           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3965           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3966           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3967           88  CP-R-AS-MEAN                        VALUE '8'.
  3968           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3969           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3970           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3971           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3972           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3973           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3974         16  FILLER                PIC X(12).
  3975
  3976***************    OUTPUT FROM ELEARN   *************************
  3977
  3978         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3979                                     COMP-3.
  3980         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3981                                     COMP-3.
  3982         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3983                                     COMP-3.
  3984         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3985                                     COMP-3.
  3986         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3987                                     COMP-3.
  3988         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3989                                     COMP-3.
  3990         16  CP-EARNING-TYPE-USED  PIC X.
  3991           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3992           88  CP-E-AS-R78                         VALUE '1'.
  3993           88  CP-E-AS-PRORATA                     VALUE '2'.
  3994           88  CP-E-AS-TEXAS                       VALUE '4'.
  3995           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3996           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3997           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3998           88  CP-E-AS-MEAN                        VALUE '8'.
  3999           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4000         16  FILLER                PIC X(12).
  4001
  4002***************    OUTPUT FROM ELPMNT   *************************
  4003
  4004         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4005                                     COMP-3.
  4006         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  75
* EL050.cbl
  4007                                     COMP-3.
  4008         16  FILLER                PIC X(12).
  4009
  4010***************   MISC WORK AREAS    *****************************
  4011         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4012                                     COMP-3.
  4013         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4014                                     COMP-3.
  4015         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4016                                     COMP-3.
  4017         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4018                                     COMP-3.
  4019         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4020                                     COMP-3.
  4021         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4022                                     COMP-3.
  4023         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4024             88  OPEN-RATE-FILE                   VALUE 'O'.
  4025             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4026             88  IO-ERROR                         VALUE 'E'.
  4027
  4028         16  CP-FIRST-PAY-DATE     PIC XX.
  4029
  4030         16  CP-JOINT-INDICATOR    PIC X.
  4031
  4032         16  CP-RESERVE-REMAINING-TERM
  4033                                   PIC S9(4)V9    VALUE ZERO
  4034                                     COMP-3.
  4035
  4036         16  CP-INSURED-BIRTH-DT   PIC XX.
  4037
  4038         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4039                                     COMP-3.
  4040
  4041         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4042                                     COMP-3.
  4043
  4044         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4045                                     COMP-3.
  4046
  4047         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4048                                     COMP-3.
  4049
  4050         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4051                                     COMP-3.
  4052
  4053         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4054                                     COMP-3.
  4055
  4056         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4057                                     COMP-3.
  4058
  4059         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4060             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4061
  4062         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4063                                     COMP-3.
  4064         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  76
* EL050.cbl
  4065                                     COMP-3.
  4066         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4067         16  cp-extra-periods      pic 9 value zeros.
  4068         16  cp-net-only-state     pic x value spaces.
  4069         16  FILLER                PIC X(13).
  4070******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  77
* EL050.cbl
  4072******************************************************************
  4073*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4074*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4075*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4076*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4077*** MODIFICATION.                                              ***
  4078*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4079*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4080******************************************************************
  4081*    COPY ERCPNDB.
  4082******************************************************************
  4083*                                                                *
  4084*                                                                *
  4085*                            ERCPNDB.                            *
  4086*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4087*                            VMOD=2.025                          *
  4088*                                                                *
  4089*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4090*                                                                *
  4091******************************************************************
  4092*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4093*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4094******************************************************************
  4095*                                                                *
  4096*                                                                *
  4097*   FILE TYPE = VSAM,KSDS                                        *
  4098*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4099*                                                                *
  4100*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4101*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4102*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4103*                                                 RKP=13,LEN=36  *
  4104*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4105*                                      AND CHG-SEQ.)             *
  4106*                                                RKP=49,LEN=11   *
  4107*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4108*                                      AND CHG-SEQ.)             *
  4109*                                                RKP=60,LEN=15   *
  4110*                                                                *
  4111*   LOG = NO                                                     *
  4112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4113******************************************************************
  4114******************************************************************
  4115*                   C H A N G E   L O G
  4116*
  4117* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4118*-----------------------------------------------------------------
  4119*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4120* EFFECTIVE    NUMBER
  4121*-----------------------------------------------------------------
  4122* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4123* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4124* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4125* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4126* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4127* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4128* 032306                   PEMA  ADD BOW LOAN NUMBER
  4129* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  78
* EL050.cbl
  4130* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4131* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4132* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4133* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4134* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4135* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4136* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4137* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4138* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4139* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4140* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4141* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  4142******************************************************************
  4143
  4144 01  PENDING-BUSINESS.
  4145     12  PB-RECORD-ID                     PIC XX.
  4146         88  VALID-PB-ID                        VALUE 'PB'.
  4147
  4148     12  PB-CONTROL-PRIMARY.
  4149         16  PB-COMPANY-CD                PIC X.
  4150         16  PB-ENTRY-BATCH               PIC X(6).
  4151         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4152         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4153
  4154     12  PB-CONTROL-BY-ACCOUNT.
  4155         16  PB-COMPANY-CD-A1             PIC X.
  4156         16  PB-CARRIER                   PIC X.
  4157         16  PB-GROUPING.
  4158             20  PB-GROUPING-PREFIX       PIC XXX.
  4159             20  PB-GROUPING-PRIME        PIC XXX.
  4160         16  PB-STATE                     PIC XX.
  4161         16  PB-ACCOUNT.
  4162             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4163             20  PB-ACCOUNT-PRIME         PIC X(6).
  4164         16  PB-CERT-EFF-DT               PIC XX.
  4165         16  PB-CERT-NO.
  4166             20  PB-CERT-PRIME            PIC X(10).
  4167             20  PB-CERT-SFX              PIC X.
  4168         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4169
  4170         16  PB-RECORD-TYPE               PIC X.
  4171             88  PB-MAILING-DATA                VALUE '0'.
  4172             88  PB-ISSUE                       VALUE '1'.
  4173             88  PB-CANCELLATION                VALUE '2'.
  4174             88  PB-BATCH-TRAILER               VALUE '9'.
  4175
  4176     12  PB-CONTROL-BY-ORIG-BATCH.
  4177         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4178         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4179         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4180         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4181
  4182     12  PB-CONTROL-BY-CSR.
  4183         16  PB-CSR-COMPANY-CD            PIC X.
  4184         16  PB-CSR-ID                    PIC X(4).
  4185         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4186         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4187         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  79
* EL050.cbl
  4188******************************************************************
  4189*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4190******************************************************************
  4191
  4192     12  PB-LAST-MAINT-DT                 PIC XX.
  4193     12  PB-LAST-MAINT-BY                 PIC X(4).
  4194     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4195
  4196     12  PB-RECORD-BODY                   PIC X(375).
  4197
  4198     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4199         16  PB-CERT-ORIGIN               PIC X.
  4200             88  CLASIC-CREATED-CERT         VALUE '1'.
  4201         16  PB-I-NAME.
  4202             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4203             20  PB-I-INSURED-FIRST-NAME.
  4204                 24  PB-I-INSURED-1ST-INIT PIC X.
  4205                 24  FILLER                PIC X(9).
  4206             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4207         16  PB-I-AGE                     PIC S99   COMP-3.
  4208         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4209         16  PB-I-BIRTHDAY                PIC XX.
  4210         16  PB-I-INSURED-SEX             PIC X.
  4211             88  PB-SEX-MALE     VALUE 'M'.
  4212             88  PB-SEX-FEMALE   VALUE 'F'.
  4213
  4214         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4215         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4216         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4217         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4218         16  PB-I-SKIP-CODE               PIC X.
  4219             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4220             88  PB-SKIP-JULY              VALUE '1'.
  4221             88  PB-SKIP-AUGUST            VALUE '2'.
  4222             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4223             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4224             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4225             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4226             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4227             88  PB-SKIP-JUNE              VALUE '8'.
  4228             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4229             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4230             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4231         16  PB-I-TERM-TYPE               PIC X.
  4232             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4233             88  PB-PAID-WEEKLY            VALUE 'W'.
  4234             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4235             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4236             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4237         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4238         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4239         16  PB-I-DATA-ENTRY-SW           PIC X.
  4240             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4241             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4242             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4243             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4244         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4245         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  80
* EL050.cbl
  4246*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4247         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4248         16  PB-I-LETTER-REQD             PIC X.
  4249
  4250         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4251             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4252             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4253                                                   '90' THRU '99'.
  4254         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4255                                          PIC XX.
  4256         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4257         16  PB-I-AMOUNT-FINANCED REDEFINES
  4258                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4259         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4260         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4261                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4262         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4263         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4264         16  PB-I-CLP-AMOUNT REDEFINES
  4265                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4266         16  PB-I-LF-CALC-FLAG            PIC X.
  4267             88 PB-COMP-LF-PREM               VALUE '?'.
  4268         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4269         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4270         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4271         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4272         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4273         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4274         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4275         16  PB-I-LF-ABBR                 PIC XXX.
  4276         16  PB-I-LF-INPUT-CD             PIC XX.
  4277
  4278         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4279             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4280             88  PB-INVALID-AH               VALUE '  ' '00'
  4281                                                   '90' THRU '99'.
  4282         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4283         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4284         16  PB-I-AH-CALC-FLAG            PIC X.
  4285             88 PB-COMP-AH-PREM                  VALUE '?'.
  4286         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4287         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4288         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4289         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4290         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4291         16  PB-I-AH-ABBR                 PIC XXX.
  4292         16  PB-I-AH-INPUT-CD             PIC XXX.
  4293
  4294         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4295         16  PB-I-REIN-TABLE              PIC XXX.
  4296         16  PB-I-BUSINESS-TYPE           PIC 99.
  4297         16  PB-I-INDV-GRP-CD             PIC X.
  4298         16  PB-I-MORT-CODE.
  4299             20  PB-I-TABLE               PIC X.
  4300             20  PB-I-INTEREST            PIC XX.
  4301             20  PB-I-MORT-TYP            PIC X.
  4302         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4303         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  81
* EL050.cbl
  4304         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4305         16  PB-I-INDV-GRP-OVRD           PIC X.
  4306         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4307         16  PB-I-SIG-SW                  PIC X.
  4308             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4309         16  PB-I-RATE-CLASS              PIC XX.
  4310         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4311         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4312         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4313         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4314         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4315         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4316         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4317         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4318         16  PB-I-OB-FLAG                 PIC X.
  4319             88  PB-I-OB                      VALUE 'B'.
  4320             88  PB-I-SUMMARY                 VALUE 'Z'.
  4321         16  PB-I-ENTRY-STATUS            PIC X.
  4322             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4323                                              'M' '5' '9' '2'.
  4324             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4325             88  PB-I-POLICY-PENDING          VALUE '2'.
  4326             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4327             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4328             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4329             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4330             88  PB-I-REIN-ONLY               VALUE '9'.
  4331             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4332             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4333             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4334             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4335         16  PB-I-INT-CODE                PIC X.
  4336             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4337             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4338         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4339         16  PB-I-SOC-SEC-NO              PIC X(11).
  4340         16  PB-I-MEMBER-NO               PIC X(12).
  4341         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4342*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4343         16  PB-I-OLD-LOF                 PIC XXX.
  4344         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4345         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4346         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4347         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4348         16  PB-I-LIFE-INDICATOR          PIC X.
  4349             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4350         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4351         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4352                                          PIC S9(5)V99    COMP-3.
  4353         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4354             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4355             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4356         16  PB-I-1ST-PMT-DT              PIC XX.
  4357         16  PB-I-JOINT-INSURED.
  4358             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4359             20 PB-I-JOINT-FIRST-NAME.
  4360                24  PB-I-JOINT-FIRST-INIT PIC X.
  4361                24  FILLER                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  82
* EL050.cbl
  4362             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4363*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4364         16  PB-I-BENEFICIARY-NAME.
  4365             20  PB-I-BANK-NUMBER         PIC X(10).
  4366             20  FILLER                   PIC X(15).
  4367         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4368         16  PB-I-REFERENCE               PIC X(12).
  4369         16  FILLER REDEFINES PB-I-REFERENCE.
  4370             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4371             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4372             20  PB-I-CLP-STATE           PIC XX.
  4373         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4374             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4375             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4376             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4377         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4378         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4379         16  PB-I-RESIDENT-STATE          PIC XX.
  4380         16  PB-I-RATE-CODE               PIC X(4).
  4381         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4382         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4383         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4384         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4385         16  PB-I-BANK-NOCHRGB            PIC 99.
  4386         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4387         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4388
  4389     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4390         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4391             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4392         16  PB-C-CANCEL-ORIGIN           PIC X.
  4393             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4394         16  PB-C-LF-CANCEL-DT            PIC XX.
  4395         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4396         16  PB-C-LF-CALC-REQ             PIC X.
  4397             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4398         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4399         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4400         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4401             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4402         16  PB-C-AH-CANCEL-DT            PIC XX.
  4403         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4404         16  PB-C-AH-CALC-REQ             PIC X.
  4405             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4406         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4407         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4408         16  PB-C-LAST-NAME               PIC X(15).
  4409         16  PB-C-REFUND-SW               PIC X.
  4410             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4411             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4412         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4413         16  PB-C-PAYEE-CODE              PIC X(6).
  4414         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4415         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4416         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4417         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4418         16  PB-C-REFERENCE               PIC X(12).
  4419         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  83
* EL050.cbl
  4420         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4421         16  PB-C-POST-CARD-IND           PIC X.
  4422         16  PB-C-CANCEL-REASON           PIC X.
  4423         16  PB-C-REF-INTERFACE-SW        PIC X.
  4424         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4425         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4426         16  FILLER                       PIC X(01).
  4427*        16  FILLER                       PIC X(18).
  4428         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4429*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4430         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4431         16  PB-CANCELED-CERT-DATA.
  4432             20  PB-CI-INSURED-NAME.
  4433                 24  PB-CI-LAST-NAME      PIC X(15).
  4434                 24  PB-CI-INITIALS       PIC XX.
  4435             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4436             20  PB-CI-INSURED-SEX        PIC X.
  4437             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4438             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4439             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4440             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4441             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4442             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4443             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4444             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4445             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4446             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4447             20  PB-CI-RATE-CLASS         PIC XX.
  4448             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4449             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4450             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4451             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4452             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4453             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4454             20  PB-CI-LF-ABBR            PIC X(3).
  4455             20  PB-CI-AH-ABBR            PIC X(3).
  4456             20  PB-CI-OB-FLAG            PIC X.
  4457                 88  PB-CI-OB                VALUE 'B'.
  4458             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4459                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4460                                           'M' '4' '5' '9' '2'.
  4461                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4462                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4463                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4464                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4465                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4466                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4467                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4468                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4469                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4470                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4471                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4472                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4473                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4474             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4475                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4476                                           'M' '4' '5' '9' '2'.
  4477                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  84
* EL050.cbl
  4478                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4479                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4480                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4481                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4482                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4483                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4484                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4485                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4486                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4487                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4488                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4489                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4490             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4491             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4492             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4493             20  PB-CI-MEMBER-NO          PIC X(12).
  4494             20  PB-CI-INT-CODE           PIC X.
  4495                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4496                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4497             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4498             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4499             20  PB-CI-COMP-EXCP-SW       PIC X.
  4500                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4501                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4502             20  PB-CI-ENTRY-STATUS       PIC X.
  4503             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4504             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4505             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4506             20  PB-CI-DEATH-DT           PIC XX.
  4507             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4508             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4509             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4510             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4511             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4512             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4513             20  PB-CI-ENTRY-DT              PIC XX.
  4514             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4515             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4516             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4517             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4518             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4519             20  PB-CI-OLD-LOF               PIC XXX.
  4520*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4521             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4522             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4523             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4524             20  PB-CI-INDV-GRP-CD           PIC X.
  4525             20  PB-CI-BENEFICIARY-NAME.
  4526                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4527                 24  FILLER                  PIC X(15).
  4528             20  PB-CI-NOTE-SW               PIC X.
  4529             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4530             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4531             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4532             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4533             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4534             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4535             20  PB-CI-FIRST-NAME            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  85
* EL050.cbl
  4536             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4537
  4538         16  FILLER                       PIC X(13).
  4539*032306  16  FILLER                       PIC X(27).
  4540*        16  FILLER                       PIC X(46).
  4541
  4542     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4543         16  FILLER                       PIC X(10).
  4544         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4545         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4546         16  PB-M-INSURED-MID-INIT        PIC X.
  4547         16  PB-M-INSURED-AGE             PIC 99.
  4548         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4549         16  PB-M-INSURED-SEX             PIC X.
  4550         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4551         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4552         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4553         16  PB-M-INSURED-CITY-STATE.
  4554             20  PB-M-INSURED-CITY        PIC X(28).
  4555             20  PB-M-INSURED-STATE       PIC XX.
  4556         16  PB-M-INSURED-ZIP-CODE.
  4557             20  PB-M-INSURED-ZIP-PRIME.
  4558                 24  PB-M-INSURED-ZIP-1   PIC X.
  4559                     88  PB-M-CANADIAN-POST-CODE
  4560                                             VALUE 'A' THRU 'Z'.
  4561                 24  FILLER               PIC X(4).
  4562             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4563         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4564                                        PB-M-INSURED-ZIP-CODE.
  4565             20  PM-M-INS-CAN-POST1       PIC XXX.
  4566             20  PM-M-INS-CAN-POST2       PIC XXX.
  4567             20  FILLER                   PIC XXX.
  4568         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4569         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4570         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4571         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4572         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4573         16  PB-M-CRED-BENE-CITYST.
  4574             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4575             20  PB-M-CRED-BENE-STATE     PIC XX.
  4576         16  FILLER                       PIC X(92).
  4577
  4578     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4579         16  FILLER                       PIC X(10).
  4580         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4581         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4582         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4583         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4584         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4585         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4586         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4587         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4588         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4589         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4590         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4591         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4592         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4593         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  86
* EL050.cbl
  4594         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4595         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4596         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4597         16  PB-ACCOUNT-NAME              PIC X(30).
  4598         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4599         16  PB-REFERENCE                 PIC X(12).
  4600         16  PB-B-RECEIVED-DT             PIC XX.
  4601         16  FILLER                       PIC X(234).
  4602
  4603     12  PB-RECORD-STATUS.
  4604         16  PB-CREDIT-SELECT-DT          PIC XX.
  4605         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4606         16  PB-BILLED-DT                 PIC XX.
  4607         16  PB-BILLING-STATUS            PIC X.
  4608             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4609             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4610             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4611         16  PB-RECORD-BILL               PIC X.
  4612             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4613             88  PB-RECORD-RETURNED           VALUE 'R'.
  4614             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4615             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4616             88  PB-OVERRIDE-AH               VALUE 'A'.
  4617             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4618         16  PB-BATCH-ENTRY               PIC X.
  4619             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4620             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4621             88  PB-REISSUED-CERT             VALUE 'E'.
  4622             88  PB-CASH-CERT                 VALUE 'C'.
  4623             88  PB-MONTHLY-CERT              VALUE 'M'.
  4624             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4625             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4626             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4627         16  PB-FORCE-CODE                PIC X.
  4628             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4629             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4630             88  PB-CANCEL-FORCE              VALUE '8'.
  4631             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4632             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4633             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4634             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4635             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4636             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4637             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4638             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4639         16  PB-FATAL-FLAG                PIC X.
  4640             88  PB-FATAL-ERRORS              VALUE 'X'.
  4641         16  PB-FORCE-ER-CD               PIC X.
  4642             88  PB-FORCE-ERRORS              VALUE 'F'.
  4643             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4644         16  PB-WARN-ER-CD                PIC X.
  4645             88  PB-WARNING-ERRORS            VALUE 'W'.
  4646         16  FILLER                       PIC X.
  4647         16  PB-OUT-BAL-CD                PIC X.
  4648             88  PB-OUT-OF-BAL                VALUE 'O'.
  4649         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4650         16  PB-AH-OVERRIDE-L1            PIC X.
  4651         16  PB-INPUT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  87
* EL050.cbl
  4652         16  PB-INPUT-BY                  PIC X(4).
  4653         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4654         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4655         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4656         16  PB-LF-EARNING-METHOD         PIC X.
  4657         16  PB-AH-EARNING-METHOD         PIC X.
  4658         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4659         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4660         16  PB-REIN-CD                   PIC XXX.
  4661         16  PB-LF-REFUND-TYPE            PIC X.
  4662         16  PB-AH-REFUND-TYPE            PIC X.
  4663         16  PB-ACCT-EFF-DT               PIC XX.
  4664         16  PB-ACCT-EXP-DT               PIC XX.
  4665         16  PB-COMPANY-ID                PIC X(3).
  4666         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4667         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4668         16  PB-SV-CARRIER                PIC X.
  4669         16  PB-SV-GROUPING               PIC X(6).
  4670         16  PB-SV-STATE                  PIC XX.
  4671         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4672         16  PB-GA-BILLING-INFO.
  4673             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4674                                          PIC XX.
  4675         16  PB-SV-REMIT-TO  REDEFINES
  4676             PB-GA-BILLING-INFO           PIC X(10).
  4677         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4678         16  PB-I-LOAN-OFFICER            PIC X(5).
  4679         16  PB-I-VIN                     PIC X(17).
  4680
  4681         16  FILLER                       PIC X(04).
  4682         16  IMNET-BYPASS-SW              PIC X.
  4683
  4684******************************************************************
  4685*                COMMON EDIT ERRORS                              *
  4686******************************************************************
  4687
  4688     12  PB-COMMON-ERRORS.
  4689         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4690                                           PIC S9(4)     COMP.
  4691
  4692******************************************************************
  4693
  4694* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4695*    COPY ELC50W1.
  4696******************************************************************
  4697*                                                                *
  4698*                                                                *
  4699*                             ELC50W1                            *
  4700*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4701*                            VMOD=2.004                          *
  4702*                                                                *
  4703*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4704*                                                                *
  4705*                                                                *
  4706******************************************************************
  4707
  4708     12  WK-WORK-AREA.
  4709         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  88
* EL050.cbl
  4710         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4711         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4712         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4713         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4714         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4715         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4716         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4717         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4718         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4719         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4720         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4721         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4722         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4723         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4724         16  WK-CREDIT-EDIT-CONTROLS.
  4725             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4726             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4727             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4728             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4729             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4730             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4731         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4732         16  WK-SAVE-REIN-DATA.
  4733             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4734             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4735             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4736         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4737             88  ENTRY-FROM-EL6311       VALUE '6'.
  4738         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4739         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4740     12  WK-RECORD-ADDRESSES.
  4741         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4742         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4743         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4744         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4745         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4746         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4747         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4748         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4749     12  WK-OVER-SHORT-AREA.
  4750         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4751         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4752         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4753             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4754         16  FILLER                   PIC X(5) VALUE SPACES.
  4755
  4756*    COPY ELCEDITC.
  4757******************************************************************
  4758*                                                                *
  4759*                                                                *
  4760*                            ELCEDITC                            *
  4761*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4762*                            VMOD=2.012                          *
  4763*                                                                *
  4764*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4765*                     EL6313, EL050 AND EL517.                   *
  4766*                                                                *
  4767******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  89
* EL050.cbl
  4768******************************************************************
  4769*                   C H A N G E   L O G
  4770*
  4771* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4772*-----------------------------------------------------------------
  4773*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4774* EFFECTIVE    NUMBER
  4775*-----------------------------------------------------------------
  4776* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4777******************************************************************
  4778
  4779     12  EDIT-CRITERIA-DATA.
  4780         16  EC-CO-MONTH-END-DT       PIC XX.
  4781         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4782         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4783         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4784         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4785         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4786         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4787         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4788         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4789         16  EC-CO-REM-TERM-CALC      PIC X.
  4790               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4791               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4792               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4793               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4794
  4795         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4796               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4797               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4798               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4799               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4800               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4801               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4802               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4803               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4804               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4805               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4806
  4807         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4808               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4809               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4810               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4811               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4812               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4813               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4814               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4815               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4816
  4817         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4818                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4819                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4820
  4821         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4822                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4823                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4824                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4825                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  90
* EL050.cbl
  4826                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4827                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4828                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4829                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4830
  4831         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4832               88  EC-BR-REDUCING                   VALUE 'R'.
  4833               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4834
  4835         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4836         16  EC-BR-LF-DESC             PIC X(10).
  4837         16  EC-BR-AH-DESC             PIC X(10).
  4838         16  EC-BR-LF-COMMENT          PIC X(10).
  4839         16  EC-BR-AH-COMMENT          PIC X(10).
  4840
  4841         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4842               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4843               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4844               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4845               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4846
  4847         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4848               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4849               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4850               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4851               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4852
  4853         16  EC-BR-LF-REFUND-CALC      PIC X.
  4854                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4855                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4856                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4857                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4858                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4859                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4860                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4861
  4862         16  EC-BR-AH-REFUND-CALC      PIC X.
  4863                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4864                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4865                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4866                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4867                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4868                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4869                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4870                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4871
  4872         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4873                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4874                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4875                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4876
  4877         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4878                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4879                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4880                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4881
  4882         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4883         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  91
* EL050.cbl
  4884         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4885         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4886
  4887         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4888         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4889                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4890                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4891                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4892                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4893
  4894         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4895               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4896               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4897               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4898               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4899               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4900
  4901         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4902               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4903               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4904               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4905               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4906               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4907
  4908         16  EC-ST-LF-REFUND-CALC      PIC X.
  4909                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4910                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4911                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4912                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4913                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4914                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4915                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4916                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4917
  4918         16  EC-ST-AH-REFUND-CALC      PIC X.
  4919                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4920                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4921                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4922                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4923                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4924                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4925                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4926                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4927
  4928         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4929         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4930         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4931         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4932         16  EC-AM-EXPIRATION-DT       PIC XX.
  4933         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4934         16  EC-AM-CLASS-CD            PIC XX.
  4935         16  EC-AM-LF-DEVIATION        PIC XXX.
  4936         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4937         16  EC-AM-AH-DEVIATION        PIC XXX.
  4938         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4939         16  EC-AM-PHONE-NO            PIC X(10).
  4940
  4941         16  EC-AM-LF-REFUND-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  92
* EL050.cbl
  4942                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4943                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4944                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4945                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4946                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4947                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4948                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4949
  4950         16  EC-AM-AH-REFUND-CALC      PIC X.
  4951                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4952                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4953                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4954                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4955                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4956                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4957                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4958
  4959         16  EC-AM-BEN-I-G-CD          PIC X.
  4960                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4961                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4962                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4963
  4964         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4965         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4966         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4967         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4968         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4969         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4970         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4971         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4972         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4973
  4974         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4975         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4976         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4977         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4978         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4979         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4980         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4981         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4982         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4983         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4984         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4985         16  EC-RT-LF-NSP-ST           PIC XX.
  4986         16  EC-RT-AH-NSP-ST           PIC XX.
  4987         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4988         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4989
  4990         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4991             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4992                                             'M' '5' '9' '2'.
  4993             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4994             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4995             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4996             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4997             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4998             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4999             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  93
* EL050.cbl
  5000             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  5001             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  5002             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  5003
  5004         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  5005             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  5006                                             'M' '5' '9' '2'.
  5007             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  5008             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  5009             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  5010             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  5011             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  5012             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  5013             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  5014             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  5015             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  5016             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  5017
  5018         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5019         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5020         16  EC-CM-LF-CANCEL-DT        PIC XX.
  5021         16  EC-CM-AH-CANCEL-DT        PIC XX.
  5022         16  EC-CM-DEATH-DT            PIC XX.
  5023
  5024*DMD CUSTOM CODING FIELDS BELOW
  5025*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  5026         16  EC-BR-DMD-RATING-SW       PIC X.
  5027                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  5028                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  5029                 88  NO-DMD-RATING               VALUE 'N'.
  5030
  5031         16  EC-NEW-CERT               PIC X(11).
  5032         16  EC-NEW-STATE              PIC XX.
  5033         16  FILLER                    PIC X.
  5034*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5035         16  OVER-SHORT-EDIT-FIELDS.
  5036             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5037             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5038             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5039             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5040             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5041             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5042             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5043             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5044             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5045         16  FILLER                    PIC X(71).
  5046******************************************************************
  5047
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  94
* EL050.cbl
  5049*    COPY ELCDIFRD.
  5050******************************************************************
  5051*                                                                *
  5052*                                                                *
  5053*                            ELCDIFRD.                           *
  5054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5055*                            VMOD=2.004                          *
  5056*                                                                *
  5057*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5058*                                                                *
  5059******************************************************************
  5060*
  5061  01  WS-DIFFERENCE-CALCULATION.
  5062        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5063        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5064        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5065        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5066        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5067        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5068        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5069        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5070        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5071        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5072        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5073
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  95
* EL050.cbl
  5075****************************************************************
  5076*
  5077* Copyright (c) 2007-2013 Dell Inc.
  5078* All rights reserved.
  5079*
  5080****************************************************************
  5081 01  DFHEIV.
  5082   02  DFHEIV0               PIC X(35).
  5083   02  DFHEIV1               PIC X(08).
  5084   02  DFHEIV2               PIC X(08).
  5085   02  DFHEIV3               PIC X(08).
  5086   02  DFHEIV4               PIC X(06).
  5087   02  DFHEIV5               PIC X(04).
  5088   02  DFHEIV6               PIC X(04).
  5089   02  DFHEIV7               PIC X(02).
  5090   02  DFHEIV8               PIC X(02).
  5091   02  DFHEIV9               PIC X(01).
  5092   02  DFHEIV10              PIC S9(7) COMP-3.
  5093   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5094   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5095   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5096   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5097   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5098   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5099   02  DFHEIV17              PIC X(04).
  5100   02  DFHEIV18              PIC X(04).
  5101   02  DFHEIV19              PIC X(04).
  5102   02  DFHEIV20              USAGE IS POINTER.
  5103   02  DFHEIV21              USAGE IS POINTER.
  5104   02  DFHEIV22              USAGE IS POINTER.
  5105   02  DFHEIV23              USAGE IS POINTER.
  5106   02  DFHEIV24              USAGE IS POINTER.
  5107   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5108   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5109   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5110   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5111   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5112   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5113   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5114   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5115   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5116   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5117   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5118   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5119   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5120   02  FILLER                PIC X(02).
  5121   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5122   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5123   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5124   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5125   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5126   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5127   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5128 LINKAGE  SECTION.
  5129*****************************************************************
  5130*                                                               *
  5131* Copyright (c) 2007-2013 Dell Inc.                             *
  5132* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  96
* EL050.cbl
  5133*                                                               *
  5134*****************************************************************
  5135 01  dfheiblk.
  5136     02  eibtime          pic s9(7) comp-3.
  5137     02  eibdate          pic s9(7) comp-3.
  5138     02  eibtrnid         pic x(4).
  5139     02  eibtaskn         pic s9(7) comp-3.
  5140     02  eibtrmid         pic x(4).
  5141     02  dfheigdi         pic s9(4) comp.
  5142     02  eibcposn         pic s9(4) comp.
  5143     02  eibcalen         pic s9(4) comp.
  5144     02  eibaid           pic x(1).
  5145     02  eibfiller1       pic x(1).
  5146     02  eibfn            pic x(2).
  5147     02  eibfiller2       pic x(2).
  5148     02  eibrcode         pic x(6).
  5149     02  eibfiller3       pic x(2).
  5150     02  eibds            pic x(8).
  5151     02  eibreqid         pic x(8).
  5152     02  eibrsrce         pic x(8).
  5153     02  eibsync          pic x(1).
  5154     02  eibfree          pic x(1).
  5155     02  eibrecv          pic x(1).
  5156     02  eibsend          pic x(1).
  5157     02  eibatt           pic x(1).
  5158     02  eibeoc           pic x(1).
  5159     02  eibfmh           pic x(1).
  5160     02  eibcompl         pic x(1).
  5161     02  eibsig           pic x(1).
  5162     02  eibconf          pic x(1).
  5163     02  eiberr           pic x(1).
  5164     02  eibrldbk         pic x(1).
  5165     02  eiberrcd         pic x(4).
  5166     02  eibsynrb         pic x(1).
  5167     02  eibnodat         pic x(1).
  5168     02  eibfiller5       pic x(2).
  5169     02  eibresp          pic s9(8) comp.
  5170     02  eibresp2         pic s9(8) comp.
  5171     02  dfheigdj         pic s9(4) comp.
  5172     02  dfheigdk         pic s9(4) comp.
  5173
  5174 01  DFHCOMMAREA                   PIC X(1036).
  5175
  5176*01 PARMLIST .
  5177*    02  FILLER                    PIC S9(8)   COMP.
  5178*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5179*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5180*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5181*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5182*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5183*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5184*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5185
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  97
* EL050.cbl
  5187*    COPY ELCCNTL.
  5188******************************************************************
  5189*                                                                *
  5190*                                                                *
  5191*                            ELCCNTL.                            *
  5192*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5193*                            VMOD=2.059                          *
  5194*                                                                *
  5195*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5196*                                                                *
  5197*   FILE TYPE = VSAM,KSDS                                        *
  5198*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5199*                                                                *
  5200*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5201*       ALTERNATE INDEX = NONE                                   *
  5202*                                                                *
  5203*   LOG = YES                                                    *
  5204*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5205******************************************************************
  5206*                   C H A N G E   L O G
  5207*
  5208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5209*-----------------------------------------------------------------
  5210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5211* EFFECTIVE    NUMBER
  5212*-----------------------------------------------------------------
  5213* 082503                   PEMA  ADD BENEFIT GROUP
  5214* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5215* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5216* 092705    2005050300006  PEMA  ADD SPP LEASES
  5217* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5218* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5219* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5220* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5221* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5222* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5223* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5224* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5225* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5226* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5227* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5228******************************************************************
  5229*
  5230 01  CONTROL-FILE.
  5231     12  CF-RECORD-ID                       PIC XX.
  5232         88  VALID-CF-ID                        VALUE 'CF'.
  5233
  5234     12  CF-CONTROL-PRIMARY.
  5235         16  CF-COMPANY-ID                  PIC XXX.
  5236         16  CF-RECORD-TYPE                 PIC X.
  5237             88  CF-COMPANY-MASTER              VALUE '1'.
  5238             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5239             88  CF-STATE-MASTER                VALUE '3'.
  5240             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5241             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5242             88  CF-CARRIER-MASTER              VALUE '6'.
  5243             88  CF-MORTALITY-MASTER            VALUE '7'.
  5244             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  98
* EL050.cbl
  5245             88  CF-TERMINAL-MASTER             VALUE '9'.
  5246             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5247             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5248             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5249             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5250             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5251             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5252             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5253             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5254             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5255         16  CF-ACCESS-CD-GENL              PIC X(4).
  5256         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5257             20  CF-PROCESSOR               PIC X(4).
  5258         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5259             20  CF-STATE-CODE              PIC XX.
  5260             20  FILLER                     PIC XX.
  5261         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5262             20  FILLER                     PIC XX.
  5263             20  CF-HI-BEN-IN-REC           PIC XX.
  5264         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5265             20  FILLER                     PIC XXX.
  5266             20  CF-CARRIER-CNTL            PIC X.
  5267         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5268             20  FILLER                     PIC XX.
  5269             20  CF-HI-TYPE-IN-REC          PIC 99.
  5270         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5271             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5272                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5273             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5274             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5275         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5276             20  FILLER                     PIC X.
  5277             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5278         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5279             20  FILLER                     PIC XX.
  5280             20  CF-MORTGAGE-PLAN           PIC XX.
  5281         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5282
  5283     12  CF-LAST-MAINT-DT                   PIC XX.
  5284     12  CF-LAST-MAINT-BY                   PIC X(4).
  5285     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5286
  5287     12  CF-RECORD-BODY                     PIC X(728).
  5288
  5289
  5290****************************************************************
  5291*             COMPANY MASTER RECORD                            *
  5292****************************************************************
  5293
  5294     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5295         16  CF-COMPANY-ADDRESS.
  5296             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5297             20  CF-CL-IN-CARE-OF           PIC X(30).
  5298             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5299             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5300             20  CF-CL-CITY-STATE           PIC X(30).
  5301             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5302             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page  99
* EL050.cbl
  5303         16  CF-COMPANY-CD                  PIC X.
  5304         16  CF-COMPANY-PASSWORD            PIC X(8).
  5305         16  CF-SECURITY-OPTION             PIC X.
  5306             88  ALL-SECURITY                   VALUE '1'.
  5307             88  COMPANY-VERIFY                 VALUE '2'.
  5308             88  PROCESSOR-VERIFY               VALUE '3'.
  5309             88  NO-SECURITY                    VALUE '4'.
  5310             88  ALL-BUT-TERM                   VALUE '5'.
  5311         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5312             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5313         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5314             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5315         16  CF-INFORCE-LOCATION            PIC X.
  5316             88  CERTS-ARE-ONLINE               VALUE '1'.
  5317             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5318             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5319         16  CF-LOWER-CASE-LETTERS          PIC X.
  5320         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5321             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5322             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5323             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5324             88  CF-ACCNT-CNTL                  VALUE '3'.
  5325             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5326
  5327         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5328         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5329
  5330         16  CF-LGX-CREDIT-USER             PIC X.
  5331             88  CO-IS-NOT-USER                 VALUE 'N'.
  5332             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5333
  5334         16 CF-CREDIT-CALC-CODES.
  5335             20  CF-CR-REM-TERM-CALC PIC X.
  5336               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5337               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5338               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5339               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5340               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5341               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5342               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5343             20  CF-CR-R78-METHOD           PIC X.
  5344               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5345               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5346
  5347         16  CF-CLAIM-CONTROL-COUNTS.
  5348             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5349                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5350
  5351             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5352                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5353
  5354             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5355                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5356
  5357             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5358                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5359
  5360         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 100
* EL050.cbl
  5361
  5362         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5363             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5364             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5365             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5366             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5367                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5368                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5369             20  CF-CO-PREM-REJECT-SW       PIC X.
  5370                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5371                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5372             20  CF-CO-REF-REJECT-SW        PIC X.
  5373                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5374                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5375
  5376         16  CF-CO-REPORTING-DT             PIC XX.
  5377         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5378         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5379           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5380           88  CF-CO-MONTH-END                  VALUE '1'.
  5381
  5382         16  CF-LGX-CLAIM-USER              PIC X.
  5383             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5384             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5385
  5386         16  CF-CREDIT-EDIT-CONTROLS.
  5387             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5388             20  CF-MIN-AGE                 PIC 99.
  5389             20  CF-DEFAULT-AGE             PIC 99.
  5390             20  CF-MIN-TERM                PIC S999      COMP-3.
  5391             20  CF-MAX-TERM                PIC S999      COMP-3.
  5392             20  CF-DEFAULT-SEX             PIC X.
  5393             20  CF-JOINT-AGE-INPUT         PIC X.
  5394                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5395             20  CF-BIRTH-DATE-INPUT        PIC X.
  5396                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5397             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5398                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5399                 88  CF-ZERO-CARRIER            VALUE '1'.
  5400                 88  CF-ZERO-GROUPING           VALUE '2'.
  5401                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5402             20  CF-EDIT-SW                 PIC X.
  5403                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5404             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5405             20  CF-CR-PR-METHOD            PIC X.
  5406               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5407               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5408             20  FILLER                     PIC X.
  5409
  5410         16  CF-CREDIT-MISC-CONTROLS.
  5411             20  CF-REIN-TABLE-SW           PIC X.
  5412                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5413             20  CF-COMP-TABLE-SW           PIC X.
  5414                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5415             20  CF-EXPERIENCE-RETENTION-AGE
  5416                                            PIC S9        COMP-3.
  5417             20  CF-CONVERSION-DT           PIC XX.
  5418             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 101
* EL050.cbl
  5419             20  CF-RUN-FREQUENCY-SW        PIC X.
  5420                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5421                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5422
  5423             20  CF-CR-CHECK-NO-CONTROL.
  5424                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5425                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5426                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5427                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5428                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5429                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5430
  5431                 24  CF-CR-CHECK-COUNT       REDEFINES
  5432                     CF-CR-CHECK-COUNTER      PIC X(4).
  5433
  5434                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5435                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5436
  5437                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5438                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5439                 24  CF-MAIL-PROCESSING       PIC X.
  5440                     88  MAIL-PROCESSING          VALUE 'Y'.
  5441
  5442         16  CF-MISC-SYSTEM-CONTROL.
  5443             20  CF-SYSTEM-C                 PIC X.
  5444                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5445             20  CF-SYSTEM-D                 PIC X.
  5446                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5447             20  CF-SOC-SEC-NO-SW            PIC X.
  5448                 88  SOC-SEC-NO-USED             VALUE '1'.
  5449             20  CF-MEMBER-NO-SW             PIC X.
  5450                 88  MEMBER-NO-USED              VALUE '1'.
  5451             20  CF-TAX-ID-NUMBER            PIC X(11).
  5452             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5453             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5454                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5455                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5456                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5457                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5458             20  CF-SYSTEM-E                 PIC X.
  5459                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5460
  5461         16  CF-LGX-LIFE-USER               PIC X.
  5462             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5463             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5464
  5465         16  CF-CR-MONTH-END-DT             PIC XX.
  5466
  5467         16  CF-FILE-MAINT-DATES.
  5468             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5469                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5470             20  CF-LAST-BATCH       REDEFINES
  5471                 CF-LAST-BATCH-NO               PIC X(4).
  5472             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5473             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5474             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5475             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5476             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 102
* EL050.cbl
  5477             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5478             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5479             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5480             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5481             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5482
  5483         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5484         16  FILLER                         PIC X.
  5485
  5486         16  CF-ALT-MORT-CODE               PIC X(4).
  5487         16  CF-MEMBER-CAPTION              PIC X(10).
  5488
  5489         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5490             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5491             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5492             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5493             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5494             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5495
  5496         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5497
  5498         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5499         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5500         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5501         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5502
  5503         16  CF-AH-OVERRIDE-L1              PIC X.
  5504         16  CF-AH-OVERRIDE-L2              PIC XX.
  5505         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5506         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5507
  5508         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5509         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5510
  5511         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5512         16  CF-AR-LAST-EL860-DT            PIC XX.
  5513         16  CF-MP-MONTH-END-DT             PIC XX.
  5514
  5515         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5516         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5517             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5518
  5519         16  CF-AR-MONTH-END-DT             PIC XX.
  5520
  5521         16  CF-CRDTCRD-USER                PIC X.
  5522             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5523             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5524
  5525         16  CF-CC-MONTH-END-DT             PIC XX.
  5526
  5527         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5528
  5529         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5530             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5531             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5532             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5533         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5534         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 103
* EL050.cbl
  5535         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5536         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5537             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5538             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5539         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5540         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5541         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5542             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5543         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5544
  5545         16  CF-CL-ZIP-CODE.
  5546             20  CF-CL-ZIP-PRIME.
  5547                 24  CF-CL-ZIP-1ST          PIC X.
  5548                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5549                 24  FILLER                 PIC X(4).
  5550             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5551         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5552             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5553             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5554             20  FILLER                     PIC XXX.
  5555
  5556         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5557         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5558         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5559         16  CF-CO-OPTION-START-DATE        PIC XX.
  5560         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5561           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5562                                                      '3' '4'.
  5563           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5564           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5565           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5566           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5567           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5568           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5569
  5570         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5571
  5572         16  CF-PAYMENT-APPROVAL-LEVELS.
  5573             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5574             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5575             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5576             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5577             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5578             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5579
  5580         16  CF-END-USER-REPORTING-USER     PIC X.
  5581             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5582             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5583
  5584         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5585             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5586             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5587
  5588         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5589
  5590         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5591         16  FILLER                         PIC X.
  5592
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 104
* EL050.cbl
  5593         16  CF-CREDIT-ARCHIVE-CNTL.
  5594             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5595             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5596             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5597
  5598         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5599
  5600         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5601             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5602             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5603
  5604         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5605             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5606             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5607
  5608         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5609
  5610         16  CF-CO-ACH-ID-CODE              PIC  X.
  5611             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5612             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5613             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5614         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5615         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5616         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5617         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5618         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5619         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5620         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5621         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5622         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5623                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5624         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5625                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5626
  5627         16  CF-CO-OVER-SHORT.
  5628             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5629             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5630
  5631*         16  FILLER                         PIC X(102).
  5632         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5633             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5634             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5635
  5636         16  CF-AH-APPROVAL-DAYS.
  5637             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5638             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5639             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5640             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5641
  5642         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5643
  5644         16  CF-APPROV-LEV-5.
  5645             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5646             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5647             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5648
  5649         16  FILLER                         PIC X(68).
  5650****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 105
* EL050.cbl
  5651*             PROCESSOR/USER RECORD                            *
  5652****************************************************************
  5653
  5654     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5655         16  CF-PROCESSOR-NAME              PIC X(30).
  5656         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5657         16  CF-PROCESSOR-TITLE             PIC X(26).
  5658         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5659                 88  MESSAGE-YES                VALUE 'Y'.
  5660                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5661
  5662*****************************************************
  5663****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5664****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5665****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5666****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5667*****************************************************
  5668
  5669         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5670             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5671             20  CF-APPLICATION-FORCE       PIC X.
  5672             20  CF-INDIVIDUAL-APP.
  5673                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5674                     28  CF-BROWSE-APP      PIC X.
  5675                     28  CF-UPDATE-APP      PIC X.
  5676
  5677         16  CF-CURRENT-TERM-ON             PIC X(4).
  5678         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5679             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5680             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5681             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5682             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5683             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5684             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5685             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5686         16  CF-PROCESSOR-CARRIER           PIC X.
  5687             88  NO-CARRIER-SECURITY            VALUE ' '.
  5688         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5689             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5690         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5691             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5692         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5693             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5694
  5695         16  CF-PROC-SYS-ACCESS-SW.
  5696             20  CF-PROC-CREDIT-CLAIMS-SW.
  5697                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5698                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5699                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5700                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5701             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5702                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5703                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5704             20  CF-PROC-LIFE-GNRLDGR-SW.
  5705                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5706                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5707                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5708                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 106
* EL050.cbl
  5709             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5710                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5711                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5712         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5713             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5714             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5715         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5716
  5717         16  CF-APPROVAL-LEVEL                  PIC X.
  5718             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5719             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5720             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5721             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5722             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5723
  5724         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5725
  5726         16  CF-LANGUAGE-TYPE                   PIC X.
  5727             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5728             88  CF-LANG-IS-FR                      VALUE 'F'.
  5729
  5730         16  CF-CSR-IND                         PIC X.
  5731         16  FILLER                             PIC X(239).
  5732
  5733****************************************************************
  5734*             PROCESSOR/REMINDERS RECORD                       *
  5735****************************************************************
  5736
  5737     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5738         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5739             20  CF-START-REMIND-DT         PIC XX.
  5740             20  CF-END-REMIND-DT           PIC XX.
  5741             20  CF-REMINDER-TEXT           PIC X(50).
  5742         16  FILLER                         PIC X(296).
  5743
  5744
  5745****************************************************************
  5746*             STATE MASTER RECORD                              *
  5747****************************************************************
  5748
  5749     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5750         16  CF-STATE-ABBREVIATION          PIC XX.
  5751         16  CF-STATE-NAME                  PIC X(25).
  5752         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5753         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5754             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5755             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5756             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5757             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5758                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5759                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5760             20  CF-ST-PREM-REJECT-SW       PIC X.
  5761                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5762                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5763             20  CF-ST-REF-REJECT-SW        PIC X.
  5764                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5765                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5766         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 107
* EL050.cbl
  5767         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5768         16  CF-ST-REFUND-RULES.
  5769             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5770             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5771             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5772         16  CF-ST-FST-PMT-EXTENSION.
  5773             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5774             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5775                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5776                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5777                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5778                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5779         16  CF-ST-STATE-CALL.
  5780             20  CF-ST-CALL-UNEARNED        PIC X.
  5781             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5782             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5783         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5784             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5785             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5786         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5787         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5788         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5789         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5790         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5791         16  FILLER                         PIC X.
  5792         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5793             20  CF-ST-BENEFIT-CD           PIC XX.
  5794             20  CF-ST-BENEFIT-KIND         PIC X.
  5795                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5796                 88  CF-ST-AH-KIND              VALUE 'A'.
  5797             20  CF-ST-REM-TERM-CALC        PIC X.
  5798                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5799                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5800                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5801                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5802                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5803                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5804                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5805                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5806
  5807             20  CF-ST-REFUND-CALC          PIC X.
  5808                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5809                 88  ST-REFD-BY-R78             VALUE '1'.
  5810                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5811                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5812                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5813                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5814                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5815                 88  ST-REFD-UTAH               VALUE '7'.
  5816                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5817                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5818                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5819
  5820             20  CF-ST-EARNING-CALC         PIC X.
  5821                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5822                 88  ST-EARN-BY-R78             VALUE '1'.
  5823                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5824                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 108
* EL050.cbl
  5825                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5826                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5827                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5828                 88  ST-EARN-MEAN               VALUE '8'.
  5829                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5830
  5831             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5832                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5833                 88  ST-OVRD-BY-R78             VALUE '1'.
  5834                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5835                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5836                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5837                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5838                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5839                 88  ST-OVRD-MEAN               VALUE '8'.
  5840                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5841             20  cf-st-extra-periods        pic 9.
  5842*            20  FILLER                     PIC X.
  5843
  5844         16  CF-ST-COMMISSION-CAPS.
  5845             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5846             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5847             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5848             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5849         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5850                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5851                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5852                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5853
  5854         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5855
  5856         16  CF-ST-STATUTORY-INTEREST.
  5857             20  CF-ST-STAT-DATE-FROM       PIC X.
  5858                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5859                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5860             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5861             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5862             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5863             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5864             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5865
  5866         16  CF-ST-OVER-SHORT.
  5867             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5868             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5869
  5870         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5871
  5872         16  CF-ST-RT-CALC                  PIC X.
  5873
  5874         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5875         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5876         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5877         16  CF-ST-RF-LR-CALC               PIC X.
  5878         16  CF-ST-RF-LL-CALC               PIC X.
  5879         16  CF-ST-RF-LN-CALC               PIC X.
  5880         16  CF-ST-RF-AH-CALC               PIC X.
  5881         16  CF-ST-RF-CP-CALC               PIC X.
  5882*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 109
* EL050.cbl
  5883*CIDMOD         16  FILLER                         PIC X(192).
  5884         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5885             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5886         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5887         16  CF-ST-VFY-2ND-BENE             PIC X.
  5888         16  CF-ST-CAUSAL-STATE             PIC X.
  5889         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5890         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5891         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5892             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5893         16  CF-ST-NET-ONLY-STATE           PIC X.
  5894             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5895         16  cf-commission-cap-required     pic x.
  5896         16  CF-ST-GA-COMMISSION-CAPS.
  5897             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5898             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5899             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5900             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5901         16  CF-ST-TOT-COMMISSION-CAPS.
  5902             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5903             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5904             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5905             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5906         16  FILLER                         PIC X(156).
  5907
  5908****************************************************************
  5909*             BENEFIT MASTER RECORD                            *
  5910****************************************************************
  5911
  5912     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5913         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5914             20  CF-BENEFIT-CODE            PIC XX.
  5915             20  CF-BENEFIT-NUMERIC  REDEFINES
  5916                 CF-BENEFIT-CODE            PIC XX.
  5917             20  CF-BENEFIT-ALPHA           PIC XXX.
  5918             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5919             20  CF-BENEFIT-COMMENT         PIC X(10).
  5920
  5921             20  CF-LF-COVERAGE-TYPE        PIC X.
  5922                 88  CF-REDUCING                VALUE 'R'.
  5923                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5924
  5925             20  CF-SPECIAL-CALC-CD         PIC X.
  5926                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5927                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5928                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5929                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5930                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5931                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5932                 88  CF-FARM-PLAN               VALUE 'F'.
  5933                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5934                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5935                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5936                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5937                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5938                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5939                 88  CF-PRUDENTIAL              VALUE 'P'.
  5940                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 110
* EL050.cbl
  5941                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5942                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5943                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5944                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5945                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5946
  5947             20  CF-JOINT-INDICATOR         PIC X.
  5948                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5949
  5950*            20  FILLER                     PIC X(12).
  5951             20  cf-maximum-benefits        pic s999 comp-3.
  5952             20  FILLER                     PIC X(09).
  5953             20  CF-BENEFIT-CATEGORY        PIC X.
  5954             20  CF-LOAN-TYPE               PIC X(8).
  5955
  5956             20  CF-CO-REM-TERM-CALC        PIC X.
  5957                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5958                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5959                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5960                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5961                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5962
  5963             20  CF-CO-EARNINGS-CALC        PIC X.
  5964                 88  CO-EARN-BY-R78             VALUE '1'.
  5965                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5966                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5967                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5968                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5969                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5970                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5971                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5972
  5973             20  CF-CO-REFUND-CALC          PIC X.
  5974                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5975                 88  CO-REFD-BY-R78             VALUE '1'.
  5976                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5977                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5978                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5979                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5980                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5981                 88  CO-REFD-MEAN               VALUE '8'.
  5982                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5983                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5984                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5985
  5986             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5987                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5988                 88  CO-OVRD-BY-R78             VALUE '1'.
  5989                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5990                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5991                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5992                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5993                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5994                 88  CO-OVRD-MEAN               VALUE '8'.
  5995                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5996
  5997             20  CF-CO-BEN-I-G-CD           PIC X.
  5998                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 111
* EL050.cbl
  5999                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  6000                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  6001
  6002         16  FILLER                         PIC X(304).
  6003
  6004
  6005****************************************************************
  6006*             CARRIER MASTER RECORD                            *
  6007****************************************************************
  6008
  6009     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6010         16  CF-ADDRESS-DATA.
  6011             20  CF-MAIL-TO-NAME            PIC X(30).
  6012             20  CF-IN-CARE-OF              PIC X(30).
  6013             20  CF-ADDRESS-LINE-1          PIC X(30).
  6014             20  CF-ADDRESS-LINE-2          PIC X(30).
  6015             20  CF-CITY-STATE              PIC X(30).
  6016             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6017             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6018
  6019         16  CF-CLAIM-NO-CONTROL.
  6020             20  CF-CLAIM-NO-METHOD         PIC X.
  6021                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6022                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6023                 88  CLAIM-NO-SEQ               VALUE '3'.
  6024                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6025             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6026                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6027                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6028                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6029
  6030         16  CF-CHECK-NO-CONTROL.
  6031             20  CF-CHECK-NO-METHOD         PIC X.
  6032                 88  CHECK-NO-MANUAL            VALUE '1'.
  6033                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6034                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6035                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6036             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6037                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6038
  6039         16  CF-DOMICILE-STATE              PIC XX.
  6040
  6041         16  CF-EXPENSE-CONTROLS.
  6042             20  CF-EXPENSE-METHOD          PIC X.
  6043                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6044                 88  DOLLARS-PER-PMT            VALUE '2'.
  6045                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6046                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6047             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6048             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6049
  6050         16  CF-CORRESPONDENCE-CONTROL.
  6051             20  CF-LETTER-RESEND-OPT       PIC X.
  6052                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6053                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6054             20  FILLER                     PIC X(4).
  6055
  6056         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 112
* EL050.cbl
  6057             20  CF-MANUAL-SW               PIC X.
  6058                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6059             20  CF-FUTURE-SW               PIC X.
  6060                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6061             20  CF-PTC-SW                  PIC X.
  6062                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6063             20  CF-IBNR-SW                 PIC X.
  6064                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6065             20  CF-PTC-LF-SW               PIC X.
  6066                 88  CF-LF-PTC-USED             VALUE '1'.
  6067             20  CF-CDT-ACCESS-METHOD       PIC X.
  6068                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6069                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6070                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6071             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6072
  6073         16  CF-CLAIM-CALC-METHOD           PIC X.
  6074             88  360-PLUS-MONTHS                VALUE '1'.
  6075             88  365-PLUS-MONTHS                VALUE '2'.
  6076             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6077             88  360-DAILY                      VALUE '4'.
  6078             88  365-DAILY                      VALUE '5'.
  6079
  6080         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6081         16  FILLER                         PIC X(11).
  6082
  6083         16  CF-LIMIT-AMOUNTS.
  6084             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6085             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6086             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6087             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6088             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6089             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6090             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6091             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6092             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6093             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6094
  6095         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6096         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6097         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6098
  6099         16  CF-ZIP-CODE.
  6100             20  CF-ZIP-PRIME.
  6101                 24  CF-ZIP-1ST             PIC X.
  6102                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6103                 24  FILLER                 PIC X(4).
  6104             20  CF-ZIP-PLUS4               PIC X(4).
  6105         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6106             20  CF-CAN-POSTAL-1            PIC XXX.
  6107             20  CF-CAN-POSTAL-2            PIC XXX.
  6108             20  FILLER                     PIC XXX.
  6109
  6110         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6111         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6112         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6113
  6114         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 113
* EL050.cbl
  6115             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6116             88  CF-NO-RATING                   VALUE 'N'.
  6117
  6118         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6119
  6120         16  CF-CARRIER-OVER-SHORT.
  6121             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6122             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6123
  6124         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6125         16  CF-SECPAY-SWITCH               PIC X.
  6126             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6127             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6128         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6129         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6130         16  FILLER                         PIC X(444).
  6131*        16  FILLER                         PIC X(452).
  6132
  6133
  6134****************************************************************
  6135*             MORTALITY MASTER RECORD                          *
  6136****************************************************************
  6137
  6138     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6139         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6140                                INDEXED BY CF-MORT-NDX.
  6141             20  CF-MORT-TABLE              PIC X(5).
  6142             20  CF-MORT-TABLE-TYPE         PIC X.
  6143                 88  CF-MORT-JOINT              VALUE 'J'.
  6144                 88  CF-MORT-SINGLE             VALUE 'S'.
  6145                 88  CF-MORT-COMBINED           VALUE 'C'.
  6146                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6147                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6148             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6149             20  CF-MORT-AGE-METHOD         PIC XX.
  6150                 88  CF-AGE-LAST                VALUE 'AL'.
  6151                 88  CF-AGE-NEAR                VALUE 'AN'.
  6152             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6153             20  CF-MORT-ADJUSTMENT-DIRECTION
  6154                                            PIC X.
  6155                 88  CF-MINUS                   VALUE '-'.
  6156                 88  CF-PLUS                    VALUE '+'.
  6157             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6158             20  CF-MORT-JOINT-CODE         PIC X.
  6159                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6160             20  CF-MORT-PC-Q               PIC X.
  6161                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6162             20  CF-MORT-TABLE-CODE         PIC X(4).
  6163             20  CF-MORT-COMMENTS           PIC X(15).
  6164             20  FILLER                     PIC X(14).
  6165
  6166         16  FILLER                         PIC X(251).
  6167
  6168
  6169****************************************************************
  6170*             BUSSINESS TYPE MASTER RECORD                     *
  6171****************************************************************
  6172
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 114
* EL050.cbl
  6173     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6174* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6175* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6176* AND RECORD 05 IS TYPES 81-99
  6177         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6178             20  CF-BUSINESS-TITLE          PIC  X(19).
  6179             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6180                                            PIC S9V9(4) COMP-3.
  6181             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6182             20  FILLER                     PIC  X.
  6183         16  FILLER                         PIC  X(248).
  6184
  6185
  6186****************************************************************
  6187*             TERMINAL MASTER RECORD                           *
  6188****************************************************************
  6189
  6190     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6191
  6192         16  CF-COMPANY-TERMINALS.
  6193             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6194                                  PIC X(4).
  6195         16  FILLER               PIC X(248).
  6196
  6197
  6198****************************************************************
  6199*             LIFE EDIT MASTER RECORD                          *
  6200****************************************************************
  6201
  6202     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6203         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6204             20  CF-LIFE-CODE-IN            PIC XX.
  6205             20  CF-LIFE-CODE-OUT           PIC XX.
  6206         16  FILLER                         PIC X(248).
  6207
  6208
  6209****************************************************************
  6210*             AH EDIT MASTER RECORD                            *
  6211****************************************************************
  6212
  6213     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6214         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6215             20  CF-AH-CODE-IN              PIC XXX.
  6216             20  CF-AH-CODE-OUT             PIC XX.
  6217         16  FILLER                         PIC X(248).
  6218
  6219
  6220****************************************************************
  6221*             CREDIBILITY TABLES                               *
  6222****************************************************************
  6223
  6224     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6225         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6226                             INDEXED BY CF-CRDB-NDX.
  6227             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6228             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6229             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6230         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 115
* EL050.cbl
  6231
  6232
  6233****************************************************************
  6234*             REPORT CUSTOMIZATION RECORD                      *
  6235****************************************************************
  6236
  6237     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6238         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6239             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6240             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6241             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6242**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6243****       A T-TRANSFER.                                   ****
  6244             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6245
  6246         16  FILLER                         PIC XX.
  6247
  6248         16  CF-CARRIER-CNTL-OPT.
  6249             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6250                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6251                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6252             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6253                                            PIC X.
  6254         16  CF-GROUP-CNTL-OPT.
  6255             20  CF-GROUP-OPT-SEQ           PIC 9.
  6256                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6257                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6258             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6259                                            PIC X(6).
  6260         16  CF-STATE-CNTL-OPT.
  6261             20  CF-STATE-OPT-SEQ           PIC 9.
  6262                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6263                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6264             20  CF-STATE-SELECT OCCURS 3 TIMES
  6265                                            PIC XX.
  6266         16  CF-ACCOUNT-CNTL-OPT.
  6267             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6268                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6269                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6270             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6271                                            PIC X(10).
  6272         16  CF-BUS-TYP-CNTL-OPT.
  6273             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6274                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6275                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6276             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6277                                            PIC XX.
  6278         16  CF-LF-TYP-CNTL-OPT.
  6279             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6280                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6281                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6282             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6283                                            PIC XX.
  6284         16  CF-AH-TYP-CNTL-OPT.
  6285             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6286                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6287                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6288             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 116
* EL050.cbl
  6289                                            PIC XX.
  6290         16  CF-REPTCD1-CNTL-OPT.
  6291             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6292                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6293                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6294             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6295                                            PIC X(10).
  6296         16  CF-REPTCD2-CNTL-OPT.
  6297             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6298                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6299                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6300             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6301                                            PIC X(10).
  6302         16  CF-USER1-CNTL-OPT.
  6303             20  CF-USER1-OPT-SEQ           PIC 9.
  6304                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6305                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6306             20  CF-USER1-SELECT OCCURS 3 TIMES
  6307                                            PIC X(10).
  6308         16  CF-USER2-CNTL-OPT.
  6309             20  CF-USER2-OPT-SEQ           PIC 9.
  6310                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6311                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6312             20  CF-USER2-SELECT OCCURS 3 TIMES
  6313                                            PIC X(10).
  6314         16  CF-USER3-CNTL-OPT.
  6315             20  CF-USER3-OPT-SEQ           PIC 9.
  6316                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6317                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6318             20  CF-USER3-SELECT OCCURS 3 TIMES
  6319                                            PIC X(10).
  6320         16  CF-USER4-CNTL-OPT.
  6321             20  CF-USER4-OPT-SEQ           PIC 9.
  6322                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6323                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6324             20  CF-USER4-SELECT OCCURS 3 TIMES
  6325                                            PIC X(10).
  6326         16  CF-USER5-CNTL-OPT.
  6327             20  CF-USER5-OPT-SEQ           PIC 9.
  6328                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6329                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6330             20  CF-USER5-SELECT OCCURS 3 TIMES
  6331                                            PIC X(10).
  6332         16  CF-REINS-CNTL-OPT.
  6333             20  CF-REINS-OPT-SEQ           PIC 9.
  6334                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6335                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6336             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6337                 24  CF-REINS-PRIME         PIC XXX.
  6338                 24  CF-REINS-SUB           PIC XXX.
  6339
  6340         16  CF-AGENT-CNTL-OPT.
  6341             20  CF-AGENT-OPT-SEQ           PIC 9.
  6342                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6343                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6344             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6345                                            PIC X(10).
  6346
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 117
* EL050.cbl
  6347         16  FILLER                         PIC X(43).
  6348
  6349         16  CF-LOSS-RATIO-SELECT.
  6350             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6351             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6352         16  CF-ENTRY-DATE-SELECT.
  6353             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6354             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6355         16  CF-EFFECTIVE-DATE-SELECT.
  6356             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6357             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6358
  6359         16  CF-EXCEPTION-LIST-IND          PIC X.
  6360             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6361
  6362         16  FILLER                         PIC X(318).
  6363
  6364****************************************************************
  6365*                  EXCEPTION REPORTING RECORD                  *
  6366****************************************************************
  6367
  6368     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6369         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6370             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6371
  6372         16  CF-COMBINED-LIFE-AH-OPT.
  6373             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6374             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6375             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6376             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6377
  6378         16  CF-LIFE-OPT.
  6379             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6380             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6381             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6382             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6383             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6384             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6385             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6386             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6387             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6388             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6389
  6390         16  CF-AH-OPT.
  6391             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6392             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6393             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6394             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6395             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6396             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6397             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6398             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6399             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6400             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6401
  6402         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6403             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6404             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 118
* EL050.cbl
  6405             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6406
  6407         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6408
  6409         16  FILLER                         PIC X(673).
  6410
  6411
  6412****************************************************************
  6413*             MORTGAGE SYSTEM PLAN RECORD                      *
  6414****************************************************************
  6415
  6416     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6417         16  CF-PLAN-TYPE                   PIC X.
  6418             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6419             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6420             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6421         16  CF-PLAN-ABBREV                 PIC XXX.
  6422         16  CF-PLAN-DESCRIPT               PIC X(10).
  6423         16  CF-PLAN-NOTES                  PIC X(20).
  6424         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6425         16  CF-PLAN-UNDERWRITING.
  6426             20  CF-PLAN-TERM-DATA.
  6427                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6428                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6429             20  CF-PLAN-AGE-DATA.
  6430                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6431                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6432                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6433             20  CF-PLAN-BENEFIT-DATA.
  6434                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6435                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6436                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6437                                            PIC S9(7)V99  COMP-3.
  6438         16  CF-PLAN-POLICY-FORMS.
  6439             20  CF-POLICY-FORM             PIC X(12).
  6440             20  CF-MASTER-APPLICATION      PIC X(12).
  6441             20  CF-MASTER-POLICY           PIC X(12).
  6442         16  CF-PLAN-RATING.
  6443             20  CF-RATE-CODE               PIC X(5).
  6444             20  CF-SEX-RATING              PIC X.
  6445                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6446                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6447             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6448             20  CF-SUB-STD-TYPE            PIC X.
  6449                 88  CF-PCT-OF-PREM            VALUE '1'.
  6450                 88  CF-PCT-OF-BENE            VALUE '2'.
  6451         16  CF-PLAN-PREM-TOLERANCES.
  6452             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6453             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6454         16  CF-PLAN-PYMT-TOLERANCES.
  6455             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6456             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6457         16  CF-PLAN-MISC-DATA.
  6458             20  FILLER                     PIC X.
  6459             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6460             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6461         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6462         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 119
* EL050.cbl
  6463             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6464                                                     '1'.
  6465             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6466                                                     '2'.
  6467         16  CF-MIB-SEARCH-SW               PIC X.
  6468             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6469             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6470             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6471             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6472         16  CF-ALPHA-SEARCH-SW             PIC X.
  6473             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6474             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6475             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6476             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6477             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6478             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6479             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6480             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6481             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6482             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6483                                                     'A' 'B' 'C'
  6484                                                     'X' 'Y' 'Z'.
  6485         16  CF-EFF-DT-RULE-SW              PIC X.
  6486             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6487             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6488             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6489             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6490             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6491         16  FILLER                         PIC X(4).
  6492         16  CF-HEALTH-QUESTIONS            PIC X.
  6493             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6494         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6495         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6496         16  CF-PLAN-SNGL-JNT               PIC X.
  6497             88  CF-COMBINED-PLAN              VALUE 'C'.
  6498             88  CF-JNT-PLAN                   VALUE 'J'.
  6499             88  CF-SNGL-PLAN                  VALUE 'S'.
  6500         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6501         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6502         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6503         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6504         16  CF-RERATE-CNTL                 PIC  X.
  6505             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6506             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6507             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6508             88  CF-AUTO-RECALC                 VALUE '4'.
  6509         16  CF-BENEFIT-TYPE                PIC  X.
  6510             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6511             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6512         16  CF-POLICY-FEE                  PIC S999V99
  6513                                                    COMP-3.
  6514         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6515         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6516         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6517         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6518         16  FILLER                         PIC  X(32).
  6519         16  CF-TERMINATION-FORM            PIC  X(04).
  6520         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 120
* EL050.cbl
  6521         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6522                                                       COMP-3.
  6523         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6524         16  CF-ISSUE-LETTER                PIC  X(4).
  6525         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6526         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6527             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6528             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6529         16  CF-MP-REFUND-CALC              PIC X.
  6530             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6531             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6532             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6533             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6534             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6535             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6536             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6537             88  CF-MP-REFD-MEAN                VALUE '8'.
  6538         16  CF-ALT-RATE-CODE               PIC  X(5).
  6539
  6540
  6541         16  FILLER                         PIC X(498).
  6542****************************************************************
  6543*             MORTGAGE COMPANY MASTER RECORD                   *
  6544****************************************************************
  6545
  6546     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6547         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6548         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6549             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6550             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6551             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6552             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6553             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6554
  6555         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6556         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6557         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6558         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6559         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6560
  6561         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6562             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6563         16  CF-MP-RECON-USE-IND            PIC X(1).
  6564             88  CF-MP-USE-RECON             VALUE 'Y'.
  6565         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6566             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6567         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6568             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6569             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6570         16  FILLER                         PIC X(1).
  6571         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6572             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6573         16  CF-MORTG-MIB-VERSION           PIC X.
  6574             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6575             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6576             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6577         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6578             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 121
* EL050.cbl
  6579                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6580             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6581                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6582             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6583                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6584             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6585                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6586             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6587                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6588             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6589                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6590         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6591         16  FILLER                         PIC X(7).
  6592         16  CF-MORTG-DESTINATION-SYMBOL.
  6593             20  CF-MORTG-MIB-COMM          PIC X(5).
  6594             20  CF-MORTG-MIB-TERM          PIC X(5).
  6595         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6596             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6597         16  FILLER                         PIC X(03).
  6598         16  CF-MP-CHECK-NO-CONTROL.
  6599             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6600                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6601                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6602                                                ' ' LOW-VALUES.
  6603                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6604                                               VALUE '3'.
  6605         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6606         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6607         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6608             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6609                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6610             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6611                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6612             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6613                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6614             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6615                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6616             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6617                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6618             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6619                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6620         16  CF-MORTG-BILLING-AREA.
  6621             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6622                                            PIC X.
  6623         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6624         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6625         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6626         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6627             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6628             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6629         16  FILLER                         PIC X.
  6630         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6631             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6632             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6633         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6634         16  FILLER                         PIC X(8).
  6635         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6636         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 122
* EL050.cbl
  6637         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6638         16  CF-ACH-COMPANY-ID.
  6639             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6640                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6641                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6642                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6643             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6644         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6645             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6646         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6647             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6648             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6649         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6650         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6651         16  FILLER                         PIC X(536).
  6652
  6653****************************************************************
  6654*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6655****************************************************************
  6656
  6657     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6658         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6659             20  CF-FEMALE-HEIGHT.
  6660                 24  CF-FEMALE-FT           PIC 99.
  6661                 24  CF-FEMALE-IN           PIC 99.
  6662             20  CF-FEMALE-MIN-WT           PIC 999.
  6663             20  CF-FEMALE-MAX-WT           PIC 999.
  6664         16  FILLER                         PIC X(428).
  6665
  6666     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6667         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6668             20  CF-MALE-HEIGHT.
  6669                 24  CF-MALE-FT             PIC 99.
  6670                 24  CF-MALE-IN             PIC 99.
  6671             20  CF-MALE-MIN-WT             PIC 999.
  6672             20  CF-MALE-MAX-WT             PIC 999.
  6673         16  FILLER                         PIC X(428).
  6674******************************************************************
  6675*             AUTOMATIC ACTIVITY RECORD                          *
  6676******************************************************************
  6677     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6678         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6679             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6680             20  CF-SYS-LETTER-ID           PIC X(04).
  6681             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6682             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6683             20  CF-SYS-RESET-SW            PIC X(01).
  6684             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6685             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6686
  6687         16  FILLER                         PIC X(50).
  6688
  6689         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6690             20  CF-USER-ACTIVE-SW          PIC X(01).
  6691             20  CF-USER-LETTER-ID          PIC X(04).
  6692             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6693             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6694             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 123
* EL050.cbl
  6695             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6696             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6697             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6698
  6699         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 124
* EL050.cbl
  6701*    COPY ERCACCT.
  6702******************************************************************
  6703*                                                                *
  6704*                                                                *
  6705*                            ERCACCT                             *
  6706*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6707*                            VMOD=2.031                          *
  6708*                                                                *
  6709*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6710*                                                                *
  6711*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6712*   VSAM ACCOUNT MASTER FILES.                                   *
  6713*                                                                *
  6714*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6715*                                                                *
  6716*   FILE TYPE = VSAM,KSDS                                        *
  6717*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6718*                                                                *
  6719*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6720*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6721*                                                                *
  6722*   LOG = NO                                                     *
  6723*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6724*                                                                *
  6725*                                                                *
  6726******************************************************************
  6727*                   C H A N G E   L O G
  6728*
  6729* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6730*-----------------------------------------------------------------
  6731*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6732* EFFECTIVE    NUMBER
  6733*-----------------------------------------------------------------
  6734* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6735* 092705    2005050300006  PEMA  ADD SPP LEASES
  6736* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6737* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6738* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6739* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6740* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6741* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6742******************************************************************
  6743
  6744 01  ACCOUNT-MASTER.
  6745     12  AM-RECORD-ID                      PIC XX.
  6746         88  VALID-AM-ID                      VALUE 'AM'.
  6747
  6748     12  AM-CONTROL-PRIMARY.
  6749         16  AM-COMPANY-CD                 PIC X.
  6750         16  AM-MSTR-CNTRL.
  6751             20  AM-CONTROL-A.
  6752                 24  AM-CARRIER            PIC X.
  6753                 24  AM-GROUPING.
  6754                     28 AM-GROUPING-PREFIX PIC XXX.
  6755                     28 AM-GROUPING-PRIME  PIC XXX.
  6756                 24  AM-STATE              PIC XX.
  6757                 24  AM-ACCOUNT.
  6758                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 125
* EL050.cbl
  6759                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6760             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6761                                           PIC X(19).
  6762             20  AM-CNTRL-B.
  6763                 24  AM-EXPIRATION-DT      PIC XX.
  6764                 24  FILLER                PIC X(4).
  6765             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6766                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6767
  6768     12  AM-CONTROL-BY-VAR-GRP.
  6769         16  AM-COMPANY-CD-A1              PIC X.
  6770         16  AM-VG-CARRIER                 PIC X.
  6771         16  AM-VG-GROUPING                PIC X(6).
  6772         16  AM-VG-STATE                   PIC XX.
  6773         16  AM-VG-ACCOUNT                 PIC X(10).
  6774         16  AM-VG-DATE.
  6775             20  AM-VG-EXPIRATION-DT       PIC XX.
  6776             20  FILLER                    PIC X(4).
  6777         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6778                                           PIC 9(11)      COMP-3.
  6779     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6780         16  FILLER                        PIC X(10).
  6781         16  AM-VG-KEY3.
  6782             20  AM-VG3-ACCOUNT            PIC X(10).
  6783             20  AM-VG3-EXP-DT             PIC XX.
  6784         16  FILLER                        PIC X(4).
  6785     12  AM-MAINT-INFORMATION.
  6786         16  AM-LAST-MAINT-DT              PIC XX.
  6787         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6788         16  AM-LAST-MAINT-USER            PIC X(4).
  6789         16  FILLER                        PIC XX.
  6790
  6791     12  AM-EFFECTIVE-DT                   PIC XX.
  6792     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6793
  6794     12  AM-PREV-DATES  COMP-3.
  6795         16  AM-PREV-EXP-DT                PIC 9(11).
  6796         16  AM-PREV-EFF-DT                PIC 9(11).
  6797
  6798     12  AM-REPORT-CODE-1                  PIC X(10).
  6799     12  AM-REPORT-CODE-2                  PIC X(10).
  6800
  6801     12  AM-CITY-CODE                      PIC X(4).
  6802     12  AM-COUNTY-PARISH                  PIC X(6).
  6803
  6804     12  AM-NAME                           PIC X(30).
  6805     12  AM-PERSON                         PIC X(30).
  6806     12  AM-ADDRS                          PIC X(30).
  6807     12  AM-CITY.
  6808         16  AM-ADDR-CITY                  PIC X(28).
  6809         16  AM-ADDR-STATE                 PIC XX.
  6810     12  AM-ZIP.
  6811         16  AM-ZIP-PRIME.
  6812             20  AM-ZIP-PRI-1ST            PIC X.
  6813                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6814             20  FILLER                    PIC X(4).
  6815         16  AM-ZIP-PLUS4                  PIC X(4).
  6816     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 126
* EL050.cbl
  6817         16  AM-CAN-POSTAL-1               PIC XXX.
  6818         16  AM-CAN-POSTAL-2               PIC XXX.
  6819         16  FILLER                        PIC XXX.
  6820     12  AM-TEL-NO.
  6821         16  AM-AREA-CODE                  PIC 999.
  6822         16  AM-TEL-PRE                    PIC 999.
  6823         16  AM-TEL-NBR                    PIC 9(4).
  6824     12  AM-TEL-LOC                        PIC X.
  6825         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6826         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6827
  6828     12  AM-COMM-STRUCTURE.
  6829         16  AM-DEFN-1.
  6830             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6831                 24  AM-AGT.
  6832                     28  AM-AGT-PREFIX     PIC X(4).
  6833                     28  AM-AGT-PRIME      PIC X(6).
  6834                 24  AM-COM-TYP            PIC X.
  6835                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6836                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6837                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6838                 24  AM-RECALC-LV-INDIC    PIC X.
  6839                 24  AM-RETRO-LV-INDIC     PIC X.
  6840                 24  AM-GL-CODES           PIC X.
  6841                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6842                 24  FILLER                PIC X(01).
  6843         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6844             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6845                 24  FILLER                PIC X(11).
  6846                 24  AM-L-COMA             PIC XXX.
  6847                 24  AM-J-COMA             PIC XXX.
  6848                 24  AM-A-COMA             PIC XXX.
  6849                 24  FILLER                PIC X(6).
  6850
  6851     12  AM-COMM-CHANGE-STATUS             PIC X.
  6852         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6853
  6854     12  AM-CSR-CODE                       PIC X(4).
  6855
  6856     12  AM-BILLING-STATUS                 PIC X.
  6857         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6858         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6859     12  AM-AUTO-REFUND-SW                 PIC X.
  6860         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6861         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6862     12  AM-GPCD                           PIC 99.
  6863     12  AM-IG                             PIC X.
  6864         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6865         88  AM-HAS-GROUP                     VALUE '2'.
  6866     12  AM-STATUS                         PIC X.
  6867         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6868         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6869         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6870         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6871         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6872         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6873         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6874         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 127
* EL050.cbl
  6875         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6876         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6877     12  AM-REMIT-TO                       PIC 99.
  6878     12  AM-ID-NO                          PIC X(11).
  6879
  6880     12  AM-CAL-TABLE                      PIC XX.
  6881     12  AM-LF-DEVIATION                   PIC XXX.
  6882     12  AM-AH-DEVIATION                   PIC XXX.
  6883     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6884     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6885     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6886     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6887     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6888     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6889
  6890     12  AM-USER-FIELDS.
  6891         16  AM-FLD-1                      PIC XX.
  6892         16  AM-FLD-2                      PIC XX.
  6893         16  AM-FLD-3                      PIC XX.
  6894         16  AM-FLD-4                      PIC XX.
  6895         16  AM-FLD-5                      PIC XX.
  6896
  6897     12  AM-1ST-PROD-DATE.
  6898         16  AM-1ST-PROD-YR                PIC XX.
  6899         16  AM-1ST-PROD-MO                PIC XX.
  6900         16  AM-1ST-PROD-DA                PIC XX.
  6901     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6902     12  AM-CERTS-PURGED-DATE.
  6903         16  AM-PUR-YR                     PIC XX.
  6904         16  AM-PUR-MO                     PIC XX.
  6905         16  AM-PUR-DA                     PIC XX.
  6906     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6907     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6908     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6909     12  AM-INACTIVE-DATE.
  6910         16  AM-INA-MO                     PIC 99.
  6911         16  AM-INA-DA                     PIC 99.
  6912         16  AM-INA-YR                     PIC 99.
  6913     12  AM-AR-HI-CERT-DATE                PIC XX.
  6914
  6915     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6916     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6917
  6918     12  AM-OB-PAYMENT-MODE                PIC X.
  6919         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6920         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6921         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6922         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6923
  6924     12  AM-AH-ONLY-INDICATOR              PIC X.
  6925         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6926         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6927
  6928     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6929
  6930     12  AM-OVER-SHORT.
  6931         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6932         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 128
* EL050.cbl
  6933
  6934     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6935     12  AM-DCC-CLP-STATE                  PIC XX.
  6936
  6937     12  AM-RECALC-COMM                    PIC X.
  6938     12  AM-RECALC-REIN                    PIC X.
  6939
  6940     12  AM-REI-TABLE                      PIC XXX.
  6941     12  AM-REI-ET-LF                      PIC X.
  6942     12  AM-REI-ET-AH                      PIC X.
  6943     12  AM-REI-PE-LF                      PIC X.
  6944     12  AM-REI-PE-AH                      PIC X.
  6945     12  AM-REI-PRT-ST                     PIC X.
  6946     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6947     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6948     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6949     12  AM-REI-GROUP-A                    PIC X(6).
  6950     12  AM-REI-MORT                       PIC X(4).
  6951     12  AM-REI-PRT-OW                     PIC X.
  6952     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6953     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6954     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6955     12  AM-REI-GROUP-B                    PIC X(6).
  6956
  6957     12  AM-TRUST-TYPE                     PIC X(2).
  6958
  6959     12  AM-EMPLOYER-STMT-USED             PIC X.
  6960     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6961
  6962     12  AM-STD-AH-TYPE                    PIC XX.
  6963     12  AM-EARN-METHODS.
  6964         16  AM-EARN-METHOD-R              PIC X.
  6965             88 AM-REF-RL-R78                 VALUE 'R'.
  6966             88 AM-REF-RL-PR                  VALUE 'P'.
  6967             88 AM-REF-RL-MEAN                VALUE 'M'.
  6968             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6969         16  AM-EARN-METHOD-L              PIC X.
  6970             88 AM-REF-LL-R78                 VALUE 'R'.
  6971             88 AM-REF-LL-PR                  VALUE 'P'.
  6972             88 AM-REF-LL-MEAN                VALUE 'M'.
  6973             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6974         16  AM-EARN-METHOD-A              PIC X.
  6975             88 AM-REF-AH-R78                 VALUE 'R'.
  6976             88 AM-REF-AH-PR                  VALUE 'P'.
  6977             88 AM-REF-AH-MEAN                VALUE 'M'.
  6978             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6979             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6980             88 AM-REF-AH-NET                 VALUE 'N'.
  6981
  6982     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6983     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6984     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6985
  6986     12  AM-RET-Y-N                        PIC X.
  6987     12  AM-RET-P-E                        PIC X.
  6988     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6989     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6990     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 129
* EL050.cbl
  6991     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6992         16  AM-POOL-PRIME                 PIC XXX.
  6993         16  AM-POOL-SUB                   PIC XXX.
  6994     12  AM-RETRO-EARNINGS.
  6995         16  AM-RET-EARN-R                 PIC X.
  6996         16  AM-RET-EARN-L                 PIC X.
  6997         16  AM-RET-EARN-A                 PIC X.
  6998     12  AM-RET-ST-TAX-USE                 PIC X.
  6999         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  7000         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  7001     12  AM-RETRO-BEG-EARNINGS.
  7002         16  AM-RET-BEG-EARN-R             PIC X.
  7003         16  AM-RET-BEG-EARN-L             PIC X.
  7004         16  AM-RET-BEG-EARN-A             PIC X.
  7005     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  7006     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  7007
  7008     12  AM-USER-SELECT-OPTIONS.
  7009         16  AM-USER-SELECT-1              PIC X(10).
  7010         16  AM-USER-SELECT-2              PIC X(10).
  7011         16  AM-USER-SELECT-3              PIC X(10).
  7012         16  AM-USER-SELECT-4              PIC X(10).
  7013         16  AM-USER-SELECT-5              PIC X(10).
  7014
  7015     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7016
  7017     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7018
  7019     12  AM-RPT045A-SWITCH                 PIC X.
  7020         88  RPT045A-OFF                   VALUE 'N'.
  7021
  7022     12  AM-INSURANCE-LIMITS.
  7023         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  7024         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  7025
  7026     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  7027         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  7028
  7029     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7030         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7031         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7032
  7033     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7034
  7035     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7036     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7037     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7038     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7039     12  AM-DCC-UEF-STATE                  PIC XX.
  7040     12  FILLER                            PIC XXX.
  7041     12  AM-REPORT-CODE-3                  PIC X(10).
  7042*    12  FILLER                            PIC X(22).
  7043
  7044     12  AM-RESERVE-DATE.
  7045         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7046         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7047         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7048
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 130
* EL050.cbl
  7049     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7050     12  AM-NOTIFICATION-TYPES.
  7051         16  AM-NOTIF-OF-LETTERS           PIC X.
  7052         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7053         16  AM-NOTIF-OF-REPORTS           PIC X.
  7054         16  AM-NOTIF-OF-STATUS            PIC X.
  7055
  7056     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7057         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7058         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7059         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7060         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7061
  7062     12  AM-BENEFIT-CONTROLS.
  7063         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7064             20  AM-BENEFIT-CODE           PIC XX.
  7065             20  AM-BENEFIT-TYPE           PIC X.
  7066             20  AM-BENEFIT-REVISION       PIC XXX.
  7067             20  AM-BENEFIT-REM-TERM       PIC X.
  7068             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7069             20  FILLER                    PIC XX.
  7070         16  FILLER                        PIC X(80).
  7071
  7072     12  AM-TRANSFER-DATA.
  7073         16  AM-TRANSFERRED-FROM.
  7074             20  AM-TRNFROM-CARRIER        PIC X.
  7075             20  AM-TRNFROM-GROUPING.
  7076                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7077                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7078             20  AM-TRNFROM-STATE          PIC XX.
  7079             20  AM-TRNFROM-ACCOUNT.
  7080                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7081                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7082             20  AM-TRNFROM-DTE            PIC XX.
  7083         16  AM-TRANSFERRED-TO.
  7084             20  AM-TRNTO-CARRIER          PIC X.
  7085             20  AM-TRNTO-GROUPING.
  7086                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7087                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7088             20  AM-TRNTO-STATE            PIC XX.
  7089             20  AM-TRNTO-ACCOUNT.
  7090                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7091                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7092             20  AM-TRNTO-DTE              PIC XX.
  7093         16  FILLER                        PIC X(10).
  7094
  7095     12  AM-SAVED-REMIT-TO                 PIC 99.
  7096
  7097     12  AM-COMM-STRUCTURE-SAVED.
  7098         16  AM-DEFN-1-SAVED.
  7099             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7100                 24  AM-AGT-SV             PIC X(10).
  7101                 24  AM-COM-TYP-SV         PIC X.
  7102                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7103                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7104                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7105                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7106                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 131
* EL050.cbl
  7107                 24  AM-GL-CODES-SV        PIC X.
  7108                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7109                 24  FILLER                PIC X.
  7110         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7111             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7112                 24  FILLER                PIC X(11).
  7113                 24  AM-L-COMA-SV          PIC XXX.
  7114                 24  AM-J-COMA-SV          PIC XXX.
  7115                 24  AM-A-COMA-SV          PIC XXX.
  7116                 24  FILLER                PIC X(6).
  7117
  7118     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7119         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7120            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7121            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7122            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7123
  7124     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7125     12  FILLER                            PIC X(120).
  7126
  7127     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7128         16  AM-CONTROL-NAME               PIC X(30).
  7129         16  AM-EXECUTIVE-ONE.
  7130             20  AM-EXEC1-NAME             PIC X(15).
  7131             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7132                                                          COMP-3.
  7133             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7134                                                          COMP-3.
  7135         16  AM-EXECUTIVE-TWO.
  7136             20  AM-EXEC2-NAME             PIC X(15).
  7137             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7138                                                          COMP-3.
  7139             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7140                                                          COMP-3.
  7141
  7142     12  AM-RETRO-ADDITIONAL-DATA.
  7143         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7144         16  AM-RETRO-PREM-P-E             PIC X.
  7145         16  AM-RETRO-CLMS-P-I             PIC X.
  7146         16  AM-RETRO-RET-BRACKET-LF.
  7147             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7148                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7149                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7150             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7151                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7152                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7153             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7154                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7155                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7156         16  AM-RETRO-RET-BRACKET-AH.
  7157             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7158                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7159                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7160                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7161             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7162                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7163                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7164             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 132
* EL050.cbl
  7165                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7166                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7167
  7168     12  AM-COMMENTS.
  7169         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7170
  7171     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7172         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7173         16  AM-FLI-BILLING-CODE           PIC X.
  7174         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7175         16  AM-FLI-UNITED-IDENT           PIC X.
  7176         16  AM-FLI-INTEREST-LOST-DATA.
  7177             20  AM-FLI-BANK-NO            PIC X(5).
  7178             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7179             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7180             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7181         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7182             20  AM-FLI-AGT                PIC X(9).
  7183             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7184             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7185         16  FILLER                        PIC X(102).
  7186
  7187     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7188         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7189             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7190             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7191             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7192             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7193             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7194         16  FILLER                          PIC X(10).
  7195******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 133
* EL050.cbl
  7197*    COPY ERCREIN.
  7198******************************************************************
  7199*                                                                *
  7200*                            ERCREIN                             *
  7201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7202*                            VMOD=2.010                          *
  7203*                                                                *
  7204*   ONLINE CREDIT SYSTEM                                         *
  7205*                                                                *
  7206*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7207*                                                                *
  7208*   FILE TYPE = VSAM,KSDS                                        *
  7209*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7210*                                                                *
  7211*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7212*       ALTERNATE PATH = NONE                                    *
  7213*                                                                *
  7214*   LOG = NO                                                     *
  7215*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7216*                                                                *
  7217******************************************************************
  7218*                   C H A N G E   L O G
  7219*
  7220* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7221*-----------------------------------------------------------------
  7222*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7223* EFFECTIVE    NUMBER
  7224*-----------------------------------------------------------------
  7225* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7226* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7227******************************************************************
  7228 01  REINSURANCE-RECORD.
  7229     12  RE-RECORD-ID                      PIC XX.
  7230         88  VALID-RE-ID                      VALUE 'RE'.
  7231
  7232     12  RE-CONTROL-PRIMARY.
  7233         16  RE-COMPANY-CD                 PIC X.
  7234         16  RE-KEY.
  7235             20  RE-CODE                   PIC X.
  7236                 88  RE-TABLE-RECORD          VALUE 'A'.
  7237                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7238             20  RE-TABLE                  PIC XXX.
  7239             20  FILLER                    PIC XXX.
  7240         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7241             20  FILLER                    PIC X.
  7242             20  RE-COMPANY.
  7243                 24  RE-COMP-PRIME         PIC XXX.
  7244                 24  RE-COMP-SUB           PIC XXX.
  7245
  7246     12  RE-MAINT-INFORMATION.
  7247         16  RE-LAST-MAINT-DT              PIC XX.
  7248         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7249         16  RE-LAST-MAINT-USER            PIC X(4).
  7250         16  FILLER                        PIC X(10).
  7251
  7252     12  RE-TABLE-DATA.
  7253         16  RE-100-COMP                   PIC 99.
  7254
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 134
* EL050.cbl
  7255         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7256             20  RE-REI-COMP-NO.
  7257                 24  RE-REI-COMP           PIC XXX.
  7258                 24  RE-REI-COMP-SUB       PIC XXX.
  7259             20  RE-LF-QC                  PIC X.
  7260             20  RE-AH-QC                  PIC X.
  7261             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7262             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7263             20  RE-LFAGE-LO               PIC 99.
  7264             20  RE-LFAGE-HI               PIC 99.
  7265             20  RE-AHAGE-LO               PIC 99.
  7266             20  RE-AHAGE-HI               PIC 99.
  7267             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7268             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7269             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7270             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7271             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7272             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7273             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7274             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7275             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7276             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7277             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7278             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7279             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7280             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7281             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7282             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7283             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7284             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7285             20  RE-LF-BEN-CODE            PIC X.
  7286             20  RE-AH-BEN-CODE            PIC X.
  7287             20  RE-INTERACTIVE            PIC X.
  7288             20  RE-REMAINING              PIC X.
  7289             20  RE-LF-RUNOFF-SW           PIC X.
  7290             20  RE-AH-RUNOFF-SW           PIC X.
  7291             20  FILLER                    PIC X(19).
  7292
  7293         16  RE-COMP-INFO-END              PIC X(6).
  7294         16  RE-NSP-ST-CD-LF               PIC XX.
  7295         16  RE-NSP-ST-CD-AH               PIC XX.
  7296         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7297             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7298
  7299         16  FILLER                        PIC X(27).
  7300
  7301     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7302         16  RE-NAME                       PIC X(30).
  7303         16  RE-LF-PE                      PIC X.
  7304         16  RE-AH-PE                      PIC X.
  7305         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7306         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7307         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7308         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7309         16  RE-PRT-ST                     PIC X.
  7310         16  RE-PRT-OW                     PIC X.
  7311         16  RE-MORT-CODE                  PIC X(4).
  7312         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 135
* EL050.cbl
  7313         16  RE-ZERO-LF-FEE                PIC X.
  7314         16  RE-ZERO-AH-FEE                PIC X.
  7315         16  RE-CEDE-NAME                  PIC X(30).
  7316         16  RE-LF-COMM                    PIC X.
  7317         16  RE-AH-COMM                    PIC X.
  7318         16  RE-LF-TAX                     PIC X.
  7319         16  RE-AH-TAX                     PIC X.
  7320         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7321         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7322         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7323
  7324         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7325             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7326
  7327         16  RE-LF-CEDING-FEE-BRACKETS.
  7328             20  RE-LF-FEE-METHOD          PIC X.
  7329                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7330                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7331                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7332                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7333             20  RE-LF-FEE-BASIS           PIC X.
  7334                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7335                 88  RE-LF-NET-CEDED               VALUE '2'.
  7336                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7337                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7338                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7339                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7340                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7341                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7342             20  FILLER                    PIC XXX.
  7343             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7344                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7345                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7346
  7347         16  RE-AH-CEDING-FEE-BRACKETS.
  7348             20  RE-AH-FEE-METHOD          PIC X.
  7349                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7350                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7351                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7352                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7353             20  RE-AH-FEE-BASIS           PIC X.
  7354                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7355                 88  RE-AH-NET-CEDED               VALUE '2'.
  7356                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7357                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7358                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7359                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7360                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7361                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7362             20  FILLER                    PIC XXX.
  7363             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7364                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7365                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7366
  7367         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7368
  7369         16  RE-OLD-CEDING-STMT            PIC X.
  7370
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 136
* EL050.cbl
  7371         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7372         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7373         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7374         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7375         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7376         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7377         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7378         16  RE-MORT-SW                    PIC X.
  7379         16  RE-CEDING-TYPE-FLAG           PIC X.
  7380             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7381             88  RE-CEDED                          VALUE 'C'.
  7382             88  RE-ASSUMED                        VALUE 'A'.
  7383             88  RE-PHANTOM                        VALUE 'P'.
  7384
  7385         16  RE-CEDING-STMT-OPT-A          PIC X.
  7386             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7387         16  RE-CEDING-STMT-OPT-B          PIC X.
  7388             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7389         16  RE-CEDING-STMT-OPT-C          PIC X.
  7390             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7391         16  RE-CEDING-STMT-OPT-D          PIC X.
  7392             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7393         16  RE-CEDING-STMT-OPT-E          PIC X.
  7394             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7395
  7396         16  RE-PRT-CRSV                   PIC X.
  7397
  7398         16  RE-GL-CENTER                  PIC X(4).
  7399
  7400         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7401
  7402         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7403
  7404         16  RE-EARN-STOP-CODE             PIC X.
  7405             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7406             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7407
  7408         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7409             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7410
  7411         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7412         16  FILLER                        PIC X(2281).
  7413
  7414         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7415
  7416******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 137
* EL050.cbl
  7418*    COPY ERCCTBL.
  7419******************************************************************
  7420*                                                                *
  7421*                                                                *
  7422*                            ERCCTBL                             *
  7423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7424*                            VMOD=2.003
  7425*                                                                *
  7426*   ONLINE CREDIT SYSTEM                                         *
  7427*                                                                *
  7428*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7429*                                                                *
  7430*   FILE TYPE = VSAM,KSDS                                        *
  7431*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7432*                                                                *
  7433*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7434*       ALTERNATE PATH = NONE                                    *
  7435*                                                                *
  7436*   LOG = NO                                                     *
  7437*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7438*                                                                *
  7439*                                                                *
  7440******************************************************************
  7441
  7442 01  COMM-TABLE-RECORD.
  7443     12  CT-RECORD-ID                      PIC XX.
  7444         88  VALID-CT-ID                      VALUE 'CT'.
  7445
  7446     12  CT-CONTROL-PRIMARY.
  7447         16  CT-COMPANY-CD                 PIC X.
  7448         16  CT-TABLE                      PIC XXX.
  7449         16  CT-CNTRL-2.
  7450             20  CT-BEN-TYPE               PIC X.
  7451             20  CT-BEN-CODE               PIC XX.
  7452
  7453     12  CT-MAINT-INFORMATION.
  7454         16  CT-LAST-MAINT-DT              PIC XX.
  7455         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7456         16  CT-LAST-MAINT-USER            PIC X(4).
  7457         16  FILLER                        PIC X(31).
  7458
  7459     12  CT-LIMITS.
  7460         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7461
  7462         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7463
  7464         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7465
  7466     12  CT-RATES.
  7467         16  CT-RTX          OCCURS 27 TIMES.
  7468             20  CT-RT                     PIC SV9(5)     COMP-3.
  7469             20  CT-RT-R   REDEFINES
  7470                 CT-RT                     PIC XXX.
  7471
  7472     12  FILLER                            PIC  X(42).
  7473
  7474******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 138
* EL050.cbl
  7476*    COPY ERCFORM.
  7477******************************************************************
  7478*                                                                *
  7479*                                                                *
  7480*                            ERCFORM.                            *
  7481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7482*                            VMOD=2.003                          *
  7483*                                                                *
  7484*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7485*                                                                *
  7486*    FILE TYPE = VSAM,KSDS                                       *
  7487*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7488*                                                                *
  7489*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7490*                                                                *
  7491*    LOG = YES                                                   *
  7492*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7493******************************************************************
  7494 01  FORM-MASTER.
  7495    12  FO-RECORD-ID                 PIC X(02).
  7496        88  VALID-FO-ID                  VALUE 'FO'.
  7497
  7498    12  FO-CONTROL-PRIMARY.
  7499        16  FO-COMPANY-CD            PIC X(01).
  7500        16  FO-STATE                 PIC X(02).
  7501        16  FO-FORM-ID               PIC X(12).
  7502        16  FO-FORM-EXP-DT           PIC X(02).
  7503
  7504    12  FO-POLICY-FORM-DATA.
  7505        16  FO-IND-GRP-CD            PIC X(01).
  7506        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7507        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7508        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7509        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7510        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7511        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7512        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7513        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7514        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7515        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7516        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7517        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7518        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7519        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7520        16  FO-APP-CERT-USE-CD       PIC X(01).
  7521
  7522    12  FILLER                       PIC X(29).
  7523
  7524    12  FO-FORM-PLAN-TABLE.
  7525        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7526            20  FO-PLAN-TYPE         PIC X(01).
  7527            20  FO-PLAN-ID           PIC X(02).
  7528            20  FO-PLAN-TERM         PIC 9(03).
  7529            20  FO-PLAN-REFUND-METHOD
  7530                                     PIC X.
  7531
  7532    12  FILLER                       PIC X(30).
  7533
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 139
* EL050.cbl
  7534    12  FO-COMMENTS-AREA.
  7535        16  FO-COMMENT-LINE-1        PIC X(78).
  7536
  7537    12  FILLER                       PIC X(20).
  7538
  7539    12  FO-MAINT-INFORMATION.
  7540        16  FO-LAST-MAINT-DT         PIC X(02).
  7541        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7542        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 140
* EL050.cbl
  7544*    COPY ELCMSTR.
  7545******************************************************************
  7546*                                                                *
  7547*                            ELCMSTR.                            *
  7548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7549*                            VMOD=2.012                          *
  7550*                                                                *
  7551*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7552*                                                                *
  7553*   FILE TYPE = VSAM,KSDS                                        *
  7554*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7555*                                                                *
  7556*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7557*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7558*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7559*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7560*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7561*                                                 RKP=75,LEN=21  *
  7562*                                                                *
  7563*   **** NOTE ****                                               *
  7564*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7565*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7566*                                                                *
  7567*   LOG = YES                                                    *
  7568*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7569******************************************************************
  7570*                   C H A N G E   L O G
  7571*
  7572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7573*-----------------------------------------------------------------
  7574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7575* EFFECTIVE    NUMBER
  7576*-----------------------------------------------------------------
  7577* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7578* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7579* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7580* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7581* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7582* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7583* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7584******************************************************************
  7585 01  CLAIM-MASTER.
  7586     12  CL-RECORD-ID                PIC XX.
  7587         88  VALID-CL-ID         VALUE 'CL'.
  7588
  7589     12  CL-CONTROL-PRIMARY.
  7590         16  CL-COMPANY-CD           PIC X.
  7591         16  CL-CARRIER              PIC X.
  7592         16  CL-CLAIM-NO             PIC X(7).
  7593         16  CL-CERT-NO.
  7594             20  CL-CERT-PRIME       PIC X(10).
  7595             20  CL-CERT-SFX         PIC X.
  7596
  7597     12  CL-CONTROL-BY-NAME.
  7598         16  CL-COMPANY-CD-A1        PIC X.
  7599         16  CL-INSURED-LAST-NAME    PIC X(15).
  7600         16  CL-INSURED-NAME.
  7601             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 141
* EL050.cbl
  7602             20  CL-INSURED-MID-INIT PIC X.
  7603
  7604     12  CL-CONTROL-BY-SSN.
  7605         16  CL-COMPANY-CD-A2        PIC X.
  7606         16  CL-SOC-SEC-NO.
  7607             20  CL-SSN-STATE        PIC XX.
  7608             20  CL-SSN-ACCOUNT      PIC X(6).
  7609             20  CL-SSN-LN3          PIC X(3).
  7610
  7611     12  CL-CONTROL-BY-CERT-NO.
  7612         16  CL-COMPANY-CD-A4        PIC X.
  7613         16  CL-CERT-NO-A4.
  7614             20  CL-CERT-A4-PRIME    PIC X(10).
  7615             20  CL-CERT-A4-SFX      PIC X.
  7616
  7617     12  CL-CONTROL-BY-CCN.
  7618         16  CL-COMPANY-CD-A5        PIC X.
  7619         16  CL-CCN-A5.
  7620             20  CL-CCN.
  7621                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7622                 24  CL-CCN-PRIME-A5 PIC X(12).
  7623             20  CL-CCN-FILLER-A5    PIC X(4).
  7624
  7625     12  CL-INSURED-PROFILE-DATA.
  7626         16  CL-INSURED-BIRTH-DT     PIC XX.
  7627         16  CL-INSURED-SEX-CD       PIC X.
  7628             88  INSURED-IS-MALE        VALUE 'M'.
  7629             88  INSURED-IS-FEMALE      VALUE 'F'.
  7630             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7631         16  CL-INSURED-OCC-CD       PIC X(6).
  7632         16  FILLER                  PIC X(5).
  7633
  7634     12  CL-PROCESSING-INFO.
  7635         16  CL-PROCESSOR-ID         PIC X(4).
  7636         16  CL-CLAIM-STATUS         PIC X.
  7637             88  CLAIM-IS-OPEN          VALUE 'O'.
  7638             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7639         16  CL-CLAIM-TYPE           PIC X.
  7640*            88  AH-CLAIM               VALUE 'A'.
  7641*            88  LIFE-CLAIM             VALUE 'L'.
  7642*            88  PROPERTY-CLAIM         VALUE 'P'.
  7643*            88  IUI-CLAIM              VALUE 'I'.
  7644*            88  GAP-CLAIM              VALUE 'G'.
  7645*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7646*            88  OTHER-CLAIM            VALUE 'O'.
  7647         16  CL-CLAIM-PREM-TYPE      PIC X.
  7648             88  SINGLE-PREMIUM         VALUE '1'.
  7649             88  O-B-COVERAGE           VALUE '2'.
  7650             88  OPEN-END-COVERAGE      VALUE '3'.
  7651         16  CL-INCURRED-DT          PIC XX.
  7652         16  CL-REPORTED-DT          PIC XX.
  7653         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7654         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7655         16  CL-LAST-PMT-DT          PIC XX.
  7656         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7657         16  CL-PAID-THRU-DT         PIC XX.
  7658         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7659         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 142
* EL050.cbl
  7660         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7661         16  CL-PMT-CALC-METHOD      PIC X.
  7662             88  CL-360-DAY-YR          VALUE '1'.
  7663             88  CL-365-DAY-YR          VALUE '2'.
  7664             88  CL-FULL-MONTHS         VALUE '3'.
  7665         16  CL-CAUSE-CD             PIC X(6).
  7666
  7667         16  CL-PRIME-CERT-NO.
  7668             20  CL-PRIME-CERT-PRIME PIC X(10).
  7669             20  CL-PRIME-CERT-SFX   PIC X.
  7670
  7671         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7672             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7673             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7674
  7675         16  CL-MICROFILM-NO         PIC X(10).
  7676         16  FILLER REDEFINES CL-MICROFILM-NO.
  7677             20  CL-BENEFIT-PERIOD   PIC 99.
  7678             20  FILLER              PIC X(8).
  7679         16  CL-PROG-FORM-TYPE       PIC X.
  7680         16  CL-LAST-ADD-ON-DT       PIC XX.
  7681
  7682         16  CL-LAST-REOPEN-DT       PIC XX.
  7683         16  CL-LAST-CLOSE-DT        PIC XX.
  7684         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7685             88  FINAL-PAID             VALUE '1'.
  7686             88  CLAIM-DENIED           VALUE '2'.
  7687             88  AUTO-CLOSE             VALUE '3'.
  7688             88  MANUAL-CLOSE           VALUE '4'.
  7689             88  BENEFITS-CHANGED       VALUE 'C'.
  7690             88  SETUP-ERRORS           VALUE 'E'.
  7691         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7692         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7693         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7694             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7695         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7696         16  FILLER                  PIC X.
  7697
  7698     12  CL-CERTIFICATE-DATA.
  7699         16  CL-CERT-ORIGIN          PIC X.
  7700             88  CERT-WAS-ONLINE        VALUE '1'.
  7701             88  CERT-WAS-CREATED       VALUE '2'.
  7702             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7703         16  CL-CERT-KEY-DATA.
  7704             20  CL-CERT-CARRIER     PIC X.
  7705             20  CL-CERT-GROUPING    PIC X(6).
  7706             20  CL-CERT-STATE       PIC XX.
  7707             20  CL-CERT-ACCOUNT.
  7708                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7709                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7710             20  CL-CERT-EFF-DT      PIC XX.
  7711
  7712     12  CL-STATUS-CONTROLS.
  7713         16  CL-PRIORITY-CD          PIC X.
  7714             88  CONFIDENTIAL-DATA      VALUE '8'.
  7715             88  HIGHEST-PRIORITY       VALUE '9'.
  7716         16  CL-SUPV-ATTN-CD         PIC X.
  7717             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 143
* EL050.cbl
  7718             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7719         16  CL-PURGED-DT            PIC XX.
  7720         16  CL-RESTORED-DT          PIC XX.
  7721         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7722         16  CL-NEXT-RESEND-DT       PIC XX.
  7723         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7724         16  CL-CRITICAL-PERIOD      PIC 99.
  7725*        16  FILLER                  PIC XX.
  7726         16  CL-LAST-MAINT-DT        PIC XX.
  7727         16  CL-LAST-MAINT-USER      PIC X(4).
  7728         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7729         16  CL-LAST-MAINT-TYPE      PIC X.
  7730             88  CLAIM-SET-UP           VALUE ' '.
  7731             88  PAYMENT-MADE           VALUE '1'.
  7732             88  LETTER-SENT            VALUE '2'.
  7733             88  MASTER-WAS-ALTERED     VALUE '3'.
  7734             88  MASTER-WAS-RESTORED    VALUE '4'.
  7735             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7736             88  FILE-CONVERTED         VALUE '6'.
  7737             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7738             88  ERROR-CORRECTION       VALUE 'E'.
  7739         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7740         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7741         16  CL-BENEFICIARY          PIC X(10).
  7742         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7743         16  CL-DENIAL-TYPE          PIC X.
  7744             88  CL-TYPE-DENIAL          VALUE '1'.
  7745             88  CL-TYPE-RESCISSION      VALUE '2'.
  7746             88  CL-TYPE-REFORMATION     VALUE '3'.
  7747             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7748             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7749         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7750         16  filler                  pic x(3).
  7751*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7752*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7753*        16  CL-RTW-DT               PIC XX.
  7754
  7755     12  CL-TRAILER-CONTROLS.
  7756         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7757             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7758             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7759             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7760         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7761         16  FILLER                  PIC XX.
  7762         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7763         16  CL-ADDRESS-TRAILER-CNT.
  7764             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7765                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7766             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7767                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7768             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7769                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7770             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7771                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7772             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7773                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7774             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7775                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 144
* EL050.cbl
  7776             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7777                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7778
  7779     12  CL-CV-REFERENCE-NO.
  7780         16  CL-CV-REFNO-PRIME       PIC X(18).
  7781         16  CL-CV-REFNO-SFX         PIC XX.
  7782
  7783     12  CL-FILE-LOCATION            PIC X(4).
  7784
  7785     12  CL-PROCESS-ERRORS.
  7786         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7787             88  NO-FATAL-ERRORS        VALUE ZERO.
  7788         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7789             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7790
  7791     12  CL-PRODUCT-CD               PIC X.
  7792
  7793     12  CL-CURRENT-KEY-DATA.
  7794         16  CL-CURRENT-CARRIER      PIC X.
  7795         16  CL-CURRENT-GROUPING     PIC X(6).
  7796         16  CL-CURRENT-STATE        PIC XX.
  7797         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7798
  7799     12  CL-ASSOCIATES               PIC X.
  7800         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7801         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7802         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7803         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7804
  7805     12  CL-ACTIVITY-CODE            PIC 99.
  7806     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7807     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7808
  7809     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7810     12  CL-LAG-REPORT-CODE          PIC 9.
  7811     12  CL-LOAN-TYPE                PIC XX.
  7812     12  CL-LEGAL-STATE              PIC XX.
  7813
  7814     12  CL-YESNOSW                  PIC X.
  7815     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7816         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7817         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7818         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7819     12  cl-insured-type             pic x.
  7820         88  cl-claim-on-primary         value 'P'.
  7821         88  cl-claim-on-co-borrower     value 'C'.
  7822     12  cl-benefit-expiration-dt    PIC XX.
  7823
  7824 01  PLAN-RECORDS.
  7825     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7826     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7827
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 145
* EL050.cbl
  7829 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7830                          ACCOUNT-MASTER REINSURANCE-RECORD
  7831                          COMM-TABLE-RECORD FORM-MASTER
  7832                          CLAIM-MASTER PLAN-RECORDS.
  7833 0000-DFHEXIT SECTION.
  7834     MOVE '9#                    $   ' TO DFHEIV0.
  7835     MOVE 'EL050' TO DFHEIV1.
  7836     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7837
  7838     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7839
  7840
  7841* EXEC CICS  HANDLE CONDITION
  7842*           ERROR    (9300-ABEND)
  7843*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7844*    END-EXEC.
  7845*    MOVE '"$.J                  ! " #00007836' TO DFHEIV0
  7846     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7848     MOVE X'2220233030303037383336' TO DFHEIV0(25:11)
  7849     CALL 'kxdfhei1' USING DFHEIV0
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7851
  7852
  7853 0000-COPY-PROCEDURE-DIV.
  7854*                          COPY ELC50PD.
  7855******************************************************************
  7856*                                                                *
  7857*                            ELC50PD                             *
  7858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7859*                            VMOD=2.188                          *
  7860*                                                                *
  7861******************************************************************
  7862*                   C H A N G E   L O G
  7863*
  7864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7865*-----------------------------------------------------------------
  7866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7867* EFFECTIVE    NUMBER
  7868*-----------------------------------------------------------------
  7869* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7870* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7871* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7872*                             2709 AND 2718
  7873* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7874* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7875* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7876* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7877* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7878*                                IS OPEN OR CNC DT < PD THRU
  7879* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7880* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7881* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7882* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7883* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7884* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7885* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7886* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 146
* EL050.cbl
  7887* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7888* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7889* 020906                   PEMA  EXPAND LOAN OFFICER
  7890* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7891* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7892* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7893* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7894* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7895* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7896* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7897* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7898* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7899* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7900* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7901* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7902* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7903* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7904* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7905* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7906* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7907* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7908* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7909* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7910* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7911* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7912* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7913* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7914* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7915*                                UPDATE VIN ON CERT TRAILER
  7916* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7917* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7918* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7919* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7920* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7921* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7922* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7923* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7924* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7925* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7926* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7927* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7928* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7929* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7930* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7931* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7932* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7933* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7934* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7935* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7936* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7937* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7938* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7939* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7940* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7941* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7942* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7943* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7944* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 147
* EL050.cbl
  7945* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7946* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7947* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7948* 032912  CR2011110200001  PEMA  AHL CHANGES
  7949* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7950* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7951* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7952* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7953* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7954* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7955* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7956* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7957* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7958* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7959* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7960* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7961* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7962* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7963* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7964* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7965* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7966* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7967* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7968* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7969* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7970* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7971* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7972* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7973* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7974* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7975* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7976*                                CERT #, ADD 2898 FORCIBLE ERROR
  7977* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7978* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7979* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7980* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7981* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7982* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7983* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7984* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7985* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7986* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7987* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7988* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7989* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7990* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7991* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7992* 100617  CR2017062000003  PEMA  New comm cap edits
  7993* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7994* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7995* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7996* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7997* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7998* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7999* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  8000* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
  8001* 092618  CR2018050200001  PEMA  Add check for open clm on issue
  8002* 021519  CR2019021100001  PEMA  Non-monthly calcs for AL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 148
* EL050.cbl
  8003* 101019  CR2019100700001  PEMA  Disallow V status with claim
  8004* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
  8005* 012220  CR2018092700002  TANA  Add edit for letter required
  8006* 012820  CR2020012800001  PEMA  ADD MIN LOAN TERM FOR EXTD TERM.
  8007* 030920  IR2020030500001  PEMA  ADD ERROR 3071 FOR MOB BUSINESS
  8008* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
  8009******************************************************************
  8010************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  8011******************************************************************
  8012
  8013     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  8014
  8015     MOVE SPACES                 TO PB-FATAL-FLAG
  8016                                    PB-FORCE-ER-CD
  8017                                    PB-WARN-ER-CD
  8018                                    PB-OUT-BAL-CD.
  8019
  8020     MOVE SPACE                  TO WS-IG-OVRD-AH
  8021                                    WS-IG-OVRD-LF
  8022                                    WS-IG-OVRD-AM
  8023                                    WS-IG-OVRD
  8024                                    WS-IG-OVRD-AH-PL
  8025                                    WS-IG-OVRD-LF-PL
  8026                                    WS-IG-OVRD-AH-BEN
  8027                                    WS-IG-OVRD-LF-BEN.
  8028
  8029******************************************************************
  8030*************       INITIALIZE COMMON ERRORS       ***************
  8031******************************************************************
  8032
  8033     MOVE +0                     TO PB-NO-OF-ERRORS.
  8034     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  8035
  8036******************************************************************
  8037
  8038     MOVE EIBDATE                TO DC-JULIAN-DATE.
  8039     SET JULIAN-TO-BIN           TO TRUE.
  8040*    MOVE 5                      TO DC-OPTION-CODE.
  8041     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8042     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8043
  8044     MOVE ZERO                   TO  SUB4.
  8045
  8046 0040-INITIALIZE-GA-BILL-DT.
  8047
  8048     ADD +1                      TO  SUB4.
  8049
  8050     IF  SUB4 GREATER THAN +5
  8051         GO TO 0050-CHECK-CNTL-FOUND.
  8052
  8053     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8054         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8055
  8056     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8057
  8058 0050-CHECK-CNTL-FOUND.
  8059
  8060     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 149
* EL050.cbl
  8061        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8062                                         WS-AH-REM-TERM-CALC
  8063                                         EC-CO-REM-TERM-CALC
  8064        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8065        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8066        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8067                                         WS-TOL-AH-CLAIM
  8068        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  8069                                         WS-TOL-AH-PREM
  8070                                         EC-CO-TOL-PREM
  8071        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8072                                         WS-TOL-AH-REFUND
  8073                                         EC-CO-TOL-REFUND
  8074        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8075                                         WS-AH-REFUND-OVS-AMT
  8076                                         EC-CO-OVR-SHT-AMT
  8077        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8078                                         WS-TOL-AH-PREM-PCT
  8079                                         EC-CO-TOL-PREM-PCT
  8080        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8081                                         WS-TOL-AH-REFUND-PCT
  8082                                         EC-CO-TOL-REFUND-PCT
  8083        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8084                                         WS-AH-REFUND-OVS-PCT
  8085                                         EC-CO-OVR-SHT-PCT
  8086        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8087        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8088        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8089        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8090        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8091        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8092        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8093        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8094        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8095        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8096        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8097        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8098                                         EC-CO-MONTH-END-DT
  8099        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8100          GO TO 0100-READ-ACCT.
  8101
  8102     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8103     MOVE SPACES                 TO CNTL-ACCESS.
  8104     MOVE '1'                    TO CNTL-REC-TYPE.
  8105     MOVE +0                     TO CNTL-SEQ-NO.
  8106
  8107     MOVE '1' TO RC-SW-1.
  8108     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8109     IF NOT CF-COMPANY-MASTER
  8110         MOVE ZEROS             TO WK-CO-TOL-PREM
  8111                                   WK-CO-TOL-CLAIM
  8112                                   WK-CO-TOL-REFUND
  8113                                   WK-REFUND-OVS-AMT
  8114                                   WK-REFUND-OVS-PCT
  8115                                   WK-CO-TOL-PREM-PCT
  8116                                   WK-CO-TOL-REFUND-PCT
  8117                                   WK-DEFAULT-APR
  8118                                   WK-CO-MAX-CAP
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 150
* EL050.cbl
  8119        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8120                                   WK-CR-R78-METHOD
  8121                                   WK-CO-REF-REJECT-SW
  8122                                   WK-CO-PREM-REJECT-SW
  8123                                   WK-REM-TRM-CALC-OPTION
  8124                                   WK-BIRTH-DATE-INPUT
  8125                                   WK-JOINT-AGE-INPUT
  8126        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8127        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8128        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8129        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8130          GO TO 0099-COMPANY-NOT-FOUND.
  8131
  8132     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8133        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8134     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8135        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8136     IF CF-CO-TOL-CAP NOT NUMERIC
  8137        MOVE +0                    TO CF-CO-TOL-CAP.
  8138     IF CF-DEFAULT-APR NOT NUMERIC
  8139        MOVE +0                    TO CF-DEFAULT-APR.
  8140
  8141     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8142     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8143     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8144     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8145     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8146     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8147     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8148     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8149     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8150     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8151     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8152     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8153
  8154     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8155          CF-CO-OVR-SHT-AMT > +0
  8156        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8157
  8158     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8159          CF-CO-OVR-SHT-PCT > +0
  8160        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8161
  8162     IF CF-VALID-REM-TRM-OPTION
  8163         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8164     ELSE
  8165         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8166
  8167     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8168     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8169     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8170     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8171
  8172     GO TO 0050-CHECK-CNTL-FOUND.
  8173
  8174 0099-COMPANY-NOT-FOUND.
  8175
  8176     MOVE ER-2616                TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 151
* EL050.cbl
  8177     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8178
  8179 0100-READ-ACCT.
  8180
  8181     MOVE SPACES                 TO DATE-RANGE-SW.
  8182
  8183     IF WK-ACCT-ADDR = ZEROS
  8184        GO TO 0102-ACCT-GETMAIN.
  8185
  8186     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8187     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8188     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8189
  8190     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8191        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8192        GO TO 0105-READ-ACCT
  8193     END-IF
  8194
  8195     IF PB-CARRIER NOT = SPACES
  8196        IF PB-CARRIER NOT = AM-VG-CARRIER
  8197           GO TO 0105-READ-ACCT.
  8198
  8199     IF PB-STATE NOT = SPACES
  8200        IF PB-STATE NOT = AM-VG-STATE
  8201           GO TO 0105-READ-ACCT.
  8202
  8203     IF PB-GROUPING NOT = SPACES
  8204        IF PB-GROUPING NOT = AM-VG-GROUPING
  8205           GO TO 0105-READ-ACCT.
  8206
  8207     MOVE 'X'                 TO DATE-RANGE-SW.
  8208
  8209     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8210        MOVE 'X'                 TO DATE-RANGE-SW
  8211        GO TO 0105-READ-ACCT.
  8212
  8213     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8214        GO TO 0105-READ-ACCT.
  8215
  8216     GO TO 0180-ACCOUNT-FOUND.
  8217
  8218 0102-ACCT-GETMAIN.
  8219     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8220     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8221
  8222 0105-READ-ACCT.
  8223     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8224     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8225     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8226     MOVE PB-STATE               TO ACCT-STATE.
  8227     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8228     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8229
  8230     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8231
  8232     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8233
  8234 0110-FIND-ACCT-TOLERANCES-LOOP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 152
* EL050.cbl
  8235     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8236
  8237     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8238        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8239        GO TO 0199-ACCT-NOT-FOUND
  8240     END-IF
  8241     IF PB-CARRIER NOT = SPACES
  8242        IF PB-CARRIER NOT = AM-VG-CARRIER
  8243           GO TO 0199-ACCT-NOT-FOUND.
  8244
  8245     IF PB-STATE NOT = SPACES
  8246        IF PB-STATE NOT = AM-VG-STATE
  8247           GO TO 0199-ACCT-NOT-FOUND.
  8248
  8249     IF PB-GROUPING NOT = SPACES
  8250        IF PB-GROUPING NOT = AM-VG-GROUPING
  8251           GO TO 0199-ACCT-NOT-FOUND.
  8252
  8253     MOVE 'X'                    TO DATE-RANGE-SW.
  8254
  8255     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8256        MOVE 'X'                 TO DATE-RANGE-SW
  8257        GO TO 0199-ACCT-NOT-FOUND.
  8258
  8259     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8260        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8261
  8262 0180-ACCOUNT-FOUND.
  8263     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8264     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8265     MOVE AM-STATE               TO PB-SV-STATE.
  8266     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8267
  8268     IF AM-CANCEL-FEE  NOT NUMERIC
  8269        MOVE ZEROS TO AM-CANCEL-FEE.
  8270
  8271     IF AM-MAX-MON-BEN NOT NUMERIC
  8272        MOVE ZEROS TO AM-MAX-MON-BEN.
  8273
  8274     IF AM-MAX-TOT-BEN NOT NUMERIC
  8275        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8276
  8277     IF AM-CLP-TOL-PCT NOT NUMERIC
  8278        MOVE +0                  TO AM-CLP-TOL-PCT
  8279     END-IF
  8280     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8281        MOVE +0                  TO AM-SPP-LEASE-COMM
  8282     END-IF
  8283     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8284        MOVE ER-2611             TO   WS-ERROR
  8285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8286
  8287     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8288        MOVE ER-2621             TO   WS-ERROR
  8289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8290
  8291     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8292        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 153
* EL050.cbl
  8293        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8294        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8295         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8296
  8297     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8298     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8299     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8300     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8301     IF AM-CLP-TOL-PCT NOT = ZEROS
  8302        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8303     END-IF
  8304     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8305        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8306     END-IF
  8307*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8308*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8309*                                   WS-ADMIN-FEES
  8310*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8311*          (SUB5 > +10)
  8312*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8313*             AND (AM-A-COM (SUB5) NUMERIC)
  8314*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8315*                + (AM-A-COM (SUB5) * 1000)
  8316*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8317*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8318*                + (AM-A-COM (SUB5) * 1000)
  8319*             END-IF
  8320*             IF AM-COM-TYP (SUB5) = 'N'
  8321*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8322*                + (AM-A-COM (SUB5) * 1000)
  8323*             END-IF
  8324*          END-IF
  8325*       END-PERFORM
  8326*    END-IF
  8327     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8328        AND (PB-ISSUE)
  8329        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8330                                    ws-cred-union-fees
  8331        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8332           (SUB5 > +10)
  8333           MOVE +0 TO WS-WK-RATE
  8334           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8335                                   'O' OR 'S')
  8336              IF (AM-A-COM (SUB5) NUMERIC)
  8337                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8338                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8339              ELSE
  8340                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8341                 IF PB-ISSUE
  8342                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8343                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8344                 ELSE
  8345                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8346                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8347                 END-IF
  8348                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8349                 MOVE ZEROS             TO WS-SUB1
  8350                                           WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 154
* EL050.cbl
  8351                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8352                 MOVE '0530'               TO CTBL-SW
  8353                 MOVE ' '                  TO WS-CTBL-READ-SW
  8354                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8355                 IF FIRST-TIME-THROUGH
  8356                    MOVE 'AA'              TO CTBL-BEN-CODE
  8357                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8358                 END-IF
  8359                 IF CTBL-TABLE-FOUND
  8360                    IF PB-ISSUE
  8361                       COMPUTE WS-COMM-CK-AMT =
  8362                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8363                    ELSE
  8364                       COMPUTE WS-COMM-CK-AMT =
  8365                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8366                    END-IF
  8367                    PERFORM 8800-GET-COMP-RATE
  8368                              THRU 8800-EXIT
  8369                 END-IF
  8370              END-IF
  8371              if am-com-typ (sub5) = 'O' or 'S'
  8372                 compute ws-cred-union-fees rounded =
  8373                    ws-cred-union-fees +
  8374                    (pb-i-ah-premium-amt * ws-wk-rate)
  8375              else
  8376                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8377                + (WS-WK-RATE * 1000)
  8378              end-if
  8379           END-IF
  8380        END-PERFORM
  8381     END-IF
  8382     IF PB-COMPANY-ID EQUAL 'CRI'
  8383         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8384
  8385     IF PB-COMPANY-ID EQUAL 'NCL'
  8386         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8387     END-IF
  8388
  8389     GO TO 0200-READ-CERT.
  8390
  8391 0199-ACCT-NOT-FOUND.
  8392
  8393     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8394
  8395     IF DATE-RANGE-SW NOT = SPACES
  8396        MOVE ER-2601             TO WS-ERROR
  8397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8398     ELSE
  8399        MOVE ER-2619             TO WS-ERROR
  8400        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8401
  8402     GO TO 9990-RETURN.
  8403
  8404 0200-READ-CERT.
  8405
  8406     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8407     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8408     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 155
* EL050.cbl
  8409     MOVE PB-SV-STATE            TO CERT-STATE.
  8410     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8411     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8412     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8413
  8414     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8415
  8416     IF CERT-WAS-NOT-FOUND
  8417        GO TO 0299-CERT-NOT-FOUND.
  8418
  8419     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8420        MOVE ER-2759             TO WS-ERROR
  8421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8422        GO TO 0298-UNLOCK-RETURN.
  8423
  8424     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8425         MOVE ER-2758            TO WS-ERROR
  8426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8427         GO TO 0298-UNLOCK-RETURN.
  8428
  8429     IF PB-ISSUE
  8430        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8431           IF CERT-WAS-CREATED-FOR-CLAIM
  8432              NEXT SENTENCE
  8433            ELSE
  8434              MOVE ER-2626       TO WS-ERROR
  8435              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8436              GO TO 0298-UNLOCK-RETURN.
  8437
  8438     IF NOT PB-CANCELLATION
  8439        GO TO 0300-CONTINUE-EDIT.
  8440
  8441     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8442     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8443     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8444     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8445     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8446     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8447
  8448     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8449     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8450     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8451     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8452     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8453     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8454     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8455     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8456     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8457
  8458     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8459     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8460     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8461     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8462     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8463     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8464     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8465
  8466     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 156
* EL050.cbl
  8467     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8468
  8469     MOVE CM-CREDIT-INTERFACE-SW-1
  8470                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8471     MOVE CM-CREDIT-INTERFACE-SW-2
  8472                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8473
  8474     IF CM-O-B-COVERAGE
  8475         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8476
  8477     IF CM-LIVES NOT NUMERIC
  8478         MOVE ZERO                TO CM-LIVES.
  8479
  8480     IF CM-BILLED NOT NUMERIC
  8481         MOVE ZERO                TO CM-BILLED.
  8482
  8483     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8484         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8485         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8486         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8487         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8488         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8489         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8490         MOVE CM-LIVES             TO PB-CI-LIVES
  8491*The next line causes a problem with my change  I dont think it is
  8492*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8493
  8494     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8495     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8496     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8497     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8498     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8499     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8500
  8501     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8502     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8503     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8504     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8505
  8506     IF CM-LIFE-COMM-PCT NUMERIC
  8507         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8508     ELSE
  8509         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8510
  8511     IF CM-AH-COMM-PCT NUMERIC
  8512         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8513     ELSE
  8514         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8515
  8516     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8517
  8518     IF CM-LOAN-APR       NOT NUMERIC
  8519           MOVE ZERO               TO CM-LOAN-APR.
  8520
  8521     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8522           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8523
  8524     IF CM-LOAN-TERM      NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 157
* EL050.cbl
  8525           MOVE ZERO               TO CM-LOAN-TERM.
  8526
  8527     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8528           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8529
  8530     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8531           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8532
  8533     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8534     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8535     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8536     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8537     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8538     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8539     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8540     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8541     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8542     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8543     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8544     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8545     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8546
  8547     IF CM-STATE = CM-SSN-STATE
  8548         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8549
  8550     IF CM-STATE NOT = CM-MEMB-STATE
  8551         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8552
  8553     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8554
  8555     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8556*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8557        IF CM-ADDL-CLP NOT NUMERIC
  8558           MOVE +0               TO CM-ADDL-CLP
  8559        END-IF
  8560        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8561        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8562           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8563        END-IF
  8564     END-IF
  8565     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8566        MOVE +0                  TO WS-ADMIN-FEES
  8567                                    WS-CSO-ADMIN-FEE
  8568                                    WS-COMM-AND-MFEE
  8569                                    WS-1ST-YR-ALLOW
  8570        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8571           (SUB5 > +10)
  8572           MOVE +0 TO WS-WK-RATE
  8573           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8574              IF (AM-A-COM (SUB5) NUMERIC)
  8575                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8576                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8577              ELSE
  8578                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8579                 IF PB-ISSUE
  8580                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8581                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8582                 ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 158
* EL050.cbl
  8583                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8584                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8585                 END-IF
  8586                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8587                 MOVE ZEROS             TO WS-SUB1
  8588                                           WS-COMMISSION
  8589                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8590                 MOVE '0530'               TO CTBL-SW
  8591                 MOVE ' '                  TO WS-CTBL-READ-SW
  8592                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8593                 IF FIRST-TIME-THROUGH
  8594                    MOVE 'AA'              TO CTBL-BEN-CODE
  8595                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8596                 END-IF
  8597                 IF CTBL-TABLE-FOUND
  8598                    IF PB-ISSUE
  8599                       COMPUTE WS-COMM-CK-AMT =
  8600                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8601                    ELSE
  8602                       COMPUTE WS-COMM-CK-AMT =
  8603                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8604                    END-IF
  8605                    PERFORM 8800-GET-COMP-RATE
  8606                              THRU 8800-EXIT
  8607                 END-IF
  8608              END-IF
  8609              IF AM-COM-TYP (SUB5) = 'I'
  8610                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8611                   + (WS-WK-RATE * 1000)
  8612              END-IF
  8613              IF AM-COM-TYP (SUB5) = 'N'
  8614                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8615                   + (WS-WK-RATE * 1000)
  8616              END-IF
  8617              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8618                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8619                   + (WS-WK-RATE * 1000)
  8620              END-IF
  8621              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8622                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8623                   + (WS-WK-RATE * 1000)
  8624              END-IF
  8625           END-IF
  8626        END-PERFORM
  8627     END-IF
  8628     GO TO 0300-CONTINUE-EDIT.
  8629
  8630 0298-UNLOCK-RETURN.
  8631      PERFORM 9250-UNLOCK-RETURN
  8632      GO TO 9990-RETURN.
  8633
  8634 0299-CERT-NOT-FOUND.
  8635
  8636     MOVE '1'                     TO CERT-STATUS-SW.
  8637
  8638     IF PB-COMPANY-ID = 'UCL'
  8639         IF WS-ERROR = ER-2799
  8640             GO TO 3000-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 159
* EL050.cbl
  8641
  8642     IF NOT PB-CANCELLATION
  8643         GO TO 0300-CONTINUE-EDIT.
  8644
  8645     MOVE ER-2726                  TO  WS-ERROR.
  8646     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8647     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8648     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8649                                    PB-CI-LF-TERM
  8650                                    PB-C-LF-REM-TERM
  8651                                    PB-CI-AH-TERM
  8652                                    PB-C-AH-REM-TERM
  8653                                    PB-CI-LF-BENEFIT-CD
  8654                                    PB-CI-LF-BENEFIT-AMT
  8655                                    PB-CI-LF-ALT-BENEFIT-AMT
  8656                                    PB-CI-LF-PREMIUM-AMT
  8657                                    PB-CI-LF-ALT-PREMIUM-AMT
  8658                                    PB-CI-AH-BENEFIT-CD
  8659                                    PB-CI-AH-BENEFIT-AMT
  8660                                    PB-CI-AH-PREMIUM-AMT
  8661                                    PB-CI-PAY-FREQUENCY
  8662                                    PB-CI-LOAN-APR
  8663                                    PB-CI-LOAN-TERM
  8664                                    PB-CI-LIFE-COMMISSION
  8665                                    PB-CI-AH-COMMISSION
  8666                                    PB-CI-CURR-SEQ
  8667                                    PB-CI-AH-CANCEL-AMT
  8668                                    PB-CI-LF-CANCEL-AMT
  8669                                    PB-CI-RATE-DEV-PCT-LF
  8670                                    PB-CI-RATE-DEV-PCT-AH
  8671                                    PB-CI-EXTENTION-DAYS
  8672                                    PB-CI-TERM-IN-DAYS
  8673                                    PB-CI-LIVES
  8674                                    PB-CI-LF-CRIT-PER
  8675                                    PB-CI-AH-CRIT-PER
  8676                                    PB-CI-ADDL-CLP
  8677                                    PB-CI-DDF-IU-RATE-UP.
  8678
  8679     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8680                                    PB-CI-AH-SETTLEMENT-DT
  8681                                    PB-CI-DEATH-DT
  8682                                    PB-CI-LF-PRIOR-CANCEL-DT
  8683                                    PB-CI-AH-PRIOR-CANCEL-DT
  8684                                    PB-CI-ENTRY-DT
  8685                                    PB-CI-LF-EXPIRE-DT
  8686                                    PB-CI-AH-EXPIRE-DT
  8687                                    PB-CI-LOAN-1ST-PMT-DT.
  8688
  8689     IF ACCOUNT-MAST-FOUND
  8690        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8691        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8692
  8693
  8694 0300-CONTINUE-EDIT.
  8695
  8696     IF PB-ISSUE
  8697        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8698            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 160
* EL050.cbl
  8699
  8700     IF PB-ISSUE
  8701        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8702            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8703
  8704     IF PB-ISSUE
  8705       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8706          (AM-NO-AH-ONLY)
  8707           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8708               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8709                   MOVE ER-2679 TO WS-ERROR
  8710                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8711
  8712     IF PB-ISSUE
  8713        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8714        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8715        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8716     ELSE
  8717        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8718        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8719        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8720
  8721     MOVE 'N'                    TO PLAN-MASTER-SW
  8722                                    PLAN-MASTER-LIFE-SW
  8723                                    FORM-MASTER-SW
  8724                                    WS-APP-CERT-SW.
  8725
  8726     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8727                                    WS-PL-TOL-LF-REFUND
  8728                                    WS-PL-REF-OVS-AMT
  8729                                    WS-PL-TOL-LF-PREM-PCT
  8730                                    WS-PL-TOL-LF-REFUND-PCT
  8731                                    WS-PL-REF-OVS-PCT
  8732                                    WS-PL-TOL-LF-CLAIM.
  8733
  8734     IF PB-COMPANY-ID = 'NCL'
  8735       IF PB-ISSUE
  8736         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8737             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8738             IF FORM-MASTER-FOUND
  8739                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8740
  8741     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8742        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8743
  8744********************** MON CODE **********************
  8745     IF PB-COMPANY-ID = 'MON'
  8746     IF PB-ISSUE
  8747     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8748        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8749             PB-I-LOAN-APR = ZERO)
  8750               MOVE 14.0         TO PB-I-LOAN-APR.
  8751******************************************************
  8752
  8753     IF PB-COMPANY-ID = 'NCL'
  8754       IF PB-ISSUE
  8755           IF FORM-MASTER-FOUND
  8756             IF FO-DISMEMBERMENT-CD = 'Y'  AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 161
* EL050.cbl
  8757                AM-DISMBR-COVERAGE
  8758                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8759                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8760                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8761                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8762                                           PB-I-LIFE-BENEFIT-CD.
  8763
  8764     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8765
  8766     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8767         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8768         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8769         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8770         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8771         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8772           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8773             GO TO 0301-LIFE-BENEFIT-SEARCH
  8774         ELSE
  8775             NEXT SENTENCE
  8776     ELSE
  8777         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8778
  8779     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8780     MOVE '4'                    TO CNTL-REC-TYPE.
  8781     MOVE +0                     TO CNTL-SEQ-NO.
  8782     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8783
  8784     MOVE '1' TO RC-SW-2.
  8785     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8786
  8787     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8788        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8789         GO TO 0305-BENEFIT-NOT-FOUND.
  8790
  8791     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8792
  8793 0301-LIFE-BENEFIT-SEARCH.
  8794
  8795     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8796
  8797     IF NO-BENEFIT-FOUND
  8798        GO TO 0305-BENEFIT-NOT-FOUND.
  8799
  8800     IF WS-BEN-CD = '99'
  8801        GO TO 0305-BENEFIT-NOT-FOUND.
  8802
  8803     IF PB-COMPANY-ID = 'NCL'
  8804         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8805             GO TO 0304-LIFE-BENEFIT-FOUND.
  8806
  8807     MOVE +1                     TO SUB5.
  8808     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8809
  8810* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8811* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8812     IF PB-COMPANY-ID = 'DMD'
  8813         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8814
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 162
* EL050.cbl
  8815 0302-EDIT-ACCT-LF-BENEFITS.
  8816
  8817     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8818        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8819           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8820                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8821           GO TO 03XX-GET-LIFE-ERPLAN.
  8822
  8823     IF SUB5 LESS THAN +20
  8824        ADD +1                   TO SUB5
  8825        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8826
  8827     MOVE +1                     TO SUB5.
  8828
  8829     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8830        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8831
  8832 0303-EDIT-DMD-EXTRA-BENEFITS.
  8833
  8834     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8835        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8836           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8837                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8838           GO TO 03XX-GET-LIFE-ERPLAN.
  8839
  8840     IF SUB5 LESS THAN +30
  8841        ADD +1                   TO SUB5
  8842        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8843
  8844     MOVE +1                     TO SUB5.
  8845
  8846 03XX-EDIT-FOR-NINETY-LF.
  8847
  8848***************************************************************
  8849*                                                             *
  8850*    NINETY BENEFIT PLAN TYPES:                               *
  8851*                                                             *
  8852*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8853*      92 = ALL GROUP REDUCING BENEFITS                       *
  8854*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8855*      94 = ALL GROUP LEVEL BENEFITS                          *
  8856*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8857*           BENEFIT CONTROLS.                                 *
  8858*      99 = ALL BENEFITS                                      *
  8859*                                                             *
  8860***************************************************************
  8861
  8862     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8863                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8864
  8865     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8866       AND
  8867        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8868        GO TO 03XX-GET-LIFE-ERPLAN.
  8869
  8870     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8871       AND
  8872        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 163
* EL050.cbl
  8873        IF CF-REDUCING (SUB3)
  8874           IF (PB-I-INDV-GRP-OVRD = 'I')
  8875              OR
  8876           ((AM-IG = '1') AND
  8877           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8878              OR
  8879           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8880           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8881           (AM-IG NOT = '2'))
  8882              GO TO 03XX-GET-LIFE-ERPLAN.
  8883
  8884     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8885       AND
  8886        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8887        IF CF-REDUCING (SUB3)
  8888           IF (PB-I-INDV-GRP-OVRD = 'G')
  8889              OR
  8890           ((AM-IG = '2') AND
  8891           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8892              OR
  8893           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8894           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8895           (AM-IG NOT = '1'))
  8896              GO TO 03XX-GET-LIFE-ERPLAN.
  8897
  8898     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8899       AND
  8900        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8901        IF CF-LEVEL    (SUB3)
  8902           IF (PB-I-INDV-GRP-OVRD = 'I')
  8903              OR
  8904           ((AM-IG = '1') AND
  8905           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8906              OR
  8907           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8908           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8909            (AM-IG NOT = '2'))
  8910              GO TO 03XX-GET-LIFE-ERPLAN.
  8911
  8912     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8913       AND
  8914        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8915        IF CF-LEVEL    (SUB3)
  8916           IF (PB-I-INDV-GRP-OVRD = 'G')
  8917              OR
  8918           ((AM-IG = '2') AND
  8919           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8920              OR
  8921           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8922           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8923           (AM-IG NOT = '1'))
  8924              GO TO 03XX-GET-LIFE-ERPLAN.
  8925
  8926     IF SUB5 LESS THAN +20
  8927        ADD +1                   TO SUB5
  8928        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8929
  8930     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 164
* EL050.cbl
  8931
  8932     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8933        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8934
  8935     MOVE +1                     TO SUB5.
  8936
  8937 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8938
  8939     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8940                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8941
  8942     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8943       AND
  8944        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8945        GO TO 03XX-GET-LIFE-ERPLAN.
  8946
  8947     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8948       AND
  8949        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8950        IF CF-REDUCING (SUB3)
  8951           IF (PB-I-INDV-GRP-OVRD = 'I')
  8952              OR
  8953           ((AM-IG = '1') AND
  8954           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8955              OR
  8956           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8957           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8958           (AM-IG NOT = '2'))
  8959              GO TO 03XX-GET-LIFE-ERPLAN.
  8960
  8961     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8962       AND
  8963        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8964        IF CF-REDUCING (SUB3)
  8965           IF (PB-I-INDV-GRP-OVRD = 'G')
  8966              OR
  8967           ((AM-IG = '2') AND
  8968           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8969              OR
  8970           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8971           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8972           (AM-IG NOT = '1'))
  8973              GO TO 03XX-GET-LIFE-ERPLAN.
  8974
  8975     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8976       AND
  8977        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8978        IF CF-LEVEL    (SUB3)
  8979           IF (PB-I-INDV-GRP-OVRD = 'I')
  8980              OR
  8981           ((AM-IG = '1') AND
  8982           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8983              OR
  8984           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8985           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8986            (AM-IG NOT = '2'))
  8987              GO TO 03XX-GET-LIFE-ERPLAN.
  8988
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 165
* EL050.cbl
  8989     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8990       AND
  8991        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8992        IF CF-LEVEL    (SUB3)
  8993           IF (PB-I-INDV-GRP-OVRD = 'G')
  8994              OR
  8995           ((AM-IG = '2') AND
  8996           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8997              OR
  8998           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8999           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9000           (AM-IG NOT = '1'))
  9001              GO TO 03XX-GET-LIFE-ERPLAN.
  9002
  9003     IF SUB5 LESS THAN +30
  9004        ADD +1                   TO SUB5
  9005        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  9006
  9007     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9008
  9009 03XX-EDIT-FOR-NINETY-LF-CONT.
  9010
  9011     MOVE +99                    TO SUB5.
  9012
  9013     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9014        IF PB-ISSUE
  9015           MOVE ER-1924          TO  WS-ERROR
  9016           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9017
  9018     GO TO 0304-LIFE-BENEFIT-FOUND.
  9019
  9020 03XX-GET-LIFE-ERPLAN.
  9021
  9022     IF WK-PLAN-ADDR EQUAL +0
  9023        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  9024
  9025     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9026     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9027     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9028     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  9029     MOVE 'Y'                    TO PLAN-MASTER-SW
  9030                                    PLAN-MASTER-LIFE-SW.
  9031     GO TO XXXX-CHECK-LF-PLAN-KEY.
  9032
  9033 03XX-ERPLAN-LIFE-GETMAIN.
  9034
  9035     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9036     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9037
  9038 03XX-ERPLAN-LIFE-READ.
  9039
  9040     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9041     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9042     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9043     MOVE PB-SV-STATE            TO PLAN-STATE.
  9044     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9045     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9046     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 166
* EL050.cbl
  9047     MOVE WS-SAVE-BENEFIT-REVISION
  9048                                 TO PLAN-REVISION-NO.
  9049
  9050     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9051     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9052
  9053     IF PB-COMPANY-ID = 'NCL'
  9054       IF NOT LF-PLAN-MASTER-FOUND
  9055         IF NOT PB-POLICY-IS-DECLINED  AND
  9056            NOT PB-POLICY-IS-VOIDED
  9057             MOVE  ER-1921         TO  WS-ERROR
  9058             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9059             GO TO 0304-LIFE-BENEFIT-FOUND.
  9060
  9061     IF NOT LF-PLAN-MASTER-FOUND
  9062        GO TO 0304-LIFE-BENEFIT-FOUND.
  9063
  9064 XXXX-CHECK-LF-PLAN-KEY.
  9065
  9066     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9067        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9068        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9069        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9070        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9071        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9072        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9073        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9074        MOVE 'N'                 TO PLAN-MASTER-SW
  9075          GO TO 03XX-ERPLAN-LIFE-READ.
  9076
  9077     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9078
  9079     IF  PB-CANCELLATION
  9080         GO TO  0303-LF-ACCT-BEN-FOUND.
  9081
  9082     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9083        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9084           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9085           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9086              MOVE ER-2644             TO WS-ERROR
  9087              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9088           ELSE
  9089              NEXT SENTENCE
  9090        ELSE
  9091           IF PB-COMPANY-ID NOT = 'NCL'
  9092              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9093                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9094
  9095 0303-LF-ACCT-BEN-FOUND.
  9096
  9097     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9098
  9099     IF PL-DEV-CODE NOT = SPACES
  9100        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9101
  9102     IF PL-DEV-PCT NUMERIC AND
  9103        PL-DEV-PCT NOT = ZEROS
  9104        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 167
* EL050.cbl
  9105
  9106     IF PL-TOL-PREM-AMT GREATER THAN +0
  9107        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9108
  9109     IF PL-TOL-REF-AMT GREATER THAN +0
  9110        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9111
  9112     IF PL-TOL-PREM-PCT GREATER THAN +0
  9113        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9114
  9115     IF PL-TOL-REF-PCT GREATER THAN +0
  9116        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9117
  9118     IF PL-TOL-CLM-AMT GREATER THAN +0
  9119        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9120
  9121     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9122                          PL-OVER-SHORT-AMT > +0
  9123        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9124
  9125     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9126                          PL-OVER-SHORT-PCT > +0
  9127        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9128
  9129     IF PL-SALES-TAX NUMERIC AND
  9130                          PL-SALES-TAX > +0
  9131         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9132
  9133     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9134        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9135                                    WS-IG-OVRD-AM.
  9136
  9137 0304-LIFE-BENEFIT-FOUND.
  9138
  9139     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9140
  9141     IF PB-ISSUE
  9142        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9143     ELSE
  9144        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9145
  9146     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9147     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9148     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9149     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9150     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9151                                         WS-LF-REFUND-CALC.
  9152     if (ws-lf-earnings-calc = '5')
  9153        and (pb-i-loan-apr = zeros)
  9154        and (benefit-code-chg)
  9155        move +99.9999 to pb-i-loan-apr
  9156     end-if
  9157
  9158     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9159        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9160
  9161     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9162        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 168
* EL050.cbl
  9163     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9164
  9165     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9166     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9167     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9168     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9169     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9170     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9171
  9172     IF PB-COMPANY-ID = 'NCL'  AND
  9173        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9174         NEXT SENTENCE
  9175     ELSE
  9176         IF SUB5 NOT GREATER THAN +20
  9177            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9178               MOVE WS-SAVE-BENEFIT-REM-TERM
  9179                                      TO WS-AM-LF-BENE-REM-TERM
  9180                                         EC-BR-LF-REM-TERM-CALC.
  9181
  9182     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9183     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9184
  9185     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9186
  9187 0305-BENEFIT-NOT-FOUND.
  9188
  9189     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9190     MOVE ER-2604                TO WS-ERROR.
  9191     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9192
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 169
* EL050.cbl
  9194
  9195 0310-FIND-AH-BENEFIT-RECORD.
  9196
  9197     MOVE 'N'                    TO PLAN-MASTER-SW
  9198                                    PLAN-MASTER-AH-SW.
  9199
  9200     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9201                                    WS-PL-TOL-AH-REFUND
  9202                                    WS-AH-PL-REF-OVS-AMT
  9203                                    WS-PL-TOL-AH-PREM-PCT
  9204                                    WS-PL-TOL-AH-REFUND-PCT
  9205                                    WS-AH-PL-REF-OVS-PCT
  9206                                    WS-PL-TOL-AH-CLAIM.
  9207     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9208
  9209
  9210     if pb-issue
  9211        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9212           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9213        end-if
  9214        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9215           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9216           GO TO 0399-BENEFIT-NOT-FOUND
  9217        end-if
  9218     end-if
  9219
  9220     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9221        GO TO 0400-FIND-CARRIER.
  9222
  9223     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9224
  9225     IF WK-AH-BEN-ADDR NOT = ZEROS
  9226         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9227         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9228         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9229         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9230           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9231             GO TO 0311-AH-BENEFIT-SEARCH
  9232         ELSE
  9233             NEXT SENTENCE
  9234     ELSE
  9235         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9236
  9237     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9238     MOVE '5'                    TO CNTL-REC-TYPE.
  9239     MOVE +0                     TO CNTL-SEQ-NO.
  9240     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9241
  9242     MOVE '2' TO RC-SW-2.
  9243     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9244
  9245     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9246        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9247          GO TO 0399-BENEFIT-NOT-FOUND.
  9248
  9249     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9250
  9251 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 170
* EL050.cbl
  9252
  9253     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9254
  9255     IF NO-BENEFIT-FOUND
  9256         GO TO 0399-BENEFIT-NOT-FOUND.
  9257
  9258     IF WS-BEN-CD = '99'
  9259        GO TO 0399-BENEFIT-NOT-FOUND.
  9260
  9261     IF PB-COMPANY-ID  =  'NCL'
  9262         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9263             GO TO 0314-A-H-BENEFIT-FOUND.
  9264
  9265     MOVE +1                     TO SUB5.
  9266     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9267
  9268* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9269* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9270     IF PB-COMPANY-ID = 'DMD'
  9271         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9272
  9273 0312-EDIT-ACCT-AH-BENEFITS.
  9274
  9275     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9276        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9277           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9278                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9279           GO TO 03XX-GET-AH-ERPLAN.
  9280
  9281     IF SUB5 LESS THAN +20
  9282        ADD +1                   TO SUB5
  9283        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9284
  9285     MOVE +1                     TO SUB5.
  9286
  9287     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9288        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9289
  9290 0313-EDIT-DMD-EXTRA-BENEFITS.
  9291
  9292     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9293        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9294           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9295                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9296           GO TO 03XX-GET-AH-ERPLAN.
  9297
  9298     IF SUB5 LESS THAN +30
  9299        ADD +1                   TO SUB5
  9300        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9301
  9302     MOVE +1                     TO SUB5.
  9303
  9304 03XX-EDIT-FOR-NINETY-AH.
  9305
  9306***************************************************************
  9307*                                                             *
  9308*    NINETY BENEFIT PLAN TYPES:                               *
  9309*                                                             *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 171
* EL050.cbl
  9310*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9311*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9312*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9313*           BENEFIT CONTROLS.                                 *
  9314*      99 = ALL BENEFITS.                                     *
  9315*                                                             *
  9316***************************************************************
  9317
  9318     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9319                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9320
  9321     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9322       AND
  9323        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9324        GO TO 03XX-GET-AH-ERPLAN.
  9325
  9326     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9327       AND
  9328        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9329           IF (PB-I-INDV-GRP-OVRD = 'I')
  9330              OR
  9331           ((AM-IG = '1') AND
  9332           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9333              OR
  9334           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9335           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9336           (AM-IG NOT = '2'))
  9337              GO TO 03XX-GET-AH-ERPLAN.
  9338
  9339     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9340       AND
  9341        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9342           IF (PB-I-INDV-GRP-OVRD = 'G')
  9343              OR
  9344           ((AM-IG = '2') AND
  9345           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9346              OR
  9347           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9348           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9349           (AM-IG NOT = '1'))
  9350              GO TO 03XX-GET-AH-ERPLAN.
  9351
  9352     IF SUB5 LESS THAN +20
  9353        ADD +1                   TO SUB5
  9354        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9355
  9356     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9357        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9358
  9359     MOVE +1                    TO SUB5.
  9360
  9361 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9362
  9363     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9364                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9365
  9366     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9367       AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 172
* EL050.cbl
  9368        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9369        GO TO 03XX-GET-AH-ERPLAN.
  9370
  9371     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9372       AND
  9373        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9374           IF (PB-I-INDV-GRP-OVRD = 'I')
  9375              OR
  9376           ((AM-IG = '1') AND
  9377           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9378              OR
  9379           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9380           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9381           (AM-IG NOT = '2'))
  9382              GO TO 03XX-GET-AH-ERPLAN.
  9383
  9384     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9385       AND
  9386        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9387           IF (PB-I-INDV-GRP-OVRD = 'G')
  9388              OR
  9389           ((AM-IG = '2') AND
  9390           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9391              OR
  9392           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9393           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9394           (AM-IG NOT = '1'))
  9395              GO TO 03XX-GET-AH-ERPLAN.
  9396
  9397     IF SUB5 LESS THAN +30
  9398        ADD +1                   TO SUB5
  9399        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9400
  9401 03XX-EDIT-FOR-NINETY-AH-CONT.
  9402
  9403     MOVE +99                    TO SUB5.
  9404
  9405     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9406
  9407     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9408        IF PB-ISSUE
  9409           MOVE ER-1925          TO  WS-ERROR
  9410           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9411
  9412     GO TO 0314-A-H-BENEFIT-FOUND.
  9413
  9414 03XX-GET-AH-ERPLAN.
  9415
  9416     IF WK-PLAN-ADDR EQUAL +0
  9417         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9418
  9419     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9420     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9421     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9422     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9423     MOVE 'Y'                    TO PLAN-MASTER-SW
  9424                                    PLAN-MASTER-AH-SW.
  9425*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 173
* EL050.cbl
  9426     GO TO 03XX-ERPLAN-AH-READ.
  9427
  9428 03XX-ERPLAN-AH-GETMAIN.
  9429
  9430     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9431     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9432
  9433 03XX-ERPLAN-AH-READ.
  9434
  9435     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9436     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9437     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9438     MOVE PB-SV-STATE            TO PLAN-STATE.
  9439     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9440     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9441     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9442     MOVE WS-SAVE-BENEFIT-REVISION
  9443                                 TO PLAN-REVISION-NO.
  9444
  9445     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9446     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9447
  9448     IF PB-COMPANY-ID = 'NCL'
  9449       IF NOT AH-PLAN-MASTER-FOUND
  9450         IF NOT PB-POLICY-IS-DECLINED  AND
  9451            NOT PB-POLICY-IS-VOIDED
  9452             MOVE  ER-1922         TO  WS-ERROR
  9453             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9454             GO TO 0314-A-H-BENEFIT-FOUND.
  9455
  9456     IF NOT AH-PLAN-MASTER-FOUND
  9457        GO TO 0314-A-H-BENEFIT-FOUND.
  9458
  9459 XXXX-CHECK-AH-PLAN-KEY.
  9460
  9461     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9462        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9463        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9464        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9465        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9466        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9467        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9468        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9469        MOVE 'N'                 TO PLAN-MASTER-SW
  9470          GO TO 03XX-ERPLAN-AH-READ.
  9471
  9472     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9473
  9474     IF  PB-CANCELLATION
  9475         GO TO  0313-AH-ACCT-BEN-FOUND.
  9476
  9477     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9478       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9479          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9480          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9481             MOVE ER-2644             TO WS-ERROR
  9482             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9483          ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 174
* EL050.cbl
  9484             NEXT SENTENCE
  9485       ELSE
  9486          IF PB-COMPANY-ID NOT = 'NCL'
  9487             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9488                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9489
  9490 0313-AH-ACCT-BEN-FOUND.
  9491
  9492     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9493
  9494     IF PL-DEV-CODE NOT = SPACES
  9495        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9496
  9497     IF PL-DEV-PCT NUMERIC AND
  9498        PL-DEV-PCT NOT = ZEROS
  9499        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9500
  9501     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9502        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9503
  9504     IF PL-TOL-REF-AMT NOT EQUAL +0
  9505        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9506
  9507     IF PL-TOL-PREM-PCT GREATER THAN +0
  9508        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9509
  9510     IF PL-TOL-REF-PCT GREATER THAN +0
  9511        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9512
  9513     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9514        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9515
  9516     IF PL-OVER-SHORT-AMT NUMERIC AND
  9517                          PL-OVER-SHORT-AMT > +0
  9518        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9519
  9520     IF PL-OVER-SHORT-PCT NUMERIC AND
  9521                          PL-OVER-SHORT-PCT > +0
  9522        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9523
  9524     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9525        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9526        IF WS-IG-OVRD-AM EQUAL SPACES
  9527            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9528
  9529 0314-A-H-BENEFIT-FOUND.
  9530
  9531     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9532
  9533     IF PB-ISSUE
  9534        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9535       ELSE
  9536        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9537
  9538     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9539     if cf-maximum-benefits (sub3) numeric
  9540        move cf-maximum-benefits (sub3)
  9541                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 175
* EL050.cbl
  9542     else
  9543        move zeros               to ws-ah-max-bens
  9544     end-if
  9545     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9546     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9547     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9548                                         WS-AH-REFUND-CALC.
  9549
  9550     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9551        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9552
  9553     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9554        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9555     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9556
  9557     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9558     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9559     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9560     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9561     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9562     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9563
  9564     IF PB-COMPANY-ID = 'NCL'  AND
  9565        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9566         NEXT SENTENCE
  9567     ELSE
  9568         IF SUB5 NOT GREATER THAN +20
  9569            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9570                MOVE WS-SAVE-BENEFIT-REM-TERM
  9571                                      TO WS-AM-AH-BENE-REM-TERM
  9572                                         EC-BR-AH-REM-TERM-CALC.
  9573
  9574     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9575     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9576
  9577     GO TO 0400-FIND-CARRIER.
  9578
  9579 0399-BENEFIT-NOT-FOUND.
  9580
  9581     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9582     MOVE ER-2605                TO WS-ERROR.
  9583     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9584
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 176
* EL050.cbl
  9586
  9587 0400-FIND-CARRIER.
  9588
  9589     MOVE PB-SV-CARRIER          TO WS-CARR.
  9590
  9591     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9592     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9593     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9594     MOVE '6'                    TO CNTL-REC-TYPE.
  9595
  9596*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9597     MOVE SPACE                  TO WS-DMD-RATING-SW
  9598                                    EC-BR-DMD-RATING-SW.
  9599
  9600     MOVE '2'                    TO RC-SW-1.
  9601     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9602
  9603     IF NOT CF-CARRIER-MASTER
  9604        GO TO 0400-CARRIER-NOT-FOUND.
  9605
  9606 0400-BUILD-CARR-TOL.
  9607
  9608     IF CF-CR-TOL-PREM NUMERIC AND
  9609        CF-CR-TOL-PREM GREATER THAN +0
  9610        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9611                                    WS-TOL-AH-PREM.
  9612
  9613     IF CF-CR-TOL-REFUND NUMERIC AND
  9614        CF-CR-TOL-REFUND GREATER THAN +0
  9615        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9616                                    WS-TOL-AH-REFUND.
  9617
  9618     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9619        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9620        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9621                                    WS-AH-REFUND-OVS-AMT.
  9622
  9623     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9624        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9625        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9626                                    WS-AH-REFUND-OVS-PCT.
  9627
  9628     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9629        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9630        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9631                                    WS-TOL-AH-PREM-PCT.
  9632
  9633     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9634        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9635        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9636                                     WS-TOL-AH-REFUND-PCT.
  9637
  9638     IF CF-COMPANY-ID EQUAL 'DMD'
  9639         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9640                                    EC-BR-DMD-RATING-SW.
  9641
  9642     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9643     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 177
* EL050.cbl
  9644        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9645     END-IF
  9646     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9647        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9648     END-IF
  9649     IF WS-TOL-CLP-PCT = ZEROS
  9650        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9651     END-IF
  9652
  9653     IF WS-SPP-LEASE-COMM = ZEROS
  9654        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9655     END-IF
  9656     GO TO 0400-FIND-ERPDEF.
  9657
  9658 0400-CARRIER-NOT-FOUND.
  9659
  9660     MOVE ER-2602                TO WS-ERROR.
  9661     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9662
  9663 0400-FIND-ERPDEF.
  9664*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9665     IF (PB-COMPANY-ID = 'DCC')
  9666        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9667        CONTINUE
  9668     ELSE
  9669        GO TO 0400-FIND-ERCOMP
  9670     END-IF
  9671     MOVE ' '                    TO PDEF-MASTER-SW
  9672     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9673     MOVE PB-STATE               TO ERPDEF-STATE
  9674     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9675        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9676     END-IF
  9677     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9678     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9679     IF PB-ISSUE
  9680        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9681     ELSE
  9682        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9683     END-IF
  9684     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9685     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9686     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9687     IF PDEF-MASTER-FOUND
  9688        MOVE 'N'                 TO PDEF-MASTER-SW
  9689        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9690        IF PDEF-MASTER-FOUND
  9691           IF (ERPDEF-KEY-SAVE (1:16) =
  9692                        PD-CONTROL-PRIMARY (1:16))
  9693              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9694              CONTINUE
  9695           ELSE
  9696              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9697              IF (ERPDEF-KEY-SAVE (1:16) =
  9698                        PD-CONTROL-PRIMARY (1:16))
  9699                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9700                 CONTINUE
  9701              ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 178
* EL050.cbl
  9702                 MOVE 'N'        TO PDEF-MASTER-SW
  9703              END-IF
  9704           END-IF
  9705        END-IF
  9706        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9707     END-IF
  9708     IF PDEF-MASTER-FOUND
  9709        IF PD-TRUNCATED = 'Y'
  9710           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9711        END-IF
  9712     END-IF
  9713     .
  9714 0400-FIND-ERCOMP.
  9715     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9716        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9717           (WS-SUB1 > +10)
  9718           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9719                 OR 'A' OR 'N'
  9720              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9721              MOVE PB-CARRIER    TO COMP-CARRIER
  9722              MOVE PB-GROUPING   TO COMP-GROUPING
  9723              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9724              MOVE AM-AGT (WS-SUB1)
  9725                                 TO COMP-FIN-RESP
  9726              MOVE 'G'           TO COMP-TYPE
  9727              PERFORM 8582-READ-COMPENSATION-MASTER
  9728                                 THRU 8582-EXIT
  9729              IF COMP-MASTER-FOUND
  9730                 IF CO-GA-INACTIVE
  9731                    MOVE ER-2763 TO WS-ERROR
  9732                    PERFORM 9900-ERROR-FORMAT
  9733                                 THRU 9900-EXIT
  9734                    MOVE +11     TO WS-SUB1
  9735                 END-IF
  9736                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9737                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9738                    MOVE ER-2788 TO WS-ERROR
  9739                    PERFORM 9900-ERROR-FORMAT
  9740                                 THRU 9900-EXIT
  9741                    MOVE +11     TO WS-SUB1
  9742                 END-IF
  9743              END-IF
  9744           END-IF
  9745        END-PERFORM
  9746     END-IF
  9747     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9748        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9749           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9750                                    WS-CLP-STATE
  9751        ELSE
  9752           MOVE SPACES           TO PB-I-CLP-STATE
  9753                                    WS-CLP-STATE
  9754        END-IF
  9755     END-IF
  9756
  9757     IF (PB-COMPANY-ID = 'DCC')
  9758        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9759        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 179
* EL050.cbl
  9760        CONTINUE
  9761     ELSE
  9762        GO TO 0400-FIND-STATE-RECORD
  9763     END-IF
  9764     MOVE SPACES                 TO WS-CLP-STATE
  9765     MOVE +0                     TO WS-BANK-FEE
  9766                                    WS-BANK-LFEE
  9767                                    WS-BANK-NOCHRGB
  9768
  9769     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9770     IF (PB-ISSUE)
  9771        AND (PB-I-BANK-NUMBER NOT =
  9772            SPACES AND ZEROS AND LOW-VALUES)
  9773        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9774     ELSE
  9775        IF (PB-CANCELLATION)
  9776           AND (PB-CI-BANK-NUMBER NOT =
  9777                SPACES AND ZEROS AND LOW-VALUES)
  9778           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9779        END-IF
  9780     END-IF
  9781     IF COMP-FIN-RESP NOT = LOW-VALUES
  9782        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9783        MOVE PB-CARRIER          TO COMP-CARRIER
  9784        MOVE PB-GROUPING         TO COMP-GROUPING
  9785        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9786        MOVE 'B'                 TO COMP-TYPE
  9787        PERFORM 8582-READ-COMPENSATION-MASTER
  9788                                 THRU 8582-EXIT
  9789        IF COMP-MASTER-FOUND
  9790           IF CO-MAX-BANK-FEE NOT NUMERIC
  9791              MOVE +0            TO CO-MAX-BANK-FEE
  9792           END-IF
  9793           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9794              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9795           END-IF
  9796           IF CO-GA-INACTIVE
  9797              MOVE ER-2763       TO WS-ERROR
  9798              PERFORM 9900-ERROR-FORMAT
  9799                                 THRU 9900-EXIT
  9800           END-IF
  9801           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9802              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9803              MOVE ER-2788 TO WS-ERROR
  9804              PERFORM 9900-ERROR-FORMAT
  9805                                 THRU 9900-EXIT
  9806              MOVE +11     TO WS-SUB1
  9807           END-IF
  9808           IF WS-AH-BEN-CATEGORY = 'G'
  9809              MOVE CO-MAX-BANK-FEE
  9810                                 TO WS-BANK-FEE
  9811                                    PB-I-BANK-FEE
  9812           ELSE
  9813              MOVE CO-MAX-BANK-FEE-LEASE
  9814                                 TO WS-BANK-LFEE
  9815                                    PB-I-BANK-FEE
  9816           END-IF
  9817           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 180
* EL050.cbl
  9818              AND (WS-AH-REFUND-CALC = 'G'))
  9819                        OR
  9820              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9821              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9822              CONTINUE
  9823           ELSE
  9824              MOVE ER-2789 TO WS-ERROR
  9825              PERFORM 9900-ERROR-FORMAT
  9826                                 THRU 9900-EXIT
  9827           END-IF
  9828           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9829                                    PB-I-CLP-STATE
  9830           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9831           MOVE CO-CARRIER       TO BXRF-CARRIER
  9832           MOVE CO-GROUPING      TO BXRF-GROUPING
  9833           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9834           MOVE BXRF-MAX-REC-LENGTH
  9835                                 TO BXRF-REC-LENGTH
  9836           PERFORM 8584-READ-BANK-CROSS-REF
  9837                                 THRU 8584-EXIT
  9838           IF BXRF-MASTER-FOUND
  9839              MOVE ' '           TO BANK-ACCT-SW
  9840              MOVE BK-BANK-POINTER-CNT
  9841                                 TO BK-BANK-POINTER-CNT
  9842              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9843                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9844                 OR (BANK-ACCT-FOUND)
  9845                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9846                    AND (BK-AM-EXP-DT (WS-SUB1)
  9847                                 > PB-CERT-EFF-DT)
  9848                    AND (BK-AM-EFF-DT (WS-SUB1)
  9849                                 NOT > PB-CERT-EFF-DT)
  9850                    SET BANK-ACCT-FOUND TO TRUE
  9851                 END-IF
  9852              END-PERFORM
  9853              IF NOT BANK-ACCT-FOUND
  9854                 MOVE ZEROS      TO WS-BANK-FEE
  9855                                    WS-BANK-LFEE
  9856                 MOVE ER-2869    TO WS-ERROR
  9857                 PERFORM 9900-ERROR-FORMAT
  9858                                 THRU 9900-EXIT
  9859              ELSE
  9860                 PERFORM 5000-PROCESS-REPS
  9861                                 THRU 5000-EXIT
  9862                 IF AGENT-MASTER-FOUND
  9863                    MOVE +0      TO WS-BANK-FEE
  9864                                    WS-BANK-LFEE
  9865*                   MOVE AG-SPP-FEES (1)
  9866*                                TO PB-I-BANK-FEE
  9867*                                   WS-BANK-FEE
  9868                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9869                       (WS-SUB1 > +10)
  9870                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9871                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9872                       END-IF
  9873                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9874                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9875                       END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 181
* EL050.cbl
  9876                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9877                          AG-SPP-FEES (WS-SUB1)
  9878                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9879                          AG-SPP-LFEES (WS-SUB1)
  9880                    END-PERFORM
  9881                    IF WS-AH-BEN-CATEGORY = 'G'
  9882                       MOVE WS-BANK-FEE
  9883                                 TO PB-I-BANK-FEE
  9884                    ELSE
  9885                       MOVE WS-BANK-LFEE
  9886                                 TO PB-I-BANK-FEE
  9887                    END-IF
  9888                 END-IF
  9889              END-IF
  9890           END-IF
  9891        ELSE
  9892           MOVE ER-2879          TO WS-ERROR
  9893           PERFORM 9900-ERROR-FORMAT
  9894                                 THRU 9900-EXIT
  9895        END-IF
  9896     ELSE
  9897        MOVE ER-2879             TO WS-ERROR
  9898        PERFORM 9900-ERROR-FORMAT
  9899                                 THRU 9900-EXIT
  9900     END-IF
  9901     IF WS-AH-BEN-CATEGORY = 'G'
  9902        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9903        + WS-BANK-FEE
  9904     ELSE
  9905        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9906        + WS-BANK-LFEE
  9907     END-IF
  9908     .
  9909 0400-FIND-STATE-RECORD.
  9910
  9911     IF WK-STATE-ADDR NOT = ZEROS
  9912         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9913         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9914         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9915         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9916         IF PB-SV-STATE = CF-STATE-CODE
  9917             GO TO 0405-CONTINUE-EDIT
  9918         ELSE
  9919             NEXT SENTENCE
  9920     ELSE
  9921         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9922
  9923     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9924     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9925     MOVE '3'                    TO CNTL-REC-TYPE.
  9926     MOVE +0                     TO CNTL-SEQ-NO.
  9927
  9928     MOVE '3'                    TO RC-SW-2.
  9929     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9930
  9931     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9932        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9933        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 182
* EL050.cbl
  9934        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9935                                    WS-TOL-AH-CLAIM
  9936                                    WS-MINIMUM-REFUND
  9937                                    WS-TOL-LF-PREM
  9938                                    WS-TOL-AH-PREM
  9939                                    WS-TOL-LF-REFUND
  9940                                    WS-TOL-AH-REFUND
  9941                                    EC-ST-TOL-PREM-PCT
  9942                                    WS-TOL-LF-PREM-PCT
  9943                                    WS-TOL-AH-PREM-PCT
  9944                                    EC-ST-TOL-REFUND-PCT
  9945                                    WS-TOL-LF-REFUND-PCT
  9946                                    WS-TOL-AH-REFUND-PCT
  9947                                    EC-ST-TOL-PREM
  9948                                    EC-ST-TOL-REFUND
  9949                                    EC-ST-FST-PMT-DAYS-MAX
  9950                                    WS-FREE-LOOK-PERIOD
  9951                                    WS-ST-LF-PREM-TAX
  9952                                    WS-ST-AH-PREM-TAX-I
  9953                                    WS-ST-AH-PREM-TAX-G
  9954                                    WS-BANK-FEE
  9955                                    WS-BANK-LFEE
  9956                                    WS-TOL-CLP-PCT
  9957                                    WS-SPP-LEASE-COMM
  9958                                    WS-INT-PERIODS
  9959                                    WS-EXTRA-PMTS
  9960        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9961                                    EC-ST-FST-PMT-DAYS-CHG
  9962                                    WS-LF-REM-TERM-CALC
  9963                                    WS-LF-REFUND-CALC
  9964                                    EC-ST-LF-REM-TERM-CALC
  9965                                    EC-ST-LF-REFUND-CALC
  9966                                    WS-AH-REM-TERM-CALC
  9967                                    WS-AH-REFUND-CALC
  9968                                    WS-LF-BEN-CATEGORY
  9969                                    WS-AH-BEN-CATEGORY
  9970                                    WS-CLP-STATE
  9971                                    WS-ST-REFUND-CLAIM-FLAG
  9972                                    WS-ST-CAUSAL-STATE
  9973                                    ws-st-agent-sig-edit
  9974                                    EC-ST-AH-REM-TERM-CALC
  9975                                    EC-ST-AH-REFUND-CALC
  9976          GO TO 0499-STATE-NOT-FOUND.
  9977
  9978     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9979
  9980 0405-CONTINUE-EDIT.
  9981
  9982     IF (PB-COMPANY-ID <> 'AHL')
  9983        and (pb-issue)
  9984        MOVE +0                  TO SUB3
  9985        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9986        IF SUB3 > +0
  9987           MOVE ER-3270          TO WS-ERROR
  9988           PERFORM 9900-ERROR-FORMAT
  9989                                 THRU 9900-EXIT
  9990        else
  9991           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 183
* EL050.cbl
  9992              MOVE ER-2722       TO WS-ERROR
  9993              PERFORM 9900-ERROR-FORMAT
  9994                                 THRU 9900-EXIT
  9995           end-if
  9996        END-IF
  9997     END-IF
  9998     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9999
 10000     IF CF-ST-TOL-CLAIM NOT = ZEROS
 10001        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
 10002                                    WS-TOL-AH-CLAIM.
 10003
 10004     IF CF-ST-REFUND-MIN NOT NUMERIC
 10005        MOVE ZEROS               TO CF-ST-REFUND-MIN.
 10006
 10007     IF CF-ST-REFUND-MIN NOT = ZEROS
 10008        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
 10009
 10010     IF CF-ST-TOL-PREM  NOT = ZEROS
 10011        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
 10012                                    WS-TOL-AH-PREM
 10013        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
 10014
 10015     IF CF-ST-TOL-REFUND NOT = ZEROS
 10016        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
 10017                                    WS-TOL-AH-REFUND
 10018        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
 10019
 10020     IF CF-ST-OVR-SHT-AMT NUMERIC AND
 10021        CF-ST-OVR-SHT-AMT GREATER THAN +0
 10022        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
 10023                                    WS-AH-REFUND-OVS-AMT
 10024                                    EC-ST-OVR-SHT-AMT.
 10025
 10026     IF CF-ST-TOL-PREM-PCT NUMERIC AND
 10027        CF-ST-TOL-PREM-PCT GREATER THAN +0
 10028        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
 10029                                    WS-TOL-LF-PREM-PCT
 10030                                    WS-TOL-AH-PREM-PCT.
 10031
 10032     IF CF-ST-TOL-REF-PCT NUMERIC AND
 10033        CF-ST-TOL-REF-PCT GREATER THAN +0
 10034        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
 10035                                    WS-TOL-LF-REFUND-PCT
 10036                                    WS-TOL-AH-REFUND-PCT.
 10037
 10038     IF CF-ST-OVR-SHT-PCT NUMERIC AND
 10039        CF-ST-OVR-SHT-PCT GREATER THAN +0
 10040        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10041                                    WS-AH-REFUND-OVS-PCT
 10042                                    EC-ST-OVR-SHT-PCT.
 10043
 10044     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10045     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10046
 10047     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10048          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10049
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 184
* EL050.cbl
 10050     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10051     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10052     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10053
 10054     IF CF-ST-LF-PREM-TAX NUMERIC
 10055        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10056     END-IF
 10057     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10058        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10059     END-IF
 10060     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10061        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10062     END-IF
 10063
 10064     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10065         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10066     END-IF.
 10067
 10068     IF CF-ST-CAUSAL-STATE > SPACES
 10069         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10070     END-IF.
 10071     if cf-st-extra-interest-periods not numeric
 10072        move zeros               to cf-st-extra-interest-periods
 10073     end-if
 10074     if cf-st-extra-payments not numeric
 10075        move zeros               to cf-st-extra-payments
 10076     end-if
 10077
 10078     move cf-st-extra-interest-periods
 10079                                 to ws-int-periods
 10080     move cf-st-extra-payments   to ws-extra-pmts
 10081     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10082     move cf-st-net-only-state   to ws-net-only-state
 10083     if cf-st-comm-cap-sl not numeric
 10084        move zeros               to cf-st-comm-cap-sl
 10085     end-if
 10086     if cf-st-comm-cap-jl not numeric
 10087        move zeros               to cf-st-comm-cap-jl
 10088     end-if
 10089     if cf-st-comm-cap-sa not numeric
 10090        move zeros               to cf-st-comm-cap-sa
 10091     end-if
 10092     if cf-st-comm-cap-ja not numeric
 10093        move zeros               to cf-st-comm-cap-ja
 10094     end-if
 10095     if cf-st-ga-comm-cap-sl not numeric
 10096        move zeros               to cf-st-ga-comm-cap-sl
 10097     end-if
 10098     if cf-st-ga-comm-cap-jl not numeric
 10099        move zeros               to cf-st-ga-comm-cap-jl
 10100     end-if
 10101     if cf-st-ga-comm-cap-sa not numeric
 10102        move zeros               to cf-st-ga-comm-cap-sa
 10103     end-if
 10104     if cf-st-ga-comm-cap-ja not numeric
 10105        move zeros               to cf-st-ga-comm-cap-ja
 10106     end-if
 10107
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 185
* EL050.cbl
 10108     if cf-st-tot-comm-cap-sl not numeric
 10109        move zeros               to cf-st-tot-comm-cap-sl
 10110     end-if
 10111     if cf-st-tot-comm-cap-jl not numeric
 10112        move zeros               to cf-st-tot-comm-cap-jl
 10113     end-if
 10114     if cf-st-tot-comm-cap-sa not numeric
 10115        move zeros               to cf-st-tot-comm-cap-sa
 10116     end-if
 10117     if cf-st-tot-comm-cap-ja not numeric
 10118        move zeros               to cf-st-tot-comm-cap-ja
 10119     end-if
 10120
 10121     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10122     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10123     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10124     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10125     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10126     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10127     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10128     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10129     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10130     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10131     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10132     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10133     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10134     IF WS-LF-BENEFIT-CD = ZEROS
 10135        GO TO 0410-CHECK-AH.
 10136
 10137     IF CF-ST-RT-CALC NOT = SPACES
 10138        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10139                                    EC-ST-LF-REM-TERM-CALC
 10140     END-IF
 10141
 10142     IF WS-LF-COVERAGE-TYPE = 'R'
 10143        IF WS-LF-EARNINGS-CALC = '5'
 10144           IF CF-ST-RF-LN-CALC > '0'
 10145              MOVE CF-ST-RF-LN-CALC
 10146                                 TO WS-LF-REFUND-CALC
 10147                                    EC-ST-LF-REFUND-CALC
 10148           END-IF
 10149        ELSE
 10150           IF CF-ST-RF-LR-CALC > '0'
 10151              MOVE CF-ST-RF-LR-CALC
 10152                                 TO WS-LF-REFUND-CALC
 10153                                    EC-ST-LF-REFUND-CALC
 10154           END-IF
 10155        END-IF
 10156     ELSE
 10157        IF CF-ST-RF-LL-CALC > '0'
 10158           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10159                                    EC-ST-LF-REFUND-CALC
 10160        END-IF
 10161     END-IF
 10162
 10163     IF CF-ST-RT-CALC NOT = SPACES
 10164        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10165                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 186
* EL050.cbl
 10166     END-IF
 10167
 10168     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10169     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10170
 10171     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10172
 10173     IF NO-BENEFIT-FOUND
 10174        GO TO 0410-CHECK-AH.
 10175
 10176     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10177        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10178                                 TO EC-ST-LF-REM-TERM-CALC
 10179                                    WS-LF-REM-TERM-CALC
 10180     END-IF
 10181
 10182     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10183        MOVE CF-ST-REFUND-CALC (SUB3)
 10184                                 TO WS-LF-REFUND-CALC
 10185                                    EC-ST-LF-REFUND-CALC
 10186     END-IF
 10187*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10188     if cf-st-extra-periods (sub3) not numeric
 10189        move zeros               to cf-st-extra-periods (sub3)
 10190     end-if
 10191     if cf-st-extra-periods (sub3) > zeros
 10192        if ws-lf-ben-category = 'P'
 10193           move cf-st-extra-periods (sub3)
 10194                                 to ws-extra-pmts
 10195        else
 10196           if ws-lf-ben-category = 'I'
 10197              move cf-st-extra-periods (sub3)
 10198                                 to ws-int-periods
 10199           end-if
 10200        end-if
 10201     end-if
 10202     .
 10203 0410-CHECK-AH.
 10204
 10205     IF WS-AH-BENEFIT-CD = ZEROS
 10206        GO TO 0500-SET-ACCOUNT.
 10207
 10208     IF CF-ST-RT-CALC NOT = SPACES
 10209        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10210                                    EC-ST-AH-REM-TERM-CALC
 10211     END-IF
 10212
 10213     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10214        IF CF-ST-RF-CP-CALC > '0'
 10215           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10216                                    EC-ST-AH-REFUND-CALC
 10217        END-IF
 10218     ELSE
 10219        IF CF-ST-RF-AH-CALC > '0'
 10220           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10221                                    EC-ST-AH-REFUND-CALC
 10222        END-IF
 10223     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 187
* EL050.cbl
 10224     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10225     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10226
 10227     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10228
 10229     IF NO-BENEFIT-FOUND
 10230        GO TO 0500-SET-ACCOUNT.
 10231
 10232     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10233        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10234                                 TO WS-AH-REM-TERM-CALC
 10235                                    EC-ST-AH-REM-TERM-CALC
 10236     END-IF
 10237
 10238     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10239        MOVE CF-ST-REFUND-CALC (SUB3)
 10240                                 TO WS-AH-REFUND-CALC
 10241                                    EC-ST-AH-REFUND-CALC
 10242     END-IF
 10243
 10244*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10245
 10246     GO TO 0500-SET-ACCOUNT.
 10247
 10248 0499-STATE-NOT-FOUND.
 10249
 10250     MOVE ER-2603                TO WS-ERROR.
 10251     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10252
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 188
* EL050.cbl
 10254
 10255 0500-SET-ACCOUNT.
 10256*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10257     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10258        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10259        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10260        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10261        MOVE '3'                 TO CNTL-REC-TYPE
 10262        MOVE +0                  TO CNTL-SEQ-NO
 10263
 10264        MOVE '3'                 TO RC-SW-2
 10265        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10266
 10267        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10268           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10269           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10270           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10271                                    WS-ST-AH-PREM-TAX-I
 10272                                    WS-ST-AH-PREM-TAX-G
 10273        ELSE
 10274           IF CF-ST-LF-PREM-TAX NUMERIC
 10275              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10276           END-IF
 10277           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10278              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10279           END-IF
 10280           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10281              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10282           END-IF
 10283        END-IF
 10284        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10285     END-IF
 10286*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10287*  FOR DCC ONLY
 10288     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10289
 10290        MOVE ' '                 TO STAT-MASTER-SW
 10291        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10292        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10293        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10294        MOVE PB-STATE            TO ELSTAT-STATE
 10295        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10296           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10297        END-IF
 10298
 10299        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10300        SET BIN-TO-GREG          TO TRUE
 10301        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10302        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10303        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10304
 10305        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10306        IF STAT-MASTER-FOUND
 10307           MOVE 'N'              TO STAT-MASTER-SW
 10308           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10309           IF STAT-MASTER-FOUND
 10310              IF (ELSTAT-KEY-SAVE (1:12) =
 10311                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 189
* EL050.cbl
 10312                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10313                    MOVE 'F'        TO STAT-MASTER-SW
 10314                 ELSE
 10315                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10316                    IF (STAT-MASTER-FOUND)
 10317                       AND (ELSTAT-KEY-SAVE (1:12) =
 10318                           SF-CONTROL-PRIMARY (1:12))
 10319                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10320                       MOVE 'F'     TO STAT-MASTER-SW
 10321                    END-IF
 10322                 END-IF
 10323              END-IF
 10324           END-IF
 10325        END-IF
 10326
 10327        IF STAT-MASTER-SW = 'F'
 10328           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10329              and (sf-st-lf-prem-tax > zeros)
 10330              MOVE SF-ST-LF-PREM-TAX
 10331                                 TO WS-ST-LF-PREM-TAX
 10332           END-IF
 10333           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10334              and (sf-st-ah-prem-tax-i > zeros)
 10335              MOVE SF-ST-AH-PREM-TAX-I
 10336                                 TO WS-ST-AH-PREM-TAX-I
 10337           END-IF
 10338           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10339              and (sf-st-ah-prem-tax-g > zeros)
 10340              MOVE SF-ST-AH-PREM-TAX-G
 10341                                 TO WS-ST-AH-PREM-TAX-G
 10342           END-IF
 10343        END-IF
 10344     END-IF
 10345     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10346        AND (PB-ISSUE)
 10347        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10348        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10349        AND (AM-GPCD = 06)
 10350        MOVE 'Y'                 TO WS-GOOD-HIN
 10351        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10352           MOVE PB-I-VIN         TO WS-WORK-VIN
 10353           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10354              (V1 > 16)
 10355              IF WS-WORK-VIN (V1:1) NUMERIC
 10356                 MOVE WS-WORK-VIN-N (V1)
 10357                                 TO WS-ROW-B-VAL (V1)
 10358              ELSE
 10359                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10360                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10361                    OR (V2 > 26)
 10362                 END-PERFORM
 10363                 IF V2 < 27
 10364                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10365                 ELSE
 10366                    MOVE 'N'     TO WS-GOOD-HIN
 10367                 END-IF
 10368              END-IF
 10369              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 190
* EL050.cbl
 10370                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10371              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10372                 WS-ROW-D-VAL (V1)
 10373           END-PERFORM
 10374           MOVE ZEROS            TO WS-VIN-REMAINDER
 10375           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10376             REMAINDER WS-VIN-REMAINDER
 10377           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10378              CONTINUE
 10379           ELSE
 10380              MOVE 'N'           TO WS-GOOD-HIN
 10381           END-IF
 10382        ELSE
 10383           MOVE 'N'              TO WS-GOOD-HIN
 10384        END-IF
 10385        IF WS-GOOD-HIN NOT = 'Y'
 10386           MOVE ER-3826           TO WS-ERROR
 10387           PERFORM 9900-ERROR-FORMAT
 10388                                 THRU 9900-EXIT
 10389        END-IF
 10390     END-IF
 10391     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10392        AND (PB-ISSUE)
 10393        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10394        AND (AM-GPCD NOT = 06)
 10395        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10396           perform 3400-edit-vin thru 3400-exit
 10397        ELSE
 10398          MOVE ER-3826           TO WS-ERROR
 10399          PERFORM 9900-ERROR-FORMAT
 10400                                 THRU 9900-EXIT
 10401        END-IF
 10402     END-IF
 10403     if (pb-company-id = 'CID')
 10404        and (pb-issue)
 10405        and (pb-i-vin not = spaces and low-values and zeros)
 10406        perform 3400-edit-vin    thru 3400-exit
 10407     end-if
 10408******************************************************************
 10409******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10410******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10411******* METHODS.
 10412******************************************************************
 10413     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10414        IF PB-CANCELLATION
 10415           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10416              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10417                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10418                IF FORM-MASTER-FOUND
 10419                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10420******************************************************************
 10421
 10422     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10423     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10424
 10425     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10426     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10427     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 191
* EL050.cbl
 10428     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10429
 10430
 10431     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10432     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10433     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10434
 10435     IF AM-LF-OB-RATE NOT NUMERIC
 10436         MOVE ZERO               TO AM-LF-OB-RATE.
 10437
 10438     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10439         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10440
 10441     IF AM-AH-OB-RATE NOT NUMERIC
 10442         MOVE ZERO               TO AM-AH-OB-RATE.
 10443
 10444     IF WS-LF-JOINT-INDICATOR = 'J'
 10445         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10446     ELSE
 10447         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10448
 10449     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10450
 10451     IF WS-IG-OVRD-AM  EQUAL SPACE
 10452         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10453
 10454     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10455         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10456                                       WS-IG-OVRD
 10457     ELSE
 10458         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10459             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10460                                       WS-IG-OVRD
 10461         ELSE
 10462             MOVE AM-IG             TO WS-IG-OVRD-AH
 10463                                       WS-IG-OVRD.
 10464
 10465     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10466         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10467                                       WS-IG-OVRD
 10468     ELSE
 10469         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10470             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10471                                       WS-IG-OVRD
 10472         ELSE
 10473             MOVE AM-IG             TO WS-IG-OVRD-LF
 10474                                       WS-IG-OVRD.
 10475
 10476     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10477     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10478     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10479     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10480*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10481     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10482                                              TO 'PRLDSFCTIA'.
 10483
 10484     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10485     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 192
* EL050.cbl
 10486     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10487     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10488
 10489     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10490     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10491     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10492     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10493     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10494     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10495     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10496
 10497     IF WS-ACCT-AH-DEV-PCT > +0
 10498        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10499     ELSE
 10500        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10501
 10502     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10503        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10504     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10505        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10506
 10507        IF AM-EARN-METHOD-L = 'S'
 10508            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10509                                        WS-LF-REFUND-CALC.
 10510
 10511        IF AM-EARN-METHOD-R = 'S'
 10512            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10513                                        WS-LF-REFUND-CALC.
 10514
 10515     IF WS-LF-COVERAGE-TYPE = 'R'
 10516         IF AM-EARN-METHOD-R = 'R'
 10517            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10518                                    WS-LF-REFUND-CALC.
 10519     IF WS-LF-COVERAGE-TYPE = 'R'
 10520         IF AM-EARN-METHOD-R = 'P'
 10521            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10522                                    WS-LF-REFUND-CALC.
 10523     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10524         IF AM-EARN-METHOD-L = 'R'
 10525            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10526                                    WS-LF-REFUND-CALC.
 10527     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10528         IF AM-EARN-METHOD-L = 'P'
 10529            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10530                                    WS-LF-REFUND-CALC.
 10531     IF WS-LF-COVERAGE-TYPE = 'R'
 10532         IF AM-EARN-METHOD-R = 'A'
 10533            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10534                                    WS-LF-REFUND-CALC.
 10535     IF WS-LF-COVERAGE-TYPE = 'R'
 10536         IF AM-EARN-METHOD-R = 'M'
 10537            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10538                                    WS-LF-REFUND-CALC.
 10539     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10540         IF AM-EARN-METHOD-L = 'A'
 10541            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10542                                    WS-LF-REFUND-CALC.
 10543     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 193
* EL050.cbl
 10544         IF AM-EARN-METHOD-L = 'M'
 10545            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10546                                    WS-LF-REFUND-CALC.
 10547
 10548     IF AM-EARN-METHOD-A = 'R'
 10549        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10550                                    WS-AH-REFUND-CALC.
 10551     IF AM-EARN-METHOD-A = 'P'
 10552        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10553                                    WS-AH-REFUND-CALC.
 10554     IF AM-EARN-METHOD-A = 'C'
 10555        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10556                                    WS-AH-REFUND-CALC.
 10557     IF AM-EARN-METHOD-A = 'A'
 10558        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10559                                    WS-AH-REFUND-CALC.
 10560     IF AM-EARN-METHOD-A = 'M'
 10561        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10562                                    WS-AH-REFUND-CALC.
 10563     IF AM-EARN-METHOD-A = 'N'
 10564        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10565                                    WS-AH-REFUND-CALC.
 10566     IF AM-EARN-METHOD-A = 'S'
 10567        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10568                                    WS-AH-REFUND-CALC.
 10569
 10570     IF AM-TOL-PREM NOT = ZEROS
 10571        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10572                                    WS-TOL-AH-PREM.
 10573
 10574     IF AM-OVR-SHT-AMT NUMERIC AND
 10575                  AM-OVR-SHT-AMT > 0
 10576        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10577                                    EC-AM-LF-OVR-SHT-AMT
 10578                                    WS-AH-REFUND-OVS-AMT
 10579                                    EC-AM-AH-OVR-SHT-AMT.
 10580
 10581     IF AM-OVR-SHT-PCT NUMERIC AND
 10582                    AM-OVR-SHT-PCT > 0
 10583        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10584                                    EC-AM-LF-OVR-SHT-PCT
 10585                                    WS-AH-REFUND-OVS-PCT
 10586                                    EC-AM-AH-OVR-SHT-PCT.
 10587
 10588     IF AM-TOL-REF-PCT NUMERIC AND
 10589                  AM-TOL-REF-PCT > 0
 10590        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10591                                    WS-TOL-AH-REFUND-PCT.
 10592
 10593     IF AM-TOL-REF  NOT = ZEROS  AND
 10594                  AM-TOL-REF NUMERIC
 10595        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10596                                    EC-AM-LF-TOL-REFUND
 10597                                    WS-TOL-AH-REFUND
 10598                                    EC-AM-AH-TOL-REFUND.
 10599
 10600     IF AM-TOL-CLM  NOT = ZEROS
 10601        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 194
* EL050.cbl
 10602                                    WS-TOL-AH-CLAIM.
 10603
 10604     IF AM-CLP-TOL-PCT NOT NUMERIC
 10605        MOVE +0                  TO AM-CLP-TOL-PCT
 10606     END-IF
 10607
 10608     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10609        MOVE +0                  TO AM-SPP-LEASE-COMM
 10610     END-IF
 10611     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10612        MOVE WS-PL-TOL-LF-PREM-PCT
 10613                                 TO WS-TOL-LF-PREM-PCT.
 10614
 10615     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10616        MOVE WS-PL-TOL-AH-PREM-PCT
 10617                                 TO WS-TOL-AH-PREM-PCT.
 10618
 10619     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10620        MOVE WS-PL-TOL-LF-REFUND-PCT
 10621                                 TO WS-TOL-LF-REFUND-PCT.
 10622
 10623     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10624        MOVE WS-PL-TOL-AH-REFUND-PCT
 10625                                 TO WS-TOL-AH-REFUND-PCT.
 10626
 10627     IF WS-PL-REF-OVS-AMT > +0
 10628        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10629
 10630     IF WS-PL-REF-OVS-PCT > +0
 10631        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10632
 10633     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10634        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10635     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10636        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10637     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10638        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10639     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10640        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10641     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10642        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10643     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10644        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10645
 10646     IF WS-AH-PL-REF-OVS-AMT > +0
 10647        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10648
 10649     IF WS-AH-PL-REF-OVS-PCT > +0
 10650        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10651
 10652     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10653     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10654
 10655     IF PB-CANCELLATION
 10656        GO TO 3000-CONTINUE-EDIT.
 10657
 10658     MOVE +1 TO SUB1.
 10659     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 195
* EL050.cbl
 10660     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10661
 10662     IF CF-COMPANY-ID = 'DMD'
 10663       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10664         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10665        ELSE
 10666         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10667
 10668  0525-FIND-ACCT-COMM.
 10669     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10670        NEXT SENTENCE
 10671      ELSE
 10672         ADD +1 TO SUB1
 10673         IF SUB1 LESS +11
 10674            GO TO 0525-FIND-ACCT-COMM
 10675          ELSE
 10676             GO TO 0550-st-comm-cap-check.
 10677
 10678     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10679     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10680                                    PB-I-LIFE-COMMISSION.
 10681***  IF PB-COMPANY-ID = 'CRI'
 10682     IF PB-PREM-ACCTNG-ONLY
 10683         GO TO 0550-st-comm-cap-check.
 10684
 10685     MOVE '0530' TO CTBL-SW.
 10686     MOVE ' '    TO WS-CTBL-READ-SW.
 10687
 10688
 10689 0530-GET-AH-COMP.
 10690     IF NO-AH-COVERAGE  OR
 10691        NO-AH-BENEFIT-MATCH
 10692           GO TO 0540-NEXT-READ-STEP.
 10693
 10694     IF AM-A-COM (SUB1) NUMERIC
 10695        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10696         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10697         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10698         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10699         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10700     ELSE
 10701          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10702          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10703          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10704          MOVE ZEROS             TO WS-SUB1
 10705                                    WS-COMMISSION
 10706          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10707          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10708          IF WS-COMMISSION > ZEROS
 10709             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10710             GO TO 0540-NEXT-READ-STEP
 10711          END-IF
 10712          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10713          IF CTBL-TABLE-FOUND
 10714             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10715                                        PB-I-AH-TERM
 10716             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10717             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 196
* EL050.cbl
 10718             GO TO 0540-NEXT-READ-STEP
 10719          ELSE
 10720             IF FIRST-TIME-THROUGH
 10721                 GO TO 0530-GET-AH-COMP
 10722             ELSE
 10723                 MOVE ER-2609                TO WS-ERROR
 10724                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10725
 10726 0540-NEXT-READ-STEP.
 10727     MOVE '0540' TO CTBL-SW.
 10728     MOVE ' '    TO WS-CTBL-READ-SW.
 10729
 10730 0540-GET-LF-COMP.
 10731     IF NO-LIFE-COVERAGE  OR
 10732        NO-LF-BENEFIT-MATCH
 10733           GO TO 0550-st-comm-cap-check.
 10734
 10735     IF WS-LF-JOINT-INDICATOR = 'J'
 10736        IF AM-J-COM (SUB1) NUMERIC
 10737           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10738           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10739           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10740           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10741           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10742        ELSE
 10743           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10744           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10745           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10746           MOVE ZEROS                TO WS-SUB1
 10747                                        WS-COMMISSION
 10748           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10749           IF WS-COMMISSION > ZEROS
 10750              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10751              GO TO 0550-st-comm-cap-check
 10752           END-IF
 10753           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10754           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10755           IF CTBL-TABLE-FOUND
 10756              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10757              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10758              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10759              GO TO 0550-st-comm-cap-check
 10760           ELSE
 10761              IF FIRST-TIME-THROUGH
 10762                  GO TO 0540-GET-LF-COMP
 10763              ELSE
 10764                  MOVE ER-2609                TO WS-ERROR
 10765                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10766                  GO TO 0550-st-comm-cap-check.
 10767
 10768     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10769        IF AM-L-COM (SUB1) NUMERIC
 10770           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10771           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10772           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10773           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10774           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10775        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 197
* EL050.cbl
 10776           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10777           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10778           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10779           MOVE ZEROS                TO WS-SUB1
 10780                                        WS-COMMISSION
 10781           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10782           IF WS-COMMISSION IS GREATER THAN ZEROS
 10783              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10784              GO TO 0550-st-comm-cap-check
 10785           END-IF
 10786           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10787           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10788           IF CTBL-TABLE-FOUND
 10789              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10790              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10791              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10792              GO TO 0550-st-comm-cap-check
 10793           ELSE
 10794              IF FIRST-TIME-THROUGH
 10795                  GO TO 0540-GET-LF-COMP
 10796              ELSE
 10797                  MOVE ER-2609                TO WS-ERROR
 10798                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10799
 10800 0550-st-comm-cap-check.
 10801
 10802     move +0                     to ws-tot-sl-wk-rate
 10803                                    ws-sl-wk-rate
 10804                                    ws-ga-sl-wk-rate
 10805                                    ws-tot-jl-wk-rate
 10806                                    ws-jl-wk-rate
 10807                                    ws-ga-jl-wk-rate
 10808                                    ws-tot-sa-wk-rate
 10809                                    ws-sa-wk-rate
 10810                                    ws-ga-sa-wk-rate
 10811                                    ws-tot-ja-wk-rate
 10812                                    ws-ja-wk-rate
 10813                                    ws-ga-ja-wk-rate
 10814     perform varying sub5 from +1 by +1 until
 10815        (sub5 > +10)
 10816        move +0                  to ws-wk-rate
 10817        if (am-gl-codes (sub5) <> 'Y')
 10818           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10819           if pb-i-lf-benefit-cd <> '  ' and '00'
 10820              move zeros         to ws-wk-rate
 10821              if (am-l-com (sub5) numeric)
 10822                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10823                 move am-l-com(sub5)
 10824                                 to ws-wk-rate
 10825              else
 10826                 move pb-company-cd to ctbl-company-cd
 10827                 move pb-i-lf-benefit-cd
 10828                                 to ctbl-ben-code
 10829                 move pb-i-lf-term  to ws-work-term
 10830                 move pb-life-override-l1
 10831                                 to ctbl-ben-type
 10832                 move zeros      to ws-sub1
 10833                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 198
* EL050.cbl
 10834                 move am-l-coma (sub5)
 10835                                 to ctbl-table
 10836                 move '0540'     to ctbl-sw
 10837                 perform 0552-get-it
 10838                                 thru 0552-exit
 10839              end-if
 10840              compute ws-tot-sl-wk-rate =
 10841                 ws-tot-sl-wk-rate + ws-wk-rate
 10842              if am-com-typ(sub5) = 'C' or 'D'
 10843                 compute ws-sl-wk-rate =
 10844                    ws-sl-wk-rate + ws-wk-rate
 10845              else
 10846                 if am-com-typ(sub5) = 'O' or 'P'
 10847                    compute ws-ga-sl-wk-rate =
 10848                       ws-ga-sl-wk-rate + ws-wk-rate
 10849                 end-if
 10850              end-if
 10851
 10852              move zeros         to ws-wk-rate
 10853              if (am-j-com (sub5) numeric)
 10854                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10855                 move am-j-com(sub5)
 10856                                 to ws-wk-rate
 10857              else
 10858                 move pb-company-cd to ctbl-company-cd
 10859                 move pb-i-lf-benefit-cd
 10860                                 to ctbl-ben-code
 10861                 move pb-i-lf-term  to ws-work-term
 10862                 move pb-life-override-l1
 10863                                 to ctbl-ben-type
 10864                 move zeros      to ws-sub1
 10865                                    ws-commission
 10866                 move am-j-coma (sub5)
 10867                                 to ctbl-table
 10868                 move '0540'     to ctbl-sw
 10869                 perform 0552-get-it
 10870                                 thru 0552-exit
 10871              end-if
 10872              compute ws-tot-jl-wk-rate =
 10873                 ws-tot-jl-wk-rate + ws-wk-rate
 10874              if am-com-typ(sub5) = 'C' or 'D'
 10875                 compute ws-jl-wk-rate =
 10876                    ws-jl-wk-rate + ws-wk-rate
 10877              else
 10878                 if am-com-typ(sub5) = 'O' or 'P'
 10879                    compute ws-ga-jl-wk-rate =
 10880                       ws-ga-jl-wk-rate + ws-wk-rate
 10881                 end-if
 10882              end-if
 10883           end-if
 10884           move zeros            to ws-wk-rate
 10885
 10886           if pb-i-ah-benefit-cd <> '  ' and '00'
 10887              if (am-a-com (sub5) numeric)
 10888                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10889                 move am-a-com(sub5)
 10890                                 to ws-wk-rate
 10891              else
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 199
* EL050.cbl
 10892                 move pb-company-cd to ctbl-company-cd
 10893                 move pb-i-ah-benefit-cd
 10894                                 to ctbl-ben-code
 10895                 move pb-i-ah-term  to ws-work-term
 10896                 move pb-ah-override-l1
 10897                                 to ctbl-ben-type
 10898                 move zeros      to ws-sub1
 10899                                    ws-commission
 10900                 move am-a-coma (sub5)
 10901                                 to ctbl-table
 10902                 move '0530'     to ctbl-sw
 10903                 perform 0552-get-it
 10904                                 thru 0552-exit
 10905              end-if
 10906              compute ws-tot-sa-wk-rate =
 10907                 ws-tot-sa-wk-rate + ws-wk-rate
 10908              if am-com-typ(sub5) = 'C' or 'D'
 10909                 compute ws-sa-wk-rate =
 10910                    ws-sa-wk-rate + ws-wk-rate
 10911              else
 10912                 if am-com-typ(sub5) = 'O' or 'P'
 10913                    compute ws-ga-sa-wk-rate =
 10914                       ws-ga-sa-wk-rate + ws-wk-rate
 10915                 end-if
 10916              end-if
 10917           end-if
 10918        end-if
 10919     end-perform
 10920
 10921     go to 0550-continue
 10922
 10923     .
 10924 0552-get-it.
 10925
 10926     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10927     MOVE ZEROS                  TO WS-SUB1
 10928                                    WS-COMMISSION
 10929     MOVE ' '                    TO WS-CTBL-READ-SW
 10930     PERFORM 8300-READ-CTBL-TABLE
 10931                                 THRU 8300-EXIT
 10932     IF FIRST-TIME-THROUGH
 10933        MOVE 'AA'                TO CTBL-BEN-CODE
 10934        PERFORM 8300-READ-CTBL-TABLE
 10935                                 THRU 8300-EXIT
 10936     END-IF
 10937     IF CTBL-TABLE-FOUND
 10938        if pb-life-override-l1 = ctbl-ben-type
 10939           move pb-i-lf-benefit-amt
 10940                                 to WS-COMM-CK-AMT
 10941        else
 10942           compute ws-comm-ck-amt =
 10943              pb-I-ah-benefit-amt * pb-i-ah-term
 10944        end-if
 10945        PERFORM 8800-GET-COMP-RATE
 10946                                 THRU 8800-EXIT
 10947     else
 10948        move zeros               to ws-wk-rate
 10949     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 200
* EL050.cbl
 10950
 10951     .
 10952 0552-exit.
 10953     exit.
 10954
 10955 0550-continue.
 10956
 10957     if ws-lf-joint-indicator = 'J'
 10958        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10959           and (ws-st-comm-cap-jl <> zeros)
 10960           MOVE ER-1956          TO WS-ERROR
 10961           PERFORM 9900-ERROR-FORMAT
 10962                                 THRU 9900-EXIT
 10963        end-if
 10964        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10965           and (ws-st-ga-comm-cap-jl <> zeros)
 10966           MOVE ER-1959          TO WS-ERROR
 10967           PERFORM 9900-ERROR-FORMAT
 10968                                 THRU 9900-EXIT
 10969        end-if
 10970        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10971           and (ws-st-tot-comm-cap-jl <> zeros)
 10972           MOVE ER-1962          TO WS-ERROR
 10973           PERFORM 9900-ERROR-FORMAT
 10974                                 THRU 9900-EXIT
 10975        end-if
 10976     else
 10977        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10978           and (ws-st-comm-cap-sl <> zeros)
 10979           MOVE ER-1955          TO WS-ERROR
 10980           PERFORM 9900-ERROR-FORMAT
 10981                                 THRU 9900-EXIT
 10982        end-if
 10983        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10984           and (ws-st-ga-comm-cap-sl <> zeros)
 10985           MOVE ER-1958          TO WS-ERROR
 10986           PERFORM 9900-ERROR-FORMAT
 10987                                 THRU 9900-EXIT
 10988        end-if
 10989        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10990           and (ws-st-tot-comm-cap-sl <> zeros)
 10991           MOVE ER-1961          TO WS-ERROR
 10992           PERFORM 9900-ERROR-FORMAT
 10993                                 THRU 9900-EXIT
 10994        end-if
 10995
 10996     if ws-ah-joint-indicator = 'J'
 10997        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10998           and (ws-st-comm-cap-ja <> zeros)
 10999           MOVE ER-1957          TO WS-ERROR
 11000           PERFORM 9900-ERROR-FORMAT
 11001                                 THRU 9900-EXIT
 11002        end-if
 11003        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 11004           and (ws-st-ga-comm-cap-ja <> zeros)
 11005           MOVE ER-1960          TO WS-ERROR
 11006           PERFORM 9900-ERROR-FORMAT
 11007                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 201
* EL050.cbl
 11008        end-if
 11009        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 11010           and (ws-st-tot-comm-cap-ja <> zeros)
 11011           MOVE ER-1963          TO WS-ERROR
 11012           PERFORM 9900-ERROR-FORMAT
 11013                                 THRU 9900-EXIT
 11014        end-if
 11015     else
 11016        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 11017           and (ws-st-comm-cap-sa <> zeros)
 11018           MOVE ER-1957          TO WS-ERROR
 11019           PERFORM 9900-ERROR-FORMAT
 11020                                 THRU 9900-EXIT
 11021        end-if
 11022        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 11023           and (ws-st-ga-comm-cap-sa <> zeros)
 11024           MOVE ER-1960          TO WS-ERROR
 11025           PERFORM 9900-ERROR-FORMAT
 11026                                 THRU 9900-EXIT
 11027        end-if
 11028        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 11029           and (ws-st-tot-comm-cap-sa <> zeros)
 11030           MOVE ER-1963          TO WS-ERROR
 11031           PERFORM 9900-ERROR-FORMAT
 11032                                 THRU 9900-EXIT
 11033        end-if
 11034     end-if
 11035     .
 11036 0560-EDIT-CONTINUE.
 11037     MOVE ZEROS                  TO WS-LF-PMF-COMM
 11038                                    WS-AH-PMF-COMM
 11039*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 11040*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11041     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11042        (SUB1 > +10)
 11043        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11044           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11045           MOVE '0530'           TO CTBL-SW
 11046           MOVE ' '              TO WS-CTBL-READ-SW
 11047           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11048           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11049           MOVE '0540'           TO CTBL-SW
 11050           MOVE ' '              TO WS-CTBL-READ-SW
 11051           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11052        END-IF
 11053     END-PERFORM
 11054     GO TO 0564-EDIT-CONTINUE
 11055     .
 11056 0561-CHECK-AH.
 11057     IF (NO-AH-COVERAGE)
 11058        OR (NO-AH-BENEFIT-MATCH)
 11059        CONTINUE
 11060     ELSE
 11061        IF (AM-A-COM (SUB1) NUMERIC)
 11062           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11063           IF (AM-COM-TYP (SUB1) = 'A')
 11064              AND (WS-AH-PMF-COMM = ZEROS)
 11065              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 202
* EL050.cbl
 11066           END-IF
 11067           CONTINUE
 11068        ELSE
 11069           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11070           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11071           MOVE PB-AH-OVERRIDE-L1
 11072                                 TO CTBL-BEN-TYPE
 11073           MOVE ZEROS            TO WS-SUB1
 11074                                    WS-COMMISSION
 11075           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11076           PERFORM 8300-READ-CTBL-TABLE
 11077                                 THRU 8300-EXIT
 11078           IF CTBL-TABLE-FOUND
 11079              IF (AM-COM-TYP (SUB1) = 'A')
 11080                 AND (WS-AH-PMF-COMM = ZEROS)
 11081                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11082                                        PB-I-AH-TERM
 11083                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11084                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11085              END-IF
 11086              CONTINUE
 11087           ELSE
 11088              IF FIRST-TIME-THROUGH
 11089                 GO TO 0561-CHECK-AH
 11090              ELSE
 11091                 MOVE ER-2609    TO WS-ERROR
 11092                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11093              END-IF
 11094           END-IF
 11095        END-IF
 11096     END-IF
 11097     .
 11098 0561-EXIT.
 11099     EXIT.
 11100 0563-CHECK-LF.
 11101     IF (NO-LIFE-COVERAGE)
 11102        OR (NO-LF-BENEFIT-MATCH)
 11103        CONTINUE
 11104     ELSE
 11105        IF WS-LF-JOINT-INDICATOR = 'J'
 11106           IF AM-J-COM (SUB1) NUMERIC
 11107              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11108              IF (AM-COM-TYP (SUB1) = 'A')
 11109                 AND (WS-LF-PMF-COMM = ZEROS)
 11110                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11111              END-IF
 11112              CONTINUE
 11113           ELSE
 11114              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11115              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11116              MOVE PB-LIFE-OVERRIDE-L1
 11117                                 TO CTBL-BEN-TYPE
 11118              MOVE ZEROS         TO WS-SUB1
 11119                                    WS-COMMISSION
 11120              MOVE AM-J-COMA (SUB1)
 11121                                 TO CTBL-TABLE
 11122              PERFORM 8300-READ-CTBL-TABLE
 11123                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 203
* EL050.cbl
 11124              IF CTBL-TABLE-FOUND
 11125                 IF (AM-COM-TYP (SUB1) = 'A')
 11126                    AND (WS-LF-PMF-COMM = ZEROS)
 11127                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11128                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11129                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11130                 END-IF
 11131                 CONTINUE
 11132              ELSE
 11133                 IF FIRST-TIME-THROUGH
 11134                    GO TO 0563-CHECK-LF
 11135                 ELSE
 11136                    MOVE ER-2609 TO WS-ERROR
 11137                    PERFORM 9900-ERROR-FORMAT
 11138                                 THRU 9900-EXIT
 11139*                   GO TO 0560-EDIT-CONTINUE
 11140                 END-IF
 11141              END-IF
 11142           END-IF
 11143        ELSE
 11144           IF AM-L-COM (SUB1) NUMERIC
 11145              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11146              IF (AM-COM-TYP (SUB1) = 'A')
 11147                 AND (WS-LF-PMF-COMM = ZEROS)
 11148                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11149              END-IF
 11150              CONTINUE
 11151           ELSE
 11152              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11153              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11154              MOVE PB-LIFE-OVERRIDE-L1
 11155                                 TO CTBL-BEN-TYPE
 11156              MOVE ZEROS         TO WS-SUB1
 11157                                    WS-COMMISSION
 11158              MOVE AM-L-COMA (SUB1)
 11159                                 TO CTBL-TABLE
 11160              PERFORM 8300-READ-CTBL-TABLE
 11161                                 THRU 8300-EXIT
 11162              IF CTBL-TABLE-FOUND
 11163                 CONTINUE
 11164              ELSE
 11165                 IF FIRST-TIME-THROUGH
 11166                    GO TO 0563-CHECK-LF
 11167                 ELSE
 11168                    MOVE ER-2609 TO WS-ERROR
 11169                    PERFORM 9900-ERROR-FORMAT
 11170                                 THRU 9900-EXIT
 11171                 END-IF
 11172              END-IF
 11173           END-IF
 11174        END-IF
 11175     END-IF
 11176     .
 11177 0563-EXIT.
 11178     EXIT.
 11179 0564-EDIT-CONTINUE.
 11180
 11181     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 204
* EL050.cbl
 11182         IF PB-I-NUM-BILLED EQUAL ZEROS
 11183            MOVE ER-8148       TO WS-ERROR
 11184            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11185
 11186*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11187*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11188*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11189*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11190*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11191*         IF NO-CONVERSION-ERROR
 11192*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11193*         ELSE
 11194*             IF PB-COMPANY-ID EQUAL 'HAN'
 11195*                 MOVE ZEROS     TO PB-I-AGE.
 11196     IF PB-I-BIRTHDAY > LOW-VALUES
 11197        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11198        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11199        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11200        PERFORM 8500-DATE-CONVERT
 11201                                 THRU 8500-EXIT
 11202        IF NO-CONVERSION-ERROR
 11203           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11204           IF PB-I-AGE > ZEROS
 11205              IF WS-WORK-AGE NOT = PB-I-AGE
 11206                 MOVE ER-9501    TO WS-ERROR
 11207                 PERFORM 9900-ERROR-FORMAT
 11208                                 THRU 9900-EXIT
 11209              END-IF
 11210           ELSE
 11211              MOVE WS-WORK-AGE   TO PB-I-AGE
 11212           END-IF
 11213        END-IF
 11214     END-IF
 11215     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11216                                   WS-INS-AGE-SET
 11217     IF PB-I-AGE = ZEROS
 11218        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11219           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11220                                   WS-INS-AGE-SET
 11221           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11222
 11223     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11224                                   WS-AH-EDIT-AGE.
 11225
 11226     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11227        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11228        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11229        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11230        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11231        IF NO-CONVERSION-ERROR
 11232           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11233           IF PB-I-JOINT-AGE > 0
 11234              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11235                 MOVE ER-9503    TO WS-ERROR
 11236                 PERFORM 9900-ERROR-FORMAT
 11237                                 THRU 9900-EXIT
 11238              END-IF
 11239           ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 205
* EL050.cbl
 11240              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11241           END-IF
 11242        ELSE
 11243           MOVE ZEROS            TO PB-I-JOINT-AGE
 11244        END-IF
 11245     END-IF
 11246     IF PB-I-JOINT-AGE NOT NUMERIC
 11247        MOVE ZERO               TO PB-I-JOINT-AGE.
 11248
 11249     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11250                                   WS-JNT-AGE-SET
 11251     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11252          or 'FNL'
 11253        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11254           (WS-AH-JOINT-INDICATOR = 'J')
 11255           IF PB-I-JOINT-AGE = ZEROS
 11256               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11257                                          WS-JNT-AGE-SET
 11258               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11259           END-IF
 11260        END-IF
 11261     END-IF
 11262
 11263     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11264     IF WS-LF-JOINT-INDICATOR = 'J'
 11265        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11266        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11267            IF  PB-I-JOINT-AGE = ZERO
 11268                MOVE ER-2686       TO WS-ERROR
 11269                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11270            ELSE
 11271                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11272                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11273                    IF PB-COMPANY-ID NOT = 'LBL'
 11274                        MOVE ER-2685    TO WS-ERROR
 11275                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11276
 11277     IF WS-AH-JOINT-INDICATOR = 'J'
 11278        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11279            IF  PB-I-JOINT-AGE = ZERO
 11280                MOVE ER-2686       TO WS-ERROR
 11281                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11282            ELSE
 11283                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11284                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11285                                           WS-EDIT-AGE
 11286                    IF PB-COMPANY-ID NOT = 'LBL'
 11287                        MOVE ER-2685    TO WS-ERROR
 11288                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11289
 11290******************************************************************
 11291*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11292******************************************************************
 11293
 11294     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11295        (WS-AH-SPECIAL-CALC-CD = 'O')
 11296        NEXT SENTENCE
 11297     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 206
* EL050.cbl
 11298        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 11299          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11300           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11301            WS-AH-JOINT-INDICATOR = 'J')  AND
 11302           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11303            MOVE ER-2627             TO WS-ERROR
 11304            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11305
 11306     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11307        (WS-AH-SPECIAL-CALC-CD = 'O')
 11308         NEXT SENTENCE
 11309     ELSE
 11310         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11311            WS-AH-JOINT-INDICATOR = 'J'
 11312             IF PB-I-JOINT-INSURED = SPACES
 11313                 IF PB-COMPANY-ID NOT = 'JAL'
 11314                     MOVE ER-2696    TO WS-ERROR
 11315                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11316
 11317     IF PB-COMPANY-ID NOT = 'BOA'
 11318        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11319           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11320           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11321               PB-I-JOINT-INSURED NOT = SPACES)
 11322                MOVE ER-2691         TO WS-ERROR
 11323                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11324
 11325     IF PB-COMPANY-ID = 'BOA'
 11326        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11327           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11328            IF PB-I-JOINT-AGE NOT = ZEROS
 11329                MOVE ER-2691         TO WS-ERROR
 11330                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11331
 11332     IF PB-COMPANY-ID = 'CRI'
 11333        IF PB-I-SIG-SW = 'J'
 11334           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11335              WS-AH-JOINT-INDICATOR NOT = 'J'
 11336              MOVE ER-2675       TO WS-ERROR
 11337              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11338
 11339     IF PB-COMPANY-ID = 'CRI'
 11340        IF PB-I-SIG-SW = 'S'
 11341           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11342              WS-AH-JOINT-INDICATOR = 'J'
 11343              MOVE ER-2676       TO WS-ERROR
 11344              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11345
 11346     IF PB-COMPANY-ID = 'CVL'
 11347         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11348            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11349              MOVE ER-2783           TO WS-ERROR
 11350              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11351     IF (WS-LF-JOINT-INDICATOR = 'J')
 11352        AND (WS-AH-JOINT-INDICATOR = 'J')
 11353        AND (PB-I-LF-TERM > 120)
 11354        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11355        MOVE ER-2783             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 207
* EL050.cbl
 11356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357     END-IF
 11358     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11359
 11360     IF PB-I-INDV-GRP-OVRD = 'I'
 11361        MOVE ER-2666             TO WS-ERROR
 11362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11363        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11364
 11365     IF PB-I-INDV-GRP-OVRD = 'G'
 11366        MOVE ER-2666             TO WS-ERROR
 11367        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11368        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11369
 11370     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11371        NEXT SENTENCE
 11372     ELSE
 11373        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11374
 11375     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11376        IF WS-ERROR = ER-2666
 11377           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11378           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11379
 11380     IF PB-COMPANY-ID = 'CID'
 11381        IF PB-STATE = 'UT' OR 'MO'
 11382           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11383                 OR '76' OR '77')
 11384                      OR
 11385               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11386                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11387                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11388                   OR '2K' OR '2L'))
 11389              AND PB-I-INDV-GRP-CD = 'I'
 11390              MOVE ER-2721             TO WS-ERROR
 11391              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11392           END-IF
 11393        END-IF
 11394     END-IF
 11395
 11396     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11397     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11398        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11399     ELSE
 11400        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11401     END-IF
 11402
 11403*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11404*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11405     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11406                                    ACCOUNT-AH-CK-SW.
 11407
 11408     IF PB-REISSUED-CERT       OR
 11409        PB-REIN-ONLY-CERT      OR
 11410        PB-POLICY-IS-DECLINED  OR
 11411        PB-POLICY-IS-VOIDED
 11412*       OR PB-MONTHLY-CERT
 11413         GO TO 3000-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 208
* EL050.cbl
 11414
 11415     IF PB-COMPANY-ID = 'CID' OR 'AHL' or 'FNL'
 11416        IF WS-EDIT-AGE           > +65
 11417           MOVE ER-2709          TO WS-ERROR
 11418           PERFORM 9900-ERROR-FORMAT
 11419                                 THRU 9900-EXIT
 11420        ELSE
 11421           IF WS-EDIT-AGE        > +55
 11422              MOVE ER-2718       TO WS-ERROR
 11423              PERFORM 9900-ERROR-FORMAT
 11424                                 THRU 9900-EXIT
 11425           END-IF
 11426        END-IF
 11427     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11428        IF WS-EDIT-AGE           > +65
 11429           MOVE ER-2709          TO WS-ERROR
 11430           PERFORM 9900-ERROR-FORMAT
 11431                                 THRU 9900-EXIT
 11432        END-IF
 11433     END-IF
 11434     .
 11435
 11436 0565-LIFE-PLAN-LIMIT-EDITS.
 11437
 11438     IF NOT LF-PLAN-MASTER-FOUND
 11439        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11440                                    EC-AM-LF-MAX-TOT-BEN
 11441        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11442
 11443     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11444
 11445     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11446         IF PL-LM-AGE (1) = ZEROS
 11447             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11448
 11449     IF NO-LF-BENEFIT-MATCH          OR
 11450        WS-LF-BENEFIT-CD = ZEROS     OR
 11451        WS-LF-SPECIAL-CALC-CD = 'M'
 11452        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11453
 11454     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11455     MOVE +1                     TO SUB2.
 11456
 11457     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11458        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11459           MOVE +5   TO SUB2
 11460           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11461              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11462              (PL-LM-AGE (SUB2) EQUAL +0)
 11463              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11464              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11465
 11466     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11467
 11468     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11469                               + PB-I-LF-ALT-BENEFIT-AMT.
 11470
 11471 0568-CHECK-LIFE-ATT-AGE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 209
* EL050.cbl
 11472
 11473     IF PL-ATT-AGE NUMERIC AND
 11474        PL-ATT-AGE > +0
 11475        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11476     END-IF
 11477*    IF PL-ATT-AGE NUMERIC AND
 11478*       PL-ATT-AGE > +0
 11479*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11480*       IF PB-I-BIRTHDAY > LOW-VALUES
 11481*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11482*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11483*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11484*          SET BIN-PLUS-ELAPSED  TO TRUE
 11485*          PERFORM 8500-DATE-CONVERT
 11486*                                THRU 8500-EXIT
 11487*          IF NO-CONVERSION-ERROR
 11488*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11489*             MOVE ER-2669       TO WS-ERROR
 11490*             PERFORM 9900-ERROR-FORMAT
 11491*                                THRU 9900-EXIT
 11492*          END-IF
 11493*       ELSE
 11494*          IF WS-ATT-AGE >= PL-ATT-AGE
 11495*             MOVE ER-2669       TO WS-ERROR
 11496*             PERFORM 9900-ERROR-FORMAT
 11497*                                THRU 9900-EXIT
 11498*          END-IF
 11499*       END-IF
 11500*    END-IF
 11501     .
 11502 0570-CHECK-LIFE-LIMITS.
 11503
 11504     IF PB-COMPANY-ID EQUAL 'CRI'
 11505        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11506           IF SUB2 GREATER THAN +4
 11507              MOVE ER-2637 TO WS-ERROR
 11508              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11509              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11510
 11511     IF PB-COMPANY-ID  =  'NCL'
 11512        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11513            SUB2 GREATER THAN +8
 11514             MOVE 'U'         TO PB-BATCH-ENTRY
 11515             MOVE ER-2637     TO WS-ERROR
 11516             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11517             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11518
 11519     IF SUB2 > +8
 11520        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11521                or 'FNL')
 11522           AND (PB-I-SIG-SW = 'Y')
 11523           CONTINUE
 11524        ELSE
 11525           MOVE ER-2637          TO WS-ERROR
 11526           PERFORM 9900-ERROR-FORMAT
 11527                                 THRU 9900-EXIT
 11528        END-IF
 11529        GO TO 0580-AH-PLAN-LIMIT-EDITS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 210
* EL050.cbl
 11530     END-IF
 11531     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11532     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11533     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11534
 11535     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11536        ADD +1  TO SUB2
 11537        GO TO 0570-CHECK-LIFE-LIMITS.
 11538
 11539     IF PB-COMPANY-ID = 'NCL'
 11540         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11541
 11542     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11543        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11544        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11545              or 'FNL')
 11546           AND (PB-I-SIG-SW = 'Y')
 11547           CONTINUE
 11548        ELSE
 11549           MOVE ER-2637          TO WS-ERROR
 11550           PERFORM 9900-ERROR-FORMAT
 11551                                 THRU 9900-EXIT
 11552        END-IF
 11553     END-IF
 11554     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11555
 11556
 11557 0570-CHECK-NCL-LIFE-LIMITS.
 11558
 11559     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11560        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11561         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11562
 11563     IF APP-CERT-USED
 11564         IF SUB2  LESS THAN  +5
 11565             MOVE +5          TO SUB2
 11566             GO TO 0570-CHECK-LIFE-LIMITS.
 11567
 11568     MOVE ER-2637             TO WS-ERROR.
 11569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11570
 11571     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11572
 11573 0575-CHECK-NCL-SIG-SWITCH.
 11574
 11575     IF NOT APP-CERT-USED
 11576         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11577
 11578     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11579        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11580        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11581        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11582         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11583
 11584     IF SUB2 GREATER THAN +4
 11585         IF PL-LM-AGE (5) = ZEROS  AND
 11586            PL-LM-AGE (6) = ZEROS  AND
 11587            PL-LM-AGE (7) = ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 211
* EL050.cbl
 11588            PL-LM-AGE (8) = ZEROS
 11589             MOVE  ER-1927        TO WS-ERROR
 11590             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11591             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11592         ELSE
 11593             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11594                 MOVE  ER-1920    TO WS-ERROR
 11595                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11596
 11597     IF PB-I-SIG-SW  = 'Y'
 11598       IF NOT PB-I-POLICY-ACCEPTED  AND
 11599          NOT PB-I-POLICY-DECLINED
 11600           MOVE 'U'               TO PB-BATCH-ENTRY
 11601           MOVE  ER-1926          TO WS-ERROR
 11602           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11603
 11604
 11605 0580-AH-PLAN-LIMIT-EDITS.
 11606
 11607     IF PB-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL'
 11608        IF PB-I-AH-BENEFIT-AMT > +1250
 11609           MOVE ER-2702          TO WS-ERROR
 11610           PERFORM 9900-ERROR-FORMAT
 11611                                 THRU 9900-EXIT
 11612        END-IF
 11613     END-IF
 11614
 11615     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11616        AND (PB-MONTHLY-CERT)
 11617        IF PB-I-AH-BENEFIT-AMT > +3000
 11618           MOVE ER-2881          TO WS-ERROR
 11619           PERFORM 9900-ERROR-FORMAT
 11620                                 THRU 9900-EXIT
 11621        END-IF
 11622     END-IF
 11623     IF NOT AH-PLAN-MASTER-FOUND
 11624        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11625        GO TO 3000-CONTINUE-EDIT.
 11626
 11627     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11628
 11629     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11630         IF PL-LM-AGE (1) = ZEROS
 11631             GO TO 3000-CONTINUE-EDIT.
 11632
 11633     IF NO-AH-BENEFIT-MATCH          OR
 11634        WS-AH-BENEFIT-CD = ZEROS     OR
 11635        WS-AH-SPECIAL-CALC-CD = 'M'
 11636        GO TO 3000-CONTINUE-EDIT.
 11637
 11638     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11639     MOVE +1                     TO SUB2.
 11640
 11641     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11642        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11643           MOVE +5 TO SUB2
 11644           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11645              (PL-LM-MOA (SUB2) EQUAL +0) AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 212
* EL050.cbl
 11646              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11647              (PL-LM-AGE (SUB2) EQUAL +0)
 11648              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11649              GO TO 3000-CONTINUE-EDIT.
 11650
 11651     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11652
 11653 0590-CHECK-AH-ATT-AGE.
 11654
 11655     IF PL-ATT-AGE NUMERIC AND
 11656        PL-ATT-AGE GREATER THAN +0
 11657        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11658     END-IF
 11659*       IF WS-ATT-AGE >= PL-ATT-AGE
 11660*          MOVE ER-3054          TO WS-ERROR
 11661*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11662     .
 11663 0597-CHECK-AH-LIMITS.
 11664
 11665     IF PB-COMPANY-ID EQUAL 'CRI'
 11666        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11667           IF SUB2 GREATER THAN +4
 11668              MOVE ER-2638       TO WS-ERROR
 11669              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11670              GO TO 3000-CONTINUE-EDIT.
 11671
 11672     IF PB-COMPANY-ID  =  'NCL'
 11673        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11674            SUB2 GREATER THAN +8
 11675             MOVE 'U'            TO PB-BATCH-ENTRY
 11676             MOVE ER-2638        TO WS-ERROR
 11677             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11678             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11679
 11680     IF SUB2 > +8
 11681        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11682               OR 'FNL')
 11683           AND (PB-I-SIG-SW = 'Y')
 11684           CONTINUE
 11685        ELSE
 11686           MOVE ER-2638          TO WS-ERROR
 11687           PERFORM 9900-ERROR-FORMAT
 11688                                 THRU 9900-EXIT
 11689        END-IF
 11690        GO TO 3000-CONTINUE-EDIT
 11691     END-IF
 11692
 11693     IF PB-COMPANY-ID = 'CRI'
 11694        IF WS-ERROR = ER-2638
 11695           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11696
 11697     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11698     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11699     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11700     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11701
 11702     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11703        ADD +1                   TO SUB2
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 213
* EL050.cbl
 11704        GO TO 0597-CHECK-AH-LIMITS.
 11705
 11706     IF PB-COMPANY-ID = 'NCL'
 11707         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11708
 11709     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11710        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11711        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11712                                 > PL-LM-AMT (SUB2))
 11713        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11714             OR 'FNL')
 11715           AND (PB-I-SIG-SW = 'Y')
 11716           CONTINUE
 11717        ELSE
 11718           MOVE ER-2638          TO WS-ERROR
 11719           PERFORM 9900-ERROR-FORMAT
 11720                                 THRU 9900-EXIT
 11721        END-IF
 11722     END-IF
 11723
 11724     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11725         IF  WS-ERROR    EQUAL    ER-2638
 11726             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11727                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11728                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11729                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11730                MOVE  ER-1910    TO  WS-ERROR
 11731                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11732
 11733     IF PB-COMPANY-ID = 'CRI'
 11734        IF WS-ERROR = ER-2638
 11735            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11736            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11737            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11738
 11739     GO TO 3000-CONTINUE-EDIT.
 11740
 11741 0597-CHECK-NCL-AH-LIMITS.
 11742
 11743     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11744        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11745        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11746                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11747         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11748
 11749     IF APP-CERT-USED
 11750         IF SUB2  LESS THAN  +5
 11751             MOVE +5             TO SUB2
 11752             GO TO 0597-CHECK-AH-LIMITS.
 11753
 11754     MOVE ER-2638                TO WS-ERROR.
 11755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11756
 11757     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11758
 11759 0599-CHECK-NCL-SIG-SWITCH.
 11760
 11761     IF NOT APP-CERT-USED
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 214
* EL050.cbl
 11762         GO TO 3000-CONTINUE-EDIT.
 11763
 11764     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11765        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11766        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11767        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11768         GO TO 3000-CONTINUE-EDIT.
 11769
 11770     IF SUB2 GREATER THAN +4
 11771         IF PL-LM-AGE (5) = ZEROS  AND
 11772            PL-LM-AGE (6) = ZEROS  AND
 11773            PL-LM-AGE (7) = ZEROS  AND
 11774            PL-LM-AGE (8) = ZEROS
 11775             MOVE  ER-1927        TO WS-ERROR
 11776             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11777             GO TO 3000-CONTINUE-EDIT
 11778         ELSE
 11779             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11780                 MOVE  ER-1920    TO WS-ERROR
 11781                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11782
 11783     IF PB-I-SIG-SW  = 'Y'
 11784       IF NOT PB-I-POLICY-ACCEPTED  AND
 11785          NOT PB-I-POLICY-DECLINED
 11786           MOVE 'U'               TO PB-BATCH-ENTRY
 11787           MOVE  ER-1926          TO WS-ERROR
 11788           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11789
 11790******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 215
* EL050.cbl
 11792
 11793 3000-CONTINUE-EDIT.
 11794
 11795     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11796     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11797     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11798     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11799     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11800
 11801     IF BROWSE-STARTED
 11802        PERFORM 9990-RETURN THRU 9990-EXIT
 11803        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11804
 11805     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11806        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11807        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11808        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11809*       MOVE 1                   TO DC-OPTION-CODE
 11810        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11811        IF DATE-CONVERSION-ERROR
 11812           MOVE ER-2622          TO WS-ERROR
 11813           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11814        ELSE
 11815           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11816              MOVE ER-2623       TO WS-ERROR
 11817              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11818           ELSE
 11819              MOVE ER-2622       TO WS-ERROR
 11820              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11821
 11822     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11823     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11824     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11825*    MOVE 1                      TO DC-OPTION-CODE.
 11826     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11827     IF DATE-CONVERSION-ERROR
 11828        GO TO 3005-EDIT-CONTINUE
 11829     ELSE
 11830        IF DC-ELAPSED-DAYS GREATER +180
 11831           MOVE ER-2613          TO WS-ERROR
 11832           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11833        ELSE
 11834           IF DC-ELAPSED-DAYS GREATER +90
 11835              MOVE ER-2612       TO WS-ERROR
 11836              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11837           ELSE
 11838             IF DC-ELAPSED-DAYS GREATER +60
 11839                MOVE ER-2614     TO WS-ERROR
 11840                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11841
 11842 3005-EDIT-CONTINUE.
 11843
 11844     IF PB-CANCELLATION
 11845         GO TO 3700-EDIT-CANCEL.
 11846
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 216
* EL050.cbl
 11848******************************************************************
 11849*                  E D I T   I S S U E                           *
 11850******************************************************************
 11851
 11852 3020-EDIT-ISSUE.
 11853
 11854      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11855      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11856      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11857      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11858      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11859
 11860     IF PB-ISSUE-FORCE
 11861        OR PB-ISSUE-DATE-FORCED
 11862        OR PB-FORCE-OFF
 11863        OR PB-OVERCHARGE-FORCE
 11864        or pb-exceeded-limit-forced
 11865        CONTINUE
 11866     ELSE
 11867        MOVE ER-2670             TO WS-ERROR
 11868        PERFORM 9900-ERROR-FORMAT
 11869                                 THRU 9900-EXIT
 11870     END-IF
 11871     .
 11872 3022-SET-POLICY-STATUS.
 11873
 11874     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11875
 11876     IF (PB-REISSUED-CERT)
 11877             OR
 11878        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11879         AND (PB-MONTHLY-CERT))
 11880         MOVE '5'                TO PB-I-ENTRY-STATUS
 11881         MOVE 'E'                TO PB-BATCH-ENTRY
 11882     END-IF
 11883
 11884     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11885        IF PB-MONTHLY-CERT
 11886           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11887        END-IF
 11888        IF PB-CASH-CERT
 11889           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11890        END-IF
 11891     END-IF
 11892     IF PB-POLICY-IS-DECLINED
 11893         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11894     IF PB-POLICY-IS-VOIDED
 11895         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11896     IF PB-NEEDS-UNDERWRITING
 11897         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11898     IF PB-REIN-ONLY-CERT
 11899         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11900     IF PB-PREM-ACCTNG-ONLY
 11901         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11902
 11903     MOVE SPACE                  TO PB-I-OB-FLAG.
 11904
 11905     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 217
* EL050.cbl
 11906         MOVE ER-2665            TO WS-ERROR
 11907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11908         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11909
 11910     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11911        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11912           MOVE 'Z'             TO PB-I-OB-FLAG.
 11913
 11914     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11915        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11916           MOVE 'Z'             TO PB-I-OB-FLAG.
 11917
 11918     IF ACCOUNT-MAST-FOUND
 11919         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11920         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11921         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11922         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11923         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11924         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11925         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11926     END-IF
 11927
 11928     IF ACCOUNT-MAST-FOUND
 11929        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11930         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11931
 11932     IF (ACCOUNT-MAST-FOUND)
 11933*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11934        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11935        IF PB-REISSUED-CERT
 11936           CONTINUE
 11937        ELSE
 11938           MOVE ER-2608          TO WS-ERROR
 11939           PERFORM 9900-ERROR-FORMAT
 11940                                 THRU 9900-EXIT
 11941         END-IF
 11942     END-IF
 11943
 11944     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11945        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11946        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11947
 11948**********   DMD CUSTOM CODE FOLLOWS  **********
 11949 3024-EDIT-DMD-FIELDS.
 11950     IF PB-COMPANY-ID NOT = 'DMD'
 11951        GO TO 3025-EDIT-REINSURANCE.
 11952
 11953*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11954*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11955*** ERROR IF THEY ARE NOT EQUAL.
 11956
 11957     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11958     SET BIN-TO-GREG               TO TRUE.
 11959     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11960     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11961**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11962
 11963     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 218
* EL050.cbl
 11964     SET BIN-TO-GREG               TO TRUE.
 11965     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11966     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11967**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11968
 11969     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11970        MOVE ER-8116               TO WS-ERROR
 11971        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11972
 11973     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11974
 11975     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11976                                      WK-FULL-CERT-NO.
 11977     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11978
 11979     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11980
 11981     IF PB-VALID-LIFE
 11982        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11983     ELSE
 11984        IF PB-VALID-AH
 11985          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11986
 11987
 11988     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11989     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11990     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11991                                      DCUA-UNDRWRTR-CODE
 11992                                      DCUA-UNDRWRTR-GROUP-CODE
 11993                                      DCUA-RETURN-CODE.
 11994
 11995****************************************************************
 11996*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11997***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11998***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11999***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 12000***   TO THIS RECORD.                                        ***
 12001****************************************************************
 12002     MOVE ' '                      TO WS-DLO-ERROR-SW.
 12003     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 12004     IF DCUA-SUCCESSFUL-PROCESS
 12005        GO TO 3024-EDIT-DL7-CONT.
 12006
 12007     IF DCUA-RETURN-CODE EQUAL '01'
 12008        MOVE ER-8110               TO WS-ERROR
 12009        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12011        GO TO 3024-EDIT-DL7-CONT.
 12012
 12013     IF DCUA-RETURN-CODE EQUAL '02'
 12014        MOVE ER-8111               TO WS-ERROR
 12015        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12017        GO TO 3024-EDIT-DL7-CONT.
 12018
 12019     IF DCUA-RETURN-CODE EQUAL '03'
 12020        MOVE ER-8074               TO WS-ERROR
 12021        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 219
* EL050.cbl
 12022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12023        GO TO 3024-EDIT-DL7-CONT.
 12024
 12025     IF DCUA-RETURN-CODE EQUAL '04'
 12026        MOVE ER-8075               TO WS-ERROR
 12027        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12028        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12029        GO TO 3024-EDIT-DL7-CONT.
 12030
 12031     IF DCUA-RETURN-CODE EQUAL '05'
 12032        MOVE ER-8076               TO WS-ERROR
 12033        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12034        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12035        GO TO 3024-EDIT-DL7-CONT.
 12036
 12037     IF DCUA-RETURN-CODE EQUAL '06'
 12038        MOVE ER-8077               TO WS-ERROR
 12039        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12041        GO TO 3024-EDIT-DL7-CONT.
 12042
 12043     IF DCUA-RETURN-CODE EQUAL '07'
 12044        MOVE ER-8078               TO WS-ERROR
 12045        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12047        GO TO 3024-EDIT-DL7-CONT.
 12048
 12049     IF DCUA-RETURN-CODE EQUAL 'E1'
 12050        MOVE ER-8079               TO WS-ERROR
 12051        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12052        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12053        GO TO 3024-EDIT-DL7-CONT.
 12054
 12055     IF DCUA-RETURN-CODE EQUAL 'E2'
 12056        MOVE ER-8080               TO WS-ERROR
 12057        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12058        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12059        GO TO 3024-EDIT-DL7-CONT.
 12060
 12061     IF DCUA-RETURN-CODE EQUAL 'E3'
 12062        MOVE ER-8098               TO WS-ERROR
 12063        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12065        GO TO 3024-EDIT-DL7-CONT.
 12066
 12067     IF DCUA-RETURN-CODE EQUAL 'C1'
 12068        MOVE ER-8099               TO WS-ERROR
 12069        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12070        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12071        GO TO 3024-EDIT-DL7-CONT.
 12072
 12073     IF DCUA-RETURN-CODE EQUAL 'U1'
 12074        MOVE ER-8109               TO WS-ERROR
 12075        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12077        GO TO 3024-EDIT-DL7-CONT.
 12078
 12079     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 220
* EL050.cbl
 12080        MOVE ER-8112               TO WS-ERROR
 12081        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12082        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12083        GO TO 3024-EDIT-DL7-CONT.
 12084
 12085     IF DCUA-RETURN-CODE EQUAL 'N2'
 12086        MOVE ER-8113               TO WS-ERROR
 12087        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12089        GO TO 3024-EDIT-DL7-CONT.
 12090
 12091     IF DCUA-RETURN-CODE EQUAL 'N3'
 12092        MOVE ER-8114               TO WS-ERROR
 12093        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12094        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12095        GO TO 3024-EDIT-DL7-CONT.
 12096
 12097     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12098     MOVE ER-8097                  TO WS-ERROR.
 12099     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12100     GO TO 3024-EDIT-DL7-CONT.
 12101
 12102 3024-EDIT-DL7-CONT.
 12103
 12104     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12105     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12106     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12107        NEXT SENTENCE
 12108     ELSE
 12109        MOVE ER-9263               TO WS-ERROR
 12110        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12111
 12112******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12113******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12114     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12115        NEXT SENTENCE
 12116     ELSE
 12117        MOVE ER-8039               TO WS-ERROR
 12118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12119
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 221
* EL050.cbl
 12121****************************************************************
 12122*** VALIDATE STATE  : DLO022                                 ***
 12123****************************************************************
 12124     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12125     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12126
 12127     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12128     IF DVSC-SUCCESSFUL-EDIT
 12129        GO TO 3024-EDIT-DL22-CONT.
 12130
 12131     IF DVSC-RETURN-CODE EQUAL '01'
 12132        MOVE ER-8300               TO WS-ERROR
 12133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12134        GO TO 3024-EDIT-DL22-CONT.
 12135
 12136     IF DVSC-RETURN-CODE EQUAL '02'
 12137        MOVE ER-8301               TO WS-ERROR
 12138        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12139        GO TO 3024-EDIT-DL22-CONT.
 12140
 12141     IF DVSC-RETURN-CODE EQUAL '03'
 12142        MOVE ER-8302               TO WS-ERROR
 12143        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12144        GO TO 3024-EDIT-DL22-CONT.
 12145
 12146     IF DVSC-RETURN-CODE EQUAL 'N1'
 12147        MOVE ER-8304               TO WS-ERROR
 12148        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12149        GO TO 3024-EDIT-DL22-CONT.
 12150
 12151     MOVE ER-8303                  TO WS-ERROR
 12152     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12153
 12154 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 222
* EL050.cbl
 12156****************************************************************
 12157*** VALIDATE LOAN OFFICER : DLO021                           ***
 12158****************************************************************
 12159
 12160     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12161     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12162     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12163     IF DVLO-SUCCESSFUL-EDIT
 12164        GO TO 3024-EDIT-DL21-CONT.
 12165
 12166     IF DVLO-RETURN-CODE EQUAL '01'
 12167        MOVE ER-8081               TO WS-ERROR
 12168        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12169        GO TO 3024-EDIT-DL21-CONT.
 12170
 12171     IF DVLO-RETURN-CODE EQUAL '02'
 12172        MOVE ER-8082               TO WS-ERROR
 12173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12174        GO TO 3024-EDIT-DL21-CONT.
 12175
 12176     IF DVLO-RETURN-CODE EQUAL '03'
 12177        MOVE ER-8083               TO WS-ERROR
 12178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12179        GO TO 3024-EDIT-DL21-CONT.
 12180
 12181     IF DVLO-RETURN-CODE EQUAL '04'
 12182        MOVE ER-8084               TO WS-ERROR
 12183        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12184        GO TO 3024-EDIT-DL21-CONT.
 12185
 12186     IF DVLO-RETURN-CODE EQUAL '05'
 12187        MOVE ER-8085               TO WS-ERROR
 12188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12189        GO TO 3024-EDIT-DL21-CONT.
 12190
 12191     MOVE ER-7825                  TO WS-ERROR
 12192     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12193     GO TO 3024-EDIT-DL21-CONT.
 12194
 12195 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 223
* EL050.cbl
 12197
 12198****************************************************************
 12199*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12200****************************************************************
 12201
 12202     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12203     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12204     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12205     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12206     IF DIPF-SUCCESSFUL-EDIT
 12207        GO TO 3024-EDIT-DL02-CONT.
 12208
 12209     IF DIPF-RETURN-CODE EQUAL '01'
 12210        MOVE ER-8086               TO WS-ERROR
 12211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12212        GO TO 3024-EDIT-DL02-CONT.
 12213
 12214     IF DIPF-RETURN-CODE EQUAL '02'
 12215        MOVE ER-8087               TO WS-ERROR
 12216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12217        GO TO 3024-EDIT-DL02-CONT.
 12218
 12219     IF DIPF-RETURN-CODE EQUAL '03'
 12220        MOVE ER-8088               TO WS-ERROR
 12221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12222        GO TO 3024-EDIT-DL02-CONT.
 12223
 12224     MOVE ER-8095                  TO WS-ERROR
 12225     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12226     GO TO 3024-EDIT-DL02-CONT.
 12227
 12228 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 224
* EL050.cbl
 12230
 12231****************************************************************
 12232*** VALIDATE BANK ID : DLO003                                ***
 12233****************************************************************
 12234
 12235     MOVE WK-GREG-CENT           TO WCG-CENT.
 12236     MOVE WK-GREG-YYMM           TO WCG-REST.
 12237     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12238        MOVE ER-8040               TO WS-ERROR
 12239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12240
 12241     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12242     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12243     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12244     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12245     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12246     IF DVBI-SUCCESSFUL-EDIT
 12247        GO TO 3024-EDIT-DL03-CONT.
 12248
 12249     IF DVBI-RETURN-CODE EQUAL '01'
 12250        MOVE ER-8089               TO WS-ERROR
 12251        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12252        GO TO 3024-EDIT-DL03-CONT.
 12253
 12254     IF DVBI-RETURN-CODE EQUAL '02'
 12255        MOVE ER-8090               TO WS-ERROR
 12256        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12257        GO TO 3024-EDIT-DL03-CONT.
 12258
 12259     IF DVBI-RETURN-CODE EQUAL '03'
 12260        MOVE ER-8091               TO WS-ERROR
 12261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12262        GO TO 3024-EDIT-DL03-CONT.
 12263
 12264     IF DVBI-RETURN-CODE EQUAL '04'
 12265        MOVE ER-8092               TO WS-ERROR
 12266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12267        GO TO 3024-EDIT-DL03-CONT.
 12268
 12269     IF DVBI-RETURN-CODE EQUAL '05'
 12270        MOVE ER-8093               TO WS-ERROR
 12271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12272        GO TO 3024-EDIT-DL03-CONT.
 12273
 12274     IF DVBI-RETURN-CODE EQUAL '06'
 12275        MOVE ER-8094               TO WS-ERROR
 12276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12277        GO TO 3024-EDIT-DL03-CONT.
 12278
 12279     MOVE ER-8096                  TO WS-ERROR
 12280     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12281     GO TO 3024-EDIT-DL03-CONT.
 12282
 12283 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 225
* EL050.cbl
 12285
 12286     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12287        NEXT SENTENCE
 12288     ELSE
 12289        MOVE ER-8042               TO WS-ERROR
 12290        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12291
 12292     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12293     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12294     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12295
 12296     IF DMPF-RETURN-CODE = '01'
 12297        MOVE ER-8067               TO WS-ERROR
 12298        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12299        GO TO 3024-EDIT-DL01-CONT.
 12300
 12301     IF DMPF-RETURN-CODE = '02'
 12302        MOVE ER-8068               TO WS-ERROR
 12303        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12304        GO TO 3024-EDIT-DL01-CONT.
 12305
 12306     IF DMPF-RETURN-CODE = '03'
 12307        MOVE ER-8069               TO WS-ERROR
 12308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12309        GO TO 3024-EDIT-DL01-CONT.
 12310
 12311     IF DMPF-RETURN-CODE = 'E1'
 12312        MOVE ER-8070               TO WS-ERROR
 12313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12314        GO TO 3024-EDIT-DL01-CONT.
 12315
 12316     IF DMPF-RETURN-CODE = 'N1'
 12317        MOVE ER-8071               TO WS-ERROR
 12318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12319        GO TO 3024-EDIT-DL01-CONT.
 12320
 12321     IF DMPF-RETURN-CODE NOT = 'OK'
 12322        MOVE ER-8072               TO WS-ERROR
 12323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12324
 12325 3024-EDIT-DL01-CONT.
 12326******************************************************************
 12327***  VALIDATES RATE CODES : DLO017                             ***
 12328******************************************************************
 12329
 12330      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12331      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12332      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12333      IF DVRC-SUCCESSFUL-EDIT
 12334        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12335        GO TO 3024-CHECK-VALID-RATE.
 12336
 12337      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12338
 12339      IF DVRC-RETURN-CODE EQUAL '01'
 12340         MOVE ER-7817                   TO WS-ERROR
 12341         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12342         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 226
* EL050.cbl
 12343
 12344      IF DVRC-RETURN-CODE EQUAL '02'
 12345         MOVE ER-7818                   TO WS-ERROR
 12346         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12347         GO TO 3025-EDIT-REINSURANCE.
 12348
 12349      IF DVRC-RETURN-CODE EQUAL '03'
 12350         MOVE ER-7819                   TO WS-ERROR
 12351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12352         GO TO 3025-EDIT-REINSURANCE.
 12353
 12354       MOVE ER-7820                     TO WS-ERROR.
 12355       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12356       GO TO 3025-EDIT-REINSURANCE.
 12357
 12358******************************************************************
 12359***  GET PREMIUM RATES : DLO011                                ***
 12360******************************************************************
 12361
 12362 3024-CHECK-VALID-RATE.
 12363
 12364     IF VALID-RATE-CODE
 12365        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12366        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12367        MOVE SPACES                TO DPRB-RETURN-CODE
 12368        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12369     ELSE
 12370         GO TO 3025-EDIT-REINSURANCE.
 12371
 12372      IF DPRB-SUCCESSFUL-PROCESS
 12373         IF PB-VALID-LIFE
 12374             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12375             GO TO 3025-EDIT-REINSURANCE
 12376         ELSE
 12377             IF PB-VALID-AH
 12378                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12379                 GO TO 3025-EDIT-REINSURANCE.
 12380
 12381      IF DPRB-RETURN-CODE EQUAL '01'
 12382         MOVE ER-7812                   TO WS-ERROR
 12383         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12384         GO TO 3025-EDIT-REINSURANCE.
 12385
 12386      IF DPRB-RETURN-CODE EQUAL '02'
 12387         MOVE ER-7813                   TO WS-ERROR
 12388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12389         GO TO 3025-EDIT-REINSURANCE.
 12390
 12391      IF DPRB-RETURN-CODE EQUAL '03'
 12392         MOVE ER-7814                   TO WS-ERROR
 12393         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12394         GO TO 3025-EDIT-REINSURANCE.
 12395
 12396      IF DPRB-RETURN-CODE EQUAL '04'
 12397         IF NOT DPRB-1ST-TIME
 12398            MOVE ER-7815                   TO WS-ERROR
 12399            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12400            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 227
* EL050.cbl
 12401          ELSE
 12402         IF PB-VALID-LIFE
 12403            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12404          ELSE
 12405            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12406         END-IF
 12407         MOVE SPACES                TO DOCC-RETURN-CODE
 12408         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12409         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12410         IF DOCC-RETURN-CODE = 'OK'
 12411             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12412             GO TO 3024-CHECK-VALID-RATE
 12413           ELSE
 12414             MOVE ER-7823               TO WS-ERROR
 12415             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12416             GO TO 3025-EDIT-REINSURANCE.
 12417
 12418       MOVE ER-7816                     TO WS-ERROR.
 12419       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12420       GO TO 3025-EDIT-REINSURANCE.
 12421
 12422**********   DMD CUSTOM CODE ABOVE    **********
 12423
 12424 3025-EDIT-REINSURANCE.
 12425     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12426         GO TO 3027-EDIT-CONTINUE.
 12427
 12428     MOVE LOW-VALUES               TO ERREIN-KEY.
 12429     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12430     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12431                                      REIN-CODE-2
 12432                                      REIN-CODE-3.
 12433     MOVE 'A'                      TO REIN-TYPE.
 12434
 12435     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12436
 12437     MOVE '3026' TO REIN-SW.
 12438     MOVE ' '                   TO WS-REIN-READ-SW.
 12439
 12440     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12441     IF REIN-TABLE-NOT-FOUND
 12442         GO TO 3026-NO-SPEC-TABLE.
 12443
 12444     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12445     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12446                                   WS-NSP-ST-CD-LF.
 12447     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12448                                   WS-NSP-ST-CD-AH.
 12449
 12450     GO TO 3040-EDIT-CONTINUE.
 12451
 12452 3026-NO-SPEC-TABLE.
 12453
 12454     MOVE ER-2664                TO WS-ERROR.
 12455     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12456     GO TO 3040-EDIT-CONTINUE.
 12457
 12458 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 228
* EL050.cbl
 12459
 12460     IF PB-I-REIN-TABLE = SPACES
 12461       GO TO 3040-EDIT-CONTINUE.
 12462
 12463     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12464          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12465          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12466           GO TO 3040-EDIT-CONTINUE.
 12467
 12468     MOVE LOW-VALUES            TO ERREIN-KEY.
 12469     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12470     MOVE 'A'                   TO REIN-TYPE.
 12471     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12472
 12473     MOVE '3028'                TO REIN-SW.
 12474     MOVE ' '                   TO WS-REIN-READ-SW.
 12475
 12476     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12477     IF REIN-TABLE-NOT-FOUND
 12478         GO TO 3028-NO-REIN-TABLE.
 12479
 12480     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12481     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12482                                   WS-NSP-ST-CD-LF.
 12483     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12484                                   WS-NSP-ST-CD-AH.
 12485
 12486     GO TO 3040-EDIT-CONTINUE.
 12487
 12488 3028-NO-REIN-TABLE.
 12489
 12490     MOVE ER-2615                TO WS-ERROR.
 12491     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12492     GO TO 3040-EDIT-CONTINUE.
 12493
 12494 3040-EDIT-CONTINUE.
 12495
 12496     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12497         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12498
 12499     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12500         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12501
 12502     IF (NOT PB-REISSUED-CERT)
 12503        AND (NOT PB-MONTHLY-CERT)
 12504        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12505            MOVE '001'           TO PB-I-LF-TERM
 12506            MOVE 'M'             TO PB-I-INSURED-SEX.
 12507
 12508     IF (NOT PB-REISSUED-CERT)
 12509        AND (NOT PB-MONTHLY-CERT)
 12510        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12511            MOVE '001'           TO PB-I-AH-TERM
 12512            MOVE 'M'             TO PB-I-INSURED-SEX.
 12513
 12514 3040-EDIT-1ST-PMT-DT.
 12515     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12516     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 229
* EL050.cbl
 12517         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12518
 12519******************************************************************
 12520*                                                                *
 12521*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12522*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12523*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12524*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12525*                                                                *
 12526******************************************************************
 12527
 12528     IF PB-EFF-DT-PROCESSING
 12529        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12530                                    PB-I-LF-EXPIRE-DT
 12531                                    PB-I-AH-EXPIRE-DT
 12532        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12533        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12534        MOVE ZERO                TO DC-ELAPSED-DAYS
 12535        MOVE +1                  TO DC-ELAPSED-MONTHS
 12536        SET BIN-PLUS-ELAPSED     TO TRUE
 12537*       MOVE 6                   TO DC-OPTION-CODE
 12538        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12539        IF NO-CONVERSION-ERROR
 12540           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12541
 12542******************************************************************
 12543*                                                                *
 12544*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12545*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12546*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12547*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12548*                                                                *
 12549******************************************************************
 12550
 12551     IF PB-EXT-DAYS-PROCESSING
 12552          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12553                                         PB-I-LF-EXPIRE-DT
 12554                                         PB-I-AH-EXPIRE-DT
 12555          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12556          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12557          MOVE +1                     TO DC-ELAPSED-MONTHS
 12558          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12559          SET BIN-PLUS-ELAPSED        TO TRUE
 12560*         MOVE 6                      TO DC-OPTION-CODE
 12561          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12562          IF NO-CONVERSION-ERROR
 12563             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12564
 12565******************************************************************
 12566*                                                                *
 12567*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12568*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12569*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12570*        (EXPIRE DATE - (TERM -1))  *  -1.
 12571*                                                                *
 12572******************************************************************
 12573
 12574     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 230
* EL050.cbl
 12575        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12576           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12577              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12578              MOVE PB-I-AH-TERM      TO WS-TERM
 12579           ELSE
 12580              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12581              MOVE PB-I-LF-TERM      TO WS-TERM
 12582        ELSE
 12583           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12584              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12585              MOVE PB-I-LF-TERM      TO WS-TERM
 12586           ELSE
 12587              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12588              MOVE PB-I-AH-TERM      TO WS-TERM.
 12589
 12590     IF PB-EXPIRE-DT-PROCESSING
 12591        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12592        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12593        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12594        MOVE ZERO                TO DC-ELAPSED-DAYS
 12595                                    DC-ODD-DAYS-OVER
 12596          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12597          SET BIN-PLUS-ELAPSED    TO TRUE
 12598*         MOVE 6                  TO DC-OPTION-CODE
 12599          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12600          IF NO-CONVERSION-ERROR
 12601             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12602
 12603******************************************************************
 12604*                                                                *
 12605*            1ST PAYMENT DATE PROCESSING                         *
 12606*                                                                *
 12607******************************************************************
 12608
 12609     IF PB-1ST-PMT-DT-PROCESSING
 12610        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12611                                    PB-I-AH-EXPIRE-DT
 12612        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12613
 12614     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12615         NEXT SENTENCE
 12616     ELSE
 12617         MOVE ER-2680                 TO WS-ERROR
 12618         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12619         GO TO 3060-ORIG-TERM-CHECK.
 12620
 12621     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12622     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12623     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12624*    MOVE 1                      TO DC-OPTION-CODE.
 12625     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12626                                    DC-ELAPSED-DAYS
 12627                                    DC-ODD-DAYS-OVER.
 12628
 12629     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12630
 12631     IF DATE-CONVERSION-ERROR
 12632        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 231
* EL050.cbl
 12633
 12634     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12635     IF (PB-COMPANY-ID = 'CID' OR 'AHL' OR 'FNL')
 12636        AND (WS-LF-COVERAGE-TYPE = 'L')
 12637        IF (DC-ELAPSED-MONTHS > 1)
 12638                      OR
 12639           ((DC-ELAPSED-MONTHS = 1)
 12640           AND (DC-ODD-DAYS-OVER > 0))
 12641           MOVE ER-2882          TO WS-ERROR
 12642           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12643        END-IF
 12644     END-IF
 12645     if dc-elapsed-months > 0
 12646        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12647        + dc-odd-days-over
 12648     end-if
 12649     IF PB-EXT-DAYS-PROCESSING
 12650        CONTINUE
 12651     ELSE
 12652        IF DC-ELAPSED-MONTHS = +0
 12653           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12654        ELSE
 12655           IF (WS-LF-EARNINGS-CALC = '4')
 12656              AND (DC-ELAPSED-MONTHS > ZERO)
 12657              AND (DC-ELAPSED-DAYS > ZERO)
 12658              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12659           ELSE
 12660              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12661                                 THRU 6499-EXIT
 12662              MOVE WS-ODD-DAYS-OVER
 12663                                 TO PB-I-EXTENTION-DAYS
 12664           END-IF
 12665        END-IF
 12666     END-IF
 12667******************************************************************
 12668*                                                                *
 12669*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12670*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12671*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12672*            AND ANY ODD DAYS.                                   *
 12673*                                                                *
 12674******************************************************************
 12675
 12676     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12677                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12678     IF WS-LF-EARNINGS-CALC NOT = '4'
 12679        IF DC-ELAPSED-DAYS > ZEROS
 12680           MOVE ER-2681          TO WS-ERROR
 12681           PERFORM 9900-ERROR-FORMAT
 12682                                 THRU 9900-EXIT
 12683        END-IF
 12684     END-IF
 12685
 12686     IF WS-LF-EARNINGS-CALC NOT = '4'
 12687        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12688           MOVE ER-2681          TO WS-ERROR
 12689           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12690
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 232
* EL050.cbl
 12691     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12692        (PB-I-LF-TERM NOT = ZERO) AND
 12693         NOT NO-LIFE-COVERAGE
 12694          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12695          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12696          IF WS-LF-EARNINGS-CALC = '4'
 12697             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12698             PB-I-PAY-FREQUENCY
 12699          END-IF
 12700          MOVE ZERO              TO DC-ELAPSED-DAYS
 12701                                    DC-ODD-DAYS-OVER
 12702          MOVE 1                 TO DC-END-OF-MONTH
 12703          SET BIN-PLUS-ELAPSED        TO TRUE
 12704*         MOVE 6                 TO DC-OPTION-CODE
 12705          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12706          IF NO-CONVERSION-ERROR
 12707             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12708             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12709                (WS-LF-SPECIAL-CALC-CD = 'L')
 12710                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12711                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12712                  MOVE +1             TO DC-ELAPSED-MONTHS
 12713                  SET BIN-PLUS-ELAPSED  TO TRUE
 12714*                 MOVE 6              TO DC-OPTION-CODE
 12715                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12716                  IF NO-CONVERSION-ERROR
 12717                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12718
 12719* okay, i had to move the new att age edit down here because the
 12720* expiration date could get recalculated and i need the exp date
 12721     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12722        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12723        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12724        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12725           AND ZEROS
 12726           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12727           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12728           SET ELAPSED-BETWEEN-BIN TO TRUE
 12729           PERFORM 8500-DATE-CONVERT
 12730                                 THRU 8500-EXIT
 12731           IF NO-CONVERSION-ERROR
 12732              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12733                 MOVE ER-2669       TO WS-ERROR
 12734*                PERFORM 9900-ERROR-FORMAT
 12735*                                THRU 9900-EXIT
 12736              END-IF
 12737           END-IF
 12738        ELSE
 12739           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12740           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12741              MOVE ER-2669       TO WS-ERROR
 12742*             PERFORM 9900-ERROR-FORMAT
 12743*                                THRU 9900-EXIT
 12744           ELSE
 12745              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12746                 MOVE ER-1570    TO WS-ERROR
 12747                 PERFORM 9900-ERROR-FORMAT
 12748                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 233
* EL050.cbl
 12749              END-IF
 12750           END-IF
 12751        END-IF
 12752        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12753           AND ZEROS
 12754           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12755           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12756           SET ELAPSED-BETWEEN-BIN TO TRUE
 12757           PERFORM 8500-DATE-CONVERT
 12758                                 THRU 8500-EXIT
 12759           IF NO-CONVERSION-ERROR
 12760              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12761                 MOVE ER-2669       TO WS-ERROR
 12762*                PERFORM 9900-ERROR-FORMAT
 12763*                                THRU 9900-EXIT
 12764              END-IF
 12765           END-IF
 12766        ELSE
 12767           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12768             (PB-I-LF-TERM / 12)
 12769           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12770              MOVE ER-2669       TO WS-ERROR
 12771*             PERFORM 9900-ERROR-FORMAT
 12772*                                THRU 9900-EXIT
 12773           ELSE
 12774              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12775                 MOVE ER-1571    TO WS-ERROR
 12776                 PERFORM 9900-ERROR-FORMAT
 12777                                 THRU 9900-EXIT
 12778              END-IF
 12779           END-IF
 12780        END-IF
 12781        IF WS-ERROR = ER-2669
 12782           PERFORM 9900-ERROR-FORMAT
 12783                                 THRU 9900-EXIT
 12784        END-IF
 12785     END-IF
 12786     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12787        (PB-I-AH-TERM NOT = ZERO) AND
 12788         NOT NO-AH-COVERAGE
 12789          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12790             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12791             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12792             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12793          ELSE
 12794             IF WS-LF-EARNINGS-CALC = '4'
 12795                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12796                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12797                PB-I-PAY-FREQUENCY
 12798             ELSE
 12799                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12800                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12801             END-IF
 12802          END-IF
 12803          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12804                                         DC-ODD-DAYS-OVER
 12805          MOVE 1                      TO DC-END-OF-MONTH
 12806          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 234
* EL050.cbl
 12807*         MOVE 6                      TO DC-OPTION-CODE
 12808          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12809          IF NO-CONVERSION-ERROR
 12810             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12811     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12812        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12813        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12814        IF PB-I-BIRTHDAY > LOW-VALUES
 12815           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12816           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12817           SET ELAPSED-BETWEEN-BIN TO TRUE
 12818           PERFORM 8500-DATE-CONVERT
 12819                                 THRU 8500-EXIT
 12820           IF NO-CONVERSION-ERROR
 12821              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12822                 MOVE ER-3054       TO WS-ERROR
 12823*                PERFORM 9900-ERROR-FORMAT
 12824*                                THRU 9900-EXIT
 12825              END-IF
 12826           END-IF
 12827        ELSE
 12828           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12829           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12830              MOVE ER-3054       TO WS-ERROR
 12831*             PERFORM 9900-ERROR-FORMAT
 12832*                                THRU 9900-EXIT
 12833           END-IF
 12834        END-IF
 12835        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12836           AND ZEROS
 12837           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12838           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12839           SET ELAPSED-BETWEEN-BIN TO TRUE
 12840           PERFORM 8500-DATE-CONVERT
 12841                                 THRU 8500-EXIT
 12842           IF NO-CONVERSION-ERROR
 12843              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12844                 MOVE ER-3054       TO WS-ERROR
 12845*                PERFORM 9900-ERROR-FORMAT
 12846*                                THRU 9900-EXIT
 12847              END-IF
 12848           END-IF
 12849        ELSE
 12850           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12851             (PB-I-AH-TERM / 12)
 12852           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12853              MOVE ER-3054       TO WS-ERROR
 12854*             PERFORM 9900-ERROR-FORMAT
 12855*                                THRU 9900-EXIT
 12856           END-IF
 12857        END-IF
 12858        IF WS-ERROR = ER-3054
 12859           PERFORM 9900-ERROR-FORMAT
 12860                                 THRU 9900-EXIT
 12861        END-IF
 12862     END-IF
 12863     MOVE SPACE                       TO DC-END-OF-MONTH.
 12864
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 235
* EL050.cbl
 12865     IF PB-COMPANY-ID = 'NCB'
 12866        GO TO 3040-EDIT-EXTENSION-DAYS.
 12867
 12868     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12869       AND
 12870        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12871        NEXT SENTENCE
 12872     ELSE
 12873        GO TO 3040-EDIT-EXTENSION-DAYS.
 12874
 12875     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12876        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12877        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12878     ELSE
 12879        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12880        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12881
 12882     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12883*    MOVE '1'      TO DC-OPTION-CODE
 12884     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12885     IF (NO-CONVERSION-ERROR)
 12886        AND (DC-ELAPSED-MONTHS > +1)
 12887        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12888        MOVE ER-2668   TO WS-ERROR
 12889        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12890
 12891 3040-EDIT-EXTENSION-DAYS.
 12892
 12893     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12894        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12895         GO TO 3050-EDIT-TERM-IN-DAYS
 12896     ELSE
 12897         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12898
 12899     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12900         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12901     ELSE
 12902        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12903           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12904           MOVE ER-2681         TO WS-ERROR
 12905           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12906
 12907     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12908        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12909        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12910         GO TO 3060-ORIG-TERM-CHECK.
 12911
 12912     GO TO 3060-ORIG-TERM-CHECK.
 12913
 12914 3050-EDIT-TERM-IN-DAYS.
 12915
 12916     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12917
 12918     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12919         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12920     ELSE
 12921         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12922            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 236
* EL050.cbl
 12923            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12924
 12925     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12926                                       REMAINDER WS-WORK-TERM.
 12927     IF WS-WORK-TERM GREATER THAN ZERO
 12928         ADD +1 TO PB-I-LF-TERM.
 12929
 12930     IF NOT NO-AH-COVERAGE
 12931         MOVE ER-2684            TO WS-ERROR
 12932         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12933
 12934
 12935 3060-ORIG-TERM-CHECK.
 12936
 12937******************************************************************
 12938*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12939******************************************************************
 12940
 12941     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12942        NEXT SENTENCE
 12943     ELSE
 12944        IF NOT NO-LIFE-COVERAGE
 12945           IF PB-I-LF-TERM NUMERIC
 12946              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12947              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12948              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12949                  NEXT SENTENCE
 12950           ELSE
 12951              MOVE ER-2647       TO WS-ERROR
 12952              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12953
 12954     IF NOT NO-AH-COVERAGE
 12955         IF PB-I-AH-TERM NUMERIC
 12956            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12957            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12958            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12959             NEXT SENTENCE
 12960          ELSE
 12961              MOVE ER-2658       TO WS-ERROR
 12962              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12963
 12964     IF PB-COMPANY-ID = 'NCB'
 12965        GO TO 3070-LOAN-TERM-CHECK.
 12966
 12967     IF POLICY-HAS-AH
 12968       AND
 12969        POLICY-HAS-LIFE
 12970       AND
 12971        PB-I-LF-TERM NUMERIC
 12972       AND
 12973        PB-I-AH-TERM NUMERIC
 12974        NEXT SENTENCE
 12975     ELSE
 12976        GO TO 3070-LOAN-TERM-CHECK.
 12977
 12978     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12979     IF WS-TEX-FACT-2 LESS THAN +0
 12980        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 237
* EL050.cbl
 12981
 12982     IF WS-TEX-FACT-2 GREATER THAN +1
 12983        MOVE ER-2668             TO WS-ERROR
 12984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12985
 12986 3070-LOAN-TERM-CHECK.
 12987
 12988     IF (WS-LF-BENEFIT-CD = ZERO)
 12989         OR (NO-LF-BENEFIT-MATCH)
 12990            GO TO 3125-EDIT-PMT-FREQ.
 12991*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12992*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12993*          AND 'V' AND 'W' AND 'X'
 12994*          GO TO 3125-EDIT-PMT-FREQ
 12995*       END-IF
 12996*    ELSE
 12997*       IF WS-AH-DCC-TRUNC = 'T'
 12998*          CONTINUE
 12999*       ELSE
 13000*          GO TO 3125-EDIT-PMT-FREQ
 13001*       END-IF
 13002*    END-IF
 13003     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13004                    OR
 13005        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13006        AND (WS-AH-DCC-TRUNC = 'T'))
 13007        CONTINUE
 13008     ELSE
 13009        GO TO 3125-EDIT-PMT-FREQ
 13010     END-IF
 13011     IF PB-I-LOAN-TERM NOT NUMERIC
 13012         MOVE ZEROS              TO PB-I-LOAN-TERM.
 13013
 13014     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 13015        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 13016*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 13017        PB-I-LOAN-TERM NOT GREATER THAN +360
 13018         NEXT SENTENCE
 13019     ELSE
 13020         MOVE ER-2648            TO WS-ERROR
 13021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13022
 13023     if  PB-I-LOAN-TERM > WS-MAX-TERM
 13024        MOVE ER-3058             TO WS-ERROR
 13025        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13026     end-if
 13027
 13028     IF WS-STATE-ABBREVIATION = 'NC'
 13029        IF PB-I-LOAN-TERM > +59
 13030           CONTINUE
 13031        ELSE
 13032           MOVE ER-2792          TO WS-ERROR
 13033           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13034        END-IF
 13035     END-IF
 13036
 13037     .
 13038 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 238
* EL050.cbl
 13039     IF (WS-LF-BENEFIT-CD = ZERO)
 13040         OR (NO-LF-BENEFIT-MATCH)
 13041         or (pb-state = 'AL')
 13042            GO TO 3127-EDIT-LOAN-OFFICER.
 13043     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13044                    OR
 13045        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13046        AND (WS-AH-DCC-TRUNC = 'T'))
 13047                    OR
 13048         (PB-COMPANY-ID = 'AHL' OR 'FNL')
 13049        CONTINUE
 13050     ELSE
 13051        IF (PB-I-LOAN-TERM > ZEROS)
 13052           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13053           MOVE ER-1575          TO WS-ERROR
 13054           PERFORM 9900-ERROR-FORMAT
 13055                                 THRU 9900-EXIT
 13056        END-IF
 13057     END-IF
 13058     IF WS-LF-EARNINGS-CALC NOT = '4'
 13059         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13060            MOVE ER-2653         TO WS-ERROR
 13061            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13062            GO TO 3127-EDIT-LOAN-OFFICER
 13063         ELSE
 13064            GO TO 3127-EDIT-LOAN-OFFICER.
 13065
 13066     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13067         MOVE ER-2655            TO WS-ERROR
 13068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13069         GO TO 3127-EDIT-LOAN-OFFICER.
 13070
 13071     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13072         MOVE ER-2654            TO WS-ERROR
 13073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13074         GO TO 3127-EDIT-LOAN-OFFICER.
 13075
 13076     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13077         GIVING WS-TEX-FACT-2
 13078             REMAINDER WS-TEX-FACT-3.
 13079
 13080*    IF WS-TEX-FACT-3 NOT = ZERO
 13081*       MOVE ER-2654             TO WS-ERROR
 13082*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13083
 13084
 13085 3127-EDIT-LOAN-OFFICER.
 13086
 13087     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13088        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13089           MOVE ER-2690          TO WS-ERROR
 13090           PERFORM 9900-ERROR-FORMAT
 13091                                 THRU 9900-EXIT
 13092        ELSE
 13093           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13094           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13095           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13096           MOVE PB-SV-STATE      TO LOFC-STATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 239
* EL050.cbl
 13097           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 13098           MOVE PB-I-LOAN-OFFICER
 13099                                 TO LOFC-CODE
 13100           PERFORM 8586-READ-LOAN-OFFICER
 13101                                 THRU 8586-EXIT
 13102           IF (NOT LOFC-MASTER-FOUND)
 13103              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13104              MOVE ER-3006       TO WS-ERROR
 13105              PERFORM 9900-ERROR-FORMAT
 13106                                 THRU 9900-EXIT
 13107           END-IF
 13108        END-IF
 13109     END-IF
 13110     .
 13111 3129-EDIT-APR.
 13112
 13113     IF (WS-LF-BENEFIT-CD = ZERO)
 13114        OR (NO-LF-BENEFIT-MATCH)
 13115        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13116           GO TO 3130-EDIT-AGE
 13117*       ELSE
 13118*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13119*             GO TO 3130-EDIT-AGE
 13120*          END-IF
 13121        END-IF
 13122     END-IF
 13123
 13124     IF (WS-STATE-ABBREVIATION = 'OH')
 13125         AND (PB-I-RATE-CLASS NOT = 'L ')
 13126         AND (PB-I-LF-TERM GREATER THAN 60)
 13127         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13128         GO TO 3129-APR-CONT.
 13129
 13130     IF (WS-STATE-ABBREVIATION = 'RI')
 13131         AND (PB-I-LF-TERM GREATER THAN 60)
 13132         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13133         GO TO 3129-APR-CONT.
 13134
 13135     IF (WS-STATE-ABBREVIATION = 'UT')
 13136         AND (PB-I-LF-TERM GREATER THAN 62)
 13137         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13138         AND (PB-CERT-EFF-DT LESS WS-830901)
 13139         GO TO 3129-APR-CONT.
 13140
 13141     IF PB-COMPANY-ID = 'LAP'
 13142        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13143           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13144              MOVE ER-2656         TO WS-ERROR
 13145              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13146              GO TO 3130-EDIT-AGE.
 13147
 13148     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13149        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13150        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13151        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13152        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13153        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13154         GO TO 3130-EDIT-AGE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 240
* EL050.cbl
 13155
 13156 3129-APR-CONT.
 13157     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13158         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13159         GO TO 3130-EDIT-AGE.
 13160
 13161     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13162         WS-AH-BENEFIT-CD (1:1) = 'S')
 13163        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13164        AND (PB-I-LOAN-APR = ZERO)
 13165        MOVE ER-2657             TO WS-ERROR
 13166        PERFORM 9900-ERROR-FORMAT
 13167                                 THRU 9900-EXIT
 13168        GO TO 3130-EDIT-AGE
 13169     END-IF
 13170*    IF PB-I-LOAN-APR = ZERO
 13171*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13172*    END-IF
 13173
 13174     if pb-i-loan-apr = +99.9999
 13175        move er-2656             to ws-error
 13176        PERFORM 9900-ERROR-FORMAT
 13177                                 THRU 9900-EXIT
 13178        GO TO 3130-EDIT-AGE
 13179     end-if
 13180*    IF PB-I-LOAN-APR = ZERO
 13181*       MOVE ER-2656             TO WS-ERROR
 13182*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13183*       GO TO 3130-EDIT-AGE.
 13184
 13185*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13186     if pb-i-loan-apr not = +99.9999
 13187        IF PB-I-LOAN-APR > +30.000
 13188           MOVE ER-2657          TO WS-ERROR
 13189           PERFORM 9900-ERROR-FORMAT
 13190                                 THRU 9900-EXIT
 13191        end-if
 13192     end-if
 13193     .
 13194 3130-EDIT-AGE.
 13195
 13196******************************************************************
 13197*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13198******************************************************************
 13199
 13200     IF NOT NO-LIFE-COVERAGE
 13201        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13202           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13203               MOVE ER-2628             TO WS-ERROR
 13204               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13205
 13206     IF NOT NO-AH-COVERAGE
 13207        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13208           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13209               MOVE ER-2628         TO WS-ERROR
 13210               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13211
 13212 3133-SEX-CODE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 241
* EL050.cbl
 13213     IF PB-I-INSURED-SEX = SPACE OR ZERO
 13214         IF WS-DEFAULT-SEX = 'M'
 13215             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13216          ELSE
 13217             IF WS-DEFAULT-SEX = 'F'
 13218             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13219
 13220     IF PB-I-INSURED-SEX = '1'
 13221         MOVE 'M' TO PB-I-INSURED-SEX.
 13222
 13223     IF PB-I-INSURED-SEX = '2'
 13224         MOVE 'F' TO PB-I-INSURED-SEX.
 13225
 13226 3134-SIG-SW-EDIT.
 13227     IF PB-I-SIG-SW = SPACE
 13228         MOVE 'N'                TO  PB-I-SIG-SW.
 13229
 13230     IF PB-COMPANY-ID = 'NCL'
 13231         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13232             NEXT SENTENCE
 13233         ELSE
 13234             MOVE ER-1923        TO  WS-ERROR
 13235             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13236     ELSE
 13237     IF PB-COMPANY-ID = 'CRI'
 13238         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13239             NEXT SENTENCE
 13240         ELSE
 13241             MOVE ER-2606        TO  WS-ERROR
 13242             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13243     ELSE
 13244     IF PB-COMPANY-ID = 'TMS'
 13245         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13246             NEXT SENTENCE
 13247         ELSE
 13248             MOVE ER-2689        TO  WS-ERROR
 13249             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13250     ELSE
 13251         IF PB-I-SIG-SW = 'Y' OR 'N'
 13252             NEXT SENTENCE
 13253         ELSE
 13254             MOVE ER-2651        TO  WS-ERROR
 13255             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13256
 13257     IF PB-COMPANY-ID = 'FLA'
 13258         IF (WS-EDIT-AGE GREATER 54  OR
 13259             WS-AH-EDIT-AGE GREATER 54)  AND
 13260            PB-I-SIG-SW = 'N'
 13261            MOVE ER-2651         TO  WS-ERROR
 13262            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13263
 13264 3135-NAME-EDIT.
 13265
 13266     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13267        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13268        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13269           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13270                                 TO PB-I-JOINT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 242
* EL050.cbl
 13271        END-PERFORM
 13272     END-IF
 13273     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13274        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13275        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13276           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13277                                 TO PB-I-JOINT-LAST-NAME
 13278        END-PERFORM
 13279     END-IF
 13280     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13281        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13282        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13283           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13284                                 TO PB-I-INSURED-FIRST-NAME
 13285        END-PERFORM
 13286     END-IF
 13287     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13288        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13289        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13290           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13291                                 TO PB-I-INSURED-LAST-NAME
 13292        END-PERFORM
 13293     END-IF
 13294     if PB-I-JOINT-COVERAGE *> and
 13295*       pb-i-insured-last-name <> spaces
 13296        if pb-i-insured-last-name = pb-i-joint-last-name and
 13297           pb-i-insured-first-name = pb-i-joint-first-name and
 13298           pb-i-birthday = pb-i-joint-birthday
 13299           move er-3069          to ws-error
 13300           perform 9900-error-format
 13301                                 thru 9900-exit
 13302        end-if
 13303     end-if
 13304     IF PB-I-INSURED-LAST-NAME = SPACES
 13305       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13306       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13307           MOVE ER-2660    TO WS-ERROR
 13308           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13309
 13310 3136-EDIT-SEX.
 13311
 13312******************************************************************
 13313*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13314******************************************************************
 13315
 13316     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13317        (WS-AH-SPECIAL-CALC-CD = 'O')
 13318        NEXT SENTENCE
 13319     ELSE
 13320        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13321           NEXT SENTENCE
 13322        ELSE
 13323           MOVE ER-2629            TO WS-ERROR
 13324           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13325
 13326 3137-EDIT-EFF-DATE.
 13327
 13328     IF PB-REISSUED-CERT       OR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 243
* EL050.cbl
 13329        PB-POLICY-IS-DECLINED  OR
 13330        PB-POLICY-IS-VOIDED
 13331         GO TO 3139-EDIT-COVERAGE-CODES.
 13332
 13333     MOVE SPACE                  TO WS-2671-SW
 13334                                    WS-2672-SW.
 13335
 13336     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13337         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13338             MOVE ER-2703        TO WS-ERROR
 13339             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13340             GO TO 3139-EDIT-COVERAGE-CODES.
 13341
 13342     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13343         GO TO 3139-EDIT-COVERAGE-CODES.
 13344
 13345     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13346     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13347*    MOVE '1'                    TO DC-OPTION-CODE.
 13348     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13349     MOVE +0                     TO DC-ELAPSED-MONTHS
 13350                                    DC-ELAPSED-DAYS.
 13351     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13352
 13353     IF DATE-CONVERSION-ERROR
 13354         GO TO 3139-EDIT-COVERAGE-CODES.
 13355
 13356     IF DC-ELAPSED-DAYS GREATER +180
 13357         MOVE ER-2672            TO WS-ERROR
 13358         MOVE 'Y'                TO WS-2672-SW
 13359         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13360     END-IF
 13361
 13362     IF WS-ERROR = ER-2671  AND
 13363        PB-COMPANY-ID  = 'LBL'
 13364        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13365        MOVE SPACE               TO WS-2671-SW
 13366        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13367
 13368     IF PB-ISSUE-DATE-FORCED  AND
 13369      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13370         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13371         MOVE ER-2673            TO WS-ERROR
 13372         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13373         MOVE SPACE              TO WS-2671-SW
 13374                                    WS-2672-SW.
 13375
 13376     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13377         IF PB-ISSUE-DATE-FORCED
 13378             MOVE ER-2600          TO  WS-ERROR
 13379             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13380         ELSE
 13381             MOVE ER-2692          TO  WS-ERROR
 13382             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13383
 13384
 13385 3139-EDIT-COVERAGE-CODES.
 13386
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 244
* EL050.cbl
 13387     if pb-company-id not = 'AHL'
 13388        IF (WS-LF-SPECIAL-CALC-CD = 'O')
 13389           or (ws-ah-special-calc-cd = 'O')
 13390           IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13391              PB-I-LF-ALT-PREMIUM-AMT) > 500000.00
 13392              MOVE ER-3071       TO WS-ERROR
 13393              PERFORM 9900-ERROR-FORMAT
 13394                                 THRU 9900-EXIT
 13395           end-if
 13396        END-IF
 13397     end-if
 13398     IF (WS-LF-SPECIAL-CALC-CD NOT = 'O')
 13399        and (ws-ah-special-calc-cd not = 'O')
 13400        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13401                                 > 250000.00
 13402           MOVE ER-2719          TO WS-ERROR
 13403           PERFORM 9900-ERROR-FORMAT
 13404                                 THRU 9900-EXIT
 13405        END-IF
 13406        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13407           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13408           MOVE ER-2787          TO WS-ERROR
 13409           PERFORM 9900-ERROR-FORMAT
 13410                                 THRU 9900-EXIT
 13411        END-IF
 13412     END-IF
 13413
 13414     IF PB-POLICY-IS-DECLINED  OR
 13415        PB-POLICY-IS-VOIDED
 13416         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13417
 13418     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13419        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13420         MOVE ER-2630                TO WS-ERROR
 13421         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13422
 13423     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13424        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13425        PB-I-LF-PREMIUM-AMT = ZERO
 13426         GO TO 3140-CHECK-AH-FOR-ZERO.
 13427
 13428     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13429        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13430        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13431         GO TO 3140-CHECK-AH-FOR-ZERO.
 13432
 13433     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13434        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13435        MOVE ER-2631             TO WS-ERROR
 13436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13437     END-IF
 13438
 13439
 13440******************************************************************
 13441*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13442******************************************************************
 13443
 13444     IF WS-LF-SPECIAL-CALC-CD = 'O'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 245
* EL050.cbl
 13445        NEXT SENTENCE
 13446     ELSE
 13447        IF PB-I-LF-BENEFIT-AMT = ZERO
 13448           MOVE ER-2632             TO WS-ERROR
 13449           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13450
 13451
 13452******************************************************************
 13453*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13454******************************************************************
 13455
 13456     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13457        CONTINUE
 13458     ELSE
 13459        IF PB-I-LF-PREMIUM-AMT = ZERO
 13460           IF (NOT PB-COMP-LF-PREM)
 13461              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13462              and (ws-lf-ben-category not = 'C')
 13463              MOVE ER-2633       TO WS-ERROR
 13464              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13465           END-IF
 13466        END-IF
 13467     END-IF
 13468     .
 13469 3140-CHECK-AH-FOR-ZERO.
 13470
 13471     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13472        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13473        PB-I-AH-PREMIUM-AMT = ZERO
 13474         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13475
 13476     IF PB-COMPANY-ID = 'CSL'  AND
 13477        PB-I-AH-BENEFIT-CD = ZERO  AND
 13478        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13479        PB-I-AH-PREMIUM-AMT = ZERO
 13480         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13481
 13482     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13483        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13484        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13485         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13486
 13487     IF PB-I-AH-BENEFIT-CD = ZERO
 13488         MOVE ER-2634            TO WS-ERROR
 13489         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13490
 13491******************************************************************
 13492*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13493******************************************************************
 13494
 13495     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13496        NEXT SENTENCE
 13497     ELSE
 13498        IF PB-I-AH-BENEFIT-AMT = ZERO
 13499           MOVE ER-2635             TO WS-ERROR
 13500           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13501
 13502******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 246
* EL050.cbl
 13503*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13504******************************************************************
 13505
 13506     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13507        NEXT SENTENCE
 13508     ELSE
 13509        IF PB-I-AH-PREMIUM-AMT = ZERO
 13510            IF NOT PB-COMP-AH-PREM
 13511                MOVE ER-2636    TO WS-ERROR
 13512                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13513
 13514
 13515 3140-EDIT-MAX-AMT-SIZES.
 13516* CUSTOM CODE FOR CLIENT    'DMD'
 13517     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13518                                     WS-RES-MUNI-TAX
 13519                                     PB-I-STATE-TAX
 13520                                     PB-I-MUNI-TAX.
 13521
 13522     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13523
 13524     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13525        GO TO 3150-RATE-OUTSTAND-BAL.
 13526
 13527     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13528        GO TO 3150-RATE-OUTSTAND-BAL.
 13529
 13530     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13531        GO TO 3150-RATE-OUTSTAND-BAL.
 13532
 13533     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13534                             OR 'RIC')
 13535        GO TO 3150-RATE-OUTSTAND-BAL.
 13536
 13537     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13538        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13539            GO TO 3150-RATE-OUTSTAND-BAL
 13540        ELSE
 13541           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13542               GO TO 3150-RATE-OUTSTAND-BAL.
 13543
 13544     IF NOT PB-NO-MONTHS-SKIPPED
 13545        GO TO 3150-RATE-OUTSTAND-BAL.
 13546
 13547     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13548        GO TO 3150-RATE-OUTSTAND-BAL.
 13549
 13550     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13551        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13552           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13553             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13554           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13555           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13556              MOVE ER-2693     TO WS-ERROR
 13557              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13558              GO TO 3150-RATE-OUTSTAND-BAL
 13559           ELSE
 13560              GO TO 3150-RATE-OUTSTAND-BAL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 247
* EL050.cbl
 13561
 13562 3150-RATE-OUTSTAND-BAL.
 13563
 13564* DMD RATING TEST
 13565     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13566         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13567         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13568         MOVE ER-2687                 TO WS-ERROR
 13569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13570         MOVE 'B'                     TO PB-I-OB-FLAG
 13571         GO TO 3260-EDIT-CONTINUE.
 13572
 13573     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13574         IF  WS-ERROR    EQUAL    ER-2693
 13575             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13576                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13577                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13578                 MOVE  +0            TO  WS-ERROR.
 13579
 13580     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13581         IF  WS-ERROR    EQUAL    ER-2693
 13582             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13583                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13584                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13585                 MOVE  +0            TO  WS-ERROR.
 13586
 13587     IF PLAN-MASTER-AH-SW = 'Y'
 13588        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13589            IF  WS-ERROR    EQUAL    ER-2693
 13590              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13591                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13592                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13593                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13594                 MOVE  ER-1910           TO  WS-ERROR
 13595                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13596
 13597     IF PLAN-MASTER-AH-SW = 'Y'
 13598        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13599            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13600               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13601               MOVE  ER-1910           TO  WS-ERROR
 13602               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13603
 13604     IF PLAN-MASTER-AH-SW = 'Y'
 13605        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13606            IF  WS-ERROR    EQUAL    ER-2693
 13607                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13608                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13609                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13610                 MOVE  +0       TO  WS-ERROR.
 13611
 13612     IF WS-ERROR = ER-2693
 13613        IF PB-COMPANY-ID = 'JAL' AND
 13614           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13615           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13616           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13617
 13618     IF WS-ERROR = ER-2693
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 248
* EL050.cbl
 13619        IF PB-COMPANY-ID = 'NCL'  AND
 13620           PB-I-AH-BENEFIT-CD = 'OA'
 13621           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13622           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13623
 13624     IF WS-ERROR = ER-2693
 13625        IF PB-COMPANY-ID = 'CNL' AND
 13626           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13627           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13628           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13629
 13630     IF WS-ERROR = ER-2693
 13631        IF PB-COMPANY-ID = 'HER'
 13632           IF WS-LEVEL
 13633              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13634              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13635
 13636     IF ((LF-BENEFIT-FOUND) AND
 13637         (NOT NO-LIFE-COVERAGE)  AND
 13638         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13639       OR   ((AH-BENEFIT-FOUND) AND
 13640             (NOT NO-AH-COVERAGE)    AND
 13641             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13642         NEXT SENTENCE
 13643     ELSE
 13644         GO TO 3215-EDIT-RATES.
 13645
 13646     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13647        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13648           MOVE ER-2674          TO WS-ERROR
 13649           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13650           GO TO 3215-EDIT-RATES.
 13651
 13652     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13653        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13654           MOVE ER-2674          TO WS-ERROR
 13655           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13656           GO TO 3215-EDIT-RATES.
 13657
 13658     MOVE 'B'                    TO PB-I-OB-FLAG.
 13659
 13660     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13661         NEXT SENTENCE
 13662     ELSE
 13663         IF NOT NO-LIFE-COVERAGE
 13664             IF WS-ACCT-LF-OB-RT = ZERO
 13665                MOVE ER-2641    TO WS-ERROR
 13666                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13667
 13668     IF PB-COMPANY-ID = 'CRI'
 13669       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13670         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13671         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13672         IF WS-ERROR = ER-2675
 13673            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13674            MOVE ER-2687              TO WS-ERROR
 13675            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13676         ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 249
* EL050.cbl
 13677            MOVE ER-2687              TO WS-ERROR
 13678            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13679
 13680
 13681     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13682         NEXT SENTENCE
 13683     ELSE
 13684       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13685            NEXT SENTENCE
 13686       ELSE
 13687         IF NOT NO-AH-COVERAGE
 13688             IF WS-ACCT-AH-OB-RT = ZERO
 13689                MOVE ER-2642    TO WS-ERROR
 13690                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13691
 13692     IF PB-COMPANY-ID = 'CRI'
 13693       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13694         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13695         IF WS-ERROR = ER-2676
 13696            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13697            MOVE ER-2687              TO WS-ERROR
 13698            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13699         ELSE
 13700            MOVE ER-2687              TO WS-ERROR
 13701            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13702
 13703     IF PB-COMPANY-ID NOT = 'GIC'
 13704         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13705            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13706     ELSE
 13707         IF PB-I-LF-PREM-CALC = ZEROS
 13708             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13709                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13710
 13711     IF PB-COMPANY-ID NOT = 'GIC'
 13712         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13713            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13714     ELSE
 13715         IF PB-I-AH-PREM-CALC = ZEROS
 13716             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13717                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13718
 13719     MOVE ZEROS TO PB-I-MORT-CODE.
 13720
 13721     GO TO 3260-EDIT-CONTINUE.
 13722
 13723
 13724 3215-EDIT-RATES.
 13725     IF ACCOUNT-MAST-FOUND
 13726         NEXT SENTENCE
 13727     ELSE
 13728         GO TO 3999-END-EDIT.
 13729
 13730 3220-CHECK-LF-RATES.
 13731
 13732     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13733        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13734        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 250
* EL050.cbl
 13735        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13736           AND (NOT WS-LF-CASH))
 13737                           OR
 13738           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13739           AND (NOT WS-AH-CASH)))
 13740                       AND
 13741           (PB-I-ENTRY-STATUS NOT = '5')
 13742           MOVE 'M'              TO PB-BATCH-ENTRY
 13743                                    PB-I-ENTRY-STATUS
 13744        END-IF
 13745     END-IF
 13746     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13747                                    PB-I-AH-PREM-CALC
 13748                                    PB-I-LF-ALT-PREM-CALC
 13749                                    PB-I-LF-ALT-RATE
 13750                                    PB-I-LF-REI-RATE
 13751                                    PB-I-LF-ALT-REI-RATE
 13752                                    PB-I-AH-REI-RATE
 13753                                    PB-I-TOT-FEES-CALC.
 13754
 13755     IF PB-COMPANY-ID EQUAL 'DMD'
 13756        NEXT SENTENCE
 13757     ELSE
 13758        MOVE ZEROS               TO PB-I-LF-RATE
 13759                                    PB-I-AH-RATE.
 13760
 13761     IF PB-I-TOT-FEES NOT NUMERIC
 13762        MOVE ZEROS               TO PB-I-TOT-FEES
 13763     END-IF
 13764     IF PB-I-LIVES NOT NUMERIC
 13765         MOVE ZERO               TO PB-I-LIVES.
 13766
 13767     IF PB-I-NUM-BILLED NOT NUMERIC
 13768         MOVE ZERO               TO PB-I-NUM-BILLED.
 13769
 13770     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13771        MOVE +0                  TO PB-I-LF-PREM-TAX
 13772     END-IF
 13773
 13774     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13775        MOVE +0                  TO PB-I-AH-PREM-TAX
 13776     END-IF
 13777
 13778     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13779        PB-I-PAY-FREQUENCY = ZEROS
 13780            MOVE 12 TO CP-PAY-FREQUENCY
 13781     ELSE
 13782            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13783
 13784     IF PB-I-STATE-TAX NOT NUMERIC
 13785         MOVE ZEROS               TO PB-I-STATE-TAX.
 13786
 13787     IF PB-I-MUNI-TAX NOT NUMERIC
 13788         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13789
 13790     MOVE SPACES                 TO CP-BEN-CATEGORY
 13791     IF PB-COMPANY-ID  = 'CSL'  AND
 13792        PB-I-LF-TERM NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 251
* EL050.cbl
 13793        COMPUTE WS-PAYMENT-AMT =
 13794             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13795        COMPUTE WS-CSL-AMT1 =
 13796             PB-I-LF-TERM * AM-MAX-MON-BEN
 13797        COMPUTE WS-CSL-AMT2 =
 13798             WS-PAYMENT-AMT * PB-I-LF-TERM
 13799        IF CP-PAY-FREQUENCY NOT = 12
 13800           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13801           MOVE '8' TO WS-CSL-CALC-CD
 13802        ELSE
 13803           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13804              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13805               AM-MAX-TOT-BEN
 13806               MOVE '6' TO WS-CSL-CALC-CD
 13807           ELSE
 13808              IF (WS-CSL-AMT1  GREATER THAN
 13809                 AM-MAX-TOT-BEN) AND
 13810                 (WS-CSL-AMT2  GREATER THAN
 13811                 AM-MAX-TOT-BEN)
 13812                 MOVE '7' TO WS-CSL-CALC-CD
 13813              ELSE
 13814                 MOVE '5' TO WS-CSL-CALC-CD.
 13815
 13816     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13817         NEXT SENTENCE
 13818     ELSE
 13819         GO TO 3300-CHECK-AH-RATES.
 13820
 13821*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13822
 13823     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13824        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13825              OR
 13826           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13827           MOVE ER-2618          TO WS-ERROR
 13828           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13829           GO TO 3300-CHECK-AH-RATES.
 13830
 13831     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13832           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13833                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13834
 13835     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13836         MOVE ER-2687             TO WS-ERROR
 13837         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13838         MOVE 'Z000'              TO PB-I-MORT-CODE
 13839         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13840         GO TO 3300-CHECK-AH-RATES.
 13841
 13842     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13843        IF PB-I-LIVES = ZERO
 13844           MOVE ER-2688          TO WS-ERROR
 13845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13846
 13847     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13848
 13849     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13850     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 252
* EL050.cbl
 13851     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13852     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13853     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13854     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13855     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13856     MOVE '3'                    TO CP-PROCESS-TYPE.
 13857     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13858     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13859
 13860******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13861     IF PB-COMPANY-ID EQUAL 'CDL'
 13862         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13863            CP-EARN-AS-NET-PAY)
 13864             IF PB-CERT-EFF-DT GREATER  WS-931231
 13865                 MOVE '1'        TO CP-EARNING-METHOD.
 13866*******
 13867
 13868     MOVE PB-SV-STATE            TO CP-STATE.
 13869     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13870     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13871     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13872     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13873     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13874                                    CP-RATING-BENEFIT-AMT.
 13875     IF CP-STATE-STD-ABBRV = 'OR'
 13876         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13877                                         PB-I-LF-ALT-BENEFIT-AMT.
 13878     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13879     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13880     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13881     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13882     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13883     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13884     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13885     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13886     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13887                                    CP-REMAINING-TERM
 13888                                    CP-LOAN-TERM.
 13889
 13890     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13891         NEXT SENTENCE
 13892     ELSE
 13893         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13894             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13895                                           PB-I-LF-PREMIUM-AMT.
 13896
 13897     IF PB-COMPANY-ID EQUAL 'CSL'
 13898        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13899           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13900                                         PB-I-LF-PREMIUM-AMT.
 13901
 13902     IF PB-COMPANY-ID EQUAL 'NCB'
 13903         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13904            CP-EARN-AS-NET-PAY
 13905             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13906                 PB-I-LF-PREMIUM-AMT.
 13907
 13908     IF (CP-TRUNCATED-LIFE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 253
* EL050.cbl
 13909        or ((pb-company-id = 'AHL')
 13910           and (pb-i-loan-term > pb-i-lf-term))
 13911        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13912
 13913     IF PB-COMPANY-ID EQUAL 'CRI'
 13914        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13915
 13916     IF CP-TERM-IS-DAYS
 13917         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13918     ELSE
 13919         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13920     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13921        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13922        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13923        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13924        IF WS-LF-BEN-CATEGORY = 'D'
 13925           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13926           MOVE PB-I-LIFE-COMMISSION
 13927                                 TO CP-DCC-ACT-COMM
 13928           MOVE WS-LF-BEN-CATEGORY
 13929                                 TO CP-BEN-CATEGORY
 13930        END-IF
 13931        IF (CP-BENEFIT-CD (1:1) = 'P')
 13932           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13933           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13934           add pb-i-ah-premium-amt to cp-original-premium
 13935        END-IF
 13936     END-IF
 13937     IF PB-COMPANY-ID = 'CSL'
 13938         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13939         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13940         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13941
 13942     IF PB-COMPANY-ID = 'CSL'
 13943        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13944
 13945     IF (CP-SPECIAL-CALC-CD = 'H')
 13946        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13947         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13948                                    TO CP-ALTERNATE-BENEFIT
 13949         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13950     if (pb-company-id = 'CID')
 13951        and (ws-lf-earnings-calc = '4')
 13952        and (cp-state-std-abbrv = 'MN' OR 'WA' or 'AL')
 13953        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13954        move pb-i-term-type      to cp-pmt-mode
 13955        move pb-i-no-of-payments to cp-no-of-pmts
 13956        move pb-i-ah-benefit-amt to cp-monthly-payment
 13957     end-if
 13958     move ws-net-only-state      to cp-net-only-state
 13959     IF (PB-COMPANY-ID = 'CID')
 13960        AND (WS-LF-EARNINGS-CALC = 'B')
 13961        AND (CP-STATE-STD-ABBRV = 'MN')
 13962        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13963                                 TO CP-ALTERNATE-BENEFIT
 13964        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13965     END-IF
 13966     IF (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 254
* EL050.cbl
 13967        AND (WS-LF-EARNINGS-CALC = 'B')
 13968        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13969                                 TO CP-ALTERNATE-BENEFIT
 13970        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13971        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13972*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13973*         pb-i-lf-alt-premium-amt
 13974        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13975        IF WS-LF-BEN-CATEGORY = 'P'
 13976           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13977        ELSE
 13978           IF WS-LF-BEN-CATEGORY = 'I'
 13979              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13980           END-IF
 13981        END-IF
 13982     END-IF
 13983     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13984     MOVE 'R'                   TO CP-RATE-FILE.
 13985     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13986
 13987     IF CP-ERROR-RATE-NOT-FOUND
 13988        MOVE ER-2641            TO WS-ERROR
 13989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13990        GO TO 3300-CHECK-AH-RATES.
 13991
 13992     IF PB-COMPANY-ID EQUAL 'CRI'
 13993        IF CP-ERROR-NO-LIMITS-CRI
 13994           IF NOT ACCOUNT-LIFE-CHECKED
 13995              MOVE ER-2607      TO WS-ERROR
 13996              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13997
 13998******************************************************************
 13999*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 14000*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14001******************************************************************
 14002
 14003* CALC LIFE AGE AT EXPIRATION.
 14004
 14005     COMPUTE WS-AGE-AT-EXPIRE =
 14006          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 14007
 14008*    IF PB-STATE = 'CO' OR 'UT'
 14009*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14010*        MOVE 'F'            TO PB-FATAL-FLAG
 14011*        MOVE ER-2709        TO WS-ERROR
 14012*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14013*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14014
 14015*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14016*        MOVE 'X'            TO PB-FATAL-FLAG
 14017*        MOVE ER-2718        TO WS-ERROR
 14018*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14019*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14020
 14021* CALC A & H AGE AT EXPIRATION.
 14022
 14023     COMPUTE WS-AGE-AT-EXPIRE =
 14024          ((PB-I-AH-TERM / 12) + PB-I-AGE).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 255
* EL050.cbl
 14025
 14026*    IF PB-STATE = 'CO' OR 'UT'
 14027*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14028*        MOVE 'F'            TO PB-FATAL-FLAG
 14029*        MOVE ER-2709        TO WS-ERROR
 14030*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14031*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14032
 14033*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14034*        MOVE 'X'            TO PB-FATAL-FLAG
 14035*        MOVE ER-2718        TO WS-ERROR
 14036*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14037*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14038
 14039     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 14040        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14041
 14042     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14043        and (not pb-monthly-cert)
 14044        GO TO 3221-CHECK-ERROR-RATE-OPEN
 14045     end-if
 14046
 14047     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14048        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14049
 14050     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14051         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 14052         MOVE ER-2639        TO WS-ERROR
 14053         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14054
 14055
 14056******************************************************************
 14057*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14058******************************************************************
 14059
 14060 PREMIUM-EDITING-IS-BYPASSED.
 14061     IF (CP-R-MAX-ATT-AGE NUMERIC)
 14062        AND (CP-R-MAX-ATT-AGE > +0)
 14063        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14064        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14065           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14066           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14067           MOVE '1'              TO DC-OPTION-CODE
 14068           PERFORM 8500-DATE-CONVERT
 14069                                 THRU 8500-EXIT
 14070           IF NO-CONVERSION-ERROR
 14071              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14072                 MOVE ER-2661       TO WS-ERROR
 14073*                PERFORM 9900-ERROR-FORMAT
 14074*                                THRU 9900-EXIT
 14075              END-IF
 14076           END-IF
 14077        ELSE
 14078           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14079           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14080              MOVE ER-2661       TO WS-ERROR
 14081*             PERFORM 9900-ERROR-FORMAT
 14082*                                THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 256
* EL050.cbl
 14083           ELSE
 14084              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14085                 MOVE ER-1570    TO WS-ERROR
 14086                 PERFORM 9900-ERROR-FORMAT
 14087                                 THRU 9900-EXIT
 14088              END-IF
 14089           END-IF
 14090        END-IF
 14091        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14092           MOVE PB-I-JOINT-BIRTHDAY
 14093                                 TO DC-BIN-DATE-1
 14094           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14095           MOVE '1'              TO DC-OPTION-CODE
 14096           PERFORM 8500-DATE-CONVERT
 14097                                 THRU 8500-EXIT
 14098           IF NO-CONVERSION-ERROR
 14099              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14100                 MOVE ER-2661       TO WS-ERROR
 14101*                PERFORM 9900-ERROR-FORMAT
 14102*                                THRU 9900-EXIT
 14103              END-IF
 14104           ELSE
 14105              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14106           END-IF
 14107        ELSE
 14108           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14109             (PB-I-LF-TERM / 12)
 14110           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14111              MOVE ER-2661       TO WS-ERROR
 14112*             PERFORM 9900-ERROR-FORMAT
 14113*                                THRU 9900-EXIT
 14114           ELSE
 14115              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14116                 MOVE ER-1571    TO WS-ERROR
 14117                 PERFORM 9900-ERROR-FORMAT
 14118                                 THRU 9900-EXIT
 14119              END-IF
 14120           END-IF
 14121        END-IF
 14122        IF WS-ERROR = ER-2661
 14123           PERFORM 9900-ERROR-FORMAT
 14124                                 THRU 9900-EXIT
 14125        END-IF
 14126     END-IF
 14127*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14128*       MOVE ER-2661             TO WS-ERROR
 14129*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14130
 14131     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14132        MOVE ER-2662             TO WS-ERROR
 14133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14134
 14135     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14136        MOVE ER-2677             TO WS-ERROR
 14137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14138
 14139     IF CP-ERROR-LOAN-TERM
 14140        MOVE ER-2648             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 257
* EL050.cbl
 14141        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14142     if cp-error-term-below-minimum
 14143        move er-3070             to ws-error
 14144        perform 9900-error-format thru 9900-exit
 14145     end-if
 14146     .
 14147 3221-CHECK-ERROR-RATE-OPEN.
 14148
 14149     IF CP-ERROR-RATE-FILE-NOTOPEN
 14150         GO TO 3990-FILES-NOT-OPEN.
 14151
 14152     IF PB-COMPANY-ID NOT = 'DMD'
 14153        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14154     END-IF
 14155     .
 14156 3221-CONTINUE.
 14157     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14158                                    WS-DCC-AH-RATE
 14159     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14160        IF WS-LF-BEN-CATEGORY = 'D'
 14161           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14162              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14163        END-IF
 14164     END-IF
 14165     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14166*   X'A4FF' = 12/31/2009
 14167     IF (PB-COMPANY-ID = 'CID')
 14168        AND (WS-LF-EARNINGS-CALC = 'B')
 14169        AND (CP-STATE-STD-ABBRV = 'MN')
 14170        AND (PB-CERT-EFF-DT > X'A4FF')
 14171        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14172     END-IF
 14173     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14174
 14175     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14176     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14177        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14178        AND (PB-I-POLICY-IS-MONTHLY)
 14179        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14180        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14181     END-IF
 14182     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14183     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14184     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14185     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14186     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14187        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14188        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14189        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14190        MOVE ER-2786             TO WS-ERROR
 14191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14192     END-IF
 14193
 14194     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14195
 14196******************************************************************
 14197*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14198******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 258
* EL050.cbl
 14199     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14200        and ((not pb-monthly-cert)
 14201        or (ws-lf-ben-category = 'C'))
 14202        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14203
 14204     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14205        GO TO 3225-CHECK-ALT-LIFE-RATE
 14206     ELSE
 14207       IF PB-I-LF-RATE = ZERO
 14208          MOVE ER-2641          TO WS-ERROR
 14209          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14210
 14211 3225-CHECK-ALT-LIFE-RATE.
 14212
 14213     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14214        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14215        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14216         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14217
 14218     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14219         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14220             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14221                   OR
 14222              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14223              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14224              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14225             MOVE ER-2720        TO  WS-ERROR
 14226             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14227             GO TO 3225-RATING-CONT
 14228         ELSE
 14229             GO TO 3225-RATING-CONT.
 14230     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14231        AND (AM-GPCD = 01 OR 06 OR 15)
 14232        MOVE ER-2798             TO WS-ERROR
 14233        PERFORM 9900-ERROR-FORMAT
 14234                                 THRU 9900-EXIT
 14235*       GO TO 3225-RATING-CONT
 14236     END-IF
 14237     if (pb-company-id = 'CID')
 14238        and (ws-lf-earnings-calc = 'B')
 14239        and (ws-lf-ben-category = 'P' or 'I')
 14240        and (ws-net-only-state = 'Y')
 14241        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14242*       display ' balloon prem ' pb-i-lf-alt-prem-calc
 14243        go to 3225-rating-cont
 14244     end-if
 14245     IF (PB-COMPANY-ID = 'CID')
 14246        AND (WS-LF-EARNINGS-CALC = 'B')
 14247        AND (CP-STATE-STD-ABBRV = 'MN')
 14248        AND (PB-CERT-EFF-DT > X'A4FF')
 14249        GO TO 3225-RATING-CONT
 14250     END-IF
 14251     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14252        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14253           AND (PB-I-POLICY-IS-MONTHLY)
 14254           GO TO 3225-RATING-CONT
 14255        END-IF
 14256     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 259
* EL050.cbl
 14257
 14258     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14259        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14260        CP-EARN-AS-REG-BALLOON
 14261        NEXT SENTENCE
 14262     ELSE
 14263        MOVE '2'                 TO CP-EARNING-METHOD.
 14264
 14265 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14266
 14267     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14268
 14269     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14270        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14271        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14272         NEXT SENTENCE
 14273     ELSE
 14274         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14275
 14276     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14277     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14278     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14279                                     CP-RATING-BENEFIT-AMT.
 14280     IF CP-STATE-STD-ABBRV = 'OR'
 14281         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14282                                         PB-I-LF-ALT-BENEFIT-AMT.
 14283     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14284        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14285     END-IF
 14286     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14287     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14288     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14289                                    CP-REMAINING-TERM
 14290                                    CP-LOAN-TERM.
 14291     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14292        ADD +1                   TO CP-ORIGINAL-TERM
 14293                                    CP-REMAINING-TERM
 14294                                    CP-LOAN-TERM.
 14295
 14296     MOVE 'R'                   TO CP-RATE-FILE.
 14297     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14298
 14299     IF CP-ERROR-RATE-NOT-FOUND
 14300         MOVE ER-2641            TO WS-ERROR
 14301         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14302         GO TO 3300-CHECK-AH-RATES.
 14303
 14304     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14305     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14306
 14307     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14308         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14309
 14310     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14311                               + PB-I-LF-ALT-BENEFIT-AMT.
 14312
 14313     IF ACCOUNT-LIFE-CHECKED  OR
 14314        PB-POLICY-IS-VOIDED   OR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 260
* EL050.cbl
 14315        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14316        and (not pb-monthly-cert))
 14317        GO TO 3225-CONTINUE.
 14318
 14319     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14320        GO TO 3225-CONTINUE.
 14321
 14322     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14323                             EC-RT-LF-MAX-TOT-BEN
 14324        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14325        MOVE ER-2639       TO WS-ERROR
 14326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14327
 14328 3225-CONTINUE.
 14329     IF PB-I-LF-ALT-RATE = ZERO
 14330         MOVE ER-2659            TO WS-ERROR
 14331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14332
 14333     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14334        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14335        MOVE ER-2698             TO WS-ERROR
 14336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14337
 14338 3225-RATING-CONT.
 14339
 14340     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14341        and (not pb-monthly-cert)
 14342         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14343         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14344         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14345            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14346            CONTINUE
 14347         ELSE
 14348            MOVE ER-2687         TO WS-ERROR
 14349            PERFORM 9900-ERROR-FORMAT
 14350                                 THRU 9900-EXIT
 14351         END-IF
 14352         GO TO 3290-EDIT-LF-REIN-RATE
 14353     END-IF
 14354
 14355* DMD RATING TEST
 14356     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14357         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14358         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14359         MOVE ER-2687                 TO WS-ERROR
 14360         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14361         GO TO 3290-EDIT-LF-REIN-RATE.
 14362
 14363 3230-CLIENT-MORT-CD-SPECIALS.
 14364
 14365     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14366     SET BIN-TO-GREG          TO TRUE.
 14367*    MOVE ' '                 TO DC-OPTION-CODE.
 14368     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14369     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14370
 14371 C-POS-3230-MORT-CD.
 14372     IF PB-COMPANY-ID = 'POS' AND
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 261
* EL050.cbl
 14373        PB-SV-CARRIER = '2'
 14374         NEXT SENTENCE
 14375     ELSE
 14376         GO TO C-POS-3240-MORT-CD.
 14377
 14378     IF PB-SV-GROUPING = '030'
 14379        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14380         MOVE '2350' TO PB-I-MORT-CODE
 14381      ELSE
 14382         MOVE '3300' TO PB-I-MORT-CODE.
 14383
 14384
 14385 C-POS-3240-MORT-CD.
 14386     IF PB-COMPANY-ID = 'POS' AND
 14387        PB-SV-CARRIER = '1'
 14388         NEXT SENTENCE
 14389     ELSE
 14390         GO TO 3230-CONTINUE.
 14391
 14392     IF PB-SV-STATE = '45' OR '47'
 14393        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14394         MOVE '5200' TO PB-I-MORT-CODE
 14395     ELSE
 14396         MOVE '8300' TO PB-I-MORT-CODE.
 14397
 14398 3230-CONTINUE.
 14399
 14400     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14401        GO TO 3240-CONTINUE
 14402     END-IF
 14403
 14404     IF PB-CERT-EFF-DT > WS-971231
 14405        GO TO 3240-CONTINUE
 14406     END-IF
 14407
 14408     IF LF-BENEFIT-FOUND AND
 14409        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14410         MOVE 'F250'       TO PB-I-MORT-CODE
 14411     ELSE
 14412         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14413             MOVE '7250'   TO PB-I-MORT-CODE
 14414         ELSE
 14415             MOVE '4251'   TO PB-I-MORT-CODE
 14416         END-IF
 14417     END-IF
 14418
 14419     .
 14420 3240-CONTINUE.
 14421
 14422     IF PB-COMPANY-ID NOT = 'GNL'
 14423         GO TO 3256-CONTINUE.
 14424
 14425     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14426         MOVE 'A300' TO PB-I-MORT-CODE
 14427     ELSE
 14428         MOVE '8350' TO PB-I-MORT-CODE.
 14429
 14430 3256-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 262
* EL050.cbl
 14431     IF PB-COMPANY-ID NOT = 'ABL'
 14432         GO TO 3260-EDIT-CONTINUE.
 14433
 14434     IF PB-I-LF-TERM GREATER THAN 59
 14435         MOVE 'F550' TO PB-I-MORT-CODE
 14436     ELSE
 14437         MOVE 'E550' TO PB-I-MORT-CODE.
 14438
 14439 3260-EDIT-CONTINUE.
 14440     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14441
 14442 3290-EDIT-LF-REIN-RATE.
 14443     IF LF-REIN-NSP-NOT-USED
 14444         GO TO 3290-RATING-CONT.
 14445
 14446     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14447        GO TO 3290-RATING-CONT.
 14448     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14449     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14450     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14451     MOVE '3'                   TO CP-PROCESS-TYPE.
 14452     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14453
 14454******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14455     IF PB-COMPANY-ID EQUAL 'CDL'
 14456         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14457            CP-EARN-AS-NET-PAY)
 14458             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14459*            MOVE SPACE          TO DC-OPTION-CODE
 14460             SET BIN-TO-GREG     TO TRUE
 14461             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14462***  Y2K PROJ 7744
 14463             IF DC-GREG-DATE-CYMD GREATER 19931231
 14464                 MOVE '1'        TO CP-EARNING-METHOD.
 14465***  Y2K PROJ 7744
 14466*******
 14467
 14468     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14469     MOVE PB-SV-STATE           TO CP-STATE.
 14470     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14471     MOVE ZERO                  TO CP-DEVIATION-CODE
 14472                                   CP-RATE-DEV-PCT.
 14473     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14474     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14475                                   CP-RATING-BENEFIT-AMT.
 14476
 14477************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14478     IF PB-COMPANY-ID EQUAL 'NCB'
 14479         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14480            CP-EARN-AS-NET-PAY
 14481             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14482                 PB-I-LF-PREMIUM-AMT.
 14483************
 14484
 14485     IF CP-STATE-STD-ABBRV = 'OR'
 14486         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14487                                         PB-I-LF-ALT-BENEFIT-AMT.
 14488     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 263
* EL050.cbl
 14489     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14490     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14491     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14492     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14493     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14494     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14495     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14496                                   CP-REMAINING-TERM
 14497                                   CP-LOAN-TERM.
 14498     IF CP-TRUNCATED-LIFE
 14499        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14500
 14501     IF CP-TERM-IS-DAYS
 14502         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14503     ELSE
 14504         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14505
 14506     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14507        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14508     END-IF
 14509     IF PB-COMPANY-ID NOT = 'TIC'
 14510          MOVE ZERO          TO CP-CLASS-CODE.
 14511
 14512     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14513
 14514     MOVE 'R'                   TO CP-RATE-FILE.
 14515     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14516
 14517     IF CP-ERROR-RATE-NOT-FOUND
 14518        IF PB-I-OB
 14519           MOVE ER-2625      TO WS-ERROR
 14520           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14521           GO TO 3299-EDIT-CONTINUE
 14522        ELSE
 14523           MOVE ER-2643      TO WS-ERROR
 14524           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14525           GO TO 3299-EDIT-CONTINUE.
 14526
 14527     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14528
 14529     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14530     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14531
 14532     IF PB-I-LF-REI-RATE = ZERO
 14533         MOVE ER-2643        TO WS-ERROR
 14534         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14535
 14536 3290-CHECK-ALT-REIN-RATE.
 14537
 14538     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14539        GO TO 3290-RATING-CONT.
 14540
 14541     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14542     MOVE '2'                    TO CP-EARNING-METHOD.
 14543     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14544     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14545     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14546     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 264
* EL050.cbl
 14547                                     CP-RATING-BENEFIT-AMT.
 14548     IF CP-STATE-STD-ABBRV = 'OR'
 14549         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14550                                         PB-I-LF-ALT-BENEFIT-AMT.
 14551     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14552        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14553     END-IF
 14554     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14555     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14556     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14557                                    CP-REMAINING-TERM
 14558                                    CP-LOAN-TERM.
 14559     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14560        ADD +1                   TO CP-ORIGINAL-TERM
 14561                                    CP-REMAINING-TERM
 14562                                    CP-LOAN-TERM.
 14563
 14564     MOVE 'R'                   TO CP-RATE-FILE.
 14565     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14566
 14567     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14568
 14569     IF PB-I-LF-ALT-REI-RATE = ZERO
 14570         MOVE ER-2643            TO WS-ERROR
 14571         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14572
 14573 3290-RATING-CONT.
 14574
 14575     IF PB-I-OB
 14576*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14577        GO TO 3300-CHECK-AH-RATES.
 14578
 14579 3299-EDIT-CONTINUE.
 14580
 14581     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14582         NEXT SENTENCE
 14583     ELSE
 14584         MOVE ER-2620           TO WS-ERROR
 14585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14586
 14587 3300-CHECK-AH-RATES.
 14588     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14589         NEXT SENTENCE
 14590     ELSE
 14591         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14592
 14593     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14594        and (not pb-monthly-cert))
 14595                  or
 14596        ((CF-COMPANY-ID = 'DMD') AND
 14597                (NO-DMD-RATING))
 14598         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14599            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14600            CONTINUE
 14601         ELSE
 14602            MOVE ER-2687         TO WS-ERROR
 14603            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14604         END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 265
* EL050.cbl
 14605         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14606         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14607     END-IF
 14608
 14609     IF PB-I-OB
 14610        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14611
 14612     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14613         MOVE ER-2687             TO WS-ERROR
 14614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14615         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14616         GO TO 3999-END-EDIT.
 14617
 14618*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14619     if pb-company-id = 'AHL'
 14620        go to 3300-skip-crit-per
 14621     end-if
 14622     if (pb-i-ah-crit-per not = zeros)
 14623        and (ws-ah-special-calc-cd not = 'C')
 14624        MOVE ER-1572             TO WS-ERROR
 14625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14626        go to 3300-skip-crit-per
 14627     END-IF
 14628     if (pb-company-id = 'DCC' or 'VPP')
 14629        and (am-dcc-product-code not = spaces)
 14630        go to 3300-skip-crit-per
 14631     end-if
 14632     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14633        IF PB-I-AH-CRIT-PER = ZERO
 14634           move ws-ah-max-bens   to pb-i-ah-crit-per
 14635*          MOVE ER-2618       TO WS-ERROR
 14636*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14637*          GO TO 3999-END-EDIT
 14638        END-IF
 14639     END-IF
 14640     if (ws-ah-special-calc-cd = 'C')
 14641        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14642        MOVE ER-1576             TO WS-ERROR
 14643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14644     end-if
 14645
 14646     .
 14647 3300-skip-crit-per.
 14648     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14649     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14650     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14651     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14652     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14653     MOVE PB-SV-STATE            TO CP-STATE.
 14654     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14655     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14656     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14657*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14658     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14659     MOVE '3'                    TO CP-PROCESS-TYPE.
 14660     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14661     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14662                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 266
* EL050.cbl
 14663     IF PB-COMPANY-ID = 'CID'
 14664               OR
 14665        CP-STATE-STD-ABBRV = 'OR'
 14666         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14667                                         PB-I-AH-TERM.
 14668     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14669        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14670           AND (PB-I-POLICY-IS-MONTHLY)
 14671           MOVE PB-I-LF-BENEFIT-AMT
 14672                                 TO CP-NET-BENEFIT-AMT
 14673           move pb-i-ah-premium-amt to cp-original-premium
 14674           add pb-i-lf-premium-amt to cp-original-premium
 14675        END-IF
 14676     END-IF
 14677     MOVE SPACES                 TO CP-BEN-CATEGORY
 14678     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14679        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14680        EVALUATE TRUE
 14681           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14682              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14683              MOVE PB-I-LF-BENEFIT-AMT
 14684                                 TO CP-RATING-BENEFIT-AMT
 14685              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14686           WHEN WS-AH-BEN-CATEGORY = 'G'
 14687              MOVE PB-I-UNPAID-CASH-PRICE
 14688                                 TO CP-RATING-BENEFIT-AMT
 14689           WHEN WS-AH-BEN-CATEGORY = 'D'
 14690              MOVE WS-AH-PMF-COMM
 14691                                 TO CP-DCC-PMF-COMM
 14692              MOVE PB-I-AH-COMMISSION
 14693                                 TO CP-DCC-ACT-COMM
 14694        END-EVALUATE
 14695     END-IF
 14696     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14697     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14698     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14699     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14700     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14701     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14702     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14703                                    CP-REMAINING-TERM
 14704                                    WS-WORK-TERM.
 14705     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14706
 14707     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14708     SET BIN-TO-GREG             TO TRUE.
 14709*    MOVE ' '                    TO DC-OPTION-CODE.
 14710     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14711     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14712
 14713     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14714     IF NOT VALID-SKIP-CODE
 14715         MOVE ER-2683            TO WS-ERROR
 14716         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14717         GO TO 3320-RATE-CONTINUE.
 14718
 14719     IF PB-NO-MONTHS-SKIPPED
 14720         GO TO 3320-RATE-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 267
* EL050.cbl
 14721
 14722     MOVE SPACE TO NUMBER-OF-MONTHS.
 14723
 14724     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14725         MOVE 'S'                TO SK-MO (6).
 14726     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14727         MOVE 'S'                TO SK-MO (7).
 14728     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14729         MOVE 'S'                TO SK-MO (8).
 14730     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14731         MOVE 'S'                TO SK-MO (9).
 14732     IF PB-I-SKIP-CODE = 'A'
 14733         MOVE 'S'                TO SK-MO (10).
 14734
 14735     MOVE 1                      TO SUB2.
 14736     MOVE PB-I-AH-TERM           TO SUB3.
 14737     MOVE WS-MONTH               TO SUB1.
 14738     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14739     GO TO 3320-RATE-CONTINUE.
 14740
 14741 3310-GET-SKIP-MO.
 14742     IF SUB1 = 13
 14743         MOVE 1                  TO SUB1.
 14744
 14745     IF SK-MO (SUB1) = 'S'
 14746         SUBTRACT 1 FROM WS-WORK-TERM.
 14747
 14748     ADD 1 TO SUB2
 14749              SUB1.
 14750
 14751 3320-RATE-CONTINUE.
 14752
 14753     IF WS-WORK-TERM = ZERO
 14754         MOVE 1                  TO WS-WORK-TERM.
 14755
 14756     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14757                                    CP-LOAN-TERM.
 14758
 14759     IF PB-COMPANY-ID EQUAL 'DMD'
 14760         NEXT SENTENCE
 14761     ELSE
 14762         MOVE ZERO               TO PB-I-AH-RATE
 14763                                    PB-I-AH-REI-RATE.
 14764
 14765
 14766     IF PB-COMPANY-ID EQUAL 'CRI'
 14767        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14768
 14769     IF PB-COMPANY-ID = 'CSL'
 14770         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14771         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14772         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14773         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14774
 14775     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14776        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14777           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14778              PB-I-RATE-DEV-PCT-LF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 268
* EL050.cbl
 14779        END-IF
 14780        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14781                                 TO CP-ALTERNATE-BENEFIT
 14782        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14783        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14784        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14785     END-IF
 14786*    if ws-clp-state not = spaces
 14787*       move ws-clp-state to cp-state
 14788*    end-if
 14789     IF (PB-COMPANY-ID = 'CID')
 14790        AND (WS-LF-EARNINGS-CALC = 'B')
 14791        AND (CP-STATE-STD-ABBRV = 'MN')
 14792        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14793     ELSE
 14794        MOVE ' '                 TO CP-AH-BALLOON-SW
 14795     END-IF
 14796     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14797     MOVE 'R'                   TO CP-RATE-FILE.
 14798     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14799
 14800     IF (CP-ERROR-RATE-NOT-FOUND)
 14801        and (not pb-monthly-cert)
 14802        IF PB-I-OB
 14803           MOVE ER-2624          TO WS-ERROR
 14804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14805           GO TO 3340-CALCULATE-PREMIUM-AMT
 14806        ELSE
 14807          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14808              NEXT SENTENCE
 14809          ELSE
 14810           MOVE ER-2642          TO WS-ERROR
 14811           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14812           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14813
 14814     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14815        CP-ERROR-DIV-BY-ZERO
 14816           MOVE ER-3782          TO WS-ERROR
 14817           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14818
 14819     IF PB-COMPANY-ID EQUAL 'CRI'
 14820        IF CP-ERROR-NO-LIMITS-CRI
 14821           IF NOT ACCOUNT-AH-CHECKED
 14822              MOVE ER-2607          TO WS-ERROR
 14823              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14824
 14825     IF ACCOUNT-AH-CHECKED
 14826        NEXT SENTENCE
 14827     ELSE
 14828       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14829          MOVE ER-2640           TO WS-ERROR
 14830          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14831
 14832     IF PB-COMPANY-ID = 'CRI'
 14833         IF WS-ERROR = ER-2640
 14834             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14835     IF ACCOUNT-AH-CHECKED
 14836        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 269
* EL050.cbl
 14837     ELSE
 14838        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14839           AND (CP-R-MAX-ATT-AGE > +0)
 14840           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14841           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14842              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14843              MOVE PB-I-AH-EXPIRE-DT
 14844                                 TO DC-BIN-DATE-2
 14845              MOVE '1'           TO DC-OPTION-CODE
 14846              PERFORM 8500-DATE-CONVERT
 14847                                 THRU 8500-EXIT
 14848              IF NO-CONVERSION-ERROR
 14849                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14850                    MOVE ER-2661       TO WS-ERROR
 14851*                   PERFORM 9900-ERROR-FORMAT
 14852*                                THRU 9900-EXIT
 14853                 END-IF
 14854              END-IF
 14855           ELSE
 14856              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14857              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14858                 MOVE ER-2661    TO WS-ERROR
 14859*                PERFORM 9900-ERROR-FORMAT
 14860*                                THRU 9900-EXIT
 14861              ELSE
 14862                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14863                    MOVE ER-1570 TO WS-ERROR
 14864                    PERFORM 9900-ERROR-FORMAT
 14865                                 THRU 9900-EXIT
 14866                 END-IF
 14867              END-IF
 14868           END-IF
 14869           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14870              MOVE PB-I-JOINT-BIRTHDAY
 14871                                    TO DC-BIN-DATE-1
 14872              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14873              MOVE '1'              TO DC-OPTION-CODE
 14874              PERFORM 8500-DATE-CONVERT
 14875                                    THRU 8500-EXIT
 14876              IF NO-CONVERSION-ERROR
 14877                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14878                    MOVE ER-2661       TO WS-ERROR
 14879*                   PERFORM 9900-ERROR-FORMAT
 14880*                                   THRU 9900-EXIT
 14881                 END-IF
 14882              END-IF
 14883           ELSE
 14884              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14885                (PB-I-AH-TERM / 12)
 14886              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14887                 MOVE ER-2661       TO WS-ERROR
 14888*                PERFORM 9900-ERROR-FORMAT
 14889*                                   THRU 9900-EXIT
 14890              ELSE
 14891                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14892                    MOVE ER-1571 TO WS-ERROR
 14893                    PERFORM 9900-ERROR-FORMAT
 14894                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 270
* EL050.cbl
 14895                 END-IF
 14896              END-IF
 14897           END-IF
 14898           IF WS-ERROR = ER-2661
 14899              PERFORM 9900-ERROR-FORMAT
 14900                                    THRU 9900-EXIT
 14901           END-IF
 14902        END-IF
 14903     END-IF
 14904*    IF ACCOUNT-AH-CHECKED
 14905*       NEXT SENTENCE
 14906*    ELSE
 14907*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14908*          MOVE ER-2661          TO WS-ERROR
 14909*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14910
 14911     IF ACCOUNT-AH-CHECKED
 14912        NEXT SENTENCE
 14913     ELSE
 14914        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14915           MOVE ER-2663          TO WS-ERROR
 14916           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14917
 14918     IF ACCOUNT-AH-CHECKED OR
 14919        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14920         PB-POLICY-IS-VOIDED
 14921        NEXT SENTENCE
 14922     ELSE
 14923        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14924           MOVE ER-2667            TO WS-ERROR
 14925           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14926
 14927     IF PB-COMPANY-ID = 'CRI'
 14928         IF WS-ERROR = ER-2667
 14929             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14930
 14931     IF ACCOUNT-AH-CHECKED
 14932        NEXT SENTENCE
 14933     ELSE
 14934        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14935           MOVE ER-2678            TO WS-ERROR
 14936           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14937
 14938     IF CP-ERROR-RATE-FILE-NOTOPEN
 14939         GO TO 3990-FILES-NOT-OPEN.
 14940
 14941 3321-CONTINUE.
 14942     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14943     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14944     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14945*    IF (PB-COMPANY-ID = 'DCC')
 14946        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14947        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14948                                    PB-I-LF-ALT-PREM-CALC
 14949        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14950        IF WS-AH-BEN-CATEGORY = 'G'
 14951           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14952           + PB-I-ADDL-CLP)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 271
* EL050.cbl
 14953           * (1 + WS-TOL-CLP-PCT)
 14954*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14955        ELSE
 14956           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14957           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14958*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14959        END-IF
 14960        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14961                                 TO PB-I-AH-PREM-CALC
 14962        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14963           MOVE ER-8152          TO WS-ERROR
 14964           PERFORM 9900-ERROR-FORMAT
 14965                                 THRU 9900-EXIT
 14966        ELSE
 14967           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14968                 PB-I-ADDL-CLP)
 14969              MOVE ER-8148       TO WS-ERROR
 14970              PERFORM 9900-ERROR-FORMAT
 14971                                 THRU 9900-EXIT
 14972           END-IF
 14973        END-IF
 14974     END-IF
 14975     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14976        AND (PB-I-POLICY-IS-MONTHLY)
 14977        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14978        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14979        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14980           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14981        END-IF
 14982     END-IF
 14983     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14984        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14985        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14986        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14987        MOVE ER-2786             TO WS-ERROR
 14988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14989     END-IF
 14990     MOVE +0                     TO PB-I-AH-CLP
 14991     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14992        evaluate true
 14993           when WS-AH-BEN-CATEGORY = 'D'
 14994              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14995                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14996           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14997              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14998           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14999              compute ws-cred-union-fees rounded =
 15000                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 15001                    pb-i-ah-commission)
 15002              COMPUTE PB-I-AH-CLP =
 15003                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15004        end-evaluate
 15005     END-IF
 15006     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 15007
 15008     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 15009         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 15010
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 272
* EL050.cbl
 15011     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 15012         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 15013
 15014     if (ws-ah-special-calc-cd = 'E')
 15015        and (pb-monthly-cert)
 15016        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15017     end-if
 15018     IF PB-COMPANY-ID = 'CRI'
 15019         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 15020            PB-I-PAYMENT-AMOUNT = ZERO
 15021             NEXT SENTENCE
 15022         ELSE
 15023             COMPUTE PB-I-AH-PREM-CALC =
 15024                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 15025                 (CP-PREMIUM-RATE / 100)
 15026             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 15027                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 15028                                             PB-I-RATE-DEV-PCT-AH.
 15029
 15030     IF (PB-I-AH-RATE  = ZERO)
 15031        and (not pb-monthly-cert)
 15032       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15033           NEXT SENTENCE
 15034       ELSE
 15035         MOVE ER-2642            TO WS-ERROR
 15036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15037
 15038     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 15039     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 15040     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 15041     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 15042     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 15043     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 15044
 15045     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15046        AND (WS-AH-BEN-CATEGORY = 'G')
 15047        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15048        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 15049        IF CP-DEVIATION-CODE NOT = '000'
 15050           MOVE '000'            TO CP-DEVIATION-CODE
 15051           PERFORM 7000-GET-RATE THRU 7000-EXIT
 15052           IF NO-CP-ERROR
 15053              COMPUTE PB-I-DDF-IU-RATE-UP =
 15054              PB-I-AH-CLP - CP-CALC-PREMIUM
 15055           ELSE
 15056              MOVE ER-3057        TO WS-ERROR
 15057              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15058           END-IF
 15059        END-IF
 15060     END-IF
 15061     .
 15062 3335-EDIT-AH-REIN-NSP-RATE.
 15063     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15064        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 15065              compute ws-cred-union-fees rounded =
 15066                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 15067                    pb-i-ah-commission)
 15068              COMPUTE PB-I-AH-CLP =
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 273
* EL050.cbl
 15069                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15070        end-if
 15071     END-IF
 15072     IF AH-REIN-NSP-NOT-USED
 15073         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15074
 15075     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15076     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15077         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15078     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 15079     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15080     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15081     MOVE PB-SV-STATE            TO CP-STATE.
 15082     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15083     MOVE ZERO                   TO CP-DEVIATION-CODE
 15084                                    CP-RATE-DEV-PCT.
 15085*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15086     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15087     MOVE '3'                    TO CP-PROCESS-TYPE.
 15088     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15089     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15090                                    CP-RATING-BENEFIT-AMT.
 15091     IF CP-STATE-STD-ABBRV = 'OR'
 15092         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 15093                                         PB-I-AH-TERM.
 15094     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 15095     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15096     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15097     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15098     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15099     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15100                                    CP-REMAINING-TERM
 15101                                    WS-WORK-TERM.
 15102     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15103     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15104        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15105     END-IF
 15106     IF  PB-COMPANY-ID = 'TIC'
 15107         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15108            MOVE ZERO TO CP-CLASS-CODE.
 15109
 15110     IF PB-COMPANY-ID NOT = 'TIC'
 15111          MOVE ZERO          TO CP-CLASS-CODE.
 15112
 15113     MOVE ZERO               TO CP-DEVIATION-CODE.
 15114
 15115     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15116
 15117     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15118
 15119     MOVE 'R'                   TO CP-RATE-FILE.
 15120     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15121
 15122     IF CP-ERROR-RATE-NOT-FOUND
 15123         MOVE ER-2645        TO WS-ERROR
 15124         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15125         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15126
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 274
* EL050.cbl
 15127     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15128
 15129     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15130     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15131
 15132     IF PB-I-AH-REI-RATE = ZERO
 15133         MOVE ER-2645        TO WS-ERROR
 15134         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15135
 15136
 15137 3340-CALCULATE-PREMIUM-AMT.
 15138     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15139     SET BIN-TO-GREG             TO TRUE
 15140     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15141     move dc-greg-date-a-edit    to ws-greg-eff-date
 15142
 15143     IF PB-COMPANY-ID = 'NCL'
 15144         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15145             WS-AH-SPECIAL-CALC-CD = 'O')
 15146             GO TO 3999-END-EDIT.
 15147
 15148     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15149                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15150                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15151                         OR 'AHL' OR 'FNL'
 15152         NEXT SENTENCE
 15153     ELSE
 15154         IF WS-STATE-ABBREVIATION = 'CT'
 15155             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15156                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15157                 COMPUTE PB-I-LF-PREM-CALC =
 15158                                     PB-I-LF-PREM-CALC * .90
 15159                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15160                                     PB-I-LF-ALT-PREM-CALC * .90
 15161                 COMPUTE PB-I-AH-PREM-CALC =
 15162                                     PB-I-AH-PREM-CALC * .90.
 15163
 15164     IF PB-COMP-LF-PREM
 15165        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15166        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15167
 15168     IF PB-COMP-AH-PREM
 15169        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15170
 15171 3340-CHECK-DCC-TOT-FEES.
 15172     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15173        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15174        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15175        AND (PB-I-POLICY-IS-MONTHLY)
 15176        CONTINUE
 15177     ELSE
 15178        GO TO 3340-EDIT-LF-AH-TOL
 15179     END-IF
 15180     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15181     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15182     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15183        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15184           PB-I-RATE-DEV-PCT-LF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 275
* EL050.cbl
 15185     END-IF
 15186     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15187        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15188           PB-I-RATE-DEV-PCT-AH
 15189     END-IF
 15190     MOVE 'N'                    TO CP-BEN-CATEGORY
 15191     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15192
 15193     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15194     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15195     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15196     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15197     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15198     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15199     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15200     MOVE '3'                    TO CP-PROCESS-TYPE.
 15201     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15202     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15203
 15204     MOVE PB-SV-STATE            TO CP-STATE.
 15205     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15206     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15207     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15208     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15209     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15210                                    CP-RATING-BENEFIT-AMT.
 15211     IF CP-STATE-STD-ABBRV = 'OR'
 15212         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15213                                         PB-I-LF-ALT-BENEFIT-AMT.
 15214     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15215     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15216     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15217     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15218     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15219     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15220     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15221     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15222     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15223                                    CP-REMAINING-TERM
 15224                                    CP-LOAN-TERM.
 15225     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15226        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15227           PB-I-LF-PREMIUM-AMT
 15228     end-if
 15229
 15230     IF CP-TRUNCATED-LIFE
 15231        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15232
 15233     IF CP-TERM-IS-DAYS
 15234         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15235     ELSE
 15236         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15237
 15238     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15239     IF CP-SPECIAL-CALC-CD = 'H'
 15240         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15241                                    TO CP-ALTERNATE-BENEFIT
 15242         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 276
* EL050.cbl
 15243     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15244     MOVE 'R'                    TO CP-RATE-FILE
 15245     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15246     IF NOT CP-ERROR-RATE-NOT-FOUND
 15247        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15248        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15249           AND (CP-BENEFIT-CD (1:1) = 'S')
 15250           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15251                                    PB-I-LF-PREMIUM-AMT
 15252        END-IF
 15253     ELSE
 15254        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15255     END-IF
 15256     .
 15257 3340-EDIT-LF-AH-TOL.
 15258
 15259***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15260***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15261***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15262***
 15263     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15264         PB-I-AH-PREMIUM-AMT
 15265          GIVING WS-CALC-WORK.
 15266
 15267     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15268        AND WS-CALC-WORK NOT = ZERO
 15269         MOVE ER-2649            TO WS-ERROR
 15270         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15271
 15272     SUBTRACT PB-I-LF-PREM-CALC
 15273             FROM PB-I-LF-PREMIUM-AMT
 15274                 GIVING WS-UNSIGN-WRK1.
 15275
 15276     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15277             FROM PB-I-LF-ALT-PREMIUM-AMT
 15278                 GIVING WS-UNSIGN-WRK4.
 15279
 15280     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15281                                + WS-UNSIGN-WRK4.
 15282
 15283     SUBTRACT PB-I-AH-PREM-CALC
 15284             FROM PB-I-AH-PREMIUM-AMT
 15285                 GIVING WS-UNSIGN-WRK2.
 15286
 15287******************************************************************
 15288*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15289******************************************************************
 15290
 15291     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15292         MOVE ZERO TO WS-UNSIGN-WRK1.
 15293
 15294     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15295         MOVE ZERO TO WS-UNSIGN-WRK2.
 15296
 15297     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15298             GIVING WS-UNSIGN-WRK3.
 15299
 15300 3342-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 277
* EL050.cbl
 15301
 15302     IF (PB-I-LF-RATE = ZERO  AND
 15303         PB-I-AH-RATE = ZERO)
 15304         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15305            WS-AH-SPECIAL-CALC-CD = 'O'
 15306              NEXT SENTENCE
 15307         ELSE
 15308             GO TO 3345-EDIT-CONTINUE.
 15309
 15310     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15311         NEXT SENTENCE
 15312     ELSE
 15313     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15314        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15315           IF (PB-REISSUED-CERT         OR
 15316               PB-POLICY-IS-DECLINED    OR
 15317               PB-POLICY-IS-VOIDED)
 15318              NEXT SENTENCE
 15319           ELSE
 15320              IF WS-PREM-REJECT-SW = SPACE
 15321                 MOVE ER-2652    TO WS-ERROR
 15322                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15323                 GO TO 3344-CHECK-AH
 15324              ELSE
 15325                 MOVE ER-2650    TO WS-ERROR
 15326                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15327                 GO TO 3344-CHECK-AH.
 15328
 15329***
 15330***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15331***
 15332
 15333     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15334         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15335            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15336             (1 + WS-TOL-LF-PREM-PCT)
 15337         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15338            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15339             (1 - WS-TOL-LF-PREM-PCT)
 15340     ELSE
 15341         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15342         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15343
 15344***
 15345***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15346***
 15347
 15348     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15349         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15350          WS-TOL-LF-PREM.
 15351
 15352     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15353         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15354          WS-TOL-LF-PREM.
 15355
 15356     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15357        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15358
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 278
* EL050.cbl
 15359     IF PB-REISSUED-CERT
 15360        or PB-POLICY-IS-DECLINED
 15361        or PB-POLICY-IS-VOIDED
 15362        continue
 15363     ELSE
 15364        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15365              > WS-TOL-LF-HIGH-PREM-AMT)
 15366           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15367              < WS-TOL-LF-LOW-PREM-AMT))
 15368                      or
 15369           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15370              > WS-TOL-LF-HIGH-PREM-PCT)
 15371           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15372              < WS-TOL-LF-LOW-PREM-PCT))
 15373           IF WS-PREM-REJECT-SW = SPACE
 15374              MOVE ER-2652       TO WS-ERROR
 15375              PERFORM 9900-ERROR-FORMAT
 15376                                 THRU 9900-EXIT
 15377           ELSE
 15378              MOVE ER-2650       TO WS-ERROR
 15379              PERFORM 9900-ERROR-FORMAT
 15380                                 THRU 9900-EXIT
 15381           end-if
 15382        end-if
 15383     end-if
 15384
 15385*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15386*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15387*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15388*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15389
 15390     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15391        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15392                      OR
 15393           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15394           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15395           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15396           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15397        END-IF
 15398     END-IF
 15399
 15400     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15401        IF WS-COMP-MAX-CAP GREATER THAN +0
 15402           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15403              IF (PB-REISSUED-CERT         OR
 15404                  PB-POLICY-IS-DECLINED    OR
 15405                  PB-POLICY-IS-VOIDED)
 15406                 NEXT SENTENCE
 15407              ELSE
 15408                  MOVE ER-2646   TO  WS-ERROR
 15409                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15410
 15411 3344-CVL-TOLERANCE-CHECK.
 15412
 15413      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15414          GO TO 3344-CHECK-AH.
 15415
 15416      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 279
* EL050.cbl
 15417          GO TO 3344-CHECK-AH.
 15418
 15419      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15420                                     WS-UNSIGN-WRK6.
 15421
 15422      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15423          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15424                                 + PB-I-LF-PREMIUM-AMT
 15425                                 - PB-I-LF-PREM-CALC.
 15426
 15427      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15428          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15429                                 + PB-I-LF-ALT-PREMIUM-AMT
 15430                                 - PB-I-LF-ALT-PREM-CALC.
 15431
 15432      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15433          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15434              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15435                 MOVE ER-2652    TO  WS-ERROR
 15436                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15437              ELSE
 15438                 MOVE ER-2650    TO  WS-ERROR
 15439                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15440
 15441      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15442          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15443              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15444                 MOVE ER-2652    TO  WS-ERROR
 15445                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15446              ELSE
 15447                 MOVE ER-2650    TO  WS-ERROR
 15448                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15449
 15450 3344-CHECK-AH.
 15451
 15452****************************************************************
 15453***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15454***
 15455
 15456     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15457         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15458             (1 + WS-TOL-AH-PREM-PCT)
 15459         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15460             (1 - WS-TOL-AH-PREM-PCT)
 15461     ELSE
 15462         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15463         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15464
 15465***
 15466***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15467***
 15468
 15469     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15470         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15471
 15472     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15473         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15474
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 280
* EL050.cbl
 15475     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15476        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15477
 15478     IF (PB-REISSUED-CERT)
 15479        OR (PB-POLICY-IS-DECLINED)
 15480        OR (PB-POLICY-IS-VOIDED)
 15481        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15482        CONTINUE
 15483     ELSE
 15484        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15485              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15486                          or
 15487           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15488              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15489           IF WS-PREM-REJECT-SW = SPACE
 15490              MOVE ER-3052       TO WS-ERROR
 15491              PERFORM 9900-ERROR-FORMAT
 15492                                 THRU 9900-EXIT
 15493           ELSE
 15494              MOVE ER-3050       TO WS-ERROR
 15495              PERFORM 9900-ERROR-FORMAT
 15496                                 THRU 9900-EXIT
 15497           END-IF
 15498        END-IF
 15499     END-IF
 15500     if (pb-company-id = 'DCC' or 'VPP')
 15501        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15502        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15503        and (pb-i-policy-is-monthly)
 15504        compute ws-tol-ah-high-prem-amt =
 15505           pb-i-tot-fees-calc + ws-tol-ah-prem
 15506        compute ws-tol-ah-low-prem-amt =
 15507           pb-i-tot-fees-calc - ws-tol-ah-prem
 15508        if ws-tol-ah-prem-pct > zeros
 15509           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15510              (1 + ws-tol-ah-prem-pct)
 15511           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15512              (1 - ws-tol-ah-prem-pct)
 15513        else
 15514           move +9999999.99      to ws-tol-ah-high-prem-pct
 15515           move +0               to ws-tol-ah-low-prem-pct
 15516        end-if
 15517        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15518            or
 15519           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15520                          or
 15521           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15522           or
 15523           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15524            move er-3049         to ws-error
 15525           perform 9900-error-format
 15526                                 thru 9900-exit
 15527
 15528        end-if
 15529     end-if
 15530     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15531         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15532             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 281
* EL050.cbl
 15533             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15534
 15535     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15536        IF WS-COMP-MAX-CAP GREATER THAN +0
 15537           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15538              IF (PB-REISSUED-CERT         OR
 15539                  PB-POLICY-IS-DECLINED    OR
 15540                  PB-POLICY-IS-VOIDED)
 15541                 NEXT SENTENCE
 15542              ELSE
 15543                  MOVE ER-2646   TO  WS-ERROR
 15544                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15545
 15546     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15547        (WS-COMP-MAX-CAP EQUAL +0)
 15548           GO TO 3345-EDIT-CONTINUE.
 15549
 15550     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15551        GREATER THAN WS-COMP-MAX-CAP
 15552           MOVE ER-2646          TO  WS-ERROR
 15553           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15554
 15555 3345-EDIT-CONTINUE.
 15556
 15557*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15558*       IF PB-ENTRY-BATCH   NUMERIC
 15559*          IF PB-ISSUE
 15560*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15561*          ELSE
 15562*              IF PB-CANCELLATION
 15563*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15564
 15565*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15566*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15567*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15568*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15569*        ELSE
 15570*            MOVE  ER-1909            TO  WS-ERROR
 15571*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15572
 15573     IF PB-I-POLICY-ACCEPTED
 15574        IF PB-POLICY-IS-DECLINED  OR
 15575           PB-REISSUED-CERT  OR
 15576           PB-REIN-ONLY-CERT  OR
 15577           PB-POLICY-IS-VOIDED
 15578            MOVE  ER-1891         TO  WS-ERROR
 15579            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15580        ELSE
 15581            MOVE SPACE            TO  PB-BATCH-ENTRY
 15582            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15583
 15584     IF PB-I-POLICY-DECLINED
 15585        IF PB-REISSUED-CERT  OR
 15586           PB-REIN-ONLY-CERT  OR
 15587           PB-POLICY-IS-VOIDED
 15588            MOVE  ER-1906         TO  WS-ERROR
 15589            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15590        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 282
* EL050.cbl
 15591            MOVE  'D'             TO  PB-BATCH-ENTRY
 15592                                      PB-I-ENTRY-STATUS.
 15593
 15594     IF PB-I-NEEDS-UNDERWRITING
 15595        IF PB-POLICY-IS-DECLINED OR
 15596           PB-REISSUED-CERT  OR
 15597           PB-REIN-ONLY-CERT  OR
 15598           PB-POLICY-IS-VOIDED
 15599            MOVE  ER-1907         TO  WS-ERROR
 15600            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15601        ELSE
 15602            MOVE 'U'              TO  PB-BATCH-ENTRY
 15603                                      PB-I-ENTRY-STATUS.
 15604
 15605     IF PB-NEEDS-UNDERWRITING
 15606        MOVE  ER-1901             TO  WS-ERROR
 15607        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15608     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15609        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15610        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15611        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15612           AND (NOT WS-LF-CASH))
 15613                           OR
 15614           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15615           AND (NOT WS-AH-CASH)))
 15616                       AND
 15617           (PB-I-ENTRY-STATUS NOT = '5')
 15618           MOVE 'M'              TO PB-BATCH-ENTRY
 15619                                    PB-I-ENTRY-STATUS
 15620        END-IF
 15621     END-IF
 15622     move pending-business       to ws-passed-erpndb
 15623     move ' '                    to ws-exceed-limit-yn
 15624     perform 7780-call-agg       thru 7780-exit
 15625*    display ' el050 exceed ' ws-exceed-limit-yn
 15626     if ws-exceed-limit-yn = 'Y'
 15627        MOVE  ER-9813            TO WS-ERROR
 15628        move 'Y'                 to ws-9813-sw
 15629        PERFORM  9900-ERROR-FORMAT
 15630                                 THRU 9900-EXIT
 15631     end-if
 15632     if (PB-EXCEEDED-LIMIT-FORCED)
 15633        and (ws-9813-sw = 'Y')
 15634        subtract +1 from PB-NO-OF-ERRORS
 15635        move er-9823             to ws-error
 15636        PERFORM  9900-ERROR-FORMAT
 15637                                 THRU 9900-EXIT
 15638     end-if
 15639     IF  PB-COMPANY-ID NOT = 'NCL'
 15640         GO TO 3999-END-EDIT.
 15641
 15642     IF PB-REISSUED-CERT  OR
 15643        PB-POLICY-IS-DECLINED  OR
 15644        PB-POLICY-IS-VOIDED  OR
 15645        PB-I-OB
 15646         GO TO 3999-END-EDIT.
 15647
 15648     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 283
* EL050.cbl
 15649         MOVE  ER-2644            TO  WS-ERROR
 15650         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15651         GO TO 3999-END-EDIT.
 15652
 15653     MOVE 'N'                     TO  FORM-MASTER-SW.
 15654     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15655
 15656     IF NOT FORM-MASTER-FOUND
 15657         GO TO 3999-END-EDIT.
 15658
 15659     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15660                                      FORM-MASTER-AH-SW.
 15661
 15662     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15663         MOVE  +1                 TO SUB6
 15664         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15665
 15666     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15667         MOVE  +1                 TO SUB6
 15668         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15669
 15670     IF LF-FORM-MASTER-FOUND  OR
 15671        AH-FORM-MASTER-FOUND
 15672         GO TO 3360-CHECK-FORM-LIMITS
 15673     ELSE
 15674         GO TO 3999-END-EDIT.
 15675
 15676******************************************************************
 15677*                  3350-GET-ERFORM                               *
 15678*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15679*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15680******************************************************************
 15681
 15682 3350-GET-ERFORM.
 15683
 15684     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15685         GO TO  3350-ERFORM-GETMAIN.
 15686
 15687     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15688     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15689     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15690     MOVE 'Y'                     TO FORM-MASTER-SW.
 15691
 15692     IF PB-CANCELLATION
 15693         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15694            PB-SV-STATE          EQUAL   FO-STATE       AND
 15695            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15696              GO TO 3350-EXIT
 15697         ELSE
 15698             NEXT SENTENCE
 15699     ELSE
 15700         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15701            PB-SV-STATE          EQUAL   FO-STATE       AND
 15702            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15703              GO TO 3350-EXIT.
 15704
 15705 3350-ERFORM-GETMAIN.
 15706
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 284
* EL050.cbl
 15707     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15708     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15709
 15710 3350-ERFORM-READ.
 15711
 15712     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15713     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15714     IF PB-CANCELLATION
 15715         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15716     ELSE
 15717         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15718     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15719
 15720     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15721
 15722     IF FORM-MASTER-FOUND
 15723       IF PB-CANCELLATION
 15724          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15725             PB-SV-STATE          EQUAL   FO-STATE       AND
 15726             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15727              GO  TO 3350-EXIT
 15728          ELSE
 15729              NEXT SENTENCE
 15730       ELSE
 15731          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15732             PB-SV-STATE          EQUAL   FO-STATE       AND
 15733             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15734              GO  TO 3350-EXIT.
 15735
 15736     MOVE  'N'                    TO  FORM-MASTER-SW.
 15737     MOVE  ER-1895                TO  WS-ERROR.
 15738     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15739
 15740 3350-EXIT.
 15741      EXIT.
 15742
 15743******************************************************************
 15744*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15745*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15746*   VALID FOR THE POLICY FORM USED.                              *
 15747******************************************************************
 15748
 15749 3355-EDIT-FORM-LF-BENEFITS.
 15750
 15751     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15752        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15753         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15754         GO TO   3355-EXIT.
 15755
 15756     IF  SUB6    LESS THAN   +40
 15757         ADD  +1      TO  SUB6
 15758         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15759
 15760     MOVE  ER-1896         TO  WS-ERROR.
 15761     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15762
 15763 3355-EXIT.
 15764      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 285
* EL050.cbl
 15765
 15766******************************************************************
 15767*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15768*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15769*   VALID FOR THE POLICY FORM USED.                              *
 15770******************************************************************
 15771
 15772 3356-EDIT-FORM-AH-BENEFITS.
 15773
 15774     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15775        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15776         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15777         GO TO  3356-EXIT.
 15778
 15779      IF  SUB6    LESS THAN     +40
 15780          ADD  +1      TO  SUB6
 15781          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15782
 15783     MOVE  ER-1897         TO  WS-ERROR.
 15784     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15785
 15786 3356-EXIT.
 15787      EXIT.
 15788
 15789******************************************************************
 15790*                  3357-BENEFIT-SEARCH                           *
 15791*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15792*   CANCELLATIONS ONLY.                                          *
 15793******************************************************************
 15794 3357-BENEFIT-SEARCH.
 15795     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15796         MOVE +1                          TO SUB6
 15797         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15798
 15799     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15800         MOVE +1                          TO SUB6
 15801         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15802
 15803 3357-EXIT.
 15804     EXIT.
 15805
 15806******************************************************************
 15807*                  3358-BENEFIT-LIFE-SEARCH                      *
 15808*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15809*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15810*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15811******************************************************************
 15812 3358-BENEFIT-LIFE-SEARCH.
 15813     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15814       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15815         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15816           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15817              IF FO-PLAN-REFUND-METHOD (SUB6)
 15818                     IS GREATER THAN SPACES
 15819                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15820                                          WS-LF-REFUND-CALC
 15821                 GO TO 3358-EXIT.
 15822
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 286
* EL050.cbl
 15823     IF SUB6 LESS THAN +40
 15824         ADD +1                 TO SUB6
 15825         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15826
 15827 3358-EXIT.
 15828     EXIT.
 15829******************************************************************
 15830*                  3359-BENEFIT-AH-SEARCH                        *
 15831*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15832*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15833*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15834******************************************************************
 15835 3359-BENEFIT-AH-SEARCH.
 15836     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15837       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15838         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15839           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15840              IF FO-PLAN-REFUND-METHOD (SUB6)
 15841                      IS GREATER THAN SPACES
 15842                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15843                                          WS-AH-REFUND-CALC
 15844                 GO TO 3359-EXIT.
 15845
 15846     IF SUB6 LESS THAN +40
 15847         ADD +1                 TO SUB6
 15848         GO TO 3359-BENEFIT-AH-SEARCH.
 15849
 15850 3359-EXIT.
 15851     EXIT.
 15852
 15853******************************************************************
 15854*                  3360-CHECK-FORM-LIMITS                        *
 15855*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15856*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15857******************************************************************
 15858
 15859 3360-CHECK-FORM-LIMITS.
 15860
 15861     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15862         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15863
 15864     IF NOT LF-FORM-MASTER-FOUND
 15865         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15866
 15867 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15868
 15869     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15870       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15871        WS-LF-JOINT-INDICATOR = 'J'  AND
 15872        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15873         IF PB-COMPANY-ID = 'NCL'
 15874            MOVE  ER-1911          TO  WS-ERROR
 15875            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15876         ELSE
 15877            MOVE  ER-1892          TO  WS-ERROR
 15878            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15879
 15880 3360-CHECK-FORM-LF-ATT-AGE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 287
* EL050.cbl
 15881
 15882     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15883
 15884     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15885         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15886         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15887            IF PB-COMPANY-ID = 'NCL'
 15888                MOVE  ER-1913      TO  WS-ERROR
 15889                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15890            ELSE
 15891                MOVE  ER-1894      TO  WS-ERROR
 15892                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15893
 15894 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15895
 15896     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15897         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15898         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15899            IF PB-COMPANY-ID = 'NCL'
 15900                MOVE  ER-1914      TO  WS-ERROR
 15901                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15902            ELSE
 15903                MOVE  ER-1899      TO  WS-ERROR
 15904                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15905
 15906 3360-CHECK-FORM-LF-TERM-BAMT.
 15907
 15908     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15909         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15910         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15911           IF  PB-COMPANY-ID = 'NCL'
 15912               MOVE  ER-1916       TO  WS-ERROR
 15913               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15914           ELSE
 15915               MOVE  ER-1902       TO  WS-ERROR
 15916               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15917
 15918     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15919                                    PB-I-LF-ALT-BENEFIT-AMT.
 15920
 15921     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15922         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15923         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15924             IF  PB-COMPANY-ID = 'NCL'
 15925                 MOVE  ER-1918     TO  WS-ERROR
 15926                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15927             ELSE
 15928                 MOVE  ER-1904     TO  WS-ERROR
 15929                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15930
 15931******************************************************************
 15932*                  3360-CHECK-FORM-AH-LIMITS                     *
 15933*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15934*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15935******************************************************************
 15936
 15937 3360-CHECK-FORM-AH-LIMITS.
 15938
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 288
* EL050.cbl
 15939     IF NOT AH-FORM-MASTER-FOUND
 15940         GO TO 3999-END-EDIT.
 15941
 15942 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15943
 15944     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15945       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15946        WS-AH-JOINT-INDICATOR = 'J'  AND
 15947        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15948         IF PB-COMPANY-ID = 'NCL'
 15949            MOVE  ER-1912          TO  WS-ERROR
 15950            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15951         ELSE
 15952            MOVE  ER-1893          TO  WS-ERROR
 15953            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15954
 15955 3360-CHECK-FORM-AH-ATT-AGE.
 15956
 15957     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15958
 15959     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15960         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15961         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15962            IF PB-COMPANY-ID = 'NCL'
 15963                MOVE  ER-1913      TO  WS-ERROR
 15964                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15965            ELSE
 15966                MOVE  ER-1894      TO  WS-ERROR
 15967                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15968
 15969 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15970
 15971     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15972         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15973         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15974            IF PB-COMPANY-ID = 'NCL'
 15975                MOVE  ER-1915      TO  WS-ERROR
 15976                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15977            ELSE
 15978                MOVE  ER-1900      TO  WS-ERROR
 15979                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15980
 15981 3360-CHECK-FORM-AH-TERM-BAMT.
 15982
 15983     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15984         FO-AH-MAX-TERM    GREATER THAN  +0
 15985         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15986             IF  PB-COMPANY-ID = 'NCL'
 15987                 MOVE  ER-1917     TO  WS-ERROR
 15988                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15989             ELSE
 15990                  MOVE  ER-1903    TO  WS-ERROR
 15991                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15992
 15993     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15994         FO-MAX-AH-AMT    GREATER THAN  +0
 15995         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15996             IF  PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 289
* EL050.cbl
 15997                 MOVE  ER-1919     TO  WS-ERROR
 15998                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15999             ELSE
 16000                 MOVE  ER-1905     TO  WS-ERROR
 16001                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16002
 16003     GO TO 3999-END-EDIT.
 16004
 16005******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 290
* EL050.cbl
 16007 3400-edit-vin.
 16008
 16009     move spaces                 to hldi-pass-area
 16010     MOVE PB-I-VIN               TO WS-WORK-VIN
 16011     MOVE +8                     TO V2
 16012     MOVE ZEROS                  TO WS-VIN-TOTAL
 16013     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16014      (V1 > 17)
 16015        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 16016           MOVE ER-3825          TO WS-ERROR
 16017           PERFORM 9900-ERROR-FORMAT
 16018                                 THRU 9900-EXIT
 16019        ELSE
 16020           IF V1 = 8
 16021              MOVE 10            TO V2
 16022           END-IF
 16023           IF V1 = 9
 16024              MOVE 0             TO V2
 16025           END-IF
 16026           IF V1 = 10
 16027              MOVE 9             TO V2
 16028           END-IF
 16029           IF WS-WORK-VIN (V1:1) NUMERIC
 16030              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 16031               + (WS-WORK-VIN-N (V1) * V2)
 16032           ELSE
 16033              MOVE WS-WORK-VIN (V1:1)
 16034                            TO WS-HEX-BYTE
 16035              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 16036              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 16037               + (WS-NUM (V3) * V2)
 16038           END-IF
 16039           COMPUTE V2 = V2 - 1
 16040        END-IF
 16041     END-PERFORM
 16042     MOVE ZEROS                  TO WS-VIN-REMAINDER
 16043     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 16044        REMAINDER WS-VIN-REMAINDER
 16045     IF ((WS-WORK-VIN (9:1) = 'X')
 16046        AND (WS-VIN-REMAINDER = 10))
 16047                OR
 16048        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 16049        if pb-company-id = 'VPP'
 16050           perform 3410-check-with-hldi
 16051                                 thru 3410-exit
 16052        end-if
 16053     ELSE
 16054        IF WS-WORK-VIN (1:1) > 0 AND < 6
 16055           MOVE ER-3826          TO WS-ERROR
 16056           PERFORM 9900-ERROR-FORMAT
 16057                                 THRU 9900-EXIT
 16058        ELSE
 16059           MOVE ER-3827          TO WS-ERROR
 16060           PERFORM 9900-ERROR-FORMAT
 16061                                 THRU 9900-EXIT
 16062        END-IF
 16063     END-IF
 16064
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 291
* EL050.cbl
 16065     .
 16066 3400-exit.
 16067     exit.
 16068 3410-check-with-hldi.
 16069     move spaces                 to hldi-pass-area
 16070     move pb-i-vin               to pa-vin
 16071     perform 7785-call-hldi      thru 7785-exit
 16072*    display 'PA-VIN        ' PA-VIN
 16073*    display 'PA-ErrorCode  ' PA-ErrorCode
 16074*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16075*    display 'PA-ModelYear  ' PA-ModelYear
 16076*    display 'PA-MakeName   ' PA-MakeName
 16077*    display 'PA-ModelName  ' PA-ModelName
 16078*    display 'PA-SeriesName ' PA-SeriesName
 16079     if pa-errorcode (1:1) not = '0'
 16080        move spaces              to hldi-pass-area
 16081        move pb-i-vin            to pa-vin
 16082*       move pa-errordesc        to pa-seriesname
 16083*       perform 7786-call-hldim  thru 7786-exit
 16084*       display 'PA-VIN        ' PA-VIN
 16085*       display 'PA-ErrorCode  ' PA-ErrorCode
 16086*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16087*       display 'PA-ModelYear  ' PA-ModelYear
 16088*       display 'PA-MakeName   ' PA-MakeName
 16089*       display 'PA-ModelName  ' PA-ModelName
 16090*       display 'PA-SeriesName ' PA-SeriesName
 16091     end-if
 16092     .
 16093 3410-exit.
 16094     exit.
 16095******************************************************************
 16096*                  E D I T   C A N C E L                         *
 16097******************************************************************
 16098
 16099 3700-EDIT-CANCEL.
 16100     IF PB-COMPANY-ID = 'DMD'
 16101         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16102                                         WS-RES-MUNI-TAX
 16103                                         PB-CI-STATE-TAX
 16104                                         PB-CI-MUNI-TAX
 16105         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16106
 16107*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16108*       IF PB-ENTRY-BATCH  NUMERIC
 16109*          IF PB-CANCELLATION
 16110*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16111*          ELSE
 16112*             IF PB-ISSUE
 16113*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16114
 16115     IF PB-C-INT-ON-REFS NOT NUMERIC
 16116        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16117     END-IF
 16118*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16119*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16120
 16121     IF CM-ENTRY-STATUS = 'V'
 16122        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 292
* EL050.cbl
 16123        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16124        GO TO 3999-END-EDIT.
 16125
 16126     IF CM-ENTRY-STATUS = 'D'
 16127        MOVE ER-2781             TO WS-ERROR
 16128        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16129        GO TO 3999-END-EDIT.
 16130
 16131     IF CM-ENTRY-STATUS = 'U'
 16132        MOVE ER-2782             TO WS-ERROR
 16133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16134
 16135***************************************************************
 16136*                                                             *
 16137*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16138*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16139*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16140*   OF ANOTHER COVERAGE.                                      *
 16141*                                                             *
 16142***************************************************************
 16143
 16144     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16145                                    PB-C-AH-CANCEL-VOID-SW.
 16146
 16147     if pb-company-id = 'DCC' or 'VPP'
 16148        if ((pb-ci-lf-cancel-amt <> zeros)
 16149                       or
 16150            (pb-ci-ah-cancel-amt <> zeros))
 16151           MOVE ER-3068          TO WS-ERROR
 16152           PERFORM 9900-ERROR-FORMAT
 16153                                 THRU 9900-EXIT
 16154           GO TO 3999-END-EDIT
 16155        end-if
 16156     end-if
 16157     IF PB-C-LF-CANCEL-AMT = ZERO
 16158        NEXT SENTENCE
 16159     ELSE
 16160        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16161           AND
 16162           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16163               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16164               MOVE ER-2745           TO WS-ERROR
 16165               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16166
 16167     IF PB-C-AH-CANCEL-AMT = ZERO
 16168        NEXT SENTENCE
 16169     ELSE
 16170        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16171           AND
 16172           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16173               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16174               MOVE ER-2745           TO WS-ERROR
 16175               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16176
 16177     IF WS-LF-EARNINGS-CALC = '4'
 16178        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16179
 16180     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 293
* EL050.cbl
 16181     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16182     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16183     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16184     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16185     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16186
 16187     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16188                                      PB-C-AH-REF-CALC.
 16189     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16190
 16191******************************************************************
 16192*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16193*             TO VALIDATE COVERAGE.                              *
 16194******************************************************************
 16195
 16196     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16197        PB-C-LF-CANCEL-AMT = ZEROS
 16198          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16199      ELSE
 16200          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16201
 16202     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16203        PB-C-AH-CANCEL-AMT = ZEROS
 16204          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16205      ELSE
 16206          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16207
 16208     EVALUATE TRUE
 16209         WHEN PB-CANCEL-FORCE             OR
 16210              PB-CANCEL-DATE-FORCED       OR
 16211              PB-FORCE-OFF
 16212                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16213                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16214                  END-IF
 16215         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16216               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16217              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16218                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16219         WHEN OTHER
 16220              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16221                 MOVE ER-2794              TO WS-ERROR
 16222              ELSE
 16223                 MOVE ER-2749              TO WS-ERROR
 16224              END-IF
 16225              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16226     END-EVALUATE.
 16227
 16228
 16229*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16230*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16231*            MOVE  ER-1909            TO  WS-ERROR
 16232*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16233*        ELSE
 16234*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16235
 16236     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16237     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16238        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 294
* EL050.cbl
 16239     ELSE
 16240        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16241     END-IF
 16242     .
 16243 3705-EDIT-CANCEL-DT.
 16244
 16245     IF LF-COVERAGE-CANCELLED
 16246        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16247         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16248         MOVE WS-CURRENT-MONTH-END
 16249                                 TO DC-BIN-DATE-2
 16250         SET ELAPSED-BETWEEN-BIN TO TRUE
 16251*        MOVE 1                  TO DC-OPTION-CODE
 16252         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16253         IF DATE-CONVERSION-ERROR
 16254            NEXT SENTENCE
 16255          ELSE
 16256             IF DC-ELAPSED-DAYS GREATER +180
 16257                IF PB-CANCEL-DATE-FORCED  OR
 16258                   PB-CANCEL-DATE-FORCED-NO-FEE
 16259                      MOVE ER-2751  TO WS-ERROR
 16260                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16261                 ELSE
 16262                   MOVE ER-2752  TO WS-ERROR
 16263                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16264
 16265     IF AH-COVERAGE-CANCELLED
 16266        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16267         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16268         MOVE WS-CURRENT-MONTH-END
 16269                                 TO DC-BIN-DATE-2
 16270         SET ELAPSED-BETWEEN-BIN TO TRUE
 16271*        MOVE 1                  TO DC-OPTION-CODE
 16272         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16273         IF DATE-CONVERSION-ERROR
 16274            NEXT SENTENCE
 16275          ELSE
 16276             IF DC-ELAPSED-DAYS GREATER +180
 16277                IF PB-CANCEL-DATE-FORCED OR
 16278                   PB-CANCEL-DATE-FORCED-NO-FEE
 16279                      MOVE ER-2751  TO WS-ERROR
 16280                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16281                 ELSE
 16282                   MOVE ER-2752  TO WS-ERROR
 16283                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16284
 16285     IF WS-ERROR = ER-2752
 16286        AND (PB-COMPANY-ID = 'ABL'
 16287         OR  PB-COMPANY-ID = 'FGL'
 16288         OR  PB-COMPANY-ID = 'IST'
 16289         OR  PB-COMPANY-ID = 'JHL'
 16290         OR  PB-COMPANY-ID = 'LAP'
 16291         OR  PB-COMPANY-ID = 'LBL'
 16292         OR  PB-COMPANY-ID = 'NCB'
 16293         OR  PB-COMPANY-ID = 'NLI'
 16294         OR  PB-COMPANY-ID = 'OFI'
 16295         OR  PB-COMPANY-ID = 'PLI'
 16296         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 295
* EL050.cbl
 16297         OR  PB-COMPANY-ID = 'TIC'
 16298         OR  PB-COMPANY-ID = 'HER'
 16299         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16300         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16301            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16302            MOVE ER-2762     TO WS-ERROR
 16303            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16304
 16305     IF LF-COVERAGE-CANCELLED
 16306        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16307        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16308             MOVE ER-2733         TO WS-ERROR
 16309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16310
 16311     IF AH-COVERAGE-CANCELLED
 16312        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16313        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16314              MOVE ER-2733        TO WS-ERROR
 16315              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16316
 16317     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16318        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16319        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16320           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16321            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16322              IF PB-COMPANY-ID NOT = 'LAP'
 16323               MOVE ER-2704            TO WS-ERROR
 16324               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16325
 16326     IF CERT-WAS-NOT-FOUND
 16327         GO TO 3999-END-EDIT.
 16328
 16329     IF PB-COMPANY-ID EQUAL 'CDC'
 16330        IF LF-COVERAGE-CANCELLED
 16331           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16332            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16333            MOVE PB-C-LF-CANCEL-DT
 16334                                 TO DC-BIN-DATE-2
 16335            SET ELAPSED-BETWEEN-BIN TO TRUE
 16336*           MOVE 1               TO DC-OPTION-CODE
 16337            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16338            IF DATE-CONVERSION-ERROR
 16339               NEXT SENTENCE
 16340             ELSE
 16341                IF DC-ELAPSED-DAYS GREATER +60
 16342                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16343
 16344     IF PB-COMPANY-ID EQUAL 'CDC'
 16345        IF AH-COVERAGE-CANCELLED
 16346           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16347            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16348            MOVE PB-C-AH-CANCEL-DT
 16349                                 TO DC-BIN-DATE-2
 16350            MOVE +0              TO DC-ELAPSED-DAYS
 16351                                    DC-ELAPSED-MONTHS
 16352            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16353*           MOVE 1               TO DC-OPTION-CODE
 16354            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 296
* EL050.cbl
 16355            IF DATE-CONVERSION-ERROR
 16356               NEXT SENTENCE
 16357             ELSE
 16358                IF DC-ELAPSED-DAYS GREATER +60
 16359                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16360
 16361     MOVE +0                     TO DC-ELAPSED-DAYS
 16362                                    DC-ELAPSED-MONTHS.
 16363
 16364     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16365        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16366          MOVE 'Z'                TO PB-CI-OB-FLAG
 16367          MOVE ER-2767            TO WS-ERROR
 16368          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16369          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16370          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16371          GO TO 3775-OVER-REF-CHK
 16372        ELSE
 16373          MOVE ZEROS              TO PB-CI-LIVES
 16374                                     PB-C-LIVES
 16375          IF PB-CI-OB-FLAG NOT = 'B'
 16376             MOVE SPACE           TO PB-CI-OB-FLAG.
 16377
 16378     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16379         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16380     ELSE
 16381         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16382
 16383     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16384        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16385            MOVE ER-2760         TO WS-ERROR
 16386            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16387
 16388     IF LF-COVERAGE-CANCELLED
 16389        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16390         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16391            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16392               MOVE ER-2774       TO WS-ERROR
 16393               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16394
 16395     IF AH-COVERAGE-CANCELLED
 16396        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16397         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16398            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16399               MOVE ER-2775       TO WS-ERROR
 16400               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16401
 16402     IF LF-COVERAGE-CANCELLED
 16403        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16404         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16405            MOVE ER-2776         TO WS-ERROR
 16406            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16407
 16408     IF AH-COVERAGE-CANCELLED
 16409        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16410         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16411            MOVE ER-2777         TO WS-ERROR
 16412            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 297
* EL050.cbl
 16413
 16414     IF LF-COVERAGE-CANCELLED
 16415        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16416        if pb-ci-lf-expire-dt = low-values or spaces
 16417           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16418           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16419           MOVE PB-CI-EXTENTION-DAYS
 16420                                 TO DC-ELAPSED-DAYS
 16421           SET BIN-PLUS-ELAPSED  TO TRUE
 16422           PERFORM 8500-DATE-CONVERT
 16423                                 THRU 8500-EXIT
 16424           IF DATE-CONVERSION-ERROR
 16425              move low-values    to dc-bin-date-2
 16426           end-if
 16427        else
 16428           move pb-ci-lf-expire-dt
 16429                                 to dc-bin-date-2
 16430        end-if
 16431        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16432           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16433                             OR  'FIA'
 16434              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16435           ELSE
 16436              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16437              MOVE ER-2731       TO WS-ERROR
 16438              PERFORM 9900-ERROR-FORMAT
 16439                                 THRU 9900-EXIT
 16440           end-if
 16441        end-if
 16442     end-if
 16443*    IF LF-COVERAGE-CANCELLED
 16444*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16445*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16446*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16447*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16448*        SET BIN-PLUS-ELAPSED      TO TRUE
 16449*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16450*        IF DATE-CONVERSION-ERROR
 16451*           NEXT SENTENCE
 16452*         ELSE
 16453*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16454*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16455*                            OR  'FIA'
 16456*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16457*              ELSE
 16458*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16459*               MOVE ER-2731       TO WS-ERROR
 16460*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16461     .
 16462 3705-EDIT-AH-CANCEL-DT.
 16463     IF AH-COVERAGE-CANCELLED
 16464        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16465        if pb-ci-AH-expire-dt = low-values or spaces
 16466           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16467           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16468           MOVE PB-CI-EXTENTION-DAYS
 16469                                 TO DC-ELAPSED-DAYS
 16470           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 298
* EL050.cbl
 16471           PERFORM 8500-DATE-CONVERT
 16472                                 THRU 8500-EXIT
 16473           IF DATE-CONVERSION-ERROR
 16474              move low-values    to dc-bin-date-2
 16475           end-if
 16476        else
 16477           move pb-ci-ah-expire-dt
 16478                                 to dc-bin-date-2
 16479        end-if
 16480        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16481           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16482                             OR  'FIA'
 16483              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16484           ELSE
 16485              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16486              MOVE ER-2771       TO WS-ERROR
 16487              PERFORM 9900-ERROR-FORMAT
 16488                                 THRU 9900-EXIT
 16489           end-if
 16490        end-if
 16491     end-if
 16492*    IF AH-COVERAGE-CANCELLED
 16493*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16494*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16495*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16496*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16497**       MOVE 6                    TO DC-OPTION-CODE
 16498*        SET BIN-PLUS-ELAPSED      TO TRUE
 16499*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16500*        IF DATE-CONVERSION-ERROR
 16501*           NEXT SENTENCE
 16502*         ELSE
 16503*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16504*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16505*                             OR 'FIA'
 16506*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16507*             ELSE
 16508*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16509*              MOVE ER-2771       TO WS-ERROR
 16510*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16511     .
 16512 3705-EDIT-CONTINUED.
 16513
 16514*    IF LF-COVERAGE-CANCELLED
 16515*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16516*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16517*            MOVE ER-2727         TO WS-ERROR
 16518*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16519*
 16520*    IF AH-COVERAGE-CANCELLED
 16521*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16522*        IF PB-COMPANY-ID = 'ACE'
 16523*           MOVE ER-2727        TO WS-ERROR
 16524*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16525*        ELSE
 16526*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16527*              MOVE ER-2727     TO WS-ERROR
 16528*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 299
* EL050.cbl
 16529
 16530     IF PB-COMPANY-ID = 'ACE'
 16531       IF AH-COVERAGE-CANCELLED
 16532         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16533           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16534              MOVE ER-2732      TO WS-ERROR
 16535              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16536
 16537     IF PB-COMPANY-ID      EQUAL   'HER'
 16538        IF WS-ERROR        EQUAL   ER-2727
 16539            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16540            MOVE  ER-2725          TO  WS-ERROR
 16541            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16542
 16543     IF PB-C-CLAIM-CREATED-CANCEL
 16544            MOVE ER-2748         TO WS-ERROR
 16545            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16546
 16547     IF PB-C-LAST-NAME NOT = SPACES
 16548         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16549            MOVE ER-2747         TO WS-ERROR
 16550            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16551
 16552 3710-EDIT-LUMP-SUM-PRIOR.
 16553
 16554     IF AH-COVERAGE-CANCELLED
 16555         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16556             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16557                MOVE ER-2735    TO WS-ERROR
 16558                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16559
 16560     IF LF-COVERAGE-CANCELLED
 16561         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16562             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16563                MOVE ER-2735    TO WS-ERROR
 16564                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16565
 16566 3710-EDIT-PRIOR-DEATH.
 16567
 16568*    IF LF-COVERAGE-CANCELLED
 16569*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16570*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16571*           (NOT PB-CI-OB)
 16572*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16573*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16574*                   MOVE ER-2732  TO WS-ERROR
 16575*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16576*
 16577*    IF AH-COVERAGE-CANCELLED
 16578*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16579*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16580*           (NOT PB-CI-OB)
 16581*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16582*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16583*                   MOVE ER-2732  TO WS-ERROR
 16584*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16585
 16586     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 300
* EL050.cbl
 16587         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16588            (NOT PB-COMP-LF-CANCEL)
 16589             NEXT SENTENCE
 16590         ELSE
 16591           IF PB-C-LF-CANCEL-VOIDED
 16592              NEXT SENTENCE
 16593           ELSE
 16594              MOVE ER-2753      TO WS-ERROR
 16595              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16596
 16597     IF CANCEL-FUTURE-DT
 16598         GO TO 3999-END-EDIT.
 16599
 16600 3715-GET-REMAIN-TERM-LF.
 16601
 16602     IF NO-LF-BENEFIT-MATCH  OR
 16603        WS-LF-BENEFIT-CD = ZEROS
 16604        GO TO 3730-GET-AH-REMAIN-TERM.
 16605
 16606     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16607     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16608     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16609     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16610     MOVE PB-SV-STATE            TO CP-STATE.
 16611     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16612     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16613     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16614     MOVE '2'                    TO CP-PROCESS-TYPE.
 16615     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16616     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16617     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16618     IF (PB-COMPANY-ID = 'CID')
 16619        AND (CP-STATE-STD-ABBRV = 'WI')
 16620        MOVE '7'                 TO CP-REM-TERM-METHOD
 16621        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16622     ELSE
 16623        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16624        MOVE WS-REM-TRM-CALC-OPTION
 16625                                 TO CP-REM-TRM-CALC-OPTION
 16626     END-IF
 16627**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16628     IF (PB-COMPANY-ID = 'CID')
 16629        AND (CP-STATE-STD-ABBRV = 'MO')
 16630        AND (PB-CERT-EFF-DT >= X'9B41')
 16631        AND (PB-CERT-EFF-DT <= X'A2FB')
 16632        MOVE '7'                 TO CP-REM-TERM-METHOD
 16633        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16634     END-IF
 16635     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16636                                    CP-LOAN-TERM.
 16637     IF CP-TRUNCATED-LIFE
 16638        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16639
 16640     IF CP-TERM-IS-DAYS
 16641         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16642     ELSE
 16643         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16644
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 301
* EL050.cbl
 16645     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16646
 16647     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16648
 16649     IF LF-COVERAGE-CANCELLED
 16650        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16651        NEXT SENTENCE
 16652      ELSE
 16653          GO TO 3730-GET-AH-REMAIN-TERM.
 16654
 16655 3720-GET-LF-REFUND.
 16656
 16657     IF PB-C-LF-CANCEL-VOIDED
 16658        GO TO 3730-GET-AH-REMAIN-TERM
 16659     end-if
 16660
 16661     IF PB-COMPANY-ID EQUAL 'BOA'
 16662         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16663         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16664         GO TO 3730-GET-AH-REMAIN-TERM.
 16665
 16666     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16667        (WS-AH-SPECIAL-CALC-CD = 'M')
 16668         MOVE ER-2767            TO WS-ERROR
 16669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16670         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16671         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16672         GO TO 3780-UPDATE-CANCEL-CERT.
 16673
 16674*    if (ws-lf-earnings-calc = '6')
 16675*       or (pb-c-lf-refund-override = '6')
 16676*       move cp-remaining-term-1 to cp-remaining-term-2
 16677*    end-if
 16678     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16679
 16680     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16681     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16682     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16683     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16684     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16685     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16686     IF PB-COMPANY-ID = 'DCC'
 16687        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16688        IF PDEF-MASTER-FOUND
 16689           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16690              (V1 > +8)
 16691              OR (PD-PROD-CODE (V1) = 'L')
 16692           END-PERFORM
 16693           IF V1 < +9
 16694              MOVE PD-MAX-AMT (V1)
 16695                           TO CP-R-MAX-TOT-BEN
 16696                              EC-AM-LF-MAX-TOT-BEN
 16697           END-IF
 16698        ELSE
 16699        MOVE ' '                 TO PDEF-MASTER-SW
 16700        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16701        MOVE PB-STATE            TO ERPDEF-STATE
 16702        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 302
* EL050.cbl
 16703           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16704        END-IF
 16705        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16706        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16707        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16708        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16709        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16710        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16711        IF PDEF-MASTER-FOUND
 16712           MOVE 'N'              TO PDEF-MASTER-SW
 16713           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16714           IF PDEF-MASTER-FOUND
 16715              IF (ERPDEF-KEY-SAVE (1:16) =
 16716                           PD-CONTROL-PRIMARY (1:16))
 16717                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16718                 CONTINUE
 16719              ELSE
 16720                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16721                 IF (ERPDEF-KEY-SAVE (1:16) =
 16722                           PD-CONTROL-PRIMARY (1:16))
 16723                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16724                    CONTINUE
 16725                 ELSE
 16726                    MOVE 'N'     TO PDEF-MASTER-SW
 16727                 END-IF
 16728              END-IF
 16729
 16730              IF PDEF-MASTER-FOUND
 16731                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16732                    (V1 > +8)
 16733                    OR (PD-PROD-CODE (V1) = 'L')
 16734                 END-PERFORM
 16735                 IF V1 < +9
 16736                    MOVE PD-MAX-AMT (V1)
 16737                                 TO CP-R-MAX-TOT-BEN
 16738                                    EC-AM-LF-MAX-TOT-BEN
 16739                 END-IF
 16740              END-IF
 16741           END-IF
 16742           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16743        END-IF
 16744        END-IF
 16745     END-IF
 16746     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16747
 16748     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16749
 16750     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16751                                    PB-C-LF-REM-TERM.
 16752
 16753     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16754     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16755
 16756     IF PB-COMPANY-ID EQUAL 'FLC'
 16757        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16758           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16759           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16760                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 303
* EL050.cbl
 16761                    - CM-LF-ITD-DEATH-AMT
 16762           IF PB-C-LF-REF-CALC LESS THAN +0
 16763              MOVE +0            TO PB-C-LF-REF-CALC
 16764              GO TO 3730-GET-AH-REMAIN-TERM
 16765           ELSE
 16766              GO TO 3730-GET-AH-REMAIN-TERM.
 16767
 16768     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16769                            OR '4' OR '5' OR '6' OR '8'
 16770                            OR '9' OR 'G'
 16771        MOVE PB-C-LF-REFUND-OVERRIDE
 16772                                 TO CP-EARNING-METHOD.
 16773
 16774     if pb-company-id = 'AHL'
 16775        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16776        if cp-class-code = spaces
 16777           move zeros            to cp-class-code
 16778        end-if
 16779     ELSE
 16780        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16781     END-IF
 16782*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16783     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16784     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16785                                    CP-RATING-BENEFIT-AMT.
 16786     IF CP-STATE-STD-ABBRV = 'OR'
 16787         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16788                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16789     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16790     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16791     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16792     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16793     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16794     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16795     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16796     IF WS-DEFAULT-APR NOT NUMERIC
 16797         MOVE ZEROS TO WS-DEFAULT-APR.
 16798****   N O T E   ****
 16799*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16800*      THE OH HARD CODING IN ELCRFNDP
 16801
 16802     IF PB-COMPANY-ID = 'CID'
 16803        IF CP-STATE-STD-ABBRV = 'OH'
 16804           MOVE WS-LF-EARNINGS-CALC
 16805                                 TO CP-EARNING-METHOD
 16806        END-IF
 16807     END-IF
 16808
 16809****   N O T E   ****
 16810
 16811*    IF CP-EARN-AS-NET-PAY
 16812*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16813*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16814*               MOVE WS-DEFAULT-APR
 16815*                                TO  CP-LOAN-APR
 16816*               MOVE ER-3780     TO  WS-ERROR
 16817*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16818*           ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 304
* EL050.cbl
 16819*               MOVE ER-3781     TO  WS-ERROR
 16820*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16821*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16822     move ' '                    to cp-ext-days-calc
 16823     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16824
 16825     IF CP-REFUND-TYPE-USED NOT = SPACE
 16826         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16827
 16828     IF CP-ERROR-RATE-IS-ZERO OR
 16829        CP-ERROR-RATE-NOT-FOUND
 16830        MOVE ER-2740             TO WS-ERROR
 16831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16832
 16833     IF CP-ERROR-RATE-FILE-NOTOPEN
 16834        MOVE ER-2617             TO WS-ERROR
 16835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16836
 16837     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16838        AND PB-CI-ENTRY-STATUS = 'M'
 16839        MOVE +0                  TO PB-C-LF-REF-CALC
 16840     ELSE
 16841        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16842     END-IF
 16843
 16844     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16845         GO TO 3730-GET-AH-REMAIN-TERM.
 16846
 16847*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16848*       ADD +1                   TO PB-C-LF-REM-TERM
 16849*                                   CP-REMAINING-TERM
 16850*                                   CP-ORIGINAL-TERM.
 16851
 16852     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16853     MOVE '2'                    TO CP-EARNING-METHOD
 16854                                    CP-RATING-METHOD.
 16855     IF PB-COMPANY-ID = 'CID'
 16856        IF (CP-STATE-STD-ABBRV = 'MN')
 16857           AND (PB-CERT-EFF-DT > X'A4FF')
 16858           AND (WS-LF-EARNINGS-CALC = 'B')
 16859           MOVE '5'              TO CP-EARNING-METHOD
 16860           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16861        END-IF
 16862     END-IF
 16863     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16864                                        CP-REMAINING-BENEFIT
 16865                                        CP-RATING-BENEFIT-AMT.
 16866     IF CP-STATE-STD-ABBRV = 'OR'
 16867         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16868                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16869     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16870     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16871
 16872     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16873
 16874     IF CP-ERROR-RATE-IS-ZERO OR
 16875        CP-ERROR-RATE-NOT-FOUND
 16876        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 305
* EL050.cbl
 16877        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16878
 16879     IF CP-ERROR-RATE-FILE-NOTOPEN
 16880        MOVE ER-2617             TO WS-ERROR
 16881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16882
 16883     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16884
 16885******************************************************************
 16886
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 306
* EL050.cbl
 16888 3730-GET-AH-REMAIN-TERM.
 16889     IF NO-AH-BENEFIT-MATCH  OR
 16890        WS-AH-BENEFIT-CD = ZEROS
 16891         GO TO 3770-CHECK-REFUNDS.
 16892
 16893     IF PB-CI-AH-LUMP-SUM-DISAB
 16894         IF  PB-C-AH-CANCEL-AMT = ZERO
 16895            IF NOT PB-COMP-AH-CANCEL
 16896             GO TO 3770-CHECK-REFUNDS.
 16897
 16898     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16899     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16900     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16901     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16902     MOVE PB-SV-STATE            TO CP-STATE.
 16903     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16904     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16905     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16906     MOVE '2'                    TO CP-PROCESS-TYPE.
 16907     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16908     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16909     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16910     IF (PB-COMPANY-ID = 'CID')
 16911        AND (CP-STATE-STD-ABBRV = 'WI')
 16912        MOVE '7'                 TO CP-REM-TERM-METHOD
 16913        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16914     ELSE
 16915        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16916        MOVE WS-REM-TRM-CALC-OPTION
 16917                                 TO CP-REM-TRM-CALC-OPTION
 16918     END-IF
 16919     IF (PB-COMPANY-ID = 'CID')
 16920        AND (CP-STATE-STD-ABBRV = 'MO')
 16921        AND (PB-CERT-EFF-DT >= X'9B41')
 16922        AND (PB-CERT-EFF-DT <= X'A2FB')
 16923        MOVE '7'                 TO CP-REM-TERM-METHOD
 16924        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16925     END-IF
 16926     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16927                                    CP-LOAN-TERM.
 16928     IF NOT CP-TERM-IS-DAYS
 16929         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16930
 16931     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16932
 16933     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16934
 16935     IF AH-COVERAGE-CANCELLED
 16936        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16937        NEXT SENTENCE
 16938      ELSE
 16939         GO TO 3770-CHECK-REFUNDS.
 16940
 16941 3740-GET-AH-REFUND.
 16942
 16943     IF PB-C-AH-CANCEL-VOIDED
 16944        GO TO 3780-UPDATE-CANCEL-CERT
 16945     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 307
* EL050.cbl
 16946
 16947     IF PB-COMPANY-ID = 'BOA'
 16948         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16949         GO TO 3770-CHECK-REFUNDS.
 16950
 16951     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16952*    MOVE ' '                    TO DC-OPTION-CODE
 16953     SET BIN-TO-GREG             TO TRUE
 16954     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16955     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16956                                    PB-C-AH-REM-TERM.
 16957     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16958     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16959
 16960     IF PB-COMPANY-ID EQUAL 'FLC'
 16961        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16962           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16963           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16964                    - CM-AH-ITD-AH-PMT)
 16965           IF PB-C-AH-REF-CALC LESS THAN +0
 16966              MOVE +0            TO PB-C-AH-REF-CALC
 16967              GO TO 3770-CHECK-REFUNDS
 16968           ELSE
 16969              GO TO 3770-CHECK-REFUNDS.
 16970
 16971     IF PB-COMPANY-ID = 'DCC'
 16972        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16973            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16974           MOVE 'S'              TO CP-EARNING-METHOD
 16975        END-IF
 16976     END-IF
 16977     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16978                            OR '4' OR '5' OR '6' OR '8'
 16979                            OR '9' OR 'G' OR 'S'
 16980        MOVE PB-C-AH-REFUND-OVERRIDE
 16981                                 TO CP-EARNING-METHOD.
 16982
 16983     if pb-company-id = 'AHL'
 16984        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16985        if cp-class-code = spaces
 16986           move zeros            to cp-class-code
 16987        end-if
 16988     ELSE
 16989        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16990     END-IF
 16991*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16992     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16993     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16994                                    CP-RATING-BENEFIT-AMT.
 16995     IF CP-STATE-STD-ABBRV = 'OR'
 16996         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16997                                         PB-CI-AH-TERM.
 16998     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16999     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 17000     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 17001     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 17002     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 17003     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 308
* EL050.cbl
 17004
 17005     IF CP-STATE-STD-ABBRV = 'OH'
 17006        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 17007                                AND 'CID' AND 'DCC' and 'VPP'
 17008                                AND 'AHL' AND 'FNL')
 17009           IF (CP-ORIGINAL-TERM GREATER 60) AND
 17010              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 17011              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 17012              MOVE '6' TO CP-EARNING-METHOD
 17013           END-IF
 17014        END-IF
 17015        IF PB-COMPANY-ID = 'CID'
 17016           IF NO-LIFE-COVERAGE
 17017              IF CP-CRITICAL-PERIOD
 17018                 MOVE '2'       TO CP-EARNING-METHOD
 17019              ELSE
 17020                 MOVE '6'       TO CP-EARNING-METHOD
 17021              END-IF
 17022           ELSE
 17023              IF WS-LF-COVERAGE-TYPE = 'L'
 17024                 MOVE '2'       TO CP-EARNING-METHOD
 17025              ELSE
 17026                 IF (PB-CI-LF-TERM > +60) OR
 17027                    (WS-LF-EARNINGS-CALC = '5')
 17028                    IF CP-CRITICAL-PERIOD
 17029                       MOVE '2'  TO CP-EARNING-METHOD
 17030                    ELSE
 17031                       MOVE '6'  TO CP-EARNING-METHOD
 17032                    END-IF
 17033                 ELSE
 17034                    MOVE '1'     TO CP-EARNING-METHOD
 17035                 END-IF
 17036              END-IF
 17037           END-IF
 17038        END-IF
 17039     END-IF
 17040
 17041*    IF CP-STATE-STD-ABBRV = 'VA'
 17042*       IF DC-GREG-DATE-CYMD GREATER 19921231
 17043*          IF CP-ORIGINAL-TERM GREATER 61
 17044*             MOVE '6' TO CP-EARNING-METHOD
 17045*          ELSE
 17046*             MOVE '1' TO CP-EARNING-METHOD.
 17047
 17048     IF WS-DEFAULT-APR NOT NUMERIC
 17049         MOVE ZEROS TO WS-DEFAULT-APR.
 17050     IF CP-EARN-AS-NET-PAY
 17051         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 17052            IF WS-DEFAULT-APR GREATER THAN ZEROS
 17053                MOVE WS-DEFAULT-APR
 17054                                 TO  CP-LOAN-APR
 17055                MOVE ER-3780     TO  WS-ERROR
 17056                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 17057            ELSE
 17058                MOVE ER-3781     TO  WS-ERROR
 17059                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 17060     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17061     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 309
* EL050.cbl
 17062        AND CP-CANCEL-REASON = 'R'
 17063        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17064        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 17065     END-IF
 17066     IF PB-COMPANY-ID = 'DCC'
 17067        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17068        AND (CP-EARNING-METHOD = 'D')
 17069        AND (CP-CANCEL-REASON NOT = 'R')
 17070        CONTINUE
 17071     ELSE
 17072        GO TO 3750-CONTINUE
 17073     END-IF
 17074     MOVE ' '                    TO DD-IU-SW
 17075     IF NOT PDEF-MASTER-FOUND
 17076        MOVE ' '                 TO PDEF-MASTER-SW
 17077        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17078        MOVE PB-STATE            TO ERPDEF-STATE
 17079        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17080           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17081        END-IF
 17082        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17083        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17084        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17085        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17086        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17087        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17088        IF PDEF-MASTER-FOUND
 17089           MOVE 'N'              TO PDEF-MASTER-SW
 17090           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17091           IF PDEF-MASTER-FOUND
 17092              IF (ERPDEF-KEY-SAVE (1:16) =
 17093                           PD-CONTROL-PRIMARY (1:16))
 17094                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17095                 CONTINUE
 17096              ELSE
 17097                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17098                 IF (ERPDEF-KEY-SAVE (1:16) =
 17099                           PD-CONTROL-PRIMARY (1:16))
 17100                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17101                    CONTINUE
 17102                 ELSE
 17103                    MOVE ER-2740 TO WS-ERROR
 17104                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17105                    GO TO 3770-CHECK-REFUNDS
 17106                 END-IF
 17107              END-IF
 17108           END-IF
 17109           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17110        END-IF
 17111     END-IF
 17112     IF PDEF-MASTER-FOUND
 17113        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17114           (V1 > +8)
 17115           OR (PD-PROD-CODE (V1) = 'I')
 17116        END-PERFORM
 17117        IF V1 < +9
 17118           SET DD-IU-PRESENT        TO TRUE
 17119        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 310
* EL050.cbl
 17120        IF WS-AH-DCC-TRUNC = 'T'
 17121           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17122        ELSE
 17123           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17124        END-IF
 17125        EVALUATE TRUE
 17126           WHEN WS-TERM > +168
 17127              MOVE 15               TO V1
 17128           WHEN WS-TERM > +156
 17129              MOVE 14               TO V1
 17130           WHEN WS-TERM > +144
 17131              MOVE 13               TO V1
 17132           WHEN WS-TERM > +132
 17133              MOVE 12               TO V1
 17134           WHEN WS-TERM > +120
 17135              MOVE 11               TO V1
 17136           WHEN WS-TERM > +108
 17137              MOVE 10               TO V1
 17138           WHEN WS-TERM > +96
 17139              MOVE 9                TO V1
 17140           WHEN WS-TERM > +84
 17141              MOVE 8                TO V1
 17142           WHEN WS-TERM > +72
 17143              MOVE 7                TO V1
 17144           WHEN WS-TERM > +60
 17145              MOVE 6                TO V1
 17146           WHEN WS-TERM > +48
 17147              MOVE 5                TO V1
 17148           WHEN WS-TERM > +36
 17149              MOVE 4                TO V1
 17150           WHEN WS-TERM > +24
 17151              MOVE 3                TO V1
 17152           WHEN WS-TERM > +12
 17153              MOVE 2                TO V1
 17154           WHEN OTHER
 17155              MOVE 1                TO V1
 17156        END-EVALUATE
 17157
 17158        EVALUATE TRUE
 17159*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17160*             < +13)
 17161*             AND (DD-IU-PRESENT)
 17162*             MOVE 2                TO V2
 17163*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17164*             MOVE 1                TO V2
 17165           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17166              MOVE 2                TO V2
 17167           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17168              MOVE 3                TO V2
 17169           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17170              MOVE 4                TO V2
 17171           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17172              MOVE 5                TO V2
 17173           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17174              MOVE 6                TO V2
 17175           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17176              MOVE 7                TO V2
 17177           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 311
* EL050.cbl
 17178              MOVE 8                TO V2
 17179           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17180              MOVE 9                TO V2
 17181           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17182              MOVE 10               TO V2
 17183           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17184              MOVE 11               TO V2
 17185           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17186              MOVE 12               TO V2
 17187           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17188              MOVE 13               TO V2
 17189           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17190              MOVE 14               TO V2
 17191           WHEN OTHER
 17192              MOVE 15               TO V2
 17193        END-EVALUATE
 17194
 17195        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17196                                 TO CP-DDF-LO-FACT
 17197        MOVE PD-UEP-FACTOR (V1 V2)
 17198                                 TO CP-DDF-HI-FACT
 17199
 17200        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17201        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17202        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17203           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17204        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17205        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17206        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17207           + PD-1ST-YR-ADMIN-ALLOW
 17208
 17209        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17210*       IF PI-CLP-YN = 'Y'
 17211*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17212*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17213*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17214*       END-IF
 17215
 17216        IF DD-IU-PRESENT
 17217           MOVE 'I'              TO CP-EARNING-METHOD
 17218        END-IF
 17219        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17220                                     CP-CLP-RATE-UP
 17221        IF CP-IU-RATE-UP NOT = ZEROS
 17222           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17223              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17224           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17225              / (1 - WS-WORK-FACT)
 17226        END-IF
 17227     END-IF
 17228     .
 17229 3750-CONTINUE.
 17230     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17231
 17232     IF CP-REFUND-TYPE-USED NOT = SPACE
 17233         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17234
 17235     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 312
* EL050.cbl
 17236        CP-ERROR-RATE-NOT-FOUND
 17237        MOVE ER-2740             TO WS-ERROR
 17238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17239
 17240     IF CP-ERROR-RATE-FILE-NOTOPEN
 17241        MOVE ER-2617             TO WS-ERROR
 17242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17243     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17244        AND (PB-CI-ENTRY-STATUS = 'M')
 17245        MOVE +0                  TO PB-C-AH-REF-CALC
 17246     ELSE
 17247        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17248     END-IF
 17249     if pb-company-id = 'VPP'
 17250        MOVE cm-ah-clp           to cp-original-premium
 17251        move zeros               to cp-calc-refund
 17252        perform 7600-get-refund  thru 7600-exit
 17253        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17254           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17255        else
 17256           move zeros            to pb-c-ah-rfnd-clp
 17257        end-if
 17258        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17259           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17260           pb-ci-cancel-fee
 17261     end-if
 17262     IF PB-COMPANY-ID = 'DCC'
 17263        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17264        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17265        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17266        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17267        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17268        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17269        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17270        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17271*       if pb-c-cancel-amt < +0
 17272*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17273*       end-if
 17274*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17275     END-IF
 17276     .
 17277 3770-CHECK-REFUNDS.
 17278
 17279     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17280        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17281           MOVE ER-2766          TO WS-ERROR
 17282           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17283           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17284           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17285              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17286
 17287     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17288        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17289           MOVE ER-2766          TO WS-ERROR
 17290           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17291           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17292           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17293              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 313
* EL050.cbl
 17294
 17295     IF PB-COMP-LF-CANCEL
 17296        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17297        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17298           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17299              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17300
 17301     IF PB-COMP-AH-CANCEL
 17302        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17303        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17304           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17305              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17306
 17307     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17308             GIVING WS-UNSIGN-WRK1
 17309     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17310             GIVING WS-UNSIGN-WRK2.
 17311
 17312     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17313         MOVE ZERO TO WS-UNSIGN-WRK1.
 17314
 17315     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17316         MOVE ZERO TO WS-UNSIGN-WRK2.
 17317
 17318     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17319
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 314
* EL050.cbl
 17321
 17322 3772-CONTINUE.
 17323
 17324**********************************
 17325*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17326*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17327*** DOUBLES THE TOLERANCE AMOUNT.
 17328***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17329**********************************
 17330     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17331     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17332         IF WS-REF-REJECT-SW = SPACE
 17333             MOVE ER-2754        TO WS-ERROR
 17334             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17335           ELSE
 17336             MOVE ER-2736        TO WS-ERROR
 17337             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17338**********************************
 17339
 17340 3773-CONTINUE.
 17341
 17342     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17343        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17344           MOVE ER-2723          TO WS-ERROR
 17345           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17346
 17347     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17348        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17349           MOVE ER-2724          TO WS-ERROR
 17350           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17351
 17352     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17353         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17354             (1 + WS-LF-REFUND-OVS-PCT)
 17355     ELSE
 17356         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17357
 17358     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17359         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17360             (1 - WS-TOL-LF-REFUND-PCT)
 17361     ELSE
 17362         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17363
 17364     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17365        AND (PB-CI-ENTRY-STATUS = 'M')
 17366        AND (PB-C-LF-CANCEL-AMT > +0)
 17367        MOVE ER-3843             TO WS-ERROR
 17368        PERFORM 9900-ERROR-FORMAT
 17369                                 THRU 9900-EXIT
 17370     END-IF
 17371     EVALUATE TRUE
 17372        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17373           CONTINUE
 17374        WHEN PB-C-LF-CANCEL-AMT = +0
 17375                 AND PB-C-LF-REF-CALC > +0
 17376           CONTINUE
 17377        WHEN WS-LF-REFUND-OVS-AMT = 0
 17378                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 315
* EL050.cbl
 17379           CONTINUE
 17380        WHEN OTHER
 17381           IF WS-TOL-LF-REFUND  = +0
 17382              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17383           END-IF
 17384           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17385                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17386                          (PB-C-LF-CANCEL-AMT))
 17387              CONTINUE
 17388           ELSE
 17389              IF WS-LF-REFUND-OVS-AMT = +0
 17390                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17391              END-IF
 17392              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17393                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17394                                       PB-C-LF-CANCEL-AMT)
 17395                 CONTINUE
 17396              ELSE
 17397                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17398                   MOVE ER-2754   TO  WS-ERROR
 17399                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17400                 ELSE
 17401                    MOVE ER-2736   TO  WS-ERROR
 17402                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17403                 END-IF
 17404              END-IF
 17405           END-IF
 17406     END-EVALUATE.
 17407
 17408     EVALUATE TRUE
 17409        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17410           CONTINUE
 17411        WHEN PB-C-LF-CANCEL-AMT = +0
 17412                 AND PB-C-LF-REF-CALC > +0
 17413           CONTINUE
 17414        WHEN OTHER
 17415           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17416               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17417              CONTINUE
 17418           ELSE
 17419              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17420               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17421                CONTINUE
 17422              ELSE
 17423                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17424                     MOVE ER-2754   TO  WS-ERROR
 17425                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17426                 ELSE
 17427                     MOVE ER-2736   TO  WS-ERROR
 17428                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17429                 END-IF
 17430              END-IF
 17431           END-IF
 17432     END-EVALUATE.
 17433
 17434     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17435         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17436             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 316
* EL050.cbl
 17437     ELSE
 17438         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17439
 17440     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17441         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17442             (1 - WS-TOL-AH-REFUND-PCT)
 17443     ELSE
 17444         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17445
 17446     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17447        AND (PB-CI-ENTRY-STATUS = 'M')
 17448        AND (PB-C-AH-CANCEL-AMT > +0)
 17449        MOVE ER-3843             TO WS-ERROR
 17450        PERFORM 9900-ERROR-FORMAT
 17451                                 THRU 9900-EXIT
 17452     END-IF
 17453     EVALUATE TRUE
 17454        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17455           CONTINUE
 17456*       WHEN PB-C-AH-REF-CALC = +0 AND
 17457*                  PB-C-AH-CANCEL-AMT > +0
 17458        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17459                   PB-C-AH-REF-CALC > +0
 17460           CONTINUE
 17461        WHEN WS-AH-REFUND-OVS-AMT = +0
 17462                AND WS-TOL-AH-REFUND = +0
 17463           CONTINUE
 17464        WHEN OTHER
 17465           IF WS-TOL-AH-REFUND = +0
 17466              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17467           END-IF
 17468           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17469               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17470                                         PB-C-AH-CANCEL-AMT)
 17471              CONTINUE
 17472           ELSE
 17473              IF WS-AH-REFUND-OVS-AMT = +0
 17474                 MOVE +9999999.99 TO
 17475                         WS-AH-REFUND-OVS-AMT
 17476              END-IF
 17477              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17478                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17479                                         PB-C-AH-CANCEL-AMT)
 17480                 CONTINUE
 17481              ELSE
 17482                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17483                    MOVE ER-2754   TO  WS-ERROR
 17484                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17485                 ELSE
 17486                    MOVE ER-2736   TO  WS-ERROR
 17487                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17488                 END-IF
 17489              END-IF
 17490           END-IF
 17491     END-EVALUATE.
 17492
 17493     EVALUATE TRUE
 17494        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 317
* EL050.cbl
 17495           CONTINUE
 17496*       WHEN PB-C-AH-REF-CALC > +0 AND
 17497*                  PB-C-AH-CANCEL-AMT = +0
 17498        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17499                   PB-C-AH-REF-CALC = +0
 17500           CONTINUE
 17501        WHEN OTHER
 17502           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17503               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17504              CONTINUE
 17505           ELSE
 17506              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17507                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17508                 CONTINUE
 17509              ELSE
 17510                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17511                     MOVE ER-2754   TO  WS-ERROR
 17512                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17513                 ELSE
 17514                     MOVE ER-2736   TO  WS-ERROR
 17515                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17516                 END-IF
 17517              END-IF
 17518           END-IF
 17519     END-EVALUATE.
 17520
 17521     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17522        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17523        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17524           AND  PB-C-LF-REF-CALC < +1.00
 17525           AND  PB-C-AH-REF-CALC < +1.00
 17526           CONTINUE
 17527        ELSE
 17528           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17529              AND (PB-CI-ENTRY-STATUS = 'M')
 17530              CONTINUE
 17531           ELSE
 17532              MOVE ER-2741       TO WS-ERROR
 17533              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17534           END-IF
 17535        END-IF
 17536     END-IF
 17537
 17538     IF (PB-C-LF-CANCEL-AMT = ZERO
 17539        AND WS-LF-BENEFIT-CD NOT = ZERO
 17540        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17541        AND PB-C-LF-REF-CALC NOT = ZERO)
 17542        OR
 17543        (PB-C-LF-CANCEL-AMT = ZERO
 17544        AND WS-LF-BENEFIT-CD NOT = ZERO
 17545        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17546             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17547                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17548                NEXT SENTENCE
 17549             ELSE
 17550                MOVE ER-2739        TO WS-ERROR
 17551                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17552
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 318
* EL050.cbl
 17553     IF (PB-C-AH-CANCEL-AMT = ZERO
 17554        AND WS-AH-BENEFIT-CD NOT = ZERO
 17555        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17556        AND PB-C-AH-REF-CALC NOT = ZERO)
 17557        OR
 17558        (PB-C-AH-CANCEL-AMT = ZERO
 17559        AND WS-AH-BENEFIT-CD NOT = ZERO
 17560        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17561             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17562                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17563                NEXT SENTENCE
 17564             ELSE
 17565                MOVE ER-2738        TO WS-ERROR
 17566                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17567
 17568 3775-OVER-REF-CHK.
 17569
 17570     IF PB-CI-ENTRY-STATUS = '5'
 17571        GO TO 3780-UPDATE-CANCEL-CERT.
 17572
 17573     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17574                              PB-CI-LF-ALT-PREMIUM-AMT.
 17575
 17576     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17577        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17578                                 PB-C-LF-REF-CALC
 17579      ELSE
 17580        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17581                                 PB-C-LF-CANCEL-AMT.
 17582
 17583     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17584        MOVE ER-2755             TO WS-ERROR
 17585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17586
 17587     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17588
 17589     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17590        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17591                                 PB-C-AH-REF-CALC
 17592      ELSE
 17593        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17594                                 PB-C-AH-CANCEL-AMT.
 17595
 17596     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17597        MOVE ER-2778             TO WS-ERROR
 17598        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17599
 17600     IF PB-CI-OB-FLAG NOT = 'Z'
 17601        NEXT SENTENCE
 17602       ELSE
 17603         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17604            MOVE ER-2757           TO WS-ERROR
 17605            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17606
 17607 3780-UPDATE-CANCEL-CERT.
 17608
 17609     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17610        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 319
* EL050.cbl
 17611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17612
 17613     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17614         MOVE ER-2729              TO WS-ERROR
 17615         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17616
 17617     IF PB-CI-LF-BENEFIT-CD = ZERO
 17618         GO TO 3780-UPDATE-CONT-1.
 17619
 17620     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17621         GO TO 3780-UPDATE-CONT-1.
 17622
 17623     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17624       AND
 17625        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17626       AND
 17627        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17628       AND
 17629        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17630            NEXT SENTENCE
 17631       ELSE
 17632        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17633          AND
 17634***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17635***       AND
 17636           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17637            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17638               MOVE ER-2730      TO WS-ERROR
 17639               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17640               GO TO 3999-END-EDIT
 17641            ELSE
 17642               GO TO 3999-END-EDIT
 17643        ELSE
 17644            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17645               MOVE ER-2765           TO WS-ERROR
 17646               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17647               GO TO 3785-CHECK-REF-INT.
 17648*              GO TO 3999-END-EDIT.
 17649
 17650 3780-UPDATE-CONT-1.
 17651     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17652
 17653     IF PB-CI-AH-BENEFIT-CD = ZERO
 17654         GO TO 3780-UPDATE-CONT-2.
 17655
 17656     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17657         GO TO 3780-UPDATE-CONT-2.
 17658
 17659     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17660
 17661     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17662       AND
 17663        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17664       AND
 17665        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17666       AND
 17667        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17668            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 320
* EL050.cbl
 17669       ELSE
 17670        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17671          AND
 17672***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17673***       AND
 17674           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17675           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17676            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17677               MOVE ER-2773      TO WS-ERROR
 17678               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17679               GO TO 3999-END-EDIT
 17680            ELSE
 17681               GO TO 3999-END-EDIT
 17682            END-IF
 17683           ELSE
 17684             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17685                IF MSTR-CERT-NO = W-CL-CERT-NO
 17686                   MOVE ER-2890 TO WS-ERROR
 17687                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17688                   GO TO 3999-END-EDIT
 17689                ELSE
 17690                   MOVE ER-2898 TO WS-ERROR
 17691                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17692                   GO TO 3999-END-EDIT
 17693                END-IF
 17694             ELSE
 17695                GO TO 3785-CHECK-REF-INT
 17696             END-IF
 17697           END-IF
 17698          ELSE
 17699            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17700              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17701                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17702                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17703                      MOVE ER-2890 TO WS-ERROR
 17704                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17705                      GO TO 3999-END-EDIT
 17706                   ELSE
 17707                      MOVE ER-2898 TO WS-ERROR
 17708                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17709                      GO TO 3999-END-EDIT
 17710                   END-IF
 17711                ELSE
 17712                   MOVE ER-2765 TO WS-ERROR
 17713                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17714                   GO TO 3785-CHECK-REF-INT
 17715                END-IF
 17716              ELSE
 17717               MOVE ER-2765      TO WS-ERROR
 17718               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17719               GO TO 3785-CHECK-REF-INT.
 17720*              GO TO 3999-END-EDIT.
 17721
 17722 3780-UPDATE-CONT-2.
 17723
 17724     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17725        AND WS-LF-BENEFIT-CD = ZERO
 17726           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 321
* EL050.cbl
 17727           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17728
 17729     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17730        AND WS-AH-BENEFIT-CD = ZERO
 17731           MOVE ER-2744           TO WS-ERROR
 17732           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17733
 17734     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17735        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17736        AND
 17737        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17738         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17739           MOVE ER-2746           TO WS-ERROR
 17740           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17741
 17742     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17743       AND
 17744        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17745             MOVE ER-2737        TO WS-ERROR
 17746             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17747
 17748     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17749       AND
 17750        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17751             MOVE ER-2737        TO WS-ERROR
 17752             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17753
 17754     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17755         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17756             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL' OR 'FNL'
 17757             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17758         ELSE
 17759             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17760                 MOVE ER-2768    TO WS-ERROR
 17761                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17762             ELSE
 17763                 MOVE ER-2756    TO WS-ERROR
 17764                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17765
 17766     IF CERT-PEND-ISSUE-RETURNED
 17767        MOVE ER-2772             TO WS-ERROR
 17768        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17769 3785-CHECK-REF-INT.
 17770*    IF PB-STATE NOT = 'NH' and 'TN'
 17771     IF PB-STATE NOT = 'NH'
 17772        GO TO 3999-END-EDIT
 17773     END-IF
 17774
 17775     MOVE ER-2796                TO WS-ERROR
 17776     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17777     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17778        OR (CM-REF-INTERFACE-SW = 'Y')
 17779        MOVE ER-2793             TO WS-ERROR
 17780        PERFORM 9900-ERROR-FORMAT
 17781                                 THRU 9900-EXIT
 17782     END-IF
 17783     MOVE +0                     TO WS-PAYMENT-AMT
 17784     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 322
* EL050.cbl
 17785        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17786               PB-C-AH-CANCEL-DT
 17787           GO TO 3999-END-EDIT
 17788        END-IF
 17789     end-if
 17790***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17791***-_-
 17792***-_-   For TN it's only flat cancels
 17793***-_-
 17794***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17795     if pb-state = 'TN'
 17796        if ((pb-c-lf-cancel-dt <> low-values)
 17797           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17798                      or
 17799           ((pb-c-ah-cancel-dt <> low-values)
 17800           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17801           GO TO 3999-END-EDIT
 17802        END-IF
 17803     end-if
 17804     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17805        GO TO 3999-END-EDIT
 17806     END-IF
 17807***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17808***-_-
 17809***-_-   if cancel date within 15 days of effective date, bypass
 17810***-_-
 17811***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17812     IF PB-STATE NOT = 'NH'
 17813        GO TO 3785-CONTINUE
 17814     END-IF
 17815     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17816     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17817     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17818        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17819     END-IF
 17820     MOVE '1'                    TO DC-OPTION-CODE
 17821     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17822     IF NO-CONVERSION-ERROR
 17823        IF DC-ELAPSED-DAYS < +16
 17824           GO TO 3999-END-EDIT
 17825        END-IF
 17826     END-IF
 17827***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17828***-_-
 17829***-_-   if cancel date within 30 days of current date then
 17830***-_-   bypass else subtract 15 days from period
 17831***-_-
 17832***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17833     MOVE +0                     TO DC-ELAPSED-DAYS
 17834     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17835     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17836     MOVE '1'                    TO DC-OPTION-CODE
 17837     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17838     IF NO-CONVERSION-ERROR
 17839        IF DC-ELAPSED-DAYS > +30
 17840           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17841        ELSE
 17842           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 323
* EL050.cbl
 17843        END-IF
 17844     ELSE
 17845        GO TO 3999-END-EDIT
 17846     END-IF
 17847     .
 17848 3785-CONTINUE.
 17849     if pb-state = 'TN'
 17850        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17851        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17852        MOVE '1'                 TO DC-OPTION-CODE
 17853        PERFORM 8500-DATE-CONVERT
 17854                                 THRU 8500-EXIT
 17855        IF no-CONVERSION-ERROR
 17856           IF DC-ELAPSED-DAYS < +16
 17857              GO TO 3999-END-EDIT
 17858           END-IF
 17859        END-IF
 17860     end-if
 17861***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17862***-_-
 17863***-_-   'NH' is 10%, TN is 3.5%
 17864***-_-
 17865***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17866*    if pb-state = 'NH'
 17867*       move +1.10               to ws-work-rate
 17868*    else
 17869*       move +1.035              to ws-work-rate
 17870*    end-if
 17871     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17872     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17873        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17874           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17875     IF WS-PAYMENT-AMT < 10.00
 17876        GO TO 3999-END-EDIT
 17877     END-IF
 17878*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17879
 17880     if (cm-soc-sec-no(1:9) numeric)
 17881        and (cm-soc-sec-no(1:9) not = zeros)
 17882        GO TO 3999-END-EDIT
 17883     END-IF
 17884     MOVE ER-2795                TO WS-ERROR
 17885     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17886
 17887     GO TO 3999-END-EDIT.
 17888******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 324
* EL050.cbl
 17890 3990-FILES-NOT-OPEN.
 17891
 17892     MOVE ER-2617                TO WS-ERROR.
 17893     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17894     GO TO 9990-RETURN.
 17895
 17896 3999-END-EDIT.
 17897
 17898     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17899
 17900     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17901         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17902         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17903             PERFORM 9250-UNLOCK-RETURN
 17904             GO TO 9990-RETURN
 17905          ELSE
 17906             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17907             GO TO 9990-RETURN.
 17908
 17909     IF PB-CANCELLATION
 17910          GO TO 9990-RETURN.
 17911
 17912     IF CERT-WAS-NOT-FOUND
 17913        MOVE SPACES              TO CERTIFICATE-MASTER.
 17914
 17915     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17916
 17917     IF CERT-WAS-FOUND
 17918         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17919             PERFORM 9250-UNLOCK-RETURN
 17920          ELSE
 17921            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17922      ELSE
 17923         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17924
 17925*    if pb-company-id = 'VPP'
 17926*       perform 8150-read-elcrtt thru 8150-exit
 17927*       if ws-vehicle-odometer numeric
 17928*          if ws-vehicle-odometer > 6000
 17929*             move er-1583       to ws-error
 17930*             PERFORM 9900-ERROR-FORMAT
 17931*                                THRU 9900-EXIT
 17932*          end-if
 17933*       end-if
 17934*    end-if
 17935     if (pb-cert-sfx not = ' ')
 17936                 or
 17937        (pb-i-entry-status = 'V')
 17938        perform 7320-CHECK-FOR-OPEN-CLMS-issue
 17939                                 thru 7320-exit
 17940     end-if
 17941     perform 8145-read-elcrtt-upd thru 8145-exit
 17942     if not elcrtt-found
 17943        move 'CS'                to certificate-trailers
 17944        move cm-control-primary  to cs-control-primary
 17945        move 'C'                 TO cs-trailer-type
 17946        move zeros               to cs-vehicle-odometer
 17947     end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 325
* EL050.cbl
 17948     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17949        IF ((PB-COMPANY-ID = 'DCC')
 17950           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17951                         or
 17952           (pb-company-id = 'CID' or 'VPP')
 17953           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 17954               or (hldi-pass-area not = spaces)
 17955               move pa-modelyear        to cs-year
 17956               move pa-makename         to cs-make
 17957               move pa-modelname        to cs-model
 17958               move pa-seriesname       to cs-future
 17959               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17960               move 'Y'                 to elcrtt-update-sw
 17961           end-if
 17962        end-if
 17963     end-if
 17964     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17965        IF WS-INS-AGE-SET = 'Y'
 17966           MOVE WS-INS-AGE-DEFAULTED
 17967                                 TO CS-INS-AGE-DEFAULT-FLAG
 17968           move 'Y'              to elcrtt-update-sw
 17969        END-IF
 17970        IF WS-JNT-AGE-SET = 'Y'
 17971           MOVE WS-JNT-AGE-DEFAULTED
 17972                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17973           move 'Y'              to elcrtt-update-sw
 17974        END-IF
 17975     end-if
 17976     IF PB-I-LETTER-REQD = 'Y'
 17977        MOVE ER-1577             TO WS-ERROR
 17978        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17979     ELSE
 17980     IF PB-I-LETTER-REQD = 'N'
 17981        MOVE ER-1584             TO WS-ERROR
 17982        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17983     END-IF.
 17984
 17985     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17986     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17987     move cs-vehicle-odometer    to ws-vehicle-odometer
 17988     if ws-ins-age-defaulted = 'Y'
 17989        move er-1573             to ws-error
 17990        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17991     end-if
 17992
 17993     if ws-jnt-age-defaulted = 'Y'
 17994        move er-1574             to ws-error
 17995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17996     end-if
 17997***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17998***                                                           ****
 17999***  Set an error if the state requires verification of agent ****
 18000***  and agent hasn't verified yet and the status is not =    ****
 18001***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 18002***  and the entry date > 09/01/2015.                         ****
 18003***                                                           ****
 18004***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 18005     if (pb-input-dt >= X'AD81')    *> 09/01/2015
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 326
* EL050.cbl
 18006        and (pb-i-entry-status not = '5' and 'D' and 'V')
 18007        and (pb-account (9:2) not = 'OB')
 18008        if (ws-st-agent-sig-edit = 'Y')
 18009           and (am-report-code-1 not = 'CONLEY')
 18010           evaluate true
 18011              when cs-agent-edit-status = 'C'
 18012                 move er-1743    to ws-error
 18013                 perform 9900-error-format
 18014                                 thru 9900-exit
 18015              when cs-agent-edit-status = 'S'
 18016                 move er-1744    to ws-error
 18017                 perform 9900-error-format
 18018                                 thru 9900-exit
 18019              when cs-agent-edit-status = 'M'
 18020                 move er-1745    to ws-error
 18021                 perform 9900-error-format
 18022                                 thru 9900-exit
 18023              when cs-agent-edit-status = 'R'
 18024                 move er-1747    to ws-error
 18025                 perform 9900-error-format
 18026                                 thru 9900-exit
 18027              when cs-agent-edit-status = 'N'
 18028                 move er-1748    to ws-error
 18029                 perform 9900-error-format
 18030                                 thru 9900-exit
 18031              when cs-agent-edit-status <> 'V' and 'U' and
 18032                                           'R' and 'N' and
 18033                                           'H'
 18034                 move er-1746    to ws-error
 18035                 perform 9900-error-format
 18036                                 thru 9900-exit
 18037           end-evaluate
 18038        end-if
 18039     end-if
 18040*    move ' ' to cs-claim-verification-status
 18041*    move 'Y' to elcrtt-update-sw
 18042     if cs-claim-verification-status = ' ' or 'R'
 18043        move pb-state            to pa-clmhs-state
 18044        move pb-account          to pa-account
 18045        move ws-greg-eff-date    to pa-eff-dt
 18046        move pb-cert-no          to pa-cert-no
 18047        perform 7795-call-sqlclmhs
 18048                                 thru 7795-exit
 18049        if pa-clm-count > 0
 18050           if cs-claim-verification-status = ' '
 18051              move 'R'           to cs-claim-verification-status
 18052*             display 'Updating elcrtt ' pb-state ' '
 18053*                pb-account ' ' pb-cert-no
 18054              move 'Y'           to elcrtt-update-sw
 18055           end-if
 18056        else
 18057           if cs-claim-verification-status = 'R'
 18058              move ' '           to cs-claim-verification-status
 18059              move 'Y'           to elcrtt-update-sw
 18060           end-if
 18061        end-if
 18062     end-if
 18063
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 327
* EL050.cbl
 18064     if cs-claim-verification-status <> ' '
 18065        evaluate true
 18066           when cs-claim-verification-status = 'R'
 18067              move er-1749    to ws-error
 18068              perform 9900-error-format
 18069                              thru 9900-exit
 18070           when cs-claim-verification-status = 'W'
 18071              move er-1750    to ws-error
 18072              perform 9900-error-format
 18073                              thru 9900-exit
 18074           when cs-claim-verification-status = 'I'
 18075              move er-1751    to ws-error
 18076              perform 9900-error-format
 18077                              thru 9900-exit
 18078           when cs-claim-verification-status = 'K'
 18079              move er-1761    to ws-error
 18080              perform 9900-error-format
 18081                              thru 9900-exit
 18082           when cs-claim-verification-status = 'A'
 18083              move er-1752    to ws-error
 18084              perform 9900-error-format
 18085                              thru 9900-exit
 18086           when cs-claim-verification-status = 'B'
 18087              move er-1754    to ws-error
 18088              perform 9900-error-format
 18089                              thru 9900-exit
 18090           when cs-claim-verification-status = 'C'
 18091              move er-1753    to ws-error
 18092              perform 9900-error-format
 18093                              thru 9900-exit
 18094           when cs-claim-verification-status = 'D'
 18095              move er-1757    to ws-error
 18096              perform 9900-error-format
 18097                              thru 9900-exit
 18098           when cs-claim-verification-status = 'E'
 18099              move er-1758    to ws-error
 18100              perform 9900-error-format
 18101                              thru 9900-exit
 18102           when cs-claim-verification-status = 'F'
 18103              move er-1759    to ws-error
 18104              perform 9900-error-format
 18105                              thru 9900-exit
 18106           when cs-claim-verification-status = 'G'
 18107              move er-1760    to ws-error
 18108              perform 9900-error-format
 18109                              thru 9900-exit
 18110*          when cs-claim-verification-status = 'H'
 18111*             move er-1756    to ws-error
 18112*             perform 9900-error-format
 18113*                             thru 9900-exit
 18114*          when cs-claim-verification-status = 'J'
 18115*             move er-1755    to ws-error
 18116*             perform 9900-error-format
 18117*                             thru 9900-exit
 18118        end-evaluate
 18119     end-if
 18120
 18121     IF ELCRTT-UPDATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 328
* EL050.cbl
 18122        perform 8150-update-elcrtt thru 8150-exit
 18123*       display ' back from 8150 ' elcrtt-file-status
 18124     else
 18125        if elcrtt-found
 18126           perform 8155-unlock-elcrtt
 18127                                 thru 8155-exit
 18128        end-if
 18129     end-if
 18130     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18131     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18132        AND (WS-NO-SECURE-PAY))
 18133                  OR
 18134        (WS-LF-SPECIAL-CALC-CD = 'O'
 18135        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18136        SET SKIP-ADDR-EDIT       TO TRUE
 18137     END-IF
 18138     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18139        AND (NOT SKIP-ADDR-EDIT)
 18140        MOVE ER-2963             TO WS-ERROR
 18141        PERFORM 9900-ERROR-FORMAT
 18142                                 THRU 9900-EXIT
 18143        GO TO 9990-RETURN
 18144     END-IF
 18145     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18146     IF ERPNDM-FOUND NOT = 'X'
 18147        move 'Y'                 to erpndm-unlock-sw
 18148        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18149           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18150           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18151           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18152           or (pm-zip-code    = zeros)
 18153           or (pm-zip-code not numeric))
 18154           AND (NOT SKIP-ADDR-EDIT)
 18155           MOVE ER-2694          TO WS-ERROR
 18156           PERFORM 9900-ERROR-FORMAT
 18157                                 THRU 9900-EXIT
 18158        END-IF
 18159        MOVE ' '                 TO STATE-RECORD-ERROR
 18160        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18161        MOVE PM-STATE            TO CNTL-ACCESS
 18162        MOVE '3'                 TO CNTL-REC-TYPE
 18163        MOVE +0                  TO CNTL-SEQ-NO
 18164        MOVE '0'                 TO RC-SW-2
 18165        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18166        IF (NO-STATE-RECORD)
 18167           OR (CF-RECORD-TYPE NOT = '3')
 18168           OR (PM-STATE NOT = CF-STATE-CODE)
 18169           IF (PM-STATE = SPACES)
 18170              AND (SKIP-ADDR-EDIT)
 18171              CONTINUE
 18172           ELSE
 18173              MOVE ER-2963       TO WS-ERROR
 18174              PERFORM 9900-ERROR-FORMAT
 18175                                 THRU 9900-EXIT
 18176           END-IF
 18177        END-IF
 18178        if (ws-error not = er-2963 and er-2694)
 18179           and (pm-city-st-zip-verified = ' ')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 329
* EL050.cbl
 18180           and (pb-company-id = 'CID')
 18181           move spaces           to zipcd-pass-area
 18182           move pm-zip-code      to pa-zip
 18183           move pm-city          to pa-city
 18184           move pm-state         to pa-state
 18185           perform 7790-call-zip-verify
 18186                                 thru 7790-exit
 18187           if pa-errorcode-zip (1:1) = ' '
 18188                    move 'Y'     to pm-city-st-zip-verified
 18189                    PERFORM 8102-REWRITE-ERPNDM
 18190                                 THRU 8102-EXIT
 18191                    move 'N'     to erpndm-unlock-sw
 18192           else
 18193              MOVE ER-3061       TO WS-ERROR
 18194              PERFORM 9900-ERROR-FORMAT
 18195                                 THRU 9900-EXIT
 18196           end-if
 18197        end-if
 18198        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18199           MOVE ER-2883          TO WS-ERROR
 18200           PERFORM 9900-ERROR-FORMAT
 18201                                 THRU 9900-EXIT
 18202        END-IF
 18203        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18204           MOVE ' '                 TO STATE-RECORD-ERROR
 18205           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18206           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18207           MOVE '3'                 TO CNTL-REC-TYPE
 18208           MOVE +0                  TO CNTL-SEQ-NO
 18209           MOVE '0'                 TO RC-SW-2
 18210           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18211           IF NO-STATE-RECORD
 18212              OR (CF-RECORD-TYPE NOT = '3')
 18213              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18214              MOVE ER-2964          TO WS-ERROR
 18215              PERFORM 9900-ERROR-FORMAT
 18216                                    THRU 9900-EXIT
 18217           END-IF
 18218        END-IF
 18219     ELSE
 18220        IF NOT SKIP-ADDR-EDIT
 18221           MOVE ER-2393          TO WS-ERROR
 18222           PERFORM 9900-ERROR-FORMAT
 18223                                 THRU 9900-EXIT
 18224        END-IF
 18225     END-IF
 18226     if need-to-unlock-erpndm
 18227        perform 8104-unlock-erpndm
 18228                                 thru 8104-exit
 18229     end-if
 18230     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18231
 18232     IF (ERMAIL-FOUND = ' ' AND
 18233        ERPNDM-FOUND = ' ')
 18234        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18235           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18236           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18237          OR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 330
* EL050.cbl
 18238           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18239          OR
 18240           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18241           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18242           GO TO 3999-UNLOCK-ERMAIL.
 18243
 18244     IF ERPNDM-FOUND = 'X'
 18245        GO TO 3999-UNLOCK-ERMAIL.
 18246
 18247     IF PM-INSURED-LAST-NAME      = SPACES
 18248        AND PM-INSURED-FIRST-NAME = SPACES
 18249        AND PM-ADDRESS-LINE-1     = SPACES
 18250        AND PM-ADDRESS-LINE-2     = SPACES
 18251        AND PM-CITY-STATE         = SPACES
 18252        AND PM-CRED-BENE-NAME     = SPACES
 18253        AND PM-CRED-BENE-ADDR     = SPACES
 18254        AND PM-CRED-BENE-CTYST    = SPACES
 18255        GO TO 3999-UNLOCK-ERMAIL
 18256     END-IF
 18257
 18258     MOVE SPACES                 TO MAILING-DATA.
 18259
 18260     MOVE 'MA'                   TO MA-RECORD-ID.
 18261     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18262     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18263     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18264     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18265     MOVE PB-SV-STATE            TO MA-STATE.
 18266     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18267     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18268
 18269     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18270     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18271
 18272     IF ERMAIL-FOUND = ' '
 18273        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18274     ELSE
 18275        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18276        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18277        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18278
 18279     GO TO 9990-RETURN.
 18280
 18281 3999-UNLOCK-ERMAIL.
 18282     IF ERMAIL-FOUND = ' '
 18283        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18284
 18285     GO TO 9990-RETURN.
 18286******************************************************************
 18287
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 331
* EL050.cbl
 18289 4000-UPDATE-CANCELLED-CERT.
 18290     IF CERT-WAS-NOT-FOUND
 18291        GO TO 4299-EXIT.
 18292
 18293*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18294     IF PB-C-INT-ON-REFS > ZEROS
 18295        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18296     END-IF
 18297     IF PB-C-REF-INTERFACE-SW = 'Y'
 18298        MOVE PB-C-REF-INTERFACE-SW
 18299                                 TO CM-ref-INTERFACE-SW
 18300     END-IF
 18301*    IF ERMAIL-FOUND = ' '
 18302*       PERFORM 8140-UNLOCK-ERMAIL
 18303*                                THRU 8140-EXIT
 18304*    end-if
 18305     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18306     IF ERMAIL-FOUND = 'X'
 18307        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18308        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18309        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18310        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18311           MOVE ER-2694          TO WS-ERROR
 18312           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18313     END-IF
 18314
 18315     IF PB-C-POST-CARD-IND = 'Y'
 18316        MOVE +8                  TO SUB
 18317*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18318        IF ERMAIL-FOUND = ' '
 18319           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18320              (SUB > +7)
 18321              OR (MA-MAIL-STATUS (SUB) = '1')
 18322           END-PERFORM
 18323        END-IF
 18324        IF (SUB > +7)
 18325           OR (ERMAIL-FOUND = 'X')
 18326           MOVE ER-3789          TO WS-ERROR
 18327           PERFORM 9900-ERROR-FORMAT
 18328                                 THRU 9900-EXIT
 18329        END-IF
 18330     ELSE
 18331        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18332     END-IF
 18333
 18334     IF ERMAIL-FOUND = ' '
 18335        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18336     END-IF.
 18337
 18338     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18339
 18340     IF PB-CI-OB-FLAG = 'Z'
 18341        GO TO 4150-SUMMARY-CERT-CANCEL.
 18342     perform 8145-read-elcrtt-upd thru 8145-exit
 18343     if not elcrtt-found
 18344        move 'CS'                to certificate-trailers
 18345        move cm-control-primary  to cs-control-primary
 18346        move 'C'                 TO cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 332
* EL050.cbl
 18347        move zeros               to cs-vehicle-odometer
 18348     end-if
 18349
 18350     if pb-lf-refund-type <> cs-lf-refund-method
 18351        move pb-lf-refund-type   to cs-lf-refund-method
 18352        set elcrtt-update to true
 18353     end-if
 18354     if pb-ah-refund-type <> cs-ah-refund-method
 18355        move pb-ah-refund-type   to cs-ah-refund-method
 18356        set elcrtt-update to true
 18357     end-if
 18358     IF PB-C-LF-CANCEL-VOIDED
 18359         PERFORM 4200-REVERSE-LF-CANCEL.
 18360     IF PB-C-AH-CANCEL-VOIDED
 18361         PERFORM 4200-REVERSE-AH-CANCEL.
 18362     IF ELCRTT-UPDATE
 18363        perform 8150-update-elcrtt thru 8150-exit
 18364     else
 18365        if elcrtt-found
 18366           perform 8155-unlock-elcrtt
 18367                                 thru 8155-exit
 18368        end-if
 18369     end-if
 18370     .
 18371 4100-APPLY-LF-CANCEL.
 18372
 18373     MOVE +0                     TO WS-SUB.
 18374
 18375 4100-CHECK-LF-ERRORS.
 18376
 18377     ADD +1                       TO WS-SUB.
 18378
 18379     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18380        IF LF-COVERAGE-CANCELLED
 18381           GO TO 4100-LF-CANCEL-CONT
 18382        ELSE
 18383           GO TO 4100-UPDATE-LF-COVERAGE.
 18384
 18385     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18386                                   ER-2729 OR
 18387                                   ER-2730 OR
 18388                                   ER-2731 OR
 18389                                   ER-2732 OR
 18390                                   ER-2737 OR
 18391                                   ER-2740 OR
 18392                                   ER-2743 OR
 18393                                   ER-2749 OR
 18394                                   ER-2750 OR
 18395                                   ER-2755 OR
 18396                                   ER-2757 OR
 18397                                   ER-2760 OR
 18398                                   ER-2772 OR
 18399                                   ER-2774 OR
 18400                                   ER-2776 OR
 18401                                   ER-2794
 18402        GO TO 4100-UPDATE-LF-COVERAGE.
 18403
 18404     GO TO 4100-CHECK-LF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 333
* EL050.cbl
 18405
 18406 4100-UPDATE-LF-COVERAGE.
 18407
 18408     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18409     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18410     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18411        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18412     END-IF
 18413     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18414                                      TO CM-CREDIT-INTERFACE-SW-2.
 18415     IF CM-LF-CANCEL-DT = LOW-VALUE
 18416         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18417
 18418     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18419         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18420                                         CM-LF-STATUS-AT-CANCEL.
 18421
 18422     GO TO 4100-APPLY-AH-CANCEL.
 18423
 18424 4100-LF-CANCEL-CONT.
 18425     IF PB-C-LF-CANCEL-VOIDED
 18426         GO TO 4100-APPLY-AH-CANCEL.
 18427
 18428     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18429         GO TO 4100-APPLY-AH-CANCEL.
 18430
 18431     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18432        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18433           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18434        ELSE
 18435           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18436
 18437     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18438     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18439
 18440     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18441         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18442
 18443     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18444        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18445         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18446         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18447
 18448     IF PB-RECORD-RETURNED
 18449        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18450      ELSE
 18451        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18452
 18453 4100-APPLY-AH-CANCEL.
 18454
 18455     MOVE +0                      TO WS-SUB.
 18456
 18457 4100-CHECK-AH-ERRORS.
 18458
 18459     ADD +1                       TO WS-SUB.
 18460
 18461     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18462        IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 334
* EL050.cbl
 18463           GO TO 4100-AH-CANCEL-CONT
 18464        ELSE
 18465           GO TO 4100-UPDATE-AH-COVERAGE.
 18466
 18467     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18468                                   ER-2729 OR
 18469                                   ER-2732 OR
 18470                                   ER-2737 OR
 18471                                   ER-2740 OR
 18472                                   ER-2744 OR
 18473                                   ER-2749 OR
 18474                                   ER-2750 OR
 18475                                   ER-2755 OR
 18476                                   ER-2757 OR
 18477                                   ER-2760 OR
 18478                                   ER-2771 OR
 18479                                   ER-2772 OR
 18480                                   ER-2773 OR
 18481                                   ER-2775 OR
 18482                                   ER-2777 OR
 18483                                   ER-2778 OR
 18484                                   ER-2794
 18485        GO TO 4100-UPDATE-AH-COVERAGE.
 18486
 18487     GO TO 4100-CHECK-AH-ERRORS.
 18488
 18489 4100-UPDATE-AH-COVERAGE.
 18490
 18491     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18492     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18493     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18494     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18495                                      TO CM-CREDIT-INTERFACE-SW-2.
 18496     IF CM-AH-CANCEL-DT = LOW-VALUE
 18497         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18498
 18499     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18500         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18501                                         CM-AH-STATUS-AT-CANCEL.
 18502
 18503     IF LF-COVERAGE-CANCELLED
 18504         IF PB-RECORD-RETURNED
 18505              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18506          ELSE
 18507              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18508
 18509     GO TO 4299-EXIT.
 18510
 18511 4100-AH-CANCEL-CONT.
 18512     IF PB-C-AH-CANCEL-VOIDED
 18513         GO TO 4299-EXIT.
 18514
 18515     if cm-credit-interface-sw-2 = ' '
 18516        if pb-fatal-errors or pb-unforced-errors
 18517           move '4'              to cm-credit-interface-sw-2
 18518        else
 18519           move '1'              to cm-credit-interface-sw-2
 18520        end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 335
* EL050.cbl
 18521     end-if
 18522     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18523         GO TO 4299-EXIT.
 18524
 18525     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18526        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18527           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18528        ELSE
 18529           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18530
 18531     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18532     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18533
 18534     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18535         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18536
 18537     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18538         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18539         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18540
 18541     IF PB-RECORD-RETURNED
 18542        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18543      ELSE
 18544        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18545
 18546     GO TO 4299-EXIT.
 18547
 18548 4150-SUMMARY-CERT-CANCEL.
 18549     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18550
 18551     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18552        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18553                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18554     ELSE
 18555        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18556                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18557
 18558     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18559        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18560                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18561     ELSE
 18562        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18563                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18564
 18565     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18566        NEXT SENTENCE
 18567     ELSE
 18568        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18569
 18570     GO TO 4299-EXIT.
 18571
 18572 4200-REVERSE-LF-CANCEL.
 18573     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18574
 18575     IF CM-LF-CANCEL-APPLIED
 18576        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18577        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18578        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 336
* EL050.cbl
 18579
 18580     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18581
 18582     IF PB-RECORD-RETURNED
 18583        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18584       ELSE
 18585        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18586
 18587 4200-REVERSE-LF-EXIT.
 18588       EXIT.
 18589
 18590 4200-REVERSE-AH-CANCEL.
 18591     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18592
 18593     IF CM-AH-CANCEL-APPLIED
 18594        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18595        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18596        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18597
 18598     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18599
 18600     IF PB-RECORD-RETURNED
 18601        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18602       ELSE
 18603        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18604
 18605 4200-REVERSE-AH-EXIT.
 18606       EXIT.
 18607
 18608 4299-EXIT.
 18609       EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 337
* EL050.cbl
 18611
 18612 4500-UPDATE-NEW-CERT.
 18613     IF CERT-WAS-FOUND
 18614         NEXT SENTENCE
 18615       ELSE
 18616         GO TO 4520-BUILD-NEW-KEY.
 18617
 18618     IF  CLASIC-CREATED-CERT
 18619         GO TO 4999-EXIT.
 18620
 18621     IF  CERT-WAS-CREATED-FOR-CLAIM
 18622         GO TO 4520-BUILD-NEW-KEY.
 18623
 18624     IF CERT-ADDED-BATCH
 18625        IF CM-RECORD-ID = 'CM'
 18626            GO TO 4999-EXIT.
 18627
 18628 4520-BUILD-NEW-KEY.
 18629* BUILD CONTROL PRIMARY
 18630
 18631     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18632                                       CM-COMPANY-CD-A1
 18633                                       CM-COMPANY-CD-A2
 18634                                       CM-COMPANY-CD-A4
 18635                                       CM-COMPANY-CD-A5.
 18636
 18637     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18638     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18639     MOVE PB-SV-STATE               TO CM-STATE.
 18640     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18641     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18642     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18643     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18644
 18645     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18646
 18647     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18648     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18649     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18650     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18651
 18652     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18653        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18654
 18655     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18656         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18657         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18658         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18659         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18660     ELSE
 18661         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18662
 18663     IF PB-COMPANY-ID   EQUAL  'CRI'
 18664         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18665         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18666         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18667         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18668         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 338
* EL050.cbl
 18669
 18670     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18671        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18672         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18673
 18674     IF PB-COMPANY-ID  = 'LBL'
 18675        IF PB-I-JOINT-COVERAGE
 18676            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18677                                           PB-I-MEMBER-NO
 18678            GO TO 4550-CONT-CERT-PROCESS.
 18679
 18680     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18681        NEXT SENTENCE
 18682     ELSE
 18683        GO TO 4540-BUILD-MEMBER-NO.
 18684
 18685******************************************************************
 18686*                                                                *
 18687*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18688*    FOR 'MON'.                                                  *
 18689*                                                                *
 18690******************************************************************
 18691
 18692     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18693     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18694     MOVE +1                     TO WS-SUB1
 18695                                    WS-SUB2.
 18696
 18697 4530-EDIT-MEMB-NAME.
 18698
 18699     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18700        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18701        ADD +1                       TO WS-SUB2.
 18702
 18703     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18704        ADD +1                       TO WS-SUB1
 18705        GO TO 4530-EDIT-MEMB-NAME.
 18706
 18707     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18708     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18709     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18710*    MOVE SPACE                      TO DC-OPTION-CODE.
 18711     SET  BIN-TO-GREG                TO TRUE.
 18712     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18713     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18714
 18715     GO TO 4550-CONT-CERT-PROCESS.
 18716
 18717******************************************************************
 18718*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18719******************************************************************
 18720
 18721 4540-BUILD-MEMBER-NO.
 18722
 18723     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18724         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18725         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18726         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 339
* EL050.cbl
 18727         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18728     ELSE
 18729         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18730
 18731     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18732        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18733         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18734
 18735 4550-CONT-CERT-PROCESS.
 18736
 18737*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18738*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18739*    ELSE
 18740*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18741
 18742     IF CERT-WAS-CREATED-FOR-CLAIM
 18743        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18744        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18745
 18746     IF CERT-AND-CLAIM-ONLINE
 18747        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18748        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18749
 18750     MOVE 'CM'                     TO CM-RECORD-ID.
 18751     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18752
 18753     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18754        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18755        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18756     ELSE
 18757        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18758        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18759
 18760     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18761     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18762     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18763     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18764     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18765     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18766     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18767                                      CM-LF-ITD-CANCEL-AMT
 18768                                      CM-LF-ITD-DEATH-AMT
 18769                                      CM-AH-ITD-AH-PMT
 18770                                      CM-AH-ITD-LUMP-PMT
 18771                                      CM-AH-ITD-CANCEL-AMT
 18772                                      CM-LF-NSP-PREMIUM-AMT
 18773                                      CM-AH-NSP-PREMIUM-AMT.
 18774*                                     CM-CLAIM-DEDUCT-WITHHELD
 18775*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18776     if pb-i-loan-apr = +99.9999
 18777        move zeros                 to cm-loan-apr
 18778     else
 18779        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18780     end-if
 18781     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18782     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18783     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18784     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 340
* EL050.cbl
 18785     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18786     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18787     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18788     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18789     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18790     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18791     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18792
 18793     IF PB-I-LIVES NOT NUMERIC
 18794         MOVE ZERO                 TO PB-I-LIVES.
 18795
 18796     IF PB-I-NUM-BILLED NOT NUMERIC
 18797         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18798
 18799     MOVE PB-I-LIVES               TO CM-LIVES.
 18800     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18801
 18802     IF PB-COMPANY-ID EQUAL  'DMD'
 18803         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18804         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18805
 18806     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18807     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18808     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18809     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18810     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18811     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18812
 18813     IF PB-I-LF-POLICY-FEE NUMERIC
 18814        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18815     ELSE
 18816        MOVE +0                    TO CM-LF-POLICY-FEE.
 18817
 18818     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18819        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18820        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18821     ELSE
 18822        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18823
 18824     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18825     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18826     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18827     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18828     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18829     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18830     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18831     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18832     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18833
 18834     IF PB-I-CANCEL-FEE NUMERIC
 18835        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18836     ELSE
 18837        MOVE +0                  TO CM-CANCEL-FEE
 18838     END-IF
 18839
 18840     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18841        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18842     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 341
* EL050.cbl
 18843        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18844
 18845     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18846     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18847
 18848     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18849                                      CM-LF-DEATH-EXIT-DT
 18850                                      CM-AH-SETTLEMENT-EXIT-DT.
 18851
 18852*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18853*                       'TIH' OR 'OFL' OR 'FLA' OR
 18854*                       'TII' OR 'TMS' OR 'CRI' OR
 18855*                       'NCL'
 18856     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18857
 18858     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18859         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18860            MOVE '2'                TO CM-PREMIUM-TYPE.
 18861
 18862     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18863         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18864            MOVE '2'                TO CM-PREMIUM-TYPE.
 18865
 18866     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18867         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18868     ELSE
 18869         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18870         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18871
 18872     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18873     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18874     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18875     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18876     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18877     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18878     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18879     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18880
 18881     IF PB-NO-MONTHS-SKIPPED
 18882         MOVE SPACE                 TO CM-SKIP-CODE
 18883     ELSE
 18884         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18885
 18886     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18887     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18888                                       CM-LF-STATUS-AT-CANCEL.
 18889
 18890     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18891     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18892                                       CM-AH-STATUS-AT-CANCEL.
 18893
 18894     MOVE '1'                       TO CM-ENTRY-STATUS.
 18895
 18896     IF PB-REISSUED-CERT
 18897        MOVE '5'                    TO CM-ENTRY-STATUS.
 18898
 18899     IF PB-MONTHLY-CERT
 18900        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 342
* EL050.cbl
 18901
 18902     IF PB-CASH-CERT
 18903        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18904
 18905     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18906     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18907     IF PB-POLICY-IS-DECLINED
 18908        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18909
 18910     IF PB-POLICY-IS-VOIDED
 18911        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18912
 18913     IF PB-NEEDS-UNDERWRITING
 18914        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18915
 18916     IF PB-REIN-ONLY-CERT
 18917        MOVE '9'                    TO CM-ENTRY-STATUS.
 18918
 18919     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18920         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18921     ELSE
 18922         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18923
 18924     IF PB-RECORD-RETURNED
 18925        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18926      ELSE
 18927        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18928
 18929     IF PB-I-MAIL-ADDRS-PRESENT
 18930        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18931
 18932     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18933                                       CM-ENTRY-DT.
 18934
 18935 4999-EXIT.
 18936     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 343
* EL050.cbl
 18938
 18939 5000-PROCESS-REPS.
 18940     MOVE ' '                    TO AGTC-MASTER-SW
 18941     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18942     MOVE CO-TYPE                TO AGTC-TYPE
 18943     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18944     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18945     IF (AGTC-MASTER-SW NOT = 'N')
 18946        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18947        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18948        PERFORM 8583-READ-ERAGTC-NEXT
 18949                                 THRU 8583-EXIT
 18950     END-IF
 18951     IF AGTC-MASTER-SW = 'N'
 18952        CONTINUE
 18953     ELSE
 18954        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18955           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18956              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18957              MOVE 'Y'           TO AGTC-MASTER-SW
 18958           END-IF
 18959        END-IF
 18960     END-IF
 18961     .
 18962 5000-EXIT.
 18963     EXIT.
 18964 6370-EDIT-INPUT-LF-CODE.
 18965     move ' ' to ws-benefit-cd-chg-sw
 18966     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18967        MOVE +1                  TO SUB
 18968        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18969        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18970        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18971        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18972        GO TO 6370-SEARCH-LOOP.
 18973
 18974     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18975
 18976     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18977     MOVE SPACES                 TO CNTL-ACCESS.
 18978*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18979     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18980     MOVE +0                     TO CNTL-SEQ-NO.
 18981     MOVE '4' TO RC-SW-2.
 18982     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18983
 18984     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18985        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18986        GO TO 6370-NO-LF-FOUND.
 18987
 18988     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18989     MOVE +1                     TO SUB.
 18990
 18991 6370-SEARCH-LOOP.
 18992     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18993         GO TO 6370-NO-LF-FOUND.
 18994
 18995     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 344
* EL050.cbl
 18996        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18997           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18998           set benefit-code-chg to true
 18999        end-if
 19000        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 19001        GO TO 6370-HER-NET-PAY-CHECK.
 19002
 19003     ADD 1   TO SUB.
 19004*    IF SUB GREATER 120
 19005     IF SUB GREATER 200
 19006         GO TO 6370-NO-LF-FOUND.
 19007
 19008     GO TO 6370-SEARCH-LOOP.
 19009
 19010 6370-NO-LF-FOUND.
 19011
 19012     if (pb-i-lf-benefit-cd not = zeros and spaces)
 19013        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 19014        set benefit-code-chg to true
 19015     end-if
 19016     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 19017
 19018 6370-HER-NET-PAY-CHECK.
 19019
 19020     IF PB-COMPANY-ID = 'CID'
 19021        IF PB-SV-STATE = 'CA' OR 'MN'
 19022           IF PB-I-LF-BENEFIT-CD = '02'
 19023              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19024           ELSE
 19025              IF PB-I-LF-BENEFIT-CD = '04'
 19026                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19027              END-IF
 19028           END-IF
 19029        END-IF
 19030     END-IF
 19031
 19032     IF PB-COMPANY-ID NOT = 'HER'
 19033         GO TO 6370-EXIT.
 19034
 19035     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 19036         GO TO 6370-EXIT.
 19037
 19038     IF PB-I-LF-TERM NOT NUMERIC
 19039         MOVE ZEROS              TO PB-I-LF-TERM.
 19040
 19041     IF PB-I-LOAN-TERM NOT NUMERIC
 19042         MOVE ZEROS              TO PB-I-LOAN-TERM.
 19043
 19044     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 19045         GO TO 6370-EXIT.
 19046
 19047     IF PB-I-LF-BENEFIT-CD = '33'
 19048         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 19049
 19050     IF PB-I-LF-BENEFIT-CD = '34'
 19051         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 19052
 19053 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 345
* EL050.cbl
 19054     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 346
* EL050.cbl
 19056
 19057 6380-EDIT-INPUT-AH-CODE.
 19058     IF WK-AH-EDIT-ADDR NOT = ZEROS
 19059        MOVE +1                  TO SUB
 19060        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 19061        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 19062        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 19063        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 19064        GO TO 6380-SEARCH-LOOP.
 19065
 19066     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 19067
 19068     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 19069     MOVE SPACES                 TO CNTL-ACCESS.
 19070     MOVE 'A'                    TO CNTL-REC-TYPE.
 19071*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 19072     MOVE +0                     TO CNTL-SEQ-NO.
 19073     MOVE '5' TO RC-SW-2.
 19074     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 19075
 19076     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 19077        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 19078        GO TO 6380-NO-AH-FOUND.
 19079
 19080     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 19081     MOVE +1 TO SUB.
 19082
 19083 6380-SEARCH-LOOP.
 19084     IF CF-AH-CODE-OUT (SUB) = ZEROS
 19085         GO TO 6380-NO-AH-FOUND.
 19086
 19087     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 19088         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 19089         GO TO 6380-CSO-AH-ONLY-CHECKS.
 19090
 19091     ADD 1   TO SUB.
 19092     IF SUB GREATER THAN 96
 19093*    IF SUB GREATER THAN 300
 19094         GO TO 6380-NO-AH-FOUND.
 19095
 19096     GO TO 6380-SEARCH-LOOP.
 19097
 19098 6380-NO-AH-FOUND.
 19099
 19100     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 19101
 19102     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 19103         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 19104     ELSE
 19105         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 19106
 19107 6380-CSO-AH-ONLY-CHECKS.
 19108
 19109     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19110        NEXT SENTENCE
 19111      ELSE
 19112        GO TO 6380-EXIT.
 19113
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 347
* EL050.cbl
 19114     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19115         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19116
 19117
 19118     GO TO 6380-EXIT
 19119     .
 19120 6380-CSO-LIFE-WITH-AH-CHECKS.
 19121
 19122
 19123     .
 19124 6380-EXIT.
 19125     EXIT.
 19126
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 348
* EL050.cbl
 19128
 19129 6400-COMPUTE-EXTENSION-DAYS.
 19130
 19131******************************************************************
 19132*                                                                *
 19133*                   COMPUTE EXTENSION DAYS                       *
 19134*                                                                *
 19135*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19136*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19137*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19138*    THE EXTENSION DAYS.                                         *
 19139*                                                                *
 19140******************************************************************
 19141
 19142     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19143     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19144
 19145******************************************************************
 19146*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19147*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19148******************************************************************
 19149
 19150     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19151        COMPUTE WS-ODD-DAYS-OVER =
 19152               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19153     ELSE
 19154        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19155
 19156     IF WS-ODD-DAYS-OVER = ZEROS
 19157           GO TO 6499-EXIT
 19158     ELSE
 19159        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19160           IF WS-WDF-MONTH = 02
 19161              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19162              ADD 2       TO  WS-ODD-DAYS-OVER
 19163              GO TO 6499-EXIT
 19164           ELSE
 19165              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19166                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19167                 GO TO 6499-EXIT
 19168               ELSE
 19169                 GO TO 6499-EXIT
 19170        ELSE
 19171           GO TO 6499-EXIT.
 19172
 19173 6412-CHECK-TO-DAY.
 19174
 19175        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19176           IF WS-WDT-DAY = 28
 19177              ADD 2              TO WS-ODD-DAYS-OVER
 19178           ELSE
 19179              IF WS-WDT-DAY = 29
 19180                 ADD 1           TO WS-ODD-DAYS-OVER
 19181              ELSE
 19182                 NEXT SENTENCE
 19183        ELSE
 19184           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19185              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 349
* EL050.cbl
 19186
 19187     GO TO 6499-EXIT.
 19188
 19189
 19190 6415-CHECK-LEAP-YEAR.
 19191
 19192     IF DC-DAYS-IN-MONTH = 29
 19193        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19194
 19195 6415-EXIT.
 19196     EXIT.
 19197
 19198 6499-EXIT.
 19199      EXIT.
 19200
 19201 6500-END.
 19202     EXIT.
 19203
 19204
 19205******************************************************************
 19206************* PROCEDURE DIVISION FOR EL050 ***********************
 19207********************** ELC50PD END *******************************
 19208
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 350
* EL050.cbl
 19210
 19211**START***********************************************************
 19212*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19213*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19214******************************************************************
 19215*
 19216 6600-GET-STATE-MUNICIPAL-TAX.
 19217
 19218     IF PB-COMPANY-ID NOT = 'DMD'
 19219         GO TO 6640-EXIT.
 19220
 19221     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19222     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19223     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19224*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19225*
 19226***  Y2K PROJ 7744
 19227     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19228     SET BIN-TO-GREG          TO TRUE.
 19229     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19230
 19231     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19232
 19233     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19234     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19235
 19236
 19237* EXEC CICS HANDLE CONDITION
 19238*        INVREQ    (6610-START-BROWSE)
 19239*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19240*        NOTFND    (6630-END-OF-FILE)
 19241*    END-EXEC.
 19242*    MOVE '"$8JI                 ! # #00019226' TO DFHEIV0
 19243     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19245     MOVE X'2320233030303139323236' TO DFHEIV0(25:11)
 19246     CALL 'kxdfhei1' USING DFHEIV0
 19247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19248
 19249
 19250 6610-START-BROWSE.
 19251
 19252
 19253* EXEC CICS HANDLE CONDITION
 19254*        NOTFND    (6630-END-OF-FILE)
 19255*        DISABLED  (6630-ERRESS-PROBLEM)
 19256*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19257*        ENDFILE   (6630-END-OF-FILE)
 19258*    END-EXEC.
 19259*    MOVE '"$IcJ''                ! $ #00019234' TO DFHEIV0
 19260     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19262     MOVE X'2420233030303139323334' TO DFHEIV0(25:11)
 19263     CALL 'kxdfhei1' USING DFHEIV0
 19264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19265
 19266
 19267
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 351
* EL050.cbl
 19268* EXEC CICS STARTBR
 19269*        DATASET (FILE-ID-ERRESS)
 19270*        RIDFLD  (WS-ERRESS-KEY)
 19271*        GTEQ
 19272*    END-EXEC.
 19273     MOVE 0
 19274       TO DFHEIV11
 19275*    MOVE '&,         G          &   #00019241' TO DFHEIV0
 19276     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19277     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19278     MOVE X'2020233030303139323431' TO DFHEIV0(25:11)
 19279     CALL 'kxdfhei1' USING DFHEIV0,
 19280           FILE-ID-ERRESS,
 19281           WS-ERRESS-KEY,
 19282           DFHEIV99,
 19283           DFHEIV11,
 19284           DFHEIV99
 19285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19286
 19287
 19288 6620-READ-NEXT-ERRESS-MASTER.
 19289
 19290
 19291* EXEC CICS HANDLE CONDITION
 19292*        NOTFND    (6630-END-OF-FILE)
 19293*        ENDFILE   (6630-END-OF-FILE)
 19294*        DISABLED  (6630-ERRESS-PROBLEM)
 19295*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19296*    END-EXEC.
 19297*    MOVE '"$I''cJ                ! % #00019249' TO DFHEIV0
 19298     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19299     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19300     MOVE X'2520233030303139323439' TO DFHEIV0(25:11)
 19301     CALL 'kxdfhei1' USING DFHEIV0
 19302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19303
 19304
 19305
 19306* EXEC CICS READNEXT
 19307*        DATASET (FILE-ID-ERRESS)
 19308*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19309*        RIDFLD  (WS-ERRESS-KEY)
 19310*    END-EXEC.
 19311     MOVE LENGTH OF
 19312      RESIDENT-STATE-TAX-MASTER
 19313       TO DFHEIV12
 19314     MOVE 0
 19315       TO DFHEIV11
 19316*    MOVE '&.IL                  )   #00019256' TO DFHEIV0
 19317     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19318     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19319     MOVE X'2020233030303139323536' TO DFHEIV0(25:11)
 19320     CALL 'kxdfhei1' USING DFHEIV0,
 19321           FILE-ID-ERRESS,
 19322           RESIDENT-STATE-TAX-MASTER,
 19323           DFHEIV12,
 19324           WS-ERRESS-KEY,
 19325           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 352
* EL050.cbl
 19326           DFHEIV11,
 19327           DFHEIV99,
 19328           DFHEIV99
 19329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19330
 19331
 19332     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19333
 19334* EXEC CICS ENDBR
 19335*            DATASET (FILE-ID-ERRESS)
 19336*       END-EXEC
 19337     MOVE 0
 19338       TO DFHEIV11
 19339*    MOVE '&2                    $   #00019263' TO DFHEIV0
 19340     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19341     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19342     MOVE X'2020233030303139323633' TO DFHEIV0(25:11)
 19343     CALL 'kxdfhei1' USING DFHEIV0,
 19344           FILE-ID-ERRESS,
 19345           DFHEIV11,
 19346           DFHEIV99
 19347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19348        GO TO 6630-END-OF-FILE.
 19349
 19350     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19351        NEXT SENTENCE
 19352      ELSE
 19353        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19354
 19355*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19356*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19357*
 19358     MOVE +2                     TO WS-SUB1.
 19359
 19360     IF PB-ISSUE
 19361     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19362        MOVE +1                  TO WS-SUB1.
 19363
 19364     IF PB-CANCELLATION
 19365     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19366        MOVE +1                  TO WS-SUB1.
 19367*
 19368*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19369*
 19370***  Y2K PROJ 7744
 19371     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19372***  Y2K PROJ 7744
 19373
 19374*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19375* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19376* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19377
 19378     ADD 1                    TO WS-YEAR-YY.
 19379
 19380     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19381         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19382                              TO WS-RES-STATE-TAX
 19383         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 353
* EL050.cbl
 19384                              TO WS-RES-MUNI-TAX
 19385     ELSE
 19386         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19387                              TO WS-RES-STATE-TAX
 19388         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19389                              TO WS-RES-MUNI-TAX.
 19390
 19391*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19392
 19393     IF PB-CANCELLATION
 19394         GO TO 6640-CANCEL-TAX.
 19395
 19396     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19397         COMPUTE PB-I-STATE-TAX ROUNDED =
 19398                                   PB-I-LF-PREMIUM-AMT
 19399                                 * WS-RES-STATE-TAX
 19400         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19401                                   PB-I-LF-PREMIUM-AMT
 19402                                 * WS-RES-MUNI-TAX
 19403     ELSE
 19404     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19405         COMPUTE PB-I-STATE-TAX ROUNDED =
 19406                                   PB-I-AH-PREMIUM-AMT
 19407                                 * WS-RES-STATE-TAX
 19408         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19409                                   PB-I-AH-PREMIUM-AMT
 19410                                 * WS-RES-MUNI-TAX.
 19411
 19412
 19413* EXEC CICS ENDBR
 19414*         DATASET (FILE-ID-ERRESS)
 19415*    END-EXEC.
 19416     MOVE 0
 19417       TO DFHEIV11
 19418*    MOVE '&2                    $   #00019330' TO DFHEIV0
 19419     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19420     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19421     MOVE X'2020233030303139333330' TO DFHEIV0(25:11)
 19422     CALL 'kxdfhei1' USING DFHEIV0,
 19423           FILE-ID-ERRESS,
 19424           DFHEIV11,
 19425           DFHEIV99
 19426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19427
 19428
 19429     GO TO 6640-EXIT.
 19430
 19431 6640-CANCEL-TAX.
 19432     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19433
 19434     IF PB-C-LF-CANCEL-AMT > ZEROS
 19435         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19436                                   PB-C-LF-CANCEL-AMT
 19437                                 * WS-RES-STATE-TAX
 19438         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19439                                   PB-C-LF-CANCEL-AMT
 19440                                *  WS-RES-MUNI-TAX
 19441     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 354
* EL050.cbl
 19442     IF PB-C-AH-CANCEL-AMT > ZEROS
 19443         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19444                                   PB-C-AH-CANCEL-AMT
 19445                                 * WS-RES-STATE-TAX
 19446         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19447                                   PB-C-AH-CANCEL-AMT
 19448                                *  WS-RES-MUNI-TAX.
 19449
 19450
 19451* EXEC CICS ENDBR
 19452*         DATASET (FILE-ID-ERRESS)
 19453*    END-EXEC.
 19454     MOVE 0
 19455       TO DFHEIV11
 19456*    MOVE '&2                    $   #00019355' TO DFHEIV0
 19457     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19458     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19459     MOVE X'2020233030303139333535' TO DFHEIV0(25:11)
 19460     CALL 'kxdfhei1' USING DFHEIV0,
 19461           FILE-ID-ERRESS,
 19462           DFHEIV11,
 19463           DFHEIV99
 19464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19465
 19466
 19467     GO TO 6640-EXIT.
 19468
 19469 6630-END-OF-FILE.
 19470     MOVE ER-8002              TO WS-ERROR.
 19471     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19472
 19473     GO TO 6640-EXIT.
 19474
 19475 6630-ERRESS-PROBLEM.
 19476     MOVE ER-8044              TO WS-ERROR.
 19477     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19478
 19479 6640-EXIT.
 19480     EXIT.
 19481
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 355
* EL050.cbl
 19483 6650-GET-RES-STATE-COMM.
 19484
 19485     IF PB-COMPANY-ID NOT = 'DMD'
 19486         GO TO 6700-COMM-EXIT.
 19487
 19488     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19489     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19490     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19491     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19492     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19493     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19494     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19495
 19496*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19497*
 19498***  Y2K PROJ 7744
 19499     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19500     SET BIN-TO-GREG          TO TRUE.
 19501     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19502
 19503     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19504***  Y2K PROJ 7744
 19505
 19506     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19507
 19508
 19509* EXEC CICS HANDLE CONDITION
 19510*        INVREQ    (6660-START-BROWSE)
 19511*        DISABLED  (6690-ERRESC-PROBLEM)
 19512*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19513*        NOTFND    (6690-END-OF-FILE)
 19514*    END-EXEC.
 19515*    MOVE '"$8cJI                ! & #00019400' TO DFHEIV0
 19516     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19518     MOVE X'2620233030303139343030' TO DFHEIV0(25:11)
 19519     CALL 'kxdfhei1' USING DFHEIV0
 19520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19521
 19522
 19523
 19524* EXEC CICS RESETBR
 19525*        DATASET (FILE-ID-ERRESC)
 19526*        RIDFLD  (WS-ERRESC-KEY)
 19527*    END-EXEC.
 19528     MOVE 0
 19529       TO DFHEIV11
 19530*    MOVE '&4         G          &   #00019407' TO DFHEIV0
 19531     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19532     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19533     MOVE X'2020233030303139343037' TO DFHEIV0(25:11)
 19534     CALL 'kxdfhei1' USING DFHEIV0,
 19535           FILE-ID-ERRESC,
 19536           WS-ERRESC-KEY,
 19537           DFHEIV99,
 19538           DFHEIV11,
 19539           DFHEIV99
 19540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 356
* EL050.cbl
 19541
 19542
 19543 6660-START-BROWSE.
 19544
 19545
 19546* EXEC CICS HANDLE CONDITION
 19547*        NOTFND    (6690-END-OF-FILE)
 19548*        DISABLED  (6690-ERRESC-PROBLEM)
 19549*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19550*        ENDFILE   (6690-END-OF-FILE)
 19551*    END-EXEC.
 19552*    MOVE '"$IcJ''                ! '' #00019414' TO DFHEIV0
 19553     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19555     MOVE X'2720233030303139343134' TO DFHEIV0(25:11)
 19556     CALL 'kxdfhei1' USING DFHEIV0
 19557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19558
 19559
 19560
 19561* EXEC CICS STARTBR
 19562*        DATASET (FILE-ID-ERRESC)
 19563*        RIDFLD  (WS-ERRESC-KEY)
 19564*        GTEQ
 19565*    END-EXEC.
 19566     MOVE 0
 19567       TO DFHEIV11
 19568*    MOVE '&,         G          &   #00019421' TO DFHEIV0
 19569     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19570     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19571     MOVE X'2020233030303139343231' TO DFHEIV0(25:11)
 19572     CALL 'kxdfhei1' USING DFHEIV0,
 19573           FILE-ID-ERRESC,
 19574           WS-ERRESC-KEY,
 19575           DFHEIV99,
 19576           DFHEIV11,
 19577           DFHEIV99
 19578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19579
 19580
 19581     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19582
 19583 6670-READ-NEXT-ERRESC-MASTER.
 19584
 19585
 19586* EXEC CICS HANDLE CONDITION
 19587*        NOTFND    (6690-END-OF-FILE)
 19588*        DISABLED  (6690-ERRESC-PROBLEM)
 19589*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19590*        ENDFILE   (6690-END-OF-FILE)
 19591*    END-EXEC.
 19592*    MOVE '"$IcJ''                ! ( #00019431' TO DFHEIV0
 19593     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19595     MOVE X'2820233030303139343331' TO DFHEIV0(25:11)
 19596     CALL 'kxdfhei1' USING DFHEIV0
 19597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19598
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 357
* EL050.cbl
 19599
 19600
 19601* EXEC CICS READNEXT
 19602*        DATASET (FILE-ID-ERRESC)
 19603*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19604*        RIDFLD  (ERRESC-RECORD-KEY)
 19605*    END-EXEC.
 19606     MOVE LENGTH OF
 19607      ACCOUNT-RESIDENT-ST-COMMISSION
 19608       TO DFHEIV12
 19609     MOVE 0
 19610       TO DFHEIV11
 19611*    MOVE '&.IL                  )   #00019438' TO DFHEIV0
 19612     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19613     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19614     MOVE X'2020233030303139343338' TO DFHEIV0(25:11)
 19615     CALL 'kxdfhei1' USING DFHEIV0,
 19616           FILE-ID-ERRESC,
 19617           ACCOUNT-RESIDENT-ST-COMMISSION,
 19618           DFHEIV12,
 19619           ERRESC-RECORD-KEY,
 19620           DFHEIV99,
 19621           DFHEIV11,
 19622           DFHEIV99,
 19623           DFHEIV99
 19624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19625
 19626
 19627     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19628        NEXT SENTENCE
 19629     ELSE
 19630
 19631* EXEC CICS ENDBR
 19632*            DATASET (FILE-ID-ERRESC)
 19633*       END-EXEC
 19634     MOVE 0
 19635       TO DFHEIV11
 19636*    MOVE '&2                    $   #00019447' TO DFHEIV0
 19637     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19638     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19639     MOVE X'2020233030303139343437' TO DFHEIV0(25:11)
 19640     CALL 'kxdfhei1' USING DFHEIV0,
 19641           FILE-ID-ERRESC,
 19642           DFHEIV11,
 19643           DFHEIV99
 19644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19645        GO TO 6690-END-OF-FILE.
 19646
 19647     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19648
 19649* EXEC CICS ENDBR
 19650*            DATASET (FILE-ID-ERRESC)
 19651*       END-EXEC
 19652     MOVE 0
 19653       TO DFHEIV11
 19654*    MOVE '&2                    $   #00019453' TO DFHEIV0
 19655     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19656     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 358
* EL050.cbl
 19657     MOVE X'2020233030303139343533' TO DFHEIV0(25:11)
 19658     CALL 'kxdfhei1' USING DFHEIV0,
 19659           FILE-ID-ERRESC,
 19660           DFHEIV11,
 19661           DFHEIV99
 19662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19663        GO TO 6690-END-OF-FILE.
 19664
 19665     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19666        NEXT SENTENCE
 19667      ELSE
 19668        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19669
 19670* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19671*
 19672     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19673
 19674     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19675
 19676     IF WS-SUB1 > ZERO
 19677         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19678             PERFORM 6680-SET-COMMISSION
 19679         ELSE
 19680             PERFORM 6680-SET-TABLE-CODE.
 19681
 19682
 19683* EXEC CICS ENDBR
 19684*         DATASET (FILE-ID-ERRESC)
 19685*    END-EXEC.
 19686     MOVE 0
 19687       TO DFHEIV11
 19688*    MOVE '&2                    $   #00019475' TO DFHEIV0
 19689     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19690     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19691     MOVE X'2020233030303139343735' TO DFHEIV0(25:11)
 19692     CALL 'kxdfhei1' USING DFHEIV0,
 19693           FILE-ID-ERRESC,
 19694           DFHEIV11,
 19695           DFHEIV99
 19696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19697
 19698
 19699     GO TO 6700-COMM-EXIT.
 19700
 19701 6680-SET-TABLE-CODE.
 19702     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19703        MOVE ZEROS             TO WS-SUB1
 19704     ELSE
 19705* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19706* TO COMPUTE AH COMMISSION.
 19707        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19708        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19709        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19710        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19711        PERFORM 6680-READ-CTBL-TABLE
 19712        IF WS-CTBL-READ-SW NOT = 'Y'
 19713           MOVE ZEROS          TO WS-SUB1.
 19714
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 359
* EL050.cbl
 19715 6680-READ-CTBL-TABLE.
 19716*
 19717* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19718* TO COMPUTE LIFE COMMISSION
 19719
 19720     IF CTBL-SW = '0540'
 19721        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19722        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19723        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19724
 19725     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19726
 19727     IF CTBL-TABLE-FOUND
 19728        IF CTBL-SW = '0530'
 19729             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19730                                    * PB-I-AH-TERM
 19731             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19732             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19733        ELSE
 19734             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19735             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19736             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19737     ELSE
 19738        IF FIRST-TIME-THROUGH
 19739            GO TO 6680-READ-CTBL-TABLE
 19740        ELSE
 19741            MOVE ZEROS         TO WS-SUB1.
 19742
 19743 6680-SET-COMMISSION.
 19744     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19745           MOVE ZEROS          TO WS-SUB1
 19746       ELSE
 19747           MOVE RESC-COMMISSION-PER (WS-SUB)
 19748                               TO WS-COMMISSION
 19749           IF CTBL-SW = '0530'
 19750               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19751           ELSE
 19752               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19753
 19754 6680-SEARCH-CATEGORY.
 19755     ADD +1                   TO WS-SUB.
 19756     IF WS-SUB > +12
 19757         GO TO 6680-EXIT.
 19758
 19759     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19760          MOVE WS-SUB         TO WS-SUB1
 19761          GO TO 6680-EXIT.
 19762
 19763     GO TO 6680-SEARCH-CATEGORY.
 19764
 19765 6680-EXIT.
 19766     EXIT.
 19767
 19768 6690-END-OF-FILE.
 19769     GO TO 6700-COMM-EXIT.
 19770
 19771 6690-ERRESC-PROBLEM.
 19772      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 360
* EL050.cbl
 19773      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19774
 19775      GO TO 6700-COMM-EXIT.
 19776
 19777 6700-COMM-EXIT.
 19778     EXIT.
 19779
 19780 7000-GET-RATE.
 19781
 19782* EXEC CICS LINK
 19783*        PROGRAM    ('ELRATE')
 19784*        COMMAREA   (CALCULATION-PASS-AREA)
 19785*        LENGTH     (CP-COMM-LENGTH)
 19786*    END-EXEC.
 19787     MOVE 'ELRATE' TO DFHEIV1
 19788*    MOVE '."C                   (   #00019561' TO DFHEIV0
 19789     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19791     MOVE X'2020233030303139353631' TO DFHEIV0(25:11)
 19792     CALL 'kxdfhei1' USING DFHEIV0,
 19793           DFHEIV1,
 19794           CALCULATION-PASS-AREA,
 19795           CP-COMM-LENGTH,
 19796           DFHEIV99,
 19797           DFHEIV99,
 19798           DFHEIV99,
 19799           DFHEIV99
 19800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19801
 19802
 19803 7000-EXIT.
 19804     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 361
* EL050.cbl
 19806 7100-FIND-BENEFIT-IN-STATE.
 19807     MOVE 'N'                    TO BEN-SEARCH-SW.
 19808
 19809     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19810         VARYING SUB3 FROM 1 BY 1 UNTIL
 19811            ((SUB3 GREATER 50) OR
 19812              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19813               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19814
 19815     IF SUB3 NOT = 51
 19816         MOVE 'Y'                TO BEN-SEARCH-SW.
 19817
 19818     GO TO 7199-EXIT.
 19819
 19820 7100-BENEFIT-DUMMY.
 19821
 19822 7100-DUMMY-EXIT.
 19823     EXIT.
 19824
 19825 7199-EXIT.
 19826     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 362
* EL050.cbl
 19828 7200-FIND-BENEFIT.
 19829     MOVE 'N'                    TO BEN-SEARCH-SW.
 19830
 19831     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19832         VARYING SUB3 FROM 1 BY 1 UNTIL
 19833            ((SUB3 GREATER 8) OR
 19834            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19835
 19836     IF SUB3 NOT = 9
 19837         MOVE 'Y'                TO BEN-SEARCH-SW.
 19838
 19839     GO TO 7200-EXIT.
 19840
 19841 7200-BENEFIT-DUMMY.
 19842
 19843 7200-DUMMY-EXIT.
 19844     EXIT.
 19845
 19846 7200-EXIT.
 19847     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 363
* EL050.cbl
 19849 7250-LOOK-FOR-RESCINDED-CLAIM.
 19850     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19851                                    W-CL-COMP-CD.
 19852     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19853                                    W-CL-CERT-NO.
 19854
 19855
 19856* EXEC CICS HANDLE CONDITION
 19857*        NOTFND  (7250-CONTINUE)
 19858*        ENDFILE (7250-CONTINUE)
 19859*    END-EXEC.
 19860*    MOVE '"$I''                  ! ) #00019619' TO DFHEIV0
 19861     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19862     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19863     MOVE X'2920233030303139363139' TO DFHEIV0(25:11)
 19864     CALL 'kxdfhei1' USING DFHEIV0
 19865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19866
 19867
 19868
 19869* EXEC CICS IGNORE CONDITION
 19870*        DUPKEY
 19871*    END-EXEC.
 19872*    MOVE '"*$                   !   #00019624' TO DFHEIV0
 19873     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19875     MOVE X'2020233030303139363234' TO DFHEIV0(25:11)
 19876     CALL 'kxdfhei1' USING DFHEIV0
 19877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19878
 19879
 19880
 19881* EXEC CICS STARTBR
 19882*        DATASET   (CLMS-ID)
 19883*        RIDFLD    (ELMSTR-KEY)
 19884*        GENERIC   EQUAL
 19885*        KEYLENGTH (ELMSTR-LENGTH)
 19886*    END-EXEC.
 19887     MOVE 0
 19888       TO DFHEIV11
 19889*    MOVE '&,   KG    E          &   #00019628' TO DFHEIV0
 19890     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19891     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19892     MOVE X'2020233030303139363238' TO DFHEIV0(25:11)
 19893     CALL 'kxdfhei1' USING DFHEIV0,
 19894           CLMS-ID,
 19895           ELMSTR-KEY,
 19896           ELMSTR-LENGTH,
 19897           DFHEIV11,
 19898           DFHEIV99
 19899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19900
 19901
 19902     MOVE 'Y'                    TO W-BROWSE-SW.
 19903
 19904 7250-NEXT-CLAIM.
 19905
 19906
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 364
* EL050.cbl
 19907* EXEC CICS READNEXT
 19908*        DATASET   (CLMS-ID)
 19909*        RIDFLD    (ELMSTR-KEY)
 19910*        SET       (ADDRESS OF CLAIM-MASTER)
 19911*    END-EXEC.
 19912     MOVE 0
 19913       TO DFHEIV11
 19914*    MOVE '&.S                   )   #00019639' TO DFHEIV0
 19915     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19916     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19917     MOVE X'2020233030303139363339' TO DFHEIV0(25:11)
 19918     CALL 'kxdfhei1' USING DFHEIV0,
 19919           CLMS-ID,
 19920           DFHEIV20,
 19921           DFHEIV99,
 19922           ELMSTR-KEY,
 19923           DFHEIV99,
 19924           DFHEIV11,
 19925           DFHEIV99,
 19926           DFHEIV99
 19927     SET ADDRESS OF CLAIM-MASTER TO
 19928         DFHEIV20
 19929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19930
 19931
 19932     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19933        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19934         GO TO 7250-CONTINUE
 19935     END-IF.
 19936
 19937     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19938        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19939        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19940        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19941        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19942         GO TO 7250-NEXT-CLAIM
 19943     END-IF.
 19944
 19945     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19946        OR (CL-CLAIM-TYPE = 'I')
 19947        OR (CL-CLAIM-TYPE = 'G')
 19948        OR (CL-CLAIM-TYPE = 'F')
 19949          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19950              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19951              GO TO 7250-CONTINUE
 19952          END-IF
 19953     END-IF.
 19954
 19955     GO TO 7250-NEXT-CLAIM.
 19956
 19957 7250-CONTINUE.
 19958
 19959     IF W-BROWSE-SW = 'Y'
 19960
 19961* EXEC CICS ENDBR
 19962*            DATASET   (CLMS-ID)
 19963*        END-EXEC
 19964     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 365
* EL050.cbl
 19965       TO DFHEIV11
 19966*    MOVE '&2                    $   #00019673' TO DFHEIV0
 19967     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19968     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19969     MOVE X'2020233030303139363733' TO DFHEIV0(25:11)
 19970     CALL 'kxdfhei1' USING DFHEIV0,
 19971           CLMS-ID,
 19972           DFHEIV11,
 19973           DFHEIV99
 19974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19975         MOVE 'N' TO W-BROWSE-SW
 19976     END-IF.
 19977
 19978 7250-EXIT.
 19979     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 366
* EL050.cbl
 19981 7300-CHECK-FOR-OPEN-CLMS.
 19982
 19983*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19984*    MOVE SPACES                 TO CNTL-ACCESS.
 19985*    MOVE '1'                    TO CNTL-REC-TYPE.
 19986*    MOVE +0                     TO CNTL-SEQ-NO.
 19987
 19988*    MOVE '3'                    TO RC-SW-1.
 19989*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19990
 19991*    IF NOT CF-COMPANY-MASTER
 19992*         PERFORM 0099-COMPANY-NOT-FOUND
 19993*         GO TO 7300-EXIT.
 19994
 19995     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19996                                    W-CL-COMP-CD.
 19997     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19998                                    W-CL-CERT-NO.
 19999
 20000
 20001* EXEC CICS HANDLE CONDITION
 20002*        NOTFND  (7300-CONTINUE)
 20003*        ENDFILE (7300-CONTINUE)
 20004*    END-EXEC.
 20005*    MOVE '"$I''                  ! * #00019701' TO DFHEIV0
 20006     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20008     MOVE X'2A20233030303139373031' TO DFHEIV0(25:11)
 20009     CALL 'kxdfhei1' USING DFHEIV0
 20010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20011
 20012
 20013
 20014* EXEC CICS IGNORE CONDITION
 20015*        DUPKEY
 20016*    END-EXEC.
 20017*    MOVE '"*$                   !   #00019706' TO DFHEIV0
 20018     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20019     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20020     MOVE X'2020233030303139373036' TO DFHEIV0(25:11)
 20021     CALL 'kxdfhei1' USING DFHEIV0
 20022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20023
 20024
 20025
 20026* EXEC CICS STARTBR
 20027*        DATASET   (CLMS-ID)
 20028*        RIDFLD    (ELMSTR-KEY)
 20029*        GENERIC   EQUAL
 20030*        KEYLENGTH (ELMSTR-LENGTH)
 20031*    END-EXEC.
 20032     MOVE 0
 20033       TO DFHEIV11
 20034*    MOVE '&,   KG    E          &   #00019710' TO DFHEIV0
 20035     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20036     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20037     MOVE X'2020233030303139373130' TO DFHEIV0(25:11)
 20038     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 367
* EL050.cbl
 20039           CLMS-ID,
 20040           ELMSTR-KEY,
 20041           ELMSTR-LENGTH,
 20042           DFHEIV11,
 20043           DFHEIV99
 20044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20045
 20046
 20047     MOVE 'Y'                    TO W-BROWSE-SW.
 20048
 20049 7300-NEXT-CLAIM.
 20050
 20051
 20052* EXEC CICS READNEXT
 20053*        DATASET   (CLMS-ID)
 20054*        RIDFLD    (ELMSTR-KEY)
 20055*        SET       (ADDRESS OF CLAIM-MASTER)
 20056*    END-EXEC.
 20057     MOVE 0
 20058       TO DFHEIV11
 20059*    MOVE '&.S                   )   #00019721' TO DFHEIV0
 20060     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20061     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20062     MOVE X'2020233030303139373231' TO DFHEIV0(25:11)
 20063     CALL 'kxdfhei1' USING DFHEIV0,
 20064           CLMS-ID,
 20065           DFHEIV20,
 20066           DFHEIV99,
 20067           ELMSTR-KEY,
 20068           DFHEIV99,
 20069           DFHEIV11,
 20070           DFHEIV99,
 20071           DFHEIV99
 20072     SET ADDRESS OF CLAIM-MASTER TO
 20073         DFHEIV20
 20074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20075
 20076
 20077     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20078        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20079         GO TO 7300-CONTINUE.
 20080
 20081     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20082        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20083        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20084        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20085        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20086         GO TO 7300-NEXT-CLAIM.
 20087
 20088*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 20089     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20090        OR (CL-CLAIM-TYPE = 'I')
 20091        OR (CL-CLAIM-TYPE = 'G')
 20092        OR (CL-CLAIM-TYPE = 'F')
 20093        IF CLAIM-IS-OPEN
 20094           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20095             AND PB-C-AH-CANCEL-DT > SPACES
 20096              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 368
* EL050.cbl
 20097              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20098           END-IF
 20099           EVALUATE TRUE
 20100             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20101                 MOVE ER-2884      TO WS-ERROR
 20102             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20103                 MOVE ER-2887      TO WS-ERROR
 20104             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20105                 MOVE ER-2886      TO WS-ERROR
 20106             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20107                 MOVE ER-2888      TO WS-ERROR
 20108             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20109                 MOVE ER-2885      TO WS-ERROR
 20110             WHEN OTHER
 20111                 MOVE ER-2768      TO WS-ERROR
 20112           END-EVALUATE
 20113           IF PB-C-AH-CANCEL-VOIDED OR
 20114              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20115                NOT AH-COVERAGE-CANCELLED)
 20116               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20117               MOVE ER-2768      TO WS-ERROR
 20118           END-IF
 20119           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20120           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20121              PB-FORCE-CODE NOT EQUAL '8'
 20122               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20123           END-IF
 20124           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20125           GO TO 7300-NEXT-CLAIM
 20126        ELSE
 20127           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20128*****THIS IS A RESCISSION OR REFORMATION
 20129              IF AH-COVERAGE-CANCELLED
 20130                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20131                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20132                    MOVE 1                   TO DC-ELAPSED-DAYS
 20133                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20134                    SET BIN-PLUS-ELAPSED     TO TRUE
 20135                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20136                    IF NO-CONVERSION-ERROR
 20137                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20138                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20139                          MOVE ER-2897 TO WS-ERROR
 20140                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20141                          GO TO 7300-NEXT-CLAIM
 20142                       END-IF
 20143                    END-IF
 20144                 ELSE
 20145                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20146                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20147                         MOVE ER-2890 TO WS-ERROR
 20148                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20149                         GO TO 7300-NEXT-CLAIM
 20150                      ELSE
 20151                         MOVE ER-2898 TO WS-ERROR
 20152                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20153                         GO TO 7300-NEXT-CLAIM
 20154                      END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 369
* EL050.cbl
 20155                   END-IF
 20156                 END-IF
 20157              END-IF
 20158           ELSE
 20159              IF CL-DENIAL-TYPE = '1'  AND
 20160                 CL-TOTAL-PAID-AMT = 0
 20161                    GO TO 7300-NEXT-CLAIM
 20162              END-IF
 20163              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20164               AND PB-C-AH-CANCEL-DT > SPACES
 20165                 MOVE ER-2756        TO WS-ERROR
 20166                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20167                 GO TO 7300-NEXT-CLAIM
 20168              END-IF
 20169           END-IF
 20170        END-IF
 20171     ELSE
 20172*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20173        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20174          OR (CL-CLAIM-TYPE = 'O')
 20175           IF (CLAIM-IS-OPEN)
 20176              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20177                 <> zeros
 20178              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20179                 <> zeros)
 20180              MOVE ER-2889      TO WS-ERROR
 20181              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20182              GO TO 7300-NEXT-CLAIM
 20183           ELSE
 20184              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20185*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20186                 IF (LF-COVERAGE-CANCELLED AND
 20187                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20188                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20189                         MOVE ER-2890 TO WS-ERROR
 20190                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20191                         GO TO 7300-NEXT-CLAIM
 20192                      ELSE
 20193                         MOVE ER-2898 TO WS-ERROR
 20194                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20195                         GO TO 7300-NEXT-CLAIM
 20196                      END-IF
 20197                 END-IF
 20198              ELSE
 20199                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20200                    and (CL-TOTAL-PAID-AMT = 0)
 20201                    GO TO 7300-NEXT-CLAIM
 20202                 END-IF
 20203                 IF (
 20204                      (AH-COVERAGE-CANCELLED)
 20205                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20206                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20207                      and (pb-ci-ah-cancel-amt +
 20208                         pb-c-ah-cancel-amt) <> zeros
 20209                    )
 20210                               OR
 20211                    (
 20212                      (LF-COVERAGE-CANCELLED)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 370
* EL050.cbl
 20213                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
 20214                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20215                      and (pb-ci-lf-cancel-amt +
 20216                         pb-c-lf-cancel-amt) <> zeros
 20217                    )
 20218                       IF CL-CLAIM-TYPE = 'O'
 20219                          MOVE ER-2998 TO WS-ERROR
 20220                       ELSE
 20221                          MOVE ER-2965 TO WS-ERROR
 20222                       END-IF
 20223                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20224                       GO TO 7300-NEXT-CLAIM
 20225                 END-IF
 20226                 IF LF-COVERAGE-CANCELLED
 20227                  IF CL-TOTAL-PAID-AMT > 0
 20228                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20229                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20230                        MOVE ER-2891 TO WS-ERROR
 20231                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20232                        GO TO 7300-NEXT-CLAIM
 20233                      END-IF
 20234                    ELSE
 20235****only show this error if cert num matches exactly
 20236                      IF PB-CERT-NO = CL-CERT-NO
 20237                         IF CL-CLAIM-TYPE = 'O'
 20238                            MOVE ER-2895 TO WS-ERROR
 20239                         ELSE
 20240                            MOVE ER-2892 TO WS-ERROR
 20241                         END-IF
 20242                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20243                         GO TO 7300-NEXT-CLAIM
 20244                      END-IF
 20245                    END-IF
 20246                  END-IF
 20247                 END-IF
 20248              END-IF
 20249           END-IF
 20250        END-IF
 20251     END-IF
 20252
 20253     GO TO 7300-NEXT-CLAIM.
 20254
 20255 7300-CONTINUE.
 20256
 20257     IF W-BROWSE-SW = 'Y'
 20258
 20259* EXEC CICS ENDBR
 20260*            DATASET   (CLMS-ID)
 20261*        END-EXEC.
 20262     MOVE 0
 20263       TO DFHEIV11
 20264*    MOVE '&2                    $   #00019908' TO DFHEIV0
 20265     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20266     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20267     MOVE X'2020233030303139393038' TO DFHEIV0(25:11)
 20268     CALL 'kxdfhei1' USING DFHEIV0,
 20269           CLMS-ID,
 20270           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 371
* EL050.cbl
 20271           DFHEIV99
 20272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20273
 20274
 20275 7300-EXIT.
 20276     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 372
* EL050.cbl
 20278 7320-CHECK-FOR-OPEN-CLMS-issue.
 20279
 20280     move ' '                    to w-browse-sw
 20281     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20282                                    W-CL-COMP-CD
 20283     MOVE PB-CERT-NO(1:10)       TO MSTR-CERT-NO
 20284                                    W-CL-CERT-NO
 20285
 20286
 20287* EXEC CICS HANDLE CONDITION
 20288*        NOTFND  (7320-CONTINUE)
 20289*        ENDFILE (7320-CONTINUE)
 20290*    END-EXEC.
 20291*    MOVE '"$I''                  ! + #00019923' TO DFHEIV0
 20292     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20294     MOVE X'2B20233030303139393233' TO DFHEIV0(25:11)
 20295     CALL 'kxdfhei1' USING DFHEIV0
 20296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20297
 20298
 20299
 20300* EXEC CICS IGNORE CONDITION
 20301*        DUPKEY
 20302*    END-EXEC.
 20303*    MOVE '"*$                   !   #00019928' TO DFHEIV0
 20304     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20306     MOVE X'2020233030303139393238' TO DFHEIV0(25:11)
 20307     CALL 'kxdfhei1' USING DFHEIV0
 20308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20309
 20310
 20311
 20312* EXEC CICS STARTBR
 20313*        DATASET   (CLMS-ID)
 20314*        RIDFLD    (ELMSTR-KEY)
 20315*        GENERIC   EQUAL
 20316*        KEYLENGTH (ELMSTR-LENGTH)
 20317*    END-EXEC.
 20318     MOVE 0
 20319       TO DFHEIV11
 20320*    MOVE '&,   KG    E          &   #00019932' TO DFHEIV0
 20321     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20322     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20323     MOVE X'2020233030303139393332' TO DFHEIV0(25:11)
 20324     CALL 'kxdfhei1' USING DFHEIV0,
 20325           CLMS-ID,
 20326           ELMSTR-KEY,
 20327           ELMSTR-LENGTH,
 20328           DFHEIV11,
 20329           DFHEIV99
 20330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20331
 20332
 20333     MOVE 'Y'                    TO W-BROWSE-SW.
 20334
 20335 7320-NEXT-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 373
* EL050.cbl
 20336
 20337
 20338* EXEC CICS READNEXT
 20339*        DATASET   (CLMS-ID)
 20340*        RIDFLD    (ELMSTR-KEY)
 20341*        SET       (ADDRESS OF CLAIM-MASTER)
 20342*    END-EXEC.
 20343     MOVE 0
 20344       TO DFHEIV11
 20345*    MOVE '&.S                   )   #00019943' TO DFHEIV0
 20346     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20347     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20348     MOVE X'2020233030303139393433' TO DFHEIV0(25:11)
 20349     CALL 'kxdfhei1' USING DFHEIV0,
 20350           CLMS-ID,
 20351           DFHEIV20,
 20352           DFHEIV99,
 20353           ELMSTR-KEY,
 20354           DFHEIV99,
 20355           DFHEIV11,
 20356           DFHEIV99,
 20357           DFHEIV99
 20358     SET ADDRESS OF CLAIM-MASTER TO
 20359         DFHEIV20
 20360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20361
 20362
 20363     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20364        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20365         GO TO 7320-CONTINUE.
 20366
 20367     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20368        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20369        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20370        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20371        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20372         GO TO 7320-NEXT-CLAIM.
 20373
 20374     IF CLAIM-IS-OPEN
 20375        MOVE ER-3273             TO WS-ERROR
 20376        PERFORM 9900-ERROR-FORMAT
 20377                                 THRU 9900-EXIT
 20378     END-IF
 20379     if pb-i-entry-status = 'V'
 20380        IF CLAIM-IS-OPEN
 20381             OR
 20382           CL-LAST-PMT-DT NOT = LOW-VALUES
 20383             OR
 20384           CL-LAST-PMT-AMT > 0
 20385           MOVE ER-3281          TO WS-ERROR
 20386           PERFORM 9900-ERROR-FORMAT
 20387                                 THRU 9900-EXIT
 20388        END-IF
 20389     END-IF
 20390
 20391     GO TO 7320-NEXT-CLAIM.
 20392
 20393 7320-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 374
* EL050.cbl
 20394
 20395     IF W-BROWSE-SW = 'Y'
 20396
 20397* EXEC CICS ENDBR
 20398*            DATASET   (CLMS-ID)
 20399*        END-EXEC.
 20400     MOVE 0
 20401       TO DFHEIV11
 20402*    MOVE '&2                    $   #00019982' TO DFHEIV0
 20403     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20404     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20405     MOVE X'2020233030303139393832' TO DFHEIV0(25:11)
 20406     CALL 'kxdfhei1' USING DFHEIV0,
 20407           CLMS-ID,
 20408           DFHEIV11,
 20409           DFHEIV99
 20410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20411
 20412
 20413 7320-EXIT.
 20414     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 375
* EL050.cbl
 20416 7400-GET-REMAIN-TERM.
 20417
 20418* EXEC CICS LINK
 20419*        PROGRAM    ('ELRTRM')
 20420*        COMMAREA   (CALCULATION-PASS-AREA)
 20421*        LENGTH     (CP-COMM-LENGTH)
 20422*    END-EXEC.
 20423     MOVE 'ELRTRM' TO DFHEIV1
 20424*    MOVE '."C                   (   #00019990' TO DFHEIV0
 20425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20427     MOVE X'2020233030303139393930' TO DFHEIV0(25:11)
 20428     CALL 'kxdfhei1' USING DFHEIV0,
 20429           DFHEIV1,
 20430           CALCULATION-PASS-AREA,
 20431           CP-COMM-LENGTH,
 20432           DFHEIV99,
 20433           DFHEIV99,
 20434           DFHEIV99,
 20435           DFHEIV99
 20436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20437
 20438
 20439 7400-EXIT.
 20440     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 376
* EL050.cbl
 20442
 20443 7500-GET-REMAIN-AMOUNT.
 20444
 20445* EXEC CICS LINK
 20446*        PROGRAM    ('ELRAMT')
 20447*        COMMAREA   (CALCULATION-PASS-AREA)
 20448*        LENGTH     (CP-COMM-LENGTH)
 20449*    END-EXEC.
 20450     MOVE 'ELRAMT' TO DFHEIV1
 20451*    MOVE '."C                   (   #00020001' TO DFHEIV0
 20452     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20454     MOVE X'2020233030303230303031' TO DFHEIV0(25:11)
 20455     CALL 'kxdfhei1' USING DFHEIV0,
 20456           DFHEIV1,
 20457           CALCULATION-PASS-AREA,
 20458           CP-COMM-LENGTH,
 20459           DFHEIV99,
 20460           DFHEIV99,
 20461           DFHEIV99,
 20462           DFHEIV99
 20463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20464
 20465
 20466 7500-EXIT.
 20467     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 377
* EL050.cbl
 20469
 20470 7600-GET-REFUND.
 20471
 20472* EXEC CICS LINK
 20473*        PROGRAM    ('ELRFND')
 20474*        COMMAREA   (CALCULATION-PASS-AREA)
 20475*        LENGTH     (CP-COMM-LENGTH)
 20476*    END-EXEC.
 20477     MOVE 'ELRFND' TO DFHEIV1
 20478*    MOVE '."C                   (   #00020012' TO DFHEIV0
 20479     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20481     MOVE X'2020233030303230303132' TO DFHEIV0(25:11)
 20482     CALL 'kxdfhei1' USING DFHEIV0,
 20483           DFHEIV1,
 20484           CALCULATION-PASS-AREA,
 20485           CP-COMM-LENGTH,
 20486           DFHEIV99,
 20487           DFHEIV99,
 20488           DFHEIV99,
 20489           DFHEIV99
 20490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20491
 20492
 20493 7600-EXIT.
 20494     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 378
* EL050.cbl
 20496 7700-CALL-DL1.
 20497
 20498* EXEC CICS LINK
 20499*        PROGRAM    ('DLO001')
 20500*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20501*        LENGTH     (DLO001-COMM-LENGTH)
 20502*    END-EXEC.
 20503     MOVE 'DLO001' TO DFHEIV1
 20504*    MOVE '."C                   (   #00020022' TO DFHEIV0
 20505     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20507     MOVE X'2020233030303230303232' TO DFHEIV0(25:11)
 20508     CALL 'kxdfhei1' USING DFHEIV0,
 20509           DFHEIV1,
 20510           WS-DLO-MASTER-POLICY-FORM,
 20511           DLO001-COMM-LENGTH,
 20512           DFHEIV99,
 20513           DFHEIV99,
 20514           DFHEIV99,
 20515           DFHEIV99
 20516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20517
 20518
 20519 7700-EXIT.
 20520     EXIT.
 20521
 20522 7710-CALL-DL2.
 20523
 20524* EXEC CICS LINK
 20525*        PROGRAM    ('DLO002')
 20526*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20527*        LENGTH     (DLO002-COMM-LENGTH)
 20528*    END-EXEC.
 20529     MOVE 'DLO002' TO DFHEIV1
 20530*    MOVE '."C                   (   #00020032' TO DFHEIV0
 20531     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20532     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20533     MOVE X'2020233030303230303332' TO DFHEIV0(25:11)
 20534     CALL 'kxdfhei1' USING DFHEIV0,
 20535           DFHEIV1,
 20536           WS-DLO-INTERNAL-POLICY-FORM,
 20537           DLO002-COMM-LENGTH,
 20538           DFHEIV99,
 20539           DFHEIV99,
 20540           DFHEIV99,
 20541           DFHEIV99
 20542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20543
 20544
 20545 7710-EXIT.
 20546     EXIT.
 20547
 20548 7720-CALL-DL3.
 20549
 20550* EXEC CICS LINK
 20551*        PROGRAM    ('DLO003')
 20552*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20553*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 379
* EL050.cbl
 20554*    END-EXEC.
 20555     MOVE 'DLO003' TO DFHEIV1
 20556*    MOVE '."C                   (   #00020042' TO DFHEIV0
 20557     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20559     MOVE X'2020233030303230303432' TO DFHEIV0(25:11)
 20560     CALL 'kxdfhei1' USING DFHEIV0,
 20561           DFHEIV1,
 20562           WS-DLO-VALID-BANK-ID,
 20563           DLO003-COMM-LENGTH,
 20564           DFHEIV99,
 20565           DFHEIV99,
 20566           DFHEIV99,
 20567           DFHEIV99
 20568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20569
 20570
 20571 7720-EXIT.
 20572     EXIT.
 20573
 20574 7730-CALL-DL7.
 20575
 20576* EXEC CICS LINK
 20577*        PROGRAM    ('DLO007')
 20578*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20579*        LENGTH     (DLO007-COMM-LENGTH)
 20580*    END-EXEC.
 20581     MOVE 'DLO007' TO DFHEIV1
 20582*    MOVE '."C                   (   #00020052' TO DFHEIV0
 20583     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20584     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20585     MOVE X'2020233030303230303532' TO DFHEIV0(25:11)
 20586     CALL 'kxdfhei1' USING DFHEIV0,
 20587           DFHEIV1,
 20588           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20589           DLO007-COMM-LENGTH,
 20590           DFHEIV99,
 20591           DFHEIV99,
 20592           DFHEIV99,
 20593           DFHEIV99
 20594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20595
 20596
 20597 7730-EXIT.
 20598     EXIT.
 20599
 20600 7740-CALL-DL11.
 20601
 20602* EXEC CICS LINK
 20603*        PROGRAM    ('DLO011')
 20604*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20605*        LENGTH     (DLO011-COMM-LENGTH)
 20606*    END-EXEC.
 20607     MOVE 'DLO011' TO DFHEIV1
 20608*    MOVE '."C                   (   #00020062' TO DFHEIV0
 20609     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20611     MOVE X'2020233030303230303632' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 380
* EL050.cbl
 20612     CALL 'kxdfhei1' USING DFHEIV0,
 20613           DFHEIV1,
 20614           WS-DLO-PREM-RATES-BEN-TYPE,
 20615           DLO011-COMM-LENGTH,
 20616           DFHEIV99,
 20617           DFHEIV99,
 20618           DFHEIV99,
 20619           DFHEIV99
 20620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20621
 20622
 20623 7740-EXIT.
 20624     EXIT.
 20625
 20626 7750-CALL-DL17.
 20627
 20628* EXEC CICS LINK
 20629*        PROGRAM    ('DLO017')
 20630*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20631*        LENGTH     (DLO017-COMM-LENGTH)
 20632*    END-EXEC.
 20633     MOVE 'DLO017' TO DFHEIV1
 20634*    MOVE '."C                   (   #00020072' TO DFHEIV0
 20635     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20636     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20637     MOVE X'2020233030303230303732' TO DFHEIV0(25:11)
 20638     CALL 'kxdfhei1' USING DFHEIV0,
 20639           DFHEIV1,
 20640           WS-DLO-VALID-RATE-CODE,
 20641           DLO017-COMM-LENGTH,
 20642           DFHEIV99,
 20643           DFHEIV99,
 20644           DFHEIV99,
 20645           DFHEIV99
 20646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20647
 20648
 20649 7750-EXIT.
 20650     EXIT.
 20651
 20652 7755-CALL-DL19.
 20653
 20654* EXEC CICS LINK
 20655*        PROGRAM    ('DLO019')
 20656*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20657*        LENGTH     (DLO019-COMM-LENGTH)
 20658*    END-EXEC.
 20659     MOVE 'DLO019' TO DFHEIV1
 20660*    MOVE '."C                   (   #00020082' TO DFHEIV0
 20661     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20663     MOVE X'2020233030303230303832' TO DFHEIV0(25:11)
 20664     CALL 'kxdfhei1' USING DFHEIV0,
 20665           DFHEIV1,
 20666           WS-DLO-ORIG-COV-CAT,
 20667           DLO019-COMM-LENGTH,
 20668           DFHEIV99,
 20669           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 381
* EL050.cbl
 20670           DFHEIV99,
 20671           DFHEIV99
 20672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20673
 20674
 20675 7755-EXIT.
 20676     EXIT.
 20677
 20678 7760-CALL-DL21.
 20679
 20680* EXEC CICS LINK
 20681*        PROGRAM    ('DLO021')
 20682*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20683*        LENGTH     (DLO021-COMM-LENGTH)
 20684*    END-EXEC.
 20685     MOVE 'DLO021' TO DFHEIV1
 20686*    MOVE '."C                   (   #00020092' TO DFHEIV0
 20687     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20689     MOVE X'2020233030303230303932' TO DFHEIV0(25:11)
 20690     CALL 'kxdfhei1' USING DFHEIV0,
 20691           DFHEIV1,
 20692           WS-DLO-VALID-LOAN-OFFICER,
 20693           DLO021-COMM-LENGTH,
 20694           DFHEIV99,
 20695           DFHEIV99,
 20696           DFHEIV99,
 20697           DFHEIV99
 20698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20699
 20700
 20701 7760-EXIT.
 20702     EXIT.
 20703
 20704 7770-CALL-DL22.
 20705
 20706* EXEC CICS LINK
 20707*        PROGRAM    ('DLO022')
 20708*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20709*        LENGTH     (DLO022-COMM-LENGTH)
 20710*    END-EXEC.
 20711     MOVE 'DLO022' TO DFHEIV1
 20712*    MOVE '."C                   (   #00020102' TO DFHEIV0
 20713     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20715     MOVE X'2020233030303230313032' TO DFHEIV0(25:11)
 20716     CALL 'kxdfhei1' USING DFHEIV0,
 20717           DFHEIV1,
 20718           WS-DLO-VALID-STATE-CODE,
 20719           DLO022-COMM-LENGTH,
 20720           DFHEIV99,
 20721           DFHEIV99,
 20722           DFHEIV99,
 20723           DFHEIV99
 20724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20725
 20726
 20727 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 382
* EL050.cbl
 20728     EXIT.
 20729
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 383
* EL050.cbl
 20731
 20732 7780-CALL-AGG.
 20733
 20734* EXEC CICS LINK
 20735*        PROGRAM    ('ELAGGO')
 20736*        COMMAREA   (WS-PASS-to-pemaggo)
 20737*        LENGTH     (ws-passed-key-LENGTH)
 20738*    END-EXEC.
 20739     MOVE 'ELAGGO' TO DFHEIV1
 20740*    MOVE '."C                   (   #00020114' TO DFHEIV0
 20741     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20743     MOVE X'2020233030303230313134' TO DFHEIV0(25:11)
 20744     CALL 'kxdfhei1' USING DFHEIV0,
 20745           DFHEIV1,
 20746           WS-PASS-to-pemaggo,
 20747           ws-passed-key-LENGTH,
 20748           DFHEIV99,
 20749           DFHEIV99,
 20750           DFHEIV99,
 20751           DFHEIV99
 20752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20753
 20754 7780-EXIT.
 20755     EXIT.
 20756 7785-CALL-HLDI.
 20757
 20758* EXEC CICS LINK
 20759*        PROGRAM    ('ELHLDI')
 20760*        COMMAREA   (HLDI-PASS-AREA)
 20761*        LENGTH     (HLDI-PASS-AREA-LEN)
 20762*    END-EXEC.
 20763     MOVE 'ELHLDI' TO DFHEIV1
 20764*    MOVE '."C                   (   #00020122' TO DFHEIV0
 20765     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20766     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20767     MOVE X'2020233030303230313232' TO DFHEIV0(25:11)
 20768     CALL 'kxdfhei1' USING DFHEIV0,
 20769           DFHEIV1,
 20770           HLDI-PASS-AREA,
 20771           HLDI-PASS-AREA-LEN,
 20772           DFHEIV99,
 20773           DFHEIV99,
 20774           DFHEIV99,
 20775           DFHEIV99
 20776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20777
 20778 7785-EXIT.
 20779     EXIT.
 20780 7786-CALL-HLDIM.
 20781
 20782* EXEC CICS LINK
 20783*        PROGRAM    ('ELHLDIM')
 20784*        COMMAREA   (HLDI-PASS-AREA)
 20785*        LENGTH     (HLDI-PASS-AREA-LEN)
 20786*    END-EXEC.
 20787     MOVE 'ELHLDIM' TO DFHEIV1
 20788*    MOVE '."C                   (   #00020130' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 384
* EL050.cbl
 20789     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20791     MOVE X'2020233030303230313330' TO DFHEIV0(25:11)
 20792     CALL 'kxdfhei1' USING DFHEIV0,
 20793           DFHEIV1,
 20794           HLDI-PASS-AREA,
 20795           HLDI-PASS-AREA-LEN,
 20796           DFHEIV99,
 20797           DFHEIV99,
 20798           DFHEIV99,
 20799           DFHEIV99
 20800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20801
 20802 7786-EXIT.
 20803     EXIT.
 20804 7790-CALL-ZIP-VERIFY.
 20805
 20806
 20807* EXEC CICS LINK
 20808*        PROGRAM    ('WSZIPCD')
 20809*        COMMAREA   (ZIPCD-PASS-AREA)
 20810*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20811*    END-EXEC.
 20812     MOVE 'WSZIPCD' TO DFHEIV1
 20813*    MOVE '."C                   (   #00020139' TO DFHEIV0
 20814     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20816     MOVE X'2020233030303230313339' TO DFHEIV0(25:11)
 20817     CALL 'kxdfhei1' USING DFHEIV0,
 20818           DFHEIV1,
 20819           ZIPCD-PASS-AREA,
 20820           ZIPCD-PASS-AREA-LEN,
 20821           DFHEIV99,
 20822           DFHEIV99,
 20823           DFHEIV99,
 20824           DFHEIV99
 20825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20826
 20827
 20828 7790-EXIT.
 20829     EXIT.
 20830 7795-call-sqlclmhs.
 20831
 20832
 20833* EXEC CICS LINK
 20834*        PROGRAM    ('SQLCLMHS')
 20835*        COMMAREA   (clmhs-PASS-AREA)
 20836*        LENGTH     (clmhs-PASS-AREA-LEN)
 20837*    END-EXEC.
 20838     MOVE 'SQLCLMHS' TO DFHEIV1
 20839*    MOVE '."C                   (   #00020149' TO DFHEIV0
 20840     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20841     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20842     MOVE X'2020233030303230313439' TO DFHEIV0(25:11)
 20843     CALL 'kxdfhei1' USING DFHEIV0,
 20844           DFHEIV1,
 20845           clmhs-PASS-AREA,
 20846           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 385
* EL050.cbl
 20847           DFHEIV99,
 20848           DFHEIV99,
 20849           DFHEIV99,
 20850           DFHEIV99
 20851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20852
 20853
 20854 7795-EXIT.
 20855     EXIT.
 20856 7800-REWRITE-CERT.
 20857******************************************************************
 20858*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20859*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20860******************************************************************
 20861
 20862     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20863        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20864        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20865        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20866
 20867* EXEC CICS REWRITE
 20868*                  DATASET (CERT-ID)
 20869*                  FROM    (CERTIFICATE-MASTER)
 20870*              END-EXEC
 20871     MOVE LENGTH OF
 20872      CERTIFICATE-MASTER
 20873       TO DFHEIV11
 20874*    MOVE '&& L                  %   #00020167' TO DFHEIV0
 20875     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20876     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20877     MOVE X'2020233030303230313637' TO DFHEIV0(25:11)
 20878     CALL 'kxdfhei1' USING DFHEIV0,
 20879           CERT-ID,
 20880           CERTIFICATE-MASTER,
 20881           DFHEIV11,
 20882           DFHEIV99
 20883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20884        GO TO 7800-EXIT.
 20885
 20886       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20887       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20888
 20889 7800-EXIT.
 20890      EXIT.
 20891
 20892 7900-DELETE-CERT.
 20893
 20894* EXEC CICS DELETE
 20895*        DATASET (CERT-ID)
 20896*    END-EXEC.
 20897*    MOVE '&(                    &   #00020180' TO DFHEIV0
 20898     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20899     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20900     MOVE X'2020233030303230313830' TO DFHEIV0(25:11)
 20901     CALL 'kxdfhei1' USING DFHEIV0,
 20902           CERT-ID,
 20903           DFHEIV99,
 20904           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 386
* EL050.cbl
 20905           DFHEIV99,
 20906           DFHEIV99
 20907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20908
 20909
 20910 7900-EXIT.
 20911     EXIT.
 20912
 20913 8000-WRITE-CERT.
 20914
 20915* EXEC CICS HANDLE CONDITION
 20916*        DUPKEY    (8000-FREE-MAIN)
 20917*    END-EXEC.
 20918*    MOVE '"$$                   ! , #00020188' TO DFHEIV0
 20919     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20921     MOVE X'2C20233030303230313838' TO DFHEIV0(25:11)
 20922     CALL 'kxdfhei1' USING DFHEIV0
 20923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20924
 20925
 20926
 20927* EXEC CICS WRITE
 20928*        DATASET     (CERT-ID)
 20929*        FROM        (CERTIFICATE-MASTER)
 20930*        RIDFLD      (ELCERT-KEY)
 20931*    END-EXEC.
 20932     MOVE LENGTH OF
 20933      CERTIFICATE-MASTER
 20934       TO DFHEIV11
 20935*    MOVE '&$ L                  ''   #00020192' TO DFHEIV0
 20936     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20937     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20938     MOVE X'2020233030303230313932' TO DFHEIV0(25:11)
 20939     CALL 'kxdfhei1' USING DFHEIV0,
 20940           CERT-ID,
 20941           CERTIFICATE-MASTER,
 20942           DFHEIV11,
 20943           ELCERT-KEY,
 20944           DFHEIV99,
 20945           DFHEIV99
 20946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20947
 20948
 20949 8000-FREE-MAIN.
 20950
 20951 8000-EXIT.
 20952      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 387
* EL050.cbl
 20954
 20955 8100-READ-ERPNDM.
 20956
 20957* EXEC CICS HANDLE CONDITION
 20958*         NOTFND     (8100-NOTFND)
 20959*         ENDFILE    (8100-NOTFND)
 20960*    END-EXEC.
 20961*    MOVE '"$I''                  ! - #00020205' TO DFHEIV0
 20962     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20963     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20964     MOVE X'2D20233030303230323035' TO DFHEIV0(25:11)
 20965     CALL 'kxdfhei1' USING DFHEIV0
 20966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20967
 20968
 20969     MOVE SPACES                 TO ERPNDM-FOUND.
 20970     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20971
 20972
 20973* EXEC CICS READ UPDATE
 20974*         DATASET   (FILE-ERPNDM)
 20975*         RIDFLD    (PM-CONTROL-PRIMARY)
 20976*         INTO      (PENDING-MAILING-DATA)
 20977*    END-EXEC.
 20978     MOVE LENGTH OF
 20979      PENDING-MAILING-DATA
 20980       TO DFHEIV11
 20981*    MOVE '&"IL       EU         (   #00020213' TO DFHEIV0
 20982     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20983     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20984     MOVE X'2020233030303230323133' TO DFHEIV0(25:11)
 20985     CALL 'kxdfhei1' USING DFHEIV0,
 20986           FILE-ERPNDM,
 20987           PENDING-MAILING-DATA,
 20988           DFHEIV11,
 20989           PM-CONTROL-PRIMARY,
 20990           DFHEIV99,
 20991           DFHEIV99,
 20992           DFHEIV99
 20993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20994
 20995
 20996     GO TO 8100-EXIT.
 20997
 20998 8100-NOTFND.
 20999
 21000     MOVE 'X'                    TO ERPNDM-FOUND.
 21001     MOVE ER-2694                TO WS-ERROR.
 21002     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21003     MOVE ER-2883                TO WS-ERROR
 21004     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 21005     .
 21006 8100-EXIT.
 21007     EXIT.
 21008 8102-REWRITE-ERPNDM.
 21009
 21010
 21011* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 388
* EL050.cbl
 21012*         DATASET    (FILE-ERPNDM)
 21013*         FROM       (PENDING-MAILING-DATA)
 21014*    END-EXEC
 21015     MOVE LENGTH OF
 21016      PENDING-MAILING-DATA
 21017       TO DFHEIV11
 21018*    MOVE '&& L                  %   #00020233' TO DFHEIV0
 21019     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21020     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21021     MOVE X'2020233030303230323333' TO DFHEIV0(25:11)
 21022     CALL 'kxdfhei1' USING DFHEIV0,
 21023           FILE-ERPNDM,
 21024           PENDING-MAILING-DATA,
 21025           DFHEIV11,
 21026           DFHEIV99
 21027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21028
 21029     .
 21030 8102-EXIT.
 21031     EXIT.
 21032 8104-UNLOCK-ERPNDM.
 21033
 21034
 21035* EXEC CICS UNLOCK
 21036*         DATASET   (FILE-ERPNDM)
 21037*    END-EXEC
 21038*    MOVE '&*                    #   #00020243' TO DFHEIV0
 21039     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21040     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21041     MOVE X'2020233030303230323433' TO DFHEIV0(25:11)
 21042     CALL 'kxdfhei1' USING DFHEIV0,
 21043           FILE-ERPNDM,
 21044           DFHEIV99
 21045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21046
 21047     .
 21048 8104-EXIT.
 21049     EXIT.
 21050 8110-READ-ERMAIL.
 21051
 21052* EXEC CICS HANDLE CONDITION
 21053*         NOTFND     (8110-NOTFND)
 21054*         ENDFILE    (8110-NOTFND)
 21055*    END-EXEC.
 21056*    MOVE '"$I''                  ! . #00020251' TO DFHEIV0
 21057     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21059     MOVE X'2E20233030303230323531' TO DFHEIV0(25:11)
 21060     CALL 'kxdfhei1' USING DFHEIV0
 21061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21062
 21063
 21064     MOVE SPACES                 TO ERMAIL-FOUND.
 21065     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 21066     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 21067     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 21068     MOVE PB-SV-STATE            TO MA-STATE.
 21069
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 389
* EL050.cbl
 21070
 21071* EXEC CICS READ
 21072*         UPDATE
 21073*         DATASET   (FILE-ERMAIL)
 21074*         RIDFLD    (MA-CONTROL-PRIMARY)
 21075*         INTO      (MAILING-DATA)
 21076*    END-EXEC.
 21077     MOVE LENGTH OF
 21078      MAILING-DATA
 21079       TO DFHEIV11
 21080*    MOVE '&"IL       EU         (   #00020262' TO DFHEIV0
 21081     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21082     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21083     MOVE X'2020233030303230323632' TO DFHEIV0(25:11)
 21084     CALL 'kxdfhei1' USING DFHEIV0,
 21085           FILE-ERMAIL,
 21086           MAILING-DATA,
 21087           DFHEIV11,
 21088           MA-CONTROL-PRIMARY,
 21089           DFHEIV99,
 21090           DFHEIV99,
 21091           DFHEIV99
 21092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21093
 21094
 21095     GO TO 8110-EXIT.
 21096
 21097 8110-NOTFND.
 21098     MOVE 'X'                    TO ERMAIL-FOUND.
 21099
 21100 8110-EXIT.
 21101     EXIT.
 21102
 21103 8120-REWRITE-ERMAIL.
 21104
 21105* EXEC CICS REWRITE
 21106*         DATASET    (FILE-ERMAIL)
 21107*         FROM       (MAILING-DATA)
 21108*    END-EXEC.
 21109     MOVE LENGTH OF
 21110      MAILING-DATA
 21111       TO DFHEIV11
 21112*    MOVE '&& L                  %   #00020278' TO DFHEIV0
 21113     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21114     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21115     MOVE X'2020233030303230323738' TO DFHEIV0(25:11)
 21116     CALL 'kxdfhei1' USING DFHEIV0,
 21117           FILE-ERMAIL,
 21118           MAILING-DATA,
 21119           DFHEIV11,
 21120           DFHEIV99
 21121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21122
 21123
 21124 8120-EXIT.
 21125     EXIT.
 21126
 21127 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 390
* EL050.cbl
 21128
 21129* EXEC CICS HANDLE CONDITION
 21130*         DUPKEY   (8130-EXIT)
 21131*    END-EXEC.
 21132*    MOVE '"$$                   ! / #00020287' TO DFHEIV0
 21133     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 21134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21135     MOVE X'2F20233030303230323837' TO DFHEIV0(25:11)
 21136     CALL 'kxdfhei1' USING DFHEIV0
 21137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21138
 21139
 21140
 21141* EXEC CICS WRITE
 21142*         DATASET     (FILE-ERMAIL)
 21143*         RIDFLD      (MA-CONTROL-PRIMARY)
 21144*         FROM        (MAILING-DATA)
 21145*    END-EXEC.
 21146     MOVE LENGTH OF
 21147      MAILING-DATA
 21148       TO DFHEIV11
 21149*    MOVE '&$ L                  ''   #00020291' TO DFHEIV0
 21150     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21151     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21152     MOVE X'2020233030303230323931' TO DFHEIV0(25:11)
 21153     CALL 'kxdfhei1' USING DFHEIV0,
 21154           FILE-ERMAIL,
 21155           MAILING-DATA,
 21156           DFHEIV11,
 21157           MA-CONTROL-PRIMARY,
 21158           DFHEIV99,
 21159           DFHEIV99
 21160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21161
 21162
 21163 8130-EXIT.
 21164     EXIT.
 21165
 21166 8140-UNLOCK-ERMAIL.
 21167
 21168* EXEC CICS UNLOCK
 21169*         DATASET   (FILE-ERMAIL)
 21170*    END-EXEC.
 21171*    MOVE '&*                    #   #00020301' TO DFHEIV0
 21172     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21173     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21174     MOVE X'2020233030303230333031' TO DFHEIV0(25:11)
 21175     CALL 'kxdfhei1' USING DFHEIV0,
 21176           FILE-ERMAIL,
 21177           DFHEIV99
 21178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21179
 21180
 21181 8140-EXIT.
 21182     EXIT.
 21183
 21184 8145-read-elcrtt-upd.
 21185
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 391
* EL050.cbl
 21186     move ' '                    to elcrtt-found-sw
 21187                                    elcrtt-update-sw
 21188
 21189* EXEC CICS HANDLE CONDITION
 21190*        NOTFND   (8145-exit)
 21191*    END-EXEC
 21192*    MOVE '"$I                   ! 0 #00020312' TO DFHEIV0
 21193     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21195     MOVE X'3020233030303230333132' TO DFHEIV0(25:11)
 21196     CALL 'kxdfhei1' USING DFHEIV0
 21197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21198
 21199     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21200     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21201
 21202
 21203* EXEC CICS READ UPDATE
 21204*        DATASET  (CRTT-ID)
 21205*        RIDFLD   (WS-ELCRTT-KEY)
 21206*        INTO     (CERTIFICATE-TRAILERS)
 21207*    END-EXEC
 21208     MOVE LENGTH OF
 21209      CERTIFICATE-TRAILERS
 21210       TO DFHEIV11
 21211*    MOVE '&"IL       EU         (   #00020319' TO DFHEIV0
 21212     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21213     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21214     MOVE X'2020233030303230333139' TO DFHEIV0(25:11)
 21215     CALL 'kxdfhei1' USING DFHEIV0,
 21216           CRTT-ID,
 21217           CERTIFICATE-TRAILERS,
 21218           DFHEIV11,
 21219           WS-ELCRTT-KEY,
 21220           DFHEIV99,
 21221           DFHEIV99,
 21222           DFHEIV99
 21223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21224
 21225     set elcrtt-found to true
 21226
 21227     .
 21228 8145-exit.
 21229     exit.
 21230 8150-UPDATE-ELCRTT.
 21231
 21232     if elcrtt-found
 21233
 21234* EXEC CICS REWRITE
 21235*           DATASET  (CRTT-ID)
 21236*           FROM     (CERTIFICATE-TRAILERS)
 21237*        END-EXEC
 21238     MOVE LENGTH OF
 21239      CERTIFICATE-TRAILERS
 21240       TO DFHEIV11
 21241*    MOVE '&& L                  %   #00020333' TO DFHEIV0
 21242     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21243     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 392
* EL050.cbl
 21244     MOVE X'2020233030303230333333' TO DFHEIV0(25:11)
 21245     CALL 'kxdfhei1' USING DFHEIV0,
 21246           CRTT-ID,
 21247           CERTIFICATE-TRAILERS,
 21248           DFHEIV11,
 21249           DFHEIV99
 21250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21251     ELSE
 21252
 21253* EXEC CICS WRITE
 21254*          DATASET  (CRTT-ID)
 21255*          RIDFLD   (WS-ELCRTT-KEY)
 21256*          FROM     (CERTIFICATE-TRAILERS)
 21257*       END-EXEC
 21258     MOVE LENGTH OF
 21259      CERTIFICATE-TRAILERS
 21260       TO DFHEIV11
 21261*    MOVE '&$ L                  ''   #00020338' TO DFHEIV0
 21262     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21263     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21264     MOVE X'2020233030303230333338' TO DFHEIV0(25:11)
 21265     CALL 'kxdfhei1' USING DFHEIV0,
 21266           CRTT-ID,
 21267           CERTIFICATE-TRAILERS,
 21268           DFHEIV11,
 21269           WS-ELCRTT-KEY,
 21270           DFHEIV99,
 21271           DFHEIV99
 21272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21273     end-if
 21274
 21275     .
 21276 8150-EXIT.
 21277     EXIT.
 21278
 21279 8155-unlock-elcrtt.
 21280
 21281
 21282* EXEC CICS UNLOCK
 21283*       DATASET  (CRTT-ID)
 21284*    END-EXEC
 21285*    MOVE '&*                    #   #00020351' TO DFHEIV0
 21286     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21287     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21288     MOVE X'2020233030303230333531' TO DFHEIV0(25:11)
 21289     CALL 'kxdfhei1' USING DFHEIV0,
 21290           CRTT-ID,
 21291           DFHEIV99
 21292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21293
 21294     .
 21295 8155-exit.
 21296     exit.
 21297
 21298 8190-UPDATE-REFUND-CLAIM-FLAG.
 21299
 21300* EXEC CICS HANDLE CONDITION
 21301*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 393
* EL050.cbl
 21302*    END-EXEC.
 21303*    MOVE '"$I                   ! 1 #00020360' TO DFHEIV0
 21304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21306     MOVE X'3120233030303230333630' TO DFHEIV0(25:11)
 21307     CALL 'kxdfhei1' USING DFHEIV0
 21308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21309
 21310
 21311     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21312     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21313
 21314
 21315* EXEC CICS READ
 21316*        UPDATE
 21317*        DATASET  (CRTT-ID)
 21318*        RIDFLD   (WS-ELCRTT-KEY)
 21319*        INTO     (CERTIFICATE-TRAILERS)
 21320*    END-EXEC.
 21321     MOVE LENGTH OF
 21322      CERTIFICATE-TRAILERS
 21323       TO DFHEIV11
 21324*    MOVE '&"IL       EU         (   #00020367' TO DFHEIV0
 21325     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21326     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21327     MOVE X'2020233030303230333637' TO DFHEIV0(25:11)
 21328     CALL 'kxdfhei1' USING DFHEIV0,
 21329           CRTT-ID,
 21330           CERTIFICATE-TRAILERS,
 21331           DFHEIV11,
 21332           WS-ELCRTT-KEY,
 21333           DFHEIV99,
 21334           DFHEIV99,
 21335           DFHEIV99
 21336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21337
 21338
 21339     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21340
 21341* EXEC CICS REWRITE
 21342*       DATASET  (CRTT-ID)
 21343*       FROM     (CERTIFICATE-TRAILERS)
 21344*    END-EXEC.
 21345     MOVE LENGTH OF
 21346      CERTIFICATE-TRAILERS
 21347       TO DFHEIV11
 21348*    MOVE '&& L                  %   #00020375' TO DFHEIV0
 21349     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21350     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21351     MOVE X'2020233030303230333735' TO DFHEIV0(25:11)
 21352     CALL 'kxdfhei1' USING DFHEIV0,
 21353           CRTT-ID,
 21354           CERTIFICATE-TRAILERS,
 21355           DFHEIV11,
 21356           DFHEIV99
 21357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21358
 21359
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 394
* EL050.cbl
 21360     GO TO 8190-EXIT.
 21361
 21362 8190-NOTFND.
 21363
 21364     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21365     MOVE 'CS'         TO CS-RECORD-ID.
 21366     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21367     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21368     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21369     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21370
 21371* EXEC CICS WRITE
 21372*       DATASET  (CRTT-ID)
 21373*       RIDFLD   (WS-ELCRTT-KEY)
 21374*       FROM     (CERTIFICATE-TRAILERS)
 21375*    END-EXEC.
 21376     MOVE LENGTH OF
 21377      CERTIFICATE-TRAILERS
 21378       TO DFHEIV11
 21379*    MOVE '&$ L                  ''   #00020390' TO DFHEIV0
 21380     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21382     MOVE X'2020233030303230333930' TO DFHEIV0(25:11)
 21383     CALL 'kxdfhei1' USING DFHEIV0,
 21384           CRTT-ID,
 21385           CERTIFICATE-TRAILERS,
 21386           DFHEIV11,
 21387           WS-ELCRTT-KEY,
 21388           DFHEIV99,
 21389           DFHEIV99
 21390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21391
 21392
 21393 8190-EXIT.
 21394     EXIT.
 21395
 21396 8195-UPDATE-AGE-FLAGS.
 21397
 21398* EXEC CICS HANDLE CONDITION
 21399*        NOTFND   (8195-NOTFND)
 21400*    END-EXEC.
 21401*    MOVE '"$I                   ! 2 #00020400' TO DFHEIV0
 21402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21404     MOVE X'3220233030303230343030' TO DFHEIV0(25:11)
 21405     CALL 'kxdfhei1' USING DFHEIV0
 21406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21407
 21408
 21409     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21410     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21411
 21412
 21413* EXEC CICS READ
 21414*        UPDATE
 21415*        DATASET  (CRTT-ID)
 21416*        RIDFLD   (WS-ELCRTT-KEY)
 21417*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 395
* EL050.cbl
 21418*    END-EXEC.
 21419     MOVE LENGTH OF
 21420      CERTIFICATE-TRAILERS
 21421       TO DFHEIV11
 21422*    MOVE '&"IL       EU         (   #00020407' TO DFHEIV0
 21423     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21424     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21425     MOVE X'2020233030303230343037' TO DFHEIV0(25:11)
 21426     CALL 'kxdfhei1' USING DFHEIV0,
 21427           CRTT-ID,
 21428           CERTIFICATE-TRAILERS,
 21429           DFHEIV11,
 21430           WS-ELCRTT-KEY,
 21431           DFHEIV99,
 21432           DFHEIV99,
 21433           DFHEIV99
 21434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21435
 21436
 21437     IF WS-INS-AGE-SET = 'Y'
 21438        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21439     END-IF
 21440     IF WS-JNT-AGE-SET = 'Y'
 21441        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21442     END-IF
 21443
 21444
 21445* EXEC CICS REWRITE
 21446*       DATASET  (CRTT-ID)
 21447*       FROM     (CERTIFICATE-TRAILERS)
 21448*    END-EXEC.
 21449     MOVE LENGTH OF
 21450      CERTIFICATE-TRAILERS
 21451       TO DFHEIV11
 21452*    MOVE '&& L                  %   #00020421' TO DFHEIV0
 21453     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21454     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21455     MOVE X'2020233030303230343231' TO DFHEIV0(25:11)
 21456     CALL 'kxdfhei1' USING DFHEIV0,
 21457           CRTT-ID,
 21458           CERTIFICATE-TRAILERS,
 21459           DFHEIV11,
 21460           DFHEIV99
 21461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21462
 21463
 21464     GO TO 8195-EXIT.
 21465
 21466 8195-NOTFND.
 21467
 21468     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21469     MOVE 'CS'         TO CS-RECORD-ID.
 21470     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21471     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21472     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21473     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21474     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21475
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 396
* EL050.cbl
 21476* EXEC CICS WRITE
 21477*       DATASET  (CRTT-ID)
 21478*       RIDFLD   (WS-ELCRTT-KEY)
 21479*       FROM     (CERTIFICATE-TRAILERS)
 21480*    END-EXEC.
 21481     MOVE LENGTH OF
 21482      CERTIFICATE-TRAILERS
 21483       TO DFHEIV11
 21484*    MOVE '&$ L                  ''   #00020437' TO DFHEIV0
 21485     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21486     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21487     MOVE X'2020233030303230343337' TO DFHEIV0(25:11)
 21488     CALL 'kxdfhei1' USING DFHEIV0,
 21489           CRTT-ID,
 21490           CERTIFICATE-TRAILERS,
 21491           DFHEIV11,
 21492           WS-ELCRTT-KEY,
 21493           DFHEIV99,
 21494           DFHEIV99
 21495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21496
 21497
 21498 8195-EXIT.
 21499     EXIT.
 21500
 21501 8200-READ-REIN-TABLE.
 21502
 21503* EXEC CICS HANDLE CONDITION
 21504*         NOTFND   (8200-NOTFND)
 21505*    END-EXEC.
 21506*    MOVE '"$I                   ! 3 #00020447' TO DFHEIV0
 21507     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21509     MOVE X'3320233030303230343437' TO DFHEIV0(25:11)
 21510     CALL 'kxdfhei1' USING DFHEIV0
 21511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21512
 21513
 21514
 21515* EXEC CICS READ
 21516*        DATASET     (REIN-ID)
 21517*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21518*        RIDFLD      (ERREIN-KEY)
 21519*    END-EXEC.
 21520*    MOVE '&"S        E          (   #00020451' TO DFHEIV0
 21521     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21523     MOVE X'2020233030303230343531' TO DFHEIV0(25:11)
 21524     CALL 'kxdfhei1' USING DFHEIV0,
 21525           REIN-ID,
 21526           DFHEIV20,
 21527           DFHEIV99,
 21528           ERREIN-KEY,
 21529           DFHEIV99,
 21530           DFHEIV99,
 21531           DFHEIV99
 21532     SET ADDRESS OF REINSURANCE-RECORD TO
 21533         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 397
* EL050.cbl
 21534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21535
 21536
 21537     GO TO 8200-EXIT.
 21538
 21539 8200-NOTFND.
 21540     MOVE 'N'             TO WS-REIN-READ-SW.
 21541
 21542 8200-EXIT.
 21543      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 398
* EL050.cbl
 21545
 21546 8300-READ-CTBL-TABLE.
 21547
 21548* EXEC CICS HANDLE CONDITION
 21549*        NOTFND    (8300-NOTFND)
 21550*        DISABLED  (8300-ERRESS-PROBLEM)
 21551*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21552*        ENDFILE   (8300-NOTFND)
 21553*    END-EXEC.
 21554*    MOVE '"$IcJ''                ! 4 #00020467' TO DFHEIV0
 21555     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21557     MOVE X'3420233030303230343637' TO DFHEIV0(25:11)
 21558     CALL 'kxdfhei1' USING DFHEIV0
 21559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21560
 21561
 21562
 21563* EXEC CICS READ
 21564*        DATASET     (CTBL-ID)
 21565*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21566*        RIDFLD      (ERCTBL-KEY)
 21567*    END-EXEC.
 21568*    MOVE '&"S        E          (   #00020474' TO DFHEIV0
 21569     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21570     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21571     MOVE X'2020233030303230343734' TO DFHEIV0(25:11)
 21572     CALL 'kxdfhei1' USING DFHEIV0,
 21573           CTBL-ID,
 21574           DFHEIV20,
 21575           DFHEIV99,
 21576           ERCTBL-KEY,
 21577           DFHEIV99,
 21578           DFHEIV99,
 21579           DFHEIV99
 21580     SET ADDRESS OF COMM-TABLE-RECORD TO
 21581         DFHEIV20
 21582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21583
 21584
 21585     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21586
 21587     GO TO 8300-EXIT.
 21588
 21589 8300-NOTFND.
 21590
 21591     IF CTBL-SW = '0530'
 21592         MOVE 'AA'                     TO WS-AH-COMP-CD
 21593         MOVE '0550'                   TO CTBL-SW
 21594         MOVE '1'                      TO WS-CTBL-READ-SW
 21595         GO TO 8300-EXIT.
 21596
 21597     IF CTBL-SW = '0540'
 21598         MOVE 'AA'                     TO WS-LF-COMP-CD
 21599         MOVE '0550'                   TO CTBL-SW
 21600         MOVE '1'                      TO WS-CTBL-READ-SW
 21601         GO TO 8300-EXIT.
 21602
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 399
* EL050.cbl
 21603     IF CTBL-SW = '0550'
 21604         MOVE '2'                      TO WS-CTBL-READ-SW
 21605         GO TO 8300-EXIT.
 21606
 21607     GO TO 8300-EXIT.
 21608
 21609 8300-ERRESS-PROBLEM.
 21610
 21611      MOVE ER-8050              TO WS-ERROR.
 21612      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21613
 21614     GO TO 8300-EXIT.
 21615
 21616 8300-EXIT.
 21617      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 400
* EL050.cbl
 21619
 21620
 21621 8400-GETMAIN-ERFORM.
 21622
 21623
 21624* EXEC CICS   GETMAIN
 21625*        LENGTH  (500)
 21626*        SET     (ADDRESS OF FORM-MASTER)
 21627*    END-EXEC.
 21628     MOVE 500
 21629       TO DFHEIV11
 21630*    MOVE '," L                  $   #00020518' TO DFHEIV0
 21631     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21633     MOVE X'2020233030303230353138' TO DFHEIV0(25:11)
 21634     CALL 'kxdfhei1' USING DFHEIV0,
 21635           DFHEIV20,
 21636           DFHEIV11,
 21637           DFHEIV99
 21638     SET ADDRESS OF FORM-MASTER TO
 21639         DFHEIV20
 21640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21641
 21642
 21643     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21644
 21645 8400-EXIT.
 21646      EXIT.
 21647
 21648 8450-READ-FORM-MASTER.
 21649
 21650
 21651* EXEC CICS  HANDLE CONDITION
 21652*        NOTFND   (8450-FORM-NOT-FOUND)
 21653*        ENDFILE  (8450-FORM-NOT-FOUND)
 21654*    END-EXEC.
 21655*    MOVE '"$I''                  ! 5 #00020530' TO DFHEIV0
 21656     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21658     MOVE X'3520233030303230353330' TO DFHEIV0(25:11)
 21659     CALL 'kxdfhei1' USING DFHEIV0
 21660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21661
 21662
 21663
 21664* EXEC CICS   READ
 21665*        DATASET   (FORM-ID)
 21666*        RIDFLD    (ERFORM-KEY)
 21667*        INTO      (FORM-MASTER)
 21668*        GTEQ
 21669*    END-EXEC.
 21670     MOVE LENGTH OF
 21671      FORM-MASTER
 21672       TO DFHEIV11
 21673*    MOVE '&"IL       G          (   #00020535' TO DFHEIV0
 21674     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21675     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21676     MOVE X'2020233030303230353335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 401
* EL050.cbl
 21677     CALL 'kxdfhei1' USING DFHEIV0,
 21678           FORM-ID,
 21679           FORM-MASTER,
 21680           DFHEIV11,
 21681           ERFORM-KEY,
 21682           DFHEIV99,
 21683           DFHEIV99,
 21684           DFHEIV99
 21685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21686
 21687
 21688     MOVE  'Y'           TO  FORM-MASTER-SW.
 21689
 21690     GO TO  8450-EXIT.
 21691
 21692 8450-FORM-NOT-FOUND.
 21693
 21694     MOVE  'N'           TO  FORM-MASTER-SW.
 21695
 21696 8450-EXIT.
 21697      EXIT.
 21698
 21699 8500-DATE-CONVERT.
 21700
 21701* EXEC CICS LINK
 21702*        PROGRAM    ('ELDATCV')
 21703*        COMMAREA   (DATE-CONVERSION-DATA)
 21704*        LENGTH     (DC-COMM-LENGTH)
 21705*    END-EXEC.
 21706     MOVE 'ELDATCV' TO DFHEIV1
 21707*    MOVE '."C                   (   #00020554' TO DFHEIV0
 21708     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21709     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21710     MOVE X'2020233030303230353534' TO DFHEIV0(25:11)
 21711     CALL 'kxdfhei1' USING DFHEIV0,
 21712           DFHEIV1,
 21713           DATE-CONVERSION-DATA,
 21714           DC-COMM-LENGTH,
 21715           DFHEIV99,
 21716           DFHEIV99,
 21717           DFHEIV99,
 21718           DFHEIV99
 21719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21720
 21721
 21722 8500-EXIT.
 21723     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 402
* EL050.cbl
 21725
 21726 8555-RELOAD-CONTROL-FILE.
 21727     CONTINUE.
 21728
 21729 8555-EXIT.
 21730     EXIT.
 21731
 21732 8557-GETMAIN-ERPLAN.
 21733
 21734
 21735* EXEC CICS GETMAIN
 21736*        LENGTH    (840)
 21737*        SET       (ADDRESS OF PLAN-RECORDS)
 21738*    END-EXEC.
 21739     MOVE 840
 21740       TO DFHEIV11
 21741*    MOVE '," L                  $   #00020572' TO DFHEIV0
 21742     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21743     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21744     MOVE X'2020233030303230353732' TO DFHEIV0(25:11)
 21745     CALL 'kxdfhei1' USING DFHEIV0,
 21746           DFHEIV20,
 21747           DFHEIV11,
 21748           DFHEIV99
 21749     SET ADDRESS OF PLAN-RECORDS TO
 21750         DFHEIV20
 21751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21752
 21753
 21754     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21755
 21756 8557-EXIT.
 21757     EXIT.
 21758
 21759 8560-GETMAIN.
 21760
 21761* EXEC CICS GETMAIN
 21762*        LENGTH    (2000)
 21763*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21764*    END-EXEC.
 21765     MOVE 2000
 21766       TO DFHEIV11
 21767*    MOVE '," L                  $   #00020583' TO DFHEIV0
 21768     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21769     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21770     MOVE X'2020233030303230353833' TO DFHEIV0(25:11)
 21771     CALL 'kxdfhei1' USING DFHEIV0,
 21772           DFHEIV20,
 21773           DFHEIV11,
 21774           DFHEIV99
 21775     SET ADDRESS OF ACCOUNT-MASTER TO
 21776         DFHEIV20
 21777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21778
 21779
 21780     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21781
 21782 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 403
* EL050.cbl
 21783     EXIT.
 21784
 21785 8570-START-ACCOUNT-MASTER.
 21786
 21787* EXEC CICS HANDLE CONDITION
 21788*        NOTFND    (0199-ACCT-NOT-FOUND)
 21789*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21790*    END-EXEC.
 21791*    MOVE '"$I''                  ! 6 #00020594' TO DFHEIV0
 21792     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21794     MOVE X'3620233030303230353934' TO DFHEIV0(25:11)
 21795     CALL 'kxdfhei1' USING DFHEIV0
 21796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21797
 21798
 21799
 21800* EXEC CICS STARTBR
 21801*        DATASET    (ACCT-ID)
 21802*        RIDFLD     (ERACCT-KEY)
 21803*        GTEQ
 21804*    END-EXEC.
 21805     MOVE 0
 21806       TO DFHEIV11
 21807*    MOVE '&,         G          &   #00020599' TO DFHEIV0
 21808     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21809     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21810     MOVE X'2020233030303230353939' TO DFHEIV0(25:11)
 21811     CALL 'kxdfhei1' USING DFHEIV0,
 21812           ACCT-ID,
 21813           ERACCT-KEY,
 21814           DFHEIV99,
 21815           DFHEIV11,
 21816           DFHEIV99
 21817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21818
 21819
 21820 8570-EXIT.
 21821     EXIT.
 21822
 21823 8580-READ-ACCOUNT-MASTER.
 21824
 21825* EXEC CICS HANDLE CONDITION
 21826*        NOTFND    (0199-ACCT-NOT-FOUND)
 21827*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21828*    END-EXEC.
 21829*    MOVE '"$I''                  ! 7 #00020609' TO DFHEIV0
 21830     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21832     MOVE X'3720233030303230363039' TO DFHEIV0(25:11)
 21833     CALL 'kxdfhei1' USING DFHEIV0
 21834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21835
 21836
 21837
 21838* EXEC CICS READNEXT
 21839*        DATASET     (ACCT-ID)
 21840*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 404
* EL050.cbl
 21841*        RIDFLD      (ERACCT-KEY)
 21842*    END-EXEC.
 21843     MOVE LENGTH OF
 21844      ACCOUNT-MASTER
 21845       TO DFHEIV12
 21846     MOVE 0
 21847       TO DFHEIV11
 21848*    MOVE '&.IL                  )   #00020614' TO DFHEIV0
 21849     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21850     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21851     MOVE X'2020233030303230363134' TO DFHEIV0(25:11)
 21852     CALL 'kxdfhei1' USING DFHEIV0,
 21853           ACCT-ID,
 21854           ACCOUNT-MASTER,
 21855           DFHEIV12,
 21856           ERACCT-KEY,
 21857           DFHEIV99,
 21858           DFHEIV11,
 21859           DFHEIV99,
 21860           DFHEIV99
 21861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21862
 21863
 21864 8580-EXIT.
 21865     EXIT.
 21866
 21867 8582-READ-COMPENSATION-MASTER.
 21868
 21869* EXEC CICS HANDLE CONDITION
 21870*        NOTFND    (8582-COMP-NOT-FOUND)
 21871*        ENDFILE   (8582-COMP-NOT-FOUND)
 21872*    END-EXEC.
 21873*    MOVE '"$I''                  ! 8 #00020624' TO DFHEIV0
 21874     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21875     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21876     MOVE X'3820233030303230363234' TO DFHEIV0(25:11)
 21877     CALL 'kxdfhei1' USING DFHEIV0
 21878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21879
 21880
 21881
 21882* EXEC CICS READ
 21883*        DATASET     (COMP-ID)
 21884*        INTO        (COMPENSATION-MASTER)
 21885*        RIDFLD      (ERCOMP-KEY)
 21886*    END-EXEC.
 21887     MOVE LENGTH OF
 21888      COMPENSATION-MASTER
 21889       TO DFHEIV11
 21890*    MOVE '&"IL       E          (   #00020629' TO DFHEIV0
 21891     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21893     MOVE X'2020233030303230363239' TO DFHEIV0(25:11)
 21894     CALL 'kxdfhei1' USING DFHEIV0,
 21895           COMP-ID,
 21896           COMPENSATION-MASTER,
 21897           DFHEIV11,
 21898           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 405
* EL050.cbl
 21899           DFHEIV99,
 21900           DFHEIV99,
 21901           DFHEIV99
 21902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21903
 21904
 21905     MOVE 'Y'                    TO COMP-MASTER-SW
 21906
 21907     GO TO 8582-EXIT
 21908     .
 21909 8582-COMP-NOT-FOUND.
 21910
 21911     MOVE 'N'                    TO COMP-MASTER-SW.
 21912
 21913 8582-EXIT.
 21914     EXIT.
 21915
 21916 8583-READ-ERAGTC.
 21917
 21918* EXEC CICS HANDLE CONDITION
 21919*        NOTFND    (8583-AGTC-NOT-FOUND)
 21920*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21921*    END-EXEC.
 21922*    MOVE '"$I''                  ! 9 #00020647' TO DFHEIV0
 21923     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21925     MOVE X'3920233030303230363437' TO DFHEIV0(25:11)
 21926     CALL 'kxdfhei1' USING DFHEIV0
 21927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21928
 21929
 21930
 21931* EXEC CICS STARTBR
 21932*        DATASET    (AGTC-ID)
 21933*        RIDFLD     (ERAGTC-KEY)
 21934*        GTEQ
 21935*    END-EXEC.
 21936     MOVE 0
 21937       TO DFHEIV11
 21938*    MOVE '&,         G          &   #00020652' TO DFHEIV0
 21939     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21940     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21941     MOVE X'2020233030303230363532' TO DFHEIV0(25:11)
 21942     CALL 'kxdfhei1' USING DFHEIV0,
 21943           AGTC-ID,
 21944           ERAGTC-KEY,
 21945           DFHEIV99,
 21946           DFHEIV11,
 21947           DFHEIV99
 21948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21949
 21950
 21951 8583-READ-ERAGTC-NEXT.
 21952
 21953* EXEC CICS READNEXT
 21954*        DATASET     (AGTC-ID)
 21955*        INTO        (AGENT-COMMISSIONS)
 21956*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 406
* EL050.cbl
 21957*    END-EXEC.
 21958     MOVE LENGTH OF
 21959      AGENT-COMMISSIONS
 21960       TO DFHEIV12
 21961     MOVE 0
 21962       TO DFHEIV11
 21963*    MOVE '&.IL                  )   #00020659' TO DFHEIV0
 21964     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21965     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21966     MOVE X'2020233030303230363539' TO DFHEIV0(25:11)
 21967     CALL 'kxdfhei1' USING DFHEIV0,
 21968           AGTC-ID,
 21969           AGENT-COMMISSIONS,
 21970           DFHEIV12,
 21971           ERAGTC-KEY,
 21972           DFHEIV99,
 21973           DFHEIV11,
 21974           DFHEIV99,
 21975           DFHEIV99
 21976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21977
 21978
 21979*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21980
 21981     GO TO 8583-EXIT
 21982     .
 21983 8583-AGTC-NOT-FOUND.
 21984
 21985     MOVE 'N'                    TO AGTC-MASTER-SW.
 21986
 21987 8583-EXIT.
 21988     EXIT.
 21989
 21990 8584-READ-BANK-CROSS-REF.
 21991
 21992* EXEC CICS HANDLE CONDITION
 21993*        NOTFND    (8584-BXRF-NOT-FOUND)
 21994*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21995*    END-EXEC.
 21996*    MOVE '"$I''                  ! : #00020677' TO DFHEIV0
 21997     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21998     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21999     MOVE X'3A20233030303230363737' TO DFHEIV0(25:11)
 22000     CALL 'kxdfhei1' USING DFHEIV0
 22001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22002
 22003
 22004
 22005* EXEC CICS READ
 22006*        DATASET     (BXRF-ID)
 22007*        INTO        (BANK-CROSS-REFERENCE)
 22008*        RIDFLD      (ERBXRF-KEY)
 22009*        LENGTH      (BXRF-REC-LENGTH)
 22010*    END-EXEC.
 22011*    MOVE '&"IL       E          (   #00020682' TO DFHEIV0
 22012     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22014     MOVE X'2020233030303230363832' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 407
* EL050.cbl
 22015     CALL 'kxdfhei1' USING DFHEIV0,
 22016           BXRF-ID,
 22017           BANK-CROSS-REFERENCE,
 22018           BXRF-REC-LENGTH,
 22019           ERBXRF-KEY,
 22020           DFHEIV99,
 22021           DFHEIV99,
 22022           DFHEIV99
 22023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22024
 22025
 22026     MOVE 'Y'                    TO BXRF-MASTER-SW
 22027
 22028     GO TO 8584-EXIT
 22029     .
 22030 8584-BXRF-NOT-FOUND.
 22031
 22032     MOVE 'N'                    TO BXRF-MASTER-SW.
 22033
 22034 8584-EXIT.
 22035     EXIT.
 22036
 22037 8585-READ-PLAN-MASTER.
 22038
 22039
 22040* EXEC CICS HANDLE CONDITION
 22041*        NOTFND    (8585-PLAN-NOT-FOUND)
 22042*        ENDFILE   (8585-PLAN-NOT-FOUND)
 22043*    END-EXEC.
 22044*    MOVE '"$I''                  ! ; #00020702' TO DFHEIV0
 22045     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22047     MOVE X'3B20233030303230373032' TO DFHEIV0(25:11)
 22048     CALL 'kxdfhei1' USING DFHEIV0
 22049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22050
 22051
 22052
 22053* EXEC CICS READ
 22054*        DATASET     (PLAN-ID)
 22055*        INTO        (PLAN-MASTER)
 22056*        RIDFLD      (ERPLAN-KEY)
 22057*    END-EXEC.
 22058     MOVE LENGTH OF
 22059      PLAN-MASTER
 22060       TO DFHEIV11
 22061*    MOVE '&"IL       E          (   #00020707' TO DFHEIV0
 22062     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22063     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22064     MOVE X'2020233030303230373037' TO DFHEIV0(25:11)
 22065     CALL 'kxdfhei1' USING DFHEIV0,
 22066           PLAN-ID,
 22067           PLAN-MASTER,
 22068           DFHEIV11,
 22069           ERPLAN-KEY,
 22070           DFHEIV99,
 22071           DFHEIV99,
 22072           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 408
* EL050.cbl
 22073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22074
 22075
 22076     MOVE 'Y'                    TO PLAN-MASTER-SW.
 22077
 22078     GO TO 8585-EXIT.
 22079
 22080 8585-PLAN-NOT-FOUND.
 22081
 22082     MOVE 'N'                    TO PLAN-MASTER-SW.
 22083
 22084 8585-EXIT.
 22085     EXIT.
 22086
 22087 8586-READ-LOAN-OFFICER.
 22088
 22089* EXEC CICS READ
 22090*        DATASET     (LOFC-ID)
 22091*        INTO        (LOAN-OFFICER-MASTER)
 22092*        RIDFLD      (ERLOFC-KEY)
 22093*        RESP        (WS-RESPONSE)
 22094*    END-EXEC
 22095     MOVE LENGTH OF
 22096      LOAN-OFFICER-MASTER
 22097       TO DFHEIV11
 22098*    MOVE '&"IL       E          (  N#00020725' TO DFHEIV0
 22099     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22100     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22101     MOVE X'204E233030303230373235' TO DFHEIV0(25:11)
 22102     CALL 'kxdfhei1' USING DFHEIV0,
 22103           LOFC-ID,
 22104           LOAN-OFFICER-MASTER,
 22105           DFHEIV11,
 22106           ERLOFC-KEY,
 22107           DFHEIV99,
 22108           DFHEIV99,
 22109           DFHEIV99
 22110     MOVE EIBRESP  TO WS-RESPONSE
 22111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22112
 22113     IF WS-RESP-NORMAL
 22114        MOVE 'Y'                 TO LOFC-MASTER-SW
 22115     ELSE
 22116        MOVE 'N'                 TO LOFC-MASTER-SW
 22117     END-IF
 22118     .
 22119 8586-EXIT.
 22120     EXIT.
 22121 8587-START-ERPDEF.
 22122
 22123* EXEC CICS STARTBR
 22124*       DATASET   (PDEF-ID)
 22125*       RIDFLD    (ERPDEF-KEY)
 22126*       GTEQ
 22127*       RESP      (WS-RESPONSE)
 22128*    END-EXEC
 22129     MOVE 0
 22130       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 409
* EL050.cbl
 22131*    MOVE '&,         G          &  N#00020741' TO DFHEIV0
 22132     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22133     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22134     MOVE X'204E233030303230373431' TO DFHEIV0(25:11)
 22135     CALL 'kxdfhei1' USING DFHEIV0,
 22136           PDEF-ID,
 22137           ERPDEF-KEY,
 22138           DFHEIV99,
 22139           DFHEIV11,
 22140           DFHEIV99
 22141     MOVE EIBRESP  TO WS-RESPONSE
 22142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22143     IF WS-RESP-NORMAL
 22144        MOVE 'Y'                 TO PDEF-MASTER-SW
 22145     ELSE
 22146        MOVE 'N'                 TO PDEF-MASTER-SW
 22147     END-IF
 22148     .
 22149 8587-EXIT.
 22150     EXIT.
 22151 8588-READ-ERPDEF.
 22152
 22153* EXEC CICS READNEXT
 22154*       DATASET   (PDEF-ID)
 22155*       RIDFLD    (ERPDEF-KEY)
 22156*       INTO      (PRODUCT-MASTER)
 22157*       RESP      (WS-RESPONSE)
 22158*    END-EXEC
 22159     MOVE LENGTH OF
 22160      PRODUCT-MASTER
 22161       TO DFHEIV12
 22162     MOVE 0
 22163       TO DFHEIV11
 22164*    MOVE '&.IL                  )  N#00020756' TO DFHEIV0
 22165     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22166     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22167     MOVE X'204E233030303230373536' TO DFHEIV0(25:11)
 22168     CALL 'kxdfhei1' USING DFHEIV0,
 22169           PDEF-ID,
 22170           PRODUCT-MASTER,
 22171           DFHEIV12,
 22172           ERPDEF-KEY,
 22173           DFHEIV99,
 22174           DFHEIV11,
 22175           DFHEIV99,
 22176           DFHEIV99
 22177     MOVE EIBRESP  TO WS-RESPONSE
 22178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22179     IF WS-RESP-NORMAL
 22180        MOVE 'Y'                 TO PDEF-MASTER-SW
 22181     ELSE
 22182        MOVE 'N'                 TO PDEF-MASTER-SW
 22183     END-IF
 22184     .
 22185 8588-EXIT.
 22186     EXIT.
 22187 8589-ENDBR-ERPDEF.
 22188
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 410
* EL050.cbl
 22189* EXEC CICS ENDBR
 22190*       DATASET   (PDEF-ID)
 22191*    END-EXEC
 22192     MOVE 0
 22193       TO DFHEIV11
 22194*    MOVE '&2                    $   #00020771' TO DFHEIV0
 22195     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22196     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22197     MOVE X'2020233030303230373731' TO DFHEIV0(25:11)
 22198     CALL 'kxdfhei1' USING DFHEIV0,
 22199           PDEF-ID,
 22200           DFHEIV11,
 22201           DFHEIV99
 22202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22203     .
 22204 8589-EXIT.
 22205     EXIT.
 22206 8590-READ-CERT-MASTER.
 22207     IF PB-COMPANY-ID = 'UCL'
 22208         GO TO 8690-READ-CERT-MASTER-UCL.
 22209
 22210
 22211* EXEC CICS HANDLE CONDITION
 22212*         NOTFND    (0299-CERT-NOT-FOUND)
 22213*    END-EXEC.
 22214*    MOVE '"$I                   ! < #00020781' TO DFHEIV0
 22215     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22217     MOVE X'3C20233030303230373831' TO DFHEIV0(25:11)
 22218     CALL 'kxdfhei1' USING DFHEIV0
 22219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22220
 22221
 22222
 22223* EXEC CICS READ
 22224*        DATASET     (CERT-ID)
 22225*        INTO        (CERTIFICATE-MASTER)
 22226*        RIDFLD      (ELCERT-KEY)
 22227*        UPDATE
 22228*    END-EXEC.
 22229     MOVE LENGTH OF
 22230      CERTIFICATE-MASTER
 22231       TO DFHEIV11
 22232*    MOVE '&"IL       EU         (   #00020785' TO DFHEIV0
 22233     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22234     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22235     MOVE X'2020233030303230373835' TO DFHEIV0(25:11)
 22236     CALL 'kxdfhei1' USING DFHEIV0,
 22237           CERT-ID,
 22238           CERTIFICATE-MASTER,
 22239           DFHEIV11,
 22240           ELCERT-KEY,
 22241           DFHEIV99,
 22242           DFHEIV99,
 22243           DFHEIV99
 22244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22245
 22246
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 411
* EL050.cbl
 22247 8590-EXIT.
 22248     EXIT.
 22249
 22250 8690-READ-CERT-MASTER-UCL.
 22251
 22252* EXEC CICS HANDLE CONDITION
 22253*         NOTFND    (8700-READ-CERT-MASTER)
 22254*    END-EXEC.
 22255*    MOVE '"$I                   ! = #00020796' TO DFHEIV0
 22256     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22258     MOVE X'3D20233030303230373936' TO DFHEIV0(25:11)
 22259     CALL 'kxdfhei1' USING DFHEIV0
 22260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22261
 22262
 22263 8690-READ-CERT-CONT.
 22264
 22265* EXEC CICS READ
 22266*        DATASET     (CERT-ID)
 22267*        INTO        (CERTIFICATE-MASTER)
 22268*        RIDFLD      (ELCERT-KEY)
 22269*        UPDATE
 22270*    END-EXEC.
 22271     MOVE LENGTH OF
 22272      CERTIFICATE-MASTER
 22273       TO DFHEIV11
 22274*    MOVE '&"IL       EU         (   #00020801' TO DFHEIV0
 22275     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22276     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22277     MOVE X'2020233030303230383031' TO DFHEIV0(25:11)
 22278     CALL 'kxdfhei1' USING DFHEIV0,
 22279           CERT-ID,
 22280           CERTIFICATE-MASTER,
 22281           DFHEIV11,
 22282           ELCERT-KEY,
 22283           DFHEIV99,
 22284           DFHEIV99,
 22285           DFHEIV99
 22286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22287
 22288
 22289     GO TO 8590-EXIT.
 22290
 22291 8700-READ-CERT-MASTER.
 22292     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22293     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22294
 22295* EXEC CICS HANDLE CONDITION
 22296*         DUPKEY    (8720-COMP-ACCOUNTS)
 22297*         ENDFILE   (8730-END-BROWSE)
 22298*         NOTFND    (8740-NOT-FOUND)
 22299*    END-EXEC.
 22300*    MOVE '"$$''I                 ! > #00020813' TO DFHEIV0
 22301     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22302     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22303     MOVE X'3E20233030303230383133' TO DFHEIV0(25:11)
 22304     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 412
* EL050.cbl
 22305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22306
 22307
 22308
 22309* EXEC CICS STARTBR
 22310*        DATASET     ('ELCERT5')
 22311*        RIDFLD      (ELCERT2-KEY)
 22312*        EQUAL
 22313*    END-EXEC.
 22314     MOVE 'ELCERT5' TO DFHEIV1
 22315     MOVE 0
 22316       TO DFHEIV11
 22317*    MOVE '&,         E          &   #00020819' TO DFHEIV0
 22318     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22320     MOVE X'2020233030303230383139' TO DFHEIV0(25:11)
 22321     CALL 'kxdfhei1' USING DFHEIV0,
 22322           DFHEIV1,
 22323           ELCERT2-KEY,
 22324           DFHEIV99,
 22325           DFHEIV11,
 22326           DFHEIV99
 22327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22328
 22329
 22330 8710-READ-NEXT.
 22331
 22332* EXEC CICS READNEXT
 22333*        DATASET     ('ELCERT5')
 22334*        INTO        (CERTIFICATE-MASTER)
 22335*        RIDFLD      (ELCERT2-KEY)
 22336*    END-EXEC.
 22337     MOVE LENGTH OF
 22338      CERTIFICATE-MASTER
 22339       TO DFHEIV12
 22340     MOVE 'ELCERT5' TO DFHEIV1
 22341     MOVE 0
 22342       TO DFHEIV11
 22343*    MOVE '&.IL                  )   #00020826' TO DFHEIV0
 22344     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22345     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22346     MOVE X'2020233030303230383236' TO DFHEIV0(25:11)
 22347     CALL 'kxdfhei1' USING DFHEIV0,
 22348           DFHEIV1,
 22349           CERTIFICATE-MASTER,
 22350           DFHEIV12,
 22351           ELCERT2-KEY,
 22352           DFHEIV99,
 22353           DFHEIV11,
 22354           DFHEIV99,
 22355           DFHEIV99
 22356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22357
 22358
 22359 8720-COMP-ACCOUNTS.
 22360
 22361* EXEC CICS ENTER
 22362*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 413
* EL050.cbl
 22363*         FROM (PB-C-LAST-NAME)
 22364*    END-EXEC.
 22365     MOVE 001
 22366       TO DFHEIV11
 22367*    MOVE ':$F                   %   #00020833' TO DFHEIV0
 22368     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22369     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22370     MOVE X'2020233030303230383333' TO DFHEIV0(25:11)
 22371     CALL 'kxdfhei1' USING DFHEIV0,
 22372           DFHEIV11,
 22373           PB-C-LAST-NAME,
 22374           DFHEIV99,
 22375           DFHEIV99
 22376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22377
 22378
 22379
 22380* EXEC CICS ENTER
 22381*         TRACEID (002)
 22382*         FROM (CM-INSURED-LAST-NAME)
 22383*    END-EXEC.
 22384     MOVE 002
 22385       TO DFHEIV11
 22386*    MOVE ':$F                   %   #00020838' TO DFHEIV0
 22387     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22388     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22389     MOVE X'2020233030303230383338' TO DFHEIV0(25:11)
 22390     CALL 'kxdfhei1' USING DFHEIV0,
 22391           DFHEIV11,
 22392           CM-INSURED-LAST-NAME,
 22393           DFHEIV99,
 22394           DFHEIV99
 22395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22396
 22397
 22398     IF PB-CERT-NO NOT = CM-CERT-NO
 22399         GO TO 8730-END-BROWSE.
 22400
 22401     IF PB-ACCOUNT = CM-ACCOUNT
 22402         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22403             MOVE ER-2799        TO WS-ERROR
 22404             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22405             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22406             GO TO 8730-END-BROWSE.
 22407
 22408     GO TO 8710-READ-NEXT.
 22409
 22410 8730-END-BROWSE.
 22411
 22412* EXEC CICS ENDBR
 22413*         DATASET    ('ELCERT5')
 22414*    END-EXEC.
 22415     MOVE 'ELCERT5' TO DFHEIV1
 22416     MOVE 0
 22417       TO DFHEIV11
 22418*    MOVE '&2                    $   #00020856' TO DFHEIV0
 22419     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22420     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 414
* EL050.cbl
 22421     MOVE X'2020233030303230383536' TO DFHEIV0(25:11)
 22422     CALL 'kxdfhei1' USING DFHEIV0,
 22423           DFHEIV1,
 22424           DFHEIV11,
 22425           DFHEIV99
 22426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22427
 22428
 22429 8740-NOT-FOUND.
 22430     GO TO 0299-CERT-NOT-FOUND.
 22431
 22432 8750-START-ELSTAT.
 22433
 22434* EXEC CICS STARTBR
 22435*       DATASET   (STAT-ID)
 22436*       RIDFLD    (ELSTAT-KEY)
 22437*       GTEQ
 22438*       RESP      (WS-RESPONSE)
 22439*    END-EXEC
 22440     MOVE 0
 22441       TO DFHEIV11
 22442*    MOVE '&,         G          &  N#00020864' TO DFHEIV0
 22443     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22444     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22445     MOVE X'204E233030303230383634' TO DFHEIV0(25:11)
 22446     CALL 'kxdfhei1' USING DFHEIV0,
 22447           STAT-ID,
 22448           ELSTAT-KEY,
 22449           DFHEIV99,
 22450           DFHEIV11,
 22451           DFHEIV99
 22452     MOVE EIBRESP  TO WS-RESPONSE
 22453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22454     IF WS-RESP-NORMAL
 22455        MOVE 'Y'                 TO STAT-MASTER-SW
 22456     ELSE
 22457        MOVE 'N'                 TO STAT-MASTER-SW
 22458     END-IF
 22459     .
 22460 8750-EXIT.
 22461     EXIT.
 22462 8752-READ-ELSTAT.
 22463
 22464* EXEC CICS READNEXT
 22465*       DATASET   (STAT-ID)
 22466*       RIDFLD    (ELSTAT-KEY)
 22467*       INTO      (STATE-FILE)
 22468*       RESP      (WS-RESPONSE)
 22469*    END-EXEC
 22470     MOVE LENGTH OF
 22471      STATE-FILE
 22472       TO DFHEIV12
 22473     MOVE 0
 22474       TO DFHEIV11
 22475*    MOVE '&.IL                  )  N#00020879' TO DFHEIV0
 22476     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22477     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22478     MOVE X'204E233030303230383739' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 415
* EL050.cbl
 22479     CALL 'kxdfhei1' USING DFHEIV0,
 22480           STAT-ID,
 22481           STATE-FILE,
 22482           DFHEIV12,
 22483           ELSTAT-KEY,
 22484           DFHEIV99,
 22485           DFHEIV11,
 22486           DFHEIV99,
 22487           DFHEIV99
 22488     MOVE EIBRESP  TO WS-RESPONSE
 22489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22490     IF WS-RESP-NORMAL
 22491        MOVE 'Y'                 TO STAT-MASTER-SW
 22492     ELSE
 22493        MOVE 'N'                 TO STAT-MASTER-SW
 22494     END-IF
 22495     .
 22496 8752-EXIT.
 22497     EXIT.
 22498 8800-GET-COMP-RATE.
 22499     MOVE +1 TO IB.
 22500     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22501         ADD +9 TO IB
 22502         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22503             ADD +9 TO IB
 22504             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22505                MOVE ZEROS       TO WS-WK-RATE
 22506                GO TO 8800-EXIT.
 22507
 22508     IF PB-I-AGE GREATER CT-AGE (1)
 22509         ADD +3 TO IB
 22510         IF PB-I-AGE GREATER CT-AGE (2)
 22511             ADD +3 TO IB
 22512             IF PB-I-AGE GREATER CT-AGE (3)
 22513                MOVE ZEROS       TO WS-WK-RATE
 22514                GO TO 8800-EXIT.
 22515
 22516     IF WS-WORK-TERM GREATER CT-TRM (1)
 22517         ADD +1 TO IB
 22518         IF WS-WORK-TERM GREATER CT-TRM (2)
 22519             ADD +1 TO IB
 22520             IF WS-WORK-TERM GREATER CT-TRM (3)
 22521                MOVE ZEROS       TO WS-WK-RATE
 22522                GO TO 8800-EXIT.
 22523
 22524     IF CT-RT (IB) NOT NUMERIC
 22525         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22526         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22527         GO TO 8800-GET-COMP-RATE.
 22528
 22529     MOVE CT-RT (IB) TO WS-WK-RATE.
 22530
 22531 8800-EXIT.
 22532     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 416
* EL050.cbl
 22534 8900-ADDRESS-FILE.
 22535     IF ERACCT-FILE-ADDRESSED
 22536         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22537         GO TO 8900-ADDRESS-EXIT.
 22538
 22539     IF ELCNTL-FILE-ADDRESSED
 22540         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22541         GO TO 8900-ADDRESS-EXIT.
 22542
 22543     IF ERPLAN-FILE-ADDRESSED
 22544         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22545         GO TO 8900-ADDRESS-EXIT.
 22546
 22547     IF ERFORM-FILE-ADDRESSED
 22548         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22549         GO TO 8900-ADDRESS-EXIT.
 22550
 22551 8900-ADDRESS-EXIT.
 22552     EXIT.
 22553
 22554 9000-READ-CONTROL.
 22555
 22556* EXEC CICS HANDLE CONDITION
 22557*        NOTFND    (9000-NOTFND)
 22558*    END-EXEC.
 22559*    MOVE '"$I                   ! ? #00020950' TO DFHEIV0
 22560     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22562     MOVE X'3F20233030303230393530' TO DFHEIV0(25:11)
 22563     CALL 'kxdfhei1' USING DFHEIV0
 22564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22565
 22566
 22567
 22568* EXEC CICS READ
 22569*        DATASET     (CNTL-ID)
 22570*        SET         (ADDRESS OF CONTROL-FILE)
 22571*        RIDFLD      (ELCNTL-KEY)
 22572*        GTEQ
 22573*    END-EXEC.
 22574*    MOVE '&"S        G          (   #00020954' TO DFHEIV0
 22575     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22576     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22577     MOVE X'2020233030303230393534' TO DFHEIV0(25:11)
 22578     CALL 'kxdfhei1' USING DFHEIV0,
 22579           CNTL-ID,
 22580           DFHEIV20,
 22581           DFHEIV99,
 22582           ELCNTL-KEY,
 22583           DFHEIV99,
 22584           DFHEIV99,
 22585           DFHEIV99
 22586     SET ADDRESS OF CONTROL-FILE TO
 22587         DFHEIV20
 22588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22589
 22590
 22591     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 417
* EL050.cbl
 22592
 22593 9000-NOTFND.
 22594     IF RC-SW-1 = '1'
 22595        MOVE ER-2616              TO WS-ERROR
 22596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22597        GO TO 9000-EXIT.
 22598
 22599     IF RC-SW-1 = '2'
 22600        MOVE ER-2602              TO WS-ERROR
 22601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22602
 22603 9000-EXIT.
 22604      EXIT.
 22605
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 418
* EL050.cbl
 22607 9100-READ-CONTROL.
 22608
 22609* EXEC CICS HANDLE CONDITION
 22610*        NOTFND  (9100-NOTFND)
 22611*        ENDFILE (9100-NOTFND)
 22612*    END-EXEC.
 22613*    MOVE '"$I''                  ! @ #00020978' TO DFHEIV0
 22614     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22616     MOVE X'4020233030303230393738' TO DFHEIV0(25:11)
 22617     CALL 'kxdfhei1' USING DFHEIV0
 22618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22619
 22620
 22621
 22622* EXEC CICS READ
 22623*        DATASET     (CNTL-ID)
 22624*        INTO        (CONTROL-FILE)
 22625*        RIDFLD      (ELCNTL-KEY)
 22626*        GTEQ
 22627*    END-EXEC.
 22628     MOVE LENGTH OF
 22629      CONTROL-FILE
 22630       TO DFHEIV11
 22631*    MOVE '&"IL       G          (   #00020983' TO DFHEIV0
 22632     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22633     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22634     MOVE X'2020233030303230393833' TO DFHEIV0(25:11)
 22635     CALL 'kxdfhei1' USING DFHEIV0,
 22636           CNTL-ID,
 22637           CONTROL-FILE,
 22638           DFHEIV11,
 22639           ELCNTL-KEY,
 22640           DFHEIV99,
 22641           DFHEIV99,
 22642           DFHEIV99
 22643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22644
 22645
 22646     GO TO 9100-EXIT.
 22647
 22648 9100-NOTFND.
 22649     IF RC-SW-2 = '0'
 22650        MOVE '1'                  TO STATE-RECORD-ERROR
 22651        GO TO 9100-EXIT
 22652     END-IF
 22653     IF RC-SW-2 = '1'
 22654        MOVE '1'                  TO LF-BENEFIT-ERROR
 22655        MOVE ER-2604              TO WS-ERROR
 22656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22657        GO TO 9100-EXIT.
 22658
 22659     IF RC-SW-2 = '2'
 22660        MOVE '1'                  TO AH-BENEFIT-ERROR
 22661        MOVE ER-2605              TO WS-ERROR
 22662        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22663        GO TO 9100-EXIT.
 22664
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 419
* EL050.cbl
 22665     IF RC-SW-2 = '3'
 22666         MOVE ER-2603           TO WS-ERROR
 22667         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22668         GO TO 9100-EXIT.
 22669
 22670     IF RC-SW-2 = '4'
 22671         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22672         GO TO 9100-EXIT.
 22673
 22674     IF RC-SW-2 = '5'
 22675         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22676         IF WS-AH-INPUT-CD-1 = SPACE
 22677             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22678         ELSE
 22679             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22680
 22681 9100-EXIT.
 22682      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 420
* EL050.cbl
 22684 9200-CONTROL-GETMAIN.
 22685
 22686* EXEC CICS GETMAIN
 22687*         LENGTH   (750)
 22688*         SET      (ADDRESS OF CONTROL-FILE)
 22689*    END-EXEC.
 22690     MOVE 750
 22691       TO DFHEIV11
 22692*    MOVE '," L                  $   #00021029' TO DFHEIV0
 22693     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22694     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22695     MOVE X'2020233030303231303239' TO DFHEIV0(25:11)
 22696     CALL 'kxdfhei1' USING DFHEIV0,
 22697           DFHEIV20,
 22698           DFHEIV11,
 22699           DFHEIV99
 22700     SET ADDRESS OF CONTROL-FILE TO
 22701         DFHEIV20
 22702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22703
 22704
 22705     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22706
 22707 9200-EXIT.
 22708     EXIT.
 22709
 22710 9250-UNLOCK-RETURN.
 22711
 22712* EXEC CICS UNLOCK
 22713*        DATASET   (CERT-ID)
 22714*    END-EXEC.
 22715*    MOVE '&*                    #   #00021040' TO DFHEIV0
 22716     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22717     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22718     MOVE X'2020233030303231303430' TO DFHEIV0(25:11)
 22719     CALL 'kxdfhei1' USING DFHEIV0,
 22720           CERT-ID,
 22721           DFHEIV99
 22722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22723
 22724
 22725 9300-ABEND.
 22726     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22727
 22728
 22729* EXEC CICS LINK
 22730*        PROGRAM   ('EL004')
 22731*        COMMAREA  (WS-ERROR-LINE)
 22732*        LENGTH    (72)
 22733*    END-EXEC.
 22734     MOVE 'EL004' TO DFHEIV1
 22735     MOVE 72
 22736       TO DFHEIV11
 22737*    MOVE '."C                   (   #00021047' TO DFHEIV0
 22738     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22739     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22740     MOVE X'2020233030303231303437' TO DFHEIV0(25:11)
 22741     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 421
* EL050.cbl
 22742           DFHEIV1,
 22743           WS-ERROR-LINE,
 22744           DFHEIV11,
 22745           DFHEIV99,
 22746           DFHEIV99,
 22747           DFHEIV99,
 22748           DFHEIV99
 22749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22750
 22751
 22752     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22753
 22754
 22755* EXEC CICS ABEND
 22756*        ABCODE ('EL50')
 22757*    END-EXEC.
 22758     MOVE 'EL50' TO DFHEIV5
 22759*    MOVE '.,A                   "   #00021055' TO DFHEIV0
 22760     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22761     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22762     MOVE X'2020233030303231303535' TO DFHEIV0(25:11)
 22763     CALL 'kxdfhei1' USING DFHEIV0,
 22764           DFHEIV5
 22765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22766
 22767
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 422
* EL050.cbl
 22769
 22770******************************************************************
 22771*                                                                *
 22772*            E R R O R   F O R M A T   R O U T I N E             *
 22773*                                                                *
 22774******************************************************************
 22775
 22776 9900-ERROR-FORMAT.
 22777
 22778     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22779                    PB-COMMON-ERROR (2) OR
 22780                    PB-COMMON-ERROR (3) OR
 22781                    PB-COMMON-ERROR (4) OR
 22782                    PB-COMMON-ERROR (5) OR
 22783                    PB-COMMON-ERROR (6) OR
 22784                    PB-COMMON-ERROR (7) OR
 22785                    PB-COMMON-ERROR (8) OR
 22786                    PB-COMMON-ERROR (9) OR
 22787                    PB-COMMON-ERROR (10)
 22788        GO TO 9900-EXIT.
 22789
 22790     IF PB-NO-OF-ERRORS = +10
 22791        GO TO 9900-EXIT.
 22792
 22793     ADD +1  TO PB-NO-OF-ERRORS.
 22794     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22795                                       (PB-NO-OF-ERRORS).
 22796 9900-EXIT.
 22797     EXIT.
 22798
 22799 9990-RETURN.
 22800     IF BROWSE-STARTED
 22801
 22802* EXEC CICS ENDBR
 22803*            DATASET  (ACCT-ID)
 22804*       END-EXEC.
 22805     MOVE 0
 22806       TO DFHEIV11
 22807*    MOVE '&2                    $   #00021092' TO DFHEIV0
 22808     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22809     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22810     MOVE X'2020233030303231303932' TO DFHEIV0(25:11)
 22811     CALL 'kxdfhei1' USING DFHEIV0,
 22812           ACCT-ID,
 22813           DFHEIV11,
 22814           DFHEIV99
 22815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22816
 22817
 22818 9990-EXIT.
 22819     EXIT.
 22820
 22821
 22822****Check for CRTO record, add one if not found.
 22823 9991-CHECK-FOR-ELCRTO.
 22824
 22825* EXEC CICS HANDLE CONDITION
 22826*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 423
* EL050.cbl
 22827*         ENDFILE (9991-CRTO-NOT-FOUND)
 22828*     END-EXEC.
 22829*    MOVE '"$I''                  ! A #00021102' TO DFHEIV0
 22830     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22832     MOVE X'4120233030303231313032' TO DFHEIV0(25:11)
 22833     CALL 'kxdfhei1' USING DFHEIV0
 22834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22835
 22836     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22837     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22838     MOVE +0                     TO ELCRTO-SEQ-NO
 22839
 22840
 22841* EXEC CICS READ
 22842*       DATASET   ('ELCRTO')
 22843*       INTO      (ORIGINAL-CERTIFICATE)
 22844*       RIDFLD    (ELCRTO-KEY)
 22845*       GTEQ
 22846*       RESP      (WS-RESPONSE)
 22847*    END-EXEC
 22848     MOVE LENGTH OF
 22849      ORIGINAL-CERTIFICATE
 22850       TO DFHEIV11
 22851     MOVE 'ELCRTO' TO DFHEIV1
 22852*    MOVE '&"IL       G          (  N#00021110' TO DFHEIV0
 22853     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22854     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22855     MOVE X'204E233030303231313130' TO DFHEIV0(25:11)
 22856     CALL 'kxdfhei1' USING DFHEIV0,
 22857           DFHEIV1,
 22858           ORIGINAL-CERTIFICATE,
 22859           DFHEIV11,
 22860           ELCRTO-KEY,
 22861           DFHEIV99,
 22862           DFHEIV99,
 22863           DFHEIV99
 22864     MOVE EIBRESP  TO WS-RESPONSE
 22865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22866
 22867     IF WS-RESP-NORMAL
 22868        AND (OC-CONTROL-PRIMARY (1:33) =
 22869                 PB-CONTROL-BY-ACCOUNT (1:33))
 22870        AND (OC-RECORD-TYPE =  'I')
 22871           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22872               GO TO 9991-CHECK-INDICATORS
 22873           ELSE
 22874               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22875               GO TO 9991-CRTO-ADD-REC
 22876           END-IF
 22877     END-IF.
 22878
 22879 9991-CRTO-NOT-FOUND.
 22880
 22881     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22882     MOVE 'OC'                TO OC-RECORD-ID
 22883     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22884                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 424
* EL050.cbl
 22885     MOVE +4096               TO OC-KEY-SEQ-NO.
 22886
 22887 9991-CRTO-ADD-REC.
 22888
 22889     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22890     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22891     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22892     MOVE 'I'                 TO OC-RECORD-TYPE
 22893     IF PB-ISSUE
 22894         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22895         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22896         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22897         MOVE PB-I-AGE               TO OC-INS-AGE
 22898         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22899         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22900         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22901         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22902         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22903         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22904         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22905         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22906         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22907         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22908         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22909         IF PB-I-JOINT-COMMISSION > +0
 22910             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22911         ELSE
 22912             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22913         END-IF
 22914         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22915         MOVE +0                     TO OC-LF-CANCEL-AMT
 22916                                        OC-LF-ITD-CANCEL-AMT
 22917         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22918         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22919         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22920         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22921         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22922         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22923         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22924         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22925         MOVE +0                     TO OC-AH-CANCEL-AMT
 22926                                        OC-AH-ITD-CANCEL-AMT
 22927         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22928         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22929         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22930     ELSE
 22931         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22932         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22933         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22934         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22935         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22936         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22937         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22938         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22939         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22940          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22941             MOVE SPACES             TO OC-LF-BENCD
 22942             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 425
* EL050.cbl
 22943                                        OC-LF-BEN-AMT
 22944                                        OC-LF-PRM-AMT
 22945                                        OC-LF-ALT-BEN-AMT
 22946                                        OC-LF-ALT-PRM-AMT
 22947                                        OC-LF-COMM-PCT
 22948                                        OC-LF-CANCEL-AMT
 22949             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22950             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22951         ELSE
 22952             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22953             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22954             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22955             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22956             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22957             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22958             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22959             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22960             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22961             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22962         END-IF
 22963         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22964         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22965          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22966             MOVE SPACES             TO OC-AH-BENCD
 22967             MOVE ZEROS              TO OC-AH-TERM
 22968                                        OC-AH-BEN-AMT
 22969                                        OC-AH-PRM-AMT
 22970                                        OC-AH-COMM-PCT
 22971                                        OC-AH-CANCEL-AMT
 22972                                        OC-AH-CP
 22973             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22974             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22975         ELSE
 22976             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22977             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22978             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22979             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22980             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22981             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22982             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22983             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22984             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22985         END-IF
 22986         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22987         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22988         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22989         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22990     END-IF
 22991     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22992
 22993     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22994
 22995
 22996* EXEC CICS READ
 22997*         DATASET   (FILE-ERMAIL)
 22998*         RIDFLD    (MA-CONTROL-PRIMARY)
 22999*         INTO      (MAILING-DATA)
 23000*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 426
* EL050.cbl
 23001*    END-EXEC
 23002     MOVE LENGTH OF
 23003      MAILING-DATA
 23004       TO DFHEIV11
 23005*    MOVE '&"IL       E          (  N#00021246' TO DFHEIV0
 23006     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23008     MOVE X'204E233030303231323436' TO DFHEIV0(25:11)
 23009     CALL 'kxdfhei1' USING DFHEIV0,
 23010           FILE-ERMAIL,
 23011           MAILING-DATA,
 23012           DFHEIV11,
 23013           MA-CONTROL-PRIMARY,
 23014           DFHEIV99,
 23015           DFHEIV99,
 23016           DFHEIV99
 23017     MOVE EIBRESP  TO WS-RESPONSE
 23018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23019
 23020     IF WS-RESP-NORMAL
 23021         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23022     END-IF.
 23023
 23024     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23025     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23026
 23027
 23028* EXEC CICS READ
 23029*         DATASET  (CRTT-ID)
 23030*         RIDFLD   (WS-ELCRTT-KEY)
 23031*         INTO     (CERTIFICATE-TRAILERS)
 23032*         RESP     (WS-RESPONSE)
 23033*    END-EXEC
 23034     MOVE LENGTH OF
 23035      CERTIFICATE-TRAILERS
 23036       TO DFHEIV11
 23037*    MOVE '&"IL       E          (  N#00021260' TO DFHEIV0
 23038     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23039     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23040     MOVE X'204E233030303231323630' TO DFHEIV0(25:11)
 23041     CALL 'kxdfhei1' USING DFHEIV0,
 23042           CRTT-ID,
 23043           CERTIFICATE-TRAILERS,
 23044           DFHEIV11,
 23045           WS-ELCRTT-KEY,
 23046           DFHEIV99,
 23047           DFHEIV99,
 23048           DFHEIV99
 23049     MOVE EIBRESP  TO WS-RESPONSE
 23050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23051
 23052     IF WS-RESP-NORMAL
 23053         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 23054         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 23055     END-IF.
 23056
 23057
 23058* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 427
* EL050.cbl
 23059*       DATASET   ('ELCRTO')
 23060*       FROM      (ORIGINAL-CERTIFICATE)
 23061*       RIDFLD    (OC-CONTROL-PRIMARY)
 23062*       RESP      (WS-RESPONSE)
 23063*    END-EXEC.
 23064     MOVE LENGTH OF
 23065      ORIGINAL-CERTIFICATE
 23066       TO DFHEIV11
 23067     MOVE 'ELCRTO' TO DFHEIV1
 23068*    MOVE '&$ L                  ''  N#00021272' TO DFHEIV0
 23069     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 23070     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23071     MOVE X'204E233030303231323732' TO DFHEIV0(25:11)
 23072     CALL 'kxdfhei1' USING DFHEIV0,
 23073           DFHEIV1,
 23074           ORIGINAL-CERTIFICATE,
 23075           DFHEIV11,
 23076           OC-CONTROL-PRIMARY,
 23077           DFHEIV99,
 23078           DFHEIV99
 23079     MOVE EIBRESP  TO WS-RESPONSE
 23080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23081
 23082
 23083     GO TO 9991-EXIT.
 23084
 23085 9991-CHECK-INDICATORS.
 23086
 23087     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 23088         GO TO 9991-EXIT
 23089     END-IF.
 23090
 23091     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 23092         GO TO 9991-EXIT
 23093     END-IF.
 23094
 23095
 23096* EXEC CICS READ
 23097*       DATASET   ('ELCRTO')
 23098*       INTO      (ORIGINAL-CERTIFICATE)
 23099*       RIDFLD    (OC-CONTROL-PRIMARY)
 23100*       UPDATE
 23101*       RESP      (WS-RESPONSE)
 23102*    END-EXEC
 23103     MOVE LENGTH OF
 23104      ORIGINAL-CERTIFICATE
 23105       TO DFHEIV11
 23106     MOVE 'ELCRTO' TO DFHEIV1
 23107*    MOVE '&"IL       EU         (  N#00021291' TO DFHEIV0
 23108     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23109     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23110     MOVE X'204E233030303231323931' TO DFHEIV0(25:11)
 23111     CALL 'kxdfhei1' USING DFHEIV0,
 23112           DFHEIV1,
 23113           ORIGINAL-CERTIFICATE,
 23114           DFHEIV11,
 23115           OC-CONTROL-PRIMARY,
 23116           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 428
* EL050.cbl
 23117           DFHEIV99,
 23118           DFHEIV99
 23119     MOVE EIBRESP  TO WS-RESPONSE
 23120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23121     IF WS-RESP-NORMAL
 23122        IF PB-ISSUE
 23123          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 23124          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 23125          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 23126          MOVE PB-I-AGE               TO OC-INS-AGE
 23127          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 23128          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 23129          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 23130          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 23131          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 23132          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 23133          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 23134          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 23135          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 23136          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 23137          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 23138          IF PB-I-JOINT-COMMISSION > +0
 23139              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 23140          ELSE
 23141              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 23142          END-IF
 23143          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 23144          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 23145          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 23146          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 23147          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 23148          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 23149          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 23150          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 23151          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 23152
 23153          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 23154
 23155* EXEC CICS READ
 23156*             DATASET   (FILE-ERMAIL)
 23157*             RIDFLD    (MA-CONTROL-PRIMARY)
 23158*             INTO      (MAILING-DATA)
 23159*             RESP      (WS-RESPONSE)
 23160*         END-EXEC
 23161     MOVE LENGTH OF
 23162      MAILING-DATA
 23163       TO DFHEIV11
 23164*    MOVE '&"IL       E          (  N#00021331' TO DFHEIV0
 23165     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23167     MOVE X'204E233030303231333331' TO DFHEIV0(25:11)
 23168     CALL 'kxdfhei1' USING DFHEIV0,
 23169           FILE-ERMAIL,
 23170           MAILING-DATA,
 23171           DFHEIV11,
 23172           MA-CONTROL-PRIMARY,
 23173           DFHEIV99,
 23174           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 429
* EL050.cbl
 23175           DFHEIV99
 23176     MOVE EIBRESP  TO WS-RESPONSE
 23177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23178          IF WS-RESP-NORMAL
 23179             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23180          END-IF
 23181
 23182          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23183          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23184
 23185* EXEC CICS READ
 23186*             DATASET  (CRTT-ID)
 23187*             RIDFLD   (WS-ELCRTT-KEY)
 23188*             INTO     (CERTIFICATE-TRAILERS)
 23189*             RESP     (WS-RESPONSE)
 23190*         END-EXEC
 23191     MOVE LENGTH OF
 23192      CERTIFICATE-TRAILERS
 23193       TO DFHEIV11
 23194*    MOVE '&"IL       E          (  N#00021343' TO DFHEIV0
 23195     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23196     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23197     MOVE X'204E233030303231333433' TO DFHEIV0(25:11)
 23198     CALL 'kxdfhei1' USING DFHEIV0,
 23199           CRTT-ID,
 23200           CERTIFICATE-TRAILERS,
 23201           DFHEIV11,
 23202           WS-ELCRTT-KEY,
 23203           DFHEIV99,
 23204           DFHEIV99,
 23205           DFHEIV99
 23206     MOVE EIBRESP  TO WS-RESPONSE
 23207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23208          IF WS-RESP-NORMAL
 23209             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 23210                               OC-INS-AGE-DEFAULT-FLAG
 23211             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 23212                               OC-JNT-AGE-DEFAULT-FLAG
 23213          END-IF
 23214
 23215        ELSE
 23216          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23217             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 23218             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 23219             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 23220          END-IF
 23221          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23222             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 23223             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 23224             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 23225          END-IF
 23226          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 23227        END-IF
 23228
 23229* EXEC CICS REWRITE
 23230*          DATASET   ('ELCRTO')
 23231*          FROM      (ORIGINAL-CERTIFICATE)
 23232*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 430
* EL050.cbl
 23233*       END-EXEC
 23234     MOVE LENGTH OF
 23235      ORIGINAL-CERTIFICATE
 23236       TO DFHEIV11
 23237     MOVE 'ELCRTO' TO DFHEIV1
 23238*    MOVE '&& L                  %  N#00021369' TO DFHEIV0
 23239     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23240     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23241     MOVE X'204E233030303231333639' TO DFHEIV0(25:11)
 23242     CALL 'kxdfhei1' USING DFHEIV0,
 23243           DFHEIV1,
 23244           ORIGINAL-CERTIFICATE,
 23245           DFHEIV11,
 23246           DFHEIV99
 23247     MOVE EIBRESP  TO WS-RESPONSE
 23248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23249     END-IF.
 23250
 23251 9991-EXIT.
 23252     EXIT.
 23253
 23254
 23255 9999-RETURN.
 23256     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23257
 23258
 23259* EXEC CICS RETURN
 23260*    END-EXEC.
 23261*    MOVE '.(                    ''   #00021383' TO DFHEIV0
 23262     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23263     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23264     MOVE X'2020233030303231333833' TO DFHEIV0(25:11)
 23265     CALL 'kxdfhei1' USING DFHEIV0,
 23266           DFHEIV99,
 23267           DFHEIV99,
 23268           DFHEIV99,
 23269           DFHEIV99,
 23270           DFHEIV99,
 23271           DFHEIV99
 23272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23273
 23274
 23275
 23276* GOBACK.
 23277     MOVE '9%                    "   ' TO DFHEIV0
 23278     MOVE 'EL050' TO DFHEIV1
 23279     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23280     GOBACK.
 23281
 23282 9999-DFHBACK SECTION.
 23283     MOVE '9%                    "   ' TO DFHEIV0
 23284     MOVE 'EL050' TO DFHEIV1
 23285     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23286     GOBACK.
 23287 9999-DFHEXIT.
 23288     IF DFHEIGDJ EQUAL 0001
 23289         NEXT SENTENCE
 23290     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 431
* EL050.cbl
 23291         GO TO 9300-ABEND,
 23292               3990-FILES-NOT-OPEN
 23293         DEPENDING ON DFHEIGDI
 23294     ELSE IF DFHEIGDJ EQUAL 3
 23295         GO TO 6610-START-BROWSE,
 23296               6630-ERRESS-PROBLEM,
 23297               6630-END-OF-FILE
 23298         DEPENDING ON DFHEIGDI
 23299     ELSE IF DFHEIGDJ EQUAL 4
 23300         GO TO 6630-END-OF-FILE,
 23301               6630-ERRESS-PROBLEM,
 23302               6630-ERRESS-PROBLEM,
 23303               6630-END-OF-FILE
 23304         DEPENDING ON DFHEIGDI
 23305     ELSE IF DFHEIGDJ EQUAL 5
 23306         GO TO 6630-END-OF-FILE,
 23307               6630-END-OF-FILE,
 23308               6630-ERRESS-PROBLEM,
 23309               6630-ERRESS-PROBLEM
 23310         DEPENDING ON DFHEIGDI
 23311     ELSE IF DFHEIGDJ EQUAL 6
 23312         GO TO 6660-START-BROWSE,
 23313               6690-ERRESC-PROBLEM,
 23314               6690-ERRESC-PROBLEM,
 23315               6690-END-OF-FILE
 23316         DEPENDING ON DFHEIGDI
 23317     ELSE IF DFHEIGDJ EQUAL 7
 23318         GO TO 6690-END-OF-FILE,
 23319               6690-ERRESC-PROBLEM,
 23320               6690-ERRESC-PROBLEM,
 23321               6690-END-OF-FILE
 23322         DEPENDING ON DFHEIGDI
 23323     ELSE IF DFHEIGDJ EQUAL 8
 23324         GO TO 6690-END-OF-FILE,
 23325               6690-ERRESC-PROBLEM,
 23326               6690-ERRESC-PROBLEM,
 23327               6690-END-OF-FILE
 23328         DEPENDING ON DFHEIGDI
 23329     ELSE IF DFHEIGDJ EQUAL 9
 23330         GO TO 7250-CONTINUE,
 23331               7250-CONTINUE
 23332         DEPENDING ON DFHEIGDI
 23333     ELSE IF DFHEIGDJ EQUAL 10
 23334         GO TO 7300-CONTINUE,
 23335               7300-CONTINUE
 23336         DEPENDING ON DFHEIGDI
 23337     ELSE IF DFHEIGDJ EQUAL 11
 23338         GO TO 7320-CONTINUE,
 23339               7320-CONTINUE
 23340         DEPENDING ON DFHEIGDI
 23341     ELSE IF DFHEIGDJ EQUAL 12
 23342         GO TO 8000-FREE-MAIN
 23343         DEPENDING ON DFHEIGDI
 23344     ELSE IF DFHEIGDJ EQUAL 13
 23345         GO TO 8100-NOTFND,
 23346               8100-NOTFND
 23347         DEPENDING ON DFHEIGDI
 23348     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 432
* EL050.cbl
 23349         GO TO 8110-NOTFND,
 23350               8110-NOTFND
 23351         DEPENDING ON DFHEIGDI
 23352     ELSE IF DFHEIGDJ EQUAL 15
 23353         GO TO 8130-EXIT
 23354         DEPENDING ON DFHEIGDI
 23355     ELSE IF DFHEIGDJ EQUAL 16
 23356         GO TO 8145-exit
 23357         DEPENDING ON DFHEIGDI
 23358     ELSE IF DFHEIGDJ EQUAL 17
 23359         GO TO 8190-NOTFND
 23360         DEPENDING ON DFHEIGDI
 23361     ELSE IF DFHEIGDJ EQUAL 18
 23362         GO TO 8195-NOTFND
 23363         DEPENDING ON DFHEIGDI
 23364     ELSE IF DFHEIGDJ EQUAL 19
 23365         GO TO 8200-NOTFND
 23366         DEPENDING ON DFHEIGDI
 23367     ELSE IF DFHEIGDJ EQUAL 20
 23368         GO TO 8300-NOTFND,
 23369               8300-ERRESS-PROBLEM,
 23370               8300-ERRESS-PROBLEM,
 23371               8300-NOTFND
 23372         DEPENDING ON DFHEIGDI
 23373     ELSE IF DFHEIGDJ EQUAL 21
 23374         GO TO 8450-FORM-NOT-FOUND,
 23375               8450-FORM-NOT-FOUND
 23376         DEPENDING ON DFHEIGDI
 23377     ELSE IF DFHEIGDJ EQUAL 22
 23378         GO TO 0199-ACCT-NOT-FOUND,
 23379               0199-ACCT-NOT-FOUND
 23380         DEPENDING ON DFHEIGDI
 23381     ELSE IF DFHEIGDJ EQUAL 23
 23382         GO TO 0199-ACCT-NOT-FOUND,
 23383               0199-ACCT-NOT-FOUND
 23384         DEPENDING ON DFHEIGDI
 23385     ELSE IF DFHEIGDJ EQUAL 24
 23386         GO TO 8582-COMP-NOT-FOUND,
 23387               8582-COMP-NOT-FOUND
 23388         DEPENDING ON DFHEIGDI
 23389     ELSE IF DFHEIGDJ EQUAL 25
 23390         GO TO 8583-AGTC-NOT-FOUND,
 23391               8583-AGTC-NOT-FOUND
 23392         DEPENDING ON DFHEIGDI
 23393     ELSE IF DFHEIGDJ EQUAL 26
 23394         GO TO 8584-BXRF-NOT-FOUND,
 23395               8584-BXRF-NOT-FOUND
 23396         DEPENDING ON DFHEIGDI
 23397     ELSE IF DFHEIGDJ EQUAL 27
 23398         GO TO 8585-PLAN-NOT-FOUND,
 23399               8585-PLAN-NOT-FOUND
 23400         DEPENDING ON DFHEIGDI
 23401     ELSE IF DFHEIGDJ EQUAL 28
 23402         GO TO 0299-CERT-NOT-FOUND
 23403         DEPENDING ON DFHEIGDI
 23404     ELSE IF DFHEIGDJ EQUAL 29
 23405         GO TO 8700-READ-CERT-MASTER
 23406         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:05 Page 433
* EL050.cbl
 23407     ELSE IF DFHEIGDJ EQUAL 30
 23408         GO TO 8720-COMP-ACCOUNTS,
 23409               8730-END-BROWSE,
 23410               8740-NOT-FOUND
 23411         DEPENDING ON DFHEIGDI
 23412     ELSE IF DFHEIGDJ EQUAL 31
 23413         GO TO 9000-NOTFND
 23414         DEPENDING ON DFHEIGDI
 23415     ELSE IF DFHEIGDJ EQUAL 32
 23416         GO TO 9100-NOTFND,
 23417               9100-NOTFND
 23418         DEPENDING ON DFHEIGDI
 23419     ELSE IF DFHEIGDJ EQUAL 33
 23420         GO TO 9991-CRTO-NOT-FOUND,
 23421               9991-CRTO-NOT-FOUND
 23422         DEPENDING ON DFHEIGDI.
 23423     MOVE '9%                    "   ' TO DFHEIV0
 23424     MOVE 'EL050' TO DFHEIV1
 23425     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23426     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41848     Code:       96225
