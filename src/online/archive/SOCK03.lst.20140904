* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48******************************************************************
    49 environment division.
    50 data division.
    51 working-storage section.
    52 01  DFH-START PIC X(04).
    53*
    54* program buffers
    55*
    56 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    57     88  ALREADY-SENT              VALUE 'Y'.
    58 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    59 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    60     88  ELCERT-FINISHED            VALUE 'Y'.
    61 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    62 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    63     88  ERACCT-FOUND               VALUE 'Y'.
    64 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    65 77 ws-send-msg-size           pic s9(8) comp value 4096.
    66 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    67 77 ws-recv-buf                pic x(4096).
    68 77 ws-send-buf                pic x(4096) VALUE SPACES.
    69 77 ws-recv-total              pic s9(8) comp value 0.
    70 77 ws-recv-left               pic s9(8) comp value 0.
    71 77 ws-seq-num                 pic s9(8) comp value 0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page   3
* SOCK03.cbl
    72 77 ws-flags                   pic s9(8) comp value 0.
    73 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    74 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    75 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    76 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    77 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    78 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    79 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    80 77  ws-cancel-reason            pic x   value spaces.
    81 77  P1                          PIC S999 COMP-3 VALUE +0.
    82 77  P2                          PIC S999 COMP-3 VALUE +0.
    83 77  C0                          PIC S999 COMP-3 VALUE +0.
    84 77  C1                          PIC S999 COMP-3 VALUE +0.
    85 77  C2                          PIC S999 COMP-3 VALUE +0.
    86 77  C3                          PIC S999 COMP-3 VALUE +0.
    87 77 S1                           PIC S999 COMP-3 VALUE +0.
    88 77 S2                           PIC S999 COMP-3 VALUE +0.
    89 77 L1                           PIC S999 COMP-3 VALUE +0.
    90 77 L2                           PIC S999 COMP-3 VALUE +0.
    91 77 F1                           PIC S999 COMP-3 VALUE +0.
    92 77 WS-BUILD-SW                  PIC X.
    93    88  TIME-TO-BUILD               VALUE 'Y'.
    94 77 WS-SAVE-ERACCT               PIC X(2000).
    95 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    96 77 WS-STOP-SW                   PIC X  VALUE ' '.
    97    88  TOLD-TO-STOP               VALUE 'Y'.
    98 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    99    88  GET-RATES                    VALUE 'R'.
   100    88  GET-ACT-ACCTS                VALUE 'A'.
   101 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   102 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   103 77 ws-disp-rate                 pic z9.99999.
   104 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   105     88  END-OF-ERCTBL                 VALUE 'Y'.
   106 77  WS-STATUS                   PIC X.
   107 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   108 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   109 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   110 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   111 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   112 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   113 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   114 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   115 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   116 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   117 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   118 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   119     88  WS-ELCERT-FULL             VALUE '1'.
   120     88  WS-ELCERT-NAME             VALUE '2'.
   121     88  WS-ELCERT-CERT-NO          VALUE '3'.
   122     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   123 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   124 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   125     88  I-SAY-TO-STOP      VALUE 'Y'.
   126 77  WS-HEX-0A                   PIC X.
   127 77  WS-CALL-TYPE                PIC X(6).
   128 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   129 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page   4
* SOCK03.cbl
   130 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   131 77  DD-IU-SW                    PIC X   VALUE ' '.
   132     88  DD-IU-PRESENT                 VALUE 'Y'.
   133 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   134 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   135 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   136 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   137 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   138 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   139 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   140 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   141 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   142     88  PDEF-FOUND                              VALUE 'Y'.
   143 01  WS-STRING-DATA.
   144     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   145     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   146     05  WS-CARRIER              PIC X        VALUE SPACES.
   147     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   148     05  WS-STATE                PIC XX       VALUE SPACES.
   149     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   150     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   151     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   152     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   153     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   154     05  WS-MID-INIT             PIC X        VALUE SPACES.
   155     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   156     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   157     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   158     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   159     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   160     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   161     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   162     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   163     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   164     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   165     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   166     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   167     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   168     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   169     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   170     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   171     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   172     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   173     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   174     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   175     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   176     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   177     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   178     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   179     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   180     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   181     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   182     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   183     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   184     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   185     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   186     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   187     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page   5
* SOCK03.cbl
   188     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   189     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   190     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   191     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   192     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   193     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   194 01  ws-work-date.
   195     05  ws-work-ccyy            pic x(4).
   196     05  ws-work-mm              pic xx.
   197     05  ws-work-dd              pic xx.
   198 01  ws-work-date-num redefines ws-work-date
   199                                 pic 9(8).
   200 01  FILLER.
   201     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   202     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   203     12  WS-STATE-ABBREVIATION   PIC XX.
   204     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   205     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   206     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   207     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   208     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   209     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   210     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   211     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   212     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   213     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   214     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   215     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   216     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   217     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   218     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   219     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   220     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   221     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   222     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   223     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   224     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   225     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   226     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   227     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   228     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   229     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   230         88  WS-REDUCING                         VALUE 'R'.
   231         88  WS-LEVEL                            VALUE 'L'  'P'.
   232 01  ELMSTR-KEY.
   233     12  ELMSTR-COMP-CD          PIC X.
   234     12  ELMSTR-CERT-NO          PIC X(11).
   235 01  CTBL-KEY-SAVE               PIC X(5).
   236 01  CTBL-KEY.
   237     05  CTBL-COMPANY-CD         PIC X.
   238     05  CTBL-TABLE              PIC XXX.
   239     05  CTBL-BEN-TYPE           PIC X.
   240     05  CTBL-BEN-CODE           PIC XX.
   241 01  ERPDEF-KEY-SAVE             PIC X(18).
   242 01  ERPDEF-KEY.
   243     12  ERPDEF-COMPANY-CD       PIC X.
   244     12  ERPDEF-STATE            PIC XX.
   245     12  ERPDEF-PROD-CD          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page   6
* SOCK03.cbl
   246     12  F                       PIC X(7).
   247     12  ERPDEF-BEN-TYPE         PIC X.
   248     12  ERPDEF-BEN-CODE         PIC XX.
   249     12  ERPDEF-EXP-DT           PIC XX.
   250 01  WS-AM3-KEY.
   251     12  WS-AM3-ACCOUNT          PIC X(10).
   252     12  WS-AM3-EXP-DT           PIC XX.
   253 01  WS-AM-KEY.
   254     12  WS-AM-COMPANY-CD        PIC X.
   255     12  WS-AM-CARRIER           PIC X.
   256     12  WS-AM-GROUPING          PIC X(6).
   257     12  WS-AM-STATE             PIC XX.
   258     12  WS-AM-ACCOUNT           PIC X(10).
   259     12  WS-AM-EXPIRATION-DT     PIC XX.
   260     12  WS-AM-FILLER            PIC XXXX.
   261 01  WS-CO-DATA.
   262     05  WS-CO-NUM               PIC X(10).
   263     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   264     05  WS-CO-NAME              PIC X(30).
   265     05  WS-CO-MAIL-NAME         PIC X(30).
   266     05  WS-CO-ADDR1             PIC X(30).
   267     05  WS-CO-ADDR2             PIC X(30).
   268     05  WS-CO-ADDR3             PIC X(30).
   269     05  WS-CO-ZIP               PIC X(9).
   270     05  WS-CO-PHONE             PIC X(10).
   271 01  WS-CF-KEY.
   272     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   273     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   274*        88  COMPANY-MASTER                      VALUE '1'.
   275*        88  STATE-MASTER                        VALUE '3'.
   276*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   277*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   278     12  WS-CF-ACCESS.
   279         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   280         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   281             20  FILLER          PIC  X(01).
   282             20  WS-CF-CARRIER   PIC  X(01).
   283     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   284 01  WS-CM-KEY.
   285     05  WS-CM-COMPANY-CD        PIC X.
   286     05  WS-CM-CARRIER           PIC X.
   287     05  WS-CM-GROUP             PIC X(6).
   288     05  WS-CM-STATE             PIC XX.
   289     05  WS-CM-ACCOUNT           PIC X(10).
   290     05  WS-CM-EFF-DT            PIC XX.
   291     05  WS-CM-CERT-NO           PIC X(11).
   292 01  WS-CM-KEY-A1.
   293     05  WS-CM-COMPANY-CD-A1     PIC X.
   294     05  WS-CM-LAST-NAME         PIC X(15).
   295     05  WS-CM-INITIALS          PIC XX.
   296 01  WS-CM-KEY-A4.
   297     05  WS-CM-COMPANY-CD-A4     PIC X.
   298     05  WS-CM-CERT-NO-A4        PIC X(11).
   299 01  WS-CID-NO                   PIC X(8).
   300 01  WS-DISP-RESP                PIC 9(5).
   301 01  WS-RESPONSE                 PIC S9(8)   COMP.
   302     88  RESP-NORMAL                  VALUE +00.
   303     88  RESP-NOTFND                  VALUE +13.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page   7
* SOCK03.cbl
   304     88  RESP-DUPKEY                  VALUE +15.
   305     88  RESP-NOTOPEN                 VALUE +19.
   306     88  RESP-ENDFILE                 VALUE +20.
   307*                                 COPY ELCCERT.
   308******************************************************************
   309*                                                                *
   310*                            ELCCERT.                            *
   311*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   312*                            VMOD=2.013                          *
   313*                                                                *
   314*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   315*                                                                *
   316*   FILE TYPE = VSAM,KSDS                                        *
   317*   RECORD SIZE = 450  RECFORM = FIXED                           *
   318*                                                                *
   319*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   320*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   321*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   322*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   323*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   324*                                                                *
   325*   LOG = YES                                                    *
   326*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   327******************************************************************
   328*                   C H A N G E   L O G
   329*
   330* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   331*-----------------------------------------------------------------
   332*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   333* EFFECTIVE    NUMBER
   334*-----------------------------------------------------------------
   335* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   336* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   337* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   338* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   339* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   340* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   341* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   342* 032612  CR2011110200001  PEMA  AHL CHANGES
   343******************************************************************
   344
   345 01  CERTIFICATE-MASTER.
   346     12  CM-RECORD-ID                      PIC XX.
   347         88  VALID-CM-ID                      VALUE 'CM'.
   348
   349     12  CM-CONTROL-PRIMARY.
   350         16  CM-COMPANY-CD                 PIC X.
   351         16  CM-CARRIER                    PIC X.
   352         16  CM-GROUPING.
   353             20  CM-GROUPING-PREFIX        PIC X(3).
   354             20  CM-GROUPING-PRIME         PIC X(3).
   355         16  CM-STATE                      PIC XX.
   356         16  CM-ACCOUNT.
   357             20  CM-ACCOUNT-PREFIX         PIC X(4).
   358             20  CM-ACCOUNT-PRIME          PIC X(6).
   359         16  CM-CERT-EFF-DT                PIC XX.
   360         16  CM-CERT-NO.
   361             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page   8
* SOCK03.cbl
   362             20  CM-CERT-SFX               PIC X.
   363
   364     12  CM-CONTROL-BY-NAME.
   365         16  CM-COMPANY-CD-A1              PIC X.
   366         16  CM-INSURED-LAST-NAME          PIC X(15).
   367         16  CM-INSURED-INITIALS.
   368             20  CM-INSURED-INITIAL1       PIC X.
   369             20  CM-INSURED-INITIAL2       PIC X.
   370
   371     12  CM-CONTROL-BY-SSN.
   372         16  CM-COMPANY-CD-A2              PIC X.
   373         16  CM-SOC-SEC-NO.
   374             20  CM-SSN-STATE              PIC XX.
   375             20  CM-SSN-ACCOUNT            PIC X(6).
   376             20  CM-SSN-LN3.
   377                 25  CM-INSURED-INITIALS-A2.
   378                     30 CM-INSURED-INITIAL1-A2   PIC X.
   379                     30 CM-INSURED-INITIAL2-A2   PIC X.
   380                 25 CM-PART-LAST-NAME-A2         PIC X.
   381
   382     12  CM-CONTROL-BY-CERT-NO.
   383         16  CM-COMPANY-CD-A4              PIC X.
   384         16  CM-CERT-NO-A4                 PIC X(11).
   385
   386     12  CM-CONTROL-BY-MEMB.
   387         16  CM-COMPANY-CD-A5              PIC X.
   388         16  CM-MEMBER-NO.
   389             20  CM-MEMB-STATE             PIC XX.
   390             20  CM-MEMB-ACCOUNT           PIC X(6).
   391             20  CM-MEMB-LN4.
   392                 25  CM-INSURED-INITIALS-A5.
   393                     30 CM-INSURED-INITIAL1-A5   PIC X.
   394                     30 CM-INSURED-INITIAL2-A5   PIC X.
   395                 25 CM-PART-LAST-NAME-A5         PIC XX.
   396
   397     12  CM-INSURED-PROFILE-DATA.
   398         16  CM-INSURED-FIRST-NAME.
   399             20  CM-INSURED-1ST-INIT       PIC X.
   400             20  FILLER                    PIC X(9).
   401         16  CM-INSURED-ISSUE-AGE          PIC 99.
   402         16  CM-INSURED-SEX                PIC X.
   403             88  CM-SEX-MALE                  VALUE 'M'.
   404             88  CM-SEX-FEMAL                 VALUE 'F'.
   405         16  CM-INSURED-JOINT-AGE          PIC 99.
   406         16  CM-JOINT-INSURED-NAME.
   407             20  CM-JT-LAST-NAME           PIC X(15).
   408             20  CM-JT-FIRST-NAME.
   409                 24  CM-JT-1ST-INIT        PIC X.
   410                 24  FILLER                PIC X(9).
   411             20  CM-JT-INITIAL             PIC X.
   412
   413     12  CM-LIFE-DATA.
   414         16  CM-LF-BENEFIT-CD              PIC XX.
   415         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   416         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   417         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   418         16  CM-LF-DEV-CODE                PIC XXX.
   419         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page   9
* SOCK03.cbl
   420         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   421         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   422         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   423         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   424         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   425         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   426         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   427         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   428         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   429         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   430         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   431         16  FILLER                        PIC XX.
   432
   433     12  CM-AH-DATA.
   434         16  CM-AH-BENEFIT-CD              PIC XX.
   435         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   436         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   437         16  CM-AH-DEV-CODE                PIC XXX.
   438         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   439         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   440         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   441         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   442         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   443         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   444         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   445         16  CM-AH-PAID-THRU-DT            PIC XX.
   446             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   447         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   448         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   449         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   450         16  FILLER                        PIC X.
   451
   452     12  CM-LOAN-INFORMATION.
   453         16  CM-LIVES                      PIC S9(7)     COMP-3.
   454         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   455                                           PIC S9(5)V99  COMP-3.
   456         16  CM-BILLED                     PIC S9(7)     COMP-3.
   457         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   458         16  CM-PAY-FREQUENCY              PIC S99.
   459         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   460         16  CM-RATE-CLASS                 PIC XX.
   461         16  CM-BENEFICIARY                PIC X(25).
   462         16  CM-POLICY-FORM-NO             PIC X(12).
   463         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   464         16  CM-LAST-ADD-ON-DT             PIC XX.
   465         16  CM-DEDUCTIBLE-AMOUNTS.
   466             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   467             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   468         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   469             20  CM-RESIDENT-STATE         PIC XX.
   470             20  CM-RATE-CODE              PIC X(4).
   471             20  FILLER                    PIC XX.
   472         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   473             20  CM-LOAN-OFFICER           PIC X(5).
   474             20  FILLER                    PIC XXX.
   475         16  CM-CSR-CODE                   PIC XXX.
   476         16  CM-UNDERWRITING-CODE          PIC X.
   477             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  10
* SOCK03.cbl
   478         16  CM-POST-CARD-IND              PIC X.
   479         16  CM-NH-INTERFACE-SW            PIC X.
   480         16  CM-PREMIUM-TYPE               PIC X.
   481             88  CM-SING-PRM                  VALUE '1'.
   482             88  CM-O-B-COVERAGE              VALUE '2'.
   483             88  CM-OPEN-END                  VALUE '3'.
   484         16  CM-IND-GRP-TYPE               PIC X.
   485             88  CM-INDIVIDUAL                VALUE 'I'.
   486             88  CM-GROUP                     VALUE 'G'.
   487         16  CM-SKIP-CODE                  PIC X.
   488             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   489             88  SKIP-JULY                    VALUE '1'.
   490             88  SKIP-AUGUST                  VALUE '2'.
   491             88  SKIP-SEPTEMBER               VALUE '3'.
   492             88  SKIP-JULY-AUG                VALUE '4'.
   493             88  SKIP-AUG-SEPT                VALUE '5'.
   494             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   495             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   496             88  SKIP-JUNE                    VALUE '8'.
   497             88  SKIP-JUNE-JULY               VALUE '9'.
   498             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   499             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   500         16  CM-PAYMENT-MODE               PIC X.
   501             88  PAY-MONTHLY                  VALUE SPACE.
   502             88  PAY-WEEKLY                   VALUE '1'.
   503             88  PAY-SEMI-MONTHLY             VALUE '2'.
   504             88  PAY-BI-WEEKLY                VALUE '3'.
   505             88  PAY-SEMI-ANUALLY             VALUE '4'.
   506         16  CM-LOAN-NUMBER                PIC X(8).
   507         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   508         16  CM-OLD-LOF                    PIC XXX.
   509*        16  CM-LOAN-OFFICER               PIC XXX.
   510         16  CM-REIN-TABLE                 PIC XXX.
   511         16  CM-SPECIAL-REIN-CODE          PIC X.
   512         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   513         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   514         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   515
   516     12  CM-STATUS-DATA.
   517         16  CM-ENTRY-STATUS               PIC X.
   518         16  CM-ENTRY-DT                   PIC XX.
   519
   520         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   521         16  CM-LF-CANCEL-DT               PIC XX.
   522         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   523
   524         16  CM-LF-STATUS-AT-DEATH         PIC X.
   525         16  CM-LF-DEATH-DT                PIC XX.
   526         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   527
   528         16  CM-LF-CURRENT-STATUS          PIC X.
   529             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   530                                                'M' '4' '5' '9'.
   531             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   532             88  CM-LF-POLICY-PENDING         VALUE '2'.
   533             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   534             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   535             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  11
* SOCK03.cbl
   536             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   537             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   538             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   539             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   540             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   541             88  CM-LF-DECLINED               VALUE 'D'.
   542             88  CM-LF-VOIDED                 VALUE 'V'.
   543
   544         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   545         16  CM-AH-CANCEL-DT               PIC XX.
   546         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   547
   548         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   549         16  CM-AH-SETTLEMENT-DT           PIC XX.
   550         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   551
   552         16  CM-AH-CURRENT-STATUS          PIC X.
   553             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   554                                                'M' '4' '5' '9'.
   555             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   556             88  CM-AH-POLICY-PENDING         VALUE '2'.
   557             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   558             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   559             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   560             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   561             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   562             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   563             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   564             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   565             88  CM-AH-DECLINED               VALUE 'D'.
   566             88  CM-AH-VOIDED                 VALUE 'V'.
   567
   568         16  CM-CLAIM-INTERFACE-SW         PIC X.
   569             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   570             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   571             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   572         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   573
   574         16  CM-ENTRY-BATCH                PIC X(6).
   575         16  CM-LF-EXIT-BATCH              PIC X(6).
   576         16  CM-AH-EXIT-BATCH              PIC X(6).
   577         16  CM-LAST-MONTH-END             PIC XX.
   578
   579     12  CM-NOTE-SW                        PIC X.
   580         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   581         88  CERT-NOTES-PRESENT               VALUE '1'.
   582         88  BILLING-NOTES-PRESENT            VALUE '2'.
   583         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   584         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   585         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   586         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   587         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   588     12  CM-COMP-EXCP-SW                   PIC X.
   589         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   590         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   591     12  CM-INSURED-ADDRESS-SW             PIC X.
   592         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   593         88  INSURED-ADDR-PRESENT             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  12
* SOCK03.cbl
   594
   595*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   596     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   597     12  FILLER                            PIC X.
   598
   599*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   600     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   601     12  FILLER                            PIC X.
   602*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   603     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   604
   605     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   606         88  CERT-ADDED-BATCH                 VALUE ' '.
   607         88  CERT-ADDED-ONLINE                VALUE '1'.
   608         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   609         88  CERT-PURGED-OFFLINE              VALUE '3'.
   610         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   611     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   612         88  CERT-AS-LOADED                   VALUE ' '.
   613         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   614         88  CERT-CLAIM-ONLINE                VALUE '2'.
   615         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   616         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   617         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   618         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   619         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   620
   621     12  CM-ACCOUNT-COMM-PCTS.
   622         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   623         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   624
   625     12  CM-USER-FIELD                     PIC X.
   626     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   627     12  CM-CLP-STATE                      PIC XX.
   628     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   629     12  CM-USER-RESERVED                  PIC XXX.
   630     12  FILLER REDEFINES CM-USER-RESERVED.
   631         16  CM-AH-CLASS-CD                PIC XX.
   632         16  F                             PIC X.
   633******************************************************************
   634*                                 COPY ELCMSTR.
   635******************************************************************
   636*                                                                *
   637*                            ELCMSTR.                            *
   638*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   639*                            VMOD=2.012                          *
   640*                                                                *
   641*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   642*                                                                *
   643*   FILE TYPE = VSAM,KSDS                                        *
   644*   RECORD SIZE = 350  RECFORM = FIXED                           *
   645*                                                                *
   646*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   647*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   648*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   649*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   650*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   651*                                                 RKP=75,LEN=21  *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  13
* SOCK03.cbl
   652*                                                                *
   653*   **** NOTE ****                                               *
   654*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   655*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   656*                                                                *
   657*   LOG = YES                                                    *
   658*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   659******************************************************************
   660*                   C H A N G E   L O G
   661*
   662* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   663*-----------------------------------------------------------------
   664*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   665* EFFECTIVE    NUMBER
   666*-----------------------------------------------------------------
   667* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   668* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   669* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   670* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   671* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   672******************************************************************
   673 01  CLAIM-MASTER.
   674     12  CL-RECORD-ID                PIC XX.
   675         88  VALID-CL-ID         VALUE 'CL'.
   676
   677     12  CL-CONTROL-PRIMARY.
   678         16  CL-COMPANY-CD           PIC X.
   679         16  CL-CARRIER              PIC X.
   680         16  CL-CLAIM-NO             PIC X(7).
   681         16  CL-CERT-NO.
   682             20  CL-CERT-PRIME       PIC X(10).
   683             20  CL-CERT-SFX         PIC X.
   684
   685     12  CL-CONTROL-BY-NAME.
   686         16  CL-COMPANY-CD-A1        PIC X.
   687         16  CL-INSURED-LAST-NAME    PIC X(15).
   688         16  CL-INSURED-NAME.
   689             20  CL-INSURED-1ST-NAME PIC X(12).
   690             20  CL-INSURED-MID-INIT PIC X.
   691
   692     12  CL-CONTROL-BY-SSN.
   693         16  CL-COMPANY-CD-A2        PIC X.
   694         16  CL-SOC-SEC-NO.
   695             20  CL-SSN-STATE        PIC XX.
   696             20  CL-SSN-ACCOUNT      PIC X(6).
   697             20  CL-SSN-LN3          PIC X(3).
   698
   699     12  CL-CONTROL-BY-CERT-NO.
   700         16  CL-COMPANY-CD-A4        PIC X.
   701         16  CL-CERT-NO-A4.
   702             20  CL-CERT-A4-PRIME    PIC X(10).
   703             20  CL-CERT-A4-SFX      PIC X.
   704
   705     12  CL-CONTROL-BY-CCN.
   706         16  CL-COMPANY-CD-A5        PIC X.
   707         16  CL-CCN-A5.
   708             20  CL-CCN.
   709                 24  CL-CCN-PREFIX-A5 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  14
* SOCK03.cbl
   710                 24  CL-CCN-PRIME-A5 PIC X(12).
   711             20  CL-CCN-FILLER-A5    PIC X(4).
   712
   713     12  CL-INSURED-PROFILE-DATA.
   714         16  CL-INSURED-BIRTH-DT     PIC XX.
   715         16  CL-INSURED-SEX-CD       PIC X.
   716             88  INSURED-IS-MALE        VALUE 'M'.
   717             88  INSURED-IS-FEMALE      VALUE 'F'.
   718             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   719         16  CL-INSURED-OCC-CD       PIC X(6).
   720         16  FILLER                  PIC X(5).
   721
   722     12  CL-PROCESSING-INFO.
   723         16  CL-PROCESSOR-ID         PIC X(4).
   724         16  CL-CLAIM-STATUS         PIC X.
   725             88  CLAIM-IS-OPEN          VALUE 'O'.
   726             88  CLAIM-IS-CLOSED        VALUE 'C'.
   727         16  CL-CLAIM-TYPE           PIC X.
   728*            88  AH-CLAIM               VALUE 'A'.
   729*            88  LIFE-CLAIM             VALUE 'L'.
   730*            88  PROPERTY-CLAIM         VALUE 'P'.
   731*            88  IUI-CLAIM              VALUE 'I'.
   732*            88  GAP-CLAIM              VALUE 'G'.
   733*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   734         16  CL-CLAIM-PREM-TYPE      PIC X.
   735             88  SINGLE-PREMIUM         VALUE '1'.
   736             88  O-B-COVERAGE           VALUE '2'.
   737             88  OPEN-END-COVERAGE      VALUE '3'.
   738         16  CL-INCURRED-DT          PIC XX.
   739         16  CL-REPORTED-DT          PIC XX.
   740         16  CL-FILE-ESTABLISH-DT    PIC XX.
   741         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   742         16  CL-LAST-PMT-DT          PIC XX.
   743         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   744         16  CL-PAID-THRU-DT         PIC XX.
   745         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   746         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   747         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   748         16  CL-PMT-CALC-METHOD      PIC X.
   749             88  CL-360-DAY-YR          VALUE '1'.
   750             88  CL-365-DAY-YR          VALUE '2'.
   751             88  CL-FULL-MONTHS         VALUE '3'.
   752         16  CL-CAUSE-CD             PIC X(6).
   753
   754         16  CL-PRIME-CERT-NO.
   755             20  CL-PRIME-CERT-PRIME PIC X(10).
   756             20  CL-PRIME-CERT-SFX   PIC X.
   757
   758         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   759             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   760             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   761
   762         16  CL-MICROFILM-NO         PIC X(10).
   763         16  FILLER REDEFINES CL-MICROFILM-NO.
   764             20  CL-BENEFIT-PERIOD   PIC 99.
   765             20  FILLER              PIC X(8).
   766         16  CL-PROG-FORM-TYPE       PIC X.
   767         16  CL-LAST-ADD-ON-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  15
* SOCK03.cbl
   768
   769         16  CL-LAST-REOPEN-DT       PIC XX.
   770         16  CL-LAST-CLOSE-DT        PIC XX.
   771         16  CL-LAST-CLOSE-REASON    PIC X(01).
   772             88  FINAL-PAID             VALUE '1'.
   773             88  CLAIM-DENIED           VALUE '2'.
   774             88  AUTO-CLOSE             VALUE '3'.
   775             88  MANUAL-CLOSE           VALUE '4'.
   776             88  BENEFITS-CHANGED       VALUE 'C'.
   777             88  SETUP-ERRORS           VALUE 'E'.
   778         16  CL-ASSOC-CERT-SEQU      PIC S99.
   779         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   780         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   781             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   782         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   783         16  FILLER                  PIC X.
   784
   785     12  CL-CERTIFICATE-DATA.
   786         16  CL-CERT-ORIGIN          PIC X.
   787             88  CERT-WAS-ONLINE        VALUE '1'.
   788             88  CERT-WAS-CREATED       VALUE '2'.
   789             88  COVERAGE-WAS-ADDED     VALUE '3'.
   790         16  CL-CERT-KEY-DATA.
   791             20  CL-CERT-CARRIER     PIC X.
   792             20  CL-CERT-GROUPING    PIC X(6).
   793             20  CL-CERT-STATE       PIC XX.
   794             20  CL-CERT-ACCOUNT.
   795                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   796                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   797             20  CL-CERT-EFF-DT      PIC XX.
   798
   799     12  CL-STATUS-CONTROLS.
   800         16  CL-PRIORITY-CD          PIC X.
   801             88  CONFIDENTIAL-DATA      VALUE '8'.
   802             88  HIGHEST-PRIORITY       VALUE '9'.
   803         16  CL-SUPV-ATTN-CD         PIC X.
   804             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   805             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   806         16  CL-PURGED-DT            PIC XX.
   807         16  CL-RESTORED-DT          PIC XX.
   808         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   809         16  CL-NEXT-RESEND-DT       PIC XX.
   810         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   811         16  CL-CRITICAL-PERIOD      PIC 99.
   812*        16  FILLER                  PIC XX.
   813         16  CL-LAST-MAINT-DT        PIC XX.
   814         16  CL-LAST-MAINT-USER      PIC X(4).
   815         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   816         16  CL-LAST-MAINT-TYPE      PIC X.
   817             88  CLAIM-SET-UP           VALUE ' '.
   818             88  PAYMENT-MADE           VALUE '1'.
   819             88  LETTER-SENT            VALUE '2'.
   820             88  MASTER-WAS-ALTERED     VALUE '3'.
   821             88  MASTER-WAS-RESTORED    VALUE '4'.
   822             88  INCURRED-DATE-CHANGED  VALUE '5'.
   823             88  FILE-CONVERTED         VALUE '6'.
   824             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   825             88  ERROR-CORRECTION       VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  16
* SOCK03.cbl
   826         16  CL-RELATED-CLAIM-NO     PIC X(7).
   827         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   828         16  CL-BENEFICIARY          PIC X(10).
   829         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   830         16  CL-DENIAL-TYPE          PIC X.
   831             88  CL-TYPE-DENIAL          VALUE '1'.
   832             88  CL-TYPE-RESCISSION      VALUE '2'.
   833             88  CL-TYPE-REFORMATION     VALUE '3'.
   834             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   835             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   836         16  filler                  pic x(5).
   837*        16  CL-CRIT-PER-RECURRENT   PIC X.
   838*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   839*        16  CL-RTW-DT               PIC XX.
   840
   841     12  CL-TRAILER-CONTROLS.
   842         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   843             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   844             88  CL-LAST-TRL-AVAIL      VALUE +100.
   845             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   846         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   847         16  FILLER                  PIC XX.
   848         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   849         16  CL-ADDRESS-TRAILER-CNT.
   850             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   851                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   852             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   853                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   854             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   855                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   856             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   857                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   858             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   859                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   860             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   861                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   862             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   863                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   864
   865     12  CL-CV-REFERENCE-NO.
   866         16  CL-CV-REFNO-PRIME       PIC X(18).
   867         16  CL-CV-REFNO-SFX         PIC XX.
   868
   869     12  CL-FILE-LOCATION            PIC X(4).
   870
   871     12  CL-PROCESS-ERRORS.
   872         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   873             88  NO-FATAL-ERRORS        VALUE ZERO.
   874         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   875             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   876
   877     12  CL-PRODUCT-CD               PIC X.
   878
   879     12  CL-CURRENT-KEY-DATA.
   880         16  CL-CURRENT-CARRIER      PIC X.
   881         16  CL-CURRENT-GROUPING     PIC X(6).
   882         16  CL-CURRENT-STATE        PIC XX.
   883         16  CL-CURRENT-ACCOUNT      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  17
* SOCK03.cbl
   884
   885     12  CL-ASSOCIATES               PIC X.
   886         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   887         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   888         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   889         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   890
   891     12  CL-ACTIVITY-CODE            PIC 99.
   892     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   893     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   894
   895     12  CL-LAPSE-REPORT-CODE        PIC 9.
   896     12  CL-LAG-REPORT-CODE          PIC 9.
   897     12  CL-LOAN-TYPE                PIC XX.
   898     12  CL-LEGAL-STATE              PIC XX.
   899
   900     12  CL-YESNOSW                  PIC X.
   901     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   902         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   903         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   904         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   905     12  cl-insured-type             pic x.
   906         88  cl-claim-on-primary         value 'P'.
   907         88  cl-claim-on-co-borrower     value 'C'.
   908     12  cl-benefit-expiration-dt    PIC XX.
   909*                                 COPY ERCPDEF.
   910******************************************************************
   911*                                                                *
   912*                                                                *
   913*                            ERCPDEF.                            *
   914*                                                                *
   915*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   916*                                                                *
   917*    FILE TYPE = VSAM,KSDS                                       *
   918*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   919*                                                                *
   920*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   921*                                                                *
   922*    LOG = YES                                                   *
   923*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   924******************************************************************
   925*                   C H A N G E   L O G
   926*
   927* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   928*-----------------------------------------------------------------
   929*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   930* EFFECTIVE    NUMBER
   931*-----------------------------------------------------------------
   932* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   933* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   934******************************************************************
   935 01  PRODUCT-MASTER.
   936    12  PD-RECORD-ID                 PIC X(02).
   937        88  VALID-PD-ID                  VALUE 'PD'.
   938    12  PD-CONTROL-PRIMARY.
   939        16  PD-COMPANY-CD            PIC X.
   940        16  PD-STATE                 PIC XX.
   941        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  18
* SOCK03.cbl
   942        16  PD-FILLER                PIC X(7).
   943        16  PD-BEN-TYPE              PIC X.
   944        16  PD-BEN-CODE              PIC XX.
   945        16  PD-PROD-EXP-DT           PIC XX.
   946    12  FILLER                       PIC X(50).
   947    12  PD-PRODUCT-DATA OCCURS 8.
   948        16  PD-PROD-CODE             PIC X.
   949            88  PD-PROD-LIFE           VALUE 'L'.
   950            88  PD-PROD-PROP           VALUE 'P'.
   951            88  PD-PROD-AH             VALUE 'A'.
   952            88  PD-PROD-IU             VALUE 'I'.
   953            88  PD-PROD-GAP            VALUE 'G'.
   954            88  PD-PROD-FAML           VALUE 'F'.
   955        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   956        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   957        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   958        16  PD-MAX-TERM              PIC S999        COMP-3.
   959        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   960        16  FILLER                   PIC X.
   961        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   962        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   963        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   964        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   965        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   966        16  PD-REC-CRIT-PERIOD       PIC 99.
   967        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   968            20  PD-RECURRING-YN      PIC X.
   969            20  FILLER               PIC X.
   970        16  PD-RTW-MOS               PIC 99.
   971        16  PD-MAX-EXTENSION         PIC 99.
   972        16  FILLER                   PIC XX.
   973    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   974    12  PD-TERM-LIMITS OCCURS 15.
   975        16  PD-LOW-TERM              PIC S999        COMP-3.
   976        16  PD-HI-TERM               PIC S999        COMP-3.
   977*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   978    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   979        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   980        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   981    12  PD-EARN-FACTORS.
   982        16  FILLER OCCURS 15.
   983            20  FILLER OCCURS 15.
   984                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   985    12  PD-PRODUCT-DESC              PIC X(80).
   986    12  PD-TRUNCATED                 PIC X.
   987    12  FILLER                       PIC X(59).
   988    12  PD-MAINT-INFORMATION.
   989        16  PD-LAST-MAINT-DT         PIC X(02).
   990        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   991        16  PD-LAST-MAINT-BY         PIC X(04).
   992*                                 COPY ERCCTBL.
   993******************************************************************
   994*                                                                *
   995*                                                                *
   996*                            ERCCTBL                             *
   997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   998*                            VMOD=2.003
   999*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  19
* SOCK03.cbl
  1000*   ONLINE CREDIT SYSTEM                                         *
  1001*                                                                *
  1002*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1003*                                                                *
  1004*   FILE TYPE = VSAM,KSDS                                        *
  1005*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1006*                                                                *
  1007*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1008*       ALTERNATE PATH = NONE                                    *
  1009*                                                                *
  1010*   LOG = NO                                                     *
  1011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1012*                                                                *
  1013*                                                                *
  1014******************************************************************
  1015
  1016 01  COMM-TABLE-RECORD.
  1017     12  CT-RECORD-ID                      PIC XX.
  1018         88  VALID-CT-ID                      VALUE 'CT'.
  1019
  1020     12  CT-CONTROL-PRIMARY.
  1021         16  CT-COMPANY-CD                 PIC X.
  1022         16  CT-TABLE                      PIC XXX.
  1023         16  CT-CNTRL-2.
  1024             20  CT-BEN-TYPE               PIC X.
  1025             20  CT-BEN-CODE               PIC XX.
  1026
  1027     12  CT-MAINT-INFORMATION.
  1028         16  CT-LAST-MAINT-DT              PIC XX.
  1029         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1030         16  CT-LAST-MAINT-USER            PIC X(4).
  1031         16  FILLER                        PIC X(31).
  1032
  1033     12  CT-LIMITS.
  1034         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1035
  1036         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1037
  1038         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1039
  1040     12  CT-RATES.
  1041         16  CT-RTX          OCCURS 27 TIMES.
  1042             20  CT-RT                     PIC SV9(5)     COMP-3.
  1043             20  CT-RT-R   REDEFINES
  1044                 CT-RT                     PIC XXX.
  1045
  1046     12  FILLER                            PIC  X(42).
  1047
  1048******************************************************************
  1049*                                 COPY ELCCNTL.
  1050******************************************************************
  1051*                                                                *
  1052*                                                                *
  1053*                            ELCCNTL.                            *
  1054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1055*                            VMOD=2.059                          *
  1056*                                                                *
  1057*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  20
* SOCK03.cbl
  1058*                                                                *
  1059*   FILE TYPE = VSAM,KSDS                                        *
  1060*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1061*                                                                *
  1062*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1063*       ALTERNATE INDEX = NONE                                   *
  1064*                                                                *
  1065*   LOG = YES                                                    *
  1066*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1067******************************************************************
  1068*                   C H A N G E   L O G
  1069*
  1070* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1071*-----------------------------------------------------------------
  1072*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1073* EFFECTIVE    NUMBER
  1074*-----------------------------------------------------------------
  1075* 082503                   PEMA  ADD BENEFIT GROUP
  1076* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1077* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1078* 092705    2005050300006  PEMA  ADD SPP LEASES
  1079* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1080* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1081* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1082* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1083* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1084* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1085* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1086* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1087* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1088* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1089******************************************************************
  1090*
  1091 01  CONTROL-FILE.
  1092     12  CF-RECORD-ID                       PIC XX.
  1093         88  VALID-CF-ID                        VALUE 'CF'.
  1094
  1095     12  CF-CONTROL-PRIMARY.
  1096         16  CF-COMPANY-ID                  PIC XXX.
  1097         16  CF-RECORD-TYPE                 PIC X.
  1098             88  CF-COMPANY-MASTER              VALUE '1'.
  1099             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1100             88  CF-STATE-MASTER                VALUE '3'.
  1101             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1102             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1103             88  CF-CARRIER-MASTER              VALUE '6'.
  1104             88  CF-MORTALITY-MASTER            VALUE '7'.
  1105             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1106             88  CF-TERMINAL-MASTER             VALUE '9'.
  1107             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1108             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1109             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1110             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1111             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1112             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1113             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1114             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1115             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  21
* SOCK03.cbl
  1116         16  CF-ACCESS-CD-GENL              PIC X(4).
  1117         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1118             20  CF-PROCESSOR               PIC X(4).
  1119         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1120             20  CF-STATE-CODE              PIC XX.
  1121             20  FILLER                     PIC XX.
  1122         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1123             20  FILLER                     PIC XX.
  1124             20  CF-HI-BEN-IN-REC           PIC XX.
  1125         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1126             20  FILLER                     PIC XXX.
  1127             20  CF-CARRIER-CNTL            PIC X.
  1128         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1129             20  FILLER                     PIC XX.
  1130             20  CF-HI-TYPE-IN-REC          PIC 99.
  1131         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1132             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1133                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1134             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1135             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1136         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1137             20  FILLER                     PIC X.
  1138             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1139         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1140             20  FILLER                     PIC XX.
  1141             20  CF-MORTGAGE-PLAN           PIC XX.
  1142         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1143
  1144     12  CF-LAST-MAINT-DT                   PIC XX.
  1145     12  CF-LAST-MAINT-BY                   PIC X(4).
  1146     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1147
  1148     12  CF-RECORD-BODY                     PIC X(728).
  1149
  1150
  1151****************************************************************
  1152*             COMPANY MASTER RECORD                            *
  1153****************************************************************
  1154
  1155     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1156         16  CF-COMPANY-ADDRESS.
  1157             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1158             20  CF-CL-IN-CARE-OF           PIC X(30).
  1159             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1160             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1161             20  CF-CL-CITY-STATE           PIC X(30).
  1162             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1163             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1164         16  CF-COMPANY-CD                  PIC X.
  1165         16  CF-COMPANY-PASSWORD            PIC X(8).
  1166         16  CF-SECURITY-OPTION             PIC X.
  1167             88  ALL-SECURITY                   VALUE '1'.
  1168             88  COMPANY-VERIFY                 VALUE '2'.
  1169             88  PROCESSOR-VERIFY               VALUE '3'.
  1170             88  NO-SECURITY                    VALUE '4'.
  1171             88  ALL-BUT-TERM                   VALUE '5'.
  1172         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1173             88  USE-ACTUAL-CARRIER             VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  22
* SOCK03.cbl
  1174         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1175             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1176         16  CF-INFORCE-LOCATION            PIC X.
  1177             88  CERTS-ARE-ONLINE               VALUE '1'.
  1178             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1179             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1180         16  CF-LOWER-CASE-LETTERS          PIC X.
  1181         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1182             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1183             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1184             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1185             88  CF-ACCNT-CNTL                  VALUE '3'.
  1186             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1187
  1188         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1189         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1190
  1191         16  CF-LGX-CREDIT-USER             PIC X.
  1192             88  CO-IS-NOT-USER                 VALUE 'N'.
  1193             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1194
  1195         16 CF-CREDIT-CALC-CODES.
  1196             20  CF-CR-REM-TERM-CALC PIC X.
  1197               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1198               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1199               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1200               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1201               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1202               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1203               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1204             20  CF-CR-R78-METHOD           PIC X.
  1205               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1206               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1207
  1208         16  CF-CLAIM-CONTROL-COUNTS.
  1209             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1210                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1211
  1212             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1213                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1214
  1215             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1216                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1217
  1218             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1219                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1220
  1221         16  CF-CURRENT-MONTH-END           PIC XX.
  1222
  1223         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1224             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1225             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1226             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1227             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1228                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1229                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1230             20  CF-CO-PREM-REJECT-SW       PIC X.
  1231                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  23
* SOCK03.cbl
  1232                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1233             20  CF-CO-REF-REJECT-SW        PIC X.
  1234                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1235                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1236
  1237         16  CF-CO-REPORTING-DT             PIC XX.
  1238         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1239         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1240           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1241           88  CF-CO-MONTH-END                  VALUE '1'.
  1242
  1243         16  CF-LGX-CLAIM-USER              PIC X.
  1244             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1245             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1246
  1247         16  CF-CREDIT-EDIT-CONTROLS.
  1248             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1249             20  CF-MIN-AGE                 PIC 99.
  1250             20  CF-DEFAULT-AGE             PIC 99.
  1251             20  CF-MIN-TERM                PIC S999      COMP-3.
  1252             20  CF-MAX-TERM                PIC S999      COMP-3.
  1253             20  CF-DEFAULT-SEX             PIC X.
  1254             20  CF-JOINT-AGE-INPUT         PIC X.
  1255                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1256             20  CF-BIRTH-DATE-INPUT        PIC X.
  1257                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1258             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1259                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1260                 88  CF-ZERO-CARRIER            VALUE '1'.
  1261                 88  CF-ZERO-GROUPING           VALUE '2'.
  1262                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1263             20  CF-EDIT-SW                 PIC X.
  1264                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1265             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1266             20  CF-CR-PR-METHOD            PIC X.
  1267               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1268               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1269             20  FILLER                     PIC X.
  1270
  1271         16  CF-CREDIT-MISC-CONTROLS.
  1272             20  CF-REIN-TABLE-SW           PIC X.
  1273                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1274             20  CF-COMP-TABLE-SW           PIC X.
  1275                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1276             20  CF-EXPERIENCE-RETENTION-AGE
  1277                                            PIC S9        COMP-3.
  1278             20  CF-CONVERSION-DT           PIC XX.
  1279             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1280             20  CF-RUN-FREQUENCY-SW        PIC X.
  1281                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1282                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1283
  1284             20  CF-CR-CHECK-NO-CONTROL.
  1285                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1286                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1287                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1288                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1289                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  24
* SOCK03.cbl
  1290                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1291
  1292                 24  CF-CR-CHECK-COUNT       REDEFINES
  1293                     CF-CR-CHECK-COUNTER      PIC X(4).
  1294
  1295                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1296                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1297
  1298                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1299                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1300                 24  CF-MAIL-PROCESSING       PIC X.
  1301                     88  MAIL-PROCESSING          VALUE 'Y'.
  1302
  1303         16  CF-MISC-SYSTEM-CONTROL.
  1304             20  CF-SYSTEM-C                 PIC X.
  1305                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1306             20  CF-SYSTEM-D                 PIC X.
  1307                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1308             20  CF-SOC-SEC-NO-SW            PIC X.
  1309                 88  SOC-SEC-NO-USED             VALUE '1'.
  1310             20  CF-MEMBER-NO-SW             PIC X.
  1311                 88  MEMBER-NO-USED              VALUE '1'.
  1312             20  CF-TAX-ID-NUMBER            PIC X(11).
  1313             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1314             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1315                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1316                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1317                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1318                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1319             20  CF-SYSTEM-E                 PIC X.
  1320                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1321
  1322         16  CF-LGX-LIFE-USER               PIC X.
  1323             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1324             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1325
  1326         16  CF-CR-MONTH-END-DT             PIC XX.
  1327
  1328         16  CF-FILE-MAINT-DATES.
  1329             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1330                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1331             20  CF-LAST-BATCH       REDEFINES
  1332                 CF-LAST-BATCH-NO               PIC X(4).
  1333             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1334             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1335             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1336             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1337             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1338             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1339             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1340             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1341             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1342             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1343
  1344         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1345         16  FILLER                         PIC X.
  1346
  1347         16  CF-ALT-MORT-CODE               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  25
* SOCK03.cbl
  1348         16  CF-MEMBER-CAPTION              PIC X(10).
  1349
  1350         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1351             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1352             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1353             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1354             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1355             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1356
  1357         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1358
  1359         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1360         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1361         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1362         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1363
  1364         16  CF-AH-OVERRIDE-L1              PIC X.
  1365         16  CF-AH-OVERRIDE-L2              PIC XX.
  1366         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1367         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1368
  1369         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1370         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1371
  1372         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1373         16  CF-AR-LAST-EL860-DT            PIC XX.
  1374         16  CF-MP-MONTH-END-DT             PIC XX.
  1375
  1376         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1377         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1378             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1379
  1380         16  CF-AR-MONTH-END-DT             PIC XX.
  1381
  1382         16  CF-CRDTCRD-USER                PIC X.
  1383             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1384             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1385
  1386         16  CF-CC-MONTH-END-DT             PIC XX.
  1387
  1388         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1389
  1390         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1391             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1392             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1393             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1394         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1395         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1396         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1397         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1398             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1399             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1400         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1401         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1402         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1403             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1404         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1405
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  26
* SOCK03.cbl
  1406         16  CF-CL-ZIP-CODE.
  1407             20  CF-CL-ZIP-PRIME.
  1408                 24  CF-CL-ZIP-1ST          PIC X.
  1409                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1410                 24  FILLER                 PIC X(4).
  1411             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1412         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1413             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1414             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1415             20  FILLER                     PIC XXX.
  1416
  1417         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1418         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1419         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1420         16  CF-CO-OPTION-START-DATE        PIC XX.
  1421         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1422           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1423                                                      '3' '4'.
  1424           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1425           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1426           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1427           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1428           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1429           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1430
  1431         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1432
  1433         16  CF-PAYMENT-APPROVAL-LEVELS.
  1434             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1435             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1436             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1437             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1438             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1439             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1440
  1441         16  CF-END-USER-REPORTING-USER     PIC X.
  1442             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1443             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1444
  1445         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1446             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1447             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1448
  1449         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1450
  1451         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1452         16  FILLER                         PIC X.
  1453
  1454         16  CF-CREDIT-ARCHIVE-CNTL.
  1455             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1456             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1457             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1458
  1459         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1460
  1461         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1462             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1463             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  27
* SOCK03.cbl
  1464
  1465         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1466             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1467             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1468
  1469         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1470
  1471         16  CF-CO-ACH-ID-CODE              PIC  X.
  1472             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1473             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1474             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1475         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1476         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1477         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1478         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1479         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1480         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1481         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1482         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1483         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1484                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1485         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1486                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1487
  1488         16  CF-CO-OVER-SHORT.
  1489             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1490             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1491
  1492*         16  FILLER                         PIC X(102).
  1493         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1494             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1495             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1496
  1497         16  CF-AH-APPROVAL-DAYS.
  1498             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1499             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1500             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1501             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1502
  1503         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1504
  1505         16  CF-APPROV-LEV-5.
  1506             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1507             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1508             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1509
  1510         16  FILLER                         PIC X(68).
  1511****************************************************************
  1512*             PROCESSOR/USER RECORD                            *
  1513****************************************************************
  1514
  1515     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1516         16  CF-PROCESSOR-NAME              PIC X(30).
  1517         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1518         16  CF-PROCESSOR-TITLE             PIC X(26).
  1519         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1520                 88  MESSAGE-YES                VALUE 'Y'.
  1521                 88  MESSAGE-NO                 VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  28
* SOCK03.cbl
  1522
  1523*****************************************************
  1524****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1525****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1526****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1527****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1528*****************************************************
  1529
  1530         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1531             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1532             20  CF-APPLICATION-FORCE       PIC X.
  1533             20  CF-INDIVIDUAL-APP.
  1534                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1535                     28  CF-BROWSE-APP      PIC X.
  1536                     28  CF-UPDATE-APP      PIC X.
  1537
  1538         16  CF-CURRENT-TERM-ON             PIC X(4).
  1539         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1540             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1541             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1542             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1543             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1544             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1545             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1546             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1547         16  CF-PROCESSOR-CARRIER           PIC X.
  1548             88  NO-CARRIER-SECURITY            VALUE ' '.
  1549         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1550             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1551         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1552             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1553         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1554             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1555
  1556         16  CF-PROC-SYS-ACCESS-SW.
  1557             20  CF-PROC-CREDIT-CLAIMS-SW.
  1558                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1559                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1560                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1561                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1562             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1563                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1564                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1565             20  CF-PROC-LIFE-GNRLDGR-SW.
  1566                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1567                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1568                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1569                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1570             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1571                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1572                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1573         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1574             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1575             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1576         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1577
  1578         16  CF-APPROVAL-LEVEL                  PIC X.
  1579             88  APPROVAL-LEVEL-1                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  29
* SOCK03.cbl
  1580             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1581             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1582             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1583             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1584
  1585         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1586
  1587         16  CF-LANGUAGE-TYPE                   PIC X.
  1588             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1589             88  CF-LANG-IS-FR                      VALUE 'F'.
  1590
  1591         16  CF-CSR-IND                         PIC X.
  1592         16  FILLER                             PIC X(239).
  1593
  1594****************************************************************
  1595*             PROCESSOR/REMINDERS RECORD                       *
  1596****************************************************************
  1597
  1598     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1599         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1600             20  CF-START-REMIND-DT         PIC XX.
  1601             20  CF-END-REMIND-DT           PIC XX.
  1602             20  CF-REMINDER-TEXT           PIC X(50).
  1603         16  FILLER                         PIC X(296).
  1604
  1605
  1606****************************************************************
  1607*             STATE MASTER RECORD                              *
  1608****************************************************************
  1609
  1610     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1611         16  CF-STATE-ABBREVIATION          PIC XX.
  1612         16  CF-STATE-NAME                  PIC X(25).
  1613         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1614         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1615             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1616             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1617             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1618             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1619                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1620                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1621             20  CF-ST-PREM-REJECT-SW       PIC X.
  1622                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1623                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1624             20  CF-ST-REF-REJECT-SW        PIC X.
  1625                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1626                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1627         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1628         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1629         16  CF-ST-REFUND-RULES.
  1630             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1631             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1632             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1633         16  CF-ST-FST-PMT-EXTENSION.
  1634             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1635             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1636                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1637                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  30
* SOCK03.cbl
  1638                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1639                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1640         16  CF-ST-STATE-CALL.
  1641             20  CF-ST-CALL-UNEARNED        PIC X.
  1642             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1643             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1644         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1645             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1646             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1647         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1648         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1649         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1650         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1651         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1652         16  FILLER                         PIC X.
  1653         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1654             20  CF-ST-BENEFIT-CD           PIC XX.
  1655             20  CF-ST-BENEFIT-KIND         PIC X.
  1656                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1657                 88  CF-ST-AH-KIND              VALUE 'A'.
  1658             20  CF-ST-REM-TERM-CALC        PIC X.
  1659                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1660                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1661                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1662                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1663                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1664                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1665                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1666                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1667
  1668             20  CF-ST-REFUND-CALC          PIC X.
  1669                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1670                 88  ST-REFD-BY-R78             VALUE '1'.
  1671                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1672                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1673                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1674                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1675                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1676                 88  ST-REFD-UTAH               VALUE '7'.
  1677                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1678                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1679                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1680
  1681             20  CF-ST-EARNING-CALC         PIC X.
  1682                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1683                 88  ST-EARN-BY-R78             VALUE '1'.
  1684                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1685                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1686                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1687                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1688                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1689                 88  ST-EARN-MEAN               VALUE '8'.
  1690                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1691
  1692             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1693                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1694                 88  ST-OVRD-BY-R78             VALUE '1'.
  1695                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  31
* SOCK03.cbl
  1696                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1697                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1698                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1699                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1700                 88  ST-OVRD-MEAN               VALUE '8'.
  1701                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1702             20  FILLER                     PIC X.
  1703
  1704         16  CF-ST-COMMISSION-CAPS.
  1705             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1706             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1707             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1708             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1709         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1710                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1711
  1712         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1713
  1714         16  CF-ST-STATUTORY-INTEREST.
  1715             20  CF-ST-STAT-DATE-FROM       PIC X.
  1716                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1717                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1718             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1719             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1720             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1721             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1722             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1723
  1724         16  CF-ST-OVER-SHORT.
  1725             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1726             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1727
  1728         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1729
  1730         16  CF-ST-RT-CALC                  PIC X.
  1731
  1732         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1733         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1734         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1735         16  CF-ST-RF-LR-CALC               PIC X.
  1736         16  CF-ST-RF-LL-CALC               PIC X.
  1737         16  CF-ST-RF-LN-CALC               PIC X.
  1738         16  CF-ST-RF-AH-CALC               PIC X.
  1739         16  CF-ST-RF-CP-CALC               PIC X.
  1740*        16  FILLER                         PIC X(206).
  1741*CIDMOD         16  FILLER                         PIC X(192).
  1742         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1743             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1744         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1745         16  CF-ST-VFY-2ND-BENE             PIC X.
  1746         16  CF-ST-CAUSAL-STATE             PIC X.
  1747         16  FILLER                         PIC X(185).
  1748
  1749****************************************************************
  1750*             BENEFIT MASTER RECORD                            *
  1751****************************************************************
  1752
  1753     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  32
* SOCK03.cbl
  1754         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1755             20  CF-BENEFIT-CODE            PIC XX.
  1756             20  CF-BENEFIT-NUMERIC  REDEFINES
  1757                 CF-BENEFIT-CODE            PIC XX.
  1758             20  CF-BENEFIT-ALPHA           PIC XXX.
  1759             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1760             20  CF-BENEFIT-COMMENT         PIC X(10).
  1761
  1762             20  CF-LF-COVERAGE-TYPE        PIC X.
  1763                 88  CF-REDUCING                VALUE 'R'.
  1764                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1765
  1766             20  CF-SPECIAL-CALC-CD         PIC X.
  1767                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1768                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1769                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1770                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1771                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1772                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1773                 88  CF-FARM-PLAN               VALUE 'F'.
  1774                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1775                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1776                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1777                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1778                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1779                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1780                 88  CF-PRUDENTIAL              VALUE 'P'.
  1781                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1782                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1783                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1784                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1785                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1786                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1787
  1788             20  CF-JOINT-INDICATOR         PIC X.
  1789                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1790
  1791*            20  FILLER                     PIC X(12).
  1792             20  cf-maximum-benefits        pic s999 comp-3.
  1793             20  FILLER                     PIC X(09).
  1794             20  CF-BENEFIT-CATEGORY        PIC X.
  1795             20  CF-LOAN-TYPE               PIC X(8).
  1796
  1797             20  CF-CO-REM-TERM-CALC        PIC X.
  1798                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1799                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1800                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1801                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1802                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1803
  1804             20  CF-CO-EARNINGS-CALC        PIC X.
  1805                 88  CO-EARN-BY-R78             VALUE '1'.
  1806                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1807                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1808                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1809                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1810                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1811                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  33
* SOCK03.cbl
  1812                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1813
  1814             20  CF-CO-REFUND-CALC          PIC X.
  1815                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1816                 88  CO-REFD-BY-R78             VALUE '1'.
  1817                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1818                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1819                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1820                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1821                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1822                 88  CO-REFD-MEAN               VALUE '8'.
  1823                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1824                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1825                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1826
  1827             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1828                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1829                 88  CO-OVRD-BY-R78             VALUE '1'.
  1830                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1831                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1832                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1833                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1834                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1835                 88  CO-OVRD-MEAN               VALUE '8'.
  1836                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1837
  1838             20  CF-CO-BEN-I-G-CD           PIC X.
  1839                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1840                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1841                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1842
  1843         16  FILLER                         PIC X(304).
  1844
  1845
  1846****************************************************************
  1847*             CARRIER MASTER RECORD                            *
  1848****************************************************************
  1849
  1850     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1851         16  CF-ADDRESS-DATA.
  1852             20  CF-MAIL-TO-NAME            PIC X(30).
  1853             20  CF-IN-CARE-OF              PIC X(30).
  1854             20  CF-ADDRESS-LINE-1          PIC X(30).
  1855             20  CF-ADDRESS-LINE-2          PIC X(30).
  1856             20  CF-CITY-STATE              PIC X(30).
  1857             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1858             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1859
  1860         16  CF-CLAIM-NO-CONTROL.
  1861             20  CF-CLAIM-NO-METHOD         PIC X.
  1862                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1863                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1864                 88  CLAIM-NO-SEQ               VALUE '3'.
  1865                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1866             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1867                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1868                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1869                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  34
* SOCK03.cbl
  1870
  1871         16  CF-CHECK-NO-CONTROL.
  1872             20  CF-CHECK-NO-METHOD         PIC X.
  1873                 88  CHECK-NO-MANUAL            VALUE '1'.
  1874                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1875                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1876                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1877             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1878                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1879
  1880         16  CF-DOMICILE-STATE              PIC XX.
  1881
  1882         16  CF-EXPENSE-CONTROLS.
  1883             20  CF-EXPENSE-METHOD          PIC X.
  1884                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1885                 88  DOLLARS-PER-PMT            VALUE '2'.
  1886                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1887                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1888             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1889             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1890
  1891         16  CF-CORRESPONDENCE-CONTROL.
  1892             20  CF-LETTER-RESEND-OPT       PIC X.
  1893                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1894                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1895             20  FILLER                     PIC X(4).
  1896
  1897         16  CF-RESERVE-CONTROLS.
  1898             20  CF-MANUAL-SW               PIC X.
  1899                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1900             20  CF-FUTURE-SW               PIC X.
  1901                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1902             20  CF-PTC-SW                  PIC X.
  1903                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1904             20  CF-IBNR-SW                 PIC X.
  1905                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1906             20  CF-PTC-LF-SW               PIC X.
  1907                 88  CF-LF-PTC-USED             VALUE '1'.
  1908             20  CF-CDT-ACCESS-METHOD       PIC X.
  1909                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1910                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1911                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1912             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1913
  1914         16  CF-CLAIM-CALC-METHOD           PIC X.
  1915             88  360-PLUS-MONTHS                VALUE '1'.
  1916             88  365-PLUS-MONTHS                VALUE '2'.
  1917             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1918             88  360-DAILY                      VALUE '4'.
  1919             88  365-DAILY                      VALUE '5'.
  1920
  1921         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1922         16  FILLER                         PIC X(11).
  1923
  1924         16  CF-LIMIT-AMOUNTS.
  1925             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1926             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1927             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  35
* SOCK03.cbl
  1928             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1929             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1930             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1931             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1932             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1933             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1934             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1935
  1936         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1937         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1938         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1939
  1940         16  CF-ZIP-CODE.
  1941             20  CF-ZIP-PRIME.
  1942                 24  CF-ZIP-1ST             PIC X.
  1943                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1944                 24  FILLER                 PIC X(4).
  1945             20  CF-ZIP-PLUS4               PIC X(4).
  1946         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1947             20  CF-CAN-POSTAL-1            PIC XXX.
  1948             20  CF-CAN-POSTAL-2            PIC XXX.
  1949             20  FILLER                     PIC XXX.
  1950
  1951         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1952         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1953         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1954
  1955         16  CF-RATING-SWITCH               PIC X.
  1956             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1957             88  CF-NO-RATING                   VALUE 'N'.
  1958
  1959         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1960
  1961         16  CF-CARRIER-OVER-SHORT.
  1962             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1963             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1964
  1965         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1966         16  CF-SECPAY-SWITCH               PIC X.
  1967             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1968             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1969         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1970         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1971         16  FILLER                         PIC X(444).
  1972*        16  FILLER                         PIC X(452).
  1973
  1974
  1975****************************************************************
  1976*             MORTALITY MASTER RECORD                          *
  1977****************************************************************
  1978
  1979     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1980         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1981                                INDEXED BY CF-MORT-NDX.
  1982             20  CF-MORT-TABLE              PIC X(5).
  1983             20  CF-MORT-TABLE-TYPE         PIC X.
  1984                 88  CF-MORT-JOINT              VALUE 'J'.
  1985                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  36
* SOCK03.cbl
  1986                 88  CF-MORT-COMBINED           VALUE 'C'.
  1987                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1988                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1989             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1990             20  CF-MORT-AGE-METHOD         PIC XX.
  1991                 88  CF-AGE-LAST                VALUE 'AL'.
  1992                 88  CF-AGE-NEAR                VALUE 'AN'.
  1993             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1994             20  CF-MORT-ADJUSTMENT-DIRECTION
  1995                                            PIC X.
  1996                 88  CF-MINUS                   VALUE '-'.
  1997                 88  CF-PLUS                    VALUE '+'.
  1998             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1999             20  CF-MORT-JOINT-CODE         PIC X.
  2000                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2001             20  CF-MORT-PC-Q               PIC X.
  2002                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2003             20  CF-MORT-TABLE-CODE         PIC X(4).
  2004             20  CF-MORT-COMMENTS           PIC X(15).
  2005             20  FILLER                     PIC X(14).
  2006
  2007         16  FILLER                         PIC X(251).
  2008
  2009
  2010****************************************************************
  2011*             BUSSINESS TYPE MASTER RECORD                     *
  2012****************************************************************
  2013
  2014     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2015* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2016* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2017* AND RECORD 05 IS TYPES 81-99
  2018         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2019             20  CF-BUSINESS-TITLE          PIC  X(19).
  2020             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2021                                            PIC S9V9(4) COMP-3.
  2022             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2023             20  FILLER                     PIC  X.
  2024         16  FILLER                         PIC  X(248).
  2025
  2026
  2027****************************************************************
  2028*             TERMINAL MASTER RECORD                           *
  2029****************************************************************
  2030
  2031     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2032
  2033         16  CF-COMPANY-TERMINALS.
  2034             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2035                                  PIC X(4).
  2036         16  FILLER               PIC X(248).
  2037
  2038
  2039****************************************************************
  2040*             LIFE EDIT MASTER RECORD                          *
  2041****************************************************************
  2042
  2043     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  37
* SOCK03.cbl
  2044         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2045             20  CF-LIFE-CODE-IN            PIC XX.
  2046             20  CF-LIFE-CODE-OUT           PIC XX.
  2047         16  FILLER                         PIC X(248).
  2048
  2049
  2050****************************************************************
  2051*             AH EDIT MASTER RECORD                            *
  2052****************************************************************
  2053
  2054     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2055         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2056             20  CF-AH-CODE-IN              PIC XXX.
  2057             20  CF-AH-CODE-OUT             PIC XX.
  2058         16  FILLER                         PIC X(248).
  2059
  2060
  2061****************************************************************
  2062*             CREDIBILITY TABLES                               *
  2063****************************************************************
  2064
  2065     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2066         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2067                             INDEXED BY CF-CRDB-NDX.
  2068             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2069             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2070             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2071         16  FILLER                         PIC  X(332).
  2072
  2073
  2074****************************************************************
  2075*             REPORT CUSTOMIZATION RECORD                      *
  2076****************************************************************
  2077
  2078     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2079         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2080             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2081             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2082             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2083**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2084****       A T-TRANSFER.                                   ****
  2085             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2086
  2087         16  FILLER                         PIC XX.
  2088
  2089         16  CF-CARRIER-CNTL-OPT.
  2090             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2091                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2092                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2093             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2094                                            PIC X.
  2095         16  CF-GROUP-CNTL-OPT.
  2096             20  CF-GROUP-OPT-SEQ           PIC 9.
  2097                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2098                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2099             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2100                                            PIC X(6).
  2101         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  38
* SOCK03.cbl
  2102             20  CF-STATE-OPT-SEQ           PIC 9.
  2103                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2104                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2105             20  CF-STATE-SELECT OCCURS 3 TIMES
  2106                                            PIC XX.
  2107         16  CF-ACCOUNT-CNTL-OPT.
  2108             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2109                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2110                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2111             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2112                                            PIC X(10).
  2113         16  CF-BUS-TYP-CNTL-OPT.
  2114             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2115                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2116                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2117             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2118                                            PIC XX.
  2119         16  CF-LF-TYP-CNTL-OPT.
  2120             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2121                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2122                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2123             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2124                                            PIC XX.
  2125         16  CF-AH-TYP-CNTL-OPT.
  2126             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2127                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2128                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2129             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2130                                            PIC XX.
  2131         16  CF-REPTCD1-CNTL-OPT.
  2132             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2133                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2134                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2135             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2136                                            PIC X(10).
  2137         16  CF-REPTCD2-CNTL-OPT.
  2138             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2139                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2140                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2141             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2142                                            PIC X(10).
  2143         16  CF-USER1-CNTL-OPT.
  2144             20  CF-USER1-OPT-SEQ           PIC 9.
  2145                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2146                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2147             20  CF-USER1-SELECT OCCURS 3 TIMES
  2148                                            PIC X(10).
  2149         16  CF-USER2-CNTL-OPT.
  2150             20  CF-USER2-OPT-SEQ           PIC 9.
  2151                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2152                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2153             20  CF-USER2-SELECT OCCURS 3 TIMES
  2154                                            PIC X(10).
  2155         16  CF-USER3-CNTL-OPT.
  2156             20  CF-USER3-OPT-SEQ           PIC 9.
  2157                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2158                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2159             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  39
* SOCK03.cbl
  2160                                            PIC X(10).
  2161         16  CF-USER4-CNTL-OPT.
  2162             20  CF-USER4-OPT-SEQ           PIC 9.
  2163                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2164                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2165             20  CF-USER4-SELECT OCCURS 3 TIMES
  2166                                            PIC X(10).
  2167         16  CF-USER5-CNTL-OPT.
  2168             20  CF-USER5-OPT-SEQ           PIC 9.
  2169                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2170                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2171             20  CF-USER5-SELECT OCCURS 3 TIMES
  2172                                            PIC X(10).
  2173         16  CF-REINS-CNTL-OPT.
  2174             20  CF-REINS-OPT-SEQ           PIC 9.
  2175                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2176                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2177             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2178                 24  CF-REINS-PRIME         PIC XXX.
  2179                 24  CF-REINS-SUB           PIC XXX.
  2180
  2181         16  CF-AGENT-CNTL-OPT.
  2182             20  CF-AGENT-OPT-SEQ           PIC 9.
  2183                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2184                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2185             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2186                                            PIC X(10).
  2187
  2188         16  FILLER                         PIC X(43).
  2189
  2190         16  CF-LOSS-RATIO-SELECT.
  2191             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2192             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2193         16  CF-ENTRY-DATE-SELECT.
  2194             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2195             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2196         16  CF-EFFECTIVE-DATE-SELECT.
  2197             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2198             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2199
  2200         16  CF-EXCEPTION-LIST-IND          PIC X.
  2201             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2202
  2203         16  FILLER                         PIC X(318).
  2204
  2205****************************************************************
  2206*                  EXCEPTION REPORTING RECORD                  *
  2207****************************************************************
  2208
  2209     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2210         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2211             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2212
  2213         16  CF-COMBINED-LIFE-AH-OPT.
  2214             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2215             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2216             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2217             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  40
* SOCK03.cbl
  2218
  2219         16  CF-LIFE-OPT.
  2220             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2221             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2222             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2223             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2224             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2225             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2226             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2227             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2228             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2229             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2230
  2231         16  CF-AH-OPT.
  2232             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2233             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2234             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2235             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2236             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2237             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2238             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2239             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2240             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2241             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2242
  2243         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2244             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2245             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2246             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2247
  2248         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2249
  2250         16  FILLER                         PIC X(673).
  2251
  2252
  2253****************************************************************
  2254*             MORTGAGE SYSTEM PLAN RECORD                      *
  2255****************************************************************
  2256
  2257     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2258         16  CF-PLAN-TYPE                   PIC X.
  2259             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2260             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2261             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2262         16  CF-PLAN-ABBREV                 PIC XXX.
  2263         16  CF-PLAN-DESCRIPT               PIC X(10).
  2264         16  CF-PLAN-NOTES                  PIC X(20).
  2265         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2266         16  CF-PLAN-UNDERWRITING.
  2267             20  CF-PLAN-TERM-DATA.
  2268                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2269                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2270             20  CF-PLAN-AGE-DATA.
  2271                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2272                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2273                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2274             20  CF-PLAN-BENEFIT-DATA.
  2275                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  41
* SOCK03.cbl
  2276                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2277                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2278                                            PIC S9(7)V99  COMP-3.
  2279         16  CF-PLAN-POLICY-FORMS.
  2280             20  CF-POLICY-FORM             PIC X(12).
  2281             20  CF-MASTER-APPLICATION      PIC X(12).
  2282             20  CF-MASTER-POLICY           PIC X(12).
  2283         16  CF-PLAN-RATING.
  2284             20  CF-RATE-CODE               PIC X(5).
  2285             20  CF-SEX-RATING              PIC X.
  2286                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2287                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2288             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2289             20  CF-SUB-STD-TYPE            PIC X.
  2290                 88  CF-PCT-OF-PREM            VALUE '1'.
  2291                 88  CF-PCT-OF-BENE            VALUE '2'.
  2292         16  CF-PLAN-PREM-TOLERANCES.
  2293             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2294             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2295         16  CF-PLAN-PYMT-TOLERANCES.
  2296             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2297             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2298         16  CF-PLAN-MISC-DATA.
  2299             20  FILLER                     PIC X.
  2300             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2301             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2302         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2303         16  CF-PLAN-IND-GRP                PIC X.
  2304             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2305                                                     '1'.
  2306             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2307                                                     '2'.
  2308         16  CF-MIB-SEARCH-SW               PIC X.
  2309             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2310             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2311             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2312             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2313         16  CF-ALPHA-SEARCH-SW             PIC X.
  2314             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2315             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2316             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2317             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2318             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2319             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2320             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2321             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2322             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2323             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2324                                                     'A' 'B' 'C'
  2325                                                     'X' 'Y' 'Z'.
  2326         16  CF-EFF-DT-RULE-SW              PIC X.
  2327             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2328             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2329             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2330             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2331             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2332         16  FILLER                         PIC X(4).
  2333         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  42
* SOCK03.cbl
  2334             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2335         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2336         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2337         16  CF-PLAN-SNGL-JNT               PIC X.
  2338             88  CF-COMBINED-PLAN              VALUE 'C'.
  2339             88  CF-JNT-PLAN                   VALUE 'J'.
  2340             88  CF-SNGL-PLAN                  VALUE 'S'.
  2341         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2342         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2343         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2344         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2345         16  CF-RERATE-CNTL                 PIC  X.
  2346             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2347             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2348             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2349             88  CF-AUTO-RECALC                 VALUE '4'.
  2350         16  CF-BENEFIT-TYPE                PIC  X.
  2351             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2352             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2353         16  CF-POLICY-FEE                  PIC S999V99
  2354                                                    COMP-3.
  2355         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2356         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2357         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2358         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2359         16  FILLER                         PIC  X(32).
  2360         16  CF-TERMINATION-FORM            PIC  X(04).
  2361         16  FILLER                         PIC  X(08).
  2362         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2363                                                       COMP-3.
  2364         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2365         16  CF-ISSUE-LETTER                PIC  X(4).
  2366         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2367         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2368             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2369             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2370         16  CF-MP-REFUND-CALC              PIC X.
  2371             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2372             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2373             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2374             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2375             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2376             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2377             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2378             88  CF-MP-REFD-MEAN                VALUE '8'.
  2379         16  CF-ALT-RATE-CODE               PIC  X(5).
  2380
  2381
  2382         16  FILLER                         PIC X(498).
  2383****************************************************************
  2384*             MORTGAGE COMPANY MASTER RECORD                   *
  2385****************************************************************
  2386
  2387     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2388         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2389         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2390             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2391             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  43
* SOCK03.cbl
  2392             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2393             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2394             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2395
  2396         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2397         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2398         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2399         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2400         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2401
  2402         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2403             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2404         16  CF-MP-RECON-USE-IND            PIC X(1).
  2405             88  CF-MP-USE-RECON             VALUE 'Y'.
  2406         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2407             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2408         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2409             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2410             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2411         16  FILLER                         PIC X(1).
  2412         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2413             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2414         16  CF-MORTG-MIB-VERSION           PIC X.
  2415             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2416             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2417             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2418         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2419             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2420                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2421             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2422                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2423             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2424                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2425             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2426                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2427             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2428                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2429             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2430                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2431         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2432         16  FILLER                         PIC X(7).
  2433         16  CF-MORTG-DESTINATION-SYMBOL.
  2434             20  CF-MORTG-MIB-COMM          PIC X(5).
  2435             20  CF-MORTG-MIB-TERM          PIC X(5).
  2436         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2437             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2438         16  FILLER                         PIC X(03).
  2439         16  CF-MP-CHECK-NO-CONTROL.
  2440             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2441                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2442                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2443                                                ' ' LOW-VALUES.
  2444                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2445                                               VALUE '3'.
  2446         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2447         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2448         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2449             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  44
* SOCK03.cbl
  2450                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2451             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2452                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2453             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2454                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2455             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2456                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2457             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2458                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2459             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2460                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2461         16  CF-MORTG-BILLING-AREA.
  2462             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2463                                            PIC X.
  2464         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2465         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2466         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2467         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2468             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2469             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2470         16  FILLER                         PIC X.
  2471         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2472             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2473             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2474         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2475         16  FILLER                         PIC X(8).
  2476         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2477         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2478         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2479         16  CF-ACH-COMPANY-ID.
  2480             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2481                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2482                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2483                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2484             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2485         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2486             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2487         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2488             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2489             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2490         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2491         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2492         16  FILLER                         PIC X(536).
  2493
  2494****************************************************************
  2495*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2496****************************************************************
  2497
  2498     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2499         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2500             20  CF-FEMALE-HEIGHT.
  2501                 24  CF-FEMALE-FT           PIC 99.
  2502                 24  CF-FEMALE-IN           PIC 99.
  2503             20  CF-FEMALE-MIN-WT           PIC 999.
  2504             20  CF-FEMALE-MAX-WT           PIC 999.
  2505         16  FILLER                         PIC X(428).
  2506
  2507     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  45
* SOCK03.cbl
  2508         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2509             20  CF-MALE-HEIGHT.
  2510                 24  CF-MALE-FT             PIC 99.
  2511                 24  CF-MALE-IN             PIC 99.
  2512             20  CF-MALE-MIN-WT             PIC 999.
  2513             20  CF-MALE-MAX-WT             PIC 999.
  2514         16  FILLER                         PIC X(428).
  2515******************************************************************
  2516*             AUTOMATIC ACTIVITY RECORD                          *
  2517******************************************************************
  2518     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2519         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2520             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2521             20  CF-SYS-LETTER-ID           PIC X(04).
  2522             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2523             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2524             20  CF-SYS-RESET-SW            PIC X(01).
  2525             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2526             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2527
  2528         16  FILLER                         PIC X(50).
  2529
  2530         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2531             20  CF-USER-ACTIVE-SW          PIC X(01).
  2532             20  CF-USER-LETTER-ID          PIC X(04).
  2533             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2534             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2535             20  CF-USER-RESET-SW           PIC X(01).
  2536             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2537             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2538             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2539
  2540         16  FILLER                         PIC X(246).
  2541*                                 COPY ERCACCT.
  2542******************************************************************
  2543*                                                                *
  2544*                                                                *
  2545*                            ERCACCT                             *
  2546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2547*                            VMOD=2.031                          *
  2548*                                                                *
  2549*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2550*                                                                *
  2551*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2552*   VSAM ACCOUNT MASTER FILES.                                   *
  2553*                                                                *
  2554*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2555*                                                                *
  2556*   FILE TYPE = VSAM,KSDS                                        *
  2557*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2558*                                                                *
  2559*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2560*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2561*                                                                *
  2562*   LOG = NO                                                     *
  2563*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2564*                                                                *
  2565*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  46
* SOCK03.cbl
  2566******************************************************************
  2567*                   C H A N G E   L O G
  2568*
  2569* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2570*-----------------------------------------------------------------
  2571*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2572* EFFECTIVE    NUMBER
  2573*-----------------------------------------------------------------
  2574* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2575* 092705    2005050300006  PEMA  ADD SPP LEASES
  2576* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2577* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2578* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2579* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2580* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2581******************************************************************
  2582
  2583 01  ACCOUNT-MASTER.
  2584     12  AM-RECORD-ID                      PIC XX.
  2585         88  VALID-AM-ID                      VALUE 'AM'.
  2586
  2587     12  AM-CONTROL-PRIMARY.
  2588         16  AM-COMPANY-CD                 PIC X.
  2589         16  AM-MSTR-CNTRL.
  2590             20  AM-CONTROL-A.
  2591                 24  AM-CARRIER            PIC X.
  2592                 24  AM-GROUPING.
  2593                     28 AM-GROUPING-PREFIX PIC XXX.
  2594                     28 AM-GROUPING-PRIME  PIC XXX.
  2595                 24  AM-STATE              PIC XX.
  2596                 24  AM-ACCOUNT.
  2597                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2598                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2599             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2600                                           PIC X(19).
  2601             20  AM-CNTRL-B.
  2602                 24  AM-EXPIRATION-DT      PIC XX.
  2603                 24  FILLER                PIC X(4).
  2604             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2605                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2606
  2607     12  AM-CONTROL-BY-VAR-GRP.
  2608         16  AM-COMPANY-CD-A1              PIC X.
  2609         16  AM-VG-CARRIER                 PIC X.
  2610         16  AM-VG-GROUPING                PIC X(6).
  2611         16  AM-VG-STATE                   PIC XX.
  2612         16  AM-VG-ACCOUNT                 PIC X(10).
  2613         16  AM-VG-DATE.
  2614             20  AM-VG-EXPIRATION-DT       PIC XX.
  2615             20  FILLER                    PIC X(4).
  2616         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2617                                           PIC 9(11)      COMP-3.
  2618     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2619         16  FILLER                        PIC X(10).
  2620         16  AM-VG-KEY3.
  2621             20  AM-VG3-ACCOUNT            PIC X(10).
  2622             20  AM-VG3-EXP-DT             PIC XX.
  2623         16  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  47
* SOCK03.cbl
  2624     12  AM-MAINT-INFORMATION.
  2625         16  AM-LAST-MAINT-DT              PIC XX.
  2626         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2627         16  AM-LAST-MAINT-USER            PIC X(4).
  2628         16  FILLER                        PIC XX.
  2629
  2630     12  AM-EFFECTIVE-DT                   PIC XX.
  2631     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2632
  2633     12  AM-PREV-DATES  COMP-3.
  2634         16  AM-PREV-EXP-DT                PIC 9(11).
  2635         16  AM-PREV-EFF-DT                PIC 9(11).
  2636
  2637     12  AM-REPORT-CODE-1                  PIC X(10).
  2638     12  AM-REPORT-CODE-2                  PIC X(10).
  2639
  2640     12  AM-CITY-CODE                      PIC X(4).
  2641     12  AM-COUNTY-PARISH                  PIC X(6).
  2642
  2643     12  AM-NAME                           PIC X(30).
  2644     12  AM-PERSON                         PIC X(30).
  2645     12  AM-ADDRS                          PIC X(30).
  2646     12  AM-CITY.
  2647         16  AM-ADDR-CITY                  PIC X(28).
  2648         16  AM-ADDR-STATE                 PIC XX.
  2649     12  AM-ZIP.
  2650         16  AM-ZIP-PRIME.
  2651             20  AM-ZIP-PRI-1ST            PIC X.
  2652                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2653             20  FILLER                    PIC X(4).
  2654         16  AM-ZIP-PLUS4                  PIC X(4).
  2655     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2656         16  AM-CAN-POSTAL-1               PIC XXX.
  2657         16  AM-CAN-POSTAL-2               PIC XXX.
  2658         16  FILLER                        PIC XXX.
  2659     12  AM-TEL-NO.
  2660         16  AM-AREA-CODE                  PIC 999.
  2661         16  AM-TEL-PRE                    PIC 999.
  2662         16  AM-TEL-NBR                    PIC 9(4).
  2663     12  AM-TEL-LOC                        PIC X.
  2664         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2665         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2666
  2667     12  AM-COMM-STRUCTURE.
  2668         16  AM-DEFN-1.
  2669             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2670                 24  AM-AGT.
  2671                     28  AM-AGT-PREFIX     PIC X(4).
  2672                     28  AM-AGT-PRIME      PIC X(6).
  2673                 24  AM-COM-TYP            PIC X.
  2674                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2675                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2676                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2677                 24  AM-RECALC-LV-INDIC    PIC X.
  2678                 24  AM-RETRO-LV-INDIC     PIC X.
  2679                 24  AM-GL-CODES           PIC X.
  2680                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2681                 24  FILLER                PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  48
* SOCK03.cbl
  2682         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2683             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2684                 24  FILLER                PIC X(11).
  2685                 24  AM-L-COMA             PIC XXX.
  2686                 24  AM-J-COMA             PIC XXX.
  2687                 24  AM-A-COMA             PIC XXX.
  2688                 24  FILLER                PIC X(6).
  2689
  2690     12  AM-COMM-CHANGE-STATUS             PIC X.
  2691         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2692
  2693     12  AM-CSR-CODE                       PIC X(4).
  2694
  2695     12  AM-BILLING-STATUS                 PIC X.
  2696         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2697         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2698     12  AM-AUTO-REFUND-SW                 PIC X.
  2699         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2700         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2701     12  AM-GPCD                           PIC 99.
  2702     12  AM-IG                             PIC X.
  2703         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2704         88  AM-HAS-GROUP                     VALUE '2'.
  2705     12  AM-STATUS                         PIC X.
  2706         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2707         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2708         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2709         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2710         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2711         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2712     12  AM-REMIT-TO                       PIC 99.
  2713     12  AM-ID-NO                          PIC X(11).
  2714
  2715     12  AM-CAL-TABLE                      PIC XX.
  2716     12  AM-LF-DEVIATION                   PIC XXX.
  2717     12  AM-AH-DEVIATION                   PIC XXX.
  2718     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2719     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2720     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2721     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2722     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2723     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2724
  2725     12  AM-USER-FIELDS.
  2726         16  AM-FLD-1                      PIC XX.
  2727         16  AM-FLD-2                      PIC XX.
  2728         16  AM-FLD-3                      PIC XX.
  2729         16  AM-FLD-4                      PIC XX.
  2730         16  AM-FLD-5                      PIC XX.
  2731
  2732     12  AM-1ST-PROD-DATE.
  2733         16  AM-1ST-PROD-YR                PIC XX.
  2734         16  AM-1ST-PROD-MO                PIC XX.
  2735         16  AM-1ST-PROD-DA                PIC XX.
  2736     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2737     12  AM-CERTS-PURGED-DATE.
  2738         16  AM-PUR-YR                     PIC XX.
  2739         16  AM-PUR-MO                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  49
* SOCK03.cbl
  2740         16  AM-PUR-DA                     PIC XX.
  2741     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2742     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2743     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2744     12  AM-INACTIVE-DATE.
  2745         16  AM-INA-MO                     PIC 99.
  2746         16  AM-INA-DA                     PIC 99.
  2747         16  AM-INA-YR                     PIC 99.
  2748     12  AM-AR-HI-CERT-DATE                PIC XX.
  2749
  2750     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2751     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2752
  2753     12  AM-OB-PAYMENT-MODE                PIC X.
  2754         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2755         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2756         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2757         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2758
  2759     12  AM-AH-ONLY-INDICATOR              PIC X.
  2760         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2761         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2762
  2763     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2764
  2765     12  AM-OVER-SHORT.
  2766         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2767         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2768
  2769     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2770     12  AM-DCC-CLP-STATE                  PIC XX.
  2771
  2772     12  AM-RECALC-COMM                    PIC X.
  2773     12  AM-RECALC-REIN                    PIC X.
  2774
  2775     12  AM-REI-TABLE                      PIC XXX.
  2776     12  AM-REI-ET-LF                      PIC X.
  2777     12  AM-REI-ET-AH                      PIC X.
  2778     12  AM-REI-PE-LF                      PIC X.
  2779     12  AM-REI-PE-AH                      PIC X.
  2780     12  AM-REI-PRT-ST                     PIC X.
  2781     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2782     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2783     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2784     12  AM-REI-GROUP-A                    PIC X(6).
  2785     12  AM-REI-MORT                       PIC X(4).
  2786     12  AM-REI-PRT-OW                     PIC X.
  2787     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2788     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2789     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2790     12  AM-REI-GROUP-B                    PIC X(6).
  2791
  2792     12  AM-TRUST-TYPE                     PIC X(2).
  2793
  2794     12  AM-EMPLOYER-STMT-USED             PIC X.
  2795     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2796
  2797     12  AM-STD-AH-TYPE                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  50
* SOCK03.cbl
  2798     12  AM-EARN-METHODS.
  2799         16  AM-EARN-METHOD-R              PIC X.
  2800             88 AM-REF-RL-R78                 VALUE 'R'.
  2801             88 AM-REF-RL-PR                  VALUE 'P'.
  2802             88 AM-REF-RL-MEAN                VALUE 'M'.
  2803             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2804         16  AM-EARN-METHOD-L              PIC X.
  2805             88 AM-REF-LL-R78                 VALUE 'R'.
  2806             88 AM-REF-LL-PR                  VALUE 'P'.
  2807             88 AM-REF-LL-MEAN                VALUE 'M'.
  2808             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2809         16  AM-EARN-METHOD-A              PIC X.
  2810             88 AM-REF-AH-R78                 VALUE 'R'.
  2811             88 AM-REF-AH-PR                  VALUE 'P'.
  2812             88 AM-REF-AH-MEAN                VALUE 'M'.
  2813             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2814             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2815             88 AM-REF-AH-NET                 VALUE 'N'.
  2816
  2817     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2818     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2819     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2820
  2821     12  AM-RET-Y-N                        PIC X.
  2822     12  AM-RET-P-E                        PIC X.
  2823     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2824     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2825     12  AM-RET-GRP                        PIC X(6).
  2826     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2827         16  AM-POOL-PRIME                 PIC XXX.
  2828         16  AM-POOL-SUB                   PIC XXX.
  2829     12  AM-RETRO-EARNINGS.
  2830         16  AM-RET-EARN-R                 PIC X.
  2831         16  AM-RET-EARN-L                 PIC X.
  2832         16  AM-RET-EARN-A                 PIC X.
  2833     12  AM-RET-ST-TAX-USE                 PIC X.
  2834         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2835         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2836     12  AM-RETRO-BEG-EARNINGS.
  2837         16  AM-RET-BEG-EARN-R             PIC X.
  2838         16  AM-RET-BEG-EARN-L             PIC X.
  2839         16  AM-RET-BEG-EARN-A             PIC X.
  2840     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2841     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2842
  2843     12  AM-USER-SELECT-OPTIONS.
  2844         16  AM-USER-SELECT-1              PIC X(10).
  2845         16  AM-USER-SELECT-2              PIC X(10).
  2846         16  AM-USER-SELECT-3              PIC X(10).
  2847         16  AM-USER-SELECT-4              PIC X(10).
  2848         16  AM-USER-SELECT-5              PIC X(10).
  2849
  2850     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2851
  2852     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2853
  2854     12  AM-RPT045A-SWITCH                 PIC X.
  2855         88  RPT045A-OFF                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  51
* SOCK03.cbl
  2856
  2857     12  AM-INSURANCE-LIMITS.
  2858         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2859         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2860
  2861     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2862         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2863
  2864     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2865         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2866         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2867
  2868     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2869
  2870     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2871     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2872     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2873     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2874     12  AM-DCC-UEF-STATE                  PIC XX.
  2875     12  FILLER                            PIC XXX.
  2876     12  AM-REPORT-CODE-3                  PIC X(10).
  2877*    12  FILLER                            PIC X(22).
  2878
  2879     12  AM-RESERVE-DATE.
  2880         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2881         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2882         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2883
  2884     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2885     12  AM-NOTIFICATION-TYPES.
  2886         16  AM-NOTIF-OF-LETTERS           PIC X.
  2887         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2888         16  AM-NOTIF-OF-REPORTS           PIC X.
  2889         16  AM-NOTIF-OF-STATUS            PIC X.
  2890
  2891     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2892         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2893         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2894         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2895         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2896
  2897     12  AM-BENEFIT-CONTROLS.
  2898         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2899             20  AM-BENEFIT-CODE           PIC XX.
  2900             20  AM-BENEFIT-TYPE           PIC X.
  2901             20  AM-BENEFIT-REVISION       PIC XXX.
  2902             20  AM-BENEFIT-REM-TERM       PIC X.
  2903             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2904             20  FILLER                    PIC XX.
  2905         16  FILLER                        PIC X(80).
  2906
  2907     12  AM-TRANSFER-DATA.
  2908         16  AM-TRANSFERRED-FROM.
  2909             20  AM-TRNFROM-CARRIER        PIC X.
  2910             20  AM-TRNFROM-GROUPING.
  2911                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2912                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2913             20  AM-TRNFROM-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  52
* SOCK03.cbl
  2914             20  AM-TRNFROM-ACCOUNT.
  2915                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2916                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2917             20  AM-TRNFROM-DTE            PIC XX.
  2918         16  AM-TRANSFERRED-TO.
  2919             20  AM-TRNTO-CARRIER          PIC X.
  2920             20  AM-TRNTO-GROUPING.
  2921                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2922                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2923             20  AM-TRNTO-STATE            PIC XX.
  2924             20  AM-TRNTO-ACCOUNT.
  2925                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2926                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2927             20  AM-TRNTO-DTE              PIC XX.
  2928         16  FILLER                        PIC X(10).
  2929
  2930     12  AM-SAVED-REMIT-TO                 PIC 99.
  2931
  2932     12  AM-COMM-STRUCTURE-SAVED.
  2933         16  AM-DEFN-1-SAVED.
  2934             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2935                 24  AM-AGT-SV             PIC X(10).
  2936                 24  AM-COM-TYP-SV         PIC X.
  2937                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2938                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2939                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2940                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2941                 24  FILLER                PIC X.
  2942                 24  AM-GL-CODES-SV        PIC X.
  2943                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2944                 24  FILLER                PIC X.
  2945         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2946             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2947                 24  FILLER                PIC X(11).
  2948                 24  AM-L-COMA-SV          PIC XXX.
  2949                 24  AM-J-COMA-SV          PIC XXX.
  2950                 24  AM-A-COMA-SV          PIC XXX.
  2951                 24  FILLER                PIC X(6).
  2952
  2953     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2954         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2955            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2956            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2957            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2958
  2959     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2960     12  FILLER                            PIC X(120).
  2961
  2962     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2963         16  AM-CONTROL-NAME               PIC X(30).
  2964         16  AM-EXECUTIVE-ONE.
  2965             20  AM-EXEC1-NAME             PIC X(15).
  2966             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2967                                                          COMP-3.
  2968             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2969                                                          COMP-3.
  2970         16  AM-EXECUTIVE-TWO.
  2971             20  AM-EXEC2-NAME             PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  53
* SOCK03.cbl
  2972             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2973                                                          COMP-3.
  2974             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2975                                                          COMP-3.
  2976
  2977     12  AM-RETRO-ADDITIONAL-DATA.
  2978         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2979         16  AM-RETRO-PREM-P-E             PIC X.
  2980         16  AM-RETRO-CLMS-P-I             PIC X.
  2981         16  AM-RETRO-RET-BRACKET-LF.
  2982             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2983                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2984                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2985             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2986                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2987                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2988             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2989                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2990                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2991         16  AM-RETRO-RET-BRACKET-AH.
  2992             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2993                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2994                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2995                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2996             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2997                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2998                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2999             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3000                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3001                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3002
  3003     12  AM-COMMENTS.
  3004         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3005
  3006     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3007         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3008         16  AM-FLI-BILLING-CODE           PIC X.
  3009         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3010         16  AM-FLI-UNITED-IDENT           PIC X.
  3011         16  AM-FLI-INTEREST-LOST-DATA.
  3012             20  AM-FLI-BANK-NO            PIC X(5).
  3013             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3014             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3015             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3016         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3017             20  AM-FLI-AGT                PIC X(9).
  3018             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3019             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3020         16  FILLER                        PIC X(102).
  3021
  3022     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3023         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3024             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3025             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3026             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3027             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3028             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3029         16  FILLER                          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  54
* SOCK03.cbl
  3030******************************************************************
  3031*                                 COPY ELCDATE.
  3032******************************************************************
  3033*                                                                *
  3034*                                                                *
  3035*                            ELCDATE.                            *
  3036*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3037*                            VMOD=2.003
  3038*                                                                *
  3039*                                                                *
  3040*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3041*                 LENGTH = 200                                   *
  3042******************************************************************
  3043
  3044 01  DATE-CONVERSION-DATA.
  3045     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3046     12  DC-OPTION-CODE                PIC X.
  3047         88  BIN-TO-GREG                VALUE ' '.
  3048         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3049         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3050         88  YMD-GREG-TO-BIN            VALUE '3'.
  3051         88  MDY-GREG-TO-BIN            VALUE '4'.
  3052         88  JULIAN-TO-BIN              VALUE '5'.
  3053         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3054         88  FIND-CENTURY               VALUE '7'.
  3055         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3056         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3057         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3058         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3059         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3060         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3061         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3062         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3063         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3064         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3065         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3066         88  BIN-3-TO-GREG              VALUE 'I'.
  3067         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3068         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3069         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3070         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3071         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3072         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3073         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3074         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3075         88  THREE-CHARACTER-BIN
  3076                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3077         88  GREGORIAN-TO-BIN
  3078                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3079         88  BIN-TO-GREGORIAN
  3080                  VALUES ' ' '1' 'I' '8' 'G'.
  3081         88  JULIAN-TO-BINARY
  3082                  VALUES '5' 'C' 'E' 'F'.
  3083     12  DC-ERROR-CODE                 PIC X.
  3084         88  NO-CONVERSION-ERROR        VALUE ' '.
  3085         88  DATE-CONVERSION-ERROR
  3086                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3087         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  55
* SOCK03.cbl
  3088         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3089         88  DATE-IS-INVALID            VALUE '3'.
  3090         88  DATE1-GREATER-DATE2        VALUE '4'.
  3091         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3092         88  DATE-INVALID-OPTION        VALUE '9'.
  3093         88  INVALID-CENTURY            VALUE 'A'.
  3094         88  ONLY-CENTURY               VALUE 'B'.
  3095         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3096         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3097     12  DC-END-OF-MONTH               PIC X.
  3098         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3099     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3100         88  USE-NORMAL-PROCESS         VALUE ' '.
  3101         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3102         88  ADJUST-UP-100-YRS          VALUE '2'.
  3103     12  FILLER                        PIC X.
  3104     12  DC-CONVERSION-DATES.
  3105         16  DC-BIN-DATE-1             PIC XX.
  3106         16  DC-BIN-DATE-2             PIC XX.
  3107         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3108         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3109                       DC-GREG-DATE-1-EDIT.
  3110             20  DC-EDIT1-MONTH        PIC 99.
  3111             20  SLASH1-1              PIC X.
  3112             20  DC-EDIT1-DAY          PIC 99.
  3113             20  SLASH1-2              PIC X.
  3114             20  DC-EDIT1-YEAR         PIC 99.
  3115         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3116         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3117                     DC-GREG-DATE-2-EDIT.
  3118             20  DC-EDIT2-MONTH        PIC 99.
  3119             20  SLASH2-1              PIC X.
  3120             20  DC-EDIT2-DAY          PIC 99.
  3121             20  SLASH2-2              PIC X.
  3122             20  DC-EDIT2-YEAR         PIC 99.
  3123         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3124         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3125                     DC-GREG-DATE-1-YMD.
  3126             20  DC-YMD-YEAR           PIC 99.
  3127             20  DC-YMD-MONTH          PIC 99.
  3128             20  DC-YMD-DAY            PIC 99.
  3129         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3130         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3131                      DC-GREG-DATE-1-MDY.
  3132             20  DC-MDY-MONTH          PIC 99.
  3133             20  DC-MDY-DAY            PIC 99.
  3134             20  DC-MDY-YEAR           PIC 99.
  3135         16  DC-GREG-DATE-1-ALPHA.
  3136             20  DC-ALPHA-MONTH        PIC X(10).
  3137             20  DC-ALPHA-DAY          PIC 99.
  3138             20  FILLER                PIC XX.
  3139             20  DC-ALPHA-CENTURY.
  3140                 24 DC-ALPHA-CEN-N     PIC 99.
  3141             20  DC-ALPHA-YEAR         PIC 99.
  3142         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3143         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3144         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3145         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  56
* SOCK03.cbl
  3146         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3147                                       PIC 9(05).
  3148         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3149             20  DC-JULIAN-YEAR        PIC 99.
  3150             20  DC-JULIAN-DAYS        PIC 999.
  3151         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3152         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3153         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3154     12  DATE-CONVERSION-VARIBLES.
  3155         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3156         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3157             20  FILLER                PIC 9(3).
  3158             20  HOLD-CEN-1-CCYY.
  3159                 24  HOLD-CEN-1-CC     PIC 99.
  3160                 24  HOLD-CEN-1-YY     PIC 99.
  3161             20  HOLD-CEN-1-MO         PIC 99.
  3162             20  HOLD-CEN-1-DA         PIC 99.
  3163         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3164             20  HOLD-CEN-1-R-MO       PIC 99.
  3165             20  HOLD-CEN-1-R-DA       PIC 99.
  3166             20  HOLD-CEN-1-R-CCYY.
  3167                 24  HOLD-CEN-1-R-CC   PIC 99.
  3168                 24  HOLD-CEN-1-R-YY   PIC 99.
  3169             20  FILLER                PIC 9(3).
  3170         16  HOLD-CENTURY-1-X.
  3171             20  FILLER                PIC X(3)  VALUE SPACES.
  3172             20  HOLD-CEN-1-X-CCYY.
  3173                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3174                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3175             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3176             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3177         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3178             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3179             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3180             20  HOLD-CEN-1-R-X-CCYY.
  3181                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3182                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3183             20  FILLER                PIC XXX.
  3184         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3185         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3186         16  DC-JULIAN-DATE-1          PIC 9(07).
  3187         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3188             20  DC-JULIAN-1-CCYY.
  3189                 24  DC-JULIAN-1-CC    PIC 99.
  3190                 24  DC-JULIAN-1-YR    PIC 99.
  3191             20  DC-JULIAN-DA-1        PIC 999.
  3192         16  DC-JULIAN-DATE-2          PIC 9(07).
  3193         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3194             20  DC-JULIAN-2-CCYY.
  3195                 24  DC-JULIAN-2-CC    PIC 99.
  3196                 24  DC-JULIAN-2-YR    PIC 99.
  3197             20  DC-JULIAN-DA-2        PIC 999.
  3198         16  DC-GREG-DATE-A-EDIT.
  3199             20  DC-EDITA-MONTH        PIC 99.
  3200             20  SLASHA-1              PIC X VALUE '/'.
  3201             20  DC-EDITA-DAY          PIC 99.
  3202             20  SLASHA-2              PIC X VALUE '/'.
  3203             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  57
* SOCK03.cbl
  3204                 24  DC-EDITA-CENT     PIC 99.
  3205                 24  DC-EDITA-YEAR     PIC 99.
  3206         16  DC-GREG-DATE-B-EDIT.
  3207             20  DC-EDITB-MONTH        PIC 99.
  3208             20  SLASHB-1              PIC X VALUE '/'.
  3209             20  DC-EDITB-DAY          PIC 99.
  3210             20  SLASHB-2              PIC X VALUE '/'.
  3211             20  DC-EDITB-CCYY.
  3212                 24  DC-EDITB-CENT     PIC 99.
  3213                 24  DC-EDITB-YEAR     PIC 99.
  3214         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3215         16  DC-GREG-DATE-CYMD-R REDEFINES
  3216                              DC-GREG-DATE-CYMD.
  3217             20  DC-CYMD-CEN           PIC 99.
  3218             20  DC-CYMD-YEAR          PIC 99.
  3219             20  DC-CYMD-MONTH         PIC 99.
  3220             20  DC-CYMD-DAY           PIC 99.
  3221         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3222         16  DC-GREG-DATE-MDCY-R REDEFINES
  3223                              DC-GREG-DATE-MDCY.
  3224             20  DC-MDCY-MONTH         PIC 99.
  3225             20  DC-MDCY-DAY           PIC 99.
  3226             20  DC-MDCY-CEN           PIC 99.
  3227             20  DC-MDCY-YEAR          PIC 99.
  3228    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3229        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3230    12  DC-EL310-DATE                  PIC X(21).
  3231    12  FILLER                         PIC X(28).
  3232*                                 COPY ELCCALC.
  3233******************************************************************
  3234*                                                                *
  3235*                           ELCCALC.                            *
  3236*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3237*                            VMOD=2.025                          *
  3238*                                                                *
  3239*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3240*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3241*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3242*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3243*                                                                *
  3244*  PASSED TO ELRTRM                                              *
  3245*  -----------------                                             *
  3246*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3247*  ORIGINAL TERM                                                 *
  3248*  BEGINNING DATE                                                *
  3249*  ENDING DATE                                                   *
  3250*  COMPANY I.D.                                                  *
  3251*  ACCOUNT MASTER USER FIELD                                     *
  3252*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3253*  FREE LOOK DAYS                                                *
  3254*                                                                *
  3255*  RETURNED FROM ELRTRM                                          *
  3256*  ---------------------                                         *
  3257*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3258*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3259*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3260*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3261*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  58
* SOCK03.cbl
  3262*  PASSED TO ELRAMT                                              *
  3263*  ----------------                                              *
  3264*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3265*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3266*  ORIGINAL AMOUNT                                               *
  3267*  ALTERNATE BENEFIT (BALLON)                                    *
  3268*  A.P.R. - NET PAY ONLY                                         *
  3269*  METHOD
  3270*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3271*  COMPANY I.D.                                                  *
  3272*  BENEFIT TYPE                                                  *
  3273*                                                                *
  3274*  RETURNED FROM ELRAMT                                          *
  3275*  --------------------                                          *
  3276*  REMAINING AMOUNT 1 - CURRENT                                  *
  3277*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3278*  REMAINING AMOUNT FACTOR
  3279*----------------------------------------------------------------*
  3280*  PASSED TO ELRESV                                              *
  3281*  -----------------                                             *
  3282*  CERTIFICATE EFFECTIVE DATE                                    *
  3283*  VALUATION DATE                                                *
  3284*  PAID THRU DATE                                                *
  3285*  BENEFIT                                                       *
  3286*  INCURRED DATE                                                 *
  3287*  REPORTED DATE                                                 *
  3288*  ISSUE AGE                                                     *
  3289*  TERM                                                          *
  3290*  CDT PERCENT                                                   *
  3291*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3292* *CLAIM TYPE (LIFE, A/H)                                        *
  3293* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3294* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3295*                                                                *
  3296*  RETURNED FROM ELRESV                                          *
  3297*  --------------------                                          *
  3298*  CDT TABLE USED                                                *
  3299*  CDT FACTOR USED                                               *
  3300*  PAY TO CURRENT RESERVE                                        *
  3301*  I.B.N.R. - A/H ONLY                                           *
  3302*  FUTURE (ACCRUED) AH ONLY                                      *
  3303*----------------------------------------------------------------*
  3304*  PASSED TO ELRATE                                              *
  3305*  ----------------                                              *
  3306*  CERT ISSUE DATE                                               *
  3307*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3308*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3309*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3310*  STATE CODE (CLIENT DEFINED)                                   *
  3311*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3312*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3313*  DEVIATION CODE                                                *
  3314*  ISSUE AGE                                                     *
  3315*  ORIGINAL BENEFIT AMOUNT                                       *
  3316*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3317*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3318*  BENEFIT KIND (LIFE OR A/H)                                    *
  3319*  A.P.R.                                                        *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  59
* SOCK03.cbl
  3320*  METHOD
  3321*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3322*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3323*  COMPANY I.D. (3 CHARACTER)                                    *
  3324*  BENEFIT CODE                                                  *
  3325*  BENEFIT OVERRIDE CODE                                         *
  3326*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3327*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3328*  JOINT INDICATOR (CSL ONLY)                                    *
  3329*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3330*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3331*                                                                *
  3332*  RETURNED FROM ELRATE                                          *
  3333*  --------------------                                          *
  3334*  CALCULATED PREMIUM                                            *
  3335*  PREMIUM RATE                                                  *
  3336*  MORTALITY CODE                                                *
  3337*  MAX ATTAINED AGE                                              *
  3338*  MAX AGE                                                       *
  3339*  MAX TERM                                                      *
  3340*  MAX MONTHLY BENEFIT                                           *
  3341*  MAX TOTAL BENIFIT                                             *
  3342*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3343*----------------------------------------------------------------*
  3344*  PASSED TO ELRFND                                              *
  3345*  ----------------                                              *
  3346*  CERT ISSUE DATE                                               *
  3347*  REFUND DATE                                                   *
  3348*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3349*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3350*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3351*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3352*  STATE CODE (CLIENT DEFINED)                                   *
  3353*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3354*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3355*  DEVIATION CODE                                                *
  3356*  ISSUE AGE                                                     *
  3357*  ORIGINAL BENEFIT AMOUNT                                       *
  3358*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3359*  PROCESS TYPE (CANCEL)                                         *
  3360*  BENEFIT KIND (LIFE OR A/H)                                    *
  3361*  A.P.R.                                                        *
  3362*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3363*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3364*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3365*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3366*  COMPANY I.D. (3 CHARACTER)                                    *
  3367*  BENEFIT CODE                                                  *
  3368*  BENEFIT OVERRIDE CODE                                         *
  3369*                                                                *
  3370*  RETURNED FROM ELRFND                                          *
  3371*  --------------------                                          *
  3372*  CALCULATED REFUND                                             *
  3373*----------------------------------------------------------------*
  3374*  PASSED TO ELEARN                                              *
  3375*  ----------------                                              *
  3376*  CERT ISSUE DATE                                               *
  3377*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  60
* SOCK03.cbl
  3378*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3379*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3380*  STATE CODE (CLIENT DEFINED)                                   *
  3381*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3382*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3383*  DEVIATION CODE                                                *
  3384*  ISSUE AGE                                                     *
  3385*  ORIGINAL BENEFIT AMOUNT                                       *
  3386*  BENEFIT KIND (LIFE OR A/H)                                    *
  3387*  A.P.R.                                                        *
  3388*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3389*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3390*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3391*  COMPANY I.D. (3 CHARACTER)                                    *
  3392*  BENEFIT CODE                                                  *
  3393*  BENEFIT OVERRIDE CODE                                         *
  3394*                                                                *
  3395*  RETURNED FROM ELEARN                                          *
  3396*  --------------------                                          *
  3397*  INDICATED  EARNINGS                                           *
  3398*----------------------------------------------------------------*
  3399*                 LENGTH = 450                                   *
  3400*                                                                *
  3401******************************************************************
  3402******************************************************************
  3403*                   C H A N G E   L O G
  3404*
  3405* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3406*-----------------------------------------------------------------
  3407*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3408* EFFECTIVE    NUMBER
  3409*-----------------------------------------------------------------
  3410* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3411* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3412* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3413* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3414* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3415* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3416* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3417* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3418* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3419******************************************************************
  3420
  3421 01  CALCULATION-PASS-AREA.
  3422     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3423                                     COMP.
  3424
  3425     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3426       88  NO-CP-ERROR                             VALUE ZERO.
  3427       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3428                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3429       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3430       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3431       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3432       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3433       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3434       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3435       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  61
* SOCK03.cbl
  3436       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3437       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3438       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3439       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3440       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3441       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3442       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3443       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3444       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3445       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3446
  3447     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3448       88  NO-CP-ERROR-2                           VALUE ZERO.
  3449***********************  INPUT AREAS ****************************
  3450
  3451     12  CP-CALCULATION-AREA.
  3452         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3453         16  CP-CERT-EFF-DT        PIC XX.
  3454         16  CP-VALUATION-DT       PIC XX.
  3455         16  CP-PAID-THRU-DT       PIC XX.
  3456         16  CP-BENEFIT-TYPE       PIC X.
  3457           88  CP-AH                               VALUE 'A' 'D'
  3458                                                   'I' 'U'.
  3459           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3460           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3461         16  CP-INCURRED-DT        PIC XX.
  3462         16  CP-REPORTED-DT        PIC XX.
  3463         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3464         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3465         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3466                                     COMP-3.
  3467         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3468                                     COMP-3.
  3469         16  CP-CDT-METHOD         PIC X.
  3470           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3471           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3472           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3473         16  CP-CLAIM-TYPE         PIC X.
  3474           88  CP-AH-CLAIM                         VALUE 'A'.
  3475           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3476         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3479                                     COMP-3.
  3480         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3481                                     COMP-3.
  3482         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3483                                     COMP-3.
  3484         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3485                                     COMP-3.
  3486         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3487                                     COMP-3.
  3488         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3489                                     COMP-3.
  3490         16  CP-REM-TERM-METHOD    PIC X.
  3491           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3492           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3493           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  62
* SOCK03.cbl
  3494           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3495           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3496           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3497           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3498         16  CP-EARNING-METHOD     PIC X.
  3499           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3500           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3501           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3502           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3503           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3504           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3505           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3506           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3507           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3508           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3509           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3510           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3511           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3512           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3513         16  CP-PROCESS-TYPE       PIC X.
  3514           88  CP-CLAIM                            VALUE '1'.
  3515           88  CP-CANCEL                           VALUE '2'.
  3516           88  CP-ISSUE                            VALUE '3'.
  3517         16  CP-SPECIAL-CALC-CD    PIC X.
  3518           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3519           88  CP-1-MTH-INTEREST               VALUE ' '.
  3520           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3521           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3522           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3523           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3524           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3525           88  CP-FARM-PLAN                    VALUE 'F'.
  3526           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3527           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3528           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3529           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3530           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3531           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3532           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3533           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3534           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3535           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3536                                                     'W' 'X'.
  3537           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3538           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3539           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3540           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3541           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3542           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3543           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3544           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3545           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3546           88  CP-CSL-METH-1                   VALUE '5'.
  3547           88  CP-CSL-METH-2                   VALUE '6'.
  3548           88  CP-CSL-METH-3                   VALUE '7'.
  3549           88  CP-CSL-METH-4                   VALUE '8'.
  3550
  3551         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  63
* SOCK03.cbl
  3552                                     COMP-3.
  3553         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3554         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3555         16  CP-STATE              PIC XX          VALUE SPACE.
  3556         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3557         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3558           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3559               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3560         16  CP-R78-OPTION         PIC X.
  3561           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3562           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3563
  3564         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3565         16  CP-IBNR-RESERVE-SW    PIC X.
  3566         16  CP-CLAIM-STATUS       PIC X.
  3567         16  CP-RATE-FILE          PIC X.
  3568         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3569                                     COMP-3.
  3570
  3571         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3572         16  CP-AH-OVERRIDE-CODE   PIC X.
  3573
  3574         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3575                                     COMP-3.
  3576         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3577                                   PIC S9(5)V99 COMP-3.
  3578         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3579                                     COMP-3.
  3580         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3581                                     COMP-3.
  3582         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3583                                     COMP-3.
  3584         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3585                                  PIC S9(7)V99 COMP-3.
  3586
  3587         16  CP-PAID-FROM-DATE     PIC X(02).
  3588         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3589         16  CP-EXT-DAYS-CALC      PIC X.
  3590           88  CP-EXT-NO-CHG                   VALUE ' '.
  3591           88  CP-EXT-CHG-LF                   VALUE '1'.
  3592           88  CP-EXT-CHG-AH                   VALUE '2'.
  3593           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3594         16  CP-DOMICILE-STATE     PIC XX.
  3595         16  CP-CARRIER            PIC X.
  3596         16  CP-REIN-FLAG          PIC X.
  3597         16  CP-REM-TRM-CALC-OPTION PIC X.
  3598           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3599                      '2' '3' '4' '5'.
  3600           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3601           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3602           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3603           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3604           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3605           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3606           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3607           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3608         16  CP-SIG-SWITCH         PIC X.
  3609         16  CP-RATING-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  64
* SOCK03.cbl
  3610           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3611           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3612           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3613           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3614           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3615           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3616           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3617           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3618           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3619         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3620                                     COMP-3.
  3621         16  CP-BEN-CATEGORY       PIC X.
  3622         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3623         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3624                                   PIC S99V9(5) COMP-3.
  3625         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3626         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3627                                   PIC S99V9(5) COMP-3.
  3628         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3629         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3630         16  CP-EXPIRE-DT          PIC XX.
  3631         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3632         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3633         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3634         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3635         16  CP-DDF-SPEC-CALC      PIC X.
  3636             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3637             88  CP-CALC-CLP              VALUE 'C'.
  3638         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3639         16  CP-CANCEL-REASON      PIC X.
  3640         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3641         16  CP-PMT-MODE           PIC X.
  3642         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3643         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3644         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3645         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3646         16  FILLER                PIC X.
  3647
  3648***************    OUTPUT FROM ELRESV   ************************
  3649
  3650         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3651
  3652         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3653                                     COMP-3.
  3654         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3655                                     COMP-3.
  3656         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3657                                     COMP-3.
  3658         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3659                                     COMP-3.
  3660         16  FILLER                PIC X(09).
  3661***************    OUTPUT FROM ELRTRM   *************************
  3662
  3663         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  65
* SOCK03.cbl
  3668                                     COMP-3.
  3669         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3670                                     COMP-3.
  3671         16  FILLER                PIC X(12).
  3672
  3673***************    OUTPUT FROM ELRAMT   *************************
  3674
  3675         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3678                                     COMP-3.
  3679         16  FILLER                PIC X(12).
  3680
  3681***************    OUTPUT FROM ELRATE   *************************
  3682
  3683         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3684                                     COMP-3.
  3685         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3686                                     COMP-3.
  3687         16  CP-MORTALITY-CODE     PIC X(4).
  3688         16  CP-RATE-EDIT-FLAG     PIC X.
  3689             88  CP-RATES-NEED-APR                  VALUE '1'.
  3690         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3691                                     COMP-3.
  3692         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3693         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3694         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3695                                   PIC S9(7)V99 COMP-3.
  3696         16  FILLER                PIC X(07).
  3697
  3698***************    OUTPUT FROM ELRFND   *************************
  3699
  3700         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3701                                     COMP-3.
  3702         16  CP-REFUND-TYPE-USED   PIC X.
  3703           88  CP-R-AS-R78                         VALUE '1'.
  3704           88  CP-R-AS-PRORATA                     VALUE '2'.
  3705           88  CP-R-AS-CALIF                       VALUE '3'.
  3706           88  CP-R-AS-TEXAS                       VALUE '4'.
  3707           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3708           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3709           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3710           88  CP-R-AS-MEAN                        VALUE '8'.
  3711           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3712           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3713           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3714           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3715           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3716           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3717         16  FILLER                PIC X(12).
  3718
  3719***************    OUTPUT FROM ELEARN   *************************
  3720
  3721         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3722                                     COMP-3.
  3723         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3724                                     COMP-3.
  3725         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  66
* SOCK03.cbl
  3726                                     COMP-3.
  3727         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3728                                     COMP-3.
  3729         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3730                                     COMP-3.
  3731         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-EARNING-TYPE-USED  PIC X.
  3734           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3735           88  CP-E-AS-R78                         VALUE '1'.
  3736           88  CP-E-AS-PRORATA                     VALUE '2'.
  3737           88  CP-E-AS-TEXAS                       VALUE '4'.
  3738           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3739           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3740           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3741           88  CP-E-AS-MEAN                        VALUE '8'.
  3742           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3743         16  FILLER                PIC X(12).
  3744
  3745***************    OUTPUT FROM ELPMNT   *************************
  3746
  3747         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3748                                     COMP-3.
  3749         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3750                                     COMP-3.
  3751         16  FILLER                PIC X(12).
  3752
  3753***************   MISC WORK AREAS    *****************************
  3754         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3755                                     COMP-3.
  3756         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3759                                     COMP-3.
  3760         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3765                                     COMP-3.
  3766         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3767             88  OPEN-RATE-FILE                   VALUE 'O'.
  3768             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3769             88  IO-ERROR                         VALUE 'E'.
  3770
  3771         16  CP-FIRST-PAY-DATE     PIC XX.
  3772
  3773         16  CP-JOINT-INDICATOR    PIC X.
  3774
  3775         16  CP-RESERVE-REMAINING-TERM
  3776                                   PIC S9(4)V9    VALUE ZERO
  3777                                     COMP-3.
  3778
  3779         16  CP-INSURED-BIRTH-DT   PIC XX.
  3780
  3781         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3782                                     COMP-3.
  3783
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  67
* SOCK03.cbl
  3784         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3785                                     COMP-3.
  3786
  3787         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3788                                     COMP-3.
  3789
  3790         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3791                                     COMP-3.
  3792
  3793         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3794                                     COMP-3.
  3795
  3796         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3797                                     COMP-3.
  3798
  3799         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3803             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3804
  3805         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3806                                     COMP-3.
  3807         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3808                                     COMP-3.
  3809         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3810         16  FILLER                PIC X(15).
  3811******************************************************************
  3812****************************************************************
  3813*
  3814* Copyright (c) 2007 by Clerity Solutions, Inc.
  3815* All rights reserved.
  3816*
  3817****************************************************************
  3818 01  DFHEIV.
  3819   02  DFHEIV0               PIC X(35).
  3820   02  DFHEIV1               PIC X(08).
  3821   02  DFHEIV2               PIC X(08).
  3822   02  DFHEIV3               PIC X(08).
  3823   02  DFHEIV4               PIC X(06).
  3824   02  DFHEIV5               PIC X(04).
  3825   02  DFHEIV6               PIC X(04).
  3826   02  DFHEIV7               PIC X(02).
  3827   02  DFHEIV8               PIC X(02).
  3828   02  DFHEIV9               PIC X(01).
  3829   02  DFHEIV10              PIC S9(7) COMP-3.
  3830   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3831   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3832   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3833   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3834   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3835   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3836   02  DFHEIV17              PIC X(04).
  3837   02  DFHEIV18              PIC X(04).
  3838   02  DFHEIV19              PIC X(04).
  3839   02  DFHEIV20              USAGE IS POINTER.
  3840   02  DFHEIV21              USAGE IS POINTER.
  3841   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  68
* SOCK03.cbl
  3842   02  DFHEIV23              USAGE IS POINTER.
  3843   02  DFHEIV24              USAGE IS POINTER.
  3844   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3845   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3846   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3847   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3848   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3849   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3850   02  FILLER                PIC X(02).
  3851   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3852   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3853   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3854   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3855   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3856 LINKAGE  SECTION.
  3857*****************************************************************
  3858*                                                               *
  3859* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3860* All rights reserved.                                          *
  3861*                                                               *
  3862*****************************************************************
  3863 01  dfheiblk.
  3864     02  eibtime          pic s9(7) comp-3.
  3865     02  eibdate          pic s9(7) comp-3.
  3866     02  eibtrnid         pic x(4).
  3867     02  eibtaskn         pic s9(7) comp-3.
  3868     02  eibtrmid         pic x(4).
  3869     02  dfheigdi         pic s9(4) comp.
  3870     02  eibcposn         pic s9(4) comp.
  3871     02  eibcalen         pic s9(4) comp.
  3872     02  eibaid           pic x(1).
  3873     02  eibfiller1       pic x(1).
  3874     02  eibfn            pic x(2).
  3875     02  eibfiller2       pic x(2).
  3876     02  eibrcode         pic x(6).
  3877     02  eibfiller3       pic x(2).
  3878     02  eibds            pic x(8).
  3879     02  eibreqid         pic x(8).
  3880     02  eibrsrce         pic x(8).
  3881     02  eibsync          pic x(1).
  3882     02  eibfree          pic x(1).
  3883     02  eibrecv          pic x(1).
  3884     02  eibsend          pic x(1).
  3885     02  eibatt           pic x(1).
  3886     02  eibeoc           pic x(1).
  3887     02  eibfmh           pic x(1).
  3888     02  eibcompl         pic x(1).
  3889     02  eibsig           pic x(1).
  3890     02  eibconf          pic x(1).
  3891     02  eiberr           pic x(1).
  3892     02  eibrldbk         pic x(1).
  3893     02  eiberrcd         pic x(4).
  3894     02  eibsynrb         pic x(1).
  3895     02  eibnodat         pic x(1).
  3896     02  eibfiller5       pic x(2).
  3897     02  eibresp          pic 9(09) comp.
  3898     02  eibresp2         pic 9(09) comp.
  3899     02  dfheigdj         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  69
* SOCK03.cbl
  3900     02  dfheigdk         pic s9(4) comp.
  3901 01  DFHCOMMAREA.
  3902   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3903   05 LSTN-NAME                PIC X(8).
  3904   05 LSTN-SUBNAME             PIC X(8).
  3905   05 CLIENT-IN-DATA.
  3906      15  CLIENT-CAR           PIC X.
  3907      15  CLIENT-GRP           PIC X(6).
  3908      15  CLIENT-STATE         PIC XX.
  3909      15  CLIENT-ACCOUNT       PIC X(10).
  3910*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3911      15  CLIENT-EFF-DT        PIC X(8).
  3912      15  CLIENT-CERT-NO       PIC X(11).
  3913      15  CLIENT-LAST-NAME     PIC X(15).
  3914      15  CLIENT-FIRST-NAME    PIC X(10).
  3915      15  CLIENT-VAL-DT        PIC X(8).
  3916      15  CLIENT-CAN-REASON    PIC X.
  3917   05 SOCKADDR-IN-PARM.
  3918     15 SIN-FAMILY             PIC 9(4) COMP.
  3919     15 SIN-PORT               PIC 9(4) COMP.
  3920     15 SIN-ADDRESS            PIC 9(8) COMP.
  3921     15 SIN-ZERO               PIC X(8).
  3922 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3923 0000-DFHEXIT SECTION.
  3924     MOVE '9#                    $   ' TO DFHEIV0.
  3925     MOVE 'SOCK03' TO DFHEIV1.
  3926     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3927     display '  BEGIN SOCK03 '
  3928     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3929     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3930     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3931        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3932        IF CLIENT-IN-DATA (8:3) = 'AHL'
  3933           MOVE X'06'            TO WS-COMP-CD
  3934           MOVE 'AHL'            TO WS-SEND-BUF (5:3)
  3935                                    WS-COMP-ID
  3936        ELSE
  3937           IF CLIENT-IN-DATA (8:3) = 'DCC'
  3938              MOVE X'05'         TO WS-COMP-CD
  3939              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  3940                                    WS-COMP-ID
  3941           ELSE
  3942              MOVE X'04'         TO WS-COMP-CD
  3943              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3944                                    WS-COMP-ID
  3945           END-IF
  3946        END-IF
  3947        move 'CSO'               to ws-send-buf (1:3)
  3948        move +25                 to ws-send-msg-size
  3949     END-IF
  3950     display 'SOCK03:sequence number  =', ws-seq-num.
  3951     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3952     call "send" using by value GIVE-TAKE-SOCKET,
  3953         by reference ws-send-buf,
  3954         by value ws-send-msg-size,
  3955         by value ws-flags.
  3956     if return-code <= zero
  3957         display 'SOCK03:send error ',
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  70
* SOCK03.cbl
  3958         go to socket-error.
  3959     move low-values to ws-recv-buf.
  3960     set ws-recv-total to zero.
  3961     compute ws-recv-left = ws-recv-msg-size.
  3962     display 'SOCK03:About to recv '
  3963     call "recv" using by value GIVE-TAKE-SOCKET,
  3964         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3965         by value ws-recv-left,
  3966         by value ws-flags.
  3967     if return-code < zero
  3968        display 'SOCK03:recv error ',
  3969        go to socket-error.
  3970     if return-code = zero
  3971        display 'SOCK03:client disconnected',
  3972        go to socket-error.
  3973*
  3974     display 'SOCK03:Good recv  '
  3975     display 'SOCK03:return code      = ', return-code
  3976     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  3977     move +4096                  to ws-send-msg-size
  3978*    move +750                   to ws-send-msg-size
  3979     move ws-recv-buf (1:72)     to client-in-data
  3980     MOVE SPACES                 TO WS-ELCERT-SW
  3981     MOVE X'0A'                  TO WS-HEX-0A
  3982     EVALUATE TRUE
  3983        WHEN (CLIENT-CAR NOT = SPACES)
  3984           AND (CLIENT-STATE NOT = SPACES)
  3985           AND (CLIENT-ACCOUNT NOT = SPACES)
  3986           AND (CLIENT-EFF-DT NOT = SPACES)
  3987           AND (CLIENT-CERT-NO NOT = SPACES)
  3988           SET WS-ELCERT-FULL    TO TRUE
  3989           DISPLAY ' SETTING FULL '
  3990        WHEN (CLIENT-CERT-NO NOT = SPACES)
  3991           SET WS-ELCERT-CERT-NO TO TRUE
  3992           DISPLAY ' SETTING CERT NO '
  3993*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  3994*          AND (CLIENT-LAST-NAME NOT = SPACES)
  3995        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  3996           AND (CLIENT-LAST-NAME NOT = SPACES)
  3997           SET WS-ELCERT-ACT-NAME TO TRUE
  3998        WHEN CLIENT-LAST-NAME NOT = SPACES
  3999           SET WS-ELCERT-NAME    TO TRUE
  4000           DISPLAY ' SETTING NAME '
  4001        WHEN OTHER
  4002           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4003           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4004           MOVE ZEROS            TO WS-RESP
  4005           PERFORM 0030-BUILD-BUFFER
  4006                                 THRU 0030-EXIT
  4007           PERFORM 0020-SEND-BUFFER
  4008                                 THRU 0020-EXIT
  4009           PERFORM 0025-CLOSE-SOCKET
  4010                                 THRU 0025-EXIT
  4011           GO TO 0010-RETURN
  4012     END-EVALUATE
  4013     IF CLIENT-CAN-REASON = 'R'
  4014        MOVE 'R'                 TO WS-CANCEL-REASON
  4015     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  71
* SOCK03.cbl
  4016        MOVE ' '                 TO WS-CANCEL-REASON
  4017     END-IF
  4018     IF WS-ELCERT-KEY-SW NOT = SPACES
  4019        PERFORM 0050-BEGIN-REFUND-PROCESS
  4020                                 THRU 0050-EXIT
  4021     END-IF
  4022     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4023     .
  4024 0010-RETURN.
  4025
  4026* exec cics return end-exec.
  4027*    MOVE '.(                    ''   #00004021' TO DFHEIV0
  4028     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4029     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4030     MOVE X'2020233030303034303231' TO DFHEIV0(25:11)
  4031     CALL 'kxdfhei1' USING DFHEIV0,
  4032           DFHEIV99,
  4033           DFHEIV99,
  4034           DFHEIV99,
  4035           DFHEIV99,
  4036           DFHEIV99,
  4037           DFHEIV99
  4038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4039
  4040
  4041* goback.
  4042     MOVE '9%                    "   ' TO DFHEIV0
  4043     MOVE 'SOCK03' TO DFHEIV1
  4044     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4045     goback.
  4046*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4047     .
  4048 0020-SEND-BUFFER.
  4049     display 'SOCK03:About to send      '
  4050     display 'SOCK03:sequence number  =', ws-seq-num.
  4051     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  4052     call "send" using by value GIVE-TAKE-SOCKET,
  4053         by reference ws-send-buf,
  4054         by value ws-send-msg-size,
  4055         by value ws-flags.
  4056     if return-code <= zero
  4057         display 'SOCK03:send error ' return-code,
  4058         go to socket-error.
  4059 0020-EXIT.
  4060     EXIT.
  4061 0025-CLOSE-SOCKET.
  4062     display 'SOCK03:closing socket'.
  4063     call "close" using by value GIVE-TAKE-SOCKET .
  4064     display 'SOCK03:done'.
  4065     .
  4066 0025-EXIT.
  4067     EXIT.
  4068*
  4069* set up the receive buffer
  4070*
  4071     move low-values to ws-recv-buf.
  4072     set ws-recv-total to zero.
  4073     compute ws-recv-left = ws-recv-msg-size.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  72
* SOCK03.cbl
  4074*
  4075* receive data
  4076*
  4077 recv-1.
  4078     call "recv" using by value GIVE-TAKE-SOCKET,
  4079         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4080         by value ws-recv-left,
  4081         by value ws-flags.
  4082*
  4083* test what was received and decide what we should do
  4084*
  4085     if return-code < zero
  4086        display 'SOCK03:recv error ',
  4087        go to socket-error.
  4088     if return-code = zero
  4089        display 'SOCK03:client disconnected',
  4090        go to socket-error.
  4091*
  4092* have we received all the data yet?
  4093*
  4094     compute ws-recv-total = ws-recv-total + return-code.
  4095     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4096*
  4097* not yet
  4098*
  4099     if ws-recv-left > 0 go to recv-1.
  4100*
  4101* received all the data
  4102*
  4103     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4104*
  4105* make sure what we received was what we sent
  4106*
  4107*    if ws-recv-buf <> ws-send-buf
  4108*        display "SOCK03:data doesn't match",
  4109*        go to socket-error.
  4110*
  4111* end of pass
  4112*
  4113*loop-end.
  4114*    if ws-seq-num = 5 go to socket-error.
  4115*    go to loop-1.
  4116*
  4117* program end
  4118*
  4119 socket-error.
  4120     if ws-seq-num <> 0
  4121         display "SOCK03:did not complete".
  4122*
  4123* flush the send buffer and deallocate
  4124*
  4125*    display 'SOCK03:closing socket'.
  4126*    call "close" using by value GIVE-TAKE-SOCKET .
  4127*
  4128* finised return to cics
  4129*
  4130 socket-fin.
  4131     display 'SOCK03:closing socket'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  73
* SOCK03.cbl
  4132     call "close" using by value GIVE-TAKE-SOCKET .
  4133     display 'SOCK03:done'.
  4134
  4135* exec cics return end-exec.
  4136*    MOVE '.(                    ''   #00004111' TO DFHEIV0
  4137     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4138     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4139     MOVE X'2020233030303034313131' TO DFHEIV0(25:11)
  4140     CALL 'kxdfhei1' USING DFHEIV0,
  4141           DFHEIV99,
  4142           DFHEIV99,
  4143           DFHEIV99,
  4144           DFHEIV99,
  4145           DFHEIV99,
  4146           DFHEIV99
  4147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4148
  4149
  4150* goback.
  4151     MOVE '9%                    "   ' TO DFHEIV0
  4152     MOVE 'SOCK03' TO DFHEIV1
  4153     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4154     goback.
  4155 0030-BUILD-BUFFER.
  4156     MOVE SPACES                 TO WS-SEND-BUF
  4157     IF WS-CALL-TYPE = 'NEWBUS'
  4158        STRING
  4159           WS-COMMENT            ';'
  4160           WS-RESP               ';'
  4161           WS-CARRIER            ';'
  4162           WS-GROUPING           ';'
  4163           WS-STATE              ';'
  4164           WS-ACCOUNT            ';'
  4165           WS-CERT-EFF-DATE      ';'
  4166           WS-CERT-NO            ';'
  4167           WS-LAST-NAME          ';'
  4168           WS-FIRST-NAME         ';'
  4169           WS-MID-INIT           ';'
  4170           WS-LAST-JNAME         ';'
  4171           WS-FIRST-JNAME        ';'
  4172           WS-MID-JINIT          ';'
  4173           WS-POST-CARD-SW       ';'
  4174           ws-lf-coverage-type   ';'
  4175           WS-LF-STATUS          ';'
  4176           WS-LF-BEN-CODE        ';'
  4177           WS-LF-BEN-CODE-DESC   ';'
  4178           WS-LF-TERM            ';'
  4179           WS-LF-REM-TERM        ';'
  4180           WS-LF-PREM            ';'
  4181           WS-LF-REFUND          ';'
  4182           WS-LF-METHOD          ';'
  4183           WS-LF-ORIG-BENEFIT    ';'
  4184           WS-LF-REM-BEN         ';'
  4185           WS-LF-EXPIRE-DATE     ';'
  4186           WS-LF-COMM            ';'
  4187           WS-LF-UEC             ';'
  4188           WS-AH-COVERAGE-TYPE   ';'
  4189           WS-AH-STATUS          ';'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  74
* SOCK03.cbl
  4190           WS-AH-BEN-CODE        ';'
  4191           WS-AH-BEN-CODE-DESC   ';'
  4192           WS-AH-TERM            ';'
  4193           WS-AH-REM-TERM        ';'
  4194           WS-AH-PREM            ';'
  4195           WS-AH-REFUND          ';'
  4196           WS-AH-METHOD          ';'
  4197           WS-AH-ORIG-BENEFIT    ';'
  4198           WS-AH-REM-BEN         ';'
  4199           WS-AH-EXPIRE-DATE     ';'
  4200           WS-AH-COMM            ';'
  4201           WS-AH-UEC             ';'
  4202           WS-ACCOUNT-NAME       ';'
  4203           WS-REPORT-CODE-1      ';'
  4204           WS-REPORT-CODE-2      ';'
  4205           WS-REPORT-CODE-3      ';'
  4206           WS-CLM-PAID-THRU-DT   ';'
  4207           WS-HEX-0A
  4208            DELIMITED BY '  ' INTO WS-SEND-BUF
  4209        END-STRING
  4210     ELSE
  4211        STRING
  4212           WS-COMMENT            ';'
  4213           WS-RESP               ';'
  4214           WS-CARRIER            ';'
  4215           WS-GROUPING           ';'
  4216           WS-STATE              ';'
  4217           WS-ACCOUNT            ';'
  4218           WS-CERT-EFF-DATE      ';'
  4219           WS-CERT-NO            ';'
  4220           WS-LAST-NAME          ';'
  4221           WS-FIRST-NAME         ';'
  4222           WS-MID-INIT           ';'
  4223           WS-LAST-JNAME         ';'
  4224           WS-FIRST-JNAME        ';'
  4225           WS-MID-JINIT          ';'
  4226           WS-POST-CARD-SW       ';'
  4227           WS-LF-STATUS          ';'
  4228           WS-LF-BEN-CODE        ';'
  4229           WS-LF-BEN-CODE-DESC   ';'
  4230           WS-LF-TERM            ';'
  4231           WS-LF-REM-TERM        ';'
  4232           WS-LF-PREM            ';'
  4233           WS-LF-REFUND          ';'
  4234           WS-LF-METHOD          ';'
  4235           WS-LF-ORIG-BENEFIT    ';'
  4236           WS-LF-REM-BEN         ';'
  4237           WS-LF-EXPIRE-DATE     ';'
  4238           WS-LF-COMM            ';'
  4239           WS-LF-UEC             ';'
  4240           WS-AH-STATUS          ';'
  4241           WS-AH-BEN-CODE        ';'
  4242           WS-AH-BEN-CODE-DESC   ';'
  4243           WS-AH-TERM            ';'
  4244           WS-AH-REM-TERM        ';'
  4245           WS-AH-PREM            ';'
  4246           WS-AH-REFUND          ';'
  4247           WS-AH-METHOD          ';'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  75
* SOCK03.cbl
  4248           WS-AH-ORIG-BENEFIT    ';'
  4249           WS-AH-REM-BEN         ';'
  4250           WS-AH-EXPIRE-DATE     ';'
  4251           WS-AH-COMM            ';'
  4252           WS-AH-UEC             ';'
  4253           WS-ACCOUNT-NAME       ';'
  4254           WS-REPORT-CODE-1      ';'
  4255           WS-REPORT-CODE-2      ';'
  4256           WS-REPORT-CODE-3      ';'
  4257           WS-CLM-PAID-THRU-DT   ';'
  4258           'E'                   ';'
  4259            DELIMITED BY '  ' INTO WS-SEND-BUF
  4260        END-STRING
  4261     END-IF
  4262     .
  4263 0030-EXIT.
  4264     EXIT.
  4265 0050-BEGIN-REFUND-PROCESS.
  4266     IF WS-ELCERT-ACT-NAME
  4267        PERFORM 0060-FIND-FULL-KEY
  4268                                 THRU 0060-EXIT
  4269        MOVE AM-CARRIER          TO CLIENT-CAR
  4270        MOVE AM-GROUPING         TO CLIENT-GRP
  4271        MOVE AM-STATE            TO CLIENT-STATE
  4272     END-IF
  4273     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4274     IF NOT RESP-NORMAL
  4275        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4276        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4277        MOVE WS-RESPONSE         TO WS-RESP
  4278        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4279        PERFORM 0020-SEND-BUFFER
  4280                                 THRU 0020-EXIT
  4281        PERFORM 0025-CLOSE-SOCKET
  4282                                 THRU 0025-EXIT
  4283        GO TO 0010-RETURN
  4284     END-IF
  4285     PERFORM 0150-READ-NEXT-ELCERT
  4286                                 THRU 0150-EXIT
  4287*    display ' came back from 0150 ' ws-response
  4288     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4289        DISPLAY ' CERT NOT FOUND '
  4290        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4291        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4292        MOVE WS-RESPONSE         TO WS-RESP
  4293        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4294        PERFORM 0020-SEND-BUFFER
  4295                                 THRU 0020-EXIT
  4296        PERFORM 0025-CLOSE-SOCKET
  4297                                 THRU 0025-EXIT
  4298        GO TO 0010-RETURN
  4299     END-IF
  4300     PERFORM 0200-BEGIN-REFUND-PROCESS
  4301                                 THRU 0200-EXIT UNTIL
  4302        ELCERT-FINISHED
  4303     .
  4304 0050-EXIT.
  4305     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  76
* SOCK03.cbl
  4306 0060-FIND-FULL-KEY.
  4307     MOVE ' ' TO WS-STOP-SW
  4308     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4309     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4310
  4311* EXEC CICS STARTBR
  4312*       DATASET  ('ERACCT3')
  4313*       RIDFLD   (WS-AM3-KEY)
  4314*       GTEQ
  4315*       RESP (WS-RESPONSE)
  4316*    END-EXEC
  4317     MOVE 'ERACCT3' TO DFHEIV1
  4318     MOVE 0
  4319       TO DFHEIV11
  4320*    MOVE '&,         G          &  N#00004268' TO DFHEIV0
  4321     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4322     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4323     MOVE X'204E233030303034323638' TO DFHEIV0(25:11)
  4324     CALL 'kxdfhei1' USING DFHEIV0,
  4325           DFHEIV1,
  4326           WS-AM3-KEY,
  4327           DFHEIV99,
  4328           DFHEIV11,
  4329           DFHEIV99
  4330     MOVE EIBRESP  TO WS-RESPONSE
  4331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4332     IF RESP-NORMAL
  4333        PERFORM UNTIL TOLD-TO-STOP
  4334
  4335* EXEC CICS READNEXT
  4336*             DATASET  ('ERACCT3')
  4337*             INTO     (ACCOUNT-MASTER)
  4338*             RIDFLD   (WS-AM3-KEY)
  4339*          END-EXEC
  4340     MOVE LENGTH OF
  4341      ACCOUNT-MASTER
  4342       TO DFHEIV12
  4343     MOVE 'ERACCT3' TO DFHEIV1
  4344     MOVE 0
  4345       TO DFHEIV11
  4346*    MOVE '&.IL                  )   #00004276' TO DFHEIV0
  4347     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4348     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4349     MOVE X'2020233030303034323736' TO DFHEIV0(25:11)
  4350     CALL 'kxdfhei1' USING DFHEIV0,
  4351           DFHEIV1,
  4352           ACCOUNT-MASTER,
  4353           DFHEIV12,
  4354           WS-AM3-KEY,
  4355           DFHEIV99,
  4356           DFHEIV11,
  4357           DFHEIV99,
  4358           DFHEIV99
  4359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4360           EVALUATE TRUE
  4361              WHEN (RESP-NORMAL)
  4362                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4363                 AND (AM-COMPANY-CD = WS-COMP-CD)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  77
* SOCK03.cbl
  4364                 SET TOLD-TO-STOP TO TRUE
  4365              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4366                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4367                 CONTINUE
  4368              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4369                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4370                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4371                 MOVE ZEROS      TO WS-RESP
  4372                 PERFORM 0030-BUILD-BUFFER
  4373                                 THRU 0030-EXIT
  4374                 PERFORM 0020-SEND-BUFFER
  4375                                 THRU 0020-EXIT
  4376                 PERFORM 0025-CLOSE-SOCKET
  4377                                 THRU 0025-EXIT
  4378                 GO TO 0010-RETURN
  4379           END-EVALUATE
  4380        END-PERFORM
  4381
  4382* EXEC CICS ENDBR
  4383*          DATASET   ('ERACCT3')
  4384*       END-EXEC
  4385     MOVE 'ERACCT3' TO DFHEIV1
  4386     MOVE 0
  4387       TO DFHEIV11
  4388*    MOVE '&2                    $   #00004302' TO DFHEIV0
  4389     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4390     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4391     MOVE X'2020233030303034333032' TO DFHEIV0(25:11)
  4392     CALL 'kxdfhei1' USING DFHEIV0,
  4393           DFHEIV1,
  4394           DFHEIV11,
  4395           DFHEIV99
  4396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4397     ELSE
  4398        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4399        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4400        MOVE ZEROS      TO WS-RESP
  4401        PERFORM 0030-BUILD-BUFFER
  4402                                 THRU 0030-EXIT
  4403        PERFORM 0020-SEND-BUFFER
  4404                                 THRU 0020-EXIT
  4405        PERFORM 0025-CLOSE-SOCKET
  4406                                 THRU 0025-EXIT
  4407        GO TO 0010-RETURN
  4408     END-IF
  4409     .
  4410 0060-EXIT.
  4411     EXIT.
  4412 0100-START-ELCERT.
  4413*    DISPLAY ' MADE 0100 START '
  4414     MOVE SPACES                 TO WS-SEND-BUF
  4415     INITIALIZE WS-STRING-DATA
  4416     MOVE LOW-VALUES             TO WS-CM-KEY
  4417                                    WS-CM-KEY-A1
  4418                                    WS-CM-KEY-A4
  4419     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4420                                    WS-CM-COMPANY-CD-A1
  4421                                    WS-CM-COMPANY-CD-A4
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  78
* SOCK03.cbl
  4422     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4423     MOVE 'L'                    TO DC-OPTION-CODE
  4424     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4425     IF NO-CONVERSION-ERROR
  4426        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4427     ELSE
  4428        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4429        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4430        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4431        PERFORM 0020-SEND-BUFFER
  4432                                 THRU 0020-EXIT
  4433        PERFORM 0025-CLOSE-SOCKET
  4434                                 THRU 0025-EXIT
  4435        GO TO 0010-RETURN
  4436     END-IF
  4437     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4438        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4439        MOVE 'L'                 TO DC-OPTION-CODE
  4440        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4441        IF NO-CONVERSION-ERROR
  4442           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4443        ELSE
  4444           MOVE 'BAD EFF DT CONVERT '
  4445                                 TO WS-COMMENT
  4446           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4447           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4448           PERFORM 0020-SEND-BUFFER
  4449                                 THRU 0020-EXIT
  4450           PERFORM 0025-CLOSE-SOCKET
  4451                                 THRU 0025-EXIT
  4452           GO TO 0010-RETURN
  4453        END-IF
  4454     END-IF
  4455     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4456        (F1 > +10)
  4457        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4458     END-PERFORM
  4459     IF F1 > +1
  4460        SUBTRACT +1 FROM F1
  4461     END-IF
  4462     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4463        (L1 > +15)
  4464        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4465     END-PERFORM
  4466     IF L1 > +1
  4467        SUBTRACT +1 FROM L1
  4468     END-IF
  4469     EVALUATE TRUE
  4470        WHEN WS-ELCERT-FULL
  4471           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4472           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4473           MOVE CLIENT-STATE        TO WS-CM-STATE
  4474           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4475           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4476           MOVE CLIENT-CERT-NO (1:10)
  4477                                    TO WS-CM-CERT-NO
  4478
  4479* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  79
* SOCK03.cbl
  4480*             INTO    (CERTIFICATE-MASTER)
  4481*             DATASET ('ELCERT')
  4482*             RIDFLD  (WS-CM-KEY)
  4483*             RESP    (WS-RESPONSE)
  4484*          END-EXEC
  4485     MOVE LENGTH OF
  4486      CERTIFICATE-MASTER
  4487       TO DFHEIV11
  4488     MOVE 'ELCERT' TO DFHEIV1
  4489*    MOVE '&"IL       E          (  N#00004386' TO DFHEIV0
  4490     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4491     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4492     MOVE X'204E233030303034333836' TO DFHEIV0(25:11)
  4493     CALL 'kxdfhei1' USING DFHEIV0,
  4494           DFHEIV1,
  4495           CERTIFICATE-MASTER,
  4496           DFHEIV11,
  4497           WS-CM-KEY,
  4498           DFHEIV99,
  4499           DFHEIV99,
  4500           DFHEIV99
  4501     MOVE EIBRESP  TO WS-RESPONSE
  4502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4503        WHEN WS-ELCERT-ACT-NAME
  4504           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4505           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4506           MOVE CLIENT-STATE        TO WS-CM-STATE
  4507           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4508           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4509           MOVE ZEROS               TO WS-CM-CERT-NO
  4510
  4511* EXEC CICS STARTBR
  4512*             DATASET ('ELCERT')
  4513*             RIDFLD  (WS-CM-KEY)
  4514*             RESP    (WS-RESPONSE)
  4515*          END-EXEC
  4516     MOVE 'ELCERT' TO DFHEIV1
  4517     MOVE 0
  4518       TO DFHEIV11
  4519*    MOVE '&,         G          &  N#00004399' TO DFHEIV0
  4520     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4521     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4522     MOVE X'204E233030303034333939' TO DFHEIV0(25:11)
  4523     CALL 'kxdfhei1' USING DFHEIV0,
  4524           DFHEIV1,
  4525           WS-CM-KEY,
  4526           DFHEIV99,
  4527           DFHEIV11,
  4528           DFHEIV99
  4529     MOVE EIBRESP  TO WS-RESPONSE
  4530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4531        WHEN WS-ELCERT-NAME
  4532           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4533           MOVE SPACES           TO WS-CM-INITIALS
  4534           COMPUTE WS-LENGTH = L1 + +1
  4535
  4536* EXEC CICS STARTBR
  4537*             DATASET   ('ELCERT2')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  80
* SOCK03.cbl
  4538*             RIDFLD    (WS-CM-KEY-A1)
  4539*             GENERIC
  4540*             KEYLENGTH (WS-LENGTH)
  4541*             GTEQ
  4542*             RESP      (WS-RESPONSE)
  4543*          END-EXEC
  4544     MOVE 'ELCERT2' TO DFHEIV1
  4545     MOVE 0
  4546       TO DFHEIV11
  4547*    MOVE '&,   KG    G          &  N#00004408' TO DFHEIV0
  4548     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4549     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4550     MOVE X'204E233030303034343038' TO DFHEIV0(25:11)
  4551     CALL 'kxdfhei1' USING DFHEIV0,
  4552           DFHEIV1,
  4553           WS-CM-KEY-A1,
  4554           WS-LENGTH,
  4555           DFHEIV11,
  4556           DFHEIV99
  4557     MOVE EIBRESP  TO WS-RESPONSE
  4558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4559*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4560*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4561        WHEN WS-ELCERT-CERT-NO
  4562* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4563           MOVE +11 TO WS-LENGTH
  4564           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4565
  4566* EXEC CICS STARTBR
  4567*             DATASET   ('ELCERT5')
  4568*             RIDFLD    (WS-CM-KEY-A4)
  4569*             GENERIC
  4570*             KEYLENGTH (WS-LENGTH)
  4571*             GTEQ
  4572*             RESP      (WS-RESPONSE)
  4573*          END-EXEC
  4574     MOVE 'ELCERT5' TO DFHEIV1
  4575     MOVE 0
  4576       TO DFHEIV11
  4577*    MOVE '&,   KG    G          &  N#00004422' TO DFHEIV0
  4578     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4579     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4580     MOVE X'204E233030303034343232' TO DFHEIV0(25:11)
  4581     CALL 'kxdfhei1' USING DFHEIV0,
  4582           DFHEIV1,
  4583           WS-CM-KEY-A4,
  4584           WS-LENGTH,
  4585           DFHEIV11,
  4586           DFHEIV99
  4587     MOVE EIBRESP  TO WS-RESPONSE
  4588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4589     END-EVALUATE
  4590     .
  4591 0100-EXIT.
  4592     EXIT.
  4593 0150-READ-NEXT-ELCERT.
  4594*    DISPLAY ' MADE 0150 NEXT '
  4595     EVALUATE TRUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  81
* SOCK03.cbl
  4596        WHEN WS-ELCERT-ACT-NAME
  4597*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4598
  4599* EXEC CICS READNEXT
  4600*             DATASET   ('ELCERT')
  4601*             RIDFLD    (WS-CM-KEY)
  4602*             INTO      (CERTIFICATE-MASTER)
  4603*             RESP      (WS-RESPONSE)
  4604*          END-EXEC
  4605     MOVE LENGTH OF
  4606      CERTIFICATE-MASTER
  4607       TO DFHEIV12
  4608     MOVE 'ELCERT' TO DFHEIV1
  4609     MOVE 0
  4610       TO DFHEIV11
  4611*    MOVE '&.IL                  )  N#00004439' TO DFHEIV0
  4612     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4613     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4614     MOVE X'204E233030303034343339' TO DFHEIV0(25:11)
  4615     CALL 'kxdfhei1' USING DFHEIV0,
  4616           DFHEIV1,
  4617           CERTIFICATE-MASTER,
  4618           DFHEIV12,
  4619           WS-CM-KEY,
  4620           DFHEIV99,
  4621           DFHEIV11,
  4622           DFHEIV99,
  4623           DFHEIV99
  4624     MOVE EIBRESP  TO WS-RESPONSE
  4625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4626        WHEN WS-ELCERT-NAME
  4627*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4628
  4629* EXEC CICS READNEXT
  4630*             DATASET   ('ELCERT2')
  4631*             RIDFLD    (WS-CM-KEY-A1)
  4632*             INTO      (CERTIFICATE-MASTER)
  4633*             RESP      (WS-RESPONSE)
  4634*          END-EXEC
  4635     MOVE LENGTH OF
  4636      CERTIFICATE-MASTER
  4637       TO DFHEIV12
  4638     MOVE 'ELCERT2' TO DFHEIV1
  4639     MOVE 0
  4640       TO DFHEIV11
  4641*    MOVE '&.IL                  )  N#00004447' TO DFHEIV0
  4642     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4643     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4644     MOVE X'204E233030303034343437' TO DFHEIV0(25:11)
  4645     CALL 'kxdfhei1' USING DFHEIV0,
  4646           DFHEIV1,
  4647           CERTIFICATE-MASTER,
  4648           DFHEIV12,
  4649           WS-CM-KEY-A1,
  4650           DFHEIV99,
  4651           DFHEIV11,
  4652           DFHEIV99,
  4653           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  82
* SOCK03.cbl
  4654     MOVE EIBRESP  TO WS-RESPONSE
  4655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4656        WHEN WS-ELCERT-CERT-NO
  4657
  4658* EXEC CICS READNEXT
  4659*             DATASET   ('ELCERT5')
  4660*             RIDFLD    (WS-CM-KEY-A4)
  4661*             INTO      (CERTIFICATE-MASTER)
  4662*             RESP      (WS-RESPONSE)
  4663*          END-EXEC
  4664     MOVE LENGTH OF
  4665      CERTIFICATE-MASTER
  4666       TO DFHEIV12
  4667     MOVE 'ELCERT5' TO DFHEIV1
  4668     MOVE 0
  4669       TO DFHEIV11
  4670*    MOVE '&.IL                  )  N#00004454' TO DFHEIV0
  4671     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4672     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4673     MOVE X'204E233030303034343534' TO DFHEIV0(25:11)
  4674     CALL 'kxdfhei1' USING DFHEIV0,
  4675           DFHEIV1,
  4676           CERTIFICATE-MASTER,
  4677           DFHEIV12,
  4678           WS-CM-KEY-A4,
  4679           DFHEIV99,
  4680           DFHEIV11,
  4681           DFHEIV99,
  4682           DFHEIV99
  4683     MOVE EIBRESP  TO WS-RESPONSE
  4684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4685     END-EVALUATE
  4686     .
  4687 0150-EXIT.
  4688     EXIT.
  4689 0200-BEGIN-REFUND-PROCESS.
  4690*    DISPLAY ' MADE 0200 BEGIN '
  4691     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4692                                    WS-ERACCT-SW
  4693     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4694                                    WS-NCB-DIFF-ODD-DAYS
  4695     INITIALIZE WS-STRING-DATA
  4696     IF RESP-NORMAL OR RESP-DUPKEY
  4697        EVALUATE TRUE
  4698           WHEN WS-ELCERT-ACT-NAME
  4699              EVALUATE TRUE
  4700                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4701                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4702                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4703                    OR (CM-STATE NOT = CLIENT-STATE)
  4704                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  4705                    SET ELCERT-FINISHED TO TRUE
  4706                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4707                    CLIENT-LAST-NAME (1:L1))
  4708                    GO TO 0200-CONTINUE
  4709                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4710                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4711                    GO TO 0200-CONTINUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  83
* SOCK03.cbl
  4712                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4713                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4714                     CLIENT-FIRST-NAME (1:F1)))
  4715                    GO TO 0200-CONTINUE
  4716                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4717                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4718                    GO TO 0200-CONTINUE
  4719              END-EVALUATE
  4720           WHEN WS-ELCERT-CERT-NO
  4721              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4722                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  4723                 SET ELCERT-FINISHED TO TRUE
  4724              ELSE
  4725                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4726                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4727                              OR
  4728                    ((CLIENT-LAST-NAME NOT = SPACES)
  4729                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4730                        CLIENT-LAST-NAME (1:L1)))
  4731                              OR
  4732                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4733                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4734                        CLIENT-FIRST-NAME (1:F1)))
  4735                              OR
  4736                    ((CLIENT-ACCOUNT NOT = SPACES)
  4737                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4738                     GO TO 0200-CONTINUE
  4739                 END-IF
  4740              END-IF
  4741           WHEN WS-ELCERT-NAME
  4742              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4743                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4744                    CLIENT-LAST-NAME (1:L1))
  4745                  SET ELCERT-FINISHED TO TRUE
  4746              ELSE
  4747                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4748                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4749                           OR
  4750                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4751                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4752                     CLIENT-FIRST-NAME (1:F1)))
  4753                           OR
  4754                 ((CLIENT-ACCOUNT NOT = SPACES)
  4755                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4756                  GO TO 0200-CONTINUE
  4757                 END-IF
  4758              END-IF
  4759           WHEN OTHER
  4760              SET ELCERT-FINISHED   TO TRUE
  4761        END-EVALUATE
  4762     ELSE
  4763        SET ELCERT-FINISHED TO TRUE
  4764     END-IF
  4765*       IF WS-ELCERT-CERT-NO
  4766*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4767*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4768*                          OR
  4769*                ((CLIENT-EFF-DT NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  84
* SOCK03.cbl
  4770*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4771*                          OR
  4772*                ((CLIENT-LAST-NAME NOT = SPACES)
  4773*                 AND (CM-INSURED-LAST-NAME NOT =
  4774*                    CLIENT-LAST-NAME))
  4775*                 SET ELCERT-FINISHED TO TRUE
  4776*          END-IF
  4777*          IF WS-ELCERT-NAME
  4778*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4779*                OR (CM-INSURED-LAST-NAME NOT =
  4780*                   CLIENT-LAST-NAME)
  4781*                            OR
  4782*                ((CLIENT-EFF-DT NOT = SPACES)
  4783*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4784*                 SET ELCERT-FINISHED TO TRUE
  4785*             END-IF
  4786*          ELSE
  4787*             SET ELCERT-FINISHED   TO TRUE
  4788*          END-IF
  4789     IF NOT WS-ELCERT-FULL
  4790        IF ELCERT-FINISHED
  4791           GO TO 0200-EXIT
  4792        END-IF
  4793     END-IF
  4794     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  4795        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4796        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4797        PERFORM 0030-BUILD-BUFFER
  4798                                 THRU 0030-EXIT
  4799        PERFORM 0020-SEND-BUFFER
  4800                                 THRU 0020-EXIT
  4801        GO TO 0200-CONTINUE
  4802     END-IF
  4803     PERFORM 0300-GET-ELCNTL-RECORDS
  4804                                 THRU 0300-EXIT
  4805     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4806     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4807     MOVE +0                     TO DC-ELAPSED-MONTHS
  4808                                    DC-ELAPSED-DAYS
  4809     MOVE '1'                    TO DC-OPTION-CODE
  4810     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4811     IF NO-CONVERSION-ERROR
  4812        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4813        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4814     END-IF
  4815     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4816     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4817     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4818     IF NOT ALREADY-SENT
  4819        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  4820     END-IF
  4821     .
  4822 0200-CONTINUE.
  4823     PERFORM 0150-READ-NEXT-ELCERT
  4824                                 THRU 0150-EXIT
  4825     .
  4826 0200-EXIT.
  4827     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  85
* SOCK03.cbl
  4828 0300-GET-ELCNTL-RECORDS.
  4829     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4830     IF NOT RESP-NORMAL
  4831        MOVE ' COMPANY RECORD NOT FOUND '
  4832                                 TO WS-COMMENT
  4833        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4834        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4835        PERFORM 0020-SEND-BUFFER
  4836                                 THRU 0020-EXIT
  4837        PERFORM 0025-CLOSE-SOCKET
  4838                                 THRU 0025-EXIT
  4839        GO TO 0010-RETURN
  4840     END-IF
  4841     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4842        PERFORM 0320-GET-LIFE-RECORD
  4843                                 THRU 0320-EXIT
  4844        IF NOT RESP-NORMAL
  4845           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4846                                 TO WS-COMMENT
  4847           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4848           PERFORM 0030-BUILD-BUFFER
  4849                                 THRU 0030-EXIT
  4850           PERFORM 0020-SEND-BUFFER
  4851                                 THRU 0020-EXIT
  4852           PERFORM 0025-CLOSE-SOCKET
  4853                                 THRU 0025-EXIT
  4854           GO TO 0010-RETURN
  4855        END-IF
  4856     END-IF
  4857     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  4858        PERFORM 0330-GET-AH-RECORD
  4859                                 THRU 0330-EXIT
  4860        IF NOT RESP-NORMAL
  4861           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4862                                 TO WS-COMMENT
  4863           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4864           PERFORM 0030-BUILD-BUFFER
  4865                                 THRU 0030-EXIT
  4866           PERFORM 0020-SEND-BUFFER
  4867                                 THRU 0020-EXIT
  4868           PERFORM 0025-CLOSE-SOCKET
  4869                                 THRU 0025-EXIT
  4870           GO TO 0010-RETURN
  4871        END-IF
  4872     END-IF
  4873     PERFORM 0340-GET-STATE-RECORD
  4874                                 THRU 0340-EXIT
  4875     IF NOT RESP-NORMAL
  4876        MOVE ' STATE RECORD NOT FOUND '
  4877                                 TO WS-COMMENT
  4878        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4879        PERFORM 0030-BUILD-BUFFER
  4880                                 THRU 0030-EXIT
  4881        PERFORM 0020-SEND-BUFFER
  4882                                 THRU 0020-EXIT
  4883        PERFORM 0025-CLOSE-SOCKET
  4884                                 THRU 0025-EXIT
  4885        GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  86
* SOCK03.cbl
  4886     END-IF
  4887     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4888     IF NOT ERACCT-FOUND
  4889        MOVE ' ACCOUNT NOT FOUND '
  4890                                 TO WS-COMMENT
  4891        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4892        PERFORM 0030-BUILD-BUFFER
  4893                                 THRU 0030-EXIT
  4894        PERFORM 0020-SEND-BUFFER
  4895                                 THRU 0020-EXIT
  4896        PERFORM 0025-CLOSE-SOCKET
  4897                                 THRU 0025-EXIT
  4898        GO TO 0010-RETURN
  4899     ELSE
  4900        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4901        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  4902        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  4903        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4904     END-IF
  4905     .
  4906 0300-EXIT.
  4907     EXIT.
  4908 0310-GET-COMPANY.
  4909     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4910     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  4911     MOVE SPACES                 TO  WS-CF-ACCESS
  4912     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4913
  4914* EXEC CICS READ
  4915*       INTO    (CONTROL-FILE)
  4916*       DATASET ('ELCNTL')
  4917*       RIDFLD  (WS-CF-KEY)
  4918*       RESP    (WS-RESPONSE)
  4919*    END-EXEC
  4920     MOVE LENGTH OF
  4921      CONTROL-FILE
  4922       TO DFHEIV11
  4923     MOVE 'ELCNTL' TO DFHEIV1
  4924*    MOVE '&"IL       E          (  N#00004688' TO DFHEIV0
  4925     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4926     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4927     MOVE X'204E233030303034363838' TO DFHEIV0(25:11)
  4928     CALL 'kxdfhei1' USING DFHEIV0,
  4929           DFHEIV1,
  4930           CONTROL-FILE,
  4931           DFHEIV11,
  4932           WS-CF-KEY,
  4933           DFHEIV99,
  4934           DFHEIV99,
  4935           DFHEIV99
  4936     MOVE EIBRESP  TO WS-RESPONSE
  4937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4938     IF (RESP-NORMAL)
  4939        AND (CF-COMPANY-ID = WS-COMP-ID)
  4940        AND (CF-RECORD-TYPE = '1')
  4941        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  4942        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  4943        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  87
* SOCK03.cbl
  4944        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  4945        IF CF-DEFAULT-APR NUMERIC
  4946           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  4947        ELSE
  4948           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  4949        END-IF
  4950        IF CF-VALID-REM-TRM-OPTION
  4951           MOVE CF-REM-TRM-CALC-OPTION
  4952                                 TO WS-CF-REM-TRM-CALC-OPTION
  4953        ELSE
  4954           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  4955        END-IF
  4956     END-IF
  4957     .
  4958 0310-EXIT.
  4959     EXIT.
  4960 0320-GET-LIFE-RECORD.
  4961     MOVE '4'                    TO WS-CF-RECORD-TYPE
  4962     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4963                                    WS-LF-BEN-CODE
  4964     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4965
  4966* EXEC CICS READ
  4967*       INTO    (CONTROL-FILE)
  4968*       DATASET ('ELCNTL')
  4969*       RIDFLD  (WS-CF-KEY)
  4970*       GTEQ
  4971*       RESP    (WS-RESPONSE)
  4972*    END-EXEC
  4973     MOVE LENGTH OF
  4974      CONTROL-FILE
  4975       TO DFHEIV11
  4976     MOVE 'ELCNTL' TO DFHEIV1
  4977*    MOVE '&"IL       G          (  N#00004721' TO DFHEIV0
  4978     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4979     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4980     MOVE X'204E233030303034373231' TO DFHEIV0(25:11)
  4981     CALL 'kxdfhei1' USING DFHEIV0,
  4982           DFHEIV1,
  4983           CONTROL-FILE,
  4984           DFHEIV11,
  4985           WS-CF-KEY,
  4986           DFHEIV99,
  4987           DFHEIV99,
  4988           DFHEIV99
  4989     MOVE EIBRESP  TO WS-RESPONSE
  4990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4991     IF RESP-NORMAL
  4992        AND (CF-COMPANY-ID  = WS-COMP-ID)
  4993        AND (CF-RECORD-TYPE = '4')
  4994        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4995           (S1 > +8)
  4996           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  4997        END-PERFORM
  4998        IF S1 > +8
  4999           CONTINUE
  5000        ELSE
  5001           MOVE CF-BENEFIT-DESCRIP (S1)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  88
* SOCK03.cbl
  5002                                 TO WS-LF-BEN-CODE-DESC
  5003           MOVE CF-LF-COVERAGE-TYPE (S1)
  5004                                 TO WS-CF-LF-COVERAGE-TYPE
  5005           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5006              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5007           ELSE
  5008              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5009           END-IF
  5010           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5011               MOVE CF-CO-REM-TERM-CALC (S1)
  5012                                 TO WS-LF-CO-REM-TERM-CALC
  5013           END-IF
  5014           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5015               MOVE CF-CO-EARNINGS-CALC (S1)
  5016                                 TO WS-LF-CO-EARNINGS-CALC
  5017                                    WS-LF-CO-REFUND-CALC
  5018           END-IF
  5019           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5020               MOVE CF-SPECIAL-CALC-CD (S1)
  5021                                 TO WS-LF-SPECIAL-CALC-CD
  5022           END-IF
  5023           IF CF-CO-REFUND-CALC (S1) > '0'
  5024               MOVE CF-CO-REFUND-CALC (S1)
  5025                                 TO WS-LF-CO-REFUND-CALC
  5026        END-IF
  5027     END-IF
  5028     .
  5029 0320-EXIT.
  5030     EXIT.
  5031 0330-GET-AH-RECORD.
  5032     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5033     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5034     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5035
  5036* EXEC CICS READ
  5037*       INTO    (CONTROL-FILE)
  5038*       DATASET ('ELCNTL')
  5039*       RIDFLD  (WS-CF-KEY)
  5040*       GTEQ
  5041*       RESP    (WS-RESPONSE)
  5042*    END-EXEC
  5043     MOVE LENGTH OF
  5044      CONTROL-FILE
  5045       TO DFHEIV11
  5046     MOVE 'ELCNTL' TO DFHEIV1
  5047*    MOVE '&"IL       G          (  N#00004772' TO DFHEIV0
  5048     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5049     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5050     MOVE X'204E233030303034373732' TO DFHEIV0(25:11)
  5051     CALL 'kxdfhei1' USING DFHEIV0,
  5052           DFHEIV1,
  5053           CONTROL-FILE,
  5054           DFHEIV11,
  5055           WS-CF-KEY,
  5056           DFHEIV99,
  5057           DFHEIV99,
  5058           DFHEIV99
  5059     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  89
* SOCK03.cbl
  5060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5061     IF RESP-NORMAL
  5062        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5063        AND (CF-RECORD-TYPE = '5')
  5064        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5065           (S1 > +8)
  5066           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5067        END-PERFORM
  5068        IF S1 > +8
  5069           CONTINUE
  5070        ELSE
  5071           MOVE CF-BENEFIT-DESCRIP (S1)
  5072                                 TO WS-AH-BEN-CODE-DESC
  5073           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5074              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5075           ELSE
  5076              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5077           END-IF
  5078           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5079              MOVE CF-CO-REM-TERM-CALC (S1)
  5080                                 TO WS-AH-CO-REM-TERM-CALC
  5081           END-IF
  5082           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5083              MOVE CF-CO-EARNINGS-CALC (S1)
  5084                                 TO WS-AH-CO-EARNINGS-CALC
  5085                                    WS-AH-CO-REFUND-CALC
  5086           END-IF
  5087           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5088              MOVE CF-SPECIAL-CALC-CD (S1)
  5089                                 TO WS-AH-SPECIAL-CALC-CD
  5090           END-IF
  5091           IF CF-CO-REFUND-CALC (S1) > '0'
  5092              MOVE CF-CO-REFUND-CALC (S1)
  5093                                 TO WS-AH-CO-REFUND-CALC
  5094           END-IF
  5095           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5096              MOVE CF-BENEFIT-CATEGORY (S1)
  5097                                 TO WS-AH-BEN-CATEGORY
  5098           END-IF
  5099        END-IF
  5100     END-IF
  5101     .
  5102 0330-EXIT.
  5103     EXIT.
  5104 0340-GET-STATE-RECORD.
  5105     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5106     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5107     MOVE CM-STATE               TO WS-CF-ACCESS
  5108     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5109
  5110* EXEC CICS READ
  5111*       INTO    (CONTROL-FILE)
  5112*       DATASET ('ELCNTL')
  5113*       RIDFLD  (WS-CF-KEY)
  5114*       RESP    (WS-RESPONSE)
  5115*    END-EXEC
  5116     MOVE LENGTH OF
  5117      CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  90
* SOCK03.cbl
  5118       TO DFHEIV11
  5119     MOVE 'ELCNTL' TO DFHEIV1
  5120*    MOVE '&"IL       E          (  N#00004827' TO DFHEIV0
  5121     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5123     MOVE X'204E233030303034383237' TO DFHEIV0(25:11)
  5124     CALL 'kxdfhei1' USING DFHEIV0,
  5125           DFHEIV1,
  5126           CONTROL-FILE,
  5127           DFHEIV11,
  5128           WS-CF-KEY,
  5129           DFHEIV99,
  5130           DFHEIV99,
  5131           DFHEIV99
  5132     MOVE EIBRESP  TO WS-RESPONSE
  5133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5134     IF (RESP-NORMAL)
  5135        AND (CF-COMPANY-ID = WS-COMP-ID)
  5136        AND (CF-RECORD-TYPE = '3')
  5137        AND (CF-STATE-CODE = CM-STATE)
  5138        MOVE CF-ST-FREE-LOOK-PERIOD
  5139                                 TO WS-FREE-LOOK
  5140        MOVE CF-STATE-ABBREVIATION
  5141                                 TO WS-STATE-ABBREVIATION
  5142        MOVE CF-ST-FST-PMT-DAYS-CHG
  5143                                 TO  WS-STATE-EXT-DAYS-CHG
  5144        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5145           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5146           IF CF-ST-RT-CALC NOT = SPACES
  5147              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5148           END-IF
  5149           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5150              IF CF-ST-RF-LR-CALC > '0'
  5151                 MOVE CF-ST-RF-LR-CALC
  5152                                 TO WS-LF-ST-REFUND-CALC
  5153              END-IF
  5154              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5155                 IF CF-ST-RF-LN-CALC > '0'
  5156                    MOVE CF-ST-RF-LN-CALC
  5157                                 TO WS-LF-ST-REFUND-CALC
  5158                 END-IF
  5159              END-IF
  5160           ELSE
  5161              IF CF-ST-RF-LL-CALC > '0'
  5162                 MOVE CF-ST-RF-LL-CALC
  5163                                 TO WS-LF-ST-REFUND-CALC
  5164              END-IF
  5165           END-IF
  5166           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5167              (S1 > 50)
  5168              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5169                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5170           END-PERFORM
  5171           IF S1 < +51
  5172              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5173                 MOVE CF-ST-REM-TERM-CALC (S1)
  5174                                 TO WS-LF-ST-REM-TERM-CALC
  5175              END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  91
* SOCK03.cbl
  5176              IF CF-ST-REFUND-CALC (S1) > '0'
  5177                 MOVE CF-ST-REFUND-CALC (S1)
  5178                                 TO WS-LF-ST-REFUND-CALC
  5179              END-IF
  5180           END-IF
  5181        END-IF
  5182        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5183           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5184           IF CF-ST-RT-CALC NOT = SPACES
  5185              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5186           END-IF
  5187           IF CF-ST-RF-AH-CALC > '0'
  5188              MOVE CF-ST-RF-AH-CALC
  5189                                 TO WS-AH-ST-REFUND-CALC
  5190           END-IF
  5191           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5192              IF CF-ST-RF-CP-CALC > '0'
  5193                 MOVE CF-ST-RF-CP-CALC
  5194                                 TO WS-AH-ST-REFUND-CALC
  5195              END-IF
  5196           END-IF
  5197           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5198              (S1 > 50)
  5199              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5200                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5201           END-PERFORM
  5202           IF S1 < +51
  5203              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5204                 MOVE CF-ST-REM-TERM-CALC (S1)
  5205                                 TO WS-AH-ST-REM-TERM-CALC
  5206              END-IF
  5207              IF CF-ST-REFUND-CALC (S1) > '0'
  5208                 MOVE CF-ST-REFUND-CALC (S1)
  5209                                 TO WS-AH-ST-REFUND-CALC
  5210              END-IF
  5211           END-IF
  5212        END-IF
  5213     END-IF
  5214     .
  5215 0340-EXIT.
  5216     EXIT.
  5217 0350-GET-ERACCT.
  5218     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5219                                    WS-AM-EARN-METHOD-R
  5220                                    WS-AM-EARN-METHOD-A
  5221                                    WS-LF-AM-REM-TERM-CALC
  5222                                    WS-AH-AM-REM-TERM-CALC
  5223     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5224     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5225     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5226     MOVE CM-STATE               TO WS-AM-STATE
  5227     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5228     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5229     MOVE LOW-VALUES             TO WS-AM-FILLER
  5230     MOVE ' '                    TO WS-STOP-SW
  5231
  5232* EXEC CICS STARTBR
  5233*       DATASET  ('ERACCT')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  92
* SOCK03.cbl
  5234*       RIDFLD   (WS-AM-KEY)
  5235*       GTEQ
  5236*       RESP (WS-RESPONSE)
  5237*    END-EXEC
  5238     MOVE 'ERACCT' TO DFHEIV1
  5239     MOVE 0
  5240       TO DFHEIV11
  5241*    MOVE '&,         G          &  N#00004930' TO DFHEIV0
  5242     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5243     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5244     MOVE X'204E233030303034393330' TO DFHEIV0(25:11)
  5245     CALL 'kxdfhei1' USING DFHEIV0,
  5246           DFHEIV1,
  5247           WS-AM-KEY,
  5248           DFHEIV99,
  5249           DFHEIV11,
  5250           DFHEIV99
  5251     MOVE EIBRESP  TO WS-RESPONSE
  5252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5253     IF RESP-NORMAL
  5254        PERFORM UNTIL TOLD-TO-STOP
  5255
  5256* EXEC CICS READNEXT
  5257*             DATASET  ('ERACCT')
  5258*             INTO     (ACCOUNT-MASTER)
  5259*             RIDFLD   (WS-AM-KEY)
  5260*          END-EXEC
  5261     MOVE LENGTH OF
  5262      ACCOUNT-MASTER
  5263       TO DFHEIV12
  5264     MOVE 'ERACCT' TO DFHEIV1
  5265     MOVE 0
  5266       TO DFHEIV11
  5267*    MOVE '&.IL                  )   #00004938' TO DFHEIV0
  5268     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5269     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5270     MOVE X'2020233030303034393338' TO DFHEIV0(25:11)
  5271     CALL 'kxdfhei1' USING DFHEIV0,
  5272           DFHEIV1,
  5273           ACCOUNT-MASTER,
  5274           DFHEIV12,
  5275           WS-AM-KEY,
  5276           DFHEIV99,
  5277           DFHEIV11,
  5278           DFHEIV99,
  5279           DFHEIV99
  5280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5281           IF RESP-NORMAL
  5282              EVALUATE TRUE
  5283                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5284                    CM-CONTROL-PRIMARY (1:20)
  5285                    SET TOLD-TO-STOP TO TRUE
  5286                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5287                    CM-CONTROL-PRIMARY (1:20))
  5288                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5289                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5290                    SET ERACCT-FOUND      TO TRUE
  5291                    SET TOLD-TO-STOP TO TRUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  93
* SOCK03.cbl
  5292              END-EVALUATE
  5293           ELSE
  5294              SET TOLD-TO-STOP TO TRUE
  5295           END-IF
  5296        END-PERFORM
  5297
  5298* EXEC CICS ENDBR
  5299*          DATASET   ('ERACCT')
  5300*       END-EXEC
  5301     MOVE 'ERACCT' TO DFHEIV1
  5302     MOVE 0
  5303       TO DFHEIV11
  5304*    MOVE '&2                    $   #00004959' TO DFHEIV0
  5305     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5306     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5307     MOVE X'2020233030303034393539' TO DFHEIV0(25:11)
  5308     CALL 'kxdfhei1' USING DFHEIV0,
  5309           DFHEIV1,
  5310           DFHEIV11,
  5311           DFHEIV99
  5312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5313     END-IF
  5314     .
  5315 0350-EXIT.
  5316     EXIT.
  5317 0400-PROCESS-LIFE.
  5318     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5319     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5320     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5321     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5322     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5323     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5324     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5325     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5326     MOVE CM-CARRIER             TO WS-CARRIER
  5327     MOVE CM-GROUPING            TO WS-GROUPING
  5328     MOVE CM-STATE               TO WS-STATE
  5329     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5330     MOVE CM-CERT-NO             TO WS-CERT-NO
  5331     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5332     MOVE ' '                    TO  DC-OPTION-CODE.
  5333     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5334     IF NO-CONVERSION-ERROR
  5335        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5336     ELSE
  5337        MOVE 99999999            TO WS-CERT-EFF-DATE
  5338     END-IF
  5339     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5340        GO TO 0400-EXIT
  5341     END-IF
  5342     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5343                                    WS-TOT-LF-PREM
  5344                                    WS-TOT-LF-COMM
  5345     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5346     MOVE ' '                    TO  DC-OPTION-CODE
  5347     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5348     IF NO-CONVERSION-ERROR
  5349        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  94
* SOCK03.cbl
  5350     ELSE
  5351        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5352     END-IF
  5353     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5354     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5355     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5356     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5357     MOVE CM-STATE               TO CP-STATE
  5358     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5359     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5360     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5361     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5362     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5363     MOVE '2'                    TO CP-PROCESS-TYPE
  5364     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5365     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5366     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5367     MOVE WS-CF-REM-TRM-CALC-OPTION
  5368                                 TO CP-REM-TRM-CALC-OPTION
  5369     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5370     IF WS-LF-CO-REM-TERM-CALC > '0'
  5371        MOVE WS-LF-CO-REM-TERM-CALC
  5372                                 TO CP-REM-TERM-METHOD
  5373     END-IF
  5374     IF WS-LF-ST-REM-TERM-CALC > '0'
  5375         MOVE WS-LF-ST-REM-TERM-CALC
  5376                                 TO  CP-REM-TERM-METHOD.
  5377     IF WS-LF-AM-REM-TERM-CALC > '0'
  5378         MOVE WS-LF-AM-REM-TERM-CALC
  5379                                 TO  CP-REM-TERM-METHOD.
  5380     IF (WS-COMP-ID = 'CID')
  5381        AND (CP-STATE-STD-ABBRV = 'WI')
  5382        MOVE '7'                 TO CP-REM-TERM-METHOD
  5383        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5384     END-IF
  5385     IF (WS-COMP-ID = 'CID')
  5386        AND (CP-STATE-STD-ABBRV = 'MO')
  5387        AND (CM-CERT-EFF-DT >= X'9B41')
  5388        AND (CM-CERT-EFF-DT <= X'A2FB')
  5389        MOVE '7'                 TO CP-REM-TERM-METHOD
  5390        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5391     END-IF
  5392     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5393                                    CP-LOAN-TERM
  5394                                    WS-LF-TERM
  5395     IF CP-TRUNCATED-LIFE
  5396         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5397     IF CP-TERM-IS-DAYS
  5398        IF CM-LF-TERM-IN-DAYS NUMERIC
  5399           MOVE CM-LF-TERM-IN-DAYS
  5400                                 TO CP-TERM-OR-EXT-DAYS
  5401        ELSE
  5402           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5403        END-IF
  5404     ELSE
  5405        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5406           MOVE CM-PMT-EXTENSION-DAYS
  5407                                 TO CP-TERM-OR-EXT-DAYS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  95
* SOCK03.cbl
  5408        ELSE
  5409           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5410        END-IF
  5411     END-IF
  5412     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5413     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5414        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5415        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5416     END-IF
  5417     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5418     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5419     MOVE ' '                    TO WS-CLM-STOP-SW
  5420     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5421     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5422
  5423* EXEC CICS STARTBR
  5424*       DATASET     ('ELMSTR5')
  5425*       RIDFLD      (ELMSTR-KEY)
  5426*       RESP        (WS-RESPONSE)
  5427*    END-EXEC
  5428     MOVE 'ELMSTR5' TO DFHEIV1
  5429     MOVE 0
  5430       TO DFHEIV11
  5431*    MOVE '&,         G          &  N#00005071' TO DFHEIV0
  5432     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5433     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5434     MOVE X'204E233030303035303731' TO DFHEIV0(25:11)
  5435     CALL 'kxdfhei1' USING DFHEIV0,
  5436           DFHEIV1,
  5437           ELMSTR-KEY,
  5438           DFHEIV99,
  5439           DFHEIV11,
  5440           DFHEIV99
  5441     MOVE EIBRESP  TO WS-RESPONSE
  5442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5443     DISPLAY ' AFTER START ' WS-RESPONSE
  5444     IF RESP-NORMAL
  5445        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5446
  5447* EXEC CICS READNEXT
  5448*             DATASET   ('ELMSTR5')
  5449*             RIDFLD    (ELMSTR-KEY)
  5450*             INTO      (CLAIM-MASTER)
  5451*             RESP      (WS-RESPONSE)
  5452*          END-EXEC
  5453     MOVE LENGTH OF
  5454      CLAIM-MASTER
  5455       TO DFHEIV12
  5456     MOVE 'ELMSTR5' TO DFHEIV1
  5457     MOVE 0
  5458       TO DFHEIV11
  5459*    MOVE '&.IL                  )  N#00005079' TO DFHEIV0
  5460     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5461     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5462     MOVE X'204E233030303035303739' TO DFHEIV0(25:11)
  5463     CALL 'kxdfhei1' USING DFHEIV0,
  5464           DFHEIV1,
  5465           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  96
* SOCK03.cbl
  5466           DFHEIV12,
  5467           ELMSTR-KEY,
  5468           DFHEIV99,
  5469           DFHEIV11,
  5470           DFHEIV99,
  5471           DFHEIV99
  5472     MOVE EIBRESP  TO WS-RESPONSE
  5473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5474        IF (RESP-NORMAL OR RESP-DUPKEY)
  5475           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5476           AND (CM-CERT-NO = CL-CERT-NO)
  5477           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5478              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5479              IF CL-CLAIM-TYPE = 'L'
  5480                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5481                    MOVE 'D'     TO WS-AH-STATUS
  5482                 END-IF
  5483                 IF CLAIM-IS-OPEN
  5484                    MOVE ' OPEN LIFE CLAIM '
  5485                                 TO WS-COMMENT
  5486                    MOVE 'L'     TO WS-LF-STATUS
  5487                    GO TO 0400-EXIT
  5488                 ELSE
  5489                    MOVE ' DEATH CLAIM APPLIED '
  5490                                 TO WS-COMMENT
  5491                    MOVE 'D'     TO WS-LF-STATUS
  5492*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5493*                      MOVE CL-PAID-THRU-DT
  5494*                                TO WS-LF-BIN-PAID-THRU-DT
  5495*                   END-IF
  5496                 END-IF
  5497              END-IF
  5498           END-IF
  5499        ELSE
  5500           SET I-SAY-TO-STOP TO TRUE
  5501        END-IF
  5502        END-PERFORM
  5503
  5504* EXEC CICS ENDBR
  5505*          DATASET   ('ELMSTR5')
  5506*       END-EXEC
  5507     MOVE 'ELMSTR5' TO DFHEIV1
  5508     MOVE 0
  5509       TO DFHEIV11
  5510*    MOVE '&2                    $   #00005114' TO DFHEIV0
  5511     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5512     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5513     MOVE X'2020233030303035313134' TO DFHEIV0(25:11)
  5514     CALL 'kxdfhei1' USING DFHEIV0,
  5515           DFHEIV1,
  5516           DFHEIV11,
  5517           DFHEIV99
  5518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5519     END-IF
  5520     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5521*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5522        MOVE WS-LF-BIN-PAID-THRU-DT
  5523                                 TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  97
* SOCK03.cbl
  5524        MOVE ' '                 TO DC-OPTION-CODE
  5525        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5526        IF NO-CONVERSION-ERROR
  5527           MOVE DC-GREG-DATE-CYMD
  5528                                 TO WS-CLM-PAID-THRU-DT
  5529        ELSE
  5530           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5531        END-IF
  5532*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5533*          MOVE 'CAN DT =< CLM PD THRU DT'
  5534*                                TO WS-COMMENT
  5535*          MOVE 'P'              TO WS-LF-STATUS
  5536*          GO TO 0400-EXIT
  5537*       END-IF
  5538        GO TO 0400-EXIT
  5539     END-IF
  5540     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5541     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5542        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5543        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5544        COMPUTE CP-REMAINING-TERM-1 =
  5545                CP-REMAINING-TERM-1 - +1
  5546        COMPUTE CP-REMAINING-TERM-2 =
  5547                CP-REMAINING-TERM-2 - +1
  5548     END-IF
  5549     IF CP-REMAINING-TERM-1 NEGATIVE
  5550        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5551     END-IF
  5552     IF CP-REMAINING-TERM-2 NEGATIVE
  5553        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5554     END-IF
  5555     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5556        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5557     END-IF
  5558     IF CM-LIFE-COMM-PCT > ZEROS
  5559        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5560           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5561     END-IF
  5562     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5563     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5564     IF CM-LF-CURRENT-STATUS = '8'
  5565        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5566           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5567                                 TO WS-COMMENT
  5568           MOVE 'C'              TO WS-LF-STATUS
  5569*          PERFORM 0030-BUILD-BUFFER
  5570*                                THRU 0030-EXIT
  5571*          PERFORM 0020-SEND-BUFFER
  5572*                                THRU 0020-EXIT
  5573*          SET ALREADY-SENT      TO TRUE
  5574*          MOVE SPACES           TO WS-COMMENT
  5575           GO TO 0400-EXIT
  5576*          PERFORM 0025-CLOSE-SOCKET
  5577*                                THRU 0025-EXIT
  5578*          GO TO 0010-RETURN
  5579        END-IF
  5580     END-IF
  5581     IF CM-LF-CURRENT-STATUS = '7'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  98
* SOCK03.cbl
  5582        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5583           MOVE ' DEATH CLAIM APPLIED '
  5584                                 TO WS-COMMENT
  5585           MOVE 'D'              TO WS-LF-STATUS
  5586*          PERFORM 0030-BUILD-BUFFER
  5587*                                THRU 0030-EXIT
  5588*          IF NOT ALREADY-SENT
  5589*             PERFORM 0020-SEND-BUFFER
  5590*                                THRU 0020-EXIT
  5591*             SET ALREADY-SENT   TO TRUE
  5592*          END-IF
  5593           GO TO 0400-EXIT
  5594*          PERFORM 0025-CLOSE-SOCKET
  5595*                                THRU 0025-EXIT
  5596*          GO TO 0010-RETURN
  5597        END-IF
  5598     END-IF
  5599     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5600        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5601        MOVE 'LF COVERAGE EXPIRED '
  5602                                 TO WS-COMMENT
  5603        MOVE 'E'                 TO WS-LF-STATUS
  5604        GO TO 0400-EXIT
  5605     END-IF
  5606     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5607        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5608        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5609     ELSE
  5610        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5611     END-IF
  5612     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5613     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5614*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  5615     if ws-comp-id = 'AHL'
  5616        move cm-lf-class-cd      to cp-class-code
  5617        if cp-class-code = spaces
  5618           move zeros            to cp-class-code
  5619        end-if
  5620     else
  5621        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5622     end-if
  5623     IF (ws-comp-id = 'DCC')
  5624        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5625        MOVE ' '                 TO WS-PDEF-RECORD-SW
  5626        PERFORM 0730-GET-DDF-FACTORS
  5627                                 THRU 0730-EXIT
  5628        IF PDEF-FOUND
  5629           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5630              (P1 > +8)
  5631              OR (PD-PROD-CODE (P1) = 'L')
  5632           END-PERFORM
  5633           IF P1 < +9
  5634              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  5635           END-IF
  5636        END-IF
  5637     END-IF
  5638     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5639*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page  99
* SOCK03.cbl
  5640     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5641        CM-LF-ALT-BENEFIT-AMT
  5642*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5643     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5644                                    WS-LF-REM-BEN
  5645     move cm-lf-premium-amt      to ws-tot-lf-prem
  5646     if ws-lf-co-earnings-calc = 'B'
  5647        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  5648           + CM-LF-ALT-PREMIUM-AMT
  5649     end-if
  5650     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5651     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5652        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5653        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5654     ELSE
  5655        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  5656     END-IF
  5657     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5658     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5659     IF WS-LF-ST-REFUND-CALC > ZERO
  5660         MOVE WS-LF-ST-REFUND-CALC
  5661                                 TO  CP-EARNING-METHOD.
  5662     IF WS-LF-FO-REFUND-CALC > ZERO
  5663         MOVE WS-LF-FO-REFUND-CALC
  5664                                 TO  CP-EARNING-METHOD.
  5665     IF CP-RATING-METHOD = '4'
  5666        MOVE '4'                 TO CP-EARNING-METHOD
  5667     END-IF
  5668*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5669     if ws-comp-id = 'AHL'
  5670        move cm-lf-class-cd      to cp-class-code
  5671        if cp-class-code = spaces
  5672           move zeros            to cp-class-code
  5673        end-if
  5674     else
  5675        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5676     end-if
  5677     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5678     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5679                                     CP-RATING-BENEFIT-AMT.
  5680     IF CP-STATE-STD-ABBRV = 'OR'
  5681         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5682                                         CM-LF-ALT-BENEFIT-AMT.
  5683****   N O T E   ****
  5684*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5685*      THE OH HARD CODING IN ELCRFNDP
  5686     IF WS-COMP-ID = 'CID'
  5687        IF CP-STATE-STD-ABBRV = 'OH'
  5688           MOVE WS-LF-CO-EARNINGS-CALC
  5689                                 TO CP-EARNING-METHOD
  5690        END-IF
  5691     END-IF
  5692****   N O T E   ****
  5693     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5694     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5695     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5696     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5697     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 100
* SOCK03.cbl
  5698     IF CP-EARN-AS-NET-PAY
  5699        IF CP-LOAN-APR <= ZEROS
  5700           IF WS-CF-DEFAULT-APR > ZEROS
  5701              MOVE WS-CF-DEFAULT-APR
  5702                                 TO  CP-LOAN-APR
  5703           END-IF
  5704        END-IF
  5705     END-IF
  5706*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5707*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5708*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5709*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5710*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5711*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5712*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5713*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  5714*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5715*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5716*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5717*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5718*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  5719*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5720*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5721*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5722*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  5723*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5724     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5725     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5726     DISPLAY ' MADE IT BACK FROM ELRFND '
  5727     IF (CP-ERROR-RATE-IS-ZERO)
  5728        OR (CP-ERROR-RATE-NOT-FOUND)
  5729        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5730        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  5731          DELIMITED BY SIZE INTO WS-COMMENT
  5732        END-STRING
  5733        MOVE 'X'                 TO WS-LF-STATUS
  5734        GO TO 0400-EXIT
  5735*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5736*       IF NOT ALREADY-SENT
  5737*          PERFORM 0020-SEND-BUFFER
  5738*                                THRU 0020-EXIT
  5739*          SET ALREADY-SENT      TO TRUE
  5740*       END-IF
  5741*       PERFORM 0025-CLOSE-SOCKET
  5742*                                THRU 0025-EXIT
  5743*       GO TO 0010-RETURN
  5744     END-IF
  5745     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5746                                    WS-TOT-LF-RFND
  5747     IF (WS-LF-STATUS = SPACES)
  5748        OR (CP-CALC-REFUND > ZEROS)
  5749        MOVE 'A'                 TO WS-LF-STATUS
  5750     END-IF
  5751     EVALUATE TRUE
  5752        WHEN CP-R-AS-R78
  5753           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5754        WHEN  CP-R-AS-PRORATA
  5755           MOVE 'PRO RATA'         TO  WS-LF-METHOD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 101
* SOCK03.cbl
  5756        WHEN CP-R-AS-CALIF
  5757           MOVE 'CALIF'            TO  WS-LF-METHOD
  5758        WHEN CP-R-AS-TEXAS
  5759           MOVE 'IRREG'            TO  WS-LF-METHOD
  5760        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5761           MOVE 'UTAH'             TO  WS-LF-METHOD
  5762        WHEN CP-R-AS-FARM-PLAN
  5763           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5764        WHEN CP-R-AS-NET-PAY
  5765           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5766        WHEN CP-R-AS-ANTICIPATION
  5767           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5768        WHEN CP-R-AS-MEAN
  5769           MOVE 'MEAN'             TO  WS-LF-METHOD
  5770        WHEN CP-R-AS-SUM-OF-DIGITS
  5771           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  5772     END-EVALUATE
  5773     IF WS-TOT-LF-RFND > ZEROS
  5774        COMPUTE WS-WORK-FACTOR ROUNDED =
  5775           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5776        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  5777           WS-TOT-LF-COMM
  5778     END-IF
  5779     IF ERACCT-FOUND
  5780        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5781           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5782        END-IF
  5783        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5784           IF (AM-COMM-CHARGEBACK (1) = 99)
  5785                     OR
  5786              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5787                     OR
  5788              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5789              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5790              MOVE ZEROS         TO WS-LF-UEC
  5791           END-IF
  5792        END-IF
  5793     END-IF
  5794     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5795        GO TO 0400-EXIT
  5796     END-IF
  5797     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5798     MOVE '2'                    TO  CP-EARNING-METHOD
  5799                                     CP-RATING-METHOD.
  5800     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5801                                     CP-REMAINING-BENEFIT
  5802                                     CP-RATING-BENEFIT-AMT.
  5803     IF CP-STATE-STD-ABBRV = 'OR'
  5804         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5805                                         CM-LF-ALT-BENEFIT-AMT.
  5806     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5807     IF ws-comp-id = 'CID'
  5808        IF (CP-STATE-STD-ABBRV = 'MN')
  5809           AND (CM-CERT-EFF-DT > X'A4FF')
  5810           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  5811           MOVE '5'              TO CP-EARNING-METHOD
  5812           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  5813        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 102
* SOCK03.cbl
  5814     END-IF
  5815     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5816     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5817     IF (CP-ERROR-RATE-IS-ZERO)
  5818        OR (CP-ERROR-RATE-NOT-FOUND)
  5819        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5820        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5821          DELIMITED BY SIZE INTO WS-COMMENT
  5822        END-STRING
  5823        MOVE 'X'              TO WS-LF-STATUS
  5824        GO TO 0400-EXIT
  5825*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5826*       IF NOT ALREADY-SENT
  5827*          PERFORM 0020-SEND-BUFFER
  5828*                                THRU 0020-EXIT
  5829*          SET ALREADY-SENT      TO TRUE
  5830*       END-IF
  5831*       PERFORM 0025-CLOSE-SOCKET
  5832*                                THRU 0025-EXIT
  5833*       GO TO 0010-RETURN
  5834     END-IF
  5835     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5836     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5837     IF WS-TOT-LF-RFND > ZEROS
  5838        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  5839           WS-TOT-LF-COMM
  5840     END-IF
  5841     IF ERACCT-FOUND
  5842        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5843           IF (AM-COMM-CHARGEBACK (1) = 99)
  5844                     OR
  5845              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5846                     OR
  5847              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5848              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5849              MOVE ZEROS         TO WS-LF-UEC
  5850           END-IF
  5851        END-IF
  5852     END-IF
  5853     .
  5854 0400-EXIT.
  5855     EXIT.
  5856 0500-PROCESS-AH.
  5857     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5858        GO TO 0500-EXIT
  5859     END-IF
  5860     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5861                                    WS-TOT-AH-PREM
  5862                                    WS-TOT-AH-COMM
  5863     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5864     MOVE ' '                    TO  DC-OPTION-CODE
  5865     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5866     IF NO-CONVERSION-ERROR
  5867        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5868     ELSE
  5869        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5870     END-IF
  5871     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 103
* SOCK03.cbl
  5872     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5873     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5874     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5875     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5876     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5877     MOVE CM-STATE               TO  CP-STATE.
  5878     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5879     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5880     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5881     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5882     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  5883     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5884     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5885     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5886     MOVE WS-CF-CR-REM-TERM-CALC
  5887                                 TO  CP-REM-TERM-METHOD.
  5888     IF WS-AH-CO-REM-TERM-CALC > '0'
  5889         MOVE WS-AH-CO-REM-TERM-CALC
  5890                                 TO  CP-REM-TERM-METHOD.
  5891     IF WS-AH-ST-REM-TERM-CALC > '0'
  5892         MOVE WS-AH-ST-REM-TERM-CALC
  5893                                 TO  CP-REM-TERM-METHOD.
  5894     IF WS-AH-AM-REM-TERM-CALC > '0'
  5895         MOVE WS-AH-AM-REM-TERM-CALC
  5896                                 TO  CP-REM-TERM-METHOD.
  5897     IF (WS-COMP-ID = 'CID')
  5898        AND (CP-STATE-STD-ABBRV = 'WI')
  5899        MOVE '7'                 TO CP-REM-TERM-METHOD
  5900        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5901     END-IF
  5902     IF (WS-COMP-ID = 'CID')
  5903        AND (CP-STATE-STD-ABBRV = 'MO')
  5904        AND (CM-CERT-EFF-DT >= X'9B41')
  5905        AND (CM-CERT-EFF-DT <= X'A2FB')
  5906        MOVE '7'                 TO CP-REM-TERM-METHOD
  5907        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5908     END-IF
  5909     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5910                                     CP-LOAN-TERM.
  5911     IF  NOT  CP-TERM-IS-DAYS
  5912         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5913             MOVE CM-PMT-EXTENSION-DAYS
  5914                                 TO  CP-TERM-OR-EXT-DAYS
  5915         ELSE
  5916             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5917     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5918     IF CM-AH-COMM-PCT > ZEROS
  5919        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5920           CM-AH-PREMIUM-AMT
  5921     END-IF
  5922     IF (ws-comp-id = 'DCC')
  5923        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5924        compute ws-tot-ah-comm = cm-ah-premium-amt -
  5925           (cm-ah-clp + cm-addl-clp)
  5926     end-if
  5927     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5928     IF WS-AH-STATUS = 'D'
  5929        GO TO 0500-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 104
* SOCK03.cbl
  5930     END-IF
  5931     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  5932     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5933     MOVE ' '                    TO WS-CLM-STOP-SW
  5934     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5935     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5936
  5937* EXEC CICS STARTBR
  5938*       DATASET     ('ELMSTR5')
  5939*       RIDFLD      (ELMSTR-KEY)
  5940*       RESP        (WS-RESPONSE)
  5941*    END-EXEC
  5942     MOVE 'ELMSTR5' TO DFHEIV1
  5943     MOVE 0
  5944       TO DFHEIV11
  5945*    MOVE '&,         G          &  N#00005534' TO DFHEIV0
  5946     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5947     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5948     MOVE X'204E233030303035353334' TO DFHEIV0(25:11)
  5949     CALL 'kxdfhei1' USING DFHEIV0,
  5950           DFHEIV1,
  5951           ELMSTR-KEY,
  5952           DFHEIV99,
  5953           DFHEIV11,
  5954           DFHEIV99
  5955     MOVE EIBRESP  TO WS-RESPONSE
  5956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5957     DISPLAY ' AFTER START ' WS-RESPONSE
  5958     IF RESP-NORMAL
  5959        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5960           DISPLAY ' AH READNEXT '
  5961
  5962* EXEC CICS READNEXT
  5963*             DATASET   ('ELMSTR5')
  5964*             RIDFLD    (ELMSTR-KEY)
  5965*             INTO      (CLAIM-MASTER)
  5966*             RESP      (WS-RESPONSE)
  5967*          END-EXEC
  5968     MOVE LENGTH OF
  5969      CLAIM-MASTER
  5970       TO DFHEIV12
  5971     MOVE 'ELMSTR5' TO DFHEIV1
  5972     MOVE 0
  5973       TO DFHEIV11
  5974*    MOVE '&.IL                  )  N#00005543' TO DFHEIV0
  5975     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5976     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5977     MOVE X'204E233030303035353433' TO DFHEIV0(25:11)
  5978     CALL 'kxdfhei1' USING DFHEIV0,
  5979           DFHEIV1,
  5980           CLAIM-MASTER,
  5981           DFHEIV12,
  5982           ELMSTR-KEY,
  5983           DFHEIV99,
  5984           DFHEIV11,
  5985           DFHEIV99,
  5986           DFHEIV99
  5987     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 105
* SOCK03.cbl
  5988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5989        IF (RESP-NORMAL OR RESP-DUPKEY)
  5990           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5991           AND (CM-CERT-NO = CL-CERT-NO)
  5992           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5993              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5994              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  5995                 IF CLAIM-IS-OPEN
  5996                    DISPLAY ' FOUND OPEN AH CLAIM '
  5997                    MOVE ' OPEN HEALTH CLAIM '
  5998                                 TO WS-COMMENT
  5999                    MOVE 'H'     TO WS-AH-STATUS
  6000                 ELSE
  6001                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6002                    MOVE ' CLOSED HEALTH CLAIM '
  6003                                 TO WS-COMMENT
  6004                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6005                       MOVE CL-PAID-THRU-DT
  6006                                 TO WS-AH-BIN-PAID-THRU-DT
  6007                    END-IF
  6008                 END-IF
  6009              END-IF
  6010           END-IF
  6011        ELSE
  6012           SET I-SAY-TO-STOP TO TRUE
  6013        END-IF
  6014        END-PERFORM
  6015
  6016* EXEC CICS ENDBR
  6017*          DATASET   ('ELMSTR5')
  6018*       END-EXEC
  6019     MOVE 'ELMSTR5' TO DFHEIV1
  6020     MOVE 0
  6021       TO DFHEIV11
  6022*    MOVE '&2                    $   #00005575' TO DFHEIV0
  6023     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6025     MOVE X'2020233030303035353735' TO DFHEIV0(25:11)
  6026     CALL 'kxdfhei1' USING DFHEIV0,
  6027           DFHEIV1,
  6028           DFHEIV11,
  6029           DFHEIV99
  6030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6031     END-IF
  6032     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6033*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6034        MOVE WS-AH-BIN-PAID-THRU-DT
  6035                                 TO DC-BIN-DATE-1
  6036        MOVE ' '                 TO DC-OPTION-CODE
  6037        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6038        IF NO-CONVERSION-ERROR
  6039           MOVE DC-GREG-DATE-CYMD
  6040                                 TO WS-CLM-PAID-THRU-DT
  6041        ELSE
  6042           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6043        END-IF
  6044        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6045           MOVE 'CAN DT NOT > CLM CLOSE DT '
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 106
* SOCK03.cbl
  6046                                 TO WS-COMMENT
  6047           MOVE 'P'              TO WS-AH-STATUS
  6048           GO TO 0500-EXIT
  6049        END-IF
  6050     END-IF
  6051     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6052     IF CM-AH-CURRENT-STATUS = '8'
  6053        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6054           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6055                                 TO WS-COMMENT
  6056           MOVE 'C'              TO WS-AH-STATUS
  6057           GO TO 0500-EXIT
  6058        END-IF
  6059     END-IF
  6060     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6061        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6062           MOVE ' SETTLEMENT CLAIM APPLIED '
  6063                                 TO WS-COMMENT
  6064           MOVE 'S'              TO WS-AH-STATUS
  6065*          PERFORM 0030-BUILD-BUFFER
  6066*                                THRU 0030-EXIT
  6067*          IF NOT ALREADY-SENT
  6068*             PERFORM 0020-SEND-BUFFER
  6069*                                THRU 0020-EXIT
  6070*             SET ALREADY-SENT   TO TRUE
  6071*          END-IF
  6072           GO TO 0500-EXIT
  6073*          PERFORM 0025-CLOSE-SOCKET
  6074*                                THRU 0025-EXIT
  6075*          GO TO 0010-RETURN
  6076        END-IF
  6077     END-IF
  6078     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6079        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6080        MOVE 'AH COVERAGE EXPIRED '
  6081                                 TO WS-COMMENT
  6082        MOVE 'E'                 TO WS-AH-STATUS
  6083        GO TO 0500-EXIT
  6084     END-IF
  6085     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6086                                    WS-AH-PREM
  6087     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6088     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6089        * CP-REMAINING-TERM-1
  6090     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6091                                     WS-AH-REM-TERM
  6092     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6093     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6094     IF WS-AH-ST-REFUND-CALC > ZERO
  6095         MOVE WS-AH-ST-REFUND-CALC
  6096                                 TO  CP-EARNING-METHOD.
  6097     IF WS-AH-FO-REFUND-CALC > ZERO
  6098         MOVE WS-AH-FO-REFUND-CALC
  6099                                 TO  CP-EARNING-METHOD.
  6100*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6101     if ws-comp-id = 'AHL'
  6102        move cm-ah-class-cd      to cp-class-code
  6103        if cp-class-code = spaces
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 107
* SOCK03.cbl
  6104           move zeros            to cp-class-code
  6105        end-if
  6106     else
  6107        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6108     end-if
  6109     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6110     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6111                                     CP-RATING-BENEFIT-AMT.
  6112     IF CP-STATE-STD-ABBRV = 'OR'
  6113         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6114                                         CM-AH-ORIG-TERM.
  6115     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6116     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6117     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6118     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6119     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6120     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6121     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6122     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6123     MOVE ' '                    TO  DC-OPTION-CODE.
  6124     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6125     IF CP-STATE-STD-ABBRV = 'OH'
  6126        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6127         IF (CP-ORIGINAL-TERM > 60)
  6128           AND (DC-GREG-DATE-1-YMD > '831101')
  6129           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6130             MOVE '6'            TO  CP-EARNING-METHOD
  6131         END-IF
  6132        END-IF
  6133        IF WS-COMP-ID = 'CID'
  6134           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6135                           LOW-VALUES)
  6136              IF CP-CRITICAL-PERIOD
  6137                 MOVE '2'       TO CP-EARNING-METHOD
  6138              ELSE
  6139                 MOVE '6'       TO CP-EARNING-METHOD
  6140              END-IF
  6141           ELSE
  6142              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6143                 MOVE '2'       TO CP-EARNING-METHOD
  6144              ELSE
  6145                 IF ((CM-LF-ORIG-TERM > 60) AND
  6146                    (CM-RATE-CLASS NOT = 'L '))
  6147                               OR
  6148                    (WS-LF-CO-EARNINGS-CALC = '5')
  6149                    IF CP-CRITICAL-PERIOD
  6150                       MOVE '2'  TO CP-EARNING-METHOD
  6151                    ELSE
  6152                       MOVE '6'  TO CP-EARNING-METHOD
  6153                    END-IF
  6154                 ELSE
  6155                    MOVE '1'     TO CP-EARNING-METHOD
  6156                 END-IF
  6157              END-IF
  6158           END-IF
  6159        END-IF
  6160     END-IF
  6161     IF CP-STATE-STD-ABBRV = 'VA'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 108
* SOCK03.cbl
  6162       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6163         IF DC-GREG-DATE-1-YMD > '921231'
  6164            IF CP-ORIGINAL-TERM > 61
  6165                MOVE '6'            TO  CP-EARNING-METHOD
  6166            ELSE
  6167                MOVE '1'            TO  CP-EARNING-METHOD.
  6168     IF CP-EARN-AS-NET-PAY
  6169        IF CP-LOAN-APR <= ZEROS
  6170           IF WS-CF-DEFAULT-APR > ZEROS
  6171              MOVE WS-CF-DEFAULT-APR
  6172                                 TO  CP-LOAN-APR
  6173           END-IF
  6174        END-IF
  6175     END-IF
  6176     IF WS-COMP-ID = 'DCC'
  6177        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6178           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6179           MOVE 'S'              TO CP-EARNING-METHOD
  6180        END-IF
  6181     END-IF
  6182     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6183     IF (WS-COMP-ID = 'DCC')
  6184        AND (CP-EARNING-METHOD = 'D')
  6185        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6186                                    WS-DDF-CSO-ADMIN-FEE
  6187                                    WS-DDF-1ST-YR-TOT-EXP
  6188                                    WS-DDF-COMM-AND-MFEE
  6189        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6190           S1 > +10
  6191           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6192              IF (AM-A-COM (S1) NUMERIC)
  6193                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6194                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6195              ELSE
  6196                 MOVE +0         TO WS-COMM-PCT C0
  6197                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6198                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6199              END-IF
  6200              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6201                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6202                    + WS-COMM-PCT
  6203              END-IF
  6204              IF AM-COM-TYP (S1) = 'N'
  6205                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6206                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6207              END-IF
  6208              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6209                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6210                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6211              END-IF
  6212              IF AM-COM-TYP (S1) = 'I'
  6213                 COMPUTE WS-DDF-COMM-AND-MFEE
  6214                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6215              END-IF
  6216           END-IF
  6217        END-PERFORM
  6218        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6219        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 109
* SOCK03.cbl
  6220        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6221           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6222     END-IF
  6223     IF (WS-COMP-ID = 'DCC')
  6224        AND (CP-EARNING-METHOD = 'D')
  6225        AND (ws-CANCEL-REASON NOT = 'R')
  6226        PERFORM 0730-GET-DDF-FACTORS
  6227                                 THRU 0730-EXIT
  6228        IF NOT PDEF-FOUND
  6229           MOVE ' DDF UE FACTORS  NOT FOUND '
  6230                                 TO WS-COMMENT
  6231           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6232           PERFORM 0030-BUILD-BUFFER
  6233                                 THRU 0030-EXIT
  6234           PERFORM 0020-SEND-BUFFER
  6235                                 THRU 0020-EXIT
  6236           PERFORM 0025-CLOSE-SOCKET
  6237                                 THRU 0025-EXIT
  6238           GO TO 0010-RETURN
  6239        END-IF
  6240*       IF NOT PDEF-FOUND
  6241*          MOVE ER-9999          TO EMI-ERROR
  6242*          PERFORM 9700-ERROR-FORMAT
  6243*                                THRU 9799-EXIT
  6244*          GO TO 8200-SEND-DATAONLY
  6245*       END-IF
  6246        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6247                                 TO CP-DDF-LO-FACT
  6248        MOVE PD-UEP-FACTOR (P1 P2)
  6249                                 TO CP-DDF-HI-FACT
  6250        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6251        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6252        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6253        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6254           + PD-1ST-YR-ADMIN-ALLOW
  6255        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6256*       IF PI-CLP-YN = 'Y'
  6257*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6258*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6259*                                   CP-DDF-CLP
  6260*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6261*       END-IF
  6262        IF DD-IU-PRESENT
  6263           MOVE 'I'              TO CP-EARNING-METHOD
  6264        END-IF
  6265        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6266                                    CP-CLP-RATE-UP
  6267        IF (CP-CALC-GROSS-FEE)
  6268           AND (CP-IU-RATE-UP NOT = ZEROS)
  6269           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6270              / CP-ORIGINAL-PREMIUM)
  6271           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6272              / (1 - TEX-FACT-8)
  6273        END-IF
  6274     END-IF
  6275     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6276     IF (CP-ERROR-RATE-IS-ZERO)
  6277        OR (CP-ERROR-RATE-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 110
* SOCK03.cbl
  6278        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6279        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6280          DELIMITED BY SIZE INTO WS-COMMENT
  6281        END-STRING
  6282        IF WS-AH-STATUS NOT = 'H'
  6283           MOVE 'X'                 TO WS-AH-STATUS
  6284        END-IF
  6285        GO TO 0500-EXIT
  6286*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6287*       IF NOT ALREADY-SENT
  6288*          PERFORM 0020-SEND-BUFFER
  6289*                                THRU 0020-EXIT
  6290*          SET ALREADY-SENT      TO TRUE
  6291*       END-IF
  6292*       PERFORM 0025-CLOSE-SOCKET
  6293*                                THRU 0025-EXIT
  6294*       GO TO 0010-RETURN
  6295     END-IF
  6296     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6297                                    WS-TOT-AH-RFND
  6298     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6299     IF ((WS-AH-STATUS = SPACES)
  6300        OR (CP-CALC-REFUND > ZEROS))
  6301                  AND
  6302          (WS-AH-STATUS NOT = 'H')
  6303        MOVE 'A'                 TO WS-AH-STATUS
  6304     END-IF
  6305     IF WS-COMP-ID = 'DCC'
  6306        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6307        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6308        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6309        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6310        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6311        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6312        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6313        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6314        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6315     END-IF
  6316     EVALUATE TRUE
  6317        WHEN CP-R-AS-R78
  6318           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6319        WHEN CP-R-AS-PRORATA
  6320           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  6321        WHEN CP-REFUND-TYPE-USED = '3'
  6322           MOVE 'CALIF'            TO  WS-AH-METHOD
  6323        WHEN CP-R-AS-TEXAS
  6324           MOVE 'IRREG'            TO  WS-AH-METHOD
  6325        WHEN CP-R-AS-FARM-PLAN
  6326           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  6327        WHEN CP-R-AS-NET-PAY
  6328           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6329        WHEN CP-R-AS-ANTICIPATION
  6330           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6331        WHEN CP-R-AS-MEAN
  6332           MOVE 'MEAN'             TO  WS-AH-METHOD
  6333        WHEN CP-R-AS-SUM-OF-DIGITS
  6334           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  6335        WHEN CP-GAP-ACTUARIAL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 111
* SOCK03.cbl
  6336           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6337     END-EVALUATE
  6338     IF WS-TOT-AH-RFND > ZEROS
  6339        IF (ws-comp-id = 'DCC')
  6340           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6341           compute ws-work-factor rounded =
  6342              ws-ah-rfnd-clp / cm-ah-clp
  6343        else
  6344           COMPUTE WS-WORK-FACTOR ROUNDED =
  6345              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6346        end-if
  6347        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6348           WS-TOT-AH-COMM
  6349     END-IF
  6350     IF ERACCT-FOUND
  6351        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6352           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6353        END-IF
  6354        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6355           IF (AM-COMM-CHARGEBACK (1) = 99)
  6356                     OR
  6357              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6358                     OR
  6359              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6360              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6361              MOVE ZEROS         TO WS-AH-UEC
  6362           END-IF
  6363        END-IF
  6364     END-IF
  6365     .
  6366 0500-EXIT.
  6367     EXIT.
  6368 0700-LINK-REM-TERM.
  6369
  6370* EXEC CICS LINK
  6371*        PROGRAM   ('ELRTRM')
  6372*        COMMAREA  (CALCULATION-PASS-AREA)
  6373*        LENGTH    (CP-COMM-LENGTH)
  6374*    END-EXEC.
  6375     MOVE 'ELRTRM' TO DFHEIV1
  6376*    MOVE '."C                   (   #00005916' TO DFHEIV0
  6377     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6379     MOVE X'2020233030303035393136' TO DFHEIV0(25:11)
  6380     CALL 'kxdfhei1' USING DFHEIV0,
  6381           DFHEIV1,
  6382           CALCULATION-PASS-AREA,
  6383           CP-COMM-LENGTH,
  6384           DFHEIV99,
  6385           DFHEIV99,
  6386           DFHEIV99,
  6387           DFHEIV99
  6388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6389
  6390 0700-EXIT.
  6391     EXIT.
  6392 0710-LINK-REM-AMOUNT.
  6393
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 112
* SOCK03.cbl
  6394* EXEC CICS LINK
  6395*        PROGRAM   ('ELRAMT')
  6396*        COMMAREA  (CALCULATION-PASS-AREA)
  6397*        LENGTH    (CP-COMM-LENGTH)
  6398*    END-EXEC
  6399     MOVE 'ELRAMT' TO DFHEIV1
  6400*    MOVE '."C                   (   #00005924' TO DFHEIV0
  6401     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6403     MOVE X'2020233030303035393234' TO DFHEIV0(25:11)
  6404     CALL 'kxdfhei1' USING DFHEIV0,
  6405           DFHEIV1,
  6406           CALCULATION-PASS-AREA,
  6407           CP-COMM-LENGTH,
  6408           DFHEIV99,
  6409           DFHEIV99,
  6410           DFHEIV99,
  6411           DFHEIV99
  6412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6413     .
  6414 0710-EXIT.
  6415     EXIT.
  6416 0720-LINK-REFUND.
  6417
  6418* EXEC CICS LINK
  6419*        PROGRAM   ('ELRFND')
  6420*        COMMAREA  (CALCULATION-PASS-AREA)
  6421*        LENGTH    (CP-COMM-LENGTH)
  6422*    END-EXEC
  6423     MOVE 'ELRFND' TO DFHEIV1
  6424*    MOVE '."C                   (   #00005933' TO DFHEIV0
  6425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6427     MOVE X'2020233030303035393333' TO DFHEIV0(25:11)
  6428     CALL 'kxdfhei1' USING DFHEIV0,
  6429           DFHEIV1,
  6430           CALCULATION-PASS-AREA,
  6431           CP-COMM-LENGTH,
  6432           DFHEIV99,
  6433           DFHEIV99,
  6434           DFHEIV99,
  6435           DFHEIV99
  6436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6437     .
  6438 0720-EXIT.
  6439     EXIT.
  6440 0730-GET-DDF-FACTORS.
  6441     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6442     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6443     MOVE CM-STATE               TO ERPDEF-STATE
  6444     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6445     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6446     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6447     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6448     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6449
  6450* EXEC CICS STARTBR
  6451*        DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 113
* SOCK03.cbl
  6452*        RIDFLD   (ERPDEF-KEY)
  6453*        GTEQ
  6454*        RESP     (WS-RESPONSE)
  6455*    END-EXEC
  6456     MOVE 'ERPDEF' TO DFHEIV1
  6457     MOVE 0
  6458       TO DFHEIV11
  6459*    MOVE '&,         G          &  N#00005950' TO DFHEIV0
  6460     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6461     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6462     MOVE X'204E233030303035393530' TO DFHEIV0(25:11)
  6463     CALL 'kxdfhei1' USING DFHEIV0,
  6464           DFHEIV1,
  6465           ERPDEF-KEY,
  6466           DFHEIV99,
  6467           DFHEIV11,
  6468           DFHEIV99
  6469     MOVE EIBRESP  TO WS-RESPONSE
  6470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6471     IF NOT RESP-NORMAL
  6472        GO TO 0730-EXIT
  6473     END-IF
  6474     .
  6475 0730-READNEXT.
  6476
  6477* EXEC CICS READNEXT
  6478*       DATASET  ('ERPDEF')
  6479*       INTO     (PRODUCT-MASTER)
  6480*       RIDFLD   (ERPDEF-KEY)
  6481*       RESP     (WS-RESPONSE)
  6482*    END-EXEC
  6483     MOVE LENGTH OF
  6484      PRODUCT-MASTER
  6485       TO DFHEIV12
  6486     MOVE 'ERPDEF' TO DFHEIV1
  6487     MOVE 0
  6488       TO DFHEIV11
  6489*    MOVE '&.IL                  )  N#00005961' TO DFHEIV0
  6490     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6491     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6492     MOVE X'204E233030303035393631' TO DFHEIV0(25:11)
  6493     CALL 'kxdfhei1' USING DFHEIV0,
  6494           DFHEIV1,
  6495           PRODUCT-MASTER,
  6496           DFHEIV12,
  6497           ERPDEF-KEY,
  6498           DFHEIV99,
  6499           DFHEIV11,
  6500           DFHEIV99,
  6501           DFHEIV99
  6502     MOVE EIBRESP  TO WS-RESPONSE
  6503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6504     IF NOT RESP-NORMAL
  6505        GO TO 0730-ENDBR
  6506     END-IF
  6507     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6508        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6509           MOVE 'Y'              TO WS-PDEF-RECORD-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 114
* SOCK03.cbl
  6510        ELSE
  6511           GO TO 0730-READNEXT
  6512        END-IF
  6513     ELSE
  6514        GO TO 0730-ENDBR
  6515     END-IF
  6516     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6517        (P1 > +8)
  6518        OR (PD-PROD-CODE (P1) = 'I')
  6519     END-PERFORM
  6520     IF P1 < +9
  6521        SET DD-IU-PRESENT        TO TRUE
  6522     END-IF
  6523     IF CM-LOAN-TERM = ZEROS
  6524        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  6525     END-IF
  6526     IF PD-TRUNCATED = 'Y'
  6527        MOVE CM-LOAN-TERM        TO WS-TERM
  6528     ELSE
  6529        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  6530     END-IF
  6531     EVALUATE TRUE
  6532        WHEN WS-TERM > +168
  6533           MOVE 15               TO P1
  6534        WHEN WS-TERM > +156
  6535           MOVE 14               TO P1
  6536        WHEN WS-TERM > +144
  6537           MOVE 13               TO P1
  6538        WHEN WS-TERM > +132
  6539           MOVE 12               TO P1
  6540        WHEN WS-TERM > +120
  6541           MOVE 11               TO P1
  6542        WHEN WS-TERM > +108
  6543           MOVE 10               TO P1
  6544        WHEN WS-TERM > +96
  6545           MOVE 9                TO P1
  6546        WHEN WS-TERM > +84
  6547           MOVE 8                TO P1
  6548        WHEN WS-TERM > +72
  6549           MOVE 7                TO P1
  6550        WHEN WS-TERM > +60
  6551           MOVE 6                TO P1
  6552        WHEN WS-TERM > +48
  6553           MOVE 5                TO P1
  6554        WHEN WS-TERM > +36
  6555           MOVE 4                TO P1
  6556        WHEN WS-TERM > +24
  6557           MOVE 3                TO P1
  6558        WHEN WS-TERM > +12
  6559           MOVE 2                TO P1
  6560        WHEN OTHER
  6561           MOVE 1                TO P1
  6562     END-EVALUATE
  6563     EVALUATE TRUE
  6564*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  6565*          AND (DD-IU-PRESENT)
  6566*          MOVE 2                TO P2
  6567*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 115
* SOCK03.cbl
  6568*          MOVE 1                TO P2
  6569        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  6570           MOVE 2                TO P2
  6571        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  6572           MOVE 3                TO P2
  6573        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  6574           MOVE 4                TO P2
  6575        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  6576           MOVE 5                TO P2
  6577        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  6578           MOVE 6                TO P2
  6579        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  6580           MOVE 7                TO P2
  6581        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  6582           MOVE 8                TO P2
  6583        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  6584           MOVE 9                TO P2
  6585        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  6586           MOVE 10               TO P2
  6587        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  6588           MOVE 11               TO P2
  6589        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  6590           MOVE 12               TO P2
  6591        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  6592           MOVE 13               TO P2
  6593        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  6594           MOVE 14               TO P2
  6595        WHEN OTHER
  6596           MOVE 15               TO P2
  6597     END-EVALUATE
  6598     .
  6599 0730-ENDBR.
  6600
  6601* EXEC CICS ENDBR
  6602*       DATASET  ('ERPDEF')
  6603*    END-EXEC
  6604     MOVE 'ERPDEF' TO DFHEIV1
  6605     MOVE 0
  6606       TO DFHEIV11
  6607*    MOVE '&2                    $   #00006063' TO DFHEIV0
  6608     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6609     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6610     MOVE X'2020233030303036303633' TO DFHEIV0(25:11)
  6611     CALL 'kxdfhei1' USING DFHEIV0,
  6612           DFHEIV1,
  6613           DFHEIV11,
  6614           DFHEIV99
  6615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6616     .
  6617 0730-EXIT.
  6618     EXIT.
  6619 0740-GET-ERCTBL.
  6620     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6621     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6622     MOVE 'A'                    TO CTBL-BEN-TYPE
  6623     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  6624     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6625     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 116
* SOCK03.cbl
  6626     IF RESP-NORMAL
  6627        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6628     ELSE
  6629        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6630        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6631        MOVE 'A'                    TO CTBL-BEN-TYPE
  6632        MOVE 'AA'                   TO CTBL-BEN-CODE
  6633        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6634        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6635        IF RESP-NORMAL
  6636           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6637        END-IF
  6638     END-IF
  6639     .
  6640 0740-EXIT.
  6641     EXIT.
  6642 0750-READ-ERCTBL.
  6643
  6644* EXEC CICS READ
  6645*         INTO    (COMM-TABLE-RECORD)
  6646*         DATASET ('ERCTBL')
  6647*         RIDFLD  (CTBL-KEY)
  6648*         RESP    (WS-RESPONSE)
  6649*    END-EXEC
  6650     MOVE LENGTH OF
  6651      COMM-TABLE-RECORD
  6652       TO DFHEIV11
  6653     MOVE 'ERCTBL' TO DFHEIV1
  6654*    MOVE '&"IL       E          (  N#00006093' TO DFHEIV0
  6655     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6657     MOVE X'204E233030303036303933' TO DFHEIV0(25:11)
  6658     CALL 'kxdfhei1' USING DFHEIV0,
  6659           DFHEIV1,
  6660           COMM-TABLE-RECORD,
  6661           DFHEIV11,
  6662           CTBL-KEY,
  6663           DFHEIV99,
  6664           DFHEIV99,
  6665           DFHEIV99
  6666     MOVE EIBRESP  TO WS-RESPONSE
  6667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6668     .
  6669 0750-EXIT.
  6670     EXIT.
  6671 0760-FIND-COMM.
  6672     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  6673        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  6674        OR (C1 > +3)
  6675     END-PERFORM
  6676     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  6677        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  6678        OR (C2 > +3)
  6679     END-PERFORM
  6680     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  6681        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  6682        OR (C3 > +3)
  6683     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 117
* SOCK03.cbl
  6684     IF C1 > +3
  6685        MOVE +1                  TO C1
  6686     END-IF
  6687     IF C2 > +3
  6688        MOVE +1                  TO C2
  6689     END-IF
  6690     IF C3 > +3
  6691        MOVE +1                  TO C3
  6692     END-IF
  6693     IF C1 = +3
  6694        MOVE +18                 TO C0
  6695     ELSE
  6696        IF C1 = +2
  6697           MOVE +9               TO C0
  6698        END-IF
  6699     END-IF
  6700     IF C2 = +3
  6701        ADD +6                   TO C0
  6702     ELSE
  6703        IF C2 = +2
  6704           ADD +3                TO C0
  6705        END-IF
  6706     END-IF
  6707     ADD C3                      TO C0
  6708     MOVE CT-RT (C0)             TO WS-COMM-PCT
  6709     .
  6710 0760-EXIT.
  6711     EXIT.
  6712 9700-DATE-LINK.
  6713
  6714* EXEC CICS LINK
  6715*         PROGRAM  ('ELDATCV')
  6716*         COMMAREA (DATE-CONVERSION-DATA)
  6717*         LENGTH   (DC-COMM-LENGTH)
  6718*    END-EXEC.
  6719     MOVE 'ELDATCV' TO DFHEIV1
  6720*    MOVE '."C                   (   #00006144' TO DFHEIV0
  6721     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6722     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6723     MOVE X'2020233030303036313434' TO DFHEIV0(25:11)
  6724     CALL 'kxdfhei1' USING DFHEIV0,
  6725           DFHEIV1,
  6726           DATE-CONVERSION-DATA,
  6727           DC-COMM-LENGTH,
  6728           DFHEIV99,
  6729           DFHEIV99,
  6730           DFHEIV99,
  6731           DFHEIV99
  6732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6733
  6734 9700-EXIT.
  6735      EXIT.
  6736
  6737 9999-DFHBACK SECTION.
  6738     MOVE '9%                    "   ' TO DFHEIV0
  6739     MOVE 'SOCK03' TO DFHEIV1
  6740     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6741     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:18 Page 118
* SOCK03.cbl
  6742 9999-DFHEXIT.
  6743     IF DFHEIGDJ EQUAL 0001
  6744         NEXT SENTENCE.
  6745     MOVE '9%                    "   ' TO DFHEIV0
  6746     MOVE 'SOCK03' TO DFHEIV1
  6747     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6748     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       18408     Code:       28421
