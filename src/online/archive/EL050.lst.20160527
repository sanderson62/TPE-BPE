* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page   3
* EL050.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    66
    67 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    68 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    69                                   USAGE POINTER.
    70 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    73                                   USAGE IS POINTER.
    74 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    75 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    76                                   USAGE IS POINTER.
    77 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    79                                   USAGE IS POINTER.
    80
    81 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    82 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    83                                   USAGE IS POINTER.
    84
    85*    COPY ELC50WS.
    86*****************************************************************
    87*                                                               *
    88*                            ELC50WS.                           *
    89*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    90*                            VMOD=2.061.                        *
    91*                                                               *
    92*   THIS IS THE WORKING STORAGE FOR EL050                       *
    93*                                   EL517                       *
    94*****************************************************************
    95******************************************************************
    96*                   C H A N G E   L O G
    97*
    98* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    99*-----------------------------------------------------------------
   100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   101* EFFECTIVE    NUMBER
   102*-----------------------------------------------------------------
   103* 123102                   PEMA  ADD DCC PROCESSING
   104* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   105* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   106* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   108* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   109* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   110* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   111* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   112* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   113* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   114* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   115* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   116* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   117* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page   4
* EL050.cbl
   118* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   119* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   120* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   121* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   122* 030309  CR2009021700001  PEMA  ADD ER-2883
   123* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   124* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   125* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   126* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   127* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   128* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   129* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   130* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   131* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   132* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   133* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   134* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   135* 061412  CR2011022800001  AJRA  NAPERSOFT
   136* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   137* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   138* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   139* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   140* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   141* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   142* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   143* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   144* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   145* 091114  IR2014091000001  TANA  ADD ERROR 2898
   146* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   147* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   148*-----------------------------------------------------------------
   149
   150 01  WORK-AREAS.
   151
   152*****************************************************************
   153*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   154*****************************************************************
   155
   156     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   157     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   158     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   159     12  WS-NAME-EDIT-WORK-AREA.
   160         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   161         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   162             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   163         16  WS-WORK-NAME.
   164             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   165             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   166             20  FILLER           PIC X(10)     VALUE SPACES.
   167         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   168             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   169
   170*****************************************************************
   171*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   172*****************************************************************
   173
   174     12  WS-ERRESC-KEY.
   175         16 WS-ERRESC-SEARCH-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page   5
* EL050.cbl
   176             20  WS-ERRESC-COMPANY-CD PIC  X.
   177             20  WS-ERRESC-CARRIER    PIC  X.
   178             20  WS-ERRESC-GROUP      PIC X(6).
   179             20  WS-ERRESC-STATE      PIC XX.
   180             20  WS-ERRESC-ACCOUNT    PIC X(10).
   181         16 WS-ERRESC-RESIDUAL-KEY.
   182             20  WS-ERRESC-AGENT      PIC X(10).
   183             20  WS-ERRESC-RES-STATE  PIC XX.
   184             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   185*                                          YYYYMMDD
   186     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   187     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   188
   189*RESIDENT STATE TAX MASTER(ERRESS)
   190*
   191     12  WS-ERRESS-KEY.
   192         16  WS-ERRESS-COMPANY-CD      PIC  X.
   193         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   194         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   195         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   196*                                          YYYYMMDD
   197
   198     12  WS-CONTRACT-DATE              PIC 9(8).
   199*                                          YYYYMMDD
   200     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   201     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   202         16 WS-YEAR-YY                 PIC   9999.
   203         16 FILLER                     PIC 9(4).
   204*                                          YYYYMMDD
   205     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   206     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   207     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   208     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   209
   210     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   211         88  DPRB-1ST-TIME                      VALUE ' '.
   212
   213*****************************************************************
   214*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   215*****************************************************************
   216
   217     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   218     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   219     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   220     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   221     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   222     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   223     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   224     12  ws-st-agent-sig-edit    pic x          value spaces.
   225     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   226     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   227     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   228     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   229         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   230         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   231     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   232         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   233         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page   6
* EL050.cbl
   234     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   235
   236     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   237     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   238
   239     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   240     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   253     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   254     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   275     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   276     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   277     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   278     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   287     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   288     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   289     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   290     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   291     12  WS-2671-SW               PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page   7
* EL050.cbl
   292     12  WS-2672-SW               PIC X         VALUE SPACE.
   293     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   294         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   295     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   296         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   297     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   298
   299     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   300         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   301         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   302         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   303         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   304
   305     12  WS-CREDIT-EDIT-CONTROLS.
   306         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   307         16  WS-MIN-AGE           PIC 99                VALUE  0.
   308         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   309         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   310         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   311         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   312
   313     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   314     12  WS-AGE-FIELDS.
   315         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   316         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   317         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   318         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   319
   320     12  WS-SAVE-ALLOWABLE-BENEFIT.
   321         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   322         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   323         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   324         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   325         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   326         16  FILLER                      PIC XX.
   327
   328     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   329     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   330     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   331     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   332     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   333     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   334     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   335     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   336     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   337     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   338
   339     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   340     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   341     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   342     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   343     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   344     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   345     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   346     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   347         88  WS-REDUCING              VALUE 'R'.
   348         88  WS-LEVEL                 VALUE 'L' 'P'.
   349     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page   8
* EL050.cbl
   350
   351     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   352     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   353     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   354     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   355     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   356     12  ws-ah-max-bens           pic 99        value zeros.
   357     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   358     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   359     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   360     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   361
   362     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   364     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   365     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   366     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   367     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   368     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   369     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   370     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   371     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   372     12  WS-ACCT-SIG-SW.
   373         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   374         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   375     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   376     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   377     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   379     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   382     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  WS-INITIALS.
   385         16  WS-INIT-1            PIC X         VALUE SPACES.
   386         16  WS-INIT-2            PIC X         VALUE SPACES.
   387
   388     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   389     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   390     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   391     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   392     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   393*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   394     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   397     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   398     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   399     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   401     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   402     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   404     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   405     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   406     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   407     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page   9
* EL050.cbl
   408     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   409     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   413     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   414     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416******** FLA
   417     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   418     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   419     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   420     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   421     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   422********
   423     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   424     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   425     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   426     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   427     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   428     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   429     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   430     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   431     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   432     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   433
   434     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   435         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   436                                         '0' THRU '9'.
   437
   438     12  NUMBER-OF-MONTHS.
   439         16  SK-MO OCCURS 12 TIMES PIC X.
   440
   441     12  WS-WORK-DATE.
   442         16  WS-YEAR            PIC 99    VALUE 00.
   443         16  WS-MONTH           PIC 99    VALUE 00.
   444         16  WS-DAY             PIC 99    VALUE 00.
   445
   446     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   447     12  WS-WORK-CRIT-DEV       REDEFINES
   448         WS-WORK-LF-CRIT-PER    PIC X(03).
   449
   450     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   451     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   452
   453     12  WS-WORK-DATE-FROM.
   454         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   455         16  FILLER             PIC X  VALUE SPACE.
   456         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   457         16  FILLER             PIC X         VALUE SPACE.
   458         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   459
   460     12  WS-WORK-DATE-THRU.
   461         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   462         16  FILLER             PIC X         VALUE SPACE.
   463         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   464         16  FILLER             PIC X         VALUE SPACE.
   465         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  10
* EL050.cbl
   466
   467     12  WS-LF-INPUT-CD.
   468         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   469         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   470
   471     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   472     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   473         16  WS-AH-INPUT-CD-1   PIC X.
   474         16  WS-AH-INPUT-CD-2-3 PIC XX.
   475
   476     12  WS-SWITCHES.
   477         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   478         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   479             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   480         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   481             88  BANK-ACCT-FOUND          VALUE 'Y'.
   482         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   483             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   484         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   485             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   486         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   487             88  COMP-MASTER-FOUND        VALUE 'Y'.
   488         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   489             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   490         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   491             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   492         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   493             88  STAT-MASTER-FOUND        VALUE 'Y'.
   494         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   495             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   496         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   497             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   498         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   499             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   500         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   501             88  FORM-MASTER-FOUND        VALUE 'Y'.
   502         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   503             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   504         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   505             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   506         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   507             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   508         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   509             88  NO-BENEFIT-FOUND         VALUE 'N'.
   510         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   511             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   512         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   513             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   514         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   515             88  AH-BENEFIT-FOUND         VALUE ' '.
   516             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   517         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   518             88  LF-BENEFIT-FOUND         VALUE ' '.
   519             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   520         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   521             88  NO-STATE-RECORD          VALUE '1'.
   522         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   523             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  11
* EL050.cbl
   524         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   525             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   526         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   527             88  CERT-WAS-FOUND           VALUE ' '.
   528             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   529         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   530             88  BROWSE-STARTED           VALUE 'Y'.
   531         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   532             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   533         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   534             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   535         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   536             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   537         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   538             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   539         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   540             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   541         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   542             88  APP-CERT-USED            VALUE 'Y' 'A'.
   543         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   544             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   545             88  FIRST-TIME-THROUGH       VALUE '1'.
   546             88  CTBL-NOT-FOUND           VALUE '2'.
   547
   548         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   549             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   550
   551         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   552             88  DLO-ERROR-FOUND          VALUE 'Y'.
   553
   554********FLA
   555     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   556     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   557********
   558     12  RC-SW-1                  PIC X           VALUE '0'.
   559     12  RC-SW-2                  PIC X           VALUE '0'.
   560     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   561     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   562     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   566     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   567     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   570     12  LIT-SPACES               PIC X           VALUE SPACES.
   571     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   572     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   573     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   574     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   575     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   576     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   577     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   578         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   579         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   580     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   581         88  SKIP-ADDR-EDIT         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  12
* EL050.cbl
   582
   583 01  WS-EXTRA-PERIODS-BY-STATE.
   584     12  WS-INT-PERIODS          PIC 9.
   585     12  WS-EXTRA-PMTS           PIC 9.
   586 01  ws-net-only-state           pic x value 'N'.
   587 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   588     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   589     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   590 01  WS-CRI-SSN-WORK-AREA.
   591     05  WS-CRI-SOC-SEC-NO.
   592         10  WS-SS-REPT-CD       PIC X(5).
   593         10  WS-SS-LAST-NAME     PIC X(5).
   594         10  WS-SS-INITIAL       PIC X.
   595
   596     05  WS-CRI-REPORT-CODE.
   597         10  FILLER              PIC X(5).
   598         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   599
   600     05  WS-CRI-LAST-NAME.
   601         10  WS-CRI-NAME-MOVE    PIC X(5).
   602         10  FILLER              PIC X(10).
   603
   604 01  WS-NUM-TABLE                PIC X(26)  VALUE
   605     '12345678012345070923456789'.
   606 01  FILLER REDEFINES WS-NUM-TABLE.
   607     05  WS-NUM OCCURS 26        PIC 9.
   608 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   609 01  V1                          PIC S999 COMP-3.
   610 01  V2                          PIC S999 COMP-3.
   611 01  V3                          PIC S999 COMP-3.
   612 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   613 01  FILLER REDEFINES WS-WORK-VIN.
   614     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   615 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   616 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   617 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   618 01  WS-HEX-WORK.
   619     05  FILLER                  PIC X  VALUE LOW-VALUES.
   620     05  WS-HEX-BYTE             PIC X.
   621 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   622 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   623 01  WS-WORK-HIN-ROW-B.
   624     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   625
   626 01  ws-benefit-cd-chg-sw      pic x value spaces.
   627     88  benefit-code-chg           value 'Y'.
   628 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   629 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   630     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   631 01  WS-ROW-D-TABLE.
   632     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   633
   634 01  WS-HIN-TABLE-B.
   635     05  F                       PIC XX VALUE 'A2'.
   636     05  F                       PIC XX VALUE 'B3'.
   637     05  F                       PIC XX VALUE 'C4'.
   638     05  F                       PIC XX VALUE 'D5'.
   639     05  F                       PIC XX VALUE 'E6'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  13
* EL050.cbl
   640     05  F                       PIC XX VALUE 'F7'.
   641     05  F                       PIC XX VALUE 'G8'.
   642     05  F                       PIC XX VALUE 'H9'.
   643     05  F                       PIC XX VALUE 'I1'.
   644     05  F                       PIC XX VALUE 'J2'.
   645     05  F                       PIC XX VALUE 'K3'.
   646     05  F                       PIC XX VALUE 'L4'.
   647     05  F                       PIC XX VALUE 'M5'.
   648     05  F                       PIC XX VALUE 'N6'.
   649     05  F                       PIC XX VALUE 'O0'.
   650     05  F                       PIC XX VALUE 'P7'.
   651     05  F                       PIC XX VALUE 'Q0'.
   652     05  F                       PIC XX VALUE 'R8'.
   653     05  F                       PIC XX VALUE 'S9'.
   654     05  F                       PIC XX VALUE 'T2'.
   655     05  F                       PIC XX VALUE 'U3'.
   656     05  F                       PIC XX VALUE 'V4'.
   657     05  F                       PIC XX VALUE 'W5'.
   658     05  F                       PIC XX VALUE 'X6'.
   659     05  F                       PIC XX VALUE 'Y7'.
   660     05  F                       PIC XX VALUE 'Z8'.
   661 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   662     05  WS-VAL-IN               PIC X.
   663     05  WS-VAL-OUT              PIC 9.
   664 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   665 01  WS-COMPARE-BINARY-DATES.
   666     05  WS-971231                PIC XX VALUE X'92FF'.
   667     05  WS-931231                PIC XX VALUE X'8CFF'.
   668     05  WS-791231                PIC XX VALUE X'77FF'.
   669     05  WS-771001                PIC XX VALUE X'74A1'.
   670     05  WS-820301                PIC XX VALUE X'7B41'.
   671     05  WS-831031                PIC XX VALUE X'7DBF'.
   672     05  WS-831231                PIC XX VALUE X'7DFF'.
   673     05  WS-810831                PIC XX VALUE X'7A7F'.
   674     05  WS-830901                PIC XX VALUE X'7D81'.
   675
   676 01  FILE-ACCESS-IDS.
   677     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   678     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   679     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   680     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   681     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   682     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   683     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   684     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   685     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   686     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   687     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   688     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   689     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   690     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   691     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   692     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   693     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   694 01  DD-IU-SW                    PIC X   VALUE ' '.
   695     88  DD-IU-PRESENT                 VALUE 'Y'.
   696
   697 01  ACCESS-KEYS.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  14
* EL050.cbl
   698     12  ELMSTR-KEY.
   699         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   701     12  W-CLAIM-KEY.
   702         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   704
   705     12  ELCNTL-KEY.
   706         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   707         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   708         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   709         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   710
   711     12  ELCERT-KEY.
   712         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   713         16  CERT-CARRIER         PIC X       VALUE SPACE.
   714         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   715         16  CERT-STATE           PIC XX      VALUE SPACES.
   716         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   717         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   718         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   719
   720     12  ELCERT2-KEY.
   721         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   722         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   723
   724     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   725
   726     12  ELCERT-SAVE.
   727         16  FILLER                      PIC XX    VALUE SPACES.
   728
   729         16  WCS-CONTROL-PRIMARY.
   730             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   731             20  WCS-CARRIER             PIC X     VALUE SPACE.
   732             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   733             20  WCS-STATE               PIC XX    VALUE SPACES.
   734             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   735             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   736             20  WCS-CERT-NO.
   737                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   738                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   739
   740         16  CS-CONTROL-BY-NAME.
   741             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   742             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   743             20  CS-INSURED-INITIALS.
   744                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   745                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   746
   747         16  CS-CONTROL-BY-SSN.
   748             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   749             20  CS-SOC-SEC-NO.
   750                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   751                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   752                 24  CS-SSN-LN3.
   753                     28 CS-INSURED-INITIALS-A2   PIC XX
   754                                     VALUE SPACES.
   755                     28 CS-PART-LAST-NAME-A2     PIC X
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  15
* EL050.cbl
   756                                     VALUE SPACE.
   757
   758         16  CS-CONTROL-BY-CERT-NO.
   759             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   760             20  CS-CERT-NO-A4           PIC X(11)
   761                                     VALUE SPACES.
   762
   763         16  CS-CONTROL-BY-MEMB.
   764             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   765             20  CS-MEMBER-NO.
   766                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   767                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   768                 24  CS-MEMB-LN4.
   769                     28 CS-INSURED-INITIALS-A5   PIC XX
   770                                      VALUE SPACES.
   771                     28 CS-PART-LAST-NAME-A5     PIC XX
   772                                      VALUE SPACES.
   773
   774         16  FILLER              PIC X(360) VALUE SPACES.
   775
   776     12  ERACCT-KEY.
   777         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   778         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   779         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   780         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   781         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   782         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   783
   784     12  ERCOMP-KEY.
   785         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   786         16  COMP-CARRIER         PIC X     VALUE SPACES.
   787         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   788         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   789         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   790         16  COMP-TYPE            PIC X     VALUE SPACES.
   791
   792     12  ERLOFC-KEY.
   793         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   794         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   795         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   796         16  LOFC-STATE           PIC XX    VALUE SPACES.
   797         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   798         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   799
   800     12  WS-ELCRTT-KEY.
   801         16  WS-ELCRTT-PRIMARY       PIC X(33).
   802         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   803
   804     12  ERBXRF-KEY.
   805         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   807         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   808         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   809
   810     12  ERAGTC-KEY.
   811         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   812         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   813         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  16
* EL050.cbl
   814         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   815         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   816         16  AGTC-TYPE            PIC X     VALUE SPACES.
   817
   818     12  ERPLAN-KEY.
   819         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   821         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   822         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   823         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   824         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   825         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   826         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   827
   828     12  ERFORM-KEY.
   829         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   830         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   831         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   832         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   833
   834     12  ERREIN-KEY.
   835         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   836         16  REIN-TYPE            PIC X     VALUE SPACES.
   837         16  REIN-TABLE-CO.
   838             20  REIN-CODE-1      PIC X     VALUE SPACE.
   839             20  REIN-CODE-2      PIC X     VALUE SPACE.
   840             20  REIN-CODE-3      PIC X     VALUE SPACE.
   841         16  FILLER               PIC X(3)  VALUE SPACES.
   842
   843     12  ERCTBL-KEY.
   844         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   845         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   846         16  CTBL-CNTRL-2.
   847             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   848             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   849
   850     12  ELCRTO-KEY.
   851         16  ELCRTO-COMPANY-CD       PIC X.
   852         16  ELCRTO-CARRIER          PIC X.
   853         16  ELCRTO-GROUPING         PIC X(6).
   854         16  ELCRTO-STATE            PIC XX.
   855         16  ELCRTO-ACCOUNT          PIC X(10).
   856         16  ELCRTO-CERT-EFF-DT      PIC XX.
   857         16  ELCRTO-CERT-NO.
   858             20  ELCRTO-CERT-PRIME   PIC X(10).
   859             20  ELCRTO-CERT-SFX     PIC X.
   860         16  ELCRTO-RECORD-TYPE      PIC X.
   861         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   862
   863
   864     12  WS-ACCESS.
   865         16  FILLER               PIC XX    VALUE SPACES.
   866         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   867
   868     12  WS-CARR-ACCESS.
   869         16  FILLER               PIC X(3)  VALUE SPACES.
   870         16  WS-CARR              PIC X     VALUE SPACE.
   871*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  17
* EL050.cbl
   872*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   873     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   874         88  WS-DMD-LF-RATING   VALUE 'Y'.
   875         88  WS-DMD-AH-RATING   VALUE 'Y'.
   876         88  WS-DMD-NO-RATING   VALUE 'N'.
   877
   878     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   879         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   880                                         'NJ' 'NL'
   881                                         'PJ' 'PL'
   882                                         'SJ' 'SL'.
   883     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   884         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   885                                         'NI' 'NJ' 'NL' 'NU'
   886                                         'PJ' 'PL' 'PI' 'PU'
   887                                         'SI' 'SJ' 'SL' 'SU'
   888                                         'MX' 'MY' 'MZ'.
   889 01  ERPDEF-KEY-SAVE             PIC X(18).
   890 01  ERPDEF-KEY.
   891     12  ERPDEF-COMPANY-CD       PIC X.
   892     12  ERPDEF-STATE            PIC XX.
   893     12  ERPDEF-PROD-CD          PIC XXX.
   894     12  F                       PIC X(7).
   895     12  ERPDEF-BEN-TYPE         PIC X.
   896     12  ERPDEF-BEN-CODE         PIC XX.
   897     12  ERPDEF-EXP-DT           PIC XX.
   898
   899 01  ELSTAT-KEY-SAVE             PIC X(20).
   900 01  ELSTAT-KEY.
   901     12  ELSTAT-COMPANY-ID       PIC XXX.
   902     12  ELSTAT-CARRIER          PIC X.
   903     12  ELSTAT-GROUP            PIC X(6).
   904     12  ELSTAT-STATE            PIC XX.
   905     12  ELSTAT-EXP-DT           PIC 9(8).
   906 01  WS-ERROR-VALUES.
   907     12  ER-1570                     PIC S9(4)   VALUE +1570.
   908     12  ER-1571                     PIC S9(4)   VALUE +1571.
   909     12  er-1572                     pic s9(4)   value +1572.
   910     12  er-1573                     pic s9(4)   value +1573.
   911     12  er-1574                     pic s9(4)   value +1574.
   912     12  ER-1575                     PIC S9(4)   VALUE +1575.
   913     12  er-1576                     pic s9(4)   value +1576.
   914     12  er-1583                     pic s9(4)   value +1583.
   915     12  er-1743                     pic s9(4)   value +1743.
   916     12  er-1744                     pic s9(4)   value +1744.
   917     12  er-1745                     pic s9(4)   value +1745.
   918     12  er-1746                     pic s9(4)   value +1746.
   919     12  er-1747                     pic s9(4)   value +1747.
   920     12  er-1748                     pic s9(4)   value +1748.
   921     12  ER-1891                     PIC S9(4)   VALUE +1891.
   922     12  ER-1892                     PIC S9(4)   VALUE +1892.
   923     12  ER-1893                     PIC S9(4)   VALUE +1893.
   924     12  ER-1894                     PIC S9(4)   VALUE +1894.
   925     12  ER-1895                     PIC S9(4)   VALUE +1895.
   926     12  ER-1896                     PIC S9(4)   VALUE +1896.
   927     12  ER-1897                     PIC S9(4)   VALUE +1897.
   928     12  ER-1898                     PIC S9(4)   VALUE +1898.
   929     12  ER-1899                     PIC S9(4)   VALUE +1899.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  18
* EL050.cbl
   930     12  ER-1900                     PIC S9(4)   VALUE +1900.
   931     12  ER-1901                     PIC S9(4)   VALUE +1901.
   932     12  ER-1902                     PIC S9(4)   VALUE +1902.
   933     12  ER-1903                     PIC S9(4)   VALUE +1903.
   934     12  ER-1904                     PIC S9(4)   VALUE +1904.
   935     12  ER-1905                     PIC S9(4)   VALUE +1905.
   936     12  ER-1906                     PIC S9(4)   VALUE +1906.
   937     12  ER-1907                     PIC S9(4)   VALUE +1907.
   938     12  ER-1909                     PIC S9(4)   VALUE +1909.
   939     12  ER-1910                     PIC S9(4)   VALUE +1910.
   940     12  ER-1911                     PIC S9(4)   VALUE +1911.
   941     12  ER-1912                     PIC S9(4)   VALUE +1912.
   942     12  ER-1913                     PIC S9(4)   VALUE +1913.
   943     12  ER-1914                     PIC S9(4)   VALUE +1914.
   944     12  ER-1915                     PIC S9(4)   VALUE +1915.
   945     12  ER-1916                     PIC S9(4)   VALUE +1916.
   946     12  ER-1917                     PIC S9(4)   VALUE +1917.
   947     12  ER-1918                     PIC S9(4)   VALUE +1918.
   948     12  ER-1919                     PIC S9(4)   VALUE +1919.
   949     12  ER-1920                     PIC S9(4)   VALUE +1920.
   950     12  ER-1921                     PIC S9(4)   VALUE +1921.
   951     12  ER-1922                     PIC S9(4)   VALUE +1922.
   952     12  ER-1923                     PIC S9(4)   VALUE +1923.
   953     12  ER-1924                     PIC S9(4)   VALUE +1924.
   954     12  ER-1925                     PIC S9(4)   VALUE +1925.
   955     12  ER-1926                     PIC S9(4)   VALUE +1926.
   956     12  ER-1927                     PIC S9(4)   VALUE +1927.
   957     12  ER-2393                     PIC S9(4)   VALUE +2393.
   958     12  ER-2600                     PIC S9(4)   VALUE +2600.
   959     12  ER-2601                     PIC S9(4)   VALUE +2601.
   960     12  ER-2602                     PIC S9(4)   VALUE +2602.
   961     12  ER-2603                     PIC S9(4)   VALUE +2603.
   962     12  ER-2604                     PIC S9(4)   VALUE +2604.
   963     12  ER-2605                     PIC S9(4)   VALUE +2605.
   964     12  ER-2606                     PIC S9(4)   VALUE +2606.
   965     12  ER-2607                     PIC S9(4)   VALUE +2607.
   966     12  ER-2608                     PIC S9(4)   VALUE +2608.
   967     12  ER-2609                     PIC S9(4)   VALUE +2609.
   968     12  ER-2610                     PIC S9(4)   VALUE +2610.
   969     12  ER-2611                     PIC S9(4)   VALUE +2611.
   970     12  ER-2612                     PIC S9(4)   VALUE +2612.
   971     12  ER-2613                     PIC S9(4)   VALUE +2613.
   972     12  ER-2614                     PIC S9(4)   VALUE +2614.
   973     12  ER-2615                     PIC S9(4)   VALUE +2615.
   974     12  ER-2616                     PIC S9(4)   VALUE +2616.
   975     12  ER-2617                     PIC S9(4)   VALUE +2617.
   976     12  ER-2618                     PIC S9(4)   VALUE +2618.
   977     12  ER-2619                     PIC S9(4)   VALUE +2619.
   978     12  ER-2620                     PIC S9(4)   VALUE +2620.
   979     12  ER-2621                     PIC S9(4)   VALUE +2621.
   980     12  ER-2622                     PIC S9(4)   VALUE +2622.
   981     12  ER-2623                     PIC S9(4)   VALUE +2623.
   982     12  ER-2624                     PIC S9(4)   VALUE +2624.
   983     12  ER-2625                     PIC S9(4)   VALUE +2625.
   984     12  ER-2626                     PIC S9(4)   VALUE +2626.
   985     12  ER-2627                     PIC S9(4)   VALUE +2627.
   986     12  ER-2628                     PIC S9(4)   VALUE +2628.
   987     12  ER-2629                     PIC S9(4)   VALUE +2629.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  19
* EL050.cbl
   988     12  ER-2630                     PIC S9(4)   VALUE +2630.
   989     12  ER-2631                     PIC S9(4)   VALUE +2631.
   990     12  ER-2632                     PIC S9(4)   VALUE +2632.
   991     12  ER-2633                     PIC S9(4)   VALUE +2633.
   992     12  ER-2634                     PIC S9(4)   VALUE +2634.
   993     12  ER-2635                     PIC S9(4)   VALUE +2635.
   994     12  ER-2636                     PIC S9(4)   VALUE +2636.
   995     12  ER-2637                     PIC S9(4)   VALUE +2637.
   996     12  ER-2638                     PIC S9(4)   VALUE +2638.
   997     12  ER-2639                     PIC S9(4)   VALUE +2639.
   998     12  ER-2640                     PIC S9(4)   VALUE +2640.
   999     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1000     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1001     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1002     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1003     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1004     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1005     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1006     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1007     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1008     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1009     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1010     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1011     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1012     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1013     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1014     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1015     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1016     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1017     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1018     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1019     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1020     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1021     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1022     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1023     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1024     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1025     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1026     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1027     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1028     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1029     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1030     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1031     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1032     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1033     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1034     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1035     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1036     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1037     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1038     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1039     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1040     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1041     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1042     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1043     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1044     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1045     12  ER-2687                     PIC S9(4)   VALUE +2687.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  20
* EL050.cbl
  1046     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1047     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1048     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1049     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1050     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1051     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1052     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1053     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1054     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1055     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1056     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1057     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1058     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1059     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1060     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1061     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1062     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1063     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1064     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1065     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1066     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1067     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1068     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1069     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1070     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1071     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1072     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1073     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1074     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1075     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1076     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1077     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1078     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1079     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1080     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1081     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1082     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1083     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1084     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1085     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1086     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1087     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1088     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1089     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1090     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1091     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1092     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1093     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1094     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1095     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1096     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1097     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1098     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1099     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1100     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1101     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1102     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1103     12  ER-2755                     PIC S9(4)   VALUE +2755.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  21
* EL050.cbl
  1104     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1105     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1106     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1107     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1108     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1109     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1110     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1111     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1112     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1113     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1114     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1115     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1116     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1117     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1118     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1119     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1120     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1121     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1122     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1123     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1124     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1125     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1126     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1127     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1128     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1129     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1130     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1131     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1132     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1133     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1134     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1135     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1136     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1137     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1138     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1139     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1140     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1141     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1142     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1143     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1144     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1145     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1146     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1147     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1148     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1149     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1150     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1151     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1152     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1153     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1154     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1155     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1156     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1157     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1158     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1159     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1160     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1161     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  22
* EL050.cbl
  1162     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1163     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1164     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1165     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1166     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1167     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1168     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1169     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1170     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1171     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1172     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1173     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1174     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1175     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1176     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1177     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1178     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1179     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1180     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1181     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1182     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1183     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1184     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1185     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1186     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1187     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1188     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1189     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1190     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1191     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1192     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1193     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1194     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1195     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1196     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1197     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1198     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1199     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1200     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1201     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1202     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1203     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1204     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1205     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1206     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1207     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1208     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1209     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1210     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1211     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1212     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1213     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1214     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1215     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1216     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1217     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1218     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1219     12  ER-8082                     PIC S9(4)   VALUE +8082.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  23
* EL050.cbl
  1220     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1221     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1222     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1223     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1224     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1225     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1226     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1227     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1228     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1229     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1230     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1231     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1232     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1233     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1234     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1235     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1236     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1237     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1238     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1239     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1240     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1241     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1242     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1243     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1244     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1245     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1246     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1247     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1248     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1249     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1250     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1251     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1252     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1253     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1254     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1255     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1256     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1257     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1258     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1259     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1260     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1261     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1262     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1263     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1264     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1265******************************************************************
  1266***************   END OF ELC50WS     ****************************
  1267******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  24
* EL050.cbl
  1270 01  WORKING-STORAGE-WORK-AREAS.
  1271     12  WS-RESPONSE             PIC S9(8)  COMP.
  1272         88  WS-RESP-NORMAL           VALUE +00.
  1273         88  WS-RESP-ERROR            VALUE +01.
  1274         88  WS-RESP-NOTFND           VALUE +13.
  1275         88  WS-RESP-DUPREC           VALUE +14.
  1276         88  WS-RESP-ENDFILE          VALUE +20.
  1277     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1278     12  WORK-AREAS.
  1279         16  WK-CONV-GREG.
  1280             24  WCG-CENT             PIC XX.
  1281             24  WCG-REST             PIC X(4).
  1282         16  WORK-GREGORIAN-DATE.
  1283             24  WK-GREG-CENT         PIC XX.
  1284             24  WK-GREG-DATE-YYMMDD.
  1285                 28  WK-GREG-YYMM     PIC X(4).
  1286                 28  WK-GREG-DD       PIC XX.
  1287
  1288         16  WORK-SELECT-DATE.
  1289             24  WK-SELECT-CENT            PIC XX.
  1290             24  WK-SELECT-DATE-YYMMDD.
  1291                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1292                 28  FILLER                PIC XX.
  1293
  1294         16  WK-FORM-NO.
  1295             24  WK-FORM-BANK-ID       PIC X(5).
  1296             24  WK-FORM-UNDRWRTR      PIC X(1).
  1297             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1298
  1299         16  WK-MEMBER-NO.
  1300             24  WK-MEMBER-1-6        PIC X(6).
  1301             24  WK-MEMBER-7-12       PIC X(6).
  1302
  1303         16  WK-FULL-CERT-NO.
  1304             24  WK-CERT-POS-1-2      PIC X(2).
  1305             24  WK-CERT-POS-3        PIC X(1).
  1306             24  WK-CERT-POS-4        PIC X(1).
  1307             24  WK-CERT-POS-5-6      PIC X(2).
  1308             24  WK-CERT-POS-7        PIC X(1).
  1309             24  WK-CERT-POS-8-11     PIC X(4).
  1310
  1311         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1312             88  VALID-RATE-CODE        VALUE 'Y'.
  1313             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1314
  1315         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1316         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1317         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1318         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1319         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1320         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1321         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1322         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1323         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1324         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1325
  1326* DLO001
  1327 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  25
* EL050.cbl
  1328     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1329     12  DMPF-RETURN-CODE          PIC XX.
  1330         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1331         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1332         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1333         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1334         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1335         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1336
  1337* DLO002
  1338 01  WS-DLO-INTERNAL-POLICY-FORM.
  1339     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1340     12  DIPF-RETURN-CODE          PIC XX.
  1341         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1342         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1343         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1344         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1345         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1346         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1347
  1348* DLO003
  1349 01  WS-DLO-VALID-BANK-ID.
  1350     12  DVBI-BANK-ID              PIC X(5).
  1351     12  DVBI-BANK-ID-TYPE         PIC X.
  1352         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1353         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1354         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1355         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1356         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1357     12  DVBI-RETURN-CODE          PIC XX.
  1358         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1359         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1360         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1361         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1362         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1363         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1364         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1365         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1366         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO007
  1369 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1370     12  DCUA-RES-STATE            PIC XX.
  1371     12  DCUA-BEN-TYPE             PIC XX.
  1372     12  DCUA-SYS-IDENT            PIC X.
  1373         88  DCUA-CLAIM                        VALUE 'C'.
  1374         88  DCUA-PREMIUM                      VALUE 'P'.
  1375     12  DCUA-COVERAGE-RULE        PIC X.
  1376     12  DCUA-CLIENT-ID            PIC X(10).
  1377     12  DCUA-EFF-DATE             PIC X(8).
  1378     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1379     12  DCUA-RETURN-CODE          PIC XX.
  1380         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1381     12  DCUA-CERT-NUMBER          PIC X(11).
  1382     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1383     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1384
  1385* DLO011
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  26
* EL050.cbl
  1386 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1387     12  DPRB-RATE-CODE            PIC X(4).
  1388     12  DPRB-COVERAGE-CATEG       PIC X.
  1389     12  DPRB-RETURN-CODE          PIC XX.
  1390         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1391         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1392         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1393         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1394         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1395         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1396         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1397         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1398         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1399     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1400     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1401     12  DPRB-BEN-TYPE             PIC XX.
  1402
  1403* DLO017
  1404 01  WS-DLO-VALID-RATE-CODE.
  1405     12  DVRC-RATE-CODE            PIC X(4).
  1406     12  DVRC-RETURN-CODE          PIC XX.
  1407         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1408         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1409         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1410         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1411         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1412         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1413
  1414* DLO019
  1415 01  WS-DLO-ORIG-COV-CAT.
  1416     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1417     12  DOCC-RETURN-CODE          PIC XX.
  1418     12  DOCC-ORIG-COV-CAT         PIC X.
  1419     12  DOCC-UNDERWITER           PIC XX.
  1420     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1421     12  DOCC-FILLER               PIC X(6).
  1422
  1423* DLO021
  1424 01  WS-DLO-VALID-LOAN-OFFICER.
  1425     12  DVLO-LOAN-OFFICER.
  1426         16  DVLO-BILL-TYPE        PIC X.
  1427         16  DVLO-BILL-SOURCE      PIC X.
  1428         16  DVLO-BATCH-TYPE       PIC X.
  1429     12  DVLO-RETURN-CODE          PIC XX.
  1430         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1431         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1432         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1433         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1434         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1435         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1436
  1437* DLO022
  1438 01  WS-DLO-VALID-STATE-CODE.
  1439     12  DVSC-STATE-CODE           PIC XX.
  1440     12  DVSC-RETURN-CODE          PIC XX.
  1441         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1442
  1443* DLO023
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  27
* EL050.cbl
  1444 01  WS-DLO-VALID-CODE-VALUES.
  1445     12  DVCV-SYSTEM-ID            PIC XX.
  1446         88  DVCV-CLAIMS                       VALUE 'CL'.
  1447         88  DVCV-CREDIT                       VALUE 'CR'.
  1448     12  DVCV-RECORD-TYPE          PIC XX.
  1449         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1450         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1451         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1452         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1453         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1454         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1455         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1456         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1457     12  DVCV-RECORD-KEY           PIC X(6).
  1458     12  DVCV-RETURN-CODE          PIC XX.
  1459         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1460         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1461         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1462         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1463         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1464         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1465         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1466     12  DVCV-CODE-DESC            PIC X(60).
  1467     12  DVCV-GEN-DESC-1           PIC X(20).
  1468     12  DVCV-GEN-DESC-2           PIC X(20).
  1469     12  DVCV-GEN-DESC-3           PIC X(20).
  1470
  1471****  this is for aggregate report.
  1472****  Length is erpndb + 100 of passed-key-area
  1473 01  ws-passed-key-length        pic s9(4) comp value +587.
  1474 01  ws-pass-to-pemaggo.
  1475     05  ws-passed-erpndb        pic x(585).
  1476     05  ws-exceed-limit-yn      pic x.
  1477     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  28
* EL050.cbl
  1479*    COPY ERCBXRF.
  1480******************************************************************
  1481*                                                                *
  1482*                                                                *
  1483*                            ERCBXRF                             *
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499
  1500 01  BANK-CROSS-REFERENCE.
  1501     12  BK-RECORD-ID                PIC XX.
  1502         88  VALID-BK-ID             VALUE 'BK'.
  1503
  1504     12  BK-CONTROL-PRIMARY.
  1505         16  BK-COMPANY-CD           PIC X.
  1506         16  BK-CARRIER              PIC X.
  1507         16  BK-GROUPING             PIC X(6).
  1508         16  BK-BANK-NO              PIC X(10).
  1509
  1510     12  BK-MAINT-INFORMATION.
  1511         16  BK-LAST-MAINT-DT        PIC XX.
  1512         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1513         16  BK-LAST-MAINT-USER      PIC X(4).
  1514         16  FILLER                  PIC X(9).
  1515
  1516     12  FILLER                      PIC X(37).
  1517
  1518     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1519
  1520     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1521                            DEPENDING ON BK-BANK-POINTER-CNT.
  1522         16  BK-AM-ACCOUNT           PIC X(10).
  1523         16  BK-AM-EXP-DT            PIC XX.
  1524         16  BK-AM-EFF-DT            PIC XX.
  1525         16  BK-AM-STATE             PIC XX.
  1526         16  FILLER                  PIC X(20).
  1527
  1528******************************************************************
  1529
  1530*    COPY ERCCOMP.
  1531******************************************************************
  1532*                                                                *
  1533*                                                                *
  1534*                            ERCCOMP                             *
  1535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1536*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  29
* EL050.cbl
  1537*                                                                *
  1538*   ONLINE CREDIT SYSTEM                                         *
  1539*                                                                *
  1540*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1541*                                                                *
  1542*   FILE TYPE = VSAM,KSDS                                        *
  1543*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1544*                                                                *
  1545*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1546*       ALTERNATE PATH = NONE                                    *
  1547*                                                                *
  1548*   LOG = NO                                                     *
  1549*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1550*                                                                *
  1551******************************************************************
  1552*                   C H A N G E   L O G
  1553*
  1554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1555*-----------------------------------------------------------------
  1556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1557* EFFECTIVE    NUMBER
  1558*-----------------------------------------------------------------
  1559* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1560* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1561* 092205    2005050300006  PEMA  ADD LEASE FEE
  1562* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1563* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1564* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1565* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1566* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1567* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1568******************************************************************
  1569
  1570 01  COMPENSATION-MASTER.
  1571     12  CO-RECORD-ID                          PIC XX.
  1572         88  VALID-CO-ID                          VALUE 'CO'.
  1573
  1574     12  CO-CONTROL-PRIMARY.
  1575         16  CO-COMPANY-CD                     PIC X.
  1576         16  CO-CONTROL.
  1577             20  CO-CTL-1.
  1578                 24  CO-CARR-GROUP.
  1579                     28  CO-CARRIER            PIC X.
  1580                     28  CO-GROUPING.
  1581                         32  CO-GROUP-PREFIX   PIC XXX.
  1582                         32  CO-GROUP-PRIME    PIC XXX.
  1583                 24  CO-RESP-NO.
  1584                     28  CO-RESP-PREFIX        PIC X(4).
  1585                     28  CO-RESP-PRIME         PIC X(6).
  1586             20  CO-CTL-2.
  1587                 24  CO-ACCOUNT.
  1588                     28  CO-ACCT-PREFIX        PIC X(4).
  1589                     28  CO-ACCT-PRIME         PIC X(6).
  1590         16  CO-TYPE                           PIC X.
  1591             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1592             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1593             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1594
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  30
* EL050.cbl
  1595     12  CO-MAINT-INFORMATION.
  1596         16  CO-LAST-MAINT-DT                  PIC XX.
  1597         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1598         16  CO-LAST-MAINT-USER                PIC X(4).
  1599     12  FILLER                                PIC XX.
  1600     12  CO-STMT-TYPE                          PIC XXX.
  1601     12  CO-COMP-TYPE                          PIC X.
  1602         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1603     12  CO-STMT-OWNER                         PIC X(4).
  1604     12  CO-BALANCE-CONTROL                    PIC X.
  1605         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1606         88  CO-NO-BALANCE                        VALUE 'N'.
  1607
  1608     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1609         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1610         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1611         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1612
  1613     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1614         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1615         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1616
  1617     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1618     12  CO-GA-DIRECT-DEP                      PIC X.
  1619     12  CO-FUTURE-SPACE                       PIC X.
  1620         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1621
  1622     12  CO-ACCT-NAME                          PIC X(30).
  1623     12  CO-MAIL-NAME                          PIC X(30).
  1624     12  CO-ADDR-1                             PIC X(30).
  1625     12  CO-ADDR-2                             PIC X(30).
  1626     12  CO-ADDR-3.
  1627         16  CO-ADDR-CITY                      PIC X(27).
  1628         16  CO-ADDR-STATE                     PIC XX.
  1629     12  CO-CSO-1099                           PIC X.
  1630     12  CO-ZIP.
  1631         16  CO-ZIP-PRIME.
  1632             20  CO-ZIP-PRI-1ST                PIC X.
  1633                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1634             20  FILLER                        PIC X(4).
  1635         16  CO-ZIP-PLUS4                      PIC X(4).
  1636     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1637         16  CO-CAN-POSTAL-1                   PIC XXX.
  1638         16  CO-CAN-POSTAL-2                   PIC XXX.
  1639         16  FILLER                            PIC XXX.
  1640     12  CO-SOC-SEC                            PIC X(13).
  1641     12  CO-TELEPHONE.
  1642         16  CO-AREA-CODE                      PIC XXX.
  1643         16  CO-PREFIX                         PIC XXX.
  1644         16  CO-PHONE                          PIC X(4).
  1645
  1646     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1647
  1648     12  CO-AR-BAL-LEVEL                       PIC X.
  1649         88  CO-AR-REF-LVL                        VALUE '1'.
  1650         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1651         88  CO-AR-BILL-LVL                       VALUE '2'.
  1652         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  31
* EL050.cbl
  1653         88  CO-AR-FR-LVL                         VALUE '4'.
  1654
  1655     12  CO-AR-NORMAL-PRINT                    PIC X.
  1656         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1657         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1658
  1659     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1660
  1661     12  CO-AR-REPORTING                       PIC X.
  1662         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1663         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1664
  1665     12  CO-AR-PULL-CHECK                      PIC X.
  1666         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1667         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1668
  1669     12  CO-AR-BALANCE-PRINT                   PIC X.
  1670         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1671
  1672     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1673         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1674         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1675         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1676
  1677     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1678
  1679     12  CO-USER-CODE                          PIC X.
  1680     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1681
  1682******************************************************************
  1683*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1684*    THE LAST MONTH END RUN.
  1685******************************************************************
  1686
  1687     12  CO-LAST-ACTIVITY-DATE.
  1688         16  CO-ACT-YEAR                       PIC 99.
  1689         16  CO-ACT-MONTH                      PIC 99.
  1690         16  CO-ACT-DAY                        PIC 99.
  1691
  1692     12  CO-LAST-STMT-DT.
  1693         16  CO-LAST-STMT-YEAR                 PIC 99.
  1694         16  CO-LAST-STMT-MONTH                PIC 99.
  1695         16  CO-LAST-STMT-DAY                  PIC 99.
  1696
  1697     12  CO-MO-END-TOTALS.
  1698         16  CO-MONTHLY-TOTALS.
  1699             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1700             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1701             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1702             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1703             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1704
  1705         16  CO-AGING-TOTALS.
  1706             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1707             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1708             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1709             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1710
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  32
* EL050.cbl
  1711         16  CO-YTD-TOTALS.
  1712             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1713             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1714
  1715         16  CO-OVER-UNDER-TOTALS.
  1716             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1717             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1718
  1719     12  CO-MISCELLANEOUS-TOTALS.
  1720         16  CO-FICA-TOTALS.
  1721             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1722             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1723
  1724         16  CO-CLAIM-TOTALS.
  1725             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1726             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1727
  1728******************************************************************
  1729*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1730*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1731******************************************************************
  1732
  1733     12  CO-CURRENT-TOTALS.
  1734         16  CO-CURRENT-LAST-STMT-DT.
  1735             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1736             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1737             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1738
  1739         16  CO-CURRENT-MONTHLY-TOTALS.
  1740             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1741             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1742             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1743             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1745
  1746         16  CO-CURRENT-AGING-TOTALS.
  1747             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1748             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1749             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1750             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1751
  1752         16  CO-CURRENT-YTD-TOTALS.
  1753             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1754             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1755
  1756     12  CO-PAID-COMM-TOTALS.
  1757         16  CO-YTD-PAID-COMMS.
  1758             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1759             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1760
  1761     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1762         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1763         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1764
  1765     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1766         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1767         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1768         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  33
* EL050.cbl
  1769         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1770         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1771         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1772         88  CO-FINAL-LETTER                  VALUE 'F'.
  1773         88  CO-RECONCILING                   VALUE 'R'.
  1774         88  CO-PHONE-CALL                    VALUE 'P'.
  1775         88  CO-LEGAL                         VALUE 'L'.
  1776         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1777         88  CO-WRITE-OFF                     VALUE 'W'.
  1778         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1779
  1780     12  CO-CSR-CODE                       PIC X(4).
  1781
  1782     12  CO-GA-STATUS-INFO.
  1783         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1784         16  CO-GA-TERMINATION-DT          PIC XX.
  1785         16  CO-GA-STATUS-CODE             PIC X.
  1786             88  CO-GA-ACTIVE                 VALUE 'A'.
  1787             88  CO-GA-INACTIVE               VALUE 'I'.
  1788             88  CO-GA-PENDING                VALUE 'P'.
  1789         16  CO-GA-COMMENTS.
  1790             20  CO-GA-COMMENT-1           PIC X(40).
  1791             20  CO-GA-COMMENT-2           PIC X(40).
  1792             20  CO-GA-COMMENT-3           PIC X(40).
  1793             20  CO-GA-COMMENT-4           PIC X(40).
  1794
  1795     12  CO-RPTCD2                         PIC X(10).
  1796     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1797         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1798         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1799
  1800     12  CO-TYPE-AGENT                     PIC X(01).
  1801         88  CO-CORPORATION                   VALUE 'C'.
  1802         88  CO-PARTNERSHIP                   VALUE 'P'.
  1803         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1804         88  CO-TRUST                         VALUE 'T'.
  1805         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1806
  1807     12  CO-FAXNO.
  1808         16  CO-FAX-AREA-CODE                  PIC XXX.
  1809         16  CO-FAX-PREFIX                     PIC XXX.
  1810         16  CO-FAX-PHONE                      PIC X(4).
  1811
  1812     12  CO-BANK-INFORMATION.
  1813         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1814         16  CO-BANK-TRANSIT-NON REDEFINES
  1815             CO-BANK-TRANSIT-NO                PIC 9(8).
  1816
  1817         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1818     12  CO-MISC-DEDUCT-INFO REDEFINES
  1819                  CO-BANK-INFORMATION.
  1820         16  CO-MD-GL-ACCT                     PIC X(10).
  1821         16  CO-MD-DIV                         PIC XX.
  1822         16  CO-MD-CENTER                      PIC X(4).
  1823         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1824         16  CO-CREATE-AP-CHECK                PIC X.
  1825         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1826         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  34
* EL050.cbl
  1827     12  CO-ACH-STATUS                         PIC X.
  1828         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1829         88  CO-ACH-PENDING                        VALUE 'P'.
  1830
  1831     12  CO-BILL-SW                            PIC X.
  1832     12  CO-CONTROL-NAME                       PIC X(30).
  1833     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1834     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1835     12  CO-CLP-STATE                          PIC XX.
  1836     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1837     12  CO-SPP-REFUND-EDIT                    PIC X.
  1838
  1839******************************************************************
  1840
  1841*    COPY ERCAGTC.
  1842******************************************************************
  1843*                                                                *
  1844*                                                                *
  1845*                            ERCAGTC                             *
  1846*                            VMOD=2.001                          *
  1847*                                                                *
  1848*   ONLINE CREDIT SYSTEM                                         *
  1849*                                                                *
  1850*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1851*                                                                *
  1852*   FILE TYPE = VSAM,KSDS                                        *
  1853*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1854*                                                                *
  1855*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1856*       ALTERNATE PATH = NONE                                    *
  1857*                                                                *
  1858*   LOG = NO                                                     *
  1859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1860*                                                                *
  1861******************************************************************
  1862*                   C H A N G E   L O G
  1863*
  1864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1865*-----------------------------------------------------------------
  1866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1867* EFFECTIVE    NUMBER
  1868*-----------------------------------------------------------------
  1869* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1870* 111004                         NEW FILE AND COPYBOOK
  1871* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1872******************************************************************
  1873 01  AGENT-COMMISSIONS.
  1874     12  AG-RECORD-ID                          PIC XX.
  1875         88  VALID-CO-ID                          VALUE 'AG'.
  1876     12  AG-CONTROL-PRIMARY.
  1877         16  AG-COMPANY-CD                     PIC X.
  1878         16  AG-CONTROL.
  1879             20  AG-CTL-1.
  1880                 24  AG-CARR-GROUP.
  1881                     28  AG-CARRIER            PIC X.
  1882                     28  AG-GROUPING           PIC X(6).
  1883                 24  AG-BANK                   PIC X(10).
  1884             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  35
* EL050.cbl
  1885                 24  AG-EXP-DT                 PIC XX.
  1886         16  AG-TYPE                           PIC X.
  1887             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1888             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1889     12  AG-MAINT-INFORMATION.
  1890         16  AG-LAST-MAINT-DT                  PIC XX.
  1891         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1892         16  AG-LAST-MAINT-USER                PIC X(4).
  1893         16  FILLER                            PIC X(10).
  1894     12  AG-EFF-DT                             PIC XX.
  1895     12  AG-COMM-STRUCTURE.
  1896         16  AG-AGT-COMMS OCCURS 10.
  1897             20  AG-AGT                PIC X(10).
  1898             20  AG-COM-TYP            PIC X.
  1899             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1900             20  AG-RECALC-LV-INDIC    PIC X.
  1901             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1902             20  AG-LRCALC-LV-INDIC    PIC X.
  1903             20  FILLER                PIC X(05).
  1904     12  FILLER                  PIC X(145).
  1905******************************************************************
  1906*    COPY ERCRESS.
  1907******************************************************************
  1908*                                                                *
  1909*                            ERCRESS                             *
  1910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1911*                            VMOD=2.002                          *
  1912*                                                                *
  1913*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1914*                                                                *
  1915*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1916*   VSAM RESIDENT STATE TAX MASTER                              *
  1917*                                                                *
  1918*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1919*                                                                *
  1920*   FILE TYPE = VSAM,KSDS                                        *
  1921*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1922*                                                                *
  1923*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1924*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1925*                                                                *
  1926*   LOG = NO                                                     *
  1927*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1928*                                                                *
  1929*                                                                *
  1930******************************************************************
  1931
  1932 01  RESIDENT-STATE-TAX-MASTER.
  1933
  1934     10  ERRESS-PRIMARY-KEY.
  1935         15  RES-COMPANY-CD        PIC X.
  1936         15  RES-RESIDENT-STATE    PIC XX.
  1937         15  RES-COVERAGE-CATEGORY PIC X.
  1938         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1939*                                      YYYYMMDD
  1940*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1941
  1942     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  36
* EL050.cbl
  1943
  1944         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1945         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1946         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1947         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1948
  1949     10 RES-RECALC-SW              PIC   X.
  1950         88 RECALC                VALUE 'Y'.
  1951         88 NO-RECALC             VALUE 'N'.
  1952     10  RES-MAINT-BY              PIC X(4).
  1953     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1954     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1955*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  37
* EL050.cbl
  1957*    COPY ERCRESC.
  1958******************************************************************
  1959*                                                                *
  1960*                            ERCRESC                             *
  1961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1962*                            VMOD=2.003                          *
  1963*                                                                *
  1964*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1965*                                                                *
  1966*   FILE TYPE = VSAM,KSDS                                        *
  1967*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1968*                                                                *
  1969*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1970*       ALTERNATE PATH1 = NONE                                   *
  1971*                                                                *
  1972*   LOG = NO                                                     *
  1973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1978
  1979     10  ERRESC-RECORD-KEY.
  1980         15  RESC-COMPANY-CD           PIC   X.
  1981         15  RESC-CARRIER              PIC   X.
  1982         15  RESC-GROUP                PIC   X(6).
  1983         15  RESC-STATE                PIC   XX.
  1984         15  RESC-ACCOUNT              PIC   X(10).
  1985         15  RESC-AGENT                PIC   X(10).
  1986         15  RESC-RESIDENT-STATE       PIC   XX.
  1987         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1988*                                           YYYYMMDD
  1989     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1990
  1991     10  RESC-COMM-RECORD-DATA.
  1992         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1993             20 RESC-COVERAGE-CAT      PIC    X.
  1994             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1995             20 RESC-COMMISSION-TAB REDEFINES
  1996                RESC-COMMISSION-PER    PIC  XXX.
  1997
  1998     10  RESC-MAINT-BY                 PIC X(4).
  1999     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2000     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2001*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  38
* EL050.cbl
  2003*    COPY ERCPLAN.
  2004******************************************************************
  2005*                                                                *
  2006*                                                                *
  2007*                            ERCPLAN                             *
  2008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2009*                            VMOD=2.003                          *
  2010*                                                                *
  2011*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2012*                                                                *
  2013*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2014*   PLAN MASTER                                                  *
  2015*                                                                *
  2016*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2017*                                                                *
  2018*   FILE TYPE = VSAM,KSDS                                        *
  2019*   RECORD SIZE = 420   RECFORM = FIX                            *
  2020*                                                                *
  2021*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2022*       ALTERNATE PATH1 = N/A                                    *
  2023*                                                                *
  2024*   LOG = NO                                                     *
  2025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2026*                                                                *
  2027*                                                                *
  2028******************************************************************
  2029
  2030 01  PLAN-MASTER.
  2031     12  PL-RECORD-ID                      PIC XX.
  2032         88  VALID-PL-ID                      VALUE 'PL'.
  2033
  2034     12  PL-CONTROL-PRIMARY.
  2035         16  PL-COMPANY-CD                 PIC X.
  2036         16  PL-MSTR-CNTRL.
  2037             20  PL-CONTROL-A.
  2038                 24  PL-CARRIER            PIC X.
  2039                 24  PL-GROUPING           PIC X(6).
  2040                 24  PL-STATE              PIC XX.
  2041                 24  PL-ACCOUNT            PIC X(10).
  2042             20  PL-BENEFIT-TYPE           PIC X.
  2043             20  PL-BENEFIT-CODE           PIC XX.
  2044             20  PL-REVISION-NO            PIC X(3).
  2045
  2046     12  PL-CONTROL-BY-VAR-GRP.
  2047         16  PL-COMPANY-CD-A1              PIC X.
  2048         16  PL-VG-CARRIER                 PIC X.
  2049         16  PL-VG-GROUPING                PIC X(6).
  2050         16  PL-VG-STATE                   PIC XX.
  2051         16  PL-VG-ACCOUNT                 PIC X(10).
  2052         16  PL-BENEFIT-TYPE-A1            PIC X.
  2053         16  PL-BENEFIT-CODE-A1            PIC XX.
  2054         16  PL-REVISION-NO-A1             PIC 999.
  2055
  2056     12  PL-MAINT-INFORMATION.
  2057         16  PL-LAST-MAINT-DT              PIC XX.
  2058         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2059         16  PL-LAST-MAINT-USER            PIC X(4).
  2060         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  39
* EL050.cbl
  2061
  2062     12  PL-LIABILITY-LIMITS.
  2063         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2064         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2065             20  PL-LM-AGE                 PIC S99        COMP-3.
  2066             20  PL-LM-DUR                 PIC S999       COMP-3.
  2067             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2068             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2069
  2070     12  FILLER                            PIC X(30).
  2071
  2072     12  PL-GL-ACCOUNT-NOS.
  2073         16  PL-PREMIUM-GL                 PIC X(8).
  2074         16  PL-COMM-GL                    PIC X(8).
  2075         16  PL-CLAIM-GL                   PIC X(8).
  2076     12  FILLER                            PIC X(24).
  2077     12  PL-TOLERANCES.
  2078         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2079         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2080         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2081         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2082         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2083         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2084     12  PL-OVER-SHORT.
  2085         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2086         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2087     12  FILLER                            PIC X(24).
  2088     12  PLAN-MISC.
  2089         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2090         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2091         16  PL-IG                         PIC X.
  2092         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2093         16  PL-POLICY-FORM                PIC X(12).
  2094         16  PL-EDIT-FOR-FORM              PIC X(01).
  2095         16  PL-DEV-CODE                   PIC XXX.
  2096         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2097         16  PL-CALC-METHOD                PIC X.
  2098         16  PL-BENEFIT-GROUP              PIC X(05).
  2099         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2100
  2101         16  FILLER                        PIC X(99).
  2102******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  40
* EL050.cbl
  2104*    COPY ELCCERT.
  2105******************************************************************
  2106*                                                                *
  2107*                            ELCCERT.                            *
  2108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2109*                            VMOD=2.013                          *
  2110*                                                                *
  2111*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2112*                                                                *
  2113*   FILE TYPE = VSAM,KSDS                                        *
  2114*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2115*                                                                *
  2116*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2117*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2118*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2119*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2120*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2121*                                                                *
  2122*   LOG = YES                                                    *
  2123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2124******************************************************************
  2125*                   C H A N G E   L O G
  2126*
  2127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2128*-----------------------------------------------------------------
  2129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2130* EFFECTIVE    NUMBER
  2131*-----------------------------------------------------------------
  2132* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2133* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2134* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2135* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2136* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2137* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2138* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2139* 032612  CR2011110200001  PEMA  AHL CHANGES
  2140* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2141* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2142******************************************************************
  2143
  2144 01  CERTIFICATE-MASTER.
  2145     12  CM-RECORD-ID                      PIC XX.
  2146         88  VALID-CM-ID                      VALUE 'CM'.
  2147
  2148     12  CM-CONTROL-PRIMARY.
  2149         16  CM-COMPANY-CD                 PIC X.
  2150         16  CM-CARRIER                    PIC X.
  2151         16  CM-GROUPING.
  2152             20  CM-GROUPING-PREFIX        PIC X(3).
  2153             20  CM-GROUPING-PRIME         PIC X(3).
  2154         16  CM-STATE                      PIC XX.
  2155         16  CM-ACCOUNT.
  2156             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2157             20  CM-ACCOUNT-PRIME          PIC X(6).
  2158         16  CM-CERT-EFF-DT                PIC XX.
  2159         16  CM-CERT-NO.
  2160             20  CM-CERT-PRIME             PIC X(10).
  2161             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  41
* EL050.cbl
  2162
  2163     12  CM-CONTROL-BY-NAME.
  2164         16  CM-COMPANY-CD-A1              PIC X.
  2165         16  CM-INSURED-LAST-NAME          PIC X(15).
  2166         16  CM-INSURED-INITIALS.
  2167             20  CM-INSURED-INITIAL1       PIC X.
  2168             20  CM-INSURED-INITIAL2       PIC X.
  2169
  2170     12  CM-CONTROL-BY-SSN.
  2171         16  CM-COMPANY-CD-A2              PIC X.
  2172         16  CM-SOC-SEC-NO.
  2173             20  CM-SSN-STATE              PIC XX.
  2174             20  CM-SSN-ACCOUNT            PIC X(6).
  2175             20  CM-SSN-LN3.
  2176                 25  CM-INSURED-INITIALS-A2.
  2177                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2178                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2179                 25 CM-PART-LAST-NAME-A2         PIC X.
  2180
  2181     12  CM-CONTROL-BY-CERT-NO.
  2182         16  CM-COMPANY-CD-A4              PIC X.
  2183         16  CM-CERT-NO-A4                 PIC X(11).
  2184
  2185     12  CM-CONTROL-BY-MEMB.
  2186         16  CM-COMPANY-CD-A5              PIC X.
  2187         16  CM-MEMBER-NO.
  2188             20  CM-MEMB-STATE             PIC XX.
  2189             20  CM-MEMB-ACCOUNT           PIC X(6).
  2190             20  CM-MEMB-LN4.
  2191                 25  CM-INSURED-INITIALS-A5.
  2192                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2193                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2194                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2195
  2196     12  CM-INSURED-PROFILE-DATA.
  2197         16  CM-INSURED-FIRST-NAME.
  2198             20  CM-INSURED-1ST-INIT       PIC X.
  2199             20  FILLER                    PIC X(9).
  2200         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2201         16  CM-INSURED-SEX                PIC X.
  2202             88  CM-SEX-MALE                  VALUE 'M'.
  2203             88  CM-SEX-FEMAL                 VALUE 'F'.
  2204         16  CM-INSURED-JOINT-AGE          PIC 99.
  2205         16  CM-JOINT-INSURED-NAME.
  2206             20  CM-JT-LAST-NAME           PIC X(15).
  2207             20  CM-JT-FIRST-NAME.
  2208                 24  CM-JT-1ST-INIT        PIC X.
  2209                 24  FILLER                PIC X(9).
  2210             20  CM-JT-INITIAL             PIC X.
  2211
  2212     12  CM-LIFE-DATA.
  2213         16  CM-LF-BENEFIT-CD              PIC XX.
  2214         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2215         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2216         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2217         16  CM-LF-DEV-CODE                PIC XXX.
  2218         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2219         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  42
* EL050.cbl
  2220         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2221         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2222         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2223         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2224         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2225         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2226         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2227         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2228         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2229         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2230         16  cm-temp-epiq                  pic xx.
  2231             88  EPIQ-CLASS                  value 'EQ'.
  2232*        16  FILLER                        PIC XX.
  2233
  2234     12  CM-AH-DATA.
  2235         16  CM-AH-BENEFIT-CD              PIC XX.
  2236         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2237         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2238         16  CM-AH-DEV-CODE                PIC XXX.
  2239         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2240         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2241         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2242         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2243         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2244         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2245         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2246         16  CM-AH-PAID-THRU-DT            PIC XX.
  2247             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2248         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2249         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2250         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2251         16  FILLER                        PIC X.
  2252
  2253     12  CM-LOAN-INFORMATION.
  2254         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2255         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2256                                           PIC S9(5)V99  COMP-3.
  2257         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2258         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2259         16  CM-PAY-FREQUENCY              PIC S99.
  2260         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2261         16  CM-RATE-CLASS                 PIC XX.
  2262         16  CM-BENEFICIARY                PIC X(25).
  2263         16  CM-POLICY-FORM-NO             PIC X(12).
  2264         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2265         16  CM-LAST-ADD-ON-DT             PIC XX.
  2266         16  CM-DEDUCTIBLE-AMOUNTS.
  2267             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2268             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2269         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2270             20  CM-RESIDENT-STATE         PIC XX.
  2271             20  CM-RATE-CODE              PIC X(4).
  2272             20  FILLER                    PIC XX.
  2273         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2274             20  CM-LOAN-OFFICER           PIC X(5).
  2275             20  FILLER                    PIC XXX.
  2276         16  CM-CSR-CODE                   PIC XXX.
  2277         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  43
* EL050.cbl
  2278             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2279         16  CM-POST-CARD-IND              PIC X.
  2280         16  CM-NH-INTERFACE-SW            PIC X.
  2281         16  CM-PREMIUM-TYPE               PIC X.
  2282             88  CM-SING-PRM                  VALUE '1'.
  2283             88  CM-O-B-COVERAGE              VALUE '2'.
  2284             88  CM-OPEN-END                  VALUE '3'.
  2285         16  CM-IND-GRP-TYPE               PIC X.
  2286             88  CM-INDIVIDUAL                VALUE 'I'.
  2287             88  CM-GROUP                     VALUE 'G'.
  2288         16  CM-SKIP-CODE                  PIC X.
  2289             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2290             88  SKIP-JULY                    VALUE '1'.
  2291             88  SKIP-AUGUST                  VALUE '2'.
  2292             88  SKIP-SEPTEMBER               VALUE '3'.
  2293             88  SKIP-JULY-AUG                VALUE '4'.
  2294             88  SKIP-AUG-SEPT                VALUE '5'.
  2295             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2296             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2297             88  SKIP-JUNE                    VALUE '8'.
  2298             88  SKIP-JUNE-JULY               VALUE '9'.
  2299             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2300             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2301         16  CM-PAYMENT-MODE               PIC X.
  2302             88  PAY-MONTHLY                  VALUE SPACE.
  2303             88  PAY-WEEKLY                   VALUE '1'.
  2304             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2305             88  PAY-BI-WEEKLY                VALUE '3'.
  2306             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2307         16  CM-LOAN-NUMBER                PIC X(8).
  2308         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2309         16  CM-OLD-LOF                    PIC XXX.
  2310*        16  CM-LOAN-OFFICER               PIC XXX.
  2311         16  CM-REIN-TABLE                 PIC XXX.
  2312         16  CM-SPECIAL-REIN-CODE          PIC X.
  2313         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2314         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2315         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2316
  2317     12  CM-STATUS-DATA.
  2318         16  CM-ENTRY-STATUS               PIC X.
  2319         16  CM-ENTRY-DT                   PIC XX.
  2320
  2321         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2322         16  CM-LF-CANCEL-DT               PIC XX.
  2323         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2324
  2325         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2326         16  CM-LF-DEATH-DT                PIC XX.
  2327         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2328
  2329         16  CM-LF-CURRENT-STATUS          PIC X.
  2330             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2331                                                'M' '4' '5' '9'.
  2332             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2333             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2334             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2335             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  44
* EL050.cbl
  2336             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2337             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2338             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2339             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2340             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2341             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2342             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2343             88  CM-LF-DECLINED               VALUE 'D'.
  2344             88  CM-LF-VOIDED                 VALUE 'V'.
  2345
  2346         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2347         16  CM-AH-CANCEL-DT               PIC XX.
  2348         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2349
  2350         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2351         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2352         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2353
  2354         16  CM-AH-CURRENT-STATUS          PIC X.
  2355             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2356                                                'M' '4' '5' '9'.
  2357             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2358             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2359             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2360             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2361             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2362             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2363             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2364             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2365             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2366             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2367             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2368             88  CM-AH-DECLINED               VALUE 'D'.
  2369             88  CM-AH-VOIDED                 VALUE 'V'.
  2370
  2371         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2372             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2373             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2374             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2375         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2376
  2377         16  CM-ENTRY-BATCH                PIC X(6).
  2378         16  CM-LF-EXIT-BATCH              PIC X(6).
  2379         16  CM-AH-EXIT-BATCH              PIC X(6).
  2380         16  CM-LAST-MONTH-END             PIC XX.
  2381
  2382     12  CM-NOTE-SW                        PIC X.
  2383         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2384         88  CERT-NOTES-PRESENT               VALUE '1'.
  2385         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2386         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2387         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2388         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2389         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2390         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2391     12  CM-COMP-EXCP-SW                   PIC X.
  2392         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2393         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  45
* EL050.cbl
  2394     12  CM-INSURED-ADDRESS-SW             PIC X.
  2395         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2396         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2397
  2398*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2399     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2400     12  FILLER                            PIC X.
  2401
  2402*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2403     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2404     12  FILLER                            PIC X.
  2405*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2406     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2407
  2408     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2409         88  CERT-ADDED-BATCH                 VALUE ' '.
  2410         88  CERT-ADDED-ONLINE                VALUE '1'.
  2411         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2412         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2413         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2414     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2415         88  CERT-AS-LOADED                   VALUE ' '.
  2416         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2417         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2418         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2419         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2420         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2421         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2422         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2423
  2424     12  CM-ACCOUNT-COMM-PCTS.
  2425         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2426         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2427
  2428     12  CM-USER-FIELD                     PIC X.
  2429     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2430     12  CM-CLP-STATE                      PIC XX.
  2431     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2432     12  CM-USER-RESERVED                  PIC XXX.
  2433     12  FILLER REDEFINES CM-USER-RESERVED.
  2434         16  CM-AH-CLASS-CD                PIC XX.
  2435         16  F                             PIC X.
  2436******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  46
* EL050.cbl
  2438*    COPY ERCMAIL.
  2439******************************************************************
  2440*                                                                *
  2441*                                                                *
  2442*                            ERCMAIL                             *
  2443*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2444*                            VMOD=2.003                          *
  2445*                                                                *
  2446*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2447*                                                                *
  2448*   FILE TYPE = VSAM,KSDS                                        *
  2449*   RECORD SIZE = 374   RECFORM = FIX                            *
  2450*                                                                *
  2451*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2452*   ALTERNATE PATH    = NOT USED                                 *
  2453*                                                                *
  2454*   LOG = YES                                                    *
  2455*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2456******************************************************************
  2457*                   C H A N G E   L O G
  2458*
  2459* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2460*-----------------------------------------------------------------
  2461*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2462* EFFECTIVE    NUMBER
  2463*-----------------------------------------------------------------
  2464* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2465* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2466* 111108                   PEMA  ADD CRED BENE ADDR2
  2467******************************************************************
  2468
  2469 01  MAILING-DATA.
  2470     12  MA-RECORD-ID                      PIC XX.
  2471         88  VALID-MA-ID                       VALUE 'MA'.
  2472
  2473     12  MA-CONTROL-PRIMARY.
  2474         16  MA-COMPANY-CD                 PIC X.
  2475         16  MA-CARRIER                    PIC X.
  2476         16  MA-GROUPING.
  2477             20  MA-GROUPING-PREFIX        PIC XXX.
  2478             20  MA-GROUPING-PRIME         PIC XXX.
  2479         16  MA-STATE                      PIC XX.
  2480         16  MA-ACCOUNT.
  2481             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2482             20  MA-ACCOUNT-PRIME          PIC X(6).
  2483         16  MA-CERT-EFF-DT                PIC XX.
  2484         16  MA-CERT-NO.
  2485             20  MA-CERT-PRIME             PIC X(10).
  2486             20  MA-CERT-SFX               PIC X.
  2487
  2488     12  FILLER                            PIC XX.
  2489
  2490     12  MA-ACCESS-CONTROL.
  2491         16  MA-SOURCE-SYSTEM              PIC XX.
  2492             88  MA-FROM-CREDIT                VALUE 'CR'.
  2493             88  MA-FROM-VSI                   VALUE 'VS'.
  2494             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2495             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  47
* EL050.cbl
  2496         16  MA-RECORD-ADD-DT              PIC XX.
  2497         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2498         16  MA-LAST-MAINT-DT              PIC XX.
  2499         16  MA-LAST-MAINT-BY              PIC XXXX.
  2500         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2501
  2502     12  MA-PROFILE-INFO.
  2503         16  MA-QUALIFY-CODE-1             PIC XX.
  2504         16  MA-QUALIFY-CODE-2             PIC XX.
  2505         16  MA-QUALIFY-CODE-3             PIC XX.
  2506         16  MA-QUALIFY-CODE-4             PIC XX.
  2507         16  MA-QUALIFY-CODE-5             PIC XX.
  2508
  2509         16  MA-INSURED-LAST-NAME          PIC X(15).
  2510         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2511         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2512         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2513         16  MA-INSURED-BIRTH-DT           PIC XX.
  2514         16  MA-INSURED-SEX                PIC X.
  2515             88  MA-SEX-MALE                   VALUE 'M'.
  2516             88  MA-SEX-FEMALE                 VALUE 'F'.
  2517         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2518
  2519         16  MA-ADDRESS-CORRECTED          PIC X.
  2520         16  MA-JOINT-BIRTH-DT             PIC XX.
  2521*        16  FILLER                        PIC X(12).
  2522
  2523         16  MA-ADDRESS-LINE-1             PIC X(30).
  2524         16  MA-ADDRESS-LINE-2             PIC X(30).
  2525         16  MA-CITY-STATE.
  2526             20  MA-CITY                   PIC X(28).
  2527             20  MA-ADDR-STATE             PIC XX.
  2528         16  MA-ZIP.
  2529             20  MA-ZIP-CODE.
  2530                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2531                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2532                 24  FILLER                PIC X(4).
  2533             20  MA-ZIP-PLUS4              PIC X(4).
  2534         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2535             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2536             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2537             20  FILLER                    PIC X(3).
  2538
  2539         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2540
  2541         16  FILLER                        PIC XXX.
  2542*        16  FILLER                        PIC X(10).
  2543
  2544     12  MA-CRED-BENE-INFO.
  2545         16  MA-CRED-BENE-NAME                 PIC X(25).
  2546         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2547         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2548         16  MA-CRED-BENE-CTYST.
  2549             20  MA-CRED-BENE-CITY             PIC X(28).
  2550             20  MA-CRED-BENE-STATE            PIC XX.
  2551         16  MA-CRED-BENE-ZIP.
  2552             20  MA-CB-ZIP-CODE.
  2553                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  48
* EL050.cbl
  2554                     88  MA-CB-CANADIAN-POST-CODE
  2555                                           VALUE 'A' THRU 'Z'.
  2556                 24  FILLER                    PIC X(4).
  2557             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2558         16  MA-CB-CANADIAN-POSTAL-CODE
  2559                            REDEFINES MA-CRED-BENE-ZIP.
  2560             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2561             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2562             20  FILLER                        PIC X(3).
  2563     12  MA-POST-CARD-MAIL-DATA.
  2564         16  MA-MAIL-DATA OCCURS 7.
  2565             20  MA-MAIL-TYPE              PIC X.
  2566                 88  MA-12MO-MAILING           VALUE '1'.
  2567                 88  MA-EXP-MAILING            VALUE '2'.
  2568             20  MA-MAIL-STATUS            PIC X.
  2569                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2570                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2571                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2572             20  MA-MAIL-DATE              PIC XX.
  2573     12  FILLER                            PIC XX.
  2574     12  FILLER                            PIC XX.
  2575*    12  FILLER                            PIC X(30).
  2576******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  49
* EL050.cbl
  2578*    COPY ERCPNDM.
  2579******************************************************************
  2580*                                                                *
  2581*                                                                *
  2582*                            ERCPNDM                             *
  2583*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2584*                            VMOD=2.003                          *
  2585*                                                                *
  2586*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2587*                                                                *
  2588*   FILE TYPE = VSAM,KSDS                                        *
  2589*   RECORD SIZE = 374   RECFORM = FIX                            *
  2590*                                                                *
  2591*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2592*   ALTERNATE PATH    = NOT USED                                 *
  2593*                                                                *
  2594*   LOG = YES                                                    *
  2595*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2596******************************************************************
  2597*                   C H A N G E   L O G
  2598*
  2599* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2600*-----------------------------------------------------------------
  2601*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2602* EFFECTIVE    NUMBER
  2603*-----------------------------------------------------------------
  2604* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2605* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2606* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2607******************************************************************
  2608
  2609 01  PENDING-MAILING-DATA.
  2610     12  PM-RECORD-ID                      PIC XX.
  2611         88  VALID-MA-ID                       VALUE 'PM'.
  2612
  2613     12  PM-CONTROL-PRIMARY.
  2614         16  PM-COMPANY-CD                 PIC X.
  2615         16  PM-ENTRY-BATCH                PIC X(6).
  2616         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2617         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2618
  2619     12  FILLER                            PIC X(14).
  2620
  2621     12  PM-ACCESS-CONTROL.
  2622         16  PM-SOURCE-SYSTEM              PIC XX.
  2623             88  PM-FROM-CREDIT                VALUE 'CR'.
  2624             88  PM-FROM-VSI                   VALUE 'VS'.
  2625             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2626             88  PM-FROM-OTHER                 VALUE 'OT'.
  2627         16  PM-RECORD-ADD-DT              PIC XX.
  2628         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2629         16  PM-LAST-MAINT-DT              PIC XX.
  2630         16  PM-LAST-MAINT-BY              PIC XXXX.
  2631         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2632
  2633     12  PM-PROFILE-INFO.
  2634         16  PM-QUALIFY-CODE-1             PIC XX.
  2635         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  50
* EL050.cbl
  2636         16  PM-QUALIFY-CODE-3             PIC XX.
  2637         16  PM-QUALIFY-CODE-4             PIC XX.
  2638         16  PM-QUALIFY-CODE-5             PIC XX.
  2639
  2640         16  PM-INSURED-LAST-NAME          PIC X(15).
  2641         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2642         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2643         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2644         16  PM-INSURED-BIRTH-DT           PIC XX.
  2645         16  PM-INSURED-SEX                PIC X.
  2646             88  PM-SEX-MALE                   VALUE 'M'.
  2647             88  PM-SEX-FEMALE                 VALUE 'F'.
  2648         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2649
  2650         16  PM-ADDRESS-CORRECTED          PIC X.
  2651         16  PM-JOINT-BIRTH-DT             PIC XX.
  2652*        16  FILLER                        PIC X(12).
  2653
  2654         16  PM-ADDRESS-LINE-1             PIC X(30).
  2655         16  PM-ADDRESS-LINE-2             PIC X(30).
  2656         16  PM-CITY-STATE.
  2657             20  PM-CITY                   PIC X(28).
  2658             20  PM-STATE                  PIC XX.
  2659         16  PM-ZIP.
  2660             20  PM-ZIP-CODE.
  2661                 24  PM-ZIP-1              PIC X.
  2662                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2663                 24  FILLER                PIC X(4).
  2664             20  PM-ZIP-PLUS4              PIC X(4).
  2665         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2666             20  PM-CAN-POST1              PIC XXX.
  2667             20  PM-CAN-POST2              PIC XXX.
  2668             20  FILLER                    PIC XXX.
  2669
  2670         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2671
  2672         16  FILLER                        PIC X(03).
  2673
  2674     12  PM-CRED-BENE-INFO.
  2675         16  PM-CRED-BENE-NAME             PIC X(25).
  2676         16  PM-CRED-BENE-ADDR             PIC X(30).
  2677         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2678         16  PM-CRED-BENE-CTYST.
  2679             20  PM-CRED-BENE-CITY         PIC X(28).
  2680             20  PM-CRED-BENE-STATE        PIC XX.
  2681         16  PM-CRED-BENE-ZIP.
  2682             20  PM-CB-ZIP-CODE.
  2683                 24  PM-CB-ZIP-1           PIC X.
  2684                     88  PM-CB-CANADIAN-POST-CODE
  2685                                  VALUE 'A' THRU 'Z'.
  2686                 24  FILLER                PIC X(4).
  2687             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2688         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2689             20  PM-CB-CAN-POST1           PIC XXX.
  2690             20  PM-CB-CAN-POST2           PIC XXX.
  2691             20  FILLER                    PIC XXX.
  2692     12  PM-POST-CARD-MAIL-DATA.
  2693         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  51
* EL050.cbl
  2694             20  PM-MAIL-TYPE              PIC X.
  2695                 88  PM-12MO-MAILING           VALUE '1'.
  2696                 88  PM-EXP-MAILING            VALUE '2'.
  2697             20  PM-MAIL-STATUS            PIC X.
  2698                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2699                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2700                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2701             20  PM-MAIL-DATE              PIC XX.
  2702     12  FILLER                            PIC XX.
  2703     12  FILLER                            PIC X(12).
  2704*    12  FILLER                            PIC X(30).
  2705
  2706******************************************************************
  2707*                                COPY ERCLOFC.
  2708******************************************************************
  2709*                                                                *
  2710*                                                                *
  2711*                            ERCLOFC                             *
  2712*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2713*                            VMOD=2.003                          *
  2714*                                                                *
  2715*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2716*                                                                *
  2717*   FILE TYPE = VSAM,KSDS                                        *
  2718*   RECORD SIZE = 670   RECFORM = FIX                            *
  2719*                                                                *
  2720*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2721*                                                                *
  2722*   LOG = YES                                                    *
  2723*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2724*                                                                *
  2725******************************************************************
  2726
  2727 01  LOAN-OFFICER-MASTER.
  2728     12  LO-RECORD-ID                PIC XX.
  2729         88  VALID-LO-ID                VALUE 'LO'.
  2730
  2731     12  LO-CONTROL-PRIMARY.
  2732         16  LO-COMPANY-CD           PIC X.
  2733         16  LO-CARRIER              PIC X.
  2734         16  LO-GROUPING.
  2735             20  LO-GROUPING-PREFIX  PIC XXX.
  2736             20  LO-GROUPING-PRIME   PIC XXX.
  2737         16  LO-STATE                PIC XX.
  2738         16  LO-ACCOUNT.
  2739             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2740             20  LO-ACCOUNT-PRIME    PIC X(6).
  2741         16  LO-OFFICER-CODE         PIC X(5).
  2742
  2743     12  LO-OFFICER-NAME             PIC X(30).
  2744
  2745     12  LO-LAST-MAINT-DT            PIC XX.
  2746     12  LO-LAST-USER                PIC X(4).
  2747     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2748
  2749     12  LO-COMP-CONTROL             PIC X.
  2750             88  LO-SHOW-COMP           VALUE 'Y'.
  2751             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  52
* EL050.cbl
  2752     12  LO-DETAIL-CONTROL           PIC X.
  2753             88  LO-PRINT-DETAIL        VALUE 'D'.
  2754             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2755
  2756     12  LO-SV-CARRIER               PIC X.
  2757     12  LO-SV-GROUPING              PIC X(6).
  2758     12  LO-SV-STATE                 PIC XX.
  2759
  2760     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2761     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2762
  2763     12  LO-OFFICER-INFO.
  2764         16  FILLER OCCURS 12 TIMES.
  2765             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2766             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2767             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2768             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2769             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2770             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2771             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2772             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2773     12  FILLER                      PIC X(198).
  2774******************************************************************
  2775*                                COPY ERCPDEF.
  2776******************************************************************
  2777*                                                                *
  2778*                                                                *
  2779*                            ERCPDEF.                            *
  2780*                                                                *
  2781*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2782*                                                                *
  2783*    FILE TYPE = VSAM,KSDS                                       *
  2784*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2785*                                                                *
  2786*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2787*                                                                *
  2788*    LOG = YES                                                   *
  2789*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2790******************************************************************
  2791*                   C H A N G E   L O G
  2792*
  2793* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2794*-----------------------------------------------------------------
  2795*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2796* EFFECTIVE    NUMBER
  2797*-----------------------------------------------------------------
  2798* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2799* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2800* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2801******************************************************************
  2802 01  PRODUCT-MASTER.
  2803    12  PD-RECORD-ID                 PIC X(02).
  2804        88  VALID-PD-ID                  VALUE 'PD'.
  2805    12  PD-CONTROL-PRIMARY.
  2806        16  PD-COMPANY-CD            PIC X.
  2807        16  PD-STATE                 PIC XX.
  2808        16  PD-PRODUCT-CD            PIC XXX.
  2809        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  53
* EL050.cbl
  2810        16  PD-BEN-TYPE              PIC X.
  2811        16  PD-BEN-CODE              PIC XX.
  2812        16  PD-PROD-EXP-DT           PIC XX.
  2813    12  FILLER                       PIC X(50).
  2814    12  PD-PRODUCT-DATA OCCURS 8.
  2815        16  PD-PROD-CODE             PIC X.
  2816            88  PD-PROD-LIFE           VALUE 'L'.
  2817            88  PD-PROD-PROP           VALUE 'P'.
  2818            88  PD-PROD-AH             VALUE 'A'.
  2819            88  PD-PROD-IU             VALUE 'I'.
  2820            88  PD-PROD-GAP            VALUE 'G'.
  2821            88  PD-PROD-FAML           VALUE 'F'.
  2822        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2823        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2824        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2825        16  PD-MAX-TERM              PIC S999        COMP-3.
  2826        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2827        16  FILLER                   PIC X.
  2828        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2829        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2830        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2831        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2832        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2833        16  PD-REC-CRIT-PERIOD       PIC 99.
  2834        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2835            20  PD-RECURRING-YN      PIC X.
  2836            20  FILLER               PIC X.
  2837        16  PD-RTW-MOS               PIC 99.
  2838        16  PD-MAX-EXTENSION         PIC 99.
  2839        16  pd-ben-pct               pic sv999 comp-3.
  2840*       16  FILLER                   PIC XX.
  2841    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2842    12  PD-TERM-LIMITS OCCURS 15.
  2843        16  PD-LOW-TERM              PIC S999        COMP-3.
  2844        16  PD-HI-TERM               PIC S999        COMP-3.
  2845*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2846    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2847        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2848        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2849    12  PD-EARN-FACTORS.
  2850        16  FILLER OCCURS 15.
  2851            20  FILLER OCCURS 15.
  2852                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2853    12  PD-PRODUCT-DESC              PIC X(80).
  2854    12  PD-TRUNCATED                 PIC X.
  2855    12  FILLER                       PIC X(59).
  2856    12  PD-MAINT-INFORMATION.
  2857        16  PD-LAST-MAINT-DT         PIC X(02).
  2858        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2859        16  PD-LAST-MAINT-BY         PIC X(04).
  2860*                                COPY ELCSTATE.
  2861******************************************************************
  2862*                                                                *
  2863*                                                                *
  2864*                            ELCSTATE.                           *
  2865*                                                                *
  2866*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2867*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  54
* EL050.cbl
  2868*   FILE TYPE = VSAM,KSDS                                        *
  2869*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2870*                                                                *
  2871*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2872*       ALTERNATE INDEX = NONE                                   *
  2873*                                                                *
  2874*   LOG = YES                                                    *
  2875*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2876******************************************************************
  2877*                   C H A N G E   L O G
  2878*
  2879* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2880*-----------------------------------------------------------------
  2881*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2882* EFFECTIVE    NUMBER
  2883*-----------------------------------------------------------------
  2884* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2885******************************************************************
  2886*
  2887 01  STATE-FILE.
  2888     12  SF-RECORD-ID                       PIC XX.
  2889         88  VALID-CF-ID                        VALUE 'SF'.
  2890     12  SF-CONTROL-PRIMARY.
  2891         16  SF-COMPANY-ID                  PIC XXX.
  2892         16  SF-CARRIER-CODE                PIC X.
  2893         16  SF-GROUPING                    PIC X(6).
  2894         16  SF-STATE-CODE                  PIC XX.
  2895         16  SF-EXPIRE-DATE                 PIC 9(8).
  2896****************************************************************
  2897*             STATE CONTROLS
  2898****************************************************************
  2899     12  SF-LAST-MAINT-DT                   PIC XX.
  2900     12  SF-LAST-MAINT-BY                   PIC X(4).
  2901     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2902     12  SF-STATE-RT-CONTROLS.
  2903         16  SF-ST-RT-CALC                  PIC X.
  2904     12  SF-ST-TAX-CONTROLS.
  2905         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2906         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2907         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2908     12  SF-ST-REFUND-OPTIONS.
  2909         16  SF-ST-RF-LR-CALC               PIC X.
  2910         16  SF-ST-RF-LL-CALC               PIC X.
  2911         16  SF-ST-RF-LN-CALC               PIC X.
  2912         16  SF-ST-RF-AH-CALC               PIC X.
  2913         16  SF-ST-RF-CP-CALC               PIC X.
  2914     12  SF-ST-UNEARN-PREM-OPTIONS.
  2915         16  SF-ST-LUEP-R78                 PIC X.
  2916         16  SF-ST-LUEP-PRO                 PIC X.
  2917         16  SF-ST-LUEP-ST                  PIC X.
  2918         16  SF-ST-LUEP-DOM                 PIC X.
  2919         16  SF-ST-AUEP-R78                 PIC X.
  2920         16  SF-ST-AUEP-PRO                 PIC X.
  2921         16  SF-ST-AUEP-ST                  PIC X.
  2922         16  SF-ST-AUEP-DOM                 PIC X.
  2923         16  SF-ST-CUEP-R78                 PIC X.
  2924         16  SF-ST-CUEP-PRO                 PIC X.
  2925         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  55
* EL050.cbl
  2926         16  SF-ST-CUEP-DOM                 PIC X.
  2927     12  SF-ST-EARN-PREM-OPTIONS.
  2928         16  SF-ST-LEP-R78                  PIC X.
  2929         16  SF-ST-LEP-PRO                  PIC X.
  2930         16  SF-ST-LEP-ST                   PIC X.
  2931         16  SF-ST-LEP-DOM                  PIC X.
  2932         16  SF-ST-AEP-R78                  PIC X.
  2933         16  SF-ST-AEP-PRO                  PIC X.
  2934         16  SF-ST-AEP-ST                   PIC X.
  2935         16  SF-ST-AEP-DOM                  PIC X.
  2936         16  SF-ST-CEP-R78                  PIC X.
  2937         16  SF-ST-CEP-PRO                  PIC X.
  2938         16  SF-ST-CEP-ST                   PIC X.
  2939         16  SF-ST-CEP-DOM                  PIC X.
  2940     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  56
* EL050.cbl
  2942*    COPY ELCCRTT.
  2943******************************************************************
  2944*                                                                *
  2945*                            ELCCRTT.                            *
  2946*                                                                *
  2947*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2948*                                                                *
  2949*   FILE TYPE = VSAM,KSDS                                        *
  2950*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2951*                                                                *
  2952*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2953*                                                                *
  2954*   LOG = YES                                                    *
  2955*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2956******************************************************************
  2957*                   C H A N G E   L O G
  2958*
  2959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2960*-----------------------------------------------------------------
  2961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2962* EFFECTIVE    NUMBER
  2963*-----------------------------------------------------------------
  2964* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2965* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2966* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2967* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2968* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2969* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2970* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2971* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2972* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2973******************************************************************
  2974
  2975 01  CERTIFICATE-TRAILERS.
  2976     12  CS-RECORD-ID                      PIC XX.
  2977         88  VALID-CS-ID                      VALUE 'CS'.
  2978
  2979     12  CS-CONTROL-PRIMARY.
  2980         16  CS-COMPANY-CD                 PIC X.
  2981         16  CS-CARRIER                    PIC X.
  2982         16  CS-GROUPING                   PIC X(6).
  2983         16  CS-STATE                      PIC XX.
  2984         16  CS-ACCOUNT                    PIC X(10).
  2985         16  CS-CERT-EFF-DT                PIC XX.
  2986         16  CS-CERT-NO.
  2987             20  CS-CERT-PRIME             PIC X(10).
  2988             20  CS-CERT-SFX               PIC X.
  2989         16  CS-TRAILER-TYPE               PIC X.
  2990             88  COMM-TRLR           VALUE 'A'.
  2991             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2992             88  CERT-DATA-TRLR      VALUE 'C'.
  2993
  2994     12  CS-DATA-AREA                      PIC X(516).
  2995
  2996     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2997         16  CS-BANK-COMMISSION-AREA.
  2998             20  CS-BANK-COMMS       OCCURS 10.
  2999                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  57
* EL050.cbl
  3000                 24  CS-COM-TYP            PIC X.
  3001                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3002                 24  CS-RECALC-LV-INDIC    PIC X.
  3003                 24  FILLER                PIC X(10).
  3004         16  FILLER                        PIC X(256).
  3005
  3006     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3007****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3008         16  CS-MB-CLAIM-DATA OCCURS 24.
  3009             20  CS-CLAIM-NO               PIC X(7).
  3010             20  CS-CLAIM-TYPE             PIC X.
  3011                 88  CS-AH-CLM               VALUE 'A'.
  3012                 88  CS-IU-CLM               VALUE 'I'.
  3013                 88  CS-GP-CLM               VALUE 'G'.
  3014                 88  CS-LF-CLM               VALUE 'L'.
  3015                 88  CS-PR-CLM               VALUE 'P'.
  3016                 88  CS-FL-CLM               VALUE 'F'.
  3017             20  CS-INSURED-TYPE           PIC X.
  3018                 88  CS-PRIM-INSURED          VALUE 'P'.
  3019                 88  CS-CO-BORROWER           VALUE 'C'.
  3020             20  CS-BENEFIT-PERIOD         PIC 99.
  3021             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3022             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3023             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3024         16  FILLER                        PIC X(12).
  3025     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3026         16  CS-VIN-NUMBER                 PIC X(17).
  3027         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3028         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3029         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3030         16  cs-agent-name.
  3031             20  cs-agent-fname            pic x(20).
  3032             20  cs-agent-mi               pic x.
  3033             20  cs-agent-lname            pic x(25).
  3034         16  cs-license-no                 pic x(15).
  3035         16  cs-npn-number                 pic x(10).
  3036         16  cs-agent-edit-status          pic x.
  3037             88  cs-ae-refer-to-manager      value 'M'.
  3038             88  cs-ae-cover-sheet           value 'C'.
  3039             88  cs-ae-sig-form              value 'S'.
  3040             88  cs-ae-verified              value 'V'.
  3041             88  cs-unidentified-signature   value 'U'.
  3042             88  cs-cert-returned            value 'R'.
  3043             88  cs-accept-no-commission     value 'N'.
  3044         16  cs-year                       pic 9999.
  3045         16  cs-make                       pic x(20).
  3046         16  cs-model                      pic x(20).
  3047         16  cs-future                     pic x(20).
  3048         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3049         16  FILLER                        PIC X(356). *> was 420
  3050*        16  FILLER                        PIC X(496).
  3051*    COPY ELCCRTO.
  3052******************************************************************
  3053*                                                                *
  3054*                            ELCCRTO.                            *
  3055*                                                                *
  3056*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3057*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  58
* EL050.cbl
  3058*   FILE TYPE = VSAM,KSDS                                        *
  3059*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3060*                                                                *
  3061*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3062*                                                                *
  3063*   LOG = YES                                                    *
  3064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3065******************************************************************
  3066*                   C H A N G E   L O G
  3067*
  3068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3069*-----------------------------------------------------------------
  3070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3071* EFFECTIVE    NUMBER
  3072*-----------------------------------------------------------------
  3073* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3074* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3075* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3076* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3077* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3078******************************************************************
  3079 01  ORIGINAL-CERTIFICATE.
  3080     12  OC-RECORD-ID                      PIC XX.
  3081         88  VALID-OC-ID                      VALUE 'OC'.
  3082     12  OC-CONTROL-PRIMARY.
  3083         16  OC-COMPANY-CD                 PIC X.
  3084         16  OC-CARRIER                    PIC X.
  3085         16  OC-GROUPING                   PIC X(6).
  3086         16  OC-STATE                      PIC XX.
  3087         16  OC-ACCOUNT                    PIC X(10).
  3088         16  OC-CERT-EFF-DT                PIC XX.
  3089         16  OC-CERT-NO.
  3090             20  OC-CERT-PRIME             PIC X(10).
  3091             20  OC-CERT-SFX               PIC X.
  3092         16  OC-RECORD-TYPE                PIC X.
  3093         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3094     12  OC-LAST-MAINT-DT                  PIC XX.
  3095     12  OC-LAST-MAINT-BY                  PIC X(4).
  3096     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3097     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3098     12  FILLER                            PIC X(49).
  3099     12  OC-ORIG-REC.
  3100         16  OC-INS-LAST-NAME              PIC X(15).
  3101         16  OC-INS-FIRST-NAME             PIC X(10).
  3102         16  OC-INS-MIDDLE-INIT            PIC X.
  3103         16  OC-INS-AGE                    PIC S999     COMP-3.
  3104         16  OC-JNT-LAST-NAME              PIC X(15).
  3105         16  OC-JNT-FIRST-NAME             PIC X(10).
  3106         16  OC-JNT-MIDDLE-INIT            PIC X.
  3107         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3108         16  OC-LF-BENCD                   PIC XX.
  3109         16  OC-LF-TERM                    PIC S999      COMP-3.
  3110         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3111         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3112         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3113         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3114         16  OC-LF-EXP-DT                  PIC XX.
  3115         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  59
* EL050.cbl
  3116         16  OC-LF-CANCEL-DT               PIC XX.
  3117         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3118         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3119         16  OC-AH-BENCD                   PIC XX.
  3120         16  OC-AH-TERM                    PIC S999      COMP-3.
  3121         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3122         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3123         16  OC-AH-EXP-DT                  PIC XX.
  3124         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3125         16  OC-AH-CP                      PIC 99.
  3126         16  OC-AH-CANCEL-DT               PIC XX.
  3127         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3128         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3129         16  OC-CRED-BENE-NAME             PIC X(25).
  3130         16  OC-1ST-PMT-DT                 PIC XX.
  3131         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3132         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3133         16  OC-ISSUE-TRAN-IND             PIC X.
  3134         16  OC-CANCEL-TRAN-IND            PIC X.
  3135         16  FILLER                        PIC X(211).
  3136
  3137     12  FILLER                            PIC X(50).
  3138******************************************************************
  3139
  3140*    COPY ELCDATE.
  3141******************************************************************
  3142*                                                                *
  3143*                                                                *
  3144*                            ELCDATE.                            *
  3145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3146*                            VMOD=2.003
  3147*                                                                *
  3148*                                                                *
  3149*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3150*                 LENGTH = 200                                   *
  3151******************************************************************
  3152
  3153 01  DATE-CONVERSION-DATA.
  3154     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3155     12  DC-OPTION-CODE                PIC X.
  3156         88  BIN-TO-GREG                VALUE ' '.
  3157         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3158         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3159         88  YMD-GREG-TO-BIN            VALUE '3'.
  3160         88  MDY-GREG-TO-BIN            VALUE '4'.
  3161         88  JULIAN-TO-BIN              VALUE '5'.
  3162         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3163         88  FIND-CENTURY               VALUE '7'.
  3164         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3165         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3166         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3167         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3168         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3169         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3170         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3171         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3172         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3173         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  60
* EL050.cbl
  3174         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3175         88  BIN-3-TO-GREG              VALUE 'I'.
  3176         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3177         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3178         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3179         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3180         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3181         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3182         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3183         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3184         88  THREE-CHARACTER-BIN
  3185                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3186         88  GREGORIAN-TO-BIN
  3187                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3188         88  BIN-TO-GREGORIAN
  3189                  VALUES ' ' '1' 'I' '8' 'G'.
  3190         88  JULIAN-TO-BINARY
  3191                  VALUES '5' 'C' 'E' 'F'.
  3192     12  DC-ERROR-CODE                 PIC X.
  3193         88  NO-CONVERSION-ERROR        VALUE ' '.
  3194         88  DATE-CONVERSION-ERROR
  3195                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3196         88  DATE-IS-ZERO               VALUE '1'.
  3197         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3198         88  DATE-IS-INVALID            VALUE '3'.
  3199         88  DATE1-GREATER-DATE2        VALUE '4'.
  3200         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3201         88  DATE-INVALID-OPTION        VALUE '9'.
  3202         88  INVALID-CENTURY            VALUE 'A'.
  3203         88  ONLY-CENTURY               VALUE 'B'.
  3204         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3205         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3206     12  DC-END-OF-MONTH               PIC X.
  3207         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3208     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3209         88  USE-NORMAL-PROCESS         VALUE ' '.
  3210         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3211         88  ADJUST-UP-100-YRS          VALUE '2'.
  3212     12  FILLER                        PIC X.
  3213     12  DC-CONVERSION-DATES.
  3214         16  DC-BIN-DATE-1             PIC XX.
  3215         16  DC-BIN-DATE-2             PIC XX.
  3216         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3217         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3218                       DC-GREG-DATE-1-EDIT.
  3219             20  DC-EDIT1-MONTH        PIC 99.
  3220             20  SLASH1-1              PIC X.
  3221             20  DC-EDIT1-DAY          PIC 99.
  3222             20  SLASH1-2              PIC X.
  3223             20  DC-EDIT1-YEAR         PIC 99.
  3224         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3225         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3226                     DC-GREG-DATE-2-EDIT.
  3227             20  DC-EDIT2-MONTH        PIC 99.
  3228             20  SLASH2-1              PIC X.
  3229             20  DC-EDIT2-DAY          PIC 99.
  3230             20  SLASH2-2              PIC X.
  3231             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  61
* EL050.cbl
  3232         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3233         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3234                     DC-GREG-DATE-1-YMD.
  3235             20  DC-YMD-YEAR           PIC 99.
  3236             20  DC-YMD-MONTH          PIC 99.
  3237             20  DC-YMD-DAY            PIC 99.
  3238         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3239         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3240                      DC-GREG-DATE-1-MDY.
  3241             20  DC-MDY-MONTH          PIC 99.
  3242             20  DC-MDY-DAY            PIC 99.
  3243             20  DC-MDY-YEAR           PIC 99.
  3244         16  DC-GREG-DATE-1-ALPHA.
  3245             20  DC-ALPHA-MONTH        PIC X(10).
  3246             20  DC-ALPHA-DAY          PIC 99.
  3247             20  FILLER                PIC XX.
  3248             20  DC-ALPHA-CENTURY.
  3249                 24 DC-ALPHA-CEN-N     PIC 99.
  3250             20  DC-ALPHA-YEAR         PIC 99.
  3251         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3252         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3253         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3254         16  DC-JULIAN-DATE            PIC 9(05).
  3255         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3256                                       PIC 9(05).
  3257         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3258             20  DC-JULIAN-YEAR        PIC 99.
  3259             20  DC-JULIAN-DAYS        PIC 999.
  3260         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3261         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3262         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3263     12  DATE-CONVERSION-VARIBLES.
  3264         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3265         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3266             20  FILLER                PIC 9(3).
  3267             20  HOLD-CEN-1-CCYY.
  3268                 24  HOLD-CEN-1-CC     PIC 99.
  3269                 24  HOLD-CEN-1-YY     PIC 99.
  3270             20  HOLD-CEN-1-MO         PIC 99.
  3271             20  HOLD-CEN-1-DA         PIC 99.
  3272         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3273             20  HOLD-CEN-1-R-MO       PIC 99.
  3274             20  HOLD-CEN-1-R-DA       PIC 99.
  3275             20  HOLD-CEN-1-R-CCYY.
  3276                 24  HOLD-CEN-1-R-CC   PIC 99.
  3277                 24  HOLD-CEN-1-R-YY   PIC 99.
  3278             20  FILLER                PIC 9(3).
  3279         16  HOLD-CENTURY-1-X.
  3280             20  FILLER                PIC X(3)  VALUE SPACES.
  3281             20  HOLD-CEN-1-X-CCYY.
  3282                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3283                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3284             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3285             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3286         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3287             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3288             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3289             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  62
* EL050.cbl
  3290                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3291                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3292             20  FILLER                PIC XXX.
  3293         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3294         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3295         16  DC-JULIAN-DATE-1          PIC 9(07).
  3296         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3297             20  DC-JULIAN-1-CCYY.
  3298                 24  DC-JULIAN-1-CC    PIC 99.
  3299                 24  DC-JULIAN-1-YR    PIC 99.
  3300             20  DC-JULIAN-DA-1        PIC 999.
  3301         16  DC-JULIAN-DATE-2          PIC 9(07).
  3302         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3303             20  DC-JULIAN-2-CCYY.
  3304                 24  DC-JULIAN-2-CC    PIC 99.
  3305                 24  DC-JULIAN-2-YR    PIC 99.
  3306             20  DC-JULIAN-DA-2        PIC 999.
  3307         16  DC-GREG-DATE-A-EDIT.
  3308             20  DC-EDITA-MONTH        PIC 99.
  3309             20  SLASHA-1              PIC X VALUE '/'.
  3310             20  DC-EDITA-DAY          PIC 99.
  3311             20  SLASHA-2              PIC X VALUE '/'.
  3312             20  DC-EDITA-CCYY.
  3313                 24  DC-EDITA-CENT     PIC 99.
  3314                 24  DC-EDITA-YEAR     PIC 99.
  3315         16  DC-GREG-DATE-B-EDIT.
  3316             20  DC-EDITB-MONTH        PIC 99.
  3317             20  SLASHB-1              PIC X VALUE '/'.
  3318             20  DC-EDITB-DAY          PIC 99.
  3319             20  SLASHB-2              PIC X VALUE '/'.
  3320             20  DC-EDITB-CCYY.
  3321                 24  DC-EDITB-CENT     PIC 99.
  3322                 24  DC-EDITB-YEAR     PIC 99.
  3323         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3324         16  DC-GREG-DATE-CYMD-R REDEFINES
  3325                              DC-GREG-DATE-CYMD.
  3326             20  DC-CYMD-CEN           PIC 99.
  3327             20  DC-CYMD-YEAR          PIC 99.
  3328             20  DC-CYMD-MONTH         PIC 99.
  3329             20  DC-CYMD-DAY           PIC 99.
  3330         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3331         16  DC-GREG-DATE-MDCY-R REDEFINES
  3332                              DC-GREG-DATE-MDCY.
  3333             20  DC-MDCY-MONTH         PIC 99.
  3334             20  DC-MDCY-DAY           PIC 99.
  3335             20  DC-MDCY-CEN           PIC 99.
  3336             20  DC-MDCY-YEAR          PIC 99.
  3337    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3338        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3339    12  DC-EL310-DATE                  PIC X(21).
  3340    12  FILLER                         PIC X(28).
  3341
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  63
* EL050.cbl
  3343*    COPY ELCCALC.
  3344******************************************************************
  3345*                                                                *
  3346*                           ELCCALC.                            *
  3347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3348*                            VMOD=2.025                          *
  3349*                                                                *
  3350*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3351*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3352*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3353*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3354*                                                                *
  3355*  PASSED TO ELRTRM                                              *
  3356*  -----------------                                             *
  3357*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3358*  ORIGINAL TERM                                                 *
  3359*  BEGINNING DATE                                                *
  3360*  ENDING DATE                                                   *
  3361*  COMPANY I.D.                                                  *
  3362*  ACCOUNT MASTER USER FIELD                                     *
  3363*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3364*  FREE LOOK DAYS                                                *
  3365*                                                                *
  3366*  RETURNED FROM ELRTRM                                          *
  3367*  ---------------------                                         *
  3368*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3369*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3370*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3371*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3372*----------------------------------------------------------------*
  3373*  PASSED TO ELRAMT                                              *
  3374*  ----------------                                              *
  3375*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3376*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3377*  ORIGINAL AMOUNT                                               *
  3378*  ALTERNATE BENEFIT (BALLON)                                    *
  3379*  A.P.R. - NET PAY ONLY                                         *
  3380*  METHOD
  3381*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3382*  COMPANY I.D.                                                  *
  3383*  BENEFIT TYPE                                                  *
  3384*                                                                *
  3385*  RETURNED FROM ELRAMT                                          *
  3386*  --------------------                                          *
  3387*  REMAINING AMOUNT 1 - CURRENT                                  *
  3388*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3389*  REMAINING AMOUNT FACTOR
  3390*----------------------------------------------------------------*
  3391*  PASSED TO ELRESV                                              *
  3392*  -----------------                                             *
  3393*  CERTIFICATE EFFECTIVE DATE                                    *
  3394*  VALUATION DATE                                                *
  3395*  PAID THRU DATE                                                *
  3396*  BENEFIT                                                       *
  3397*  INCURRED DATE                                                 *
  3398*  REPORTED DATE                                                 *
  3399*  ISSUE AGE                                                     *
  3400*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  64
* EL050.cbl
  3401*  CDT PERCENT                                                   *
  3402*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3403* *CLAIM TYPE (LIFE, A/H)                                        *
  3404* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3405* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3406*                                                                *
  3407*  RETURNED FROM ELRESV                                          *
  3408*  --------------------                                          *
  3409*  CDT TABLE USED                                                *
  3410*  CDT FACTOR USED                                               *
  3411*  PAY TO CURRENT RESERVE                                        *
  3412*  I.B.N.R. - A/H ONLY                                           *
  3413*  FUTURE (ACCRUED) AH ONLY                                      *
  3414*----------------------------------------------------------------*
  3415*  PASSED TO ELRATE                                              *
  3416*  ----------------                                              *
  3417*  CERT ISSUE DATE                                               *
  3418*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3419*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3420*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3421*  STATE CODE (CLIENT DEFINED)                                   *
  3422*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3423*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3424*  DEVIATION CODE                                                *
  3425*  ISSUE AGE                                                     *
  3426*  ORIGINAL BENEFIT AMOUNT                                       *
  3427*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3428*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3429*  BENEFIT KIND (LIFE OR A/H)                                    *
  3430*  A.P.R.                                                        *
  3431*  METHOD
  3432*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3433*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3434*  COMPANY I.D. (3 CHARACTER)                                    *
  3435*  BENEFIT CODE                                                  *
  3436*  BENEFIT OVERRIDE CODE                                         *
  3437*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3438*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3439*  JOINT INDICATOR (CSL ONLY)                                    *
  3440*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3441*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3442*                                                                *
  3443*  RETURNED FROM ELRATE                                          *
  3444*  --------------------                                          *
  3445*  CALCULATED PREMIUM                                            *
  3446*  PREMIUM RATE                                                  *
  3447*  MORTALITY CODE                                                *
  3448*  MAX ATTAINED AGE                                              *
  3449*  MAX AGE                                                       *
  3450*  MAX TERM                                                      *
  3451*  MAX MONTHLY BENEFIT                                           *
  3452*  MAX TOTAL BENIFIT                                             *
  3453*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3454*----------------------------------------------------------------*
  3455*  PASSED TO ELRFND                                              *
  3456*  ----------------                                              *
  3457*  CERT ISSUE DATE                                               *
  3458*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  65
* EL050.cbl
  3459*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3460*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3461*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3462*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3463*  STATE CODE (CLIENT DEFINED)                                   *
  3464*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3465*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3466*  DEVIATION CODE                                                *
  3467*  ISSUE AGE                                                     *
  3468*  ORIGINAL BENEFIT AMOUNT                                       *
  3469*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3470*  PROCESS TYPE (CANCEL)                                         *
  3471*  BENEFIT KIND (LIFE OR A/H)                                    *
  3472*  A.P.R.                                                        *
  3473*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3474*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3475*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3476*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3477*  COMPANY I.D. (3 CHARACTER)                                    *
  3478*  BENEFIT CODE                                                  *
  3479*  BENEFIT OVERRIDE CODE                                         *
  3480*                                                                *
  3481*  RETURNED FROM ELRFND                                          *
  3482*  --------------------                                          *
  3483*  CALCULATED REFUND                                             *
  3484*----------------------------------------------------------------*
  3485*  PASSED TO ELEARN                                              *
  3486*  ----------------                                              *
  3487*  CERT ISSUE DATE                                               *
  3488*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3489*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3490*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3491*  STATE CODE (CLIENT DEFINED)                                   *
  3492*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3493*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3494*  DEVIATION CODE                                                *
  3495*  ISSUE AGE                                                     *
  3496*  ORIGINAL BENEFIT AMOUNT                                       *
  3497*  BENEFIT KIND (LIFE OR A/H)                                    *
  3498*  A.P.R.                                                        *
  3499*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3500*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3501*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3502*  COMPANY I.D. (3 CHARACTER)                                    *
  3503*  BENEFIT CODE                                                  *
  3504*  BENEFIT OVERRIDE CODE                                         *
  3505*                                                                *
  3506*  RETURNED FROM ELEARN                                          *
  3507*  --------------------                                          *
  3508*  INDICATED  EARNINGS                                           *
  3509*----------------------------------------------------------------*
  3510*                 LENGTH = 450                                   *
  3511*                                                                *
  3512******************************************************************
  3513******************************************************************
  3514*                   C H A N G E   L O G
  3515*
  3516* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  66
* EL050.cbl
  3517*-----------------------------------------------------------------
  3518*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3519* EFFECTIVE    NUMBER
  3520*-----------------------------------------------------------------
  3521* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3522* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3523* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3524* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3525* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3526* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3527* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3528* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3529* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3530* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3531* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3532******************************************************************
  3533
  3534 01  CALCULATION-PASS-AREA.
  3535     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3536                                     COMP.
  3537
  3538     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3539       88  NO-CP-ERROR                             VALUE ZERO.
  3540       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3541                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3542       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3543       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3544       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3545       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3546       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3547       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3548       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3549       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3550       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3551       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3552       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3553       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3554       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3555       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3556       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3557       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3558       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3559
  3560     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3561       88  NO-CP-ERROR-2                           VALUE ZERO.
  3562***********************  INPUT AREAS ****************************
  3563
  3564     12  CP-CALCULATION-AREA.
  3565         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3566         16  CP-CERT-EFF-DT        PIC XX.
  3567         16  CP-VALUATION-DT       PIC XX.
  3568         16  CP-PAID-THRU-DT       PIC XX.
  3569         16  CP-BENEFIT-TYPE       PIC X.
  3570           88  CP-AH                               VALUE 'A' 'D'
  3571                                                   'I' 'U'.
  3572           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3573           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3574         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  67
* EL050.cbl
  3575         16  CP-REPORTED-DT        PIC XX.
  3576         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3577         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3578         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3579                                     COMP-3.
  3580         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3581                                     COMP-3.
  3582         16  CP-CDT-METHOD         PIC X.
  3583           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3584           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3585           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3586         16  CP-CLAIM-TYPE         PIC X.
  3587           88  CP-AH-CLAIM                         VALUE 'A'.
  3588           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3589         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3596                                     COMP-3.
  3597         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3598                                     COMP-3.
  3599         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3602                                     COMP-3.
  3603         16  CP-REM-TERM-METHOD    PIC X.
  3604           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3605           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3606           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3607           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3608           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3609           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3610           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3611         16  CP-EARNING-METHOD     PIC X.
  3612           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3613           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3614           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3615           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3616           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3617           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3618           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3619           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3620           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3621           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3622           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3623           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3624           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3625           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3626         16  CP-PROCESS-TYPE       PIC X.
  3627           88  CP-CLAIM                            VALUE '1'.
  3628           88  CP-CANCEL                           VALUE '2'.
  3629           88  CP-ISSUE                            VALUE '3'.
  3630         16  CP-SPECIAL-CALC-CD    PIC X.
  3631           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3632           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  68
* EL050.cbl
  3633           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3634           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3635           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3636           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3637           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3638           88  CP-FARM-PLAN                    VALUE 'F'.
  3639           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3640           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3641           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3642           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3643           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3644           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3645           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3646           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3647           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3648           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3649                                                     'W' 'X'.
  3650           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3651           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3652           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3653           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3654           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3655           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3656           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3657           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3658           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3659           88  CP-CSL-METH-1                   VALUE '5'.
  3660           88  CP-CSL-METH-2                   VALUE '6'.
  3661           88  CP-CSL-METH-3                   VALUE '7'.
  3662           88  CP-CSL-METH-4                   VALUE '8'.
  3663
  3664         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3667         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3668         16  CP-STATE              PIC XX          VALUE SPACE.
  3669         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3670         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3671           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3672               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3673         16  CP-R78-OPTION         PIC X.
  3674           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3675           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3676
  3677         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3678         16  CP-IBNR-RESERVE-SW    PIC X.
  3679         16  CP-CLAIM-STATUS       PIC X.
  3680         16  CP-RATE-FILE          PIC X.
  3681         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3682                                     COMP-3.
  3683
  3684         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3685         16  CP-AH-OVERRIDE-CODE   PIC X.
  3686
  3687         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3688                                     COMP-3.
  3689         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3690                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  69
* EL050.cbl
  3691         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3698                                  PIC S9(7)V99 COMP-3.
  3699
  3700         16  CP-PAID-FROM-DATE     PIC X(02).
  3701         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3702         16  CP-EXT-DAYS-CALC      PIC X.
  3703           88  CP-EXT-NO-CHG                   VALUE ' '.
  3704           88  CP-EXT-CHG-LF                   VALUE '1'.
  3705           88  CP-EXT-CHG-AH                   VALUE '2'.
  3706           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3707         16  CP-DOMICILE-STATE     PIC XX.
  3708         16  CP-CARRIER            PIC X.
  3709         16  CP-REIN-FLAG          PIC X.
  3710         16  CP-REM-TRM-CALC-OPTION PIC X.
  3711           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3712                      '2' '3' '4' '5'.
  3713           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3714           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3715           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3716           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3717           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3718           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3719           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3720           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3721         16  CP-SIG-SWITCH         PIC X.
  3722         16  CP-RATING-METHOD      PIC X.
  3723           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3724           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3725           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3726           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3727           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3728           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3729           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3730           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3731           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3732         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3733                                     COMP-3.
  3734         16  CP-BEN-CATEGORY       PIC X.
  3735         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3736         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3737                                   PIC S99V9(5) COMP-3.
  3738         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3739         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3740                                   PIC S99V9(5) COMP-3.
  3741         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3742         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3743         16  CP-EXPIRE-DT          PIC XX.
  3744         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3745         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3746         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3747         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3748         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  70
* EL050.cbl
  3749             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3750             88  CP-CALC-CLP              VALUE 'C'.
  3751         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3752         16  CP-CANCEL-REASON      PIC X.
  3753         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3754         16  CP-PMT-MODE           PIC X.
  3755         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3756         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3757         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3758         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3759         16  FILLER                PIC X.
  3760
  3761***************    OUTPUT FROM ELRESV   ************************
  3762
  3763         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3764
  3765         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  FILLER                PIC X(09).
  3774***************    OUTPUT FROM ELRTRM   *************************
  3775
  3776         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3783                                     COMP-3.
  3784         16  FILLER                PIC X(12).
  3785
  3786***************    OUTPUT FROM ELRAMT   *************************
  3787
  3788         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3789                                     COMP-3.
  3790         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3791                                     COMP-3.
  3792         16  FILLER                PIC X(12).
  3793
  3794***************    OUTPUT FROM ELRATE   *************************
  3795
  3796         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3797                                     COMP-3.
  3798         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3799                                     COMP-3.
  3800         16  CP-MORTALITY-CODE     PIC X(4).
  3801         16  CP-RATE-EDIT-FLAG     PIC X.
  3802             88  CP-RATES-NEED-APR                  VALUE '1'.
  3803         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3804                                     COMP-3.
  3805         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3806         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  71
* EL050.cbl
  3807         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3808                                   PIC S9(7)V99 COMP-3.
  3809         16  FILLER                PIC X(07).
  3810
  3811***************    OUTPUT FROM ELRFND   *************************
  3812
  3813         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3814                                     COMP-3.
  3815         16  CP-REFUND-TYPE-USED   PIC X.
  3816           88  CP-R-AS-R78                         VALUE '1'.
  3817           88  CP-R-AS-PRORATA                     VALUE '2'.
  3818           88  CP-R-AS-CALIF                       VALUE '3'.
  3819           88  CP-R-AS-TEXAS                       VALUE '4'.
  3820           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3821           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3822           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3823           88  CP-R-AS-MEAN                        VALUE '8'.
  3824           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3825           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3826           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3827           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3828           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3829           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3830         16  FILLER                PIC X(12).
  3831
  3832***************    OUTPUT FROM ELEARN   *************************
  3833
  3834         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3839                                     COMP-3.
  3840         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3841                                     COMP-3.
  3842         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3843                                     COMP-3.
  3844         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3845                                     COMP-3.
  3846         16  CP-EARNING-TYPE-USED  PIC X.
  3847           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3848           88  CP-E-AS-R78                         VALUE '1'.
  3849           88  CP-E-AS-PRORATA                     VALUE '2'.
  3850           88  CP-E-AS-TEXAS                       VALUE '4'.
  3851           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3852           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3853           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3854           88  CP-E-AS-MEAN                        VALUE '8'.
  3855           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3856         16  FILLER                PIC X(12).
  3857
  3858***************    OUTPUT FROM ELPMNT   *************************
  3859
  3860         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3861                                     COMP-3.
  3862         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3863                                     COMP-3.
  3864         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  72
* EL050.cbl
  3865
  3866***************   MISC WORK AREAS    *****************************
  3867         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3868                                     COMP-3.
  3869         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3870                                     COMP-3.
  3871         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3872                                     COMP-3.
  3873         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3876                                     COMP-3.
  3877         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3878                                     COMP-3.
  3879         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3880             88  OPEN-RATE-FILE                   VALUE 'O'.
  3881             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3882             88  IO-ERROR                         VALUE 'E'.
  3883
  3884         16  CP-FIRST-PAY-DATE     PIC XX.
  3885
  3886         16  CP-JOINT-INDICATOR    PIC X.
  3887
  3888         16  CP-RESERVE-REMAINING-TERM
  3889                                   PIC S9(4)V9    VALUE ZERO
  3890                                     COMP-3.
  3891
  3892         16  CP-INSURED-BIRTH-DT   PIC XX.
  3893
  3894         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3895                                     COMP-3.
  3896
  3897         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3898                                     COMP-3.
  3899
  3900         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3901                                     COMP-3.
  3902
  3903         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3904                                     COMP-3.
  3905
  3906         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3907                                     COMP-3.
  3908
  3909         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3910                                     COMP-3.
  3911
  3912         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3913                                     COMP-3.
  3914
  3915         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3916             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3917
  3918         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  73
* EL050.cbl
  3923         16  cp-extra-periods      pic 9 value zeros.
  3924         16  cp-net-only-state     pic x value spaces.
  3925         16  FILLER                PIC X(13).
  3926******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  74
* EL050.cbl
  3928******************************************************************
  3929*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3930*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3931*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3932*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3933*** MODIFICATION.                                              ***
  3934*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3935*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3936******************************************************************
  3937*    COPY ERCPNDB.
  3938******************************************************************
  3939*                                                                *
  3940*                                                                *
  3941*                            ERCPNDB.                            *
  3942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3943*                            VMOD=2.025                          *
  3944*                                                                *
  3945*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3946*                                                                *
  3947******************************************************************
  3948*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3949*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3950******************************************************************
  3951*                                                                *
  3952*                                                                *
  3953*   FILE TYPE = VSAM,KSDS                                        *
  3954*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3955*                                                                *
  3956*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3957*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3958*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3959*                                                 RKP=13,LEN=36  *
  3960*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3961*                                      AND CHG-SEQ.)             *
  3962*                                                RKP=49,LEN=11   *
  3963*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3964*                                      AND CHG-SEQ.)             *
  3965*                                                RKP=60,LEN=15   *
  3966*                                                                *
  3967*   LOG = NO                                                     *
  3968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3969******************************************************************
  3970******************************************************************
  3971*                   C H A N G E   L O G
  3972*
  3973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3974*-----------------------------------------------------------------
  3975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3976* EFFECTIVE    NUMBER
  3977*-----------------------------------------------------------------
  3978* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3979* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3980* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3981* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3982* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3983* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3984* 032306                   PEMA  ADD BOW LOAN NUMBER
  3985* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  75
* EL050.cbl
  3986* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3987* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3988* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3989* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3990* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3991* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3992* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3993* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3994* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3995******************************************************************
  3996
  3997 01  PENDING-BUSINESS.
  3998     12  PB-RECORD-ID                     PIC XX.
  3999         88  VALID-PB-ID                        VALUE 'PB'.
  4000
  4001     12  PB-CONTROL-PRIMARY.
  4002         16  PB-COMPANY-CD                PIC X.
  4003         16  PB-ENTRY-BATCH               PIC X(6).
  4004         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4005         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4006
  4007     12  PB-CONTROL-BY-ACCOUNT.
  4008         16  PB-COMPANY-CD-A1             PIC X.
  4009         16  PB-CARRIER                   PIC X.
  4010         16  PB-GROUPING.
  4011             20  PB-GROUPING-PREFIX       PIC XXX.
  4012             20  PB-GROUPING-PRIME        PIC XXX.
  4013         16  PB-STATE                     PIC XX.
  4014         16  PB-ACCOUNT.
  4015             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4016             20  PB-ACCOUNT-PRIME         PIC X(6).
  4017         16  PB-CERT-EFF-DT               PIC XX.
  4018         16  PB-CERT-NO.
  4019             20  PB-CERT-PRIME            PIC X(10).
  4020             20  PB-CERT-SFX              PIC X.
  4021         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4022
  4023         16  PB-RECORD-TYPE               PIC X.
  4024             88  PB-MAILING-DATA                VALUE '0'.
  4025             88  PB-ISSUE                       VALUE '1'.
  4026             88  PB-CANCELLATION                VALUE '2'.
  4027             88  PB-BATCH-TRAILER               VALUE '9'.
  4028
  4029     12  PB-CONTROL-BY-ORIG-BATCH.
  4030         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4031         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4032         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4033         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4034
  4035     12  PB-CONTROL-BY-CSR.
  4036         16  PB-CSR-COMPANY-CD            PIC X.
  4037         16  PB-CSR-ID                    PIC X(4).
  4038         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4039         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4040         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4041******************************************************************
  4042*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4043******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  76
* EL050.cbl
  4044
  4045     12  PB-LAST-MAINT-DT                 PIC XX.
  4046     12  PB-LAST-MAINT-BY                 PIC X(4).
  4047     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4048
  4049     12  PB-RECORD-BODY                   PIC X(375).
  4050
  4051     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4052         16  PB-CERT-ORIGIN               PIC X.
  4053             88  CLASIC-CREATED-CERT         VALUE '1'.
  4054         16  PB-I-NAME.
  4055             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4056             20  PB-I-INSURED-FIRST-NAME.
  4057                 24  PB-I-INSURED-1ST-INIT PIC X.
  4058                 24  FILLER                PIC X(9).
  4059             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4060         16  PB-I-AGE                     PIC S99   COMP-3.
  4061         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4062         16  PB-I-BIRTHDAY                PIC XX.
  4063         16  PB-I-INSURED-SEX             PIC X.
  4064             88  PB-SEX-MALE     VALUE 'M'.
  4065             88  PB-SEX-FEMALE   VALUE 'F'.
  4066
  4067         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4068         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4069         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4070         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4071         16  PB-I-SKIP-CODE               PIC X.
  4072             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4073             88  PB-SKIP-JULY              VALUE '1'.
  4074             88  PB-SKIP-AUGUST            VALUE '2'.
  4075             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4076             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4077             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4078             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4079             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4080             88  PB-SKIP-JUNE              VALUE '8'.
  4081             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4082             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4083             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4084         16  PB-I-TERM-TYPE               PIC X.
  4085             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4086             88  PB-PAID-WEEKLY            VALUE 'W'.
  4087             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4088             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4089             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4090         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4091         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4092         16  PB-I-DATA-ENTRY-SW           PIC X.
  4093             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4094             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4095             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4096             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4097         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4098         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4099*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4100         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4101         16  FILLER                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  77
* EL050.cbl
  4102
  4103         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4104             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4105             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4106                                                   '90' THRU '99'.
  4107         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4108                                          PIC XX.
  4109         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4110         16  PB-I-AMOUNT-FINANCED REDEFINES
  4111                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4112         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4113         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4114                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4115         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4116         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4117         16  PB-I-CLP-AMOUNT REDEFINES
  4118                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4119         16  PB-I-LF-CALC-FLAG            PIC X.
  4120             88 PB-COMP-LF-PREM               VALUE '?'.
  4121         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4122         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4123         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4124         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4125         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4126         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4127         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4128         16  PB-I-LF-ABBR                 PIC XXX.
  4129         16  PB-I-LF-INPUT-CD             PIC XX.
  4130
  4131         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4132             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4133             88  PB-INVALID-AH               VALUE '  ' '00'
  4134                                                   '90' THRU '99'.
  4135         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4136         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4137         16  PB-I-AH-CALC-FLAG            PIC X.
  4138             88 PB-COMP-AH-PREM                  VALUE '?'.
  4139         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4140         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4141         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4142         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4143         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4144         16  PB-I-AH-ABBR                 PIC XXX.
  4145         16  PB-I-AH-INPUT-CD             PIC XXX.
  4146
  4147         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4148         16  PB-I-REIN-TABLE              PIC XXX.
  4149         16  PB-I-BUSINESS-TYPE           PIC 99.
  4150         16  PB-I-INDV-GRP-CD             PIC X.
  4151         16  PB-I-MORT-CODE.
  4152             20  PB-I-TABLE               PIC X.
  4153             20  PB-I-INTEREST            PIC XX.
  4154             20  PB-I-MORT-TYP            PIC X.
  4155         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4156         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4157         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4158         16  PB-I-INDV-GRP-OVRD           PIC X.
  4159         16  PB-I-RATE-CLASS-OVRD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  78
* EL050.cbl
  4160         16  PB-I-SIG-SW                  PIC X.
  4161             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4162         16  PB-I-RATE-CLASS              PIC XX.
  4163         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4164         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4165         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4166         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4167         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4168         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4169         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4170         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4171         16  PB-I-OB-FLAG                 PIC X.
  4172             88  PB-I-OB                      VALUE 'B'.
  4173             88  PB-I-SUMMARY                 VALUE 'Z'.
  4174         16  PB-I-ENTRY-STATUS            PIC X.
  4175             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4176                                              'M' '5' '9' '2'.
  4177             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4178             88  PB-I-POLICY-PENDING          VALUE '2'.
  4179             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4180             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4181             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4182             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4183             88  PB-I-REIN-ONLY               VALUE '9'.
  4184             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4185             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4186             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4187             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4188         16  PB-I-INT-CODE                PIC X.
  4189             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4190             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4191         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4192         16  PB-I-SOC-SEC-NO              PIC X(11).
  4193         16  PB-I-MEMBER-NO               PIC X(12).
  4194         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4195*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4196         16  PB-I-OLD-LOF                 PIC XXX.
  4197         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4198         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4199         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4200         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4201         16  PB-I-LIFE-INDICATOR          PIC X.
  4202             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4203         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4204         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4205                                          PIC S9(5)V99    COMP-3.
  4206         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4207             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4208             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4209         16  PB-I-1ST-PMT-DT              PIC XX.
  4210         16  PB-I-JOINT-INSURED.
  4211             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4212             20 PB-I-JOINT-FIRST-NAME.
  4213                24  PB-I-JOINT-FIRST-INIT PIC X.
  4214                24  FILLER                PIC X(9).
  4215             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4216*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4217         16  PB-I-BENEFICIARY-NAME.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  79
* EL050.cbl
  4218             20  PB-I-BANK-NUMBER         PIC X(10).
  4219             20  FILLER                   PIC X(15).
  4220         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4221         16  PB-I-REFERENCE               PIC X(12).
  4222         16  FILLER REDEFINES PB-I-REFERENCE.
  4223             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4224             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4225             20  PB-I-CLP-STATE           PIC XX.
  4226         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4227             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4228             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4229             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4230         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4231         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4232         16  PB-I-RESIDENT-STATE          PIC XX.
  4233         16  PB-I-RATE-CODE               PIC X(4).
  4234         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4235         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4236         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4237         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4238         16  PB-I-BANK-NOCHRGB            PIC 99.
  4239         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4240         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4241
  4242     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4243         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4244             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4245         16  PB-C-CANCEL-ORIGIN           PIC X.
  4246             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4247         16  PB-C-LF-CANCEL-DT            PIC XX.
  4248         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4249         16  PB-C-LF-CALC-REQ             PIC X.
  4250             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4251         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4252         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4253         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4254             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4255         16  PB-C-AH-CANCEL-DT            PIC XX.
  4256         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4257         16  PB-C-AH-CALC-REQ             PIC X.
  4258             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4259         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4260         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4261         16  PB-C-LAST-NAME               PIC X(15).
  4262         16  PB-C-REFUND-SW               PIC X.
  4263             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4264             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4265         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4266         16  PB-C-PAYEE-CODE              PIC X(6).
  4267         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4268         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4269         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4270         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4271         16  PB-C-REFERENCE               PIC X(12).
  4272         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4273         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4274         16  PB-C-POST-CARD-IND           PIC X.
  4275         16  PB-C-CANCEL-REASON           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  80
* EL050.cbl
  4276         16  PB-C-REF-INTERFACE-SW        PIC X.
  4277         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4278         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4279         16  FILLER                       PIC X(01).
  4280*        16  FILLER                       PIC X(18).
  4281         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4282*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4283         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4284         16  PB-CANCELED-CERT-DATA.
  4285             20  PB-CI-INSURED-NAME.
  4286                 24  PB-CI-LAST-NAME      PIC X(15).
  4287                 24  PB-CI-INITIALS       PIC XX.
  4288             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4289             20  PB-CI-INSURED-SEX        PIC X.
  4290             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4291             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4292             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4293             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4294             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4295             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4296             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4297             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4298             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4299             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4300             20  PB-CI-RATE-CLASS         PIC XX.
  4301             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4302             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4303             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4304             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4305             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4306             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4307             20  PB-CI-LF-ABBR            PIC X(3).
  4308             20  PB-CI-AH-ABBR            PIC X(3).
  4309             20  PB-CI-OB-FLAG            PIC X.
  4310                 88  PB-CI-OB                VALUE 'B'.
  4311             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4312                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4313                                           'M' '4' '5' '9' '2'.
  4314                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4315                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4316                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4317                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4318                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4319                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4320                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4321                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4322                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4323                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4324                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4325                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4326                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4327             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4328                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4329                                           'M' '4' '5' '9' '2'.
  4330                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4331                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4332                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4333                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  81
* EL050.cbl
  4334                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4335                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4336                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4337                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4338                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4339                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4340                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4341                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4342                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4343             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4344             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4345             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4346             20  PB-CI-MEMBER-NO          PIC X(12).
  4347             20  PB-CI-INT-CODE           PIC X.
  4348                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4349                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4350             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4351             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4352             20  PB-CI-COMP-EXCP-SW       PIC X.
  4353                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4354                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4355             20  PB-CI-ENTRY-STATUS       PIC X.
  4356             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4357             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4358             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4359             20  PB-CI-DEATH-DT           PIC XX.
  4360             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4361             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4362             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4363             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4364             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4365             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4366             20  PB-CI-ENTRY-DT              PIC XX.
  4367             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4368             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4369             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4370             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4371             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4372             20  PB-CI-OLD-LOF               PIC XXX.
  4373*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4374             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4375             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4376             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4377             20  PB-CI-INDV-GRP-CD           PIC X.
  4378             20  PB-CI-BENEFICIARY-NAME.
  4379                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4380                 24  FILLER                  PIC X(15).
  4381             20  PB-CI-NOTE-SW               PIC X.
  4382             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4383             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4384             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4385             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4386             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4387             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4388             20  PB-CI-FIRST-NAME            PIC X(10).
  4389             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4390
  4391         16  FILLER                       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  82
* EL050.cbl
  4392*032306  16  FILLER                       PIC X(27).
  4393*        16  FILLER                       PIC X(46).
  4394
  4395     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4396         16  FILLER                       PIC X(10).
  4397         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4398         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4399         16  PB-M-INSURED-MID-INIT        PIC X.
  4400         16  PB-M-INSURED-AGE             PIC 99.
  4401         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4402         16  PB-M-INSURED-SEX             PIC X.
  4403         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4404         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4405         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4406         16  PB-M-INSURED-CITY-STATE.
  4407             20  PB-M-INSURED-CITY        PIC X(28).
  4408             20  PB-M-INSURED-STATE       PIC XX.
  4409         16  PB-M-INSURED-ZIP-CODE.
  4410             20  PB-M-INSURED-ZIP-PRIME.
  4411                 24  PB-M-INSURED-ZIP-1   PIC X.
  4412                     88  PB-M-CANADIAN-POST-CODE
  4413                                             VALUE 'A' THRU 'Z'.
  4414                 24  FILLER               PIC X(4).
  4415             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4416         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4417                                        PB-M-INSURED-ZIP-CODE.
  4418             20  PM-M-INS-CAN-POST1       PIC XXX.
  4419             20  PM-M-INS-CAN-POST2       PIC XXX.
  4420             20  FILLER                   PIC XXX.
  4421         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4422         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4423         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4424         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4425         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4426         16  PB-M-CRED-BENE-CITYST.
  4427             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4428             20  PB-M-CRED-BENE-STATE     PIC XX.
  4429         16  FILLER                       PIC X(92).
  4430
  4431     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4432         16  FILLER                       PIC X(10).
  4433         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4434         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4435         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4436         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4437         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4438         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4439         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4440         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4441         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4442         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4443         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4444         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4445         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4446         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4447         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4448         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4449         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  83
* EL050.cbl
  4450         16  PB-ACCOUNT-NAME              PIC X(30).
  4451         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4452         16  PB-REFERENCE                 PIC X(12).
  4453         16  PB-B-RECEIVED-DT             PIC XX.
  4454         16  FILLER                       PIC X(234).
  4455
  4456     12  PB-RECORD-STATUS.
  4457         16  PB-CREDIT-SELECT-DT          PIC XX.
  4458         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4459         16  PB-BILLED-DT                 PIC XX.
  4460         16  PB-BILLING-STATUS            PIC X.
  4461             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4462             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4463             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4464         16  PB-RECORD-BILL               PIC X.
  4465             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4466             88  PB-RECORD-RETURNED           VALUE 'R'.
  4467             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4468             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4469             88  PB-OVERRIDE-AH               VALUE 'A'.
  4470             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4471         16  PB-BATCH-ENTRY               PIC X.
  4472             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4473             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4474             88  PB-REISSUED-CERT             VALUE 'E'.
  4475             88  PB-CASH-CERT                 VALUE 'C'.
  4476             88  PB-MONTHLY-CERT              VALUE 'M'.
  4477             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4478             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4479             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4480         16  PB-FORCE-CODE                PIC X.
  4481             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4482             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4483             88  PB-CANCEL-FORCE              VALUE '8'.
  4484             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4485             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4486             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4487             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4488             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4489             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4490             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4491         16  PB-FATAL-FLAG                PIC X.
  4492             88  PB-FATAL-ERRORS              VALUE 'X'.
  4493         16  PB-FORCE-ER-CD               PIC X.
  4494             88  PB-FORCE-ERRORS              VALUE 'F'.
  4495             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4496         16  PB-WARN-ER-CD                PIC X.
  4497             88  PB-WARNING-ERRORS            VALUE 'W'.
  4498         16  FILLER                       PIC X.
  4499         16  PB-OUT-BAL-CD                PIC X.
  4500             88  PB-OUT-OF-BAL                VALUE 'O'.
  4501         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4502         16  PB-AH-OVERRIDE-L1            PIC X.
  4503         16  PB-INPUT-DT                  PIC XX.
  4504         16  PB-INPUT-BY                  PIC X(4).
  4505         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4506         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4507         16  PB-TOLERANCE-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  84
* EL050.cbl
  4508         16  PB-LF-EARNING-METHOD         PIC X.
  4509         16  PB-AH-EARNING-METHOD         PIC X.
  4510         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4511         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4512         16  PB-REIN-CD                   PIC XXX.
  4513         16  PB-LF-REFUND-TYPE            PIC X.
  4514         16  PB-AH-REFUND-TYPE            PIC X.
  4515         16  PB-ACCT-EFF-DT               PIC XX.
  4516         16  PB-ACCT-EXP-DT               PIC XX.
  4517         16  PB-COMPANY-ID                PIC X(3).
  4518         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4519         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4520         16  PB-SV-CARRIER                PIC X.
  4521         16  PB-SV-GROUPING               PIC X(6).
  4522         16  PB-SV-STATE                  PIC XX.
  4523         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4524         16  PB-GA-BILLING-INFO.
  4525             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4526                                          PIC XX.
  4527         16  PB-SV-REMIT-TO  REDEFINES
  4528             PB-GA-BILLING-INFO           PIC X(10).
  4529         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4530         16  PB-I-LOAN-OFFICER            PIC X(5).
  4531         16  PB-I-VIN                     PIC X(17).
  4532
  4533         16  FILLER                       PIC X(04).
  4534         16  IMNET-BYPASS-SW              PIC X.
  4535
  4536******************************************************************
  4537*                COMMON EDIT ERRORS                              *
  4538******************************************************************
  4539
  4540     12  PB-COMMON-ERRORS.
  4541         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4542                                           PIC S9(4)     COMP.
  4543
  4544******************************************************************
  4545
  4546* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4547*    COPY ELC50W1.
  4548******************************************************************
  4549*                                                                *
  4550*                                                                *
  4551*                             ELC50W1                            *
  4552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4553*                            VMOD=2.004                          *
  4554*                                                                *
  4555*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4556*                                                                *
  4557*                                                                *
  4558******************************************************************
  4559
  4560     12  WK-WORK-AREA.
  4561         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4562         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4563         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4564         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4565         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  85
* EL050.cbl
  4566         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4567         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4568         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4569         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4570         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4571         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4572         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4573         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4574         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4575         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4576         16  WK-CREDIT-EDIT-CONTROLS.
  4577             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4578             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4579             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4580             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4581             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4582             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4583         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4584         16  WK-SAVE-REIN-DATA.
  4585             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4586             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4587             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4588         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4589             88  ENTRY-FROM-EL6311       VALUE '6'.
  4590         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4591         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4592     12  WK-RECORD-ADDRESSES.
  4593         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4594         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4595         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4596         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4597         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4598         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4599         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4600         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4601     12  WK-OVER-SHORT-AREA.
  4602         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4603         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4604         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4605             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4606         16  FILLER                   PIC X(5) VALUE SPACES.
  4607
  4608*    COPY ELCEDITC.
  4609******************************************************************
  4610*                                                                *
  4611*                                                                *
  4612*                            ELCEDITC                            *
  4613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4614*                            VMOD=2.012                          *
  4615*                                                                *
  4616*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4617*                     EL6313, EL050 AND EL517.                   *
  4618*                                                                *
  4619******************************************************************
  4620******************************************************************
  4621*                   C H A N G E   L O G
  4622*
  4623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  86
* EL050.cbl
  4624*-----------------------------------------------------------------
  4625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4626* EFFECTIVE    NUMBER
  4627*-----------------------------------------------------------------
  4628* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4629******************************************************************
  4630
  4631     12  EDIT-CRITERIA-DATA.
  4632         16  EC-CO-MONTH-END-DT       PIC XX.
  4633         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4634         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4635         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4636         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4637         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4638         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4639         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4640         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4641         16  EC-CO-REM-TERM-CALC      PIC X.
  4642               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4643               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4644               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4645               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4646
  4647         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4648               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4649               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4650               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4651               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4652               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4653               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4654               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4655               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4656               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4657               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4658
  4659         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4660               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4661               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4662               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4663               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4664               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4665               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4666               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4667               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4668
  4669         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4670                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4671                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4672
  4673         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4674                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4675                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4676                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4677                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4678                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4679                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4680                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4681                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  87
* EL050.cbl
  4682
  4683         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4684               88  EC-BR-REDUCING                   VALUE 'R'.
  4685               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4686
  4687         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4688         16  EC-BR-LF-DESC             PIC X(10).
  4689         16  EC-BR-AH-DESC             PIC X(10).
  4690         16  EC-BR-LF-COMMENT          PIC X(10).
  4691         16  EC-BR-AH-COMMENT          PIC X(10).
  4692
  4693         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4694               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4695               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4696               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4697               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4698
  4699         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4700               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4701               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4702               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4703               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4704
  4705         16  EC-BR-LF-REFUND-CALC      PIC X.
  4706                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4707                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4708                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4709                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4710                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4711                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4712                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4713
  4714         16  EC-BR-AH-REFUND-CALC      PIC X.
  4715                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4716                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4717                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4718                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4719                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4720                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4721                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4722                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4723
  4724         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4725                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4726                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4727                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4728
  4729         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4730                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4731                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4732                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4733
  4734         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4735         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4736         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4737         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4738
  4739         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  88
* EL050.cbl
  4740         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4741                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4742                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4743                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4744                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4745
  4746         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4747               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4748               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4749               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4750               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4751               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4752
  4753         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4754               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4755               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4756               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4757               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4758               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4759
  4760         16  EC-ST-LF-REFUND-CALC      PIC X.
  4761                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4762                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4763                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4764                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4765                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4766                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4767                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4768                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4769
  4770         16  EC-ST-AH-REFUND-CALC      PIC X.
  4771                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4772                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4773                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4774                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4775                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4776                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4777                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4778                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4779
  4780         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4781         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4782         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4783         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4784         16  EC-AM-EXPIRATION-DT       PIC XX.
  4785         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4786         16  EC-AM-CLASS-CD            PIC XX.
  4787         16  EC-AM-LF-DEVIATION        PIC XXX.
  4788         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4789         16  EC-AM-AH-DEVIATION        PIC XXX.
  4790         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4791         16  EC-AM-PHONE-NO            PIC X(10).
  4792
  4793         16  EC-AM-LF-REFUND-CALC      PIC X.
  4794                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4795                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4796                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4797                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  89
* EL050.cbl
  4798                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4799                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4800                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4801
  4802         16  EC-AM-AH-REFUND-CALC      PIC X.
  4803                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4804                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4805                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4806                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4807                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4808                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4809                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4810
  4811         16  EC-AM-BEN-I-G-CD          PIC X.
  4812                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4813                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4814                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4815
  4816         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4817         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4818         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4819         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4820         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4821         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4822         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4823         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4824         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4825
  4826         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4827         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4828         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4829         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4830         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4831         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4832         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4833         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4834         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4835         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4836         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4837         16  EC-RT-LF-NSP-ST           PIC XX.
  4838         16  EC-RT-AH-NSP-ST           PIC XX.
  4839         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4840         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4841
  4842         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4843             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4844                                             'M' '5' '9' '2'.
  4845             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4846             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4847             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4848             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4849             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4850             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4851             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4852             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4853             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4854             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4855
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  90
* EL050.cbl
  4856         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4857             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4858                                             'M' '5' '9' '2'.
  4859             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4860             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4861             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4862             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4863             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4864             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4865             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4866             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4867             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4868             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4869
  4870         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4871         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4872         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4873         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4874         16  EC-CM-DEATH-DT            PIC XX.
  4875
  4876*DMD CUSTOM CODING FIELDS BELOW
  4877*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4878         16  EC-BR-DMD-RATING-SW       PIC X.
  4879                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4880                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4881                 88  NO-DMD-RATING               VALUE 'N'.
  4882
  4883         16  EC-NEW-CERT               PIC X(11).
  4884         16  EC-NEW-STATE              PIC XX.
  4885         16  FILLER                    PIC X.
  4886*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4887         16  OVER-SHORT-EDIT-FIELDS.
  4888             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4889             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4890             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4891             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4892             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4893             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4894             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4895             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4896             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4897         16  FILLER                    PIC X(71).
  4898******************************************************************
  4899
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  91
* EL050.cbl
  4901*    COPY ELCDIFRD.
  4902******************************************************************
  4903*                                                                *
  4904*                                                                *
  4905*                            ELCDIFRD.                           *
  4906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4907*                            VMOD=2.004                          *
  4908*                                                                *
  4909*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4910*                                                                *
  4911******************************************************************
  4912*
  4913  01  WS-DIFFERENCE-CALCULATION.
  4914        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4915        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4916        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4917        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4918        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4919        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4920        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4921        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4922        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4923        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4924        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4925
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  92
* EL050.cbl
  4927****************************************************************
  4928*
  4929* Copyright (c) 2007 by Clerity Solutions, Inc.
  4930* All rights reserved.
  4931*
  4932****************************************************************
  4933 01  DFHEIV.
  4934   02  DFHEIV0               PIC X(35).
  4935   02  DFHEIV1               PIC X(08).
  4936   02  DFHEIV2               PIC X(08).
  4937   02  DFHEIV3               PIC X(08).
  4938   02  DFHEIV4               PIC X(06).
  4939   02  DFHEIV5               PIC X(04).
  4940   02  DFHEIV6               PIC X(04).
  4941   02  DFHEIV7               PIC X(02).
  4942   02  DFHEIV8               PIC X(02).
  4943   02  DFHEIV9               PIC X(01).
  4944   02  DFHEIV10              PIC S9(7) COMP-3.
  4945   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4946   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4947   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4948   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4949   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4950   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4951   02  DFHEIV17              PIC X(04).
  4952   02  DFHEIV18              PIC X(04).
  4953   02  DFHEIV19              PIC X(04).
  4954   02  DFHEIV20              USAGE IS POINTER.
  4955   02  DFHEIV21              USAGE IS POINTER.
  4956   02  DFHEIV22              USAGE IS POINTER.
  4957   02  DFHEIV23              USAGE IS POINTER.
  4958   02  DFHEIV24              USAGE IS POINTER.
  4959   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4960   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4961   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4962   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4963   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4964   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4965   02  FILLER                PIC X(02).
  4966   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4967   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4968   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4969   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4970   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4971 LINKAGE  SECTION.
  4972*****************************************************************
  4973*                                                               *
  4974* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4975* All rights reserved.                                          *
  4976*                                                               *
  4977*****************************************************************
  4978 01  dfheiblk.
  4979     02  eibtime          pic s9(7) comp-3.
  4980     02  eibdate          pic s9(7) comp-3.
  4981     02  eibtrnid         pic x(4).
  4982     02  eibtaskn         pic s9(7) comp-3.
  4983     02  eibtrmid         pic x(4).
  4984     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  93
* EL050.cbl
  4985     02  eibcposn         pic s9(4) comp.
  4986     02  eibcalen         pic s9(4) comp.
  4987     02  eibaid           pic x(1).
  4988     02  eibfiller1       pic x(1).
  4989     02  eibfn            pic x(2).
  4990     02  eibfiller2       pic x(2).
  4991     02  eibrcode         pic x(6).
  4992     02  eibfiller3       pic x(2).
  4993     02  eibds            pic x(8).
  4994     02  eibreqid         pic x(8).
  4995     02  eibrsrce         pic x(8).
  4996     02  eibsync          pic x(1).
  4997     02  eibfree          pic x(1).
  4998     02  eibrecv          pic x(1).
  4999     02  eibsend          pic x(1).
  5000     02  eibatt           pic x(1).
  5001     02  eibeoc           pic x(1).
  5002     02  eibfmh           pic x(1).
  5003     02  eibcompl         pic x(1).
  5004     02  eibsig           pic x(1).
  5005     02  eibconf          pic x(1).
  5006     02  eiberr           pic x(1).
  5007     02  eibrldbk         pic x(1).
  5008     02  eiberrcd         pic x(4).
  5009     02  eibsynrb         pic x(1).
  5010     02  eibnodat         pic x(1).
  5011     02  eibfiller5       pic x(2).
  5012     02  eibresp          pic 9(09) comp.
  5013     02  eibresp2         pic 9(09) comp.
  5014     02  dfheigdj         pic s9(4) comp.
  5015     02  dfheigdk         pic s9(4) comp.
  5016
  5017 01  DFHCOMMAREA                   PIC X(1036).
  5018
  5019*01 PARMLIST .
  5020*    02  FILLER                    PIC S9(8)   COMP.
  5021*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5022*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5023*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5024*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5025*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5026*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5027*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5028
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  94
* EL050.cbl
  5030*    COPY ELCCNTL.
  5031******************************************************************
  5032*                                                                *
  5033*                                                                *
  5034*                            ELCCNTL.                            *
  5035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5036*                            VMOD=2.059                          *
  5037*                                                                *
  5038*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5039*                                                                *
  5040*   FILE TYPE = VSAM,KSDS                                        *
  5041*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5042*                                                                *
  5043*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5044*       ALTERNATE INDEX = NONE                                   *
  5045*                                                                *
  5046*   LOG = YES                                                    *
  5047*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5048******************************************************************
  5049*                   C H A N G E   L O G
  5050*
  5051* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5052*-----------------------------------------------------------------
  5053*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5054* EFFECTIVE    NUMBER
  5055*-----------------------------------------------------------------
  5056* 082503                   PEMA  ADD BENEFIT GROUP
  5057* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5058* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5059* 092705    2005050300006  PEMA  ADD SPP LEASES
  5060* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5061* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5062* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5063* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5064* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5065* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5066* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5067* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5068* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5069* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5070******************************************************************
  5071*
  5072 01  CONTROL-FILE.
  5073     12  CF-RECORD-ID                       PIC XX.
  5074         88  VALID-CF-ID                        VALUE 'CF'.
  5075
  5076     12  CF-CONTROL-PRIMARY.
  5077         16  CF-COMPANY-ID                  PIC XXX.
  5078         16  CF-RECORD-TYPE                 PIC X.
  5079             88  CF-COMPANY-MASTER              VALUE '1'.
  5080             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5081             88  CF-STATE-MASTER                VALUE '3'.
  5082             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5083             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5084             88  CF-CARRIER-MASTER              VALUE '6'.
  5085             88  CF-MORTALITY-MASTER            VALUE '7'.
  5086             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5087             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  95
* EL050.cbl
  5088             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5089             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5090             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5091             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5092             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5093             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5094             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5095             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5096             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5097         16  CF-ACCESS-CD-GENL              PIC X(4).
  5098         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5099             20  CF-PROCESSOR               PIC X(4).
  5100         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5101             20  CF-STATE-CODE              PIC XX.
  5102             20  FILLER                     PIC XX.
  5103         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5104             20  FILLER                     PIC XX.
  5105             20  CF-HI-BEN-IN-REC           PIC XX.
  5106         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5107             20  FILLER                     PIC XXX.
  5108             20  CF-CARRIER-CNTL            PIC X.
  5109         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5110             20  FILLER                     PIC XX.
  5111             20  CF-HI-TYPE-IN-REC          PIC 99.
  5112         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5113             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5114                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5115             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5116             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5117         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5118             20  FILLER                     PIC X.
  5119             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5120         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5121             20  FILLER                     PIC XX.
  5122             20  CF-MORTGAGE-PLAN           PIC XX.
  5123         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5124
  5125     12  CF-LAST-MAINT-DT                   PIC XX.
  5126     12  CF-LAST-MAINT-BY                   PIC X(4).
  5127     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5128
  5129     12  CF-RECORD-BODY                     PIC X(728).
  5130
  5131
  5132****************************************************************
  5133*             COMPANY MASTER RECORD                            *
  5134****************************************************************
  5135
  5136     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5137         16  CF-COMPANY-ADDRESS.
  5138             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5139             20  CF-CL-IN-CARE-OF           PIC X(30).
  5140             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5141             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5142             20  CF-CL-CITY-STATE           PIC X(30).
  5143             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5144             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5145         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  96
* EL050.cbl
  5146         16  CF-COMPANY-PASSWORD            PIC X(8).
  5147         16  CF-SECURITY-OPTION             PIC X.
  5148             88  ALL-SECURITY                   VALUE '1'.
  5149             88  COMPANY-VERIFY                 VALUE '2'.
  5150             88  PROCESSOR-VERIFY               VALUE '3'.
  5151             88  NO-SECURITY                    VALUE '4'.
  5152             88  ALL-BUT-TERM                   VALUE '5'.
  5153         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5154             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5155         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5156             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5157         16  CF-INFORCE-LOCATION            PIC X.
  5158             88  CERTS-ARE-ONLINE               VALUE '1'.
  5159             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5160             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5161         16  CF-LOWER-CASE-LETTERS          PIC X.
  5162         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5163             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5164             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5165             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5166             88  CF-ACCNT-CNTL                  VALUE '3'.
  5167             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5168
  5169         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5170         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5171
  5172         16  CF-LGX-CREDIT-USER             PIC X.
  5173             88  CO-IS-NOT-USER                 VALUE 'N'.
  5174             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5175
  5176         16 CF-CREDIT-CALC-CODES.
  5177             20  CF-CR-REM-TERM-CALC PIC X.
  5178               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5179               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5180               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5181               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5182               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5183               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5184               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5185             20  CF-CR-R78-METHOD           PIC X.
  5186               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5187               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5188
  5189         16  CF-CLAIM-CONTROL-COUNTS.
  5190             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5191                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5192
  5193             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5194                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5195
  5196             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5197                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5198
  5199             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5200                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5201
  5202         16  CF-CURRENT-MONTH-END           PIC XX.
  5203
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  97
* EL050.cbl
  5204         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5205             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5206             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5207             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5208             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5209                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5210                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5211             20  CF-CO-PREM-REJECT-SW       PIC X.
  5212                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5213                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5214             20  CF-CO-REF-REJECT-SW        PIC X.
  5215                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5216                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5217
  5218         16  CF-CO-REPORTING-DT             PIC XX.
  5219         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5220         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5221           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5222           88  CF-CO-MONTH-END                  VALUE '1'.
  5223
  5224         16  CF-LGX-CLAIM-USER              PIC X.
  5225             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5226             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5227
  5228         16  CF-CREDIT-EDIT-CONTROLS.
  5229             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5230             20  CF-MIN-AGE                 PIC 99.
  5231             20  CF-DEFAULT-AGE             PIC 99.
  5232             20  CF-MIN-TERM                PIC S999      COMP-3.
  5233             20  CF-MAX-TERM                PIC S999      COMP-3.
  5234             20  CF-DEFAULT-SEX             PIC X.
  5235             20  CF-JOINT-AGE-INPUT         PIC X.
  5236                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5237             20  CF-BIRTH-DATE-INPUT        PIC X.
  5238                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5239             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5240                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5241                 88  CF-ZERO-CARRIER            VALUE '1'.
  5242                 88  CF-ZERO-GROUPING           VALUE '2'.
  5243                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5244             20  CF-EDIT-SW                 PIC X.
  5245                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5246             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5247             20  CF-CR-PR-METHOD            PIC X.
  5248               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5249               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5250             20  FILLER                     PIC X.
  5251
  5252         16  CF-CREDIT-MISC-CONTROLS.
  5253             20  CF-REIN-TABLE-SW           PIC X.
  5254                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5255             20  CF-COMP-TABLE-SW           PIC X.
  5256                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5257             20  CF-EXPERIENCE-RETENTION-AGE
  5258                                            PIC S9        COMP-3.
  5259             20  CF-CONVERSION-DT           PIC XX.
  5260             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5261             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  98
* EL050.cbl
  5262                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5263                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5264
  5265             20  CF-CR-CHECK-NO-CONTROL.
  5266                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5267                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5268                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5269                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5270                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5271                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5272
  5273                 24  CF-CR-CHECK-COUNT       REDEFINES
  5274                     CF-CR-CHECK-COUNTER      PIC X(4).
  5275
  5276                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5277                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5278
  5279                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5280                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5281                 24  CF-MAIL-PROCESSING       PIC X.
  5282                     88  MAIL-PROCESSING          VALUE 'Y'.
  5283
  5284         16  CF-MISC-SYSTEM-CONTROL.
  5285             20  CF-SYSTEM-C                 PIC X.
  5286                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5287             20  CF-SYSTEM-D                 PIC X.
  5288                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5289             20  CF-SOC-SEC-NO-SW            PIC X.
  5290                 88  SOC-SEC-NO-USED             VALUE '1'.
  5291             20  CF-MEMBER-NO-SW             PIC X.
  5292                 88  MEMBER-NO-USED              VALUE '1'.
  5293             20  CF-TAX-ID-NUMBER            PIC X(11).
  5294             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5295             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5296                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5297                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5298                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5299                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5300             20  CF-SYSTEM-E                 PIC X.
  5301                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5302
  5303         16  CF-LGX-LIFE-USER               PIC X.
  5304             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5305             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5306
  5307         16  CF-CR-MONTH-END-DT             PIC XX.
  5308
  5309         16  CF-FILE-MAINT-DATES.
  5310             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5311                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5312             20  CF-LAST-BATCH       REDEFINES
  5313                 CF-LAST-BATCH-NO               PIC X(4).
  5314             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5315             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5316             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5317             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5318             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5319             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page  99
* EL050.cbl
  5320             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5321             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5322             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5323             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5324
  5325         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5326         16  FILLER                         PIC X.
  5327
  5328         16  CF-ALT-MORT-CODE               PIC X(4).
  5329         16  CF-MEMBER-CAPTION              PIC X(10).
  5330
  5331         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5332             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5333             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5334             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5335             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5336             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5337
  5338         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5339
  5340         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5341         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5342         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5343         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5344
  5345         16  CF-AH-OVERRIDE-L1              PIC X.
  5346         16  CF-AH-OVERRIDE-L2              PIC XX.
  5347         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5348         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5349
  5350         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5351         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5352
  5353         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5354         16  CF-AR-LAST-EL860-DT            PIC XX.
  5355         16  CF-MP-MONTH-END-DT             PIC XX.
  5356
  5357         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5358         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5359             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5360
  5361         16  CF-AR-MONTH-END-DT             PIC XX.
  5362
  5363         16  CF-CRDTCRD-USER                PIC X.
  5364             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5365             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5366
  5367         16  CF-CC-MONTH-END-DT             PIC XX.
  5368
  5369         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5370
  5371         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5372             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5373             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5374             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5375         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5376         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5377         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 100
* EL050.cbl
  5378         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5379             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5380             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5381         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5382         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5383         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5384             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5385         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5386
  5387         16  CF-CL-ZIP-CODE.
  5388             20  CF-CL-ZIP-PRIME.
  5389                 24  CF-CL-ZIP-1ST          PIC X.
  5390                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5391                 24  FILLER                 PIC X(4).
  5392             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5393         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5394             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5395             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5396             20  FILLER                     PIC XXX.
  5397
  5398         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5399         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5400         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5401         16  CF-CO-OPTION-START-DATE        PIC XX.
  5402         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5403           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5404                                                      '3' '4'.
  5405           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5406           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5407           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5408           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5409           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5410           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5411
  5412         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5413
  5414         16  CF-PAYMENT-APPROVAL-LEVELS.
  5415             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5416             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5417             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5418             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5419             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5420             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5421
  5422         16  CF-END-USER-REPORTING-USER     PIC X.
  5423             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5424             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5425
  5426         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5427             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5428             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5429
  5430         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5431
  5432         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5433         16  FILLER                         PIC X.
  5434
  5435         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 101
* EL050.cbl
  5436             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5437             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5438             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5439
  5440         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5441
  5442         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5443             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5444             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5445
  5446         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5447             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5448             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5449
  5450         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5451
  5452         16  CF-CO-ACH-ID-CODE              PIC  X.
  5453             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5454             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5455             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5456         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5457         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5458         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5459         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5460         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5461         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5462         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5463         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5464         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5465                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5466         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5467                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5468
  5469         16  CF-CO-OVER-SHORT.
  5470             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5471             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5472
  5473*         16  FILLER                         PIC X(102).
  5474         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5475             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5476             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5477
  5478         16  CF-AH-APPROVAL-DAYS.
  5479             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5480             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5481             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5482             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5483
  5484         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5485
  5486         16  CF-APPROV-LEV-5.
  5487             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5488             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5489             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5490
  5491         16  FILLER                         PIC X(68).
  5492****************************************************************
  5493*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 102
* EL050.cbl
  5494****************************************************************
  5495
  5496     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5497         16  CF-PROCESSOR-NAME              PIC X(30).
  5498         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5499         16  CF-PROCESSOR-TITLE             PIC X(26).
  5500         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5501                 88  MESSAGE-YES                VALUE 'Y'.
  5502                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5503
  5504*****************************************************
  5505****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5506****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5507****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5508****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5509*****************************************************
  5510
  5511         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5512             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5513             20  CF-APPLICATION-FORCE       PIC X.
  5514             20  CF-INDIVIDUAL-APP.
  5515                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5516                     28  CF-BROWSE-APP      PIC X.
  5517                     28  CF-UPDATE-APP      PIC X.
  5518
  5519         16  CF-CURRENT-TERM-ON             PIC X(4).
  5520         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5521             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5522             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5523             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5524             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5525             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5526             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5527             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5528         16  CF-PROCESSOR-CARRIER           PIC X.
  5529             88  NO-CARRIER-SECURITY            VALUE ' '.
  5530         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5531             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5532         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5533             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5534         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5535             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5536
  5537         16  CF-PROC-SYS-ACCESS-SW.
  5538             20  CF-PROC-CREDIT-CLAIMS-SW.
  5539                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5540                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5541                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5542                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5543             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5544                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5545                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5546             20  CF-PROC-LIFE-GNRLDGR-SW.
  5547                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5548                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5549                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5550                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5551             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 103
* EL050.cbl
  5552                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5553                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5554         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5555             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5556             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5557         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5558
  5559         16  CF-APPROVAL-LEVEL                  PIC X.
  5560             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5561             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5562             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5563             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5564             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5565
  5566         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5567
  5568         16  CF-LANGUAGE-TYPE                   PIC X.
  5569             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5570             88  CF-LANG-IS-FR                      VALUE 'F'.
  5571
  5572         16  CF-CSR-IND                         PIC X.
  5573         16  FILLER                             PIC X(239).
  5574
  5575****************************************************************
  5576*             PROCESSOR/REMINDERS RECORD                       *
  5577****************************************************************
  5578
  5579     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5580         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5581             20  CF-START-REMIND-DT         PIC XX.
  5582             20  CF-END-REMIND-DT           PIC XX.
  5583             20  CF-REMINDER-TEXT           PIC X(50).
  5584         16  FILLER                         PIC X(296).
  5585
  5586
  5587****************************************************************
  5588*             STATE MASTER RECORD                              *
  5589****************************************************************
  5590
  5591     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5592         16  CF-STATE-ABBREVIATION          PIC XX.
  5593         16  CF-STATE-NAME                  PIC X(25).
  5594         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5595         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5596             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5597             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5598             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5599             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5600                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5601                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5602             20  CF-ST-PREM-REJECT-SW       PIC X.
  5603                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5604                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5605             20  CF-ST-REF-REJECT-SW        PIC X.
  5606                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5607                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5608         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5609         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 104
* EL050.cbl
  5610         16  CF-ST-REFUND-RULES.
  5611             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5612             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5613             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5614         16  CF-ST-FST-PMT-EXTENSION.
  5615             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5616             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5617                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5618                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5619                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5620                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5621         16  CF-ST-STATE-CALL.
  5622             20  CF-ST-CALL-UNEARNED        PIC X.
  5623             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5624             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5625         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5626             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5627             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5628         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5629         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5630         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5631         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5632         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5633         16  FILLER                         PIC X.
  5634         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5635             20  CF-ST-BENEFIT-CD           PIC XX.
  5636             20  CF-ST-BENEFIT-KIND         PIC X.
  5637                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5638                 88  CF-ST-AH-KIND              VALUE 'A'.
  5639             20  CF-ST-REM-TERM-CALC        PIC X.
  5640                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5641                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5642                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5643                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5644                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5645                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5646                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5647                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5648
  5649             20  CF-ST-REFUND-CALC          PIC X.
  5650                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5651                 88  ST-REFD-BY-R78             VALUE '1'.
  5652                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5653                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5654                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5655                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5656                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5657                 88  ST-REFD-UTAH               VALUE '7'.
  5658                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5659                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5660                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5661
  5662             20  CF-ST-EARNING-CALC         PIC X.
  5663                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5664                 88  ST-EARN-BY-R78             VALUE '1'.
  5665                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5666                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5667                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 105
* EL050.cbl
  5668                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5669                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5670                 88  ST-EARN-MEAN               VALUE '8'.
  5671                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5672
  5673             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5674                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5675                 88  ST-OVRD-BY-R78             VALUE '1'.
  5676                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5677                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5678                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5679                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5680                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5681                 88  ST-OVRD-MEAN               VALUE '8'.
  5682                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5683             20  cf-st-extra-periods        pic 9.
  5684*            20  FILLER                     PIC X.
  5685
  5686         16  CF-ST-COMMISSION-CAPS.
  5687             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5688             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5689             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5690             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5691         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5692                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5693
  5694         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5695
  5696         16  CF-ST-STATUTORY-INTEREST.
  5697             20  CF-ST-STAT-DATE-FROM       PIC X.
  5698                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5699                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5700             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5701             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5702             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5703             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5704             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5705
  5706         16  CF-ST-OVER-SHORT.
  5707             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5708             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5709
  5710         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5711
  5712         16  CF-ST-RT-CALC                  PIC X.
  5713
  5714         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5715         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5716         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5717         16  CF-ST-RF-LR-CALC               PIC X.
  5718         16  CF-ST-RF-LL-CALC               PIC X.
  5719         16  CF-ST-RF-LN-CALC               PIC X.
  5720         16  CF-ST-RF-AH-CALC               PIC X.
  5721         16  CF-ST-RF-CP-CALC               PIC X.
  5722*        16  FILLER                         PIC X(206).
  5723*CIDMOD         16  FILLER                         PIC X(192).
  5724         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5725             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 106
* EL050.cbl
  5726         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5727         16  CF-ST-VFY-2ND-BENE             PIC X.
  5728         16  CF-ST-CAUSAL-STATE             PIC X.
  5729         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5730         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5731         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5732             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5733         16  CF-ST-NET-ONLY-STATE           PIC X.
  5734             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5735         16  FILLER                         PIC X(181).
  5736
  5737****************************************************************
  5738*             BENEFIT MASTER RECORD                            *
  5739****************************************************************
  5740
  5741     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5742         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5743             20  CF-BENEFIT-CODE            PIC XX.
  5744             20  CF-BENEFIT-NUMERIC  REDEFINES
  5745                 CF-BENEFIT-CODE            PIC XX.
  5746             20  CF-BENEFIT-ALPHA           PIC XXX.
  5747             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5748             20  CF-BENEFIT-COMMENT         PIC X(10).
  5749
  5750             20  CF-LF-COVERAGE-TYPE        PIC X.
  5751                 88  CF-REDUCING                VALUE 'R'.
  5752                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5753
  5754             20  CF-SPECIAL-CALC-CD         PIC X.
  5755                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5756                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5757                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5758                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5759                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5760                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5761                 88  CF-FARM-PLAN               VALUE 'F'.
  5762                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5763                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5764                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5765                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5766                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5767                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5768                 88  CF-PRUDENTIAL              VALUE 'P'.
  5769                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5770                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5771                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5772                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5773                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5774                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5775
  5776             20  CF-JOINT-INDICATOR         PIC X.
  5777                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5778
  5779*            20  FILLER                     PIC X(12).
  5780             20  cf-maximum-benefits        pic s999 comp-3.
  5781             20  FILLER                     PIC X(09).
  5782             20  CF-BENEFIT-CATEGORY        PIC X.
  5783             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 107
* EL050.cbl
  5784
  5785             20  CF-CO-REM-TERM-CALC        PIC X.
  5786                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5787                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5788                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5789                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5790                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5791
  5792             20  CF-CO-EARNINGS-CALC        PIC X.
  5793                 88  CO-EARN-BY-R78             VALUE '1'.
  5794                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5795                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5796                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5797                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5798                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5799                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5800                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5801
  5802             20  CF-CO-REFUND-CALC          PIC X.
  5803                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5804                 88  CO-REFD-BY-R78             VALUE '1'.
  5805                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5806                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5807                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5808                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5809                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5810                 88  CO-REFD-MEAN               VALUE '8'.
  5811                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5812                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5813                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5814
  5815             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5816                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5817                 88  CO-OVRD-BY-R78             VALUE '1'.
  5818                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5819                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5820                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5821                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5822                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5823                 88  CO-OVRD-MEAN               VALUE '8'.
  5824                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5825
  5826             20  CF-CO-BEN-I-G-CD           PIC X.
  5827                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5828                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5829                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5830
  5831         16  FILLER                         PIC X(304).
  5832
  5833
  5834****************************************************************
  5835*             CARRIER MASTER RECORD                            *
  5836****************************************************************
  5837
  5838     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5839         16  CF-ADDRESS-DATA.
  5840             20  CF-MAIL-TO-NAME            PIC X(30).
  5841             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 108
* EL050.cbl
  5842             20  CF-ADDRESS-LINE-1          PIC X(30).
  5843             20  CF-ADDRESS-LINE-2          PIC X(30).
  5844             20  CF-CITY-STATE              PIC X(30).
  5845             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5846             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5847
  5848         16  CF-CLAIM-NO-CONTROL.
  5849             20  CF-CLAIM-NO-METHOD         PIC X.
  5850                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5851                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5852                 88  CLAIM-NO-SEQ               VALUE '3'.
  5853                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5854             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5855                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5856                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5857                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5858
  5859         16  CF-CHECK-NO-CONTROL.
  5860             20  CF-CHECK-NO-METHOD         PIC X.
  5861                 88  CHECK-NO-MANUAL            VALUE '1'.
  5862                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5863                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5864                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5865             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5866                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5867
  5868         16  CF-DOMICILE-STATE              PIC XX.
  5869
  5870         16  CF-EXPENSE-CONTROLS.
  5871             20  CF-EXPENSE-METHOD          PIC X.
  5872                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5873                 88  DOLLARS-PER-PMT            VALUE '2'.
  5874                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5875                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5876             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5877             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5878
  5879         16  CF-CORRESPONDENCE-CONTROL.
  5880             20  CF-LETTER-RESEND-OPT       PIC X.
  5881                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5882                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5883             20  FILLER                     PIC X(4).
  5884
  5885         16  CF-RESERVE-CONTROLS.
  5886             20  CF-MANUAL-SW               PIC X.
  5887                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5888             20  CF-FUTURE-SW               PIC X.
  5889                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5890             20  CF-PTC-SW                  PIC X.
  5891                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5892             20  CF-IBNR-SW                 PIC X.
  5893                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5894             20  CF-PTC-LF-SW               PIC X.
  5895                 88  CF-LF-PTC-USED             VALUE '1'.
  5896             20  CF-CDT-ACCESS-METHOD       PIC X.
  5897                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5898                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5899                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 109
* EL050.cbl
  5900             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5901
  5902         16  CF-CLAIM-CALC-METHOD           PIC X.
  5903             88  360-PLUS-MONTHS                VALUE '1'.
  5904             88  365-PLUS-MONTHS                VALUE '2'.
  5905             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5906             88  360-DAILY                      VALUE '4'.
  5907             88  365-DAILY                      VALUE '5'.
  5908
  5909         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5910         16  FILLER                         PIC X(11).
  5911
  5912         16  CF-LIMIT-AMOUNTS.
  5913             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5914             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5915             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5916             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5917             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5918             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5919             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5920             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5921             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5922             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5923
  5924         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5925         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5926         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5927
  5928         16  CF-ZIP-CODE.
  5929             20  CF-ZIP-PRIME.
  5930                 24  CF-ZIP-1ST             PIC X.
  5931                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5932                 24  FILLER                 PIC X(4).
  5933             20  CF-ZIP-PLUS4               PIC X(4).
  5934         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5935             20  CF-CAN-POSTAL-1            PIC XXX.
  5936             20  CF-CAN-POSTAL-2            PIC XXX.
  5937             20  FILLER                     PIC XXX.
  5938
  5939         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5940         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5941         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5942
  5943         16  CF-RATING-SWITCH               PIC X.
  5944             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5945             88  CF-NO-RATING                   VALUE 'N'.
  5946
  5947         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5948
  5949         16  CF-CARRIER-OVER-SHORT.
  5950             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5951             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5952
  5953         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5954         16  CF-SECPAY-SWITCH               PIC X.
  5955             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5956             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5957         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 110
* EL050.cbl
  5958         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5959         16  FILLER                         PIC X(444).
  5960*        16  FILLER                         PIC X(452).
  5961
  5962
  5963****************************************************************
  5964*             MORTALITY MASTER RECORD                          *
  5965****************************************************************
  5966
  5967     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5968         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5969                                INDEXED BY CF-MORT-NDX.
  5970             20  CF-MORT-TABLE              PIC X(5).
  5971             20  CF-MORT-TABLE-TYPE         PIC X.
  5972                 88  CF-MORT-JOINT              VALUE 'J'.
  5973                 88  CF-MORT-SINGLE             VALUE 'S'.
  5974                 88  CF-MORT-COMBINED           VALUE 'C'.
  5975                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5976                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5977             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5978             20  CF-MORT-AGE-METHOD         PIC XX.
  5979                 88  CF-AGE-LAST                VALUE 'AL'.
  5980                 88  CF-AGE-NEAR                VALUE 'AN'.
  5981             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5982             20  CF-MORT-ADJUSTMENT-DIRECTION
  5983                                            PIC X.
  5984                 88  CF-MINUS                   VALUE '-'.
  5985                 88  CF-PLUS                    VALUE '+'.
  5986             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5987             20  CF-MORT-JOINT-CODE         PIC X.
  5988                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5989             20  CF-MORT-PC-Q               PIC X.
  5990                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5991             20  CF-MORT-TABLE-CODE         PIC X(4).
  5992             20  CF-MORT-COMMENTS           PIC X(15).
  5993             20  FILLER                     PIC X(14).
  5994
  5995         16  FILLER                         PIC X(251).
  5996
  5997
  5998****************************************************************
  5999*             BUSSINESS TYPE MASTER RECORD                     *
  6000****************************************************************
  6001
  6002     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6003* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6004* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6005* AND RECORD 05 IS TYPES 81-99
  6006         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6007             20  CF-BUSINESS-TITLE          PIC  X(19).
  6008             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6009                                            PIC S9V9(4) COMP-3.
  6010             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6011             20  FILLER                     PIC  X.
  6012         16  FILLER                         PIC  X(248).
  6013
  6014
  6015****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 111
* EL050.cbl
  6016*             TERMINAL MASTER RECORD                           *
  6017****************************************************************
  6018
  6019     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6020
  6021         16  CF-COMPANY-TERMINALS.
  6022             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6023                                  PIC X(4).
  6024         16  FILLER               PIC X(248).
  6025
  6026
  6027****************************************************************
  6028*             LIFE EDIT MASTER RECORD                          *
  6029****************************************************************
  6030
  6031     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6032         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6033             20  CF-LIFE-CODE-IN            PIC XX.
  6034             20  CF-LIFE-CODE-OUT           PIC XX.
  6035         16  FILLER                         PIC X(248).
  6036
  6037
  6038****************************************************************
  6039*             AH EDIT MASTER RECORD                            *
  6040****************************************************************
  6041
  6042     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6043         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6044             20  CF-AH-CODE-IN              PIC XXX.
  6045             20  CF-AH-CODE-OUT             PIC XX.
  6046         16  FILLER                         PIC X(248).
  6047
  6048
  6049****************************************************************
  6050*             CREDIBILITY TABLES                               *
  6051****************************************************************
  6052
  6053     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6054         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6055                             INDEXED BY CF-CRDB-NDX.
  6056             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6057             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6058             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6059         16  FILLER                         PIC  X(332).
  6060
  6061
  6062****************************************************************
  6063*             REPORT CUSTOMIZATION RECORD                      *
  6064****************************************************************
  6065
  6066     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6067         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6068             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6069             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6070             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6071**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6072****       A T-TRANSFER.                                   ****
  6073             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 112
* EL050.cbl
  6074
  6075         16  FILLER                         PIC XX.
  6076
  6077         16  CF-CARRIER-CNTL-OPT.
  6078             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6079                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6080                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6081             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6082                                            PIC X.
  6083         16  CF-GROUP-CNTL-OPT.
  6084             20  CF-GROUP-OPT-SEQ           PIC 9.
  6085                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6086                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6087             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6088                                            PIC X(6).
  6089         16  CF-STATE-CNTL-OPT.
  6090             20  CF-STATE-OPT-SEQ           PIC 9.
  6091                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6092                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6093             20  CF-STATE-SELECT OCCURS 3 TIMES
  6094                                            PIC XX.
  6095         16  CF-ACCOUNT-CNTL-OPT.
  6096             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6097                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6098                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6099             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6100                                            PIC X(10).
  6101         16  CF-BUS-TYP-CNTL-OPT.
  6102             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6103                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6104                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6105             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6106                                            PIC XX.
  6107         16  CF-LF-TYP-CNTL-OPT.
  6108             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6109                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6110                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6111             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6112                                            PIC XX.
  6113         16  CF-AH-TYP-CNTL-OPT.
  6114             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6115                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6116                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6117             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6118                                            PIC XX.
  6119         16  CF-REPTCD1-CNTL-OPT.
  6120             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6121                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6122                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6123             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-REPTCD2-CNTL-OPT.
  6126             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6127                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6128                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6129             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6130                                            PIC X(10).
  6131         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 113
* EL050.cbl
  6132             20  CF-USER1-OPT-SEQ           PIC 9.
  6133                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6134                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6135             20  CF-USER1-SELECT OCCURS 3 TIMES
  6136                                            PIC X(10).
  6137         16  CF-USER2-CNTL-OPT.
  6138             20  CF-USER2-OPT-SEQ           PIC 9.
  6139                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6140                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6141             20  CF-USER2-SELECT OCCURS 3 TIMES
  6142                                            PIC X(10).
  6143         16  CF-USER3-CNTL-OPT.
  6144             20  CF-USER3-OPT-SEQ           PIC 9.
  6145                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6146                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6147             20  CF-USER3-SELECT OCCURS 3 TIMES
  6148                                            PIC X(10).
  6149         16  CF-USER4-CNTL-OPT.
  6150             20  CF-USER4-OPT-SEQ           PIC 9.
  6151                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6152                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6153             20  CF-USER4-SELECT OCCURS 3 TIMES
  6154                                            PIC X(10).
  6155         16  CF-USER5-CNTL-OPT.
  6156             20  CF-USER5-OPT-SEQ           PIC 9.
  6157                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6158                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6159             20  CF-USER5-SELECT OCCURS 3 TIMES
  6160                                            PIC X(10).
  6161         16  CF-REINS-CNTL-OPT.
  6162             20  CF-REINS-OPT-SEQ           PIC 9.
  6163                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6164                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6165             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6166                 24  CF-REINS-PRIME         PIC XXX.
  6167                 24  CF-REINS-SUB           PIC XXX.
  6168
  6169         16  CF-AGENT-CNTL-OPT.
  6170             20  CF-AGENT-OPT-SEQ           PIC 9.
  6171                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6172                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6173             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6174                                            PIC X(10).
  6175
  6176         16  FILLER                         PIC X(43).
  6177
  6178         16  CF-LOSS-RATIO-SELECT.
  6179             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6180             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6181         16  CF-ENTRY-DATE-SELECT.
  6182             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6183             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6184         16  CF-EFFECTIVE-DATE-SELECT.
  6185             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6186             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6187
  6188         16  CF-EXCEPTION-LIST-IND          PIC X.
  6189             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 114
* EL050.cbl
  6190
  6191         16  FILLER                         PIC X(318).
  6192
  6193****************************************************************
  6194*                  EXCEPTION REPORTING RECORD                  *
  6195****************************************************************
  6196
  6197     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6198         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6199             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6200
  6201         16  CF-COMBINED-LIFE-AH-OPT.
  6202             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6203             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6204             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6205             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6206
  6207         16  CF-LIFE-OPT.
  6208             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6209             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6210             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6211             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6212             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6213             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6214             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6215             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6216             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6217             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6218
  6219         16  CF-AH-OPT.
  6220             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6221             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6222             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6223             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6224             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6225             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6226             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6227             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6228             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6229             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6230
  6231         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6232             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6233             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6234             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6235
  6236         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6237
  6238         16  FILLER                         PIC X(673).
  6239
  6240
  6241****************************************************************
  6242*             MORTGAGE SYSTEM PLAN RECORD                      *
  6243****************************************************************
  6244
  6245     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6246         16  CF-PLAN-TYPE                   PIC X.
  6247             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 115
* EL050.cbl
  6248             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6249             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6250         16  CF-PLAN-ABBREV                 PIC XXX.
  6251         16  CF-PLAN-DESCRIPT               PIC X(10).
  6252         16  CF-PLAN-NOTES                  PIC X(20).
  6253         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6254         16  CF-PLAN-UNDERWRITING.
  6255             20  CF-PLAN-TERM-DATA.
  6256                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6257                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6258             20  CF-PLAN-AGE-DATA.
  6259                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6260                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6261                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6262             20  CF-PLAN-BENEFIT-DATA.
  6263                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6264                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6265                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6266                                            PIC S9(7)V99  COMP-3.
  6267         16  CF-PLAN-POLICY-FORMS.
  6268             20  CF-POLICY-FORM             PIC X(12).
  6269             20  CF-MASTER-APPLICATION      PIC X(12).
  6270             20  CF-MASTER-POLICY           PIC X(12).
  6271         16  CF-PLAN-RATING.
  6272             20  CF-RATE-CODE               PIC X(5).
  6273             20  CF-SEX-RATING              PIC X.
  6274                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6275                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6276             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6277             20  CF-SUB-STD-TYPE            PIC X.
  6278                 88  CF-PCT-OF-PREM            VALUE '1'.
  6279                 88  CF-PCT-OF-BENE            VALUE '2'.
  6280         16  CF-PLAN-PREM-TOLERANCES.
  6281             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6282             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6283         16  CF-PLAN-PYMT-TOLERANCES.
  6284             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6285             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6286         16  CF-PLAN-MISC-DATA.
  6287             20  FILLER                     PIC X.
  6288             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6289             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6290         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6291         16  CF-PLAN-IND-GRP                PIC X.
  6292             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6293                                                     '1'.
  6294             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6295                                                     '2'.
  6296         16  CF-MIB-SEARCH-SW               PIC X.
  6297             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6298             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6299             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6300             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6301         16  CF-ALPHA-SEARCH-SW             PIC X.
  6302             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6303             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6304             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6305             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 116
* EL050.cbl
  6306             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6307             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6308             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6309             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6310             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6311             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6312                                                     'A' 'B' 'C'
  6313                                                     'X' 'Y' 'Z'.
  6314         16  CF-EFF-DT-RULE-SW              PIC X.
  6315             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6316             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6317             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6318             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6319             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6320         16  FILLER                         PIC X(4).
  6321         16  CF-HEALTH-QUESTIONS            PIC X.
  6322             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6323         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6324         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6325         16  CF-PLAN-SNGL-JNT               PIC X.
  6326             88  CF-COMBINED-PLAN              VALUE 'C'.
  6327             88  CF-JNT-PLAN                   VALUE 'J'.
  6328             88  CF-SNGL-PLAN                  VALUE 'S'.
  6329         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6330         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6331         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6332         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6333         16  CF-RERATE-CNTL                 PIC  X.
  6334             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6335             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6336             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6337             88  CF-AUTO-RECALC                 VALUE '4'.
  6338         16  CF-BENEFIT-TYPE                PIC  X.
  6339             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6340             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6341         16  CF-POLICY-FEE                  PIC S999V99
  6342                                                    COMP-3.
  6343         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6344         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6345         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6346         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6347         16  FILLER                         PIC  X(32).
  6348         16  CF-TERMINATION-FORM            PIC  X(04).
  6349         16  FILLER                         PIC  X(08).
  6350         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6351                                                       COMP-3.
  6352         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6353         16  CF-ISSUE-LETTER                PIC  X(4).
  6354         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6355         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6356             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6357             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6358         16  CF-MP-REFUND-CALC              PIC X.
  6359             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6360             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6361             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6362             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6363             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 117
* EL050.cbl
  6364             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6365             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6366             88  CF-MP-REFD-MEAN                VALUE '8'.
  6367         16  CF-ALT-RATE-CODE               PIC  X(5).
  6368
  6369
  6370         16  FILLER                         PIC X(498).
  6371****************************************************************
  6372*             MORTGAGE COMPANY MASTER RECORD                   *
  6373****************************************************************
  6374
  6375     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6376         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6377         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6378             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6379             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6380             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6381             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6382             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6383
  6384         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6385         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6386         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6387         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6388         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6389
  6390         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6391             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6392         16  CF-MP-RECON-USE-IND            PIC X(1).
  6393             88  CF-MP-USE-RECON             VALUE 'Y'.
  6394         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6395             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6396         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6397             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6398             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6399         16  FILLER                         PIC X(1).
  6400         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6401             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6402         16  CF-MORTG-MIB-VERSION           PIC X.
  6403             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6404             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6405             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6406         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6407             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6408                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6409             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6410                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6411             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6412                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6413             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6414                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6415             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6416                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6417             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6418                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6419         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6420         16  FILLER                         PIC X(7).
  6421         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 118
* EL050.cbl
  6422             20  CF-MORTG-MIB-COMM          PIC X(5).
  6423             20  CF-MORTG-MIB-TERM          PIC X(5).
  6424         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6425             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6426         16  FILLER                         PIC X(03).
  6427         16  CF-MP-CHECK-NO-CONTROL.
  6428             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6429                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6430                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6431                                                ' ' LOW-VALUES.
  6432                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6433                                               VALUE '3'.
  6434         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6435         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6436         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6437             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6438                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6439             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6440                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6441             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6442                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6443             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6444                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6445             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6446                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6447             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6448                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6449         16  CF-MORTG-BILLING-AREA.
  6450             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6451                                            PIC X.
  6452         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6453         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6454         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6455         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6456             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6457             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6458         16  FILLER                         PIC X.
  6459         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6460             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6461             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6462         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6463         16  FILLER                         PIC X(8).
  6464         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6465         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6466         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6467         16  CF-ACH-COMPANY-ID.
  6468             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6469                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6470                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6471                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6472             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6473         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6474             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6475         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6476             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6477             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6478         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6479         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 119
* EL050.cbl
  6480         16  FILLER                         PIC X(536).
  6481
  6482****************************************************************
  6483*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6484****************************************************************
  6485
  6486     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6487         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6488             20  CF-FEMALE-HEIGHT.
  6489                 24  CF-FEMALE-FT           PIC 99.
  6490                 24  CF-FEMALE-IN           PIC 99.
  6491             20  CF-FEMALE-MIN-WT           PIC 999.
  6492             20  CF-FEMALE-MAX-WT           PIC 999.
  6493         16  FILLER                         PIC X(428).
  6494
  6495     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6496         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6497             20  CF-MALE-HEIGHT.
  6498                 24  CF-MALE-FT             PIC 99.
  6499                 24  CF-MALE-IN             PIC 99.
  6500             20  CF-MALE-MIN-WT             PIC 999.
  6501             20  CF-MALE-MAX-WT             PIC 999.
  6502         16  FILLER                         PIC X(428).
  6503******************************************************************
  6504*             AUTOMATIC ACTIVITY RECORD                          *
  6505******************************************************************
  6506     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6507         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6508             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6509             20  CF-SYS-LETTER-ID           PIC X(04).
  6510             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6511             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6512             20  CF-SYS-RESET-SW            PIC X(01).
  6513             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6514             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6515
  6516         16  FILLER                         PIC X(50).
  6517
  6518         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6519             20  CF-USER-ACTIVE-SW          PIC X(01).
  6520             20  CF-USER-LETTER-ID          PIC X(04).
  6521             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6522             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6523             20  CF-USER-RESET-SW           PIC X(01).
  6524             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6525             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6526             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6527
  6528         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 120
* EL050.cbl
  6530*    COPY ERCACCT.
  6531******************************************************************
  6532*                                                                *
  6533*                                                                *
  6534*                            ERCACCT                             *
  6535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6536*                            VMOD=2.031                          *
  6537*                                                                *
  6538*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6539*                                                                *
  6540*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6541*   VSAM ACCOUNT MASTER FILES.                                   *
  6542*                                                                *
  6543*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6544*                                                                *
  6545*   FILE TYPE = VSAM,KSDS                                        *
  6546*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6547*                                                                *
  6548*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6549*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6550*                                                                *
  6551*   LOG = NO                                                     *
  6552*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6553*                                                                *
  6554*                                                                *
  6555******************************************************************
  6556*                   C H A N G E   L O G
  6557*
  6558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6559*-----------------------------------------------------------------
  6560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6561* EFFECTIVE    NUMBER
  6562*-----------------------------------------------------------------
  6563* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6564* 092705    2005050300006  PEMA  ADD SPP LEASES
  6565* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6566* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6567* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6568* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6569* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6570* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6571******************************************************************
  6572
  6573 01  ACCOUNT-MASTER.
  6574     12  AM-RECORD-ID                      PIC XX.
  6575         88  VALID-AM-ID                      VALUE 'AM'.
  6576
  6577     12  AM-CONTROL-PRIMARY.
  6578         16  AM-COMPANY-CD                 PIC X.
  6579         16  AM-MSTR-CNTRL.
  6580             20  AM-CONTROL-A.
  6581                 24  AM-CARRIER            PIC X.
  6582                 24  AM-GROUPING.
  6583                     28 AM-GROUPING-PREFIX PIC XXX.
  6584                     28 AM-GROUPING-PRIME  PIC XXX.
  6585                 24  AM-STATE              PIC XX.
  6586                 24  AM-ACCOUNT.
  6587                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 121
* EL050.cbl
  6588                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6589             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6590                                           PIC X(19).
  6591             20  AM-CNTRL-B.
  6592                 24  AM-EXPIRATION-DT      PIC XX.
  6593                 24  FILLER                PIC X(4).
  6594             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6595                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6596
  6597     12  AM-CONTROL-BY-VAR-GRP.
  6598         16  AM-COMPANY-CD-A1              PIC X.
  6599         16  AM-VG-CARRIER                 PIC X.
  6600         16  AM-VG-GROUPING                PIC X(6).
  6601         16  AM-VG-STATE                   PIC XX.
  6602         16  AM-VG-ACCOUNT                 PIC X(10).
  6603         16  AM-VG-DATE.
  6604             20  AM-VG-EXPIRATION-DT       PIC XX.
  6605             20  FILLER                    PIC X(4).
  6606         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6607                                           PIC 9(11)      COMP-3.
  6608     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6609         16  FILLER                        PIC X(10).
  6610         16  AM-VG-KEY3.
  6611             20  AM-VG3-ACCOUNT            PIC X(10).
  6612             20  AM-VG3-EXP-DT             PIC XX.
  6613         16  FILLER                        PIC X(4).
  6614     12  AM-MAINT-INFORMATION.
  6615         16  AM-LAST-MAINT-DT              PIC XX.
  6616         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6617         16  AM-LAST-MAINT-USER            PIC X(4).
  6618         16  FILLER                        PIC XX.
  6619
  6620     12  AM-EFFECTIVE-DT                   PIC XX.
  6621     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6622
  6623     12  AM-PREV-DATES  COMP-3.
  6624         16  AM-PREV-EXP-DT                PIC 9(11).
  6625         16  AM-PREV-EFF-DT                PIC 9(11).
  6626
  6627     12  AM-REPORT-CODE-1                  PIC X(10).
  6628     12  AM-REPORT-CODE-2                  PIC X(10).
  6629
  6630     12  AM-CITY-CODE                      PIC X(4).
  6631     12  AM-COUNTY-PARISH                  PIC X(6).
  6632
  6633     12  AM-NAME                           PIC X(30).
  6634     12  AM-PERSON                         PIC X(30).
  6635     12  AM-ADDRS                          PIC X(30).
  6636     12  AM-CITY.
  6637         16  AM-ADDR-CITY                  PIC X(28).
  6638         16  AM-ADDR-STATE                 PIC XX.
  6639     12  AM-ZIP.
  6640         16  AM-ZIP-PRIME.
  6641             20  AM-ZIP-PRI-1ST            PIC X.
  6642                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6643             20  FILLER                    PIC X(4).
  6644         16  AM-ZIP-PLUS4                  PIC X(4).
  6645     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 122
* EL050.cbl
  6646         16  AM-CAN-POSTAL-1               PIC XXX.
  6647         16  AM-CAN-POSTAL-2               PIC XXX.
  6648         16  FILLER                        PIC XXX.
  6649     12  AM-TEL-NO.
  6650         16  AM-AREA-CODE                  PIC 999.
  6651         16  AM-TEL-PRE                    PIC 999.
  6652         16  AM-TEL-NBR                    PIC 9(4).
  6653     12  AM-TEL-LOC                        PIC X.
  6654         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6655         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6656
  6657     12  AM-COMM-STRUCTURE.
  6658         16  AM-DEFN-1.
  6659             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6660                 24  AM-AGT.
  6661                     28  AM-AGT-PREFIX     PIC X(4).
  6662                     28  AM-AGT-PRIME      PIC X(6).
  6663                 24  AM-COM-TYP            PIC X.
  6664                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6665                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6666                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6667                 24  AM-RECALC-LV-INDIC    PIC X.
  6668                 24  AM-RETRO-LV-INDIC     PIC X.
  6669                 24  AM-GL-CODES           PIC X.
  6670                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6671                 24  FILLER                PIC X(01).
  6672         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6673             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6674                 24  FILLER                PIC X(11).
  6675                 24  AM-L-COMA             PIC XXX.
  6676                 24  AM-J-COMA             PIC XXX.
  6677                 24  AM-A-COMA             PIC XXX.
  6678                 24  FILLER                PIC X(6).
  6679
  6680     12  AM-COMM-CHANGE-STATUS             PIC X.
  6681         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6682
  6683     12  AM-CSR-CODE                       PIC X(4).
  6684
  6685     12  AM-BILLING-STATUS                 PIC X.
  6686         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6687         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6688     12  AM-AUTO-REFUND-SW                 PIC X.
  6689         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6690         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6691     12  AM-GPCD                           PIC 99.
  6692     12  AM-IG                             PIC X.
  6693         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6694         88  AM-HAS-GROUP                     VALUE '2'.
  6695     12  AM-STATUS                         PIC X.
  6696         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6697         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6698         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6699         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6700         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6701         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6702         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6703         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 123
* EL050.cbl
  6704         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6705         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6706     12  AM-REMIT-TO                       PIC 99.
  6707     12  AM-ID-NO                          PIC X(11).
  6708
  6709     12  AM-CAL-TABLE                      PIC XX.
  6710     12  AM-LF-DEVIATION                   PIC XXX.
  6711     12  AM-AH-DEVIATION                   PIC XXX.
  6712     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6713     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6714     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6715     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6716     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6717     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6718
  6719     12  AM-USER-FIELDS.
  6720         16  AM-FLD-1                      PIC XX.
  6721         16  AM-FLD-2                      PIC XX.
  6722         16  AM-FLD-3                      PIC XX.
  6723         16  AM-FLD-4                      PIC XX.
  6724         16  AM-FLD-5                      PIC XX.
  6725
  6726     12  AM-1ST-PROD-DATE.
  6727         16  AM-1ST-PROD-YR                PIC XX.
  6728         16  AM-1ST-PROD-MO                PIC XX.
  6729         16  AM-1ST-PROD-DA                PIC XX.
  6730     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6731     12  AM-CERTS-PURGED-DATE.
  6732         16  AM-PUR-YR                     PIC XX.
  6733         16  AM-PUR-MO                     PIC XX.
  6734         16  AM-PUR-DA                     PIC XX.
  6735     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6736     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6737     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6738     12  AM-INACTIVE-DATE.
  6739         16  AM-INA-MO                     PIC 99.
  6740         16  AM-INA-DA                     PIC 99.
  6741         16  AM-INA-YR                     PIC 99.
  6742     12  AM-AR-HI-CERT-DATE                PIC XX.
  6743
  6744     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6745     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6746
  6747     12  AM-OB-PAYMENT-MODE                PIC X.
  6748         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6749         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6750         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6751         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6752
  6753     12  AM-AH-ONLY-INDICATOR              PIC X.
  6754         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6755         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6756
  6757     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6758
  6759     12  AM-OVER-SHORT.
  6760         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6761         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 124
* EL050.cbl
  6762
  6763     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6764     12  AM-DCC-CLP-STATE                  PIC XX.
  6765
  6766     12  AM-RECALC-COMM                    PIC X.
  6767     12  AM-RECALC-REIN                    PIC X.
  6768
  6769     12  AM-REI-TABLE                      PIC XXX.
  6770     12  AM-REI-ET-LF                      PIC X.
  6771     12  AM-REI-ET-AH                      PIC X.
  6772     12  AM-REI-PE-LF                      PIC X.
  6773     12  AM-REI-PE-AH                      PIC X.
  6774     12  AM-REI-PRT-ST                     PIC X.
  6775     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6776     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6777     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6778     12  AM-REI-GROUP-A                    PIC X(6).
  6779     12  AM-REI-MORT                       PIC X(4).
  6780     12  AM-REI-PRT-OW                     PIC X.
  6781     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6782     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6783     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6784     12  AM-REI-GROUP-B                    PIC X(6).
  6785
  6786     12  AM-TRUST-TYPE                     PIC X(2).
  6787
  6788     12  AM-EMPLOYER-STMT-USED             PIC X.
  6789     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6790
  6791     12  AM-STD-AH-TYPE                    PIC XX.
  6792     12  AM-EARN-METHODS.
  6793         16  AM-EARN-METHOD-R              PIC X.
  6794             88 AM-REF-RL-R78                 VALUE 'R'.
  6795             88 AM-REF-RL-PR                  VALUE 'P'.
  6796             88 AM-REF-RL-MEAN                VALUE 'M'.
  6797             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6798         16  AM-EARN-METHOD-L              PIC X.
  6799             88 AM-REF-LL-R78                 VALUE 'R'.
  6800             88 AM-REF-LL-PR                  VALUE 'P'.
  6801             88 AM-REF-LL-MEAN                VALUE 'M'.
  6802             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6803         16  AM-EARN-METHOD-A              PIC X.
  6804             88 AM-REF-AH-R78                 VALUE 'R'.
  6805             88 AM-REF-AH-PR                  VALUE 'P'.
  6806             88 AM-REF-AH-MEAN                VALUE 'M'.
  6807             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6808             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6809             88 AM-REF-AH-NET                 VALUE 'N'.
  6810
  6811     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6812     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6813     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6814
  6815     12  AM-RET-Y-N                        PIC X.
  6816     12  AM-RET-P-E                        PIC X.
  6817     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6818     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6819     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 125
* EL050.cbl
  6820     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6821         16  AM-POOL-PRIME                 PIC XXX.
  6822         16  AM-POOL-SUB                   PIC XXX.
  6823     12  AM-RETRO-EARNINGS.
  6824         16  AM-RET-EARN-R                 PIC X.
  6825         16  AM-RET-EARN-L                 PIC X.
  6826         16  AM-RET-EARN-A                 PIC X.
  6827     12  AM-RET-ST-TAX-USE                 PIC X.
  6828         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6829         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6830     12  AM-RETRO-BEG-EARNINGS.
  6831         16  AM-RET-BEG-EARN-R             PIC X.
  6832         16  AM-RET-BEG-EARN-L             PIC X.
  6833         16  AM-RET-BEG-EARN-A             PIC X.
  6834     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6835     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6836
  6837     12  AM-USER-SELECT-OPTIONS.
  6838         16  AM-USER-SELECT-1              PIC X(10).
  6839         16  AM-USER-SELECT-2              PIC X(10).
  6840         16  AM-USER-SELECT-3              PIC X(10).
  6841         16  AM-USER-SELECT-4              PIC X(10).
  6842         16  AM-USER-SELECT-5              PIC X(10).
  6843
  6844     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6845
  6846     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6847
  6848     12  AM-RPT045A-SWITCH                 PIC X.
  6849         88  RPT045A-OFF                   VALUE 'N'.
  6850
  6851     12  AM-INSURANCE-LIMITS.
  6852         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6853         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6854
  6855     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6856         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6857
  6858     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6859         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6860         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6861
  6862     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6863
  6864     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6865     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6866     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6867     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6868     12  AM-DCC-UEF-STATE                  PIC XX.
  6869     12  FILLER                            PIC XXX.
  6870     12  AM-REPORT-CODE-3                  PIC X(10).
  6871*    12  FILLER                            PIC X(22).
  6872
  6873     12  AM-RESERVE-DATE.
  6874         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6875         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6876         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6877
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 126
* EL050.cbl
  6878     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6879     12  AM-NOTIFICATION-TYPES.
  6880         16  AM-NOTIF-OF-LETTERS           PIC X.
  6881         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6882         16  AM-NOTIF-OF-REPORTS           PIC X.
  6883         16  AM-NOTIF-OF-STATUS            PIC X.
  6884
  6885     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6886         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6887         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6888         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6889         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6890
  6891     12  AM-BENEFIT-CONTROLS.
  6892         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6893             20  AM-BENEFIT-CODE           PIC XX.
  6894             20  AM-BENEFIT-TYPE           PIC X.
  6895             20  AM-BENEFIT-REVISION       PIC XXX.
  6896             20  AM-BENEFIT-REM-TERM       PIC X.
  6897             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6898             20  FILLER                    PIC XX.
  6899         16  FILLER                        PIC X(80).
  6900
  6901     12  AM-TRANSFER-DATA.
  6902         16  AM-TRANSFERRED-FROM.
  6903             20  AM-TRNFROM-CARRIER        PIC X.
  6904             20  AM-TRNFROM-GROUPING.
  6905                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6906                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6907             20  AM-TRNFROM-STATE          PIC XX.
  6908             20  AM-TRNFROM-ACCOUNT.
  6909                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6910                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6911             20  AM-TRNFROM-DTE            PIC XX.
  6912         16  AM-TRANSFERRED-TO.
  6913             20  AM-TRNTO-CARRIER          PIC X.
  6914             20  AM-TRNTO-GROUPING.
  6915                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6916                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6917             20  AM-TRNTO-STATE            PIC XX.
  6918             20  AM-TRNTO-ACCOUNT.
  6919                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6920                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6921             20  AM-TRNTO-DTE              PIC XX.
  6922         16  FILLER                        PIC X(10).
  6923
  6924     12  AM-SAVED-REMIT-TO                 PIC 99.
  6925
  6926     12  AM-COMM-STRUCTURE-SAVED.
  6927         16  AM-DEFN-1-SAVED.
  6928             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6929                 24  AM-AGT-SV             PIC X(10).
  6930                 24  AM-COM-TYP-SV         PIC X.
  6931                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6932                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6933                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6934                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6935                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 127
* EL050.cbl
  6936                 24  AM-GL-CODES-SV        PIC X.
  6937                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6938                 24  FILLER                PIC X.
  6939         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6940             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6941                 24  FILLER                PIC X(11).
  6942                 24  AM-L-COMA-SV          PIC XXX.
  6943                 24  AM-J-COMA-SV          PIC XXX.
  6944                 24  AM-A-COMA-SV          PIC XXX.
  6945                 24  FILLER                PIC X(6).
  6946
  6947     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6948         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6949            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6950            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6951            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6952
  6953     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6954     12  FILLER                            PIC X(120).
  6955
  6956     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6957         16  AM-CONTROL-NAME               PIC X(30).
  6958         16  AM-EXECUTIVE-ONE.
  6959             20  AM-EXEC1-NAME             PIC X(15).
  6960             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6961                                                          COMP-3.
  6962             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6963                                                          COMP-3.
  6964         16  AM-EXECUTIVE-TWO.
  6965             20  AM-EXEC2-NAME             PIC X(15).
  6966             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6967                                                          COMP-3.
  6968             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6969                                                          COMP-3.
  6970
  6971     12  AM-RETRO-ADDITIONAL-DATA.
  6972         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6973         16  AM-RETRO-PREM-P-E             PIC X.
  6974         16  AM-RETRO-CLMS-P-I             PIC X.
  6975         16  AM-RETRO-RET-BRACKET-LF.
  6976             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6977                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6978                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6979             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6980                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6981                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6982             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6983                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6984                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6985         16  AM-RETRO-RET-BRACKET-AH.
  6986             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6987                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6988                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6989                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6990             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6991                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6992                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6993             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 128
* EL050.cbl
  6994                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6995                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6996
  6997     12  AM-COMMENTS.
  6998         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6999
  7000     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7001         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7002         16  AM-FLI-BILLING-CODE           PIC X.
  7003         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7004         16  AM-FLI-UNITED-IDENT           PIC X.
  7005         16  AM-FLI-INTEREST-LOST-DATA.
  7006             20  AM-FLI-BANK-NO            PIC X(5).
  7007             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7008             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7009             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7010         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7011             20  AM-FLI-AGT                PIC X(9).
  7012             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7013             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7014         16  FILLER                        PIC X(102).
  7015
  7016     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7017         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7018             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7019             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7020             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7021             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7022             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7023         16  FILLER                          PIC X(10).
  7024******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 129
* EL050.cbl
  7026*    COPY ERCREIN.
  7027******************************************************************
  7028*                                                                *
  7029*                            ERCREIN                             *
  7030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7031*                            VMOD=2.010                          *
  7032*                                                                *
  7033*   ONLINE CREDIT SYSTEM                                         *
  7034*                                                                *
  7035*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7036*                                                                *
  7037*   FILE TYPE = VSAM,KSDS                                        *
  7038*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7039*                                                                *
  7040*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7041*       ALTERNATE PATH = NONE                                    *
  7042*                                                                *
  7043*   LOG = NO                                                     *
  7044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7045*                                                                *
  7046******************************************************************
  7047*                   C H A N G E   L O G
  7048*
  7049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7050*-----------------------------------------------------------------
  7051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7052* EFFECTIVE    NUMBER
  7053*-----------------------------------------------------------------
  7054* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7055* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7056******************************************************************
  7057 01  REINSURANCE-RECORD.
  7058     12  RE-RECORD-ID                      PIC XX.
  7059         88  VALID-RE-ID                      VALUE 'RE'.
  7060
  7061     12  RE-CONTROL-PRIMARY.
  7062         16  RE-COMPANY-CD                 PIC X.
  7063         16  RE-KEY.
  7064             20  RE-CODE                   PIC X.
  7065                 88  RE-TABLE-RECORD          VALUE 'A'.
  7066                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7067             20  RE-TABLE                  PIC XXX.
  7068             20  FILLER                    PIC XXX.
  7069         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7070             20  FILLER                    PIC X.
  7071             20  RE-COMPANY.
  7072                 24  RE-COMP-PRIME         PIC XXX.
  7073                 24  RE-COMP-SUB           PIC XXX.
  7074
  7075     12  RE-MAINT-INFORMATION.
  7076         16  RE-LAST-MAINT-DT              PIC XX.
  7077         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7078         16  RE-LAST-MAINT-USER            PIC X(4).
  7079         16  FILLER                        PIC X(10).
  7080
  7081     12  RE-TABLE-DATA.
  7082         16  RE-100-COMP                   PIC 99.
  7083
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 130
* EL050.cbl
  7084         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7085             20  RE-REI-COMP-NO.
  7086                 24  RE-REI-COMP           PIC XXX.
  7087                 24  RE-REI-COMP-SUB       PIC XXX.
  7088             20  RE-LF-QC                  PIC X.
  7089             20  RE-AH-QC                  PIC X.
  7090             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7091             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7092             20  RE-LFAGE-LO               PIC 99.
  7093             20  RE-LFAGE-HI               PIC 99.
  7094             20  RE-AHAGE-LO               PIC 99.
  7095             20  RE-AHAGE-HI               PIC 99.
  7096             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7097             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7098             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7099             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7100             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7101             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7102             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7103             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7104             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7105             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7106             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7107             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7108             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7109             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7110             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7111             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7112             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7113             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7114             20  RE-LF-BEN-CODE            PIC X.
  7115             20  RE-AH-BEN-CODE            PIC X.
  7116             20  RE-INTERACTIVE            PIC X.
  7117             20  RE-REMAINING              PIC X.
  7118             20  RE-LF-RUNOFF-SW           PIC X.
  7119             20  RE-AH-RUNOFF-SW           PIC X.
  7120             20  FILLER                    PIC X(19).
  7121
  7122         16  RE-COMP-INFO-END              PIC X(6).
  7123         16  RE-NSP-ST-CD-LF               PIC XX.
  7124         16  RE-NSP-ST-CD-AH               PIC XX.
  7125         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7126             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7127
  7128         16  FILLER                        PIC X(27).
  7129
  7130     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7131         16  RE-NAME                       PIC X(30).
  7132         16  RE-LF-PE                      PIC X.
  7133         16  RE-AH-PE                      PIC X.
  7134         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7135         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7136         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7137         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7138         16  RE-PRT-ST                     PIC X.
  7139         16  RE-PRT-OW                     PIC X.
  7140         16  RE-MORT-CODE                  PIC X(4).
  7141         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 131
* EL050.cbl
  7142         16  RE-ZERO-LF-FEE                PIC X.
  7143         16  RE-ZERO-AH-FEE                PIC X.
  7144         16  RE-CEDE-NAME                  PIC X(30).
  7145         16  RE-LF-COMM                    PIC X.
  7146         16  RE-AH-COMM                    PIC X.
  7147         16  RE-LF-TAX                     PIC X.
  7148         16  RE-AH-TAX                     PIC X.
  7149         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7150         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7151         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7152
  7153         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7154             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7155
  7156         16  RE-LF-CEDING-FEE-BRACKETS.
  7157             20  RE-LF-FEE-METHOD          PIC X.
  7158                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7159                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7160                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7161                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7162             20  RE-LF-FEE-BASIS           PIC X.
  7163                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7164                 88  RE-LF-NET-CEDED               VALUE '2'.
  7165                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7166                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7167                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7168                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7169                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7170                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7171             20  FILLER                    PIC XXX.
  7172             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7173                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7174                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7175
  7176         16  RE-AH-CEDING-FEE-BRACKETS.
  7177             20  RE-AH-FEE-METHOD          PIC X.
  7178                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7179                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7180                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7181                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7182             20  RE-AH-FEE-BASIS           PIC X.
  7183                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7184                 88  RE-AH-NET-CEDED               VALUE '2'.
  7185                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7186                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7187                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7188                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7189                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7190                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7191             20  FILLER                    PIC XXX.
  7192             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7193                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7194                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7195
  7196         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7197
  7198         16  RE-OLD-CEDING-STMT            PIC X.
  7199
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 132
* EL050.cbl
  7200         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7201         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7202         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7203         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7204         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7205         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7206         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7207         16  RE-MORT-SW                    PIC X.
  7208         16  RE-CEDING-TYPE-FLAG           PIC X.
  7209             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7210             88  RE-CEDED                          VALUE 'C'.
  7211             88  RE-ASSUMED                        VALUE 'A'.
  7212             88  RE-PHANTOM                        VALUE 'P'.
  7213
  7214         16  RE-CEDING-STMT-OPT-A          PIC X.
  7215             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7216         16  RE-CEDING-STMT-OPT-B          PIC X.
  7217             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7218         16  RE-CEDING-STMT-OPT-C          PIC X.
  7219             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7220         16  RE-CEDING-STMT-OPT-D          PIC X.
  7221             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7222         16  RE-CEDING-STMT-OPT-E          PIC X.
  7223             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7224
  7225         16  RE-PRT-CRSV                   PIC X.
  7226
  7227         16  RE-GL-CENTER                  PIC X(4).
  7228
  7229         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7230
  7231         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7232
  7233         16  RE-EARN-STOP-CODE             PIC X.
  7234             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7235             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7236
  7237         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7238             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7239
  7240         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7241         16  FILLER                        PIC X(2281).
  7242
  7243         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7244
  7245******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 133
* EL050.cbl
  7247*    COPY ERCCTBL.
  7248******************************************************************
  7249*                                                                *
  7250*                                                                *
  7251*                            ERCCTBL                             *
  7252*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7253*                            VMOD=2.003
  7254*                                                                *
  7255*   ONLINE CREDIT SYSTEM                                         *
  7256*                                                                *
  7257*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7258*                                                                *
  7259*   FILE TYPE = VSAM,KSDS                                        *
  7260*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7261*                                                                *
  7262*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7263*       ALTERNATE PATH = NONE                                    *
  7264*                                                                *
  7265*   LOG = NO                                                     *
  7266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7267*                                                                *
  7268*                                                                *
  7269******************************************************************
  7270
  7271 01  COMM-TABLE-RECORD.
  7272     12  CT-RECORD-ID                      PIC XX.
  7273         88  VALID-CT-ID                      VALUE 'CT'.
  7274
  7275     12  CT-CONTROL-PRIMARY.
  7276         16  CT-COMPANY-CD                 PIC X.
  7277         16  CT-TABLE                      PIC XXX.
  7278         16  CT-CNTRL-2.
  7279             20  CT-BEN-TYPE               PIC X.
  7280             20  CT-BEN-CODE               PIC XX.
  7281
  7282     12  CT-MAINT-INFORMATION.
  7283         16  CT-LAST-MAINT-DT              PIC XX.
  7284         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7285         16  CT-LAST-MAINT-USER            PIC X(4).
  7286         16  FILLER                        PIC X(31).
  7287
  7288     12  CT-LIMITS.
  7289         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7290
  7291         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7292
  7293         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7294
  7295     12  CT-RATES.
  7296         16  CT-RTX          OCCURS 27 TIMES.
  7297             20  CT-RT                     PIC SV9(5)     COMP-3.
  7298             20  CT-RT-R   REDEFINES
  7299                 CT-RT                     PIC XXX.
  7300
  7301     12  FILLER                            PIC  X(42).
  7302
  7303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 134
* EL050.cbl
  7305*    COPY ERCFORM.
  7306******************************************************************
  7307*                                                                *
  7308*                                                                *
  7309*                            ERCFORM.                            *
  7310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7311*                            VMOD=2.003                          *
  7312*                                                                *
  7313*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7314*                                                                *
  7315*    FILE TYPE = VSAM,KSDS                                       *
  7316*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7317*                                                                *
  7318*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7319*                                                                *
  7320*    LOG = YES                                                   *
  7321*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7322******************************************************************
  7323 01  FORM-MASTER.
  7324    12  FO-RECORD-ID                 PIC X(02).
  7325        88  VALID-FO-ID                  VALUE 'FO'.
  7326
  7327    12  FO-CONTROL-PRIMARY.
  7328        16  FO-COMPANY-CD            PIC X(01).
  7329        16  FO-STATE                 PIC X(02).
  7330        16  FO-FORM-ID               PIC X(12).
  7331        16  FO-FORM-EXP-DT           PIC X(02).
  7332
  7333    12  FO-POLICY-FORM-DATA.
  7334        16  FO-IND-GRP-CD            PIC X(01).
  7335        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7336        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7337        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7338        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7339        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7340        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7341        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7342        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7343        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7344        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7345        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7346        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7347        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7348        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7349        16  FO-APP-CERT-USE-CD       PIC X(01).
  7350
  7351    12  FILLER                       PIC X(29).
  7352
  7353    12  FO-FORM-PLAN-TABLE.
  7354        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7355            20  FO-PLAN-TYPE         PIC X(01).
  7356            20  FO-PLAN-ID           PIC X(02).
  7357            20  FO-PLAN-TERM         PIC 9(03).
  7358            20  FO-PLAN-REFUND-METHOD
  7359                                     PIC X.
  7360
  7361    12  FILLER                       PIC X(30).
  7362
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 135
* EL050.cbl
  7363    12  FO-COMMENTS-AREA.
  7364        16  FO-COMMENT-LINE-1        PIC X(78).
  7365
  7366    12  FILLER                       PIC X(20).
  7367
  7368    12  FO-MAINT-INFORMATION.
  7369        16  FO-LAST-MAINT-DT         PIC X(02).
  7370        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7371        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 136
* EL050.cbl
  7373*    COPY ELCMSTR.
  7374******************************************************************
  7375*                                                                *
  7376*                            ELCMSTR.                            *
  7377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7378*                            VMOD=2.012                          *
  7379*                                                                *
  7380*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7381*                                                                *
  7382*   FILE TYPE = VSAM,KSDS                                        *
  7383*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7384*                                                                *
  7385*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7386*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7387*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7388*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7389*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7390*                                                 RKP=75,LEN=21  *
  7391*                                                                *
  7392*   **** NOTE ****                                               *
  7393*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7394*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7395*                                                                *
  7396*   LOG = YES                                                    *
  7397*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7398******************************************************************
  7399*                   C H A N G E   L O G
  7400*
  7401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7402*-----------------------------------------------------------------
  7403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7404* EFFECTIVE    NUMBER
  7405*-----------------------------------------------------------------
  7406* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7407* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7408* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7409* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7410* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7411******************************************************************
  7412 01  CLAIM-MASTER.
  7413     12  CL-RECORD-ID                PIC XX.
  7414         88  VALID-CL-ID         VALUE 'CL'.
  7415
  7416     12  CL-CONTROL-PRIMARY.
  7417         16  CL-COMPANY-CD           PIC X.
  7418         16  CL-CARRIER              PIC X.
  7419         16  CL-CLAIM-NO             PIC X(7).
  7420         16  CL-CERT-NO.
  7421             20  CL-CERT-PRIME       PIC X(10).
  7422             20  CL-CERT-SFX         PIC X.
  7423
  7424     12  CL-CONTROL-BY-NAME.
  7425         16  CL-COMPANY-CD-A1        PIC X.
  7426         16  CL-INSURED-LAST-NAME    PIC X(15).
  7427         16  CL-INSURED-NAME.
  7428             20  CL-INSURED-1ST-NAME PIC X(12).
  7429             20  CL-INSURED-MID-INIT PIC X.
  7430
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 137
* EL050.cbl
  7431     12  CL-CONTROL-BY-SSN.
  7432         16  CL-COMPANY-CD-A2        PIC X.
  7433         16  CL-SOC-SEC-NO.
  7434             20  CL-SSN-STATE        PIC XX.
  7435             20  CL-SSN-ACCOUNT      PIC X(6).
  7436             20  CL-SSN-LN3          PIC X(3).
  7437
  7438     12  CL-CONTROL-BY-CERT-NO.
  7439         16  CL-COMPANY-CD-A4        PIC X.
  7440         16  CL-CERT-NO-A4.
  7441             20  CL-CERT-A4-PRIME    PIC X(10).
  7442             20  CL-CERT-A4-SFX      PIC X.
  7443
  7444     12  CL-CONTROL-BY-CCN.
  7445         16  CL-COMPANY-CD-A5        PIC X.
  7446         16  CL-CCN-A5.
  7447             20  CL-CCN.
  7448                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7449                 24  CL-CCN-PRIME-A5 PIC X(12).
  7450             20  CL-CCN-FILLER-A5    PIC X(4).
  7451
  7452     12  CL-INSURED-PROFILE-DATA.
  7453         16  CL-INSURED-BIRTH-DT     PIC XX.
  7454         16  CL-INSURED-SEX-CD       PIC X.
  7455             88  INSURED-IS-MALE        VALUE 'M'.
  7456             88  INSURED-IS-FEMALE      VALUE 'F'.
  7457             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7458         16  CL-INSURED-OCC-CD       PIC X(6).
  7459         16  FILLER                  PIC X(5).
  7460
  7461     12  CL-PROCESSING-INFO.
  7462         16  CL-PROCESSOR-ID         PIC X(4).
  7463         16  CL-CLAIM-STATUS         PIC X.
  7464             88  CLAIM-IS-OPEN          VALUE 'O'.
  7465             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7466         16  CL-CLAIM-TYPE           PIC X.
  7467*            88  AH-CLAIM               VALUE 'A'.
  7468*            88  LIFE-CLAIM             VALUE 'L'.
  7469*            88  PROPERTY-CLAIM         VALUE 'P'.
  7470*            88  IUI-CLAIM              VALUE 'I'.
  7471*            88  GAP-CLAIM              VALUE 'G'.
  7472*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7473         16  CL-CLAIM-PREM-TYPE      PIC X.
  7474             88  SINGLE-PREMIUM         VALUE '1'.
  7475             88  O-B-COVERAGE           VALUE '2'.
  7476             88  OPEN-END-COVERAGE      VALUE '3'.
  7477         16  CL-INCURRED-DT          PIC XX.
  7478         16  CL-REPORTED-DT          PIC XX.
  7479         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7480         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7481         16  CL-LAST-PMT-DT          PIC XX.
  7482         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7483         16  CL-PAID-THRU-DT         PIC XX.
  7484         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7485         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7486         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7487         16  CL-PMT-CALC-METHOD      PIC X.
  7488             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 138
* EL050.cbl
  7489             88  CL-365-DAY-YR          VALUE '2'.
  7490             88  CL-FULL-MONTHS         VALUE '3'.
  7491         16  CL-CAUSE-CD             PIC X(6).
  7492
  7493         16  CL-PRIME-CERT-NO.
  7494             20  CL-PRIME-CERT-PRIME PIC X(10).
  7495             20  CL-PRIME-CERT-SFX   PIC X.
  7496
  7497         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7498             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7499             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7500
  7501         16  CL-MICROFILM-NO         PIC X(10).
  7502         16  FILLER REDEFINES CL-MICROFILM-NO.
  7503             20  CL-BENEFIT-PERIOD   PIC 99.
  7504             20  FILLER              PIC X(8).
  7505         16  CL-PROG-FORM-TYPE       PIC X.
  7506         16  CL-LAST-ADD-ON-DT       PIC XX.
  7507
  7508         16  CL-LAST-REOPEN-DT       PIC XX.
  7509         16  CL-LAST-CLOSE-DT        PIC XX.
  7510         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7511             88  FINAL-PAID             VALUE '1'.
  7512             88  CLAIM-DENIED           VALUE '2'.
  7513             88  AUTO-CLOSE             VALUE '3'.
  7514             88  MANUAL-CLOSE           VALUE '4'.
  7515             88  BENEFITS-CHANGED       VALUE 'C'.
  7516             88  SETUP-ERRORS           VALUE 'E'.
  7517         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7518         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7519         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7520             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7521         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7522         16  FILLER                  PIC X.
  7523
  7524     12  CL-CERTIFICATE-DATA.
  7525         16  CL-CERT-ORIGIN          PIC X.
  7526             88  CERT-WAS-ONLINE        VALUE '1'.
  7527             88  CERT-WAS-CREATED       VALUE '2'.
  7528             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7529         16  CL-CERT-KEY-DATA.
  7530             20  CL-CERT-CARRIER     PIC X.
  7531             20  CL-CERT-GROUPING    PIC X(6).
  7532             20  CL-CERT-STATE       PIC XX.
  7533             20  CL-CERT-ACCOUNT.
  7534                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7535                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7536             20  CL-CERT-EFF-DT      PIC XX.
  7537
  7538     12  CL-STATUS-CONTROLS.
  7539         16  CL-PRIORITY-CD          PIC X.
  7540             88  CONFIDENTIAL-DATA      VALUE '8'.
  7541             88  HIGHEST-PRIORITY       VALUE '9'.
  7542         16  CL-SUPV-ATTN-CD         PIC X.
  7543             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7544             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7545         16  CL-PURGED-DT            PIC XX.
  7546         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 139
* EL050.cbl
  7547         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7548         16  CL-NEXT-RESEND-DT       PIC XX.
  7549         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7550         16  CL-CRITICAL-PERIOD      PIC 99.
  7551*        16  FILLER                  PIC XX.
  7552         16  CL-LAST-MAINT-DT        PIC XX.
  7553         16  CL-LAST-MAINT-USER      PIC X(4).
  7554         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7555         16  CL-LAST-MAINT-TYPE      PIC X.
  7556             88  CLAIM-SET-UP           VALUE ' '.
  7557             88  PAYMENT-MADE           VALUE '1'.
  7558             88  LETTER-SENT            VALUE '2'.
  7559             88  MASTER-WAS-ALTERED     VALUE '3'.
  7560             88  MASTER-WAS-RESTORED    VALUE '4'.
  7561             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7562             88  FILE-CONVERTED         VALUE '6'.
  7563             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7564             88  ERROR-CORRECTION       VALUE 'E'.
  7565         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7566         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7567         16  CL-BENEFICIARY          PIC X(10).
  7568         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7569         16  CL-DENIAL-TYPE          PIC X.
  7570             88  CL-TYPE-DENIAL          VALUE '1'.
  7571             88  CL-TYPE-RESCISSION      VALUE '2'.
  7572             88  CL-TYPE-REFORMATION     VALUE '3'.
  7573             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7574             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7575         16  filler                  pic x(5).
  7576*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7577*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7578*        16  CL-RTW-DT               PIC XX.
  7579
  7580     12  CL-TRAILER-CONTROLS.
  7581         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7582             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7583             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7584             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7585         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7586         16  FILLER                  PIC XX.
  7587         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7588         16  CL-ADDRESS-TRAILER-CNT.
  7589             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7590                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7591             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7592                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7593             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7594                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7595             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7596                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7597             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7598                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7599             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7600                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7601             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7602                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7603
  7604     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 140
* EL050.cbl
  7605         16  CL-CV-REFNO-PRIME       PIC X(18).
  7606         16  CL-CV-REFNO-SFX         PIC XX.
  7607
  7608     12  CL-FILE-LOCATION            PIC X(4).
  7609
  7610     12  CL-PROCESS-ERRORS.
  7611         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7612             88  NO-FATAL-ERRORS        VALUE ZERO.
  7613         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7614             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7615
  7616     12  CL-PRODUCT-CD               PIC X.
  7617
  7618     12  CL-CURRENT-KEY-DATA.
  7619         16  CL-CURRENT-CARRIER      PIC X.
  7620         16  CL-CURRENT-GROUPING     PIC X(6).
  7621         16  CL-CURRENT-STATE        PIC XX.
  7622         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7623
  7624     12  CL-ASSOCIATES               PIC X.
  7625         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7626         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7627         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7628         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7629
  7630     12  CL-ACTIVITY-CODE            PIC 99.
  7631     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7632     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7633
  7634     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7635     12  CL-LAG-REPORT-CODE          PIC 9.
  7636     12  CL-LOAN-TYPE                PIC XX.
  7637     12  CL-LEGAL-STATE              PIC XX.
  7638
  7639     12  CL-YESNOSW                  PIC X.
  7640     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7641         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7642         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7643         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7644     12  cl-insured-type             pic x.
  7645         88  cl-claim-on-primary         value 'P'.
  7646         88  cl-claim-on-co-borrower     value 'C'.
  7647     12  cl-benefit-expiration-dt    PIC XX.
  7648
  7649 01  PLAN-RECORDS.
  7650     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7651     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7652
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 141
* EL050.cbl
  7654 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7655                          ACCOUNT-MASTER REINSURANCE-RECORD
  7656                          COMM-TABLE-RECORD FORM-MASTER
  7657                          CLAIM-MASTER PLAN-RECORDS.
  7658 0000-DFHEXIT SECTION.
  7659     MOVE '9#                    $   ' TO DFHEIV0.
  7660     MOVE 'EL050' TO DFHEIV1.
  7661     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7662
  7663     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7664
  7665
  7666* EXEC CICS  HANDLE CONDITION
  7667*           ERROR    (9300-ABEND)
  7668*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7669*    END-EXEC.
  7670*    MOVE '"$.J                  ! " #00007661' TO DFHEIV0
  7671     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7673     MOVE X'2220233030303037363631' TO DFHEIV0(25:11)
  7674     CALL 'kxdfhei1' USING DFHEIV0
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678 0000-COPY-PROCEDURE-DIV.
  7679*                          COPY ELC50PD.
  7680******************************************************************
  7681*                                                                *
  7682*                            ELC50PD                             *
  7683*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7684*                            VMOD=2.188                          *
  7685*                                                                *
  7686******************************************************************
  7687*                   C H A N G E   L O G
  7688*
  7689* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7690*-----------------------------------------------------------------
  7691*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7692* EFFECTIVE    NUMBER
  7693*-----------------------------------------------------------------
  7694* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7695* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7696* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7697*                             2709 AND 2718
  7698* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7699* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7700* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7701* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7702* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7703*                                IS OPEN OR CNC DT < PD THRU
  7704* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7705* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7706* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7707* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7708* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7709* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7710* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7711* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 142
* EL050.cbl
  7712* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7713* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7714* 020906                   PEMA  EXPAND LOAN OFFICER
  7715* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7716* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7717* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7718* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7719* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7720* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7721* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7722* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7723* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7724* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7725* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7726* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7727* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7728* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7729* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7730* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7731* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7732* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7733* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7734* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7735* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7736* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7737* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7738* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7739* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7740*                                UPDATE VIN ON CERT TRAILER
  7741* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7742* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7743* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7744* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7745* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7746* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7747* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7748* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7749* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7750* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7751* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7752* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7753* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7754* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7755* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7756* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7757* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7758* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7759* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7760* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7761* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7762* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7763* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7764* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7765* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7766* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7767* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7768* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7769* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 143
* EL050.cbl
  7770* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7771* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7772* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7773* 032912  CR2011110200001  PEMA  AHL CHANGES
  7774* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7775* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7776* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7777* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7778* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7779* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7780* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7781* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7782* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7783* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7784* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7785* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7786* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7787* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7788* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7789* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7790* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7791* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7792* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7793* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7794* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7795* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7796* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7797* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7798* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7799* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7800* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7801*                                CERT #, ADD 2898 FORCIBLE ERROR
  7802* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7803* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7804* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7805* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7806* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7807* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7808* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7809* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7810* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7811* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7812******************************************************************
  7813************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7814******************************************************************
  7815
  7816     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7817
  7818     MOVE SPACES                 TO PB-FATAL-FLAG
  7819                                    PB-FORCE-ER-CD
  7820                                    PB-WARN-ER-CD
  7821                                    PB-OUT-BAL-CD.
  7822
  7823     MOVE SPACE                  TO WS-IG-OVRD-AH
  7824                                    WS-IG-OVRD-LF
  7825                                    WS-IG-OVRD-AM
  7826                                    WS-IG-OVRD
  7827                                    WS-IG-OVRD-AH-PL
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 144
* EL050.cbl
  7828                                    WS-IG-OVRD-LF-PL
  7829                                    WS-IG-OVRD-AH-BEN
  7830                                    WS-IG-OVRD-LF-BEN.
  7831
  7832******************************************************************
  7833*************       INITIALIZE COMMON ERRORS       ***************
  7834******************************************************************
  7835
  7836     MOVE +0                     TO PB-NO-OF-ERRORS.
  7837     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7838
  7839******************************************************************
  7840
  7841     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7842     SET JULIAN-TO-BIN           TO TRUE.
  7843*    MOVE 5                      TO DC-OPTION-CODE.
  7844     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7845     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7846
  7847     MOVE ZERO                   TO  SUB4.
  7848
  7849 0040-INITIALIZE-GA-BILL-DT.
  7850
  7851     ADD +1                      TO  SUB4.
  7852
  7853     IF  SUB4 GREATER THAN +5
  7854         GO TO 0050-CHECK-CNTL-FOUND.
  7855
  7856     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7857         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7858
  7859     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7860
  7861 0050-CHECK-CNTL-FOUND.
  7862
  7863     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7864        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7865                                         WS-AH-REM-TERM-CALC
  7866                                         EC-CO-REM-TERM-CALC
  7867        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7868        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7869        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7870                                         WS-TOL-AH-CLAIM
  7871        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7872                                         WS-TOL-AH-PREM
  7873                                         EC-CO-TOL-PREM
  7874        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7875                                         WS-TOL-AH-REFUND
  7876                                         EC-CO-TOL-REFUND
  7877        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7878                                         WS-AH-REFUND-OVS-AMT
  7879                                         EC-CO-OVR-SHT-AMT
  7880        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7881                                         WS-TOL-AH-PREM-PCT
  7882                                         EC-CO-TOL-PREM-PCT
  7883        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7884                                         WS-TOL-AH-REFUND-PCT
  7885                                         EC-CO-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 145
* EL050.cbl
  7886        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7887                                         WS-AH-REFUND-OVS-PCT
  7888                                         EC-CO-OVR-SHT-PCT
  7889        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7890        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7891        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7892        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7893        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7894        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7895        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7896        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7897        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7898        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7899        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7900        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7901                                         EC-CO-MONTH-END-DT
  7902        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7903          GO TO 0100-READ-ACCT.
  7904
  7905     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7906     MOVE SPACES                 TO CNTL-ACCESS.
  7907     MOVE '1'                    TO CNTL-REC-TYPE.
  7908     MOVE +0                     TO CNTL-SEQ-NO.
  7909
  7910     MOVE '1' TO RC-SW-1.
  7911     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7912     IF NOT CF-COMPANY-MASTER
  7913         MOVE ZEROS             TO WK-CO-TOL-PREM
  7914                                   WK-CO-TOL-CLAIM
  7915                                   WK-CO-TOL-REFUND
  7916                                   WK-REFUND-OVS-AMT
  7917                                   WK-REFUND-OVS-PCT
  7918                                   WK-CO-TOL-PREM-PCT
  7919                                   WK-CO-TOL-REFUND-PCT
  7920                                   WK-DEFAULT-APR
  7921                                   WK-CO-MAX-CAP
  7922        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7923                                   WK-CR-R78-METHOD
  7924                                   WK-CO-REF-REJECT-SW
  7925                                   WK-CO-PREM-REJECT-SW
  7926                                   WK-REM-TRM-CALC-OPTION
  7927                                   WK-BIRTH-DATE-INPUT
  7928                                   WK-JOINT-AGE-INPUT
  7929        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7930        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7931        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7932        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7933          GO TO 0099-COMPANY-NOT-FOUND.
  7934
  7935     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7936        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7937     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7938        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7939     IF CF-CO-TOL-CAP NOT NUMERIC
  7940        MOVE +0                    TO CF-CO-TOL-CAP.
  7941     IF CF-DEFAULT-APR NOT NUMERIC
  7942        MOVE +0                    TO CF-DEFAULT-APR.
  7943
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 146
* EL050.cbl
  7944     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7945     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7946     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7947     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7948     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7949     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7950     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7951     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7952     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7953     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7954     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7955     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7956
  7957     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7958          CF-CO-OVR-SHT-AMT > +0
  7959        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7960
  7961     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7962          CF-CO-OVR-SHT-PCT > +0
  7963        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7964
  7965     IF CF-VALID-REM-TRM-OPTION
  7966         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7967     ELSE
  7968         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7969
  7970     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7971     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7972     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7973     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7974
  7975     GO TO 0050-CHECK-CNTL-FOUND.
  7976
  7977 0099-COMPANY-NOT-FOUND.
  7978
  7979     MOVE ER-2616                TO WS-ERROR.
  7980     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7981
  7982 0100-READ-ACCT.
  7983
  7984     MOVE SPACES                 TO DATE-RANGE-SW.
  7985
  7986     IF WK-ACCT-ADDR = ZEROS
  7987        GO TO 0102-ACCT-GETMAIN.
  7988
  7989     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7990     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7991     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7992
  7993     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7994        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7995        GO TO 0105-READ-ACCT
  7996     END-IF
  7997
  7998     IF PB-CARRIER NOT = SPACES
  7999        IF PB-CARRIER NOT = AM-VG-CARRIER
  8000           GO TO 0105-READ-ACCT.
  8001
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 147
* EL050.cbl
  8002     IF PB-STATE NOT = SPACES
  8003        IF PB-STATE NOT = AM-VG-STATE
  8004           GO TO 0105-READ-ACCT.
  8005
  8006     IF PB-GROUPING NOT = SPACES
  8007        IF PB-GROUPING NOT = AM-VG-GROUPING
  8008           GO TO 0105-READ-ACCT.
  8009
  8010     MOVE 'X'                 TO DATE-RANGE-SW.
  8011
  8012     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8013        MOVE 'X'                 TO DATE-RANGE-SW
  8014        GO TO 0105-READ-ACCT.
  8015
  8016     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8017        GO TO 0105-READ-ACCT.
  8018
  8019     GO TO 0180-ACCOUNT-FOUND.
  8020
  8021 0102-ACCT-GETMAIN.
  8022     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8023     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8024
  8025 0105-READ-ACCT.
  8026     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8027     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8028     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8029     MOVE PB-STATE               TO ACCT-STATE.
  8030     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8031     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8032
  8033     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8034
  8035     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8036
  8037 0110-FIND-ACCT-TOLERANCES-LOOP.
  8038     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8039
  8040     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8041        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8042        GO TO 0199-ACCT-NOT-FOUND
  8043     END-IF
  8044     IF PB-CARRIER NOT = SPACES
  8045        IF PB-CARRIER NOT = AM-VG-CARRIER
  8046           GO TO 0199-ACCT-NOT-FOUND.
  8047
  8048     IF PB-STATE NOT = SPACES
  8049        IF PB-STATE NOT = AM-VG-STATE
  8050           GO TO 0199-ACCT-NOT-FOUND.
  8051
  8052     IF PB-GROUPING NOT = SPACES
  8053        IF PB-GROUPING NOT = AM-VG-GROUPING
  8054           GO TO 0199-ACCT-NOT-FOUND.
  8055
  8056     MOVE 'X'                    TO DATE-RANGE-SW.
  8057
  8058     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8059        MOVE 'X'                 TO DATE-RANGE-SW
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 148
* EL050.cbl
  8060        GO TO 0199-ACCT-NOT-FOUND.
  8061
  8062     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8063        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8064
  8065 0180-ACCOUNT-FOUND.
  8066     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8067     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8068     MOVE AM-STATE               TO PB-SV-STATE.
  8069     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8070
  8071     IF AM-CANCEL-FEE  NOT NUMERIC
  8072        MOVE ZEROS TO AM-CANCEL-FEE.
  8073
  8074     IF AM-MAX-MON-BEN NOT NUMERIC
  8075        MOVE ZEROS TO AM-MAX-MON-BEN.
  8076
  8077     IF AM-MAX-TOT-BEN NOT NUMERIC
  8078        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8079
  8080     IF AM-CLP-TOL-PCT NOT NUMERIC
  8081        MOVE +0                  TO AM-CLP-TOL-PCT
  8082     END-IF
  8083     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8084        MOVE +0                  TO AM-SPP-LEASE-COMM
  8085     END-IF
  8086     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8087        MOVE ER-2611             TO   WS-ERROR
  8088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8089
  8090     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8091        MOVE ER-2621             TO   WS-ERROR
  8092        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8093
  8094     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8095        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8096        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8097        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8098         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8099
  8100     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8101     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8102     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8103     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8104     IF AM-CLP-TOL-PCT NOT = ZEROS
  8105        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8106     END-IF
  8107     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8108        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8109     END-IF
  8110*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8111*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8112*                                   WS-ADMIN-FEES
  8113*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8114*          (SUB5 > +10)
  8115*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8116*             AND (AM-A-COM (SUB5) NUMERIC)
  8117*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 149
* EL050.cbl
  8118*                + (AM-A-COM (SUB5) * 1000)
  8119*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8120*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8121*                + (AM-A-COM (SUB5) * 1000)
  8122*             END-IF
  8123*             IF AM-COM-TYP (SUB5) = 'N'
  8124*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8125*                + (AM-A-COM (SUB5) * 1000)
  8126*             END-IF
  8127*          END-IF
  8128*       END-PERFORM
  8129*    END-IF
  8130     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8131        AND (PB-ISSUE)
  8132        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8133                                    ws-cred-union-fees
  8134        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8135           (SUB5 > +10)
  8136           MOVE +0 TO WS-WK-RATE
  8137           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8138                                   'O' OR 'S')
  8139              IF (AM-A-COM (SUB5) NUMERIC)
  8140                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8141                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8142              ELSE
  8143                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8144                 IF PB-ISSUE
  8145                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8146                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8147                 ELSE
  8148                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8149                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8150                 END-IF
  8151                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8152                 MOVE ZEROS             TO WS-SUB1
  8153                                           WS-COMMISSION
  8154                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8155                 MOVE '0530'               TO CTBL-SW
  8156                 MOVE ' '                  TO WS-CTBL-READ-SW
  8157                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8158                 IF FIRST-TIME-THROUGH
  8159                    MOVE 'AA'              TO CTBL-BEN-CODE
  8160                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8161                 END-IF
  8162                 IF CTBL-TABLE-FOUND
  8163                    IF PB-ISSUE
  8164                       COMPUTE WS-COMM-CK-AMT =
  8165                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8166                    ELSE
  8167                       COMPUTE WS-COMM-CK-AMT =
  8168                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8169                    END-IF
  8170                    PERFORM 8800-GET-COMP-RATE
  8171                              THRU 8800-EXIT
  8172                 END-IF
  8173              END-IF
  8174              if am-com-typ (sub5) = 'O' or 'S'
  8175                 compute ws-cred-union-fees rounded =
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 150
* EL050.cbl
  8176                    ws-cred-union-fees +
  8177                    (pb-i-ah-premium-amt * ws-wk-rate)
  8178              else
  8179                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8180                + (WS-WK-RATE * 1000)
  8181              end-if
  8182           END-IF
  8183        END-PERFORM
  8184     END-IF
  8185     IF PB-COMPANY-ID EQUAL 'CRI'
  8186         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8187
  8188     IF PB-COMPANY-ID EQUAL 'NCL'
  8189         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8190     END-IF
  8191
  8192     GO TO 0200-READ-CERT.
  8193
  8194 0199-ACCT-NOT-FOUND.
  8195
  8196     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8197
  8198     IF DATE-RANGE-SW NOT = SPACES
  8199        MOVE ER-2601             TO WS-ERROR
  8200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8201     ELSE
  8202        MOVE ER-2619             TO WS-ERROR
  8203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8204
  8205     GO TO 9990-RETURN.
  8206
  8207 0200-READ-CERT.
  8208
  8209     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8210     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8211     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8212     MOVE PB-SV-STATE            TO CERT-STATE.
  8213     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8214     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8215     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8216
  8217     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8218
  8219     IF CERT-WAS-NOT-FOUND
  8220        GO TO 0299-CERT-NOT-FOUND.
  8221
  8222     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8223        MOVE ER-2759             TO WS-ERROR
  8224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8225        GO TO 0298-UNLOCK-RETURN.
  8226
  8227     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8228         MOVE ER-2758            TO WS-ERROR
  8229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8230         GO TO 0298-UNLOCK-RETURN.
  8231
  8232     IF PB-ISSUE
  8233        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 151
* EL050.cbl
  8234           IF CERT-WAS-CREATED-FOR-CLAIM
  8235              NEXT SENTENCE
  8236            ELSE
  8237              MOVE ER-2626       TO WS-ERROR
  8238              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8239              GO TO 0298-UNLOCK-RETURN.
  8240
  8241     IF NOT PB-CANCELLATION
  8242        GO TO 0300-CONTINUE-EDIT.
  8243
  8244     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8245     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8246     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8247     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8248     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8249     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8250
  8251     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8252     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8253     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8254     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8255     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8256     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8257     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8258     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8259     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8260
  8261     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8262     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8263     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8264     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8265     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8266     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8267     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8268
  8269     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8270     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8271
  8272     MOVE CM-CREDIT-INTERFACE-SW-1
  8273                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8274     MOVE CM-CREDIT-INTERFACE-SW-2
  8275                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8276
  8277     IF CM-O-B-COVERAGE
  8278         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8279
  8280     IF CM-LIVES NOT NUMERIC
  8281         MOVE ZERO                TO CM-LIVES.
  8282
  8283     IF CM-BILLED NOT NUMERIC
  8284         MOVE ZERO                TO CM-BILLED.
  8285
  8286     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8287         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8288         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8289         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8290         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8291         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 152
* EL050.cbl
  8292         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8293         MOVE CM-LIVES             TO PB-CI-LIVES
  8294*The next line causes a problem with my change  I dont think it is
  8295*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8296
  8297     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8298     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8299     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8300     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8301     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8302     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8303
  8304     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8305     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8306     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8307     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8308
  8309     IF CM-LIFE-COMM-PCT NUMERIC
  8310         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8311     ELSE
  8312         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8313
  8314     IF CM-AH-COMM-PCT NUMERIC
  8315         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8316     ELSE
  8317         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8318
  8319     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8320
  8321     IF CM-LOAN-APR       NOT NUMERIC
  8322           MOVE ZERO               TO CM-LOAN-APR.
  8323
  8324     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8325           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8326
  8327     IF CM-LOAN-TERM      NOT NUMERIC
  8328           MOVE ZERO               TO CM-LOAN-TERM.
  8329
  8330     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8331           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8332
  8333     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8334           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8335
  8336     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8337     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8338     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8339     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8340     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8341     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8342     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8343     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8344     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8345     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8346     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8347     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8348
  8349     IF CM-STATE = CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 153
* EL050.cbl
  8350         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8351
  8352     IF CM-STATE NOT = CM-MEMB-STATE
  8353         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8354
  8355     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8356
  8357     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8358        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8359        IF CM-ADDL-CLP NOT NUMERIC
  8360           MOVE +0               TO CM-ADDL-CLP
  8361        END-IF
  8362        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8363        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8364           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8365        END-IF
  8366     END-IF
  8367     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8368        MOVE +0                  TO WS-ADMIN-FEES
  8369                                    WS-CSO-ADMIN-FEE
  8370                                    WS-COMM-AND-MFEE
  8371                                    WS-1ST-YR-ALLOW
  8372        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8373           (SUB5 > +10)
  8374           MOVE +0 TO WS-WK-RATE
  8375           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8376              IF (AM-A-COM (SUB5) NUMERIC)
  8377                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8378                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8379              ELSE
  8380                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8381                 IF PB-ISSUE
  8382                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8383                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8384                 ELSE
  8385                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8386                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8387                 END-IF
  8388                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8389                 MOVE ZEROS             TO WS-SUB1
  8390                                           WS-COMMISSION
  8391                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8392                 MOVE '0530'               TO CTBL-SW
  8393                 MOVE ' '                  TO WS-CTBL-READ-SW
  8394                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8395                 IF FIRST-TIME-THROUGH
  8396                    MOVE 'AA'              TO CTBL-BEN-CODE
  8397                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8398                 END-IF
  8399                 IF CTBL-TABLE-FOUND
  8400                    IF PB-ISSUE
  8401                       COMPUTE WS-COMM-CK-AMT =
  8402                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8403                    ELSE
  8404                       COMPUTE WS-COMM-CK-AMT =
  8405                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8406                    END-IF
  8407                    PERFORM 8800-GET-COMP-RATE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 154
* EL050.cbl
  8408                              THRU 8800-EXIT
  8409                 END-IF
  8410              END-IF
  8411              IF AM-COM-TYP (SUB5) = 'I'
  8412                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8413                   + (WS-WK-RATE * 1000)
  8414              END-IF
  8415              IF AM-COM-TYP (SUB5) = 'N'
  8416                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8417                   + (WS-WK-RATE * 1000)
  8418              END-IF
  8419              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8420                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8421                   + (WS-WK-RATE * 1000)
  8422              END-IF
  8423              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8424                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8425                   + (WS-WK-RATE * 1000)
  8426              END-IF
  8427           END-IF
  8428        END-PERFORM
  8429     END-IF
  8430     GO TO 0300-CONTINUE-EDIT.
  8431
  8432 0298-UNLOCK-RETURN.
  8433      PERFORM 9250-UNLOCK-RETURN
  8434      GO TO 9990-RETURN.
  8435
  8436 0299-CERT-NOT-FOUND.
  8437
  8438     MOVE '1'                     TO CERT-STATUS-SW.
  8439
  8440     IF PB-COMPANY-ID = 'UCL'
  8441         IF WS-ERROR = ER-2799
  8442             GO TO 3000-CONTINUE-EDIT.
  8443
  8444     IF NOT PB-CANCELLATION
  8445         GO TO 0300-CONTINUE-EDIT.
  8446
  8447     MOVE ER-2726                  TO  WS-ERROR.
  8448     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8449     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8450     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8451                                    PB-CI-LF-TERM
  8452                                    PB-C-LF-REM-TERM
  8453                                    PB-CI-AH-TERM
  8454                                    PB-C-AH-REM-TERM
  8455                                    PB-CI-LF-BENEFIT-CD
  8456                                    PB-CI-LF-BENEFIT-AMT
  8457                                    PB-CI-LF-ALT-BENEFIT-AMT
  8458                                    PB-CI-LF-PREMIUM-AMT
  8459                                    PB-CI-LF-ALT-PREMIUM-AMT
  8460                                    PB-CI-AH-BENEFIT-CD
  8461                                    PB-CI-AH-BENEFIT-AMT
  8462                                    PB-CI-AH-PREMIUM-AMT
  8463                                    PB-CI-PAY-FREQUENCY
  8464                                    PB-CI-LOAN-APR
  8465                                    PB-CI-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 155
* EL050.cbl
  8466                                    PB-CI-LIFE-COMMISSION
  8467                                    PB-CI-AH-COMMISSION
  8468                                    PB-CI-CURR-SEQ
  8469                                    PB-CI-AH-CANCEL-AMT
  8470                                    PB-CI-LF-CANCEL-AMT
  8471                                    PB-CI-RATE-DEV-PCT-LF
  8472                                    PB-CI-RATE-DEV-PCT-AH
  8473                                    PB-CI-EXTENTION-DAYS
  8474                                    PB-CI-TERM-IN-DAYS
  8475                                    PB-CI-LIVES
  8476                                    PB-CI-LF-CRIT-PER
  8477                                    PB-CI-AH-CRIT-PER
  8478                                    PB-CI-ADDL-CLP
  8479                                    PB-CI-DDF-IU-RATE-UP.
  8480
  8481     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8482                                    PB-CI-AH-SETTLEMENT-DT
  8483                                    PB-CI-DEATH-DT
  8484                                    PB-CI-LF-PRIOR-CANCEL-DT
  8485                                    PB-CI-AH-PRIOR-CANCEL-DT
  8486                                    PB-CI-ENTRY-DT
  8487                                    PB-CI-LF-EXPIRE-DT
  8488                                    PB-CI-AH-EXPIRE-DT
  8489                                    PB-CI-LOAN-1ST-PMT-DT.
  8490
  8491     IF ACCOUNT-MAST-FOUND
  8492        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8493        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8494
  8495
  8496 0300-CONTINUE-EDIT.
  8497
  8498     IF PB-ISSUE
  8499        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8500            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8501
  8502     IF PB-ISSUE
  8503        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8504            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8505
  8506     IF PB-ISSUE
  8507       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8508          (AM-NO-AH-ONLY)
  8509           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8510               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8511                   MOVE ER-2679 TO WS-ERROR
  8512                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8513
  8514     IF PB-ISSUE
  8515        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8516        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8517        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8518     ELSE
  8519        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8520        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8521        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8522
  8523     MOVE 'N'                    TO PLAN-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 156
* EL050.cbl
  8524                                    PLAN-MASTER-LIFE-SW
  8525                                    FORM-MASTER-SW
  8526                                    WS-APP-CERT-SW.
  8527
  8528     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8529                                    WS-PL-TOL-LF-REFUND
  8530                                    WS-PL-REF-OVS-AMT
  8531                                    WS-PL-TOL-LF-PREM-PCT
  8532                                    WS-PL-TOL-LF-REFUND-PCT
  8533                                    WS-PL-REF-OVS-PCT
  8534                                    WS-PL-TOL-LF-CLAIM.
  8535
  8536     IF PB-COMPANY-ID = 'NCL'
  8537       IF PB-ISSUE
  8538         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8539             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8540             IF FORM-MASTER-FOUND
  8541                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8542
  8543     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8544        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8545
  8546********************** MON CODE **********************
  8547     IF PB-COMPANY-ID = 'MON'
  8548     IF PB-ISSUE
  8549     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8550        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8551             PB-I-LOAN-APR = ZERO)
  8552               MOVE 14.0         TO PB-I-LOAN-APR.
  8553******************************************************
  8554
  8555     IF PB-COMPANY-ID = 'NCL'
  8556       IF PB-ISSUE
  8557           IF FORM-MASTER-FOUND
  8558             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8559                AM-DISMBR-COVERAGE
  8560                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8561                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8562                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8563                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8564                                           PB-I-LIFE-BENEFIT-CD.
  8565
  8566     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8567
  8568     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8569         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8570         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8571         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8572         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8573         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8574           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8575             GO TO 0301-LIFE-BENEFIT-SEARCH
  8576         ELSE
  8577             NEXT SENTENCE
  8578     ELSE
  8579         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8580
  8581     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 157
* EL050.cbl
  8582     MOVE '4'                    TO CNTL-REC-TYPE.
  8583     MOVE +0                     TO CNTL-SEQ-NO.
  8584     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8585
  8586     MOVE '1' TO RC-SW-2.
  8587     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8588
  8589     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8590        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8591         GO TO 0305-BENEFIT-NOT-FOUND.
  8592
  8593     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8594
  8595 0301-LIFE-BENEFIT-SEARCH.
  8596
  8597     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8598
  8599     IF NO-BENEFIT-FOUND
  8600        GO TO 0305-BENEFIT-NOT-FOUND.
  8601
  8602     IF WS-BEN-CD = '99'
  8603        GO TO 0305-BENEFIT-NOT-FOUND.
  8604
  8605     IF PB-COMPANY-ID = 'NCL'
  8606         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8607             GO TO 0304-LIFE-BENEFIT-FOUND.
  8608
  8609     MOVE +1                     TO SUB5.
  8610     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8611
  8612* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8613* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8614     IF PB-COMPANY-ID = 'DMD'
  8615         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8616
  8617 0302-EDIT-ACCT-LF-BENEFITS.
  8618
  8619     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8620        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8621           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8622                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8623           GO TO 03XX-GET-LIFE-ERPLAN.
  8624
  8625     IF SUB5 LESS THAN +20
  8626        ADD +1                   TO SUB5
  8627        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8628
  8629     MOVE +1                     TO SUB5.
  8630
  8631     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8632        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8633
  8634 0303-EDIT-DMD-EXTRA-BENEFITS.
  8635
  8636     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8637        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8638           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8639                                 TO WS-SAVE-ALLOWABLE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 158
* EL050.cbl
  8640           GO TO 03XX-GET-LIFE-ERPLAN.
  8641
  8642     IF SUB5 LESS THAN +30
  8643        ADD +1                   TO SUB5
  8644        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8645
  8646     MOVE +1                     TO SUB5.
  8647
  8648 03XX-EDIT-FOR-NINETY-LF.
  8649
  8650***************************************************************
  8651*                                                             *
  8652*    NINETY BENEFIT PLAN TYPES:                               *
  8653*                                                             *
  8654*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8655*      92 = ALL GROUP REDUCING BENEFITS                       *
  8656*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8657*      94 = ALL GROUP LEVEL BENEFITS                          *
  8658*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8659*           BENEFIT CONTROLS.                                 *
  8660*      99 = ALL BENEFITS                                      *
  8661*                                                             *
  8662***************************************************************
  8663
  8664     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8665                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8666
  8667     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8668       AND
  8669        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8670        GO TO 03XX-GET-LIFE-ERPLAN.
  8671
  8672     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8673       AND
  8674        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8675        IF CF-REDUCING (SUB3)
  8676           IF (PB-I-INDV-GRP-OVRD = 'I')
  8677              OR
  8678           ((AM-IG = '1') AND
  8679           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8680              OR
  8681           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8682           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8683           (AM-IG NOT = '2'))
  8684              GO TO 03XX-GET-LIFE-ERPLAN.
  8685
  8686     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8687       AND
  8688        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8689        IF CF-REDUCING (SUB3)
  8690           IF (PB-I-INDV-GRP-OVRD = 'G')
  8691              OR
  8692           ((AM-IG = '2') AND
  8693           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8694              OR
  8695           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8696           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8697           (AM-IG NOT = '1'))
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 159
* EL050.cbl
  8698              GO TO 03XX-GET-LIFE-ERPLAN.
  8699
  8700     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8701       AND
  8702        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8703        IF CF-LEVEL    (SUB3)
  8704           IF (PB-I-INDV-GRP-OVRD = 'I')
  8705              OR
  8706           ((AM-IG = '1') AND
  8707           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8708              OR
  8709           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8710           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8711            (AM-IG NOT = '2'))
  8712              GO TO 03XX-GET-LIFE-ERPLAN.
  8713
  8714     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8715       AND
  8716        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8717        IF CF-LEVEL    (SUB3)
  8718           IF (PB-I-INDV-GRP-OVRD = 'G')
  8719              OR
  8720           ((AM-IG = '2') AND
  8721           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8722              OR
  8723           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8724           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8725           (AM-IG NOT = '1'))
  8726              GO TO 03XX-GET-LIFE-ERPLAN.
  8727
  8728     IF SUB5 LESS THAN +20
  8729        ADD +1                   TO SUB5
  8730        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8731
  8732     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8733
  8734     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8735        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8736
  8737     MOVE +1                     TO SUB5.
  8738
  8739 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8740
  8741     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8742                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8743
  8744     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8745       AND
  8746        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8747        GO TO 03XX-GET-LIFE-ERPLAN.
  8748
  8749     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8750       AND
  8751        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8752        IF CF-REDUCING (SUB3)
  8753           IF (PB-I-INDV-GRP-OVRD = 'I')
  8754              OR
  8755           ((AM-IG = '1') AND
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 160
* EL050.cbl
  8756           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8757              OR
  8758           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8759           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8760           (AM-IG NOT = '2'))
  8761              GO TO 03XX-GET-LIFE-ERPLAN.
  8762
  8763     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8764       AND
  8765        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8766        IF CF-REDUCING (SUB3)
  8767           IF (PB-I-INDV-GRP-OVRD = 'G')
  8768              OR
  8769           ((AM-IG = '2') AND
  8770           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8771              OR
  8772           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8773           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8774           (AM-IG NOT = '1'))
  8775              GO TO 03XX-GET-LIFE-ERPLAN.
  8776
  8777     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8778       AND
  8779        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8780        IF CF-LEVEL    (SUB3)
  8781           IF (PB-I-INDV-GRP-OVRD = 'I')
  8782              OR
  8783           ((AM-IG = '1') AND
  8784           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8785              OR
  8786           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8787           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8788            (AM-IG NOT = '2'))
  8789              GO TO 03XX-GET-LIFE-ERPLAN.
  8790
  8791     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8792       AND
  8793        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8794        IF CF-LEVEL    (SUB3)
  8795           IF (PB-I-INDV-GRP-OVRD = 'G')
  8796              OR
  8797           ((AM-IG = '2') AND
  8798           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8799              OR
  8800           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8801           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8802           (AM-IG NOT = '1'))
  8803              GO TO 03XX-GET-LIFE-ERPLAN.
  8804
  8805     IF SUB5 LESS THAN +30
  8806        ADD +1                   TO SUB5
  8807        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8808
  8809     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8810
  8811 03XX-EDIT-FOR-NINETY-LF-CONT.
  8812
  8813     MOVE +99                    TO SUB5.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 161
* EL050.cbl
  8814
  8815     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8816        IF PB-ISSUE
  8817           MOVE ER-1924          TO  WS-ERROR
  8818           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8819
  8820     GO TO 0304-LIFE-BENEFIT-FOUND.
  8821
  8822 03XX-GET-LIFE-ERPLAN.
  8823
  8824     IF WK-PLAN-ADDR EQUAL +0
  8825        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8826
  8827     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8828     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8829     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8830     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8831     MOVE 'Y'                    TO PLAN-MASTER-SW
  8832                                    PLAN-MASTER-LIFE-SW.
  8833     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8834
  8835 03XX-ERPLAN-LIFE-GETMAIN.
  8836
  8837     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8838     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8839
  8840 03XX-ERPLAN-LIFE-READ.
  8841
  8842     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8843     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8844     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8845     MOVE PB-SV-STATE            TO PLAN-STATE.
  8846     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8847     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8848     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8849     MOVE WS-SAVE-BENEFIT-REVISION
  8850                                 TO PLAN-REVISION-NO.
  8851
  8852     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8853     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8854
  8855     IF PB-COMPANY-ID = 'NCL'
  8856       IF NOT LF-PLAN-MASTER-FOUND
  8857         IF NOT PB-POLICY-IS-DECLINED  AND
  8858            NOT PB-POLICY-IS-VOIDED
  8859             MOVE  ER-1921         TO  WS-ERROR
  8860             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8861             GO TO 0304-LIFE-BENEFIT-FOUND.
  8862
  8863     IF NOT LF-PLAN-MASTER-FOUND
  8864        GO TO 0304-LIFE-BENEFIT-FOUND.
  8865
  8866 XXXX-CHECK-LF-PLAN-KEY.
  8867
  8868     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8869        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8870        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8871        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 162
* EL050.cbl
  8872        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8873        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8874        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8875        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8876        MOVE 'N'                 TO PLAN-MASTER-SW
  8877          GO TO 03XX-ERPLAN-LIFE-READ.
  8878
  8879     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8880
  8881     IF  PB-CANCELLATION
  8882         GO TO  0303-LF-ACCT-BEN-FOUND.
  8883
  8884     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8885        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8886           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8887           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8888              MOVE ER-2644             TO WS-ERROR
  8889              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8890           ELSE
  8891              NEXT SENTENCE
  8892        ELSE
  8893           IF PB-COMPANY-ID NOT = 'NCL'
  8894              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8895                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8896
  8897 0303-LF-ACCT-BEN-FOUND.
  8898
  8899     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8900
  8901     IF PL-DEV-CODE NOT = SPACES
  8902        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8903
  8904     IF PL-DEV-PCT NUMERIC AND
  8905        PL-DEV-PCT NOT = ZEROS
  8906        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8907
  8908     IF PL-TOL-PREM-AMT GREATER THAN +0
  8909        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8910
  8911     IF PL-TOL-REF-AMT GREATER THAN +0
  8912        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8913
  8914     IF PL-TOL-PREM-PCT GREATER THAN +0
  8915        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8916
  8917     IF PL-TOL-REF-PCT GREATER THAN +0
  8918        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8919
  8920     IF PL-TOL-CLM-AMT GREATER THAN +0
  8921        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8922
  8923     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8924                          PL-OVER-SHORT-AMT > +0
  8925        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8926
  8927     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8928                          PL-OVER-SHORT-PCT > +0
  8929        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 163
* EL050.cbl
  8930
  8931     IF PL-SALES-TAX NUMERIC AND
  8932                          PL-SALES-TAX > +0
  8933         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8934
  8935     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8936        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8937                                    WS-IG-OVRD-AM.
  8938
  8939 0304-LIFE-BENEFIT-FOUND.
  8940
  8941     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8942
  8943     IF PB-ISSUE
  8944        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8945     ELSE
  8946        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8947
  8948     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8949     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8950     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8951     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8952     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8953                                         WS-LF-REFUND-CALC.
  8954     if (ws-lf-earnings-calc = '5')
  8955        and (pb-i-loan-apr = zeros)
  8956        and (benefit-code-chg)
  8957        move +99.9999 to pb-i-loan-apr
  8958     end-if
  8959
  8960     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8961        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8962
  8963     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8964        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8965     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8966
  8967     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8968     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8969     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8970     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8971     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8972     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8973
  8974     IF PB-COMPANY-ID = 'NCL'  AND
  8975        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8976         NEXT SENTENCE
  8977     ELSE
  8978         IF SUB5 NOT GREATER THAN +20
  8979            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8980               MOVE WS-SAVE-BENEFIT-REM-TERM
  8981                                      TO WS-AM-LF-BENE-REM-TERM
  8982                                         EC-BR-LF-REM-TERM-CALC.
  8983
  8984     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8985     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8986
  8987     GO TO 0310-FIND-AH-BENEFIT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 164
* EL050.cbl
  8988
  8989 0305-BENEFIT-NOT-FOUND.
  8990
  8991     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8992     MOVE ER-2604                TO WS-ERROR.
  8993     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8994
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 165
* EL050.cbl
  8996
  8997 0310-FIND-AH-BENEFIT-RECORD.
  8998
  8999     MOVE 'N'                    TO PLAN-MASTER-SW
  9000                                    PLAN-MASTER-AH-SW.
  9001
  9002     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9003                                    WS-PL-TOL-AH-REFUND
  9004                                    WS-AH-PL-REF-OVS-AMT
  9005                                    WS-PL-TOL-AH-PREM-PCT
  9006                                    WS-PL-TOL-AH-REFUND-PCT
  9007                                    WS-AH-PL-REF-OVS-PCT
  9008                                    WS-PL-TOL-AH-CLAIM.
  9009     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9010
  9011
  9012     if pb-issue
  9013        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9014           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9015        end-if
  9016        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9017           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9018           GO TO 0399-BENEFIT-NOT-FOUND
  9019        end-if
  9020     end-if
  9021
  9022     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9023        GO TO 0400-FIND-CARRIER.
  9024
  9025     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9026
  9027     IF WK-AH-BEN-ADDR NOT = ZEROS
  9028         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9029         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9030         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9031         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9032           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9033             GO TO 0311-AH-BENEFIT-SEARCH
  9034         ELSE
  9035             NEXT SENTENCE
  9036     ELSE
  9037         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9038
  9039     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9040     MOVE '5'                    TO CNTL-REC-TYPE.
  9041     MOVE +0                     TO CNTL-SEQ-NO.
  9042     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9043
  9044     MOVE '2' TO RC-SW-2.
  9045     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9046
  9047     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9048        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9049          GO TO 0399-BENEFIT-NOT-FOUND.
  9050
  9051     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9052
  9053 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 166
* EL050.cbl
  9054
  9055     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9056
  9057     IF NO-BENEFIT-FOUND
  9058         GO TO 0399-BENEFIT-NOT-FOUND.
  9059
  9060     IF WS-BEN-CD = '99'
  9061        GO TO 0399-BENEFIT-NOT-FOUND.
  9062
  9063     IF PB-COMPANY-ID  =  'NCL'
  9064         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9065             GO TO 0314-A-H-BENEFIT-FOUND.
  9066
  9067     MOVE +1                     TO SUB5.
  9068     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9069
  9070* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9071* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9072     IF PB-COMPANY-ID = 'DMD'
  9073         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9074
  9075 0312-EDIT-ACCT-AH-BENEFITS.
  9076
  9077     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9078        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9079           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9080                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9081           GO TO 03XX-GET-AH-ERPLAN.
  9082
  9083     IF SUB5 LESS THAN +20
  9084        ADD +1                   TO SUB5
  9085        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9086
  9087     MOVE +1                     TO SUB5.
  9088
  9089     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9090        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9091
  9092 0313-EDIT-DMD-EXTRA-BENEFITS.
  9093
  9094     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9095        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9096           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9097                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9098           GO TO 03XX-GET-AH-ERPLAN.
  9099
  9100     IF SUB5 LESS THAN +30
  9101        ADD +1                   TO SUB5
  9102        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9103
  9104     MOVE +1                     TO SUB5.
  9105
  9106 03XX-EDIT-FOR-NINETY-AH.
  9107
  9108***************************************************************
  9109*                                                             *
  9110*    NINETY BENEFIT PLAN TYPES:                               *
  9111*                                                             *
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 167
* EL050.cbl
  9112*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9113*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9114*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9115*           BENEFIT CONTROLS.                                 *
  9116*      99 = ALL BENEFITS.                                     *
  9117*                                                             *
  9118***************************************************************
  9119
  9120     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9121                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9122
  9123     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9124       AND
  9125        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9126        GO TO 03XX-GET-AH-ERPLAN.
  9127
  9128     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9129       AND
  9130        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9131           IF (PB-I-INDV-GRP-OVRD = 'I')
  9132              OR
  9133           ((AM-IG = '1') AND
  9134           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9135              OR
  9136           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9137           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9138           (AM-IG NOT = '2'))
  9139              GO TO 03XX-GET-AH-ERPLAN.
  9140
  9141     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9142       AND
  9143        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9144           IF (PB-I-INDV-GRP-OVRD = 'G')
  9145              OR
  9146           ((AM-IG = '2') AND
  9147           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9148              OR
  9149           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9150           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9151           (AM-IG NOT = '1'))
  9152              GO TO 03XX-GET-AH-ERPLAN.
  9153
  9154     IF SUB5 LESS THAN +20
  9155        ADD +1                   TO SUB5
  9156        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9157
  9158     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9159        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9160
  9161     MOVE +1                    TO SUB5.
  9162
  9163 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9164
  9165     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9166                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9167
  9168     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9169       AND
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 168
* EL050.cbl
  9170        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9171        GO TO 03XX-GET-AH-ERPLAN.
  9172
  9173     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9174       AND
  9175        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9176           IF (PB-I-INDV-GRP-OVRD = 'I')
  9177              OR
  9178           ((AM-IG = '1') AND
  9179           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9180              OR
  9181           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9182           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9183           (AM-IG NOT = '2'))
  9184              GO TO 03XX-GET-AH-ERPLAN.
  9185
  9186     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9187       AND
  9188        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9189           IF (PB-I-INDV-GRP-OVRD = 'G')
  9190              OR
  9191           ((AM-IG = '2') AND
  9192           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9193              OR
  9194           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9195           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9196           (AM-IG NOT = '1'))
  9197              GO TO 03XX-GET-AH-ERPLAN.
  9198
  9199     IF SUB5 LESS THAN +30
  9200        ADD +1                   TO SUB5
  9201        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9202
  9203 03XX-EDIT-FOR-NINETY-AH-CONT.
  9204
  9205     MOVE +99                    TO SUB5.
  9206
  9207     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9208
  9209     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9210        IF PB-ISSUE
  9211           MOVE ER-1925          TO  WS-ERROR
  9212           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9213
  9214     GO TO 0314-A-H-BENEFIT-FOUND.
  9215
  9216 03XX-GET-AH-ERPLAN.
  9217
  9218     IF WK-PLAN-ADDR EQUAL +0
  9219         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9220
  9221     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9222     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9223     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9224     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9225     MOVE 'Y'                    TO PLAN-MASTER-SW
  9226                                    PLAN-MASTER-AH-SW.
  9227*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 169
* EL050.cbl
  9228     GO TO 03XX-ERPLAN-AH-READ.
  9229
  9230 03XX-ERPLAN-AH-GETMAIN.
  9231
  9232     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9233     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9234
  9235 03XX-ERPLAN-AH-READ.
  9236
  9237     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9238     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9239     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9240     MOVE PB-SV-STATE            TO PLAN-STATE.
  9241     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9242     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9243     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9244     MOVE WS-SAVE-BENEFIT-REVISION
  9245                                 TO PLAN-REVISION-NO.
  9246
  9247     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9248     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9249
  9250     IF PB-COMPANY-ID = 'NCL'
  9251       IF NOT AH-PLAN-MASTER-FOUND
  9252         IF NOT PB-POLICY-IS-DECLINED  AND
  9253            NOT PB-POLICY-IS-VOIDED
  9254             MOVE  ER-1922         TO  WS-ERROR
  9255             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9256             GO TO 0314-A-H-BENEFIT-FOUND.
  9257
  9258     IF NOT AH-PLAN-MASTER-FOUND
  9259        GO TO 0314-A-H-BENEFIT-FOUND.
  9260
  9261 XXXX-CHECK-AH-PLAN-KEY.
  9262
  9263     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9264        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9265        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9266        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9267        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9268        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9269        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9270        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9271        MOVE 'N'                 TO PLAN-MASTER-SW
  9272          GO TO 03XX-ERPLAN-AH-READ.
  9273
  9274     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9275
  9276     IF  PB-CANCELLATION
  9277         GO TO  0313-AH-ACCT-BEN-FOUND.
  9278
  9279     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9280       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9281          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9282          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9283             MOVE ER-2644             TO WS-ERROR
  9284             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9285          ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 170
* EL050.cbl
  9286             NEXT SENTENCE
  9287       ELSE
  9288          IF PB-COMPANY-ID NOT = 'NCL'
  9289             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9290                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9291
  9292 0313-AH-ACCT-BEN-FOUND.
  9293
  9294     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9295
  9296     IF PL-DEV-CODE NOT = SPACES
  9297        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9298
  9299     IF PL-DEV-PCT NUMERIC AND
  9300        PL-DEV-PCT NOT = ZEROS
  9301        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9302
  9303     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9304        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9305
  9306     IF PL-TOL-REF-AMT NOT EQUAL +0
  9307        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9308
  9309     IF PL-TOL-PREM-PCT GREATER THAN +0
  9310        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9311
  9312     IF PL-TOL-REF-PCT GREATER THAN +0
  9313        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9314
  9315     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9316        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9317
  9318     IF PL-OVER-SHORT-AMT NUMERIC AND
  9319                          PL-OVER-SHORT-AMT > +0
  9320        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9321
  9322     IF PL-OVER-SHORT-PCT NUMERIC AND
  9323                          PL-OVER-SHORT-PCT > +0
  9324        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9325
  9326     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9327        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9328        IF WS-IG-OVRD-AM EQUAL SPACES
  9329            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9330
  9331 0314-A-H-BENEFIT-FOUND.
  9332
  9333     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9334
  9335     IF PB-ISSUE
  9336        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9337       ELSE
  9338        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9339
  9340     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9341     if cf-maximum-benefits (sub3) numeric
  9342        move cf-maximum-benefits (sub3)
  9343                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 171
* EL050.cbl
  9344     else
  9345        move zeros               to ws-ah-max-bens
  9346     end-if
  9347     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9348     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9349     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9350                                         WS-AH-REFUND-CALC.
  9351
  9352     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9353        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9354
  9355     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9356        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9357     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9358
  9359     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9360     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9361     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9362     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9363     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9364     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9365
  9366     IF PB-COMPANY-ID = 'NCL'  AND
  9367        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9368         NEXT SENTENCE
  9369     ELSE
  9370         IF SUB5 NOT GREATER THAN +20
  9371            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9372                MOVE WS-SAVE-BENEFIT-REM-TERM
  9373                                      TO WS-AM-AH-BENE-REM-TERM
  9374                                         EC-BR-AH-REM-TERM-CALC.
  9375
  9376     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9377     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9378
  9379     GO TO 0400-FIND-CARRIER.
  9380
  9381 0399-BENEFIT-NOT-FOUND.
  9382
  9383     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9384     MOVE ER-2605                TO WS-ERROR.
  9385     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9386
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 172
* EL050.cbl
  9388
  9389 0400-FIND-CARRIER.
  9390
  9391     MOVE PB-SV-CARRIER          TO WS-CARR.
  9392
  9393     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9394     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9395     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9396     MOVE '6'                    TO CNTL-REC-TYPE.
  9397
  9398*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9399     MOVE SPACE                  TO WS-DMD-RATING-SW
  9400                                    EC-BR-DMD-RATING-SW.
  9401
  9402     MOVE '2'                    TO RC-SW-1.
  9403     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9404
  9405     IF NOT CF-CARRIER-MASTER
  9406        GO TO 0400-CARRIER-NOT-FOUND.
  9407
  9408 0400-BUILD-CARR-TOL.
  9409
  9410     IF CF-CR-TOL-PREM NUMERIC AND
  9411        CF-CR-TOL-PREM GREATER THAN +0
  9412        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9413                                    WS-TOL-AH-PREM.
  9414
  9415     IF CF-CR-TOL-REFUND NUMERIC AND
  9416        CF-CR-TOL-REFUND GREATER THAN +0
  9417        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9418                                    WS-TOL-AH-REFUND.
  9419
  9420     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9421        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9422        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9423                                    WS-AH-REFUND-OVS-AMT.
  9424
  9425     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9426        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9427        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9428                                    WS-AH-REFUND-OVS-PCT.
  9429
  9430     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9431        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9432        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9433                                    WS-TOL-AH-PREM-PCT.
  9434
  9435     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9436        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9437        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9438                                     WS-TOL-AH-REFUND-PCT.
  9439
  9440     IF CF-COMPANY-ID EQUAL 'DMD'
  9441         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9442                                    EC-BR-DMD-RATING-SW.
  9443
  9444     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9445     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 173
* EL050.cbl
  9446        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9447     END-IF
  9448     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9449        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9450     END-IF
  9451     IF WS-TOL-CLP-PCT = ZEROS
  9452        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9453     END-IF
  9454
  9455     IF WS-SPP-LEASE-COMM = ZEROS
  9456        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9457     END-IF
  9458     GO TO 0400-FIND-ERPDEF.
  9459
  9460 0400-CARRIER-NOT-FOUND.
  9461
  9462     MOVE ER-2602                TO WS-ERROR.
  9463     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9464
  9465 0400-FIND-ERPDEF.
  9466*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9467     IF (PB-COMPANY-ID = 'DCC')
  9468        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9469        CONTINUE
  9470     ELSE
  9471        GO TO 0400-FIND-ERCOMP
  9472     END-IF
  9473     MOVE ' '                    TO PDEF-MASTER-SW
  9474     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9475     MOVE PB-STATE               TO ERPDEF-STATE
  9476     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9477        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9478     END-IF
  9479     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9480     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9481     IF PB-ISSUE
  9482        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9483     ELSE
  9484        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9485     END-IF
  9486     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9487     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9488     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9489     IF PDEF-MASTER-FOUND
  9490        MOVE 'N'                 TO PDEF-MASTER-SW
  9491        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9492        IF PDEF-MASTER-FOUND
  9493           IF (ERPDEF-KEY-SAVE (1:16) =
  9494                        PD-CONTROL-PRIMARY (1:16))
  9495              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9496              CONTINUE
  9497           ELSE
  9498              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9499              IF (ERPDEF-KEY-SAVE (1:16) =
  9500                        PD-CONTROL-PRIMARY (1:16))
  9501                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9502                 CONTINUE
  9503              ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 174
* EL050.cbl
  9504                 MOVE 'N'        TO PDEF-MASTER-SW
  9505              END-IF
  9506           END-IF
  9507        END-IF
  9508        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9509     END-IF
  9510     IF PDEF-MASTER-FOUND
  9511        IF PD-TRUNCATED = 'Y'
  9512           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9513        END-IF
  9514     END-IF
  9515     .
  9516 0400-FIND-ERCOMP.
  9517     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9518        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9519           (WS-SUB1 > +10)
  9520           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9521                 OR 'A' OR 'N'
  9522              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9523              MOVE PB-CARRIER    TO COMP-CARRIER
  9524              MOVE PB-GROUPING   TO COMP-GROUPING
  9525              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9526              MOVE AM-AGT (WS-SUB1)
  9527                                 TO COMP-FIN-RESP
  9528              MOVE 'G'           TO COMP-TYPE
  9529              PERFORM 8582-READ-COMPENSATION-MASTER
  9530                                 THRU 8582-EXIT
  9531              IF COMP-MASTER-FOUND
  9532                 IF CO-GA-INACTIVE
  9533                    MOVE ER-2763 TO WS-ERROR
  9534                    PERFORM 9900-ERROR-FORMAT
  9535                                 THRU 9900-EXIT
  9536                    MOVE +11     TO WS-SUB1
  9537                 END-IF
  9538                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9539                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9540                    MOVE ER-2788 TO WS-ERROR
  9541                    PERFORM 9900-ERROR-FORMAT
  9542                                 THRU 9900-EXIT
  9543                    MOVE +11     TO WS-SUB1
  9544                 END-IF
  9545              END-IF
  9546           END-IF
  9547        END-PERFORM
  9548     END-IF
  9549     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9550        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9551           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9552                                    WS-CLP-STATE
  9553        ELSE
  9554           MOVE SPACES           TO PB-I-CLP-STATE
  9555                                    WS-CLP-STATE
  9556        END-IF
  9557     END-IF
  9558
  9559     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9560        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9561        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 175
* EL050.cbl
  9562        CONTINUE
  9563     ELSE
  9564        GO TO 0400-FIND-STATE-RECORD
  9565     END-IF
  9566     MOVE SPACES                 TO WS-CLP-STATE
  9567     MOVE +0                     TO WS-BANK-FEE
  9568                                    WS-BANK-LFEE
  9569                                    WS-BANK-NOCHRGB
  9570
  9571     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9572     IF (PB-ISSUE)
  9573        AND (PB-I-BANK-NUMBER NOT =
  9574            SPACES AND ZEROS AND LOW-VALUES)
  9575        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9576     ELSE
  9577        IF (PB-CANCELLATION)
  9578           AND (PB-CI-BANK-NUMBER NOT =
  9579                SPACES AND ZEROS AND LOW-VALUES)
  9580           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9581        END-IF
  9582     END-IF
  9583     IF COMP-FIN-RESP NOT = LOW-VALUES
  9584        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9585        MOVE PB-CARRIER          TO COMP-CARRIER
  9586        MOVE PB-GROUPING         TO COMP-GROUPING
  9587        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9588        MOVE 'B'                 TO COMP-TYPE
  9589        PERFORM 8582-READ-COMPENSATION-MASTER
  9590                                 THRU 8582-EXIT
  9591        IF COMP-MASTER-FOUND
  9592           IF CO-MAX-BANK-FEE NOT NUMERIC
  9593              MOVE +0            TO CO-MAX-BANK-FEE
  9594           END-IF
  9595           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9596              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9597           END-IF
  9598           IF CO-GA-INACTIVE
  9599              MOVE ER-2763       TO WS-ERROR
  9600              PERFORM 9900-ERROR-FORMAT
  9601                                 THRU 9900-EXIT
  9602           END-IF
  9603           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9604              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9605              MOVE ER-2788 TO WS-ERROR
  9606              PERFORM 9900-ERROR-FORMAT
  9607                                 THRU 9900-EXIT
  9608              MOVE +11     TO WS-SUB1
  9609           END-IF
  9610           IF WS-AH-BEN-CATEGORY = 'G'
  9611              MOVE CO-MAX-BANK-FEE
  9612                                 TO WS-BANK-FEE
  9613                                    PB-I-BANK-FEE
  9614           ELSE
  9615              MOVE CO-MAX-BANK-FEE-LEASE
  9616                                 TO WS-BANK-LFEE
  9617                                    PB-I-BANK-FEE
  9618           END-IF
  9619           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 176
* EL050.cbl
  9620              AND (WS-AH-REFUND-CALC = 'G'))
  9621                        OR
  9622              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9623              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9624              CONTINUE
  9625           ELSE
  9626              MOVE ER-2789 TO WS-ERROR
  9627              PERFORM 9900-ERROR-FORMAT
  9628                                 THRU 9900-EXIT
  9629           END-IF
  9630           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9631                                    PB-I-CLP-STATE
  9632           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9633           MOVE CO-CARRIER       TO BXRF-CARRIER
  9634           MOVE CO-GROUPING      TO BXRF-GROUPING
  9635           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9636           MOVE BXRF-MAX-REC-LENGTH
  9637                                 TO BXRF-REC-LENGTH
  9638           PERFORM 8584-READ-BANK-CROSS-REF
  9639                                 THRU 8584-EXIT
  9640           IF BXRF-MASTER-FOUND
  9641              MOVE ' '           TO BANK-ACCT-SW
  9642              MOVE BK-BANK-POINTER-CNT
  9643                                 TO BK-BANK-POINTER-CNT
  9644              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9645                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9646                 OR (BANK-ACCT-FOUND)
  9647                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9648                    AND (BK-AM-EXP-DT (WS-SUB1)
  9649                                 > PB-CERT-EFF-DT)
  9650                    AND (BK-AM-EFF-DT (WS-SUB1)
  9651                                 NOT > PB-CERT-EFF-DT)
  9652                    SET BANK-ACCT-FOUND TO TRUE
  9653                 END-IF
  9654              END-PERFORM
  9655              IF NOT BANK-ACCT-FOUND
  9656                 MOVE ZEROS      TO WS-BANK-FEE
  9657                                    WS-BANK-LFEE
  9658                 MOVE ER-2869    TO WS-ERROR
  9659                 PERFORM 9900-ERROR-FORMAT
  9660                                 THRU 9900-EXIT
  9661              ELSE
  9662                 PERFORM 5000-PROCESS-REPS
  9663                                 THRU 5000-EXIT
  9664                 IF AGENT-MASTER-FOUND
  9665                    MOVE +0      TO WS-BANK-FEE
  9666                                    WS-BANK-LFEE
  9667*                   MOVE AG-SPP-FEES (1)
  9668*                                TO PB-I-BANK-FEE
  9669*                                   WS-BANK-FEE
  9670                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9671                       (WS-SUB1 > +10)
  9672                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9673                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9674                       END-IF
  9675                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9676                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9677                       END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 177
* EL050.cbl
  9678                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9679                          AG-SPP-FEES (WS-SUB1)
  9680                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9681                          AG-SPP-LFEES (WS-SUB1)
  9682                    END-PERFORM
  9683                    IF WS-AH-BEN-CATEGORY = 'G'
  9684                       MOVE WS-BANK-FEE
  9685                                 TO PB-I-BANK-FEE
  9686                    ELSE
  9687                       MOVE WS-BANK-LFEE
  9688                                 TO PB-I-BANK-FEE
  9689                    END-IF
  9690                 END-IF
  9691              END-IF
  9692           END-IF
  9693        ELSE
  9694           MOVE ER-2879          TO WS-ERROR
  9695           PERFORM 9900-ERROR-FORMAT
  9696                                 THRU 9900-EXIT
  9697        END-IF
  9698     ELSE
  9699        MOVE ER-2879             TO WS-ERROR
  9700        PERFORM 9900-ERROR-FORMAT
  9701                                 THRU 9900-EXIT
  9702     END-IF
  9703     IF WS-AH-BEN-CATEGORY = 'G'
  9704        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9705        + WS-BANK-FEE
  9706     ELSE
  9707        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9708        + WS-BANK-LFEE
  9709     END-IF
  9710     .
  9711 0400-FIND-STATE-RECORD.
  9712
  9713     IF WK-STATE-ADDR NOT = ZEROS
  9714         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9715         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9716         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9717         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9718         IF PB-SV-STATE = CF-STATE-CODE
  9719             GO TO 0405-CONTINUE-EDIT
  9720         ELSE
  9721             NEXT SENTENCE
  9722     ELSE
  9723         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9724
  9725     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9726     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9727     MOVE '3'                    TO CNTL-REC-TYPE.
  9728     MOVE +0                     TO CNTL-SEQ-NO.
  9729
  9730     MOVE '3'                    TO RC-SW-2.
  9731     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9732
  9733     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9734        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9735        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 178
* EL050.cbl
  9736        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9737                                    WS-TOL-AH-CLAIM
  9738                                    WS-MINIMUM-REFUND
  9739                                    WS-TOL-LF-PREM
  9740                                    WS-TOL-AH-PREM
  9741                                    WS-TOL-LF-REFUND
  9742                                    WS-TOL-AH-REFUND
  9743                                    EC-ST-TOL-PREM-PCT
  9744                                    WS-TOL-LF-PREM-PCT
  9745                                    WS-TOL-AH-PREM-PCT
  9746                                    EC-ST-TOL-REFUND-PCT
  9747                                    WS-TOL-LF-REFUND-PCT
  9748                                    WS-TOL-AH-REFUND-PCT
  9749                                    EC-ST-TOL-PREM
  9750                                    EC-ST-TOL-REFUND
  9751                                    EC-ST-FST-PMT-DAYS-MAX
  9752                                    WS-FREE-LOOK-PERIOD
  9753                                    WS-ST-LF-PREM-TAX
  9754                                    WS-ST-AH-PREM-TAX-I
  9755                                    WS-ST-AH-PREM-TAX-G
  9756                                    WS-BANK-FEE
  9757                                    WS-BANK-LFEE
  9758                                    WS-TOL-CLP-PCT
  9759                                    WS-SPP-LEASE-COMM
  9760                                    WS-INT-PERIODS
  9761                                    WS-EXTRA-PMTS
  9762        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9763                                    EC-ST-FST-PMT-DAYS-CHG
  9764                                    WS-LF-REM-TERM-CALC
  9765                                    WS-LF-REFUND-CALC
  9766                                    EC-ST-LF-REM-TERM-CALC
  9767                                    EC-ST-LF-REFUND-CALC
  9768                                    WS-AH-REM-TERM-CALC
  9769                                    WS-AH-REFUND-CALC
  9770                                    WS-LF-BEN-CATEGORY
  9771                                    WS-AH-BEN-CATEGORY
  9772                                    WS-CLP-STATE
  9773                                    WS-ST-REFUND-CLAIM-FLAG
  9774                                    WS-ST-CAUSAL-STATE
  9775                                    ws-st-agent-sig-edit
  9776                                    EC-ST-AH-REM-TERM-CALC
  9777                                    EC-ST-AH-REFUND-CALC
  9778          GO TO 0499-STATE-NOT-FOUND.
  9779
  9780     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9781
  9782 0405-CONTINUE-EDIT.
  9783
  9784     if pb-company-id = 'AHL'
  9785        continue
  9786     else
  9787        IF PB-CERT-PRIME NOT NUMERIC
  9788           MOVE ER-2722          TO WS-ERROR
  9789           PERFORM 9900-ERROR-FORMAT
  9790                                 THRU 9900-EXIT
  9791        end-if
  9792     END-IF
  9793*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 179
* EL050.cbl
  9794*       MOVE +0                  TO SUB3
  9795*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9796*       IF SUB3 > +0
  9797*          MOVE ER-2722          TO WS-ERROR
  9798*          PERFORM 9900-ERROR-FORMAT
  9799*                                THRU 9900-EXIT
  9800*       END-IF
  9801*    END-IF
  9802*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9803*       IF PB-CERT-PRIME NOT NUMERIC
  9804*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9805*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9806*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9807*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9808*
  9809*          MOVE ER-2722          TO WS-ERROR
  9810*          PERFORM 9900-ERROR-FORMAT
  9811*                                THRU 9900-EXIT
  9812*       END-IF
  9813*    END-IF
  9814
  9815     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9816
  9817     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9818        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9819                                    WS-TOL-AH-CLAIM.
  9820
  9821     IF CF-ST-REFUND-MIN NOT NUMERIC
  9822        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9823
  9824     IF CF-ST-REFUND-MIN NOT = ZEROS
  9825        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9826
  9827     IF CF-ST-TOL-PREM  NOT = ZEROS
  9828        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9829                                    WS-TOL-AH-PREM
  9830        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9831
  9832     IF CF-ST-TOL-REFUND NOT = ZEROS
  9833        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9834                                    WS-TOL-AH-REFUND
  9835        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9836
  9837     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9838        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9839        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9840                                    WS-AH-REFUND-OVS-AMT
  9841                                    EC-ST-OVR-SHT-AMT.
  9842
  9843     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9844        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9845        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9846                                    WS-TOL-LF-PREM-PCT
  9847                                    WS-TOL-AH-PREM-PCT.
  9848
  9849     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9850        CF-ST-TOL-REF-PCT GREATER THAN +0
  9851        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 180
* EL050.cbl
  9852                                    WS-TOL-LF-REFUND-PCT
  9853                                    WS-TOL-AH-REFUND-PCT.
  9854
  9855     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9856        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9857        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9858                                    WS-AH-REFUND-OVS-PCT
  9859                                    EC-ST-OVR-SHT-PCT.
  9860
  9861     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9862     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9863
  9864     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9865          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9866
  9867     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9868     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9869     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9870
  9871     IF CF-ST-LF-PREM-TAX NUMERIC
  9872        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9873     END-IF
  9874     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9875        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9876     END-IF
  9877     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9878        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9879     END-IF
  9880
  9881     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9882         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9883     END-IF.
  9884
  9885     IF CF-ST-CAUSAL-STATE > SPACES
  9886         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9887     END-IF.
  9888     if cf-st-extra-interest-periods not numeric
  9889        move zeros               to cf-st-extra-interest-periods
  9890     end-if
  9891     if cf-st-extra-payments not numeric
  9892        move zeros               to cf-st-extra-payments
  9893     end-if
  9894
  9895     move cf-st-extra-interest-periods
  9896                                 to ws-int-periods
  9897     move cf-st-extra-payments   to ws-extra-pmts
  9898     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9899     move cf-st-net-only-state   to ws-net-only-state
  9900     IF WS-LF-BENEFIT-CD = ZEROS
  9901        GO TO 0410-CHECK-AH.
  9902
  9903     IF CF-ST-RT-CALC NOT = SPACES
  9904        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9905                                    EC-ST-LF-REM-TERM-CALC
  9906     END-IF
  9907
  9908     IF WS-LF-COVERAGE-TYPE = 'R'
  9909        IF WS-LF-EARNINGS-CALC = '5'
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 181
* EL050.cbl
  9910           IF CF-ST-RF-LN-CALC > '0'
  9911              MOVE CF-ST-RF-LN-CALC
  9912                                 TO WS-LF-REFUND-CALC
  9913                                    EC-ST-LF-REFUND-CALC
  9914           END-IF
  9915        ELSE
  9916           IF CF-ST-RF-LR-CALC > '0'
  9917              MOVE CF-ST-RF-LR-CALC
  9918                                 TO WS-LF-REFUND-CALC
  9919                                    EC-ST-LF-REFUND-CALC
  9920           END-IF
  9921        END-IF
  9922     ELSE
  9923        IF CF-ST-RF-LL-CALC > '0'
  9924           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9925                                    EC-ST-LF-REFUND-CALC
  9926        END-IF
  9927     END-IF
  9928
  9929     IF CF-ST-RT-CALC NOT = SPACES
  9930        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9931                                    EC-ST-LF-REM-TERM-CALC
  9932     END-IF
  9933
  9934     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9935     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9936
  9937     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9938
  9939     IF NO-BENEFIT-FOUND
  9940        GO TO 0410-CHECK-AH.
  9941
  9942     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9943        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9944                                 TO EC-ST-LF-REM-TERM-CALC
  9945                                    WS-LF-REM-TERM-CALC
  9946     END-IF
  9947
  9948     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9949        MOVE CF-ST-REFUND-CALC (SUB3)
  9950                                 TO WS-LF-REFUND-CALC
  9951                                    EC-ST-LF-REFUND-CALC
  9952     END-IF
  9953*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9954     if cf-st-extra-periods (sub3) not numeric
  9955        move zeros               to cf-st-extra-periods (sub3)
  9956     end-if
  9957     if cf-st-extra-periods (sub3) > zeros
  9958        if ws-lf-ben-category = 'P'
  9959           move cf-st-extra-periods (sub3)
  9960                                 to ws-extra-pmts
  9961        else
  9962           if ws-lf-ben-category = 'I'
  9963              move cf-st-extra-periods (sub3)
  9964                                 to ws-int-periods
  9965           end-if
  9966        end-if
  9967     end-if
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 182
* EL050.cbl
  9968     .
  9969 0410-CHECK-AH.
  9970
  9971     IF WS-AH-BENEFIT-CD = ZEROS
  9972        GO TO 0500-SET-ACCOUNT.
  9973
  9974     IF CF-ST-RT-CALC NOT = SPACES
  9975        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9976                                    EC-ST-AH-REM-TERM-CALC
  9977     END-IF
  9978
  9979     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9980        IF CF-ST-RF-CP-CALC > '0'
  9981           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9982                                    EC-ST-AH-REFUND-CALC
  9983        END-IF
  9984     ELSE
  9985        IF CF-ST-RF-AH-CALC > '0'
  9986           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9987                                    EC-ST-AH-REFUND-CALC
  9988        END-IF
  9989     END-IF
  9990     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9991     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9992
  9993     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9994
  9995     IF NO-BENEFIT-FOUND
  9996        GO TO 0500-SET-ACCOUNT.
  9997
  9998     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9999        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10000                                 TO WS-AH-REM-TERM-CALC
 10001                                    EC-ST-AH-REM-TERM-CALC
 10002     END-IF
 10003
 10004     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10005        MOVE CF-ST-REFUND-CALC (SUB3)
 10006                                 TO WS-AH-REFUND-CALC
 10007                                    EC-ST-AH-REFUND-CALC
 10008     END-IF
 10009
 10010*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10011
 10012     GO TO 0500-SET-ACCOUNT.
 10013
 10014 0499-STATE-NOT-FOUND.
 10015
 10016     MOVE ER-2603                TO WS-ERROR.
 10017     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10018
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 183
* EL050.cbl
 10020
 10021 0500-SET-ACCOUNT.
 10022*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10023     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10024        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10025        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10026        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10027        MOVE '3'                 TO CNTL-REC-TYPE
 10028        MOVE +0                  TO CNTL-SEQ-NO
 10029
 10030        MOVE '3'                 TO RC-SW-2
 10031        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10032
 10033        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10034           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10035           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10036           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10037                                    WS-ST-AH-PREM-TAX-I
 10038                                    WS-ST-AH-PREM-TAX-G
 10039        ELSE
 10040           IF CF-ST-LF-PREM-TAX NUMERIC
 10041              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10042           END-IF
 10043           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10044              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10045           END-IF
 10046           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10047              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10048           END-IF
 10049        END-IF
 10050        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10051     END-IF
 10052*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10053*  FOR DCC ONLY
 10054     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10055
 10056     MOVE ' '                    TO STAT-MASTER-SW
 10057     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10058     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10059     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10060     MOVE PB-STATE               TO ELSTAT-STATE
 10061     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10062        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10063     END-IF
 10064
 10065     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10066     SET BIN-TO-GREG             TO TRUE
 10067     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10068     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10069     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10070
 10071     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10072     IF STAT-MASTER-FOUND
 10073        MOVE 'N'                 TO STAT-MASTER-SW
 10074        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10075        IF STAT-MASTER-FOUND
 10076           IF (ELSTAT-KEY-SAVE (1:12) =
 10077                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 184
* EL050.cbl
 10078              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10079                 MOVE 'F'        TO STAT-MASTER-SW
 10080              ELSE
 10081                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10082                 IF (STAT-MASTER-FOUND)
 10083                    AND (ELSTAT-KEY-SAVE (1:12) =
 10084                        SF-CONTROL-PRIMARY (1:12))
 10085                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10086                    MOVE 'F'     TO STAT-MASTER-SW
 10087                 END-IF
 10088              END-IF
 10089           END-IF
 10090        END-IF
 10091     END-IF
 10092
 10093     IF STAT-MASTER-SW = 'F'
 10094        IF (SF-ST-LF-PREM-TAX NUMERIC)
 10095           and (sf-st-lf-prem-tax > zeros)
 10096           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10097        END-IF
 10098        IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10099           and (sf-st-ah-prem-tax-i > zeros)
 10100           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10101        END-IF
 10102        IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10103           and (sf-st-ah-prem-tax-g > zeros)
 10104           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10105        END-IF
 10106     END-IF
 10107
 10108     END-IF
 10109     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10110        AND (PB-ISSUE)
 10111        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10112        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10113        AND (AM-GPCD = 06)
 10114        MOVE 'Y'                 TO WS-GOOD-HIN
 10115        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10116           MOVE PB-I-VIN         TO WS-WORK-VIN
 10117           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10118              (V1 > 16)
 10119              IF WS-WORK-VIN (V1:1) NUMERIC
 10120                 MOVE WS-WORK-VIN-N (V1)
 10121                                 TO WS-ROW-B-VAL (V1)
 10122              ELSE
 10123                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10124                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10125                    OR (V2 > 26)
 10126                 END-PERFORM
 10127                 IF V2 < 27
 10128                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10129                 ELSE
 10130                    MOVE 'N'     TO WS-GOOD-HIN
 10131                 END-IF
 10132              END-IF
 10133              COMPUTE WS-ROW-D-VAL (V1) =
 10134                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10135              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 185
* EL050.cbl
 10136                 WS-ROW-D-VAL (V1)
 10137           END-PERFORM
 10138           MOVE ZEROS            TO WS-VIN-REMAINDER
 10139           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10140             REMAINDER WS-VIN-REMAINDER
 10141           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10142              CONTINUE
 10143           ELSE
 10144              MOVE 'N'           TO WS-GOOD-HIN
 10145           END-IF
 10146        ELSE
 10147           MOVE 'N'              TO WS-GOOD-HIN
 10148        END-IF
 10149        IF WS-GOOD-HIN NOT = 'Y'
 10150           MOVE ER-3826           TO WS-ERROR
 10151           PERFORM 9900-ERROR-FORMAT
 10152                                 THRU 9900-EXIT
 10153        END-IF
 10154     END-IF
 10155     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10156        AND (PB-ISSUE)
 10157        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10158        AND (AM-GPCD NOT = 06)
 10159        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10160           perform 3400-edit-vin thru 3400-exit
 10161        ELSE
 10162          MOVE ER-3826           TO WS-ERROR
 10163          PERFORM 9900-ERROR-FORMAT
 10164                                 THRU 9900-EXIT
 10165        END-IF
 10166     END-IF
 10167     if (pb-company-id = 'CID')
 10168        and (pb-issue)
 10169        and (pb-i-vin not = spaces and low-values and zeros)
 10170        perform 3400-edit-vin    thru 3400-exit
 10171     end-if
 10172******************************************************************
 10173******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10174******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10175******* METHODS.
 10176******************************************************************
 10177     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10178        IF PB-CANCELLATION
 10179           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10180              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10181                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10182                IF FORM-MASTER-FOUND
 10183                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10184******************************************************************
 10185
 10186     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10187     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10188
 10189     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10190     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10191     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10192     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10193
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 186
* EL050.cbl
 10194
 10195     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10196     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10197     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10198
 10199     IF AM-LF-OB-RATE NOT NUMERIC
 10200         MOVE ZERO               TO AM-LF-OB-RATE.
 10201
 10202     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10203         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10204
 10205     IF AM-AH-OB-RATE NOT NUMERIC
 10206         MOVE ZERO               TO AM-AH-OB-RATE.
 10207
 10208     IF WS-LF-JOINT-INDICATOR = 'J'
 10209         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10210     ELSE
 10211         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10212
 10213     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10214
 10215     IF WS-IG-OVRD-AM  EQUAL SPACE
 10216         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10217
 10218     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10219         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10220                                       WS-IG-OVRD
 10221     ELSE
 10222         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10223             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10224                                       WS-IG-OVRD
 10225         ELSE
 10226             MOVE AM-IG             TO WS-IG-OVRD-AH
 10227                                       WS-IG-OVRD.
 10228
 10229     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10230         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10231                                       WS-IG-OVRD
 10232     ELSE
 10233         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10234             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10235                                       WS-IG-OVRD
 10236         ELSE
 10237             MOVE AM-IG             TO WS-IG-OVRD-LF
 10238                                       WS-IG-OVRD.
 10239
 10240     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10241     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10242     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10243     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10244*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10245     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10246                                              TO 'PRLDSFCTIA'.
 10247
 10248     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10249     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10250     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10251     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 187
* EL050.cbl
 10252
 10253     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10254     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10255     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10256     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10257     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10258     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10259     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10260
 10261     IF WS-ACCT-AH-DEV-PCT > +0
 10262        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10263     ELSE
 10264        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10265
 10266     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10267        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10268     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10269        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10270
 10271        IF AM-EARN-METHOD-L = 'S'
 10272            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10273                                        WS-LF-REFUND-CALC.
 10274
 10275        IF AM-EARN-METHOD-R = 'S'
 10276            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10277                                        WS-LF-REFUND-CALC.
 10278
 10279     IF WS-LF-COVERAGE-TYPE = 'R'
 10280         IF AM-EARN-METHOD-R = 'R'
 10281            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10282                                    WS-LF-REFUND-CALC.
 10283     IF WS-LF-COVERAGE-TYPE = 'R'
 10284         IF AM-EARN-METHOD-R = 'P'
 10285            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10286                                    WS-LF-REFUND-CALC.
 10287     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10288         IF AM-EARN-METHOD-L = 'R'
 10289            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10290                                    WS-LF-REFUND-CALC.
 10291     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10292         IF AM-EARN-METHOD-L = 'P'
 10293            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10294                                    WS-LF-REFUND-CALC.
 10295     IF WS-LF-COVERAGE-TYPE = 'R'
 10296         IF AM-EARN-METHOD-R = 'A'
 10297            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10298                                    WS-LF-REFUND-CALC.
 10299     IF WS-LF-COVERAGE-TYPE = 'R'
 10300         IF AM-EARN-METHOD-R = 'M'
 10301            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10302                                    WS-LF-REFUND-CALC.
 10303     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10304         IF AM-EARN-METHOD-L = 'A'
 10305            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10306                                    WS-LF-REFUND-CALC.
 10307     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10308         IF AM-EARN-METHOD-L = 'M'
 10309            MOVE '8'             TO EC-AM-LF-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 188
* EL050.cbl
 10310                                    WS-LF-REFUND-CALC.
 10311
 10312     IF AM-EARN-METHOD-A = 'R'
 10313        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10314                                    WS-AH-REFUND-CALC.
 10315     IF AM-EARN-METHOD-A = 'P'
 10316        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10317                                    WS-AH-REFUND-CALC.
 10318     IF AM-EARN-METHOD-A = 'C'
 10319        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10320                                    WS-AH-REFUND-CALC.
 10321     IF AM-EARN-METHOD-A = 'A'
 10322        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10323                                    WS-AH-REFUND-CALC.
 10324     IF AM-EARN-METHOD-A = 'M'
 10325        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10326                                    WS-AH-REFUND-CALC.
 10327     IF AM-EARN-METHOD-A = 'N'
 10328        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10329                                    WS-AH-REFUND-CALC.
 10330     IF AM-EARN-METHOD-A = 'S'
 10331        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10332                                    WS-AH-REFUND-CALC.
 10333
 10334     IF AM-TOL-PREM NOT = ZEROS
 10335        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10336                                    WS-TOL-AH-PREM.
 10337
 10338     IF AM-OVR-SHT-AMT NUMERIC AND
 10339                  AM-OVR-SHT-AMT > 0
 10340        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10341                                    EC-AM-LF-OVR-SHT-AMT
 10342                                    WS-AH-REFUND-OVS-AMT
 10343                                    EC-AM-AH-OVR-SHT-AMT.
 10344
 10345     IF AM-OVR-SHT-PCT NUMERIC AND
 10346                    AM-OVR-SHT-PCT > 0
 10347        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10348                                    EC-AM-LF-OVR-SHT-PCT
 10349                                    WS-AH-REFUND-OVS-PCT
 10350                                    EC-AM-AH-OVR-SHT-PCT.
 10351
 10352     IF AM-TOL-REF-PCT NUMERIC AND
 10353                  AM-TOL-REF-PCT > 0
 10354        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10355                                    WS-TOL-AH-REFUND-PCT.
 10356
 10357     IF AM-TOL-REF  NOT = ZEROS  AND
 10358                  AM-TOL-REF NUMERIC
 10359        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10360                                    EC-AM-LF-TOL-REFUND
 10361                                    WS-TOL-AH-REFUND
 10362                                    EC-AM-AH-TOL-REFUND.
 10363
 10364     IF AM-TOL-CLM  NOT = ZEROS
 10365        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10366                                    WS-TOL-AH-CLAIM.
 10367
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 189
* EL050.cbl
 10368     IF AM-CLP-TOL-PCT NOT NUMERIC
 10369        MOVE +0                  TO AM-CLP-TOL-PCT
 10370     END-IF
 10371
 10372     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10373        MOVE +0                  TO AM-SPP-LEASE-COMM
 10374     END-IF
 10375     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10376        MOVE WS-PL-TOL-LF-PREM-PCT
 10377                                 TO WS-TOL-LF-PREM-PCT.
 10378
 10379     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10380        MOVE WS-PL-TOL-AH-PREM-PCT
 10381                                 TO WS-TOL-AH-PREM-PCT.
 10382
 10383     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10384        MOVE WS-PL-TOL-LF-REFUND-PCT
 10385                                 TO WS-TOL-LF-REFUND-PCT.
 10386
 10387     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10388        MOVE WS-PL-TOL-AH-REFUND-PCT
 10389                                 TO WS-TOL-AH-REFUND-PCT.
 10390
 10391     IF WS-PL-REF-OVS-AMT > +0
 10392        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10393
 10394     IF WS-PL-REF-OVS-PCT > +0
 10395        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10396
 10397     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10398        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10399     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10400        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10401     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10402        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10403     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10404        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10405     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10406        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10407     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10408        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10409
 10410     IF WS-AH-PL-REF-OVS-AMT > +0
 10411        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10412
 10413     IF WS-AH-PL-REF-OVS-PCT > +0
 10414        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10415
 10416     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10417     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10418
 10419     IF PB-CANCELLATION
 10420        GO TO 3000-CONTINUE-EDIT.
 10421
 10422     MOVE +1 TO SUB1.
 10423     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10424     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10425
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 190
* EL050.cbl
 10426     IF CF-COMPANY-ID = 'DMD'
 10427       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10428         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10429        ELSE
 10430         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10431
 10432  0525-FIND-ACCT-COMM.
 10433     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10434        NEXT SENTENCE
 10435      ELSE
 10436         ADD +1 TO SUB1
 10437         IF SUB1 LESS +11
 10438            GO TO 0525-FIND-ACCT-COMM
 10439          ELSE
 10440             GO TO 0560-EDIT-CONTINUE.
 10441
 10442     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10443     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10444                                    PB-I-LIFE-COMMISSION.
 10445***  IF PB-COMPANY-ID = 'CRI'
 10446     IF PB-PREM-ACCTNG-ONLY
 10447         GO TO 0560-EDIT-CONTINUE.
 10448
 10449     MOVE '0530' TO CTBL-SW.
 10450     MOVE ' '    TO WS-CTBL-READ-SW.
 10451
 10452
 10453 0530-GET-AH-COMP.
 10454     IF NO-AH-COVERAGE  OR
 10455        NO-AH-BENEFIT-MATCH
 10456           GO TO 0540-NEXT-READ-STEP.
 10457
 10458     IF AM-A-COM (SUB1) NUMERIC
 10459        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10460         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10461         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10462         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10463         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10464     ELSE
 10465          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10466          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10467          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10468          MOVE ZEROS             TO WS-SUB1
 10469                                    WS-COMMISSION
 10470          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10471          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10472          IF WS-COMMISSION > ZEROS
 10473             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10474             GO TO 0540-NEXT-READ-STEP
 10475          END-IF
 10476          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10477          IF CTBL-TABLE-FOUND
 10478             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10479                                        PB-I-AH-TERM
 10480             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10481             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10482             GO TO 0540-NEXT-READ-STEP
 10483          ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 191
* EL050.cbl
 10484             IF FIRST-TIME-THROUGH
 10485                 GO TO 0530-GET-AH-COMP
 10486             ELSE
 10487                 MOVE ER-2609                TO WS-ERROR
 10488                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10489
 10490 0540-NEXT-READ-STEP.
 10491     MOVE '0540' TO CTBL-SW.
 10492     MOVE ' '    TO WS-CTBL-READ-SW.
 10493
 10494 0540-GET-LF-COMP.
 10495     IF NO-LIFE-COVERAGE  OR
 10496        NO-LF-BENEFIT-MATCH
 10497           GO TO 0560-EDIT-CONTINUE.
 10498
 10499     IF WS-LF-JOINT-INDICATOR = 'J'
 10500        IF AM-J-COM (SUB1) NUMERIC
 10501           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10502           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10503           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10504           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10505           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10506        ELSE
 10507           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10508           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10509           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10510           MOVE ZEROS                TO WS-SUB1
 10511                                        WS-COMMISSION
 10512           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10513           IF WS-COMMISSION > ZEROS
 10514              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10515              GO TO 0560-EDIT-CONTINUE
 10516           END-IF
 10517           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10518           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10519           IF CTBL-TABLE-FOUND
 10520              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10521              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10522              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10523              GO TO 0560-EDIT-CONTINUE
 10524           ELSE
 10525              IF FIRST-TIME-THROUGH
 10526                  GO TO 0540-GET-LF-COMP
 10527              ELSE
 10528                  MOVE ER-2609                TO WS-ERROR
 10529                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10530                  GO TO 0560-EDIT-CONTINUE.
 10531
 10532     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10533        IF AM-L-COM (SUB1) NUMERIC
 10534           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10535           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10536           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10537           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10538           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10539        ELSE
 10540           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10541           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 192
* EL050.cbl
 10542           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10543           MOVE ZEROS                TO WS-SUB1
 10544                                        WS-COMMISSION
 10545           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10546           IF WS-COMMISSION IS GREATER THAN ZEROS
 10547              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10548              GO TO 0560-EDIT-CONTINUE
 10549           END-IF
 10550           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10551           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10552           IF CTBL-TABLE-FOUND
 10553              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10554              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10555              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10556              GO TO 0560-EDIT-CONTINUE
 10557           ELSE
 10558              IF FIRST-TIME-THROUGH
 10559                  GO TO 0540-GET-LF-COMP
 10560              ELSE
 10561                  MOVE ER-2609                TO WS-ERROR
 10562                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10563
 10564*    GO TO 0560-EDIT-CONTINUE.
 10565
 10566 0560-EDIT-CONTINUE.
 10567     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10568                                    WS-AH-PMF-COMM
 10569*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10570*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10571     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10572        (SUB1 > +10)
 10573        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10574           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10575           MOVE '0530'           TO CTBL-SW
 10576           MOVE ' '              TO WS-CTBL-READ-SW
 10577           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10578           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10579           MOVE '0540'           TO CTBL-SW
 10580           MOVE ' '              TO WS-CTBL-READ-SW
 10581           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10582        END-IF
 10583     END-PERFORM
 10584     GO TO 0564-EDIT-CONTINUE
 10585     .
 10586 0561-CHECK-AH.
 10587     IF (NO-AH-COVERAGE)
 10588        OR (NO-AH-BENEFIT-MATCH)
 10589        CONTINUE
 10590     ELSE
 10591        IF (AM-A-COM (SUB1) NUMERIC)
 10592           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10593           IF (AM-COM-TYP (SUB1) = 'A')
 10594              AND (WS-AH-PMF-COMM = ZEROS)
 10595              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10596           END-IF
 10597           CONTINUE
 10598        ELSE
 10599           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 193
* EL050.cbl
 10600           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10601           MOVE PB-AH-OVERRIDE-L1
 10602                                 TO CTBL-BEN-TYPE
 10603           MOVE ZEROS            TO WS-SUB1
 10604                                    WS-COMMISSION
 10605           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10606           PERFORM 8300-READ-CTBL-TABLE
 10607                                 THRU 8300-EXIT
 10608           IF CTBL-TABLE-FOUND
 10609              IF (AM-COM-TYP (SUB1) = 'A')
 10610                 AND (WS-AH-PMF-COMM = ZEROS)
 10611                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10612                                        PB-I-AH-TERM
 10613                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10614                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10615              END-IF
 10616              CONTINUE
 10617           ELSE
 10618              IF FIRST-TIME-THROUGH
 10619                 GO TO 0561-CHECK-AH
 10620              ELSE
 10621                 MOVE ER-2609    TO WS-ERROR
 10622                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10623              END-IF
 10624           END-IF
 10625        END-IF
 10626     END-IF
 10627     .
 10628 0561-EXIT.
 10629     EXIT.
 10630 0563-CHECK-LF.
 10631     IF (NO-LIFE-COVERAGE)
 10632        OR (NO-LF-BENEFIT-MATCH)
 10633        CONTINUE
 10634     ELSE
 10635        IF WS-LF-JOINT-INDICATOR = 'J'
 10636           IF AM-J-COM (SUB1) NUMERIC
 10637              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10638              IF (AM-COM-TYP (SUB1) = 'A')
 10639                 AND (WS-LF-PMF-COMM = ZEROS)
 10640                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10641              END-IF
 10642              CONTINUE
 10643           ELSE
 10644              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10645              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10646              MOVE PB-LIFE-OVERRIDE-L1
 10647                                 TO CTBL-BEN-TYPE
 10648              MOVE ZEROS         TO WS-SUB1
 10649                                    WS-COMMISSION
 10650              MOVE AM-J-COMA (SUB1)
 10651                                 TO CTBL-TABLE
 10652              PERFORM 8300-READ-CTBL-TABLE
 10653                                 THRU 8300-EXIT
 10654              IF CTBL-TABLE-FOUND
 10655                 IF (AM-COM-TYP (SUB1) = 'A')
 10656                    AND (WS-LF-PMF-COMM = ZEROS)
 10657                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 194
* EL050.cbl
 10658                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10659                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10660                 END-IF
 10661                 CONTINUE
 10662              ELSE
 10663                 IF FIRST-TIME-THROUGH
 10664                    GO TO 0563-CHECK-LF
 10665                 ELSE
 10666                    MOVE ER-2609 TO WS-ERROR
 10667                    PERFORM 9900-ERROR-FORMAT
 10668                                 THRU 9900-EXIT
 10669*                   GO TO 0560-EDIT-CONTINUE
 10670                 END-IF
 10671              END-IF
 10672           END-IF
 10673        ELSE
 10674           IF AM-L-COM (SUB1) NUMERIC
 10675              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10676              IF (AM-COM-TYP (SUB1) = 'A')
 10677                 AND (WS-LF-PMF-COMM = ZEROS)
 10678                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10679              END-IF
 10680              CONTINUE
 10681           ELSE
 10682              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10683              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10684              MOVE PB-LIFE-OVERRIDE-L1
 10685                                 TO CTBL-BEN-TYPE
 10686              MOVE ZEROS         TO WS-SUB1
 10687                                    WS-COMMISSION
 10688              MOVE AM-L-COMA (SUB1)
 10689                                 TO CTBL-TABLE
 10690              PERFORM 8300-READ-CTBL-TABLE
 10691                                 THRU 8300-EXIT
 10692              IF CTBL-TABLE-FOUND
 10693                 CONTINUE
 10694              ELSE
 10695                 IF FIRST-TIME-THROUGH
 10696                    GO TO 0563-CHECK-LF
 10697                 ELSE
 10698                    MOVE ER-2609 TO WS-ERROR
 10699                    PERFORM 9900-ERROR-FORMAT
 10700                                 THRU 9900-EXIT
 10701                 END-IF
 10702              END-IF
 10703           END-IF
 10704        END-IF
 10705     END-IF
 10706     .
 10707 0563-EXIT.
 10708     EXIT.
 10709 0564-EDIT-CONTINUE.
 10710
 10711     IF  PB-COMPANY-ID EQUAL 'DMD'
 10712         IF PB-I-NUM-BILLED EQUAL ZEROS
 10713            MOVE ER-8148       TO WS-ERROR
 10714            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10715
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 195
* EL050.cbl
 10716*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10717*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10718*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10719*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10720*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10721*         IF NO-CONVERSION-ERROR
 10722*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10723*         ELSE
 10724*             IF PB-COMPANY-ID EQUAL 'HAN'
 10725*                 MOVE ZEROS     TO PB-I-AGE.
 10726     IF PB-I-BIRTHDAY > LOW-VALUES
 10727        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10728        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10729        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10730        PERFORM 8500-DATE-CONVERT
 10731                                 THRU 8500-EXIT
 10732        IF NO-CONVERSION-ERROR
 10733           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10734           IF PB-I-AGE > ZEROS
 10735              IF WS-WORK-AGE NOT = PB-I-AGE
 10736                 MOVE ER-9501    TO WS-ERROR
 10737                 PERFORM 9900-ERROR-FORMAT
 10738                                 THRU 9900-EXIT
 10739              END-IF
 10740           ELSE
 10741              MOVE WS-WORK-AGE   TO PB-I-AGE
 10742           END-IF
 10743        END-IF
 10744     END-IF
 10745     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10746                                   WS-INS-AGE-SET
 10747     IF PB-I-AGE = ZEROS
 10748        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10749           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10750                                   WS-INS-AGE-SET
 10751           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10752
 10753     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10754                                   WS-AH-EDIT-AGE.
 10755
 10756     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10757        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10758        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10759        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10760        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10761        IF NO-CONVERSION-ERROR
 10762           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10763           IF PB-I-JOINT-AGE > 0
 10764              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10765                 MOVE ER-9503    TO WS-ERROR
 10766                 PERFORM 9900-ERROR-FORMAT
 10767                                 THRU 9900-EXIT
 10768              END-IF
 10769           ELSE
 10770              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10771           END-IF
 10772        ELSE
 10773           MOVE ZEROS            TO PB-I-JOINT-AGE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 196
* EL050.cbl
 10774        END-IF
 10775     END-IF
 10776     IF PB-I-JOINT-AGE NOT NUMERIC
 10777        MOVE ZERO               TO PB-I-JOINT-AGE.
 10778
 10779     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10780                                   WS-JNT-AGE-SET
 10781     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 10782        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10783           (WS-AH-JOINT-INDICATOR = 'J')
 10784           IF PB-I-JOINT-AGE = ZEROS
 10785               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10786                                          WS-JNT-AGE-SET
 10787               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10788           END-IF
 10789        END-IF
 10790     END-IF
 10791
 10792     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10793     IF WS-LF-JOINT-INDICATOR = 'J'
 10794        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10795        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10796            IF  PB-I-JOINT-AGE = ZERO
 10797                MOVE ER-2686       TO WS-ERROR
 10798                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10799            ELSE
 10800                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10801                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10802                    IF PB-COMPANY-ID NOT = 'LBL'
 10803                        MOVE ER-2685    TO WS-ERROR
 10804                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10805
 10806     IF WS-AH-JOINT-INDICATOR = 'J'
 10807        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10808            IF  PB-I-JOINT-AGE = ZERO
 10809                MOVE ER-2686       TO WS-ERROR
 10810                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10811            ELSE
 10812                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10813                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10814                                           WS-EDIT-AGE
 10815                    IF PB-COMPANY-ID NOT = 'LBL'
 10816                        MOVE ER-2685    TO WS-ERROR
 10817                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10818
 10819******************************************************************
 10820*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10821******************************************************************
 10822
 10823     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10824        (WS-AH-SPECIAL-CALC-CD = 'O')
 10825        NEXT SENTENCE
 10826     ELSE
 10827        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10828          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10829           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10830            WS-AH-JOINT-INDICATOR = 'J')  AND
 10831           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 197
* EL050.cbl
 10832            MOVE ER-2627             TO WS-ERROR
 10833            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10834
 10835     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10836        (WS-AH-SPECIAL-CALC-CD = 'O')
 10837         NEXT SENTENCE
 10838     ELSE
 10839         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10840            WS-AH-JOINT-INDICATOR = 'J'
 10841             IF PB-I-JOINT-INSURED = SPACES
 10842                 IF PB-COMPANY-ID NOT = 'JAL'
 10843                     MOVE ER-2696    TO WS-ERROR
 10844                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10845
 10846     IF PB-COMPANY-ID NOT = 'BOA'
 10847        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10848           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10849           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10850               PB-I-JOINT-INSURED NOT = SPACES)
 10851                MOVE ER-2691         TO WS-ERROR
 10852                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10853
 10854     IF PB-COMPANY-ID = 'BOA'
 10855        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10856           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10857            IF PB-I-JOINT-AGE NOT = ZEROS
 10858                MOVE ER-2691         TO WS-ERROR
 10859                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10860
 10861     IF PB-COMPANY-ID = 'CRI'
 10862        IF PB-I-SIG-SW = 'J'
 10863           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10864              WS-AH-JOINT-INDICATOR NOT = 'J'
 10865              MOVE ER-2675       TO WS-ERROR
 10866              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10867
 10868     IF PB-COMPANY-ID = 'CRI'
 10869        IF PB-I-SIG-SW = 'S'
 10870           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10871              WS-AH-JOINT-INDICATOR = 'J'
 10872              MOVE ER-2676       TO WS-ERROR
 10873              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10874
 10875     IF PB-COMPANY-ID = 'CVL'
 10876         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10877            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10878              MOVE ER-2783           TO WS-ERROR
 10879              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10880     IF (WS-LF-JOINT-INDICATOR = 'J')
 10881        AND (WS-AH-JOINT-INDICATOR = 'J')
 10882        AND (PB-I-LF-TERM > 120)
 10883        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10884        MOVE ER-2783             TO WS-ERROR
 10885        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10886     END-IF
 10887     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10888
 10889     IF PB-I-INDV-GRP-OVRD = 'I'
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 198
* EL050.cbl
 10890        MOVE ER-2666             TO WS-ERROR
 10891        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10892        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10893
 10894     IF PB-I-INDV-GRP-OVRD = 'G'
 10895        MOVE ER-2666             TO WS-ERROR
 10896        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10897        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10898
 10899     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10900        NEXT SENTENCE
 10901     ELSE
 10902        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10903
 10904     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10905        IF WS-ERROR = ER-2666
 10906           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10907           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10908
 10909     IF PB-COMPANY-ID = 'CID'
 10910        IF PB-STATE = 'UT' OR 'MO'
 10911           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10912                 OR '76' OR '77')
 10913                      OR
 10914               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10915                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10916                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10917                   OR '2K' OR '2L'))
 10918              AND PB-I-INDV-GRP-CD = 'I'
 10919              MOVE ER-2721             TO WS-ERROR
 10920              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10921           END-IF
 10922        END-IF
 10923     END-IF
 10924
 10925     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10926     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10927        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10928     ELSE
 10929        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10930     END-IF
 10931
 10932*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10933*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10934     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10935                                    ACCOUNT-AH-CK-SW.
 10936
 10937     IF PB-REISSUED-CERT       OR
 10938        PB-REIN-ONLY-CERT      OR
 10939        PB-POLICY-IS-DECLINED  OR
 10940        PB-POLICY-IS-VOIDED
 10941*       OR PB-MONTHLY-CERT
 10942         GO TO 3000-CONTINUE-EDIT.
 10943
 10944     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10945        IF WS-EDIT-AGE           > +65
 10946           MOVE ER-2709          TO WS-ERROR
 10947           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 199
* EL050.cbl
 10948                                 THRU 9900-EXIT
 10949        ELSE
 10950           IF WS-EDIT-AGE        > +55
 10951              MOVE ER-2718       TO WS-ERROR
 10952              PERFORM 9900-ERROR-FORMAT
 10953                                 THRU 9900-EXIT
 10954           END-IF
 10955        END-IF
 10956     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10957        IF WS-EDIT-AGE           > +65
 10958           MOVE ER-2709          TO WS-ERROR
 10959           PERFORM 9900-ERROR-FORMAT
 10960                                 THRU 9900-EXIT
 10961        END-IF
 10962     END-IF
 10963     .
 10964
 10965 0565-LIFE-PLAN-LIMIT-EDITS.
 10966
 10967     IF NOT LF-PLAN-MASTER-FOUND
 10968        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10969                                    EC-AM-LF-MAX-TOT-BEN
 10970        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10971
 10972     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10973
 10974     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10975         IF PL-LM-AGE (1) = ZEROS
 10976             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10977
 10978     IF NO-LF-BENEFIT-MATCH          OR
 10979        WS-LF-BENEFIT-CD = ZEROS     OR
 10980        WS-LF-SPECIAL-CALC-CD = 'M'
 10981        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10982
 10983     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10984     MOVE +1                     TO SUB2.
 10985
 10986     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10987        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10988           MOVE +5   TO SUB2
 10989           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10990              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10991              (PL-LM-AGE (SUB2) EQUAL +0)
 10992              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10993              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10994
 10995     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10996
 10997     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10998                               + PB-I-LF-ALT-BENEFIT-AMT.
 10999
 11000 0568-CHECK-LIFE-ATT-AGE.
 11001
 11002     IF PL-ATT-AGE NUMERIC AND
 11003        PL-ATT-AGE > +0
 11004        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11005     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 200
* EL050.cbl
 11006*    IF PL-ATT-AGE NUMERIC AND
 11007*       PL-ATT-AGE > +0
 11008*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11009*       IF PB-I-BIRTHDAY > LOW-VALUES
 11010*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11011*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11012*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11013*          SET BIN-PLUS-ELAPSED  TO TRUE
 11014*          PERFORM 8500-DATE-CONVERT
 11015*                                THRU 8500-EXIT
 11016*          IF NO-CONVERSION-ERROR
 11017*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11018*             MOVE ER-2669       TO WS-ERROR
 11019*             PERFORM 9900-ERROR-FORMAT
 11020*                                THRU 9900-EXIT
 11021*          END-IF
 11022*       ELSE
 11023*          IF WS-ATT-AGE >= PL-ATT-AGE
 11024*             MOVE ER-2669       TO WS-ERROR
 11025*             PERFORM 9900-ERROR-FORMAT
 11026*                                THRU 9900-EXIT
 11027*          END-IF
 11028*       END-IF
 11029*    END-IF
 11030     .
 11031 0570-CHECK-LIFE-LIMITS.
 11032
 11033     IF PB-COMPANY-ID EQUAL 'CRI'
 11034        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11035           IF SUB2 GREATER THAN +4
 11036              MOVE ER-2637 TO WS-ERROR
 11037              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11038              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11039
 11040     IF PB-COMPANY-ID  =  'NCL'
 11041        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11042            SUB2 GREATER THAN +8
 11043             MOVE 'U'         TO PB-BATCH-ENTRY
 11044             MOVE ER-2637     TO WS-ERROR
 11045             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11046             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11047
 11048     IF SUB2 > +8
 11049        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11050           AND (PB-I-SIG-SW = 'Y')
 11051           CONTINUE
 11052        ELSE
 11053           MOVE ER-2637          TO WS-ERROR
 11054           PERFORM 9900-ERROR-FORMAT
 11055                                 THRU 9900-EXIT
 11056        END-IF
 11057        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11058     END-IF
 11059     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11060     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11061     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11062
 11063     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 201
* EL050.cbl
 11064        ADD +1  TO SUB2
 11065        GO TO 0570-CHECK-LIFE-LIMITS.
 11066
 11067     IF PB-COMPANY-ID = 'NCL'
 11068         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11069
 11070     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11071        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11072        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11073           AND (PB-I-SIG-SW = 'Y')
 11074           CONTINUE
 11075        ELSE
 11076           MOVE ER-2637          TO WS-ERROR
 11077           PERFORM 9900-ERROR-FORMAT
 11078                                 THRU 9900-EXIT
 11079        END-IF
 11080     END-IF
 11081     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11082
 11083
 11084 0570-CHECK-NCL-LIFE-LIMITS.
 11085
 11086     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11087        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11088         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11089
 11090     IF APP-CERT-USED
 11091         IF SUB2  LESS THAN  +5
 11092             MOVE +5          TO SUB2
 11093             GO TO 0570-CHECK-LIFE-LIMITS.
 11094
 11095     MOVE ER-2637             TO WS-ERROR.
 11096     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11097
 11098     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11099
 11100 0575-CHECK-NCL-SIG-SWITCH.
 11101
 11102     IF NOT APP-CERT-USED
 11103         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11104
 11105     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11106        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11107        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11108        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11109         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11110
 11111     IF SUB2 GREATER THAN +4
 11112         IF PL-LM-AGE (5) = ZEROS  AND
 11113            PL-LM-AGE (6) = ZEROS  AND
 11114            PL-LM-AGE (7) = ZEROS  AND
 11115            PL-LM-AGE (8) = ZEROS
 11116             MOVE  ER-1927        TO WS-ERROR
 11117             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11118             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11119         ELSE
 11120             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11121                 MOVE  ER-1920    TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 202
* EL050.cbl
 11122                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11123
 11124     IF PB-I-SIG-SW  = 'Y'
 11125       IF NOT PB-I-POLICY-ACCEPTED  AND
 11126          NOT PB-I-POLICY-DECLINED
 11127           MOVE 'U'               TO PB-BATCH-ENTRY
 11128           MOVE  ER-1926          TO WS-ERROR
 11129           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11130
 11131
 11132 0580-AH-PLAN-LIMIT-EDITS.
 11133
 11134     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11135        IF PB-I-AH-BENEFIT-AMT > +1250
 11136           MOVE ER-2702          TO WS-ERROR
 11137           PERFORM 9900-ERROR-FORMAT
 11138                                 THRU 9900-EXIT
 11139        END-IF
 11140     END-IF
 11141
 11142     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11143        AND (PB-MONTHLY-CERT)
 11144        IF PB-I-AH-BENEFIT-AMT > +3000
 11145           MOVE ER-2881          TO WS-ERROR
 11146           PERFORM 9900-ERROR-FORMAT
 11147                                 THRU 9900-EXIT
 11148        END-IF
 11149     END-IF
 11150     IF NOT AH-PLAN-MASTER-FOUND
 11151        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11152        GO TO 3000-CONTINUE-EDIT.
 11153
 11154     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11155
 11156     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11157         IF PL-LM-AGE (1) = ZEROS
 11158             GO TO 3000-CONTINUE-EDIT.
 11159
 11160     IF NO-AH-BENEFIT-MATCH          OR
 11161        WS-AH-BENEFIT-CD = ZEROS     OR
 11162        WS-AH-SPECIAL-CALC-CD = 'M'
 11163        GO TO 3000-CONTINUE-EDIT.
 11164
 11165     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11166     MOVE +1                     TO SUB2.
 11167
 11168     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11169        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11170           MOVE +5 TO SUB2
 11171           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11172              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11173              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11174              (PL-LM-AGE (SUB2) EQUAL +0)
 11175              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11176              GO TO 3000-CONTINUE-EDIT.
 11177
 11178     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11179
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 203
* EL050.cbl
 11180 0590-CHECK-AH-ATT-AGE.
 11181
 11182     IF PL-ATT-AGE NUMERIC AND
 11183        PL-ATT-AGE GREATER THAN +0
 11184        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11185     END-IF
 11186*       IF WS-ATT-AGE >= PL-ATT-AGE
 11187*          MOVE ER-3054          TO WS-ERROR
 11188*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11189     .
 11190 0597-CHECK-AH-LIMITS.
 11191
 11192     IF PB-COMPANY-ID EQUAL 'CRI'
 11193        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11194           IF SUB2 GREATER THAN +4
 11195              MOVE ER-2638       TO WS-ERROR
 11196              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11197              GO TO 3000-CONTINUE-EDIT.
 11198
 11199     IF PB-COMPANY-ID  =  'NCL'
 11200        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11201            SUB2 GREATER THAN +8
 11202             MOVE 'U'            TO PB-BATCH-ENTRY
 11203             MOVE ER-2638        TO WS-ERROR
 11204             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11205             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11206
 11207     IF SUB2 > +8
 11208        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11209           AND (PB-I-SIG-SW = 'Y')
 11210           CONTINUE
 11211        ELSE
 11212           MOVE ER-2638          TO WS-ERROR
 11213           PERFORM 9900-ERROR-FORMAT
 11214                                 THRU 9900-EXIT
 11215        END-IF
 11216        GO TO 3000-CONTINUE-EDIT
 11217     END-IF
 11218
 11219     IF PB-COMPANY-ID = 'CRI'
 11220        IF WS-ERROR = ER-2638
 11221           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11222
 11223     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11224     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11225     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11226     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11227
 11228     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11229        ADD +1                   TO SUB2
 11230        GO TO 0597-CHECK-AH-LIMITS.
 11231
 11232     IF PB-COMPANY-ID = 'NCL'
 11233         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11234
 11235     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11236        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11237        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 204
* EL050.cbl
 11238                                 > PL-LM-AMT (SUB2))
 11239        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11240           AND (PB-I-SIG-SW = 'Y')
 11241           CONTINUE
 11242        ELSE
 11243           MOVE ER-2638          TO WS-ERROR
 11244           PERFORM 9900-ERROR-FORMAT
 11245                                 THRU 9900-EXIT
 11246        END-IF
 11247     END-IF
 11248
 11249     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11250         IF  WS-ERROR    EQUAL    ER-2638
 11251             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11252                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11253                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11254                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11255                MOVE  ER-1910    TO  WS-ERROR
 11256                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11257
 11258     IF PB-COMPANY-ID = 'CRI'
 11259        IF WS-ERROR = ER-2638
 11260            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11261            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11262            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11263
 11264     GO TO 3000-CONTINUE-EDIT.
 11265
 11266 0597-CHECK-NCL-AH-LIMITS.
 11267
 11268     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11269        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11270        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11271                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11272         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11273
 11274     IF APP-CERT-USED
 11275         IF SUB2  LESS THAN  +5
 11276             MOVE +5             TO SUB2
 11277             GO TO 0597-CHECK-AH-LIMITS.
 11278
 11279     MOVE ER-2638                TO WS-ERROR.
 11280     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11281
 11282     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11283
 11284 0599-CHECK-NCL-SIG-SWITCH.
 11285
 11286     IF NOT APP-CERT-USED
 11287         GO TO 3000-CONTINUE-EDIT.
 11288
 11289     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11290        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11291        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11292        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11293         GO TO 3000-CONTINUE-EDIT.
 11294
 11295     IF SUB2 GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 205
* EL050.cbl
 11296         IF PL-LM-AGE (5) = ZEROS  AND
 11297            PL-LM-AGE (6) = ZEROS  AND
 11298            PL-LM-AGE (7) = ZEROS  AND
 11299            PL-LM-AGE (8) = ZEROS
 11300             MOVE  ER-1927        TO WS-ERROR
 11301             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11302             GO TO 3000-CONTINUE-EDIT
 11303         ELSE
 11304             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11305                 MOVE  ER-1920    TO WS-ERROR
 11306                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11307
 11308     IF PB-I-SIG-SW  = 'Y'
 11309       IF NOT PB-I-POLICY-ACCEPTED  AND
 11310          NOT PB-I-POLICY-DECLINED
 11311           MOVE 'U'               TO PB-BATCH-ENTRY
 11312           MOVE  ER-1926          TO WS-ERROR
 11313           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11314
 11315******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 206
* EL050.cbl
 11317
 11318 3000-CONTINUE-EDIT.
 11319
 11320     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11321     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11322     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11323     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11324     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11325
 11326     IF BROWSE-STARTED
 11327        PERFORM 9990-RETURN THRU 9990-EXIT
 11328        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11329
 11330     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11331        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11332        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11333        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11334*       MOVE 1                   TO DC-OPTION-CODE
 11335        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11336        IF DATE-CONVERSION-ERROR
 11337           MOVE ER-2622          TO WS-ERROR
 11338           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11339        ELSE
 11340           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11341              MOVE ER-2623       TO WS-ERROR
 11342              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11343           ELSE
 11344              MOVE ER-2622       TO WS-ERROR
 11345              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11346
 11347     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11348     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11349     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11350*    MOVE 1                      TO DC-OPTION-CODE.
 11351     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11352     IF DATE-CONVERSION-ERROR
 11353        GO TO 3005-EDIT-CONTINUE
 11354     ELSE
 11355        IF DC-ELAPSED-DAYS GREATER +180
 11356           MOVE ER-2613          TO WS-ERROR
 11357           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358        ELSE
 11359           IF DC-ELAPSED-DAYS GREATER +90
 11360              MOVE ER-2612       TO WS-ERROR
 11361              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11362           ELSE
 11363             IF DC-ELAPSED-DAYS GREATER +60
 11364                MOVE ER-2614     TO WS-ERROR
 11365                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11366
 11367 3005-EDIT-CONTINUE.
 11368
 11369     IF PB-CANCELLATION
 11370         GO TO 3700-EDIT-CANCEL.
 11371
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 207
* EL050.cbl
 11373******************************************************************
 11374*                  E D I T   I S S U E                           *
 11375******************************************************************
 11376
 11377 3020-EDIT-ISSUE.
 11378
 11379      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11380      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11381      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11382      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11383      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11384
 11385     IF PB-ISSUE-FORCE
 11386        OR PB-ISSUE-DATE-FORCED
 11387        OR PB-FORCE-OFF
 11388        OR PB-OVERCHARGE-FORCE
 11389        CONTINUE
 11390     ELSE
 11391        MOVE ER-2670             TO WS-ERROR
 11392        PERFORM 9900-ERROR-FORMAT
 11393                                 THRU 9900-EXIT
 11394     END-IF
 11395     .
 11396 3022-SET-POLICY-STATUS.
 11397
 11398     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11399
 11400     IF (PB-REISSUED-CERT)
 11401             OR
 11402        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11403         AND (PB-MONTHLY-CERT))
 11404         MOVE '5'                TO PB-I-ENTRY-STATUS
 11405         MOVE 'E'                TO PB-BATCH-ENTRY
 11406     END-IF
 11407
 11408     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11409        IF PB-MONTHLY-CERT
 11410           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11411        END-IF
 11412        IF PB-CASH-CERT
 11413           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11414        END-IF
 11415     END-IF
 11416     IF PB-POLICY-IS-DECLINED
 11417         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11418     IF PB-POLICY-IS-VOIDED
 11419         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11420     IF PB-NEEDS-UNDERWRITING
 11421         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11422     IF PB-REIN-ONLY-CERT
 11423         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11424     IF PB-PREM-ACCTNG-ONLY
 11425         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11426
 11427     MOVE SPACE                  TO PB-I-OB-FLAG.
 11428
 11429     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11430         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 208
* EL050.cbl
 11431         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11432         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11433
 11434     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11435        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11436           MOVE 'Z'             TO PB-I-OB-FLAG.
 11437
 11438     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11439        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11440           MOVE 'Z'             TO PB-I-OB-FLAG.
 11441
 11442     IF ACCOUNT-MAST-FOUND
 11443         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11444         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11445         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11446         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11447         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11448         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11449         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11450     END-IF
 11451
 11452     IF ACCOUNT-MAST-FOUND
 11453        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11454         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11455
 11456     IF (ACCOUNT-MAST-FOUND)
 11457*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11458        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11459        IF PB-REISSUED-CERT
 11460           CONTINUE
 11461        ELSE
 11462           MOVE ER-2608          TO WS-ERROR
 11463           PERFORM 9900-ERROR-FORMAT
 11464                                 THRU 9900-EXIT
 11465         END-IF
 11466     END-IF
 11467
 11468     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11469        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11470        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11471
 11472**********   DMD CUSTOM CODE FOLLOWS  **********
 11473 3024-EDIT-DMD-FIELDS.
 11474     IF PB-COMPANY-ID NOT = 'DMD'
 11475        GO TO 3025-EDIT-REINSURANCE.
 11476
 11477*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11478*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11479*** ERROR IF THEY ARE NOT EQUAL.
 11480
 11481     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11482     SET BIN-TO-GREG               TO TRUE.
 11483     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11484     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11485**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11486
 11487     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11488     SET BIN-TO-GREG               TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 209
* EL050.cbl
 11489     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11490     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11491**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11492
 11493     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11494        MOVE ER-8116               TO WS-ERROR
 11495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11496
 11497     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11498
 11499     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11500                                      WK-FULL-CERT-NO.
 11501     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11502
 11503     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11504
 11505     IF PB-VALID-LIFE
 11506        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11507     ELSE
 11508        IF PB-VALID-AH
 11509          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11510
 11511
 11512     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11513     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11514     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11515                                      DCUA-UNDRWRTR-CODE
 11516                                      DCUA-UNDRWRTR-GROUP-CODE
 11517                                      DCUA-RETURN-CODE.
 11518
 11519****************************************************************
 11520*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11521***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11522***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11523***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11524***   TO THIS RECORD.                                        ***
 11525****************************************************************
 11526     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11527     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11528     IF DCUA-SUCCESSFUL-PROCESS
 11529        GO TO 3024-EDIT-DL7-CONT.
 11530
 11531     IF DCUA-RETURN-CODE EQUAL '01'
 11532        MOVE ER-8110               TO WS-ERROR
 11533        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11535        GO TO 3024-EDIT-DL7-CONT.
 11536
 11537     IF DCUA-RETURN-CODE EQUAL '02'
 11538        MOVE ER-8111               TO WS-ERROR
 11539        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11541        GO TO 3024-EDIT-DL7-CONT.
 11542
 11543     IF DCUA-RETURN-CODE EQUAL '03'
 11544        MOVE ER-8074               TO WS-ERROR
 11545        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 210
* EL050.cbl
 11547        GO TO 3024-EDIT-DL7-CONT.
 11548
 11549     IF DCUA-RETURN-CODE EQUAL '04'
 11550        MOVE ER-8075               TO WS-ERROR
 11551        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11553        GO TO 3024-EDIT-DL7-CONT.
 11554
 11555     IF DCUA-RETURN-CODE EQUAL '05'
 11556        MOVE ER-8076               TO WS-ERROR
 11557        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11559        GO TO 3024-EDIT-DL7-CONT.
 11560
 11561     IF DCUA-RETURN-CODE EQUAL '06'
 11562        MOVE ER-8077               TO WS-ERROR
 11563        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11565        GO TO 3024-EDIT-DL7-CONT.
 11566
 11567     IF DCUA-RETURN-CODE EQUAL '07'
 11568        MOVE ER-8078               TO WS-ERROR
 11569        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11571        GO TO 3024-EDIT-DL7-CONT.
 11572
 11573     IF DCUA-RETURN-CODE EQUAL 'E1'
 11574        MOVE ER-8079               TO WS-ERROR
 11575        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11577        GO TO 3024-EDIT-DL7-CONT.
 11578
 11579     IF DCUA-RETURN-CODE EQUAL 'E2'
 11580        MOVE ER-8080               TO WS-ERROR
 11581        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11582        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11583        GO TO 3024-EDIT-DL7-CONT.
 11584
 11585     IF DCUA-RETURN-CODE EQUAL 'E3'
 11586        MOVE ER-8098               TO WS-ERROR
 11587        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11588        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11589        GO TO 3024-EDIT-DL7-CONT.
 11590
 11591     IF DCUA-RETURN-CODE EQUAL 'C1'
 11592        MOVE ER-8099               TO WS-ERROR
 11593        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11594        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11595        GO TO 3024-EDIT-DL7-CONT.
 11596
 11597     IF DCUA-RETURN-CODE EQUAL 'U1'
 11598        MOVE ER-8109               TO WS-ERROR
 11599        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601        GO TO 3024-EDIT-DL7-CONT.
 11602
 11603     IF DCUA-RETURN-CODE EQUAL 'N1'
 11604        MOVE ER-8112               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 211
* EL050.cbl
 11605        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11607        GO TO 3024-EDIT-DL7-CONT.
 11608
 11609     IF DCUA-RETURN-CODE EQUAL 'N2'
 11610        MOVE ER-8113               TO WS-ERROR
 11611        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11612        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11613        GO TO 3024-EDIT-DL7-CONT.
 11614
 11615     IF DCUA-RETURN-CODE EQUAL 'N3'
 11616        MOVE ER-8114               TO WS-ERROR
 11617        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11618        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11619        GO TO 3024-EDIT-DL7-CONT.
 11620
 11621     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11622     MOVE ER-8097                  TO WS-ERROR.
 11623     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11624     GO TO 3024-EDIT-DL7-CONT.
 11625
 11626 3024-EDIT-DL7-CONT.
 11627
 11628     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11629     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11630     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11631        NEXT SENTENCE
 11632     ELSE
 11633        MOVE ER-9263               TO WS-ERROR
 11634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11635
 11636******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11637******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11638     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11639        NEXT SENTENCE
 11640     ELSE
 11641        MOVE ER-8039               TO WS-ERROR
 11642        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11643
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 212
* EL050.cbl
 11645****************************************************************
 11646*** VALIDATE STATE  : DLO022                                 ***
 11647****************************************************************
 11648     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11649     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11650
 11651     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11652     IF DVSC-SUCCESSFUL-EDIT
 11653        GO TO 3024-EDIT-DL22-CONT.
 11654
 11655     IF DVSC-RETURN-CODE EQUAL '01'
 11656        MOVE ER-8300               TO WS-ERROR
 11657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658        GO TO 3024-EDIT-DL22-CONT.
 11659
 11660     IF DVSC-RETURN-CODE EQUAL '02'
 11661        MOVE ER-8301               TO WS-ERROR
 11662        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11663        GO TO 3024-EDIT-DL22-CONT.
 11664
 11665     IF DVSC-RETURN-CODE EQUAL '03'
 11666        MOVE ER-8302               TO WS-ERROR
 11667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11668        GO TO 3024-EDIT-DL22-CONT.
 11669
 11670     IF DVSC-RETURN-CODE EQUAL 'N1'
 11671        MOVE ER-8304               TO WS-ERROR
 11672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11673        GO TO 3024-EDIT-DL22-CONT.
 11674
 11675     MOVE ER-8303                  TO WS-ERROR
 11676     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11677
 11678 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 213
* EL050.cbl
 11680****************************************************************
 11681*** VALIDATE LOAN OFFICER : DLO021                           ***
 11682****************************************************************
 11683
 11684     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11685     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11686     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11687     IF DVLO-SUCCESSFUL-EDIT
 11688        GO TO 3024-EDIT-DL21-CONT.
 11689
 11690     IF DVLO-RETURN-CODE EQUAL '01'
 11691        MOVE ER-8081               TO WS-ERROR
 11692        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11693        GO TO 3024-EDIT-DL21-CONT.
 11694
 11695     IF DVLO-RETURN-CODE EQUAL '02'
 11696        MOVE ER-8082               TO WS-ERROR
 11697        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11698        GO TO 3024-EDIT-DL21-CONT.
 11699
 11700     IF DVLO-RETURN-CODE EQUAL '03'
 11701        MOVE ER-8083               TO WS-ERROR
 11702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11703        GO TO 3024-EDIT-DL21-CONT.
 11704
 11705     IF DVLO-RETURN-CODE EQUAL '04'
 11706        MOVE ER-8084               TO WS-ERROR
 11707        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11708        GO TO 3024-EDIT-DL21-CONT.
 11709
 11710     IF DVLO-RETURN-CODE EQUAL '05'
 11711        MOVE ER-8085               TO WS-ERROR
 11712        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11713        GO TO 3024-EDIT-DL21-CONT.
 11714
 11715     MOVE ER-7825                  TO WS-ERROR
 11716     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11717     GO TO 3024-EDIT-DL21-CONT.
 11718
 11719 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 214
* EL050.cbl
 11721
 11722****************************************************************
 11723*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11724****************************************************************
 11725
 11726     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11727     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11728     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11729     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11730     IF DIPF-SUCCESSFUL-EDIT
 11731        GO TO 3024-EDIT-DL02-CONT.
 11732
 11733     IF DIPF-RETURN-CODE EQUAL '01'
 11734        MOVE ER-8086               TO WS-ERROR
 11735        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11736        GO TO 3024-EDIT-DL02-CONT.
 11737
 11738     IF DIPF-RETURN-CODE EQUAL '02'
 11739        MOVE ER-8087               TO WS-ERROR
 11740        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11741        GO TO 3024-EDIT-DL02-CONT.
 11742
 11743     IF DIPF-RETURN-CODE EQUAL '03'
 11744        MOVE ER-8088               TO WS-ERROR
 11745        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11746        GO TO 3024-EDIT-DL02-CONT.
 11747
 11748     MOVE ER-8095                  TO WS-ERROR
 11749     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11750     GO TO 3024-EDIT-DL02-CONT.
 11751
 11752 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 215
* EL050.cbl
 11754
 11755****************************************************************
 11756*** VALIDATE BANK ID : DLO003                                ***
 11757****************************************************************
 11758
 11759     MOVE WK-GREG-CENT           TO WCG-CENT.
 11760     MOVE WK-GREG-YYMM           TO WCG-REST.
 11761     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11762        MOVE ER-8040               TO WS-ERROR
 11763        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11764
 11765     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11766     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11767     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11768     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11769     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11770     IF DVBI-SUCCESSFUL-EDIT
 11771        GO TO 3024-EDIT-DL03-CONT.
 11772
 11773     IF DVBI-RETURN-CODE EQUAL '01'
 11774        MOVE ER-8089               TO WS-ERROR
 11775        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11776        GO TO 3024-EDIT-DL03-CONT.
 11777
 11778     IF DVBI-RETURN-CODE EQUAL '02'
 11779        MOVE ER-8090               TO WS-ERROR
 11780        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11781        GO TO 3024-EDIT-DL03-CONT.
 11782
 11783     IF DVBI-RETURN-CODE EQUAL '03'
 11784        MOVE ER-8091               TO WS-ERROR
 11785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11786        GO TO 3024-EDIT-DL03-CONT.
 11787
 11788     IF DVBI-RETURN-CODE EQUAL '04'
 11789        MOVE ER-8092               TO WS-ERROR
 11790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11791        GO TO 3024-EDIT-DL03-CONT.
 11792
 11793     IF DVBI-RETURN-CODE EQUAL '05'
 11794        MOVE ER-8093               TO WS-ERROR
 11795        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11796        GO TO 3024-EDIT-DL03-CONT.
 11797
 11798     IF DVBI-RETURN-CODE EQUAL '06'
 11799        MOVE ER-8094               TO WS-ERROR
 11800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11801        GO TO 3024-EDIT-DL03-CONT.
 11802
 11803     MOVE ER-8096                  TO WS-ERROR
 11804     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11805     GO TO 3024-EDIT-DL03-CONT.
 11806
 11807 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 216
* EL050.cbl
 11809
 11810     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11811        NEXT SENTENCE
 11812     ELSE
 11813        MOVE ER-8042               TO WS-ERROR
 11814        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11815
 11816     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11817     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11818     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11819
 11820     IF DMPF-RETURN-CODE = '01'
 11821        MOVE ER-8067               TO WS-ERROR
 11822        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11823        GO TO 3024-EDIT-DL01-CONT.
 11824
 11825     IF DMPF-RETURN-CODE = '02'
 11826        MOVE ER-8068               TO WS-ERROR
 11827        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11828        GO TO 3024-EDIT-DL01-CONT.
 11829
 11830     IF DMPF-RETURN-CODE = '03'
 11831        MOVE ER-8069               TO WS-ERROR
 11832        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11833        GO TO 3024-EDIT-DL01-CONT.
 11834
 11835     IF DMPF-RETURN-CODE = 'E1'
 11836        MOVE ER-8070               TO WS-ERROR
 11837        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11838        GO TO 3024-EDIT-DL01-CONT.
 11839
 11840     IF DMPF-RETURN-CODE = 'N1'
 11841        MOVE ER-8071               TO WS-ERROR
 11842        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11843        GO TO 3024-EDIT-DL01-CONT.
 11844
 11845     IF DMPF-RETURN-CODE NOT = 'OK'
 11846        MOVE ER-8072               TO WS-ERROR
 11847        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11848
 11849 3024-EDIT-DL01-CONT.
 11850******************************************************************
 11851***  VALIDATES RATE CODES : DLO017                             ***
 11852******************************************************************
 11853
 11854      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11855      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11856      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11857      IF DVRC-SUCCESSFUL-EDIT
 11858        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11859        GO TO 3024-CHECK-VALID-RATE.
 11860
 11861      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11862
 11863      IF DVRC-RETURN-CODE EQUAL '01'
 11864         MOVE ER-7817                   TO WS-ERROR
 11865         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11866         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 217
* EL050.cbl
 11867
 11868      IF DVRC-RETURN-CODE EQUAL '02'
 11869         MOVE ER-7818                   TO WS-ERROR
 11870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11871         GO TO 3025-EDIT-REINSURANCE.
 11872
 11873      IF DVRC-RETURN-CODE EQUAL '03'
 11874         MOVE ER-7819                   TO WS-ERROR
 11875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11876         GO TO 3025-EDIT-REINSURANCE.
 11877
 11878       MOVE ER-7820                     TO WS-ERROR.
 11879       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11880       GO TO 3025-EDIT-REINSURANCE.
 11881
 11882******************************************************************
 11883***  GET PREMIUM RATES : DLO011                                ***
 11884******************************************************************
 11885
 11886 3024-CHECK-VALID-RATE.
 11887
 11888     IF VALID-RATE-CODE
 11889        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11890        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11891        MOVE SPACES                TO DPRB-RETURN-CODE
 11892        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11893     ELSE
 11894         GO TO 3025-EDIT-REINSURANCE.
 11895
 11896      IF DPRB-SUCCESSFUL-PROCESS
 11897         IF PB-VALID-LIFE
 11898             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11899             GO TO 3025-EDIT-REINSURANCE
 11900         ELSE
 11901             IF PB-VALID-AH
 11902                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11903                 GO TO 3025-EDIT-REINSURANCE.
 11904
 11905      IF DPRB-RETURN-CODE EQUAL '01'
 11906         MOVE ER-7812                   TO WS-ERROR
 11907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11908         GO TO 3025-EDIT-REINSURANCE.
 11909
 11910      IF DPRB-RETURN-CODE EQUAL '02'
 11911         MOVE ER-7813                   TO WS-ERROR
 11912         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11913         GO TO 3025-EDIT-REINSURANCE.
 11914
 11915      IF DPRB-RETURN-CODE EQUAL '03'
 11916         MOVE ER-7814                   TO WS-ERROR
 11917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11918         GO TO 3025-EDIT-REINSURANCE.
 11919
 11920      IF DPRB-RETURN-CODE EQUAL '04'
 11921         IF NOT DPRB-1ST-TIME
 11922            MOVE ER-7815                   TO WS-ERROR
 11923            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11924            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 218
* EL050.cbl
 11925          ELSE
 11926         IF PB-VALID-LIFE
 11927            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11928          ELSE
 11929            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11930         END-IF
 11931         MOVE SPACES                TO DOCC-RETURN-CODE
 11932         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11933         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11934         IF DOCC-RETURN-CODE = 'OK'
 11935             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11936             GO TO 3024-CHECK-VALID-RATE
 11937           ELSE
 11938             MOVE ER-7823               TO WS-ERROR
 11939             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11940             GO TO 3025-EDIT-REINSURANCE.
 11941
 11942       MOVE ER-7816                     TO WS-ERROR.
 11943       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11944       GO TO 3025-EDIT-REINSURANCE.
 11945
 11946**********   DMD CUSTOM CODE ABOVE    **********
 11947
 11948 3025-EDIT-REINSURANCE.
 11949     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11950         GO TO 3027-EDIT-CONTINUE.
 11951
 11952     MOVE LOW-VALUES               TO ERREIN-KEY.
 11953     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11954     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11955                                      REIN-CODE-2
 11956                                      REIN-CODE-3.
 11957     MOVE 'A'                      TO REIN-TYPE.
 11958
 11959     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11960
 11961     MOVE '3026' TO REIN-SW.
 11962     MOVE ' '                   TO WS-REIN-READ-SW.
 11963
 11964     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11965     IF REIN-TABLE-NOT-FOUND
 11966         GO TO 3026-NO-SPEC-TABLE.
 11967
 11968     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11969     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11970                                   WS-NSP-ST-CD-LF.
 11971     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11972                                   WS-NSP-ST-CD-AH.
 11973
 11974     GO TO 3040-EDIT-CONTINUE.
 11975
 11976 3026-NO-SPEC-TABLE.
 11977
 11978     MOVE ER-2664                TO WS-ERROR.
 11979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11980     GO TO 3040-EDIT-CONTINUE.
 11981
 11982 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 219
* EL050.cbl
 11983
 11984     IF PB-I-REIN-TABLE = SPACES
 11985       GO TO 3040-EDIT-CONTINUE.
 11986
 11987     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11988          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11989          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11990           GO TO 3040-EDIT-CONTINUE.
 11991
 11992     MOVE LOW-VALUES            TO ERREIN-KEY.
 11993     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11994     MOVE 'A'                   TO REIN-TYPE.
 11995     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11996
 11997     MOVE '3028'                TO REIN-SW.
 11998     MOVE ' '                   TO WS-REIN-READ-SW.
 11999
 12000     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12001     IF REIN-TABLE-NOT-FOUND
 12002         GO TO 3028-NO-REIN-TABLE.
 12003
 12004     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12005     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12006                                   WS-NSP-ST-CD-LF.
 12007     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12008                                   WS-NSP-ST-CD-AH.
 12009
 12010     GO TO 3040-EDIT-CONTINUE.
 12011
 12012 3028-NO-REIN-TABLE.
 12013
 12014     MOVE ER-2615                TO WS-ERROR.
 12015     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12016     GO TO 3040-EDIT-CONTINUE.
 12017
 12018 3040-EDIT-CONTINUE.
 12019
 12020     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12021         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12022
 12023     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12024         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12025
 12026     IF (NOT PB-REISSUED-CERT)
 12027        AND (NOT PB-MONTHLY-CERT)
 12028        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12029            MOVE '001'           TO PB-I-LF-TERM
 12030            MOVE 'M'             TO PB-I-INSURED-SEX.
 12031
 12032     IF (NOT PB-REISSUED-CERT)
 12033        AND (NOT PB-MONTHLY-CERT)
 12034        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12035            MOVE '001'           TO PB-I-AH-TERM
 12036            MOVE 'M'             TO PB-I-INSURED-SEX.
 12037
 12038 3040-EDIT-1ST-PMT-DT.
 12039     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12040     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 220
* EL050.cbl
 12041         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12042
 12043******************************************************************
 12044*                                                                *
 12045*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12046*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12047*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12048*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12049*                                                                *
 12050******************************************************************
 12051
 12052     IF PB-EFF-DT-PROCESSING
 12053        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12054                                    PB-I-LF-EXPIRE-DT
 12055                                    PB-I-AH-EXPIRE-DT
 12056        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12057        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12058        MOVE ZERO                TO DC-ELAPSED-DAYS
 12059        MOVE +1                  TO DC-ELAPSED-MONTHS
 12060        SET BIN-PLUS-ELAPSED     TO TRUE
 12061*       MOVE 6                   TO DC-OPTION-CODE
 12062        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12063        IF NO-CONVERSION-ERROR
 12064           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12065
 12066******************************************************************
 12067*                                                                *
 12068*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12069*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12070*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12071*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12072*                                                                *
 12073******************************************************************
 12074
 12075     IF PB-EXT-DAYS-PROCESSING
 12076          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12077                                         PB-I-LF-EXPIRE-DT
 12078                                         PB-I-AH-EXPIRE-DT
 12079          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12080          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12081          MOVE +1                     TO DC-ELAPSED-MONTHS
 12082          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12083          SET BIN-PLUS-ELAPSED        TO TRUE
 12084*         MOVE 6                      TO DC-OPTION-CODE
 12085          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12086          IF NO-CONVERSION-ERROR
 12087             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12088
 12089******************************************************************
 12090*                                                                *
 12091*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12092*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12093*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12094*        (EXPIRE DATE - (TERM -1))  *  -1.
 12095*                                                                *
 12096******************************************************************
 12097
 12098     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 221
* EL050.cbl
 12099        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12100           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12101              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12102              MOVE PB-I-AH-TERM      TO WS-TERM
 12103           ELSE
 12104              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12105              MOVE PB-I-LF-TERM      TO WS-TERM
 12106        ELSE
 12107           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12108              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12109              MOVE PB-I-LF-TERM      TO WS-TERM
 12110           ELSE
 12111              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12112              MOVE PB-I-AH-TERM      TO WS-TERM.
 12113
 12114     IF PB-EXPIRE-DT-PROCESSING
 12115        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12116        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12117        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12118        MOVE ZERO                TO DC-ELAPSED-DAYS
 12119                                    DC-ODD-DAYS-OVER
 12120          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12121          SET BIN-PLUS-ELAPSED    TO TRUE
 12122*         MOVE 6                  TO DC-OPTION-CODE
 12123          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12124          IF NO-CONVERSION-ERROR
 12125             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12126
 12127******************************************************************
 12128*                                                                *
 12129*            1ST PAYMENT DATE PROCESSING                         *
 12130*                                                                *
 12131******************************************************************
 12132
 12133     IF PB-1ST-PMT-DT-PROCESSING
 12134        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12135                                    PB-I-AH-EXPIRE-DT
 12136        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12137
 12138     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12139         NEXT SENTENCE
 12140     ELSE
 12141         MOVE ER-2680                 TO WS-ERROR
 12142         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12143         GO TO 3060-ORIG-TERM-CHECK.
 12144
 12145     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12146     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12147     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12148*    MOVE 1                      TO DC-OPTION-CODE.
 12149     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12150                                    DC-ELAPSED-DAYS
 12151                                    DC-ODD-DAYS-OVER.
 12152
 12153     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12154
 12155     IF DATE-CONVERSION-ERROR
 12156        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 222
* EL050.cbl
 12157
 12158     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12159     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12160        AND (WS-LF-COVERAGE-TYPE = 'L')
 12161        IF (DC-ELAPSED-MONTHS > 1)
 12162                      OR
 12163           ((DC-ELAPSED-MONTHS = 1)
 12164           AND (DC-ODD-DAYS-OVER > 0))
 12165           MOVE ER-2882          TO WS-ERROR
 12166           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12167        END-IF
 12168     END-IF
 12169     if dc-elapsed-months > 0
 12170        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12171        + dc-odd-days-over
 12172     end-if
 12173     IF PB-EXT-DAYS-PROCESSING
 12174        CONTINUE
 12175     ELSE
 12176        IF DC-ELAPSED-MONTHS = +0
 12177           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12178        ELSE
 12179           IF (WS-LF-EARNINGS-CALC = '4')
 12180              AND (DC-ELAPSED-MONTHS > ZERO)
 12181              AND (DC-ELAPSED-DAYS > ZERO)
 12182              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12183           ELSE
 12184              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12185                                 THRU 6499-EXIT
 12186              MOVE WS-ODD-DAYS-OVER
 12187                                 TO PB-I-EXTENTION-DAYS
 12188           END-IF
 12189        END-IF
 12190     END-IF
 12191******************************************************************
 12192*                                                                *
 12193*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12194*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12195*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12196*            AND ANY ODD DAYS.                                   *
 12197*                                                                *
 12198******************************************************************
 12199
 12200     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12201                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12202     IF WS-LF-EARNINGS-CALC NOT = '4'
 12203        IF DC-ELAPSED-DAYS > ZEROS
 12204           MOVE ER-2681          TO WS-ERROR
 12205           PERFORM 9900-ERROR-FORMAT
 12206                                 THRU 9900-EXIT
 12207        END-IF
 12208     END-IF
 12209
 12210     IF WS-LF-EARNINGS-CALC NOT = '4'
 12211        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12212           MOVE ER-2681          TO WS-ERROR
 12213           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12214
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 223
* EL050.cbl
 12215     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12216        (PB-I-LF-TERM NOT = ZERO) AND
 12217         NOT NO-LIFE-COVERAGE
 12218          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12219          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12220          IF WS-LF-EARNINGS-CALC = '4'
 12221             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12222             PB-I-PAY-FREQUENCY
 12223          END-IF
 12224          MOVE ZERO              TO DC-ELAPSED-DAYS
 12225                                    DC-ODD-DAYS-OVER
 12226          MOVE 1                 TO DC-END-OF-MONTH
 12227          SET BIN-PLUS-ELAPSED        TO TRUE
 12228*         MOVE 6                 TO DC-OPTION-CODE
 12229          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12230          IF NO-CONVERSION-ERROR
 12231             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12232             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12233                (WS-LF-SPECIAL-CALC-CD = 'L')
 12234                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12235                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12236                  MOVE +1             TO DC-ELAPSED-MONTHS
 12237                  SET BIN-PLUS-ELAPSED  TO TRUE
 12238*                 MOVE 6              TO DC-OPTION-CODE
 12239                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12240                  IF NO-CONVERSION-ERROR
 12241                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12242
 12243* okay, i had to move the new att age edit down here because the
 12244* expiration date could get recalculated and i need the exp date
 12245     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12246        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12247        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12248        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12249           AND ZEROS
 12250           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12251           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12252           SET ELAPSED-BETWEEN-BIN TO TRUE
 12253           PERFORM 8500-DATE-CONVERT
 12254                                 THRU 8500-EXIT
 12255           IF NO-CONVERSION-ERROR
 12256              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12257                 MOVE ER-2669       TO WS-ERROR
 12258*                PERFORM 9900-ERROR-FORMAT
 12259*                                THRU 9900-EXIT
 12260              END-IF
 12261           END-IF
 12262        ELSE
 12263           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12264           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12265              MOVE ER-2669       TO WS-ERROR
 12266*             PERFORM 9900-ERROR-FORMAT
 12267*                                THRU 9900-EXIT
 12268           ELSE
 12269              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12270                 MOVE ER-1570    TO WS-ERROR
 12271                 PERFORM 9900-ERROR-FORMAT
 12272                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 224
* EL050.cbl
 12273              END-IF
 12274           END-IF
 12275        END-IF
 12276        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12277           AND ZEROS
 12278           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12279           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12280           SET ELAPSED-BETWEEN-BIN TO TRUE
 12281           PERFORM 8500-DATE-CONVERT
 12282                                 THRU 8500-EXIT
 12283           IF NO-CONVERSION-ERROR
 12284              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12285                 MOVE ER-2669       TO WS-ERROR
 12286*                PERFORM 9900-ERROR-FORMAT
 12287*                                THRU 9900-EXIT
 12288              END-IF
 12289           END-IF
 12290        ELSE
 12291           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12292             (PB-I-LF-TERM / 12)
 12293           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12294              MOVE ER-2669       TO WS-ERROR
 12295*             PERFORM 9900-ERROR-FORMAT
 12296*                                THRU 9900-EXIT
 12297           ELSE
 12298              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12299                 MOVE ER-1571    TO WS-ERROR
 12300                 PERFORM 9900-ERROR-FORMAT
 12301                                 THRU 9900-EXIT
 12302              END-IF
 12303           END-IF
 12304        END-IF
 12305        IF WS-ERROR = ER-2669
 12306           PERFORM 9900-ERROR-FORMAT
 12307                                 THRU 9900-EXIT
 12308        END-IF
 12309     END-IF
 12310     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12311        (PB-I-AH-TERM NOT = ZERO) AND
 12312         NOT NO-AH-COVERAGE
 12313          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12314             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12315             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12316             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12317          ELSE
 12318             IF WS-LF-EARNINGS-CALC = '4'
 12319                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12320                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12321                PB-I-PAY-FREQUENCY
 12322             ELSE
 12323                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12324                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12325             END-IF
 12326          END-IF
 12327          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12328                                         DC-ODD-DAYS-OVER
 12329          MOVE 1                      TO DC-END-OF-MONTH
 12330          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 225
* EL050.cbl
 12331*         MOVE 6                      TO DC-OPTION-CODE
 12332          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12333          IF NO-CONVERSION-ERROR
 12334             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12335     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12336        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12337        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12338        IF PB-I-BIRTHDAY > LOW-VALUES
 12339           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12340           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12341           SET ELAPSED-BETWEEN-BIN TO TRUE
 12342           PERFORM 8500-DATE-CONVERT
 12343                                 THRU 8500-EXIT
 12344           IF NO-CONVERSION-ERROR
 12345              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12346                 MOVE ER-3054       TO WS-ERROR
 12347*                PERFORM 9900-ERROR-FORMAT
 12348*                                THRU 9900-EXIT
 12349              END-IF
 12350           END-IF
 12351        ELSE
 12352           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12353           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12354              MOVE ER-3054       TO WS-ERROR
 12355*             PERFORM 9900-ERROR-FORMAT
 12356*                                THRU 9900-EXIT
 12357           END-IF
 12358        END-IF
 12359        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12360           AND ZEROS
 12361           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12362           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12363           SET ELAPSED-BETWEEN-BIN TO TRUE
 12364           PERFORM 8500-DATE-CONVERT
 12365                                 THRU 8500-EXIT
 12366           IF NO-CONVERSION-ERROR
 12367              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12368                 MOVE ER-3054       TO WS-ERROR
 12369*                PERFORM 9900-ERROR-FORMAT
 12370*                                THRU 9900-EXIT
 12371              END-IF
 12372           END-IF
 12373        ELSE
 12374           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12375             (PB-I-AH-TERM / 12)
 12376           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12377              MOVE ER-3054       TO WS-ERROR
 12378*             PERFORM 9900-ERROR-FORMAT
 12379*                                THRU 9900-EXIT
 12380           END-IF
 12381        END-IF
 12382        IF WS-ERROR = ER-3054
 12383           PERFORM 9900-ERROR-FORMAT
 12384                                 THRU 9900-EXIT
 12385        END-IF
 12386     END-IF
 12387     MOVE SPACE                       TO DC-END-OF-MONTH.
 12388
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 226
* EL050.cbl
 12389     IF PB-COMPANY-ID = 'NCB'
 12390        GO TO 3040-EDIT-EXTENSION-DAYS.
 12391
 12392     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12393       AND
 12394        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12395        NEXT SENTENCE
 12396     ELSE
 12397        GO TO 3040-EDIT-EXTENSION-DAYS.
 12398
 12399     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12400        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12401        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12402     ELSE
 12403        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12404        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12405
 12406     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12407*    MOVE '1'      TO DC-OPTION-CODE
 12408     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12409     IF (NO-CONVERSION-ERROR)
 12410        AND (DC-ELAPSED-MONTHS > +1)
 12411        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12412        MOVE ER-2668   TO WS-ERROR
 12413        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12414
 12415 3040-EDIT-EXTENSION-DAYS.
 12416
 12417     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12418        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12419         GO TO 3050-EDIT-TERM-IN-DAYS
 12420     ELSE
 12421         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12422
 12423     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12424         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12425     ELSE
 12426        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12427           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12428           MOVE ER-2681         TO WS-ERROR
 12429           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12430
 12431     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12432        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12433        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12434         GO TO 3060-ORIG-TERM-CHECK.
 12435
 12436     GO TO 3060-ORIG-TERM-CHECK.
 12437
 12438 3050-EDIT-TERM-IN-DAYS.
 12439
 12440     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12441
 12442     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12443         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12444     ELSE
 12445         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12446            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 227
* EL050.cbl
 12447            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12448
 12449     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12450                                       REMAINDER WS-WORK-TERM.
 12451     IF WS-WORK-TERM GREATER THAN ZERO
 12452         ADD +1 TO PB-I-LF-TERM.
 12453
 12454     IF NOT NO-AH-COVERAGE
 12455         MOVE ER-2684            TO WS-ERROR
 12456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12457
 12458
 12459 3060-ORIG-TERM-CHECK.
 12460
 12461******************************************************************
 12462*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12463******************************************************************
 12464
 12465     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12466        NEXT SENTENCE
 12467     ELSE
 12468        IF NOT NO-LIFE-COVERAGE
 12469           IF PB-I-LF-TERM NUMERIC
 12470              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12471              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12472              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12473                  NEXT SENTENCE
 12474           ELSE
 12475              MOVE ER-2647       TO WS-ERROR
 12476              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12477
 12478     IF NOT NO-AH-COVERAGE
 12479         IF PB-I-AH-TERM NUMERIC
 12480            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12481            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12482            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12483             NEXT SENTENCE
 12484          ELSE
 12485              MOVE ER-2658       TO WS-ERROR
 12486              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12487
 12488     IF PB-COMPANY-ID = 'NCB'
 12489        GO TO 3070-LOAN-TERM-CHECK.
 12490
 12491     IF POLICY-HAS-AH
 12492       AND
 12493        POLICY-HAS-LIFE
 12494       AND
 12495        PB-I-LF-TERM NUMERIC
 12496       AND
 12497        PB-I-AH-TERM NUMERIC
 12498        NEXT SENTENCE
 12499     ELSE
 12500        GO TO 3070-LOAN-TERM-CHECK.
 12501
 12502     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12503     IF WS-TEX-FACT-2 LESS THAN +0
 12504        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 228
* EL050.cbl
 12505
 12506     IF WS-TEX-FACT-2 GREATER THAN +1
 12507        MOVE ER-2668             TO WS-ERROR
 12508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12509
 12510 3070-LOAN-TERM-CHECK.
 12511
 12512     IF (WS-LF-BENEFIT-CD = ZERO)
 12513         OR (NO-LF-BENEFIT-MATCH)
 12514            GO TO 3125-EDIT-PMT-FREQ.
 12515*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12516*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12517*          AND 'V' AND 'W' AND 'X'
 12518*          GO TO 3125-EDIT-PMT-FREQ
 12519*       END-IF
 12520*    ELSE
 12521*       IF WS-AH-DCC-TRUNC = 'T'
 12522*          CONTINUE
 12523*       ELSE
 12524*          GO TO 3125-EDIT-PMT-FREQ
 12525*       END-IF
 12526*    END-IF
 12527     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12528                    OR
 12529        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12530        AND (WS-AH-DCC-TRUNC = 'T'))
 12531        CONTINUE
 12532     ELSE
 12533        GO TO 3125-EDIT-PMT-FREQ
 12534     END-IF
 12535     IF PB-I-LOAN-TERM NOT NUMERIC
 12536         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12537
 12538     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12539        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12540*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12541        PB-I-LOAN-TERM NOT GREATER THAN +360
 12542         NEXT SENTENCE
 12543     ELSE
 12544         MOVE ER-2648            TO WS-ERROR
 12545         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12546
 12547     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12548        MOVE ER-3058             TO WS-ERROR
 12549        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12550     end-if
 12551
 12552     IF WS-STATE-ABBREVIATION = 'NC'
 12553        IF PB-I-LOAN-TERM > +59
 12554           CONTINUE
 12555        ELSE
 12556           MOVE ER-2792          TO WS-ERROR
 12557           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12558        END-IF
 12559     END-IF
 12560
 12561     .
 12562 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 229
* EL050.cbl
 12563     IF (WS-LF-BENEFIT-CD = ZERO)
 12564         OR (NO-LF-BENEFIT-MATCH)
 12565            GO TO 3127-EDIT-LOAN-OFFICER.
 12566     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12567                    OR
 12568        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12569        AND (WS-AH-DCC-TRUNC = 'T'))
 12570                    OR
 12571         (PB-COMPANY-ID = 'AHL')
 12572        CONTINUE
 12573     ELSE
 12574        IF (PB-I-LOAN-TERM > ZEROS)
 12575           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12576           MOVE ER-1575          TO WS-ERROR
 12577           PERFORM 9900-ERROR-FORMAT
 12578                                 THRU 9900-EXIT
 12579        END-IF
 12580     END-IF
 12581     IF WS-LF-EARNINGS-CALC NOT = '4'
 12582         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12583            MOVE ER-2653         TO WS-ERROR
 12584            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12585            GO TO 3127-EDIT-LOAN-OFFICER
 12586         ELSE
 12587            GO TO 3127-EDIT-LOAN-OFFICER.
 12588
 12589     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12590         MOVE ER-2655            TO WS-ERROR
 12591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12592         GO TO 3127-EDIT-LOAN-OFFICER.
 12593
 12594     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12595         MOVE ER-2654            TO WS-ERROR
 12596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12597         GO TO 3127-EDIT-LOAN-OFFICER.
 12598
 12599     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12600         GIVING WS-TEX-FACT-2
 12601             REMAINDER WS-TEX-FACT-3.
 12602
 12603*    IF WS-TEX-FACT-3 NOT = ZERO
 12604*       MOVE ER-2654             TO WS-ERROR
 12605*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12606
 12607
 12608 3127-EDIT-LOAN-OFFICER.
 12609
 12610     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12611        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12612           MOVE ER-2690          TO WS-ERROR
 12613           PERFORM 9900-ERROR-FORMAT
 12614                                 THRU 9900-EXIT
 12615        ELSE
 12616           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12617           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12618           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12619           MOVE PB-SV-STATE      TO LOFC-STATE
 12620           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 230
* EL050.cbl
 12621           MOVE PB-I-LOAN-OFFICER
 12622                                 TO LOFC-CODE
 12623           PERFORM 8586-READ-LOAN-OFFICER
 12624                                 THRU 8586-EXIT
 12625           IF (NOT LOFC-MASTER-FOUND)
 12626              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12627              MOVE ER-3006       TO WS-ERROR
 12628              PERFORM 9900-ERROR-FORMAT
 12629                                 THRU 9900-EXIT
 12630           END-IF
 12631        END-IF
 12632     END-IF
 12633     .
 12634 3129-EDIT-APR.
 12635
 12636     IF (WS-LF-BENEFIT-CD = ZERO)
 12637        OR (NO-LF-BENEFIT-MATCH)
 12638        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12639           GO TO 3130-EDIT-AGE
 12640*       ELSE
 12641*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12642*             GO TO 3130-EDIT-AGE
 12643*          END-IF
 12644        END-IF
 12645     END-IF
 12646
 12647     IF (WS-STATE-ABBREVIATION = 'OH')
 12648         AND (PB-I-RATE-CLASS NOT = 'L ')
 12649         AND (PB-I-LF-TERM GREATER THAN 60)
 12650         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12651         GO TO 3129-APR-CONT.
 12652
 12653     IF (WS-STATE-ABBREVIATION = 'RI')
 12654         AND (PB-I-LF-TERM GREATER THAN 60)
 12655         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12656         GO TO 3129-APR-CONT.
 12657
 12658     IF (WS-STATE-ABBREVIATION = 'UT')
 12659         AND (PB-I-LF-TERM GREATER THAN 62)
 12660         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12661         AND (PB-CERT-EFF-DT LESS WS-830901)
 12662         GO TO 3129-APR-CONT.
 12663
 12664     IF PB-COMPANY-ID = 'LAP'
 12665        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12666           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12667              MOVE ER-2656         TO WS-ERROR
 12668              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12669              GO TO 3130-EDIT-AGE.
 12670
 12671     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12672        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12673        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12674        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12675        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12676        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12677         GO TO 3130-EDIT-AGE.
 12678
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 231
* EL050.cbl
 12679 3129-APR-CONT.
 12680     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12681         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12682         GO TO 3130-EDIT-AGE.
 12683
 12684     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12685         WS-AH-BENEFIT-CD (1:1) = 'S')
 12686        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12687        AND (PB-I-LOAN-APR = ZERO)
 12688        MOVE ER-2657             TO WS-ERROR
 12689        PERFORM 9900-ERROR-FORMAT
 12690                                 THRU 9900-EXIT
 12691        GO TO 3130-EDIT-AGE
 12692     END-IF
 12693*    IF PB-I-LOAN-APR = ZERO
 12694*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12695*    END-IF
 12696
 12697     if pb-i-loan-apr = +99.9999
 12698        move er-2656             to ws-error
 12699        PERFORM 9900-ERROR-FORMAT
 12700                                 THRU 9900-EXIT
 12701        GO TO 3130-EDIT-AGE
 12702     end-if
 12703*    IF PB-I-LOAN-APR = ZERO
 12704*       MOVE ER-2656             TO WS-ERROR
 12705*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12706*       GO TO 3130-EDIT-AGE.
 12707
 12708*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12709     if pb-i-loan-apr not = +99.9999
 12710        IF PB-I-LOAN-APR > +30.000
 12711           MOVE ER-2657          TO WS-ERROR
 12712           PERFORM 9900-ERROR-FORMAT
 12713                                 THRU 9900-EXIT
 12714        end-if
 12715     end-if
 12716     .
 12717 3130-EDIT-AGE.
 12718
 12719******************************************************************
 12720*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12721******************************************************************
 12722
 12723     IF NOT NO-LIFE-COVERAGE
 12724        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12725           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12726               MOVE ER-2628             TO WS-ERROR
 12727               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12728
 12729     IF NOT NO-AH-COVERAGE
 12730        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12731           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12732               MOVE ER-2628         TO WS-ERROR
 12733               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12734
 12735 3133-SEX-CODE.
 12736     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 232
* EL050.cbl
 12737         IF WS-DEFAULT-SEX = 'M'
 12738             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12739          ELSE
 12740             IF WS-DEFAULT-SEX = 'F'
 12741             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12742
 12743     IF PB-I-INSURED-SEX = '1'
 12744         MOVE 'M' TO PB-I-INSURED-SEX.
 12745
 12746     IF PB-I-INSURED-SEX = '2'
 12747         MOVE 'F' TO PB-I-INSURED-SEX.
 12748
 12749 3134-SIG-SW-EDIT.
 12750     IF PB-I-SIG-SW = SPACE
 12751         MOVE 'N'                TO  PB-I-SIG-SW.
 12752
 12753     IF PB-COMPANY-ID = 'NCL'
 12754         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12755             NEXT SENTENCE
 12756         ELSE
 12757             MOVE ER-1923        TO  WS-ERROR
 12758             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12759     ELSE
 12760     IF PB-COMPANY-ID = 'CRI'
 12761         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12762             NEXT SENTENCE
 12763         ELSE
 12764             MOVE ER-2606        TO  WS-ERROR
 12765             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12766     ELSE
 12767     IF PB-COMPANY-ID = 'TMS'
 12768         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12769             NEXT SENTENCE
 12770         ELSE
 12771             MOVE ER-2689        TO  WS-ERROR
 12772             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12773     ELSE
 12774         IF PB-I-SIG-SW = 'Y' OR 'N'
 12775             NEXT SENTENCE
 12776         ELSE
 12777             MOVE ER-2651        TO  WS-ERROR
 12778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12779
 12780     IF PB-COMPANY-ID = 'FLA'
 12781         IF (WS-EDIT-AGE GREATER 54  OR
 12782             WS-AH-EDIT-AGE GREATER 54)  AND
 12783            PB-I-SIG-SW = 'N'
 12784            MOVE ER-2651         TO  WS-ERROR
 12785            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12786
 12787 3135-NAME-EDIT.
 12788
 12789     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12790        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12791        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12792           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12793                                 TO PB-I-JOINT-FIRST-NAME
 12794        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 233
* EL050.cbl
 12795     END-IF
 12796     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12797        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12798        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12799           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12800                                 TO PB-I-JOINT-LAST-NAME
 12801        END-PERFORM
 12802     END-IF
 12803     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12804        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12805        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12806           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12807                                 TO PB-I-INSURED-FIRST-NAME
 12808        END-PERFORM
 12809     END-IF
 12810     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12811        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12812        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12813           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12814                                 TO PB-I-INSURED-LAST-NAME
 12815        END-PERFORM
 12816     END-IF
 12817     IF PB-I-INSURED-LAST-NAME = SPACES
 12818       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12819       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12820           MOVE ER-2660    TO WS-ERROR
 12821           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12822
 12823 3136-EDIT-SEX.
 12824
 12825******************************************************************
 12826*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12827******************************************************************
 12828
 12829     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12830        (WS-AH-SPECIAL-CALC-CD = 'O')
 12831        NEXT SENTENCE
 12832     ELSE
 12833        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12834           NEXT SENTENCE
 12835        ELSE
 12836           MOVE ER-2629            TO WS-ERROR
 12837           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12838
 12839 3137-EDIT-EFF-DATE.
 12840
 12841     IF PB-REISSUED-CERT       OR
 12842        PB-POLICY-IS-DECLINED  OR
 12843        PB-POLICY-IS-VOIDED
 12844         GO TO 3139-EDIT-COVERAGE-CODES.
 12845
 12846     MOVE SPACE                  TO WS-2671-SW
 12847                                    WS-2672-SW.
 12848
 12849     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12850         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12851             MOVE ER-2703        TO WS-ERROR
 12852             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 234
* EL050.cbl
 12853             GO TO 3139-EDIT-COVERAGE-CODES.
 12854
 12855     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12856         GO TO 3139-EDIT-COVERAGE-CODES.
 12857
 12858     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12859     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12860*    MOVE '1'                    TO DC-OPTION-CODE.
 12861     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12862     MOVE +0                     TO DC-ELAPSED-MONTHS
 12863                                    DC-ELAPSED-DAYS.
 12864     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12865
 12866     IF DATE-CONVERSION-ERROR
 12867         GO TO 3139-EDIT-COVERAGE-CODES.
 12868
 12869     IF DC-ELAPSED-DAYS GREATER +180
 12870         MOVE ER-2672            TO WS-ERROR
 12871         MOVE 'Y'                TO WS-2672-SW
 12872         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12873     END-IF
 12874
 12875     IF WS-ERROR = ER-2671  AND
 12876        PB-COMPANY-ID  = 'LBL'
 12877        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12878        MOVE SPACE               TO WS-2671-SW
 12879        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12880
 12881     IF PB-ISSUE-DATE-FORCED  AND
 12882      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12883         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12884         MOVE ER-2673            TO WS-ERROR
 12885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12886         MOVE SPACE              TO WS-2671-SW
 12887                                    WS-2672-SW.
 12888
 12889     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12890         IF PB-ISSUE-DATE-FORCED
 12891             MOVE ER-2600          TO  WS-ERROR
 12892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12893         ELSE
 12894             MOVE ER-2692          TO  WS-ERROR
 12895             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12896
 12897
 12898 3139-EDIT-COVERAGE-CODES.
 12899
 12900     if pb-company-id not = 'AHL'
 12901        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12902           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12903           MOVE ER-2787          TO WS-ERROR
 12904           PERFORM 9900-ERROR-FORMAT
 12905                                 THRU 9900-EXIT
 12906        END-IF
 12907     end-if
 12908     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12909        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12910                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 235
* EL050.cbl
 12911           MOVE ER-2719          TO WS-ERROR
 12912           PERFORM 9900-ERROR-FORMAT
 12913                                 THRU 9900-EXIT
 12914        END-IF
 12915     END-IF
 12916
 12917     IF PB-POLICY-IS-DECLINED  OR
 12918        PB-POLICY-IS-VOIDED
 12919         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12920
 12921     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12922        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12923         MOVE ER-2630                TO WS-ERROR
 12924         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12925
 12926     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12927        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12928        PB-I-LF-PREMIUM-AMT = ZERO
 12929         GO TO 3140-CHECK-AH-FOR-ZERO.
 12930
 12931     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12932        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12933        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12934         GO TO 3140-CHECK-AH-FOR-ZERO.
 12935
 12936     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12937        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12938        MOVE ER-2631             TO WS-ERROR
 12939        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12940     END-IF
 12941
 12942
 12943******************************************************************
 12944*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12945******************************************************************
 12946
 12947     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12948        NEXT SENTENCE
 12949     ELSE
 12950        IF PB-I-LF-BENEFIT-AMT = ZERO
 12951           MOVE ER-2632             TO WS-ERROR
 12952           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12953
 12954
 12955******************************************************************
 12956*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12957******************************************************************
 12958
 12959     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12960        CONTINUE
 12961     ELSE
 12962        IF PB-I-LF-PREMIUM-AMT = ZERO
 12963           IF (NOT PB-COMP-LF-PREM)
 12964              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12965              and (ws-lf-ben-category not = 'C')
 12966              MOVE ER-2633       TO WS-ERROR
 12967              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12968           END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 236
* EL050.cbl
 12969        END-IF
 12970     END-IF
 12971     .
 12972 3140-CHECK-AH-FOR-ZERO.
 12973
 12974     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12975        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12976        PB-I-AH-PREMIUM-AMT = ZERO
 12977         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12978
 12979     IF PB-COMPANY-ID = 'CSL'  AND
 12980        PB-I-AH-BENEFIT-CD = ZERO  AND
 12981        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12982        PB-I-AH-PREMIUM-AMT = ZERO
 12983         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12984
 12985     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12986        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12987        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12988         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12989
 12990     IF PB-I-AH-BENEFIT-CD = ZERO
 12991         MOVE ER-2634            TO WS-ERROR
 12992         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12993
 12994******************************************************************
 12995*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12996******************************************************************
 12997
 12998     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12999        NEXT SENTENCE
 13000     ELSE
 13001        IF PB-I-AH-BENEFIT-AMT = ZERO
 13002           MOVE ER-2635             TO WS-ERROR
 13003           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13004
 13005******************************************************************
 13006*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13007******************************************************************
 13008
 13009     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13010        NEXT SENTENCE
 13011     ELSE
 13012        IF PB-I-AH-PREMIUM-AMT = ZERO
 13013            IF NOT PB-COMP-AH-PREM
 13014                MOVE ER-2636    TO WS-ERROR
 13015                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13016
 13017
 13018 3140-EDIT-MAX-AMT-SIZES.
 13019* CUSTOM CODE FOR CLIENT    'DMD'
 13020     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13021                                     WS-RES-MUNI-TAX
 13022                                     PB-I-STATE-TAX
 13023                                     PB-I-MUNI-TAX.
 13024
 13025     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13026
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 237
* EL050.cbl
 13027     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13028        GO TO 3150-RATE-OUTSTAND-BAL.
 13029
 13030     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13031        GO TO 3150-RATE-OUTSTAND-BAL.
 13032
 13033     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13034        GO TO 3150-RATE-OUTSTAND-BAL.
 13035
 13036     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13037                             OR 'RIC')
 13038        GO TO 3150-RATE-OUTSTAND-BAL.
 13039
 13040     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13041        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13042            GO TO 3150-RATE-OUTSTAND-BAL
 13043        ELSE
 13044           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13045               GO TO 3150-RATE-OUTSTAND-BAL.
 13046
 13047     IF NOT PB-NO-MONTHS-SKIPPED
 13048        GO TO 3150-RATE-OUTSTAND-BAL.
 13049
 13050     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13051        GO TO 3150-RATE-OUTSTAND-BAL.
 13052
 13053     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13054        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13055           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13056             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13057           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13058           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13059              MOVE ER-2693     TO WS-ERROR
 13060              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13061              GO TO 3150-RATE-OUTSTAND-BAL
 13062           ELSE
 13063              GO TO 3150-RATE-OUTSTAND-BAL.
 13064
 13065 3150-RATE-OUTSTAND-BAL.
 13066
 13067* DMD RATING TEST
 13068     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13069         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13070         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13071         MOVE ER-2687                 TO WS-ERROR
 13072         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13073         MOVE 'B'                     TO PB-I-OB-FLAG
 13074         GO TO 3260-EDIT-CONTINUE.
 13075
 13076     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13077         IF  WS-ERROR    EQUAL    ER-2693
 13078             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13079                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13080                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13081                 MOVE  +0            TO  WS-ERROR.
 13082
 13083     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13084         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 238
* EL050.cbl
 13085             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13086                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13087                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13088                 MOVE  +0            TO  WS-ERROR.
 13089
 13090     IF PLAN-MASTER-AH-SW = 'Y'
 13091        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13092            IF  WS-ERROR    EQUAL    ER-2693
 13093              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13094                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13095                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13096                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13097                 MOVE  ER-1910           TO  WS-ERROR
 13098                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13099
 13100     IF PLAN-MASTER-AH-SW = 'Y'
 13101        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13102            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13103               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13104               MOVE  ER-1910           TO  WS-ERROR
 13105               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13106
 13107     IF PLAN-MASTER-AH-SW = 'Y'
 13108        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13109            IF  WS-ERROR    EQUAL    ER-2693
 13110                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13111                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13112                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13113                 MOVE  +0       TO  WS-ERROR.
 13114
 13115     IF WS-ERROR = ER-2693
 13116        IF PB-COMPANY-ID = 'JAL' AND
 13117           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13118           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13119           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13120
 13121     IF WS-ERROR = ER-2693
 13122        IF PB-COMPANY-ID = 'NCL'  AND
 13123           PB-I-AH-BENEFIT-CD = 'OA'
 13124           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13125           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13126
 13127     IF WS-ERROR = ER-2693
 13128        IF PB-COMPANY-ID = 'CNL' AND
 13129           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13130           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13131           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13132
 13133     IF WS-ERROR = ER-2693
 13134        IF PB-COMPANY-ID = 'HER'
 13135           IF WS-LEVEL
 13136              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13137              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13138
 13139     IF ((LF-BENEFIT-FOUND) AND
 13140         (NOT NO-LIFE-COVERAGE)  AND
 13141         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13142       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 239
* EL050.cbl
 13143             (NOT NO-AH-COVERAGE)    AND
 13144             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13145         NEXT SENTENCE
 13146     ELSE
 13147         GO TO 3215-EDIT-RATES.
 13148
 13149     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13150        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13151           MOVE ER-2674          TO WS-ERROR
 13152           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13153           GO TO 3215-EDIT-RATES.
 13154
 13155     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13156        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13157           MOVE ER-2674          TO WS-ERROR
 13158           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13159           GO TO 3215-EDIT-RATES.
 13160
 13161     MOVE 'B'                    TO PB-I-OB-FLAG.
 13162
 13163     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13164         NEXT SENTENCE
 13165     ELSE
 13166         IF NOT NO-LIFE-COVERAGE
 13167             IF WS-ACCT-LF-OB-RT = ZERO
 13168                MOVE ER-2641    TO WS-ERROR
 13169                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13170
 13171     IF PB-COMPANY-ID = 'CRI'
 13172       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13173         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13174         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13175         IF WS-ERROR = ER-2675
 13176            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13177            MOVE ER-2687              TO WS-ERROR
 13178            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13179         ELSE
 13180            MOVE ER-2687              TO WS-ERROR
 13181            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13182
 13183
 13184     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13185         NEXT SENTENCE
 13186     ELSE
 13187       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13188            NEXT SENTENCE
 13189       ELSE
 13190         IF NOT NO-AH-COVERAGE
 13191             IF WS-ACCT-AH-OB-RT = ZERO
 13192                MOVE ER-2642    TO WS-ERROR
 13193                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13194
 13195     IF PB-COMPANY-ID = 'CRI'
 13196       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13197         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13198         IF WS-ERROR = ER-2676
 13199            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13200            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 240
* EL050.cbl
 13201            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13202         ELSE
 13203            MOVE ER-2687              TO WS-ERROR
 13204            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13205
 13206     IF PB-COMPANY-ID NOT = 'GIC'
 13207         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13208            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13209     ELSE
 13210         IF PB-I-LF-PREM-CALC = ZEROS
 13211             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13212                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13213
 13214     IF PB-COMPANY-ID NOT = 'GIC'
 13215         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13216            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13217     ELSE
 13218         IF PB-I-AH-PREM-CALC = ZEROS
 13219             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13220                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13221
 13222     MOVE ZEROS TO PB-I-MORT-CODE.
 13223
 13224     GO TO 3260-EDIT-CONTINUE.
 13225
 13226
 13227 3215-EDIT-RATES.
 13228     IF ACCOUNT-MAST-FOUND
 13229         NEXT SENTENCE
 13230     ELSE
 13231         GO TO 3999-END-EDIT.
 13232
 13233 3220-CHECK-LF-RATES.
 13234
 13235     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13236        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13237        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13238        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13239           AND (NOT WS-LF-CASH))
 13240                           OR
 13241           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13242           AND (NOT WS-AH-CASH)))
 13243                       AND
 13244           (PB-I-ENTRY-STATUS NOT = '5')
 13245           MOVE 'M'              TO PB-BATCH-ENTRY
 13246                                    PB-I-ENTRY-STATUS
 13247        END-IF
 13248     END-IF
 13249     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13250                                    PB-I-AH-PREM-CALC
 13251                                    PB-I-LF-ALT-PREM-CALC
 13252                                    PB-I-LF-ALT-RATE
 13253                                    PB-I-LF-REI-RATE
 13254                                    PB-I-LF-ALT-REI-RATE
 13255                                    PB-I-AH-REI-RATE
 13256                                    PB-I-TOT-FEES-CALC.
 13257
 13258     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 241
* EL050.cbl
 13259        NEXT SENTENCE
 13260     ELSE
 13261        MOVE ZEROS               TO PB-I-LF-RATE
 13262                                    PB-I-AH-RATE.
 13263
 13264     IF PB-I-TOT-FEES NOT NUMERIC
 13265        MOVE ZEROS               TO PB-I-TOT-FEES
 13266     END-IF
 13267     IF PB-I-LIVES NOT NUMERIC
 13268         MOVE ZERO               TO PB-I-LIVES.
 13269
 13270     IF PB-I-NUM-BILLED NOT NUMERIC
 13271         MOVE ZERO               TO PB-I-NUM-BILLED.
 13272
 13273     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13274        MOVE +0                  TO PB-I-LF-PREM-TAX
 13275     END-IF
 13276
 13277     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13278        MOVE +0                  TO PB-I-AH-PREM-TAX
 13279     END-IF
 13280
 13281     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13282        PB-I-PAY-FREQUENCY = ZEROS
 13283            MOVE 12 TO CP-PAY-FREQUENCY
 13284     ELSE
 13285            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13286
 13287     IF PB-I-STATE-TAX NOT NUMERIC
 13288         MOVE ZEROS               TO PB-I-STATE-TAX.
 13289
 13290     IF PB-I-MUNI-TAX NOT NUMERIC
 13291         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13292
 13293     MOVE SPACES                 TO CP-BEN-CATEGORY
 13294     IF PB-COMPANY-ID  = 'CSL'  AND
 13295        PB-I-LF-TERM NOT = ZERO
 13296        COMPUTE WS-PAYMENT-AMT =
 13297             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13298        COMPUTE WS-CSL-AMT1 =
 13299             PB-I-LF-TERM * AM-MAX-MON-BEN
 13300        COMPUTE WS-CSL-AMT2 =
 13301             WS-PAYMENT-AMT * PB-I-LF-TERM
 13302        IF CP-PAY-FREQUENCY NOT = 12
 13303           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13304           MOVE '8' TO WS-CSL-CALC-CD
 13305        ELSE
 13306           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13307              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13308               AM-MAX-TOT-BEN
 13309               MOVE '6' TO WS-CSL-CALC-CD
 13310           ELSE
 13311              IF (WS-CSL-AMT1  GREATER THAN
 13312                 AM-MAX-TOT-BEN) AND
 13313                 (WS-CSL-AMT2  GREATER THAN
 13314                 AM-MAX-TOT-BEN)
 13315                 MOVE '7' TO WS-CSL-CALC-CD
 13316              ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 242
* EL050.cbl
 13317                 MOVE '5' TO WS-CSL-CALC-CD.
 13318
 13319     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13320         NEXT SENTENCE
 13321     ELSE
 13322         GO TO 3300-CHECK-AH-RATES.
 13323
 13324*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13325
 13326     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13327        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13328              OR
 13329           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13330           MOVE ER-2618          TO WS-ERROR
 13331           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13332           GO TO 3300-CHECK-AH-RATES.
 13333
 13334     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13335           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13336                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13337
 13338     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13339         MOVE ER-2687             TO WS-ERROR
 13340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13341         MOVE 'Z000'              TO PB-I-MORT-CODE
 13342         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13343         GO TO 3300-CHECK-AH-RATES.
 13344
 13345     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13346        IF PB-I-LIVES = ZERO
 13347           MOVE ER-2688          TO WS-ERROR
 13348           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13349
 13350     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13351
 13352     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13353     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13354     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13355     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13356     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13357     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13358     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13359     MOVE '3'                    TO CP-PROCESS-TYPE.
 13360     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13361     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13362
 13363******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13364     IF PB-COMPANY-ID EQUAL 'CDL'
 13365         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13366            CP-EARN-AS-NET-PAY)
 13367             IF PB-CERT-EFF-DT GREATER  WS-931231
 13368                 MOVE '1'        TO CP-EARNING-METHOD.
 13369*******
 13370
 13371     MOVE PB-SV-STATE            TO CP-STATE.
 13372     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13373     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13374     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 243
* EL050.cbl
 13375     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13376     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13377                                    CP-RATING-BENEFIT-AMT.
 13378     IF CP-STATE-STD-ABBRV = 'OR'
 13379         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13380                                         PB-I-LF-ALT-BENEFIT-AMT.
 13381     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13382     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13383     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13384     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13385     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13386     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13387     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13388     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13389     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13390                                    CP-REMAINING-TERM
 13391                                    CP-LOAN-TERM.
 13392
 13393     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13394         NEXT SENTENCE
 13395     ELSE
 13396         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13397             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13398                                           PB-I-LF-PREMIUM-AMT.
 13399
 13400     IF PB-COMPANY-ID EQUAL 'CSL'
 13401        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13402           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13403                                         PB-I-LF-PREMIUM-AMT.
 13404
 13405     IF PB-COMPANY-ID EQUAL 'NCB'
 13406         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13407            CP-EARN-AS-NET-PAY
 13408             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13409                 PB-I-LF-PREMIUM-AMT.
 13410
 13411     IF (CP-TRUNCATED-LIFE)
 13412        or ((pb-company-id = 'AHL')
 13413           and (pb-i-loan-term > pb-i-lf-term))
 13414        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13415
 13416     IF PB-COMPANY-ID EQUAL 'CRI'
 13417        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13418
 13419     IF CP-TERM-IS-DAYS
 13420         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13421     ELSE
 13422         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13423     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13424        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13425        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13426        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13427        IF WS-LF-BEN-CATEGORY = 'D'
 13428           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13429           MOVE PB-I-LIFE-COMMISSION
 13430                                 TO CP-DCC-ACT-COMM
 13431           MOVE WS-LF-BEN-CATEGORY
 13432                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 244
* EL050.cbl
 13433        END-IF
 13434        IF (CP-BENEFIT-CD (1:1) = 'P')
 13435           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13436           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13437           add pb-i-ah-premium-amt to cp-original-premium
 13438        END-IF
 13439     END-IF
 13440     IF PB-COMPANY-ID = 'CSL'
 13441         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13442         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13443         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13444
 13445     IF PB-COMPANY-ID = 'CSL'
 13446        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13447
 13448     IF (CP-SPECIAL-CALC-CD = 'H')
 13449        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13450         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13451                                    TO CP-ALTERNATE-BENEFIT
 13452         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13453     if (pb-company-id = 'CID')
 13454        and (ws-lf-earnings-calc = '4')
 13455        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13456        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13457        move pb-i-term-type      to cp-pmt-mode
 13458        move pb-i-no-of-payments to cp-no-of-pmts
 13459     end-if
 13460     move ws-net-only-state      to cp-net-only-state
 13461     IF (PB-COMPANY-ID = 'CID')
 13462        AND (WS-LF-EARNINGS-CALC = 'B')
 13463        AND (CP-STATE-STD-ABBRV = 'MN')
 13464        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13465                                 TO CP-ALTERNATE-BENEFIT
 13466        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13467     END-IF
 13468     IF (PB-COMPANY-ID = 'CID')
 13469        AND (WS-LF-EARNINGS-CALC = 'B')
 13470        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13471                                 TO CP-ALTERNATE-BENEFIT
 13472        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13473        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13474*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13475*         pb-i-lf-alt-premium-amt
 13476        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13477        IF WS-LF-BEN-CATEGORY = 'P'
 13478           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13479        ELSE
 13480           IF WS-LF-BEN-CATEGORY = 'I'
 13481              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13482           END-IF
 13483        END-IF
 13484     END-IF
 13485     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13486     MOVE 'R'                   TO CP-RATE-FILE.
 13487     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13488
 13489     IF CP-ERROR-RATE-NOT-FOUND
 13490        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 245
* EL050.cbl
 13491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13492        GO TO 3300-CHECK-AH-RATES.
 13493
 13494     IF PB-COMPANY-ID EQUAL 'CRI'
 13495        IF CP-ERROR-NO-LIMITS-CRI
 13496           IF NOT ACCOUNT-LIFE-CHECKED
 13497              MOVE ER-2607      TO WS-ERROR
 13498              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13499
 13500******************************************************************
 13501*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13502*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13503******************************************************************
 13504
 13505* CALC LIFE AGE AT EXPIRATION.
 13506
 13507     COMPUTE WS-AGE-AT-EXPIRE =
 13508          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13509
 13510*    IF PB-STATE = 'CO' OR 'UT'
 13511*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13512*        MOVE 'F'            TO PB-FATAL-FLAG
 13513*        MOVE ER-2709        TO WS-ERROR
 13514*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13515*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13516
 13517*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13518*        MOVE 'X'            TO PB-FATAL-FLAG
 13519*        MOVE ER-2718        TO WS-ERROR
 13520*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13521*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13522
 13523* CALC A & H AGE AT EXPIRATION.
 13524
 13525     COMPUTE WS-AGE-AT-EXPIRE =
 13526          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13527
 13528*    IF PB-STATE = 'CO' OR 'UT'
 13529*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13530*        MOVE 'F'            TO PB-FATAL-FLAG
 13531*        MOVE ER-2709        TO WS-ERROR
 13532*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13533*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13534
 13535*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13536*        MOVE 'X'            TO PB-FATAL-FLAG
 13537*        MOVE ER-2718        TO WS-ERROR
 13538*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13539*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13540
 13541     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13542        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13543
 13544     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13545        and (not pb-monthly-cert)
 13546        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13547     end-if
 13548
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 246
* EL050.cbl
 13549     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13550        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13551
 13552     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13553         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13554         MOVE ER-2639        TO WS-ERROR
 13555         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13556
 13557
 13558******************************************************************
 13559*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13560******************************************************************
 13561
 13562 PREMIUM-EDITING-IS-BYPASSED.
 13563     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13564        AND (CP-R-MAX-ATT-AGE > +0)
 13565        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13566        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13567           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13568           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13569           MOVE '1'              TO DC-OPTION-CODE
 13570           PERFORM 8500-DATE-CONVERT
 13571                                 THRU 8500-EXIT
 13572           IF NO-CONVERSION-ERROR
 13573              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13574                 MOVE ER-2661       TO WS-ERROR
 13575*                PERFORM 9900-ERROR-FORMAT
 13576*                                THRU 9900-EXIT
 13577              END-IF
 13578           END-IF
 13579        ELSE
 13580           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13581           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13582              MOVE ER-2661       TO WS-ERROR
 13583*             PERFORM 9900-ERROR-FORMAT
 13584*                                THRU 9900-EXIT
 13585           ELSE
 13586              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13587                 MOVE ER-1570    TO WS-ERROR
 13588                 PERFORM 9900-ERROR-FORMAT
 13589                                 THRU 9900-EXIT
 13590              END-IF
 13591           END-IF
 13592        END-IF
 13593        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13594           MOVE PB-I-JOINT-BIRTHDAY
 13595                                 TO DC-BIN-DATE-1
 13596           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13597           MOVE '1'              TO DC-OPTION-CODE
 13598           PERFORM 8500-DATE-CONVERT
 13599                                 THRU 8500-EXIT
 13600           IF NO-CONVERSION-ERROR
 13601              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13602                 MOVE ER-2661       TO WS-ERROR
 13603*                PERFORM 9900-ERROR-FORMAT
 13604*                                THRU 9900-EXIT
 13605              END-IF
 13606           ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 247
* EL050.cbl
 13607              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13608           END-IF
 13609        ELSE
 13610           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13611             (PB-I-LF-TERM / 12)
 13612           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13613              MOVE ER-2661       TO WS-ERROR
 13614*             PERFORM 9900-ERROR-FORMAT
 13615*                                THRU 9900-EXIT
 13616           ELSE
 13617              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13618                 MOVE ER-1571    TO WS-ERROR
 13619                 PERFORM 9900-ERROR-FORMAT
 13620                                 THRU 9900-EXIT
 13621              END-IF
 13622           END-IF
 13623        END-IF
 13624        IF WS-ERROR = ER-2661
 13625           PERFORM 9900-ERROR-FORMAT
 13626                                 THRU 9900-EXIT
 13627        END-IF
 13628     END-IF
 13629*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13630*       MOVE ER-2661             TO WS-ERROR
 13631*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13632
 13633     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13634        MOVE ER-2662             TO WS-ERROR
 13635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13636
 13637     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13638        MOVE ER-2677             TO WS-ERROR
 13639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13640
 13641     IF CP-ERROR-LOAN-TERM
 13642        MOVE ER-2648             TO WS-ERROR
 13643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13644
 13645 3221-CHECK-ERROR-RATE-OPEN.
 13646
 13647     IF CP-ERROR-RATE-FILE-NOTOPEN
 13648         GO TO 3990-FILES-NOT-OPEN.
 13649
 13650     IF PB-COMPANY-ID NOT = 'DMD'
 13651        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13652     END-IF
 13653     .
 13654 3221-CONTINUE.
 13655     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13656                                    WS-DCC-AH-RATE
 13657     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13658        IF WS-LF-BEN-CATEGORY = 'D'
 13659           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13660              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13661        END-IF
 13662     END-IF
 13663     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13664*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 248
* EL050.cbl
 13665     IF (PB-COMPANY-ID = 'CID')
 13666        AND (WS-LF-EARNINGS-CALC = 'B')
 13667        AND (CP-STATE-STD-ABBRV = 'MN')
 13668        AND (PB-CERT-EFF-DT > X'A4FF')
 13669        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13670     END-IF
 13671     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 13672
 13673     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13674     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13675        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13676        AND (PB-I-POLICY-IS-MONTHLY)
 13677        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13678        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13679     END-IF
 13680     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13681     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13682     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13683     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13684     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13685        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13686        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13687        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13688        MOVE ER-2786             TO WS-ERROR
 13689        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13690     END-IF
 13691
 13692     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13693
 13694******************************************************************
 13695*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13696******************************************************************
 13697     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13698        and ((not pb-monthly-cert)
 13699        or (ws-lf-ben-category = 'C'))
 13700        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13701
 13702     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13703        GO TO 3225-CHECK-ALT-LIFE-RATE
 13704     ELSE
 13705       IF PB-I-LF-RATE = ZERO
 13706          MOVE ER-2641          TO WS-ERROR
 13707          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13708
 13709 3225-CHECK-ALT-LIFE-RATE.
 13710
 13711     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13712        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13713        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13714         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13715
 13716     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13717         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13718             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 13719                   OR
 13720              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13721              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13722              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 249
* EL050.cbl
 13723             MOVE ER-2720        TO  WS-ERROR
 13724             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13725             GO TO 3225-RATING-CONT
 13726         ELSE
 13727             GO TO 3225-RATING-CONT.
 13728     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13729        AND (AM-GPCD = 01 OR 06 OR 15)
 13730        MOVE ER-2798             TO WS-ERROR
 13731        PERFORM 9900-ERROR-FORMAT
 13732                                 THRU 9900-EXIT
 13733*       GO TO 3225-RATING-CONT
 13734     END-IF
 13735     if (pb-company-id = 'CID')
 13736        and (ws-lf-earnings-calc = 'B')
 13737        and (ws-lf-ben-category = 'P' or 'I')
 13738        and (ws-net-only-state = 'Y')
 13739        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13740        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13741        go to 3225-rating-cont
 13742     end-if
 13743     IF (PB-COMPANY-ID = 'CID')
 13744        AND (WS-LF-EARNINGS-CALC = 'B')
 13745        AND (CP-STATE-STD-ABBRV = 'MN')
 13746        AND (PB-CERT-EFF-DT > X'A4FF')
 13747        GO TO 3225-RATING-CONT
 13748     END-IF
 13749     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13750        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13751           AND (PB-I-POLICY-IS-MONTHLY)
 13752           GO TO 3225-RATING-CONT
 13753        END-IF
 13754     END-IF
 13755
 13756     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13757        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13758        CP-EARN-AS-REG-BALLOON
 13759        NEXT SENTENCE
 13760     ELSE
 13761        MOVE '2'                 TO CP-EARNING-METHOD.
 13762
 13763 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13764
 13765     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13766
 13767     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13768        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13769        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13770         NEXT SENTENCE
 13771     ELSE
 13772         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13773
 13774     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13775     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13776     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13777                                     CP-RATING-BENEFIT-AMT.
 13778     IF CP-STATE-STD-ABBRV = 'OR'
 13779         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13780                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 250
* EL050.cbl
 13781     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13782        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13783     END-IF
 13784     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13785     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13786     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13787                                    CP-REMAINING-TERM
 13788                                    CP-LOAN-TERM.
 13789     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13790        ADD +1                   TO CP-ORIGINAL-TERM
 13791                                    CP-REMAINING-TERM
 13792                                    CP-LOAN-TERM.
 13793
 13794     MOVE 'R'                   TO CP-RATE-FILE.
 13795     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13796
 13797     IF CP-ERROR-RATE-NOT-FOUND
 13798         MOVE ER-2641            TO WS-ERROR
 13799         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13800         GO TO 3300-CHECK-AH-RATES.
 13801
 13802     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13803     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13804
 13805     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13806         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13807
 13808     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13809                               + PB-I-LF-ALT-BENEFIT-AMT.
 13810
 13811     IF ACCOUNT-LIFE-CHECKED  OR
 13812        PB-POLICY-IS-VOIDED   OR
 13813        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13814        and (not pb-monthly-cert))
 13815        GO TO 3225-CONTINUE.
 13816
 13817     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13818        GO TO 3225-CONTINUE.
 13819
 13820     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13821                             EC-RT-LF-MAX-TOT-BEN
 13822        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13823        MOVE ER-2639       TO WS-ERROR
 13824        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13825
 13826 3225-CONTINUE.
 13827     IF PB-I-LF-ALT-RATE = ZERO
 13828         MOVE ER-2659            TO WS-ERROR
 13829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13830
 13831     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13832        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13833        MOVE ER-2698             TO WS-ERROR
 13834        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13835
 13836 3225-RATING-CONT.
 13837
 13838     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 251
* EL050.cbl
 13839        and (not pb-monthly-cert)
 13840         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13841         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13842         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13843            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13844            CONTINUE
 13845         ELSE
 13846            MOVE ER-2687         TO WS-ERROR
 13847            PERFORM 9900-ERROR-FORMAT
 13848                                 THRU 9900-EXIT
 13849         END-IF
 13850         GO TO 3290-EDIT-LF-REIN-RATE
 13851     END-IF
 13852
 13853* DMD RATING TEST
 13854     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13855         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13856         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13857         MOVE ER-2687                 TO WS-ERROR
 13858         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13859         GO TO 3290-EDIT-LF-REIN-RATE.
 13860
 13861 3230-CLIENT-MORT-CD-SPECIALS.
 13862
 13863     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13864     SET BIN-TO-GREG          TO TRUE.
 13865*    MOVE ' '                 TO DC-OPTION-CODE.
 13866     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13867     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13868
 13869 C-POS-3230-MORT-CD.
 13870     IF PB-COMPANY-ID = 'POS' AND
 13871        PB-SV-CARRIER = '2'
 13872         NEXT SENTENCE
 13873     ELSE
 13874         GO TO C-POS-3240-MORT-CD.
 13875
 13876     IF PB-SV-GROUPING = '030'
 13877        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13878         MOVE '2350' TO PB-I-MORT-CODE
 13879      ELSE
 13880         MOVE '3300' TO PB-I-MORT-CODE.
 13881
 13882
 13883 C-POS-3240-MORT-CD.
 13884     IF PB-COMPANY-ID = 'POS' AND
 13885        PB-SV-CARRIER = '1'
 13886         NEXT SENTENCE
 13887     ELSE
 13888         GO TO 3230-CONTINUE.
 13889
 13890     IF PB-SV-STATE = '45' OR '47'
 13891        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13892         MOVE '5200' TO PB-I-MORT-CODE
 13893     ELSE
 13894         MOVE '8300' TO PB-I-MORT-CODE.
 13895
 13896 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 252
* EL050.cbl
 13897
 13898     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13899        GO TO 3240-CONTINUE
 13900     END-IF
 13901
 13902     IF PB-CERT-EFF-DT > WS-971231
 13903        GO TO 3240-CONTINUE
 13904     END-IF
 13905
 13906     IF LF-BENEFIT-FOUND AND
 13907        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13908         MOVE 'F250'       TO PB-I-MORT-CODE
 13909     ELSE
 13910         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13911             MOVE '7250'   TO PB-I-MORT-CODE
 13912         ELSE
 13913             MOVE '4251'   TO PB-I-MORT-CODE
 13914         END-IF
 13915     END-IF
 13916
 13917     .
 13918 3240-CONTINUE.
 13919
 13920     IF PB-COMPANY-ID NOT = 'GNL'
 13921         GO TO 3256-CONTINUE.
 13922
 13923     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13924         MOVE 'A300' TO PB-I-MORT-CODE
 13925     ELSE
 13926         MOVE '8350' TO PB-I-MORT-CODE.
 13927
 13928 3256-CONTINUE.
 13929     IF PB-COMPANY-ID NOT = 'ABL'
 13930         GO TO 3260-EDIT-CONTINUE.
 13931
 13932     IF PB-I-LF-TERM GREATER THAN 59
 13933         MOVE 'F550' TO PB-I-MORT-CODE
 13934     ELSE
 13935         MOVE 'E550' TO PB-I-MORT-CODE.
 13936
 13937 3260-EDIT-CONTINUE.
 13938     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13939
 13940 3290-EDIT-LF-REIN-RATE.
 13941     IF LF-REIN-NSP-NOT-USED
 13942         GO TO 3290-RATING-CONT.
 13943
 13944     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13945        GO TO 3290-RATING-CONT.
 13946     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13947     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13948     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13949     MOVE '3'                   TO CP-PROCESS-TYPE.
 13950     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13951
 13952******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13953     IF PB-COMPANY-ID EQUAL 'CDL'
 13954         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 253
* EL050.cbl
 13955            CP-EARN-AS-NET-PAY)
 13956             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13957*            MOVE SPACE          TO DC-OPTION-CODE
 13958             SET BIN-TO-GREG     TO TRUE
 13959             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13960***  Y2K PROJ 7744
 13961             IF DC-GREG-DATE-CYMD GREATER 19931231
 13962                 MOVE '1'        TO CP-EARNING-METHOD.
 13963***  Y2K PROJ 7744
 13964*******
 13965
 13966     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13967     MOVE PB-SV-STATE           TO CP-STATE.
 13968     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13969     MOVE ZERO                  TO CP-DEVIATION-CODE
 13970                                   CP-RATE-DEV-PCT.
 13971     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13972     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13973                                   CP-RATING-BENEFIT-AMT.
 13974
 13975************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13976     IF PB-COMPANY-ID EQUAL 'NCB'
 13977         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13978            CP-EARN-AS-NET-PAY
 13979             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13980                 PB-I-LF-PREMIUM-AMT.
 13981************
 13982
 13983     IF CP-STATE-STD-ABBRV = 'OR'
 13984         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13985                                         PB-I-LF-ALT-BENEFIT-AMT.
 13986     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13987     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13988     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13989     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13990     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13991     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13992     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13993     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13994                                   CP-REMAINING-TERM
 13995                                   CP-LOAN-TERM.
 13996     IF CP-TRUNCATED-LIFE
 13997        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13998
 13999     IF CP-TERM-IS-DAYS
 14000         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14001     ELSE
 14002         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14003
 14004     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14005        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14006     END-IF
 14007     IF PB-COMPANY-ID NOT = 'TIC'
 14008          MOVE ZERO          TO CP-CLASS-CODE.
 14009
 14010     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14011
 14012     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 254
* EL050.cbl
 14013     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14014
 14015     IF CP-ERROR-RATE-NOT-FOUND
 14016        IF PB-I-OB
 14017           MOVE ER-2625      TO WS-ERROR
 14018           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14019           GO TO 3299-EDIT-CONTINUE
 14020        ELSE
 14021           MOVE ER-2643      TO WS-ERROR
 14022           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14023           GO TO 3299-EDIT-CONTINUE.
 14024
 14025     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14026
 14027     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14028     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14029
 14030     IF PB-I-LF-REI-RATE = ZERO
 14031         MOVE ER-2643        TO WS-ERROR
 14032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14033
 14034 3290-CHECK-ALT-REIN-RATE.
 14035
 14036     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14037        GO TO 3290-RATING-CONT.
 14038
 14039     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14040     MOVE '2'                    TO CP-EARNING-METHOD.
 14041     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14042     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14043     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14044     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14045                                     CP-RATING-BENEFIT-AMT.
 14046     IF CP-STATE-STD-ABBRV = 'OR'
 14047         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14048                                         PB-I-LF-ALT-BENEFIT-AMT.
 14049     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14050        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14051     END-IF
 14052     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14053     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14054     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14055                                    CP-REMAINING-TERM
 14056                                    CP-LOAN-TERM.
 14057     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14058        ADD +1                   TO CP-ORIGINAL-TERM
 14059                                    CP-REMAINING-TERM
 14060                                    CP-LOAN-TERM.
 14061
 14062     MOVE 'R'                   TO CP-RATE-FILE.
 14063     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14064
 14065     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14066
 14067     IF PB-I-LF-ALT-REI-RATE = ZERO
 14068         MOVE ER-2643            TO WS-ERROR
 14069         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14070
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 255
* EL050.cbl
 14071 3290-RATING-CONT.
 14072
 14073     IF PB-I-OB
 14074*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14075        GO TO 3300-CHECK-AH-RATES.
 14076
 14077 3299-EDIT-CONTINUE.
 14078
 14079     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14080         NEXT SENTENCE
 14081     ELSE
 14082         MOVE ER-2620           TO WS-ERROR
 14083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14084
 14085 3300-CHECK-AH-RATES.
 14086     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14087         NEXT SENTENCE
 14088     ELSE
 14089         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14090
 14091     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14092        and (not pb-monthly-cert))
 14093                  or
 14094        ((CF-COMPANY-ID = 'DMD') AND
 14095                (NO-DMD-RATING))
 14096         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14097            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14098            CONTINUE
 14099         ELSE
 14100            MOVE ER-2687         TO WS-ERROR
 14101            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14102         END-IF
 14103         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14104         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14105     END-IF
 14106
 14107     IF PB-I-OB
 14108        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14109
 14110     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14111         MOVE ER-2687             TO WS-ERROR
 14112         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14113         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14114         GO TO 3999-END-EDIT.
 14115
 14116*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14117     if pb-company-id = 'AHL'
 14118        go to 3300-skip-crit-per
 14119     end-if
 14120     if (pb-i-ah-crit-per not = zeros)
 14121        and (ws-ah-special-calc-cd not = 'C')
 14122        MOVE ER-1572             TO WS-ERROR
 14123        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14124        go to 3300-skip-crit-per
 14125     END-IF
 14126     if (pb-company-id = 'DCC' or 'VPP')
 14127        and (am-dcc-product-code not = spaces)
 14128        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 256
* EL050.cbl
 14129     end-if
 14130     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14131        IF PB-I-AH-CRIT-PER = ZERO
 14132           move ws-ah-max-bens   to pb-i-ah-crit-per
 14133*          MOVE ER-2618       TO WS-ERROR
 14134*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14135*          GO TO 3999-END-EDIT
 14136        END-IF
 14137     END-IF
 14138     if (ws-ah-special-calc-cd = 'C')
 14139        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14140        MOVE ER-1576             TO WS-ERROR
 14141        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14142     end-if
 14143
 14144     .
 14145 3300-skip-crit-per.
 14146     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14147     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14148     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14149     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14150     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14151     MOVE PB-SV-STATE            TO CP-STATE.
 14152     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14153     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14154     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14155*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14156     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14157     MOVE '3'                    TO CP-PROCESS-TYPE.
 14158     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14159     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14160                                    CP-RATING-BENEFIT-AMT.
 14161     IF PB-COMPANY-ID = 'CID'
 14162               OR
 14163        CP-STATE-STD-ABBRV = 'OR'
 14164         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14165                                         PB-I-AH-TERM.
 14166     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14167        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14168           AND (PB-I-POLICY-IS-MONTHLY)
 14169           MOVE PB-I-LF-BENEFIT-AMT
 14170                                 TO CP-NET-BENEFIT-AMT
 14171           move pb-i-ah-premium-amt to cp-original-premium
 14172           add pb-i-lf-premium-amt to cp-original-premium
 14173        END-IF
 14174     END-IF
 14175     MOVE SPACES                 TO CP-BEN-CATEGORY
 14176     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14177        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14178        EVALUATE TRUE
 14179           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14180              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14181              MOVE PB-I-LF-BENEFIT-AMT
 14182                                 TO CP-RATING-BENEFIT-AMT
 14183              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14184           WHEN WS-AH-BEN-CATEGORY = 'G'
 14185              MOVE PB-I-UNPAID-CASH-PRICE
 14186                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 257
* EL050.cbl
 14187           WHEN WS-AH-BEN-CATEGORY = 'D'
 14188              MOVE WS-AH-PMF-COMM
 14189                                 TO CP-DCC-PMF-COMM
 14190              MOVE PB-I-AH-COMMISSION
 14191                                 TO CP-DCC-ACT-COMM
 14192        END-EVALUATE
 14193     END-IF
 14194     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14195     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14196     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14197     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14198     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14199     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14200     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14201                                    CP-REMAINING-TERM
 14202                                    WS-WORK-TERM.
 14203     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14204
 14205     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14206     SET BIN-TO-GREG             TO TRUE.
 14207*    MOVE ' '                    TO DC-OPTION-CODE.
 14208     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14209     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14210
 14211     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14212     IF NOT VALID-SKIP-CODE
 14213         MOVE ER-2683            TO WS-ERROR
 14214         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14215         GO TO 3320-RATE-CONTINUE.
 14216
 14217     IF PB-NO-MONTHS-SKIPPED
 14218         GO TO 3320-RATE-CONTINUE.
 14219
 14220     MOVE SPACE TO NUMBER-OF-MONTHS.
 14221
 14222     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14223         MOVE 'S'                TO SK-MO (6).
 14224     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14225         MOVE 'S'                TO SK-MO (7).
 14226     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14227         MOVE 'S'                TO SK-MO (8).
 14228     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14229         MOVE 'S'                TO SK-MO (9).
 14230     IF PB-I-SKIP-CODE = 'A'
 14231         MOVE 'S'                TO SK-MO (10).
 14232
 14233     MOVE 1                      TO SUB2.
 14234     MOVE PB-I-AH-TERM           TO SUB3.
 14235     MOVE WS-MONTH               TO SUB1.
 14236     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14237     GO TO 3320-RATE-CONTINUE.
 14238
 14239 3310-GET-SKIP-MO.
 14240     IF SUB1 = 13
 14241         MOVE 1                  TO SUB1.
 14242
 14243     IF SK-MO (SUB1) = 'S'
 14244         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 258
* EL050.cbl
 14245
 14246     ADD 1 TO SUB2
 14247              SUB1.
 14248
 14249 3320-RATE-CONTINUE.
 14250
 14251     IF WS-WORK-TERM = ZERO
 14252         MOVE 1                  TO WS-WORK-TERM.
 14253
 14254     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14255                                    CP-LOAN-TERM.
 14256
 14257     IF PB-COMPANY-ID EQUAL 'DMD'
 14258         NEXT SENTENCE
 14259     ELSE
 14260         MOVE ZERO               TO PB-I-AH-RATE
 14261                                    PB-I-AH-REI-RATE.
 14262
 14263
 14264     IF PB-COMPANY-ID EQUAL 'CRI'
 14265        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14266
 14267     IF PB-COMPANY-ID = 'CSL'
 14268         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14269         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14270         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14271         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14272
 14273     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14274        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14275           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14276              PB-I-RATE-DEV-PCT-LF
 14277        END-IF
 14278        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14279                                 TO CP-ALTERNATE-BENEFIT
 14280        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14281        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14282        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14283     END-IF
 14284     IF (PB-COMPANY-ID = 'CID')
 14285        AND (WS-LF-EARNINGS-CALC = 'B')
 14286        AND (CP-STATE-STD-ABBRV = 'MN')
 14287        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14288     ELSE
 14289        MOVE ' '                 TO CP-AH-BALLOON-SW
 14290     END-IF
 14291     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14292     MOVE 'R'                   TO CP-RATE-FILE.
 14293     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14294
 14295     IF (CP-ERROR-RATE-NOT-FOUND)
 14296        and (not pb-monthly-cert)
 14297        IF PB-I-OB
 14298           MOVE ER-2624          TO WS-ERROR
 14299           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14300           GO TO 3340-CALCULATE-PREMIUM-AMT
 14301        ELSE
 14302          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 259
* EL050.cbl
 14303              NEXT SENTENCE
 14304          ELSE
 14305           MOVE ER-2642          TO WS-ERROR
 14306           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14307           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14308
 14309     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14310        CP-ERROR-DIV-BY-ZERO
 14311           MOVE ER-3782          TO WS-ERROR
 14312           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14313
 14314     IF PB-COMPANY-ID EQUAL 'CRI'
 14315        IF CP-ERROR-NO-LIMITS-CRI
 14316           IF NOT ACCOUNT-AH-CHECKED
 14317              MOVE ER-2607          TO WS-ERROR
 14318              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14319
 14320     IF ACCOUNT-AH-CHECKED
 14321        NEXT SENTENCE
 14322     ELSE
 14323       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14324          MOVE ER-2640           TO WS-ERROR
 14325          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14326
 14327     IF PB-COMPANY-ID = 'CRI'
 14328         IF WS-ERROR = ER-2640
 14329             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14330     IF ACCOUNT-AH-CHECKED
 14331        CONTINUE
 14332     ELSE
 14333        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14334           AND (CP-R-MAX-ATT-AGE > +0)
 14335           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14336           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14337              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14338              MOVE PB-I-AH-EXPIRE-DT
 14339                                 TO DC-BIN-DATE-2
 14340              MOVE '1'           TO DC-OPTION-CODE
 14341              PERFORM 8500-DATE-CONVERT
 14342                                 THRU 8500-EXIT
 14343              IF NO-CONVERSION-ERROR
 14344                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14345                    MOVE ER-2661       TO WS-ERROR
 14346*                   PERFORM 9900-ERROR-FORMAT
 14347*                                THRU 9900-EXIT
 14348                 END-IF
 14349              END-IF
 14350           ELSE
 14351              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14352              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14353                 MOVE ER-2661    TO WS-ERROR
 14354*                PERFORM 9900-ERROR-FORMAT
 14355*                                THRU 9900-EXIT
 14356              ELSE
 14357                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14358                    MOVE ER-1570 TO WS-ERROR
 14359                    PERFORM 9900-ERROR-FORMAT
 14360                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 260
* EL050.cbl
 14361                 END-IF
 14362              END-IF
 14363           END-IF
 14364           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14365              MOVE PB-I-JOINT-BIRTHDAY
 14366                                    TO DC-BIN-DATE-1
 14367              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14368              MOVE '1'              TO DC-OPTION-CODE
 14369              PERFORM 8500-DATE-CONVERT
 14370                                    THRU 8500-EXIT
 14371              IF NO-CONVERSION-ERROR
 14372                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14373                    MOVE ER-2661       TO WS-ERROR
 14374*                   PERFORM 9900-ERROR-FORMAT
 14375*                                   THRU 9900-EXIT
 14376                 END-IF
 14377              END-IF
 14378           ELSE
 14379              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14380                (PB-I-AH-TERM / 12)
 14381              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14382                 MOVE ER-2661       TO WS-ERROR
 14383*                PERFORM 9900-ERROR-FORMAT
 14384*                                   THRU 9900-EXIT
 14385              ELSE
 14386                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14387                    MOVE ER-1571 TO WS-ERROR
 14388                    PERFORM 9900-ERROR-FORMAT
 14389                                 THRU 9900-EXIT
 14390                 END-IF
 14391              END-IF
 14392           END-IF
 14393           IF WS-ERROR = ER-2661
 14394              PERFORM 9900-ERROR-FORMAT
 14395                                    THRU 9900-EXIT
 14396           END-IF
 14397        END-IF
 14398     END-IF
 14399*    IF ACCOUNT-AH-CHECKED
 14400*       NEXT SENTENCE
 14401*    ELSE
 14402*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14403*          MOVE ER-2661          TO WS-ERROR
 14404*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14405
 14406     IF ACCOUNT-AH-CHECKED
 14407        NEXT SENTENCE
 14408     ELSE
 14409        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14410           MOVE ER-2663          TO WS-ERROR
 14411           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14412
 14413     IF ACCOUNT-AH-CHECKED OR
 14414        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14415         PB-POLICY-IS-VOIDED
 14416        NEXT SENTENCE
 14417     ELSE
 14418        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 261
* EL050.cbl
 14419           MOVE ER-2667            TO WS-ERROR
 14420           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14421
 14422     IF PB-COMPANY-ID = 'CRI'
 14423         IF WS-ERROR = ER-2667
 14424             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14425
 14426     IF ACCOUNT-AH-CHECKED
 14427        NEXT SENTENCE
 14428     ELSE
 14429        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14430           MOVE ER-2678            TO WS-ERROR
 14431           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14432
 14433     IF CP-ERROR-RATE-FILE-NOTOPEN
 14434         GO TO 3990-FILES-NOT-OPEN.
 14435
 14436 3321-CONTINUE.
 14437     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14438     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14439     IF (PB-COMPANY-ID = 'DCC')
 14440        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14441        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14442                                    PB-I-LF-ALT-PREM-CALC
 14443        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14444        IF WS-AH-BEN-CATEGORY = 'G'
 14445           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14446           + PB-I-ADDL-CLP)
 14447           * (1 + WS-TOL-CLP-PCT)
 14448*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14449        ELSE
 14450           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14451           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14452*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14453        END-IF
 14454        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14455                                 TO PB-I-AH-PREM-CALC
 14456        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14457           MOVE ER-8152          TO WS-ERROR
 14458           PERFORM 9900-ERROR-FORMAT
 14459                                 THRU 9900-EXIT
 14460        ELSE
 14461           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14462                 PB-I-ADDL-CLP)
 14463              MOVE ER-8148       TO WS-ERROR
 14464              PERFORM 9900-ERROR-FORMAT
 14465                                 THRU 9900-EXIT
 14466           END-IF
 14467        END-IF
 14468     END-IF
 14469     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14470        AND (PB-I-POLICY-IS-MONTHLY)
 14471        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14472        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14473        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14474           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14475        END-IF
 14476     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 262
* EL050.cbl
 14477     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14478        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14479        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14480        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14481        MOVE ER-2786             TO WS-ERROR
 14482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14483     END-IF
 14484     MOVE +0                     TO PB-I-AH-CLP
 14485     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14486        evaluate true
 14487           when WS-AH-BEN-CATEGORY = 'D'
 14488              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14489                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14490           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14491              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14492           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14493              compute ws-cred-union-fees rounded =
 14494                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14495                    pb-i-ah-commission)
 14496              COMPUTE PB-I-AH-CLP =
 14497                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14498        end-evaluate
 14499     END-IF
 14500     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14501
 14502     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14503         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14504
 14505     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14506         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14507
 14508     if (ws-ah-special-calc-cd = 'E')
 14509        and (pb-monthly-cert)
 14510        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14511     end-if
 14512     IF PB-COMPANY-ID = 'CRI'
 14513         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14514            PB-I-PAYMENT-AMOUNT = ZERO
 14515             NEXT SENTENCE
 14516         ELSE
 14517             COMPUTE PB-I-AH-PREM-CALC =
 14518                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14519                 (CP-PREMIUM-RATE / 100)
 14520             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14521                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14522                                             PB-I-RATE-DEV-PCT-AH.
 14523
 14524     IF (PB-I-AH-RATE  = ZERO)
 14525        and (not pb-monthly-cert)
 14526       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14527           NEXT SENTENCE
 14528       ELSE
 14529         MOVE ER-2642            TO WS-ERROR
 14530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14531
 14532     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14533     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14534     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 263
* EL050.cbl
 14535     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14536     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14537     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14538
 14539     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14540        AND (WS-AH-BEN-CATEGORY = 'G')
 14541        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14542        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14543        IF CP-DEVIATION-CODE NOT = '000'
 14544           MOVE '000'            TO CP-DEVIATION-CODE
 14545           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14546           IF NO-CP-ERROR
 14547              COMPUTE PB-I-DDF-IU-RATE-UP =
 14548              PB-I-AH-CLP - CP-CALC-PREMIUM
 14549           ELSE
 14550              MOVE ER-3057        TO WS-ERROR
 14551              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14552           END-IF
 14553        END-IF
 14554     END-IF
 14555     .
 14556 3335-EDIT-AH-REIN-NSP-RATE.
 14557     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14558        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14559              compute ws-cred-union-fees rounded =
 14560                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14561                    pb-i-ah-commission)
 14562              COMPUTE PB-I-AH-CLP =
 14563                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14564        end-if
 14565     END-IF
 14566     IF AH-REIN-NSP-NOT-USED
 14567         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14568
 14569     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14570     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14571         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14572     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14573     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14574     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14575     MOVE PB-SV-STATE            TO CP-STATE.
 14576     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14577     MOVE ZERO                   TO CP-DEVIATION-CODE
 14578                                    CP-RATE-DEV-PCT.
 14579*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14580     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14581     MOVE '3'                    TO CP-PROCESS-TYPE.
 14582     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14583     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14584                                    CP-RATING-BENEFIT-AMT.
 14585     IF CP-STATE-STD-ABBRV = 'OR'
 14586         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14587                                         PB-I-AH-TERM.
 14588     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14589     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14590     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14591     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14592     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 264
* EL050.cbl
 14593     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14594                                    CP-REMAINING-TERM
 14595                                    WS-WORK-TERM.
 14596     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14597     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14598        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14599     END-IF
 14600     IF  PB-COMPANY-ID = 'TIC'
 14601         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14602            MOVE ZERO TO CP-CLASS-CODE.
 14603
 14604     IF PB-COMPANY-ID NOT = 'TIC'
 14605          MOVE ZERO          TO CP-CLASS-CODE.
 14606
 14607     MOVE ZERO               TO CP-DEVIATION-CODE.
 14608
 14609     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14610
 14611     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14612
 14613     MOVE 'R'                   TO CP-RATE-FILE.
 14614     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14615
 14616     IF CP-ERROR-RATE-NOT-FOUND
 14617         MOVE ER-2645        TO WS-ERROR
 14618         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14619         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14620
 14621     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14622
 14623     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14624     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14625
 14626     IF PB-I-AH-REI-RATE = ZERO
 14627         MOVE ER-2645        TO WS-ERROR
 14628         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14629
 14630
 14631 3340-CALCULATE-PREMIUM-AMT.
 14632
 14633     IF PB-COMPANY-ID = 'NCL'
 14634         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14635             WS-AH-SPECIAL-CALC-CD = 'O')
 14636             GO TO 3999-END-EDIT.
 14637
 14638     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14639                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14640                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 14641                         OR 'AHL'
 14642         NEXT SENTENCE
 14643     ELSE
 14644         IF WS-STATE-ABBREVIATION = 'CT'
 14645             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14646                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14647                 COMPUTE PB-I-LF-PREM-CALC =
 14648                                     PB-I-LF-PREM-CALC * .90
 14649                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14650                                     PB-I-LF-ALT-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 265
* EL050.cbl
 14651                 COMPUTE PB-I-AH-PREM-CALC =
 14652                                     PB-I-AH-PREM-CALC * .90.
 14653
 14654     IF PB-COMP-LF-PREM
 14655        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14656        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14657
 14658     IF PB-COMP-AH-PREM
 14659        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14660
 14661 3340-CHECK-DCC-TOT-FEES.
 14662     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14663        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14664        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14665        AND (PB-I-POLICY-IS-MONTHLY)
 14666        CONTINUE
 14667     ELSE
 14668        GO TO 3340-EDIT-LF-AH-TOL
 14669     END-IF
 14670     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14671     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14672     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14673        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14674           PB-I-RATE-DEV-PCT-LF
 14675     END-IF
 14676     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14677        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14678           PB-I-RATE-DEV-PCT-AH
 14679     END-IF
 14680     MOVE 'N'                    TO CP-BEN-CATEGORY
 14681     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14682
 14683     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14684     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14685     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14686     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14687     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14688     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14689     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14690     MOVE '3'                    TO CP-PROCESS-TYPE.
 14691     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14692     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14693
 14694     MOVE PB-SV-STATE            TO CP-STATE.
 14695     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14696     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14697     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14698     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14699     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14700                                    CP-RATING-BENEFIT-AMT.
 14701     IF CP-STATE-STD-ABBRV = 'OR'
 14702         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14703                                         PB-I-LF-ALT-BENEFIT-AMT.
 14704     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14705     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14706     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14707     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14708     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 266
* EL050.cbl
 14709     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14710     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14711     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14712     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14713                                    CP-REMAINING-TERM
 14714                                    CP-LOAN-TERM.
 14715     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14716        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14717           PB-I-LF-PREMIUM-AMT
 14718     end-if
 14719
 14720     IF CP-TRUNCATED-LIFE
 14721        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14722
 14723     IF CP-TERM-IS-DAYS
 14724         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14725     ELSE
 14726         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14727
 14728     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14729     IF CP-SPECIAL-CALC-CD = 'H'
 14730         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14731                                    TO CP-ALTERNATE-BENEFIT
 14732         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14733     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14734     MOVE 'R'                    TO CP-RATE-FILE
 14735     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14736     IF NOT CP-ERROR-RATE-NOT-FOUND
 14737        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14738        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14739           AND (CP-BENEFIT-CD (1:1) = 'S')
 14740           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14741                                    PB-I-LF-PREMIUM-AMT
 14742        END-IF
 14743     ELSE
 14744        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14745     END-IF
 14746     .
 14747 3340-EDIT-LF-AH-TOL.
 14748
 14749***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14750***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14751***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14752***
 14753     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14754         PB-I-AH-PREMIUM-AMT
 14755          GIVING WS-CALC-WORK.
 14756
 14757     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14758        AND WS-CALC-WORK NOT = ZERO
 14759         MOVE ER-2649            TO WS-ERROR
 14760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14761
 14762     SUBTRACT PB-I-LF-PREM-CALC
 14763             FROM PB-I-LF-PREMIUM-AMT
 14764                 GIVING WS-UNSIGN-WRK1.
 14765
 14766     SUBTRACT PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 267
* EL050.cbl
 14767             FROM PB-I-LF-ALT-PREMIUM-AMT
 14768                 GIVING WS-UNSIGN-WRK4.
 14769
 14770     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14771                                + WS-UNSIGN-WRK4.
 14772
 14773     SUBTRACT PB-I-AH-PREM-CALC
 14774             FROM PB-I-AH-PREMIUM-AMT
 14775                 GIVING WS-UNSIGN-WRK2.
 14776
 14777******************************************************************
 14778*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14779******************************************************************
 14780
 14781     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14782         MOVE ZERO TO WS-UNSIGN-WRK1.
 14783
 14784     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14785         MOVE ZERO TO WS-UNSIGN-WRK2.
 14786
 14787     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14788             GIVING WS-UNSIGN-WRK3.
 14789
 14790 3342-CONTINUE.
 14791
 14792     IF (PB-I-LF-RATE = ZERO  AND
 14793         PB-I-AH-RATE = ZERO)
 14794         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14795            WS-AH-SPECIAL-CALC-CD = 'O'
 14796              NEXT SENTENCE
 14797         ELSE
 14798             GO TO 3345-EDIT-CONTINUE.
 14799
 14800     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14801         NEXT SENTENCE
 14802     ELSE
 14803     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14804        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14805           IF (PB-REISSUED-CERT         OR
 14806               PB-POLICY-IS-DECLINED    OR
 14807               PB-POLICY-IS-VOIDED)
 14808              NEXT SENTENCE
 14809           ELSE
 14810              IF WS-PREM-REJECT-SW = SPACE
 14811                 MOVE ER-2652    TO WS-ERROR
 14812                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14813                 GO TO 3344-CHECK-AH
 14814              ELSE
 14815                 MOVE ER-2650    TO WS-ERROR
 14816                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14817                 GO TO 3344-CHECK-AH.
 14818
 14819***
 14820***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14821***
 14822
 14823     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14824         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 268
* EL050.cbl
 14825            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14826             (1 + WS-TOL-LF-PREM-PCT)
 14827         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14828            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14829             (1 - WS-TOL-LF-PREM-PCT)
 14830     ELSE
 14831         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14832         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14833
 14834***
 14835***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14836***
 14837
 14838     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14839         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14840          WS-TOL-LF-PREM.
 14841
 14842     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14843         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14844          WS-TOL-LF-PREM.
 14845
 14846     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14847        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14848
 14849     IF PB-REISSUED-CERT
 14850        or PB-POLICY-IS-DECLINED
 14851        or PB-POLICY-IS-VOIDED
 14852        continue
 14853     ELSE
 14854        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14855              > WS-TOL-LF-HIGH-PREM-AMT)
 14856           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14857              < WS-TOL-LF-LOW-PREM-AMT))
 14858                      or
 14859           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14860              > WS-TOL-LF-HIGH-PREM-PCT)
 14861           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14862              < WS-TOL-LF-LOW-PREM-PCT))
 14863           IF WS-PREM-REJECT-SW = SPACE
 14864              MOVE ER-2652       TO WS-ERROR
 14865              PERFORM 9900-ERROR-FORMAT
 14866                                 THRU 9900-EXIT
 14867           ELSE
 14868              MOVE ER-2650       TO WS-ERROR
 14869              PERFORM 9900-ERROR-FORMAT
 14870                                 THRU 9900-EXIT
 14871           end-if
 14872        end-if
 14873     end-if
 14874
 14875*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14876*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14877*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14878*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14879
 14880     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14881        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14882                      OR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 269
* EL050.cbl
 14883           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 14884           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14885           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14886           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14887        END-IF
 14888     END-IF
 14889
 14890     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14891        IF WS-COMP-MAX-CAP GREATER THAN +0
 14892           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14893              IF (PB-REISSUED-CERT         OR
 14894                  PB-POLICY-IS-DECLINED    OR
 14895                  PB-POLICY-IS-VOIDED)
 14896                 NEXT SENTENCE
 14897              ELSE
 14898                  MOVE ER-2646   TO  WS-ERROR
 14899                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14900
 14901 3344-CVL-TOLERANCE-CHECK.
 14902
 14903      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14904          GO TO 3344-CHECK-AH.
 14905
 14906      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14907          GO TO 3344-CHECK-AH.
 14908
 14909      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14910                                     WS-UNSIGN-WRK6.
 14911
 14912      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14913          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14914                                 + PB-I-LF-PREMIUM-AMT
 14915                                 - PB-I-LF-PREM-CALC.
 14916
 14917      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14918          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14919                                 + PB-I-LF-ALT-PREMIUM-AMT
 14920                                 - PB-I-LF-ALT-PREM-CALC.
 14921
 14922      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14923          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14924              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14925                 MOVE ER-2652    TO  WS-ERROR
 14926                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14927              ELSE
 14928                 MOVE ER-2650    TO  WS-ERROR
 14929                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14930
 14931      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14932          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14933              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14934                 MOVE ER-2652    TO  WS-ERROR
 14935                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14936              ELSE
 14937                 MOVE ER-2650    TO  WS-ERROR
 14938                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14939
 14940 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 270
* EL050.cbl
 14941
 14942****************************************************************
 14943***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14944***
 14945
 14946     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14947         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14948             (1 + WS-TOL-AH-PREM-PCT)
 14949         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14950             (1 - WS-TOL-AH-PREM-PCT)
 14951     ELSE
 14952         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14953         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14954
 14955***
 14956***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14957***
 14958
 14959     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14960         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14961
 14962     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14963         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14964
 14965     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14966        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14967
 14968     IF (PB-REISSUED-CERT)
 14969        OR (PB-POLICY-IS-DECLINED)
 14970        OR (PB-POLICY-IS-VOIDED)
 14971        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14972        CONTINUE
 14973     ELSE
 14974        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14975              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14976                          or
 14977           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14978              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14979           IF WS-PREM-REJECT-SW = SPACE
 14980              MOVE ER-3052       TO WS-ERROR
 14981              PERFORM 9900-ERROR-FORMAT
 14982                                 THRU 9900-EXIT
 14983           ELSE
 14984              MOVE ER-3050       TO WS-ERROR
 14985              PERFORM 9900-ERROR-FORMAT
 14986                                 THRU 9900-EXIT
 14987           END-IF
 14988        END-IF
 14989     END-IF
 14990     if (pb-company-id = 'DCC' or 'VPP')
 14991        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14992        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14993        and (pb-i-policy-is-monthly)
 14994        compute ws-tol-ah-high-prem-amt =
 14995           pb-i-tot-fees-calc + ws-tol-ah-prem
 14996        compute ws-tol-ah-low-prem-amt =
 14997           pb-i-tot-fees-calc - ws-tol-ah-prem
 14998        if ws-tol-ah-prem-pct > zeros
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 271
* EL050.cbl
 14999           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15000              (1 + ws-tol-ah-prem-pct)
 15001           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15002              (1 - ws-tol-ah-prem-pct)
 15003        else
 15004           move +9999999.99      to ws-tol-ah-high-prem-pct
 15005           move +0               to ws-tol-ah-low-prem-pct
 15006        end-if
 15007        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15008            or
 15009           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15010                          or
 15011           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15012           or
 15013           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15014            move er-3049         to ws-error
 15015           perform 9900-error-format
 15016                                 thru 9900-exit
 15017
 15018        end-if
 15019     end-if
 15020     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15021         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15022             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15023             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15024
 15025     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15026        IF WS-COMP-MAX-CAP GREATER THAN +0
 15027           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15028              IF (PB-REISSUED-CERT         OR
 15029                  PB-POLICY-IS-DECLINED    OR
 15030                  PB-POLICY-IS-VOIDED)
 15031                 NEXT SENTENCE
 15032              ELSE
 15033                  MOVE ER-2646   TO  WS-ERROR
 15034                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15035
 15036     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15037        (WS-COMP-MAX-CAP EQUAL +0)
 15038           GO TO 3345-EDIT-CONTINUE.
 15039
 15040     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15041        GREATER THAN WS-COMP-MAX-CAP
 15042           MOVE ER-2646          TO  WS-ERROR
 15043           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15044
 15045 3345-EDIT-CONTINUE.
 15046
 15047*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15048*       IF PB-ENTRY-BATCH   NUMERIC
 15049*          IF PB-ISSUE
 15050*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15051*          ELSE
 15052*              IF PB-CANCELLATION
 15053*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15054
 15055*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15056*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 272
* EL050.cbl
 15057*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15058*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15059*        ELSE
 15060*            MOVE  ER-1909            TO  WS-ERROR
 15061*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15062
 15063     IF PB-I-POLICY-ACCEPTED
 15064        IF PB-POLICY-IS-DECLINED  OR
 15065           PB-REISSUED-CERT  OR
 15066           PB-REIN-ONLY-CERT  OR
 15067           PB-POLICY-IS-VOIDED
 15068            MOVE  ER-1891         TO  WS-ERROR
 15069            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15070        ELSE
 15071            MOVE SPACE            TO  PB-BATCH-ENTRY
 15072            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15073
 15074     IF PB-I-POLICY-DECLINED
 15075        IF PB-REISSUED-CERT  OR
 15076           PB-REIN-ONLY-CERT  OR
 15077           PB-POLICY-IS-VOIDED
 15078            MOVE  ER-1906         TO  WS-ERROR
 15079            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15080        ELSE
 15081            MOVE  'D'             TO  PB-BATCH-ENTRY
 15082                                      PB-I-ENTRY-STATUS.
 15083
 15084     IF PB-I-NEEDS-UNDERWRITING
 15085        IF PB-POLICY-IS-DECLINED OR
 15086           PB-REISSUED-CERT  OR
 15087           PB-REIN-ONLY-CERT  OR
 15088           PB-POLICY-IS-VOIDED
 15089            MOVE  ER-1907         TO  WS-ERROR
 15090            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15091        ELSE
 15092            MOVE 'U'              TO  PB-BATCH-ENTRY
 15093                                      PB-I-ENTRY-STATUS.
 15094
 15095     IF PB-NEEDS-UNDERWRITING
 15096        MOVE  ER-1901             TO  WS-ERROR
 15097        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15098     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15099        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15100        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15101        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15102           AND (NOT WS-LF-CASH))
 15103                           OR
 15104           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15105           AND (NOT WS-AH-CASH)))
 15106                       AND
 15107           (PB-I-ENTRY-STATUS NOT = '5')
 15108           MOVE 'M'              TO PB-BATCH-ENTRY
 15109                                    PB-I-ENTRY-STATUS
 15110        END-IF
 15111     END-IF
 15112     move pending-business       to ws-passed-erpndb
 15113     move ' '                    to ws-exceed-limit-yn
 15114     perform 7780-call-agg       thru 7780-exit
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 273
* EL050.cbl
 15115     display ' el050 exceed ' ws-exceed-limit-yn
 15116     if ws-exceed-limit-yn = 'Y'
 15117        MOVE  ER-9813            TO WS-ERROR
 15118        PERFORM  9900-ERROR-FORMAT
 15119                                 THRU 9900-EXIT
 15120     end-if
 15121     IF  PB-COMPANY-ID NOT = 'NCL'
 15122         GO TO 3999-END-EDIT.
 15123
 15124     IF PB-REISSUED-CERT  OR
 15125        PB-POLICY-IS-DECLINED  OR
 15126        PB-POLICY-IS-VOIDED  OR
 15127        PB-I-OB
 15128         GO TO 3999-END-EDIT.
 15129
 15130     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15131         MOVE  ER-2644            TO  WS-ERROR
 15132         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15133         GO TO 3999-END-EDIT.
 15134
 15135     MOVE 'N'                     TO  FORM-MASTER-SW.
 15136     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15137
 15138     IF NOT FORM-MASTER-FOUND
 15139         GO TO 3999-END-EDIT.
 15140
 15141     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15142                                      FORM-MASTER-AH-SW.
 15143
 15144     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15145         MOVE  +1                 TO SUB6
 15146         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15147
 15148     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15149         MOVE  +1                 TO SUB6
 15150         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15151
 15152     IF LF-FORM-MASTER-FOUND  OR
 15153        AH-FORM-MASTER-FOUND
 15154         GO TO 3360-CHECK-FORM-LIMITS
 15155     ELSE
 15156         GO TO 3999-END-EDIT.
 15157
 15158******************************************************************
 15159*                  3350-GET-ERFORM                               *
 15160*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15161*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15162******************************************************************
 15163
 15164 3350-GET-ERFORM.
 15165
 15166     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15167         GO TO  3350-ERFORM-GETMAIN.
 15168
 15169     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15170     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15171     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15172     MOVE 'Y'                     TO FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 274
* EL050.cbl
 15173
 15174     IF PB-CANCELLATION
 15175         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15176            PB-SV-STATE          EQUAL   FO-STATE       AND
 15177            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15178              GO TO 3350-EXIT
 15179         ELSE
 15180             NEXT SENTENCE
 15181     ELSE
 15182         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15183            PB-SV-STATE          EQUAL   FO-STATE       AND
 15184            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15185              GO TO 3350-EXIT.
 15186
 15187 3350-ERFORM-GETMAIN.
 15188
 15189     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15190     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15191
 15192 3350-ERFORM-READ.
 15193
 15194     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15195     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15196     IF PB-CANCELLATION
 15197         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15198     ELSE
 15199         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15200     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15201
 15202     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15203
 15204     IF FORM-MASTER-FOUND
 15205       IF PB-CANCELLATION
 15206          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15207             PB-SV-STATE          EQUAL   FO-STATE       AND
 15208             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15209              GO  TO 3350-EXIT
 15210          ELSE
 15211              NEXT SENTENCE
 15212       ELSE
 15213          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15214             PB-SV-STATE          EQUAL   FO-STATE       AND
 15215             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15216              GO  TO 3350-EXIT.
 15217
 15218     MOVE  'N'                    TO  FORM-MASTER-SW.
 15219     MOVE  ER-1895                TO  WS-ERROR.
 15220     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15221
 15222 3350-EXIT.
 15223      EXIT.
 15224
 15225******************************************************************
 15226*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15227*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15228*   VALID FOR THE POLICY FORM USED.                              *
 15229******************************************************************
 15230
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 275
* EL050.cbl
 15231 3355-EDIT-FORM-LF-BENEFITS.
 15232
 15233     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15234        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15235         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15236         GO TO   3355-EXIT.
 15237
 15238     IF  SUB6    LESS THAN   +40
 15239         ADD  +1      TO  SUB6
 15240         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15241
 15242     MOVE  ER-1896         TO  WS-ERROR.
 15243     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15244
 15245 3355-EXIT.
 15246      EXIT.
 15247
 15248******************************************************************
 15249*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15250*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15251*   VALID FOR THE POLICY FORM USED.                              *
 15252******************************************************************
 15253
 15254 3356-EDIT-FORM-AH-BENEFITS.
 15255
 15256     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15257        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15258         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15259         GO TO  3356-EXIT.
 15260
 15261      IF  SUB6    LESS THAN     +40
 15262          ADD  +1      TO  SUB6
 15263          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15264
 15265     MOVE  ER-1897         TO  WS-ERROR.
 15266     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15267
 15268 3356-EXIT.
 15269      EXIT.
 15270
 15271******************************************************************
 15272*                  3357-BENEFIT-SEARCH                           *
 15273*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15274*   CANCELLATIONS ONLY.                                          *
 15275******************************************************************
 15276 3357-BENEFIT-SEARCH.
 15277     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15278         MOVE +1                          TO SUB6
 15279         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15280
 15281     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15282         MOVE +1                          TO SUB6
 15283         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15284
 15285 3357-EXIT.
 15286     EXIT.
 15287
 15288******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 276
* EL050.cbl
 15289*                  3358-BENEFIT-LIFE-SEARCH                      *
 15290*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15291*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15292*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15293******************************************************************
 15294 3358-BENEFIT-LIFE-SEARCH.
 15295     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15296       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15297         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15298           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15299              IF FO-PLAN-REFUND-METHOD (SUB6)
 15300                     IS GREATER THAN SPACES
 15301                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15302                                          WS-LF-REFUND-CALC
 15303                 GO TO 3358-EXIT.
 15304
 15305     IF SUB6 LESS THAN +40
 15306         ADD +1                 TO SUB6
 15307         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15308
 15309 3358-EXIT.
 15310     EXIT.
 15311******************************************************************
 15312*                  3359-BENEFIT-AH-SEARCH                        *
 15313*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15314*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15315*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15316******************************************************************
 15317 3359-BENEFIT-AH-SEARCH.
 15318     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15319       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15320         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15321           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15322              IF FO-PLAN-REFUND-METHOD (SUB6)
 15323                      IS GREATER THAN SPACES
 15324                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15325                                          WS-AH-REFUND-CALC
 15326                 GO TO 3359-EXIT.
 15327
 15328     IF SUB6 LESS THAN +40
 15329         ADD +1                 TO SUB6
 15330         GO TO 3359-BENEFIT-AH-SEARCH.
 15331
 15332 3359-EXIT.
 15333     EXIT.
 15334
 15335******************************************************************
 15336*                  3360-CHECK-FORM-LIMITS                        *
 15337*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15338*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15339******************************************************************
 15340
 15341 3360-CHECK-FORM-LIMITS.
 15342
 15343     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15344         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15345
 15346     IF NOT LF-FORM-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 277
* EL050.cbl
 15347         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15348
 15349 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15350
 15351     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15352       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15353        WS-LF-JOINT-INDICATOR = 'J'  AND
 15354        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15355         IF PB-COMPANY-ID = 'NCL'
 15356            MOVE  ER-1911          TO  WS-ERROR
 15357            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15358         ELSE
 15359            MOVE  ER-1892          TO  WS-ERROR
 15360            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15361
 15362 3360-CHECK-FORM-LF-ATT-AGE.
 15363
 15364     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15365
 15366     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15367         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15368         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15369            IF PB-COMPANY-ID = 'NCL'
 15370                MOVE  ER-1913      TO  WS-ERROR
 15371                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15372            ELSE
 15373                MOVE  ER-1894      TO  WS-ERROR
 15374                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15375
 15376 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15377
 15378     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15379         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15380         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15381            IF PB-COMPANY-ID = 'NCL'
 15382                MOVE  ER-1914      TO  WS-ERROR
 15383                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15384            ELSE
 15385                MOVE  ER-1899      TO  WS-ERROR
 15386                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15387
 15388 3360-CHECK-FORM-LF-TERM-BAMT.
 15389
 15390     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15391         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15392         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15393           IF  PB-COMPANY-ID = 'NCL'
 15394               MOVE  ER-1916       TO  WS-ERROR
 15395               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15396           ELSE
 15397               MOVE  ER-1902       TO  WS-ERROR
 15398               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15399
 15400     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15401                                    PB-I-LF-ALT-BENEFIT-AMT.
 15402
 15403     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15404         FO-MAX-LF-AMT   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 278
* EL050.cbl
 15405         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15406             IF  PB-COMPANY-ID = 'NCL'
 15407                 MOVE  ER-1918     TO  WS-ERROR
 15408                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15409             ELSE
 15410                 MOVE  ER-1904     TO  WS-ERROR
 15411                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15412
 15413******************************************************************
 15414*                  3360-CHECK-FORM-AH-LIMITS                     *
 15415*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15416*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15417******************************************************************
 15418
 15419 3360-CHECK-FORM-AH-LIMITS.
 15420
 15421     IF NOT AH-FORM-MASTER-FOUND
 15422         GO TO 3999-END-EDIT.
 15423
 15424 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15425
 15426     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15427       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15428        WS-AH-JOINT-INDICATOR = 'J'  AND
 15429        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15430         IF PB-COMPANY-ID = 'NCL'
 15431            MOVE  ER-1912          TO  WS-ERROR
 15432            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15433         ELSE
 15434            MOVE  ER-1893          TO  WS-ERROR
 15435            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15436
 15437 3360-CHECK-FORM-AH-ATT-AGE.
 15438
 15439     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15440
 15441     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15442         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15443         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15444            IF PB-COMPANY-ID = 'NCL'
 15445                MOVE  ER-1913      TO  WS-ERROR
 15446                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15447            ELSE
 15448                MOVE  ER-1894      TO  WS-ERROR
 15449                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15450
 15451 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15452
 15453     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15454         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15455         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15456            IF PB-COMPANY-ID = 'NCL'
 15457                MOVE  ER-1915      TO  WS-ERROR
 15458                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15459            ELSE
 15460                MOVE  ER-1900      TO  WS-ERROR
 15461                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15462
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 279
* EL050.cbl
 15463 3360-CHECK-FORM-AH-TERM-BAMT.
 15464
 15465     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15466         FO-AH-MAX-TERM    GREATER THAN  +0
 15467         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15468             IF  PB-COMPANY-ID = 'NCL'
 15469                 MOVE  ER-1917     TO  WS-ERROR
 15470                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15471             ELSE
 15472                  MOVE  ER-1903    TO  WS-ERROR
 15473                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15474
 15475     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15476         FO-MAX-AH-AMT    GREATER THAN  +0
 15477         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15478             IF  PB-COMPANY-ID = 'NCL'
 15479                 MOVE  ER-1919     TO  WS-ERROR
 15480                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15481             ELSE
 15482                 MOVE  ER-1905     TO  WS-ERROR
 15483                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15484
 15485     GO TO 3999-END-EDIT.
 15486
 15487******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 280
* EL050.cbl
 15489 3400-edit-vin.
 15490
 15491     MOVE PB-I-VIN               TO WS-WORK-VIN
 15492     MOVE +8                     TO V2
 15493     MOVE ZEROS                  TO WS-VIN-TOTAL
 15494     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15495      (V1 > 17)
 15496        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15497           MOVE ER-3825          TO WS-ERROR
 15498           PERFORM 9900-ERROR-FORMAT
 15499                                 THRU 9900-EXIT
 15500        ELSE
 15501           IF V1 = 8
 15502              MOVE 10            TO V2
 15503           END-IF
 15504           IF V1 = 9
 15505              MOVE 0             TO V2
 15506           END-IF
 15507           IF V1 = 10
 15508              MOVE 9             TO V2
 15509           END-IF
 15510           IF WS-WORK-VIN (V1:1) NUMERIC
 15511              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15512               + (WS-WORK-VIN-N (V1) * V2)
 15513           ELSE
 15514              MOVE WS-WORK-VIN (V1:1)
 15515                            TO WS-HEX-BYTE
 15516              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15517              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15518               + (WS-NUM (V3) * V2)
 15519           END-IF
 15520           COMPUTE V2 = V2 - 1
 15521        END-IF
 15522     END-PERFORM
 15523     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15524     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15525        REMAINDER WS-VIN-REMAINDER
 15526     IF ((WS-WORK-VIN (9:1) = 'X')
 15527        AND (WS-VIN-REMAINDER = 10))
 15528                OR
 15529        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15530        CONTINUE
 15531     ELSE
 15532        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15533           MOVE ER-3826          TO WS-ERROR
 15534           PERFORM 9900-ERROR-FORMAT
 15535                                 THRU 9900-EXIT
 15536        ELSE
 15537           MOVE ER-3827          TO WS-ERROR
 15538           PERFORM 9900-ERROR-FORMAT
 15539                                 THRU 9900-EXIT
 15540        END-IF
 15541     END-IF
 15542
 15543     .
 15544 3400-exit.
 15545     exit.
 15546******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 281
* EL050.cbl
 15547*                  E D I T   C A N C E L                         *
 15548******************************************************************
 15549
 15550 3700-EDIT-CANCEL.
 15551     IF PB-COMPANY-ID = 'DMD'
 15552         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15553                                         WS-RES-MUNI-TAX
 15554                                         PB-CI-STATE-TAX
 15555                                         PB-CI-MUNI-TAX
 15556         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15557
 15558*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15559*       IF PB-ENTRY-BATCH  NUMERIC
 15560*          IF PB-CANCELLATION
 15561*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15562*          ELSE
 15563*             IF PB-ISSUE
 15564*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15565
 15566     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15567        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15568     END-IF
 15569*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15570*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15571
 15572     IF CM-ENTRY-STATUS = 'V'
 15573        MOVE ER-2780             TO WS-ERROR
 15574        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15575        GO TO 3999-END-EDIT.
 15576
 15577     IF CM-ENTRY-STATUS = 'D'
 15578        MOVE ER-2781             TO WS-ERROR
 15579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15580        GO TO 3999-END-EDIT.
 15581
 15582     IF CM-ENTRY-STATUS = 'U'
 15583        MOVE ER-2782             TO WS-ERROR
 15584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15585
 15586***************************************************************
 15587*                                                             *
 15588*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15589*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15590*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15591*   OF ANOTHER COVERAGE.                                      *
 15592*                                                             *
 15593***************************************************************
 15594
 15595     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15596                                    PB-C-AH-CANCEL-VOID-SW.
 15597
 15598     IF PB-C-LF-CANCEL-AMT = ZERO
 15599        NEXT SENTENCE
 15600     ELSE
 15601        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15602           AND
 15603           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15604               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 282
* EL050.cbl
 15605               MOVE ER-2745           TO WS-ERROR
 15606               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15607
 15608     IF PB-C-AH-CANCEL-AMT = ZERO
 15609        NEXT SENTENCE
 15610     ELSE
 15611        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15612           AND
 15613           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15614               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15615               MOVE ER-2745           TO WS-ERROR
 15616               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15617
 15618     IF WS-LF-EARNINGS-CALC = '4'
 15619        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15620
 15621     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15622     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15623     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15624     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15625     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15626     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15627
 15628     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15629                                      PB-C-AH-REF-CALC.
 15630     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15631
 15632******************************************************************
 15633*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15634*             TO VALIDATE COVERAGE.                              *
 15635******************************************************************
 15636
 15637     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15638        PB-C-LF-CANCEL-AMT = ZEROS
 15639          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15640      ELSE
 15641          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15642
 15643     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15644        PB-C-AH-CANCEL-AMT = ZEROS
 15645          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15646      ELSE
 15647          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15648
 15649     EVALUATE TRUE
 15650         WHEN PB-CANCEL-FORCE             OR
 15651              PB-CANCEL-DATE-FORCED       OR
 15652              PB-FORCE-OFF
 15653                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15654                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15655                  END-IF
 15656         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15657               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15658              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 15659                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15660         WHEN OTHER
 15661              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15662                 MOVE ER-2794              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 283
* EL050.cbl
 15663              ELSE
 15664                 MOVE ER-2749              TO WS-ERROR
 15665              END-IF
 15666              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15667     END-EVALUATE.
 15668
 15669
 15670*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15671*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15672*            MOVE  ER-1909            TO  WS-ERROR
 15673*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15674*        ELSE
 15675*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15676
 15677     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15678     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15679        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15680     ELSE
 15681        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15682     END-IF
 15683     .
 15684 3705-EDIT-CANCEL-DT.
 15685
 15686     IF LF-COVERAGE-CANCELLED
 15687        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15688         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15689         MOVE WS-CURRENT-MONTH-END
 15690                                 TO DC-BIN-DATE-2
 15691         SET ELAPSED-BETWEEN-BIN TO TRUE
 15692*        MOVE 1                  TO DC-OPTION-CODE
 15693         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15694         IF DATE-CONVERSION-ERROR
 15695            NEXT SENTENCE
 15696          ELSE
 15697             IF DC-ELAPSED-DAYS GREATER +180
 15698                IF PB-CANCEL-DATE-FORCED  OR
 15699                   PB-CANCEL-DATE-FORCED-NO-FEE
 15700                      MOVE ER-2751  TO WS-ERROR
 15701                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15702                 ELSE
 15703                   MOVE ER-2752  TO WS-ERROR
 15704                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15705
 15706     IF AH-COVERAGE-CANCELLED
 15707        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15708         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15709         MOVE WS-CURRENT-MONTH-END
 15710                                 TO DC-BIN-DATE-2
 15711         SET ELAPSED-BETWEEN-BIN TO TRUE
 15712*        MOVE 1                  TO DC-OPTION-CODE
 15713         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15714         IF DATE-CONVERSION-ERROR
 15715            NEXT SENTENCE
 15716          ELSE
 15717             IF DC-ELAPSED-DAYS GREATER +180
 15718                IF PB-CANCEL-DATE-FORCED OR
 15719                   PB-CANCEL-DATE-FORCED-NO-FEE
 15720                      MOVE ER-2751  TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 284
* EL050.cbl
 15721                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15722                 ELSE
 15723                   MOVE ER-2752  TO WS-ERROR
 15724                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15725
 15726     IF WS-ERROR = ER-2752
 15727        AND (PB-COMPANY-ID = 'ABL'
 15728         OR  PB-COMPANY-ID = 'FGL'
 15729         OR  PB-COMPANY-ID = 'IST'
 15730         OR  PB-COMPANY-ID = 'JHL'
 15731         OR  PB-COMPANY-ID = 'LAP'
 15732         OR  PB-COMPANY-ID = 'LBL'
 15733         OR  PB-COMPANY-ID = 'NCB'
 15734         OR  PB-COMPANY-ID = 'NLI'
 15735         OR  PB-COMPANY-ID = 'OFI'
 15736         OR  PB-COMPANY-ID = 'PLI'
 15737         OR  PB-COMPANY-ID = 'TAO'
 15738         OR  PB-COMPANY-ID = 'TIC'
 15739         OR  PB-COMPANY-ID = 'HER'
 15740         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15741         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15742            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15743            MOVE ER-2762     TO WS-ERROR
 15744            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15745
 15746     IF LF-COVERAGE-CANCELLED
 15747        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15748        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15749             MOVE ER-2733         TO WS-ERROR
 15750             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15751
 15752     IF AH-COVERAGE-CANCELLED
 15753        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15754        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15755              MOVE ER-2733        TO WS-ERROR
 15756              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15757
 15758     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15759        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15760        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15761           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15762            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15763              IF PB-COMPANY-ID NOT = 'LAP'
 15764               MOVE ER-2704            TO WS-ERROR
 15765               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15766
 15767     IF CERT-WAS-NOT-FOUND
 15768         GO TO 3999-END-EDIT.
 15769
 15770     IF PB-COMPANY-ID EQUAL 'CDC'
 15771        IF LF-COVERAGE-CANCELLED
 15772           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15773            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15774            MOVE PB-C-LF-CANCEL-DT
 15775                                 TO DC-BIN-DATE-2
 15776            SET ELAPSED-BETWEEN-BIN TO TRUE
 15777*           MOVE 1               TO DC-OPTION-CODE
 15778            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 285
* EL050.cbl
 15779            IF DATE-CONVERSION-ERROR
 15780               NEXT SENTENCE
 15781             ELSE
 15782                IF DC-ELAPSED-DAYS GREATER +60
 15783                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15784
 15785     IF PB-COMPANY-ID EQUAL 'CDC'
 15786        IF AH-COVERAGE-CANCELLED
 15787           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15788            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15789            MOVE PB-C-AH-CANCEL-DT
 15790                                 TO DC-BIN-DATE-2
 15791            MOVE +0              TO DC-ELAPSED-DAYS
 15792                                    DC-ELAPSED-MONTHS
 15793            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15794*           MOVE 1               TO DC-OPTION-CODE
 15795            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15796            IF DATE-CONVERSION-ERROR
 15797               NEXT SENTENCE
 15798             ELSE
 15799                IF DC-ELAPSED-DAYS GREATER +60
 15800                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15801
 15802     MOVE +0                     TO DC-ELAPSED-DAYS
 15803                                    DC-ELAPSED-MONTHS.
 15804
 15805     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15806        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15807          MOVE 'Z'                TO PB-CI-OB-FLAG
 15808          MOVE ER-2767            TO WS-ERROR
 15809          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15810          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15811          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15812          GO TO 3775-OVER-REF-CHK
 15813        ELSE
 15814          MOVE ZEROS              TO PB-CI-LIVES
 15815                                     PB-C-LIVES
 15816          IF PB-CI-OB-FLAG NOT = 'B'
 15817             MOVE SPACE           TO PB-CI-OB-FLAG.
 15818
 15819     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15820         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15821     ELSE
 15822         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15823
 15824     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15825        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15826            MOVE ER-2760         TO WS-ERROR
 15827            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15828
 15829     IF LF-COVERAGE-CANCELLED
 15830        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15831         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15832            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15833               MOVE ER-2774       TO WS-ERROR
 15834               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15835
 15836     IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 286
* EL050.cbl
 15837        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15838         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15839            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15840               MOVE ER-2775       TO WS-ERROR
 15841               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15842
 15843     IF LF-COVERAGE-CANCELLED
 15844        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15845         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15846            MOVE ER-2776         TO WS-ERROR
 15847            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15848
 15849     IF AH-COVERAGE-CANCELLED
 15850        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15851         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15852            MOVE ER-2777         TO WS-ERROR
 15853            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15854
 15855     IF LF-COVERAGE-CANCELLED
 15856        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15857        if pb-ci-lf-expire-dt = low-values or spaces
 15858           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15859           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15860           MOVE PB-CI-EXTENTION-DAYS
 15861                                 TO DC-ELAPSED-DAYS
 15862           SET BIN-PLUS-ELAPSED  TO TRUE
 15863           PERFORM 8500-DATE-CONVERT
 15864                                 THRU 8500-EXIT
 15865           IF DATE-CONVERSION-ERROR
 15866              move low-values    to dc-bin-date-2
 15867           end-if
 15868        else
 15869           move pb-ci-lf-expire-dt
 15870                                 to dc-bin-date-2
 15871        end-if
 15872        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15873           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15874                             OR  'FIA'
 15875              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15876           ELSE
 15877              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15878              MOVE ER-2731       TO WS-ERROR
 15879              PERFORM 9900-ERROR-FORMAT
 15880                                 THRU 9900-EXIT
 15881           end-if
 15882        end-if
 15883     end-if
 15884*    IF LF-COVERAGE-CANCELLED
 15885*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15886*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15887*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15888*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15889*        SET BIN-PLUS-ELAPSED      TO TRUE
 15890*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15891*        IF DATE-CONVERSION-ERROR
 15892*           NEXT SENTENCE
 15893*         ELSE
 15894*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 287
* EL050.cbl
 15895*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15896*                            OR  'FIA'
 15897*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15898*              ELSE
 15899*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15900*               MOVE ER-2731       TO WS-ERROR
 15901*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15902     .
 15903 3705-EDIT-AH-CANCEL-DT.
 15904     IF AH-COVERAGE-CANCELLED
 15905        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15906        if pb-ci-AH-expire-dt = low-values or spaces
 15907           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15908           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15909           MOVE PB-CI-EXTENTION-DAYS
 15910                                 TO DC-ELAPSED-DAYS
 15911           SET BIN-PLUS-ELAPSED  TO TRUE
 15912           PERFORM 8500-DATE-CONVERT
 15913                                 THRU 8500-EXIT
 15914           IF DATE-CONVERSION-ERROR
 15915              move low-values    to dc-bin-date-2
 15916           end-if
 15917        else
 15918           move pb-ci-ah-expire-dt
 15919                                 to dc-bin-date-2
 15920        end-if
 15921        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15922           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15923                             OR  'FIA'
 15924              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15925           ELSE
 15926              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15927              MOVE ER-2771       TO WS-ERROR
 15928              PERFORM 9900-ERROR-FORMAT
 15929                                 THRU 9900-EXIT
 15930           end-if
 15931        end-if
 15932     end-if
 15933*    IF AH-COVERAGE-CANCELLED
 15934*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15935*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15936*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15937*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15938**       MOVE 6                    TO DC-OPTION-CODE
 15939*        SET BIN-PLUS-ELAPSED      TO TRUE
 15940*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15941*        IF DATE-CONVERSION-ERROR
 15942*           NEXT SENTENCE
 15943*         ELSE
 15944*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15945*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15946*                             OR 'FIA'
 15947*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15948*             ELSE
 15949*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15950*              MOVE ER-2771       TO WS-ERROR
 15951*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15952     .
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 288
* EL050.cbl
 15953 3705-EDIT-CONTINUED.
 15954
 15955*    IF LF-COVERAGE-CANCELLED
 15956*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15957*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15958*            MOVE ER-2727         TO WS-ERROR
 15959*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15960*
 15961*    IF AH-COVERAGE-CANCELLED
 15962*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15963*        IF PB-COMPANY-ID = 'ACE'
 15964*           MOVE ER-2727        TO WS-ERROR
 15965*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15966*        ELSE
 15967*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15968*              MOVE ER-2727     TO WS-ERROR
 15969*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15970
 15971     IF PB-COMPANY-ID = 'ACE'
 15972       IF AH-COVERAGE-CANCELLED
 15973         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15974           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15975              MOVE ER-2732      TO WS-ERROR
 15976              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15977
 15978     IF PB-COMPANY-ID      EQUAL   'HER'
 15979        IF WS-ERROR        EQUAL   ER-2727
 15980            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15981            MOVE  ER-2725          TO  WS-ERROR
 15982            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15983
 15984     IF PB-C-CLAIM-CREATED-CANCEL
 15985            MOVE ER-2748         TO WS-ERROR
 15986            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15987
 15988     IF PB-C-LAST-NAME NOT = SPACES
 15989         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15990            MOVE ER-2747         TO WS-ERROR
 15991            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15992
 15993 3710-EDIT-LUMP-SUM-PRIOR.
 15994
 15995     IF AH-COVERAGE-CANCELLED
 15996         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15997             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15998                MOVE ER-2735    TO WS-ERROR
 15999                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16000
 16001     IF LF-COVERAGE-CANCELLED
 16002         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16003             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16004                MOVE ER-2735    TO WS-ERROR
 16005                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16006
 16007 3710-EDIT-PRIOR-DEATH.
 16008
 16009*    IF LF-COVERAGE-CANCELLED
 16010*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 289
* EL050.cbl
 16011*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16012*           (NOT PB-CI-OB)
 16013*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16014*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16015*                   MOVE ER-2732  TO WS-ERROR
 16016*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16017*
 16018*    IF AH-COVERAGE-CANCELLED
 16019*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16020*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16021*           (NOT PB-CI-OB)
 16022*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16023*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16024*                   MOVE ER-2732  TO WS-ERROR
 16025*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16026
 16027     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16028         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16029            (NOT PB-COMP-LF-CANCEL)
 16030             NEXT SENTENCE
 16031         ELSE
 16032           IF PB-C-LF-CANCEL-VOIDED
 16033              NEXT SENTENCE
 16034           ELSE
 16035              MOVE ER-2753      TO WS-ERROR
 16036              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16037
 16038     IF CANCEL-FUTURE-DT
 16039         GO TO 3999-END-EDIT.
 16040
 16041 3715-GET-REMAIN-TERM-LF.
 16042
 16043     IF NO-LF-BENEFIT-MATCH  OR
 16044        WS-LF-BENEFIT-CD = ZEROS
 16045        GO TO 3730-GET-AH-REMAIN-TERM.
 16046
 16047     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16048     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16049     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16050     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16051     MOVE PB-SV-STATE            TO CP-STATE.
 16052     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16053     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16054     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16055     MOVE '2'                    TO CP-PROCESS-TYPE.
 16056     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16057     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16058     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16059     IF (PB-COMPANY-ID = 'CID')
 16060        AND (CP-STATE-STD-ABBRV = 'WI')
 16061        MOVE '7'                 TO CP-REM-TERM-METHOD
 16062        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16063     ELSE
 16064        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16065        MOVE WS-REM-TRM-CALC-OPTION
 16066                                 TO CP-REM-TRM-CALC-OPTION
 16067     END-IF
 16068**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 290
* EL050.cbl
 16069     IF (PB-COMPANY-ID = 'CID')
 16070        AND (CP-STATE-STD-ABBRV = 'MO')
 16071        AND (PB-CERT-EFF-DT >= X'9B41')
 16072        AND (PB-CERT-EFF-DT <= X'A2FB')
 16073        MOVE '7'                 TO CP-REM-TERM-METHOD
 16074        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16075     END-IF
 16076     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16077                                    CP-LOAN-TERM.
 16078     IF CP-TRUNCATED-LIFE
 16079        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16080
 16081     IF CP-TERM-IS-DAYS
 16082         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16083     ELSE
 16084         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16085
 16086     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16087
 16088     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16089
 16090     IF LF-COVERAGE-CANCELLED
 16091        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16092        NEXT SENTENCE
 16093      ELSE
 16094          GO TO 3730-GET-AH-REMAIN-TERM.
 16095
 16096 3720-GET-LF-REFUND.
 16097
 16098     IF PB-C-LF-CANCEL-VOIDED
 16099        GO TO 3730-GET-AH-REMAIN-TERM
 16100     end-if
 16101
 16102     IF PB-COMPANY-ID EQUAL 'BOA'
 16103         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16104         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16105         GO TO 3730-GET-AH-REMAIN-TERM.
 16106
 16107     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16108        (WS-AH-SPECIAL-CALC-CD = 'M')
 16109         MOVE ER-2767            TO WS-ERROR
 16110         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16111         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16112         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16113         GO TO 3780-UPDATE-CANCEL-CERT.
 16114
 16115*    if (ws-lf-earnings-calc = '6')
 16116*       or (pb-c-lf-refund-override = '6')
 16117*       move cp-remaining-term-1 to cp-remaining-term-2
 16118*    end-if
 16119     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16120
 16121     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16122     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16123     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16124     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16125     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16126     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 291
* EL050.cbl
 16127     IF PB-COMPANY-ID = 'DCC'
 16128        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16129        IF PDEF-MASTER-FOUND
 16130           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16131              (V1 > +8)
 16132              OR (PD-PROD-CODE (V1) = 'L')
 16133           END-PERFORM
 16134           IF V1 < +9
 16135              MOVE PD-MAX-AMT (V1)
 16136                           TO CP-R-MAX-TOT-BEN
 16137                              EC-AM-LF-MAX-TOT-BEN
 16138           END-IF
 16139        ELSE
 16140        MOVE ' '                 TO PDEF-MASTER-SW
 16141        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16142        MOVE PB-STATE            TO ERPDEF-STATE
 16143        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16144           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16145        END-IF
 16146        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16147        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16148        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16149        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16150        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16151        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16152        IF PDEF-MASTER-FOUND
 16153           MOVE 'N'              TO PDEF-MASTER-SW
 16154           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16155           IF PDEF-MASTER-FOUND
 16156              IF (ERPDEF-KEY-SAVE (1:16) =
 16157                           PD-CONTROL-PRIMARY (1:16))
 16158                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16159                 CONTINUE
 16160              ELSE
 16161                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16162                 IF (ERPDEF-KEY-SAVE (1:16) =
 16163                           PD-CONTROL-PRIMARY (1:16))
 16164                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16165                    CONTINUE
 16166                 ELSE
 16167                    MOVE 'N'     TO PDEF-MASTER-SW
 16168                 END-IF
 16169              END-IF
 16170
 16171              IF PDEF-MASTER-FOUND
 16172                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16173                    (V1 > +8)
 16174                    OR (PD-PROD-CODE (V1) = 'L')
 16175                 END-PERFORM
 16176                 IF V1 < +9
 16177                    MOVE PD-MAX-AMT (V1)
 16178                                 TO CP-R-MAX-TOT-BEN
 16179                                    EC-AM-LF-MAX-TOT-BEN
 16180                 END-IF
 16181              END-IF
 16182           END-IF
 16183           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16184        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 292
* EL050.cbl
 16185        END-IF
 16186     END-IF
 16187     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16188
 16189     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16190
 16191     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16192                                    PB-C-LF-REM-TERM.
 16193
 16194     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16195     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16196
 16197     IF PB-COMPANY-ID EQUAL 'FLC'
 16198        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16199           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16200           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16201                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16202                    - CM-LF-ITD-DEATH-AMT
 16203           IF PB-C-LF-REF-CALC LESS THAN +0
 16204              MOVE +0            TO PB-C-LF-REF-CALC
 16205              GO TO 3730-GET-AH-REMAIN-TERM
 16206           ELSE
 16207              GO TO 3730-GET-AH-REMAIN-TERM.
 16208
 16209     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16210                            OR '4' OR '5' OR '6' OR '8'
 16211                            OR '9' OR 'G'
 16212        MOVE PB-C-LF-REFUND-OVERRIDE
 16213                                 TO CP-EARNING-METHOD.
 16214
 16215     if pb-company-id = 'AHL'
 16216        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16217        if cp-class-code = spaces
 16218           move zeros            to cp-class-code
 16219        end-if
 16220     ELSE
 16221        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16222     END-IF
 16223*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16224     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16225     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16226                                    CP-RATING-BENEFIT-AMT.
 16227     IF CP-STATE-STD-ABBRV = 'OR'
 16228         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16229                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16230     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16231     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16232     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16233     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16234     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16235     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16236     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16237     IF WS-DEFAULT-APR NOT NUMERIC
 16238         MOVE ZEROS TO WS-DEFAULT-APR.
 16239****   N O T E   ****
 16240*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16241*      THE OH HARD CODING IN ELCRFNDP
 16242
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 293
* EL050.cbl
 16243     IF PB-COMPANY-ID = 'CID'
 16244        IF CP-STATE-STD-ABBRV = 'OH'
 16245           MOVE WS-LF-EARNINGS-CALC
 16246                                 TO CP-EARNING-METHOD
 16247        END-IF
 16248     END-IF
 16249
 16250****   N O T E   ****
 16251
 16252     IF CP-EARN-AS-NET-PAY
 16253         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16254            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16255                MOVE WS-DEFAULT-APR
 16256                                 TO  CP-LOAN-APR
 16257                MOVE ER-3780     TO  WS-ERROR
 16258                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16259            ELSE
 16260                MOVE ER-3781     TO  WS-ERROR
 16261                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16262*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16263     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16264
 16265     IF CP-REFUND-TYPE-USED NOT = SPACE
 16266         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16267
 16268     IF CP-ERROR-RATE-IS-ZERO OR
 16269        CP-ERROR-RATE-NOT-FOUND
 16270        MOVE ER-2740             TO WS-ERROR
 16271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16272
 16273     IF CP-ERROR-RATE-FILE-NOTOPEN
 16274        MOVE ER-2617             TO WS-ERROR
 16275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16276
 16277     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16278        AND PB-CI-ENTRY-STATUS = 'M'
 16279        MOVE +0                  TO PB-C-LF-REF-CALC
 16280     ELSE
 16281        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16282     END-IF
 16283
 16284     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16285         GO TO 3730-GET-AH-REMAIN-TERM.
 16286
 16287*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16288*       ADD +1                   TO PB-C-LF-REM-TERM
 16289*                                   CP-REMAINING-TERM
 16290*                                   CP-ORIGINAL-TERM.
 16291
 16292     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16293     MOVE '2'                    TO CP-EARNING-METHOD
 16294                                    CP-RATING-METHOD.
 16295     IF PB-COMPANY-ID = 'CID'
 16296        IF (CP-STATE-STD-ABBRV = 'MN')
 16297           AND (PB-CERT-EFF-DT > X'A4FF')
 16298           AND (WS-LF-EARNINGS-CALC = 'B')
 16299           MOVE '5'              TO CP-EARNING-METHOD
 16300           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 294
* EL050.cbl
 16301        END-IF
 16302     END-IF
 16303     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16304                                        CP-REMAINING-BENEFIT
 16305                                        CP-RATING-BENEFIT-AMT.
 16306     IF CP-STATE-STD-ABBRV = 'OR'
 16307         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16308                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16309     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16310     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16311
 16312     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16313
 16314     IF CP-ERROR-RATE-IS-ZERO OR
 16315        CP-ERROR-RATE-NOT-FOUND
 16316        MOVE ER-2740             TO WS-ERROR
 16317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16318
 16319     IF CP-ERROR-RATE-FILE-NOTOPEN
 16320        MOVE ER-2617             TO WS-ERROR
 16321        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16322
 16323     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16324
 16325******************************************************************
 16326
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 295
* EL050.cbl
 16328 3730-GET-AH-REMAIN-TERM.
 16329     IF NO-AH-BENEFIT-MATCH  OR
 16330        WS-AH-BENEFIT-CD = ZEROS
 16331         GO TO 3770-CHECK-REFUNDS.
 16332
 16333     IF PB-CI-AH-LUMP-SUM-DISAB
 16334         IF  PB-C-AH-CANCEL-AMT = ZERO
 16335            IF NOT PB-COMP-AH-CANCEL
 16336             GO TO 3770-CHECK-REFUNDS.
 16337
 16338     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16339     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16340     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16341     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16342     MOVE PB-SV-STATE            TO CP-STATE.
 16343     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16344     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16345     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16346     MOVE '2'                    TO CP-PROCESS-TYPE.
 16347     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16348     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16349     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16350     IF (PB-COMPANY-ID = 'CID')
 16351        AND (CP-STATE-STD-ABBRV = 'WI')
 16352        MOVE '7'                 TO CP-REM-TERM-METHOD
 16353        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16354     ELSE
 16355        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16356        MOVE WS-REM-TRM-CALC-OPTION
 16357                                 TO CP-REM-TRM-CALC-OPTION
 16358     END-IF
 16359     IF (PB-COMPANY-ID = 'CID')
 16360        AND (CP-STATE-STD-ABBRV = 'MO')
 16361        AND (PB-CERT-EFF-DT >= X'9B41')
 16362        AND (PB-CERT-EFF-DT <= X'A2FB')
 16363        MOVE '7'                 TO CP-REM-TERM-METHOD
 16364        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16365     END-IF
 16366     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16367                                    CP-LOAN-TERM.
 16368     IF NOT CP-TERM-IS-DAYS
 16369         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16370
 16371     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16372
 16373     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16374
 16375     IF AH-COVERAGE-CANCELLED
 16376        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16377        NEXT SENTENCE
 16378      ELSE
 16379         GO TO 3770-CHECK-REFUNDS.
 16380
 16381 3740-GET-AH-REFUND.
 16382
 16383     IF PB-C-AH-CANCEL-VOIDED
 16384        GO TO 3780-UPDATE-CANCEL-CERT
 16385     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 296
* EL050.cbl
 16386
 16387     IF PB-COMPANY-ID = 'BOA'
 16388         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16389         GO TO 3770-CHECK-REFUNDS.
 16390
 16391     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16392*    MOVE ' '                    TO DC-OPTION-CODE
 16393     SET BIN-TO-GREG             TO TRUE
 16394     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16395     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16396                                    PB-C-AH-REM-TERM.
 16397     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16398     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16399
 16400     IF PB-COMPANY-ID EQUAL 'FLC'
 16401        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16402           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16403           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16404                    - CM-AH-ITD-AH-PMT)
 16405           IF PB-C-AH-REF-CALC LESS THAN +0
 16406              MOVE +0            TO PB-C-AH-REF-CALC
 16407              GO TO 3770-CHECK-REFUNDS
 16408           ELSE
 16409              GO TO 3770-CHECK-REFUNDS.
 16410
 16411     IF PB-COMPANY-ID = 'DCC'
 16412        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16413            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16414           MOVE 'S'              TO CP-EARNING-METHOD
 16415        END-IF
 16416     END-IF
 16417     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16418                            OR '4' OR '5' OR '6' OR '8'
 16419                            OR '9' OR 'G' OR 'S'
 16420        MOVE PB-C-AH-REFUND-OVERRIDE
 16421                                 TO CP-EARNING-METHOD.
 16422
 16423     if pb-company-id = 'AHL'
 16424        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16425        if cp-class-code = spaces
 16426           move zeros            to cp-class-code
 16427        end-if
 16428     ELSE
 16429        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16430     END-IF
 16431*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16432     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16433     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16434                                    CP-RATING-BENEFIT-AMT.
 16435     IF CP-STATE-STD-ABBRV = 'OR'
 16436         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16437                                         PB-CI-AH-TERM.
 16438     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16439     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16440     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16441     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16442     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16443     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 297
* EL050.cbl
 16444
 16445     IF CP-STATE-STD-ABBRV = 'OH'
 16446        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16447                                AND 'CID' AND 'DCC' and 'VPP'
 16448                                AND 'AHL')
 16449           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16450              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16451              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16452              MOVE '6' TO CP-EARNING-METHOD
 16453           END-IF
 16454        END-IF
 16455        IF PB-COMPANY-ID = 'CID'
 16456           IF NO-LIFE-COVERAGE
 16457              IF CP-CRITICAL-PERIOD
 16458                 MOVE '2'       TO CP-EARNING-METHOD
 16459              ELSE
 16460                 MOVE '6'       TO CP-EARNING-METHOD
 16461              END-IF
 16462           ELSE
 16463              IF WS-LF-COVERAGE-TYPE = 'L'
 16464                 MOVE '2'       TO CP-EARNING-METHOD
 16465              ELSE
 16466                 IF (PB-CI-LF-TERM > +60) OR
 16467                    (WS-LF-EARNINGS-CALC = '5')
 16468                    IF CP-CRITICAL-PERIOD
 16469                       MOVE '2'  TO CP-EARNING-METHOD
 16470                    ELSE
 16471                       MOVE '6'  TO CP-EARNING-METHOD
 16472                    END-IF
 16473                 ELSE
 16474                    MOVE '1'     TO CP-EARNING-METHOD
 16475                 END-IF
 16476              END-IF
 16477           END-IF
 16478        END-IF
 16479     END-IF
 16480
 16481*    IF CP-STATE-STD-ABBRV = 'VA'
 16482*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16483*          IF CP-ORIGINAL-TERM GREATER 61
 16484*             MOVE '6' TO CP-EARNING-METHOD
 16485*          ELSE
 16486*             MOVE '1' TO CP-EARNING-METHOD.
 16487
 16488     IF WS-DEFAULT-APR NOT NUMERIC
 16489         MOVE ZEROS TO WS-DEFAULT-APR.
 16490     IF CP-EARN-AS-NET-PAY
 16491         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16492            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16493                MOVE WS-DEFAULT-APR
 16494                                 TO  CP-LOAN-APR
 16495                MOVE ER-3780     TO  WS-ERROR
 16496                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16497            ELSE
 16498                MOVE ER-3781     TO  WS-ERROR
 16499                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16500     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16501     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 298
* EL050.cbl
 16502        AND CP-CANCEL-REASON = 'R'
 16503        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16504        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16505     END-IF
 16506     IF PB-COMPANY-ID = 'DCC'
 16507        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16508        AND (CP-EARNING-METHOD = 'D')
 16509        AND (CP-CANCEL-REASON NOT = 'R')
 16510        CONTINUE
 16511     ELSE
 16512        GO TO 3750-CONTINUE
 16513     END-IF
 16514     MOVE ' '                    TO DD-IU-SW
 16515     IF NOT PDEF-MASTER-FOUND
 16516        MOVE ' '                 TO PDEF-MASTER-SW
 16517        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16518        MOVE PB-STATE            TO ERPDEF-STATE
 16519        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16520           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16521        END-IF
 16522        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16523        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16524        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16525        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16526        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16527        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16528        IF PDEF-MASTER-FOUND
 16529           MOVE 'N'              TO PDEF-MASTER-SW
 16530           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16531           IF PDEF-MASTER-FOUND
 16532              IF (ERPDEF-KEY-SAVE (1:16) =
 16533                           PD-CONTROL-PRIMARY (1:16))
 16534                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16535                 CONTINUE
 16536              ELSE
 16537                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16538                 IF (ERPDEF-KEY-SAVE (1:16) =
 16539                           PD-CONTROL-PRIMARY (1:16))
 16540                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16541                    CONTINUE
 16542                 ELSE
 16543                    MOVE ER-2740 TO WS-ERROR
 16544                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16545                    GO TO 3770-CHECK-REFUNDS
 16546                 END-IF
 16547              END-IF
 16548           END-IF
 16549           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16550        END-IF
 16551     END-IF
 16552     IF PDEF-MASTER-FOUND
 16553        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16554           (V1 > +8)
 16555           OR (PD-PROD-CODE (V1) = 'I')
 16556        END-PERFORM
 16557        IF V1 < +9
 16558           SET DD-IU-PRESENT        TO TRUE
 16559        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 299
* EL050.cbl
 16560        IF WS-AH-DCC-TRUNC = 'T'
 16561           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16562        ELSE
 16563           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16564        END-IF
 16565        EVALUATE TRUE
 16566           WHEN WS-TERM > +168
 16567              MOVE 15               TO V1
 16568           WHEN WS-TERM > +156
 16569              MOVE 14               TO V1
 16570           WHEN WS-TERM > +144
 16571              MOVE 13               TO V1
 16572           WHEN WS-TERM > +132
 16573              MOVE 12               TO V1
 16574           WHEN WS-TERM > +120
 16575              MOVE 11               TO V1
 16576           WHEN WS-TERM > +108
 16577              MOVE 10               TO V1
 16578           WHEN WS-TERM > +96
 16579              MOVE 9                TO V1
 16580           WHEN WS-TERM > +84
 16581              MOVE 8                TO V1
 16582           WHEN WS-TERM > +72
 16583              MOVE 7                TO V1
 16584           WHEN WS-TERM > +60
 16585              MOVE 6                TO V1
 16586           WHEN WS-TERM > +48
 16587              MOVE 5                TO V1
 16588           WHEN WS-TERM > +36
 16589              MOVE 4                TO V1
 16590           WHEN WS-TERM > +24
 16591              MOVE 3                TO V1
 16592           WHEN WS-TERM > +12
 16593              MOVE 2                TO V1
 16594           WHEN OTHER
 16595              MOVE 1                TO V1
 16596        END-EVALUATE
 16597
 16598        EVALUATE TRUE
 16599*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16600*             < +13)
 16601*             AND (DD-IU-PRESENT)
 16602*             MOVE 2                TO V2
 16603*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16604*             MOVE 1                TO V2
 16605           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16606              MOVE 2                TO V2
 16607           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16608              MOVE 3                TO V2
 16609           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16610              MOVE 4                TO V2
 16611           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16612              MOVE 5                TO V2
 16613           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16614              MOVE 6                TO V2
 16615           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16616              MOVE 7                TO V2
 16617           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 300
* EL050.cbl
 16618              MOVE 8                TO V2
 16619           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16620              MOVE 9                TO V2
 16621           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16622              MOVE 10               TO V2
 16623           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16624              MOVE 11               TO V2
 16625           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16626              MOVE 12               TO V2
 16627           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16628              MOVE 13               TO V2
 16629           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16630              MOVE 14               TO V2
 16631           WHEN OTHER
 16632              MOVE 15               TO V2
 16633        END-EVALUATE
 16634
 16635        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16636                                 TO CP-DDF-LO-FACT
 16637        MOVE PD-UEP-FACTOR (V1 V2)
 16638                                 TO CP-DDF-HI-FACT
 16639
 16640        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16641        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16642        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16643           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16644        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16645        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16646        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16647           + PD-1ST-YR-ADMIN-ALLOW
 16648
 16649        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16650*       IF PI-CLP-YN = 'Y'
 16651*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16652*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16653*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16654*       END-IF
 16655
 16656        IF DD-IU-PRESENT
 16657           MOVE 'I'              TO CP-EARNING-METHOD
 16658        END-IF
 16659        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16660                                     CP-CLP-RATE-UP
 16661        IF CP-IU-RATE-UP NOT = ZEROS
 16662           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16663              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16664           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16665              / (1 - WS-WORK-FACT)
 16666        END-IF
 16667     END-IF
 16668     .
 16669 3750-CONTINUE.
 16670     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16671
 16672     IF CP-REFUND-TYPE-USED NOT = SPACE
 16673         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16674
 16675     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 301
* EL050.cbl
 16676        CP-ERROR-RATE-NOT-FOUND
 16677        MOVE ER-2740             TO WS-ERROR
 16678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16679
 16680     IF CP-ERROR-RATE-FILE-NOTOPEN
 16681        MOVE ER-2617             TO WS-ERROR
 16682        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16683     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16684        AND PB-CI-ENTRY-STATUS = 'M'
 16685        MOVE +0                  TO PB-C-AH-REF-CALC
 16686     ELSE
 16687        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16688     END-IF
 16689     if pb-company-id = 'VPP'
 16690        MOVE cm-ah-clp           to cp-original-premium
 16691        move zeros               to cp-calc-refund
 16692        perform 7600-get-refund  thru 7600-exit
 16693        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 16694           move cp-calc-refund   to pb-c-ah-rfnd-clp
 16695        else
 16696           move zeros            to pb-c-ah-rfnd-clp
 16697        end-if
 16698        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 16699           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 16700           pb-ci-cancel-fee
 16701     end-if
 16702     IF PB-COMPANY-ID = 'DCC'
 16703        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16704        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16705        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16706        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16707        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16708        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16709        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16710        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16711*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16712     END-IF
 16713     .
 16714 3770-CHECK-REFUNDS.
 16715
 16716     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16717        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16718           MOVE ER-2766          TO WS-ERROR
 16719           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16720           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16721           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16722              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16723
 16724     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16725        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16726           MOVE ER-2766          TO WS-ERROR
 16727           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16728           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16729           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16730              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16731
 16732     IF PB-COMP-LF-CANCEL
 16733        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 302
* EL050.cbl
 16734        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16735           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16736              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16737
 16738     IF PB-COMP-AH-CANCEL
 16739        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16740        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16741           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16742              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16743
 16744     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16745             GIVING WS-UNSIGN-WRK1
 16746     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16747             GIVING WS-UNSIGN-WRK2.
 16748
 16749     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16750         MOVE ZERO TO WS-UNSIGN-WRK1.
 16751
 16752     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16753         MOVE ZERO TO WS-UNSIGN-WRK2.
 16754
 16755     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16756
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 303
* EL050.cbl
 16758
 16759 3772-CONTINUE.
 16760
 16761**********************************
 16762*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16763*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16764*** DOUBLES THE TOLERANCE AMOUNT.
 16765***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16766**********************************
 16767     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 16768     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16769         IF WS-REF-REJECT-SW = SPACE
 16770             MOVE ER-2754        TO WS-ERROR
 16771             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16772           ELSE
 16773             MOVE ER-2736        TO WS-ERROR
 16774             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16775**********************************
 16776
 16777 3773-CONTINUE.
 16778
 16779     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16780        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16781           MOVE ER-2723          TO WS-ERROR
 16782           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16783
 16784     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16785        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16786           MOVE ER-2724          TO WS-ERROR
 16787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16788
 16789     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16790         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16791             (1 + WS-LF-REFUND-OVS-PCT)
 16792     ELSE
 16793         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16794
 16795     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16796         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16797             (1 - WS-TOL-LF-REFUND-PCT)
 16798     ELSE
 16799         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16800
 16801     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16802        AND (PB-CI-ENTRY-STATUS = 'M')
 16803        AND (PB-C-LF-CANCEL-AMT > +0)
 16804        MOVE ER-3843             TO WS-ERROR
 16805        PERFORM 9900-ERROR-FORMAT
 16806                                 THRU 9900-EXIT
 16807     END-IF
 16808     EVALUATE TRUE
 16809        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16810           CONTINUE
 16811        WHEN PB-C-LF-CANCEL-AMT = +0
 16812                 AND PB-C-LF-REF-CALC > +0
 16813           CONTINUE
 16814        WHEN WS-LF-REFUND-OVS-AMT = 0
 16815                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 304
* EL050.cbl
 16816           CONTINUE
 16817        WHEN OTHER
 16818           IF WS-TOL-LF-REFUND  = +0
 16819              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16820           END-IF
 16821           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16822                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16823                          (PB-C-LF-CANCEL-AMT))
 16824              CONTINUE
 16825           ELSE
 16826              IF WS-LF-REFUND-OVS-AMT = +0
 16827                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16828              END-IF
 16829              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16830                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16831                                       PB-C-LF-CANCEL-AMT)
 16832                 CONTINUE
 16833              ELSE
 16834                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16835                   MOVE ER-2754   TO  WS-ERROR
 16836                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16837                 ELSE
 16838                    MOVE ER-2736   TO  WS-ERROR
 16839                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16840                 END-IF
 16841              END-IF
 16842           END-IF
 16843     END-EVALUATE.
 16844
 16845     EVALUATE TRUE
 16846        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16847           CONTINUE
 16848        WHEN PB-C-LF-CANCEL-AMT = +0
 16849                 AND PB-C-LF-REF-CALC > +0
 16850           CONTINUE
 16851        WHEN OTHER
 16852           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16853               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16854              CONTINUE
 16855           ELSE
 16856              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16857               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16858                CONTINUE
 16859              ELSE
 16860                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16861                     MOVE ER-2754   TO  WS-ERROR
 16862                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16863                 ELSE
 16864                     MOVE ER-2736   TO  WS-ERROR
 16865                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16866                 END-IF
 16867              END-IF
 16868           END-IF
 16869     END-EVALUATE.
 16870
 16871     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16872         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16873             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 305
* EL050.cbl
 16874     ELSE
 16875         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16876
 16877     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16878         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16879             (1 - WS-TOL-AH-REFUND-PCT)
 16880     ELSE
 16881         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16882
 16883     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16884        AND (PB-CI-ENTRY-STATUS = 'M')
 16885        AND (PB-C-AH-CANCEL-AMT > +0)
 16886        MOVE ER-3843             TO WS-ERROR
 16887        PERFORM 9900-ERROR-FORMAT
 16888                                 THRU 9900-EXIT
 16889     END-IF
 16890     EVALUATE TRUE
 16891        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16892           CONTINUE
 16893*       WHEN PB-C-AH-REF-CALC = +0 AND
 16894*                  PB-C-AH-CANCEL-AMT > +0
 16895        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16896                   PB-C-AH-REF-CALC > +0
 16897           CONTINUE
 16898        WHEN WS-AH-REFUND-OVS-AMT = +0
 16899                AND WS-TOL-AH-REFUND = +0
 16900           CONTINUE
 16901        WHEN OTHER
 16902           IF WS-TOL-AH-REFUND = +0
 16903              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16904           END-IF
 16905           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16906               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16907                                         PB-C-AH-CANCEL-AMT)
 16908              CONTINUE
 16909           ELSE
 16910              IF WS-AH-REFUND-OVS-AMT = +0
 16911                 MOVE +9999999.99 TO
 16912                         WS-AH-REFUND-OVS-AMT
 16913              END-IF
 16914              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16915                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16916                                         PB-C-AH-CANCEL-AMT)
 16917                 CONTINUE
 16918              ELSE
 16919                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16920                    MOVE ER-2754   TO  WS-ERROR
 16921                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16922                 ELSE
 16923                    MOVE ER-2736   TO  WS-ERROR
 16924                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16925                 END-IF
 16926              END-IF
 16927           END-IF
 16928     END-EVALUATE.
 16929
 16930     EVALUATE TRUE
 16931        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 306
* EL050.cbl
 16932           CONTINUE
 16933*       WHEN PB-C-AH-REF-CALC > +0 AND
 16934*                  PB-C-AH-CANCEL-AMT = +0
 16935        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16936                   PB-C-AH-REF-CALC = +0
 16937           CONTINUE
 16938        WHEN OTHER
 16939           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16940               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16941              CONTINUE
 16942           ELSE
 16943              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16944                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16945                 CONTINUE
 16946              ELSE
 16947                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16948                     MOVE ER-2754   TO  WS-ERROR
 16949                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16950                 ELSE
 16951                     MOVE ER-2736   TO  WS-ERROR
 16952                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16953                 END-IF
 16954              END-IF
 16955           END-IF
 16956     END-EVALUATE.
 16957
 16958     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16959        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16960        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16961           AND  PB-C-LF-REF-CALC < +1.00
 16962           AND  PB-C-AH-REF-CALC < +1.00
 16963           CONTINUE
 16964        ELSE
 16965           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16966              AND (PB-CI-ENTRY-STATUS = 'M')
 16967              CONTINUE
 16968           ELSE
 16969              MOVE ER-2741       TO WS-ERROR
 16970              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16971           END-IF
 16972        END-IF
 16973     END-IF
 16974
 16975     IF (PB-C-LF-CANCEL-AMT = ZERO
 16976        AND WS-LF-BENEFIT-CD NOT = ZERO
 16977        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16978        AND PB-C-LF-REF-CALC NOT = ZERO)
 16979        OR
 16980        (PB-C-LF-CANCEL-AMT = ZERO
 16981        AND WS-LF-BENEFIT-CD NOT = ZERO
 16982        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16983             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16984                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16985                NEXT SENTENCE
 16986             ELSE
 16987                MOVE ER-2739        TO WS-ERROR
 16988                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16989
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 307
* EL050.cbl
 16990     IF (PB-C-AH-CANCEL-AMT = ZERO
 16991        AND WS-AH-BENEFIT-CD NOT = ZERO
 16992        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16993        AND PB-C-AH-REF-CALC NOT = ZERO)
 16994        OR
 16995        (PB-C-AH-CANCEL-AMT = ZERO
 16996        AND WS-AH-BENEFIT-CD NOT = ZERO
 16997        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16998             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16999                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17000                NEXT SENTENCE
 17001             ELSE
 17002                MOVE ER-2738        TO WS-ERROR
 17003                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17004
 17005 3775-OVER-REF-CHK.
 17006
 17007     IF PB-CI-ENTRY-STATUS = '5'
 17008        GO TO 3780-UPDATE-CANCEL-CERT.
 17009
 17010     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17011                              PB-CI-LF-ALT-PREMIUM-AMT.
 17012
 17013     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17014        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17015                                 PB-C-LF-REF-CALC
 17016      ELSE
 17017        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17018                                 PB-C-LF-CANCEL-AMT.
 17019
 17020     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17021        MOVE ER-2755             TO WS-ERROR
 17022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17023
 17024     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17025
 17026     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17027        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17028                                 PB-C-AH-REF-CALC
 17029      ELSE
 17030        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17031                                 PB-C-AH-CANCEL-AMT.
 17032
 17033     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17034        MOVE ER-2778             TO WS-ERROR
 17035        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17036
 17037     IF PB-CI-OB-FLAG NOT = 'Z'
 17038        NEXT SENTENCE
 17039       ELSE
 17040         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17041            MOVE ER-2757           TO WS-ERROR
 17042            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17043
 17044 3780-UPDATE-CANCEL-CERT.
 17045
 17046     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17047        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 308
* EL050.cbl
 17048        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17049
 17050     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17051         MOVE ER-2729              TO WS-ERROR
 17052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17053
 17054     IF PB-CI-LF-BENEFIT-CD = ZERO
 17055         GO TO 3780-UPDATE-CONT-1.
 17056
 17057     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17058         GO TO 3780-UPDATE-CONT-1.
 17059
 17060     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17061       AND
 17062        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17063       AND
 17064        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17065       AND
 17066        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17067            NEXT SENTENCE
 17068       ELSE
 17069        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17070          AND
 17071***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17072***       AND
 17073           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17074            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17075               MOVE ER-2730      TO WS-ERROR
 17076               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17077               GO TO 3999-END-EDIT
 17078            ELSE
 17079               GO TO 3999-END-EDIT
 17080        ELSE
 17081            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17082               MOVE ER-2765           TO WS-ERROR
 17083               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17084               GO TO 3785-CHECK-NH.
 17085*              GO TO 3999-END-EDIT.
 17086
 17087 3780-UPDATE-CONT-1.
 17088     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17089
 17090     IF PB-CI-AH-BENEFIT-CD = ZERO
 17091         GO TO 3780-UPDATE-CONT-2.
 17092
 17093     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17094         GO TO 3780-UPDATE-CONT-2.
 17095
 17096     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17097
 17098     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17099       AND
 17100        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17101       AND
 17102        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17103       AND
 17104        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17105            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 309
* EL050.cbl
 17106       ELSE
 17107        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17108          AND
 17109***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17110***       AND
 17111           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17112           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17113            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17114               MOVE ER-2773      TO WS-ERROR
 17115               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17116               GO TO 3999-END-EDIT
 17117            ELSE
 17118               GO TO 3999-END-EDIT
 17119            END-IF
 17120           ELSE
 17121             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17122                IF MSTR-CERT-NO = W-CL-CERT-NO
 17123                   MOVE ER-2890 TO WS-ERROR
 17124                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17125                   GO TO 3999-END-EDIT
 17126                ELSE
 17127                   MOVE ER-2898 TO WS-ERROR
 17128                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17129                   GO TO 3999-END-EDIT
 17130                END-IF
 17131             ELSE
 17132                GO TO 3785-CHECK-NH
 17133             END-IF
 17134           END-IF
 17135          ELSE
 17136            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17137              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17138                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17139                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17140                      MOVE ER-2890 TO WS-ERROR
 17141                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17142                      GO TO 3999-END-EDIT
 17143                   ELSE
 17144                      MOVE ER-2898 TO WS-ERROR
 17145                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17146                      GO TO 3999-END-EDIT
 17147                   END-IF
 17148                ELSE
 17149                   MOVE ER-2765 TO WS-ERROR
 17150                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17151                   GO TO 3785-CHECK-NH
 17152                END-IF
 17153              ELSE
 17154               MOVE ER-2765      TO WS-ERROR
 17155               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17156               GO TO 3785-CHECK-NH.
 17157*              GO TO 3999-END-EDIT.
 17158
 17159 3780-UPDATE-CONT-2.
 17160
 17161     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17162        AND WS-LF-BENEFIT-CD = ZERO
 17163           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 310
* EL050.cbl
 17164           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17165
 17166     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17167        AND WS-AH-BENEFIT-CD = ZERO
 17168           MOVE ER-2744           TO WS-ERROR
 17169           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17170
 17171     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17172        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17173        AND
 17174        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17175         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17176           MOVE ER-2746           TO WS-ERROR
 17177           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17178
 17179     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17180       AND
 17181        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17182             MOVE ER-2737        TO WS-ERROR
 17183             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17184
 17185     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17186       AND
 17187        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17188             MOVE ER-2737        TO WS-ERROR
 17189             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17190
 17191     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17192         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17193             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17194             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17195         ELSE
 17196             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17197                 MOVE ER-2768    TO WS-ERROR
 17198                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17199             ELSE
 17200                 MOVE ER-2756    TO WS-ERROR
 17201                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17202
 17203     IF CERT-PEND-ISSUE-RETURNED
 17204        MOVE ER-2772             TO WS-ERROR
 17205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17206 3785-CHECK-NH.
 17207*    IF PB-STATE NOT = 'NH' and 'TN'
 17208     IF PB-STATE NOT = 'NH'
 17209        GO TO 3999-END-EDIT
 17210     END-IF
 17211
 17212     MOVE ER-2796                TO WS-ERROR
 17213     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17214     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17215        OR (CM-NH-INTERFACE-SW = 'Y')
 17216        MOVE ER-2793             TO WS-ERROR
 17217        PERFORM 9900-ERROR-FORMAT
 17218                                 THRU 9900-EXIT
 17219     END-IF
 17220     MOVE +0                     TO WS-PAYMENT-AMT
 17221     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 311
* EL050.cbl
 17222        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17223               PB-C-AH-CANCEL-DT
 17224           GO TO 3999-END-EDIT
 17225        END-IF
 17226     end-if
 17227***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17228***-_-
 17229***-_-   For TN it's only flat cancels
 17230***-_-
 17231***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17232     if pb-state = 'TN'
 17233        if ((pb-c-lf-cancel-dt <> low-values)
 17234           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17235                      or
 17236           ((pb-c-ah-cancel-dt <> low-values)
 17237           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17238           GO TO 3999-END-EDIT
 17239        END-IF
 17240     end-if
 17241     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17242        GO TO 3999-END-EDIT
 17243     END-IF
 17244***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17245***-_-
 17246***-_-   if cancel date within 15 days of effective date, bypass
 17247***-_-
 17248***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17249     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17250     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17251     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17252        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17253     END-IF
 17254     MOVE '1'                    TO DC-OPTION-CODE
 17255     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17256     IF NO-CONVERSION-ERROR
 17257        and pb-state = 'NH'
 17258        IF DC-ELAPSED-DAYS < +16
 17259           GO TO 3999-END-EDIT
 17260        END-IF
 17261     END-IF
 17262***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17263***-_-
 17264***-_-   if cancel date within 30 days of current date then
 17265***-_-   bypass else subtract 15 days from period
 17266***-_-
 17267***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17268     MOVE +0                     TO DC-ELAPSED-DAYS
 17269     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17270     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17271     MOVE '1'                    TO DC-OPTION-CODE
 17272     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17273     IF NO-CONVERSION-ERROR
 17274        IF DC-ELAPSED-DAYS > +30
 17275           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17276        ELSE
 17277           GO TO 3999-END-EDIT
 17278        END-IF
 17279     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 312
* EL050.cbl
 17280        GO TO 3999-END-EDIT
 17281     END-IF
 17282***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17283***-_-
 17284***-_-   'NH' is 10%, TN is 3.5%
 17285***-_-
 17286***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17287     if pb-state = 'NH'
 17288        move +1.10               to ws-work-rate
 17289     else
 17290        move +1.035              to ws-work-rate
 17291     end-if
 17292     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17293        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17294           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17295     IF WS-PAYMENT-AMT < 600.00
 17296        GO TO 3999-END-EDIT
 17297     END-IF
 17298     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17299
 17300     IF (ERMAIL-FOUND = ' ')
 17301         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17302         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17303        GO TO 3999-END-EDIT
 17304     END-IF
 17305     MOVE ER-2795                TO WS-ERROR
 17306     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17307
 17308     GO TO 3999-END-EDIT.
 17309******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 313
* EL050.cbl
 17311 3990-FILES-NOT-OPEN.
 17312
 17313     MOVE ER-2617                TO WS-ERROR.
 17314     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17315     GO TO 9990-RETURN.
 17316
 17317 3999-END-EDIT.
 17318
 17319     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17320
 17321     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17322         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17323         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17324             PERFORM 9250-UNLOCK-RETURN
 17325             GO TO 9990-RETURN
 17326          ELSE
 17327             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17328             GO TO 9990-RETURN.
 17329
 17330     IF PB-CANCELLATION
 17331          GO TO 9990-RETURN.
 17332
 17333     IF CERT-WAS-NOT-FOUND
 17334        MOVE SPACES              TO CERTIFICATE-MASTER.
 17335
 17336     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17337
 17338     IF CERT-WAS-FOUND
 17339         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17340             PERFORM 9250-UNLOCK-RETURN
 17341          ELSE
 17342            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17343      ELSE
 17344         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17345
 17346     if pb-company-id = 'VPP'
 17347        perform 8150-read-elcrtt thru 8150-exit
 17348        if ws-vehicle-odometer numeric
 17349           if ws-vehicle-odometer > 6000
 17350              move er-1583       to ws-error
 17351              PERFORM 9900-ERROR-FORMAT
 17352                                 THRU 9900-EXIT
 17353           end-if
 17354        end-if
 17355     end-if
 17356     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17357        IF ((PB-COMPANY-ID = 'DCC')
 17358           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17359                         or
 17360            (pb-company-id = 'CID' or 'VPP')
 17361            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17362        END-IF
 17363     END-IF.
 17364
 17365     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17366         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17367     END-IF.
 17368     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 314
* EL050.cbl
 17369     perform 8150-read-elcrtt    thru 8150-exit
 17370     if ws-ins-age-defaulted = 'Y'
 17371        move er-1573             to ws-error
 17372        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17373     end-if
 17374
 17375     if ws-jnt-age-defaulted = 'Y'
 17376        move er-1574             to ws-error
 17377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17378     end-if
 17379***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17380***                                                           ****
 17381***  Set an error if the state requires verification of agent ****
 17382***  and agent hasn't verified yet and the status is not =    ****
 17383***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17384***  and the entry date > 09/01/2015.                         ****
 17385***                                                           ****
 17386***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17387     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17388        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17389        and (pb-account (9:2) not = 'OB')
 17390        if (ws-st-agent-sig-edit = 'Y')
 17391           and (am-report-code-1 not = 'CONLEY')
 17392           evaluate true
 17393              when cs-agent-edit-status = 'C'
 17394                 move er-1743    to ws-error
 17395                 perform 9900-error-format
 17396                                 thru 9900-exit
 17397              when cs-agent-edit-status = 'S'
 17398                 move er-1744    to ws-error
 17399                 perform 9900-error-format
 17400                                 thru 9900-exit
 17401              when cs-agent-edit-status = 'M'
 17402                 move er-1745    to ws-error
 17403                 perform 9900-error-format
 17404                                 thru 9900-exit
 17405              when cs-agent-edit-status = 'R'
 17406                 move er-1747    to ws-error
 17407                 perform 9900-error-format
 17408                                 thru 9900-exit
 17409              when cs-agent-edit-status = 'N'
 17410                 move er-1748    to ws-error
 17411                 perform 9900-error-format
 17412                                 thru 9900-exit
 17413              when cs-agent-edit-status <> 'V' and 'U' and
 17414                                           'R' and 'N'
 17415                 move er-1746    to ws-error
 17416                 perform 9900-error-format
 17417                                 thru 9900-exit
 17418           end-evaluate
 17419        end-if
 17420     end-if
 17421     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17422     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17423        AND (WS-NO-SECURE-PAY))
 17424                  OR
 17425        (WS-LF-SPECIAL-CALC-CD = 'O'
 17426        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 315
* EL050.cbl
 17427        SET SKIP-ADDR-EDIT       TO TRUE
 17428     END-IF
 17429     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17430        AND (NOT SKIP-ADDR-EDIT)
 17431        MOVE ER-2963             TO WS-ERROR
 17432        PERFORM 9900-ERROR-FORMAT
 17433                                 THRU 9900-EXIT
 17434        GO TO 9990-RETURN
 17435     END-IF
 17436     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17437     IF ERPNDM-FOUND NOT = 'X'
 17438        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17439           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17440           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17441           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17442           AND (NOT SKIP-ADDR-EDIT)
 17443           MOVE ER-2694          TO WS-ERROR
 17444           PERFORM 9900-ERROR-FORMAT
 17445                                 THRU 9900-EXIT
 17446        END-IF
 17447        MOVE ' '                 TO STATE-RECORD-ERROR
 17448        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17449        MOVE PM-STATE            TO CNTL-ACCESS
 17450        MOVE '3'                 TO CNTL-REC-TYPE
 17451        MOVE +0                  TO CNTL-SEQ-NO
 17452        MOVE '0'                 TO RC-SW-2
 17453        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17454        IF (NO-STATE-RECORD)
 17455           OR (CF-RECORD-TYPE NOT = '3')
 17456           OR (PM-STATE NOT = CF-STATE-CODE)
 17457           IF (PM-STATE = SPACES)
 17458              AND (SKIP-ADDR-EDIT)
 17459              CONTINUE
 17460           ELSE
 17461              MOVE ER-2963       TO WS-ERROR
 17462              PERFORM 9900-ERROR-FORMAT
 17463                                 THRU 9900-EXIT
 17464           END-IF
 17465        END-IF
 17466        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17467           MOVE ER-2883          TO WS-ERROR
 17468           PERFORM 9900-ERROR-FORMAT
 17469                                 THRU 9900-EXIT
 17470        END-IF
 17471        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17472           MOVE ' '                 TO STATE-RECORD-ERROR
 17473           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17474           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17475           MOVE '3'                 TO CNTL-REC-TYPE
 17476           MOVE +0                  TO CNTL-SEQ-NO
 17477           MOVE '0'                 TO RC-SW-2
 17478           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17479           IF NO-STATE-RECORD
 17480              OR (CF-RECORD-TYPE NOT = '3')
 17481              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17482              MOVE ER-2964          TO WS-ERROR
 17483              PERFORM 9900-ERROR-FORMAT
 17484                                    THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 316
* EL050.cbl
 17485           END-IF
 17486        END-IF
 17487     ELSE
 17488        IF NOT SKIP-ADDR-EDIT
 17489           MOVE ER-2393          TO WS-ERROR
 17490           PERFORM 9900-ERROR-FORMAT
 17491                                 THRU 9900-EXIT
 17492        END-IF
 17493     END-IF
 17494
 17495     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17496
 17497     IF (ERMAIL-FOUND = ' ' AND
 17498        ERPNDM-FOUND = ' ')
 17499        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17500           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17501           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17502          OR
 17503           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17504          OR
 17505           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17506           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17507           GO TO 3999-UNLOCK-ERMAIL.
 17508
 17509     IF ERPNDM-FOUND = 'X'
 17510        GO TO 3999-UNLOCK-ERMAIL.
 17511
 17512     IF PM-INSURED-LAST-NAME      = SPACES
 17513        AND PM-INSURED-FIRST-NAME = SPACES
 17514        AND PM-ADDRESS-LINE-1     = SPACES
 17515        AND PM-ADDRESS-LINE-2     = SPACES
 17516        AND PM-CITY-STATE         = SPACES
 17517        AND PM-CRED-BENE-NAME     = SPACES
 17518        AND PM-CRED-BENE-ADDR     = SPACES
 17519        AND PM-CRED-BENE-CTYST    = SPACES
 17520        GO TO 3999-UNLOCK-ERMAIL
 17521     END-IF
 17522
 17523     MOVE SPACES                 TO MAILING-DATA.
 17524
 17525     MOVE 'MA'                   TO MA-RECORD-ID.
 17526     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17527     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17528     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17529     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17530     MOVE PB-SV-STATE            TO MA-STATE.
 17531     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17532     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17533
 17534     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17535     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17536
 17537     IF ERMAIL-FOUND = ' '
 17538        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17539     ELSE
 17540        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17541        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17542        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 317
* EL050.cbl
 17543
 17544     GO TO 9990-RETURN.
 17545
 17546 3999-UNLOCK-ERMAIL.
 17547     IF ERMAIL-FOUND = ' '
 17548        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17549
 17550     GO TO 9990-RETURN.
 17551******************************************************************
 17552
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 318
* EL050.cbl
 17554 4000-UPDATE-CANCELLED-CERT.
 17555     IF CERT-WAS-NOT-FOUND
 17556        GO TO 4299-EXIT.
 17557
 17558*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17559     IF PB-C-NH-INT-ON-REFS > ZEROS
 17560        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17561     END-IF
 17562     IF PB-C-REF-INTERFACE-SW = 'Y'
 17563        MOVE PB-C-REF-INTERFACE-SW
 17564                                 TO CM-NH-INTERFACE-SW
 17565     END-IF
 17566     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17567     IF ERMAIL-FOUND = 'X'
 17568        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17569        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17570        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17571        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17572           MOVE ER-2694          TO WS-ERROR
 17573           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17574     END-IF
 17575
 17576     IF PB-C-POST-CARD-IND = 'Y'
 17577        MOVE +8                  TO SUB
 17578*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17579        IF ERMAIL-FOUND = ' '
 17580           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17581              (SUB > +7)
 17582              OR (MA-MAIL-STATUS (SUB) = '1')
 17583           END-PERFORM
 17584        END-IF
 17585        IF (SUB > +7)
 17586           OR (ERMAIL-FOUND = 'X')
 17587           MOVE ER-3789          TO WS-ERROR
 17588           PERFORM 9900-ERROR-FORMAT
 17589                                 THRU 9900-EXIT
 17590        END-IF
 17591     ELSE
 17592        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17593     END-IF
 17594
 17595     IF ERMAIL-FOUND = ' '
 17596        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17597     END-IF.
 17598
 17599     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17600
 17601     IF PB-CI-OB-FLAG = 'Z'
 17602        GO TO 4150-SUMMARY-CERT-CANCEL.
 17603
 17604     IF PB-C-LF-CANCEL-VOIDED
 17605         PERFORM 4200-REVERSE-LF-CANCEL.
 17606     IF PB-C-AH-CANCEL-VOIDED
 17607         PERFORM 4200-REVERSE-AH-CANCEL.
 17608
 17609 4100-APPLY-LF-CANCEL.
 17610
 17611     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 319
* EL050.cbl
 17612
 17613 4100-CHECK-LF-ERRORS.
 17614
 17615     ADD +1                       TO WS-SUB.
 17616
 17617     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17618        IF LF-COVERAGE-CANCELLED
 17619           GO TO 4100-LF-CANCEL-CONT
 17620        ELSE
 17621           GO TO 4100-UPDATE-LF-COVERAGE.
 17622
 17623     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17624                                   ER-2729 OR
 17625                                   ER-2730 OR
 17626                                   ER-2731 OR
 17627                                   ER-2732 OR
 17628                                   ER-2737 OR
 17629                                   ER-2740 OR
 17630                                   ER-2743 OR
 17631                                   ER-2749 OR
 17632                                   ER-2750 OR
 17633                                   ER-2755 OR
 17634                                   ER-2757 OR
 17635                                   ER-2760 OR
 17636                                   ER-2772 OR
 17637                                   ER-2774 OR
 17638                                   ER-2776 OR
 17639                                   ER-2794
 17640        GO TO 4100-UPDATE-LF-COVERAGE.
 17641
 17642     GO TO 4100-CHECK-LF-ERRORS.
 17643
 17644 4100-UPDATE-LF-COVERAGE.
 17645
 17646     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17647     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17648     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17649        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17650     END-IF
 17651     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17652                                      TO CM-CREDIT-INTERFACE-SW-2.
 17653     IF CM-LF-CANCEL-DT = LOW-VALUE
 17654         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17655
 17656     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17657         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17658                                         CM-LF-STATUS-AT-CANCEL.
 17659
 17660     GO TO 4100-APPLY-AH-CANCEL.
 17661
 17662 4100-LF-CANCEL-CONT.
 17663     IF PB-C-LF-CANCEL-VOIDED
 17664         GO TO 4100-APPLY-AH-CANCEL.
 17665
 17666     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17667         GO TO 4100-APPLY-AH-CANCEL.
 17668
 17669     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 320
* EL050.cbl
 17670        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17671           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17672        ELSE
 17673           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17674
 17675     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17676     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17677
 17678     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17679         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17680
 17681     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17682        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17683         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17684         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17685
 17686     IF PB-RECORD-RETURNED
 17687        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17688      ELSE
 17689        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17690
 17691 4100-APPLY-AH-CANCEL.
 17692
 17693     MOVE +0                      TO WS-SUB.
 17694
 17695 4100-CHECK-AH-ERRORS.
 17696
 17697     ADD +1                       TO WS-SUB.
 17698
 17699     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17700        IF AH-COVERAGE-CANCELLED
 17701           GO TO 4100-AH-CANCEL-CONT
 17702        ELSE
 17703           GO TO 4100-UPDATE-AH-COVERAGE.
 17704
 17705     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17706                                   ER-2729 OR
 17707                                   ER-2732 OR
 17708                                   ER-2737 OR
 17709                                   ER-2740 OR
 17710                                   ER-2744 OR
 17711                                   ER-2749 OR
 17712                                   ER-2750 OR
 17713                                   ER-2755 OR
 17714                                   ER-2757 OR
 17715                                   ER-2760 OR
 17716                                   ER-2771 OR
 17717                                   ER-2772 OR
 17718                                   ER-2773 OR
 17719                                   ER-2775 OR
 17720                                   ER-2777 OR
 17721                                   ER-2778 OR
 17722                                   ER-2794
 17723        GO TO 4100-UPDATE-AH-COVERAGE.
 17724
 17725     GO TO 4100-CHECK-AH-ERRORS.
 17726
 17727 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 321
* EL050.cbl
 17728
 17729     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17730     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17731     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17732     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17733                                      TO CM-CREDIT-INTERFACE-SW-2.
 17734     IF CM-AH-CANCEL-DT = LOW-VALUE
 17735         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17736
 17737     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17738         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17739                                         CM-AH-STATUS-AT-CANCEL.
 17740
 17741     IF LF-COVERAGE-CANCELLED
 17742         IF PB-RECORD-RETURNED
 17743              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17744          ELSE
 17745              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17746
 17747     GO TO 4299-EXIT.
 17748
 17749 4100-AH-CANCEL-CONT.
 17750     IF PB-C-AH-CANCEL-VOIDED
 17751         GO TO 4299-EXIT.
 17752
 17753     if cm-credit-interface-sw-2 = ' '
 17754        if pb-fatal-errors or pb-unforced-errors
 17755           move '4'              to cm-credit-interface-sw-2
 17756        else
 17757           move '1'              to cm-credit-interface-sw-2
 17758        end-if
 17759     end-if
 17760     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17761         GO TO 4299-EXIT.
 17762
 17763     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17764        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17765           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17766        ELSE
 17767           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17768
 17769     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17770     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17771
 17772     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17773         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17774
 17775     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17776         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17777         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17778
 17779     IF PB-RECORD-RETURNED
 17780        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17781      ELSE
 17782        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17783
 17784     GO TO 4299-EXIT.
 17785
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 322
* EL050.cbl
 17786 4150-SUMMARY-CERT-CANCEL.
 17787     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17788
 17789     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17790        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17791                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17792     ELSE
 17793        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17794                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17795
 17796     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17797        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17798                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17799     ELSE
 17800        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17801                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17802
 17803     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17804        NEXT SENTENCE
 17805     ELSE
 17806        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17807
 17808     GO TO 4299-EXIT.
 17809
 17810 4200-REVERSE-LF-CANCEL.
 17811     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17812
 17813     IF CM-LF-CANCEL-APPLIED
 17814        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17815        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17816        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17817
 17818     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17819
 17820     IF PB-RECORD-RETURNED
 17821        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17822       ELSE
 17823        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17824
 17825 4200-REVERSE-LF-EXIT.
 17826       EXIT.
 17827
 17828 4200-REVERSE-AH-CANCEL.
 17829     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17830
 17831     IF CM-AH-CANCEL-APPLIED
 17832        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17833        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17834        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17835
 17836     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17837
 17838     IF PB-RECORD-RETURNED
 17839        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17840       ELSE
 17841        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17842
 17843 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 323
* EL050.cbl
 17844       EXIT.
 17845
 17846 4299-EXIT.
 17847       EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 324
* EL050.cbl
 17849
 17850 4500-UPDATE-NEW-CERT.
 17851     IF CERT-WAS-FOUND
 17852         NEXT SENTENCE
 17853       ELSE
 17854         GO TO 4520-BUILD-NEW-KEY.
 17855
 17856     IF  CLASIC-CREATED-CERT
 17857         GO TO 4999-EXIT.
 17858
 17859     IF  CERT-WAS-CREATED-FOR-CLAIM
 17860         GO TO 4520-BUILD-NEW-KEY.
 17861
 17862     IF CERT-ADDED-BATCH
 17863        IF CM-RECORD-ID = 'CM'
 17864            GO TO 4999-EXIT.
 17865
 17866 4520-BUILD-NEW-KEY.
 17867* BUILD CONTROL PRIMARY
 17868
 17869     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17870                                       CM-COMPANY-CD-A1
 17871                                       CM-COMPANY-CD-A2
 17872                                       CM-COMPANY-CD-A4
 17873                                       CM-COMPANY-CD-A5.
 17874
 17875     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17876     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17877     MOVE PB-SV-STATE               TO CM-STATE.
 17878     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17879     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17880     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17881     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17882
 17883     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17884
 17885     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17886     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17887     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17888     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17889
 17890     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17891        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17892
 17893     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17894         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17895         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17896         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17897         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17898     ELSE
 17899         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17900
 17901     IF PB-COMPANY-ID   EQUAL  'CRI'
 17902         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17903         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17904         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17905         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17906         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 325
* EL050.cbl
 17907
 17908     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17909        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17910         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17911
 17912     IF PB-COMPANY-ID  = 'LBL'
 17913        IF PB-I-JOINT-COVERAGE
 17914            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17915                                           PB-I-MEMBER-NO
 17916            GO TO 4550-CONT-CERT-PROCESS.
 17917
 17918     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17919        NEXT SENTENCE
 17920     ELSE
 17921        GO TO 4540-BUILD-MEMBER-NO.
 17922
 17923******************************************************************
 17924*                                                                *
 17925*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17926*    FOR 'MON'.                                                  *
 17927*                                                                *
 17928******************************************************************
 17929
 17930     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17931     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17932     MOVE +1                     TO WS-SUB1
 17933                                    WS-SUB2.
 17934
 17935 4530-EDIT-MEMB-NAME.
 17936
 17937     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17938        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17939        ADD +1                       TO WS-SUB2.
 17940
 17941     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17942        ADD +1                       TO WS-SUB1
 17943        GO TO 4530-EDIT-MEMB-NAME.
 17944
 17945     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17946     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17947     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17948*    MOVE SPACE                      TO DC-OPTION-CODE.
 17949     SET  BIN-TO-GREG                TO TRUE.
 17950     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17951     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17952
 17953     GO TO 4550-CONT-CERT-PROCESS.
 17954
 17955******************************************************************
 17956*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17957******************************************************************
 17958
 17959 4540-BUILD-MEMBER-NO.
 17960
 17961     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17962         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17963         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17964         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 326
* EL050.cbl
 17965         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17966     ELSE
 17967         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17968
 17969     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17970        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17971         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17972
 17973 4550-CONT-CERT-PROCESS.
 17974
 17975*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17976*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17977*    ELSE
 17978*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17979
 17980     IF CERT-WAS-CREATED-FOR-CLAIM
 17981        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17982        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17983
 17984     IF CERT-AND-CLAIM-ONLINE
 17985        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17986        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17987
 17988     MOVE 'CM'                     TO CM-RECORD-ID.
 17989     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17990
 17991     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17992        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17993        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17994     ELSE
 17995        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17996        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17997
 17998     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17999     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18000     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18001     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18002     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18003     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18004     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18005                                      CM-LF-ITD-CANCEL-AMT
 18006                                      CM-LF-ITD-DEATH-AMT
 18007                                      CM-AH-ITD-AH-PMT
 18008                                      CM-AH-ITD-LUMP-PMT
 18009                                      CM-AH-ITD-CANCEL-AMT
 18010                                      CM-LF-NSP-PREMIUM-AMT
 18011                                      CM-AH-NSP-PREMIUM-AMT.
 18012*                                     CM-CLAIM-DEDUCT-WITHHELD
 18013*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18014     if pb-i-loan-apr = +99.9999
 18015        move zeros                 to cm-loan-apr
 18016     else
 18017        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18018     end-if
 18019     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18020     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18021     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18022     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 327
* EL050.cbl
 18023     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18024     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18025     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18026     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18027     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18028     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18029     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18030
 18031     IF PB-I-LIVES NOT NUMERIC
 18032         MOVE ZERO                 TO PB-I-LIVES.
 18033
 18034     IF PB-I-NUM-BILLED NOT NUMERIC
 18035         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18036
 18037     MOVE PB-I-LIVES               TO CM-LIVES.
 18038     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18039
 18040     IF PB-COMPANY-ID EQUAL  'DMD'
 18041         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18042         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18043
 18044     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18045     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18046     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18047     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18048     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18049     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18050
 18051     IF PB-I-LF-POLICY-FEE NUMERIC
 18052        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18053     ELSE
 18054        MOVE +0                    TO CM-LF-POLICY-FEE.
 18055
 18056     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18057        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18058        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18059     ELSE
 18060        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18061
 18062     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18063     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18064     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18065     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18066     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18067     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18068     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18069     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18070     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18071
 18072     IF PB-I-CANCEL-FEE NUMERIC
 18073        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18074     ELSE
 18075        MOVE +0                  TO CM-CANCEL-FEE
 18076     END-IF
 18077
 18078     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18079        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18080     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 328
* EL050.cbl
 18081        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18082
 18083     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18084     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18085
 18086     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18087                                      CM-LF-DEATH-EXIT-DT
 18088                                      CM-AH-SETTLEMENT-EXIT-DT.
 18089
 18090*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18091*                       'TIH' OR 'OFL' OR 'FLA' OR
 18092*                       'TII' OR 'TMS' OR 'CRI' OR
 18093*                       'NCL'
 18094     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18095
 18096     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18097         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18098            MOVE '2'                TO CM-PREMIUM-TYPE.
 18099
 18100     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18101         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18102            MOVE '2'                TO CM-PREMIUM-TYPE.
 18103
 18104     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18105         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18106     ELSE
 18107         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18108         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18109
 18110     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18111     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18112     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18113     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18114     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18115     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18116     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18117     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18118
 18119     IF PB-NO-MONTHS-SKIPPED
 18120         MOVE SPACE                 TO CM-SKIP-CODE
 18121     ELSE
 18122         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18123
 18124     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18125     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18126                                       CM-LF-STATUS-AT-CANCEL.
 18127
 18128     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18129     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18130                                       CM-AH-STATUS-AT-CANCEL.
 18131
 18132     MOVE '1'                       TO CM-ENTRY-STATUS.
 18133
 18134     IF PB-REISSUED-CERT
 18135        MOVE '5'                    TO CM-ENTRY-STATUS.
 18136
 18137     IF PB-MONTHLY-CERT
 18138        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 329
* EL050.cbl
 18139
 18140     IF PB-CASH-CERT
 18141        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18142
 18143     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18144     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18145     IF PB-POLICY-IS-DECLINED
 18146        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18147
 18148     IF PB-POLICY-IS-VOIDED
 18149        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18150
 18151     IF PB-NEEDS-UNDERWRITING
 18152        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18153
 18154     IF PB-REIN-ONLY-CERT
 18155        MOVE '9'                    TO CM-ENTRY-STATUS.
 18156
 18157     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18158         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18159     ELSE
 18160         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18161
 18162     IF PB-RECORD-RETURNED
 18163        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18164      ELSE
 18165        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18166
 18167     IF PB-I-MAIL-ADDRS-PRESENT
 18168        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18169
 18170     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18171                                       CM-ENTRY-DT.
 18172
 18173 4999-EXIT.
 18174     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 330
* EL050.cbl
 18176
 18177 5000-PROCESS-REPS.
 18178     MOVE ' '                    TO AGTC-MASTER-SW
 18179     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18180     MOVE CO-TYPE                TO AGTC-TYPE
 18181     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18182     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18183     IF (AGTC-MASTER-SW NOT = 'N')
 18184        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18185        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18186        PERFORM 8583-READ-ERAGTC-NEXT
 18187                                 THRU 8583-EXIT
 18188     END-IF
 18189     IF AGTC-MASTER-SW = 'N'
 18190        CONTINUE
 18191     ELSE
 18192        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18193           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18194              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18195              MOVE 'Y'           TO AGTC-MASTER-SW
 18196           END-IF
 18197        END-IF
 18198     END-IF
 18199     .
 18200 5000-EXIT.
 18201     EXIT.
 18202 6370-EDIT-INPUT-LF-CODE.
 18203     move ' ' to ws-benefit-cd-chg-sw
 18204     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18205        MOVE +1                  TO SUB
 18206        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18207        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18208        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18209        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18210        GO TO 6370-SEARCH-LOOP.
 18211
 18212     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18213
 18214     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18215     MOVE SPACES                 TO CNTL-ACCESS.
 18216*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18217     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18218     MOVE +0                     TO CNTL-SEQ-NO.
 18219     MOVE '4' TO RC-SW-2.
 18220     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18221
 18222     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18223        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18224        GO TO 6370-NO-LF-FOUND.
 18225
 18226     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18227     MOVE +1                     TO SUB.
 18228
 18229 6370-SEARCH-LOOP.
 18230     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18231         GO TO 6370-NO-LF-FOUND.
 18232
 18233     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 331
* EL050.cbl
 18234        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18235           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18236           set benefit-code-chg to true
 18237        end-if
 18238        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18239        GO TO 6370-HER-NET-PAY-CHECK.
 18240
 18241     ADD 1   TO SUB.
 18242*    IF SUB GREATER 120
 18243     IF SUB GREATER 200
 18244         GO TO 6370-NO-LF-FOUND.
 18245
 18246     GO TO 6370-SEARCH-LOOP.
 18247
 18248 6370-NO-LF-FOUND.
 18249
 18250     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18251        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18252        set benefit-code-chg to true
 18253     end-if
 18254     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18255
 18256 6370-HER-NET-PAY-CHECK.
 18257
 18258     IF PB-COMPANY-ID = 'CID'
 18259        IF PB-SV-STATE = 'CA' OR 'MN'
 18260           IF PB-I-LF-BENEFIT-CD = '02'
 18261              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18262           ELSE
 18263              IF PB-I-LF-BENEFIT-CD = '04'
 18264                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18265              END-IF
 18266           END-IF
 18267        END-IF
 18268     END-IF
 18269
 18270     IF PB-COMPANY-ID NOT = 'HER'
 18271         GO TO 6370-EXIT.
 18272
 18273     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18274         GO TO 6370-EXIT.
 18275
 18276     IF PB-I-LF-TERM NOT NUMERIC
 18277         MOVE ZEROS              TO PB-I-LF-TERM.
 18278
 18279     IF PB-I-LOAN-TERM NOT NUMERIC
 18280         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18281
 18282     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18283         GO TO 6370-EXIT.
 18284
 18285     IF PB-I-LF-BENEFIT-CD = '33'
 18286         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18287
 18288     IF PB-I-LF-BENEFIT-CD = '34'
 18289         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18290
 18291 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 332
* EL050.cbl
 18292     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 333
* EL050.cbl
 18294
 18295 6380-EDIT-INPUT-AH-CODE.
 18296     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18297        MOVE +1                  TO SUB
 18298        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18299        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18300        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18301        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18302        GO TO 6380-SEARCH-LOOP.
 18303
 18304     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18305
 18306     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18307     MOVE SPACES                 TO CNTL-ACCESS.
 18308     MOVE 'A'                    TO CNTL-REC-TYPE.
 18309*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18310     MOVE +0                     TO CNTL-SEQ-NO.
 18311     MOVE '5' TO RC-SW-2.
 18312     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18313
 18314     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18315        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18316        GO TO 6380-NO-AH-FOUND.
 18317
 18318     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18319     MOVE +1 TO SUB.
 18320
 18321 6380-SEARCH-LOOP.
 18322     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18323         GO TO 6380-NO-AH-FOUND.
 18324
 18325     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18326         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18327         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18328
 18329     ADD 1   TO SUB.
 18330     IF SUB GREATER THAN 96
 18331*    IF SUB GREATER THAN 300
 18332         GO TO 6380-NO-AH-FOUND.
 18333
 18334     GO TO 6380-SEARCH-LOOP.
 18335
 18336 6380-NO-AH-FOUND.
 18337
 18338     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18339
 18340     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18341         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18342     ELSE
 18343         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18344
 18345 6380-CSO-AH-ONLY-CHECKS.
 18346
 18347     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18348        NEXT SENTENCE
 18349      ELSE
 18350        GO TO 6380-EXIT.
 18351
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 334
* EL050.cbl
 18352     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18353         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18354
 18355
 18356     GO TO 6380-EXIT
 18357     .
 18358 6380-CSO-LIFE-WITH-AH-CHECKS.
 18359
 18360
 18361     .
 18362 6380-EXIT.
 18363     EXIT.
 18364
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 335
* EL050.cbl
 18366
 18367 6400-COMPUTE-EXTENSION-DAYS.
 18368
 18369******************************************************************
 18370*                                                                *
 18371*                   COMPUTE EXTENSION DAYS                       *
 18372*                                                                *
 18373*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18374*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18375*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18376*    THE EXTENSION DAYS.                                         *
 18377*                                                                *
 18378******************************************************************
 18379
 18380     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18381     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18382
 18383******************************************************************
 18384*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18385*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18386******************************************************************
 18387
 18388     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18389        COMPUTE WS-ODD-DAYS-OVER =
 18390               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18391     ELSE
 18392        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18393
 18394     IF WS-ODD-DAYS-OVER = ZEROS
 18395           GO TO 6499-EXIT
 18396     ELSE
 18397        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18398           IF WS-WDF-MONTH = 02
 18399              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18400              ADD 2       TO  WS-ODD-DAYS-OVER
 18401              GO TO 6499-EXIT
 18402           ELSE
 18403              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18404                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18405                 GO TO 6499-EXIT
 18406               ELSE
 18407                 GO TO 6499-EXIT
 18408        ELSE
 18409           GO TO 6499-EXIT.
 18410
 18411 6412-CHECK-TO-DAY.
 18412
 18413        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18414           IF WS-WDT-DAY = 28
 18415              ADD 2              TO WS-ODD-DAYS-OVER
 18416           ELSE
 18417              IF WS-WDT-DAY = 29
 18418                 ADD 1           TO WS-ODD-DAYS-OVER
 18419              ELSE
 18420                 NEXT SENTENCE
 18421        ELSE
 18422           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18423              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 336
* EL050.cbl
 18424
 18425     GO TO 6499-EXIT.
 18426
 18427
 18428 6415-CHECK-LEAP-YEAR.
 18429
 18430     IF DC-DAYS-IN-MONTH = 29
 18431        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18432
 18433 6415-EXIT.
 18434     EXIT.
 18435
 18436 6499-EXIT.
 18437      EXIT.
 18438
 18439 6500-END.
 18440     EXIT.
 18441
 18442
 18443******************************************************************
 18444************* PROCEDURE DIVISION FOR EL050 ***********************
 18445********************** ELC50PD END *******************************
 18446
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 337
* EL050.cbl
 18448
 18449**START***********************************************************
 18450*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18451*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18452******************************************************************
 18453*
 18454 6600-GET-STATE-MUNICIPAL-TAX.
 18455
 18456     IF PB-COMPANY-ID NOT = 'DMD'
 18457         GO TO 6640-EXIT.
 18458
 18459     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18460     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18461     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18462*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18463*
 18464***  Y2K PROJ 7744
 18465     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18466     SET BIN-TO-GREG          TO TRUE.
 18467     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18468
 18469     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18470
 18471     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18472     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18473
 18474
 18475* EXEC CICS HANDLE CONDITION
 18476*        INVREQ    (6610-START-BROWSE)
 18477*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18478*        NOTFND    (6630-END-OF-FILE)
 18479*    END-EXEC.
 18480*    MOVE '"$8JI                 ! # #00018462' TO DFHEIV0
 18481     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18482     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18483     MOVE X'2320233030303138343632' TO DFHEIV0(25:11)
 18484     CALL 'kxdfhei1' USING DFHEIV0
 18485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18486
 18487
 18488 6610-START-BROWSE.
 18489
 18490
 18491* EXEC CICS HANDLE CONDITION
 18492*        NOTFND    (6630-END-OF-FILE)
 18493*        DISABLED  (6630-ERRESS-PROBLEM)
 18494*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18495*        ENDFILE   (6630-END-OF-FILE)
 18496*    END-EXEC.
 18497*    MOVE '"$IcJ''                ! $ #00018470' TO DFHEIV0
 18498     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18500     MOVE X'2420233030303138343730' TO DFHEIV0(25:11)
 18501     CALL 'kxdfhei1' USING DFHEIV0
 18502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18503
 18504
 18505
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 338
* EL050.cbl
 18506* EXEC CICS STARTBR
 18507*        DATASET (FILE-ID-ERRESS)
 18508*        RIDFLD  (WS-ERRESS-KEY)
 18509*        GTEQ
 18510*    END-EXEC.
 18511     MOVE 0
 18512       TO DFHEIV11
 18513*    MOVE '&,         G          &   #00018477' TO DFHEIV0
 18514     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18515     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18516     MOVE X'2020233030303138343737' TO DFHEIV0(25:11)
 18517     CALL 'kxdfhei1' USING DFHEIV0,
 18518           FILE-ID-ERRESS,
 18519           WS-ERRESS-KEY,
 18520           DFHEIV99,
 18521           DFHEIV11,
 18522           DFHEIV99
 18523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18524
 18525
 18526 6620-READ-NEXT-ERRESS-MASTER.
 18527
 18528
 18529* EXEC CICS HANDLE CONDITION
 18530*        NOTFND    (6630-END-OF-FILE)
 18531*        ENDFILE   (6630-END-OF-FILE)
 18532*        DISABLED  (6630-ERRESS-PROBLEM)
 18533*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18534*    END-EXEC.
 18535*    MOVE '"$I''cJ                ! % #00018485' TO DFHEIV0
 18536     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18538     MOVE X'2520233030303138343835' TO DFHEIV0(25:11)
 18539     CALL 'kxdfhei1' USING DFHEIV0
 18540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18541
 18542
 18543
 18544* EXEC CICS READNEXT
 18545*        DATASET (FILE-ID-ERRESS)
 18546*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18547*        RIDFLD  (WS-ERRESS-KEY)
 18548*    END-EXEC.
 18549     MOVE LENGTH OF
 18550      RESIDENT-STATE-TAX-MASTER
 18551       TO DFHEIV12
 18552     MOVE 0
 18553       TO DFHEIV11
 18554*    MOVE '&.IL                  )   #00018492' TO DFHEIV0
 18555     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18556     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18557     MOVE X'2020233030303138343932' TO DFHEIV0(25:11)
 18558     CALL 'kxdfhei1' USING DFHEIV0,
 18559           FILE-ID-ERRESS,
 18560           RESIDENT-STATE-TAX-MASTER,
 18561           DFHEIV12,
 18562           WS-ERRESS-KEY,
 18563           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 339
* EL050.cbl
 18564           DFHEIV11,
 18565           DFHEIV99,
 18566           DFHEIV99
 18567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18568
 18569
 18570     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18571
 18572* EXEC CICS ENDBR
 18573*            DATASET (FILE-ID-ERRESS)
 18574*       END-EXEC
 18575     MOVE 0
 18576       TO DFHEIV11
 18577*    MOVE '&2                    $   #00018499' TO DFHEIV0
 18578     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18579     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18580     MOVE X'2020233030303138343939' TO DFHEIV0(25:11)
 18581     CALL 'kxdfhei1' USING DFHEIV0,
 18582           FILE-ID-ERRESS,
 18583           DFHEIV11,
 18584           DFHEIV99
 18585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18586        GO TO 6630-END-OF-FILE.
 18587
 18588     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18589        NEXT SENTENCE
 18590      ELSE
 18591        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18592
 18593*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18594*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18595*
 18596     MOVE +2                     TO WS-SUB1.
 18597
 18598     IF PB-ISSUE
 18599     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18600        MOVE +1                  TO WS-SUB1.
 18601
 18602     IF PB-CANCELLATION
 18603     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18604        MOVE +1                  TO WS-SUB1.
 18605*
 18606*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18607*
 18608***  Y2K PROJ 7744
 18609     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18610***  Y2K PROJ 7744
 18611
 18612*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18613* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18614* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18615
 18616     ADD 1                    TO WS-YEAR-YY.
 18617
 18618     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18619         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18620                              TO WS-RES-STATE-TAX
 18621         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 340
* EL050.cbl
 18622                              TO WS-RES-MUNI-TAX
 18623     ELSE
 18624         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18625                              TO WS-RES-STATE-TAX
 18626         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18627                              TO WS-RES-MUNI-TAX.
 18628
 18629*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18630
 18631     IF PB-CANCELLATION
 18632         GO TO 6640-CANCEL-TAX.
 18633
 18634     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18635         COMPUTE PB-I-STATE-TAX ROUNDED =
 18636                                   PB-I-LF-PREMIUM-AMT
 18637                                 * WS-RES-STATE-TAX
 18638         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18639                                   PB-I-LF-PREMIUM-AMT
 18640                                 * WS-RES-MUNI-TAX
 18641     ELSE
 18642     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18643         COMPUTE PB-I-STATE-TAX ROUNDED =
 18644                                   PB-I-AH-PREMIUM-AMT
 18645                                 * WS-RES-STATE-TAX
 18646         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18647                                   PB-I-AH-PREMIUM-AMT
 18648                                 * WS-RES-MUNI-TAX.
 18649
 18650
 18651* EXEC CICS ENDBR
 18652*         DATASET (FILE-ID-ERRESS)
 18653*    END-EXEC.
 18654     MOVE 0
 18655       TO DFHEIV11
 18656*    MOVE '&2                    $   #00018566' TO DFHEIV0
 18657     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18658     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18659     MOVE X'2020233030303138353636' TO DFHEIV0(25:11)
 18660     CALL 'kxdfhei1' USING DFHEIV0,
 18661           FILE-ID-ERRESS,
 18662           DFHEIV11,
 18663           DFHEIV99
 18664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18665
 18666
 18667     GO TO 6640-EXIT.
 18668
 18669 6640-CANCEL-TAX.
 18670     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18671
 18672     IF PB-C-LF-CANCEL-AMT > ZEROS
 18673         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18674                                   PB-C-LF-CANCEL-AMT
 18675                                 * WS-RES-STATE-TAX
 18676         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18677                                   PB-C-LF-CANCEL-AMT
 18678                                *  WS-RES-MUNI-TAX
 18679     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 341
* EL050.cbl
 18680     IF PB-C-AH-CANCEL-AMT > ZEROS
 18681         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18682                                   PB-C-AH-CANCEL-AMT
 18683                                 * WS-RES-STATE-TAX
 18684         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18685                                   PB-C-AH-CANCEL-AMT
 18686                                *  WS-RES-MUNI-TAX.
 18687
 18688
 18689* EXEC CICS ENDBR
 18690*         DATASET (FILE-ID-ERRESS)
 18691*    END-EXEC.
 18692     MOVE 0
 18693       TO DFHEIV11
 18694*    MOVE '&2                    $   #00018591' TO DFHEIV0
 18695     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18696     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18697     MOVE X'2020233030303138353931' TO DFHEIV0(25:11)
 18698     CALL 'kxdfhei1' USING DFHEIV0,
 18699           FILE-ID-ERRESS,
 18700           DFHEIV11,
 18701           DFHEIV99
 18702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18703
 18704
 18705     GO TO 6640-EXIT.
 18706
 18707 6630-END-OF-FILE.
 18708     MOVE ER-8002              TO WS-ERROR.
 18709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18710
 18711     GO TO 6640-EXIT.
 18712
 18713 6630-ERRESS-PROBLEM.
 18714     MOVE ER-8044              TO WS-ERROR.
 18715     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18716
 18717 6640-EXIT.
 18718     EXIT.
 18719
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 342
* EL050.cbl
 18721 6650-GET-RES-STATE-COMM.
 18722
 18723     IF PB-COMPANY-ID NOT = 'DMD'
 18724         GO TO 6700-COMM-EXIT.
 18725
 18726     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18727     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18728     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18729     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18730     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18731     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18732     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18733
 18734*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18735*
 18736***  Y2K PROJ 7744
 18737     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18738     SET BIN-TO-GREG          TO TRUE.
 18739     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18740
 18741     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18742***  Y2K PROJ 7744
 18743
 18744     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18745
 18746
 18747* EXEC CICS HANDLE CONDITION
 18748*        INVREQ    (6660-START-BROWSE)
 18749*        DISABLED  (6690-ERRESC-PROBLEM)
 18750*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18751*        NOTFND    (6690-END-OF-FILE)
 18752*    END-EXEC.
 18753*    MOVE '"$8cJI                ! & #00018636' TO DFHEIV0
 18754     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18756     MOVE X'2620233030303138363336' TO DFHEIV0(25:11)
 18757     CALL 'kxdfhei1' USING DFHEIV0
 18758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18759
 18760
 18761
 18762* EXEC CICS RESETBR
 18763*        DATASET (FILE-ID-ERRESC)
 18764*        RIDFLD  (WS-ERRESC-KEY)
 18765*    END-EXEC.
 18766     MOVE 0
 18767       TO DFHEIV11
 18768*    MOVE '&4         G          &   #00018643' TO DFHEIV0
 18769     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18770     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18771     MOVE X'2020233030303138363433' TO DFHEIV0(25:11)
 18772     CALL 'kxdfhei1' USING DFHEIV0,
 18773           FILE-ID-ERRESC,
 18774           WS-ERRESC-KEY,
 18775           DFHEIV99,
 18776           DFHEIV11,
 18777           DFHEIV99
 18778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 343
* EL050.cbl
 18779
 18780
 18781 6660-START-BROWSE.
 18782
 18783
 18784* EXEC CICS HANDLE CONDITION
 18785*        NOTFND    (6690-END-OF-FILE)
 18786*        DISABLED  (6690-ERRESC-PROBLEM)
 18787*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18788*        ENDFILE   (6690-END-OF-FILE)
 18789*    END-EXEC.
 18790*    MOVE '"$IcJ''                ! '' #00018650' TO DFHEIV0
 18791     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18793     MOVE X'2720233030303138363530' TO DFHEIV0(25:11)
 18794     CALL 'kxdfhei1' USING DFHEIV0
 18795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18796
 18797
 18798
 18799* EXEC CICS STARTBR
 18800*        DATASET (FILE-ID-ERRESC)
 18801*        RIDFLD  (WS-ERRESC-KEY)
 18802*        GTEQ
 18803*    END-EXEC.
 18804     MOVE 0
 18805       TO DFHEIV11
 18806*    MOVE '&,         G          &   #00018657' TO DFHEIV0
 18807     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18808     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18809     MOVE X'2020233030303138363537' TO DFHEIV0(25:11)
 18810     CALL 'kxdfhei1' USING DFHEIV0,
 18811           FILE-ID-ERRESC,
 18812           WS-ERRESC-KEY,
 18813           DFHEIV99,
 18814           DFHEIV11,
 18815           DFHEIV99
 18816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18817
 18818
 18819     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18820
 18821 6670-READ-NEXT-ERRESC-MASTER.
 18822
 18823
 18824* EXEC CICS HANDLE CONDITION
 18825*        NOTFND    (6690-END-OF-FILE)
 18826*        DISABLED  (6690-ERRESC-PROBLEM)
 18827*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18828*        ENDFILE   (6690-END-OF-FILE)
 18829*    END-EXEC.
 18830*    MOVE '"$IcJ''                ! ( #00018667' TO DFHEIV0
 18831     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18833     MOVE X'2820233030303138363637' TO DFHEIV0(25:11)
 18834     CALL 'kxdfhei1' USING DFHEIV0
 18835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18836
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 344
* EL050.cbl
 18837
 18838
 18839* EXEC CICS READNEXT
 18840*        DATASET (FILE-ID-ERRESC)
 18841*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18842*        RIDFLD  (ERRESC-RECORD-KEY)
 18843*    END-EXEC.
 18844     MOVE LENGTH OF
 18845      ACCOUNT-RESIDENT-ST-COMMISSION
 18846       TO DFHEIV12
 18847     MOVE 0
 18848       TO DFHEIV11
 18849*    MOVE '&.IL                  )   #00018674' TO DFHEIV0
 18850     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18851     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18852     MOVE X'2020233030303138363734' TO DFHEIV0(25:11)
 18853     CALL 'kxdfhei1' USING DFHEIV0,
 18854           FILE-ID-ERRESC,
 18855           ACCOUNT-RESIDENT-ST-COMMISSION,
 18856           DFHEIV12,
 18857           ERRESC-RECORD-KEY,
 18858           DFHEIV99,
 18859           DFHEIV11,
 18860           DFHEIV99,
 18861           DFHEIV99
 18862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18863
 18864
 18865     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18866        NEXT SENTENCE
 18867     ELSE
 18868
 18869* EXEC CICS ENDBR
 18870*            DATASET (FILE-ID-ERRESC)
 18871*       END-EXEC
 18872     MOVE 0
 18873       TO DFHEIV11
 18874*    MOVE '&2                    $   #00018683' TO DFHEIV0
 18875     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18876     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18877     MOVE X'2020233030303138363833' TO DFHEIV0(25:11)
 18878     CALL 'kxdfhei1' USING DFHEIV0,
 18879           FILE-ID-ERRESC,
 18880           DFHEIV11,
 18881           DFHEIV99
 18882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18883        GO TO 6690-END-OF-FILE.
 18884
 18885     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18886
 18887* EXEC CICS ENDBR
 18888*            DATASET (FILE-ID-ERRESC)
 18889*       END-EXEC
 18890     MOVE 0
 18891       TO DFHEIV11
 18892*    MOVE '&2                    $   #00018689' TO DFHEIV0
 18893     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18894     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 345
* EL050.cbl
 18895     MOVE X'2020233030303138363839' TO DFHEIV0(25:11)
 18896     CALL 'kxdfhei1' USING DFHEIV0,
 18897           FILE-ID-ERRESC,
 18898           DFHEIV11,
 18899           DFHEIV99
 18900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18901        GO TO 6690-END-OF-FILE.
 18902
 18903     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18904        NEXT SENTENCE
 18905      ELSE
 18906        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18907
 18908* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18909*
 18910     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18911
 18912     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18913
 18914     IF WS-SUB1 > ZERO
 18915         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18916             PERFORM 6680-SET-COMMISSION
 18917         ELSE
 18918             PERFORM 6680-SET-TABLE-CODE.
 18919
 18920
 18921* EXEC CICS ENDBR
 18922*         DATASET (FILE-ID-ERRESC)
 18923*    END-EXEC.
 18924     MOVE 0
 18925       TO DFHEIV11
 18926*    MOVE '&2                    $   #00018711' TO DFHEIV0
 18927     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18928     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18929     MOVE X'2020233030303138373131' TO DFHEIV0(25:11)
 18930     CALL 'kxdfhei1' USING DFHEIV0,
 18931           FILE-ID-ERRESC,
 18932           DFHEIV11,
 18933           DFHEIV99
 18934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18935
 18936
 18937     GO TO 6700-COMM-EXIT.
 18938
 18939 6680-SET-TABLE-CODE.
 18940     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18941        MOVE ZEROS             TO WS-SUB1
 18942     ELSE
 18943* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18944* TO COMPUTE AH COMMISSION.
 18945        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18946        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18947        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18948        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18949        PERFORM 6680-READ-CTBL-TABLE
 18950        IF WS-CTBL-READ-SW NOT = 'Y'
 18951           MOVE ZEROS          TO WS-SUB1.
 18952
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 346
* EL050.cbl
 18953 6680-READ-CTBL-TABLE.
 18954*
 18955* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18956* TO COMPUTE LIFE COMMISSION
 18957
 18958     IF CTBL-SW = '0540'
 18959        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18960        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18961        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18962
 18963     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18964
 18965     IF CTBL-TABLE-FOUND
 18966        IF CTBL-SW = '0530'
 18967             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18968                                    * PB-I-AH-TERM
 18969             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18970             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18971        ELSE
 18972             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18973             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18974             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18975     ELSE
 18976        IF FIRST-TIME-THROUGH
 18977            GO TO 6680-READ-CTBL-TABLE
 18978        ELSE
 18979            MOVE ZEROS         TO WS-SUB1.
 18980
 18981 6680-SET-COMMISSION.
 18982     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18983           MOVE ZEROS          TO WS-SUB1
 18984       ELSE
 18985           MOVE RESC-COMMISSION-PER (WS-SUB)
 18986                               TO WS-COMMISSION
 18987           IF CTBL-SW = '0530'
 18988               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18989           ELSE
 18990               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18991
 18992 6680-SEARCH-CATEGORY.
 18993     ADD +1                   TO WS-SUB.
 18994     IF WS-SUB > +12
 18995         GO TO 6680-EXIT.
 18996
 18997     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18998          MOVE WS-SUB         TO WS-SUB1
 18999          GO TO 6680-EXIT.
 19000
 19001     GO TO 6680-SEARCH-CATEGORY.
 19002
 19003 6680-EXIT.
 19004     EXIT.
 19005
 19006 6690-END-OF-FILE.
 19007     GO TO 6700-COMM-EXIT.
 19008
 19009 6690-ERRESC-PROBLEM.
 19010      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 347
* EL050.cbl
 19011      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19012
 19013      GO TO 6700-COMM-EXIT.
 19014
 19015 6700-COMM-EXIT.
 19016     EXIT.
 19017
 19018 7000-GET-RATE.
 19019
 19020* EXEC CICS LINK
 19021*        PROGRAM    ('ELRATE')
 19022*        COMMAREA   (CALCULATION-PASS-AREA)
 19023*        LENGTH     (CP-COMM-LENGTH)
 19024*    END-EXEC.
 19025     MOVE 'ELRATE' TO DFHEIV1
 19026*    MOVE '."C                   (   #00018797' TO DFHEIV0
 19027     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19029     MOVE X'2020233030303138373937' TO DFHEIV0(25:11)
 19030     CALL 'kxdfhei1' USING DFHEIV0,
 19031           DFHEIV1,
 19032           CALCULATION-PASS-AREA,
 19033           CP-COMM-LENGTH,
 19034           DFHEIV99,
 19035           DFHEIV99,
 19036           DFHEIV99,
 19037           DFHEIV99
 19038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19039
 19040
 19041 7000-EXIT.
 19042     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 348
* EL050.cbl
 19044 7100-FIND-BENEFIT-IN-STATE.
 19045     MOVE 'N'                    TO BEN-SEARCH-SW.
 19046
 19047     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19048         VARYING SUB3 FROM 1 BY 1 UNTIL
 19049            ((SUB3 GREATER 50) OR
 19050              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19051               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19052
 19053     IF SUB3 NOT = 51
 19054         MOVE 'Y'                TO BEN-SEARCH-SW.
 19055
 19056     GO TO 7199-EXIT.
 19057
 19058 7100-BENEFIT-DUMMY.
 19059
 19060 7100-DUMMY-EXIT.
 19061     EXIT.
 19062
 19063 7199-EXIT.
 19064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 349
* EL050.cbl
 19066 7200-FIND-BENEFIT.
 19067     MOVE 'N'                    TO BEN-SEARCH-SW.
 19068
 19069     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19070         VARYING SUB3 FROM 1 BY 1 UNTIL
 19071            ((SUB3 GREATER 8) OR
 19072            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19073
 19074     IF SUB3 NOT = 9
 19075         MOVE 'Y'                TO BEN-SEARCH-SW.
 19076
 19077     GO TO 7200-EXIT.
 19078
 19079 7200-BENEFIT-DUMMY.
 19080
 19081 7200-DUMMY-EXIT.
 19082     EXIT.
 19083
 19084 7200-EXIT.
 19085     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 350
* EL050.cbl
 19087 7250-LOOK-FOR-RESCINDED-CLAIM.
 19088     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19089                                    W-CL-COMP-CD.
 19090     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19091                                    W-CL-CERT-NO.
 19092
 19093
 19094* EXEC CICS HANDLE CONDITION
 19095*        NOTFND  (7250-CONTINUE)
 19096*        ENDFILE (7250-CONTINUE)
 19097*    END-EXEC.
 19098*    MOVE '"$I''                  ! ) #00018855' TO DFHEIV0
 19099     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19101     MOVE X'2920233030303138383535' TO DFHEIV0(25:11)
 19102     CALL 'kxdfhei1' USING DFHEIV0
 19103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19104
 19105
 19106
 19107* EXEC CICS IGNORE CONDITION
 19108*        DUPKEY
 19109*    END-EXEC.
 19110*    MOVE '"*$                   !   #00018860' TO DFHEIV0
 19111     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19113     MOVE X'2020233030303138383630' TO DFHEIV0(25:11)
 19114     CALL 'kxdfhei1' USING DFHEIV0
 19115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19116
 19117
 19118
 19119* EXEC CICS STARTBR
 19120*        DATASET   (CLMS-ID)
 19121*        RIDFLD    (ELMSTR-KEY)
 19122*        GENERIC   EQUAL
 19123*        KEYLENGTH (ELMSTR-LENGTH)
 19124*    END-EXEC.
 19125     MOVE 0
 19126       TO DFHEIV11
 19127*    MOVE '&,   KG    E          &   #00018864' TO DFHEIV0
 19128     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19129     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19130     MOVE X'2020233030303138383634' TO DFHEIV0(25:11)
 19131     CALL 'kxdfhei1' USING DFHEIV0,
 19132           CLMS-ID,
 19133           ELMSTR-KEY,
 19134           ELMSTR-LENGTH,
 19135           DFHEIV11,
 19136           DFHEIV99
 19137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19138
 19139
 19140     MOVE 'Y'                    TO W-BROWSE-SW.
 19141
 19142 7250-NEXT-CLAIM.
 19143
 19144
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 351
* EL050.cbl
 19145* EXEC CICS READNEXT
 19146*        DATASET   (CLMS-ID)
 19147*        RIDFLD    (ELMSTR-KEY)
 19148*        SET       (ADDRESS OF CLAIM-MASTER)
 19149*    END-EXEC.
 19150     MOVE 0
 19151       TO DFHEIV11
 19152*    MOVE '&.S                   )   #00018875' TO DFHEIV0
 19153     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19154     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19155     MOVE X'2020233030303138383735' TO DFHEIV0(25:11)
 19156     CALL 'kxdfhei1' USING DFHEIV0,
 19157           CLMS-ID,
 19158           DFHEIV20,
 19159           DFHEIV99,
 19160           ELMSTR-KEY,
 19161           DFHEIV99,
 19162           DFHEIV11,
 19163           DFHEIV99,
 19164           DFHEIV99
 19165     SET ADDRESS OF CLAIM-MASTER TO
 19166         DFHEIV20
 19167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19168
 19169
 19170     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19171        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19172         GO TO 7250-CONTINUE
 19173     END-IF.
 19174
 19175     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19176        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19177        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19178        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19179        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19180         GO TO 7250-NEXT-CLAIM
 19181     END-IF.
 19182
 19183     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19184        OR (CL-CLAIM-TYPE = 'I')
 19185        OR (CL-CLAIM-TYPE = 'G')
 19186        OR (CL-CLAIM-TYPE = 'F')
 19187          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19188              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19189              GO TO 7250-CONTINUE
 19190          END-IF
 19191     END-IF.
 19192
 19193     GO TO 7250-NEXT-CLAIM.
 19194
 19195 7250-CONTINUE.
 19196
 19197     IF W-BROWSE-SW = 'Y'
 19198
 19199* EXEC CICS ENDBR
 19200*            DATASET   (CLMS-ID)
 19201*        END-EXEC
 19202     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 352
* EL050.cbl
 19203       TO DFHEIV11
 19204*    MOVE '&2                    $   #00018909' TO DFHEIV0
 19205     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19206     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19207     MOVE X'2020233030303138393039' TO DFHEIV0(25:11)
 19208     CALL 'kxdfhei1' USING DFHEIV0,
 19209           CLMS-ID,
 19210           DFHEIV11,
 19211           DFHEIV99
 19212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19213         MOVE 'N' TO W-BROWSE-SW
 19214     END-IF.
 19215
 19216 7250-EXIT.
 19217     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 353
* EL050.cbl
 19219 7300-CHECK-FOR-OPEN-CLMS.
 19220
 19221*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19222*    MOVE SPACES                 TO CNTL-ACCESS.
 19223*    MOVE '1'                    TO CNTL-REC-TYPE.
 19224*    MOVE +0                     TO CNTL-SEQ-NO.
 19225
 19226*    MOVE '3'                    TO RC-SW-1.
 19227*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19228
 19229*    IF NOT CF-COMPANY-MASTER
 19230*         PERFORM 0099-COMPANY-NOT-FOUND
 19231*         GO TO 7300-EXIT.
 19232
 19233     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19234                                    W-CL-COMP-CD.
 19235     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19236                                    W-CL-CERT-NO.
 19237
 19238
 19239* EXEC CICS HANDLE CONDITION
 19240*        NOTFND  (7300-CONTINUE)
 19241*        ENDFILE (7300-CONTINUE)
 19242*    END-EXEC.
 19243*    MOVE '"$I''                  ! * #00018937' TO DFHEIV0
 19244     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19246     MOVE X'2A20233030303138393337' TO DFHEIV0(25:11)
 19247     CALL 'kxdfhei1' USING DFHEIV0
 19248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19249
 19250
 19251
 19252* EXEC CICS IGNORE CONDITION
 19253*        DUPKEY
 19254*    END-EXEC.
 19255*    MOVE '"*$                   !   #00018942' TO DFHEIV0
 19256     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19258     MOVE X'2020233030303138393432' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0
 19260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19261
 19262
 19263
 19264* EXEC CICS STARTBR
 19265*        DATASET   (CLMS-ID)
 19266*        RIDFLD    (ELMSTR-KEY)
 19267*        GENERIC   EQUAL
 19268*        KEYLENGTH (ELMSTR-LENGTH)
 19269*    END-EXEC.
 19270     MOVE 0
 19271       TO DFHEIV11
 19272*    MOVE '&,   KG    E          &   #00018946' TO DFHEIV0
 19273     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19274     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19275     MOVE X'2020233030303138393436' TO DFHEIV0(25:11)
 19276     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 354
* EL050.cbl
 19277           CLMS-ID,
 19278           ELMSTR-KEY,
 19279           ELMSTR-LENGTH,
 19280           DFHEIV11,
 19281           DFHEIV99
 19282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19283
 19284
 19285     MOVE 'Y'                    TO W-BROWSE-SW.
 19286
 19287 7300-NEXT-CLAIM.
 19288
 19289
 19290* EXEC CICS READNEXT
 19291*        DATASET   (CLMS-ID)
 19292*        RIDFLD    (ELMSTR-KEY)
 19293*        SET       (ADDRESS OF CLAIM-MASTER)
 19294*    END-EXEC.
 19295     MOVE 0
 19296       TO DFHEIV11
 19297*    MOVE '&.S                   )   #00018957' TO DFHEIV0
 19298     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19299     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19300     MOVE X'2020233030303138393537' TO DFHEIV0(25:11)
 19301     CALL 'kxdfhei1' USING DFHEIV0,
 19302           CLMS-ID,
 19303           DFHEIV20,
 19304           DFHEIV99,
 19305           ELMSTR-KEY,
 19306           DFHEIV99,
 19307           DFHEIV11,
 19308           DFHEIV99,
 19309           DFHEIV99
 19310     SET ADDRESS OF CLAIM-MASTER TO
 19311         DFHEIV20
 19312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19313
 19314
 19315     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19316        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19317         GO TO 7300-CONTINUE.
 19318
 19319     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19320        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19321        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19322        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19323        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19324         GO TO 7300-NEXT-CLAIM.
 19325
 19326*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19327     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19328        OR (CL-CLAIM-TYPE = 'I')
 19329        OR (CL-CLAIM-TYPE = 'G')
 19330        OR (CL-CLAIM-TYPE = 'F')
 19331        IF CLAIM-IS-OPEN
 19332           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19333             AND PB-C-AH-CANCEL-DT > SPACES
 19334              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 355
* EL050.cbl
 19335              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19336           END-IF
 19337           EVALUATE TRUE
 19338             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19339                 MOVE ER-2884      TO WS-ERROR
 19340             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19341                 MOVE ER-2887      TO WS-ERROR
 19342             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19343                 MOVE ER-2886      TO WS-ERROR
 19344             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19345                 MOVE ER-2888      TO WS-ERROR
 19346             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19347                 MOVE ER-2885      TO WS-ERROR
 19348             WHEN OTHER
 19349                 MOVE ER-2768      TO WS-ERROR
 19350           END-EVALUATE
 19351           IF PB-C-AH-CANCEL-VOIDED OR
 19352              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19353                NOT AH-COVERAGE-CANCELLED)
 19354               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19355               MOVE ER-2768      TO WS-ERROR
 19356           END-IF
 19357           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19358           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19359              PB-FORCE-CODE NOT EQUAL '8'
 19360               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19361           END-IF
 19362           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19363           GO TO 7300-NEXT-CLAIM
 19364        ELSE
 19365           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19366*****THIS IS A RESCISSION OR REFORMATION
 19367              IF AH-COVERAGE-CANCELLED
 19368                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19369                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19370                    MOVE 1                   TO DC-ELAPSED-DAYS
 19371                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19372                    SET BIN-PLUS-ELAPSED     TO TRUE
 19373                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19374                    IF NO-CONVERSION-ERROR
 19375                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19376                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19377                          MOVE ER-2897 TO WS-ERROR
 19378                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19379                          GO TO 7300-NEXT-CLAIM
 19380                       END-IF
 19381                    END-IF
 19382                 ELSE
 19383                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19384                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19385                         MOVE ER-2890 TO WS-ERROR
 19386                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19387                         GO TO 7300-NEXT-CLAIM
 19388                      ELSE
 19389                         MOVE ER-2898 TO WS-ERROR
 19390                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19391                         GO TO 7300-NEXT-CLAIM
 19392                      END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 356
* EL050.cbl
 19393                   END-IF
 19394                 END-IF
 19395              END-IF
 19396           ELSE
 19397              IF CL-DENIAL-TYPE = '1'  AND
 19398                 CL-TOTAL-PAID-AMT = 0
 19399                    GO TO 7300-NEXT-CLAIM
 19400              END-IF
 19401              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19402               AND PB-C-AH-CANCEL-DT > SPACES
 19403                 MOVE ER-2756        TO WS-ERROR
 19404                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19405                 GO TO 7300-NEXT-CLAIM
 19406              END-IF
 19407           END-IF
 19408        END-IF
 19409     ELSE
 19410*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19411        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19412           IF (CLAIM-IS-OPEN)
 19413              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19414                 <> zeros
 19415              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19416                 <> zeros)
 19417              MOVE ER-2889      TO WS-ERROR
 19418              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19419              GO TO 7300-NEXT-CLAIM
 19420           ELSE
 19421              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19422*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19423                 IF (LF-COVERAGE-CANCELLED AND
 19424                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19425                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19426                         MOVE ER-2890 TO WS-ERROR
 19427                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19428                         GO TO 7300-NEXT-CLAIM
 19429                      ELSE
 19430                         MOVE ER-2898 TO WS-ERROR
 19431                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19432                         GO TO 7300-NEXT-CLAIM
 19433                      END-IF
 19434                 END-IF
 19435              ELSE
 19436                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19437                    and (CL-TOTAL-PAID-AMT = 0)
 19438                    GO TO 7300-NEXT-CLAIM
 19439                 END-IF
 19440                 IF (
 19441                      (AH-COVERAGE-CANCELLED)
 19442                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19443                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19444                      and (pb-ci-ah-cancel-amt +
 19445                         pb-c-ah-cancel-amt) <> zeros
 19446                    )
 19447                               OR
 19448                    (
 19449                      (LF-COVERAGE-CANCELLED)
 19450                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 357
* EL050.cbl
 19451                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19452                      and (pb-ci-lf-cancel-amt +
 19453                         pb-c-lf-cancel-amt) <> zeros
 19454                    )
 19455                       MOVE ER-2965 TO WS-ERROR
 19456                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19457                       GO TO 7300-NEXT-CLAIM
 19458                 END-IF
 19459                 IF LF-COVERAGE-CANCELLED
 19460                  IF CL-TOTAL-PAID-AMT > 0
 19461                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19462                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19463                        MOVE ER-2891 TO WS-ERROR
 19464                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19465                        GO TO 7300-NEXT-CLAIM
 19466                      END-IF
 19467                    ELSE
 19468****only show this error if cert num matches exactly
 19469                      IF PB-CERT-NO = CL-CERT-NO
 19470                         MOVE ER-2892 TO WS-ERROR
 19471                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19472                         GO TO 7300-NEXT-CLAIM
 19473                      END-IF
 19474                    END-IF
 19475                  END-IF
 19476                 END-IF
 19477              END-IF
 19478           END-IF
 19479        END-IF
 19480     END-IF
 19481
 19482     GO TO 7300-NEXT-CLAIM.
 19483
 19484 7300-CONTINUE.
 19485
 19486     IF W-BROWSE-SW = 'Y'
 19487
 19488* EXEC CICS ENDBR
 19489*            DATASET   (CLMS-ID)
 19490*        END-EXEC.
 19491     MOVE 0
 19492       TO DFHEIV11
 19493*    MOVE '&2                    $   #00019135' TO DFHEIV0
 19494     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19495     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19496     MOVE X'2020233030303139313335' TO DFHEIV0(25:11)
 19497     CALL 'kxdfhei1' USING DFHEIV0,
 19498           CLMS-ID,
 19499           DFHEIV11,
 19500           DFHEIV99
 19501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19502
 19503
 19504 7300-EXIT.
 19505     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 358
* EL050.cbl
 19507
 19508 7400-GET-REMAIN-TERM.
 19509
 19510* EXEC CICS LINK
 19511*        PROGRAM    ('ELRTRM')
 19512*        COMMAREA   (CALCULATION-PASS-AREA)
 19513*        LENGTH     (CP-COMM-LENGTH)
 19514*    END-EXEC.
 19515     MOVE 'ELRTRM' TO DFHEIV1
 19516*    MOVE '."C                   (   #00019144' TO DFHEIV0
 19517     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19519     MOVE X'2020233030303139313434' TO DFHEIV0(25:11)
 19520     CALL 'kxdfhei1' USING DFHEIV0,
 19521           DFHEIV1,
 19522           CALCULATION-PASS-AREA,
 19523           CP-COMM-LENGTH,
 19524           DFHEIV99,
 19525           DFHEIV99,
 19526           DFHEIV99,
 19527           DFHEIV99
 19528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19529
 19530
 19531 7400-EXIT.
 19532     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 359
* EL050.cbl
 19534
 19535 7500-GET-REMAIN-AMOUNT.
 19536
 19537* EXEC CICS LINK
 19538*        PROGRAM    ('ELRAMT')
 19539*        COMMAREA   (CALCULATION-PASS-AREA)
 19540*        LENGTH     (CP-COMM-LENGTH)
 19541*    END-EXEC.
 19542     MOVE 'ELRAMT' TO DFHEIV1
 19543*    MOVE '."C                   (   #00019155' TO DFHEIV0
 19544     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19545     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19546     MOVE X'2020233030303139313535' TO DFHEIV0(25:11)
 19547     CALL 'kxdfhei1' USING DFHEIV0,
 19548           DFHEIV1,
 19549           CALCULATION-PASS-AREA,
 19550           CP-COMM-LENGTH,
 19551           DFHEIV99,
 19552           DFHEIV99,
 19553           DFHEIV99,
 19554           DFHEIV99
 19555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19556
 19557
 19558 7500-EXIT.
 19559     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 360
* EL050.cbl
 19561
 19562 7600-GET-REFUND.
 19563
 19564* EXEC CICS LINK
 19565*        PROGRAM    ('ELRFND')
 19566*        COMMAREA   (CALCULATION-PASS-AREA)
 19567*        LENGTH     (CP-COMM-LENGTH)
 19568*    END-EXEC.
 19569     MOVE 'ELRFND' TO DFHEIV1
 19570*    MOVE '."C                   (   #00019166' TO DFHEIV0
 19571     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19573     MOVE X'2020233030303139313636' TO DFHEIV0(25:11)
 19574     CALL 'kxdfhei1' USING DFHEIV0,
 19575           DFHEIV1,
 19576           CALCULATION-PASS-AREA,
 19577           CP-COMM-LENGTH,
 19578           DFHEIV99,
 19579           DFHEIV99,
 19580           DFHEIV99,
 19581           DFHEIV99
 19582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19583
 19584
 19585 7600-EXIT.
 19586     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 361
* EL050.cbl
 19588 7700-CALL-DL1.
 19589
 19590* EXEC CICS LINK
 19591*        PROGRAM    ('DLO001')
 19592*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19593*        LENGTH     (DLO001-COMM-LENGTH)
 19594*    END-EXEC.
 19595     MOVE 'DLO001' TO DFHEIV1
 19596*    MOVE '."C                   (   #00019176' TO DFHEIV0
 19597     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19599     MOVE X'2020233030303139313736' TO DFHEIV0(25:11)
 19600     CALL 'kxdfhei1' USING DFHEIV0,
 19601           DFHEIV1,
 19602           WS-DLO-MASTER-POLICY-FORM,
 19603           DLO001-COMM-LENGTH,
 19604           DFHEIV99,
 19605           DFHEIV99,
 19606           DFHEIV99,
 19607           DFHEIV99
 19608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19609
 19610
 19611 7700-EXIT.
 19612     EXIT.
 19613
 19614 7710-CALL-DL2.
 19615
 19616* EXEC CICS LINK
 19617*        PROGRAM    ('DLO002')
 19618*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19619*        LENGTH     (DLO002-COMM-LENGTH)
 19620*    END-EXEC.
 19621     MOVE 'DLO002' TO DFHEIV1
 19622*    MOVE '."C                   (   #00019186' TO DFHEIV0
 19623     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19625     MOVE X'2020233030303139313836' TO DFHEIV0(25:11)
 19626     CALL 'kxdfhei1' USING DFHEIV0,
 19627           DFHEIV1,
 19628           WS-DLO-INTERNAL-POLICY-FORM,
 19629           DLO002-COMM-LENGTH,
 19630           DFHEIV99,
 19631           DFHEIV99,
 19632           DFHEIV99,
 19633           DFHEIV99
 19634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19635
 19636
 19637 7710-EXIT.
 19638     EXIT.
 19639
 19640 7720-CALL-DL3.
 19641
 19642* EXEC CICS LINK
 19643*        PROGRAM    ('DLO003')
 19644*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19645*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 362
* EL050.cbl
 19646*    END-EXEC.
 19647     MOVE 'DLO003' TO DFHEIV1
 19648*    MOVE '."C                   (   #00019196' TO DFHEIV0
 19649     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19651     MOVE X'2020233030303139313936' TO DFHEIV0(25:11)
 19652     CALL 'kxdfhei1' USING DFHEIV0,
 19653           DFHEIV1,
 19654           WS-DLO-VALID-BANK-ID,
 19655           DLO003-COMM-LENGTH,
 19656           DFHEIV99,
 19657           DFHEIV99,
 19658           DFHEIV99,
 19659           DFHEIV99
 19660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19661
 19662
 19663 7720-EXIT.
 19664     EXIT.
 19665
 19666 7730-CALL-DL7.
 19667
 19668* EXEC CICS LINK
 19669*        PROGRAM    ('DLO007')
 19670*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19671*        LENGTH     (DLO007-COMM-LENGTH)
 19672*    END-EXEC.
 19673     MOVE 'DLO007' TO DFHEIV1
 19674*    MOVE '."C                   (   #00019206' TO DFHEIV0
 19675     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19677     MOVE X'2020233030303139323036' TO DFHEIV0(25:11)
 19678     CALL 'kxdfhei1' USING DFHEIV0,
 19679           DFHEIV1,
 19680           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19681           DLO007-COMM-LENGTH,
 19682           DFHEIV99,
 19683           DFHEIV99,
 19684           DFHEIV99,
 19685           DFHEIV99
 19686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19687
 19688
 19689 7730-EXIT.
 19690     EXIT.
 19691
 19692 7740-CALL-DL11.
 19693
 19694* EXEC CICS LINK
 19695*        PROGRAM    ('DLO011')
 19696*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19697*        LENGTH     (DLO011-COMM-LENGTH)
 19698*    END-EXEC.
 19699     MOVE 'DLO011' TO DFHEIV1
 19700*    MOVE '."C                   (   #00019216' TO DFHEIV0
 19701     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19703     MOVE X'2020233030303139323136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 363
* EL050.cbl
 19704     CALL 'kxdfhei1' USING DFHEIV0,
 19705           DFHEIV1,
 19706           WS-DLO-PREM-RATES-BEN-TYPE,
 19707           DLO011-COMM-LENGTH,
 19708           DFHEIV99,
 19709           DFHEIV99,
 19710           DFHEIV99,
 19711           DFHEIV99
 19712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19713
 19714
 19715 7740-EXIT.
 19716     EXIT.
 19717
 19718 7750-CALL-DL17.
 19719
 19720* EXEC CICS LINK
 19721*        PROGRAM    ('DLO017')
 19722*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19723*        LENGTH     (DLO017-COMM-LENGTH)
 19724*    END-EXEC.
 19725     MOVE 'DLO017' TO DFHEIV1
 19726*    MOVE '."C                   (   #00019226' TO DFHEIV0
 19727     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19729     MOVE X'2020233030303139323236' TO DFHEIV0(25:11)
 19730     CALL 'kxdfhei1' USING DFHEIV0,
 19731           DFHEIV1,
 19732           WS-DLO-VALID-RATE-CODE,
 19733           DLO017-COMM-LENGTH,
 19734           DFHEIV99,
 19735           DFHEIV99,
 19736           DFHEIV99,
 19737           DFHEIV99
 19738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19739
 19740
 19741 7750-EXIT.
 19742     EXIT.
 19743
 19744 7755-CALL-DL19.
 19745
 19746* EXEC CICS LINK
 19747*        PROGRAM    ('DLO019')
 19748*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19749*        LENGTH     (DLO019-COMM-LENGTH)
 19750*    END-EXEC.
 19751     MOVE 'DLO019' TO DFHEIV1
 19752*    MOVE '."C                   (   #00019236' TO DFHEIV0
 19753     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19754     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19755     MOVE X'2020233030303139323336' TO DFHEIV0(25:11)
 19756     CALL 'kxdfhei1' USING DFHEIV0,
 19757           DFHEIV1,
 19758           WS-DLO-ORIG-COV-CAT,
 19759           DLO019-COMM-LENGTH,
 19760           DFHEIV99,
 19761           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 364
* EL050.cbl
 19762           DFHEIV99,
 19763           DFHEIV99
 19764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19765
 19766
 19767 7755-EXIT.
 19768     EXIT.
 19769
 19770 7760-CALL-DL21.
 19771
 19772* EXEC CICS LINK
 19773*        PROGRAM    ('DLO021')
 19774*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19775*        LENGTH     (DLO021-COMM-LENGTH)
 19776*    END-EXEC.
 19777     MOVE 'DLO021' TO DFHEIV1
 19778*    MOVE '."C                   (   #00019246' TO DFHEIV0
 19779     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19780     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19781     MOVE X'2020233030303139323436' TO DFHEIV0(25:11)
 19782     CALL 'kxdfhei1' USING DFHEIV0,
 19783           DFHEIV1,
 19784           WS-DLO-VALID-LOAN-OFFICER,
 19785           DLO021-COMM-LENGTH,
 19786           DFHEIV99,
 19787           DFHEIV99,
 19788           DFHEIV99,
 19789           DFHEIV99
 19790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19791
 19792
 19793 7760-EXIT.
 19794     EXIT.
 19795
 19796 7770-CALL-DL22.
 19797
 19798* EXEC CICS LINK
 19799*        PROGRAM    ('DLO022')
 19800*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19801*        LENGTH     (DLO022-COMM-LENGTH)
 19802*    END-EXEC.
 19803     MOVE 'DLO022' TO DFHEIV1
 19804*    MOVE '."C                   (   #00019256' TO DFHEIV0
 19805     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19807     MOVE X'2020233030303139323536' TO DFHEIV0(25:11)
 19808     CALL 'kxdfhei1' USING DFHEIV0,
 19809           DFHEIV1,
 19810           WS-DLO-VALID-STATE-CODE,
 19811           DLO022-COMM-LENGTH,
 19812           DFHEIV99,
 19813           DFHEIV99,
 19814           DFHEIV99,
 19815           DFHEIV99
 19816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19817
 19818
 19819 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 365
* EL050.cbl
 19820     EXIT.
 19821
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 366
* EL050.cbl
 19823
 19824 7780-CALL-AGG.
 19825
 19826* EXEC CICS LINK
 19827*        PROGRAM    ('ELAGGO')
 19828*        COMMAREA   (WS-PASS-to-pemaggo)
 19829*        LENGTH     (ws-passed-key-LENGTH)
 19830*    END-EXEC.
 19831     MOVE 'ELAGGO' TO DFHEIV1
 19832*    MOVE '."C                   (   #00019268' TO DFHEIV0
 19833     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19835     MOVE X'2020233030303139323638' TO DFHEIV0(25:11)
 19836     CALL 'kxdfhei1' USING DFHEIV0,
 19837           DFHEIV1,
 19838           WS-PASS-to-pemaggo,
 19839           ws-passed-key-LENGTH,
 19840           DFHEIV99,
 19841           DFHEIV99,
 19842           DFHEIV99,
 19843           DFHEIV99
 19844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19845
 19846 7780-EXIT.
 19847     EXIT.
 19848 7800-REWRITE-CERT.
 19849******************************************************************
 19850*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19851*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19852******************************************************************
 19853
 19854     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19855        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19856        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19857        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19858
 19859* EXEC CICS REWRITE
 19860*                  DATASET (CERT-ID)
 19861*                  FROM    (CERTIFICATE-MASTER)
 19862*              END-EXEC
 19863     MOVE LENGTH OF
 19864      CERTIFICATE-MASTER
 19865       TO DFHEIV11
 19866*    MOVE '&& L                  %   #00019285' TO DFHEIV0
 19867     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19868     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19869     MOVE X'2020233030303139323835' TO DFHEIV0(25:11)
 19870     CALL 'kxdfhei1' USING DFHEIV0,
 19871           CERT-ID,
 19872           CERTIFICATE-MASTER,
 19873           DFHEIV11,
 19874           DFHEIV99
 19875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19876        GO TO 7800-EXIT.
 19877
 19878       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19879       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19880
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 367
* EL050.cbl
 19881 7800-EXIT.
 19882      EXIT.
 19883
 19884 7900-DELETE-CERT.
 19885
 19886* EXEC CICS DELETE
 19887*        DATASET (CERT-ID)
 19888*    END-EXEC.
 19889*    MOVE '&(                    &   #00019298' TO DFHEIV0
 19890     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19891     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19892     MOVE X'2020233030303139323938' TO DFHEIV0(25:11)
 19893     CALL 'kxdfhei1' USING DFHEIV0,
 19894           CERT-ID,
 19895           DFHEIV99,
 19896           DFHEIV99,
 19897           DFHEIV99,
 19898           DFHEIV99
 19899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19900
 19901
 19902 7900-EXIT.
 19903     EXIT.
 19904
 19905 8000-WRITE-CERT.
 19906
 19907* EXEC CICS HANDLE CONDITION
 19908*        DUPKEY    (8000-FREE-MAIN)
 19909*    END-EXEC.
 19910*    MOVE '"$$                   ! + #00019306' TO DFHEIV0
 19911     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19913     MOVE X'2B20233030303139333036' TO DFHEIV0(25:11)
 19914     CALL 'kxdfhei1' USING DFHEIV0
 19915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19916
 19917
 19918
 19919* EXEC CICS WRITE
 19920*        DATASET     (CERT-ID)
 19921*        FROM        (CERTIFICATE-MASTER)
 19922*        RIDFLD      (ELCERT-KEY)
 19923*    END-EXEC.
 19924     MOVE LENGTH OF
 19925      CERTIFICATE-MASTER
 19926       TO DFHEIV11
 19927*    MOVE '&$ L                  ''   #00019310' TO DFHEIV0
 19928     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19929     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19930     MOVE X'2020233030303139333130' TO DFHEIV0(25:11)
 19931     CALL 'kxdfhei1' USING DFHEIV0,
 19932           CERT-ID,
 19933           CERTIFICATE-MASTER,
 19934           DFHEIV11,
 19935           ELCERT-KEY,
 19936           DFHEIV99,
 19937           DFHEIV99
 19938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 368
* EL050.cbl
 19939
 19940
 19941 8000-FREE-MAIN.
 19942
 19943 8000-EXIT.
 19944      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 369
* EL050.cbl
 19946
 19947 8100-READ-ERPNDM.
 19948
 19949* EXEC CICS HANDLE CONDITION
 19950*         NOTFND     (8100-NOTFND)
 19951*         ENDFILE    (8100-NOTFND)
 19952*    END-EXEC.
 19953*    MOVE '"$I''                  ! , #00019323' TO DFHEIV0
 19954     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19956     MOVE X'2C20233030303139333233' TO DFHEIV0(25:11)
 19957     CALL 'kxdfhei1' USING DFHEIV0
 19958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19959
 19960
 19961     MOVE SPACES                 TO ERPNDM-FOUND.
 19962     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19963
 19964
 19965* EXEC CICS READ
 19966*         DATASET   (FILE-ERPNDM)
 19967*         RIDFLD    (PM-CONTROL-PRIMARY)
 19968*         INTO      (PENDING-MAILING-DATA)
 19969*    END-EXEC.
 19970     MOVE LENGTH OF
 19971      PENDING-MAILING-DATA
 19972       TO DFHEIV11
 19973*    MOVE '&"IL       E          (   #00019331' TO DFHEIV0
 19974     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19975     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19976     MOVE X'2020233030303139333331' TO DFHEIV0(25:11)
 19977     CALL 'kxdfhei1' USING DFHEIV0,
 19978           FILE-ERPNDM,
 19979           PENDING-MAILING-DATA,
 19980           DFHEIV11,
 19981           PM-CONTROL-PRIMARY,
 19982           DFHEIV99,
 19983           DFHEIV99,
 19984           DFHEIV99
 19985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19986
 19987
 19988     GO TO 8100-EXIT.
 19989
 19990 8100-NOTFND.
 19991
 19992     MOVE 'X'                    TO ERPNDM-FOUND.
 19993     MOVE ER-2694                TO WS-ERROR.
 19994     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19995     MOVE ER-2883                TO WS-ERROR
 19996     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19997     .
 19998 8100-EXIT.
 19999     EXIT.
 20000
 20001 8110-READ-ERMAIL.
 20002
 20003* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 370
* EL050.cbl
 20004*         NOTFND     (8110-NOTFND)
 20005*         ENDFILE    (8110-NOTFND)
 20006*    END-EXEC.
 20007*    MOVE '"$I''                  ! - #00019351' TO DFHEIV0
 20008     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20010     MOVE X'2D20233030303139333531' TO DFHEIV0(25:11)
 20011     CALL 'kxdfhei1' USING DFHEIV0
 20012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20013
 20014
 20015     MOVE SPACES                 TO ERMAIL-FOUND.
 20016     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20017     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20018     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20019     MOVE PB-SV-STATE            TO MA-STATE.
 20020
 20021
 20022* EXEC CICS READ
 20023*         UPDATE
 20024*         DATASET   (FILE-ERMAIL)
 20025*         RIDFLD    (MA-CONTROL-PRIMARY)
 20026*         INTO      (MAILING-DATA)
 20027*    END-EXEC.
 20028     MOVE LENGTH OF
 20029      MAILING-DATA
 20030       TO DFHEIV11
 20031*    MOVE '&"IL       EU         (   #00019362' TO DFHEIV0
 20032     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20033     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20034     MOVE X'2020233030303139333632' TO DFHEIV0(25:11)
 20035     CALL 'kxdfhei1' USING DFHEIV0,
 20036           FILE-ERMAIL,
 20037           MAILING-DATA,
 20038           DFHEIV11,
 20039           MA-CONTROL-PRIMARY,
 20040           DFHEIV99,
 20041           DFHEIV99,
 20042           DFHEIV99
 20043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20044
 20045
 20046     GO TO 8110-EXIT.
 20047
 20048 8110-NOTFND.
 20049     MOVE 'X'                    TO ERMAIL-FOUND.
 20050
 20051 8110-EXIT.
 20052     EXIT.
 20053
 20054 8120-REWRITE-ERMAIL.
 20055
 20056* EXEC CICS REWRITE
 20057*         DATASET    (FILE-ERMAIL)
 20058*         FROM       (MAILING-DATA)
 20059*    END-EXEC.
 20060     MOVE LENGTH OF
 20061      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 371
* EL050.cbl
 20062       TO DFHEIV11
 20063*    MOVE '&& L                  %   #00019378' TO DFHEIV0
 20064     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20065     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20066     MOVE X'2020233030303139333738' TO DFHEIV0(25:11)
 20067     CALL 'kxdfhei1' USING DFHEIV0,
 20068           FILE-ERMAIL,
 20069           MAILING-DATA,
 20070           DFHEIV11,
 20071           DFHEIV99
 20072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20073
 20074
 20075 8120-EXIT.
 20076     EXIT.
 20077
 20078 8130-WRITE-ERMAIL.
 20079
 20080* EXEC CICS HANDLE CONDITION
 20081*         DUPKEY   (8130-EXIT)
 20082*    END-EXEC.
 20083*    MOVE '"$$                   ! . #00019387' TO DFHEIV0
 20084     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20086     MOVE X'2E20233030303139333837' TO DFHEIV0(25:11)
 20087     CALL 'kxdfhei1' USING DFHEIV0
 20088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20089
 20090
 20091
 20092* EXEC CICS WRITE
 20093*         DATASET     (FILE-ERMAIL)
 20094*         RIDFLD      (MA-CONTROL-PRIMARY)
 20095*         FROM        (MAILING-DATA)
 20096*    END-EXEC.
 20097     MOVE LENGTH OF
 20098      MAILING-DATA
 20099       TO DFHEIV11
 20100*    MOVE '&$ L                  ''   #00019391' TO DFHEIV0
 20101     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20102     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20103     MOVE X'2020233030303139333931' TO DFHEIV0(25:11)
 20104     CALL 'kxdfhei1' USING DFHEIV0,
 20105           FILE-ERMAIL,
 20106           MAILING-DATA,
 20107           DFHEIV11,
 20108           MA-CONTROL-PRIMARY,
 20109           DFHEIV99,
 20110           DFHEIV99
 20111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20112
 20113
 20114 8130-EXIT.
 20115     EXIT.
 20116
 20117 8140-UNLOCK-ERMAIL.
 20118
 20119* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 372
* EL050.cbl
 20120*         DATASET   (FILE-ERMAIL)
 20121*    END-EXEC.
 20122*    MOVE '&*                    #   #00019401' TO DFHEIV0
 20123     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20124     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20125     MOVE X'2020233030303139343031' TO DFHEIV0(25:11)
 20126     CALL 'kxdfhei1' USING DFHEIV0,
 20127           FILE-ERMAIL,
 20128           DFHEIV99
 20129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20130
 20131
 20132 8140-EXIT.
 20133     EXIT.
 20134
 20135 8150-read-elcrtt.
 20136
 20137
 20138* EXEC CICS HANDLE CONDITION
 20139*        NOTFND   (8150-exit)
 20140*    END-EXEC
 20141*    MOVE '"$I                   ! / #00019410' TO DFHEIV0
 20142     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20144     MOVE X'2F20233030303139343130' TO DFHEIV0(25:11)
 20145     CALL 'kxdfhei1' USING DFHEIV0
 20146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20147
 20148     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20149     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20150
 20151
 20152* EXEC CICS READ
 20153*        DATASET  (CRTT-ID)
 20154*        RIDFLD   (WS-ELCRTT-KEY)
 20155*        INTO     (CERTIFICATE-TRAILERS)
 20156*    END-EXEC
 20157     MOVE LENGTH OF
 20158      CERTIFICATE-TRAILERS
 20159       TO DFHEIV11
 20160*    MOVE '&"IL       E          (   #00019417' TO DFHEIV0
 20161     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20163     MOVE X'2020233030303139343137' TO DFHEIV0(25:11)
 20164     CALL 'kxdfhei1' USING DFHEIV0,
 20165           CRTT-ID,
 20166           CERTIFICATE-TRAILERS,
 20167           DFHEIV11,
 20168           WS-ELCRTT-KEY,
 20169           DFHEIV99,
 20170           DFHEIV99,
 20171           DFHEIV99
 20172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20173
 20174     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20175     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20176     move cs-vehicle-odometer    to ws-vehicle-odometer
 20177
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 373
* EL050.cbl
 20178     .
 20179 8150-exit.
 20180     exit.
 20181 8180-UPDATE-VIN-NUMBER.
 20182
 20183* EXEC CICS HANDLE CONDITION
 20184*        NOTFND   (8180-NOTFND)
 20185*    END-EXEC.
 20186*    MOVE '"$I                   ! 0 #00019431' TO DFHEIV0
 20187     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20189     MOVE X'3020233030303139343331' TO DFHEIV0(25:11)
 20190     CALL 'kxdfhei1' USING DFHEIV0
 20191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20192
 20193
 20194     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20195     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20196
 20197
 20198* EXEC CICS READ
 20199*        UPDATE
 20200*        DATASET  (CRTT-ID)
 20201*        RIDFLD   (WS-ELCRTT-KEY)
 20202*        INTO     (CERTIFICATE-TRAILERS)
 20203*    END-EXEC.
 20204     MOVE LENGTH OF
 20205      CERTIFICATE-TRAILERS
 20206       TO DFHEIV11
 20207*    MOVE '&"IL       EU         (   #00019438' TO DFHEIV0
 20208     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20209     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20210     MOVE X'2020233030303139343338' TO DFHEIV0(25:11)
 20211     CALL 'kxdfhei1' USING DFHEIV0,
 20212           CRTT-ID,
 20213           CERTIFICATE-TRAILERS,
 20214           DFHEIV11,
 20215           WS-ELCRTT-KEY,
 20216           DFHEIV99,
 20217           DFHEIV99,
 20218           DFHEIV99
 20219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20220
 20221
 20222     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20223         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20224
 20225* EXEC CICS REWRITE
 20226*           DATASET  (CRTT-ID)
 20227*           FROM     (CERTIFICATE-TRAILERS)
 20228*        END-EXEC
 20229     MOVE LENGTH OF
 20230      CERTIFICATE-TRAILERS
 20231       TO DFHEIV11
 20232*    MOVE '&& L                  %   #00019447' TO DFHEIV0
 20233     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20234     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20235     MOVE X'2020233030303139343437' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 374
* EL050.cbl
 20236     CALL 'kxdfhei1' USING DFHEIV0,
 20237           CRTT-ID,
 20238           CERTIFICATE-TRAILERS,
 20239           DFHEIV11,
 20240           DFHEIV99
 20241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20242     ELSE
 20243
 20244* EXEC CICS UNLOCK
 20245*          DATASET  (CRTT-ID)
 20246*       END-EXEC
 20247*    MOVE '&*                    #   #00019452' TO DFHEIV0
 20248     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20249     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20250     MOVE X'2020233030303139343532' TO DFHEIV0(25:11)
 20251     CALL 'kxdfhei1' USING DFHEIV0,
 20252           CRTT-ID,
 20253           DFHEIV99
 20254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20255     END-IF.
 20256
 20257     GO TO 8180-EXIT.
 20258
 20259 8180-NOTFND.
 20260
 20261     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20262     MOVE 'CS'         TO CS-RECORD-ID.
 20263     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20264     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20265     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20266     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20267
 20268* EXEC CICS WRITE
 20269*       DATASET  (CRTT-ID)
 20270*       RIDFLD   (WS-ELCRTT-KEY)
 20271*       FROM     (CERTIFICATE-TRAILERS)
 20272*    END-EXEC.
 20273     MOVE LENGTH OF
 20274      CERTIFICATE-TRAILERS
 20275       TO DFHEIV11
 20276*    MOVE '&$ L                  ''   #00019467' TO DFHEIV0
 20277     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20278     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20279     MOVE X'2020233030303139343637' TO DFHEIV0(25:11)
 20280     CALL 'kxdfhei1' USING DFHEIV0,
 20281           CRTT-ID,
 20282           CERTIFICATE-TRAILERS,
 20283           DFHEIV11,
 20284           WS-ELCRTT-KEY,
 20285           DFHEIV99,
 20286           DFHEIV99
 20287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20288
 20289
 20290 8180-EXIT.
 20291     EXIT.
 20292
 20293 8190-UPDATE-REFUND-CLAIM-FLAG.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 375
* EL050.cbl
 20294
 20295* EXEC CICS HANDLE CONDITION
 20296*        NOTFND   (8190-NOTFND)
 20297*    END-EXEC.
 20298*    MOVE '"$I                   ! 1 #00019477' TO DFHEIV0
 20299     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20301     MOVE X'3120233030303139343737' TO DFHEIV0(25:11)
 20302     CALL 'kxdfhei1' USING DFHEIV0
 20303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20304
 20305
 20306     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20307     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20308
 20309
 20310* EXEC CICS READ
 20311*        UPDATE
 20312*        DATASET  (CRTT-ID)
 20313*        RIDFLD   (WS-ELCRTT-KEY)
 20314*        INTO     (CERTIFICATE-TRAILERS)
 20315*    END-EXEC.
 20316     MOVE LENGTH OF
 20317      CERTIFICATE-TRAILERS
 20318       TO DFHEIV11
 20319*    MOVE '&"IL       EU         (   #00019484' TO DFHEIV0
 20320     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20321     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20322     MOVE X'2020233030303139343834' TO DFHEIV0(25:11)
 20323     CALL 'kxdfhei1' USING DFHEIV0,
 20324           CRTT-ID,
 20325           CERTIFICATE-TRAILERS,
 20326           DFHEIV11,
 20327           WS-ELCRTT-KEY,
 20328           DFHEIV99,
 20329           DFHEIV99,
 20330           DFHEIV99
 20331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20332
 20333
 20334     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20335
 20336* EXEC CICS REWRITE
 20337*       DATASET  (CRTT-ID)
 20338*       FROM     (CERTIFICATE-TRAILERS)
 20339*    END-EXEC.
 20340     MOVE LENGTH OF
 20341      CERTIFICATE-TRAILERS
 20342       TO DFHEIV11
 20343*    MOVE '&& L                  %   #00019492' TO DFHEIV0
 20344     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20345     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20346     MOVE X'2020233030303139343932' TO DFHEIV0(25:11)
 20347     CALL 'kxdfhei1' USING DFHEIV0,
 20348           CRTT-ID,
 20349           CERTIFICATE-TRAILERS,
 20350           DFHEIV11,
 20351           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 376
* EL050.cbl
 20352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20353
 20354
 20355     GO TO 8190-EXIT.
 20356
 20357 8190-NOTFND.
 20358
 20359     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20360     MOVE 'CS'         TO CS-RECORD-ID.
 20361     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20362     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20363     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20364     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20365
 20366* EXEC CICS WRITE
 20367*       DATASET  (CRTT-ID)
 20368*       RIDFLD   (WS-ELCRTT-KEY)
 20369*       FROM     (CERTIFICATE-TRAILERS)
 20370*    END-EXEC.
 20371     MOVE LENGTH OF
 20372      CERTIFICATE-TRAILERS
 20373       TO DFHEIV11
 20374*    MOVE '&$ L                  ''   #00019507' TO DFHEIV0
 20375     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20376     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20377     MOVE X'2020233030303139353037' TO DFHEIV0(25:11)
 20378     CALL 'kxdfhei1' USING DFHEIV0,
 20379           CRTT-ID,
 20380           CERTIFICATE-TRAILERS,
 20381           DFHEIV11,
 20382           WS-ELCRTT-KEY,
 20383           DFHEIV99,
 20384           DFHEIV99
 20385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20386
 20387
 20388 8190-EXIT.
 20389     EXIT.
 20390
 20391 8195-UPDATE-AGE-FLAGS.
 20392
 20393* EXEC CICS HANDLE CONDITION
 20394*        NOTFND   (8195-NOTFND)
 20395*    END-EXEC.
 20396*    MOVE '"$I                   ! 2 #00019517' TO DFHEIV0
 20397     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20399     MOVE X'3220233030303139353137' TO DFHEIV0(25:11)
 20400     CALL 'kxdfhei1' USING DFHEIV0
 20401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20402
 20403
 20404     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20405     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20406
 20407
 20408* EXEC CICS READ
 20409*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 377
* EL050.cbl
 20410*        DATASET  (CRTT-ID)
 20411*        RIDFLD   (WS-ELCRTT-KEY)
 20412*        INTO     (CERTIFICATE-TRAILERS)
 20413*    END-EXEC.
 20414     MOVE LENGTH OF
 20415      CERTIFICATE-TRAILERS
 20416       TO DFHEIV11
 20417*    MOVE '&"IL       EU         (   #00019524' TO DFHEIV0
 20418     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20419     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20420     MOVE X'2020233030303139353234' TO DFHEIV0(25:11)
 20421     CALL 'kxdfhei1' USING DFHEIV0,
 20422           CRTT-ID,
 20423           CERTIFICATE-TRAILERS,
 20424           DFHEIV11,
 20425           WS-ELCRTT-KEY,
 20426           DFHEIV99,
 20427           DFHEIV99,
 20428           DFHEIV99
 20429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20430
 20431
 20432     IF WS-INS-AGE-SET = 'Y'
 20433        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20434     END-IF
 20435     IF WS-JNT-AGE-SET = 'Y'
 20436        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20437     END-IF
 20438
 20439
 20440* EXEC CICS REWRITE
 20441*       DATASET  (CRTT-ID)
 20442*       FROM     (CERTIFICATE-TRAILERS)
 20443*    END-EXEC.
 20444     MOVE LENGTH OF
 20445      CERTIFICATE-TRAILERS
 20446       TO DFHEIV11
 20447*    MOVE '&& L                  %   #00019538' TO DFHEIV0
 20448     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20449     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20450     MOVE X'2020233030303139353338' TO DFHEIV0(25:11)
 20451     CALL 'kxdfhei1' USING DFHEIV0,
 20452           CRTT-ID,
 20453           CERTIFICATE-TRAILERS,
 20454           DFHEIV11,
 20455           DFHEIV99
 20456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20457
 20458
 20459     GO TO 8195-EXIT.
 20460
 20461 8195-NOTFND.
 20462
 20463     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20464     MOVE 'CS'         TO CS-RECORD-ID.
 20465     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20466     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20467     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 378
* EL050.cbl
 20468     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20469     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20470
 20471* EXEC CICS WRITE
 20472*       DATASET  (CRTT-ID)
 20473*       RIDFLD   (WS-ELCRTT-KEY)
 20474*       FROM     (CERTIFICATE-TRAILERS)
 20475*    END-EXEC.
 20476     MOVE LENGTH OF
 20477      CERTIFICATE-TRAILERS
 20478       TO DFHEIV11
 20479*    MOVE '&$ L                  ''   #00019554' TO DFHEIV0
 20480     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20481     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20482     MOVE X'2020233030303139353534' TO DFHEIV0(25:11)
 20483     CALL 'kxdfhei1' USING DFHEIV0,
 20484           CRTT-ID,
 20485           CERTIFICATE-TRAILERS,
 20486           DFHEIV11,
 20487           WS-ELCRTT-KEY,
 20488           DFHEIV99,
 20489           DFHEIV99
 20490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20491
 20492
 20493 8195-EXIT.
 20494     EXIT.
 20495
 20496 8200-READ-REIN-TABLE.
 20497
 20498* EXEC CICS HANDLE CONDITION
 20499*         NOTFND   (8200-NOTFND)
 20500*    END-EXEC.
 20501*    MOVE '"$I                   ! 3 #00019564' TO DFHEIV0
 20502     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20504     MOVE X'3320233030303139353634' TO DFHEIV0(25:11)
 20505     CALL 'kxdfhei1' USING DFHEIV0
 20506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20507
 20508
 20509
 20510* EXEC CICS READ
 20511*        DATASET     (REIN-ID)
 20512*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20513*        RIDFLD      (ERREIN-KEY)
 20514*    END-EXEC.
 20515*    MOVE '&"S        E          (   #00019568' TO DFHEIV0
 20516     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20517     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20518     MOVE X'2020233030303139353638' TO DFHEIV0(25:11)
 20519     CALL 'kxdfhei1' USING DFHEIV0,
 20520           REIN-ID,
 20521           DFHEIV20,
 20522           DFHEIV99,
 20523           ERREIN-KEY,
 20524           DFHEIV99,
 20525           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 379
* EL050.cbl
 20526           DFHEIV99
 20527     SET ADDRESS OF REINSURANCE-RECORD TO
 20528         DFHEIV20
 20529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20530
 20531
 20532     GO TO 8200-EXIT.
 20533
 20534 8200-NOTFND.
 20535     MOVE 'N'             TO WS-REIN-READ-SW.
 20536
 20537 8200-EXIT.
 20538      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 380
* EL050.cbl
 20540
 20541 8300-READ-CTBL-TABLE.
 20542
 20543* EXEC CICS HANDLE CONDITION
 20544*        NOTFND    (8300-NOTFND)
 20545*        DISABLED  (8300-ERRESS-PROBLEM)
 20546*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20547*        ENDFILE   (8300-NOTFND)
 20548*    END-EXEC.
 20549*    MOVE '"$IcJ''                ! 4 #00019584' TO DFHEIV0
 20550     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20552     MOVE X'3420233030303139353834' TO DFHEIV0(25:11)
 20553     CALL 'kxdfhei1' USING DFHEIV0
 20554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20555
 20556
 20557
 20558* EXEC CICS READ
 20559*        DATASET     (CTBL-ID)
 20560*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20561*        RIDFLD      (ERCTBL-KEY)
 20562*    END-EXEC.
 20563*    MOVE '&"S        E          (   #00019591' TO DFHEIV0
 20564     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20565     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20566     MOVE X'2020233030303139353931' TO DFHEIV0(25:11)
 20567     CALL 'kxdfhei1' USING DFHEIV0,
 20568           CTBL-ID,
 20569           DFHEIV20,
 20570           DFHEIV99,
 20571           ERCTBL-KEY,
 20572           DFHEIV99,
 20573           DFHEIV99,
 20574           DFHEIV99
 20575     SET ADDRESS OF COMM-TABLE-RECORD TO
 20576         DFHEIV20
 20577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20578
 20579
 20580     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20581
 20582     GO TO 8300-EXIT.
 20583
 20584 8300-NOTFND.
 20585
 20586     IF CTBL-SW = '0530'
 20587         MOVE 'AA'                     TO WS-AH-COMP-CD
 20588         MOVE '0550'                   TO CTBL-SW
 20589         MOVE '1'                      TO WS-CTBL-READ-SW
 20590         GO TO 8300-EXIT.
 20591
 20592     IF CTBL-SW = '0540'
 20593         MOVE 'AA'                     TO WS-LF-COMP-CD
 20594         MOVE '0550'                   TO CTBL-SW
 20595         MOVE '1'                      TO WS-CTBL-READ-SW
 20596         GO TO 8300-EXIT.
 20597
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 381
* EL050.cbl
 20598     IF CTBL-SW = '0550'
 20599         MOVE '2'                      TO WS-CTBL-READ-SW
 20600         GO TO 8300-EXIT.
 20601
 20602     GO TO 8300-EXIT.
 20603
 20604 8300-ERRESS-PROBLEM.
 20605
 20606      MOVE ER-8050              TO WS-ERROR.
 20607      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20608
 20609     GO TO 8300-EXIT.
 20610
 20611 8300-EXIT.
 20612      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 382
* EL050.cbl
 20614
 20615
 20616 8400-GETMAIN-ERFORM.
 20617
 20618
 20619* EXEC CICS   GETMAIN
 20620*        LENGTH  (500)
 20621*        SET     (ADDRESS OF FORM-MASTER)
 20622*    END-EXEC.
 20623     MOVE 500
 20624       TO DFHEIV11
 20625*    MOVE '," L                  $   #00019635' TO DFHEIV0
 20626     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20627     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20628     MOVE X'2020233030303139363335' TO DFHEIV0(25:11)
 20629     CALL 'kxdfhei1' USING DFHEIV0,
 20630           DFHEIV20,
 20631           DFHEIV11,
 20632           DFHEIV99
 20633     SET ADDRESS OF FORM-MASTER TO
 20634         DFHEIV20
 20635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20636
 20637
 20638     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20639
 20640 8400-EXIT.
 20641      EXIT.
 20642
 20643 8450-READ-FORM-MASTER.
 20644
 20645
 20646* EXEC CICS  HANDLE CONDITION
 20647*        NOTFND   (8450-FORM-NOT-FOUND)
 20648*        ENDFILE  (8450-FORM-NOT-FOUND)
 20649*    END-EXEC.
 20650*    MOVE '"$I''                  ! 5 #00019647' TO DFHEIV0
 20651     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20653     MOVE X'3520233030303139363437' TO DFHEIV0(25:11)
 20654     CALL 'kxdfhei1' USING DFHEIV0
 20655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20656
 20657
 20658
 20659* EXEC CICS   READ
 20660*        DATASET   (FORM-ID)
 20661*        RIDFLD    (ERFORM-KEY)
 20662*        INTO      (FORM-MASTER)
 20663*        GTEQ
 20664*    END-EXEC.
 20665     MOVE LENGTH OF
 20666      FORM-MASTER
 20667       TO DFHEIV11
 20668*    MOVE '&"IL       G          (   #00019652' TO DFHEIV0
 20669     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20670     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20671     MOVE X'2020233030303139363532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 383
* EL050.cbl
 20672     CALL 'kxdfhei1' USING DFHEIV0,
 20673           FORM-ID,
 20674           FORM-MASTER,
 20675           DFHEIV11,
 20676           ERFORM-KEY,
 20677           DFHEIV99,
 20678           DFHEIV99,
 20679           DFHEIV99
 20680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20681
 20682
 20683     MOVE  'Y'           TO  FORM-MASTER-SW.
 20684
 20685     GO TO  8450-EXIT.
 20686
 20687 8450-FORM-NOT-FOUND.
 20688
 20689     MOVE  'N'           TO  FORM-MASTER-SW.
 20690
 20691 8450-EXIT.
 20692      EXIT.
 20693
 20694 8500-DATE-CONVERT.
 20695
 20696* EXEC CICS LINK
 20697*        PROGRAM    ('ELDATCV')
 20698*        COMMAREA   (DATE-CONVERSION-DATA)
 20699*        LENGTH     (DC-COMM-LENGTH)
 20700*    END-EXEC.
 20701     MOVE 'ELDATCV' TO DFHEIV1
 20702*    MOVE '."C                   (   #00019671' TO DFHEIV0
 20703     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20705     MOVE X'2020233030303139363731' TO DFHEIV0(25:11)
 20706     CALL 'kxdfhei1' USING DFHEIV0,
 20707           DFHEIV1,
 20708           DATE-CONVERSION-DATA,
 20709           DC-COMM-LENGTH,
 20710           DFHEIV99,
 20711           DFHEIV99,
 20712           DFHEIV99,
 20713           DFHEIV99
 20714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20715
 20716
 20717 8500-EXIT.
 20718     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 384
* EL050.cbl
 20720
 20721 8555-RELOAD-CONTROL-FILE.
 20722     CONTINUE.
 20723
 20724 8555-EXIT.
 20725     EXIT.
 20726
 20727 8557-GETMAIN-ERPLAN.
 20728
 20729
 20730* EXEC CICS GETMAIN
 20731*        LENGTH    (840)
 20732*        SET       (ADDRESS OF PLAN-RECORDS)
 20733*    END-EXEC.
 20734     MOVE 840
 20735       TO DFHEIV11
 20736*    MOVE '," L                  $   #00019689' TO DFHEIV0
 20737     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20738     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20739     MOVE X'2020233030303139363839' TO DFHEIV0(25:11)
 20740     CALL 'kxdfhei1' USING DFHEIV0,
 20741           DFHEIV20,
 20742           DFHEIV11,
 20743           DFHEIV99
 20744     SET ADDRESS OF PLAN-RECORDS TO
 20745         DFHEIV20
 20746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20747
 20748
 20749     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20750
 20751 8557-EXIT.
 20752     EXIT.
 20753
 20754 8560-GETMAIN.
 20755
 20756* EXEC CICS GETMAIN
 20757*        LENGTH    (2000)
 20758*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20759*    END-EXEC.
 20760     MOVE 2000
 20761       TO DFHEIV11
 20762*    MOVE '," L                  $   #00019700' TO DFHEIV0
 20763     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20764     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20765     MOVE X'2020233030303139373030' TO DFHEIV0(25:11)
 20766     CALL 'kxdfhei1' USING DFHEIV0,
 20767           DFHEIV20,
 20768           DFHEIV11,
 20769           DFHEIV99
 20770     SET ADDRESS OF ACCOUNT-MASTER TO
 20771         DFHEIV20
 20772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20773
 20774
 20775     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20776
 20777 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 385
* EL050.cbl
 20778     EXIT.
 20779
 20780 8570-START-ACCOUNT-MASTER.
 20781
 20782* EXEC CICS HANDLE CONDITION
 20783*        NOTFND    (0199-ACCT-NOT-FOUND)
 20784*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20785*    END-EXEC.
 20786*    MOVE '"$I''                  ! 6 #00019711' TO DFHEIV0
 20787     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20789     MOVE X'3620233030303139373131' TO DFHEIV0(25:11)
 20790     CALL 'kxdfhei1' USING DFHEIV0
 20791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20792
 20793
 20794
 20795* EXEC CICS STARTBR
 20796*        DATASET    (ACCT-ID)
 20797*        RIDFLD     (ERACCT-KEY)
 20798*        GTEQ
 20799*    END-EXEC.
 20800     MOVE 0
 20801       TO DFHEIV11
 20802*    MOVE '&,         G          &   #00019716' TO DFHEIV0
 20803     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20804     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20805     MOVE X'2020233030303139373136' TO DFHEIV0(25:11)
 20806     CALL 'kxdfhei1' USING DFHEIV0,
 20807           ACCT-ID,
 20808           ERACCT-KEY,
 20809           DFHEIV99,
 20810           DFHEIV11,
 20811           DFHEIV99
 20812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20813
 20814
 20815 8570-EXIT.
 20816     EXIT.
 20817
 20818 8580-READ-ACCOUNT-MASTER.
 20819
 20820* EXEC CICS HANDLE CONDITION
 20821*        NOTFND    (0199-ACCT-NOT-FOUND)
 20822*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20823*    END-EXEC.
 20824*    MOVE '"$I''                  ! 7 #00019726' TO DFHEIV0
 20825     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20827     MOVE X'3720233030303139373236' TO DFHEIV0(25:11)
 20828     CALL 'kxdfhei1' USING DFHEIV0
 20829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20830
 20831
 20832
 20833* EXEC CICS READNEXT
 20834*        DATASET     (ACCT-ID)
 20835*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 386
* EL050.cbl
 20836*        RIDFLD      (ERACCT-KEY)
 20837*    END-EXEC.
 20838     MOVE LENGTH OF
 20839      ACCOUNT-MASTER
 20840       TO DFHEIV12
 20841     MOVE 0
 20842       TO DFHEIV11
 20843*    MOVE '&.IL                  )   #00019731' TO DFHEIV0
 20844     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20845     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20846     MOVE X'2020233030303139373331' TO DFHEIV0(25:11)
 20847     CALL 'kxdfhei1' USING DFHEIV0,
 20848           ACCT-ID,
 20849           ACCOUNT-MASTER,
 20850           DFHEIV12,
 20851           ERACCT-KEY,
 20852           DFHEIV99,
 20853           DFHEIV11,
 20854           DFHEIV99,
 20855           DFHEIV99
 20856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20857
 20858
 20859 8580-EXIT.
 20860     EXIT.
 20861
 20862 8582-READ-COMPENSATION-MASTER.
 20863
 20864* EXEC CICS HANDLE CONDITION
 20865*        NOTFND    (8582-COMP-NOT-FOUND)
 20866*        ENDFILE   (8582-COMP-NOT-FOUND)
 20867*    END-EXEC.
 20868*    MOVE '"$I''                  ! 8 #00019741' TO DFHEIV0
 20869     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20871     MOVE X'3820233030303139373431' TO DFHEIV0(25:11)
 20872     CALL 'kxdfhei1' USING DFHEIV0
 20873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20874
 20875
 20876
 20877* EXEC CICS READ
 20878*        DATASET     (COMP-ID)
 20879*        INTO        (COMPENSATION-MASTER)
 20880*        RIDFLD      (ERCOMP-KEY)
 20881*    END-EXEC.
 20882     MOVE LENGTH OF
 20883      COMPENSATION-MASTER
 20884       TO DFHEIV11
 20885*    MOVE '&"IL       E          (   #00019746' TO DFHEIV0
 20886     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20887     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20888     MOVE X'2020233030303139373436' TO DFHEIV0(25:11)
 20889     CALL 'kxdfhei1' USING DFHEIV0,
 20890           COMP-ID,
 20891           COMPENSATION-MASTER,
 20892           DFHEIV11,
 20893           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 387
* EL050.cbl
 20894           DFHEIV99,
 20895           DFHEIV99,
 20896           DFHEIV99
 20897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20898
 20899
 20900     MOVE 'Y'                    TO COMP-MASTER-SW
 20901
 20902     GO TO 8582-EXIT
 20903     .
 20904 8582-COMP-NOT-FOUND.
 20905
 20906     MOVE 'N'                    TO COMP-MASTER-SW.
 20907
 20908 8582-EXIT.
 20909     EXIT.
 20910
 20911 8583-READ-ERAGTC.
 20912
 20913* EXEC CICS HANDLE CONDITION
 20914*        NOTFND    (8583-AGTC-NOT-FOUND)
 20915*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20916*    END-EXEC.
 20917*    MOVE '"$I''                  ! 9 #00019764' TO DFHEIV0
 20918     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20920     MOVE X'3920233030303139373634' TO DFHEIV0(25:11)
 20921     CALL 'kxdfhei1' USING DFHEIV0
 20922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20923
 20924
 20925
 20926* EXEC CICS STARTBR
 20927*        DATASET    (AGTC-ID)
 20928*        RIDFLD     (ERAGTC-KEY)
 20929*        GTEQ
 20930*    END-EXEC.
 20931     MOVE 0
 20932       TO DFHEIV11
 20933*    MOVE '&,         G          &   #00019769' TO DFHEIV0
 20934     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20935     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20936     MOVE X'2020233030303139373639' TO DFHEIV0(25:11)
 20937     CALL 'kxdfhei1' USING DFHEIV0,
 20938           AGTC-ID,
 20939           ERAGTC-KEY,
 20940           DFHEIV99,
 20941           DFHEIV11,
 20942           DFHEIV99
 20943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20944
 20945
 20946 8583-READ-ERAGTC-NEXT.
 20947
 20948* EXEC CICS READNEXT
 20949*        DATASET     (AGTC-ID)
 20950*        INTO        (AGENT-COMMISSIONS)
 20951*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 388
* EL050.cbl
 20952*    END-EXEC.
 20953     MOVE LENGTH OF
 20954      AGENT-COMMISSIONS
 20955       TO DFHEIV12
 20956     MOVE 0
 20957       TO DFHEIV11
 20958*    MOVE '&.IL                  )   #00019776' TO DFHEIV0
 20959     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20960     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20961     MOVE X'2020233030303139373736' TO DFHEIV0(25:11)
 20962     CALL 'kxdfhei1' USING DFHEIV0,
 20963           AGTC-ID,
 20964           AGENT-COMMISSIONS,
 20965           DFHEIV12,
 20966           ERAGTC-KEY,
 20967           DFHEIV99,
 20968           DFHEIV11,
 20969           DFHEIV99,
 20970           DFHEIV99
 20971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20972
 20973
 20974*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20975
 20976     GO TO 8583-EXIT
 20977     .
 20978 8583-AGTC-NOT-FOUND.
 20979
 20980     MOVE 'N'                    TO AGTC-MASTER-SW.
 20981
 20982 8583-EXIT.
 20983     EXIT.
 20984
 20985 8584-READ-BANK-CROSS-REF.
 20986
 20987* EXEC CICS HANDLE CONDITION
 20988*        NOTFND    (8584-BXRF-NOT-FOUND)
 20989*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20990*    END-EXEC.
 20991*    MOVE '"$I''                  ! : #00019794' TO DFHEIV0
 20992     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20994     MOVE X'3A20233030303139373934' TO DFHEIV0(25:11)
 20995     CALL 'kxdfhei1' USING DFHEIV0
 20996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20997
 20998
 20999
 21000* EXEC CICS READ
 21001*        DATASET     (BXRF-ID)
 21002*        INTO        (BANK-CROSS-REFERENCE)
 21003*        RIDFLD      (ERBXRF-KEY)
 21004*        LENGTH      (BXRF-REC-LENGTH)
 21005*    END-EXEC.
 21006*    MOVE '&"IL       E          (   #00019799' TO DFHEIV0
 21007     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21009     MOVE X'2020233030303139373939' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 389
* EL050.cbl
 21010     CALL 'kxdfhei1' USING DFHEIV0,
 21011           BXRF-ID,
 21012           BANK-CROSS-REFERENCE,
 21013           BXRF-REC-LENGTH,
 21014           ERBXRF-KEY,
 21015           DFHEIV99,
 21016           DFHEIV99,
 21017           DFHEIV99
 21018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21019
 21020
 21021     MOVE 'Y'                    TO BXRF-MASTER-SW
 21022
 21023     GO TO 8584-EXIT
 21024     .
 21025 8584-BXRF-NOT-FOUND.
 21026
 21027     MOVE 'N'                    TO BXRF-MASTER-SW.
 21028
 21029 8584-EXIT.
 21030     EXIT.
 21031
 21032 8585-READ-PLAN-MASTER.
 21033
 21034
 21035* EXEC CICS HANDLE CONDITION
 21036*        NOTFND    (8585-PLAN-NOT-FOUND)
 21037*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21038*    END-EXEC.
 21039*    MOVE '"$I''                  ! ; #00019819' TO DFHEIV0
 21040     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21042     MOVE X'3B20233030303139383139' TO DFHEIV0(25:11)
 21043     CALL 'kxdfhei1' USING DFHEIV0
 21044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21045
 21046
 21047
 21048* EXEC CICS READ
 21049*        DATASET     (PLAN-ID)
 21050*        INTO        (PLAN-MASTER)
 21051*        RIDFLD      (ERPLAN-KEY)
 21052*    END-EXEC.
 21053     MOVE LENGTH OF
 21054      PLAN-MASTER
 21055       TO DFHEIV11
 21056*    MOVE '&"IL       E          (   #00019824' TO DFHEIV0
 21057     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21059     MOVE X'2020233030303139383234' TO DFHEIV0(25:11)
 21060     CALL 'kxdfhei1' USING DFHEIV0,
 21061           PLAN-ID,
 21062           PLAN-MASTER,
 21063           DFHEIV11,
 21064           ERPLAN-KEY,
 21065           DFHEIV99,
 21066           DFHEIV99,
 21067           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 390
* EL050.cbl
 21068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21069
 21070
 21071     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21072
 21073     GO TO 8585-EXIT.
 21074
 21075 8585-PLAN-NOT-FOUND.
 21076
 21077     MOVE 'N'                    TO PLAN-MASTER-SW.
 21078
 21079 8585-EXIT.
 21080     EXIT.
 21081
 21082 8586-READ-LOAN-OFFICER.
 21083
 21084* EXEC CICS READ
 21085*        DATASET     (LOFC-ID)
 21086*        INTO        (LOAN-OFFICER-MASTER)
 21087*        RIDFLD      (ERLOFC-KEY)
 21088*        RESP        (WS-RESPONSE)
 21089*    END-EXEC
 21090     MOVE LENGTH OF
 21091      LOAN-OFFICER-MASTER
 21092       TO DFHEIV11
 21093*    MOVE '&"IL       E          (  N#00019842' TO DFHEIV0
 21094     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21095     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21096     MOVE X'204E233030303139383432' TO DFHEIV0(25:11)
 21097     CALL 'kxdfhei1' USING DFHEIV0,
 21098           LOFC-ID,
 21099           LOAN-OFFICER-MASTER,
 21100           DFHEIV11,
 21101           ERLOFC-KEY,
 21102           DFHEIV99,
 21103           DFHEIV99,
 21104           DFHEIV99
 21105     MOVE EIBRESP  TO WS-RESPONSE
 21106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21107
 21108     IF WS-RESP-NORMAL
 21109        MOVE 'Y'                 TO LOFC-MASTER-SW
 21110     ELSE
 21111        MOVE 'N'                 TO LOFC-MASTER-SW
 21112     END-IF
 21113     .
 21114 8586-EXIT.
 21115     EXIT.
 21116 8587-START-ERPDEF.
 21117
 21118* EXEC CICS STARTBR
 21119*       DATASET   (PDEF-ID)
 21120*       RIDFLD    (ERPDEF-KEY)
 21121*       GTEQ
 21122*       RESP      (WS-RESPONSE)
 21123*    END-EXEC
 21124     MOVE 0
 21125       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 391
* EL050.cbl
 21126*    MOVE '&,         G          &  N#00019858' TO DFHEIV0
 21127     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21128     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21129     MOVE X'204E233030303139383538' TO DFHEIV0(25:11)
 21130     CALL 'kxdfhei1' USING DFHEIV0,
 21131           PDEF-ID,
 21132           ERPDEF-KEY,
 21133           DFHEIV99,
 21134           DFHEIV11,
 21135           DFHEIV99
 21136     MOVE EIBRESP  TO WS-RESPONSE
 21137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21138     IF WS-RESP-NORMAL
 21139        MOVE 'Y'                 TO PDEF-MASTER-SW
 21140     ELSE
 21141        MOVE 'N'                 TO PDEF-MASTER-SW
 21142     END-IF
 21143     .
 21144 8587-EXIT.
 21145     EXIT.
 21146 8588-READ-ERPDEF.
 21147
 21148* EXEC CICS READNEXT
 21149*       DATASET   (PDEF-ID)
 21150*       RIDFLD    (ERPDEF-KEY)
 21151*       INTO      (PRODUCT-MASTER)
 21152*       RESP      (WS-RESPONSE)
 21153*    END-EXEC
 21154     MOVE LENGTH OF
 21155      PRODUCT-MASTER
 21156       TO DFHEIV12
 21157     MOVE 0
 21158       TO DFHEIV11
 21159*    MOVE '&.IL                  )  N#00019873' TO DFHEIV0
 21160     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21161     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21162     MOVE X'204E233030303139383733' TO DFHEIV0(25:11)
 21163     CALL 'kxdfhei1' USING DFHEIV0,
 21164           PDEF-ID,
 21165           PRODUCT-MASTER,
 21166           DFHEIV12,
 21167           ERPDEF-KEY,
 21168           DFHEIV99,
 21169           DFHEIV11,
 21170           DFHEIV99,
 21171           DFHEIV99
 21172     MOVE EIBRESP  TO WS-RESPONSE
 21173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21174     IF WS-RESP-NORMAL
 21175        MOVE 'Y'                 TO PDEF-MASTER-SW
 21176     ELSE
 21177        MOVE 'N'                 TO PDEF-MASTER-SW
 21178     END-IF
 21179     .
 21180 8588-EXIT.
 21181     EXIT.
 21182 8589-ENDBR-ERPDEF.
 21183
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 392
* EL050.cbl
 21184* EXEC CICS ENDBR
 21185*       DATASET   (PDEF-ID)
 21186*    END-EXEC
 21187     MOVE 0
 21188       TO DFHEIV11
 21189*    MOVE '&2                    $   #00019888' TO DFHEIV0
 21190     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21191     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21192     MOVE X'2020233030303139383838' TO DFHEIV0(25:11)
 21193     CALL 'kxdfhei1' USING DFHEIV0,
 21194           PDEF-ID,
 21195           DFHEIV11,
 21196           DFHEIV99
 21197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21198     .
 21199 8589-EXIT.
 21200     EXIT.
 21201 8590-READ-CERT-MASTER.
 21202     IF PB-COMPANY-ID = 'UCL'
 21203         GO TO 8690-READ-CERT-MASTER-UCL.
 21204
 21205
 21206* EXEC CICS HANDLE CONDITION
 21207*         NOTFND    (0299-CERT-NOT-FOUND)
 21208*    END-EXEC.
 21209*    MOVE '"$I                   ! < #00019898' TO DFHEIV0
 21210     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21211     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21212     MOVE X'3C20233030303139383938' TO DFHEIV0(25:11)
 21213     CALL 'kxdfhei1' USING DFHEIV0
 21214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21215
 21216
 21217
 21218* EXEC CICS READ
 21219*        DATASET     (CERT-ID)
 21220*        INTO        (CERTIFICATE-MASTER)
 21221*        RIDFLD      (ELCERT-KEY)
 21222*        UPDATE
 21223*    END-EXEC.
 21224     MOVE LENGTH OF
 21225      CERTIFICATE-MASTER
 21226       TO DFHEIV11
 21227*    MOVE '&"IL       EU         (   #00019902' TO DFHEIV0
 21228     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21229     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21230     MOVE X'2020233030303139393032' TO DFHEIV0(25:11)
 21231     CALL 'kxdfhei1' USING DFHEIV0,
 21232           CERT-ID,
 21233           CERTIFICATE-MASTER,
 21234           DFHEIV11,
 21235           ELCERT-KEY,
 21236           DFHEIV99,
 21237           DFHEIV99,
 21238           DFHEIV99
 21239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21240
 21241
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 393
* EL050.cbl
 21242 8590-EXIT.
 21243     EXIT.
 21244
 21245 8690-READ-CERT-MASTER-UCL.
 21246
 21247* EXEC CICS HANDLE CONDITION
 21248*         NOTFND    (8700-READ-CERT-MASTER)
 21249*    END-EXEC.
 21250*    MOVE '"$I                   ! = #00019913' TO DFHEIV0
 21251     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21253     MOVE X'3D20233030303139393133' TO DFHEIV0(25:11)
 21254     CALL 'kxdfhei1' USING DFHEIV0
 21255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21256
 21257
 21258 8690-READ-CERT-CONT.
 21259
 21260* EXEC CICS READ
 21261*        DATASET     (CERT-ID)
 21262*        INTO        (CERTIFICATE-MASTER)
 21263*        RIDFLD      (ELCERT-KEY)
 21264*        UPDATE
 21265*    END-EXEC.
 21266     MOVE LENGTH OF
 21267      CERTIFICATE-MASTER
 21268       TO DFHEIV11
 21269*    MOVE '&"IL       EU         (   #00019918' TO DFHEIV0
 21270     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21271     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21272     MOVE X'2020233030303139393138' TO DFHEIV0(25:11)
 21273     CALL 'kxdfhei1' USING DFHEIV0,
 21274           CERT-ID,
 21275           CERTIFICATE-MASTER,
 21276           DFHEIV11,
 21277           ELCERT-KEY,
 21278           DFHEIV99,
 21279           DFHEIV99,
 21280           DFHEIV99
 21281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21282
 21283
 21284     GO TO 8590-EXIT.
 21285
 21286 8700-READ-CERT-MASTER.
 21287     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21288     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21289
 21290* EXEC CICS HANDLE CONDITION
 21291*         DUPKEY    (8720-COMP-ACCOUNTS)
 21292*         ENDFILE   (8730-END-BROWSE)
 21293*         NOTFND    (8740-NOT-FOUND)
 21294*    END-EXEC.
 21295*    MOVE '"$$''I                 ! > #00019930' TO DFHEIV0
 21296     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21298     MOVE X'3E20233030303139393330' TO DFHEIV0(25:11)
 21299     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 394
* EL050.cbl
 21300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21301
 21302
 21303
 21304* EXEC CICS STARTBR
 21305*        DATASET     ('ELCERT5')
 21306*        RIDFLD      (ELCERT2-KEY)
 21307*        EQUAL
 21308*    END-EXEC.
 21309     MOVE 'ELCERT5' TO DFHEIV1
 21310     MOVE 0
 21311       TO DFHEIV11
 21312*    MOVE '&,         E          &   #00019936' TO DFHEIV0
 21313     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21314     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21315     MOVE X'2020233030303139393336' TO DFHEIV0(25:11)
 21316     CALL 'kxdfhei1' USING DFHEIV0,
 21317           DFHEIV1,
 21318           ELCERT2-KEY,
 21319           DFHEIV99,
 21320           DFHEIV11,
 21321           DFHEIV99
 21322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21323
 21324
 21325 8710-READ-NEXT.
 21326
 21327* EXEC CICS READNEXT
 21328*        DATASET     ('ELCERT5')
 21329*        INTO        (CERTIFICATE-MASTER)
 21330*        RIDFLD      (ELCERT2-KEY)
 21331*    END-EXEC.
 21332     MOVE LENGTH OF
 21333      CERTIFICATE-MASTER
 21334       TO DFHEIV12
 21335     MOVE 'ELCERT5' TO DFHEIV1
 21336     MOVE 0
 21337       TO DFHEIV11
 21338*    MOVE '&.IL                  )   #00019943' TO DFHEIV0
 21339     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21340     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21341     MOVE X'2020233030303139393433' TO DFHEIV0(25:11)
 21342     CALL 'kxdfhei1' USING DFHEIV0,
 21343           DFHEIV1,
 21344           CERTIFICATE-MASTER,
 21345           DFHEIV12,
 21346           ELCERT2-KEY,
 21347           DFHEIV99,
 21348           DFHEIV11,
 21349           DFHEIV99,
 21350           DFHEIV99
 21351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21352
 21353
 21354 8720-COMP-ACCOUNTS.
 21355
 21356* EXEC CICS ENTER
 21357*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 395
* EL050.cbl
 21358*         FROM (PB-C-LAST-NAME)
 21359*    END-EXEC.
 21360     MOVE 001
 21361       TO DFHEIV11
 21362*    MOVE ':$F                   %   #00019950' TO DFHEIV0
 21363     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21364     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21365     MOVE X'2020233030303139393530' TO DFHEIV0(25:11)
 21366     CALL 'kxdfhei1' USING DFHEIV0,
 21367           DFHEIV11,
 21368           PB-C-LAST-NAME,
 21369           DFHEIV99,
 21370           DFHEIV99
 21371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21372
 21373
 21374
 21375* EXEC CICS ENTER
 21376*         TRACEID (002)
 21377*         FROM (CM-INSURED-LAST-NAME)
 21378*    END-EXEC.
 21379     MOVE 002
 21380       TO DFHEIV11
 21381*    MOVE ':$F                   %   #00019955' TO DFHEIV0
 21382     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21383     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21384     MOVE X'2020233030303139393535' TO DFHEIV0(25:11)
 21385     CALL 'kxdfhei1' USING DFHEIV0,
 21386           DFHEIV11,
 21387           CM-INSURED-LAST-NAME,
 21388           DFHEIV99,
 21389           DFHEIV99
 21390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21391
 21392
 21393     IF PB-CERT-NO NOT = CM-CERT-NO
 21394         GO TO 8730-END-BROWSE.
 21395
 21396     IF PB-ACCOUNT = CM-ACCOUNT
 21397         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21398             MOVE ER-2799        TO WS-ERROR
 21399             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21400             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21401             GO TO 8730-END-BROWSE.
 21402
 21403     GO TO 8710-READ-NEXT.
 21404
 21405 8730-END-BROWSE.
 21406
 21407* EXEC CICS ENDBR
 21408*         DATASET    ('ELCERT5')
 21409*    END-EXEC.
 21410     MOVE 'ELCERT5' TO DFHEIV1
 21411     MOVE 0
 21412       TO DFHEIV11
 21413*    MOVE '&2                    $   #00019973' TO DFHEIV0
 21414     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21415     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 396
* EL050.cbl
 21416     MOVE X'2020233030303139393733' TO DFHEIV0(25:11)
 21417     CALL 'kxdfhei1' USING DFHEIV0,
 21418           DFHEIV1,
 21419           DFHEIV11,
 21420           DFHEIV99
 21421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21422
 21423
 21424 8740-NOT-FOUND.
 21425     GO TO 0299-CERT-NOT-FOUND.
 21426
 21427 8750-START-ELSTAT.
 21428
 21429* EXEC CICS STARTBR
 21430*       DATASET   (STAT-ID)
 21431*       RIDFLD    (ELSTAT-KEY)
 21432*       GTEQ
 21433*       RESP      (WS-RESPONSE)
 21434*    END-EXEC
 21435     MOVE 0
 21436       TO DFHEIV11
 21437*    MOVE '&,         G          &  N#00019981' TO DFHEIV0
 21438     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21439     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21440     MOVE X'204E233030303139393831' TO DFHEIV0(25:11)
 21441     CALL 'kxdfhei1' USING DFHEIV0,
 21442           STAT-ID,
 21443           ELSTAT-KEY,
 21444           DFHEIV99,
 21445           DFHEIV11,
 21446           DFHEIV99
 21447     MOVE EIBRESP  TO WS-RESPONSE
 21448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21449     IF WS-RESP-NORMAL
 21450        MOVE 'Y'                 TO STAT-MASTER-SW
 21451     ELSE
 21452        MOVE 'N'                 TO STAT-MASTER-SW
 21453     END-IF
 21454     .
 21455 8750-EXIT.
 21456     EXIT.
 21457 8752-READ-ELSTAT.
 21458
 21459* EXEC CICS READNEXT
 21460*       DATASET   (STAT-ID)
 21461*       RIDFLD    (ELSTAT-KEY)
 21462*       INTO      (STATE-FILE)
 21463*       RESP      (WS-RESPONSE)
 21464*    END-EXEC
 21465     MOVE LENGTH OF
 21466      STATE-FILE
 21467       TO DFHEIV12
 21468     MOVE 0
 21469       TO DFHEIV11
 21470*    MOVE '&.IL                  )  N#00019996' TO DFHEIV0
 21471     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21472     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21473     MOVE X'204E233030303139393936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 397
* EL050.cbl
 21474     CALL 'kxdfhei1' USING DFHEIV0,
 21475           STAT-ID,
 21476           STATE-FILE,
 21477           DFHEIV12,
 21478           ELSTAT-KEY,
 21479           DFHEIV99,
 21480           DFHEIV11,
 21481           DFHEIV99,
 21482           DFHEIV99
 21483     MOVE EIBRESP  TO WS-RESPONSE
 21484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21485     IF WS-RESP-NORMAL
 21486        MOVE 'Y'                 TO STAT-MASTER-SW
 21487     ELSE
 21488        MOVE 'N'                 TO STAT-MASTER-SW
 21489     END-IF
 21490     .
 21491 8752-EXIT.
 21492     EXIT.
 21493 8800-GET-COMP-RATE.
 21494     MOVE +1 TO IB.
 21495     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21496         ADD +9 TO IB
 21497         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21498             ADD +9 TO IB
 21499             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21500                MOVE ZEROS       TO WS-WK-RATE
 21501                GO TO 8800-EXIT.
 21502
 21503     IF PB-I-AGE GREATER CT-AGE (1)
 21504         ADD +3 TO IB
 21505         IF PB-I-AGE GREATER CT-AGE (2)
 21506             ADD +3 TO IB
 21507             IF PB-I-AGE GREATER CT-AGE (3)
 21508                MOVE ZEROS       TO WS-WK-RATE
 21509                GO TO 8800-EXIT.
 21510
 21511     IF WS-WORK-TERM GREATER CT-TRM (1)
 21512         ADD +1 TO IB
 21513         IF WS-WORK-TERM GREATER CT-TRM (2)
 21514             ADD +1 TO IB
 21515             IF WS-WORK-TERM GREATER CT-TRM (3)
 21516                MOVE ZEROS       TO WS-WK-RATE
 21517                GO TO 8800-EXIT.
 21518
 21519     IF CT-RT (IB) NOT NUMERIC
 21520         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21521         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21522         GO TO 8800-GET-COMP-RATE.
 21523
 21524     MOVE CT-RT (IB) TO WS-WK-RATE.
 21525
 21526 8800-EXIT.
 21527     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 398
* EL050.cbl
 21529 8900-ADDRESS-FILE.
 21530     IF ERACCT-FILE-ADDRESSED
 21531         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21532         GO TO 8900-ADDRESS-EXIT.
 21533
 21534     IF ELCNTL-FILE-ADDRESSED
 21535         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21536         GO TO 8900-ADDRESS-EXIT.
 21537
 21538     IF ERPLAN-FILE-ADDRESSED
 21539         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21540         GO TO 8900-ADDRESS-EXIT.
 21541
 21542     IF ERFORM-FILE-ADDRESSED
 21543         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21544         GO TO 8900-ADDRESS-EXIT.
 21545
 21546 8900-ADDRESS-EXIT.
 21547     EXIT.
 21548
 21549 9000-READ-CONTROL.
 21550
 21551* EXEC CICS HANDLE CONDITION
 21552*        NOTFND    (9000-NOTFND)
 21553*    END-EXEC.
 21554*    MOVE '"$I                   ! ? #00020067' TO DFHEIV0
 21555     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21557     MOVE X'3F20233030303230303637' TO DFHEIV0(25:11)
 21558     CALL 'kxdfhei1' USING DFHEIV0
 21559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21560
 21561
 21562
 21563* EXEC CICS READ
 21564*        DATASET     (CNTL-ID)
 21565*        SET         (ADDRESS OF CONTROL-FILE)
 21566*        RIDFLD      (ELCNTL-KEY)
 21567*        GTEQ
 21568*    END-EXEC.
 21569*    MOVE '&"S        G          (   #00020071' TO DFHEIV0
 21570     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21572     MOVE X'2020233030303230303731' TO DFHEIV0(25:11)
 21573     CALL 'kxdfhei1' USING DFHEIV0,
 21574           CNTL-ID,
 21575           DFHEIV20,
 21576           DFHEIV99,
 21577           ELCNTL-KEY,
 21578           DFHEIV99,
 21579           DFHEIV99,
 21580           DFHEIV99
 21581     SET ADDRESS OF CONTROL-FILE TO
 21582         DFHEIV20
 21583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21584
 21585
 21586     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 399
* EL050.cbl
 21587
 21588 9000-NOTFND.
 21589     IF RC-SW-1 = '1'
 21590        MOVE ER-2616              TO WS-ERROR
 21591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21592        GO TO 9000-EXIT.
 21593
 21594     IF RC-SW-1 = '2'
 21595        MOVE ER-2602              TO WS-ERROR
 21596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21597
 21598 9000-EXIT.
 21599      EXIT.
 21600
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 400
* EL050.cbl
 21602 9100-READ-CONTROL.
 21603
 21604* EXEC CICS HANDLE CONDITION
 21605*        NOTFND  (9100-NOTFND)
 21606*        ENDFILE (9100-NOTFND)
 21607*    END-EXEC.
 21608*    MOVE '"$I''                  ! @ #00020095' TO DFHEIV0
 21609     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21611     MOVE X'4020233030303230303935' TO DFHEIV0(25:11)
 21612     CALL 'kxdfhei1' USING DFHEIV0
 21613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21614
 21615
 21616
 21617* EXEC CICS READ
 21618*        DATASET     (CNTL-ID)
 21619*        INTO        (CONTROL-FILE)
 21620*        RIDFLD      (ELCNTL-KEY)
 21621*        GTEQ
 21622*    END-EXEC.
 21623     MOVE LENGTH OF
 21624      CONTROL-FILE
 21625       TO DFHEIV11
 21626*    MOVE '&"IL       G          (   #00020100' TO DFHEIV0
 21627     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21628     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21629     MOVE X'2020233030303230313030' TO DFHEIV0(25:11)
 21630     CALL 'kxdfhei1' USING DFHEIV0,
 21631           CNTL-ID,
 21632           CONTROL-FILE,
 21633           DFHEIV11,
 21634           ELCNTL-KEY,
 21635           DFHEIV99,
 21636           DFHEIV99,
 21637           DFHEIV99
 21638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21639
 21640
 21641     GO TO 9100-EXIT.
 21642
 21643 9100-NOTFND.
 21644     IF RC-SW-2 = '0'
 21645        MOVE '1'                  TO STATE-RECORD-ERROR
 21646        GO TO 9100-EXIT
 21647     END-IF
 21648     IF RC-SW-2 = '1'
 21649        MOVE '1'                  TO LF-BENEFIT-ERROR
 21650        MOVE ER-2604              TO WS-ERROR
 21651        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21652        GO TO 9100-EXIT.
 21653
 21654     IF RC-SW-2 = '2'
 21655        MOVE '1'                  TO AH-BENEFIT-ERROR
 21656        MOVE ER-2605              TO WS-ERROR
 21657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21658        GO TO 9100-EXIT.
 21659
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 401
* EL050.cbl
 21660     IF RC-SW-2 = '3'
 21661         MOVE ER-2603           TO WS-ERROR
 21662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21663         GO TO 9100-EXIT.
 21664
 21665     IF RC-SW-2 = '4'
 21666         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21667         GO TO 9100-EXIT.
 21668
 21669     IF RC-SW-2 = '5'
 21670         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21671         IF WS-AH-INPUT-CD-1 = SPACE
 21672             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21673         ELSE
 21674             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21675
 21676 9100-EXIT.
 21677      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 402
* EL050.cbl
 21679 9200-CONTROL-GETMAIN.
 21680
 21681* EXEC CICS GETMAIN
 21682*         LENGTH   (750)
 21683*         SET      (ADDRESS OF CONTROL-FILE)
 21684*    END-EXEC.
 21685     MOVE 750
 21686       TO DFHEIV11
 21687*    MOVE '," L                  $   #00020146' TO DFHEIV0
 21688     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21689     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21690     MOVE X'2020233030303230313436' TO DFHEIV0(25:11)
 21691     CALL 'kxdfhei1' USING DFHEIV0,
 21692           DFHEIV20,
 21693           DFHEIV11,
 21694           DFHEIV99
 21695     SET ADDRESS OF CONTROL-FILE TO
 21696         DFHEIV20
 21697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21698
 21699
 21700     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21701
 21702 9200-EXIT.
 21703     EXIT.
 21704
 21705 9250-UNLOCK-RETURN.
 21706
 21707* EXEC CICS UNLOCK
 21708*        DATASET   (CERT-ID)
 21709*    END-EXEC.
 21710*    MOVE '&*                    #   #00020157' TO DFHEIV0
 21711     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21712     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21713     MOVE X'2020233030303230313537' TO DFHEIV0(25:11)
 21714     CALL 'kxdfhei1' USING DFHEIV0,
 21715           CERT-ID,
 21716           DFHEIV99
 21717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21718
 21719
 21720 9300-ABEND.
 21721     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21722
 21723
 21724* EXEC CICS LINK
 21725*        PROGRAM   ('EL004')
 21726*        COMMAREA  (WS-ERROR-LINE)
 21727*        LENGTH    (72)
 21728*    END-EXEC.
 21729     MOVE 'EL004' TO DFHEIV1
 21730     MOVE 72
 21731       TO DFHEIV11
 21732*    MOVE '."C                   (   #00020164' TO DFHEIV0
 21733     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21735     MOVE X'2020233030303230313634' TO DFHEIV0(25:11)
 21736     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 403
* EL050.cbl
 21737           DFHEIV1,
 21738           WS-ERROR-LINE,
 21739           DFHEIV11,
 21740           DFHEIV99,
 21741           DFHEIV99,
 21742           DFHEIV99,
 21743           DFHEIV99
 21744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21745
 21746
 21747     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21748
 21749
 21750* EXEC CICS ABEND
 21751*        ABCODE ('EL50')
 21752*    END-EXEC.
 21753     MOVE 'EL50' TO DFHEIV5
 21754*    MOVE '.,A                   "   #00020172' TO DFHEIV0
 21755     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21756     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21757     MOVE X'2020233030303230313732' TO DFHEIV0(25:11)
 21758     CALL 'kxdfhei1' USING DFHEIV0,
 21759           DFHEIV5
 21760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21761
 21762
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 404
* EL050.cbl
 21764
 21765******************************************************************
 21766*                                                                *
 21767*            E R R O R   F O R M A T   R O U T I N E             *
 21768*                                                                *
 21769******************************************************************
 21770
 21771 9900-ERROR-FORMAT.
 21772
 21773     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21774                    PB-COMMON-ERROR (2) OR
 21775                    PB-COMMON-ERROR (3) OR
 21776                    PB-COMMON-ERROR (4) OR
 21777                    PB-COMMON-ERROR (5) OR
 21778                    PB-COMMON-ERROR (6) OR
 21779                    PB-COMMON-ERROR (7) OR
 21780                    PB-COMMON-ERROR (8) OR
 21781                    PB-COMMON-ERROR (9) OR
 21782                    PB-COMMON-ERROR (10)
 21783        GO TO 9900-EXIT.
 21784
 21785     IF PB-NO-OF-ERRORS = +10
 21786        GO TO 9900-EXIT.
 21787
 21788     ADD +1  TO PB-NO-OF-ERRORS.
 21789     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21790                                       (PB-NO-OF-ERRORS).
 21791 9900-EXIT.
 21792     EXIT.
 21793
 21794 9990-RETURN.
 21795     IF BROWSE-STARTED
 21796
 21797* EXEC CICS ENDBR
 21798*            DATASET  (ACCT-ID)
 21799*       END-EXEC.
 21800     MOVE 0
 21801       TO DFHEIV11
 21802*    MOVE '&2                    $   #00020209' TO DFHEIV0
 21803     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21804     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21805     MOVE X'2020233030303230323039' TO DFHEIV0(25:11)
 21806     CALL 'kxdfhei1' USING DFHEIV0,
 21807           ACCT-ID,
 21808           DFHEIV11,
 21809           DFHEIV99
 21810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21811
 21812
 21813 9990-EXIT.
 21814     EXIT.
 21815
 21816
 21817****Check for CRTO record, add one if not found.
 21818 9991-CHECK-FOR-ELCRTO.
 21819
 21820* EXEC CICS HANDLE CONDITION
 21821*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 405
* EL050.cbl
 21822*         ENDFILE (9991-CRTO-NOT-FOUND)
 21823*     END-EXEC.
 21824*    MOVE '"$I''                  ! A #00020219' TO DFHEIV0
 21825     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21827     MOVE X'4120233030303230323139' TO DFHEIV0(25:11)
 21828     CALL 'kxdfhei1' USING DFHEIV0
 21829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21830
 21831     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21832     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21833     MOVE +0                     TO ELCRTO-SEQ-NO
 21834
 21835
 21836* EXEC CICS READ
 21837*       DATASET   ('ELCRTO')
 21838*       INTO      (ORIGINAL-CERTIFICATE)
 21839*       RIDFLD    (ELCRTO-KEY)
 21840*       GTEQ
 21841*       RESP      (WS-RESPONSE)
 21842*    END-EXEC
 21843     MOVE LENGTH OF
 21844      ORIGINAL-CERTIFICATE
 21845       TO DFHEIV11
 21846     MOVE 'ELCRTO' TO DFHEIV1
 21847*    MOVE '&"IL       G          (  N#00020227' TO DFHEIV0
 21848     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21850     MOVE X'204E233030303230323237' TO DFHEIV0(25:11)
 21851     CALL 'kxdfhei1' USING DFHEIV0,
 21852           DFHEIV1,
 21853           ORIGINAL-CERTIFICATE,
 21854           DFHEIV11,
 21855           ELCRTO-KEY,
 21856           DFHEIV99,
 21857           DFHEIV99,
 21858           DFHEIV99
 21859     MOVE EIBRESP  TO WS-RESPONSE
 21860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21861
 21862     IF WS-RESP-NORMAL
 21863        AND (OC-CONTROL-PRIMARY (1:33) =
 21864                 PB-CONTROL-BY-ACCOUNT (1:33))
 21865        AND (OC-RECORD-TYPE =  'I')
 21866           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21867               GO TO 9991-CHECK-INDICATORS
 21868           ELSE
 21869               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21870               GO TO 9991-CRTO-ADD-REC
 21871           END-IF
 21872     END-IF.
 21873
 21874 9991-CRTO-NOT-FOUND.
 21875
 21876     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21877     MOVE 'OC'                TO OC-RECORD-ID
 21878     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21879                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 406
* EL050.cbl
 21880     MOVE +4096               TO OC-KEY-SEQ-NO.
 21881
 21882 9991-CRTO-ADD-REC.
 21883
 21884     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21885     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21886     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21887     MOVE 'I'                 TO OC-RECORD-TYPE
 21888     IF PB-ISSUE
 21889         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21890         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21891         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21892         MOVE PB-I-AGE               TO OC-INS-AGE
 21893         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21894         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21895         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21896         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21897         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21898         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21899         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21900         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21901         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21902         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21903         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21904         IF PB-I-JOINT-COMMISSION > +0
 21905             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21906         ELSE
 21907             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21908         END-IF
 21909         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21910         MOVE +0                     TO OC-LF-CANCEL-AMT
 21911                                        OC-LF-ITD-CANCEL-AMT
 21912         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21913         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21914         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21915         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21916         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21917         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21918         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21919         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21920         MOVE +0                     TO OC-AH-CANCEL-AMT
 21921                                        OC-AH-ITD-CANCEL-AMT
 21922         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21923         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21924         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21925     ELSE
 21926         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21927         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21928         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21929         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21930         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21931         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21932         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21933         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21934         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21935          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21936             MOVE SPACES             TO OC-LF-BENCD
 21937             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 407
* EL050.cbl
 21938                                        OC-LF-BEN-AMT
 21939                                        OC-LF-PRM-AMT
 21940                                        OC-LF-ALT-BEN-AMT
 21941                                        OC-LF-ALT-PRM-AMT
 21942                                        OC-LF-COMM-PCT
 21943                                        OC-LF-CANCEL-AMT
 21944             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21945             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21946         ELSE
 21947             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21948             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21949             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21950             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21951             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21952             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21953             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21954             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21955             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21956             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21957         END-IF
 21958         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21959         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21960          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21961             MOVE SPACES             TO OC-AH-BENCD
 21962             MOVE ZEROS              TO OC-AH-TERM
 21963                                        OC-AH-BEN-AMT
 21964                                        OC-AH-PRM-AMT
 21965                                        OC-AH-COMM-PCT
 21966                                        OC-AH-CANCEL-AMT
 21967                                        OC-AH-CP
 21968             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21969             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21970         ELSE
 21971             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21972             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21973             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21974             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21975             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21976             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21977             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21978             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21979             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21980         END-IF
 21981         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21982         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21983         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21984         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21985     END-IF
 21986     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21987
 21988     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21989
 21990
 21991* EXEC CICS READ
 21992*         DATASET   (FILE-ERMAIL)
 21993*         RIDFLD    (MA-CONTROL-PRIMARY)
 21994*         INTO      (MAILING-DATA)
 21995*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 408
* EL050.cbl
 21996*    END-EXEC
 21997     MOVE LENGTH OF
 21998      MAILING-DATA
 21999       TO DFHEIV11
 22000*    MOVE '&"IL       E          (  N#00020363' TO DFHEIV0
 22001     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22003     MOVE X'204E233030303230333633' TO DFHEIV0(25:11)
 22004     CALL 'kxdfhei1' USING DFHEIV0,
 22005           FILE-ERMAIL,
 22006           MAILING-DATA,
 22007           DFHEIV11,
 22008           MA-CONTROL-PRIMARY,
 22009           DFHEIV99,
 22010           DFHEIV99,
 22011           DFHEIV99
 22012     MOVE EIBRESP  TO WS-RESPONSE
 22013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22014
 22015     IF WS-RESP-NORMAL
 22016         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22017     END-IF.
 22018
 22019     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22020     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22021
 22022
 22023* EXEC CICS READ
 22024*         DATASET  (CRTT-ID)
 22025*         RIDFLD   (WS-ELCRTT-KEY)
 22026*         INTO     (CERTIFICATE-TRAILERS)
 22027*         RESP     (WS-RESPONSE)
 22028*    END-EXEC
 22029     MOVE LENGTH OF
 22030      CERTIFICATE-TRAILERS
 22031       TO DFHEIV11
 22032*    MOVE '&"IL       E          (  N#00020377' TO DFHEIV0
 22033     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22035     MOVE X'204E233030303230333737' TO DFHEIV0(25:11)
 22036     CALL 'kxdfhei1' USING DFHEIV0,
 22037           CRTT-ID,
 22038           CERTIFICATE-TRAILERS,
 22039           DFHEIV11,
 22040           WS-ELCRTT-KEY,
 22041           DFHEIV99,
 22042           DFHEIV99,
 22043           DFHEIV99
 22044     MOVE EIBRESP  TO WS-RESPONSE
 22045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22046
 22047     IF WS-RESP-NORMAL
 22048         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22049         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22050     END-IF.
 22051
 22052
 22053* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 409
* EL050.cbl
 22054*       DATASET   ('ELCRTO')
 22055*       FROM      (ORIGINAL-CERTIFICATE)
 22056*       RIDFLD    (OC-CONTROL-PRIMARY)
 22057*       RESP      (WS-RESPONSE)
 22058*    END-EXEC.
 22059     MOVE LENGTH OF
 22060      ORIGINAL-CERTIFICATE
 22061       TO DFHEIV11
 22062     MOVE 'ELCRTO' TO DFHEIV1
 22063*    MOVE '&$ L                  ''  N#00020389' TO DFHEIV0
 22064     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22065     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22066     MOVE X'204E233030303230333839' TO DFHEIV0(25:11)
 22067     CALL 'kxdfhei1' USING DFHEIV0,
 22068           DFHEIV1,
 22069           ORIGINAL-CERTIFICATE,
 22070           DFHEIV11,
 22071           OC-CONTROL-PRIMARY,
 22072           DFHEIV99,
 22073           DFHEIV99
 22074     MOVE EIBRESP  TO WS-RESPONSE
 22075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22076
 22077
 22078     GO TO 9991-EXIT.
 22079
 22080 9991-CHECK-INDICATORS.
 22081
 22082     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22083         GO TO 9991-EXIT
 22084     END-IF.
 22085
 22086     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22087         GO TO 9991-EXIT
 22088     END-IF.
 22089
 22090
 22091* EXEC CICS READ
 22092*       DATASET   ('ELCRTO')
 22093*       INTO      (ORIGINAL-CERTIFICATE)
 22094*       RIDFLD    (OC-CONTROL-PRIMARY)
 22095*       UPDATE
 22096*       RESP      (WS-RESPONSE)
 22097*    END-EXEC
 22098     MOVE LENGTH OF
 22099      ORIGINAL-CERTIFICATE
 22100       TO DFHEIV11
 22101     MOVE 'ELCRTO' TO DFHEIV1
 22102*    MOVE '&"IL       EU         (  N#00020408' TO DFHEIV0
 22103     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22104     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22105     MOVE X'204E233030303230343038' TO DFHEIV0(25:11)
 22106     CALL 'kxdfhei1' USING DFHEIV0,
 22107           DFHEIV1,
 22108           ORIGINAL-CERTIFICATE,
 22109           DFHEIV11,
 22110           OC-CONTROL-PRIMARY,
 22111           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 410
* EL050.cbl
 22112           DFHEIV99,
 22113           DFHEIV99
 22114     MOVE EIBRESP  TO WS-RESPONSE
 22115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22116     IF WS-RESP-NORMAL
 22117        IF PB-ISSUE
 22118          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22119          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22120          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22121          MOVE PB-I-AGE               TO OC-INS-AGE
 22122          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22123          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22124          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22125          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22126          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22127          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22128          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22129          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22130          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22131          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22132          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22133          IF PB-I-JOINT-COMMISSION > +0
 22134              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22135          ELSE
 22136              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22137          END-IF
 22138          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22139          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22140          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22141          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22142          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22143          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22144          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22145          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22146          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22147
 22148          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22149
 22150* EXEC CICS READ
 22151*             DATASET   (FILE-ERMAIL)
 22152*             RIDFLD    (MA-CONTROL-PRIMARY)
 22153*             INTO      (MAILING-DATA)
 22154*             RESP      (WS-RESPONSE)
 22155*         END-EXEC
 22156     MOVE LENGTH OF
 22157      MAILING-DATA
 22158       TO DFHEIV11
 22159*    MOVE '&"IL       E          (  N#00020448' TO DFHEIV0
 22160     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22162     MOVE X'204E233030303230343438' TO DFHEIV0(25:11)
 22163     CALL 'kxdfhei1' USING DFHEIV0,
 22164           FILE-ERMAIL,
 22165           MAILING-DATA,
 22166           DFHEIV11,
 22167           MA-CONTROL-PRIMARY,
 22168           DFHEIV99,
 22169           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 411
* EL050.cbl
 22170           DFHEIV99
 22171     MOVE EIBRESP  TO WS-RESPONSE
 22172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22173          IF WS-RESP-NORMAL
 22174             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22175          END-IF
 22176
 22177          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22178          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22179
 22180* EXEC CICS READ
 22181*             DATASET  (CRTT-ID)
 22182*             RIDFLD   (WS-ELCRTT-KEY)
 22183*             INTO     (CERTIFICATE-TRAILERS)
 22184*             RESP     (WS-RESPONSE)
 22185*         END-EXEC
 22186     MOVE LENGTH OF
 22187      CERTIFICATE-TRAILERS
 22188       TO DFHEIV11
 22189*    MOVE '&"IL       E          (  N#00020460' TO DFHEIV0
 22190     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22191     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22192     MOVE X'204E233030303230343630' TO DFHEIV0(25:11)
 22193     CALL 'kxdfhei1' USING DFHEIV0,
 22194           CRTT-ID,
 22195           CERTIFICATE-TRAILERS,
 22196           DFHEIV11,
 22197           WS-ELCRTT-KEY,
 22198           DFHEIV99,
 22199           DFHEIV99,
 22200           DFHEIV99
 22201     MOVE EIBRESP  TO WS-RESPONSE
 22202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22203          IF WS-RESP-NORMAL
 22204             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22205                               OC-INS-AGE-DEFAULT-FLAG
 22206             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22207                               OC-JNT-AGE-DEFAULT-FLAG
 22208          END-IF
 22209
 22210        ELSE
 22211          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22212             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22213             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22214             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22215          END-IF
 22216          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22217             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22218             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22219             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22220          END-IF
 22221          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22222        END-IF
 22223
 22224* EXEC CICS REWRITE
 22225*          DATASET   ('ELCRTO')
 22226*          FROM      (ORIGINAL-CERTIFICATE)
 22227*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 412
* EL050.cbl
 22228*       END-EXEC
 22229     MOVE LENGTH OF
 22230      ORIGINAL-CERTIFICATE
 22231       TO DFHEIV11
 22232     MOVE 'ELCRTO' TO DFHEIV1
 22233*    MOVE '&& L                  %  N#00020486' TO DFHEIV0
 22234     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22235     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22236     MOVE X'204E233030303230343836' TO DFHEIV0(25:11)
 22237     CALL 'kxdfhei1' USING DFHEIV0,
 22238           DFHEIV1,
 22239           ORIGINAL-CERTIFICATE,
 22240           DFHEIV11,
 22241           DFHEIV99
 22242     MOVE EIBRESP  TO WS-RESPONSE
 22243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22244     END-IF.
 22245
 22246 9991-EXIT.
 22247     EXIT.
 22248
 22249
 22250 9999-RETURN.
 22251     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22252
 22253
 22254* EXEC CICS RETURN
 22255*    END-EXEC.
 22256*    MOVE '.(                    ''   #00020500' TO DFHEIV0
 22257     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22258     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22259     MOVE X'2020233030303230353030' TO DFHEIV0(25:11)
 22260     CALL 'kxdfhei1' USING DFHEIV0,
 22261           DFHEIV99,
 22262           DFHEIV99,
 22263           DFHEIV99,
 22264           DFHEIV99,
 22265           DFHEIV99,
 22266           DFHEIV99
 22267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22268
 22269
 22270
 22271* GOBACK.
 22272     MOVE '9%                    "   ' TO DFHEIV0
 22273     MOVE 'EL050' TO DFHEIV1
 22274     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22275     GOBACK.
 22276
 22277 9999-DFHBACK SECTION.
 22278     MOVE '9%                    "   ' TO DFHEIV0
 22279     MOVE 'EL050' TO DFHEIV1
 22280     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22281     GOBACK.
 22282 9999-DFHEXIT.
 22283     IF DFHEIGDJ EQUAL 0001
 22284         NEXT SENTENCE
 22285     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 413
* EL050.cbl
 22286         GO TO 9300-ABEND,
 22287               3990-FILES-NOT-OPEN
 22288         DEPENDING ON DFHEIGDI
 22289     ELSE IF DFHEIGDJ EQUAL 3
 22290         GO TO 6610-START-BROWSE,
 22291               6630-ERRESS-PROBLEM,
 22292               6630-END-OF-FILE
 22293         DEPENDING ON DFHEIGDI
 22294     ELSE IF DFHEIGDJ EQUAL 4
 22295         GO TO 6630-END-OF-FILE,
 22296               6630-ERRESS-PROBLEM,
 22297               6630-ERRESS-PROBLEM,
 22298               6630-END-OF-FILE
 22299         DEPENDING ON DFHEIGDI
 22300     ELSE IF DFHEIGDJ EQUAL 5
 22301         GO TO 6630-END-OF-FILE,
 22302               6630-END-OF-FILE,
 22303               6630-ERRESS-PROBLEM,
 22304               6630-ERRESS-PROBLEM
 22305         DEPENDING ON DFHEIGDI
 22306     ELSE IF DFHEIGDJ EQUAL 6
 22307         GO TO 6660-START-BROWSE,
 22308               6690-ERRESC-PROBLEM,
 22309               6690-ERRESC-PROBLEM,
 22310               6690-END-OF-FILE
 22311         DEPENDING ON DFHEIGDI
 22312     ELSE IF DFHEIGDJ EQUAL 7
 22313         GO TO 6690-END-OF-FILE,
 22314               6690-ERRESC-PROBLEM,
 22315               6690-ERRESC-PROBLEM,
 22316               6690-END-OF-FILE
 22317         DEPENDING ON DFHEIGDI
 22318     ELSE IF DFHEIGDJ EQUAL 8
 22319         GO TO 6690-END-OF-FILE,
 22320               6690-ERRESC-PROBLEM,
 22321               6690-ERRESC-PROBLEM,
 22322               6690-END-OF-FILE
 22323         DEPENDING ON DFHEIGDI
 22324     ELSE IF DFHEIGDJ EQUAL 9
 22325         GO TO 7250-CONTINUE,
 22326               7250-CONTINUE
 22327         DEPENDING ON DFHEIGDI
 22328     ELSE IF DFHEIGDJ EQUAL 10
 22329         GO TO 7300-CONTINUE,
 22330               7300-CONTINUE
 22331         DEPENDING ON DFHEIGDI
 22332     ELSE IF DFHEIGDJ EQUAL 11
 22333         GO TO 8000-FREE-MAIN
 22334         DEPENDING ON DFHEIGDI
 22335     ELSE IF DFHEIGDJ EQUAL 12
 22336         GO TO 8100-NOTFND,
 22337               8100-NOTFND
 22338         DEPENDING ON DFHEIGDI
 22339     ELSE IF DFHEIGDJ EQUAL 13
 22340         GO TO 8110-NOTFND,
 22341               8110-NOTFND
 22342         DEPENDING ON DFHEIGDI
 22343     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 414
* EL050.cbl
 22344         GO TO 8130-EXIT
 22345         DEPENDING ON DFHEIGDI
 22346     ELSE IF DFHEIGDJ EQUAL 15
 22347         GO TO 8150-exit
 22348         DEPENDING ON DFHEIGDI
 22349     ELSE IF DFHEIGDJ EQUAL 16
 22350         GO TO 8180-NOTFND
 22351         DEPENDING ON DFHEIGDI
 22352     ELSE IF DFHEIGDJ EQUAL 17
 22353         GO TO 8190-NOTFND
 22354         DEPENDING ON DFHEIGDI
 22355     ELSE IF DFHEIGDJ EQUAL 18
 22356         GO TO 8195-NOTFND
 22357         DEPENDING ON DFHEIGDI
 22358     ELSE IF DFHEIGDJ EQUAL 19
 22359         GO TO 8200-NOTFND
 22360         DEPENDING ON DFHEIGDI
 22361     ELSE IF DFHEIGDJ EQUAL 20
 22362         GO TO 8300-NOTFND,
 22363               8300-ERRESS-PROBLEM,
 22364               8300-ERRESS-PROBLEM,
 22365               8300-NOTFND
 22366         DEPENDING ON DFHEIGDI
 22367     ELSE IF DFHEIGDJ EQUAL 21
 22368         GO TO 8450-FORM-NOT-FOUND,
 22369               8450-FORM-NOT-FOUND
 22370         DEPENDING ON DFHEIGDI
 22371     ELSE IF DFHEIGDJ EQUAL 22
 22372         GO TO 0199-ACCT-NOT-FOUND,
 22373               0199-ACCT-NOT-FOUND
 22374         DEPENDING ON DFHEIGDI
 22375     ELSE IF DFHEIGDJ EQUAL 23
 22376         GO TO 0199-ACCT-NOT-FOUND,
 22377               0199-ACCT-NOT-FOUND
 22378         DEPENDING ON DFHEIGDI
 22379     ELSE IF DFHEIGDJ EQUAL 24
 22380         GO TO 8582-COMP-NOT-FOUND,
 22381               8582-COMP-NOT-FOUND
 22382         DEPENDING ON DFHEIGDI
 22383     ELSE IF DFHEIGDJ EQUAL 25
 22384         GO TO 8583-AGTC-NOT-FOUND,
 22385               8583-AGTC-NOT-FOUND
 22386         DEPENDING ON DFHEIGDI
 22387     ELSE IF DFHEIGDJ EQUAL 26
 22388         GO TO 8584-BXRF-NOT-FOUND,
 22389               8584-BXRF-NOT-FOUND
 22390         DEPENDING ON DFHEIGDI
 22391     ELSE IF DFHEIGDJ EQUAL 27
 22392         GO TO 8585-PLAN-NOT-FOUND,
 22393               8585-PLAN-NOT-FOUND
 22394         DEPENDING ON DFHEIGDI
 22395     ELSE IF DFHEIGDJ EQUAL 28
 22396         GO TO 0299-CERT-NOT-FOUND
 22397         DEPENDING ON DFHEIGDI
 22398     ELSE IF DFHEIGDJ EQUAL 29
 22399         GO TO 8700-READ-CERT-MASTER
 22400         DEPENDING ON DFHEIGDI
 22401     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 18-Apr-16 13:53 Page 415
* EL050.cbl
 22402         GO TO 8720-COMP-ACCOUNTS,
 22403               8730-END-BROWSE,
 22404               8740-NOT-FOUND
 22405         DEPENDING ON DFHEIGDI
 22406     ELSE IF DFHEIGDJ EQUAL 31
 22407         GO TO 9000-NOTFND
 22408         DEPENDING ON DFHEIGDI
 22409     ELSE IF DFHEIGDJ EQUAL 32
 22410         GO TO 9100-NOTFND,
 22411               9100-NOTFND
 22412         DEPENDING ON DFHEIGDI
 22413     ELSE IF DFHEIGDJ EQUAL 33
 22414         GO TO 9991-CRTO-NOT-FOUND,
 22415               9991-CRTO-NOT-FOUND
 22416         DEPENDING ON DFHEIGDI.
 22417     MOVE '9%                    "   ' TO DFHEIV0
 22418     MOVE 'EL050' TO DFHEIV1
 22419     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22420     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40696     Code:       91544
