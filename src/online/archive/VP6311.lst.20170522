* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   1
* VP6311.cbl
* Options: int("VP6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("VP6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"VP6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"VP6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 VP6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   2
* VP6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - VPB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   3
* VP6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    79******************************************************************
    80
    81 ENVIRONMENT DIVISION.
    82
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   4
* VP6311.cbl
    84 DATA DIVISION.
    85 WORKING-STORAGE SECTION.
    86 01  DFH-START PIC X(04).
    87 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    88 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    89 77  FILLER  PIC X(32)  VALUE '********************************'.
    90 77  FILLER  PIC X(32)  VALUE '*    VP6311 WORKING STORAGE    *'.
    91 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    92 77  A1                          PIC S999 COMP-3 VALUE +0.
    93 77  N1                          PIC S999 COMP-3 VALUE +0.
    94 77  N2                          PIC S999 COMP-3 VALUE +0.
    95 77  N3                          PIC S999 COMP-3 VALUE +0.
    96 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    97 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    98 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    99     88  REVERSAL                    VALUE 'Y'.
   100 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   101 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   102 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   103 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   104 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   105     88  ERMAIL-FOUND                 VALUE 'Y'.
   106 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   107 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   108 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   109 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   110     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   111 77  ws-stop-sw                  pic x value ' '.
   112     88  i-say-stop                 value 'Y'.
   113 77  ws-check-sw                 pic x value ' '.
   114     88  i-have-checks              value 'Y'.
   115 77  ws-proc-check-sw            pic x value ' '.
   116     88  i-have-processed-checks    value 'Y'.
   117 77  ws-chek-browse-sw           pic x value ' '.
   118 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   119 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   120 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   121 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   122 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   123 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   124 01  P pointer.
   125 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   126 01  var-ptr pointer.
   127 01  env-var-len                 pic 9(4)  binary.
   128 01  rc                          pic 9(9)  binary.
   129 01  WS-KIXSYS.
   130     05  WS-KIX-FIL1             PIC X(10).
   131     05  WS-KIX-APPS             PIC X(10).
   132     05  WS-KIX-ENV              PIC X(10).
   133     05  WS-KIX-MYENV            PIC X(10).
   134     05  WS-KIX-SYS              PIC X(10).
   135*    COPY ELCSCTM.
   136******************************************************************
   137*                                                                *
   138*                                                                *
   139*                            ELCSCTM                             *
   140*                            VMOD=2.001                          *
   141*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   5
* VP6311.cbl
   142*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   143*                                                                *
   144******************************************************************
   145 01  SECURITY-MESSAGE.
   146     12  FILLER                          PIC X(30)
   147            VALUE '** LOGIC SECURITY VIOLATION -'.
   148     12  SM-READ                         PIC X(6).
   149     12  FILLER                          PIC X(5)
   150            VALUE ' PGM='.
   151     12  SM-PGM                          PIC X(6).
   152     12  FILLER                          PIC X(5)
   153            VALUE ' OPR='.
   154     12  SM-PROCESSOR-ID                 PIC X(4).
   155     12  FILLER                          PIC X(6)
   156            VALUE ' TERM='.
   157     12  SM-TERMID                       PIC X(4).
   158     12  FILLER                          PIC XX   VALUE SPACE.
   159     12  SM-JUL-DATE                     PIC 9(5).
   160     12  FILLER                          PIC X    VALUE SPACE.
   161     12  SM-TIME                         PIC 99.99.
   162
   163
   164*    COPY ELCSCRTY.
   165******************************************************************
   166*                                                                *
   167*                                                                *
   168*                            ELCSCRTY                            *
   169*                            VMOD=2.001                          *
   170*                                                                *
   171*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   172*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   173*        SAVED IN PI-SECURITY-ADDRESS.                           *
   174*                                                                *
   175******************************************************************
   176 01  SECURITY-CONTROL.
   177     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   178     12  FILLER                       PIC XX    VALUE 'SC'.
   179     12  SC-CREDIT-CODES.
   180         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   181             20  SC-CREDIT-DISPLAY    PIC X.
   182             20  SC-CREDIT-UPDATE     PIC X.
   183     12  SC-CLAIMS-CODES.
   184         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   185             20  SC-CLAIMS-DISPLAY    PIC X.
   186             20  SC-CLAIMS-UPDATE     PIC X.
   187
   188 01  WS-VA-NO-COMM-MESS.
   189     12  FILLER                  PIC X(41) VALUE
   190        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   191 01  WS-OC-MESSAGE.
   192     12  FILLER                  PIC X(43) VALUE
   193        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   194     12  WS-OC-DIS-AMT           PIC -----9.99.
   195     12  FILLER                  PIC X(4) VALUE ' ON '.
   196     12  WS-OC-DATE              PIC X(10).
   197 01  WS-DATE-AREA.
   198     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   199     12  WS-CURRENT-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   6
* VP6311.cbl
   200         16  FILLER              PIC X(6)    VALUE SPACES.
   201         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   202     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   203     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   204     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   205
   206 01  STANDARD-AREAS.
   207     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   208     12  VP631B                  PIC X(8)    VALUE 'VP631B'.
   209     12  VP631C                  PIC X(8)    VALUE 'VP631C'.
   210     12  VP631D                  PIC X(8)    VALUE 'VP631D'.
   211     12  MAPSET-VP6311S          PIC X(8)    VALUE 'VP6311S'.
   212     12  SCREEN-NUMBER           PIC X(6)    VALUE 'VP631B'.
   213     12  TRANS-EXB1              PIC X(4)    VALUE 'VPB1'.
   214     12  THIS-PGM                PIC X(8)    VALUE 'VP6311'.
   215     12  PGM-NAME                PIC X(8).
   216     12  TIME-IN                 PIC S9(7).
   217     12  TIME-OUT-R  REDEFINES TIME-IN.
   218         16  FILLER              PIC X.
   219         16  TIME-OUT            PIC 99V99.
   220         16  FILLER              PIC XX.
   221     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   222     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   223     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   224     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   225     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   226     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   227     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   228     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   229     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   230     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   231     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   232     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   233     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   234     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   235     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   236     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   237     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   238     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   239     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   240     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   241     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   242     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   243     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   244     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   245     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   246     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   247     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   248     12  FILE-ID                 PIC X(8).
   249     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   250     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   251     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   252     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   253     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   254     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   255     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   256     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   257     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   7
* VP6311.cbl
   258     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   259     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   260     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   261     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   262     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   263     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   264
   265 01  WS-PASS-AREA.
   266     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   267     05  WS-PASS-VADS-REC    PIC X(350).
   268*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   269*                                COPY ELCZREC.
   270******************************************************************
   271*                                                                *
   272*                                                                *
   273*                            ELCZREC.                            *
   274*                                                                *
   275*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   276*                                                                *
   277******************************************************************
   278*-----------------------------------------------------------------
   279*                   C H A N G E   L O G
   280*
   281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   282*-----------------------------------------------------------------
   283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   284* EFFECTIVE    NUMBER
   285*-----------------------------------------------------------------
   286* 122011    2011022800001  AJRA  NEW FILE
   287* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   288* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   289* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   290* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   291*-----------------------------------------------------------------
   292 01  W-Z-CONTROL-DATA.
   293     05  W-NUMBER-OF-COPIES      PIC  9.
   294     05  FILLER                  PIC  X.
   295     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   296     05  FILLER                  PIC  X.
   297     05  W-DAYS-TO-RESEND        PIC  999.
   298     05  FILLER                  PIC  X.
   299     05  W-FORM-TO-RESEND        PIC  X(4).
   300     05  W-ADD-BAR-CODE          PIC  X.
   301     05  W-PROMPT-LETTER         PIC  X.
   302     05  W-HAS-RETURN-ENV        PIC  X.
   303     05  W-ENCLOSURE-CD          PIC  XXX.
   304     05  W-SIG-FLAG-DEFAULT      PIC  X.
   305     05  W-AUTO-CLOSE-IND        PIC  X.
   306     05  FILLER                  PIC  X.
   307     05  W-LETTER-TO-BENE        PIC  X.
   308     05  FILLER                  PIC  X.
   309     05  W-LETTER-TO-ACCT        PIC  X.
   310     05  FILLER                  PIC  X.
   311     05  W-LETTER-TYPE           PIC  X.
   312     05  FILLER                  PIC  X.
   313     05  W-PRINT-CERTIFICATE     PIC  X.
   314     05  FILLER                  PIC  X.
   315     05  W-REFUND-REQUIRED       PIC  X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   8
* VP6311.cbl
   316     05  FILLER                  PIC  X.
   317     05  W-ONBASE-CODE           PIC  XX.
   318     05  FILLER                  PIC  X.
   319     05  W-ACCT-SUMM             PIC  X.
   320     05  FILLER                  PIC  X.
   321     05  W-CSO-SUMM              PIC  X.
   322     05  FILLER                  PIC  X.
   323     05  W-REASONS-REQUIRED      PIC  X.
   324     05  FILLER                  PIC  X(29).
   325******************************************************************
   326*                                                                *
   327*              A C C E S S   K E Y S                             *
   328*                                                                *
   329******************************************************************
   330
   331 01  ACCESS-KEYS.
   332     12  ERPYAJ-KEY.
   333         16  ERPYAJ-COMPANY-CD       PIC X.
   334         16  ERPYAJ-CARRIER          PIC X.
   335         16  ERPYAJ-GROUPING         PIC X(6).
   336         16  ERPYAJ-FIN-RESP         PIC X(10).
   337         16  ERPYAJ-ACCOUNT          PIC X(10).
   338         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   339         16  ERPYAJ-TYPE             PIC X.
   340     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   341     12  ELCERT-KEY.
   342         16  ELCERT-COMPANY-CD       PIC X.
   343         16  ELCERT-CARRIER          PIC X.
   344         16  ELCERT-GROUPING         PIC X(6).
   345         16  ELCERT-STATE            PIC XX.
   346         16  ELCERT-ACCOUNT          PIC X(10).
   347         16  ELCERT-CERT-EFF-DT      PIC XX.
   348         16  ELCERT-CERT-NO.
   349             20  ELCERT-CERT-PRIME   PIC X(10).
   350             20  ELCERT-CERT-SFX     PIC X.
   351
   352     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   353     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   354     12  ELCRTO-KEY.
   355         16  ELCRTO-COMPANY-CD       PIC X.
   356         16  ELCRTO-CARRIER          PIC X.
   357         16  ELCRTO-GROUPING         PIC X(6).
   358         16  ELCRTO-STATE            PIC XX.
   359         16  ELCRTO-ACCOUNT          PIC X(10).
   360         16  ELCRTO-CERT-EFF-DT      PIC XX.
   361         16  ELCRTO-CERT-NO.
   362             20  ELCRTO-CERT-PRIME   PIC X(10).
   363             20  ELCRTO-CERT-SFX     PIC X.
   364         16  ELCRTO-RECORD-TYPE      PIC X.
   365         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   366
   367     12  ELCRTT-KEY.
   368         16  ELCRTT-PRIMARY          PIC X(33).
   369         16  ELCRTT-REC-TYPE         PIC X(1).
   370     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   371     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   372
   373     12  ERPNDB-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   9
* VP6311.cbl
   374         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   375         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   376         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   377         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   378             ERPNDB-BATCH-SEQ-NO     PIC XX.
   379         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   380
   381     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   382     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   383     12  ERCHEK-KEY.
   384         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   385         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   386         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   387         16  CHEK-STATE              PIC XX      VALUE SPACES.
   388         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   389         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   390         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   391         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   392         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   393     12  ELLETR-KEY.
   394         16  LETR-COMPANY-CD     PIC X.
   395         16  LETR-LETTER-ID      PIC X(4).
   396         16  LETR-FILLER         PIC X(8).
   397         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   398     12  ERPNDM-KEY.
   399         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   400         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   401         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   402         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   403
   404*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   405     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   406*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   407     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   408
   409     12  ERPNDB-ALT-KEY.
   410         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   411         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   412         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   413         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   414         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   415         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   416         16  ERPNDB-CERT-NO.
   417             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   418             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   419         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   420         16  ERPNDB-RECORD-TYPE      PIC X.
   421
   422      12  ERPNDB-CSR-KEY.
   423          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   424          20  ERPNDB-CSR-ID                PIC X(4).
   425          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   426          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   427          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   428
   429     12  ERNOTE-KEY.
   430         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   431         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  10
* VP6311.cbl
   432         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   433         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   434         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   435         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   436         16  ERNOTE-CERT-NO.
   437             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   438             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   439
   440     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   441     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   442
   443     12  ERCNOT-KEY.
   444         16  ERCNOT-PART-KEY.
   445             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   446             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   447             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   448             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   449             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   450             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   451             20  ERCNOT-CERT-NO.
   452                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   453                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   454         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   455         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   456
   457     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   458     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   459
   460     12  ERMAIL-KEY.
   461         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   462         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   463         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   464         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   465         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   466         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   467         16  ERMAIL-CERT-NO.
   468             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   469             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   470
   471     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   472     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   473
   474     12  ERRQST-KEY.
   475         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   476         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   477
   478     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   479     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   480
   481     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   482
   483     12  ERLOFC-KEY.
   484         16  ERLOFC-COMPANY-CD          PIC  X.
   485         16  ERLOFC-CARRIER             PIC  X.
   486         16  ERLOFC-GROUPING            PIC  X(6).
   487         16  ERLOFC-STATE               PIC  XX.
   488         16  ERLOFC-ACCOUNT             PIC  X(10).
   489         16  ERLOFC-OFFICER-CODE        PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  11
* VP6311.cbl
   490*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   491
   492     12  ERACCT-KEY.
   493         16  ERACCT-COMPANY-CD          PIC  X.
   494         16  ERACCT-CARRIER             PIC  X.
   495         16  ERACCT-GROUPING            PIC  X(6).
   496         16  ERACCT-STATE               PIC  XX.
   497         16  ERACCT-ACCOUNT             PIC  X(10).
   498         16  ERACCT-EXP-DT.
   499             20  ERACCT-DT              PIC  XX.
   500             20  ERACCT-FILL            PIC  X(4).
   501
   502     12  ERENDT-KEY.
   503         16  ENDT-COMPANY-CD       PIC X.
   504         16  ENDT-CARRIER          PIC X.
   505         16  ENDT-GROUPING         PIC X(6).
   506         16  ENDT-STATE            PIC XX.
   507         16  ENDT-ACCOUNT          PIC X(10).
   508         16  ENDT-CERT-EFF-DT      PIC XX.
   509         16  ENDT-CERT-PRIME       PIC X(10).
   510         16  ENDT-CERT-SFX         PIC X.
   511         16  ENDT-RECORD-TYPE      PIC X.
   512         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   513
   514 01  WS-ELMSTR-WORK.
   515     12  ELMSTR-KEY.
   516         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   517         16  MSTR-CERT-NO.
   518             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   519             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   520     12  W-CLAIM-KEY.
   521         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   522         16  W-CL-CERT-NO.
   523             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   524             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   525      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   526 01  CANCEL-GEN-PASS-AREA.
   527     05  CG-OPTION-CODE          PIC X.
   528         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   529         88  CG-FLAT-CANCEL        VALUE '1'.
   530         88  CG-CANCEL             VALUE '2'.
   531         88  CG-CANCEL-REISSUE     VALUE '3'.
   532     05  CG-ERROR-CODE           PIC 99.
   533         88  CG-SUCCESS            VALUE 00.
   534         88  CG-DATE-ERROR         VALUE 01.
   535         88  CG-CERT-NOT-FOUND     VALUE 02.
   536         88  CG-AMOUNT-ERROR       VALUE 04.
   537         88  CG-OPTION-ERROR       VALUE 05.
   538         88  CG-PREV-CAN           VALUE 06.
   539         88  CG-INVALID-DATA       VALUE 07.
   540         88  CG-NO-ACCT-MSTR       VALUE 08.
   541         88  CG-SFX-A-EXIST        VALUE 09.
   542         88  CG-MISC-ERROR         VALUE 99.
   543     05  CG-COMPANY-ID           PIC XXX.
   544     05  CG-PROC-ID              PIC XXXX.
   545     05  CG-CURRENT-DT           PIC XX.
   546     05  CG-MONTH-END-DT         PIC XX.
   547     05  CG-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  12
* VP6311.cbl
   548         10  CG-CERT-COMPANY-CD  PIC X.
   549         10  CG-CERT-CARRIER     PIC X.
   550         10  CG-CERT-GROUP       PIC X(6).
   551         10  CG-CERT-STATE       PIC XX.
   552         10  CG-CERT-ACCOUNT     PIC X(10).
   553         10  CG-CERT-EFF-DT      PIC XX.
   554         10  CG-CERT-CERT-NO     PIC X(11).
   555     05  CG-LF-CAN-DATA.
   556         10  CG-LF-CAN-DT        PIC XX.
   557         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   558     05  CG-AH-CAN-DATA.
   559         10  CG-AH-CAN-DT        PIC XX.
   560         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   561     05  CG-CERT-PROFILE-DATA.
   562         10  CG-INS-LNAME        PIC X(15).
   563         10  CG-INS-FNAME        PIC X(10).
   564         10  CG-INS-MID-INIT     PIC X.
   565         10  CG-INS-AGE          PIC 99.
   566         10  CG-JNT-LNAME        PIC X(15).
   567         10  CG-JNT-FNAME        PIC X(10).
   568         10  CG-JNT-MID-INIT     PIC X.
   569         10  CG-JNT-AGE          PIC 99.
   570     05  CG-LF-ISS-DATA.
   571         10  CG-LF-BENCD         PIC XX.
   572         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   573         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   574     05  CG-AH-ISS-DATA.
   575         10  CG-AH-BENCD         PIC XX.
   576         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   577     05  CG-BATCH-NO             PIC X(6).
   578     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   579     05  FILLER                  PIC X(306).
   580******************************************************************
   581*                                                                *
   582*            G E N E R A L   W O R K   A R E A                   *
   583*                                                                *
   584******************************************************************
   585
   586 01  WORK-AREA.
   587     12  WS-RESPONSE             PIC S9(8)   COMP.
   588         88  RESP-NORMAL           VALUE +0.
   589         88  resp-file-notfnd      value +12.
   590         88  RESP-NOTFND           VALUE +13.
   591         88  resp-duprec           value +14.
   592         88  resp-dupkey           value +15.
   593         88  resp-invreq           value +16.
   594         88  RESP-NOTOPEN          VALUE +19.
   595         88  RESP-ENDFILE          VALUE +20.
   596         88  resp-lengtherr        value +22.
   597     12  DEEDIT-FIELD            PIC X(15).
   598     12  FILLER          REDEFINES DEEDIT-FIELD.
   599         16  FILLER              PIC X(4).
   600         16  DEEDIT-FIELD-X11    PIC X(11).
   601     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   602                                 PIC S9(15).
   603     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   604                                 PIC S9(13)V99.
   605     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  13
* VP6311.cbl
   606                                 PIC S9(11)V9999.
   607     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   608     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   609     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   610         16  WS-CALC-TERM-WHOLE  PIC S999.
   611         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   612
   613     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   614     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   615         16  WS-HR-MINS          PIC 99V99.
   616         16  FILLER              PIC XX.
   617
   618     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   619     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   620
   621     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   622     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   623
   624     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   625     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   626     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   627     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   628     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   629     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   630     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   631
   632     12  QID.
   633         16  QID-TERM            PIC X(4).
   634         16  FILLER              PIC X(4)    VALUE '607B'.
   635
   636     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   637         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   638
   639     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   640         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   641
   642     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   643         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   644                                         'A'.
   645
   646     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   647
   648     12  WS-NUMERIC-SW           PIC X.
   649        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   650
   651     12  WS-EDIT-CSO-FIELD.
   652         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   653                                 PIC X.
   654
   655     12  WS-SAVE-INPUT-FIELDS.
   656         16  WS-BAGE             PIC 99       VALUE ZERO.
   657*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   658         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   659         16  FILLER REDEFINES WS-BAPR.
   660             20  WS-APR-WHOLE-NUM    PIC 99.
   661             20  WS-APR-DEC          PIC 9999.
   662         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   663         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  14
* VP6311.cbl
   664
   665         16  WS-B-COVERAGE OCCURS 2 TIMES.
   666             20  WS-TERM-IN-DAYS-SW  PIC X.
   667                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   668             20  WS-BTERM        PIC 999       COMP-3.
   669             20  WS-BALT-TERM    PIC 999       COMP-3.
   670             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   671             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   672             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   673             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   674             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   675             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   676
   677         16  WS-C-FIELDS COMP-3.
   678             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   679             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   680             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   681
   682         16  WS-D-FIELDS COMP-3.
   683             20  WS-DRISS        PIC S9(5)    VALUE +0.
   684             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   685             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   686             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   687             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   688             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   689
   690     12  WS-SAVE-BIRTH-DATE.
   691         16  FILLER              PIC X(4)   VALUE SPACES.
   692         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   693
   694     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   695     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   696     12  FILLER REDEFINES WS-WORK-BIN-RED.
   697         16  FILLER              PIC X(02).
   698         16  WS-WORK-BIN-DT      PIC X(02).
   699     12  WS-SW-1                 PIC X     VALUE SPACE.
   700     12  WS-SW-2                 PIC X     VALUE SPACE.
   701     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   702         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   703     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   704         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   705
   706     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   707     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   708     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   709     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   710     12  WS-CONVERTED-CANCEL-DATES.
   711         16  WS-CONVERTED-CANDT1                  PIC XX.
   712         16  WS-CONVERTED-CANDT2                  PIC XX.
   713
   714     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   715
   716     12  WS-REC-FOUND-SW         PIC X.
   717         88  RECORD-NOT-FOUND    VALUE 'N'.
   718
   719     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   720         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   721         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  15
* VP6311.cbl
   722
   723     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   724         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   725         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   726
   727     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   728         88  BROWSE-STARTED      VALUE 'Y'.
   729
   730     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   731         88  FIRST-TIME          VALUE 'Y'.
   732
   733     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   734         88  FIRST-ENTRY         VALUE 'Y'.
   735
   736     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   737         88  REC-BILLED          VALUE 'Y'.
   738
   739     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   740         88  NO-CURSOR-SET       VALUE +0.
   741         88  CURSOR-SET          VALUE +1.
   742
   743     12  WS-ERR-SW               PIC X.
   744         88  STD-ERRORS          VALUE 'S'.
   745         88  TRN-ERRORS          VALUE 'T'.
   746
   747     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   748         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   749
   750     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   751         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   752
   753     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   754         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   755
   756     12  WS-ERR-CODE.
   757         16  FILLER              PIC 99.
   758         16  WS-ERROR-SUB        PIC 99.
   759
   760     12  WS-DATE-WORK.
   761         16  WS-WORK-MM          PIC XX.
   762         16  WS-WORK-DD          PIC XX.
   763         16  WS-WORK-YY          PIC XX.
   764
   765     12  WS-MM-YY.
   766         16  WS-MM               PIC XX.
   767         16  FILLER              PIC X     VALUE '/'.
   768         16  WS-YY               PIC XX.
   769
   770     12  WS-CERT-EFF-DT          PIC XX.
   771
   772     12  WS-MEMBER-NO            PIC X(12).
   773     12  FILLER  REDEFINES  WS-MEMBER-NO.
   774         16  WS-MEMBER-NO-1-8    PIC 9(8).
   775         16  FILLER              PIC X(4).
   776
   777     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   778
   779     12  WS-ERPNDB-ALT-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  16
* VP6311.cbl
   780         16  WS-PB-COMPANY-CD-A1         PIC X.
   781         16  WS-PB-CARRIER               PIC X.
   782         16  WS-PB-GROUPING              PIC X(6).
   783         16  WS-PB-STATE                 PIC XX.
   784         16  WS-PB-ACCOUNT               PIC X(10).
   785         16  WS-PB-CERT-EFF-DT           PIC XX.
   786         16  WS-PB-CERT-NO.
   787             20  WS-PB-CERT-PRIME        PIC X(10).
   788             20  WS-PB-CERT-SFX          PIC X.
   789         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   790         16  WS-PB-RECORD-TYPE           PIC X.
   791
   792     12  WS-SHOW-SAVE-AREAS.
   793         16  WS-NEW-CERT-NO.
   794             20  WS-NEW-PRIME    PIC X(10).
   795             20  WS-NEW-SUFFIX   PIC X.
   796         16  WS-NEW-CERT-EFF-DT  PIC XX.
   797         16  WS-NEW-RECORD-TYPE  PIC X.
   798         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   799             88   SHOW-RECORD            VALUE 'Y'.
   800
   801     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   802
   803     12  WS-BATCH-NO.
   804         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   805         16  FILLER              PIC X(5) VALUE SPACES.
   806
   807     12  WS-FIRST-NAME.
   808         16  WS-1ST-INIT         PIC X.
   809         16  FILLER              PIC X(9).
   810
   811     12  WS-INITIALS.
   812         16  WS-INITIAL-1        PIC X.
   813         16  WS-INITIAL-2        PIC X.
   814
   815     12  WS-C-HDG.
   816         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   817         16  FILLER              PIC X(4) VALUE '-REF'.
   818
   819     12  WS-D-PREM-HDG.
   820         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   821         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   822
   823     12  WS-D-REFUND-HDG.
   824         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   825         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   826
   827     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   828
   829     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   830     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   831     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   832     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   833     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   834     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   835     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   836
   837     12  WS-01-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  17
* VP6311.cbl
   838         VALUE 'CANCEL DATE ERROR'.
   839     12  WS-02-CANCEL-ERR        PIC X(25)
   840         VALUE 'CERT NOT FOUND'.
   841     12  WS-04-CANCEL-ERR        PIC X(25)
   842         VALUE 'CANCEL AMOUNT ERROR'.
   843     12  WS-05-CANCEL-ERR        PIC X(25)
   844         VALUE 'CANCEL OPTION ERROR'.
   845     12  WS-06-CANCEL-ERR        PIC X(25)
   846         VALUE 'PREVIOUSLY CANCELLED'.
   847     12  WS-07-CANCEL-ERR        PIC X(25)
   848         VALUE 'INVALID DATA'.
   849     12  WS-08-CANCEL-ERR        PIC X(25)
   850         VALUE 'NO ACCOUNT MASTER'.
   851     12  WS-09-CANCEL-ERR        PIC X(25)
   852         VALUE 'SUFFIX ALREADY EXISTS'.
   853     12  WS-99-CANCEL-ERR        PIC X(25)
   854         VALUE 'MISC CANCEL ERROR'.
   855
   856     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   857     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   858
   859     12  WS-AGE-FIELDS.
   860         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   861         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   862         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   863         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   864
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  18
* VP6311.cbl
   866
   867******************************************************************
   868*                                                                *
   869*                 B A T C H   T O T A L S                        *
   870*                                                                *
   871******************************************************************
   872
   873     12  WS-BATCH-RECORD.
   874         16  FILLER                       PIC X(10).
   875         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   876         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   877         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   878         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   879         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   880         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   881         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   882         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   883         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   884         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   885         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   886         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   887         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   888         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   889         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   890         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   891         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   892         16  WS-ACCOUNT-NAME              PIC X(30).
   893         16  FILLER                       PIC X.
   894         16  WS-REFERENCE                 PIC X(12).
   895         16  FILLER                       PIC X(197).
   896
   897     12  WS-BATCH-TOTALS.
   898         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   899         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   900         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   901         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   902         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   903         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   904         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   905         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   906         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   908         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   909         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   910         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   911         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   912         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   913         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   914         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   915         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   916         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   917
   918     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   919
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  19
* VP6311.cbl
   921
   922******************************************************************
   923*                                                                *
   924*                E R R O R   M E S S A G E S                     *
   925*                                                                *
   926******************************************************************
   927
   928 01  ERROR-MESSAGES.
   929     12  ER-0004                 PIC  9(4) VALUE 0004.
   930     12  ER-0008                 PIC  9(4) VALUE 0008.
   931     12  ER-0023                 PIC  9(4) VALUE 0023.
   932     12  ER-0029                 PIC  9(4) VALUE 0029.
   933     12  ER-0033                 PIC  9(4) VALUE 0033.
   934     12  ER-0070                 PIC  9(4) VALUE 0070.
   935     12  ER-0220                 PIC  9(4) VALUE 0220.
   936     12  ER-0248                 PIC  9(4) VALUE 0248.
   937     12  ER-0280                 PIC  9(4) VALUE 0280.
   938     12  ER-0348                 PIC  9(4) VALUE 0348.
   939     12  ER-0582                 PIC  9(4) VALUE 0582.
   940     12  ER-0877                 PIC  9(4) VALUE 0877.
   941     12  ER-1236                 PIC  9(4) VALUE 1236.
   942     12  ER-1570                 PIC  9(4) VALUE 1570.
   943     12  ER-1575                 PIC  9(4) VALUE 1575.
   944     12  ER-1609                 PIC  9(4) VALUE 1609.
   945     12  ER-1819                 PIC  9(4) VALUE 1819.
   946     12  ER-2077                 PIC  9(4) VALUE 2077.
   947     12  ER-2129                 PIC  9(4) VALUE 2129.
   948     12  ER-2188                 PIC  9(4) VALUE 2188.
   949     12  ER-2192                 PIC  9(4) VALUE 2192.
   950     12  ER-2196                 PIC  9(4) VALUE 2196.
   951     12  ER-2197                 PIC  9(4) VALUE 2197.
   952     12  ER-2198                 PIC  9(4) VALUE 2198.
   953     12  ER-2200                 PIC  9(4) VALUE 2200.
   954     12  ER-2212                 PIC  9(4) VALUE 2212.
   955     12  ER-2218                 PIC  9(4) VALUE 2218.
   956     12  ER-2220                 PIC  9(4) VALUE 2220.
   957     12  ER-2222                 PIC  9(4) VALUE 2222.
   958     12  ER-2223                 PIC  9(4) VALUE 2223.
   959     12  ER-2224                 PIC  9(4) VALUE 2224.
   960     12  ER-2225                 PIC  9(4) VALUE 2225.
   961     12  ER-2226                 PIC  9(4) VALUE 2226.
   962     12  ER-2227                 PIC  9(4) VALUE 2227.
   963     12  ER-2228                 PIC  9(4) VALUE 2228.
   964     12  ER-2240                 PIC  9(4) VALUE 2240.
   965     12  ER-2241                 PIC  9(4) VALUE 2241.
   966     12  ER-2242                 PIC  9(4) VALUE 2242.
   967     12  ER-2243                 PIC  9(4) VALUE 2243.
   968     12  ER-2244                 PIC  9(4) VALUE 2244.
   969     12  ER-2245                 PIC  9(4) VALUE 2245.
   970     12  ER-2246                 PIC  9(4) VALUE 2246.
   971     12  ER-2247                 PIC  9(4) VALUE 2247.
   972     12  ER-2251                 PIC  9(4) VALUE 2251.
   973     12  ER-2252                 PIC  9(4) VALUE 2252.
   974     12  ER-2253                 PIC  9(4) VALUE 2253.
   975     12  ER-2254                 PIC  9(4) VALUE 2254.
   976     12  ER-2255                 PIC  9(4) VALUE 2255.
   977     12  ER-2256                 PIC  9(4) VALUE 2256.
   978     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  20
* VP6311.cbl
   979     12  ER-2258                 PIC  9(4) VALUE 2258.
   980     12  ER-2259                 PIC  9(4) VALUE 2259.
   981     12  ER-2260                 PIC  9(4) VALUE 2260.
   982     12  ER-2261                 PIC  9(4) VALUE 2261.
   983     12  ER-2287                 PIC  9(4) VALUE 2287.
   984     12  ER-2336                 PIC  9(4) VALUE 2336.
   985     12  ER-2337                 PIC  9(4) VALUE 2337.
   986     12  ER-2437                 PIC  9(4) VALUE 2437.
   987     12  ER-2471                 PIC  9(4) VALUE 2471.
   988     12  ER-2530                 PIC  9(4) VALUE 2530.
   989     12  ER-2531                 PIC  9(4) VALUE 2531.
   990     12  ER-2532                 PIC  9(4) VALUE 2532.
   991     12  ER-2533                 PIC  9(4) VALUE 2533.
   992     12  ER-2547                 PIC  9(4) VALUE 2547.
   993     12  ER-2591                 PIC  9(4) VALUE 2591.
   994     12  ER-2592                 PIC  9(4) VALUE 2592.
   995     12  ER-2593                 PIC  9(4) VALUE 2593.
   996     12  ER-2600                 PIC  9(4) VALUE 2600.
   997     12  ER-2601                 PIC  9(4) VALUE 2601.
   998     12  ER-2604                 PIC  9(4) VALUE 2604.
   999     12  ER-2605                 PIC  9(4) VALUE 2605.
  1000     12  ER-2606                 PIC  9(4) VALUE 2606.
  1001     12  ER-2607                 PIC  9(4) VALUE 2607.
  1002     12  ER-2622                 PIC  9(4) VALUE 2622.
  1003     12  ER-2625                 PIC  9(4) VALUE 2625.
  1004     12  ER-2626                 PIC  9(4) VALUE 2626.
  1005     12  ER-2627                 PIC  9(4) VALUE 2627.
  1006     12  ER-2628                 PIC  9(4) VALUE 2628.
  1007     12  ER-2629                 PIC  9(4) VALUE 2629.
  1008     12  ER-2630                 PIC  9(4) VALUE 2630.
  1009     12  ER-2631                 PIC  9(4) VALUE 2631.
  1010     12  ER-2632                 PIC  9(4) VALUE 2632.
  1011     12  ER-2633                 PIC  9(4) VALUE 2633.
  1012     12  ER-2634                 PIC  9(4) VALUE 2634.
  1013     12  ER-2635                 PIC  9(4) VALUE 2635.
  1014     12  ER-2636                 PIC  9(4) VALUE 2636.
  1015     12  ER-2639                 PIC  9(4) VALUE 2639.
  1016     12  ER-2640                 PIC  9(4) VALUE 2640.
  1017     12  ER-2647                 PIC  9(4) VALUE 2647.
  1018     12  ER-2648                 PIC  9(4) VALUE 2648.
  1019     12  ER-2649                 PIC  9(4) VALUE 2649.
  1020     12  ER-2650                 PIC  9(4) VALUE 2650.
  1021     12  ER-2653                 PIC  9(4) VALUE 2653.
  1022     12  ER-2654                 PIC  9(4) VALUE 2654.
  1023     12  ER-2655                 PIC  9(4) VALUE 2655.
  1024     12  ER-2656                 PIC  9(4) VALUE 2656.
  1025     12  ER-2657                 PIC  9(4) VALUE 2657.
  1026     12  ER-2660                 PIC  9(4) VALUE 2660.
  1027     12  ER-2661                 PIC  9(4) VALUE 2661.
  1028     12  ER-2662                 PIC  9(4) VALUE 2662.
  1029     12  ER-2663                 PIC  9(4) VALUE 2663.
  1030     12  ER-2664                 PIC  9(4) VALUE 2664.
  1031     12  ER-2667                 PIC  9(4) VALUE 2667.
  1032     12  ER-2668                 PIC  9(4) VALUE 2668.
  1033     12  ER-2669                 PIC  9(4) VALUE 2669.
  1034     12  ER-2670                 PIC  9(4) VALUE 2670.
  1035     12  ER-2671                 PIC  9(4) VALUE 2671.
  1036     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  21
* VP6311.cbl
  1037     12  ER-2673                 PIC  9(4) VALUE 2673.
  1038     12  ER-2677                 PIC  9(4) VALUE 2677.
  1039     12  ER-2678                 PIC  9(4) VALUE 2678.
  1040     12  ER-2679                 PIC  9(4) VALUE 2679.
  1041     12  ER-2680                 PIC  9(4) VALUE 2680.
  1042     12  ER-2681                 PIC  9(4) VALUE 2681.
  1043     12  ER-2682                 PIC  9(4) VALUE 2682.
  1044     12  ER-2683                 PIC  9(4) VALUE 2683.
  1045     12  ER-2684                 PIC  9(4) VALUE 2684.
  1046     12  ER-2686                 PIC  9(4) VALUE 2686.
  1047     12  ER-2689                 PIC  9(4) VALUE 2689.
  1048     12  ER-2690                 PIC  9(4) VALUE 2690.
  1049     12  ER-2693                 PIC  9(4) VALUE 2693.
  1050     12  ER-2695                 PIC  9(4) VALUE 2695.
  1051     12  ER-2701                 PIC  9(4) VALUE 2701.
  1052     12  ER-2720                 PIC  9(4) VALUE 2720.
  1053     12  ER-2709                 PIC  9(4) VALUE 2709.
  1054     12  ER-2704                 PIC  9(4) VALUE 2704.
  1055     12  ER-2725                 PIC  9(4) VALUE 2725.
  1056     12  ER-2726                 PIC  9(4) VALUE 2726.
  1057     12  ER-2728                 PIC  9(4) VALUE 2728.
  1058     12  ER-2729                 PIC  9(4) VALUE 2729.
  1059     12  ER-2731                 PIC  9(4) VALUE 2731.
  1060     12  ER-2732                 PIC  9(4) VALUE 2732.
  1061     12  ER-2733                 PIC  9(4) VALUE 2733.
  1062     12  ER-2735                 PIC  9(4) VALUE 2735.
  1063     12  ER-2738                 PIC  9(4) VALUE 2738.
  1064     12  ER-2742                 PIC  9(4) VALUE 2742.
  1065     12  ER-2743                 PIC  9(4) VALUE 2743.
  1066     12  ER-2744                 PIC  9(4) VALUE 2744.
  1067     12  ER-2747                 PIC  9(4) VALUE 2747.
  1068     12  ER-2749                 PIC  9(4) VALUE 2749.
  1069     12  ER-2753                 PIC  9(4) VALUE 2753.
  1070     12  ER-2755                 PIC  9(4) VALUE 2755.
  1071     12  ER-2757                 PIC  9(4) VALUE 2757.
  1072     12  ER-2771                 PIC  9(4) VALUE 2771.
  1073     12  ER-2774                 PIC  9(4) VALUE 2774.
  1074     12  ER-2775                 PIC  9(4) VALUE 2775.
  1075     12  ER-2776                 PIC  9(4) VALUE 2776.
  1076     12  ER-2777                 PIC  9(4) VALUE 2777.
  1077     12  ER-2794                 PIC  9(4) VALUE 2794.
  1078     12  ER-2799                 PIC  9(4) VALUE 2799.
  1079     12  ER-2900                 PIC  9(4) VALUE 2900.
  1080     12  ER-2902                 PIC  9(4) VALUE 2902.
  1081     12  ER-2945                 PIC  9(4) VALUE 2945.
  1082     12  ER-3000                 PIC  9(4) VALUE 3000.
  1083     12  ER-3006                 PIC  9(4) VALUE 3006.
  1084     12  ER-3054                 PIC  9(4) VALUE 3054.
  1085     12  ER-3224                 PIC  9(4) VALUE 3224.
  1086     12  ER-3269                 PIC  9(4) VALUE 3269.
  1087     12  er-3444                 pic  9(4) value 3444.
  1088     12  er-3446                 pic  9(4) value 3446.
  1089     12  er-3447                 pic  9(4) value 3447.
  1090     12  er-3448                 pic  9(4) value 3448.
  1091     12  er-3449                 pic  9(4) value 3449.
  1092     12  ER-3456                 PIC  9(4) VALUE 3456.
  1093     12  ER-3457                 PIC  9(4) VALUE 3457.
  1094     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  22
* VP6311.cbl
  1095     12  ER-3504                 PIC  9(4) VALUE 3504.
  1096     12  ER-3513                 PIC  9(4) VALUE 3513.
  1097     12  ER-3831                 PIC  9(4) VALUE 3831.
  1098     12  ER-3834                 PIC  9(4) VALUE 3834.
  1099     12  ER-3835                 PIC  9(4) VALUE 3835.
  1100     12  ER-4005                 PIC  9(4) VALUE 4005.
  1101     12  ER-7144                 PIC  9(4) VALUE 7144.
  1102     12  ER-7401                 PIC  9(4) VALUE 7401.
  1103     12  ER-7402                 PIC  9(4) VALUE 7402.
  1104     12  ER-7403                 PIC  9(4) VALUE 7403.
  1105     12  ER-7404                 PIC  9(4) VALUE 7404.
  1106     12  ER-7423                 PIC  9(4) VALUE 7423.
  1107     12  ER-7424                 PIC  9(4) VALUE 7424.
  1108     12  ER-7433                 PIC  9(4) VALUE 7433.
  1109     12  ER-7450                 PIC  9(4) VALUE 7450.
  1110     12  ER-7451                 PIC  9(4) VALUE 7451.
  1111     12  ER-7530                 PIC  9(4) VALUE 7530.
  1112     12  ER-7573                 PIC  9(4) VALUE 7573.
  1113     12  ER-7631                 PIC  9(4) VALUE 7631.
  1114     12  ER-7632                 PIC  9(4) VALUE 7632.
  1115     12  ER-7633                 PIC  9(4) VALUE 7633.
  1116     12  ER-7537                 PIC  9(4) VALUE 7537.
  1117     12  ER-7538                 PIC  9(4) VALUE 7538.
  1118     12  ER-7574                 PIC  9(4) VALUE 7574.
  1119     12  ER-7997                 PIC  9(4) VALUE 7997.
  1120     12  ER-7998                 PIC  9(4) VALUE 7998.
  1121     12  ER-8148                 PIC  9(4) VALUE 8148.
  1122     12  ER-9063                 PIC  9(4) VALUE 9063.
  1123     12  ER-9076                 PIC  9(4) VALUE 9076.
  1124     12  ER-9618                 PIC  9(4) VALUE 9618.
  1125     12  ER-9841                 PIC  9(4) VALUE 9841.
  1126
  1127*                                COPY ELCTEXT.
  1128******************************************************************
  1129*                                                                *
  1130*                                                                *
  1131*                            ELCTEXT.                            *
  1132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1133*                            VMOD=2.008                          *
  1134*                                                                *
  1135*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1136*                                     FORM LETTERS,              *
  1137*                                     CERT FORM DISPLAY.
  1138*                                                                *
  1139*   FILE TYPE = VSAM,KSDS                                        *
  1140*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1141*                                                                *
  1142*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1143*       ALTERNATE INDEX = NONE                                   *
  1144*                                                                *
  1145*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1146*       ALTERNATE INDEX = NONE                                   *
  1147*                                                                *
  1148*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1149*       ALTERNATE INDEX = NONE                                   *
  1150*                                                                *
  1151*   LOG = NO                                                     *
  1152*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  23
* VP6311.cbl
  1153******************************************************************
  1154 01  TEXT-FILES.
  1155     12  TEXT-FILE-ID                PIC XX.
  1156         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1157         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1158         88  HELP-FILE-TEXT             VALUE 'TH'.
  1159
  1160     12  TX-CONTROL-PRIMARY.
  1161         16  TX-COMPANY-CD           PIC X.
  1162             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1163         16  TX-ACCESS-CD-GENL       PIC X(12).
  1164
  1165         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1166             20  TX-LETTER-NO        PIC X(4).
  1167             20  FILLER              PIC X(8).
  1168
  1169         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1170             20  TX-FORM-NO          PIC X(12).
  1171
  1172         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1173             20  TX-HELP-TYPE        PIC X.
  1174                 88  HELP-FOR-GENERAL   VALUE ' '.
  1175                 88  HELP-BY-SCREEN     VALUE 'S'.
  1176                 88  HELP-BY-ERROR      VALUE 'E'.
  1177             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1178                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1179             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1180                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1181             20  FILLER              PIC X(4).
  1182
  1183         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1184
  1185     12  TX-PROCESS-CONTROL          PIC XX.
  1186         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1187
  1188     12  TX-TEXT-LINE                PIC X(70).
  1189
  1190     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1191         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1192         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1193         88  TX-VALID-FORM-SQUEEZE-VALUE
  1194                                        VALUE 'Y' ' '.
  1195
  1196     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1197         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1198         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1199         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1200         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1201         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1202         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1203         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1204                                              'K' 'N' ' '
  1205                                              'Z'.
  1206
  1207     12  TX-ARCHIVE-SW               PIC X.
  1208         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1209         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1210         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  24
* VP6311.cbl
  1211
  1212     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1213     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1214
  1215     12  TX-BSR-CODE                 PIC X.
  1216         88  TX-BSR-LETTER              VALUE 'B'.
  1217         88  TX-NON-BSR-LETTER          VALUE ' '.
  1218
  1219     12  FILLER                      PIC X.
  1220*****************************************************************
  1221*                                COPY ELCCRTO.
  1222******************************************************************
  1223*                                                                *
  1224*                            ELCCRTO.                            *
  1225*                                                                *
  1226*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1227*                                                                *
  1228*   FILE TYPE = VSAM,KSDS                                        *
  1229*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1230*                                                                *
  1231*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1232*                                                                *
  1233*   LOG = YES                                                    *
  1234*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1235******************************************************************
  1236*                   C H A N G E   L O G
  1237*
  1238* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1239*-----------------------------------------------------------------
  1240*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1241* EFFECTIVE    NUMBER
  1242*-----------------------------------------------------------------
  1243* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1244* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1245* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1246* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1247* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1248******************************************************************
  1249 01  ORIGINAL-CERTIFICATE.
  1250     12  OC-RECORD-ID                      PIC XX.
  1251         88  VALID-OC-ID                      VALUE 'OC'.
  1252     12  OC-CONTROL-PRIMARY.
  1253         16  OC-COMPANY-CD                 PIC X.
  1254         16  OC-CARRIER                    PIC X.
  1255         16  OC-GROUPING                   PIC X(6).
  1256         16  OC-STATE                      PIC XX.
  1257         16  OC-ACCOUNT                    PIC X(10).
  1258         16  OC-CERT-EFF-DT                PIC XX.
  1259         16  OC-CERT-NO.
  1260             20  OC-CERT-PRIME             PIC X(10).
  1261             20  OC-CERT-SFX               PIC X.
  1262         16  OC-RECORD-TYPE                PIC X.
  1263         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1264     12  OC-LAST-MAINT-DT                  PIC XX.
  1265     12  OC-LAST-MAINT-BY                  PIC X(4).
  1266     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1267     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1268     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  25
* VP6311.cbl
  1269     12  OC-ORIG-REC.
  1270         16  OC-INS-LAST-NAME              PIC X(15).
  1271         16  OC-INS-FIRST-NAME             PIC X(10).
  1272         16  OC-INS-MIDDLE-INIT            PIC X.
  1273         16  OC-INS-AGE                    PIC S999     COMP-3.
  1274         16  OC-JNT-LAST-NAME              PIC X(15).
  1275         16  OC-JNT-FIRST-NAME             PIC X(10).
  1276         16  OC-JNT-MIDDLE-INIT            PIC X.
  1277         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1278         16  OC-LF-BENCD                   PIC XX.
  1279         16  OC-LF-TERM                    PIC S999      COMP-3.
  1280         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1281         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1282         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1283         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1284         16  OC-LF-EXP-DT                  PIC XX.
  1285         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1286         16  OC-LF-CANCEL-DT               PIC XX.
  1287         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1288         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1289         16  OC-AH-BENCD                   PIC XX.
  1290         16  OC-AH-TERM                    PIC S999      COMP-3.
  1291         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1292         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1293         16  OC-AH-EXP-DT                  PIC XX.
  1294         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1295         16  OC-AH-CP                      PIC 99.
  1296         16  OC-AH-CANCEL-DT               PIC XX.
  1297         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1298         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1299         16  OC-CRED-BENE-NAME             PIC X(25).
  1300         16  OC-1ST-PMT-DT                 PIC XX.
  1301         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1302         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1303         16  OC-ISSUE-TRAN-IND             PIC X.
  1304         16  OC-CANCEL-TRAN-IND            PIC X.
  1305         16  FILLER                        PIC X(211).
  1306
  1307     12  FILLER                            PIC X(50).
  1308******************************************************************
  1309*                                COPY ERCACCT.
  1310******************************************************************
  1311*                                                                *
  1312*                                                                *
  1313*                            ERCACCT                             *
  1314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1315*                            VMOD=2.031                          *
  1316*                                                                *
  1317*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1318*                                                                *
  1319*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1320*   VSAM ACCOUNT MASTER FILES.                                   *
  1321*                                                                *
  1322*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1323*                                                                *
  1324*   FILE TYPE = VSAM,KSDS                                        *
  1325*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1326*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  26
* VP6311.cbl
  1327*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1328*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1329*                                                                *
  1330*   LOG = NO                                                     *
  1331*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1332*                                                                *
  1333*                                                                *
  1334******************************************************************
  1335*                   C H A N G E   L O G
  1336*
  1337* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1338*-----------------------------------------------------------------
  1339*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1340* EFFECTIVE    NUMBER
  1341*-----------------------------------------------------------------
  1342* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1343* 092705    2005050300006  PEMA  ADD SPP LEASES
  1344* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1345* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1346* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1347* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1348* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1349******************************************************************
  1350
  1351 01  ACCOUNT-MASTER.
  1352     12  AM-RECORD-ID                      PIC XX.
  1353         88  VALID-AM-ID                      VALUE 'AM'.
  1354
  1355     12  AM-CONTROL-PRIMARY.
  1356         16  AM-COMPANY-CD                 PIC X.
  1357         16  AM-MSTR-CNTRL.
  1358             20  AM-CONTROL-A.
  1359                 24  AM-CARRIER            PIC X.
  1360                 24  AM-GROUPING.
  1361                     28 AM-GROUPING-PREFIX PIC XXX.
  1362                     28 AM-GROUPING-PRIME  PIC XXX.
  1363                 24  AM-STATE              PIC XX.
  1364                 24  AM-ACCOUNT.
  1365                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1366                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1367             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1368                                           PIC X(19).
  1369             20  AM-CNTRL-B.
  1370                 24  AM-EXPIRATION-DT      PIC XX.
  1371                 24  FILLER                PIC X(4).
  1372             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1373                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1374
  1375     12  AM-CONTROL-BY-VAR-GRP.
  1376         16  AM-COMPANY-CD-A1              PIC X.
  1377         16  AM-VG-CARRIER                 PIC X.
  1378         16  AM-VG-GROUPING                PIC X(6).
  1379         16  AM-VG-STATE                   PIC XX.
  1380         16  AM-VG-ACCOUNT                 PIC X(10).
  1381         16  AM-VG-DATE.
  1382             20  AM-VG-EXPIRATION-DT       PIC XX.
  1383             20  FILLER                    PIC X(4).
  1384         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  27
* VP6311.cbl
  1385                                           PIC 9(11)      COMP-3.
  1386     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1387         16  FILLER                        PIC X(10).
  1388         16  AM-VG-KEY3.
  1389             20  AM-VG3-ACCOUNT            PIC X(10).
  1390             20  AM-VG3-EXP-DT             PIC XX.
  1391         16  FILLER                        PIC X(4).
  1392     12  AM-MAINT-INFORMATION.
  1393         16  AM-LAST-MAINT-DT              PIC XX.
  1394         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1395         16  AM-LAST-MAINT-USER            PIC X(4).
  1396         16  FILLER                        PIC XX.
  1397
  1398     12  AM-EFFECTIVE-DT                   PIC XX.
  1399     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1400
  1401     12  AM-PREV-DATES  COMP-3.
  1402         16  AM-PREV-EXP-DT                PIC 9(11).
  1403         16  AM-PREV-EFF-DT                PIC 9(11).
  1404
  1405     12  AM-REPORT-CODE-1                  PIC X(10).
  1406     12  AM-REPORT-CODE-2                  PIC X(10).
  1407
  1408     12  AM-CITY-CODE                      PIC X(4).
  1409     12  AM-COUNTY-PARISH                  PIC X(6).
  1410
  1411     12  AM-NAME                           PIC X(30).
  1412     12  AM-PERSON                         PIC X(30).
  1413     12  AM-ADDRS                          PIC X(30).
  1414     12  AM-CITY.
  1415         16  AM-ADDR-CITY                  PIC X(28).
  1416         16  AM-ADDR-STATE                 PIC XX.
  1417     12  AM-ZIP.
  1418         16  AM-ZIP-PRIME.
  1419             20  AM-ZIP-PRI-1ST            PIC X.
  1420                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1421             20  FILLER                    PIC X(4).
  1422         16  AM-ZIP-PLUS4                  PIC X(4).
  1423     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1424         16  AM-CAN-POSTAL-1               PIC XXX.
  1425         16  AM-CAN-POSTAL-2               PIC XXX.
  1426         16  FILLER                        PIC XXX.
  1427     12  AM-TEL-NO.
  1428         16  AM-AREA-CODE                  PIC 999.
  1429         16  AM-TEL-PRE                    PIC 999.
  1430         16  AM-TEL-NBR                    PIC 9(4).
  1431     12  AM-TEL-LOC                        PIC X.
  1432         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1433         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1434
  1435     12  AM-COMM-STRUCTURE.
  1436         16  AM-DEFN-1.
  1437             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1438                 24  AM-AGT.
  1439                     28  AM-AGT-PREFIX     PIC X(4).
  1440                     28  AM-AGT-PRIME      PIC X(6).
  1441                 24  AM-COM-TYP            PIC X.
  1442                 24  AM-L-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  28
* VP6311.cbl
  1443                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1444                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1445                 24  AM-RECALC-LV-INDIC    PIC X.
  1446                 24  AM-RETRO-LV-INDIC     PIC X.
  1447                 24  AM-GL-CODES           PIC X.
  1448                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1449                 24  FILLER                PIC X(01).
  1450         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1451             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1452                 24  FILLER                PIC X(11).
  1453                 24  AM-L-COMA             PIC XXX.
  1454                 24  AM-J-COMA             PIC XXX.
  1455                 24  AM-A-COMA             PIC XXX.
  1456                 24  FILLER                PIC X(6).
  1457
  1458     12  AM-COMM-CHANGE-STATUS             PIC X.
  1459         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1460
  1461     12  AM-CSR-CODE                       PIC X(4).
  1462
  1463     12  AM-BILLING-STATUS                 PIC X.
  1464         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1465         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1466     12  AM-AUTO-REFUND-SW                 PIC X.
  1467         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1468         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1469     12  AM-GPCD                           PIC 99.
  1470     12  AM-IG                             PIC X.
  1471         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1472         88  AM-HAS-GROUP                     VALUE '2'.
  1473     12  AM-STATUS                         PIC X.
  1474         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1475         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1476         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1477         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1478         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1479         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1480     12  AM-REMIT-TO                       PIC 99.
  1481     12  AM-ID-NO                          PIC X(11).
  1482
  1483     12  AM-CAL-TABLE                      PIC XX.
  1484     12  AM-LF-DEVIATION                   PIC XXX.
  1485     12  AM-AH-DEVIATION                   PIC XXX.
  1486     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1487     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1488     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1489     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1490     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1491     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1492
  1493     12  AM-USER-FIELDS.
  1494         16  AM-FLD-1                      PIC XX.
  1495         16  AM-FLD-2                      PIC XX.
  1496         16  AM-FLD-3                      PIC XX.
  1497         16  AM-FLD-4                      PIC XX.
  1498         16  AM-FLD-5                      PIC XX.
  1499
  1500     12  AM-1ST-PROD-DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  29
* VP6311.cbl
  1501         16  AM-1ST-PROD-YR                PIC XX.
  1502         16  AM-1ST-PROD-MO                PIC XX.
  1503         16  AM-1ST-PROD-DA                PIC XX.
  1504     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1505     12  AM-CERTS-PURGED-DATE.
  1506         16  AM-PUR-YR                     PIC XX.
  1507         16  AM-PUR-MO                     PIC XX.
  1508         16  AM-PUR-DA                     PIC XX.
  1509     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1510     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1511     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1512     12  AM-INACTIVE-DATE.
  1513         16  AM-INA-MO                     PIC 99.
  1514         16  AM-INA-DA                     PIC 99.
  1515         16  AM-INA-YR                     PIC 99.
  1516     12  AM-AR-HI-CERT-DATE                PIC XX.
  1517
  1518     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1519     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1520
  1521     12  AM-OB-PAYMENT-MODE                PIC X.
  1522         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1523         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1524         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1525         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1526
  1527     12  AM-AH-ONLY-INDICATOR              PIC X.
  1528         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1529         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1530
  1531     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1532
  1533     12  AM-OVER-SHORT.
  1534         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1535         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1536
  1537     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1538     12  AM-DCC-CLP-STATE                  PIC XX.
  1539
  1540     12  AM-RECALC-COMM                    PIC X.
  1541     12  AM-RECALC-REIN                    PIC X.
  1542
  1543     12  AM-REI-TABLE                      PIC XXX.
  1544     12  AM-REI-ET-LF                      PIC X.
  1545     12  AM-REI-ET-AH                      PIC X.
  1546     12  AM-REI-PE-LF                      PIC X.
  1547     12  AM-REI-PE-AH                      PIC X.
  1548     12  AM-REI-PRT-ST                     PIC X.
  1549     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1550     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1551     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1552     12  AM-REI-GROUP-A                    PIC X(6).
  1553     12  AM-REI-MORT                       PIC X(4).
  1554     12  AM-REI-PRT-OW                     PIC X.
  1555     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1556     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1557     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1558     12  AM-REI-GROUP-B                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  30
* VP6311.cbl
  1559
  1560     12  AM-TRUST-TYPE                     PIC X(2).
  1561
  1562     12  AM-EMPLOYER-STMT-USED             PIC X.
  1563     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1564
  1565     12  AM-STD-AH-TYPE                    PIC XX.
  1566     12  AM-EARN-METHODS.
  1567         16  AM-EARN-METHOD-R              PIC X.
  1568             88 AM-REF-RL-R78                 VALUE 'R'.
  1569             88 AM-REF-RL-PR                  VALUE 'P'.
  1570             88 AM-REF-RL-MEAN                VALUE 'M'.
  1571             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1572         16  AM-EARN-METHOD-L              PIC X.
  1573             88 AM-REF-LL-R78                 VALUE 'R'.
  1574             88 AM-REF-LL-PR                  VALUE 'P'.
  1575             88 AM-REF-LL-MEAN                VALUE 'M'.
  1576             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1577         16  AM-EARN-METHOD-A              PIC X.
  1578             88 AM-REF-AH-R78                 VALUE 'R'.
  1579             88 AM-REF-AH-PR                  VALUE 'P'.
  1580             88 AM-REF-AH-MEAN                VALUE 'M'.
  1581             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1582             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1583             88 AM-REF-AH-NET                 VALUE 'N'.
  1584
  1585     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1586     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1587     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1588
  1589     12  AM-RET-Y-N                        PIC X.
  1590     12  AM-RET-P-E                        PIC X.
  1591     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1592     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1593     12  AM-RET-GRP                        PIC X(6).
  1594     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1595         16  AM-POOL-PRIME                 PIC XXX.
  1596         16  AM-POOL-SUB                   PIC XXX.
  1597     12  AM-RETRO-EARNINGS.
  1598         16  AM-RET-EARN-R                 PIC X.
  1599         16  AM-RET-EARN-L                 PIC X.
  1600         16  AM-RET-EARN-A                 PIC X.
  1601     12  AM-RET-ST-TAX-USE                 PIC X.
  1602         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1603         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1604     12  AM-RETRO-BEG-EARNINGS.
  1605         16  AM-RET-BEG-EARN-R             PIC X.
  1606         16  AM-RET-BEG-EARN-L             PIC X.
  1607         16  AM-RET-BEG-EARN-A             PIC X.
  1608     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1609     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1610
  1611     12  AM-USER-SELECT-OPTIONS.
  1612         16  AM-USER-SELECT-1              PIC X(10).
  1613         16  AM-USER-SELECT-2              PIC X(10).
  1614         16  AM-USER-SELECT-3              PIC X(10).
  1615         16  AM-USER-SELECT-4              PIC X(10).
  1616         16  AM-USER-SELECT-5              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  31
* VP6311.cbl
  1617
  1618     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1619
  1620     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1621
  1622     12  AM-RPT045A-SWITCH                 PIC X.
  1623         88  RPT045A-OFF                   VALUE 'N'.
  1624
  1625     12  AM-INSURANCE-LIMITS.
  1626         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1627         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1628
  1629     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1630         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1631
  1632     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1633         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1634         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1635
  1636     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1637
  1638     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1639     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1640     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1641     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1642     12  AM-DCC-UEF-STATE                  PIC XX.
  1643     12  FILLER                            PIC XXX.
  1644     12  AM-REPORT-CODE-3                  PIC X(10).
  1645*    12  FILLER                            PIC X(22).
  1646
  1647     12  AM-RESERVE-DATE.
  1648         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1649         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1650         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1651
  1652     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1653     12  AM-NOTIFICATION-TYPES.
  1654         16  AM-NOTIF-OF-LETTERS           PIC X.
  1655         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1656         16  AM-NOTIF-OF-REPORTS           PIC X.
  1657         16  AM-NOTIF-OF-STATUS            PIC X.
  1658
  1659     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1660         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1661         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1662         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1663         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1664
  1665     12  AM-BENEFIT-CONTROLS.
  1666         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1667             20  AM-BENEFIT-CODE           PIC XX.
  1668             20  AM-BENEFIT-TYPE           PIC X.
  1669             20  AM-BENEFIT-REVISION       PIC XXX.
  1670             20  AM-BENEFIT-REM-TERM       PIC X.
  1671             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1672             20  FILLER                    PIC XX.
  1673         16  FILLER                        PIC X(80).
  1674
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  32
* VP6311.cbl
  1675     12  AM-TRANSFER-DATA.
  1676         16  AM-TRANSFERRED-FROM.
  1677             20  AM-TRNFROM-CARRIER        PIC X.
  1678             20  AM-TRNFROM-GROUPING.
  1679                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1680                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1681             20  AM-TRNFROM-STATE          PIC XX.
  1682             20  AM-TRNFROM-ACCOUNT.
  1683                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1684                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1685             20  AM-TRNFROM-DTE            PIC XX.
  1686         16  AM-TRANSFERRED-TO.
  1687             20  AM-TRNTO-CARRIER          PIC X.
  1688             20  AM-TRNTO-GROUPING.
  1689                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1690                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1691             20  AM-TRNTO-STATE            PIC XX.
  1692             20  AM-TRNTO-ACCOUNT.
  1693                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1694                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1695             20  AM-TRNTO-DTE              PIC XX.
  1696         16  FILLER                        PIC X(10).
  1697
  1698     12  AM-SAVED-REMIT-TO                 PIC 99.
  1699
  1700     12  AM-COMM-STRUCTURE-SAVED.
  1701         16  AM-DEFN-1-SAVED.
  1702             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1703                 24  AM-AGT-SV             PIC X(10).
  1704                 24  AM-COM-TYP-SV         PIC X.
  1705                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1706                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1707                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1708                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1709                 24  FILLER                PIC X.
  1710                 24  AM-GL-CODES-SV        PIC X.
  1711                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1712                 24  FILLER                PIC X.
  1713         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1714             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1715                 24  FILLER                PIC X(11).
  1716                 24  AM-L-COMA-SV          PIC XXX.
  1717                 24  AM-J-COMA-SV          PIC XXX.
  1718                 24  AM-A-COMA-SV          PIC XXX.
  1719                 24  FILLER                PIC X(6).
  1720
  1721     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1722         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1723            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1724            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1725            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1726
  1727     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1728     12  FILLER                            PIC X(120).
  1729
  1730     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1731         16  AM-CONTROL-NAME               PIC X(30).
  1732         16  AM-EXECUTIVE-ONE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  33
* VP6311.cbl
  1733             20  AM-EXEC1-NAME             PIC X(15).
  1734             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1735                                                          COMP-3.
  1736             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1737                                                          COMP-3.
  1738         16  AM-EXECUTIVE-TWO.
  1739             20  AM-EXEC2-NAME             PIC X(15).
  1740             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1741                                                          COMP-3.
  1742             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1743                                                          COMP-3.
  1744
  1745     12  AM-RETRO-ADDITIONAL-DATA.
  1746         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1747         16  AM-RETRO-PREM-P-E             PIC X.
  1748         16  AM-RETRO-CLMS-P-I             PIC X.
  1749         16  AM-RETRO-RET-BRACKET-LF.
  1750             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1751                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1752                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1753             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1754                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1755                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1756             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1757                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1758                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1759         16  AM-RETRO-RET-BRACKET-AH.
  1760             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1761                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1762                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1763                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1764             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1765                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1766                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1767             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1768                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1769                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1770
  1771     12  AM-COMMENTS.
  1772         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1773
  1774     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1775         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1776         16  AM-FLI-BILLING-CODE           PIC X.
  1777         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1778         16  AM-FLI-UNITED-IDENT           PIC X.
  1779         16  AM-FLI-INTEREST-LOST-DATA.
  1780             20  AM-FLI-BANK-NO            PIC X(5).
  1781             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1782             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1783             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1784         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1785             20  AM-FLI-AGT                PIC X(9).
  1786             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1787             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1788         16  FILLER                        PIC X(102).
  1789
  1790     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  34
* VP6311.cbl
  1791         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1792             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1793             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1794             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1795             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1796             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1797         16  FILLER                          PIC X(10).
  1798******************************************************************
  1799*                                COPY ELCVADS.
  1800******************************************************************
  1801*                                                                *
  1802*                                                                *
  1803*                            ELCVADS.                            *
  1804*                                                                *
  1805*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1806*   ELVADS                  LENGTH = 350                         *
  1807******************************************************************
  1808******************************************************************
  1809*                   C H A N G E   L O G
  1810*
  1811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1812*-----------------------------------------------------------------
  1813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1814* EFFECTIVE    NUMBER
  1815*-----------------------------------------------------------------
  1816* 100111    2011022800001  AJRA  NAPERSOFT
  1817******************************************************************
  1818
  1819 01  VIRGINIA-DISCLOSURE.
  1820     12  VD-COMPANY-CD              PIC X.
  1821     12  VD-CARRIER                 PIC X.
  1822     12  VD-GROUPING.
  1823         20  VD-GROUPING-PREFIX     PIC XXX.
  1824         20  VD-GROUPING-PRIME      PIC XXX.
  1825     12  VD-STATE                   PIC XX.
  1826     12  VD-ACCOUNT.
  1827         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1828         20  VD-ACCOUNT-PRIME       PIC X(6).
  1829     12  VD-CERT-EFF-DT             PIC XX.
  1830     12  VD-CERT-NO.
  1831         20  VD-CERT-PRIME          PIC X(10).
  1832         20  VD-CERT-SFX            PIC X.
  1833     12  VD-ENTRY-BATCH             PIC X(6).
  1834     12  VD-CSR-ID                  PIC X(4).
  1835     12  VD-NAME.
  1836         20  VD-INSURED-LAST-NAME   PIC X(15).
  1837         20  VD-INSURED-FIRST-NAME.
  1838             24  VD-INSURED-1ST-INIT PIC X.
  1839             24  FILLER             PIC X(9).
  1840         20  VD-INSURED-MIDDLE-INIT PIC X.
  1841     12  VD-JOINT-INSURED.
  1842         20 VD-JOINT-LAST-NAME      PIC X(15).
  1843         20 VD-JOINT-FIRST-NAME.
  1844            24  VD-JOINT-FIRST-INIT PIC X.
  1845            24  FILLER              PIC X(9).
  1846         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1847     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1848     12  VD-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  35
* VP6311.cbl
  1849     12  VD-INSURED-CITY-STATE.
  1850         20  VD-INSURED-CITY        PIC X(28).
  1851         20  VD-INSURED-STATE       PIC XX.
  1852     12  VD-INSURED-ZIP-CODE.
  1853         20  VD-INSURED-ZIP-PRIME.
  1854             24  VD-INSURED-ZIP-1   PIC X.
  1855                 88  VD-CANADIAN-POST-CODE
  1856                                       VALUE 'A' THRU 'Z'.
  1857             24  FILLER             PIC X(4).
  1858         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1859     12  VD-BENEFICIARY-NAME        PIC X(30).
  1860     12  VD-ACCOUNT-NAME            PIC X(30).
  1861     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1862     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1863     12  VD-1ST-PMT-DT              PIC XX.
  1864     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1865         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1866         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1867                                             '90' THRU '99'.
  1868     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1869                                    PIC XX.
  1870     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1871     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1872     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1873     12  VD-LF-TERM                 PIC S999   COMP-3.
  1874     12  VD-AH-BENEFIT-CD           PIC XX.
  1875         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1876         88  VD-INVALID-AH             VALUE '  ' '00'
  1877                                             '90' THRU '99'.
  1878     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1879     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1880     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1881     12  VD-AH-TERM                 PIC S999   COMP-3.
  1882     12  VD-LETTER-ID               PIC X(4).
  1883     12  VD-PROC-ID                 PIC X(4).
  1884     12  VD-COMP-ID                 PIC X(3).
  1885     12  VD-CURRENT-DATE            PIC XX.
  1886     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1887     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1888     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  36
* VP6311.cbl
  1890*    COPY ELCDATE.
  1891******************************************************************
  1892*                                                                *
  1893*                                                                *
  1894*                            ELCDATE.                            *
  1895*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1896*                            VMOD=2.003
  1897*                                                                *
  1898*                                                                *
  1899*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1900*                 LENGTH = 200                                   *
  1901******************************************************************
  1902
  1903 01  DATE-CONVERSION-DATA.
  1904     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1905     12  DC-OPTION-CODE                PIC X.
  1906         88  BIN-TO-GREG                VALUE ' '.
  1907         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1908         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1909         88  YMD-GREG-TO-BIN            VALUE '3'.
  1910         88  MDY-GREG-TO-BIN            VALUE '4'.
  1911         88  JULIAN-TO-BIN              VALUE '5'.
  1912         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1913         88  FIND-CENTURY               VALUE '7'.
  1914         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1915         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1916         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1917         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1918         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1919         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1920         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1921         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1922         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1923         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1924         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1925         88  BIN-3-TO-GREG              VALUE 'I'.
  1926         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1927         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1928         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1929         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1930         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1931         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1932         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1933         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1934         88  THREE-CHARACTER-BIN
  1935                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1936         88  GREGORIAN-TO-BIN
  1937                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1938         88  BIN-TO-GREGORIAN
  1939                  VALUES ' ' '1' 'I' '8' 'G'.
  1940         88  JULIAN-TO-BINARY
  1941                  VALUES '5' 'C' 'E' 'F'.
  1942     12  DC-ERROR-CODE                 PIC X.
  1943         88  NO-CONVERSION-ERROR        VALUE ' '.
  1944         88  DATE-CONVERSION-ERROR
  1945                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1946         88  DATE-IS-ZERO               VALUE '1'.
  1947         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  37
* VP6311.cbl
  1948         88  DATE-IS-INVALID            VALUE '3'.
  1949         88  DATE1-GREATER-DATE2        VALUE '4'.
  1950         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1951         88  DATE-INVALID-OPTION        VALUE '9'.
  1952         88  INVALID-CENTURY            VALUE 'A'.
  1953         88  ONLY-CENTURY               VALUE 'B'.
  1954         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1955         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1956     12  DC-END-OF-MONTH               PIC X.
  1957         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1958     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1959         88  USE-NORMAL-PROCESS         VALUE ' '.
  1960         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1961         88  ADJUST-UP-100-YRS          VALUE '2'.
  1962     12  FILLER                        PIC X.
  1963     12  DC-CONVERSION-DATES.
  1964         16  DC-BIN-DATE-1             PIC XX.
  1965         16  DC-BIN-DATE-2             PIC XX.
  1966         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1967         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1968                       DC-GREG-DATE-1-EDIT.
  1969             20  DC-EDIT1-MONTH        PIC 99.
  1970             20  SLASH1-1              PIC X.
  1971             20  DC-EDIT1-DAY          PIC 99.
  1972             20  SLASH1-2              PIC X.
  1973             20  DC-EDIT1-YEAR         PIC 99.
  1974         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1975         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1976                     DC-GREG-DATE-2-EDIT.
  1977             20  DC-EDIT2-MONTH        PIC 99.
  1978             20  SLASH2-1              PIC X.
  1979             20  DC-EDIT2-DAY          PIC 99.
  1980             20  SLASH2-2              PIC X.
  1981             20  DC-EDIT2-YEAR         PIC 99.
  1982         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1983         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1984                     DC-GREG-DATE-1-YMD.
  1985             20  DC-YMD-YEAR           PIC 99.
  1986             20  DC-YMD-MONTH          PIC 99.
  1987             20  DC-YMD-DAY            PIC 99.
  1988         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1989         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1990                      DC-GREG-DATE-1-MDY.
  1991             20  DC-MDY-MONTH          PIC 99.
  1992             20  DC-MDY-DAY            PIC 99.
  1993             20  DC-MDY-YEAR           PIC 99.
  1994         16  DC-GREG-DATE-1-ALPHA.
  1995             20  DC-ALPHA-MONTH        PIC X(10).
  1996             20  DC-ALPHA-DAY          PIC 99.
  1997             20  FILLER                PIC XX.
  1998             20  DC-ALPHA-CENTURY.
  1999                 24 DC-ALPHA-CEN-N     PIC 99.
  2000             20  DC-ALPHA-YEAR         PIC 99.
  2001         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2002         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2003         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2004         16  DC-JULIAN-DATE            PIC 9(05).
  2005         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  38
* VP6311.cbl
  2006                                       PIC 9(05).
  2007         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2008             20  DC-JULIAN-YEAR        PIC 99.
  2009             20  DC-JULIAN-DAYS        PIC 999.
  2010         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2011         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2012         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2013     12  DATE-CONVERSION-VARIBLES.
  2014         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2015         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2016             20  FILLER                PIC 9(3).
  2017             20  HOLD-CEN-1-CCYY.
  2018                 24  HOLD-CEN-1-CC     PIC 99.
  2019                 24  HOLD-CEN-1-YY     PIC 99.
  2020             20  HOLD-CEN-1-MO         PIC 99.
  2021             20  HOLD-CEN-1-DA         PIC 99.
  2022         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2023             20  HOLD-CEN-1-R-MO       PIC 99.
  2024             20  HOLD-CEN-1-R-DA       PIC 99.
  2025             20  HOLD-CEN-1-R-CCYY.
  2026                 24  HOLD-CEN-1-R-CC   PIC 99.
  2027                 24  HOLD-CEN-1-R-YY   PIC 99.
  2028             20  FILLER                PIC 9(3).
  2029         16  HOLD-CENTURY-1-X.
  2030             20  FILLER                PIC X(3)  VALUE SPACES.
  2031             20  HOLD-CEN-1-X-CCYY.
  2032                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2033                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2034             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2035             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2036         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2037             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2038             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2039             20  HOLD-CEN-1-R-X-CCYY.
  2040                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2041                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2042             20  FILLER                PIC XXX.
  2043         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2044         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2045         16  DC-JULIAN-DATE-1          PIC 9(07).
  2046         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2047             20  DC-JULIAN-1-CCYY.
  2048                 24  DC-JULIAN-1-CC    PIC 99.
  2049                 24  DC-JULIAN-1-YR    PIC 99.
  2050             20  DC-JULIAN-DA-1        PIC 999.
  2051         16  DC-JULIAN-DATE-2          PIC 9(07).
  2052         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2053             20  DC-JULIAN-2-CCYY.
  2054                 24  DC-JULIAN-2-CC    PIC 99.
  2055                 24  DC-JULIAN-2-YR    PIC 99.
  2056             20  DC-JULIAN-DA-2        PIC 999.
  2057         16  DC-GREG-DATE-A-EDIT.
  2058             20  DC-EDITA-MONTH        PIC 99.
  2059             20  SLASHA-1              PIC X VALUE '/'.
  2060             20  DC-EDITA-DAY          PIC 99.
  2061             20  SLASHA-2              PIC X VALUE '/'.
  2062             20  DC-EDITA-CCYY.
  2063                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  39
* VP6311.cbl
  2064                 24  DC-EDITA-YEAR     PIC 99.
  2065         16  DC-GREG-DATE-B-EDIT.
  2066             20  DC-EDITB-MONTH        PIC 99.
  2067             20  SLASHB-1              PIC X VALUE '/'.
  2068             20  DC-EDITB-DAY          PIC 99.
  2069             20  SLASHB-2              PIC X VALUE '/'.
  2070             20  DC-EDITB-CCYY.
  2071                 24  DC-EDITB-CENT     PIC 99.
  2072                 24  DC-EDITB-YEAR     PIC 99.
  2073         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2074         16  DC-GREG-DATE-CYMD-R REDEFINES
  2075                              DC-GREG-DATE-CYMD.
  2076             20  DC-CYMD-CEN           PIC 99.
  2077             20  DC-CYMD-YEAR          PIC 99.
  2078             20  DC-CYMD-MONTH         PIC 99.
  2079             20  DC-CYMD-DAY           PIC 99.
  2080         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2081         16  DC-GREG-DATE-MDCY-R REDEFINES
  2082                              DC-GREG-DATE-MDCY.
  2083             20  DC-MDCY-MONTH         PIC 99.
  2084             20  DC-MDCY-DAY           PIC 99.
  2085             20  DC-MDCY-CEN           PIC 99.
  2086             20  DC-MDCY-YEAR          PIC 99.
  2087    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2088        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2089    12  DC-EL310-DATE                  PIC X(21).
  2090    12  FILLER                         PIC X(28).
  2091
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  40
* VP6311.cbl
  2093*    COPY ELCLOGOF.
  2094******************************************************************
  2095*                                                                *
  2096*                                                                *
  2097*                            ELCLOGOF.                           *
  2098*                            VMOD=2.001                          *
  2099*                                                                *
  2100*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2101*                                                                *
  2102******************************************************************
  2103 01  CLASIC-LOGOFF.
  2104     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2105     12  LOGOFF-TEXT.
  2106         16  FILLER          PIC X(5)    VALUE SPACES.
  2107         16  LOGOFF-MSG.
  2108             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2109             20  FILLER      PIC X       VALUE SPACES.
  2110             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2111         16  FILLER          PIC X(80)
  2112           VALUE '* YOU ARE NOW LOGGED OFF'.
  2113         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2114         16  FILLER          PIC X       VALUE QUOTE.
  2115         16  LOGOFF-SYS-MSG  PIC X(17)
  2116           VALUE 'S CLAS-IC SYSTEM '.
  2117     12  TEXT-MESSAGES.
  2118         16  UNACCESS-MSG    PIC X(29)
  2119             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2120         16  PGMIDERR-MSG    PIC X(17)
  2121             VALUE 'PROGRAM NOT FOUND'.
  2122
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  41
* VP6311.cbl
  2124*    COPY ELCATTR.
  2125******************************************************************
  2126*                                                                *
  2127*                            ELCATTR.                            *
  2128*                            VMOD=2.001                          *
  2129*                                                                *
  2130*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2131*                                                                *
  2132*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2133*                                                                *
  2134*                   POS 1   P=PROTECTED                          *
  2135*                           U=UNPROTECTED                        *
  2136*                           S=ASKIP                              *
  2137*                   POS 2   A=ALPHA/NUMERIC                      *
  2138*                           N=NUMERIC                            *
  2139*                   POS 3   N=NORMAL                             *
  2140*                           B=BRIGHT                             *
  2141*                           D=DARK                               *
  2142*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2143*                           OF=MODIFIED DATA TAG OFF             *
  2144*                                                                *
  2145*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2146******************************************************************
  2147 01  ATTRIBUTE-LIST.
  2148     12  AL-PABOF            PIC X       VALUE 'Y'.
  2149     12  AL-PABON            PIC X       VALUE 'Z'.
  2150     12  AL-PADOF            PIC X       VALUE '%'.
  2151     12  AL-PADON            PIC X       VALUE '_'.
  2152     12  AL-PANOF            PIC X       VALUE '-'.
  2153     12  AL-PANON            PIC X       VALUE '/'.
  2154     12  AL-SABOF            PIC X       VALUE '8'.
  2155     12  AL-SABON            PIC X       VALUE '9'.
  2156     12  AL-SADOF            PIC X       VALUE '@'.
  2157     12  AL-SADON            PIC X       VALUE QUOTE.
  2158     12  AL-SANOF            PIC X       VALUE '0'.
  2159     12  AL-SANON            PIC X       VALUE '1'.
  2160     12  AL-UABOF            PIC X       VALUE 'H'.
  2161     12  AL-UABON            PIC X       VALUE 'I'.
  2162     12  AL-UADOF            PIC X       VALUE '<'.
  2163     12  AL-UADON            PIC X       VALUE '('.
  2164     12  AL-UANOF            PIC X       VALUE ' '.
  2165     12  AL-UANON            PIC X       VALUE 'A'.
  2166     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2167     12  AL-UNBON            PIC X       VALUE 'R'.
  2168     12  AL-UNDOF            PIC X       VALUE '*'.
  2169     12  AL-UNDON            PIC X       VALUE ')'.
  2170     12  AL-UNNOF            PIC X       VALUE '&'.
  2171     12  AL-UNNON            PIC X       VALUE 'J'.
  2172
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  42
* VP6311.cbl
  2174*    COPY ELCEMIB.
  2175******************************************************************
  2176*                                                                *
  2177*                                                                *
  2178*                            ELCEMIB.                            *
  2179*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2180*                            VMOD=2.005                          *
  2181*                                                                *
  2182*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2183*                                                                *
  2184******************************************************************
  2185 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2186     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2187     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2188     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2189     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2190     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2191     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2192     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2193     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2194     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2195         88  EMI-NO-ERRORS                    VALUE '1'.
  2196         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2197         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2198     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2199         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2200     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2201         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2202         88  EMI-AREA1-FULL                   VALUE '2'.
  2203     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2204         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2205         88  EMI-AREA2-FULL                   VALUE '2'.
  2206     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2207         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2208         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2209         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2210         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2211         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2212     12  EMI-ERROR-LINES.
  2213         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2214         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2215         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2216         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2217             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2218                 24  EMI-ERR-NUM         PIC X(4).
  2219                 24  EMI-FILLER          PIC X.
  2220                 24  EMI-SEV             PIC X.
  2221                 24  FILLER              PIC X.
  2222             20  FILLER                  PIC X(02).
  2223     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2224         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2225             20  EMI-ERROR-NUMBER    PIC X(4).
  2226             20  EMI-FILL            PIC X.
  2227             20  EMI-SEVERITY        PIC X.
  2228             20  FILLER              PIC X.
  2229             20  EMI-ERROR-TEXT.
  2230                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2231                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  43
* VP6311.cbl
  2232     12  EMI-SEVERITY-SAVE           PIC X.
  2233         88  EMI-NOTE                    VALUE 'N'.
  2234         88  EMI-WARNING                 VALUE 'W'.
  2235         88  EMI-FORCABLE                VALUE 'F'.
  2236         88  EMI-FATAL                   VALUE 'X'.
  2237     12  EMI-MESSAGE-FLAG            PIC X.
  2238         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2239         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2240     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2241     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2242         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2243         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2244         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2245     12  emi-claim-no                pic x(7).
  2246     12  emi-claim-type              pic x(6).
  2247     12  FILLER                      PIC X(124)  VALUE SPACES.
  2248     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2249     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2250     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2251     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2252
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  44
* VP6311.cbl
  2254*    COPY ELCINTF.
  2255******************************************************************
  2256*                                                                *
  2257*                                                                *
  2258*                            ELCINTF.                            *
  2259*                            VMOD=2.017                          *
  2260*                                                                *
  2261*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2262*                                                                *
  2263*       LENGTH = 1024                                            *
  2264*                                                                *
  2265******************************************************************
  2266*                   C H A N G E   L O G
  2267*
  2268* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2269*-----------------------------------------------------------------
  2270*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2271* EFFECTIVE    NUMBER
  2272*-----------------------------------------------------------------
  2273* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2274******************************************************************
  2275 01  PROGRAM-INTERFACE-BLOCK.
  2276     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2277     12  PI-CALLING-PROGRAM              PIC X(8).
  2278     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2279     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2280     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2281     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2282     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2283     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2284     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2285     12  PI-COMPANY-ID                   PIC XXX.
  2286     12  PI-COMPANY-CD                   PIC X.
  2287
  2288     12  PI-COMPANY-PASSWORD             PIC X(8).
  2289
  2290     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2291
  2292     12  PI-CONTROL-IN-PROGRESS.
  2293         16  PI-CARRIER                  PIC X.
  2294         16  PI-GROUPING                 PIC X(6).
  2295         16  PI-STATE                    PIC XX.
  2296         16  PI-ACCOUNT                  PIC X(10).
  2297         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2298                                         PIC X(10).
  2299         16  PI-CLAIM-CERT-GRP.
  2300             20  PI-CLAIM-NO             PIC X(7).
  2301             20  PI-CERT-NO.
  2302                 25  PI-CERT-PRIME       PIC X(10).
  2303                 25  PI-CERT-SFX         PIC X.
  2304             20  PI-CERT-EFF-DT          PIC XX.
  2305         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2306             20  PI-PLAN-CODE            PIC X(2).
  2307             20  PI-REVISION-NUMBER      PIC X(3).
  2308             20  PI-PLAN-EFF-DT          PIC X(2).
  2309             20  PI-PLAN-EXP-DT          PIC X(2).
  2310             20  FILLER                  PIC X(11).
  2311         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  45
* VP6311.cbl
  2312             20  PI-OE-REFERENCE-1.
  2313                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2314                 25  PI-OE-REF-1-SUFF    PIC XX.
  2315
  2316     12  PI-SESSION-IN-PROGRESS          PIC X.
  2317         88  CLAIM-SESSION                   VALUE '1'.
  2318         88  CREDIT-SESSION                  VALUE '2'.
  2319         88  WARRANTY-SESSION                VALUE '3'.
  2320         88  MORTGAGE-SESSION                VALUE '4'.
  2321         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2322
  2323
  2324*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2325
  2326     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2327     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2328
  2329     12  PI-CREDIT-USER                  PIC X.
  2330         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2331         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2332
  2333     12  PI-CLAIM-USER                   PIC X.
  2334         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2335         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2336
  2337     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2338         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2339         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2340         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2341         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2342         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2343
  2344     12  PI-PROCESSOR-ID                 PIC X(4).
  2345
  2346     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2347
  2348     12  PI-MEMBER-CAPTION               PIC X(10).
  2349
  2350     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2351         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2352
  2353     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2354     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2355     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2356     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2357
  2358     12  PI-AH-OVERRIDE-L1               PIC X.
  2359     12  PI-AH-OVERRIDE-L2               PIC XX.
  2360     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2361     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2362
  2363     12  PI-NEW-SYSTEM                   PIC X(2).
  2364
  2365     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2366     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2367         88  PI-USES-PAID-TO                 VALUE '1'.
  2368     12  PI-CRDTCRD-SYSTEM.
  2369         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  46
* VP6311.cbl
  2370             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2371             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2372         16  PI-CC-MONTH-END-DT          PIC XX.
  2373     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2374
  2375     12  PI-OE-REFERENCE-2.
  2376         16  PI-OE-REF-2-PRIME           PIC X(10).
  2377         16  PI-OE-REF-2-SUFF            PIC X.
  2378
  2379     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2380
  2381     12  PI-LANGUAGE-TYPE                PIC X.
  2382             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2383             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2384             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2385
  2386     12  PI-POLICY-LINKAGE-IND           PIC X.
  2387         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2388         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2389                                                   LOW-VALUES.
  2390
  2391     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2392     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2393         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2394         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2395
  2396     12  PI-PROCESSOR-CSR-IND            PIC X.
  2397         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2398         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2399
  2400     12  FILLER                          PIC X(3).
  2401
  2402     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2403
  2404     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2405         PI-SYSTEM-LEVEL.
  2406
  2407         16  PI-ENTRY-CODES.
  2408             20  PI-ENTRY-CD-1           PIC X.
  2409             20  PI-ENTRY-CD-2           PIC X.
  2410
  2411         16  PI-RETURN-CODES.
  2412             20  PI-RETURN-CD-1          PIC X.
  2413             20  PI-RETURN-CD-2          PIC X.
  2414
  2415         16  PI-UPDATE-STATUS-SAVE.
  2416             20  PI-UPDATE-BY            PIC X(4).
  2417             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2418
  2419         16  PI-LOWER-CASE-LETTERS       PIC X.
  2420             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2421
  2422*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2423*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2424*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2425
  2426         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2427             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  47
* VP6311.cbl
  2428             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2429             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2430             88  ACCNT-CNTL                  VALUE '3'.
  2431             88  CARR-ACCNT-CNTL             VALUE '4'.
  2432
  2433         16  PI-PROCESSOR-CAP-LIST.
  2434             20  PI-SYSTEM-CONTROLS.
  2435                24 PI-SYSTEM-DISPLAY     PIC X.
  2436                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2437                24 PI-SYSTEM-MODIFY      PIC X.
  2438                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2439             20  FILLER                  PIC XX.
  2440             20  PI-DISPLAY-CAP          PIC X.
  2441                 88  DISPLAY-CAP             VALUE 'Y'.
  2442             20  PI-MODIFY-CAP           PIC X.
  2443                 88  MODIFY-CAP              VALUE 'Y'.
  2444             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2445                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2446             20  PI-FORCE-CAP            PIC X.
  2447                 88  FORCE-CAP               VALUE 'Y'.
  2448
  2449         16  PI-PROGRAM-CONTROLS.
  2450             20  PI-PGM-PRINT-OPT        PIC X.
  2451             20  PI-PGM-FORMAT-OPT       PIC X.
  2452             20  PI-PGM-PROCESS-OPT      PIC X.
  2453             20  PI-PGM-TOTALS-OPT       PIC X.
  2454
  2455         16  PI-HELP-INTERFACE.
  2456             20  PI-LAST-ERROR-NO        PIC X(4).
  2457             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2458
  2459         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2460             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2461
  2462         16  PI-CR-CONTROL-IN-PROGRESS.
  2463             20  PI-CR-CARRIER           PIC X.
  2464             20  PI-CR-GROUPING          PIC X(6).
  2465             20  PI-CR-STATE             PIC XX.
  2466             20  PI-CR-ACCOUNT           PIC X(10).
  2467             20  PI-CR-FIN-RESP          PIC X(10).
  2468             20  PI-CR-TYPE              PIC X.
  2469
  2470         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2471
  2472         16  PI-CR-MONTH-END-DT          PIC XX.
  2473
  2474         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2475             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2476             88  PI-ZERO-CARRIER             VALUE '1'.
  2477             88  PI-ZERO-GROUPING            VALUE '2'.
  2478             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2479
  2480         16  PI-CARRIER-SECURITY         PIC X.
  2481             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2482
  2483         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2484             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2485             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  48
* VP6311.cbl
  2486
  2487         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2488             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2489                                         INDEXED BY PI-ACCESS-NDX
  2490                                         PIC X.
  2491
  2492         16  PI-GA-BILLING-CONTROL       PIC X.
  2493             88  PI-GA-BILLING               VALUE '1'.
  2494
  2495         16  PI-MAIL-PROCESSING          PIC X.
  2496             88  PI-MAIL-YES                 VALUE 'Y'.
  2497
  2498         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2499
  2500         16  PI-AR-SYSTEM.
  2501             20  PI-AR-PROCESSING-CNTL   PIC X.
  2502                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2503             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2504             20  PI-AR-MONTH-END-DT      PIC XX.
  2505
  2506         16  PI-MP-SYSTEM.
  2507             20  PI-MORTGAGE-USER            PIC X.
  2508                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2509                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2510             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2511                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2512                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2513                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2514                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2515                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2516             20  PI-MP-MONTH-END-DT          PIC XX.
  2517             20  PI-MP-REFERENCE-NO.
  2518                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2519                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2520
  2521         16  PI-LABEL-CONTROL            PIC X(01).
  2522             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2523             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2524
  2525         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2526             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2527
  2528         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2529             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2530             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2531
  2532         16  FILLER                      PIC X(14).
  2533
  2534     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2535******************************************************************
  2536
  2537     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2538*    COPY ELC631PI.
  2539******************************************************************
  2540*                                                                *
  2541*                                                                *
  2542*                            ELC631PI                            *
  2543*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  49
* VP6311.cbl
  2544*                                                                *
  2545*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2546*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2547*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2548*                                                                *
  2549*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2550*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2551*    BETWEEN PROGRAMS.                                           *
  2552*                                                                *
  2553*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2554*                                                                *
  2555*               EL631 - EL6311 - EL6312 - EL6313                 *
  2556*                                                                *
  2557******************************************************************
  2558*                   C H A N G E   L O G
  2559*
  2560* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2561*-----------------------------------------------------------------
  2562*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2563* EFFECTIVE    NUMBER
  2564*-----------------------------------------------------------------
  2565* 021414    2003053000001  PEMA  changes for auto chk request
  2566******************************************************************
  2567
  2568         16  PI-631-DATA.
  2569             20  PI-ERPNDB-KEY.
  2570                 24  PI-PB-COMPANY-CD     PIC X.
  2571                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2572                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2573                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2574
  2575             20  PI-ERPNDB-ALT-KEY.
  2576                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2577                 24  PI-PB-CARRIER        PIC X.
  2578                 24  PI-PB-GROUPING       PIC X(6).
  2579                 24  PI-PB-STATE          PIC XX.
  2580                 24  PI-PB-ACCOUNT        PIC X(10).
  2581                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2582                 24  PI-PB-CERT-NO.
  2583                     28  PI-PB-CERT-PRIME PIC X(10).
  2584                     28  PI-PB-CERT-SFX   PIC X.
  2585                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2586                 24  PI-PB-RECORD-TYPE    PIC X.
  2587
  2588             20  PI-ERPNDB-CSR-KEY.
  2589                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2590                 24  PI-PB-CSR-ID             PIC X(4).
  2591                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2592                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2593                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2594
  2595             20  PI-BROWSE-TYPE               PIC X.
  2596                 88  PI-FILE-BROWSE             VALUE ' '.
  2597                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2598                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2599                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2600                 88  PI-CSR-BROWSE              VALUE '4'.
  2601
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  50
* VP6311.cbl
  2602             20  PI-MAINT-FUNCTION            PIC X.
  2603                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2604                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2605                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2606                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2607                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2608                 88  PI-PF5-FUNCTION            VALUE '5'.
  2609                 88  PI-PF6-FUNCTION            VALUE '6'.
  2610
  2611             20  PI-FILE-SWITCHES.
  2612                 24  PI-ALL-ISSUES-SW         PIC X.
  2613                     88  ALL-ISSUES             VALUE 'Y'.
  2614                 24  PI-ALL-CANCELS-SW        PIC X.
  2615                     88  ALL-CANCELS            VALUE 'Y'.
  2616                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2617                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2618                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2619                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2620                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2621                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2622                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2623                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2624                 24  PI-HOLD-REC-SW           PIC X.
  2625                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2626                 24  PI-CHANGE-REC-SW         PIC X.
  2627                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2628                 24  PI-CHK-REQ-REC-SW        PIC X.
  2629                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2630                 24  PI-ISSUE-WARNING-SW      PIC X.
  2631                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2632                 24  PI-CANCEL-WARNING-SW     PIC X.
  2633                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2634             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2635                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2636             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2637                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2638
  2639             20  PI-MAP-NAME                  PIC X(8).
  2640
  2641             20  PI-CURSOR                    PIC S9(4) COMP.
  2642
  2643             20  PI-PREV-ALT-KEY              PIC X(36).
  2644             20  PI-PREV-CSR-KEY              PIC X(15).
  2645             20  PI-PREV-KEY.
  2646                 24  PI-PREV-COMPANY-CD       PIC X.
  2647                 24  PI-PREV-BATCH            PIC X(6).
  2648                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2649                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2650             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2651             20  PI-BROWSE-SW                 PIC X.
  2652                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2653                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2654             20  PI-SV-CARRIER                PIC X.
  2655             20  PI-SV-GROUPING               PIC X(6).
  2656             20  PI-SV-STATE                  PIC XX.
  2657             20  PI-EDIT-SW                   PIC X.
  2658             20  PI-DISPLAY-SW                PIC XX.
  2659                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  51
* VP6311.cbl
  2660                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2661             20  PI-CRITERIA-DATA             PIC X(350).
  2662             20  PI-BMODE                     PIC X.
  2663             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2664             20  PI-BPMTS                     PIC S999     COMP-3.
  2665             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2666             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2667             20  PI-CSR-SESSION-SW            PIC X.
  2668                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2669             20  PI-ERRORS-SW                 PIC X.
  2670                 88  FATAL-ERRORS               VALUE 'X'.
  2671*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2672             20  pi-unforced-sw               pic x.
  2673                 88  unforced-errors            value 'X'.
  2674             20  FILLER                       PIC X(4).
  2675
  2676        16  FILLER             PIC X(94).
  2677
  2678 01  W-LETTER-COMMUNICATION-AREAS.
  2679*    COPY ELC1042.
  2680******************************************************************
  2681*                                                                *
  2682*                                                                *
  2683*                           ELC1042                              *
  2684*                            VMOD=2.002                          *
  2685*                                                                *
  2686*    NOTE                                                        *
  2687*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2688*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2689*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2690*        TO THESE PROGRAMS.                                      *
  2691*                                                                *
  2692*    NOTE                                                        *
  2693*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2694*        USE ONLY!                                               *
  2695*                                                                *
  2696******************************************************************
  2697
  2698         16  PI-1042-WA.
  2699             20  PI-ACTION       PIC  X(01).
  2700                 88 PI-SHOW-MODE           VALUE '1'.
  2701                 88 PI-CLEAR-MODE          VALUE '2'.
  2702                 88 PI-CREATE-MODE         VALUE '3'.
  2703             20  PI-COMM-CONTROL PIC  X(12).
  2704             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2705             20  PI-EOF-SW       PIC  X(01).
  2706                 88  PI-FILE-EOF           VALUE 'Y'.
  2707             20  PI-FILETYP      PIC  X(01).
  2708             20  PI-FORM-SQUEEZE-CONTROL
  2709                                 PIC  X(01).
  2710                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2711                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2712             20  PI-LAST-CONTROL PIC  X(12).
  2713             20  PI-TEMP-STOR-ITEMS
  2714                                 PIC S9(04) COMP.
  2715             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2716             20  PI-UPDATE-SW    PIC  9(01).
  2717                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  52
* VP6311.cbl
  2718             20  PI-104-SCREEN-SENT-IND
  2719                                 PIC  X(01).
  2720                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2721                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2722             20  PI-1042-SCREEN-SENT-IND
  2723                                 PIC  X(01).
  2724                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2725                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2726             20  PI-1042-ARCHIVE-IND
  2727                                 PIC  X(01).
  2728                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2729             20  FILLER          PIC  X(29).
  2730*    COPY ELC689PI.
  2731******************************************************************
  2732*                                                                *
  2733*                            ELC689PI                            *
  2734*                            VMOD=2.003                          *
  2735*                                                                *
  2736*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2737*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2738*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2739*                                                                *
  2740*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2741*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2742*    BETWEEN PROGRAMS.                                           *
  2743*                                                                *
  2744*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2745*                                                                *
  2746*               EL631 - EL689  - EL6891 - EL6892                 *
  2747*                                                                *
  2748******************************************************************
  2749*                   C H A N G E   L O G
  2750*
  2751* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2752*-----------------------------------------------------------------
  2753*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2754* EFFECTIVE    NUMBER
  2755*-----------------------------------------------------------------
  2756* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2757* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2758* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2759******************************************************************
  2760
  2761
  2762         16  PI-689-WORK-AREA.
  2763             20  PI-689-ALT-PRINTER-ID
  2764                                 PIC  X(04).
  2765             20  PI-689-ARCHIVE-NUMBER
  2766                                 PIC  9(08).
  2767             20  PI-689-ARCHIVE-SW
  2768                                 PIC  X(01).
  2769                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2770             20  PI-689-DATA-SOURCE
  2771                                 PIC  X(01).
  2772                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2773                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2774                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2775                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  53
* VP6311.cbl
  2776                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2777             20  PI-689-ERROR-IND
  2778                                 PIC  X(01).
  2779                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2780             20  PI-689-ERROR    PIC  9(04).
  2781                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2782                 88  PI-689-FATAL-ERROR
  2783                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2784                            0042 0047 0051 0066 0067 0070
  2785                            0168 0169 0174 0175 0176 0177 0179
  2786                            0180 0181 0182 0184 0185 0189 0190
  2787                            0191
  2788                            0215 0279 0280
  2789                            0412 0413 0454
  2790                            0533 0537
  2791                            2055 2114 2208 2209 2216 2232 2369
  2792                            2398 2433 2908 2999
  2793                            3000 3770 3771 3775
  2794                            7250 7365 7367 7368 7369 7370 7371
  2795                            7272 7373 7374 7376 7377 7378 7379
  2796                            7381 7388 7390 7393 7395 7396 7398
  2797                            9095 9096 9281 9298 9299 9320 9327
  2798                            9426 9427.
  2799                 88  PI-689-STOP-ERROR
  2800                     VALUES 0004 0008 0013 0023 0029 0033
  2801                            0042 0047 0066 0067 0070
  2802                            0168 0169 0174 0175 0176 0177
  2803                            0181 0182 0184 0185 0189 0190
  2804                            0279 0280
  2805                            0412 0413 0454
  2806                            2055 2208 2209 2216 2232
  2807                            2398 2999
  2808                            3000 3770 3771 3775
  2809                            7250 7365 7369 7370 7371
  2810                            7272 7373 7374 7376 7377 7378 7379
  2811                            7381 7388 7390 7393 7396 7398
  2812                            9095 9096 9299 9320 9426.
  2813             20  PI-689-FOLLOW-UP-DATE
  2814                                 PIC  X(02).
  2815             20  PI-689-FORM-NUMBER
  2816                                 PIC  X(04).
  2817             20  PI-689-LABEL-SOURCE
  2818                                 PIC X(01).
  2819                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2820                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2821                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2822                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2823                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2824                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2825                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2826             20  PI-689-NUMBER-COPIES
  2827                                 PIC  9(01).
  2828             20  PI-689-NUMBER-LABEL-LINES
  2829                                 PIC  9(01).
  2830             20  PI-689-NUMBER-TEXT-RECORDS
  2831                                 PIC  9(03).
  2832             20  PI-689-PRINT-ORDER-SW
  2833                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  54
* VP6311.cbl
  2834                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2835                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2836                 88  PI-689-PRINT-LATER     VALUE '3'.
  2837                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2838             20  PI-689-PRINT-RESTRICTION
  2839                                 PIC  X(01).
  2840                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2841                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2842                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2843             20  PI-689-PRINT-SW PIC  X(01).
  2844                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2845             20  PI-689-RESEND-DATE-1
  2846                                 PIC  X(02).
  2847             20  PI-689-RESEND-LETR-1
  2848                                 PIC X(4).
  2849             20  PI-689-TEMP-STOR-ID
  2850                                 PIC  X(08).
  2851             20  PI-689-USE-SCREEN-IND
  2852                                 PIC  X(01).
  2853                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2854             20  PI-689-ARCH-POINTER
  2855                                 PIC S9(08) COMP.
  2856                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2857             20  PI-689-ARCT-POINTER
  2858                                 PIC S9(08) COMP.
  2859                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2860             20  PI-689-VARIABLE-DATA-GRP.
  2861                 24  PI-689-VARIABLE-DATA-1
  2862                                 PIC  X(30).
  2863                 24  PI-689-VARIABLE-DATA-2
  2864                                 PIC  X(30).
  2865                 24  PI-689-VARIABLE-DATA-3
  2866                                 PIC  X(30).
  2867                 24  PI-689-VARIABLE-DATA-4
  2868                                 PIC  X(30).
  2869
  2870         16  PI-689-KEY-DATA-FIELDS.
  2871             20  PI-689-ACCOUNT  PIC  X(10).
  2872             20  PI-689-CARRIER  PIC  X(01).
  2873             20  PI-689-CERT-NO.
  2874                 24  PI-689-CERT-PRIME
  2875                                 PIC  X(10).
  2876                 24  PI-689-CERT-SFX
  2877                                 PIC  X(01).
  2878             20  PI-689-CHG-SEQ-NO
  2879                                 PIC S9(04)    COMP.
  2880             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2881                                 PIC  X(02).
  2882             20  PI-689-ENTRY-BATCH
  2883                                 PIC  X(06).
  2884             20  PI-689-EFF-DATE PIC  X(02).
  2885             20  PI-689-EXP-DATE PIC  X(02).
  2886             20  PI-689-GROUPING PIC  X(06).
  2887             20  PI-689-RESP-PERSON
  2888                                 PIC  X(10).
  2889             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2890             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2891                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  55
* VP6311.cbl
  2892             20  PI-689-STATE    PIC  X(02).
  2893             20  PI-689-TYPE     PIC  X(01).
  2894             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2895             20  PI-689-ALT-SEQ-NO
  2896                                 PIC S9(04)    COMP.
  2897         16  PI-689-DATE-EDIT    PIC  X(08).
  2898         16  PI-689-FOLLOW-UP-EDIT
  2899                                 PIC  X(08).
  2900         16  PI-689-RESEND1-EDIT PIC  X(08).
  2901         16  PI-689-SEQ-EDIT     PIC  X(08).
  2902         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2903         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2904             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2905         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2906         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  56
* VP6311.cbl
  2908
  2909 01  WS-EL6315-PASS-AREA.
  2910        16  PI-6315-ISS-CAN-SW      PIC X.
  2911        16  FILLER                  PIC X(120).
  2912        16  PI-RES-REF-CLM-TYPE     PIC X.
  2913        16  FILLER                  PIC X.
  2914        16  PI-6315-PASS-AREA.
  2915            20 FILLER               PIC X(236).
  2916            20 PI-6315-FINALIZED    PIC X.
  2917            20 FILLER               PIC X(280).
  2918
  2919 01  WS-EL6316-PASS-AREA.
  2920        16  PI-ISS-CAN-SW           PIC X.
  2921        16  FILLER                  PIC X(121).
  2922        16  PI-CLM-RESC-IND         PIC X.
  2923        16  PI-6316-PASS-AREA.
  2924            20 FILLER               PIC X(236).
  2925            20 PI-6316-FINALIZED    PIC X.
  2926            20 FILLER               PIC X(280).
  2927
  2928******************************************************************
  2929*                                                                *
  2930*         P A S S   A R E A   F O R   E D I T                    *
  2931*                                                                *
  2932******************************************************************
  2933
  2934 01  PASSED-RECORD.
  2935     12  RECORD-SAVE                  PIC X(585).
  2936* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2937*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2938*                    BY  WK-CURRENT-DATE.
  2939******************************************************************
  2940*                                                                *
  2941*                                                                *
  2942*                             ELC50W1                            *
  2943*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2944*                            VMOD=2.004                          *
  2945*                                                                *
  2946*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2947*                                                                *
  2948*                                                                *
  2949******************************************************************
  2950
  2951     12  WK-WORK-AREA.
  2952         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2953         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2954         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2955         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2956         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2957         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2958         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2959         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2960         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2961         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2962         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2963         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2964         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2965         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  57
* VP6311.cbl
  2966         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2967         16  WK-CREDIT-EDIT-CONTROLS.
  2968             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2969             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2970             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2971             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2972             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2973             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2974         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2975         16  WK-SAVE-REIN-DATA.
  2976             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2977             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2978             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2979         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2980             88  ENTRY-FROM-EL6311       VALUE '6'.
  2981         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2982         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2983     12  WK-RECORD-ADDRESSES.
  2984         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2985         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2986         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2987         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2988         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2989         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2990         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2991         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2992     12  WK-OVER-SHORT-AREA.
  2993         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2994         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2995         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2996             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2997         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  58
* VP6311.cbl
  2999
  3000*    COPY ELCEDITC.
  3001******************************************************************
  3002*                                                                *
  3003*                                                                *
  3004*                            ELCEDITC                            *
  3005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3006*                            VMOD=2.012                          *
  3007*                                                                *
  3008*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3009*                     EL6313, EL050 AND EL517.                   *
  3010*                                                                *
  3011******************************************************************
  3012******************************************************************
  3013*                   C H A N G E   L O G
  3014*
  3015* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3016*-----------------------------------------------------------------
  3017*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3018* EFFECTIVE    NUMBER
  3019*-----------------------------------------------------------------
  3020* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3021******************************************************************
  3022
  3023     12  EDIT-CRITERIA-DATA.
  3024         16  EC-CO-MONTH-END-DT       PIC XX.
  3025         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3026         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3027         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3028         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3029         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3030         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3031         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3032         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3033         16  EC-CO-REM-TERM-CALC      PIC X.
  3034               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3035               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3036               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3037               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3038
  3039         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3040               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3041               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3042               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3043               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3044               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3045               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3046               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3047               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3048               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3049               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3050
  3051         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3052               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3053               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3054               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3055               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3056               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  59
* VP6311.cbl
  3057               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3058               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3059               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3060
  3061         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3062                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3063                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3064
  3065         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3066                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3067                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3068                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3069                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3070                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3071                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3072                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3073                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3074
  3075         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3076               88  EC-BR-REDUCING                   VALUE 'R'.
  3077               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3078
  3079         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3080         16  EC-BR-LF-DESC             PIC X(10).
  3081         16  EC-BR-AH-DESC             PIC X(10).
  3082         16  EC-BR-LF-COMMENT          PIC X(10).
  3083         16  EC-BR-AH-COMMENT          PIC X(10).
  3084
  3085         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3086               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3087               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3088               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3089               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3090
  3091         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3092               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3093               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3094               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3095               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3096
  3097         16  EC-BR-LF-REFUND-CALC      PIC X.
  3098                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3099                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3100                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3101                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3102                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3103                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3104                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3105
  3106         16  EC-BR-AH-REFUND-CALC      PIC X.
  3107                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3108                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3109                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3110                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3111                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3112                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3113                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3114                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  60
* VP6311.cbl
  3115
  3116         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3117                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3118                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3119                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3120
  3121         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3122                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3123                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3124                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3125
  3126         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3127         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3128         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3129         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3130
  3131         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3132         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3133                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3134                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3135                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3136                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3137
  3138         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3139               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3140               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3141               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3142               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3143               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3144
  3145         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3146               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3147               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3148               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3149               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3150               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3151
  3152         16  EC-ST-LF-REFUND-CALC      PIC X.
  3153                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3154                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3155                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3156                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3157                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3158                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3159                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3160                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3161
  3162         16  EC-ST-AH-REFUND-CALC      PIC X.
  3163                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3164                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3165                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3166                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3167                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3168                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3169                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3170                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3171
  3172         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  61
* VP6311.cbl
  3173         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3174         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3175         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3176         16  EC-AM-EXPIRATION-DT       PIC XX.
  3177         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3178         16  EC-AM-CLASS-CD            PIC XX.
  3179         16  EC-AM-LF-DEVIATION        PIC XXX.
  3180         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3181         16  EC-AM-AH-DEVIATION        PIC XXX.
  3182         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3183         16  EC-AM-PHONE-NO            PIC X(10).
  3184
  3185         16  EC-AM-LF-REFUND-CALC      PIC X.
  3186                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3187                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3188                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3189                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3190                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3191                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3192                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3193
  3194         16  EC-AM-AH-REFUND-CALC      PIC X.
  3195                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3196                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3197                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3198                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3199                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3200                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3201                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3202
  3203         16  EC-AM-BEN-I-G-CD          PIC X.
  3204                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3205                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3206                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3207
  3208         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3209         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3210         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3211         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3212         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3213         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3214         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3215         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3216         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3217
  3218         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3219         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3220         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3221         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3222         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3223         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3224         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3225         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3226         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3227         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3228         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3229         16  EC-RT-LF-NSP-ST           PIC XX.
  3230         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  62
* VP6311.cbl
  3231         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3232         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3233
  3234         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3235             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3236                                             'M' '5' '9' '2'.
  3237             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3238             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3239             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3240             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3241             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3242             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3243             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3244             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3245             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3246             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3247
  3248         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3249             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3250                                             'M' '5' '9' '2'.
  3251             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3252             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3253             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3254             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3255             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3256             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3257             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3258             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3259             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3260             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3261
  3262         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3263         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3264         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3265         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3266         16  EC-CM-DEATH-DT            PIC XX.
  3267
  3268*DMD CUSTOM CODING FIELDS BELOW
  3269*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3270         16  EC-BR-DMD-RATING-SW       PIC X.
  3271                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3272                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3273                 88  NO-DMD-RATING               VALUE 'N'.
  3274
  3275         16  EC-NEW-CERT               PIC X(11).
  3276         16  EC-NEW-STATE              PIC XX.
  3277         16  FILLER                    PIC X.
  3278*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3279         16  OVER-SHORT-EDIT-FIELDS.
  3280             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3281             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3282             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3283             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3284             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3285             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3286             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3287             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3288             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  63
* VP6311.cbl
  3289         16  FILLER                    PIC X(71).
  3290
  3291******************************************************************
  3292
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  64
* VP6311.cbl
  3294
  3295*    COPY ELCJPFX.
  3296******************************************************************
  3297*                                                                *
  3298*                                                                *
  3299*                            ELCJPFX.                            *
  3300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3301*                            VMOD=2.002                          *
  3302*                                                                *
  3303*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3304*                                                                *
  3305*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3306*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3307*        ELCNTL - CONTROL FILE                                   *
  3308*        ELMSTR - CLAIM MASTERS                                  *
  3309*        ELTRLR - ACTIVITY TRAILERS                              *
  3310*        ELCHKQ - CHECK QUE                                      *
  3311******************************************************************
  3312 01  JOURNAL-RECORD.
  3313     12  jp-date                     pic s9(5) comp-3.
  3314     12  jp-time                     pic s9(7) comp-3.
  3315     12  JP-USER-ID                  PIC X(4).
  3316     12  JP-FILE-ID                  PIC X(8).
  3317     12  JP-PROGRAM-ID               PIC X(8).
  3318     12  JP-RECORD-TYPE              PIC X.
  3319         88 JP-ADD              VALUE 'A'.
  3320         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3321         88 JP-AFTER-CHANGE     VALUE 'C'.
  3322         88 JP-DELETE           VALUE 'D'.
  3323         88 JP-GENERIC-DELETE   VALUE 'G'.
  3324         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3325         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3326     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3327     12  JP-RECORD-AREA
  3328
  3329
  3330                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  65
* VP6311.cbl
  3332*    COPY ELCAID.
  3333******************************************************************
  3334*                                                                *
  3335*                            ELCAID.                             *
  3336*                            VMOD=2.001                          *
  3337*                                                                *
  3338*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3339*                                                                *
  3340*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3341*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3342******************************************************************
  3343
  3344 01  DFHAID.
  3345   02  DFHNULL   PIC  X  VALUE  ' '.
  3346   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3347   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3348   02  DFHPEN    PIC  X  VALUE  '='.
  3349   02  DFHOPID   PIC  X  VALUE  'W'.
  3350   02  DFHPA1    PIC  X  VALUE  '%'.
  3351   02  DFHPA2    PIC  X  VALUE  '>'.
  3352   02  DFHPA3    PIC  X  VALUE  ','.
  3353   02  DFHPF1    PIC  X  VALUE  '1'.
  3354   02  DFHPF2    PIC  X  VALUE  '2'.
  3355   02  DFHPF3    PIC  X  VALUE  '3'.
  3356   02  DFHPF4    PIC  X  VALUE  '4'.
  3357   02  DFHPF5    PIC  X  VALUE  '5'.
  3358   02  DFHPF6    PIC  X  VALUE  '6'.
  3359   02  DFHPF7    PIC  X  VALUE  '7'.
  3360   02  DFHPF8    PIC  X  VALUE  '8'.
  3361   02  DFHPF9    PIC  X  VALUE  '9'.
  3362   02  DFHPF10   PIC  X  VALUE  ':'.
  3363   02  DFHPF11   PIC  X  VALUE  '#'.
  3364   02  DFHPF12   PIC  X  VALUE  '@'.
  3365   02  DFHPF13   PIC  X  VALUE  'A'.
  3366   02  DFHPF14   PIC  X  VALUE  'B'.
  3367   02  DFHPF15   PIC  X  VALUE  'C'.
  3368   02  DFHPF16   PIC  X  VALUE  'D'.
  3369   02  DFHPF17   PIC  X  VALUE  'E'.
  3370   02  DFHPF18   PIC  X  VALUE  'F'.
  3371   02  DFHPF19   PIC  X  VALUE  'G'.
  3372   02  DFHPF20   PIC  X  VALUE  'H'.
  3373   02  DFHPF21   PIC  X  VALUE  'I'.
  3374*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3375   02  DFHPF22   PIC  X  VALUE  '['.
  3376   02  DFHPF23   PIC  X  VALUE  '.'.
  3377   02  DFHPF24   PIC  X  VALUE  '<'.
  3378   02  DFHMSRE   PIC  X  VALUE  'X'.
  3379   02  DFHSTRF   PIC  X  VALUE  'h'.
  3380   02  DFHTRIG   PIC  X  VALUE  '"'.
  3381
  3382 01  FILLER    REDEFINES DFHAID.
  3383     12  FILLER              PIC X(8).
  3384     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3385
  3386*                                COPY VP6311S.
  3387 01  VP631BI.
  3388     05  FILLER            PIC  X(0012).
  3389*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  66
* VP6311.cbl
  3390     05  BDATEL PIC S9(0004) COMP.
  3391     05  BDATEF PIC  X(0001).
  3392     05  FILLER REDEFINES BDATEF.
  3393         10  BDATEA PIC  X(0001).
  3394     05  BDATEI PIC  X(0008).
  3395*    -------------------------------
  3396     05  BTIMEL PIC S9(0004) COMP.
  3397     05  BTIMEF PIC  X(0001).
  3398     05  FILLER REDEFINES BTIMEF.
  3399         10  BTIMEA PIC  X(0001).
  3400     05  BTIMEI PIC  X(0005).
  3401*    -------------------------------
  3402     05  BHEADL PIC S9(0004) COMP.
  3403     05  BHEADF PIC  X(0001).
  3404     05  FILLER REDEFINES BHEADF.
  3405         10  BHEADA PIC  X(0001).
  3406     05  BHEADI PIC  X(0038).
  3407*    -------------------------------
  3408     05  BNCERTLL PIC S9(0004) COMP.
  3409     05  BNCERTLF PIC  X(0001).
  3410     05  FILLER REDEFINES BNCERTLF.
  3411         10  BNCERTLA PIC  X(0001).
  3412     05  BNCERTLI PIC  X(0008).
  3413*    -------------------------------
  3414     05  BNCERTL PIC S9(0004) COMP.
  3415     05  BNCERTF PIC  X(0001).
  3416     05  FILLER REDEFINES BNCERTF.
  3417         10  BNCERTA PIC  X(0001).
  3418     05  BNCERTI PIC  X(0011).
  3419*    -------------------------------
  3420     05  BNSTATLL PIC S9(0004) COMP.
  3421     05  BNSTATLF PIC  X(0001).
  3422     05  FILLER REDEFINES BNSTATLF.
  3423         10  BNSTATLA PIC  X(0001).
  3424     05  BNSTATLI PIC  X(0009).
  3425*    -------------------------------
  3426     05  BNSTATL PIC S9(0004) COMP.
  3427     05  BNSTATF PIC  X(0001).
  3428     05  FILLER REDEFINES BNSTATF.
  3429         10  BNSTATA PIC  X(0001).
  3430     05  BNSTATI PIC  X(0002).
  3431*    -------------------------------
  3432     05  BCHGTL PIC S9(0004) COMP.
  3433     05  BCHGTF PIC  X(0001).
  3434     05  FILLER REDEFINES BCHGTF.
  3435         10  BCHGTA PIC  X(0001).
  3436     05  BCHGTI PIC  X(0004).
  3437*    -------------------------------
  3438     05  BCHGL PIC S9(0004) COMP.
  3439     05  BCHGF PIC  X(0001).
  3440     05  FILLER REDEFINES BCHGF.
  3441         10  BCHGA PIC  X(0001).
  3442     05  BCHGI PIC  X(0004).
  3443*    -------------------------------
  3444     05  BCOMPIDL PIC S9(0004) COMP.
  3445     05  BCOMPIDF PIC  X(0001).
  3446     05  FILLER REDEFINES BCOMPIDF.
  3447         10  BCOMPIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  67
* VP6311.cbl
  3448     05  BCOMPIDI PIC  X(0003).
  3449*    -------------------------------
  3450     05  BREGIONL PIC S9(0004) COMP.
  3451     05  BREGIONF PIC  X(0001).
  3452     05  FILLER REDEFINES BREGIONF.
  3453         10  BREGIONA PIC  X(0001).
  3454     05  BREGIONI PIC  X(0006).
  3455*    -------------------------------
  3456     05  BUSERL PIC S9(0004) COMP.
  3457     05  BUSERF PIC  X(0001).
  3458     05  FILLER REDEFINES BUSERF.
  3459         10  BUSERA PIC  X(0001).
  3460     05  BUSERI PIC  X(0004).
  3461*    -------------------------------
  3462     05  BMAINTL PIC S9(0004) COMP.
  3463     05  BMAINTF PIC  X(0001).
  3464     05  FILLER REDEFINES BMAINTF.
  3465         10  BMAINTA PIC  X(0001).
  3466     05  BMAINTI PIC  X(0001).
  3467*    -------------------------------
  3468     05  BMANTBYL PIC S9(0004) COMP.
  3469     05  BMANTBYF PIC  X(0001).
  3470     05  FILLER REDEFINES BMANTBYF.
  3471         10  BMANTBYA PIC  X(0001).
  3472     05  BMANTBYI PIC  X(0004).
  3473*    -------------------------------
  3474     05  BCHGHDGL PIC S9(0004) COMP.
  3475     05  BCHGHDGF PIC  X(0001).
  3476     05  FILLER REDEFINES BCHGHDGF.
  3477         10  BCHGHDGA PIC  X(0001).
  3478     05  BCHGHDGI PIC  X(0003).
  3479*    -------------------------------
  3480     05  BMANTDTL PIC S9(0004) COMP.
  3481     05  BMANTDTF PIC  X(0001).
  3482     05  FILLER REDEFINES BMANTDTF.
  3483         10  BMANTDTA PIC  X(0001).
  3484     05  BMANTDTI PIC  X(0008).
  3485*    -------------------------------
  3486     05  BMANTATL PIC S9(0004) COMP.
  3487     05  BMANTATF PIC  X(0001).
  3488     05  FILLER REDEFINES BMANTATF.
  3489         10  BMANTATA PIC  X(0001).
  3490     05  BMANTATI PIC  X(0005).
  3491*    -------------------------------
  3492     05  BCSRL PIC S9(0004) COMP.
  3493     05  BCSRF PIC  X(0001).
  3494     05  FILLER REDEFINES BCSRF.
  3495         10  BCSRA PIC  X(0001).
  3496     05  BCSRI PIC  X(0004).
  3497*    -------------------------------
  3498     05  BBATCHL PIC S9(0004) COMP.
  3499     05  BBATCHF PIC  X(0001).
  3500     05  FILLER REDEFINES BBATCHF.
  3501         10  BBATCHA PIC  X(0001).
  3502     05  BBATCHI PIC  X(0006).
  3503*    -------------------------------
  3504     05  BSEQL PIC S9(0004) COMP.
  3505     05  BSEQF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  68
* VP6311.cbl
  3506     05  FILLER REDEFINES BSEQF.
  3507         10  BSEQA PIC  X(0001).
  3508     05  BSEQI PIC  X(0004).
  3509*    -------------------------------
  3510     05  BMOENDTL PIC S9(0004) COMP.
  3511     05  BMOENDTF PIC  X(0001).
  3512     05  FILLER REDEFINES BMOENDTF.
  3513         10  BMOENDTA PIC  X(0001).
  3514     05  BMOENDTI PIC  X(0008).
  3515*    -------------------------------
  3516     05  BCARRL PIC S9(0004) COMP.
  3517     05  BCARRF PIC  X(0001).
  3518     05  FILLER REDEFINES BCARRF.
  3519         10  BCARRA PIC  X(0001).
  3520     05  BCARRI PIC  X(0001).
  3521*    -------------------------------
  3522     05  BGROUPL PIC S9(0004) COMP.
  3523     05  BGROUPF PIC  X(0001).
  3524     05  FILLER REDEFINES BGROUPF.
  3525         10  BGROUPA PIC  X(0001).
  3526     05  BGROUPI PIC  X(0006).
  3527*    -------------------------------
  3528     05  BSTATEL PIC S9(0004) COMP.
  3529     05  BSTATEF PIC  X(0001).
  3530     05  FILLER REDEFINES BSTATEF.
  3531         10  BSTATEA PIC  X(0001).
  3532     05  BSTATEI PIC  X(0002).
  3533*    -------------------------------
  3534     05  BACCTL PIC S9(0004) COMP.
  3535     05  BACCTF PIC  X(0001).
  3536     05  FILLER REDEFINES BACCTF.
  3537         10  BACCTA PIC  X(0001).
  3538     05  BACCTI PIC  X(0010).
  3539*    -------------------------------
  3540     05  BVINHL PIC S9(0004) COMP.
  3541     05  BVINHF PIC  X(0001).
  3542     05  FILLER REDEFINES BVINHF.
  3543         10  BVINHA PIC  X(0001).
  3544     05  BVINHI PIC  X(0004).
  3545*    -------------------------------
  3546     05  BVINL PIC S9(0004) COMP.
  3547     05  BVINF PIC  X(0001).
  3548     05  FILLER REDEFINES BVINF.
  3549         10  BVINA PIC  X(0001).
  3550     05  BVINI PIC  X(0017).
  3551*    -------------------------------
  3552     05  BREFHDGL PIC S9(0004) COMP.
  3553     05  BREFHDGF PIC  X(0001).
  3554     05  FILLER REDEFINES BREFHDGF.
  3555         10  BREFHDGA PIC  X(0001).
  3556     05  BREFHDGI PIC  X(0004).
  3557*    -------------------------------
  3558     05  BREFL PIC S9(0004) COMP.
  3559     05  BREFF PIC  X(0001).
  3560     05  FILLER REDEFINES BREFF.
  3561         10  BREFA PIC  X(0001).
  3562     05  BREFI PIC  X(0012).
  3563*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  69
* VP6311.cbl
  3564     05  BAGEDEFL PIC S9(0004) COMP.
  3565     05  BAGEDEFF PIC  X(0001).
  3566     05  FILLER REDEFINES BAGEDEFF.
  3567         10  BAGEDEFA PIC  X(0001).
  3568     05  BAGEDEFI PIC  X(0004).
  3569*    -------------------------------
  3570     05  BCERTNOL PIC S9(0004) COMP.
  3571     05  BCERTNOF PIC  X(0001).
  3572     05  FILLER REDEFINES BCERTNOF.
  3573         10  BCERTNOA PIC  X(0001).
  3574     05  BCERTNOI PIC  X(0010).
  3575*    -------------------------------
  3576     05  BSUFIXL PIC S9(0004) COMP.
  3577     05  BSUFIXF PIC  X(0001).
  3578     05  FILLER REDEFINES BSUFIXF.
  3579         10  BSUFIXA PIC  X(0001).
  3580     05  BSUFIXI PIC  X(0001).
  3581*    -------------------------------
  3582     05  BEFFDTL PIC S9(0004) COMP.
  3583     05  BEFFDTF PIC  X(0001).
  3584     05  FILLER REDEFINES BEFFDTF.
  3585         10  BEFFDTA PIC  X(0001).
  3586     05  BEFFDTI PIC  X(0008).
  3587*    -------------------------------
  3588     05  BLSTNML PIC S9(0004) COMP.
  3589     05  BLSTNMF PIC  X(0001).
  3590     05  FILLER REDEFINES BLSTNMF.
  3591         10  BLSTNMA PIC  X(0001).
  3592     05  BLSTNMI PIC  X(0015).
  3593*    -------------------------------
  3594     05  B1STNML PIC S9(0004) COMP.
  3595     05  B1STNMF PIC  X(0001).
  3596     05  FILLER REDEFINES B1STNMF.
  3597         10  B1STNMA PIC  X(0001).
  3598     05  B1STNMI PIC  X(0010).
  3599*    -------------------------------
  3600     05  BINITL PIC S9(0004) COMP.
  3601     05  BINITF PIC  X(0001).
  3602     05  FILLER REDEFINES BINITF.
  3603         10  BINITA PIC  X(0001).
  3604     05  BINITI PIC  X(0001).
  3605*    -------------------------------
  3606     05  BSEXL PIC S9(0004) COMP.
  3607     05  BSEXF PIC  X(0001).
  3608     05  FILLER REDEFINES BSEXF.
  3609         10  BSEXA PIC  X(0001).
  3610     05  BSEXI PIC  X(0001).
  3611*    -------------------------------
  3612     05  BAGEL PIC S9(0004) COMP.
  3613     05  BAGEF PIC  X(0001).
  3614     05  FILLER REDEFINES BAGEF.
  3615         10  BAGEA PIC  X(0001).
  3616     05  BAGEI PIC  X(0002).
  3617*    -------------------------------
  3618     05  BBIRTHL PIC S9(0004) COMP.
  3619     05  BBIRTHF PIC  X(0001).
  3620     05  FILLER REDEFINES BBIRTHF.
  3621         10  BBIRTHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  70
* VP6311.cbl
  3622     05  BBIRTHI PIC  X(0008).
  3623*    -------------------------------
  3624     05  BYEARL PIC S9(0004) COMP.
  3625     05  BYEARF PIC  X(0001).
  3626     05  FILLER REDEFINES BYEARF.
  3627         10  BYEARA PIC  X(0001).
  3628     05  BYEARI PIC  X(0004).
  3629*    -------------------------------
  3630     05  BMAKEL PIC S9(0004) COMP.
  3631     05  BMAKEF PIC  X(0001).
  3632     05  FILLER REDEFINES BMAKEF.
  3633         10  BMAKEA PIC  X(0001).
  3634     05  BMAKEI PIC  X(0020).
  3635*    -------------------------------
  3636     05  BMODELL PIC S9(0004) COMP.
  3637     05  BMODELF PIC  X(0001).
  3638     05  FILLER REDEFINES BMODELF.
  3639         10  BMODELA PIC  X(0001).
  3640     05  BMODELI PIC  X(0020).
  3641*    -------------------------------
  3642     05  BFUTUREL PIC S9(0004) COMP.
  3643     05  BFUTUREF PIC  X(0001).
  3644     05  FILLER REDEFINES BFUTUREF.
  3645         10  BFUTUREA PIC  X(0001).
  3646     05  BFUTUREI PIC  X(0020).
  3647*    -------------------------------
  3648     05  BOMETERL PIC S9(0004) COMP.
  3649     05  BOMETERF PIC  X(0001).
  3650     05  FILLER REDEFINES BOMETERF.
  3651         10  BOMETERA PIC  X(0001).
  3652     05  BOMETERI PIC  X(0007).
  3653*    -------------------------------
  3654     05  BMEMCAPL PIC S9(0004) COMP.
  3655     05  BMEMCAPF PIC  X(0001).
  3656     05  FILLER REDEFINES BMEMCAPF.
  3657         10  BMEMCAPA PIC  X(0001).
  3658     05  BMEMCAPI PIC  X(0011).
  3659*    -------------------------------
  3660     05  BORIGHDL PIC S9(0004) COMP.
  3661     05  BORIGHDF PIC  X(0001).
  3662     05  FILLER REDEFINES BORIGHDF.
  3663         10  BORIGHDA PIC  X(0001).
  3664     05  BORIGHDI PIC  X(0010).
  3665*    -------------------------------
  3666     05  BFORCEL PIC S9(0004) COMP.
  3667     05  BFORCEF PIC  X(0001).
  3668     05  FILLER REDEFINES BFORCEF.
  3669         10  BFORCEA PIC  X(0001).
  3670     05  BFORCEI PIC  X(0001).
  3671*    -------------------------------
  3672     05  BENTRYL PIC S9(0004) COMP.
  3673     05  BENTRYF PIC  X(0001).
  3674     05  FILLER REDEFINES BENTRYF.
  3675         10  BENTRYA PIC  X(0001).
  3676     05  BENTRYI PIC  X(0001).
  3677*    -------------------------------
  3678     05  BREINL PIC S9(0004) COMP.
  3679     05  BREINF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  71
* VP6311.cbl
  3680     05  FILLER REDEFINES BREINF.
  3681         10  BREINA PIC  X(0001).
  3682     05  BREINI PIC  X(0001).
  3683*    -------------------------------
  3684     05  BBILCDL PIC S9(0004) COMP.
  3685     05  BBILCDF PIC  X(0001).
  3686     05  FILLER REDEFINES BBILCDF.
  3687         10  BBILCDA PIC  X(0001).
  3688     05  BBILCDI PIC  X(0001).
  3689*    -------------------------------
  3690     05  BUNWRITL PIC S9(0004) COMP.
  3691     05  BUNWRITF PIC  X(0001).
  3692     05  FILLER REDEFINES BUNWRITF.
  3693         10  BUNWRITA PIC  X(0001).
  3694     05  BUNWRITI PIC  X(0001).
  3695*    -------------------------------
  3696     05  BSKPCDL PIC S9(0004) COMP.
  3697     05  BSKPCDF PIC  X(0001).
  3698     05  FILLER REDEFINES BSKPCDF.
  3699         10  BSKPCDA PIC  X(0001).
  3700     05  BSKPCDI PIC  X(0001).
  3701*    -------------------------------
  3702     05  BINDGRPL PIC S9(0004) COMP.
  3703     05  BINDGRPF PIC  X(0001).
  3704     05  FILLER REDEFINES BINDGRPF.
  3705         10  BINDGRPA PIC  X(0001).
  3706     05  BINDGRPI PIC  X(0001).
  3707*    -------------------------------
  3708     05  BSIGL PIC S9(0004) COMP.
  3709     05  BSIGF PIC  X(0001).
  3710     05  FILLER REDEFINES BSIGF.
  3711         10  BSIGA PIC  X(0001).
  3712     05  BSIGI PIC  X(0001).
  3713*    -------------------------------
  3714     05  BRTCLSL PIC S9(0004) COMP.
  3715     05  BRTCLSF PIC  X(0001).
  3716     05  FILLER REDEFINES BRTCLSF.
  3717         10  BRTCLSA PIC  X(0001).
  3718     05  BRTCLSI PIC  X(0002).
  3719*    -------------------------------
  3720     05  BCHGCNTL PIC S9(0004) COMP.
  3721     05  BCHGCNTF PIC  X(0001).
  3722     05  FILLER REDEFINES BCHGCNTF.
  3723         10  BCHGCNTA PIC  X(0001).
  3724     05  BCHGCNTI PIC  X(0003).
  3725*    -------------------------------
  3726     05  BMEMBERL PIC S9(0004) COMP.
  3727     05  BMEMBERF PIC  X(0001).
  3728     05  FILLER REDEFINES BMEMBERF.
  3729         10  BMEMBERA PIC  X(0001).
  3730     05  BMEMBERI PIC  X(0012).
  3731*    -------------------------------
  3732     05  BLNOFCRL PIC S9(0004) COMP.
  3733     05  BLNOFCRF PIC  X(0001).
  3734     05  FILLER REDEFINES BLNOFCRF.
  3735         10  BLNOFCRA PIC  X(0001).
  3736     05  BLNOFCRI PIC  X(0005).
  3737*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  72
* VP6311.cbl
  3738     05  BKIND1L PIC S9(0004) COMP.
  3739     05  BKIND1F PIC  X(0001).
  3740     05  FILLER REDEFINES BKIND1F.
  3741         10  BKIND1A PIC  X(0001).
  3742     05  BKIND1I PIC  X(0002).
  3743*    -------------------------------
  3744     05  BTYPE1L PIC S9(0004) COMP.
  3745     05  BTYPE1F PIC  X(0001).
  3746     05  FILLER REDEFINES BTYPE1F.
  3747         10  BTYPE1A PIC  X(0001).
  3748     05  BTYPE1I PIC  X(0003).
  3749*    -------------------------------
  3750     05  BTERM1L PIC S9(0004) COMP.
  3751     05  BTERM1F PIC  X(0001).
  3752     05  FILLER REDEFINES BTERM1F.
  3753         10  BTERM1A PIC  X(0001).
  3754     05  BTERM1I PIC  X(0003).
  3755*    -------------------------------
  3756     05  BBEN1L PIC S9(0004) COMP.
  3757     05  BBEN1F PIC  X(0001).
  3758     05  FILLER REDEFINES BBEN1F.
  3759         10  BBEN1A PIC  X(0001).
  3760     05  BBEN1I PIC  X(0012).
  3761*    -------------------------------
  3762     05  BPREM1L PIC S9(0004) COMP.
  3763     05  BPREM1F PIC  X(0001).
  3764     05  FILLER REDEFINES BPREM1F.
  3765         10  BPREM1A PIC  X(0001).
  3766     05  BPREM1I PIC  X(0011).
  3767*    -------------------------------
  3768     05  BEXPIR1L PIC S9(0004) COMP.
  3769     05  BEXPIR1F PIC  X(0001).
  3770     05  FILLER REDEFINES BEXPIR1F.
  3771         10  BEXPIR1A PIC  X(0001).
  3772     05  BEXPIR1I PIC  X(0008).
  3773*    -------------------------------
  3774     05  BCP1L PIC S9(0004) COMP.
  3775     05  BCP1F PIC  X(0001).
  3776     05  FILLER REDEFINES BCP1F.
  3777         10  BCP1A PIC  X(0001).
  3778     05  BCP1I PIC  X(0002).
  3779*    -------------------------------
  3780     05  BALTBN1L PIC S9(0004) COMP.
  3781     05  BALTBN1F PIC  X(0001).
  3782     05  FILLER REDEFINES BALTBN1F.
  3783         10  BALTBN1A PIC  X(0001).
  3784     05  BALTBN1I PIC  X(0012).
  3785*    -------------------------------
  3786     05  BALTPR1L PIC S9(0004) COMP.
  3787     05  BALTPR1F PIC  X(0001).
  3788     05  FILLER REDEFINES BALTPR1F.
  3789         10  BALTPR1A PIC  X(0001).
  3790     05  BALTPR1I PIC  X(0011).
  3791*    -------------------------------
  3792     05  BBNCD1L PIC S9(0004) COMP.
  3793     05  BBNCD1F PIC  X(0001).
  3794     05  FILLER REDEFINES BBNCD1F.
  3795         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  73
* VP6311.cbl
  3796     05  BBNCD1I PIC  X(0003).
  3797*    -------------------------------
  3798     05  BCPRM1L PIC S9(0004) COMP.
  3799     05  BCPRM1F PIC  X(0001).
  3800     05  FILLER REDEFINES BCPRM1F.
  3801         10  BCPRM1A PIC  X(0001).
  3802     05  BCPRM1I PIC  X(0011).
  3803*    -------------------------------
  3804     05  BCAPRM1L PIC S9(0004) COMP.
  3805     05  BCAPRM1F PIC  X(0001).
  3806     05  FILLER REDEFINES BCAPRM1F.
  3807         10  BCAPRM1A PIC  X(0001).
  3808     05  BCAPRM1I PIC  X(0011).
  3809*    -------------------------------
  3810     05  BENABR1L PIC S9(0004) COMP.
  3811     05  BENABR1F PIC  X(0001).
  3812     05  FILLER REDEFINES BENABR1F.
  3813         10  BENABR1A PIC  X(0001).
  3814     05  BENABR1I PIC  X(0005).
  3815*    -------------------------------
  3816     05  BDIFF1L PIC S9(0004) COMP.
  3817     05  BDIFF1F PIC  X(0001).
  3818     05  FILLER REDEFINES BDIFF1F.
  3819         10  BDIFF1A PIC  X(0001).
  3820     05  BDIFF1I PIC  X(0011).
  3821*    -------------------------------
  3822     05  BBILIT1L PIC S9(0004) COMP.
  3823     05  BBILIT1F PIC  X(0001).
  3824     05  FILLER REDEFINES BBILIT1F.
  3825         10  BBILIT1A PIC  X(0001).
  3826     05  BBILIT1I PIC  X(0008).
  3827*    -------------------------------
  3828     05  BADIFF1L PIC S9(0004) COMP.
  3829     05  BADIFF1F PIC  X(0001).
  3830     05  FILLER REDEFINES BADIFF1F.
  3831         10  BADIFF1A PIC  X(0001).
  3832     05  BADIFF1I PIC  X(0011).
  3833*    -------------------------------
  3834     05  BKIND2L PIC S9(0004) COMP.
  3835     05  BKIND2F PIC  X(0001).
  3836     05  FILLER REDEFINES BKIND2F.
  3837         10  BKIND2A PIC  X(0001).
  3838     05  BKIND2I PIC  X(0002).
  3839*    -------------------------------
  3840     05  BTYPE2L PIC S9(0004) COMP.
  3841     05  BTYPE2F PIC  X(0001).
  3842     05  FILLER REDEFINES BTYPE2F.
  3843         10  BTYPE2A PIC  X(0001).
  3844     05  BTYPE2I PIC  X(0003).
  3845*    -------------------------------
  3846     05  BTERM2L PIC S9(0004) COMP.
  3847     05  BTERM2F PIC  X(0001).
  3848     05  FILLER REDEFINES BTERM2F.
  3849         10  BTERM2A PIC  X(0001).
  3850     05  BTERM2I PIC  X(0003).
  3851*    -------------------------------
  3852     05  BBEN2L PIC S9(0004) COMP.
  3853     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  74
* VP6311.cbl
  3854     05  FILLER REDEFINES BBEN2F.
  3855         10  BBEN2A PIC  X(0001).
  3856     05  BBEN2I PIC  X(0012).
  3857*    -------------------------------
  3858     05  BPREM2L PIC S9(0004) COMP.
  3859     05  BPREM2F PIC  X(0001).
  3860     05  FILLER REDEFINES BPREM2F.
  3861         10  BPREM2A PIC  X(0001).
  3862     05  BPREM2I PIC  X(0011).
  3863*    -------------------------------
  3864     05  BEXPIR2L PIC S9(0004) COMP.
  3865     05  BEXPIR2F PIC  X(0001).
  3866     05  FILLER REDEFINES BEXPIR2F.
  3867         10  BEXPIR2A PIC  X(0001).
  3868     05  BEXPIR2I PIC  X(0008).
  3869*    -------------------------------
  3870     05  BCP2L PIC S9(0004) COMP.
  3871     05  BCP2F PIC  X(0001).
  3872     05  FILLER REDEFINES BCP2F.
  3873         10  BCP2A PIC  X(0001).
  3874     05  BCP2I PIC  X(0002).
  3875*    -------------------------------
  3876     05  BALTBN2L PIC S9(0004) COMP.
  3877     05  BALTBN2F PIC  X(0001).
  3878     05  FILLER REDEFINES BALTBN2F.
  3879         10  BALTBN2A PIC  X(0001).
  3880     05  BALTBN2I PIC  X(0012).
  3881*    -------------------------------
  3882     05  BALTPR2L PIC S9(0004) COMP.
  3883     05  BALTPR2F PIC  X(0001).
  3884     05  FILLER REDEFINES BALTPR2F.
  3885         10  BALTPR2A PIC  X(0001).
  3886     05  BALTPR2I PIC  X(0011).
  3887*    -------------------------------
  3888     05  BBNCD2L PIC S9(0004) COMP.
  3889     05  BBNCD2F PIC  X(0001).
  3890     05  FILLER REDEFINES BBNCD2F.
  3891         10  BBNCD2A PIC  X(0001).
  3892     05  BBNCD2I PIC  X(0003).
  3893*    -------------------------------
  3894     05  BCPRM2L PIC S9(0004) COMP.
  3895     05  BCPRM2F PIC  X(0001).
  3896     05  FILLER REDEFINES BCPRM2F.
  3897         10  BCPRM2A PIC  X(0001).
  3898     05  BCPRM2I PIC  X(0011).
  3899*    -------------------------------
  3900     05  BCAPRM2L PIC S9(0004) COMP.
  3901     05  BCAPRM2F PIC  X(0001).
  3902     05  FILLER REDEFINES BCAPRM2F.
  3903         10  BCAPRM2A PIC  X(0001).
  3904     05  BCAPRM2I PIC  X(0011).
  3905*    -------------------------------
  3906     05  BENABR2L PIC S9(0004) COMP.
  3907     05  BENABR2F PIC  X(0001).
  3908     05  FILLER REDEFINES BENABR2F.
  3909         10  BENABR2A PIC  X(0001).
  3910     05  BENABR2I PIC  X(0005).
  3911*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  75
* VP6311.cbl
  3912     05  BDIFF2L PIC S9(0004) COMP.
  3913     05  BDIFF2F PIC  X(0001).
  3914     05  FILLER REDEFINES BDIFF2F.
  3915         10  BDIFF2A PIC  X(0001).
  3916     05  BDIFF2I PIC  X(0011).
  3917*    -------------------------------
  3918     05  BBILIT2L PIC S9(0004) COMP.
  3919     05  BBILIT2F PIC  X(0001).
  3920     05  FILLER REDEFINES BBILIT2F.
  3921         10  BBILIT2A PIC  X(0001).
  3922     05  BBILIT2I PIC  X(0008).
  3923*    -------------------------------
  3924     05  BADIFF2L PIC S9(0004) COMP.
  3925     05  BADIFF2F PIC  X(0001).
  3926     05  FILLER REDEFINES BADIFF2F.
  3927         10  BADIFF2A PIC  X(0001).
  3928     05  BADIFF2I PIC  X(0011).
  3929*    -------------------------------
  3930     05  BERMSG1L PIC S9(0004) COMP.
  3931     05  BERMSG1F PIC  X(0001).
  3932     05  FILLER REDEFINES BERMSG1F.
  3933         10  BERMSG1A PIC  X(0001).
  3934     05  BERMSG1I PIC  X(0078).
  3935*    -------------------------------
  3936     05  BERMSG2L PIC S9(0004) COMP.
  3937     05  BERMSG2F PIC  X(0001).
  3938     05  FILLER REDEFINES BERMSG2F.
  3939         10  BERMSG2A PIC  X(0001).
  3940     05  BERMSG2I PIC  X(0078).
  3941*    -------------------------------
  3942     05  BERMSG3L PIC S9(0004) COMP.
  3943     05  BERMSG3F PIC  X(0001).
  3944     05  FILLER REDEFINES BERMSG3F.
  3945         10  BERMSG3A PIC  X(0001).
  3946     05  BERMSG3I PIC  X(0078).
  3947*    -------------------------------
  3948     05  BPFENTRL PIC S9(0004) COMP.
  3949     05  BPFENTRF PIC  X(0001).
  3950     05  FILLER REDEFINES BPFENTRF.
  3951         10  BPFENTRA PIC  X(0001).
  3952     05  BPFENTRI PIC  9(2).
  3953*    -------------------------------
  3954     05  BPF5HDRL PIC S9(0004) COMP.
  3955     05  BPF5HDRF PIC  X(0001).
  3956     05  FILLER REDEFINES BPF5HDRF.
  3957         10  BPF5HDRA PIC  X(0001).
  3958     05  BPF5HDRI PIC  X(0005).
  3959*    -------------------------------
  3960     05  BPF4HDRL PIC S9(0004) COMP.
  3961     05  BPF4HDRF PIC  X(0001).
  3962     05  FILLER REDEFINES BPF4HDRF.
  3963         10  BPF4HDRA PIC  X(0001).
  3964     05  BPF4HDRI PIC  X(0013).
  3965*    -------------------------------
  3966     05  BF15HDRL PIC S9(0004) COMP.
  3967     05  BF15HDRF PIC  X(0001).
  3968     05  FILLER REDEFINES BF15HDRF.
  3969         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  76
* VP6311.cbl
  3970     05  BF15HDRI PIC  X(0010).
  3971 01  VP631BO REDEFINES VP631BI.
  3972     05  FILLER            PIC  X(0012).
  3973*    -------------------------------
  3974     05  FILLER            PIC  X(0003).
  3975     05  BDATEO PIC  X(0008).
  3976*    -------------------------------
  3977     05  FILLER            PIC  X(0003).
  3978     05  BTIMEO PIC  99.99.
  3979*    -------------------------------
  3980     05  FILLER            PIC  X(0003).
  3981     05  BHEADO PIC  X(0038).
  3982*    -------------------------------
  3983     05  FILLER            PIC  X(0003).
  3984     05  BNCERTLO PIC  X(0008).
  3985*    -------------------------------
  3986     05  FILLER            PIC  X(0003).
  3987     05  BNCERTO PIC  X(0011).
  3988*    -------------------------------
  3989     05  FILLER            PIC  X(0003).
  3990     05  BNSTATLO PIC  X(0009).
  3991*    -------------------------------
  3992     05  FILLER            PIC  X(0003).
  3993     05  BNSTATO PIC  X(0002).
  3994*    -------------------------------
  3995     05  FILLER            PIC  X(0003).
  3996     05  BCHGTO PIC  X(0004).
  3997*    -------------------------------
  3998     05  FILLER            PIC  X(0003).
  3999     05  BCHGO PIC  ZZZ9.
  4000*    -------------------------------
  4001     05  FILLER            PIC  X(0003).
  4002     05  BCOMPIDO PIC  X(0003).
  4003*    -------------------------------
  4004     05  FILLER            PIC  X(0003).
  4005     05  BREGIONO PIC  X(0006).
  4006*    -------------------------------
  4007     05  FILLER            PIC  X(0003).
  4008     05  BUSERO PIC  X(0004).
  4009*    -------------------------------
  4010     05  FILLER            PIC  X(0003).
  4011     05  BMAINTO PIC  X(0001).
  4012*    -------------------------------
  4013     05  FILLER            PIC  X(0003).
  4014     05  BMANTBYO PIC  X(0004).
  4015*    -------------------------------
  4016     05  FILLER            PIC  X(0003).
  4017     05  BCHGHDGO PIC  X(0003).
  4018*    -------------------------------
  4019     05  FILLER            PIC  X(0003).
  4020     05  BMANTDTO PIC  X(0008).
  4021*    -------------------------------
  4022     05  FILLER            PIC  X(0003).
  4023     05  BMANTATO PIC  99.99.
  4024*    -------------------------------
  4025     05  FILLER            PIC  X(0003).
  4026     05  BCSRO PIC  X(0004).
  4027*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  77
* VP6311.cbl
  4028     05  FILLER            PIC  X(0003).
  4029     05  BBATCHO PIC  X(0006).
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BSEQO PIC  X(0004).
  4033*    -------------------------------
  4034     05  FILLER            PIC  X(0003).
  4035     05  BMOENDTO PIC  X(0008).
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BCARRO PIC  X(0001).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BGROUPO PIC  X(0006).
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BSTATEO PIC  X(0002).
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BACCTO PIC  X(0010).
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
  4050     05  BVINHO PIC  X(0004).
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BVINO PIC  X(0017).
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BREFHDGO PIC  X(0004).
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  BREFO PIC  X(0012).
  4060*    -------------------------------
  4061     05  FILLER            PIC  X(0003).
  4062     05  BAGEDEFO PIC  X(0004).
  4063*    -------------------------------
  4064     05  FILLER            PIC  X(0003).
  4065     05  BCERTNOO PIC  X(0010).
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BSUFIXO PIC  X(0001).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BEFFDTO PIC  X(0008).
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BLSTNMO PIC  X(0015).
  4075*    -------------------------------
  4076     05  FILLER            PIC  X(0003).
  4077     05  B1STNMO PIC  X(0010).
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  BINITO PIC  X(0001).
  4081*    -------------------------------
  4082     05  FILLER            PIC  X(0003).
  4083     05  BSEXO PIC  X(0001).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  78
* VP6311.cbl
  4086     05  BAGEO PIC  X(0002).
  4087*    -------------------------------
  4088     05  FILLER            PIC  X(0003).
  4089     05  BBIRTHO PIC  X(0008).
  4090*    -------------------------------
  4091     05  FILLER            PIC  X(0003).
  4092     05  BYEARO PIC  X(0004).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  BMAKEO PIC  X(0020).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BMODELO PIC  X(0020).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BFUTUREO PIC  X(0020).
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BOMETERO PIC  ZZZ,Z99.
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BMEMCAPO PIC  X(0011).
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BORIGHDO PIC  X(0010).
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BFORCEO PIC  X(0001).
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BENTRYO PIC  X(0001).
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
  4119     05  BREINO PIC  X(0001).
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
  4122     05  BBILCDO PIC  X(0001).
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  BUNWRITO PIC  X(0001).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  BSKPCDO PIC  X(0001).
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  BINDGRPO PIC  X(0001).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  BSIGO PIC  X(0001).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BRTCLSO PIC  X(0002).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BCHGCNTO PIC  X(0003).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BMEMBERO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  79
* VP6311.cbl
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BLNOFCRO PIC  X(0005).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BKIND1O PIC  X(0002).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BTYPE1O PIC  X(0003).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BTERM1O PIC  X(0003).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BBEN1O PIC  X(0012).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BPREM1O PIC  X(0011).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BEXPIR1O PIC  X(0008).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BCP1O PIC  X(0002).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BALTBN1O PIC  X(0012).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BALTPR1O PIC  X(0011).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BBNCD1O PIC  X(0003).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BCPRM1O PIC  X(0011).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BCAPRM1O PIC  X(0011).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BENABR1O PIC  X(0005).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BDIFF1O PIC  X(0011).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BBILIT1O PIC  X(0008).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BADIFF1O PIC  X(0011).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BKIND2O PIC  X(0002).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BTYPE2O PIC  X(0003).
  4201*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  80
* VP6311.cbl
  4202     05  FILLER            PIC  X(0003).
  4203     05  BTERM2O PIC  X(0003).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BBEN2O PIC  X(0012).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BPREM2O PIC  X(0011).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BEXPIR2O PIC  X(0008).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BCP2O PIC  X(0002).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BALTBN2O PIC  X(0012).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BALTPR2O PIC  X(0011).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BBNCD2O PIC  X(0003).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BCPRM2O PIC  X(0011).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BCAPRM2O PIC  X(0011).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BENABR2O PIC  X(0005).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BDIFF2O PIC  X(0011).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BBILIT2O PIC  X(0008).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BADIFF2O PIC  X(0011).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BERMSG1O PIC  X(0078).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BERMSG2O PIC  X(0078).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BERMSG3O PIC  X(0078).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BPFENTRO PIC  X(0002).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BPF5HDRO PIC  X(0005).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  81
* VP6311.cbl
  4260     05  BPF4HDRO PIC  X(0013).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BF15HDRO PIC  X(0010).
  4264*    -------------------------------
  4265 01  VP631CI REDEFINES VP631BI.
  4266     05  FILLER            PIC  X(0012).
  4267*    -------------------------------
  4268     05  CDATEL PIC S9(0004) COMP.
  4269     05  CDATEF PIC  X(0001).
  4270     05  FILLER REDEFINES CDATEF.
  4271         10  CDATEA PIC  X(0001).
  4272     05  CDATEI PIC  X(0008).
  4273*    -------------------------------
  4274     05  CTIMEL PIC S9(0004) COMP.
  4275     05  CTIMEF PIC  X(0001).
  4276     05  FILLER REDEFINES CTIMEF.
  4277         10  CTIMEA PIC  X(0001).
  4278     05  CTIMEI PIC  X(0005).
  4279*    -------------------------------
  4280     05  CHEADL PIC S9(0004) COMP.
  4281     05  CHEADF PIC  X(0001).
  4282     05  FILLER REDEFINES CHEADF.
  4283         10  CHEADA PIC  X(0001).
  4284     05  CHEADI PIC  X(0038).
  4285*    -------------------------------
  4286     05  CCHGTL PIC S9(0004) COMP.
  4287     05  CCHGTF PIC  X(0001).
  4288     05  FILLER REDEFINES CCHGTF.
  4289         10  CCHGTA PIC  X(0001).
  4290     05  CCHGTI PIC  X(0004).
  4291*    -------------------------------
  4292     05  CCHGL PIC S9(0004) COMP.
  4293     05  CCHGF PIC  X(0001).
  4294     05  FILLER REDEFINES CCHGF.
  4295         10  CCHGA PIC  X(0001).
  4296     05  CCHGI PIC  X(0004).
  4297*    -------------------------------
  4298     05  CMAINTL PIC S9(0004) COMP.
  4299     05  CMAINTF PIC  X(0001).
  4300     05  FILLER REDEFINES CMAINTF.
  4301         10  CMAINTA PIC  X(0001).
  4302     05  CMAINTI PIC  X(0001).
  4303*    -------------------------------
  4304     05  CMANTBYL PIC S9(0004) COMP.
  4305     05  CMANTBYF PIC  X(0001).
  4306     05  FILLER REDEFINES CMANTBYF.
  4307         10  CMANTBYA PIC  X(0001).
  4308     05  CMANTBYI PIC  X(0004).
  4309*    -------------------------------
  4310     05  CCHGHDGL PIC S9(0004) COMP.
  4311     05  CCHGHDGF PIC  X(0001).
  4312     05  FILLER REDEFINES CCHGHDGF.
  4313         10  CCHGHDGA PIC  X(0001).
  4314     05  CCHGHDGI PIC  X(0003).
  4315*    -------------------------------
  4316     05  CMANTDTL PIC S9(0004) COMP.
  4317     05  CMANTDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  82
* VP6311.cbl
  4318     05  FILLER REDEFINES CMANTDTF.
  4319         10  CMANTDTA PIC  X(0001).
  4320     05  CMANTDTI PIC  X(0008).
  4321*    -------------------------------
  4322     05  CMANTATL PIC S9(0004) COMP.
  4323     05  CMANTATF PIC  X(0001).
  4324     05  FILLER REDEFINES CMANTATF.
  4325         10  CMANTATA PIC  X(0001).
  4326     05  CMANTATI PIC  X(0005).
  4327*    -------------------------------
  4328     05  CCSRL PIC S9(0004) COMP.
  4329     05  CCSRF PIC  X(0001).
  4330     05  FILLER REDEFINES CCSRF.
  4331         10  CCSRA PIC  X(0001).
  4332     05  CCSRI PIC  X(0004).
  4333*    -------------------------------
  4334     05  CBATCHL PIC S9(0004) COMP.
  4335     05  CBATCHF PIC  X(0001).
  4336     05  FILLER REDEFINES CBATCHF.
  4337         10  CBATCHA PIC  X(0001).
  4338     05  CBATCHI PIC  X(0006).
  4339*    -------------------------------
  4340     05  CSEQL PIC S9(0004) COMP.
  4341     05  CSEQF PIC  X(0001).
  4342     05  FILLER REDEFINES CSEQF.
  4343         10  CSEQA PIC  X(0001).
  4344     05  CSEQI PIC  X(0004).
  4345*    -------------------------------
  4346     05  CMOENDTL PIC S9(0004) COMP.
  4347     05  CMOENDTF PIC  X(0001).
  4348     05  FILLER REDEFINES CMOENDTF.
  4349         10  CMOENDTA PIC  X(0001).
  4350     05  CMOENDTI PIC  X(0008).
  4351*    -------------------------------
  4352     05  CCARRL PIC S9(0004) COMP.
  4353     05  CCARRF PIC  X(0001).
  4354     05  FILLER REDEFINES CCARRF.
  4355         10  CCARRA PIC  X(0001).
  4356     05  CCARRI PIC  X(0001).
  4357*    -------------------------------
  4358     05  CGROUPL PIC S9(0004) COMP.
  4359     05  CGROUPF PIC  X(0001).
  4360     05  FILLER REDEFINES CGROUPF.
  4361         10  CGROUPA PIC  X(0001).
  4362     05  CGROUPI PIC  X(0006).
  4363*    -------------------------------
  4364     05  CSTATEL PIC S9(0004) COMP.
  4365     05  CSTATEF PIC  X(0001).
  4366     05  FILLER REDEFINES CSTATEF.
  4367         10  CSTATEA PIC  X(0001).
  4368     05  CSTATEI PIC  X(0002).
  4369*    -------------------------------
  4370     05  CACCTL PIC S9(0004) COMP.
  4371     05  CACCTF PIC  X(0001).
  4372     05  FILLER REDEFINES CACCTF.
  4373         10  CACCTA PIC  X(0001).
  4374     05  CACCTI PIC  X(0010).
  4375*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  83
* VP6311.cbl
  4376     05  CORIGHDL PIC S9(0004) COMP.
  4377     05  CORIGHDF PIC  X(0001).
  4378     05  FILLER REDEFINES CORIGHDF.
  4379         10  CORIGHDA PIC  X(0001).
  4380     05  CORIGHDI PIC  X(0011).
  4381*    -------------------------------
  4382     05  CORGNOL PIC S9(0004) COMP.
  4383     05  CORGNOF PIC  X(0001).
  4384     05  FILLER REDEFINES CORGNOF.
  4385         10  CORGNOA PIC  X(0001).
  4386     05  CORGNOI PIC  X(0006).
  4387*    -------------------------------
  4388     05  CORGSEQL PIC S9(0004) COMP.
  4389     05  CORGSEQF PIC  X(0001).
  4390     05  FILLER REDEFINES CORGSEQF.
  4391         10  CORGSEQA PIC  X(0001).
  4392     05  CORGSEQI PIC  X(0004).
  4393*    -------------------------------
  4394     05  CREFHDGL PIC S9(0004) COMP.
  4395     05  CREFHDGF PIC  X(0001).
  4396     05  FILLER REDEFINES CREFHDGF.
  4397         10  CREFHDGA PIC  X(0001).
  4398     05  CREFHDGI PIC  X(0010).
  4399*    -------------------------------
  4400     05  CREFL PIC S9(0004) COMP.
  4401     05  CREFF PIC  X(0001).
  4402     05  FILLER REDEFINES CREFF.
  4403         10  CREFA PIC  X(0001).
  4404     05  CREFI PIC  X(0012).
  4405*    -------------------------------
  4406     05  CNHINTL PIC S9(0004) COMP.
  4407     05  CNHINTF PIC  X(0001).
  4408     05  FILLER REDEFINES CNHINTF.
  4409         10  CNHINTA PIC  X(0001).
  4410     05  CNHINTI PIC  9(7)V99.
  4411*    -------------------------------
  4412     05  CCERTNOL PIC S9(0004) COMP.
  4413     05  CCERTNOF PIC  X(0001).
  4414     05  FILLER REDEFINES CCERTNOF.
  4415         10  CCERTNOA PIC  X(0001).
  4416     05  CCERTNOI PIC  X(0010).
  4417*    -------------------------------
  4418     05  CSUFIXL PIC S9(0004) COMP.
  4419     05  CSUFIXF PIC  X(0001).
  4420     05  FILLER REDEFINES CSUFIXF.
  4421         10  CSUFIXA PIC  X(0001).
  4422     05  CSUFIXI PIC  X(0001).
  4423*    -------------------------------
  4424     05  CEFFDTL PIC S9(0004) COMP.
  4425     05  CEFFDTF PIC  X(0001).
  4426     05  FILLER REDEFINES CEFFDTF.
  4427         10  CEFFDTA PIC  X(0001).
  4428     05  CEFFDTI PIC  X(0008).
  4429*    -------------------------------
  4430     05  CLSTNML PIC S9(0004) COMP.
  4431     05  CLSTNMF PIC  X(0001).
  4432     05  FILLER REDEFINES CLSTNMF.
  4433         10  CLSTNMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  84
* VP6311.cbl
  4434     05  CLSTNMI PIC  X(0015).
  4435*    -------------------------------
  4436     05  CPCYNL PIC S9(0004) COMP.
  4437     05  CPCYNF PIC  X(0001).
  4438     05  FILLER REDEFINES CPCYNF.
  4439         10  CPCYNA PIC  X(0001).
  4440     05  CPCYNI PIC  X(0001).
  4441*    -------------------------------
  4442     05  CINAMEL PIC S9(0004) COMP.
  4443     05  CINAMEF PIC  X(0001).
  4444     05  FILLER REDEFINES CINAMEF.
  4445         10  CINAMEA PIC  X(0001).
  4446     05  CINAMEI PIC  X(0015).
  4447*    -------------------------------
  4448     05  CINITSL PIC S9(0004) COMP.
  4449     05  CINITSF PIC  X(0001).
  4450     05  FILLER REDEFINES CINITSF.
  4451         10  CINITSA PIC  X(0001).
  4452     05  CINITSI PIC  X(0010).
  4453*    -------------------------------
  4454     05  CCANREAL PIC S9(0004) COMP.
  4455     05  CCANREAF PIC  X(0001).
  4456     05  FILLER REDEFINES CCANREAF.
  4457         10  CCANREAA PIC  X(0001).
  4458     05  CCANREAI PIC  X(0001).
  4459*    -------------------------------
  4460     05  CKIND1L PIC S9(0004) COMP.
  4461     05  CKIND1F PIC  X(0001).
  4462     05  FILLER REDEFINES CKIND1F.
  4463         10  CKIND1A PIC  X(0001).
  4464     05  CKIND1I PIC  X(0002).
  4465*    -------------------------------
  4466     05  CCANDT1L PIC S9(0004) COMP.
  4467     05  CCANDT1F PIC  X(0001).
  4468     05  FILLER REDEFINES CCANDT1F.
  4469         10  CCANDT1A PIC  X(0001).
  4470     05  CCANDT1I PIC  X(0008).
  4471*    -------------------------------
  4472     05  CREFND1L PIC S9(0004) COMP.
  4473     05  CREFND1F PIC  X(0001).
  4474     05  FILLER REDEFINES CREFND1F.
  4475         10  CREFND1A PIC  X(0001).
  4476     05  CREFND1I PIC  S9(9)V99.
  4477*    -------------------------------
  4478     05  CMTHD1L PIC S9(0004) COMP.
  4479     05  CMTHD1F PIC  X(0001).
  4480     05  FILLER REDEFINES CMTHD1F.
  4481         10  CMTHD1A PIC  X(0001).
  4482     05  CMTHD1I PIC  X(0001).
  4483*    -------------------------------
  4484     05  CKIND2L PIC S9(0004) COMP.
  4485     05  CKIND2F PIC  X(0001).
  4486     05  FILLER REDEFINES CKIND2F.
  4487         10  CKIND2A PIC  X(0001).
  4488     05  CKIND2I PIC  X(0002).
  4489*    -------------------------------
  4490     05  CCANDT2L PIC S9(0004) COMP.
  4491     05  CCANDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  85
* VP6311.cbl
  4492     05  FILLER REDEFINES CCANDT2F.
  4493         10  CCANDT2A PIC  X(0001).
  4494     05  CCANDT2I PIC  X(0008).
  4495*    -------------------------------
  4496     05  CREFND2L PIC S9(0004) COMP.
  4497     05  CREFND2F PIC  X(0001).
  4498     05  FILLER REDEFINES CREFND2F.
  4499         10  CREFND2A PIC  X(0001).
  4500     05  CREFND2I PIC  S9(9)V99.
  4501*    -------------------------------
  4502     05  CMTHD2L PIC S9(0004) COMP.
  4503     05  CMTHD2F PIC  X(0001).
  4504     05  FILLER REDEFINES CMTHD2F.
  4505         10  CMTHD2A PIC  X(0001).
  4506     05  CMTHD2I PIC  X(0001).
  4507*    -------------------------------
  4508     05  CLIVESL PIC S9(0004) COMP.
  4509     05  CLIVESF PIC  X(0001).
  4510     05  FILLER REDEFINES CLIVESF.
  4511         10  CLIVESA PIC  X(0001).
  4512     05  CLIVESI PIC  X(0003).
  4513*    -------------------------------
  4514     05  CFORCEL PIC S9(0004) COMP.
  4515     05  CFORCEF PIC  X(0001).
  4516     05  FILLER REDEFINES CFORCEF.
  4517         10  CFORCEA PIC  X(0001).
  4518     05  CFORCEI PIC  X(0001).
  4519*    -------------------------------
  4520     05  CBILCDL PIC S9(0004) COMP.
  4521     05  CBILCDF PIC  X(0001).
  4522     05  FILLER REDEFINES CBILCDF.
  4523         10  CBILCDA PIC  X(0001).
  4524     05  CBILCDI PIC  X(0001).
  4525*    -------------------------------
  4526     05  CCRFND1L PIC S9(0004) COMP.
  4527     05  CCRFND1F PIC  X(0001).
  4528     05  FILLER REDEFINES CCRFND1F.
  4529         10  CCRFND1A PIC  X(0001).
  4530     05  CCRFND1I PIC  X(0011).
  4531*    -------------------------------
  4532     05  CCRFND2L PIC S9(0004) COMP.
  4533     05  CCRFND2F PIC  X(0001).
  4534     05  FILLER REDEFINES CCRFND2F.
  4535         10  CCRFND2A PIC  X(0001).
  4536     05  CCRFND2I PIC  X(0011).
  4537*    -------------------------------
  4538     05  CBILIT1L PIC S9(0004) COMP.
  4539     05  CBILIT1F PIC  X(0001).
  4540     05  FILLER REDEFINES CBILIT1F.
  4541         10  CBILIT1A PIC  X(0001).
  4542     05  CBILIT1I PIC  X(0008).
  4543*    -------------------------------
  4544     05  CDRFND1L PIC S9(0004) COMP.
  4545     05  CDRFND1F PIC  X(0001).
  4546     05  FILLER REDEFINES CDRFND1F.
  4547         10  CDRFND1A PIC  X(0001).
  4548     05  CDRFND1I PIC  X(0011).
  4549*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  86
* VP6311.cbl
  4550     05  CBILIT2L PIC S9(0004) COMP.
  4551     05  CBILIT2F PIC  X(0001).
  4552     05  FILLER REDEFINES CBILIT2F.
  4553         10  CBILIT2A PIC  X(0001).
  4554     05  CBILIT2I PIC  X(0008).
  4555*    -------------------------------
  4556     05  CDRFND2L PIC S9(0004) COMP.
  4557     05  CDRFND2F PIC  X(0001).
  4558     05  FILLER REDEFINES CDRFND2F.
  4559         10  CDRFND2A PIC  X(0001).
  4560     05  CDRFND2I PIC  X(0011).
  4561*    -------------------------------
  4562     05  CCANTXTL PIC S9(0004) COMP.
  4563     05  CCANTXTF PIC  X(0001).
  4564     05  FILLER REDEFINES CCANTXTF.
  4565         10  CCANTXTA PIC  X(0001).
  4566     05  CCANTXTI PIC  X(0005).
  4567*    -------------------------------
  4568     05  CCANFEEL PIC S9(0004) COMP.
  4569     05  CCANFEEF PIC  X(0001).
  4570     05  FILLER REDEFINES CCANFEEF.
  4571         10  CCANFEEA PIC  X(0001).
  4572     05  CCANFEEI PIC  X(0002).
  4573*    -------------------------------
  4574     05  CTERM1L PIC S9(0004) COMP.
  4575     05  CTERM1F PIC  X(0001).
  4576     05  FILLER REDEFINES CTERM1F.
  4577         10  CTERM1A PIC  X(0001).
  4578     05  CTERM1I PIC  X(0003).
  4579*    -------------------------------
  4580     05  CRTERM1L PIC S9(0004) COMP.
  4581     05  CRTERM1F PIC  X(0001).
  4582     05  FILLER REDEFINES CRTERM1F.
  4583         10  CRTERM1A PIC  X(0001).
  4584     05  CRTERM1I PIC  X(0003).
  4585*    -------------------------------
  4586     05  CPREM1L PIC S9(0004) COMP.
  4587     05  CPREM1F PIC  X(0001).
  4588     05  FILLER REDEFINES CPREM1F.
  4589         10  CPREM1A PIC  X(0001).
  4590     05  CPREM1I PIC  X(0011).
  4591*    -------------------------------
  4592     05  CTERM2L PIC S9(0004) COMP.
  4593     05  CTERM2F PIC  X(0001).
  4594     05  FILLER REDEFINES CTERM2F.
  4595         10  CTERM2A PIC  X(0001).
  4596     05  CTERM2I PIC  X(0003).
  4597*    -------------------------------
  4598     05  CRTERM2L PIC S9(0004) COMP.
  4599     05  CRTERM2F PIC  X(0001).
  4600     05  FILLER REDEFINES CRTERM2F.
  4601         10  CRTERM2A PIC  X(0001).
  4602     05  CRTERM2I PIC  X(0003).
  4603*    -------------------------------
  4604     05  CPREM2L PIC S9(0004) COMP.
  4605     05  CPREM2F PIC  X(0001).
  4606     05  FILLER REDEFINES CPREM2F.
  4607         10  CPREM2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  87
* VP6311.cbl
  4608     05  CPREM2I PIC  X(0011).
  4609*    -------------------------------
  4610     05  CENTRDTL PIC S9(0004) COMP.
  4611     05  CENTRDTF PIC  X(0001).
  4612     05  FILLER REDEFINES CENTRDTF.
  4613         10  CENTRDTA PIC  X(0001).
  4614     05  CENTRDTI PIC  X(0008).
  4615*    -------------------------------
  4616     05  CPAYEEL PIC S9(0004) COMP.
  4617     05  CPAYEEF PIC  X(0001).
  4618     05  FILLER REDEFINES CPAYEEF.
  4619         10  CPAYEEA PIC  X(0001).
  4620     05  CPAYEEI PIC  X(0006).
  4621*    -------------------------------
  4622     05  CRFNDSWL PIC S9(0004) COMP.
  4623     05  CRFNDSWF PIC  X(0001).
  4624     05  FILLER REDEFINES CRFNDSWF.
  4625         10  CRFNDSWA PIC  X(0001).
  4626     05  CRFNDSWI PIC  X(0003).
  4627*    -------------------------------
  4628     05  CLFHDGL PIC S9(0004) COMP.
  4629     05  CLFHDGF PIC  X(0001).
  4630     05  FILLER REDEFINES CLFHDGF.
  4631         10  CLFHDGA PIC  X(0001).
  4632     05  CLFHDGI PIC  X(0006).
  4633*    -------------------------------
  4634     05  CAHHDGL PIC S9(0004) COMP.
  4635     05  CAHHDGF PIC  X(0001).
  4636     05  FILLER REDEFINES CAHHDGF.
  4637         10  CAHHDGA PIC  X(0001).
  4638     05  CAHHDGI PIC  X(0006).
  4639*    -------------------------------
  4640     05  CENTDTL PIC S9(0004) COMP.
  4641     05  CENTDTF PIC  X(0001).
  4642     05  FILLER REDEFINES CENTDTF.
  4643         10  CENTDTA PIC  X(0001).
  4644     05  CENTDTI PIC  X(0008).
  4645*    -------------------------------
  4646     05  CENTBYL PIC S9(0004) COMP.
  4647     05  CENTBYF PIC  X(0001).
  4648     05  FILLER REDEFINES CENTBYF.
  4649         10  CENTBYA PIC  X(0001).
  4650     05  CENTBYI PIC  X(0004).
  4651*    -------------------------------
  4652     05  CCHGCNTL PIC S9(0004) COMP.
  4653     05  CCHGCNTF PIC  X(0001).
  4654     05  FILLER REDEFINES CCHGCNTF.
  4655         10  CCHGCNTA PIC  X(0001).
  4656     05  CCHGCNTI PIC  X(0003).
  4657*    -------------------------------
  4658     05  CLFREFNL PIC S9(0004) COMP.
  4659     05  CLFREFNF PIC  X(0001).
  4660     05  FILLER REDEFINES CLFREFNF.
  4661         10  CLFREFNA PIC  X(0001).
  4662     05  CLFREFNI PIC  X(0006).
  4663*    -------------------------------
  4664     05  CAHREFNL PIC S9(0004) COMP.
  4665     05  CAHREFNF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  88
* VP6311.cbl
  4666     05  FILLER REDEFINES CAHREFNF.
  4667         10  CAHREFNA PIC  X(0001).
  4668     05  CAHREFNI PIC  X(0006).
  4669*    -------------------------------
  4670     05  CREINCDL PIC S9(0004) COMP.
  4671     05  CREINCDF PIC  X(0001).
  4672     05  FILLER REDEFINES CREINCDF.
  4673         10  CREINCDA PIC  X(0001).
  4674     05  CREINCDI PIC  X(0003).
  4675*    -------------------------------
  4676     05  CAEFFDTL PIC S9(0004) COMP.
  4677     05  CAEFFDTF PIC  X(0001).
  4678     05  FILLER REDEFINES CAEFFDTF.
  4679         10  CAEFFDTA PIC  X(0001).
  4680     05  CAEFFDTI PIC  X(0008).
  4681*    -------------------------------
  4682     05  CAEXPDTL PIC S9(0004) COMP.
  4683     05  CAEXPDTF PIC  X(0001).
  4684     05  FILLER REDEFINES CAEXPDTF.
  4685         10  CAEXPDTA PIC  X(0001).
  4686     05  CAEXPDTI PIC  X(0008).
  4687*    -------------------------------
  4688     05  COMMLFL PIC S9(0004) COMP.
  4689     05  COMMLFF PIC  X(0001).
  4690     05  FILLER REDEFINES COMMLFF.
  4691         10  COMMLFA PIC  X(0001).
  4692     05  COMMLFI PIC  X(0006).
  4693*    -------------------------------
  4694     05  COMMAHL PIC S9(0004) COMP.
  4695     05  COMMAHF PIC  X(0001).
  4696     05  FILLER REDEFINES COMMAHF.
  4697         10  COMMAHA PIC  X(0001).
  4698     05  COMMAHI PIC  X(0006).
  4699*    -------------------------------
  4700     05  CERMSG1L PIC S9(0004) COMP.
  4701     05  CERMSG1F PIC  X(0001).
  4702     05  FILLER REDEFINES CERMSG1F.
  4703         10  CERMSG1A PIC  X(0001).
  4704     05  CERMSG1I PIC  X(0078).
  4705*    -------------------------------
  4706     05  CERMSG2L PIC S9(0004) COMP.
  4707     05  CERMSG2F PIC  X(0001).
  4708     05  FILLER REDEFINES CERMSG2F.
  4709         10  CERMSG2A PIC  X(0001).
  4710     05  CERMSG2I PIC  X(0078).
  4711*    -------------------------------
  4712     05  CERMSG3L PIC S9(0004) COMP.
  4713     05  CERMSG3F PIC  X(0001).
  4714     05  FILLER REDEFINES CERMSG3F.
  4715         10  CERMSG3A PIC  X(0001).
  4716     05  CERMSG3I PIC  X(0078).
  4717*    -------------------------------
  4718     05  CPFENTRL PIC S9(0004) COMP.
  4719     05  CPFENTRF PIC  X(0001).
  4720     05  FILLER REDEFINES CPFENTRF.
  4721         10  CPFENTRA PIC  X(0001).
  4722     05  CPFENTRI PIC  9(2).
  4723*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  89
* VP6311.cbl
  4724     05  CPF5HDRL PIC S9(0004) COMP.
  4725     05  CPF5HDRF PIC  X(0001).
  4726     05  FILLER REDEFINES CPF5HDRF.
  4727         10  CPF5HDRA PIC  X(0001).
  4728     05  CPF5HDRI PIC  X(0005).
  4729*    -------------------------------
  4730     05  CPF4HDRL PIC S9(0004) COMP.
  4731     05  CPF4HDRF PIC  X(0001).
  4732     05  FILLER REDEFINES CPF4HDRF.
  4733         10  CPF4HDRA PIC  X(0001).
  4734     05  CPF4HDRI PIC  X(0013).
  4735*    -------------------------------
  4736     05  CF15HDRL PIC S9(0004) COMP.
  4737     05  CF15HDRF PIC  X(0001).
  4738     05  FILLER REDEFINES CF15HDRF.
  4739         10  CF15HDRA PIC  X(0001).
  4740     05  CF15HDRI PIC  X(0022).
  4741 01  VP631CO REDEFINES VP631BI.
  4742     05  FILLER            PIC  X(0012).
  4743*    -------------------------------
  4744     05  FILLER            PIC  X(0003).
  4745     05  CDATEO PIC  X(0008).
  4746*    -------------------------------
  4747     05  FILLER            PIC  X(0003).
  4748     05  CTIMEO PIC  99.99.
  4749*    -------------------------------
  4750     05  FILLER            PIC  X(0003).
  4751     05  CHEADO PIC  X(0038).
  4752*    -------------------------------
  4753     05  FILLER            PIC  X(0003).
  4754     05  CCHGTO PIC  X(0004).
  4755*    -------------------------------
  4756     05  FILLER            PIC  X(0003).
  4757     05  CCHGO PIC  ZZZ9.
  4758*    -------------------------------
  4759     05  FILLER            PIC  X(0003).
  4760     05  CMAINTO PIC  X(0001).
  4761*    -------------------------------
  4762     05  FILLER            PIC  X(0003).
  4763     05  CMANTBYO PIC  X(0004).
  4764*    -------------------------------
  4765     05  FILLER            PIC  X(0003).
  4766     05  CCHGHDGO PIC  X(0003).
  4767*    -------------------------------
  4768     05  FILLER            PIC  X(0003).
  4769     05  CMANTDTO PIC  X(0008).
  4770*    -------------------------------
  4771     05  FILLER            PIC  X(0003).
  4772     05  CMANTATO PIC  99.99.
  4773*    -------------------------------
  4774     05  FILLER            PIC  X(0003).
  4775     05  CCSRO PIC  X(0004).
  4776*    -------------------------------
  4777     05  FILLER            PIC  X(0003).
  4778     05  CBATCHO PIC  X(0006).
  4779*    -------------------------------
  4780     05  FILLER            PIC  X(0003).
  4781     05  CSEQO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  90
* VP6311.cbl
  4782*    -------------------------------
  4783     05  FILLER            PIC  X(0003).
  4784     05  CMOENDTO PIC  X(0008).
  4785*    -------------------------------
  4786     05  FILLER            PIC  X(0003).
  4787     05  CCARRO PIC  X(0001).
  4788*    -------------------------------
  4789     05  FILLER            PIC  X(0003).
  4790     05  CGROUPO PIC  X(0006).
  4791*    -------------------------------
  4792     05  FILLER            PIC  X(0003).
  4793     05  CSTATEO PIC  X(0002).
  4794*    -------------------------------
  4795     05  FILLER            PIC  X(0003).
  4796     05  CACCTO PIC  X(0010).
  4797*    -------------------------------
  4798     05  FILLER            PIC  X(0003).
  4799     05  CORIGHDO PIC  X(0011).
  4800*    -------------------------------
  4801     05  FILLER            PIC  X(0003).
  4802     05  CORGNOO PIC  X(0006).
  4803*    -------------------------------
  4804     05  FILLER            PIC  X(0003).
  4805     05  CORGSEQO PIC  X(0004).
  4806*    -------------------------------
  4807     05  FILLER            PIC  X(0003).
  4808     05  CREFHDGO PIC  X(0010).
  4809*    -------------------------------
  4810     05  FILLER            PIC  X(0003).
  4811     05  CREFO PIC  X(0012).
  4812*    -------------------------------
  4813     05  FILLER            PIC  X(0003).
  4814     05  CNHINTO PIC  999999.99.
  4815*    -------------------------------
  4816     05  FILLER            PIC  X(0003).
  4817     05  CCERTNOO PIC  X(0010).
  4818*    -------------------------------
  4819     05  FILLER            PIC  X(0003).
  4820     05  CSUFIXO PIC  X(0001).
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  CEFFDTO PIC  X(0008).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CLSTNMO PIC  X(0015).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CPCYNO PIC  X(0001).
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  CINAMEO PIC  X(0015).
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CINITSO PIC  X(0010).
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CCANREAO PIC  X(0001).
  4839*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  91
* VP6311.cbl
  4840     05  FILLER            PIC  X(0003).
  4841     05  CKIND1O PIC  X(0002).
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CCANDT1O PIC  X(0008).
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  CREFND1O PIC  Z(7).99-.
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CMTHD1O PIC  X(0001).
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CKIND2O PIC  X(0002).
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CCANDT2O PIC  X(0008).
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CREFND2O PIC  Z(7).99-.
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  CMTHD2O PIC  X(0001).
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CLIVESO PIC  X(0003).
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CFORCEO PIC  X(0001).
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CBILCDO PIC  X(0001).
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  CCRFND1O PIC  Z(7).99-.
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  CCRFND2O PIC  Z(7).99-.
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CBILIT1O PIC  X(0008).
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CDRFND1O PIC  Z(7).99-.
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CBILIT2O PIC  X(0008).
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
  4889     05  CDRFND2O PIC  Z(7).99-.
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CCANTXTO PIC  X(0005).
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  CCANFEEO PIC  Z9.
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  92
* VP6311.cbl
  4898     05  CTERM1O PIC  ZZ9.
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  CRTERM1O PIC  ZZ9.
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
  4904     05  CPREM1O PIC  ZZZZZZ9.99-.
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CTERM2O PIC  ZZ9.
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  CRTERM2O PIC  ZZ9.
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  CPREM2O PIC  ZZZZZZ9.99-.
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CENTRDTO PIC  X(0008).
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CPAYEEO PIC  X(0006).
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CRFNDSWO PIC  X(0003).
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CLFHDGO PIC  X(0006).
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CAHHDGO PIC  X(0006).
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  CENTDTO PIC  X(0008).
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CENTBYO PIC  X(0004).
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  CCHGCNTO PIC  X(0003).
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  CLFREFNO PIC  X(0006).
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CAHREFNO PIC  X(0006).
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  CREINCDO PIC  X(0003).
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CAEFFDTO PIC  X(0008).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CAEXPDTO PIC  X(0008).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  COMMLFO PIC  .99999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  93
* VP6311.cbl
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  COMMAHO PIC  .99999.
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CERMSG1O PIC  X(0078).
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CERMSG2O PIC  X(0078).
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CERMSG3O PIC  X(0078).
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CPFENTRO PIC  X(0002).
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CPF5HDRO PIC  X(0005).
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CPF4HDRO PIC  X(0013).
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CF15HDRO PIC  X(0022).
  4980*    -------------------------------
  4981 01  VP631DI REDEFINES VP631BI.
  4982     05  FILLER            PIC  X(0012).
  4983*    -------------------------------
  4984     05  DDATEL PIC S9(0004) COMP.
  4985     05  DDATEF PIC  X(0001).
  4986     05  FILLER REDEFINES DDATEF.
  4987         10  DDATEA PIC  X(0001).
  4988     05  DDATEI PIC  X(0008).
  4989*    -------------------------------
  4990     05  DTIMEL PIC S9(0004) COMP.
  4991     05  DTIMEF PIC  X(0001).
  4992     05  FILLER REDEFINES DTIMEF.
  4993         10  DTIMEA PIC  X(0001).
  4994     05  DTIMEI PIC  X(0005).
  4995*    -------------------------------
  4996     05  DHEADL PIC S9(0004) COMP.
  4997     05  DHEADF PIC  X(0001).
  4998     05  FILLER REDEFINES DHEADF.
  4999         10  DHEADA PIC  X(0001).
  5000     05  DHEADI PIC  X(0038).
  5001*    -------------------------------
  5002     05  DLDATEL PIC S9(0004) COMP.
  5003     05  DLDATEF PIC  X(0001).
  5004     05  FILLER REDEFINES DLDATEF.
  5005         10  DLDATEA PIC  X(0001).
  5006     05  DLDATEI PIC  X(0010).
  5007*    -------------------------------
  5008     05  DBATCHL PIC S9(0004) COMP.
  5009     05  DBATCHF PIC  X(0001).
  5010     05  FILLER REDEFINES DBATCHF.
  5011         10  DBATCHA PIC  X(0001).
  5012     05  DBATCHI PIC  X(0011).
  5013*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  94
* VP6311.cbl
  5014     05  DACCTNML PIC S9(0004) COMP.
  5015     05  DACCTNMF PIC  X(0001).
  5016     05  FILLER REDEFINES DACCTNMF.
  5017         10  DACCTNMA PIC  X(0001).
  5018     05  DACCTNMI PIC  X(0030).
  5019*    -------------------------------
  5020     05  DPROCDTL PIC S9(0004) COMP.
  5021     05  DPROCDTF PIC  X(0001).
  5022     05  FILLER REDEFINES DPROCDTF.
  5023         10  DPROCDTA PIC  X(0001).
  5024     05  DPROCDTI PIC  X(0008).
  5025*    -------------------------------
  5026     05  DINPUTL PIC S9(0004) COMP.
  5027     05  DINPUTF PIC  X(0001).
  5028     05  FILLER REDEFINES DINPUTF.
  5029         10  DINPUTA PIC  X(0001).
  5030     05  DINPUTI PIC  X(0008).
  5031*    -------------------------------
  5032     05  DMAINDTL PIC S9(0004) COMP.
  5033     05  DMAINDTF PIC  X(0001).
  5034     05  FILLER REDEFINES DMAINDTF.
  5035         10  DMAINDTA PIC  X(0001).
  5036     05  DMAINDTI PIC  X(0008).
  5037*    -------------------------------
  5038     05  DCARRL PIC S9(0004) COMP.
  5039     05  DCARRF PIC  X(0001).
  5040     05  FILLER REDEFINES DCARRF.
  5041         10  DCARRA PIC  X(0001).
  5042     05  DCARRI PIC  X(0001).
  5043*    -------------------------------
  5044     05  DGROUPL PIC S9(0004) COMP.
  5045     05  DGROUPF PIC  X(0001).
  5046     05  FILLER REDEFINES DGROUPF.
  5047         10  DGROUPA PIC  X(0001).
  5048     05  DGROUPI PIC  X(0006).
  5049*    -------------------------------
  5050     05  DSTATEL PIC S9(0004) COMP.
  5051     05  DSTATEF PIC  X(0001).
  5052     05  FILLER REDEFINES DSTATEF.
  5053         10  DSTATEA PIC  X(0001).
  5054     05  DSTATEI PIC  X(0002).
  5055*    -------------------------------
  5056     05  DACCTL PIC S9(0004) COMP.
  5057     05  DACCTF PIC  X(0001).
  5058     05  FILLER REDEFINES DACCTF.
  5059         10  DACCTA PIC  X(0001).
  5060     05  DACCTI PIC  X(0010).
  5061*    -------------------------------
  5062     05  DRECVDTL PIC S9(0004) COMP.
  5063     05  DRECVDTF PIC  X(0001).
  5064     05  FILLER REDEFINES DRECVDTF.
  5065         10  DRECVDTA PIC  X(0001).
  5066     05  DRECVDTI PIC  X(0008).
  5067*    -------------------------------
  5068     05  DCSRL PIC S9(0004) COMP.
  5069     05  DCSRF PIC  X(0001).
  5070     05  FILLER REDEFINES DCSRF.
  5071         10  DCSRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  95
* VP6311.cbl
  5072     05  DCSRI PIC  X(0004).
  5073*    -------------------------------
  5074     05  DREFHDGL PIC S9(0004) COMP.
  5075     05  DREFHDGF PIC  X(0001).
  5076     05  FILLER REDEFINES DREFHDGF.
  5077         10  DREFHDGA PIC  X(0001).
  5078     05  DREFHDGI PIC  X(0010).
  5079*    -------------------------------
  5080     05  DREFL PIC S9(0004) COMP.
  5081     05  DREFF PIC  X(0001).
  5082     05  FILLER REDEFINES DREFF.
  5083         10  DREFA PIC  X(0001).
  5084     05  DREFI PIC  X(0012).
  5085*    -------------------------------
  5086     05  DLFPHDGL PIC S9(0004) COMP.
  5087     05  DLFPHDGF PIC  X(0001).
  5088     05  FILLER REDEFINES DLFPHDGF.
  5089         10  DLFPHDGA PIC  X(0001).
  5090     05  DLFPHDGI PIC  X(0010).
  5091*    -------------------------------
  5092     05  DAHPHDGL PIC S9(0004) COMP.
  5093     05  DAHPHDGF PIC  X(0001).
  5094     05  FILLER REDEFINES DAHPHDGF.
  5095         10  DAHPHDGA PIC  X(0001).
  5096     05  DAHPHDGI PIC  X(0010).
  5097*    -------------------------------
  5098     05  DLFRHDGL PIC S9(0004) COMP.
  5099     05  DLFRHDGF PIC  X(0001).
  5100     05  FILLER REDEFINES DLFRHDGF.
  5101         10  DLFRHDGA PIC  X(0001).
  5102     05  DLFRHDGI PIC  X(0009).
  5103*    -------------------------------
  5104     05  DAHRHDGL PIC S9(0004) COMP.
  5105     05  DAHRHDGF PIC  X(0001).
  5106     05  FILLER REDEFINES DAHRHDGF.
  5107         10  DAHRHDGA PIC  X(0001).
  5108     05  DAHRHDGI PIC  X(0009).
  5109*    -------------------------------
  5110     05  DRISSL PIC S9(0004) COMP.
  5111     05  DRISSF PIC  X(0001).
  5112     05  FILLER REDEFINES DRISSF.
  5113         10  DRISSA PIC  X(0001).
  5114     05  DRISSI PIC  X(0005).
  5115*    -------------------------------
  5116     05  DRLFPRML PIC S9(0004) COMP.
  5117     05  DRLFPRMF PIC  X(0001).
  5118     05  FILLER REDEFINES DRLFPRMF.
  5119         10  DRLFPRMA PIC  X(0001).
  5120     05  DRLFPRMI PIC  S9(9)V99.
  5121*    -------------------------------
  5122     05  DRAHPRML PIC S9(0004) COMP.
  5123     05  DRAHPRMF PIC  X(0001).
  5124     05  FILLER REDEFINES DRAHPRMF.
  5125         10  DRAHPRMA PIC  X(0001).
  5126     05  DRAHPRMI PIC  S9(9)V99.
  5127*    -------------------------------
  5128     05  DRCANCL PIC S9(0004) COMP.
  5129     05  DRCANCF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  96
* VP6311.cbl
  5130     05  FILLER REDEFINES DRCANCF.
  5131         10  DRCANCA PIC  X(0001).
  5132     05  DRCANCI PIC  X(0005).
  5133*    -------------------------------
  5134     05  DRLFRFDL PIC S9(0004) COMP.
  5135     05  DRLFRFDF PIC  X(0001).
  5136     05  FILLER REDEFINES DRLFRFDF.
  5137         10  DRLFRFDA PIC  X(0001).
  5138     05  DRLFRFDI PIC  S9(9)V99.
  5139*    -------------------------------
  5140     05  DRAHRFDL PIC S9(0004) COMP.
  5141     05  DRAHRFDF PIC  X(0001).
  5142     05  FILLER REDEFINES DRAHRFDF.
  5143         10  DRAHRFDA PIC  X(0001).
  5144     05  DRAHRFDI PIC  S9(9)V99.
  5145*    -------------------------------
  5146     05  DEISSL PIC S9(0004) COMP.
  5147     05  DEISSF PIC  X(0001).
  5148     05  FILLER REDEFINES DEISSF.
  5149         10  DEISSA PIC  X(0001).
  5150     05  DEISSI PIC  X(0005).
  5151*    -------------------------------
  5152     05  DELFPRML PIC S9(0004) COMP.
  5153     05  DELFPRMF PIC  X(0001).
  5154     05  FILLER REDEFINES DELFPRMF.
  5155         10  DELFPRMA PIC  X(0001).
  5156     05  DELFPRMI PIC  X(0011).
  5157*    -------------------------------
  5158     05  DEAHPRML PIC S9(0004) COMP.
  5159     05  DEAHPRMF PIC  X(0001).
  5160     05  FILLER REDEFINES DEAHPRMF.
  5161         10  DEAHPRMA PIC  X(0001).
  5162     05  DEAHPRMI PIC  X(0011).
  5163*    -------------------------------
  5164     05  DECANCL PIC S9(0004) COMP.
  5165     05  DECANCF PIC  X(0001).
  5166     05  FILLER REDEFINES DECANCF.
  5167         10  DECANCA PIC  X(0001).
  5168     05  DECANCI PIC  X(0005).
  5169*    -------------------------------
  5170     05  DELFRFDL PIC S9(0004) COMP.
  5171     05  DELFRFDF PIC  X(0001).
  5172     05  FILLER REDEFINES DELFRFDF.
  5173         10  DELFRFDA PIC  X(0001).
  5174     05  DELFRFDI PIC  X(0011).
  5175*    -------------------------------
  5176     05  DEAHRFDL PIC S9(0004) COMP.
  5177     05  DEAHRFDF PIC  X(0001).
  5178     05  FILLER REDEFINES DEAHRFDF.
  5179         10  DEAHRFDA PIC  X(0001).
  5180     05  DEAHRFDI PIC  X(0011).
  5181*    -------------------------------
  5182     05  DCISSL PIC S9(0004) COMP.
  5183     05  DCISSF PIC  X(0001).
  5184     05  FILLER REDEFINES DCISSF.
  5185         10  DCISSA PIC  X(0001).
  5186     05  DCISSI PIC  X(0005).
  5187*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  97
* VP6311.cbl
  5188     05  DCLFPRML PIC S9(0004) COMP.
  5189     05  DCLFPRMF PIC  X(0001).
  5190     05  FILLER REDEFINES DCLFPRMF.
  5191         10  DCLFPRMA PIC  X(0001).
  5192     05  DCLFPRMI PIC  X(0011).
  5193*    -------------------------------
  5194     05  DCAHPRML PIC S9(0004) COMP.
  5195     05  DCAHPRMF PIC  X(0001).
  5196     05  FILLER REDEFINES DCAHPRMF.
  5197         10  DCAHPRMA PIC  X(0001).
  5198     05  DCAHPRMI PIC  X(0011).
  5199*    -------------------------------
  5200     05  DCCANCL PIC S9(0004) COMP.
  5201     05  DCCANCF PIC  X(0001).
  5202     05  FILLER REDEFINES DCCANCF.
  5203         10  DCCANCA PIC  X(0001).
  5204     05  DCCANCI PIC  X(0005).
  5205*    -------------------------------
  5206     05  DCLFRFDL PIC S9(0004) COMP.
  5207     05  DCLFRFDF PIC  X(0001).
  5208     05  FILLER REDEFINES DCLFRFDF.
  5209         10  DCLFRFDA PIC  X(0001).
  5210     05  DCLFRFDI PIC  X(0011).
  5211*    -------------------------------
  5212     05  DCAHRFDL PIC S9(0004) COMP.
  5213     05  DCAHRFDF PIC  X(0001).
  5214     05  FILLER REDEFINES DCAHRFDF.
  5215         10  DCAHRFDA PIC  X(0001).
  5216     05  DCAHRFDI PIC  X(0011).
  5217*    -------------------------------
  5218     05  DOISSL PIC S9(0004) COMP.
  5219     05  DOISSF PIC  X(0001).
  5220     05  FILLER REDEFINES DOISSF.
  5221         10  DOISSA PIC  X(0001).
  5222     05  DOISSI PIC  X(0005).
  5223*    -------------------------------
  5224     05  DOLFPRML PIC S9(0004) COMP.
  5225     05  DOLFPRMF PIC  X(0001).
  5226     05  FILLER REDEFINES DOLFPRMF.
  5227         10  DOLFPRMA PIC  X(0001).
  5228     05  DOLFPRMI PIC  X(0011).
  5229*    -------------------------------
  5230     05  DOAHPRML PIC S9(0004) COMP.
  5231     05  DOAHPRMF PIC  X(0001).
  5232     05  FILLER REDEFINES DOAHPRMF.
  5233         10  DOAHPRMA PIC  X(0001).
  5234     05  DOAHPRMI PIC  X(0011).
  5235*    -------------------------------
  5236     05  DOCANCL PIC S9(0004) COMP.
  5237     05  DOCANCF PIC  X(0001).
  5238     05  FILLER REDEFINES DOCANCF.
  5239         10  DOCANCA PIC  X(0001).
  5240     05  DOCANCI PIC  X(0005).
  5241*    -------------------------------
  5242     05  DOLFRFDL PIC S9(0004) COMP.
  5243     05  DOLFRFDF PIC  X(0001).
  5244     05  FILLER REDEFINES DOLFRFDF.
  5245         10  DOLFRFDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  98
* VP6311.cbl
  5246     05  DOLFRFDI PIC  X(0011).
  5247*    -------------------------------
  5248     05  DOAHRFDL PIC S9(0004) COMP.
  5249     05  DOAHRFDF PIC  X(0001).
  5250     05  FILLER REDEFINES DOAHRFDF.
  5251         10  DOAHRFDA PIC  X(0001).
  5252     05  DOAHRFDI PIC  X(0011).
  5253*    -------------------------------
  5254     05  DITOTALL PIC S9(0004) COMP.
  5255     05  DITOTALF PIC  X(0001).
  5256     05  FILLER REDEFINES DITOTALF.
  5257         10  DITOTALA PIC  X(0001).
  5258     05  DITOTALI PIC  X(0005).
  5259*    -------------------------------
  5260     05  DIFATALL PIC S9(0004) COMP.
  5261     05  DIFATALF PIC  X(0001).
  5262     05  FILLER REDEFINES DIFATALF.
  5263         10  DIFATALA PIC  X(0001).
  5264     05  DIFATALI PIC  X(0005).
  5265*    -------------------------------
  5266     05  DIFORCEL PIC S9(0004) COMP.
  5267     05  DIFORCEF PIC  X(0001).
  5268     05  FILLER REDEFINES DIFORCEF.
  5269         10  DIFORCEA PIC  X(0001).
  5270     05  DIFORCEI PIC  X(0005).
  5271*    -------------------------------
  5272     05  DIHOLDL PIC S9(0004) COMP.
  5273     05  DIHOLDF PIC  X(0001).
  5274     05  FILLER REDEFINES DIHOLDF.
  5275         10  DIHOLDA PIC  X(0001).
  5276     05  DIHOLDI PIC  X(0005).
  5277*    -------------------------------
  5278     05  DIAVAILL PIC S9(0004) COMP.
  5279     05  DIAVAILF PIC  X(0001).
  5280     05  FILLER REDEFINES DIAVAILF.
  5281         10  DIAVAILA PIC  X(0001).
  5282     05  DIAVAILI PIC  X(0005).
  5283*    -------------------------------
  5284     05  DIGPREML PIC S9(0004) COMP.
  5285     05  DIGPREMF PIC  X(0001).
  5286     05  FILLER REDEFINES DIGPREMF.
  5287         10  DIGPREMA PIC  X(0001).
  5288     05  DIGPREMI PIC  X(0011).
  5289*    -------------------------------
  5290     05  DIBPREML PIC S9(0004) COMP.
  5291     05  DIBPREMF PIC  X(0001).
  5292     05  FILLER REDEFINES DIBPREMF.
  5293         10  DIBPREMA PIC  X(0001).
  5294     05  DIBPREMI PIC  X(0011).
  5295*    -------------------------------
  5296     05  DCTOTALL PIC S9(0004) COMP.
  5297     05  DCTOTALF PIC  X(0001).
  5298     05  FILLER REDEFINES DCTOTALF.
  5299         10  DCTOTALA PIC  X(0001).
  5300     05  DCTOTALI PIC  X(0005).
  5301*    -------------------------------
  5302     05  DCFATALL PIC S9(0004) COMP.
  5303     05  DCFATALF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  99
* VP6311.cbl
  5304     05  FILLER REDEFINES DCFATALF.
  5305         10  DCFATALA PIC  X(0001).
  5306     05  DCFATALI PIC  X(0005).
  5307*    -------------------------------
  5308     05  DCFORCEL PIC S9(0004) COMP.
  5309     05  DCFORCEF PIC  X(0001).
  5310     05  FILLER REDEFINES DCFORCEF.
  5311         10  DCFORCEA PIC  X(0001).
  5312     05  DCFORCEI PIC  X(0005).
  5313*    -------------------------------
  5314     05  DCHOLDL PIC S9(0004) COMP.
  5315     05  DCHOLDF PIC  X(0001).
  5316     05  FILLER REDEFINES DCHOLDF.
  5317         10  DCHOLDA PIC  X(0001).
  5318     05  DCHOLDI PIC  X(0005).
  5319*    -------------------------------
  5320     05  DCAVAILL PIC S9(0004) COMP.
  5321     05  DCAVAILF PIC  X(0001).
  5322     05  FILLER REDEFINES DCAVAILF.
  5323         10  DCAVAILA PIC  X(0001).
  5324     05  DCAVAILI PIC  X(0005).
  5325*    -------------------------------
  5326     05  DCGPREML PIC S9(0004) COMP.
  5327     05  DCGPREMF PIC  X(0001).
  5328     05  FILLER REDEFINES DCGPREMF.
  5329         10  DCGPREMA PIC  X(0001).
  5330     05  DCGPREMI PIC  X(0011).
  5331*    -------------------------------
  5332     05  DCBPREML PIC S9(0004) COMP.
  5333     05  DCBPREMF PIC  X(0001).
  5334     05  FILLER REDEFINES DCBPREMF.
  5335         10  DCBPREMA PIC  X(0001).
  5336     05  DCBPREMI PIC  X(0011).
  5337*    -------------------------------
  5338     05  DNTOTALL PIC S9(0004) COMP.
  5339     05  DNTOTALF PIC  X(0001).
  5340     05  FILLER REDEFINES DNTOTALF.
  5341         10  DNTOTALA PIC  X(0001).
  5342     05  DNTOTALI PIC  X(0005).
  5343*    -------------------------------
  5344     05  DNFATALL PIC S9(0004) COMP.
  5345     05  DNFATALF PIC  X(0001).
  5346     05  FILLER REDEFINES DNFATALF.
  5347         10  DNFATALA PIC  X(0001).
  5348     05  DNFATALI PIC  X(0005).
  5349*    -------------------------------
  5350     05  DNFORCEL PIC S9(0004) COMP.
  5351     05  DNFORCEF PIC  X(0001).
  5352     05  FILLER REDEFINES DNFORCEF.
  5353         10  DNFORCEA PIC  X(0001).
  5354     05  DNFORCEI PIC  X(0005).
  5355*    -------------------------------
  5356     05  DNHOLDL PIC S9(0004) COMP.
  5357     05  DNHOLDF PIC  X(0001).
  5358     05  FILLER REDEFINES DNHOLDF.
  5359         10  DNHOLDA PIC  X(0001).
  5360     05  DNHOLDI PIC  X(0005).
  5361*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 100
* VP6311.cbl
  5362     05  DNAVAILL PIC S9(0004) COMP.
  5363     05  DNAVAILF PIC  X(0001).
  5364     05  FILLER REDEFINES DNAVAILF.
  5365         10  DNAVAILA PIC  X(0001).
  5366     05  DNAVAILI PIC  X(0005).
  5367*    -------------------------------
  5368     05  DNGPREML PIC S9(0004) COMP.
  5369     05  DNGPREMF PIC  X(0001).
  5370     05  FILLER REDEFINES DNGPREMF.
  5371         10  DNGPREMA PIC  X(0001).
  5372     05  DNGPREMI PIC  X(0011).
  5373*    -------------------------------
  5374     05  DNBPREML PIC S9(0004) COMP.
  5375     05  DNBPREMF PIC  X(0001).
  5376     05  FILLER REDEFINES DNBPREMF.
  5377         10  DNBPREMA PIC  X(0001).
  5378     05  DNBPREMI PIC  X(0011).
  5379*    -------------------------------
  5380     05  DERMSGL PIC S9(0004) COMP.
  5381     05  DERMSGF PIC  X(0001).
  5382     05  FILLER REDEFINES DERMSGF.
  5383         10  DERMSGA PIC  X(0001).
  5384     05  DERMSGI PIC  X(0075).
  5385*    -------------------------------
  5386     05  DPFENTRL PIC S9(0004) COMP.
  5387     05  DPFENTRF PIC  X(0001).
  5388     05  FILLER REDEFINES DPFENTRF.
  5389         10  DPFENTRA PIC  X(0001).
  5390     05  DPFENTRI PIC  9(2).
  5391 01  VP631DO REDEFINES VP631BI.
  5392     05  FILLER            PIC  X(0012).
  5393*    -------------------------------
  5394     05  FILLER            PIC  X(0003).
  5395     05  DDATEO PIC  X(0008).
  5396*    -------------------------------
  5397     05  FILLER            PIC  X(0003).
  5398     05  DTIMEO PIC  99.99.
  5399*    -------------------------------
  5400     05  FILLER            PIC  X(0003).
  5401     05  DHEADO PIC  X(0038).
  5402*    -------------------------------
  5403     05  FILLER            PIC  X(0003).
  5404     05  DLDATEO PIC  X(0010).
  5405*    -------------------------------
  5406     05  FILLER            PIC  X(0003).
  5407     05  DBATCHO PIC  X(0011).
  5408*    -------------------------------
  5409     05  FILLER            PIC  X(0003).
  5410     05  DACCTNMO PIC  X(0030).
  5411*    -------------------------------
  5412     05  FILLER            PIC  X(0003).
  5413     05  DPROCDTO PIC  X(0008).
  5414*    -------------------------------
  5415     05  FILLER            PIC  X(0003).
  5416     05  DINPUTO PIC  X(0008).
  5417*    -------------------------------
  5418     05  FILLER            PIC  X(0003).
  5419     05  DMAINDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 101
* VP6311.cbl
  5420*    -------------------------------
  5421     05  FILLER            PIC  X(0003).
  5422     05  DCARRO PIC  X(0001).
  5423*    -------------------------------
  5424     05  FILLER            PIC  X(0003).
  5425     05  DGROUPO PIC  X(0006).
  5426*    -------------------------------
  5427     05  FILLER            PIC  X(0003).
  5428     05  DSTATEO PIC  X(0002).
  5429*    -------------------------------
  5430     05  FILLER            PIC  X(0003).
  5431     05  DACCTO PIC  X(0010).
  5432*    -------------------------------
  5433     05  FILLER            PIC  X(0003).
  5434     05  DRECVDTO PIC  X(0008).
  5435*    -------------------------------
  5436     05  FILLER            PIC  X(0003).
  5437     05  DCSRO PIC  X(0004).
  5438*    -------------------------------
  5439     05  FILLER            PIC  X(0003).
  5440     05  DREFHDGO PIC  X(0010).
  5441*    -------------------------------
  5442     05  FILLER            PIC  X(0003).
  5443     05  DREFO PIC  X(0012).
  5444*    -------------------------------
  5445     05  FILLER            PIC  X(0003).
  5446     05  DLFPHDGO PIC  X(0010).
  5447*    -------------------------------
  5448     05  FILLER            PIC  X(0003).
  5449     05  DAHPHDGO PIC  X(0010).
  5450*    -------------------------------
  5451     05  FILLER            PIC  X(0003).
  5452     05  DLFRHDGO PIC  X(0009).
  5453*    -------------------------------
  5454     05  FILLER            PIC  X(0003).
  5455     05  DAHRHDGO PIC  X(0009).
  5456*    -------------------------------
  5457     05  FILLER            PIC  X(0003).
  5458     05  DRISSO PIC  ZZ99-.
  5459*    -------------------------------
  5460     05  FILLER            PIC  X(0003).
  5461     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5462*    -------------------------------
  5463     05  FILLER            PIC  X(0003).
  5464     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5465*    -------------------------------
  5466     05  FILLER            PIC  X(0003).
  5467     05  DRCANCO PIC  ZZ99-.
  5468*    -------------------------------
  5469     05  FILLER            PIC  X(0003).
  5470     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5471*    -------------------------------
  5472     05  FILLER            PIC  X(0003).
  5473     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DEISSO PIC  ZZ99-.
  5477*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 102
* VP6311.cbl
  5478     05  FILLER            PIC  X(0003).
  5479     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5483*    -------------------------------
  5484     05  FILLER            PIC  X(0003).
  5485     05  DECANCO PIC  ZZ99-.
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DCISSO PIC  ZZ99-.
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
  5500     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DCCANCO PIC  ZZ99-.
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5510*    -------------------------------
  5511     05  FILLER            PIC  X(0003).
  5512     05  DOISSO PIC  ZZ99-.
  5513*    -------------------------------
  5514     05  FILLER            PIC  X(0003).
  5515     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DOCANCO PIC  ZZ99-.
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5525*    -------------------------------
  5526     05  FILLER            PIC  X(0003).
  5527     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DITOTALO PIC  ZZZ99.
  5531*    -------------------------------
  5532     05  FILLER            PIC  X(0003).
  5533     05  DIFATALO PIC  ZZZ99.
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 103
* VP6311.cbl
  5536     05  DIFORCEO PIC  ZZZ99.
  5537*    -------------------------------
  5538     05  FILLER            PIC  X(0003).
  5539     05  DIHOLDO PIC  ZZZ99.
  5540*    -------------------------------
  5541     05  FILLER            PIC  X(0003).
  5542     05  DIAVAILO PIC  ZZZ99.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DCTOTALO PIC  ZZZ99.
  5552*    -------------------------------
  5553     05  FILLER            PIC  X(0003).
  5554     05  DCFATALO PIC  ZZZ99.
  5555*    -------------------------------
  5556     05  FILLER            PIC  X(0003).
  5557     05  DCFORCEO PIC  ZZZ99.
  5558*    -------------------------------
  5559     05  FILLER            PIC  X(0003).
  5560     05  DCHOLDO PIC  ZZZ99.
  5561*    -------------------------------
  5562     05  FILLER            PIC  X(0003).
  5563     05  DCAVAILO PIC  ZZZ99.
  5564*    -------------------------------
  5565     05  FILLER            PIC  X(0003).
  5566     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5567*    -------------------------------
  5568     05  FILLER            PIC  X(0003).
  5569     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5570*    -------------------------------
  5571     05  FILLER            PIC  X(0003).
  5572     05  DNTOTALO PIC  ---99.
  5573*    -------------------------------
  5574     05  FILLER            PIC  X(0003).
  5575     05  DNFATALO PIC  ---99.
  5576*    -------------------------------
  5577     05  FILLER            PIC  X(0003).
  5578     05  DNFORCEO PIC  ---99.
  5579*    -------------------------------
  5580     05  FILLER            PIC  X(0003).
  5581     05  DNHOLDO PIC  ---99.
  5582*    -------------------------------
  5583     05  FILLER            PIC  X(0003).
  5584     05  DNAVAILO PIC  ---99.
  5585*    -------------------------------
  5586     05  FILLER            PIC  X(0003).
  5587     05  DNGPREMO PIC  -------9.99.
  5588*    -------------------------------
  5589     05  FILLER            PIC  X(0003).
  5590     05  DNBPREMO PIC  -------9.99.
  5591*    -------------------------------
  5592     05  FILLER            PIC  X(0003).
  5593     05  DERMSGO PIC  X(0075).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 104
* VP6311.cbl
  5594*    -------------------------------
  5595     05  FILLER            PIC  X(0003).
  5596     05  DPFENTRO PIC  X(0002).
  5597*    -------------------------------
  5598 01  MAP-B REDEFINES VP631BI.
  5599     12  FILLER                  PIC X(569).
  5600*    12  FILLER                  PIC X(512).
  5601*    12  FILLER                  PIC X(510).
  5602     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5603         16  BKIND-LEN               PIC S9(4)  COMP.
  5604         16  BKIND-ATTRB             PIC X.
  5605         16  BKIND                   PIC XX.
  5606         16  BTYPE-LEN               PIC S9(4)  COMP.
  5607         16  BTYPE-ATTRB             PIC X.
  5608         16  BTYPE                   PIC X(3).
  5609         16  BTERM-LEN               PIC S9(4)  COMP.
  5610         16  BTERM-ATTRB             PIC X.
  5611         16  BTERMI                  PIC 999.
  5612         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5613         16  BBEN-LEN                PIC S9(4)  COMP.
  5614         16  BBEN-ATTRB              PIC X.
  5615         16  BBENI                   PIC 9(10)V99.
  5616*        16  BBENI                   PIC 9(12).
  5617         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5618         16  BPREM-LEN               PIC S9(4)  COMP.
  5619         16  BPREM-ATTRB             PIC X.
  5620         16  BPREMI                  PIC S9(9)V99.
  5621*        16  BPREMI                  PIC 9(11).
  5622         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5623         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5624         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5625         16  BEXPIRE-ATTRB           PIC X.
  5626         16  BEXPIRE                 PIC X(8).
  5627         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5628         16  BCRIT-PERD-ATTRB        PIC X.
  5629         16  BCRIT-PERDI             PIC 99.
  5630         16  BCRIT-PERDO REDEFINES
  5631                         BCRIT-PERDI PIC ZZ.
  5632         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5633         16  BALT-BEN-ATTRB          PIC X.
  5634         16  BALT-BENI               PIC 9(10)V99.
  5635*        16  BALT-BENI               PIC 9(12).
  5636         16  BALT-BENO REDEFINES
  5637                           BALT-BENI PIC Z(9).ZZ.
  5638         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5639         16  BALT-PREM-ATTRB         PIC X.
  5640         16  BALT-PREMI              PIC 9(9)V99.
  5641*        16  BALT-PREMI              PIC 9(11).
  5642         16  BALT-PREMO REDEFINES
  5643                          BALT-PREMI PIC Z(7).ZZ-.
  5644         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5645         16  BBEN-CD-ATTRB           PIC X.
  5646         16  BBEN-CD                 PIC XXX.
  5647         16  BCPREM-LEN              PIC S9(4)  COMP.
  5648         16  BCPREM-ATTRB            PIC X.
  5649         16  BCPREMI                 PIC S9(9)V99.
  5650*        16  BCPREMI                 PIC X(11).
  5651         16  BCPREMO REDEFINES BCPREMI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 105
* VP6311.cbl
  5652                                     PIC Z(7).99-.
  5653         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5654         16  BCALT-PREM-ATTRB        PIC X.
  5655         16  BCALT-PREM              PIC Z(7).99-.
  5656         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5657         16  BBEN-ABBR-ATTRB         PIC X.
  5658         16  BBEN-ABBR               PIC X(5).
  5659         16  BDIFF-LEN               PIC S9(4)  COMP.
  5660         16  BDIFF-ATTRB             PIC X.
  5661         16  BDIFFO                  PIC Z(7).99-.
  5662         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5663         16  BBILL-LIT-ATTRB         PIC X.
  5664         16  BBILL-LIT               PIC X(8).
  5665         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5666         16  BDALT-PREM-ATTRB        PIC X.
  5667         16  BDALT-PREM              PIC Z(7).99-.
  5668
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 106
* VP6311.cbl
  5670
  5671****************************************************************
  5672*
  5673* Copyright (c) 2007 by Clerity Solutions, Inc.
  5674* All rights reserved.
  5675*
  5676****************************************************************
  5677 01  DFHEIV.
  5678   02  DFHEIV0               PIC X(35).
  5679   02  DFHEIV1               PIC X(08).
  5680   02  DFHEIV2               PIC X(08).
  5681   02  DFHEIV3               PIC X(08).
  5682   02  DFHEIV4               PIC X(06).
  5683   02  DFHEIV5               PIC X(04).
  5684   02  DFHEIV6               PIC X(04).
  5685   02  DFHEIV7               PIC X(02).
  5686   02  DFHEIV8               PIC X(02).
  5687   02  DFHEIV9               PIC X(01).
  5688   02  DFHEIV10              PIC S9(7) COMP-3.
  5689   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5690   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5691   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5692   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5693   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5694   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5695   02  DFHEIV17              PIC X(04).
  5696   02  DFHEIV18              PIC X(04).
  5697   02  DFHEIV19              PIC X(04).
  5698   02  DFHEIV20              USAGE IS POINTER.
  5699   02  DFHEIV21              USAGE IS POINTER.
  5700   02  DFHEIV22              USAGE IS POINTER.
  5701   02  DFHEIV23              USAGE IS POINTER.
  5702   02  DFHEIV24              USAGE IS POINTER.
  5703   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5704   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5705   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5706   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5707   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5708   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5709   02  FILLER                PIC X(02).
  5710   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5711   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5712   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5713   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5714   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5715 LINKAGE  SECTION.
  5716*****************************************************************
  5717*                                                               *
  5718* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5719* All rights reserved.                                          *
  5720*                                                               *
  5721*****************************************************************
  5722 01  dfheiblk.
  5723     02  eibtime          pic s9(7) comp-3.
  5724     02  eibdate          pic s9(7) comp-3.
  5725     02  eibtrnid         pic x(4).
  5726     02  eibtaskn         pic s9(7) comp-3.
  5727     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 107
* VP6311.cbl
  5728     02  dfheigdi         pic s9(4) comp.
  5729     02  eibcposn         pic s9(4) comp.
  5730     02  eibcalen         pic s9(4) comp.
  5731     02  eibaid           pic x(1).
  5732     02  eibfiller1       pic x(1).
  5733     02  eibfn            pic x(2).
  5734     02  eibfiller2       pic x(2).
  5735     02  eibrcode         pic x(6).
  5736     02  eibfiller3       pic x(2).
  5737     02  eibds            pic x(8).
  5738     02  eibreqid         pic x(8).
  5739     02  eibrsrce         pic x(8).
  5740     02  eibsync          pic x(1).
  5741     02  eibfree          pic x(1).
  5742     02  eibrecv          pic x(1).
  5743     02  eibsend          pic x(1).
  5744     02  eibatt           pic x(1).
  5745     02  eibeoc           pic x(1).
  5746     02  eibfmh           pic x(1).
  5747     02  eibcompl         pic x(1).
  5748     02  eibsig           pic x(1).
  5749     02  eibconf          pic x(1).
  5750     02  eiberr           pic x(1).
  5751     02  eibrldbk         pic x(1).
  5752     02  eiberrcd         pic x(4).
  5753     02  eibsynrb         pic x(1).
  5754     02  eibnodat         pic x(1).
  5755     02  eibfiller5       pic x(2).
  5756     02  eibresp          pic 9(09) comp.
  5757     02  eibresp2         pic 9(09) comp.
  5758     02  dfheigdj         pic s9(4) comp.
  5759     02  dfheigdk         pic s9(4) comp.
  5760 01  DFHCOMMAREA                 PIC X(1300).
  5761*                                COPY ERCPNDB.
  5762******************************************************************
  5763*                                                                *
  5764*                                                                *
  5765*                            ERCPNDB.                            *
  5766*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5767*                            VMOD=2.025                          *
  5768*                                                                *
  5769*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5770*                                                                *
  5771******************************************************************
  5772*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5773*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5774******************************************************************
  5775*                                                                *
  5776*                                                                *
  5777*   FILE TYPE = VSAM,KSDS                                        *
  5778*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5779*                                                                *
  5780*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5781*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5782*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5783*                                                 RKP=13,LEN=36  *
  5784*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5785*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 108
* VP6311.cbl
  5786*                                                RKP=49,LEN=11   *
  5787*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5788*                                      AND CHG-SEQ.)             *
  5789*                                                RKP=60,LEN=15   *
  5790*                                                                *
  5791*   LOG = NO                                                     *
  5792*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5793******************************************************************
  5794******************************************************************
  5795*                   C H A N G E   L O G
  5796*
  5797* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5798*-----------------------------------------------------------------
  5799*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5800* EFFECTIVE    NUMBER
  5801*-----------------------------------------------------------------
  5802* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5803* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5804* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5805* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5806* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5807* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5808* 032306                   PEMA  ADD BOW LOAN NUMBER
  5809* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5810* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5811* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5812* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5813* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5814* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5815* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5816* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5817* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5818* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5819******************************************************************
  5820
  5821 01  PENDING-BUSINESS.
  5822     12  PB-RECORD-ID                     PIC XX.
  5823         88  VALID-PB-ID                        VALUE 'PB'.
  5824
  5825     12  PB-CONTROL-PRIMARY.
  5826         16  PB-COMPANY-CD                PIC X.
  5827         16  PB-ENTRY-BATCH               PIC X(6).
  5828         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5829         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5830
  5831     12  PB-CONTROL-BY-ACCOUNT.
  5832         16  PB-COMPANY-CD-A1             PIC X.
  5833         16  PB-CARRIER                   PIC X.
  5834         16  PB-GROUPING.
  5835             20  PB-GROUPING-PREFIX       PIC XXX.
  5836             20  PB-GROUPING-PRIME        PIC XXX.
  5837         16  PB-STATE                     PIC XX.
  5838         16  PB-ACCOUNT.
  5839             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5840             20  PB-ACCOUNT-PRIME         PIC X(6).
  5841         16  PB-CERT-EFF-DT               PIC XX.
  5842         16  PB-CERT-NO.
  5843             20  PB-CERT-PRIME            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 109
* VP6311.cbl
  5844             20  PB-CERT-SFX              PIC X.
  5845         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5846
  5847         16  PB-RECORD-TYPE               PIC X.
  5848             88  PB-MAILING-DATA                VALUE '0'.
  5849             88  PB-ISSUE                       VALUE '1'.
  5850             88  PB-CANCELLATION                VALUE '2'.
  5851             88  PB-BATCH-TRAILER               VALUE '9'.
  5852
  5853     12  PB-CONTROL-BY-ORIG-BATCH.
  5854         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5855         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5856         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5857         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5858
  5859     12  PB-CONTROL-BY-CSR.
  5860         16  PB-CSR-COMPANY-CD            PIC X.
  5861         16  PB-CSR-ID                    PIC X(4).
  5862         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5863         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5864         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5865******************************************************************
  5866*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5867******************************************************************
  5868
  5869     12  PB-LAST-MAINT-DT                 PIC XX.
  5870     12  PB-LAST-MAINT-BY                 PIC X(4).
  5871     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5872
  5873     12  PB-RECORD-BODY                   PIC X(375).
  5874
  5875     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5876         16  PB-CERT-ORIGIN               PIC X.
  5877             88  CLASIC-CREATED-CERT         VALUE '1'.
  5878         16  PB-I-NAME.
  5879             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5880             20  PB-I-INSURED-FIRST-NAME.
  5881                 24  PB-I-INSURED-1ST-INIT PIC X.
  5882                 24  FILLER                PIC X(9).
  5883             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5884         16  PB-I-AGE                     PIC S99   COMP-3.
  5885         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5886         16  PB-I-BIRTHDAY                PIC XX.
  5887         16  PB-I-INSURED-SEX             PIC X.
  5888             88  PB-SEX-MALE     VALUE 'M'.
  5889             88  PB-SEX-FEMALE   VALUE 'F'.
  5890
  5891         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5892         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5893         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5894         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5895         16  PB-I-SKIP-CODE               PIC X.
  5896             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5897             88  PB-SKIP-JULY              VALUE '1'.
  5898             88  PB-SKIP-AUGUST            VALUE '2'.
  5899             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5900             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5901             88  PB-SKIP-AUG-SEPT          VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 110
* VP6311.cbl
  5902             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5903             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5904             88  PB-SKIP-JUNE              VALUE '8'.
  5905             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5906             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5907             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5908         16  PB-I-TERM-TYPE               PIC X.
  5909             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5910             88  PB-PAID-WEEKLY            VALUE 'W'.
  5911             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5912             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5913             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5914         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5915         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5916         16  PB-I-DATA-ENTRY-SW           PIC X.
  5917             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5918             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5919             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5920             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5921         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5922         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5923*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5924         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5925         16  FILLER                       PIC X.
  5926
  5927         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5928             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5929             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5930                                                   '90' THRU '99'.
  5931         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5932                                          PIC XX.
  5933         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5934         16  PB-I-AMOUNT-FINANCED REDEFINES
  5935                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5936         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5937         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5938                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5939         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5940         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5941         16  PB-I-CLP-AMOUNT REDEFINES
  5942                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5943         16  PB-I-LF-CALC-FLAG            PIC X.
  5944             88 PB-COMP-LF-PREM               VALUE '?'.
  5945         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5946         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5947         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5948         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5949         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5950         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5951         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5952         16  PB-I-LF-ABBR                 PIC XXX.
  5953         16  PB-I-LF-INPUT-CD             PIC XX.
  5954
  5955         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5956             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5957             88  PB-INVALID-AH               VALUE '  ' '00'
  5958                                                   '90' THRU '99'.
  5959         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 111
* VP6311.cbl
  5960         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5961         16  PB-I-AH-CALC-FLAG            PIC X.
  5962             88 PB-COMP-AH-PREM                  VALUE '?'.
  5963         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5964         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5965         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  5966         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5967         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5968         16  PB-I-AH-ABBR                 PIC XXX.
  5969         16  PB-I-AH-INPUT-CD             PIC XXX.
  5970
  5971         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5972         16  PB-I-REIN-TABLE              PIC XXX.
  5973         16  PB-I-BUSINESS-TYPE           PIC 99.
  5974         16  PB-I-INDV-GRP-CD             PIC X.
  5975         16  PB-I-MORT-CODE.
  5976             20  PB-I-TABLE               PIC X.
  5977             20  PB-I-INTEREST            PIC XX.
  5978             20  PB-I-MORT-TYP            PIC X.
  5979         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5980         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5981         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5982         16  PB-I-INDV-GRP-OVRD           PIC X.
  5983         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5984         16  PB-I-SIG-SW                  PIC X.
  5985             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5986         16  PB-I-RATE-CLASS              PIC XX.
  5987         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5988         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5989         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5990         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5991         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5992         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5993         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5994         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5995         16  PB-I-OB-FLAG                 PIC X.
  5996             88  PB-I-OB                      VALUE 'B'.
  5997             88  PB-I-SUMMARY                 VALUE 'Z'.
  5998         16  PB-I-ENTRY-STATUS            PIC X.
  5999             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6000                                              'M' '5' '9' '2'.
  6001             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6002             88  PB-I-POLICY-PENDING          VALUE '2'.
  6003             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6004             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6005             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6006             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6007             88  PB-I-REIN-ONLY               VALUE '9'.
  6008             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6009             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6010             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6011             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6012         16  PB-I-INT-CODE                PIC X.
  6013             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6014             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6015         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6016         16  PB-I-SOC-SEC-NO              PIC X(11).
  6017         16  PB-I-MEMBER-NO               PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 112
* VP6311.cbl
  6018         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6019*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6020         16  PB-I-OLD-LOF                 PIC XXX.
  6021         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6022         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6023         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6024         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6025         16  PB-I-LIFE-INDICATOR          PIC X.
  6026             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6027         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6028         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6029                                          PIC S9(5)V99    COMP-3.
  6030         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6031             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6032             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6033         16  PB-I-1ST-PMT-DT              PIC XX.
  6034         16  PB-I-JOINT-INSURED.
  6035             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6036             20 PB-I-JOINT-FIRST-NAME.
  6037                24  PB-I-JOINT-FIRST-INIT PIC X.
  6038                24  FILLER                PIC X(9).
  6039             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6040*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6041         16  PB-I-BENEFICIARY-NAME.
  6042             20  PB-I-BANK-NUMBER         PIC X(10).
  6043             20  FILLER                   PIC X(15).
  6044         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6045         16  PB-I-REFERENCE               PIC X(12).
  6046         16  FILLER REDEFINES PB-I-REFERENCE.
  6047             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6048             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6049             20  PB-I-CLP-STATE           PIC XX.
  6050         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6051             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6052             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6053             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6054         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6055         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6056         16  PB-I-RESIDENT-STATE          PIC XX.
  6057         16  PB-I-RATE-CODE               PIC X(4).
  6058         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6059         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6060         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6061         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6062         16  PB-I-BANK-NOCHRGB            PIC 99.
  6063         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6064         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6065
  6066     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6067         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6068             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6069         16  PB-C-CANCEL-ORIGIN           PIC X.
  6070             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6071         16  PB-C-LF-CANCEL-DT            PIC XX.
  6072         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6073         16  PB-C-LF-CALC-REQ             PIC X.
  6074             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6075         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 113
* VP6311.cbl
  6076         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6077         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6078             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6079         16  PB-C-AH-CANCEL-DT            PIC XX.
  6080         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6081         16  PB-C-AH-CALC-REQ             PIC X.
  6082             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6083         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6084         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6085         16  PB-C-LAST-NAME               PIC X(15).
  6086         16  PB-C-REFUND-SW               PIC X.
  6087             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6088             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6089         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6090         16  PB-C-PAYEE-CODE              PIC X(6).
  6091         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6092         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6093         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6094         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6095         16  PB-C-REFERENCE               PIC X(12).
  6096         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6097         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6098         16  PB-C-POST-CARD-IND           PIC X.
  6099         16  PB-C-CANCEL-REASON           PIC X.
  6100         16  PB-C-REF-INTERFACE-SW        PIC X.
  6101         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6102         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6103         16  FILLER                       PIC X(01).
  6104*        16  FILLER                       PIC X(18).
  6105         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6106*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6107         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6108         16  PB-CANCELED-CERT-DATA.
  6109             20  PB-CI-INSURED-NAME.
  6110                 24  PB-CI-LAST-NAME      PIC X(15).
  6111                 24  PB-CI-INITIALS       PIC XX.
  6112             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6113             20  PB-CI-INSURED-SEX        PIC X.
  6114             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6115             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6116             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6117             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6118             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6119             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6120             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6121             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6122             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6123             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6124             20  PB-CI-RATE-CLASS         PIC XX.
  6125             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6126             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6127             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6128             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6129             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6130             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6131             20  PB-CI-LF-ABBR            PIC X(3).
  6132             20  PB-CI-AH-ABBR            PIC X(3).
  6133             20  PB-CI-OB-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 114
* VP6311.cbl
  6134                 88  PB-CI-OB                VALUE 'B'.
  6135             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6136                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6137                                           'M' '4' '5' '9' '2'.
  6138                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6139                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6140                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6141                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6142                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6143                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6144                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6145                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6146                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6147                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6148                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6149                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6150                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6151             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6152                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6153                                           'M' '4' '5' '9' '2'.
  6154                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6155                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6156                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6157                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6158                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6159                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6160                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6161                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6162                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6163                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6164                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6165                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6166                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6167             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6168             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6169             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6170             20  PB-CI-MEMBER-NO          PIC X(12).
  6171             20  PB-CI-INT-CODE           PIC X.
  6172                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6173                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6174             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6175             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6176             20  PB-CI-COMP-EXCP-SW       PIC X.
  6177                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6178                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6179             20  PB-CI-ENTRY-STATUS       PIC X.
  6180             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6181             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6182             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6183             20  PB-CI-DEATH-DT           PIC XX.
  6184             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6185             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6186             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6187             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6188             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6189             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6190             20  PB-CI-ENTRY-DT              PIC XX.
  6191             20  PB-CI-ENTRY-BATCH           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 115
* VP6311.cbl
  6192             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6193             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6194             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6195             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6196             20  PB-CI-OLD-LOF               PIC XXX.
  6197*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6198             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6199             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6200             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6201             20  PB-CI-INDV-GRP-CD           PIC X.
  6202             20  PB-CI-BENEFICIARY-NAME.
  6203                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6204                 24  FILLER                  PIC X(15).
  6205             20  PB-CI-NOTE-SW               PIC X.
  6206             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6207             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6208             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6209             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6210             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6211             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6212             20  PB-CI-FIRST-NAME            PIC X(10).
  6213             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6214
  6215         16  FILLER                       PIC X(13).
  6216*032306  16  FILLER                       PIC X(27).
  6217*        16  FILLER                       PIC X(46).
  6218
  6219     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6220         16  FILLER                       PIC X(10).
  6221         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6222         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6223         16  PB-M-INSURED-MID-INIT        PIC X.
  6224         16  PB-M-INSURED-AGE             PIC 99.
  6225         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6226         16  PB-M-INSURED-SEX             PIC X.
  6227         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6228         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6229         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6230         16  PB-M-INSURED-CITY-STATE.
  6231             20  PB-M-INSURED-CITY        PIC X(28).
  6232             20  PB-M-INSURED-STATE       PIC XX.
  6233         16  PB-M-INSURED-ZIP-CODE.
  6234             20  PB-M-INSURED-ZIP-PRIME.
  6235                 24  PB-M-INSURED-ZIP-1   PIC X.
  6236                     88  PB-M-CANADIAN-POST-CODE
  6237                                             VALUE 'A' THRU 'Z'.
  6238                 24  FILLER               PIC X(4).
  6239             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6240         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6241                                        PB-M-INSURED-ZIP-CODE.
  6242             20  PM-M-INS-CAN-POST1       PIC XXX.
  6243             20  PM-M-INS-CAN-POST2       PIC XXX.
  6244             20  FILLER                   PIC XXX.
  6245         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6246         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6247         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6248         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6249         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 116
* VP6311.cbl
  6250         16  PB-M-CRED-BENE-CITYST.
  6251             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6252             20  PB-M-CRED-BENE-STATE     PIC XX.
  6253         16  FILLER                       PIC X(92).
  6254
  6255     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6256         16  FILLER                       PIC X(10).
  6257         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6258         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6259         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6260         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6261         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6262         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6263         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6264         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6265         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6266         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6267         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6268         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6269         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6270         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6271         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6272         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6273         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6274         16  PB-ACCOUNT-NAME              PIC X(30).
  6275         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6276         16  PB-REFERENCE                 PIC X(12).
  6277         16  PB-B-RECEIVED-DT             PIC XX.
  6278         16  FILLER                       PIC X(234).
  6279
  6280     12  PB-RECORD-STATUS.
  6281         16  PB-CREDIT-SELECT-DT          PIC XX.
  6282         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6283         16  PB-BILLED-DT                 PIC XX.
  6284         16  PB-BILLING-STATUS            PIC X.
  6285             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6286             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6287             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6288         16  PB-RECORD-BILL               PIC X.
  6289             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6290             88  PB-RECORD-RETURNED           VALUE 'R'.
  6291             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6292             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6293             88  PB-OVERRIDE-AH               VALUE 'A'.
  6294             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6295         16  PB-BATCH-ENTRY               PIC X.
  6296             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6297             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6298             88  PB-REISSUED-CERT             VALUE 'E'.
  6299             88  PB-CASH-CERT                 VALUE 'C'.
  6300             88  PB-MONTHLY-CERT              VALUE 'M'.
  6301             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6302             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6303             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6304         16  PB-FORCE-CODE                PIC X.
  6305             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6306             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6307             88  PB-CANCEL-FORCE              VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 117
* VP6311.cbl
  6308             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6309             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6310             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6311             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6312             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6313             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6314             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6315         16  PB-FATAL-FLAG                PIC X.
  6316             88  PB-FATAL-ERRORS              VALUE 'X'.
  6317         16  PB-FORCE-ER-CD               PIC X.
  6318             88  PB-FORCE-ERRORS              VALUE 'F'.
  6319             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6320         16  PB-WARN-ER-CD                PIC X.
  6321             88  PB-WARNING-ERRORS            VALUE 'W'.
  6322         16  FILLER                       PIC X.
  6323         16  PB-OUT-BAL-CD                PIC X.
  6324             88  PB-OUT-OF-BAL                VALUE 'O'.
  6325         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6326         16  PB-AH-OVERRIDE-L1            PIC X.
  6327         16  PB-INPUT-DT                  PIC XX.
  6328         16  PB-INPUT-BY                  PIC X(4).
  6329         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6330         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6331         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6332         16  PB-LF-EARNING-METHOD         PIC X.
  6333         16  PB-AH-EARNING-METHOD         PIC X.
  6334         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6335         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6336         16  PB-REIN-CD                   PIC XXX.
  6337         16  PB-LF-REFUND-TYPE            PIC X.
  6338         16  PB-AH-REFUND-TYPE            PIC X.
  6339         16  PB-ACCT-EFF-DT               PIC XX.
  6340         16  PB-ACCT-EXP-DT               PIC XX.
  6341         16  PB-COMPANY-ID                PIC X(3).
  6342         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6343         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6344         16  PB-SV-CARRIER                PIC X.
  6345         16  PB-SV-GROUPING               PIC X(6).
  6346         16  PB-SV-STATE                  PIC XX.
  6347         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6348         16  PB-GA-BILLING-INFO.
  6349             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6350                                          PIC XX.
  6351         16  PB-SV-REMIT-TO  REDEFINES
  6352             PB-GA-BILLING-INFO           PIC X(10).
  6353         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6354         16  PB-I-LOAN-OFFICER            PIC X(5).
  6355         16  PB-I-VIN                     PIC X(17).
  6356
  6357         16  FILLER                       PIC X(04).
  6358         16  IMNET-BYPASS-SW              PIC X.
  6359
  6360******************************************************************
  6361*                COMMON EDIT ERRORS                              *
  6362******************************************************************
  6363
  6364     12  PB-COMMON-ERRORS.
  6365         16  PB-COMMON-ERROR    OCCURS 10 TIMES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 118
* VP6311.cbl
  6366                                           PIC S9(4)     COMP.
  6367
  6368******************************************************************
  6369*                                COPY ELCCERT.
  6370******************************************************************
  6371*                                                                *
  6372*                            ELCCERT.                            *
  6373*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6374*                            VMOD=2.013                          *
  6375*                                                                *
  6376*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6377*                                                                *
  6378*   FILE TYPE = VSAM,KSDS                                        *
  6379*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6380*                                                                *
  6381*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6382*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6383*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6384*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6385*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6386*                                                                *
  6387*   LOG = YES                                                    *
  6388*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6389******************************************************************
  6390*                   C H A N G E   L O G
  6391*
  6392* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6393*-----------------------------------------------------------------
  6394*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6395* EFFECTIVE    NUMBER
  6396*-----------------------------------------------------------------
  6397* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6398* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6399* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6400* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6401* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6402* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6403* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6404* 032612  CR2011110200001  PEMA  AHL CHANGES
  6405* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6406* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6407******************************************************************
  6408
  6409 01  CERTIFICATE-MASTER.
  6410     12  CM-RECORD-ID                      PIC XX.
  6411         88  VALID-CM-ID                      VALUE 'CM'.
  6412
  6413     12  CM-CONTROL-PRIMARY.
  6414         16  CM-COMPANY-CD                 PIC X.
  6415         16  CM-CARRIER                    PIC X.
  6416         16  CM-GROUPING.
  6417             20  CM-GROUPING-PREFIX        PIC X(3).
  6418             20  CM-GROUPING-PRIME         PIC X(3).
  6419         16  CM-STATE                      PIC XX.
  6420         16  CM-ACCOUNT.
  6421             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6422             20  CM-ACCOUNT-PRIME          PIC X(6).
  6423         16  CM-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 119
* VP6311.cbl
  6424         16  CM-CERT-NO.
  6425             20  CM-CERT-PRIME             PIC X(10).
  6426             20  CM-CERT-SFX               PIC X.
  6427
  6428     12  CM-CONTROL-BY-NAME.
  6429         16  CM-COMPANY-CD-A1              PIC X.
  6430         16  CM-INSURED-LAST-NAME          PIC X(15).
  6431         16  CM-INSURED-INITIALS.
  6432             20  CM-INSURED-INITIAL1       PIC X.
  6433             20  CM-INSURED-INITIAL2       PIC X.
  6434
  6435     12  CM-CONTROL-BY-SSN.
  6436         16  CM-COMPANY-CD-A2              PIC X.
  6437         16  CM-SOC-SEC-NO.
  6438             20  CM-SSN-STATE              PIC XX.
  6439             20  CM-SSN-ACCOUNT            PIC X(6).
  6440             20  CM-SSN-LN3.
  6441                 25  CM-INSURED-INITIALS-A2.
  6442                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6443                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6444                 25 CM-PART-LAST-NAME-A2         PIC X.
  6445
  6446     12  CM-CONTROL-BY-CERT-NO.
  6447         16  CM-COMPANY-CD-A4              PIC X.
  6448         16  CM-CERT-NO-A4                 PIC X(11).
  6449
  6450     12  CM-CONTROL-BY-MEMB.
  6451         16  CM-COMPANY-CD-A5              PIC X.
  6452         16  CM-MEMBER-NO.
  6453             20  CM-MEMB-STATE             PIC XX.
  6454             20  CM-MEMB-ACCOUNT           PIC X(6).
  6455             20  CM-MEMB-LN4.
  6456                 25  CM-INSURED-INITIALS-A5.
  6457                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6458                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6459                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6460
  6461     12  CM-INSURED-PROFILE-DATA.
  6462         16  CM-INSURED-FIRST-NAME.
  6463             20  CM-INSURED-1ST-INIT       PIC X.
  6464             20  FILLER                    PIC X(9).
  6465         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6466         16  CM-INSURED-SEX                PIC X.
  6467             88  CM-SEX-MALE                  VALUE 'M'.
  6468             88  CM-SEX-FEMAL                 VALUE 'F'.
  6469         16  CM-INSURED-JOINT-AGE          PIC 99.
  6470         16  CM-JOINT-INSURED-NAME.
  6471             20  CM-JT-LAST-NAME           PIC X(15).
  6472             20  CM-JT-FIRST-NAME.
  6473                 24  CM-JT-1ST-INIT        PIC X.
  6474                 24  FILLER                PIC X(9).
  6475             20  CM-JT-INITIAL             PIC X.
  6476
  6477     12  CM-LIFE-DATA.
  6478         16  CM-LF-BENEFIT-CD              PIC XX.
  6479         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6480         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6481         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 120
* VP6311.cbl
  6482         16  CM-LF-DEV-CODE                PIC XXX.
  6483         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6484         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6485         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6486         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6487         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6488         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6489         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6490         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6491         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6492         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6493         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6494         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6495         16  cm-temp-epiq                  pic xx.
  6496             88  EPIQ-CLASS                  value 'EQ'.
  6497*        16  FILLER                        PIC XX.
  6498
  6499     12  CM-AH-DATA.
  6500         16  CM-AH-BENEFIT-CD              PIC XX.
  6501         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6502         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6503         16  CM-AH-DEV-CODE                PIC XXX.
  6504         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6505         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6506         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6507         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6508         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6509         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6510         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6511         16  CM-AH-PAID-THRU-DT            PIC XX.
  6512             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6513         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6514         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6515         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6516         16  FILLER                        PIC X.
  6517
  6518     12  CM-LOAN-INFORMATION.
  6519         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6520         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6521                                           PIC S9(5)V99  COMP-3.
  6522         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6523         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6524         16  CM-PAY-FREQUENCY              PIC S99.
  6525         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6526         16  CM-RATE-CLASS                 PIC XX.
  6527         16  CM-BENEFICIARY                PIC X(25).
  6528         16  CM-POLICY-FORM-NO             PIC X(12).
  6529         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6530         16  CM-LAST-ADD-ON-DT             PIC XX.
  6531         16  CM-DEDUCTIBLE-AMOUNTS.
  6532             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6533             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6534         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6535             20  CM-RESIDENT-STATE         PIC XX.
  6536             20  CM-RATE-CODE              PIC X(4).
  6537             20  FILLER                    PIC XX.
  6538         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6539             20  CM-LOAN-OFFICER           PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 121
* VP6311.cbl
  6540             20  FILLER                    PIC XXX.
  6541         16  CM-CSR-CODE                   PIC XXX.
  6542         16  CM-UNDERWRITING-CODE          PIC X.
  6543             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6544         16  CM-POST-CARD-IND              PIC X.
  6545         16  CM-NH-INTERFACE-SW            PIC X.
  6546         16  CM-PREMIUM-TYPE               PIC X.
  6547             88  CM-SING-PRM                  VALUE '1'.
  6548             88  CM-O-B-COVERAGE              VALUE '2'.
  6549             88  CM-OPEN-END                  VALUE '3'.
  6550         16  CM-IND-GRP-TYPE               PIC X.
  6551             88  CM-INDIVIDUAL                VALUE 'I'.
  6552             88  CM-GROUP                     VALUE 'G'.
  6553         16  CM-SKIP-CODE                  PIC X.
  6554             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6555             88  SKIP-JULY                    VALUE '1'.
  6556             88  SKIP-AUGUST                  VALUE '2'.
  6557             88  SKIP-SEPTEMBER               VALUE '3'.
  6558             88  SKIP-JULY-AUG                VALUE '4'.
  6559             88  SKIP-AUG-SEPT                VALUE '5'.
  6560             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6561             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6562             88  SKIP-JUNE                    VALUE '8'.
  6563             88  SKIP-JUNE-JULY               VALUE '9'.
  6564             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6565             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6566         16  CM-PAYMENT-MODE               PIC X.
  6567             88  PAY-MONTHLY                  VALUE SPACE.
  6568             88  PAY-WEEKLY                   VALUE '1'.
  6569             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6570             88  PAY-BI-WEEKLY                VALUE '3'.
  6571             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6572         16  CM-LOAN-NUMBER                PIC X(8).
  6573         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6574         16  CM-OLD-LOF                    PIC XXX.
  6575*        16  CM-LOAN-OFFICER               PIC XXX.
  6576         16  CM-REIN-TABLE                 PIC XXX.
  6577         16  CM-SPECIAL-REIN-CODE          PIC X.
  6578         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6579         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6580         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6581
  6582     12  CM-STATUS-DATA.
  6583         16  CM-ENTRY-STATUS               PIC X.
  6584         16  CM-ENTRY-DT                   PIC XX.
  6585
  6586         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6587         16  CM-LF-CANCEL-DT               PIC XX.
  6588         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6589
  6590         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6591         16  CM-LF-DEATH-DT                PIC XX.
  6592         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6593
  6594         16  CM-LF-CURRENT-STATUS          PIC X.
  6595             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6596                                                'M' '4' '5' '9'.
  6597             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 122
* VP6311.cbl
  6598             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6599             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6600             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6601             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6602             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6603             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6604             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6605             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6606             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6607             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6608             88  CM-LF-DECLINED               VALUE 'D'.
  6609             88  CM-LF-VOIDED                 VALUE 'V'.
  6610
  6611         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6612         16  CM-AH-CANCEL-DT               PIC XX.
  6613         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6614
  6615         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6616         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6617         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6618
  6619         16  CM-AH-CURRENT-STATUS          PIC X.
  6620             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6621                                                'M' '4' '5' '9'.
  6622             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6623             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6624             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6625             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6626             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6627             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6628             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6629             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6630             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6631             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6632             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6633             88  CM-AH-DECLINED               VALUE 'D'.
  6634             88  CM-AH-VOIDED                 VALUE 'V'.
  6635
  6636         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6637             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6638             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6639             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6640         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6641
  6642         16  CM-ENTRY-BATCH                PIC X(6).
  6643         16  CM-LF-EXIT-BATCH              PIC X(6).
  6644         16  CM-AH-EXIT-BATCH              PIC X(6).
  6645         16  CM-LAST-MONTH-END             PIC XX.
  6646
  6647     12  CM-NOTE-SW                        PIC X.
  6648         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6649         88  CERT-NOTES-PRESENT               VALUE '1'.
  6650         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6651         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6652         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6653         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6654         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6655         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 123
* VP6311.cbl
  6656     12  CM-COMP-EXCP-SW                   PIC X.
  6657         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6658         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6659     12  CM-INSURED-ADDRESS-SW             PIC X.
  6660         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6661         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6662
  6663*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6664     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6665     12  FILLER                            PIC X.
  6666
  6667*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6668     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6669     12  FILLER                            PIC X.
  6670*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6671     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6672
  6673     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6674         88  CERT-ADDED-BATCH                 VALUE ' '.
  6675         88  CERT-ADDED-ONLINE                VALUE '1'.
  6676         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6677         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6678         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6679     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6680         88  CERT-AS-LOADED                   VALUE ' '.
  6681         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6682         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6683         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6684         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6685         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6686         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6687         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6688
  6689     12  CM-ACCOUNT-COMM-PCTS.
  6690         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6691         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6692
  6693     12  CM-USER-FIELD                     PIC X.
  6694     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6695     12  CM-CLP-STATE                      PIC XX.
  6696     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6697     12  CM-USER-RESERVED                  PIC XXX.
  6698     12  FILLER REDEFINES CM-USER-RESERVED.
  6699         16  CM-AH-CLASS-CD                PIC XX.
  6700         16  F                             PIC X.
  6701******************************************************************
  6702*                                COPY ERCNOTE.
  6703******************************************************************
  6704*                                                                *
  6705*                                                                *
  6706*                            ERCNOTE                             *
  6707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6708*                            VMOD=2.003                          *
  6709*                                                                *
  6710*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6711*                                                                *
  6712*        FILE TYPE= VSAM,KSDS                                    *
  6713*        RECORD SIZE = 825    RECFORM = FIXED                    *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 124
* VP6311.cbl
  6714*                                                                *
  6715*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6716*                                                                *
  6717*        LOG = YES                                               *
  6718*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6719*                                                                *
  6720******************************************************************
  6721*                   C H A N G E   L O G
  6722*
  6723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6724*-----------------------------------------------------------------
  6725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6726* EFFECTIVE    NUMBER
  6727*-----------------------------------------------------------------
  6728* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6729*                                FILE WILL CONTAIN BILLING NOTES O
  6730******************************************************************
  6731
  6732 01  CERTIFICATE-NOTE.
  6733     12  CN-RECORD-ID                PIC  XX.
  6734         88  VALID-CN-ID                  VALUE 'CN'.
  6735
  6736     12  CN-CONTROL-PRIMARY.
  6737         16  CN-COMPANY-CD           PIC X.
  6738         16  CN-CARRIER              PIC X.
  6739         16  CN-GROUPING.
  6740             20 CN-GROUPING-PREFIX   PIC XXX.
  6741             20 CN-GROUPING-PRIME    PIC XXX.
  6742         16  CN-STATE                PIC XX.
  6743         16  CN-ACCOUNT.
  6744             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6745             20 CN-ACCOUNT-PRIME     PIC X(6).
  6746         16  CN-CERT-EFF-DT          PIC XX.
  6747         16  CN-CERT-NO.
  6748             20  CN-CERT-PRIME       PIC X(10).
  6749             20  CN-CERT-SFX         PIC X.
  6750
  6751     12  CN-BILLING-START-LINE-NO    PIC 99.
  6752     12  CN-BILLING-END-LINE-NO      PIC 99.
  6753
  6754     12  CN-LINES.
  6755         16  CN-LINE OCCURS 10       PIC X(77).
  6756
  6757     12  CN-LAST-MAINT-DT            PIC XX.
  6758     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6759     12  CN-LAST-MAINT-USER          PIC X(4).
  6760     12  FILLER                      PIC X(6).
  6761******************************************************************
  6762*                                COPY ERCPNDM.
  6763******************************************************************
  6764*                                                                *
  6765*                                                                *
  6766*                            ERCPNDM                             *
  6767*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6768*                            VMOD=2.003                          *
  6769*                                                                *
  6770*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6771*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 125
* VP6311.cbl
  6772*   FILE TYPE = VSAM,KSDS                                        *
  6773*   RECORD SIZE = 374   RECFORM = FIX                            *
  6774*                                                                *
  6775*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6776*   ALTERNATE PATH    = NOT USED                                 *
  6777*                                                                *
  6778*   LOG = YES                                                    *
  6779*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6780******************************************************************
  6781*                   C H A N G E   L O G
  6782*
  6783* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6784*-----------------------------------------------------------------
  6785*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6786* EFFECTIVE    NUMBER
  6787*-----------------------------------------------------------------
  6788* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6789* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6790* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6791******************************************************************
  6792
  6793 01  PENDING-MAILING-DATA.
  6794     12  PM-RECORD-ID                      PIC XX.
  6795         88  VALID-MA-ID                       VALUE 'PM'.
  6796
  6797     12  PM-CONTROL-PRIMARY.
  6798         16  PM-COMPANY-CD                 PIC X.
  6799         16  PM-ENTRY-BATCH                PIC X(6).
  6800         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6801         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6802
  6803     12  FILLER                            PIC X(14).
  6804
  6805     12  PM-ACCESS-CONTROL.
  6806         16  PM-SOURCE-SYSTEM              PIC XX.
  6807             88  PM-FROM-CREDIT                VALUE 'CR'.
  6808             88  PM-FROM-VSI                   VALUE 'VS'.
  6809             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6810             88  PM-FROM-OTHER                 VALUE 'OT'.
  6811         16  PM-RECORD-ADD-DT              PIC XX.
  6812         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6813         16  PM-LAST-MAINT-DT              PIC XX.
  6814         16  PM-LAST-MAINT-BY              PIC XXXX.
  6815         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6816
  6817     12  PM-PROFILE-INFO.
  6818         16  PM-QUALIFY-CODE-1             PIC XX.
  6819         16  PM-QUALIFY-CODE-2             PIC XX.
  6820         16  PM-QUALIFY-CODE-3             PIC XX.
  6821         16  PM-QUALIFY-CODE-4             PIC XX.
  6822         16  PM-QUALIFY-CODE-5             PIC XX.
  6823
  6824         16  PM-INSURED-LAST-NAME          PIC X(15).
  6825         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6826         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6827         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6828         16  PM-INSURED-BIRTH-DT           PIC XX.
  6829         16  PM-INSURED-SEX                PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 126
* VP6311.cbl
  6830             88  PM-SEX-MALE                   VALUE 'M'.
  6831             88  PM-SEX-FEMALE                 VALUE 'F'.
  6832         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6833
  6834         16  PM-ADDRESS-CORRECTED          PIC X.
  6835         16  PM-JOINT-BIRTH-DT             PIC XX.
  6836*        16  FILLER                        PIC X(12).
  6837
  6838         16  PM-ADDRESS-LINE-1             PIC X(30).
  6839         16  PM-ADDRESS-LINE-2             PIC X(30).
  6840         16  PM-CITY-STATE.
  6841             20  PM-CITY                   PIC X(28).
  6842             20  PM-STATE                  PIC XX.
  6843         16  PM-ZIP.
  6844             20  PM-ZIP-CODE.
  6845                 24  PM-ZIP-1              PIC X.
  6846                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6847                 24  FILLER                PIC X(4).
  6848             20  PM-ZIP-PLUS4              PIC X(4).
  6849         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6850             20  PM-CAN-POST1              PIC XXX.
  6851             20  PM-CAN-POST2              PIC XXX.
  6852             20  FILLER                    PIC XXX.
  6853
  6854         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6855
  6856         16  FILLER                        PIC X(03).
  6857
  6858     12  PM-CRED-BENE-INFO.
  6859         16  PM-CRED-BENE-NAME             PIC X(25).
  6860         16  PM-CRED-BENE-ADDR             PIC X(30).
  6861         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6862         16  PM-CRED-BENE-CTYST.
  6863             20  PM-CRED-BENE-CITY         PIC X(28).
  6864             20  PM-CRED-BENE-STATE        PIC XX.
  6865         16  PM-CRED-BENE-ZIP.
  6866             20  PM-CB-ZIP-CODE.
  6867                 24  PM-CB-ZIP-1           PIC X.
  6868                     88  PM-CB-CANADIAN-POST-CODE
  6869                                  VALUE 'A' THRU 'Z'.
  6870                 24  FILLER                PIC X(4).
  6871             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6872         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6873             20  PM-CB-CAN-POST1           PIC XXX.
  6874             20  PM-CB-CAN-POST2           PIC XXX.
  6875             20  FILLER                    PIC XXX.
  6876     12  PM-POST-CARD-MAIL-DATA.
  6877         16  PM-MAIL-DATA OCCURS 7.
  6878             20  PM-MAIL-TYPE              PIC X.
  6879                 88  PM-12MO-MAILING           VALUE '1'.
  6880                 88  PM-EXP-MAILING            VALUE '2'.
  6881             20  PM-MAIL-STATUS            PIC X.
  6882                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6883                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6884                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6885             20  PM-MAIL-DATE              PIC XX.
  6886     12  FILLER                            PIC XX.
  6887     12  FILLER                            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 127
* VP6311.cbl
  6888*    12  FILLER                            PIC X(30).
  6889
  6890******************************************************************
  6891*                                COPY ERCMAIL.
  6892******************************************************************
  6893*                                                                *
  6894*                                                                *
  6895*                            ERCMAIL                             *
  6896*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6897*                            VMOD=2.003                          *
  6898*                                                                *
  6899*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6900*                                                                *
  6901*   FILE TYPE = VSAM,KSDS                                        *
  6902*   RECORD SIZE = 374   RECFORM = FIX                            *
  6903*                                                                *
  6904*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6905*   ALTERNATE PATH    = NOT USED                                 *
  6906*                                                                *
  6907*   LOG = YES                                                    *
  6908*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6909******************************************************************
  6910*                   C H A N G E   L O G
  6911*
  6912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6913*-----------------------------------------------------------------
  6914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6915* EFFECTIVE    NUMBER
  6916*-----------------------------------------------------------------
  6917* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6918* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6919* 111108                   PEMA  ADD CRED BENE ADDR2
  6920******************************************************************
  6921
  6922 01  MAILING-DATA.
  6923     12  MA-RECORD-ID                      PIC XX.
  6924         88  VALID-MA-ID                       VALUE 'MA'.
  6925
  6926     12  MA-CONTROL-PRIMARY.
  6927         16  MA-COMPANY-CD                 PIC X.
  6928         16  MA-CARRIER                    PIC X.
  6929         16  MA-GROUPING.
  6930             20  MA-GROUPING-PREFIX        PIC XXX.
  6931             20  MA-GROUPING-PRIME         PIC XXX.
  6932         16  MA-STATE                      PIC XX.
  6933         16  MA-ACCOUNT.
  6934             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6935             20  MA-ACCOUNT-PRIME          PIC X(6).
  6936         16  MA-CERT-EFF-DT                PIC XX.
  6937         16  MA-CERT-NO.
  6938             20  MA-CERT-PRIME             PIC X(10).
  6939             20  MA-CERT-SFX               PIC X.
  6940
  6941     12  FILLER                            PIC XX.
  6942
  6943     12  MA-ACCESS-CONTROL.
  6944         16  MA-SOURCE-SYSTEM              PIC XX.
  6945             88  MA-FROM-CREDIT                VALUE 'CR'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 128
* VP6311.cbl
  6946             88  MA-FROM-VSI                   VALUE 'VS'.
  6947             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6948             88  MA-FROM-OTHER                 VALUE 'OT'.
  6949         16  MA-RECORD-ADD-DT              PIC XX.
  6950         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6951         16  MA-LAST-MAINT-DT              PIC XX.
  6952         16  MA-LAST-MAINT-BY              PIC XXXX.
  6953         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6954
  6955     12  MA-PROFILE-INFO.
  6956         16  MA-QUALIFY-CODE-1             PIC XX.
  6957         16  MA-QUALIFY-CODE-2             PIC XX.
  6958         16  MA-QUALIFY-CODE-3             PIC XX.
  6959         16  MA-QUALIFY-CODE-4             PIC XX.
  6960         16  MA-QUALIFY-CODE-5             PIC XX.
  6961
  6962         16  MA-INSURED-LAST-NAME          PIC X(15).
  6963         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6964         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6965         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6966         16  MA-INSURED-BIRTH-DT           PIC XX.
  6967         16  MA-INSURED-SEX                PIC X.
  6968             88  MA-SEX-MALE                   VALUE 'M'.
  6969             88  MA-SEX-FEMALE                 VALUE 'F'.
  6970         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6971
  6972         16  MA-ADDRESS-CORRECTED          PIC X.
  6973         16  MA-JOINT-BIRTH-DT             PIC XX.
  6974*        16  FILLER                        PIC X(12).
  6975
  6976         16  MA-ADDRESS-LINE-1             PIC X(30).
  6977         16  MA-ADDRESS-LINE-2             PIC X(30).
  6978         16  MA-CITY-STATE.
  6979             20  MA-CITY                   PIC X(28).
  6980             20  MA-ADDR-STATE             PIC XX.
  6981         16  MA-ZIP.
  6982             20  MA-ZIP-CODE.
  6983                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6984                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6985                 24  FILLER                PIC X(4).
  6986             20  MA-ZIP-PLUS4              PIC X(4).
  6987         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6988             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6989             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6990             20  FILLER                    PIC X(3).
  6991
  6992         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6993
  6994         16  FILLER                        PIC XXX.
  6995*        16  FILLER                        PIC X(10).
  6996
  6997     12  MA-CRED-BENE-INFO.
  6998         16  MA-CRED-BENE-NAME                 PIC X(25).
  6999         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7000         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7001         16  MA-CRED-BENE-CTYST.
  7002             20  MA-CRED-BENE-CITY             PIC X(28).
  7003             20  MA-CRED-BENE-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 129
* VP6311.cbl
  7004         16  MA-CRED-BENE-ZIP.
  7005             20  MA-CB-ZIP-CODE.
  7006                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7007                     88  MA-CB-CANADIAN-POST-CODE
  7008                                           VALUE 'A' THRU 'Z'.
  7009                 24  FILLER                    PIC X(4).
  7010             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7011         16  MA-CB-CANADIAN-POSTAL-CODE
  7012                            REDEFINES MA-CRED-BENE-ZIP.
  7013             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7014             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7015             20  FILLER                        PIC X(3).
  7016     12  MA-POST-CARD-MAIL-DATA.
  7017         16  MA-MAIL-DATA OCCURS 7.
  7018             20  MA-MAIL-TYPE              PIC X.
  7019                 88  MA-12MO-MAILING           VALUE '1'.
  7020                 88  MA-EXP-MAILING            VALUE '2'.
  7021             20  MA-MAIL-STATUS            PIC X.
  7022                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7023                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7024                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7025             20  MA-MAIL-DATE              PIC XX.
  7026     12  FILLER                            PIC XX.
  7027     12  FILLER                            PIC XX.
  7028*    12  FILLER                            PIC X(30).
  7029******************************************************************
  7030*                                COPY ERCRQST.
  7031******************************************************************
  7032*                                                                *
  7033*                                                                *
  7034*                            ERCRQST.                            *
  7035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7036*                            VMOD=2.002                          *
  7037*                                                                *
  7038*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7039*                                                                *
  7040*   FILE TYPE = VSAM,KSDS                                        *
  7041*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7042*                                                                *
  7043*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7044*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7045*                                   ACCOUNT, REF, BATCH)         *
  7046*                                                RKP=9, LEN=38   *
  7047*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7048*                                   ACCOUNT, REF, BATCH)         *
  7049*                                                RKP=47, LEN=46  *
  7050*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7051*                                   BATCH)                       *
  7052*                                                RKP=93, LEN=24  *
  7053*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7054*                                   REF, BATCH)                  *
  7055*                                                RKP=117, LEN=35 *
  7056*   LOG = NO                                                     *
  7057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7058******************************************************************
  7059
  7060 01  AR-REQUEST-RECORD.
  7061     12  RQ-RECORD-ID                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 130
* VP6311.cbl
  7062         88  VALID-RQ-ID                        VALUE 'RQ'.
  7063
  7064     12  RQ-CONTROL-PRIMARY.
  7065         16  RQ-COMPANY-CD                PIC X.
  7066         16  RQ-ENTRY-BATCH               PIC X(6).
  7067
  7068     12  RQ-CONTROL-BY-ACCT-REF.
  7069         16  RQ-COMPANY-CD-A1             PIC X.
  7070         16  RQ-CARRIER-A1                PIC X.
  7071         16  RQ-GROUPING-A1               PIC X(6).
  7072         16  RQ-STATE-A1                  PIC XX.
  7073         16  RQ-ACCOUNT-A1                PIC X(10).
  7074         16  RQ-REFERENCE-A1              PIC X(12).
  7075         16  RQ-BATCH-A1                  PIC X(6).
  7076
  7077     12  RQ-CONTROL-BY-FIN-RESP.
  7078         16  RQ-COMPANY-CD-A2             PIC X.
  7079         16  RQ-CARRIER-A2                PIC X.
  7080         16  RQ-GROUPING-A2               PIC X(6).
  7081         16  RQ-FIN-RESP-A2               PIC X(10).
  7082         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7083         16  RQ-REFERENCE-A2              PIC X(12).
  7084         16  RQ-BATCH-A2                  PIC X(6).
  7085
  7086     12  RQ-CONTROL-BY-ACCT-AGENT.
  7087         16  RQ-COMPANY-CD-A3             PIC X.
  7088         16  RQ-CARRIER-A3                PIC X.
  7089         16  RQ-GROUPING-A3               PIC X(6).
  7090         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7091         16  RQ-BATCH-A3                  PIC X(6).
  7092
  7093     12  RQ-CONTROL-BY-SUMMARY.
  7094         16  RQ-COMPANY-CD-A4             PIC X.
  7095         16  RQ-SUMMARY-CODE              PIC X(6).
  7096         16  RQ-ACCOUNT-A4                PIC X(10).
  7097         16  RQ-REFERENCE-A4              PIC X(12).
  7098         16  RQ-BATCH-A4                  PIC X(6).
  7099
  7100     12  RQ-REQUEST-METHOD                PIC X.
  7101         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7102         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7103         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7104         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7105     12  FILLER                           PIC X.
  7106     12  RQ-STATUS                        PIC X.
  7107         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7108         88  RQ-RESUBMIT                      VALUE 'R'.
  7109     12  RQ-PROCESSOR-ID                  PIC X(4).
  7110     12  RQ-ENTRY-DT                      PIC XX.
  7111     12  RQ-MO-END-DT                     PIC XX.
  7112     12  RQ-REQUEST-DT                    PIC XX.
  7113     12  RQ-STMT-DT                       PIC XX.
  7114     12  RQ-REVERSAL-DT                   PIC XX.
  7115     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7116     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7117
  7118     12  FILLER                           PIC X(27).
  7119
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 131
* VP6311.cbl
  7120******************************************************************
  7121
  7122*                                COPY ERCLOFC.
  7123******************************************************************
  7124*                                                                *
  7125*                                                                *
  7126*                            ERCLOFC                             *
  7127*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7128*                            VMOD=2.003                          *
  7129*                                                                *
  7130*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7131*                                                                *
  7132*   FILE TYPE = VSAM,KSDS                                        *
  7133*   RECORD SIZE = 670   RECFORM = FIX                            *
  7134*                                                                *
  7135*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7136*                                                                *
  7137*   LOG = YES                                                    *
  7138*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7139*                                                                *
  7140******************************************************************
  7141
  7142 01  LOAN-OFFICER-MASTER.
  7143     12  LO-RECORD-ID                PIC XX.
  7144         88  VALID-LO-ID                VALUE 'LO'.
  7145
  7146     12  LO-CONTROL-PRIMARY.
  7147         16  LO-COMPANY-CD           PIC X.
  7148         16  LO-CARRIER              PIC X.
  7149         16  LO-GROUPING.
  7150             20  LO-GROUPING-PREFIX  PIC XXX.
  7151             20  LO-GROUPING-PRIME   PIC XXX.
  7152         16  LO-STATE                PIC XX.
  7153         16  LO-ACCOUNT.
  7154             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7155             20  LO-ACCOUNT-PRIME    PIC X(6).
  7156         16  LO-OFFICER-CODE         PIC X(5).
  7157
  7158     12  LO-OFFICER-NAME             PIC X(30).
  7159
  7160     12  LO-LAST-MAINT-DT            PIC XX.
  7161     12  LO-LAST-USER                PIC X(4).
  7162     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7163
  7164     12  LO-COMP-CONTROL             PIC X.
  7165             88  LO-SHOW-COMP           VALUE 'Y'.
  7166             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7167     12  LO-DETAIL-CONTROL           PIC X.
  7168             88  LO-PRINT-DETAIL        VALUE 'D'.
  7169             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7170
  7171     12  LO-SV-CARRIER               PIC X.
  7172     12  LO-SV-GROUPING              PIC X(6).
  7173     12  LO-SV-STATE                 PIC XX.
  7174
  7175     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7176     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7177
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 132
* VP6311.cbl
  7178     12  LO-OFFICER-INFO.
  7179         16  FILLER OCCURS 12 TIMES.
  7180             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7181             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7182             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7183             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7184             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7185             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7186             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7187             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7188     12  FILLER                      PIC X(198).
  7189******************************************************************
  7190*                                COPY ERCPYAJ.
  7191******************************************************************
  7192*                                                                *
  7193*                            ERCPYAJ                             *
  7194*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7195*                            VMOD=2.015                          *
  7196*                                                                *
  7197*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7198*                                                                *
  7199*                                                                *
  7200*   FILE TYPE = VSAM,KSDS                                        *
  7201*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7202*                                                                *
  7203*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7204*       ALTERNATE PATHS = NONE                                   *
  7205*                                                                *
  7206*   LOG = YES                                                    *
  7207*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7208******************************************************************
  7209******************************************************************
  7210*                   C H A N G E   L O G
  7211*
  7212* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7213*-----------------------------------------------------------------
  7214*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7215* EFFECTIVE    NUMBER
  7216*-----------------------------------------------------------------
  7217* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7218* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7219******************************************************************
  7220
  7221 01  PENDING-PAY-ADJ.
  7222     12  PY-RECORD-ID                     PIC XX.
  7223         88  VALID-PY-ID                        VALUE 'PY'.
  7224
  7225     12  PY-CONTROL-PRIMARY.
  7226         16  PY-COMPANY-CD                PIC X.
  7227         16  PY-CARRIER                   PIC X.
  7228         16  PY-GROUPING                  PIC X(6).
  7229         16  PY-FIN-RESP                  PIC X(10).
  7230         16  PY-ACCOUNT                   PIC X(10).
  7231         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7232                                          PIC X(10).
  7233         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7234         16  PY-RECORD-TYPE               PIC X.
  7235             88  PY-REMIT-RECEIVED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 133
* VP6311.cbl
  7236             88  PY-DEPOSIT                   VALUE 'D'.
  7237             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7238             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7239             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7240             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7241             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7242             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7243             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7244             88  PY-FICA-ENTRY                VALUE 'F'.
  7245             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7246             88  PY-POLICY-FEE                VALUE 'W'.
  7247             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7248
  7249     12  PY-PYMT-TYPE                     PIC X.
  7250             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7251             88  PY-REINS-PYMT                VALUE 'R'.
  7252             88  PY-EXP-PYMT                  VALUE 'E'.
  7253
  7254     12  PY-BIL-INV                       PIC X(6).
  7255     12  PY-REF-NO                        PIC X(12).
  7256
  7257     12  PY-LAST-MAINT-DT                 PIC XX.
  7258     12  PY-LAST-MAINT-BY                 PIC X(4).
  7259     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7260
  7261     12  PY-PYADJ-RECORD.
  7262         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7263         16  PY-ENTRY-COMMENT             PIC X(30).
  7264         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7265             20  PY-GL-ACCOUNT            PIC X(10).
  7266             20  PY-GL-STATE              PIC X(02).
  7267             20  PY-GL-CANC-SW            PIC X(01).
  7268                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7269                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7270             20  PY-GL-COMMENT            PIC X(10).
  7271             20  FILLER      REDEFINES PY-GL-COMMENT.
  7272                 24  PY-GL-CHECK-NO       PIC 9(06).
  7273                 24  FILLER               PIC X(04).
  7274             20  FILLER                   PIC X(07).
  7275         16  PY-SAVE-ACCOUNT              PIC X(10).
  7276         16  PY-SAVE-TYPE                 PIC X(01).
  7277
  7278         16  PY-LETTERS.
  7279             20  PY-LETTER OCCURS 3 TIMES
  7280                           INDEXED BY PY-LET-NDX
  7281                                          PIC X(04).
  7282
  7283         16  PY-ERCOMP-TYPE               PIC X.
  7284             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7285             88  PY-GA-TYPE                   VALUE 'G'.
  7286             88  PY-BANK-TYPE                 VALUE 'B'.
  7287         16  FILLER                       PIC X(05).
  7288
  7289     12  PY-RECORD-STATUS.
  7290         16  PY-CREDIT-SELECT-DT          PIC XX.
  7291         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7292         16  PY-BILLED-DATE               PIC XX.
  7293         16  PY-REPORTED-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 134
* VP6311.cbl
  7294         16  PY-PMT-APPLIED               PIC X.
  7295             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7296             88  PY-GA-PMT                    VALUE 'G'.
  7297             88  PY-OVWRITE-PMT               VALUE 'O'.
  7298             88  PY-NON-AR-PMT                VALUE 'N'.
  7299         16  FILLER                       PIC X(5).
  7300         16  PY-INPUT-DT                  PIC XX.
  7301         16  PY-CHECK-NUMBER              PIC X(6).
  7302         16  PY-VOID-SW                   PIC X.
  7303             88  PY-CHECK-VOIDED              VALUE 'V'.
  7304         16  PY-CHECK-ORIGIN-SW           PIC X.
  7305             88  PY-BILLING-CHECK             VALUE 'B'.
  7306             88  PY-REFUND-CHECK              VALUE 'R'.
  7307             88  PY-GA-CHECK                  VALUE 'G'.
  7308             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7309             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7310         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7311         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7312         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7313         16  PY-BILL-FLAG                 PIC X.
  7314             88  PY-BILLED                    VALUE 'B'.
  7315         16  PY-AR-FLAG                   PIC X.
  7316             88  PY-AR-CYCLE                  VALUE 'C'.
  7317             88  PY-AR-MONTH-END              VALUE 'M'.
  7318         16  PY-AR-DATE                   PIC XX.
  7319
  7320     12  PY-GL-CODES.
  7321         16  PY-GL-DB                     PIC X(14).
  7322         16  PY-GL-CR                     PIC X(14).
  7323         16  PY-GL-FLAG                   PIC X.
  7324         16  PY-GL-DATE                   PIC XX.
  7325
  7326     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7327     12  FILLER                           PIC X(3).
  7328******************************************************************
  7329*                                COPY ERCCNOT.
  7330******************************************************************
  7331*                                                                *
  7332*                            ERCCNOT                             *
  7333*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7334*                            VMOD=2.003                          *
  7335*                                                                *
  7336*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7337*                                                                *
  7338*        FILE TYPE= VSAM,KSDS                                    *
  7339*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7340*                                                                *
  7341*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7342*                                                                *
  7343*        LOG = YES                                               *
  7344*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7345*                                                                *
  7346******************************************************************
  7347*                   C H A N G E   L O G
  7348*
  7349* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7350*-----------------------------------------------------------------
  7351*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 135
* VP6311.cbl
  7352* EFFECTIVE    NUMBER
  7353*-----------------------------------------------------------------
  7354* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7355******************************************************************
  7356
  7357 01  CERT-NOTE-FILE.
  7358     12  CZ-RECORD-ID                PIC  XX.
  7359         88  VALID-CZ-ID                  VALUE 'CZ'.
  7360
  7361     12  CZ-CONTROL-PRIMARY.
  7362         16  CZ-COMPANY-CD           PIC X.
  7363         16  CZ-CARRIER              PIC X.
  7364         16  CZ-GROUPING.
  7365             20 CZ-GROUPING-PREFIX   PIC XXX.
  7366             20 CZ-GROUPING-PRIME    PIC XXX.
  7367         16  CZ-STATE                PIC XX.
  7368         16  CZ-ACCOUNT.
  7369             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7370             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7371         16  CZ-CERT-EFF-DT          PIC XX.
  7372         16  CZ-CERT-NO.
  7373             20  CZ-CERT-PRIME       PIC X(10).
  7374             20  CZ-CERT-SFX         PIC X.
  7375         16  CZ-RECORD-TYPE          PIC X.
  7376             88  CERT-NOTE           VALUE '1'.
  7377             88  CLAIM-CERT-NOTE     VALUE '2'.
  7378         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7379
  7380     12  CZ-LAST-MAINT-DT            PIC XX.
  7381     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7382     12  CZ-LAST-MAINT-USER          PIC X(4).
  7383
  7384     12  CZ-NOTE-INFORMATION.
  7385         16  CZ-NOTE                 PIC X(63).
  7386         16  FILLER                  PIC X(39).
  7387******************************************************************
  7388*                                COPY ELCMSTR.
  7389******************************************************************
  7390*                                                                *
  7391*                            ELCMSTR.                            *
  7392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7393*                            VMOD=2.012                          *
  7394*                                                                *
  7395*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7396*                                                                *
  7397*   FILE TYPE = VSAM,KSDS                                        *
  7398*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7399*                                                                *
  7400*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7401*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7402*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7403*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7404*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7405*                                                 RKP=75,LEN=21  *
  7406*                                                                *
  7407*   **** NOTE ****                                               *
  7408*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7409*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 136
* VP6311.cbl
  7410*                                                                *
  7411*   LOG = YES                                                    *
  7412*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7413******************************************************************
  7414*                   C H A N G E   L O G
  7415*
  7416* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7417*-----------------------------------------------------------------
  7418*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7419* EFFECTIVE    NUMBER
  7420*-----------------------------------------------------------------
  7421* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7422* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7423* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7424* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7425* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7426******************************************************************
  7427 01  CLAIM-MASTER.
  7428     12  CL-RECORD-ID                PIC XX.
  7429         88  VALID-CL-ID         VALUE 'CL'.
  7430
  7431     12  CL-CONTROL-PRIMARY.
  7432         16  CL-COMPANY-CD           PIC X.
  7433         16  CL-CARRIER              PIC X.
  7434         16  CL-CLAIM-NO             PIC X(7).
  7435         16  CL-CERT-NO.
  7436             20  CL-CERT-PRIME       PIC X(10).
  7437             20  CL-CERT-SFX         PIC X.
  7438
  7439     12  CL-CONTROL-BY-NAME.
  7440         16  CL-COMPANY-CD-A1        PIC X.
  7441         16  CL-INSURED-LAST-NAME    PIC X(15).
  7442         16  CL-INSURED-NAME.
  7443             20  CL-INSURED-1ST-NAME PIC X(12).
  7444             20  CL-INSURED-MID-INIT PIC X.
  7445
  7446     12  CL-CONTROL-BY-SSN.
  7447         16  CL-COMPANY-CD-A2        PIC X.
  7448         16  CL-SOC-SEC-NO.
  7449             20  CL-SSN-STATE        PIC XX.
  7450             20  CL-SSN-ACCOUNT      PIC X(6).
  7451             20  CL-SSN-LN3          PIC X(3).
  7452
  7453     12  CL-CONTROL-BY-CERT-NO.
  7454         16  CL-COMPANY-CD-A4        PIC X.
  7455         16  CL-CERT-NO-A4.
  7456             20  CL-CERT-A4-PRIME    PIC X(10).
  7457             20  CL-CERT-A4-SFX      PIC X.
  7458
  7459     12  CL-CONTROL-BY-CCN.
  7460         16  CL-COMPANY-CD-A5        PIC X.
  7461         16  CL-CCN-A5.
  7462             20  CL-CCN.
  7463                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7464                 24  CL-CCN-PRIME-A5 PIC X(12).
  7465             20  CL-CCN-FILLER-A5    PIC X(4).
  7466
  7467     12  CL-INSURED-PROFILE-DATA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 137
* VP6311.cbl
  7468         16  CL-INSURED-BIRTH-DT     PIC XX.
  7469         16  CL-INSURED-SEX-CD       PIC X.
  7470             88  INSURED-IS-MALE        VALUE 'M'.
  7471             88  INSURED-IS-FEMALE      VALUE 'F'.
  7472             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7473         16  CL-INSURED-OCC-CD       PIC X(6).
  7474         16  FILLER                  PIC X(5).
  7475
  7476     12  CL-PROCESSING-INFO.
  7477         16  CL-PROCESSOR-ID         PIC X(4).
  7478         16  CL-CLAIM-STATUS         PIC X.
  7479             88  CLAIM-IS-OPEN          VALUE 'O'.
  7480             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7481         16  CL-CLAIM-TYPE           PIC X.
  7482*            88  AH-CLAIM               VALUE 'A'.
  7483*            88  LIFE-CLAIM             VALUE 'L'.
  7484*            88  PROPERTY-CLAIM         VALUE 'P'.
  7485*            88  IUI-CLAIM              VALUE 'I'.
  7486*            88  GAP-CLAIM              VALUE 'G'.
  7487*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7488         16  CL-CLAIM-PREM-TYPE      PIC X.
  7489             88  SINGLE-PREMIUM         VALUE '1'.
  7490             88  O-B-COVERAGE           VALUE '2'.
  7491             88  OPEN-END-COVERAGE      VALUE '3'.
  7492         16  CL-INCURRED-DT          PIC XX.
  7493         16  CL-REPORTED-DT          PIC XX.
  7494         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7495         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7496         16  CL-LAST-PMT-DT          PIC XX.
  7497         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7498         16  CL-PAID-THRU-DT         PIC XX.
  7499         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7500         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7501         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7502         16  CL-PMT-CALC-METHOD      PIC X.
  7503             88  CL-360-DAY-YR          VALUE '1'.
  7504             88  CL-365-DAY-YR          VALUE '2'.
  7505             88  CL-FULL-MONTHS         VALUE '3'.
  7506         16  CL-CAUSE-CD             PIC X(6).
  7507
  7508         16  CL-PRIME-CERT-NO.
  7509             20  CL-PRIME-CERT-PRIME PIC X(10).
  7510             20  CL-PRIME-CERT-SFX   PIC X.
  7511
  7512         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7513             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7514             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7515
  7516         16  CL-MICROFILM-NO         PIC X(10).
  7517         16  FILLER REDEFINES CL-MICROFILM-NO.
  7518             20  CL-BENEFIT-PERIOD   PIC 99.
  7519             20  FILLER              PIC X(8).
  7520         16  CL-PROG-FORM-TYPE       PIC X.
  7521         16  CL-LAST-ADD-ON-DT       PIC XX.
  7522
  7523         16  CL-LAST-REOPEN-DT       PIC XX.
  7524         16  CL-LAST-CLOSE-DT        PIC XX.
  7525         16  CL-LAST-CLOSE-REASON    PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 138
* VP6311.cbl
  7526             88  FINAL-PAID             VALUE '1'.
  7527             88  CLAIM-DENIED           VALUE '2'.
  7528             88  AUTO-CLOSE             VALUE '3'.
  7529             88  MANUAL-CLOSE           VALUE '4'.
  7530             88  BENEFITS-CHANGED       VALUE 'C'.
  7531             88  SETUP-ERRORS           VALUE 'E'.
  7532         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7533         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7534         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7535             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7536         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7537         16  FILLER                  PIC X.
  7538
  7539     12  CL-CERTIFICATE-DATA.
  7540         16  CL-CERT-ORIGIN          PIC X.
  7541             88  CERT-WAS-ONLINE        VALUE '1'.
  7542             88  CERT-WAS-CREATED       VALUE '2'.
  7543             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7544         16  CL-CERT-KEY-DATA.
  7545             20  CL-CERT-CARRIER     PIC X.
  7546             20  CL-CERT-GROUPING    PIC X(6).
  7547             20  CL-CERT-STATE       PIC XX.
  7548             20  CL-CERT-ACCOUNT.
  7549                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7550                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7551             20  CL-CERT-EFF-DT      PIC XX.
  7552
  7553     12  CL-STATUS-CONTROLS.
  7554         16  CL-PRIORITY-CD          PIC X.
  7555             88  CONFIDENTIAL-DATA      VALUE '8'.
  7556             88  HIGHEST-PRIORITY       VALUE '9'.
  7557         16  CL-SUPV-ATTN-CD         PIC X.
  7558             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7559             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7560         16  CL-PURGED-DT            PIC XX.
  7561         16  CL-RESTORED-DT          PIC XX.
  7562         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7563         16  CL-NEXT-RESEND-DT       PIC XX.
  7564         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7565         16  CL-CRITICAL-PERIOD      PIC 99.
  7566*        16  FILLER                  PIC XX.
  7567         16  CL-LAST-MAINT-DT        PIC XX.
  7568         16  CL-LAST-MAINT-USER      PIC X(4).
  7569         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7570         16  CL-LAST-MAINT-TYPE      PIC X.
  7571             88  CLAIM-SET-UP           VALUE ' '.
  7572             88  PAYMENT-MADE           VALUE '1'.
  7573             88  LETTER-SENT            VALUE '2'.
  7574             88  MASTER-WAS-ALTERED     VALUE '3'.
  7575             88  MASTER-WAS-RESTORED    VALUE '4'.
  7576             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7577             88  FILE-CONVERTED         VALUE '6'.
  7578             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7579             88  ERROR-CORRECTION       VALUE 'E'.
  7580         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7581         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7582         16  CL-BENEFICIARY          PIC X(10).
  7583         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 139
* VP6311.cbl
  7584         16  CL-DENIAL-TYPE          PIC X.
  7585             88  CL-TYPE-DENIAL          VALUE '1'.
  7586             88  CL-TYPE-RESCISSION      VALUE '2'.
  7587             88  CL-TYPE-REFORMATION     VALUE '3'.
  7588             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7589             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7590         16  filler                  pic x(5).
  7591*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7592*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7593*        16  CL-RTW-DT               PIC XX.
  7594
  7595     12  CL-TRAILER-CONTROLS.
  7596         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7597             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7598             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7599             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7600         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7601         16  FILLER                  PIC XX.
  7602         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7603         16  CL-ADDRESS-TRAILER-CNT.
  7604             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7605                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7606             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7607                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7608             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7609                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7610             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7611                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7612             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7613                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7614             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7615                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7616             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7617                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7618
  7619     12  CL-CV-REFERENCE-NO.
  7620         16  CL-CV-REFNO-PRIME       PIC X(18).
  7621         16  CL-CV-REFNO-SFX         PIC XX.
  7622
  7623     12  CL-FILE-LOCATION            PIC X(4).
  7624
  7625     12  CL-PROCESS-ERRORS.
  7626         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7627             88  NO-FATAL-ERRORS        VALUE ZERO.
  7628         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7629             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7630
  7631     12  CL-PRODUCT-CD               PIC X.
  7632
  7633     12  CL-CURRENT-KEY-DATA.
  7634         16  CL-CURRENT-CARRIER      PIC X.
  7635         16  CL-CURRENT-GROUPING     PIC X(6).
  7636         16  CL-CURRENT-STATE        PIC XX.
  7637         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7638
  7639     12  CL-ASSOCIATES               PIC X.
  7640         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7641         88  CL-ASSOC-INTERFACE         VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 140
* VP6311.cbl
  7642         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7643         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7644
  7645     12  CL-ACTIVITY-CODE            PIC 99.
  7646     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7647     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7648
  7649     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7650     12  CL-LAG-REPORT-CODE          PIC 9.
  7651     12  CL-LOAN-TYPE                PIC XX.
  7652     12  CL-LEGAL-STATE              PIC XX.
  7653
  7654     12  CL-YESNOSW                  PIC X.
  7655     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7656         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7657         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7658         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7659     12  cl-insured-type             pic x.
  7660         88  cl-claim-on-primary         value 'P'.
  7661         88  cl-claim-on-co-borrower     value 'C'.
  7662     12  cl-benefit-expiration-dt    PIC XX.
  7663*                                COPY ERCENDT.
  7664******************************************************************
  7665*                                                                *
  7666*                                                                *
  7667*                            ERCENDT.                            *
  7668*                            VMOD=2.001                          *
  7669*                                                                *
  7670*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7671*                                                                *
  7672*   FILE TYPE = VSAM,KSDS                                        *
  7673*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7674*                                                                *
  7675*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7676*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7677*                                                                *
  7678*   LOG = NO                                                     *
  7679*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7680******************************************************************
  7681*-----------------------------------------------------------------
  7682*                   C H A N G E   L O G
  7683*
  7684* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7685*-----------------------------------------------------------------
  7686*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7687* EFFECTIVE    NUMBER
  7688*-----------------------------------------------------------------
  7689* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7690*                                WITH OPEN CLAIMS
  7691* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7692* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7693* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7694* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7695*-----------------------------------------------------------------
  7696 01  ENDORSEMENT-RECORD.
  7697     12  EN-RECORD-ID                PIC XX.
  7698         88  VALID-EN-ID                VALUE 'EN'.
  7699     12  EN-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 141
* VP6311.cbl
  7700         16  EN-COMPANY-CD           PIC X.
  7701         16  EN-CARRIER              PIC X.
  7702         16  EN-GROUPING             PIC X(6).
  7703         16  EN-STATE                PIC XX.
  7704         16  EN-ACCOUNT              PIC X(10).
  7705         16  EN-CERT-EFF-DT          PIC XX.
  7706         16  EN-CERT-NO.
  7707             20  EN-CERT-PRIME       PIC X(10).
  7708             20  EN-CERT-SFX         PIC X.
  7709         16  EN-REC-TYPE             PIC X.
  7710             88  EN-ISSUE               VALUE 'I'.
  7711             88  EN-CANCELLATION        VALUE 'C'.
  7712         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7713     12  EN-CONTROL-BY-ARCH-NO.
  7714         16  EN-COMPANY-CD-A1              PIC X.
  7715         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7716     12  EN-LAST-MAINT-DT            PIC XX.
  7717     12  EN-LAST-MAINT-BY            PIC X(4).
  7718     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7719     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7720     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7721         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7722         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7723         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7724         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7725         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7726         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7727         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7728         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7729         16  EN-LF-ORIG-BENCD        PIC XX.
  7730         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7731         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7732         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7733         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7734         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7735         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7736*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7737         16  EN-ORIG-CRED-BENE       PIC X(25).
  7738         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7739         16  FILLER                  PIC X.
  7740         16  EN-AH-ORIG-BENCD        PIC XX.
  7741         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7742         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7743         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7744         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7745*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7746*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7747         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7748         16  F                       PIC X(09).
  7749         16  EN-AH-ORIG-CP           PIC 99.
  7750         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7751         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7752         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7753         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7754         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7755         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7756         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7757         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 142
* VP6311.cbl
  7758         16  EN-LF-NEW-BENCD         PIC XX.
  7759         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7760         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7761         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7762         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7763         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7764         16  EN-LF-NEW-EXP-DT        PIC XX.
  7765         16  EN-NEW-CRED-BENE        PIC X(25).
  7766         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7767         16  FILLER                  PIC X.
  7768         16  EN-AH-NEW-BENCD         PIC XX.
  7769         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7770         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7771         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7772         16  EN-AH-NEW-EXP-DT        PIC XX.
  7773*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7774*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7775*        16  F                       PIC X(12).
  7776         16  EN-AH-NEW-CP            PIC 99.
  7777         16  EN-SIG-SW               PIC X.
  7778         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7779         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7780         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7781         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7782         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7783         16  FILLER                  PIC X(33).
  7784     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7785         16  EN-LF-ORIG-REF-DT       PIC XX.
  7786         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7787         16  EN-AH-ORIG-REF-DT       PIC XX.
  7788         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7789         16  EN-LF-NEW-REF-DT        PIC XX.
  7790         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7791         16  EN-AH-NEW-REF-DT        PIC XX.
  7792         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7793         16  EN-FLAG-CERT            PIC X.
  7794         16  EN-INS-LAST-NAME        PIC X(15).
  7795         16  EN-INS-FIRST-NAME       PIC X(10).
  7796         16  EN-INS-MIDDLE-INIT      PIC X.
  7797         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7798         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7799         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7800         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7801         16  FILLER                  PIC X(262).
  7802     12  EN-MONEY-SW             PIC X.
  7803     12  EN-HEALTH-APP           PIC X.
  7804     12  EN-VOUCHER-SW           PIC X.
  7805     12  EN-PAYEE                PIC X(14).
  7806     12  EN-INPUT-DT             PIC XX.
  7807     12  EN-PROCESS-DT           PIC XX.
  7808     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7809     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7810     12  EN-REASON-CODES.
  7811         16  F OCCURS 12.
  7812             20  EN-REASON-CODE  PIC X(4).
  7813     12  EN-TEMPLATE-USED        PIC X(8).
  7814     12  EN-DOCU-TYPE            PIC X.
  7815         88  EN-VERI-DOCU          VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 143
* VP6311.cbl
  7816         88  EN-GCE-DOCU           VALUE 'G'.
  7817         88  EN-CANC-DOCU          VALUE 'C'.
  7818     12  EN-COMMENTS1            PIC X(13).
  7819     12  EN-COMMENTS2            PIC X(70).
  7820     12  EN-COMM-CHGBK           PIC X.
  7821         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7822         88  EN-CHG-ACCT           VALUE 'Y'.
  7823     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7824     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7825     12  EN-BATCH-NUMBER         PIC X(6).
  7826     12  EN-ACCT-SUMM            PIC X.
  7827     12  EN-CSO-SUMM             PIC X.
  7828     12  en-check-type           pic x.
  7829     12  FILLER                  PIC X(12).
  7830******************************************************************
  7831*                                COPY ELCCRTT.
  7832******************************************************************
  7833*                                                                *
  7834*                            ELCCRTT.                            *
  7835*                                                                *
  7836*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7837*                                                                *
  7838*   FILE TYPE = VSAM,KSDS                                        *
  7839*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7840*                                                                *
  7841*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7842*                                                                *
  7843*   LOG = YES                                                    *
  7844*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7845******************************************************************
  7846*                   C H A N G E   L O G
  7847*
  7848* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7849*-----------------------------------------------------------------
  7850*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7851* EFFECTIVE    NUMBER
  7852*-----------------------------------------------------------------
  7853* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7854* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7855* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7856* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7857* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7858* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7859* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7860* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7861* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7862******************************************************************
  7863
  7864 01  CERTIFICATE-TRAILERS.
  7865     12  CS-RECORD-ID                      PIC XX.
  7866         88  VALID-CS-ID                      VALUE 'CS'.
  7867
  7868     12  CS-CONTROL-PRIMARY.
  7869         16  CS-COMPANY-CD                 PIC X.
  7870         16  CS-CARRIER                    PIC X.
  7871         16  CS-GROUPING                   PIC X(6).
  7872         16  CS-STATE                      PIC XX.
  7873         16  CS-ACCOUNT                    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 144
* VP6311.cbl
  7874         16  CS-CERT-EFF-DT                PIC XX.
  7875         16  CS-CERT-NO.
  7876             20  CS-CERT-PRIME             PIC X(10).
  7877             20  CS-CERT-SFX               PIC X.
  7878         16  CS-TRAILER-TYPE               PIC X.
  7879             88  COMM-TRLR           VALUE 'A'.
  7880             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7881             88  CERT-DATA-TRLR      VALUE 'C'.
  7882
  7883     12  CS-DATA-AREA                      PIC X(516).
  7884
  7885     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7886         16  CS-BANK-COMMISSION-AREA.
  7887             20  CS-BANK-COMMS       OCCURS 10.
  7888                 24  CS-AGT                PIC X(10).
  7889                 24  CS-COM-TYP            PIC X.
  7890                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7891                 24  CS-RECALC-LV-INDIC    PIC X.
  7892                 24  FILLER                PIC X(10).
  7893         16  FILLER                        PIC X(256).
  7894
  7895     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7896****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7897         16  CS-MB-CLAIM-DATA OCCURS 24.
  7898             20  CS-CLAIM-NO               PIC X(7).
  7899             20  CS-CLAIM-TYPE             PIC X.
  7900                 88  CS-AH-CLM               VALUE 'A'.
  7901                 88  CS-IU-CLM               VALUE 'I'.
  7902                 88  CS-GP-CLM               VALUE 'G'.
  7903                 88  CS-LF-CLM               VALUE 'L'.
  7904                 88  CS-PR-CLM               VALUE 'P'.
  7905                 88  CS-FL-CLM               VALUE 'F'.
  7906             20  CS-INSURED-TYPE           PIC X.
  7907                 88  CS-PRIM-INSURED          VALUE 'P'.
  7908                 88  CS-CO-BORROWER           VALUE 'C'.
  7909             20  CS-BENEFIT-PERIOD         PIC 99.
  7910             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7911             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7912             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7913         16  FILLER                        PIC X(12).
  7914     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7915         16  CS-VIN-NUMBER                 PIC X(17).
  7916         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7917         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7918         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7919         16  cs-agent-name.
  7920             20  cs-agent-fname            pic x(20).
  7921             20  cs-agent-mi               pic x.
  7922             20  cs-agent-lname            pic x(25).
  7923         16  cs-license-no                 pic x(15).
  7924         16  cs-npn-number                 pic x(10).
  7925         16  cs-agent-edit-status          pic x.
  7926             88  cs-ae-refer-to-manager      value 'M'.
  7927             88  cs-ae-cover-sheet           value 'C'.
  7928             88  cs-ae-sig-form              value 'S'.
  7929             88  cs-ae-verified              value 'V'.
  7930             88  cs-unidentified-signature   value 'U'.
  7931             88  cs-cert-returned            value 'R'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 145
* VP6311.cbl
  7932             88  cs-accept-no-commission     value 'N'.
  7933         16  cs-year                       pic 9999.
  7934         16  cs-make                       pic x(20).
  7935         16  cs-model                      pic x(20).
  7936         16  cs-future                     pic x(20).
  7937         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7938         16  FILLER                        PIC X(356). *> was 420
  7939*        16  FILLER                        PIC X(496).
  7940*                                COPY ERCCHEK.
  7941******************************************************************
  7942*                                                                *
  7943*                                                                *
  7944*                            ERCCHEK                             *
  7945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7946*                            VMOD=2.008                          *
  7947*                                                                *
  7948*   FILE DESCRIPTION = CHECK RECORDS                             *
  7949*                                                                *
  7950*   FILE TYPE = VSAM,KSDS                                        *
  7951*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7952*                                                                *
  7953*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7954*       ALTERNATE INDEX = NONE                                   *
  7955*                                                                *
  7956*   LOG = YES                                                    *
  7957*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7958******************************************************************
  7959*                   C H A N G E   L O G
  7960*
  7961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7962*-----------------------------------------------------------------
  7963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7964* EFFECTIVE    NUMBER
  7965*-----------------------------------------------------------------
  7966* 021414    2003053000001  PEMA  changes for auto chk request
  7967******************************************************************
  7968 01  CHECK-RECORDS.
  7969     12  CH-RECORD-ID                      PIC XX.
  7970         88  VALID-CH-ID                      VALUE 'CH'.
  7971
  7972     12  CH-CONTROL-PRIMARY.
  7973         16  CH-COMPANY-CD                 PIC X.
  7974         16  CH-CARRIER                    PIC X.
  7975         16  CH-GROUPING                   PIC X(6).
  7976         16  CH-STATE                      PIC XX.
  7977         16  CH-ACCOUNT                    PIC X(10).
  7978         16  CH-CERT-EFF-DT                PIC XX.
  7979         16  CH-CERT-NO.
  7980             20  CH-CERT-PRIME             PIC X(10).
  7981             20  CH-CERT-SFX               PIC X.
  7982         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  7983
  7984     12  CH-RECORDED-DT                    PIC XX.
  7985     12  CH-RECORDED-BY                    PIC X(4).
  7986     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  7987
  7988     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  7989     12  CH-CHECK-NO                       PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 146
* VP6311.cbl
  7990     12  CH-REASON-FOR-CHECK               PIC X(25).
  7991     12  CH-CHECK-WRITTEN-DT               PIC XX.
  7992     12  FILLER                            PIC X.
  7993
  7994     12  CH-PAYEE-INFO.
  7995         16  CH-PAYEE-NAME-1               PIC X(30).
  7996         16  CH-PAYEE-NAME-2               PIC X(30).
  7997         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  7998         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  7999         16  CH-PAYEE-CITY-ST.
  8000             20  CH-PAYEE-CITY             PIC X(28).
  8001             20  CH-PAYEE-STATE            PIC XX.
  8002         16  CH-PAYEE-ZIP-CODE.
  8003             20  CH-PAYEE-ZIP.
  8004                 24  CH-ZIP-PRI-1ST        PIC X.
  8005                     88  CH-CANADIAN-POST-CODE
  8006                                           VALUES 'A' THRU 'Z'.
  8007                 24  FILLER                PIC X(4).
  8008             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8009         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8010             20  CH-CAN-POSTAL-1           PIC XXX.
  8011             20  CH-CAN-POSTAL-2           PIC XXX.
  8012             20  FILLER                    PIC XXX.
  8013
  8014     12  CH-CHECK-STUB-TEXT.
  8015         16  CH-STUB-LINE-1                PIC X(30).
  8016         16  CH-TEXT-LINE-1                PIC X(50).
  8017         16  CH-TEXT-LINE-2                PIC X(50).
  8018         16  CH-TEXT-LINE-3                PIC X(40).
  8019     12  CH-RETURN-TO                      PIC X(30).
  8020
  8021     12  CH-COMPENSATION-CONTROL.
  8022         16  CH-COMP-CARRIER               PIC X.
  8023         16  CH-COMP-GROUPING              PIC X(6).
  8024         16  CH-COMP-FIN-RESP              PIC X(10).
  8025         16  CH-COMP-ACCOUNT               PIC X(10).
  8026
  8027     12  CH-CREDIT-SELECT-DT               PIC XX.
  8028     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8029     12  CH-PAYEE-CODE                     PIC X(6).
  8030
  8031     12  CH-VOID-DATA.
  8032         20  CH-VOID-DT                    PIC XX.
  8033         20  CH-VOID-BY                    PIC X(4).
  8034         20  CH-VOID-REASON                PIC X(25).
  8035
  8036     12  CH-APPROVAL-DATA.
  8037         20  CH-APPROVAL-DT                PIC XX.
  8038         20  CH-APPROVAL-STATUS            PIC X.
  8039             88  CH-IN-LIMBO                  VALUE ' '.
  8040             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8041             88  CH-APPROVED                  VALUE 'A'.
  8042             88  CH-DENIED                    VALUE 'D'.
  8043         20  CH-APPROVED-BY                PIC XXXX.
  8044     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8045             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8046     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8047
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 147
* VP6311.cbl
  8048     12  ch-released-dt                    pic xx.
  8049     12  ch-check-cashed-dt                pic xx.
  8050     12  FILLER                            PIC X.
  8051*    12  CH-CHECK-REFERENCE                PIC X(12).
  8052     12  CH-CHECK-ORIGIN-SW                PIC X.
  8053             88  CH-REFUND-CHECK              VALUE 'R'.
  8054             88  CH-MAINT-CHECK               VALUE 'M'.
  8055
  8056     12  CH-CANC-DT                        PIC XX.
  8057     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8058     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8059
  8060     12  CH-INSURED-NAME                   PIC X(28).
  8061
  8062     12  ch-released-by                    pic x(4).
  8063     12  ch-csr                            pic x(4).
  8064     12  ch-deduct-commission              pic x.
  8065         88  ch-deduct-comm                  value 'Y'.
  8066         88  ch-do-not-deduct-comm           value 'N'.
  8067
  8068     12  FILLER                            PIC X(11).
  8069*    12  CH-LETTER-TABLE.
  8070*        16  CH-LETTERS OCCURS 3 TIMES
  8071*                       INDEXED BY CH-LT-NDX
  8072*                                          PIC X(04).
  8073
  8074     12  FILLER                            PIC X(07).
  8075
  8076 01  var                         pic x(30).
  8077 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8078                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8079                          PENDING-MAILING-DATA MAILING-DATA
  8080                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8081                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8082                          CLAIM-MASTER ENDORSEMENT-RECORD
  8083                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8084                          VAR.
  8085 0000-DFHEXIT SECTION.
  8086     MOVE '9#                    $   ' TO DFHEIV0.
  8087     MOVE 'VP6311' TO DFHEIV1.
  8088     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8089
  8090     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8091     MOVE EIBTRMID               TO QID-TERM.
  8092     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8093     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8094     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8095     MOVE 2                      TO EMI-SWITCH2.
  8096
  8097     move spaces to ws-kix-myenv
  8098     set P to address of KIXSYS
  8099     CALL "getenv" using by value P returning var-ptr
  8100     if var-ptr = null then
  8101        display ' kixsys not set '
  8102     else
  8103        set address of var to var-ptr
  8104        move 0 to env-var-len
  8105        inspect var tallying env-var-len
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 148
* VP6311.cbl
  8106          for characters before X'00'
  8107        unstring var (1:env-var-len) delimited by '/'
  8108           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8109              WS-KIX-SYS
  8110        end-unstring
  8111     end-if
  8112     perform varying a1 from +1 by +1 until a1 > +10
  8113        if ws-kix-myenv (a1:1) = low-values or high-values
  8114           display ' found low or hi val '
  8115           move spaces to ws-kix-myenv (a1:1)
  8116        end-if
  8117     end-perform
  8118*    display ' env *' ws-kix-myenv '*'
  8119     IF EIBCALEN = 0
  8120         GO TO 8800-UNAUTHORIZED-ACCESS.
  8121
  8122     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8123     MOVE '5'                   TO DC-OPTION-CODE.
  8124     PERFORM 9700-DATE-LINK.
  8125     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8126     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8127
  8128     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8129     MOVE SPACE                  TO DC-OPTION-CODE.
  8130     PERFORM 9700-DATE-LINK.
  8131     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8132     MOVE LOW-VALUES             TO VP631BI.
  8133
  8134
  8135* EXEC CICS HANDLE CONDITION
  8136*        PGMIDERR  (9600-PGMID-ERROR)
  8137*        ERROR     (9990-ABEND)
  8138*        INVREQ    (9990-ABEND)
  8139*        QIDERR    (0010-MAIN-LOGIC)
  8140*    END-EXEC.
  8141*    MOVE '"$L.8N                ! " #00008130' TO DFHEIV0
  8142     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8144     MOVE X'2220233030303038313330' TO DFHEIV0(25:11)
  8145     CALL 'kxdfhei1' USING DFHEIV0
  8146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8147
  8148
  8149     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8150         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8151             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8152             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8153             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8154             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8155             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8156             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8157             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8158             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8159
  8160             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8161                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8162
  8163             ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 149
* VP6311.cbl
  8164                 NEXT SENTENCE
  8165
  8166         ELSE
  8167             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8168             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8169             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8170             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8171             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8172             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8173             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8174             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8175             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8176             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8177             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8178             GO TO 3900-RE-DISPLAY-RECORD
  8179     ELSE
  8180         GO TO 0020-MAIN-LOGIC.
  8181
  8182 0010-MAIN-LOGIC.
  8183     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8184                                    WS-FIRST-ENTRY-SW.
  8185
  8186     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8187
  8188     MOVE LOW-VALUES             TO EC-NEW-CERT
  8189                                    EC-NEW-STATE.
  8190
  8191     IF PI-DISPLAY-ORIGINAL-BATCH
  8192         NEXT SENTENCE
  8193     ELSE
  8194         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8195             GO TO 5000-BROWSE-BATCH-HEADERS.
  8196
  8197     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8198         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8199
  8200     IF PI-CSR-BROWSE
  8201        GO TO 4200-BROWSE-CSR-FORWARD.
  8202
  8203     IF PI-FILE-BROWSE
  8204         GO TO 4300-BROWSE-FILE-FORWARD.
  8205
  8206     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8207
  8208 0020-MAIN-LOGIC.
  8209     IF EIBAID = DFHCLEAR
  8210         GO TO 9400-CLEAR.
  8211
  8212     MOVE LOW-VALUES             TO EC-NEW-CERT
  8213                                    EC-NEW-STATE.
  8214
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 150
* VP6311.cbl
  8216
  8217******************************************************************
  8218*                                                                *
  8219*              R E C E I V E   M A P                             *
  8220*                                                                *
  8221******************************************************************
  8222
  8223 0200-RECEIVE.
  8224     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8225         MOVE ER-0008            TO EMI-ERROR
  8226         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8227         IF PI-MAP-NAME = VP631B
  8228             MOVE -1                 TO BMAINTL
  8229             GO TO 8200-SEND-DATAONLY
  8230         ELSE
  8231             IF PI-MAP-NAME = VP631C
  8232                 MOVE -1                 TO CMAINTL
  8233                 GO TO 8200-SEND-DATAONLY
  8234             ELSE
  8235                 IF PI-MAP-NAME = VP631D
  8236                     MOVE -1                 TO DPFENTRL
  8237                     GO TO 8200-SEND-DATAONLY.
  8238
  8239
  8240* EXEC CICS RECEIVE
  8241*        MAP      (PI-MAP-NAME)
  8242*        MAPSET   (MAPSET-VP6311S)
  8243*        INTO     (VP631BI)
  8244*    END-EXEC.
  8245     MOVE LENGTH OF
  8246      VP631BI
  8247       TO DFHEIV11
  8248*    MOVE '8"T I  L              ''   #00008227' TO DFHEIV0
  8249     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8250     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8251     MOVE X'2020233030303038323237' TO DFHEIV0(25:11)
  8252     CALL 'kxdfhei1' USING DFHEIV0,
  8253           PI-MAP-NAME,
  8254           VP631BI,
  8255           DFHEIV11,
  8256           MAPSET-VP6311S,
  8257           DFHEIV99,
  8258           DFHEIV99
  8259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8260
  8261
  8262******************************************************************
  8263*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8264******************************************************************
  8265
  8266     IF BTYPE-LEN (1) EQUAL +3
  8267        IF BTYPE (1) EQUAL ALL ' '
  8268            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8269
  8270     IF BTYPE-LEN (2) EQUAL +3
  8271        IF BTYPE (2) EQUAL ALL ' '
  8272            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8273
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 151
* VP6311.cbl
  8274     INSPECT VP631BI CONVERTING '_' TO ' '.
  8275
  8276     IF PI-MAP-NAME = VP631B
  8277         IF BPFENTRL GREATER THAN ZEROS
  8278             IF EIBAID NOT = DFHENTER
  8279                 MOVE ER-0004       TO EMI-ERROR
  8280                 MOVE -1            TO BPFENTRL
  8281                 MOVE AL-UNBOF      TO BPFENTRA
  8282                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8283                 GO TO 8200-SEND-DATAONLY
  8284             ELSE
  8285                 IF BPFENTRI NUMERIC AND
  8286                   (BPFENTRI GREATER 0 AND LESS 25)
  8287                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8288                 ELSE
  8289                     MOVE ER-0029  TO EMI-ERROR
  8290                     MOVE AL-UNBON TO BPFENTRA
  8291                     MOVE -1       TO BPFENTRL
  8292                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8293                     GO TO 8200-SEND-DATAONLY
  8294         ELSE
  8295             NEXT SENTENCE
  8296     ELSE
  8297         IF PI-MAP-NAME = VP631C
  8298            IF CPFENTRL GREATER THAN ZEROS
  8299                IF EIBAID NOT = DFHENTER
  8300                 MOVE ER-0004         TO EMI-ERROR
  8301                 MOVE -1              TO CPFENTRL
  8302                 MOVE AL-UNBOF        TO CPFENTRA
  8303                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8304                 GO TO 8200-SEND-DATAONLY
  8305             ELSE
  8306                 IF CPFENTRI NUMERIC AND
  8307                   (CPFENTRI GREATER 0 AND LESS 25)
  8308                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8309                 ELSE
  8310                     MOVE ER-0029      TO EMI-ERROR
  8311                     MOVE AL-UNBON     TO CPFENTRA
  8312                     MOVE -1           TO CPFENTRL
  8313                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8314                     GO TO 8200-SEND-DATAONLY
  8315         ELSE
  8316             NEXT SENTENCE
  8317     ELSE
  8318     IF PI-MAP-NAME = VP631D
  8319         IF DPFENTRL GREATER THAN ZEROS
  8320             IF EIBAID NOT = DFHENTER
  8321                 MOVE ER-0004         TO EMI-ERROR
  8322                 MOVE -1              TO DPFENTRL
  8323                 MOVE AL-UNBOF        TO DPFENTRA
  8324                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8325                 GO TO 8200-SEND-DATAONLY
  8326             ELSE
  8327                 IF DPFENTRI NUMERIC AND
  8328                   (DPFENTRI GREATER 0 AND LESS 25)
  8329                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8330                 ELSE
  8331                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 152
* VP6311.cbl
  8332                     MOVE AL-UNBON     TO DPFENTRA
  8333                     MOVE -1           TO DPFENTRL
  8334                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8335                     GO TO 8200-SEND-DATAONLY.
  8336
  8337     IF EIBAID = DFHPF23
  8338         GO TO 8810-PF23.
  8339
  8340     IF EIBAID = DFHPF24
  8341         GO TO 9200-RETURN-MAIN-MENU.
  8342
  8343     IF EIBAID = DFHPF12
  8344         GO TO 9500-PF12.
  8345
  8346     IF PI-MAP-NAME = VP631B
  8347        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8348
  8349     IF PI-MAP-NAME = VP631C
  8350        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8351
  8352     IF PI-MAP-NAME = VP631D
  8353        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8354
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 153
* VP6311.cbl
  8356
  8357******************************************************************
  8358*                                                                *
  8359*      ISSUE SCREEN PF KEY CHECKING                              *
  8360*                                                                *
  8361******************************************************************
  8362
  8363******************************************************************
  8364*                                                                *
  8365*      PF KEY FUNCTIONS:                                         *
  8366*                                                                *
  8367*      PF1  = BROWSE FORWARD                                     *
  8368*      PF2  = BROWSE BACKWARD                                    *
  8369*      PF3  = CERTIFICATE LOOKUP                                 *
  8370*      PF4  = DISPLAY BATCH HEADER                               *
  8371*      PF5  = ADD ISSUE  SCREEN                                  *
  8372*      PF6  = ADD CANCEL SCREEN                                  *
  8373*      PF7  = CERTIFICATE DISPLAY                                *
  8374*      PF8  = CERTIFICATE NOTES                                  *
  8375*      PF9  = EDIT CONTROL                                       *
  8376*      PF10 = DISPLAY LETTER SCREEN                              *
  8377*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8378*      PF12 = HELP SCREEN                                        *
  8379*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8380*      PF14 = ACCOUNT MASTER                                     *
  8381*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8382*      PF16 = DISPLAY LETTER REVIEW                              *
  8383*                                                                *
  8384******************************************************************
  8385
  8386 0300-CHECK-ISSUE-PF-KEYS.
  8387     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8388        MOVE ER-2337            TO EMI-ERROR
  8389        MOVE -1                  TO BMAINTL
  8390        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8391        GO TO 8200-SEND-DATAONLY.
  8392
  8393     IF EIBAID = DFHPF1
  8394        MOVE '0'                TO PI-EDIT-SW
  8395        IF PI-PRIMARY-BROWSE
  8396           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8397        ELSE
  8398           IF PI-PRIMARY-WITH-SELECT
  8399              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8400           ELSE
  8401              IF PI-FILE-BROWSE
  8402                 GO TO 4300-BROWSE-FILE-FORWARD
  8403              ELSE
  8404                 IF PI-CSR-BROWSE
  8405                    GO TO 4200-BROWSE-CSR-FORWARD
  8406                 ELSE
  8407                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8408
  8409     IF EIBAID = DFHPF2
  8410        MOVE '0'                TO PI-EDIT-SW
  8411        IF PI-PRIMARY-BROWSE
  8412           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8413        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 154
* VP6311.cbl
  8414           IF PI-PRIMARY-WITH-SELECT
  8415              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8416           ELSE
  8417              IF PI-FILE-BROWSE
  8418                 GO TO 4800-BROWSE-FILE-BACKWARD
  8419              ELSE
  8420                 IF PI-CSR-BROWSE
  8421                    GO TO 4900-BROWSE-CSR-BACKWARD
  8422                 ELSE
  8423                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8424
  8425     IF EIBAID = DFHPF3
  8426        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8427        MOVE XCTL-EL127         TO PGM-NAME
  8428        GO TO 9300-XCTL.
  8429
  8430     IF (EIBAID = DFHPF15 OR DFHPF6)
  8431        AND (CSR-EDIT-SESSION)
  8432*       AND (FATAL-OR-UNFORCED)
  8433        AND (FATAL-ERRORS)
  8434        MOVE ER-1819             TO EMI-ERROR
  8435        MOVE -1                  TO BMAINTL
  8436        MOVE AL-UANON            TO BMAINTA
  8437        PERFORM 9900-ERROR-FORMAT
  8438                                 THRU 9900-EXIT
  8439        GO TO 8200-SEND-DATAONLY
  8440     END-IF
  8441     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8442      OR (EIBAID = DFHPF10)
  8443        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8444        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8445        IF (RESP-NORMAL)
  8446           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8447              AM-CONTROL-PRIMARY (1:20))
  8448            IF AM-NAME NOT GREATER THAN SPACES OR
  8449               AM-ADDRS NOT GREATER THAN SPACES  OR
  8450               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8451               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8452               AM-ZIP NOT GREATER THAN SPACES
  8453               MOVE ER-3834             TO EMI-ERROR
  8454               MOVE -1                  TO BMAINTL
  8455               MOVE AL-UANON            TO BMAINTA
  8456               PERFORM 9900-ERROR-FORMAT
  8457                                 THRU 9900-EXIT
  8458               GO TO 8200-SEND-DATAONLY
  8459            END-IF
  8460        ELSE
  8461           MOVE ER-1609             TO EMI-ERROR
  8462           MOVE -1                  TO BMAINTL
  8463           MOVE AL-UANON            TO BMAINTA
  8464           PERFORM 9900-ERROR-FORMAT
  8465                                THRU 9900-EXIT
  8466           GO TO 8200-SEND-DATAONLY
  8467        END-IF
  8468
  8469        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8470        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8471        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 155
* VP6311.cbl
  8472            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8473               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8474               MA-CITY NOT GREATER THAN SPACES OR
  8475               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8476               MA-ZIP-CODE NOT GREATER THAN SPACES
  8477               MOVE ER-3835             TO EMI-ERROR
  8478               MOVE -1                  TO BMAINTL
  8479               MOVE AL-UANON            TO BMAINTA
  8480               PERFORM 9900-ERROR-FORMAT
  8481                                 THRU 9900-EXIT
  8482               GO TO 8200-SEND-DATAONLY
  8483            END-IF
  8484        ELSE
  8485           MOVE ER-3000             TO EMI-ERROR
  8486           MOVE -1                  TO BMAINTL
  8487           MOVE AL-UANON            TO BMAINTA
  8488           PERFORM 9900-ERROR-FORMAT
  8489                                THRU 9900-EXIT
  8490           GO TO 8200-SEND-DATAONLY
  8491        END-IF
  8492
  8493     END-IF
  8494     IF (EIBAID = DFHPF15)
  8495        AND (CSR-EDIT-SESSION)
  8496        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8497        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8498        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8499        MOVE PI-SV-STATE         TO PI-STATE
  8500        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8501        MOVE BCERTNOI            TO PI-CERT-PRIME
  8502        MOVE BSUFIXI             TO PI-CERT-SFX
  8503        MOVE BEFFDTI             TO DEEDIT-FIELD
  8504        PERFORM 8600-DEEDIT
  8505        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8506        MOVE '4'                 TO DC-OPTION-CODE
  8507        PERFORM 9700-DATE-LINK
  8508        IF DATE-CONVERSION-ERROR
  8509           MOVE ER-0348          TO EMI-ERROR
  8510           MOVE -1               TO BEFFDTL
  8511           MOVE AL-UABON         TO BEFFDTA
  8512           PERFORM 9900-ERROR-FORMAT
  8513                                 THRU 9900-EXIT
  8514           GO TO 8200-SEND-DATAONLY
  8515        ELSE
  8516           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8517           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8518           MOVE XCTL-EL6315      TO PGM-NAME
  8519           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8520           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8521           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8522           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8523           GO TO 9300-XCTL
  8524        END-IF
  8525     END-IF
  8526
  8527     IF EIBAID = DFHPF4
  8528        MOVE '0'                TO PI-EDIT-SW
  8529        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 156
* VP6311.cbl
  8530           NEXT SENTENCE
  8531        ELSE
  8532           GO TO 7200-DISPLAY-BATCHES.
  8533
  8534     IF EIBAID = DFHPF5
  8535        MOVE ER-0029                TO EMI-ERROR
  8536        MOVE -1                     TO BPFENTRL
  8537        MOVE AL-UNBON               TO BPFENTRA
  8538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8539        GO TO 8200-SEND-DATAONLY.
  8540*        MOVE '0'                TO PI-EDIT-SW
  8541*        IF PI-DISPLAY-ORIGINAL-BATCH
  8542*           NEXT SENTENCE
  8543*        ELSE
  8544*           MOVE VP631B              TO PI-MAP-NAME
  8545*           MOVE LOW-VALUES          TO VP631BI
  8546*           MOVE 'A'                 TO BMAINTO
  8547*           MOVE AL-UANON            TO BMAINTA
  8548*           MOVE -1                  TO BMAINTL
  8549*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8550*           GO TO 8100-SEND-INITIAL-MAP.
  8551
  8552     IF EIBAID = DFHPF6
  8553        IF NOT CSR-EDIT-SESSION
  8554           MOVE ER-0029                TO EMI-ERROR
  8555           MOVE -1                     TO BPFENTRL
  8556           MOVE AL-UNBON               TO BPFENTRA
  8557           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8558           GO TO 8200-SEND-DATAONLY
  8559*           MOVE '0'              TO PI-EDIT-SW
  8560*           IF PI-DISPLAY-ORIGINAL-BATCH
  8561*              NEXT SENTENCE
  8562*           ELSE
  8563*              MOVE VP631C        TO PI-MAP-NAME
  8564*              MOVE LOW-VALUES    TO VP631CI
  8565*              MOVE 'A'           TO CMAINTO
  8566*              MOVE AL-UANON      TO CMAINTA
  8567*              MOVE -1            TO CMAINTL
  8568*              MOVE '6'           TO PI-MAINT-FUNCTION
  8569*              GO TO 8100-SEND-INITIAL-MAP
  8570*           END-IF
  8571        ELSE
  8572           PERFORM 5100-PROCESS-POL-RESC
  8573                                 THRU 5100-EXIT
  8574           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8575           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8576                                    PI-PREV-SEQ-NO
  8577           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8578*                                    WS-CANCEL-LETTER-SW
  8579                                    PI-ALL-ISSUES-SW
  8580                                    PI-ALL-CANCELS-SW
  8581           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8582        END-IF
  8583     END-IF
  8584     IF EIBAID = DFHPF7
  8585        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8586        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8587        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 157
* VP6311.cbl
  8588        MOVE PI-SV-STATE            TO PI-STATE
  8589        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8590        MOVE BCERTNOI               TO PI-CERT-PRIME
  8591        MOVE BSUFIXI                TO PI-CERT-SFX
  8592        MOVE BEFFDTI                TO DEEDIT-FIELD
  8593        PERFORM 8600-DEEDIT
  8594        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8595        MOVE '4'                    TO DC-OPTION-CODE
  8596        PERFORM 9700-DATE-LINK
  8597        IF DATE-CONVERSION-ERROR
  8598           MOVE ER-0348            TO EMI-ERROR
  8599           MOVE -1                  TO BEFFDTL
  8600           MOVE AL-UABON            TO BEFFDTA
  8601           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8602           GO TO 8200-SEND-DATAONLY
  8603        ELSE
  8604           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8605           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8606           MOVE XCTL-EL1273        TO PGM-NAME
  8607           GO TO 9300-XCTL.
  8608
  8609     IF EIBAID = DFHPF8
  8610        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8611        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8612        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8613        MOVE PI-SV-STATE            TO PI-STATE
  8614        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8615        MOVE BCERTNOI               TO PI-CERT-PRIME
  8616        MOVE BSUFIXI                TO PI-CERT-SFX
  8617        MOVE BEFFDTI                TO DEEDIT-FIELD
  8618        PERFORM 8600-DEEDIT
  8619        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8620        MOVE '4'                    TO DC-OPTION-CODE
  8621        PERFORM 9700-DATE-LINK
  8622        IF DATE-CONVERSION-ERROR
  8623           MOVE ER-0348            TO EMI-ERROR
  8624           MOVE -1                  TO BEFFDTL
  8625           MOVE AL-UABON            TO BEFFDTA
  8626           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8627           GO TO 8200-SEND-DATAONLY
  8628        ELSE
  8629           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8630           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8631           IF PI-COMPANY-ID = 'DMD'
  8632               MOVE XCTL-EL401DMD      TO PGM-NAME
  8633             ELSE
  8634               MOVE XCTL-EL1279        TO PGM-NAME
  8635           END-IF
  8636           GO TO 9300-XCTL.
  8637
  8638     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8639        MOVE XCTL-EL6312         TO PGM-NAME
  8640
  8641* EXEC CICS XCTL
  8642*           PROGRAM   (PGM-NAME)
  8643*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8644*           LENGTH    (WS-COMM-LENGTH)
  8645*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 158
* VP6311.cbl
  8646*    MOVE '.$C                   %   #00008611' TO DFHEIV0
  8647     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8648     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8649     MOVE X'2020233030303038363131' TO DFHEIV0(25:11)
  8650     CALL 'kxdfhei1' USING DFHEIV0,
  8651           PGM-NAME,
  8652           PROGRAM-INTERFACE-BLOCK,
  8653           WS-COMM-LENGTH,
  8654           DFHEIV99
  8655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8656     ELSE
  8657        MOVE '0'                 TO  PI-EDIT-SW.
  8658
  8659     IF  EIBAID = DFHPF10
  8660         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8661         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8662         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8663                                    PI-1042-WA
  8664         MOVE 4                  TO PI-689-DATA-SOURCE
  8665         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8666         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8667         MOVE PI-SV-STATE        TO PI-689-STATE
  8668         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8669         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8670         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8671         MOVE PI-PB-ALT-CHG-SEQ-NO
  8672                                 TO PI-689-ALT-SEQ-NO
  8673         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8674         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8675         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8676         MOVE +0                 TO PI-689-CONTROL
  8677         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8678                                    PI-689-EXP-DATE
  8679                                    PI-689-RESP-PERSON
  8680                                    PI-689-TYPE
  8681                                    PI-689-FOLLOW-UP-EDIT
  8682                                    PI-689-RESEND1-EDIT
  8683                                    PI-689-SEQ-EDIT
  8684                                    PI-689-BCSEQ-EDIT
  8685                                    PI-689-LBL-OVERRIDE
  8686         MOVE W-LETTER-COMMUNICATION-AREAS
  8687                                 TO PI-PROGRAM-WORK-AREA
  8688         MOVE XCTL-EL689         TO PGM-NAME
  8689         GO TO 9300-XCTL.
  8690
  8691     IF  EIBAID = DFHPF16
  8692         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8693         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8694         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8695                                    PI-1042-WA
  8696         MOVE 4                  TO PI-689-DATA-SOURCE
  8697         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8698         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8699         MOVE PI-SV-STATE        TO PI-689-STATE
  8700         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8701         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8702         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8703         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 159
* VP6311.cbl
  8704                                 TO PI-689-ALT-SEQ-NO
  8705         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8706         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8707         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8708         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8709         MOVE W-LETTER-COMMUNICATION-AREAS
  8710                                 TO PI-PROGRAM-WORK-AREA
  8711         MOVE XCTL-EL690         TO PGM-NAME
  8712         GO TO 9300-XCTL.
  8713
  8714     IF EIBAID = DFHPF13
  8715         MOVE XCTL-EL6313        TO PGM-NAME
  8716         GO TO 9300-XCTL.
  8717
  8718     IF EIBAID = DFHPF17
  8719        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8720        IF (PB-I-LOAN-APR numeric)
  8721           and (pb-i-loan-apr < 99.9999)
  8722           AND (PB-I-BENEFICIARY-NAME NOT
  8723              = SPACES AND LOW-VALUES)
  8724
  8725           MOVE LINK-ELVADS          TO PGM-NAME
  8726
  8727* EXEC CICS LINK
  8728*              PROGRAM    (PGM-NAME)
  8729*              COMMAREA   (WS-PASS-AREA)
  8730*              LENGTH     (WS-PASS-AREA-LENGTH)
  8731*          END-EXEC
  8732*    MOVE '."C                   (   #00008686' TO DFHEIV0
  8733     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8735     MOVE X'2020233030303038363836' TO DFHEIV0(25:11)
  8736     CALL 'kxdfhei1' USING DFHEIV0,
  8737           PGM-NAME,
  8738           WS-PASS-AREA,
  8739           WS-PASS-AREA-LENGTH,
  8740           DFHEIV99,
  8741           DFHEIV99,
  8742           DFHEIV99,
  8743           DFHEIV99
  8744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8745
  8746           MOVE 0000             TO EMI-ERROR
  8747           MOVE -1               TO BMAINTL
  8748           PERFORM 9900-ERROR-FORMAT
  8749                                 THRU 9900-EXIT
  8750           GO TO 8200-SEND-DATAONLY
  8751        ELSE
  8752           MOVE ER-0877            TO EMI-ERROR
  8753           MOVE -1                  TO BEFFDTL
  8754           MOVE AL-UABON            TO BEFFDTA
  8755           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8756           GO TO 8200-SEND-DATAONLY
  8757        END-IF
  8758     END-IF
  8759     IF EIBAID = DFHPF14
  8760        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8761        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 160
* VP6311.cbl
  8762        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8763        MOVE PI-SV-STATE            TO PI-CR-STATE
  8764        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8765        MOVE SPACE                  TO PI-EDIT-SW
  8766        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8767        MOVE XCTL-EL650             TO PGM-NAME
  8768        GO TO 9300-XCTL.
  8769
  8770     IF EIBAID = DFHPF15
  8771        IF PI-COMPANY-ID  =  'HER'
  8772            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8773            MOVE XCTL-EL680         TO PGM-NAME
  8774            GO TO 9300-XCTL.
  8775
  8776     IF EIBAID = DFHENTER OR DFHPF11
  8777        GO TO 1000-ISSUE-MAINLINE.
  8778
  8779     MOVE ER-0029                TO EMI-ERROR
  8780     MOVE -1                     TO BPFENTRL
  8781     MOVE AL-UNBON               TO BPFENTRA
  8782     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8783     GO TO 8200-SEND-DATAONLY.
  8784
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 161
* VP6311.cbl
  8786
  8787******************************************************************
  8788*                                                                *
  8789*      CANCEL SCREEN PF KEY CHECKING                             *
  8790*                                                                *
  8791******************************************************************
  8792
  8793******************************************************************
  8794*                                                                *
  8795*      PF KEY FUNCTIONS:                                         *
  8796*                                                                *
  8797*      PF1  = BROWSE FORWARD                                     *
  8798*      PF2  = BROWSE BACKWARD                                    *
  8799*      PF3  = CERTIFICATE LOOKUP                                 *
  8800*      PF4  = DISPLAY BATCH HEADER                               *
  8801*      PF5  = ADD ISSUE SCREEN                                   *
  8802*      PF6  = ADD CANCEL SCREEN                                  *
  8803*      PF7  = CERTIFICATE DISPLAY                                *
  8804*      PF8  = CERTIFICATE NOTES                                  *
  8805*      PF9  = EDIT CONTROL                                       *
  8806*      PF10 = DISPLAY LETTER SCREEN                              *
  8807*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8808*      PF12 = DISPLAY HELP SCREEN                                *
  8809*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8810*      PF14 = ACCOUNT MASTER                                     *
  8811*      PF16 = LETTER REVIEW                                      *
  8812*                                                                *
  8813******************************************************************
  8814
  8815 0400-CHECK-CANCEL-PF-KEYS.
  8816     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8817        MOVE ER-2337             TO EMI-ERROR
  8818        MOVE -1                  TO CMAINTL
  8819        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8820        GO TO 8200-SEND-DATAONLY.
  8821
  8822     IF EIBAID = DFHPF1
  8823        MOVE '0'                TO PI-EDIT-SW
  8824        IF PI-PRIMARY-BROWSE
  8825           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8826        ELSE
  8827           IF PI-PRIMARY-WITH-SELECT
  8828              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8829           ELSE
  8830              IF PI-FILE-BROWSE
  8831                 GO TO 4300-BROWSE-FILE-FORWARD
  8832              ELSE
  8833                 IF PI-CSR-BROWSE
  8834                    GO TO 4200-BROWSE-CSR-FORWARD
  8835                 ELSE
  8836                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8837
  8838     IF EIBAID = DFHPF2
  8839        MOVE '0'                TO PI-EDIT-SW
  8840        IF PI-PRIMARY-BROWSE
  8841           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8842        ELSE
  8843           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 162
* VP6311.cbl
  8844              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8845           ELSE
  8846              IF PI-FILE-BROWSE
  8847                 GO TO 4800-BROWSE-FILE-BACKWARD
  8848              ELSE
  8849                 IF PI-CSR-BROWSE
  8850                    GO TO 4900-BROWSE-CSR-BACKWARD
  8851                 ELSE
  8852                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8853
  8854     IF EIBAID = DFHPF3
  8855        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8856        MOVE XCTL-EL127         TO PGM-NAME
  8857        GO TO 9300-XCTL.
  8858
  8859     IF (EIBAID = DFHPF15 OR DFHPF17)
  8860        AND (CSR-EDIT-SESSION)
  8861*       AND (FATAL-OR-UNFORCED)
  8862        AND (FATAL-ERRORS)
  8863        MOVE ER-1819             TO EMI-ERROR
  8864        MOVE -1                  TO CMAINTL
  8865        MOVE AL-UANON            TO CMAINTA
  8866        PERFORM 9900-ERROR-FORMAT
  8867                                 THRU 9900-EXIT
  8868        GO TO 8200-SEND-DATAONLY
  8869     END-IF
  8870     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8871       AND (CSR-EDIT-SESSION)
  8872        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8873        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8874        IF (RESP-NORMAL)
  8875           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8876              AM-CONTROL-PRIMARY (1:20))
  8877            IF AM-NAME NOT GREATER THAN SPACES OR
  8878               AM-ADDRS NOT GREATER THAN SPACES  OR
  8879               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8880               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8881               AM-ZIP NOT GREATER THAN SPACES
  8882               MOVE ER-3834             TO EMI-ERROR
  8883               MOVE -1                  TO BMAINTL
  8884               MOVE AL-UANON            TO BMAINTA
  8885               PERFORM 9900-ERROR-FORMAT
  8886                                 THRU 9900-EXIT
  8887               GO TO 8200-SEND-DATAONLY
  8888            END-IF
  8889        ELSE
  8890           MOVE ER-1609             TO EMI-ERROR
  8891           MOVE -1                  TO BMAINTL
  8892           MOVE AL-UANON            TO BMAINTA
  8893           PERFORM 9900-ERROR-FORMAT
  8894                                THRU 9900-EXIT
  8895           GO TO 8200-SEND-DATAONLY
  8896        END-IF
  8897
  8898        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8899        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8900        IF (ERMAIL-FOUND)
  8901            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 163
* VP6311.cbl
  8902               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8903               MA-CITY NOT GREATER THAN SPACES OR
  8904               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8905               MA-ZIP-CODE NOT GREATER THAN SPACES
  8906               MOVE ER-3835             TO EMI-ERROR
  8907               MOVE -1                  TO BMAINTL
  8908               MOVE AL-UANON            TO BMAINTA
  8909               PERFORM 9900-ERROR-FORMAT
  8910                                 THRU 9900-EXIT
  8911               GO TO 8200-SEND-DATAONLY
  8912            END-IF
  8913        ELSE
  8914           MOVE ER-3000             TO EMI-ERROR
  8915           MOVE -1                  TO BMAINTL
  8916           MOVE AL-UANON            TO BMAINTA
  8917           PERFORM 9900-ERROR-FORMAT
  8918                                THRU 9900-EXIT
  8919           GO TO 8200-SEND-DATAONLY
  8920        END-IF
  8921
  8922     END-IF
  8923     IF (EIBAID = DFHPF15 OR DFHPF17)
  8924        AND (CSR-EDIT-SESSION)
  8925        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8926        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8927        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8928        MOVE PI-SV-STATE         TO PI-STATE
  8929        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8930        MOVE CCERTNOI            TO PI-CERT-PRIME
  8931        MOVE CSUFIXI             TO PI-CERT-SFX
  8932        MOVE CEFFDTI             TO DEEDIT-FIELD
  8933        PERFORM 8600-DEEDIT
  8934        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8935        MOVE '4'                 TO DC-OPTION-CODE
  8936        PERFORM 9700-DATE-LINK
  8937        IF DATE-CONVERSION-ERROR
  8938           MOVE ER-0348          TO EMI-ERROR
  8939           MOVE -1               TO CEFFDTL
  8940           MOVE AL-UABON         TO CEFFDTA
  8941           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8942           GO TO 8200-SEND-DATAONLY
  8943        ELSE
  8944           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8945           PERFORM 6000-CREATE-TEMP-STORAGE
  8946                                 THRU 6000-EXIT
  8947           IF EIBAID = DFHPF17
  8948               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8949                                  THRU 6400-EXIT
  8950               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8951                                 '2' AND '3' AND '4'
  8952                  MOVE ER-3831     TO  EMI-ERROR
  8953                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8954                  GO TO 8200-SEND-DATAONLY
  8955               END-IF
  8956               MOVE 'Y'          TO PI-CLM-RESC-IND
  8957           ELSE
  8958               MOVE 'N'          TO PI-CLM-RESC-IND
  8959           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 164
* VP6311.cbl
  8960           MOVE XCTL-EL6316      TO PGM-NAME
  8961           MOVE '2'              TO PI-ISS-CAN-SW
  8962           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8963           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8964           GO TO 9300-XCTL
  8965        END-IF
  8966     END-IF
  8967
  8968     IF EIBAID = DFHPF4
  8969        MOVE '0'                TO PI-EDIT-SW
  8970        IF PI-DISPLAY-ORIGINAL-BATCH
  8971           NEXT SENTENCE
  8972        ELSE
  8973           GO TO 7200-DISPLAY-BATCHES.
  8974
  8975     IF EIBAID = DFHPF5
  8976        MOVE ER-0029                TO EMI-ERROR
  8977        MOVE -1                     TO BPFENTRL
  8978        MOVE AL-UNBON               TO BPFENTRA
  8979        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8980        GO TO 8200-SEND-DATAONLY.
  8981*        MOVE '0'                TO PI-EDIT-SW
  8982*        IF PI-DISPLAY-ORIGINAL-BATCH
  8983*           NEXT SENTENCE
  8984*        ELSE
  8985*           MOVE VP631B              TO PI-MAP-NAME
  8986*           MOVE LOW-VALUES          TO VP631BI
  8987*           MOVE 'A'                 TO BMAINTO
  8988*           MOVE AL-UANON            TO BMAINTA
  8989*           MOVE -1                  TO BMAINTL
  8990*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8991*           GO TO 8100-SEND-INITIAL-MAP.
  8992
  8993     IF EIBAID = DFHPF6
  8994        MOVE ER-0029                TO EMI-ERROR
  8995        MOVE -1                     TO BPFENTRL
  8996        MOVE AL-UNBON               TO BPFENTRA
  8997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8998        GO TO 8200-SEND-DATAONLY.
  8999*        MOVE '0'                TO PI-EDIT-SW
  9000*        IF PI-DISPLAY-ORIGINAL-BATCH
  9001*           NEXT SENTENCE
  9002*        ELSE
  9003*           MOVE VP631C              TO PI-MAP-NAME
  9004*           MOVE LOW-VALUES          TO VP631CI
  9005*           MOVE 'A'                 TO CMAINTO
  9006*           MOVE AL-UANON            TO CMAINTA
  9007*           MOVE -1                  TO CMAINTL
  9008*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9009*           GO TO 8100-SEND-INITIAL-MAP.
  9010
  9011     IF EIBAID = DFHPF7
  9012        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9013        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9014        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9015        MOVE PI-SV-STATE            TO PI-STATE
  9016        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9017        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 165
* VP6311.cbl
  9018        MOVE CSUFIXI                TO PI-CERT-SFX
  9019        MOVE CEFFDTI                TO DEEDIT-FIELD
  9020        PERFORM 8600-DEEDIT
  9021        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9022        MOVE '4'                    TO DC-OPTION-CODE
  9023        PERFORM 9700-DATE-LINK
  9024        IF DATE-CONVERSION-ERROR
  9025           MOVE ER-0348            TO EMI-ERROR
  9026           MOVE -1                  TO BEFFDTL
  9027           MOVE AL-UABON            TO BEFFDTA
  9028           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9029           GO TO 8200-SEND-DATAONLY
  9030        ELSE
  9031           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9032           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9033           MOVE XCTL-EL1273        TO PGM-NAME
  9034           GO TO 9300-XCTL.
  9035
  9036     IF EIBAID = DFHPF8
  9037        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9038        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9039        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9040        MOVE PI-SV-STATE            TO PI-STATE
  9041        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9042        MOVE CCERTNOI               TO PI-CERT-PRIME
  9043        MOVE CSUFIXI                TO PI-CERT-SFX
  9044        MOVE CEFFDTI                TO DEEDIT-FIELD
  9045        PERFORM 8600-DEEDIT
  9046        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9047        MOVE '4'                    TO DC-OPTION-CODE
  9048        PERFORM 9700-DATE-LINK
  9049        IF DATE-CONVERSION-ERROR
  9050           MOVE ER-0348             TO EMI-ERROR
  9051           MOVE -1                  TO BEFFDTL
  9052           MOVE AL-UABON            TO BEFFDTA
  9053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9054           GO TO 8200-SEND-DATAONLY
  9055        ELSE
  9056           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9057           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9058           IF PI-COMPANY-ID = 'DMD'
  9059               MOVE XCTL-EL401DMD      TO PGM-NAME
  9060             ELSE
  9061               MOVE XCTL-EL1279        TO PGM-NAME
  9062           END-IF
  9063           GO TO 9300-XCTL.
  9064
  9065     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9066        MOVE XCTL-EL6312     TO PGM-NAME
  9067
  9068* EXEC CICS XCTL
  9069*           PROGRAM  (PGM-NAME)
  9070*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9071*           LENGTH   (WS-COMM-LENGTH)
  9072*       END-EXEC
  9073*    MOVE '.$C                   %   #00009013' TO DFHEIV0
  9074     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9075     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 166
* VP6311.cbl
  9076     MOVE X'2020233030303039303133' TO DFHEIV0(25:11)
  9077     CALL 'kxdfhei1' USING DFHEIV0,
  9078           PGM-NAME,
  9079           PROGRAM-INTERFACE-BLOCK,
  9080           WS-COMM-LENGTH,
  9081           DFHEIV99
  9082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9083     ELSE
  9084        MOVE '0'                 TO  PI-EDIT-SW.
  9085
  9086     IF EIBAID = DFHPF10
  9087         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9088         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9089         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9090         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9091                                    PI-1042-WA
  9092         MOVE 4                  TO PI-689-DATA-SOURCE
  9093         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9094         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9095         MOVE PI-SV-STATE        TO PI-689-STATE
  9096         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9097         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9098         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9099         MOVE PI-PB-ALT-CHG-SEQ-NO
  9100                                 TO PI-689-ALT-SEQ-NO
  9101         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9102         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9103         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9104         MOVE +0                 TO PI-689-CONTROL
  9105         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9106                                    PI-689-EXP-DATE
  9107                                    PI-689-RESP-PERSON
  9108                                    PI-689-TYPE
  9109                                    PI-689-FOLLOW-UP-EDIT
  9110                                    PI-689-RESEND1-EDIT
  9111                                    PI-689-SEQ-EDIT
  9112                                    PI-689-BCSEQ-EDIT
  9113                                    PI-689-LBL-OVERRIDE
  9114         MOVE W-LETTER-COMMUNICATION-AREAS
  9115                                 TO PI-PROGRAM-WORK-AREA
  9116         MOVE XCTL-EL689         TO PGM-NAME
  9117         GO TO 9300-XCTL.
  9118
  9119     IF  EIBAID = DFHPF16
  9120         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9121         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9122         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9123                                    PI-1042-WA
  9124         MOVE 4                  TO PI-689-DATA-SOURCE
  9125         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9126         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9127         MOVE PI-SV-STATE        TO PI-689-STATE
  9128         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9129         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9130         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9131         MOVE PI-PB-ALT-CHG-SEQ-NO
  9132                                 TO PI-689-ALT-SEQ-NO
  9133         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 167
* VP6311.cbl
  9134         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9135         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9136         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9137         MOVE W-LETTER-COMMUNICATION-AREAS
  9138                                 TO PI-PROGRAM-WORK-AREA
  9139         MOVE XCTL-EL690         TO PGM-NAME
  9140         GO TO 9300-XCTL.
  9141     IF (EIBAID = DFHPF13)
  9142        if (not fatal-errors)
  9143           and (not unforced-errors)
  9144           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9145           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9146           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9147           MOVE PI-SV-STATE      TO PI-STATE
  9148           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9149           MOVE CCERTNOI         TO PI-CERT-PRIME
  9150           MOVE CSUFIXI          TO PI-CERT-SFX
  9151           MOVE CEFFDTI          TO DEEDIT-FIELD
  9152           PERFORM 8600-DEEDIT
  9153           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9154           MOVE '4'              TO DC-OPTION-CODE
  9155           PERFORM 9700-DATE-LINK
  9156           IF DATE-CONVERSION-ERROR
  9157              MOVE ER-0348       TO EMI-ERROR
  9158              MOVE -1            TO CEFFDTL
  9159              MOVE AL-UABON      TO CEFFDTA
  9160              PERFORM 9900-ERROR-FORMAT
  9161                                 THRU 9900-EXIT
  9162              GO TO 8200-SEND-DATAONLY
  9163           ELSE
  9164              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9165              MOVE AL-UANON      TO CEFFDTA
  9166              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9167              PERFORM 6000-CREATE-TEMP-STORAGE
  9168                                 THRU 6000-EXIT
  9169              MOVE XCTL-EL677    TO PGM-NAME
  9170              GO TO 9300-XCTL
  9171           end-if
  9172        else
  9173           MOVE ER-3444          TO EMI-ERROR
  9174           MOVE -1               TO CPFENTRL
  9175           MOVE AL-UNBON         TO CPFENTRA
  9176           PERFORM 9900-ERROR-FORMAT
  9177                                 THRU 9900-EXIT
  9178           GO TO 8200-SEND-DATAONLY
  9179        end-if
  9180     end-if
  9181
  9182     IF EIBAID = DFHPF14
  9183        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9184        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9185        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9186        MOVE PI-SV-STATE            TO PI-CR-STATE
  9187        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9188        MOVE SPACE                  TO PI-EDIT-SW
  9189        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9190        MOVE XCTL-EL650             TO PGM-NAME
  9191        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 168
* VP6311.cbl
  9192
  9193     IF EIBAID = DFHENTER OR DFHPF11
  9194        GO TO 2000-CANCEL-MAINLINE.
  9195
  9196     MOVE ER-0029                TO EMI-ERROR.
  9197     MOVE -1                     TO CPFENTRL.
  9198     MOVE AL-UNBON               TO CPFENTRA.
  9199     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9200     GO TO 8200-SEND-DATAONLY.
  9201
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 169
* VP6311.cbl
  9203
  9204******************************************************************
  9205*                                                                *
  9206*      BATCH SCREEN PF KEY CHECKING                              *
  9207*                                                                *
  9208******************************************************************
  9209
  9210******************************************************************
  9211*                                                                *
  9212*      PF KEY FUNCTIONS:                                         *
  9213*                                                                *
  9214*      PF1 = BROWSE FORWARD                                      *
  9215*      PF2 = BROWSE BACKWARD                                     *
  9216*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9217*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9218*                                                                *
  9219*                                                                *
  9220******************************************************************
  9221
  9222 0500-CHECK-BATCH-PF-KEYS.
  9223     IF EIBAID = DFHPF1
  9224        MOVE '0'                TO PI-EDIT-SW
  9225        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9226           GO TO 5000-BROWSE-BATCH-HEADERS
  9227        ELSE
  9228           IF PI-GOOD-BROWSE
  9229              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9230                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9231              ELSE
  9232                 IF PI-FILE-BROWSE
  9233                    GO TO 4300-BROWSE-FILE-FORWARD
  9234                 ELSE
  9235                    IF PI-CSR-BROWSE
  9236                       GO TO 4200-BROWSE-CSR-FORWARD
  9237                    ELSE
  9238                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9239           ELSE
  9240              GO TO 0800-BROWSE-ERROR.
  9241
  9242     IF EIBAID = DFHPF2
  9243        MOVE '0'                TO PI-EDIT-SW
  9244        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9245           GO TO 5500-BROWSE-BATCH-BACKWARD
  9246        ELSE
  9247           IF PI-GOOD-BROWSE
  9248              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9249                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9250              ELSE
  9251                 IF PI-FILE-BROWSE
  9252                    GO TO 4800-BROWSE-FILE-BACKWARD
  9253                 ELSE
  9254                    IF PI-CSR-BROWSE
  9255                       GO TO 4900-BROWSE-CSR-BACKWARD
  9256                    ELSE
  9257                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9258           ELSE
  9259              GO TO 0800-BROWSE-ERROR.
  9260
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 170
* VP6311.cbl
  9261     IF EIBAID = DFHPF3
  9262        GO TO 3000-BATCH-MAINLINE.
  9263
  9264     IF  EIBAID = DFHPF4
  9265        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9266        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9267        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9268        MOVE PI-SV-STATE            TO PI-CR-STATE
  9269        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9270                                       PI-CR-FIN-RESP
  9271        MOVE 'A'                    TO PI-CR-TYPE
  9272        MOVE SPACE                  TO PI-EDIT-SW
  9273        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9274        MOVE XCTL-EL640             TO PGM-NAME
  9275        GO TO 9300-XCTL.
  9276
  9277     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9278       AND
  9279        (EIBAID = DFHENTER)
  9280           GO TO 3500-EDIT-BATCH-DATA.
  9281
  9282     IF EIBAID = DFHENTER
  9283        GO TO 3500-EDIT-BATCH-DATA.
  9284
  9285     MOVE ER-0029             TO EMI-ERROR.
  9286     MOVE -1                  TO DPFENTRL.
  9287     MOVE AL-UNBON            TO DPFENTRA.
  9288     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9289     GO TO 8200-SEND-DATAONLY.
  9290
  9291 0800-BROWSE-ERROR.
  9292     MOVE ER-2258                TO EMI-ERROR.
  9293     MOVE -1                     TO DPFENTRL.
  9294     MOVE AL-UNBON               TO DPFENTRA.
  9295     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9296     GO TO 8200-SEND-DATAONLY.
  9297
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 171
* VP6311.cbl
  9299
  9300******************************************************************
  9301*                                                                *
  9302*                I S S U E   M A I N L I N E                     *
  9303*                                                                *
  9304******************************************************************
  9305
  9306 1000-ISSUE-MAINLINE.
  9307     IF PI-DISPLAY-ORIGINAL-BATCH
  9308        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9309           MOVE ER-0023             TO EMI-ERROR
  9310           MOVE -1                  TO BMAINTL
  9311           MOVE AL-UABON            TO BMAINTA
  9312           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9313           GO TO 8200-SEND-DATAONLY
  9314        ELSE
  9315           NEXT SENTENCE
  9316     ELSE
  9317        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9318           MOVE ER-0023             TO EMI-ERROR
  9319           MOVE -1                  TO BMAINTL
  9320           MOVE AL-UABON            TO BMAINTA
  9321           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9322           GO TO 8200-SEND-DATAONLY.
  9323
  9324     IF BMAINTI = 'S'
  9325        GO TO 1100-SHOW-REQUEST.
  9326
  9327     IF NOT MODIFY-CAP
  9328         MOVE 'UPDATE'       TO SM-READ
  9329         PERFORM 9995-SECURITY-VIOLATION
  9330         MOVE ER-0070        TO EMI-ERROR
  9331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9332         GO TO 8100-SEND-INITIAL-MAP.
  9333
  9334     IF BMAINTL GREATER THAN ZEROS
  9335        IF PI-PF5-FUNCTION
  9336           IF BMAINTI NOT = 'A'
  9337              MOVE AL-UABON  TO BMAINTA
  9338              MOVE -1        TO BMAINTL
  9339              MOVE ER-2260   TO EMI-ERROR
  9340              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9341              GO TO 8200-SEND-DATAONLY.
  9342
  9343     IF BCERTNOL = ZEROS
  9344       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9345         NEXT SENTENCE
  9346     ELSE
  9347         IF BCERTNOL NOT = ZEROS
  9348             MOVE AL-UANON       TO BCERTNOA
  9349         ELSE
  9350             MOVE -1             TO BCERTNOL
  9351             MOVE  1             TO SET-CURSOR-SW
  9352             MOVE ER-2218        TO EMI-ERROR
  9353             MOVE AL-UABON       TO BCERTNOA
  9354             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9355
  9356     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 172
* VP6311.cbl
  9357         MOVE AL-UANON       TO BSUFIXA
  9358     ELSE
  9359         MOVE AL-SANOF       TO BSUFIXA.
  9360
  9361     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9362        NEXT SENTENCE
  9363     ELSE
  9364        IF BEFFDTL NOT = ZEROS
  9365           MOVE AL-UNNON             TO BEFFDTA
  9366           MOVE BEFFDTI              TO DEEDIT-FIELD
  9367           PERFORM 8600-DEEDIT
  9368           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9369           MOVE 4                    TO DC-OPTION-CODE
  9370           PERFORM 9700-DATE-LINK
  9371           IF NO-CONVERSION-ERROR
  9372              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9373              ELSE
  9374              MOVE -1                TO BEFFDTL
  9375              MOVE  1                TO SET-CURSOR-SW
  9376              MOVE ER-2226           TO EMI-ERROR
  9377              MOVE AL-UNBON          TO BEFFDTA
  9378              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9379           ELSE
  9380              MOVE -1                TO BEFFDTL
  9381              MOVE  1                TO SET-CURSOR-SW
  9382              MOVE ER-2220           TO EMI-ERROR
  9383              MOVE AL-UNBON          TO BEFFDTA
  9384              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9385
  9386     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9387
  9388     IF BCERTNOL NOT = ZEROS
  9389        MOVE BCERTNOI                TO WS-NEW-PRIME
  9390     ELSE
  9391        MOVE SPACES                  TO WS-NEW-PRIME.
  9392
  9393     IF BSUFIXL NOT = ZEROS
  9394        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9395     ELSE
  9396        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9397
  9398     IF BEFFDTL NOT = ZEROS
  9399        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9400     ELSE
  9401        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9402
  9403     IF BMAINTI = 'A' OR 'K' OR 'S'
  9404        NEXT SENTENCE
  9405     ELSE
  9406        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9407        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9408           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9409           WS-PB-RECORD-TYPE NOT = '1'
  9410           IF BMAINTI = 'C'
  9411               MOVE ER-2287          TO EMI-ERROR
  9412               MOVE -1               TO BCERTNOL
  9413               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9414               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 173
* VP6311.cbl
  9415               GO TO 8200-SEND-DATAONLY
  9416             ELSE
  9417               MOVE ER-2260          TO EMI-ERROR
  9418               MOVE -1               TO BCERTNOL
  9419               MOVE AL-UABON         TO BCERTNOA
  9420               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9421               GO TO 8200-SEND-DATAONLY.
  9422
  9423     IF BMAINTI = 'D'
  9424         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9425
  9426*    IF BMICRNOL  NOT =  ZEROS
  9427*        IF BMICRNOI  NUMERIC
  9428*            MOVE AL-UNNON       TO  BMICRNOA
  9429*        ELSE
  9430*            MOVE -1             TO  BMICRNOL
  9431*            MOVE 1              TO  SET-CURSOR-SW
  9432*            MOVE AL-UNBON       TO  BMICRNOA
  9433*            MOVE ER-2701        TO  EMI-ERROR
  9434*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9435     IF BVINL NOT = ZEROS
  9436        MOVE AL-UANON            TO BVINA
  9437     END-IF
  9438     IF B1STNML NOT = ZEROS
  9439         MOVE AL-UANON                TO B1STNMA.
  9440
  9441     IF BINITL  NOT = ZEROS
  9442        MOVE AL-UANON                TO BINITA.
  9443
  9444     IF BSEXL NOT = ZEROS
  9445        IF BSEXI = 'M' OR 'F'
  9446           MOVE AL-UANON             TO BSEXA
  9447        ELSE
  9448           MOVE -1               TO BSEXL
  9449           MOVE ER-2629          TO EMI-ERROR
  9450           MOVE AL-UABON         TO BSEXA
  9451           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9452
  9453     IF BAGEL NOT = ZEROS
  9454         IF BAGEI NUMERIC
  9455             MOVE BAGEI              TO WS-BAGE
  9456             MOVE AL-UNNON           TO BAGEA
  9457         ELSE
  9458             MOVE -1                 TO BAGEL
  9459             MOVE  1                 TO SET-CURSOR-SW
  9460             MOVE ER-2223            TO EMI-ERROR
  9461             MOVE AL-UNBON           TO BAGEA
  9462             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9463
  9464     IF BLSTNML NOT = ZERO  OR
  9465        B1STNML NOT = ZERO  OR
  9466        BINITL NOT = ZERO
  9467         IF BAGEL = ZEROS
  9468             MOVE -1                 TO BAGEL
  9469             MOVE  1                 TO SET-CURSOR-SW
  9470             MOVE ER-3269            TO EMI-ERROR
  9471             MOVE AL-UNBON           TO BAGEA
  9472             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 174
* VP6311.cbl
  9473         END-IF
  9474     END-IF.
  9475
  9476     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9477
  9478     IF (BBIRTHL GREATER THAN +0) AND
  9479        (BBIRTHI NOT EQUAL SPACES)
  9480        NEXT SENTENCE
  9481     ELSE
  9482        GO TO 1010-CHECK-AGE.
  9483
  9484     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9485     PERFORM 8600-DEEDIT.
  9486     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9487     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9488     MOVE AL-UNNON               TO BBIRTHA.
  9489     MOVE '4'                    TO DC-OPTION-CODE.
  9490     PERFORM 9700-DATE-LINK.
  9491     IF DATE-CONVERSION-ERROR
  9492        MOVE -1                  TO BBIRTHL
  9493        MOVE  1                  TO SET-CURSOR-SW
  9494        MOVE ER-2228             TO EMI-ERROR
  9495        MOVE AL-UNBON            TO BBIRTHA
  9496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9497        GO TO 1010-CHECK-AGE.
  9498
  9499     IF (NO-CONVERSION-ERROR) AND
  9500        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9501        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9502        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9503        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9504                                    WS-CONVERTED-BIRTH
  9505        MOVE AL-UANON            TO BBIRTHA
  9506     ELSE
  9507        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9508        MOVE AL-UANON            TO BBIRTHA.
  9509
  9510 1010-CHECK-AGE.
  9511
  9512*    IF BAGEL = ZERO
  9513*       IF BBIRTHL GREATER THAN ZERO
  9514*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9515
  9516
  9517
  9518
  9519**   IF PI-COMPANY-ID = 'DMD'
  9520     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9521        NEXT SENTENCE
  9522     ELSE
  9523         IF BLNOFCRL NOT = ZEROS
  9524            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9525            IF LOAN-OFFICER-FOUND
  9526                MOVE AL-UANON        TO BLNOFCRA
  9527             ELSE
  9528                 MOVE SPACE          TO WS-LOAN-OFFICER
  9529                 MOVE -1             TO BLNOFCRL
  9530                 MOVE  1             TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 175
* VP6311.cbl
  9531                 MOVE ER-3006        TO EMI-ERROR
  9532                 MOVE AL-UNBON       TO BLNOFCRA
  9533                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9534
  9535 1010-EDIT-CONT.
  9536
  9537     IF BFORCEL  NOT = ZEROS
  9538         IF FORCE-CAP
  9539            MOVE AL-UANON            TO BFORCEA
  9540         ELSE
  9541            MOVE ER-2945             TO EMI-ERROR
  9542            MOVE AL-UABON            TO BFORCEA
  9543            MOVE -1                  TO BFORCEL
  9544            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9545
  9546     IF BENTRYL NOT = ZEROS
  9547        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9548                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9549           MOVE ER-2224              TO EMI-ERROR
  9550           MOVE AL-UABON             TO BENTRYA
  9551           MOVE -1                   TO BENTRYL
  9552           MOVE  1                   TO SET-CURSOR-SW
  9553           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9554        ELSE
  9555           MOVE AL-UANON             TO BENTRYA.
  9556
  9557     IF BUNWRITL NOT = ZEROS
  9558        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9559           MOVE ER-7574              TO EMI-ERROR
  9560           MOVE AL-UABON             TO BUNWRITA
  9561           MOVE -1                   TO BUNWRITL
  9562           MOVE  1                   TO SET-CURSOR-SW
  9563           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9564        ELSE
  9565           MOVE AL-UANON             TO BUNWRITA.
  9566
  9567     IF BREINL  NOT = ZEROS
  9568         MOVE AL-UANON               TO BREINA.
  9569
  9570     IF BBILCDL NOT = ZEROS
  9571        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9572                             AND 'A' AND 'B' AND 'E'
  9573           MOVE ER-2225              TO EMI-ERROR
  9574           MOVE AL-UABON             TO BBILCDA
  9575           MOVE -1                   TO BBILCDL
  9576           MOVE  1                   TO SET-CURSOR-SW
  9577           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9578        ELSE
  9579           MOVE AL-UANON             TO BBILCDA.
  9580
  9581     IF BSKPCDL NOT = ZEROS
  9582         MOVE AL-UANON               TO BSKPCDA.
  9583
  9584     IF BINDGRPL NOT = ZEROS
  9585         MOVE AL-UANON               TO BINDGRPA.
  9586
  9587     IF BSIGL   NOT = ZEROS
  9588         MOVE AL-UANON               TO BSIGA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 176
* VP6311.cbl
  9589
  9590     IF BRTCLSL NOT = ZEROS
  9591         MOVE AL-UANON               TO BRTCLSA.
  9592
  9593     IF BMEMBERL NOT = ZEROS
  9594         MOVE AL-UANON               TO BMEMBERA.
  9595
  9596     MOVE +0                         TO WS-SUB1.
  9597
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 177
* VP6311.cbl
  9599
  9600******************************************************************
  9601*                                                                *
  9602*           E D I T   I S S U E   C O V E R A G E S              *
  9603*                                                                *
  9604******************************************************************
  9605
  9606 1020-EDIT-COVERAGES.
  9607     ADD +1                      TO WS-SUB1.
  9608
  9609     IF WS-SUB1 GREATER +2
  9610        GO TO 1025-EDIT-CONTINUE
  9611     END-IF
  9612
  9613
  9614     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9615        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9616        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9617        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9618        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9619        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9620        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9621        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9622        NEXT SENTENCE
  9623         ELSE
  9624            GO TO 1020-EDIT-COVERAGES.
  9625
  9626 1021-CONT-EDIT.
  9627
  9628     IF BMAINTI = 'A'
  9629        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9630           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9631        ELSE
  9632           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9633           MOVE ER-7404          TO EMI-ERROR
  9634           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9635           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9636     ELSE
  9637        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9638           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9639
  9640     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9641        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9642        PERFORM 8600-DEEDIT
  9643        IF DEEDIT-FIELD-V0 NUMERIC
  9644           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9645        ELSE
  9646           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9647
  9648
  9649     IF BMAINTI = ('C' OR 'K')
  9650        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9651           NEXT SENTENCE
  9652        ELSE
  9653           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9654           PERFORM 8600-DEEDIT
  9655           IF DEEDIT-FIELD-V0 NUMERIC
  9656              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 178
* VP6311.cbl
  9657              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9658                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9659              ELSE
  9660                    MOVE ER-2241      TO EMI-ERROR
  9661                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9662                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9663                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9664           ELSE
  9665              MOVE ER-2223          TO EMI-ERROR
  9666              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9667              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9668              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9669     ELSE
  9670        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9671            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9672            PERFORM 8600-DEEDIT
  9673            IF DEEDIT-FIELD-V0      NUMERIC
  9674               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9675                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9676                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9677               ELSE
  9678                  MOVE ER-2241         TO EMI-ERROR
  9679                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9680                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9681                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9682            ELSE
  9683              MOVE ER-2223             TO EMI-ERROR
  9684              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9685              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9686              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9687        ELSE
  9688            MOVE ER-2240               TO EMI-ERROR
  9689            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9690            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9691
  9692     IF BBEN-LEN (WS-SUB1) = ZEROS
  9693        AND BMAINTI = ('C' OR 'K')
  9694           NEXT SENTENCE
  9695     ELSE
  9696        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9697           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9698
  9699* EXEC CICS BIF DEEDIT
  9700*              FIELD  (BBENI (WS-SUB1))
  9701*              LENGTH (12)
  9702*          END-EXEC
  9703     MOVE 12
  9704       TO DFHEIV11
  9705*    MOVE '@"L                   #   #00009633' TO DFHEIV0
  9706     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9707     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9708     MOVE X'2020233030303039363333' TO DFHEIV0(25:11)
  9709     CALL 'kxdfhei1' USING DFHEIV0,
  9710           BBENI(WS-SUB1),
  9711           DFHEIV11
  9712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9713           IF BBENI (WS-SUB1)  NUMERIC
  9714              IF BBENI (WS-SUB1) GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 179
* VP6311.cbl
  9715                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9716*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9717*          PERFORM 8600-DEEDIT
  9718*          IF DEEDIT-FIELD-V2  NUMERIC
  9719*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9720*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9721              ELSE
  9722                 MOVE ER-7632    TO EMI-ERROR
  9723                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9724                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9725                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9726           ELSE
  9727              MOVE ER-2223         TO EMI-ERROR
  9728              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9729              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9730              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9731        ELSE
  9732           MOVE ER-7632    TO EMI-ERROR
  9733           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9734           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9735           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9736
  9737     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9738        AND (BMAINTI = ('C' OR 'K'))
  9739        CONTINUE
  9740     ELSE
  9741        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9742           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9743           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9744              FOR ALL '.'
  9745           IF WS-TALLY > 1
  9746              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9747                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9748              END-PERFORM
  9749              IF A1 < 9
  9750                 ADD 3 TO A1
  9751                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9752              END-IF
  9753           ELSE
  9754              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9755                (A1 > 11)
  9756                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9757                  LOW-VALUES OR SPACES)
  9758              END-PERFORM
  9759              IF A1 > 1 AND < 12
  9760                 MOVE SPACES
  9761                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9762              END-IF
  9763           END-IF
  9764
  9765* EXEC CICS BIF DEEDIT
  9766*              FIELD  (BPREMI (WS-SUB1))
  9767*              LENGTH (11)
  9768*          END-EXEC
  9769     MOVE 11
  9770       TO DFHEIV11
  9771*    MOVE '@"L                   #   #00009688' TO DFHEIV0
  9772     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 180
* VP6311.cbl
  9773     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9774     MOVE X'2020233030303039363838' TO DFHEIV0(25:11)
  9775     CALL 'kxdfhei1' USING DFHEIV0,
  9776           BPREMI(WS-SUB1),
  9777           DFHEIV11
  9778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9779           IF BPREMI (WS-SUB1) NUMERIC
  9780              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9781                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9782*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9783*          PERFORM 8600-DEEDIT
  9784*          IF DEEDIT-FIELD-V2  NUMERIC
  9785*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9786*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9787              ELSE
  9788                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9789                    MOVE ER-7633    TO EMI-ERROR
  9790                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9791                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9792                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9793                 END-IF
  9794              END-IF
  9795           ELSE
  9796              MOVE ER-2223         TO EMI-ERROR
  9797              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9798              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9799              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9800           END-IF
  9801        ELSE
  9802           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9803              MOVE ER-7633         TO EMI-ERROR
  9804              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9805              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9806              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9807           END-IF
  9808        END-IF
  9809     END-IF
  9810
  9811     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9812        NEXT SENTENCE
  9813     ELSE
  9814        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9815
  9816* EXEC CICS BIF DEEDIT
  9817*           FIELD  (BCPREMI (WS-SUB1))
  9818*           LENGTH (11)
  9819*       END-EXEC
  9820     MOVE 11
  9821       TO DFHEIV11
  9822*    MOVE '@"L                   #   #00009728' TO DFHEIV0
  9823     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9824     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9825     MOVE X'2020233030303039373238' TO DFHEIV0(25:11)
  9826     CALL 'kxdfhei1' USING DFHEIV0,
  9827           BCPREMI(WS-SUB1),
  9828           DFHEIV11
  9829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9830        IF BCPREMI (WS-SUB1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 181
* VP6311.cbl
  9831           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9832*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9833*       PERFORM 8600-DEEDIT
  9834*       IF DEEDIT-FIELD-V2  NUMERIC
  9835*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9836        ELSE
  9837           MOVE ER-2223         TO EMI-ERROR
  9838           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9839           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9840           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9841
  9842     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9843        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9844        PERFORM 8600-DEEDIT
  9845        IF DEEDIT-FIELD-V0 NUMERIC
  9846           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9847           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9848         ELSE
  9849           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9850           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9851           MOVE ER-2223              TO EMI-ERROR
  9852           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9853
  9854     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9855        IF BEXPIRE   (WS-SUB1) = SPACES
  9856           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9857        ELSE
  9858           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9859           PERFORM 8600-DEEDIT
  9860           IF DEEDIT-FIELD-V0        NUMERIC
  9861              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9862              MOVE 4                TO DC-OPTION-CODE
  9863              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9864              PERFORM 9700-DATE-LINK
  9865              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9866                                                        (WS-SUB1)
  9867              IF NO-CONVERSION-ERROR
  9868                 NEXT SENTENCE
  9869              ELSE
  9870                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9871                 MOVE ER-2531    TO EMI-ERROR
  9872                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9873                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9874           ELSE
  9875             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9876             MOVE ER-2532        TO EMI-ERROR
  9877             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9878             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9879
  9880     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9881        NEXT SENTENCE
  9882     ELSE
  9883
  9884* EXEC CICS BIF DEEDIT
  9885*           FIELD  (BALT-BENI (WS-SUB1))
  9886*           LENGTH (12)
  9887*       END-EXEC
  9888     MOVE 12
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 182
* VP6311.cbl
  9889       TO DFHEIV11
  9890*    MOVE '@"L                   #   #00009785' TO DFHEIV0
  9891     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9892     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9893     MOVE X'2020233030303039373835' TO DFHEIV0(25:11)
  9894     CALL 'kxdfhei1' USING DFHEIV0,
  9895           BALT-BENI(WS-SUB1),
  9896           DFHEIV11
  9897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9898        IF BALT-BENI (WS-SUB1) NUMERIC
  9899           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9900*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9901*       PERFORM 8600-DEEDIT
  9902*       IF DEEDIT-FIELD-V0 NUMERIC
  9903*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9904        ELSE
  9905           MOVE ER-2223         TO EMI-ERROR
  9906           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9907           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9909
  9910     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9911        NEXT SENTENCE
  9912     ELSE
  9913
  9914* EXEC CICS BIF DEEDIT
  9915*           FIELD  (BALT-PREMI (WS-SUB1))
  9916*           LENGTH (11)
  9917*       END-EXEC
  9918     MOVE 11
  9919       TO DFHEIV11
  9920*    MOVE '@"L                   #   #00009804' TO DFHEIV0
  9921     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9922     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9923     MOVE X'2020233030303039383034' TO DFHEIV0(25:11)
  9924     CALL 'kxdfhei1' USING DFHEIV0,
  9925           BALT-PREMI(WS-SUB1),
  9926           DFHEIV11
  9927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9928        IF BALT-PREMI (WS-SUB1) NUMERIC
  9929           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9930*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9931*       PERFORM 8600-DEEDIT
  9932*       IF DEEDIT-FIELD-V0 NUMERIC
  9933*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9934        ELSE
  9935           MOVE ER-2223         TO EMI-ERROR
  9936           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9937           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9938           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9939
  9940      GO TO 1020-EDIT-COVERAGES.
  9941     .
  9942 1025-edit-continue.
  9943     IF PI-COMPANY-ID  =  'DMD'
  9944        MOVE LOW-VALUES             TO BNCERTI
  9945                                       BNSTATI.
  9946
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 183
* VP6311.cbl
  9947     IF EMI-ERROR = ZEROS
  9948         NEXT SENTENCE
  9949     ELSE
  9950         GO TO 8200-SEND-DATAONLY.
  9951
  9952     IF BMAINTI = 'A'
  9953         GO TO 1200-ADD-ISSUE-ROUTINE.
  9954
  9955     IF BMAINTI = 'C'
  9956         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9957
  9958     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9959
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 184
* VP6311.cbl
  9961
  9962 1030-EDIT-FOR-NUMERICS.
  9963     IF WS-CSO-SUB EQUAL 10
  9964        GO TO 1030-EDIT-EXIT.
  9965
  9966     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9967        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9968        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9969           ADD +1               TO WS-CSO-SUB
  9970           GO TO 1030-EDIT-FOR-NUMERICS.
  9971
  9972     MOVE 'N'                   TO WS-NUMERIC-SW.
  9973
  9974 1030-EDIT-EXIT.
  9975******************************************************************
  9976*                                                                *
  9977*                 C A L C U L A T E   A G E                      *
  9978*                                                                *
  9979******************************************************************
  9980
  9981
  9982 1095-CALC-AGE.
  9983
  9984     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9985     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9986     MOVE 1                  TO DC-OPTION-CODE.
  9987     PERFORM 9700-DATE-LINK
  9988     IF NO-CONVERSION-ERROR
  9989         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9990         MOVE WS-BAGE            TO BAGEI
  9991         MOVE +2                 TO BAGEL
  9992         MOVE AL-UNNON TO BAGEA.
  9993
  9994 1099-EXIT.
  9995     EXIT.
  9996
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 185
* VP6311.cbl
  9998
  9999******************************************************************
 10000*                                                                *
 10001*                   S H O W   I S S U E                          *
 10002*                                                                *
 10003******************************************************************
 10004
 10005 1100-SHOW-REQUEST.
 10006     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10007
 10008     IF BCERTNOL = ZEROS AND
 10009        BEFFDTL  = ZEROS
 10010        MOVE -1                  TO BMAINTL
 10011        GO TO 8200-SEND-DATAONLY.
 10012
 10013     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10014
 10015     IF BSUFIXL NOT = ZEROS
 10016        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10017     ELSE
 10018        MOVE SPACE               TO WS-NEW-SUFFIX.
 10019
 10020     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10021     PERFORM 8600-DEEDIT.
 10022     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10023     MOVE '4'                    TO DC-OPTION-CODE.
 10024     PERFORM 9700-DATE-LINK.
 10025     IF DATE-CONVERSION-ERROR
 10026        MOVE ER-0348             TO EMI-ERROR
 10027        MOVE -1                  TO BEFFDTL
 10028        MOVE AL-UABON            TO BEFFDTA
 10029        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10030        GO TO 8200-SEND-DATAONLY
 10031     ELSE
 10032        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10033        MOVE AL-UANON            TO BEFFDTA
 10034        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10035
 10036     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10037
 10038     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10039        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10040          MOVE 'Y'                    TO WS-SHOW-SW
 10041          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10042             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10043           ELSE
 10044             IF PI-FILE-BROWSE
 10045                GO TO 4300-BROWSE-FILE-FORWARD
 10046              ELSE
 10047                IF PI-CSR-BROWSE
 10048                   GO TO 4200-BROWSE-CSR-FORWARD
 10049                ELSE
 10050                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10051        ELSE
 10052           GO TO 3900-RE-DISPLAY-RECORD.
 10053
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 186
* VP6311.cbl
 10055
 10056******************************************************************
 10057*                                                                *
 10058*            A D D   I S S U E   R O U T I N E                   *
 10059*                                                                *
 10060******************************************************************
 10061
 10062***************************************************************
 10063*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10064*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10065*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10066*     4. LINK TO THE EDIT ROUTINE.                            *
 10067*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10068*     6. WRITE THE NEW ISSUE RECORD.                          *
 10069*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10070*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10071*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10072*        ELSE                                                 *
 10073*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10074***************************************************************
 10075
 10076 1200-ADD-ISSUE-ROUTINE.
 10077     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10078
 10079
 10080* EXEC CICS GETMAIN
 10081*        SET     (ADDRESS OF PENDING-BUSINESS)
 10082*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10083*    END-EXEC.
 10084*    MOVE '," L                  $   #00009959' TO DFHEIV0
 10085     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10086     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10087     MOVE X'2020233030303039393539' TO DFHEIV0(25:11)
 10088     CALL 'kxdfhei1' USING DFHEIV0,
 10089           DFHEIV20,
 10090           ERPNDB-RECORD-LENGTH,
 10091           DFHEIV99
 10092     SET ADDRESS OF PENDING-BUSINESS TO
 10093         DFHEIV20
 10094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10095
 10096
 10097
 10098* EXEC CICS HANDLE CONDITION
 10099*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10100*    END-EXEC.
 10101*    MOVE '"$I                   ! # #00009964' TO DFHEIV0
 10102     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10104     MOVE X'2320233030303039393634' TO DFHEIV0(25:11)
 10105     CALL 'kxdfhei1' USING DFHEIV0
 10106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10107
 10108
 10109     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10110     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10111     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10112
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 187
* VP6311.cbl
 10113
 10114* EXEC CICS READ
 10115*        INTO    (PENDING-BUSINESS)
 10116*        DATASET (FILE-ID-ERPNDB)
 10117*        RIDFLD  (ERPNDB-KEY)
 10118*    END-EXEC.
 10119     MOVE LENGTH OF
 10120      PENDING-BUSINESS
 10121       TO DFHEIV11
 10122*    MOVE '&"IL       E          (   #00009972' TO DFHEIV0
 10123     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10125     MOVE X'2020233030303039393732' TO DFHEIV0(25:11)
 10126     CALL 'kxdfhei1' USING DFHEIV0,
 10127           FILE-ID-ERPNDB,
 10128           PENDING-BUSINESS,
 10129           DFHEIV11,
 10130           ERPNDB-KEY,
 10131           DFHEIV99,
 10132           DFHEIV99,
 10133           DFHEIV99
 10134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10135
 10136
 10137     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10138
 10139     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10140     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10141     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10142     MOVE SPACES                 TO PENDING-BUSINESS.
 10143     MOVE 'PB'                   TO PB-RECORD-ID.
 10144     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10145     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10146     MOVE SPACES                 TO PB-CERT-SFX.
 10147     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10148     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10149                                    PB-ALT-CHG-SEQ-NO.
 10150
 10151     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10152     MOVE '1'                    TO PB-RECORD-TYPE.
 10153
 10154     IF BSUFIXL NOT = ZEROS
 10155        MOVE BSUFIXI             TO PB-CERT-SFX.
 10156
 10157     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10158
 10159     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10160     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10161
 10162     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10163                                    PB-I-LF-PREM-CALC
 10164                                    PB-I-LF-ALT-PREM-CALC
 10165                                    PB-I-LF-RATE
 10166                                    PB-I-LF-ALT-RATE
 10167                                    PB-I-LF-REI-RATE
 10168                                    PB-I-LF-ALT-REI-RATE
 10169                                    PB-I-RATE-DEV-PCT-LF
 10170                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 188
* VP6311.cbl
 10171                                    PB-I-AH-RATE
 10172                                    PB-I-AH-REI-RATE
 10173                                    PB-I-AH-RATE-TRM
 10174                                    PB-I-RATE-DEV-PCT-AH
 10175                                    PB-I-BUSINESS-TYPE
 10176                                    PB-I-LIFE-COMMISSION
 10177                                    PB-I-JOINT-COMMISSION
 10178                                    PB-I-JOINT-AGE
 10179                                    PB-I-AH-COMMISSION
 10180                                    PB-I-CURR-SEQ
 10181                                    PB-CHG-COUNT
 10182                                    PB-LF-BILLED-AMTS
 10183                                    PB-AH-BILLED-AMTS
 10184                                    PB-CALC-TOLERANCE
 10185                                    PB-I-EXTENTION-DAYS
 10186*                                   PB-I-MICROFILM-NO
 10187                                    PB-I-TERM-IN-DAYS.
 10188
 10189     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10190                                    PB-I-LF-EXPIRE-DT
 10191                                    PB-I-AH-EXPIRE-DT
 10192                                    PB-BILLED-DT
 10193                                    PB-ACCT-EFF-DT
 10194                                    PB-ACCT-EXP-DT
 10195                                    PB-I-1ST-PMT-DT.
 10196
 10197     MOVE 'X'                    TO PB-FATAL-FLAG.
 10198
 10199     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10200
 10201     IF BLSTNML GREATER THAN ZEROS
 10202         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10203
 10204*    IF BMICRNOL  GREATER  ZEROS
 10205*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10206*    ELSE
 10207*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10208     IF BVINL > ZEROS
 10209        MOVE BVINI               TO PB-I-VIN
 10210     END-IF
 10211     IF B1STNML GREATER THAN ZEROS
 10212         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10213
 10214     IF BINITL  GREATER THAN ZEROS
 10215         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10216
 10217     IF BBIRTHL GREATER THAN ZERO
 10218         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10219     ELSE
 10220         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10221
 10222
 10223     IF BAGEL    GREATER THAN ZEROS
 10224         MOVE BAGEI              TO PB-I-AGE
 10225        ELSE
 10226         MOVE ZEROS              TO PB-I-AGE.
 10227
 10228     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 189
* VP6311.cbl
 10229         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10230
 10231     IF BTERM-LEN (1) GREATER THAN ZEROS
 10232        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10233     ELSE
 10234        MOVE ZEROS               TO PB-I-LF-TERM.
 10235
 10236     IF BTERM-LEN (2) GREATER THAN ZEROS
 10237        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10238     ELSE
 10239        MOVE ZEROS               TO PB-I-AH-TERM.
 10240
 10241
 10242
 10243     IF BSKPCDL       GREATER THAN ZEROS
 10244         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10245
 10246
 10247         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10248                                    PI-BPMTS.
 10249
 10250         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10251
 10252     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10253        IF BTYPE  (1)   NOT = ZEROS
 10254           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10255                                    PI-BTYPE (1)
 10256           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10257           MOVE SPACES           TO PB-I-LF-ABBR
 10258        ELSE
 10259           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10260                                    PB-I-LF-ABBR
 10261           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10262     ELSE
 10263        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10264                                    PB-I-LF-ABBR
 10265        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10266
 10267     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10268         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10269     ELSE
 10270         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10271
 10272     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10273         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10274     ELSE
 10275         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10276
 10277     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10278         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10279            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10280            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10281         ELSE
 10282            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10283*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10284*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10285         END-IF
 10286     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 190
* VP6311.cbl
 10287         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10288
 10289     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10290         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10291
 10292     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10293         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10294         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10295     ELSE
 10296         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10297
 10298     IF  BALT-PREM-LEN     (2) > ZEROS
 10299         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10300     ELSE
 10301         MOVE ZEROS            TO PB-I-TOT-FEES.
 10302
 10303     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10304        IF BTYPE      (2)   NOT = ZEROS
 10305           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10306                                  PI-BTYPE (2)
 10307           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10308           MOVE SPACES         TO PB-I-AH-ABBR
 10309        ELSE
 10310           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10311                                  PB-I-AH-ABBR
 10312           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10313     ELSE
 10314        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10315                                  PB-I-AH-ABBR
 10316        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10317
 10318     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10319         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10320     ELSE
 10321         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10322
 10323     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10324         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10325            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10326            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10327         ELSE
 10328            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10329*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10330*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10331         END-IF
 10332     ELSE
 10333         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10334
 10335     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10336         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10337
 10338     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10339        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10340     ELSE
 10341        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10342
 10343     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10344        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 191
* VP6311.cbl
 10345     ELSE
 10346        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10347
 10348     IF BINDGRPL  GREATER THAN ZEROS
 10349         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10350
 10351     IF BRTCLSL   GREATER THAN ZEROS
 10352         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10353
 10354     IF BSIGL     GREATER THAN ZEROS
 10355         MOVE BSIGI              TO PB-I-SIG-SW.
 10356     IF BMEMBERL  GREATER THAN ZEROS
 10357         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10358
 10359     IF BLNOFCRL  GREATER THAN ZEROS
 10360         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10361
 10362     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10363        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10364     ELSE
 10365        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10366
 10367     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10368        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10369     ELSE
 10370        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10371
 10372
 10373     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10374        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10375           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10376
 10377     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10378        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10379           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10380
 10381
 10382     IF PB-EXT-DAYS-PROCESSING
 10383        IF PB-I-EXTENTION-DAYS = ZEROS
 10384           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10385
 10386     IF PB-EXPIRE-DT-PROCESSING
 10387        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10388           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10389             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10390
 10391     IF PB-1ST-PMT-DT-PROCESSING
 10392        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10393           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10394
 10395     IF BREINL GREATER THAN ZEROS
 10396        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10397
 10398     IF BENTRYL NOT = ZEROS
 10399        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10400        IF PI-COMPANY-ID = 'CID'
 10401           AND (PB-BATCH-ENTRY = 'P')
 10402           AND (PB-STATE = 'VA')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 192
* VP6311.cbl
 10403           PERFORM 1500-UPDATE-ERNOTE
 10404                                 THRU 1500-EXIT
 10405        END-IF
 10406     END-IF
 10407     IF BUNWRITL NOT = ZEROS
 10408        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10409
 10410     IF BFORCEL NOT = ZEROS
 10411        MOVE BFORCEI             TO PB-FORCE-CODE.
 10412
 10413     IF BBILCDL NOT = ZEROS
 10414        MOVE BBILCDI             TO PB-RECORD-BILL.
 10415
 10416
 10417
 10418 1260-WRITE-PB-RECORD.
 10419     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10420                                    PB-INPUT-BY.
 10421     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10422     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10423                                    PB-INPUT-DT.
 10424
 10425     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10426     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10427                                    PB-CONTROL-BY-ORIG-BATCH.
 10428
 10429
 10430     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10431     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10432     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10433     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10434     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10435
 10436     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10437
 10438     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10439
 10440     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10441     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10442     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10443
 10444     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10445     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10446
 10447 1275-WRITE-PENDING-BUSINESS.
 10448     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10449     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10450     MOVE 'A'                    TO JP-RECORD-TYPE.
 10451     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10452
 10453
 10454* EXEC CICS HANDLE CONDITION
 10455*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10456*    END-EXEC.
 10457*    MOVE '"$%                   ! $ #00010294' TO DFHEIV0
 10458     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10460     MOVE X'2420233030303130323934' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 193
* VP6311.cbl
 10461     CALL 'kxdfhei1' USING DFHEIV0
 10462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10463
 10464
 10465
 10466* EXEC CICS WRITE
 10467*        DATASET (FILE-ID-ERPNDB)
 10468*        FROM    (PENDING-BUSINESS)
 10469*        RIDFLD  (PB-CONTROL-PRIMARY)
 10470*    END-EXEC.
 10471     MOVE LENGTH OF
 10472      PENDING-BUSINESS
 10473       TO DFHEIV11
 10474*    MOVE '&$ L                  ''   #00010298' TO DFHEIV0
 10475     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10476     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10477     MOVE X'2020233030303130323938' TO DFHEIV0(25:11)
 10478     CALL 'kxdfhei1' USING DFHEIV0,
 10479           FILE-ID-ERPNDB,
 10480           PENDING-BUSINESS,
 10481           DFHEIV11,
 10482           PB-CONTROL-PRIMARY,
 10483           DFHEIV99,
 10484           DFHEIV99
 10485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10486
 10487
 10488     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10489
 10490     PERFORM 8400-LOG-JOURNAL-RECORD.
 10491
 10492******************************************************************
 10493*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10494******************************************************************
 10495*    display ' made it to add orig cert '
 10496     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10497     MOVE ' '                    TO WS-ERMAIL-SW
 10498
 10499* EXEC CICS READ
 10500*       DATASET   (FILE-ID-ERMAIL)
 10501*       SET       (ADDRESS OF MAILING-DATA)
 10502*       RIDFLD    (ERMAIL-KEY)
 10503*       RESP      (WS-RESPONSE)
 10504*    END-EXEC
 10505*    MOVE '&"S        E          (  N#00010314' TO DFHEIV0
 10506     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10507     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10508     MOVE X'204E233030303130333134' TO DFHEIV0(25:11)
 10509     CALL 'kxdfhei1' USING DFHEIV0,
 10510           FILE-ID-ERMAIL,
 10511           DFHEIV20,
 10512           DFHEIV99,
 10513           ERMAIL-KEY,
 10514           DFHEIV99,
 10515           DFHEIV99,
 10516           DFHEIV99
 10517     SET ADDRESS OF MAILING-DATA TO
 10518         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 194
* VP6311.cbl
 10519     MOVE EIBRESP  TO WS-RESPONSE
 10520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10521     IF RESP-NORMAL
 10522        SET ERMAIL-FOUND TO TRUE
 10523     END-IF
 10524
 10525     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10526     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10527     MOVE 'OC'                   TO OC-RECORD-ID
 10528     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10529                                 TO OC-CONTROL-PRIMARY (1:33)
 10530     MOVE 'I'                    TO OC-RECORD-TYPE
 10531     MOVE +4096                  TO OC-KEY-SEQ-NO
 10532     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10533     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10534     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10535     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10536     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10537     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10538     MOVE PB-I-AGE               TO OC-INS-AGE
 10539     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10540     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10541     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10542     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10543     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10544     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10545     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10546     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10547     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10548     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10549     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10550     IF PB-I-JOINT-COMMISSION > +0
 10551         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10552     ELSE
 10553         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10554     END-IF
 10555     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10556     MOVE +0                     TO OC-LF-CANCEL-AMT
 10557                                    OC-LF-ITD-CANCEL-AMT
 10558     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10559     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10560     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10561     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10562     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10563     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10564     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10565     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10566     MOVE +0                     TO OC-AH-CANCEL-AMT
 10567                                    OC-AH-ITD-CANCEL-AMT
 10568     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10569     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10570     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10571     IF ERMAIL-FOUND
 10572        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10573     END-IF
 10574     IF NOT CERT-TRL-REC-NOT-FOUND
 10575        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10576                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 195
* VP6311.cbl
 10577        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10578                           OC-JNT-AGE-DEFAULT-FLAG
 10579     END-IF
 10580     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10581     .
 10582 1275-WRITE-ELCRTO.
 10583
 10584* EXEC CICS WRITE
 10585*       DATASET   ('ELCRTO')
 10586*       FROM      (ORIGINAL-CERTIFICATE)
 10587*       RIDFLD    (OC-CONTROL-PRIMARY)
 10588*       RESP      (WS-RESPONSE)
 10589*    END-EXEC
 10590     MOVE LENGTH OF
 10591      ORIGINAL-CERTIFICATE
 10592       TO DFHEIV11
 10593     MOVE 'ELCRTO' TO DFHEIV1
 10594*    MOVE '&$ L                  ''  N#00010382' TO DFHEIV0
 10595     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10596     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10597     MOVE X'204E233030303130333832' TO DFHEIV0(25:11)
 10598     CALL 'kxdfhei1' USING DFHEIV0,
 10599           DFHEIV1,
 10600           ORIGINAL-CERTIFICATE,
 10601           DFHEIV11,
 10602           OC-CONTROL-PRIMARY,
 10603           DFHEIV99,
 10604           DFHEIV99
 10605     MOVE EIBRESP  TO WS-RESPONSE
 10606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10607*    display ' just wrote 1275 ' ws-response
 10608     IF RESP-DUPKEY
 10609        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10610        GO TO 1275-WRITE-ELCRTO
 10611     ELSE
 10612        IF NOT RESP-NORMAL
 10613           MOVE -1               TO BMAINTL
 10614           MOVE ER-7450          TO EMI-ERROR
 10615           PERFORM 9900-ERROR-FORMAT
 10616                                 THRU 9900-EXIT
 10617           GO TO 8200-SEND-DATAONLY
 10618        END-IF
 10619     END-IF
 10620******************************************************************
 10621*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10622******************************************************************
 10623
 10624
 10625* EXEC CICS READ
 10626*        INTO    (PENDING-BUSINESS)
 10627*        DATASET (FILE-ID-ERPNDB)
 10628*        RIDFLD  (ERPNDB-KEY)
 10629*        UPDATE
 10630*    END-EXEC.
 10631     MOVE LENGTH OF
 10632      PENDING-BUSINESS
 10633       TO DFHEIV11
 10634*    MOVE '&"IL       EU         (   #00010405' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 196
* VP6311.cbl
 10635     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10636     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10637     MOVE X'2020233030303130343035' TO DFHEIV0(25:11)
 10638     CALL 'kxdfhei1' USING DFHEIV0,
 10639           FILE-ID-ERPNDB,
 10640           PENDING-BUSINESS,
 10641           DFHEIV11,
 10642           ERPNDB-KEY,
 10643           DFHEIV99,
 10644           DFHEIV99,
 10645           DFHEIV99
 10646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10647
 10648
 10649     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10650     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10651     MOVE 'B'                    TO JP-RECORD-TYPE.
 10652     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10653
 10654     PERFORM 8400-LOG-JOURNAL-RECORD.
 10655
 10656     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10657
 10658
 10659* EXEC CICS REWRITE
 10660*        DATASET (FILE-ID-ERPNDB)
 10661*        FROM    (PENDING-BUSINESS)
 10662*    END-EXEC.
 10663     MOVE LENGTH OF
 10664      PENDING-BUSINESS
 10665       TO DFHEIV11
 10666*    MOVE '&& L                  %   #00010421' TO DFHEIV0
 10667     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10668     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10669     MOVE X'2020233030303130343231' TO DFHEIV0(25:11)
 10670     CALL 'kxdfhei1' USING DFHEIV0,
 10671           FILE-ID-ERPNDB,
 10672           PENDING-BUSINESS,
 10673           DFHEIV11,
 10674           DFHEIV99
 10675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10676
 10677
 10678     MOVE 'C'                    TO JP-RECORD-TYPE.
 10679     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10680
 10681     PERFORM 8400-LOG-JOURNAL-RECORD.
 10682
 10683     IF WS-ERRORS-PRESENT
 10684         GO TO 3900-RE-DISPLAY-RECORD.
 10685
 10686     MOVE ZEROS                  TO EMI-ERROR.
 10687     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10688     MOVE LOW-VALUES             TO VP631BI.
 10689     MOVE  -1                    TO BMAINTL.
 10690     GO TO 8100-SEND-INITIAL-MAP.
 10691
 10692 1280-BATCH-HDR-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 197
* VP6311.cbl
 10693     MOVE -1                     TO BMAINTL.
 10694     MOVE ER-7450                TO EMI-ERROR.
 10695     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10696     GO TO 8200-SEND-DATAONLY.
 10697
 10698 1290-DUPLICATE-ALT-INDEX.
 10699
 10700******************************************************************
 10701*                                                                *
 10702*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10703*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10704*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10705*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10706*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10707*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10708*                                                                *
 10709******************************************************************
 10710
 10711     IF LCP-ONCTR-01 =  0
 10712         ADD 1 TO LCP-ONCTR-01
 10713        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10714
 10715     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10716
 10717     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10718         NEXT SENTENCE
 10719     ELSE
 10720         ADD +1 TO PB-BATCH-SEQ-NO
 10721                   PB-CSR-BATCH-SEQ-NO
 10722         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10723         GO TO 1275-WRITE-PENDING-BUSINESS.
 10724
 10725     MOVE -1                     TO BCERTNOL.
 10726     MOVE AL-UABON               TO BCERTNOA.
 10727     MOVE AL-UNBON               TO BEFFDTA.
 10728
 10729     MOVE 1                      TO EMI-SUB
 10730                                    EMI-SWITCH1
 10731                                    EMI-SWITCH-AREA-1
 10732                                    EMI-SWITCH-AREA-2.
 10733
 10734     MOVE SPACES                 TO EMI-ERROR-LINES.
 10735
 10736
 10737* EXEC CICS SYNCPOINT ROLLBACK
 10738*    END-EXEC.
 10739*    MOVE '6"R                   !   #00010484' TO DFHEIV0
 10740     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10742     MOVE X'2020233030303130343834' TO DFHEIV0(25:11)
 10743     CALL 'kxdfhei1' USING DFHEIV0
 10744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10745
 10746
 10747     MOVE ER-2247                TO EMI-ERROR.
 10748     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10749     GO TO 8200-SEND-DATAONLY.
 10750
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 198
* VP6311.cbl
 10752
 10753
 10754 1295-READ-CERT-TRAILER.
 10755
 10756
 10757* EXEC CICS GETMAIN
 10758*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10759*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10760*        INITIMG (GETMAIN-SPACE)
 10761*    END-EXEC
 10762*    MOVE ',"IL                  $   #00010496' TO DFHEIV0
 10763     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10764     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10765     MOVE X'2020233030303130343936' TO DFHEIV0(25:11)
 10766     CALL 'kxdfhei1' USING DFHEIV0,
 10767           DFHEIV20,
 10768           ELCRTT-RECORD-LENGTH,
 10769           GETMAIN-SPACE
 10770     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10771         DFHEIV20
 10772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10773
 10774     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10775     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10776     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10777
 10778
 10779* EXEC CICS HANDLE CONDITION
 10780*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10781*    END-EXEC.
 10782*    MOVE '"$I                   ! % #00010506' TO DFHEIV0
 10783     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10785     MOVE X'2520233030303130353036' TO DFHEIV0(25:11)
 10786     CALL 'kxdfhei1' USING DFHEIV0
 10787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10788
 10789
 10790
 10791* EXEC CICS READ
 10792*        DATASET  (CRTT-ID)
 10793*        RIDFLD   (ELCRTT-KEY)
 10794*        INTO     (CERTIFICATE-TRAILERS)
 10795*    END-EXEC.
 10796     MOVE LENGTH OF
 10797      CERTIFICATE-TRAILERS
 10798       TO DFHEIV11
 10799*    MOVE '&"IL       E          (   #00010510' TO DFHEIV0
 10800     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10802     MOVE X'2020233030303130353130' TO DFHEIV0(25:11)
 10803     CALL 'kxdfhei1' USING DFHEIV0,
 10804           CRTT-ID,
 10805           CERTIFICATE-TRAILERS,
 10806           DFHEIV11,
 10807           ELCRTT-KEY,
 10808           DFHEIV99,
 10809           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 199
* VP6311.cbl
 10810           DFHEIV99
 10811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10812
 10813
 10814     GO TO 1295-EXIT.
 10815
 10816 1295-CERT-TRL-REC-NOTFND.
 10817     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10818
 10819 1295-EXIT.
 10820     EXIT.
 10821
 10822******************************************************************
 10823*                                                                *
 10824*          C H A N G E   I S S U E   R O U T I N E               *
 10825*                                                                *
 10826******************************************************************
 10827
 10828***************************************************************
 10829*                                                             *
 10830*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10831*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10832*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10833*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10834*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10835*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10836*     5. LINK TO THE EDIT ROUTINE.                            *
 10837*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10838*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10839*              THE EDIT ROUTINE.                              *
 10840*     7. REWRITE THE NEW ISSUE                                *
 10841*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10842*                                                             *
 10843***************************************************************
 10844
 10845 1300-CHANGE-ISSUE-ROUTINE.
 10846     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10847
 10848     IF BCHGL NOT = ZEROS
 10849        MOVE ER-2196             TO EMI-ERROR
 10850        MOVE AL-UABON            TO BMAINTA
 10851        MOVE -1                  TO BMAINTL
 10852        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10853        GO TO 8200-SEND-DATAONLY.
 10854
 10855     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10856
 10857     IF BSUFIXL NOT = ZEROS
 10858        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10859     ELSE
 10860        MOVE SPACE               TO WS-NEW-SUFFIX.
 10861
 10862     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10863     PERFORM 8600-DEEDIT.
 10864     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10865     MOVE '4'                    TO DC-OPTION-CODE.
 10866     PERFORM 9700-DATE-LINK.
 10867     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 200
* VP6311.cbl
 10868        MOVE ER-0348             TO EMI-ERROR
 10869        MOVE -1                  TO BEFFDTL
 10870        MOVE AL-UABON            TO BEFFDTA
 10871        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10872        GO TO 8200-SEND-DATAONLY
 10873     ELSE
 10874        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10875        MOVE AL-UANON            TO BEFFDTA
 10876        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10877
 10878 1325-PROCESS-ISSUE-CHANGES.
 10879
 10880* EXEC CICS HANDLE CONDITION
 10881*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10882*    END-EXEC.
 10883*    MOVE '"$I                   ! & #00010581' TO DFHEIV0
 10884     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10885     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10886     MOVE X'2620233030303130353831' TO DFHEIV0(25:11)
 10887     CALL 'kxdfhei1' USING DFHEIV0
 10888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10889
 10890
 10891     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10892     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10893     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10894
 10895
 10896* EXEC CICS GETMAIN
 10897*        SET      (ADDRESS OF PENDING-BUSINESS)
 10898*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10899*        INITIMG  (GETMAIN-SPACE)
 10900*     END-EXEC.
 10901*    MOVE ',"IL                  $   #00010589' TO DFHEIV0
 10902     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10904     MOVE X'2020233030303130353839' TO DFHEIV0(25:11)
 10905     CALL 'kxdfhei1' USING DFHEIV0,
 10906           DFHEIV20,
 10907           ERPNDB-RECORD-LENGTH,
 10908           GETMAIN-SPACE
 10909     SET ADDRESS OF PENDING-BUSINESS TO
 10910         DFHEIV20
 10911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10912
 10913
 10914
 10915* EXEC CICS READ
 10916*        INTO    (PENDING-BUSINESS)
 10917*        DATASET (FILE-ID-ERPNDB)
 10918*        RIDFLD  (ERPNDB-KEY)
 10919*    END-EXEC.
 10920     MOVE LENGTH OF
 10921      PENDING-BUSINESS
 10922       TO DFHEIV11
 10923*    MOVE '&"IL       E          (   #00010595' TO DFHEIV0
 10924     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 201
* VP6311.cbl
 10926     MOVE X'2020233030303130353935' TO DFHEIV0(25:11)
 10927     CALL 'kxdfhei1' USING DFHEIV0,
 10928           FILE-ID-ERPNDB,
 10929           PENDING-BUSINESS,
 10930           DFHEIV11,
 10931           ERPNDB-KEY,
 10932           DFHEIV99,
 10933           DFHEIV99,
 10934           DFHEIV99
 10935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10936
 10937
 10938     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10939
 10940
 10941* EXEC CICS HANDLE CONDITION
 10942*         NOTFND     (1385-REC-NOT-FOUND)
 10943*    END-EXEC.
 10944*    MOVE '"$I                   ! '' #00010603' TO DFHEIV0
 10945     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10946     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10947     MOVE X'2720233030303130363033' TO DFHEIV0(25:11)
 10948     CALL 'kxdfhei1' USING DFHEIV0
 10949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10950
 10951
 10952**********************************************************
 10953*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10954*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10955**********************************************************
 10956
 10957
 10958* EXEC CICS READ
 10959*        DATASET (FILE-ID-ERPNDB)
 10960*        INTO    (PENDING-BUSINESS)
 10961*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10962*    END-EXEC.
 10963     MOVE LENGTH OF
 10964      PENDING-BUSINESS
 10965       TO DFHEIV11
 10966*    MOVE '&"IL       E          (   #00010612' TO DFHEIV0
 10967     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10969     MOVE X'2020233030303130363132' TO DFHEIV0(25:11)
 10970     CALL 'kxdfhei1' USING DFHEIV0,
 10971           FILE-ID-ERPNDB,
 10972           PENDING-BUSINESS,
 10973           DFHEIV11,
 10974           PI-PREV-CONTROL-PRIMARY,
 10975           DFHEIV99,
 10976           DFHEIV99,
 10977           DFHEIV99
 10978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10979
 10980
 10981********** DO NOT ALLOW CHANGES IF THRU A/R
 10982     IF BMAINTI = 'C'
 10983         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 202
* VP6311.cbl
 10984             MOVE ER-4005          TO EMI-ERROR
 10985             MOVE -1               TO BMAINTL
 10986             MOVE AL-UABON         TO BMAINTA
 10987             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10988             GO TO 8200-SEND-DATAONLY.
 10989**********
 10990
 10991     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 10992        MOVE -1                 TO BMAINTL
 10993        MOVE ER-2197            TO EMI-ERROR
 10994        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10995        GO TO 8200-SEND-DATAONLY.
 10996
 10997     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 10998        MOVE ER-2196             TO EMI-ERROR
 10999        MOVE AL-UABON            TO BMAINTA
 11000        MOVE -1                  TO BMAINTL
 11001        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11002        GO TO 8200-SEND-DATAONLY.
 11003
 11004     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11005
 11006     IF PB-BILLED-DT = LOW-VALUES AND
 11007        PB-CHG-COUNT = ZEROS
 11008        NEXT SENTENCE
 11009     ELSE
 11010        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11011            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11012           OR
 11013           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11014            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11015           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11016     move zeros                  to ws-check-amts
 11017     move ' '                    to ws-stop-sw
 11018                                    ws-check-sw
 11019                                    ws-proc-check-sw
 11020                                    ws-chek-browse-sw
 11021
 11022     perform 2500-browse-checks  thru 2500-exit
 11023
 11024     if i-have-processed-checks
 11025        or i-have-checks
 11026        continue
 11027     else
 11028        go to 1330-continue
 11029     end-if
 11030
 11031     compute ws-tot-orig-prem =
 11032        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11033        pb-i-lf-alt-premium-amt
 11034
 11035     if bprem1l <> zeros
 11036        MOVE AL-UNNON            TO bprem1a
 11037        move ws-bprem (1)        to ws-new-iss-total
 11038     else
 11039        move pb-i-lf-premium-amt to ws-new-iss-total
 11040     end-if
 11041     display ' new iss totala ' ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 203
* VP6311.cbl
 11042
 11043     if baltpr1l <> zeros
 11044        MOVE AL-UNNON            TO baltpr1a
 11045        compute ws-new-iss-total =
 11046           ws-new-iss-total + ws-balt-prem(1)
 11047     else
 11048        compute ws-new-iss-total =
 11049           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11050     end-if
 11051
 11052     if bprem2l <> zeros
 11053        MOVE AL-UNNON            TO bprem2a
 11054        compute ws-new-iss-total = ws-new-iss-total +
 11055           ws-bprem (2)
 11056     else
 11057        compute ws-new-iss-total = ws-new-iss-total +
 11058           pb-i-ah-premium-amt
 11059     end-if
 11060
 11061     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11062        if ((bprem1l <> zeros)
 11063           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11064                      or
 11065           ((bprem2l <> zeros)
 11066           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11067           move er-3456          to emi-error
 11068           perform 9900-error-format
 11069                                 thru 9900-exit
 11070           go to 1330-continue
 11071        end-if
 11072     end-if
 11073
 11074     if ws-new-iss-total > ws-tot-orig-prem
 11075        move er-3458             to emi-error
 11076        perform 9900-error-format thru 9900-exit
 11077        move al-uabon            to bmainta
 11078        move -1                  to bmaintl
 11079        go to 8200-send-dataonly
 11080     end-if
 11081
 11082     if ws-new-iss-total < ws-tot-orig-prem
 11083        move er-3457             to emi-error
 11084        move al-uabon            to bprem1a
 11085                                    bprem2a
 11086        move +0 to bprem1l bprem2l
 11087        perform 9900-error-format thru 9900-exit
 11088        move -1                  to bmaintl
 11089        go to 1330-continue
 11090     end-if
 11091
 11092     .
 11093 1330-continue.
 11094
 11095
 11096* EXEC CICS READ
 11097*        DATASET (FILE-ID-ERPNDB)
 11098*        INTO    (PENDING-BUSINESS)
 11099*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 204
* VP6311.cbl
 11100*        UPDATE
 11101*    END-EXEC.
 11102     MOVE LENGTH OF
 11103      PENDING-BUSINESS
 11104       TO DFHEIV11
 11105*    MOVE '&"IL       EU         (   #00010732' TO DFHEIV0
 11106     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11107     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11108     MOVE X'2020233030303130373332' TO DFHEIV0(25:11)
 11109     CALL 'kxdfhei1' USING DFHEIV0,
 11110           FILE-ID-ERPNDB,
 11111           PENDING-BUSINESS,
 11112           DFHEIV11,
 11113           PI-PREV-CONTROL-PRIMARY,
 11114           DFHEIV99,
 11115           DFHEIV99,
 11116           DFHEIV99
 11117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11118
 11119
 11120     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11121     MOVE 'B'                    TO JP-RECORD-TYPE
 11122     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11123     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11124
 11125     PERFORM 8400-LOG-JOURNAL-RECORD.
 11126
 11127     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11128        PB-CHG-COUNT NOT = ZEROS
 11129        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11130            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11131           OR
 11132           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11133            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11134            MOVE LOW-VALUES             TO PB-BILLED-DT
 11135            ADD +1                      TO PB-CHG-COUNT.
 11136
 11137     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11138     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11139     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11140     MOVE '5'                    TO DC-OPTION-CODE.
 11141     PERFORM 9700-DATE-LINK
 11142     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11143
 11144*    IF BMICRNOL  GREATER  ZEROS
 11145*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11146
 11147     IF BVINL > ZEROS
 11148        MOVE BVINI               TO PB-I-VIN
 11149     END-IF
 11150     IF (BFORCEL NOT = ZEROS)
 11151        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11152        AND (BFORCEI = ' ')
 11153        AND (PB-FORCE-CODE = 'O')
 11154        COMPUTE PB-I-AH-PREMIUM-AMT =
 11155           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11156        PERFORM 1800-REMOVE-CERT-NOTES
 11157                                 THRU 1800-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 205
* VP6311.cbl
 11158        PERFORM 1900-DELETE-ERPYAJ
 11159                                 THRU 1900-EXIT
 11160        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11161     END-IF
 11162     IF (BFORCEL NOT = ZEROS)
 11163        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11164        AND (BFORCEI = 'O')
 11165        AND (PB-FORCE-CODE NOT = 'O')
 11166        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11167           PB-I-AH-PREM-CALC
 11168        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11169        MOVE SPACE               TO DC-OPTION-CODE
 11170        PERFORM 9700-DATE-LINK
 11171        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11172        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11173        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11174        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11175        PERFORM 1500-UPDATE-ERNOTE
 11176                                 THRU 1500-EXIT
 11177        PERFORM 1600-UPDATE-ERPYAJ
 11178                                 THRU 1600-EXIT
 11179     END-IF
 11180     IF BLSTNML  GREATER THAN ZEROS
 11181         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11182
 11183     IF B1STNML  GREATER THAN ZEROS
 11184         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11185
 11186     IF BINITL   GREATER THAN ZEROS
 11187         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11188
 11189     IF BBIRTHL  GREATER THAN ZERO
 11190         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11191
 11192
 11193     IF BAGEL    GREATER THAN ZEROS
 11194         MOVE BAGEI              TO PB-I-AGE.
 11195
 11196     MOVE 'N'                    TO WS-INS-AGE-SET
 11197                                    WS-JNT-AGE-SET.
 11198     IF BAGEL    GREATER THAN ZEROS
 11199        MOVE 'Y'                TO WS-INS-AGE-SET
 11200        IF BAGEI = ZERO AND
 11201             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11202           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11203           MOVE 'AGE*'          TO BAGEDEFO
 11204        ELSE
 11205           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11206           MOVE 'AGE '          TO BAGEDEFO
 11207        END-IF
 11208        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11209     END-IF.
 11210     if (byearl      <> zeros)
 11211        or (bmakel   <> zeros)
 11212        or (bmodell  <> zeros)
 11213        or (bometerl <> zeros)
 11214        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11215                                 TO ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 206
* VP6311.cbl
 11216        MOVE 'C'                 TO ELCRTT-REC-TYPE
 11217        perform 1390-read-elcrtt-update
 11218                                 thru 1390-exit
 11219        if resp-normal
 11220           perform 1391-rewrite-elcrtt
 11221                                 thru 1391-exit
 11222        else
 11223           if resp-notfnd
 11224              perform 1392-write-elcrtt
 11225                                 thru 1392-exit
 11226           end-if
 11227        end-if
 11228     end-if
 11229     IF BSEXL    GREATER THAN ZEROS
 11230         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11231
 11232     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11233        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11234
 11235     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11236        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11237
 11238
 11239
 11240     IF BSKPCDL  GREATER THAN ZEROS
 11241         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11242
 11243
 11244
 11245
 11246     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11247         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11248
 11249     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11250         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11251
 11252     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11253
 11254     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11255         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11256            SUBTRACT PB-I-LF-PREMIUM-AMT
 11257                     FROM WS-B-LF-ISS-PRM-ENTERED
 11258            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11259            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11260            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11261         ELSE
 11262            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11263*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11264*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11265         END-IF
 11266     END-IF.
 11267
 11268     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11269            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11270                     FROM WS-B-LF-ISS-PRM-ENTERED
 11271         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11272         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11273
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 207
* VP6311.cbl
 11274     IF  BALT-PREM-LEN     (2)  > ZEROS
 11275         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11276
 11277     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11278         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11279
 11280     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11281         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11282            SUBTRACT PB-I-AH-PREMIUM-AMT
 11283                     FROM WS-B-AH-ISS-PRM-ENTERED
 11284            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11285            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11286            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11287         ELSE
 11288            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11289*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11290*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11291         END-IF
 11292     END-IF
 11293
 11294     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11295        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11296
 11297     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11298        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11299
 11300     IF BINDGRPL            GREATER THAN ZEROS
 11301         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11302
 11303     IF BRTCLSL             GREATER THAN ZEROS
 11304         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11305
 11306     IF BSIGL               GREATER THAN ZEROS
 11307         MOVE BSIGI              TO PB-I-SIG-SW.
 11308
 11309
 11310     IF BMEMBERL            GREATER THAN ZEROS
 11311         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11312
 11313     IF BLNOFCRL            GREATER THAN ZEROS
 11314         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11315
 11316     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11317        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11318
 11319     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11320        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11321
 11322
 11323     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11324        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11325           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11326
 11327     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11328        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11329           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11330
 11331
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 208
* VP6311.cbl
 11332     IF PB-EXT-DAYS-PROCESSING
 11333        IF PB-I-EXTENTION-DAYS = ZEROS
 11334           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11335
 11336     IF PB-EXPIRE-DT-PROCESSING
 11337        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11338           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11339             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11340
 11341     IF PB-1ST-PMT-DT-PROCESSING
 11342        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11343           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11344
 11345     IF BREINL GREATER THAN ZEROS
 11346        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11347
 11348     IF BFORCEL NOT = ZEROS
 11349        MOVE BFORCEI             TO PB-FORCE-CODE.
 11350     IF (BENTRYL NOT = ZEROS)
 11351        AND (PB-COMPANY-ID = 'CID')
 11352        AND (PB-STATE = 'VA')
 11353        AND (BENTRYI NOT = 'P')
 11354        AND (PB-BATCH-ENTRY = 'P')
 11355        PERFORM 1800-REMOVE-CERT-NOTES
 11356                                 THRU 1800-EXIT
 11357     END-IF
 11358     IF BENTRYL NOT = ZEROS
 11359        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11360        IF PI-COMPANY-ID = 'CID'
 11361           AND (PB-BATCH-ENTRY = 'P')
 11362           AND (PB-STATE = 'VA')
 11363           PERFORM 1500-UPDATE-ERNOTE
 11364                                 THRU 1500-EXIT
 11365        END-IF
 11366     END-IF
 11367
 11368     IF BUNWRITL NOT = ZEROS
 11369        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11370
 11371     IF BBILCDL NOT = ZEROS
 11372        MOVE BBILCDI             TO PB-RECORD-BILL.
 11373
 11374
 11375
 11376
 11377
 11378*****************************************************************
 11379*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11380*****************************************************************
 11381
 11382     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11383        IF BTYPE  (1)   = ZEROS OR SPACES
 11384           IF REMOVE-LF-COVERAGE
 11385               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11386                                        PI-BTYPE (1)
 11387               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11388                                        WS-B-LF-ISS-PRM-ENTERED
 11389               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 209
* VP6311.cbl
 11390                                        WS-B-LF-ISS-PRM-ENTERED
 11391               SUBTRACT PB-I-LF-PREM-CALC FROM
 11392                                        WS-B-LF-ISS-PRM-COMPUTED
 11393               MOVE ZEROS            TO PB-I-LF-TERM
 11394                                        PB-I-LF-BENEFIT-AMT
 11395                                        PB-I-LF-PREMIUM-AMT
 11396                                        PB-I-LF-BENEFIT-CD
 11397                                        PB-I-LF-PREM-CALC
 11398                                        PB-I-LF-CRIT-PER
 11399                                        PB-I-LF-ALT-BENEFIT-AMT
 11400                                        PB-I-LF-ALT-PREMIUM-AMT
 11401               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11402           ELSE
 11403               NEXT SENTENCE
 11404        ELSE
 11405           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11406                                    PI-BTYPE (1).
 11407     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11408        IF BTYPE  (2)   = ZEROS OR SPACES
 11409           IF  REMOVE-AH-COVERAGE
 11410               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11411                                        PI-BTYPE (2)
 11412               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11413                                        WS-B-AH-ISS-PRM-ENTERED
 11414               SUBTRACT PB-I-AH-PREM-CALC FROM
 11415                                        WS-B-AH-ISS-PRM-COMPUTED
 11416               MOVE ZEROS            TO PB-I-AH-TERM
 11417                                        PB-I-AH-BENEFIT-AMT
 11418                                        PB-I-AH-PREMIUM-AMT
 11419                                        PB-I-AH-BENEFIT-CD
 11420                                        PB-I-AH-PREM-CALC
 11421                                        PB-I-AH-CRIT-PER
 11422               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11423           ELSE
 11424               NEXT SENTENCE
 11425        ELSE
 11426           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11427                                    PI-BTYPE (2).
 11428 1360-REWRITE-PB-RECORD.
 11429     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11430
 11431     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11432     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11433
 11434     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11435
 11436     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11437     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11438
 11439     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11440         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11441
 11442     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11443         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11444
 11445     PERFORM 1398-UPDATE-ERPNDM THRU 1398-EXIT.
 11446
 11447     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 210
* VP6311.cbl
 11448
 11449     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11450
 11451     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11452     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11453     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11454
 11455     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11456     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11457
 11458 1375-REWRITE-PB-RECORD.
 11459     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11460     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11461     MOVE 'C'                    TO JP-RECORD-TYPE.
 11462     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11463
 11464
 11465* EXEC CICS REWRITE
 11466*        DATASET (FILE-ID-ERPNDB)
 11467*        FROM    (PENDING-BUSINESS)
 11468*    END-EXEC.
 11469     MOVE LENGTH OF
 11470      PENDING-BUSINESS
 11471       TO DFHEIV11
 11472*    MOVE '&& L                  %   #00011083' TO DFHEIV0
 11473     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11474     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11475     MOVE X'2020233030303131303833' TO DFHEIV0(25:11)
 11476     CALL 'kxdfhei1' USING DFHEIV0,
 11477           FILE-ID-ERPNDB,
 11478           PENDING-BUSINESS,
 11479           DFHEIV11,
 11480           DFHEIV99
 11481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11482
 11483
 11484     PERFORM 8400-LOG-JOURNAL-RECORD.
 11485******************************************************************
 11486*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11487******************************************************************
 11488     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11489     MOVE ' '                    TO WS-ERMAIL-SW
 11490
 11491* EXEC CICS READ
 11492*       DATASET   (FILE-ID-ERMAIL)
 11493*       SET       (ADDRESS OF MAILING-DATA)
 11494*       RIDFLD    (ERMAIL-KEY)
 11495*       RESP      (WS-RESPONSE)
 11496*    END-EXEC
 11497*    MOVE '&"S        E          (  N#00011094' TO DFHEIV0
 11498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11500     MOVE X'204E233030303131303934' TO DFHEIV0(25:11)
 11501     CALL 'kxdfhei1' USING DFHEIV0,
 11502           FILE-ID-ERMAIL,
 11503           DFHEIV20,
 11504           DFHEIV99,
 11505           ERMAIL-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 211
* VP6311.cbl
 11506           DFHEIV99,
 11507           DFHEIV99,
 11508           DFHEIV99
 11509     SET ADDRESS OF MAILING-DATA TO
 11510         DFHEIV20
 11511     MOVE EIBRESP  TO WS-RESPONSE
 11512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11513     IF RESP-NORMAL
 11514        SET ERMAIL-FOUND TO TRUE
 11515     END-IF
 11516
 11517     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11518     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11519                                 TO ELCRTO-KEY
 11520     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11521     MOVE +0                     TO ELCRTO-SEQ-NO
 11522
 11523* EXEC CICS READ
 11524*       DATASET   ('ELCRTO')
 11525*       INTO      (ORIGINAL-CERTIFICATE)
 11526*       RIDFLD    (ELCRTO-KEY)
 11527*       GTEQ
 11528*       RESP      (WS-RESPONSE)
 11529*    END-EXEC
 11530     MOVE LENGTH OF
 11531      ORIGINAL-CERTIFICATE
 11532       TO DFHEIV11
 11533     MOVE 'ELCRTO' TO DFHEIV1
 11534*    MOVE '&"IL       G          (  N#00011109' TO DFHEIV0
 11535     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11537     MOVE X'204E233030303131313039' TO DFHEIV0(25:11)
 11538     CALL 'kxdfhei1' USING DFHEIV0,
 11539           DFHEIV1,
 11540           ORIGINAL-CERTIFICATE,
 11541           DFHEIV11,
 11542           ELCRTO-KEY,
 11543           DFHEIV99,
 11544           DFHEIV99,
 11545           DFHEIV99
 11546     MOVE EIBRESP  TO WS-RESPONSE
 11547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11548*    display ' just read gteq ' ws-response
 11549     IF RESP-NORMAL
 11550        AND (OC-CONTROL-PRIMARY (1:33) =
 11551                 PB-CONTROL-BY-ACCOUNT (1:33))
 11552        AND (OC-RECORD-TYPE = 'I')
 11553*       display ' resp norm, key =, type i '
 11554        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11555*          display ' end proc blank '
 11556           display ' csr edit session ' PI-CSR-SESSION-SW
 11557           IF NOT CSR-EDIT-SESSION
 11558
 11559* EXEC CICS READ
 11560*                DATASET   ('ELCRTO')
 11561*                INTO      (ORIGINAL-CERTIFICATE)
 11562*                RIDFLD    (OC-CONTROL-PRIMARY)
 11563*                UPDATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 212
* VP6311.cbl
 11564*                RESP      (WS-RESPONSE)
 11565*             END-EXEC
 11566     MOVE LENGTH OF
 11567      ORIGINAL-CERTIFICATE
 11568       TO DFHEIV11
 11569     MOVE 'ELCRTO' TO DFHEIV1
 11570*    MOVE '&"IL       EU         (  N#00011126' TO DFHEIV0
 11571     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11572     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11573     MOVE X'204E233030303131313236' TO DFHEIV0(25:11)
 11574     CALL 'kxdfhei1' USING DFHEIV0,
 11575           DFHEIV1,
 11576           ORIGINAL-CERTIFICATE,
 11577           DFHEIV11,
 11578           OC-CONTROL-PRIMARY,
 11579           DFHEIV99,
 11580           DFHEIV99,
 11581           DFHEIV99
 11582     MOVE EIBRESP  TO WS-RESPONSE
 11583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11584              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11585              IF RESP-NORMAL
 11586                 display ' good read upd '
 11587                 MOVE PB-I-INSURED-LAST-NAME TO
 11588                         OC-INS-LAST-NAME
 11589                 MOVE PB-I-INSURED-FIRST-NAME TO
 11590                         OC-INS-FIRST-NAME
 11591                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11592                         OC-INS-MIDDLE-INIT
 11593                 MOVE PB-I-AGE         TO OC-INS-AGE
 11594                 MOVE PB-I-JOINT-LAST-NAME   TO
 11595                         OC-JNT-LAST-NAME
 11596                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11597                         OC-JNT-FIRST-NAME
 11598                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11599                         OC-JNT-MIDDLE-INIT
 11600                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11601                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11602                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11603                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11604                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11605                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11606                         OC-LF-ALT-BEN-AMT
 11607                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11608                         OC-LF-ALT-PRM-AMT
 11609                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11610                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11611                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11612                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11613                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11614                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11615                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11616                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11617                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11618                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11619                 IF OC-CANCEL-TRAN-IND = 'N'
 11620                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11621                    MOVE +0            TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 213
* VP6311.cbl
 11622                                          OC-LF-ITD-CANCEL-AMT
 11623                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11624                    MOVE +0            TO OC-AH-CANCEL-AMT
 11625                                          OC-AH-ITD-CANCEL-AMT
 11626                 END-IF
 11627                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11628                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11629                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11630                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11631                 IF ERMAIL-FOUND
 11632                    MOVE MA-CRED-BENE-NAME
 11633                                 TO OC-CRED-BENE-NAME
 11634                 END-IF
 11635                 IF NOT CERT-TRL-REC-NOT-FOUND
 11636                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11637                           OC-INS-AGE-DEFAULT-FLAG
 11638                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11639                           OC-JNT-AGE-DEFAULT-FLAG
 11640                 END-IF
 11641
 11642* EXEC CICS REWRITE
 11643*                   DATASET   ('ELCRTO')
 11644*                   FROM      (ORIGINAL-CERTIFICATE)
 11645*                   RESP      (WS-RESPONSE)
 11646*                END-EXEC
 11647     MOVE LENGTH OF
 11648      ORIGINAL-CERTIFICATE
 11649       TO DFHEIV11
 11650     MOVE 'ELCRTO' TO DFHEIV1
 11651*    MOVE '&& L                  %  N#00011190' TO DFHEIV0
 11652     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11653     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11654     MOVE X'204E233030303131313930' TO DFHEIV0(25:11)
 11655     CALL 'kxdfhei1' USING DFHEIV0,
 11656           DFHEIV1,
 11657           ORIGINAL-CERTIFICATE,
 11658           DFHEIV11,
 11659           DFHEIV99
 11660     MOVE EIBRESP  TO WS-RESPONSE
 11661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11662                 display ' just rewrote ' ws-response
 11663              END-IF
 11664           END-IF
 11665        ELSE
 11666           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11667           MOVE 'OC'             TO OC-RECORD-ID
 11668           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11669           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11670           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11671           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11672           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11673           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11674           MOVE PB-I-AGE         TO OC-INS-AGE
 11675           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11676           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11677           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11678           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11679           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 214
* VP6311.cbl
 11680           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11681           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11682           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11683           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11684           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11685           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11686           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11687           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11688           MOVE +0               TO OC-LF-CANCEL-AMT
 11689                                    OC-LF-ITD-CANCEL-AMT
 11690           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11691           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11692           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11693           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11694           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11695           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11696           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11697           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11698           MOVE +0               TO OC-AH-CANCEL-AMT
 11699                                    OC-AH-ITD-CANCEL-AMT
 11700           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11701           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11702           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11703           IF ERMAIL-FOUND
 11704              MOVE MA-CRED-BENE-NAME
 11705                                 TO OC-CRED-BENE-NAME
 11706           END-IF
 11707           IF NOT CERT-TRL-REC-NOT-FOUND
 11708              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11709                           OC-INS-AGE-DEFAULT-FLAG
 11710              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11711                           OC-JNT-AGE-DEFAULT-FLAG
 11712           END-IF
 11713           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11714
 11715* EXEC CICS WRITE
 11716*             DATASET   ('ELCRTO')
 11717*             FROM      (ORIGINAL-CERTIFICATE)
 11718*             RIDFLD    (OC-CONTROL-PRIMARY)
 11719*             RESP      (WS-RESPONSE)
 11720*          END-EXEC
 11721     MOVE LENGTH OF
 11722      ORIGINAL-CERTIFICATE
 11723       TO DFHEIV11
 11724     MOVE 'ELCRTO' TO DFHEIV1
 11725*    MOVE '&$ L                  ''  N#00011247' TO DFHEIV0
 11726     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11727     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11728     MOVE X'204E233030303131323437' TO DFHEIV0(25:11)
 11729     CALL 'kxdfhei1' USING DFHEIV0,
 11730           DFHEIV1,
 11731           ORIGINAL-CERTIFICATE,
 11732           DFHEIV11,
 11733           OC-CONTROL-PRIMARY,
 11734           DFHEIV99,
 11735           DFHEIV99
 11736     MOVE EIBRESP  TO WS-RESPONSE
 11737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 215
* VP6311.cbl
 11738        END-IF
 11739     ELSE
 11740        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11741        MOVE 'OC'                TO OC-RECORD-ID
 11742        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11743                                 TO OC-CONTROL-PRIMARY (1:33)
 11744        MOVE 'I'                 TO OC-RECORD-TYPE
 11745        MOVE +4096               TO OC-KEY-SEQ-NO
 11746        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11747        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11748        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11749        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11750        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11751        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11752        MOVE PB-I-AGE            TO OC-INS-AGE
 11753        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11754        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11755        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11756        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11757        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11758        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11759        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11760        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11761        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11762        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11763        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11764        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11765        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11766        MOVE +0                  TO OC-LF-CANCEL-AMT
 11767                                    OC-LF-ITD-CANCEL-AMT
 11768        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11769        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11770        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11771        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11772        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11773        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11774        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11775        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11776        MOVE +0                  TO OC-AH-CANCEL-AMT
 11777                                    OC-AH-ITD-CANCEL-AMT
 11778        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11779        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11780        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11781        IF ERMAIL-FOUND
 11782           MOVE MA-CRED-BENE-NAME
 11783                                 TO OC-CRED-BENE-NAME
 11784        END-IF
 11785        IF NOT CERT-TRL-REC-NOT-FOUND
 11786           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11787                           OC-INS-AGE-DEFAULT-FLAG
 11788           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11789                           OC-JNT-AGE-DEFAULT-FLAG
 11790        END-IF
 11791        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11792
 11793* EXEC CICS WRITE
 11794*          DATASET   ('ELCRTO')
 11795*          FROM      (ORIGINAL-CERTIFICATE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 216
* VP6311.cbl
 11796*          RIDFLD    (OC-CONTROL-PRIMARY)
 11797*          RESP      (WS-RESPONSE)
 11798*       END-EXEC
 11799     MOVE LENGTH OF
 11800      ORIGINAL-CERTIFICATE
 11801       TO DFHEIV11
 11802     MOVE 'ELCRTO' TO DFHEIV1
 11803*    MOVE '&$ L                  ''  N#00011307' TO DFHEIV0
 11804     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11805     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11806     MOVE X'204E233030303131333037' TO DFHEIV0(25:11)
 11807     CALL 'kxdfhei1' USING DFHEIV0,
 11808           DFHEIV1,
 11809           ORIGINAL-CERTIFICATE,
 11810           DFHEIV11,
 11811           OC-CONTROL-PRIMARY,
 11812           DFHEIV99,
 11813           DFHEIV99
 11814     MOVE EIBRESP  TO WS-RESPONSE
 11815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11816     END-IF
 11817******************************************************************
 11818*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11819******************************************************************
 11820
 11821     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11822     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11823
 11824
 11825* EXEC CICS READ
 11826*        INTO    (PENDING-BUSINESS)
 11827*        DATASET (FILE-ID-ERPNDB)
 11828*        RIDFLD  (ERPNDB-KEY)
 11829*        UPDATE
 11830*    END-EXEC.
 11831     MOVE LENGTH OF
 11832      PENDING-BUSINESS
 11833       TO DFHEIV11
 11834*    MOVE '&"IL       EU         (   #00011321' TO DFHEIV0
 11835     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11836     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11837     MOVE X'2020233030303131333231' TO DFHEIV0(25:11)
 11838     CALL 'kxdfhei1' USING DFHEIV0,
 11839           FILE-ID-ERPNDB,
 11840           PENDING-BUSINESS,
 11841           DFHEIV11,
 11842           ERPNDB-KEY,
 11843           DFHEIV99,
 11844           DFHEIV99,
 11845           DFHEIV99
 11846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11847
 11848
 11849     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11850     MOVE 'B'                    TO JP-RECORD-TYPE.
 11851     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11852
 11853     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 217
* VP6311.cbl
 11854
 11855     PERFORM 8400-LOG-JOURNAL-RECORD.
 11856
 11857     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11858
 11859     MOVE 'C'                    TO JP-RECORD-TYPE.
 11860     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11861
 11862
 11863* EXEC CICS REWRITE
 11864*        DATASET    (FILE-ID-ERPNDB)
 11865*        FROM       (PENDING-BUSINESS)
 11866*    END-EXEC.
 11867     MOVE LENGTH OF
 11868      PENDING-BUSINESS
 11869       TO DFHEIV11
 11870*    MOVE '&& L                  %   #00011341' TO DFHEIV0
 11871     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11872     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11873     MOVE X'2020233030303131333431' TO DFHEIV0(25:11)
 11874     CALL 'kxdfhei1' USING DFHEIV0,
 11875           FILE-ID-ERPNDB,
 11876           PENDING-BUSINESS,
 11877           DFHEIV11,
 11878           DFHEIV99
 11879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11880
 11881
 11882     PERFORM 8400-LOG-JOURNAL-RECORD.
 11883
 11884     IF WS-ERRORS-PRESENT
 11885        GO TO 3900-RE-DISPLAY-RECORD.
 11886
 11887     MOVE ZEROS                  TO EMI-ERROR.
 11888     MOVE -1                     TO BMAINTL.
 11889     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11890     GO TO 3900-RE-DISPLAY-RECORD.
 11891
 11892 1380-BATCH-HDR-NOT-FOUND.
 11893     MOVE -1                     TO BMAINTL.
 11894     MOVE ER-7450                TO EMI-ERROR.
 11895     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11896     GO TO 8200-SEND-DATAONLY.
 11897
 11898 1385-REC-NOT-FOUND.
 11899     MOVE -1                     TO BMAINTL.
 11900     MOVE ER-7451                TO EMI-ERROR.
 11901     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11902     GO TO 8200-SEND-DATAONLY.
 11903
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 218
* VP6311.cbl
 11905
 11906
 11907 1386-UPDATE-AGE-FLAGS.
 11908
 11909
 11910* EXEC CICS GETMAIN
 11911*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11912*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11913*        INITIMG (GETMAIN-SPACE)
 11914*    END-EXEC
 11915*    MOVE ',"IL                  $   #00011373' TO DFHEIV0
 11916     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11917     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11918     MOVE X'2020233030303131333733' TO DFHEIV0(25:11)
 11919     CALL 'kxdfhei1' USING DFHEIV0,
 11920           DFHEIV20,
 11921           ELCRTT-RECORD-LENGTH,
 11922           GETMAIN-SPACE
 11923     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11924         DFHEIV20
 11925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11926
 11927
 11928* EXEC CICS HANDLE CONDITION
 11929*        NOTFND   (1386-NOTFND)
 11930*    END-EXEC.
 11931*    MOVE '"$I                   ! ( #00011379' TO DFHEIV0
 11932     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11933     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11934     MOVE X'2820233030303131333739' TO DFHEIV0(25:11)
 11935     CALL 'kxdfhei1' USING DFHEIV0
 11936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11937
 11938
 11939     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11940     MOVE 'C'                TO ELCRTT-REC-TYPE
 11941
 11942
 11943* EXEC CICS READ
 11944*        UPDATE
 11945*        DATASET  (CRTT-ID)
 11946*        RIDFLD   (ELCRTT-KEY)
 11947*        INTO     (CERTIFICATE-TRAILERS)
 11948*    END-EXEC.
 11949     MOVE LENGTH OF
 11950      CERTIFICATE-TRAILERS
 11951       TO DFHEIV11
 11952*    MOVE '&"IL       EU         (   #00011386' TO DFHEIV0
 11953     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11954     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11955     MOVE X'2020233030303131333836' TO DFHEIV0(25:11)
 11956     CALL 'kxdfhei1' USING DFHEIV0,
 11957           CRTT-ID,
 11958           CERTIFICATE-TRAILERS,
 11959           DFHEIV11,
 11960           ELCRTT-KEY,
 11961           DFHEIV99,
 11962           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 219
* VP6311.cbl
 11963           DFHEIV99
 11964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11965
 11966
 11967     IF WS-INS-AGE-SET = 'Y'
 11968        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11969     END-IF
 11970     IF WS-JNT-AGE-SET = 'Y'
 11971        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11972     END-IF
 11973
 11974
 11975* EXEC CICS REWRITE
 11976*       DATASET  (CRTT-ID)
 11977*       FROM     (CERTIFICATE-TRAILERS)
 11978*    END-EXEC.
 11979     MOVE LENGTH OF
 11980      CERTIFICATE-TRAILERS
 11981       TO DFHEIV11
 11982*    MOVE '&& L                  %   #00011400' TO DFHEIV0
 11983     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11984     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11985     MOVE X'2020233030303131343030' TO DFHEIV0(25:11)
 11986     CALL 'kxdfhei1' USING DFHEIV0,
 11987           CRTT-ID,
 11988           CERTIFICATE-TRAILERS,
 11989           DFHEIV11,
 11990           DFHEIV99
 11991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11992
 11993
 11994     GO TO 1386-EXIT.
 11995
 11996 1386-NOTFND.
 11997
 11998     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 11999     MOVE 'CS'         TO CS-RECORD-ID.
 12000     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12001     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12002     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12003     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12004     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12005
 12006* EXEC CICS WRITE
 12007*       DATASET  (CRTT-ID)
 12008*       RIDFLD   (ELCRTT-KEY)
 12009*       FROM     (CERTIFICATE-TRAILERS)
 12010*    END-EXEC.
 12011     MOVE LENGTH OF
 12012      CERTIFICATE-TRAILERS
 12013       TO DFHEIV11
 12014*    MOVE '&$ L                  ''   #00011416' TO DFHEIV0
 12015     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12016     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12017     MOVE X'2020233030303131343136' TO DFHEIV0(25:11)
 12018     CALL 'kxdfhei1' USING DFHEIV0,
 12019           CRTT-ID,
 12020           CERTIFICATE-TRAILERS,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 220
* VP6311.cbl
 12021           DFHEIV11,
 12022           ELCRTT-KEY,
 12023           DFHEIV99,
 12024           DFHEIV99
 12025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12026
 12027
 12028 1386-EXIT.
 12029     EXIT.
 12030 1390-read-elcrtt-update.
 12031
 12032* EXEC CICS GETMAIN
 12033*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12034*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12035*        INITIMG (GETMAIN-SPACE)
 12036*    END-EXEC
 12037*    MOVE ',"IL                  $   #00011425' TO DFHEIV0
 12038     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12039     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12040     MOVE X'2020233030303131343235' TO DFHEIV0(25:11)
 12041     CALL 'kxdfhei1' USING DFHEIV0,
 12042           DFHEIV20,
 12043           ELCRTT-RECORD-LENGTH,
 12044           GETMAIN-SPACE
 12045     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12046         DFHEIV20
 12047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12048
 12049* EXEC CICS READ
 12050*        UPDATE
 12051*        DATASET  (CRTT-ID)
 12052*        RIDFLD   (ELCRTT-KEY)
 12053*        INTO     (CERTIFICATE-TRAILERS)
 12054*        resp     (ws-response)
 12055*    END-EXEC
 12056     MOVE LENGTH OF
 12057      CERTIFICATE-TRAILERS
 12058       TO DFHEIV11
 12059*    MOVE '&"IL       EU         (  N#00011430' TO DFHEIV0
 12060     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12061     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12062     MOVE X'204E233030303131343330' TO DFHEIV0(25:11)
 12063     CALL 'kxdfhei1' USING DFHEIV0,
 12064           CRTT-ID,
 12065           CERTIFICATE-TRAILERS,
 12066           DFHEIV11,
 12067           ELCRTT-KEY,
 12068           DFHEIV99,
 12069           DFHEIV99,
 12070           DFHEIV99
 12071     MOVE EIBRESP  TO ws-response
 12072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12073     .
 12074 1390-exit.
 12075     exit.
 12076 1391-rewrite-elcrtt.
 12077     perform 1393-update-elcrtt  thru 1393-exit
 12078
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 221
* VP6311.cbl
 12079* EXEC CICS REWRITE
 12080*       DATASET  (CRTT-ID)
 12081*       FROM     (CERTIFICATE-TRAILERS)
 12082*       resp     (ws-response)
 12083*    END-EXEC
 12084     MOVE LENGTH OF
 12085      CERTIFICATE-TRAILERS
 12086       TO DFHEIV11
 12087*    MOVE '&& L                  %  N#00011442' TO DFHEIV0
 12088     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12089     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12090     MOVE X'204E233030303131343432' TO DFHEIV0(25:11)
 12091     CALL 'kxdfhei1' USING DFHEIV0,
 12092           CRTT-ID,
 12093           CERTIFICATE-TRAILERS,
 12094           DFHEIV11,
 12095           DFHEIV99
 12096     MOVE EIBRESP  TO ws-response
 12097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12098     .
 12099 1391-exit.
 12100     exit.
 12101 1392-write-elcrtt.
 12102     move 'CS'                   to certificate-trailers
 12103     move elcrtt-key             to cs-control-primary
 12104     move 'C'                    to cs-trailer-type
 12105     perform 1393-update-elcrtt  thru 1393-exit
 12106
 12107* EXEC CICS WRITE
 12108*       DATASET  (CRTT-ID)
 12109*       ridfld   (elcrtt-key)
 12110*       FROM     (CERTIFICATE-TRAILERS)
 12111*       resp     (ws-response)
 12112*    END-EXEC
 12113     MOVE LENGTH OF
 12114      CERTIFICATE-TRAILERS
 12115       TO DFHEIV11
 12116*    MOVE '&$ L                  ''  N#00011455' TO DFHEIV0
 12117     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12118     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12119     MOVE X'204E233030303131343535' TO DFHEIV0(25:11)
 12120     CALL 'kxdfhei1' USING DFHEIV0,
 12121           CRTT-ID,
 12122           CERTIFICATE-TRAILERS,
 12123           DFHEIV11,
 12124           elcrtt-key,
 12125           DFHEIV99,
 12126           DFHEIV99
 12127     MOVE EIBRESP  TO ws-response
 12128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12129     .
 12130 1392-exit.
 12131     exit.
 12132 1393-update-elcrtt.
 12133     if byearl <> zeros
 12134        move byeari              to cs-year
 12135     end-if
 12136     if bmakel <> zeros
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 222
* VP6311.cbl
 12137        move bmakei              to cs-make
 12138     end-if
 12139     if bmodell <> zeros
 12140        move bmodeli             to cs-model
 12141     end-if
 12142     if bometerl <> zeros
 12143        MOVE Bometeri            TO DEEDIT-FIELD
 12144        PERFORM 8600-DEEDIT
 12145        IF DEEDIT-FIELD-V0 NUMERIC
 12146           MOVE DEEDIT-FIELD-V0  TO cs-vehicle-odometer
 12147        end-if
 12148     end-if
 12149     .
 12150 1393-exit.
 12151     exit.
 12152 1398-UPDATE-ERPNDM.
 12153
 12154
 12155* EXEC CICS HANDLE CONDITION
 12156*        NOTFND (1398-EXIT)
 12157*    END-EXEC.
 12158*    MOVE '"$I                   ! ) #00011486' TO DFHEIV0
 12159     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12160     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12161     MOVE X'2920233030303131343836' TO DFHEIV0(25:11)
 12162     CALL 'kxdfhei1' USING DFHEIV0
 12163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12164
 12165
 12166     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12167
 12168
 12169* EXEC CICS READ
 12170*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12171*        DATASET (FILE-ID-ERPNDM)
 12172*        RIDFLD  (ERPNDM-KEY)
 12173*        UPDATE
 12174*    END-EXEC.
 12175*    MOVE '&"S        EU         (   #00011492' TO DFHEIV0
 12176     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12177     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12178     MOVE X'2020233030303131343932' TO DFHEIV0(25:11)
 12179     CALL 'kxdfhei1' USING DFHEIV0,
 12180           FILE-ID-ERPNDM,
 12181           DFHEIV20,
 12182           DFHEIV99,
 12183           ERPNDM-KEY,
 12184           DFHEIV99,
 12185           DFHEIV99,
 12186           DFHEIV99
 12187     SET ADDRESS OF PENDING-MAILING-DATA TO
 12188         DFHEIV20
 12189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12190
 12191
 12192     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12193     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12194     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 223
* VP6311.cbl
 12195
 12196     IF BLSTNML GREATER THAN ZEROS
 12197         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12198
 12199     IF B1STNML GREATER  THAN ZEROS
 12200         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
 12201
 12202     IF BINITL GREATER THAN ZEROS
 12203         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12204
 12205     IF BAGEL GREATER THAN ZEROS
 12206         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12207
 12208     IF BBIRTHL GREATER THAN ZEROS
 12209         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12210
 12211     IF BSEXL GREATER THAN ZEROS
 12212         MOVE  BSEXI             TO PM-INSURED-SEX.
 12213
 12214
 12215* EXEC CICS REWRITE
 12216*        DATASET (FILE-ID-ERPNDM)
 12217*        FROM    (PENDING-MAILING-DATA)
 12218*    END-EXEC.
 12219     MOVE LENGTH OF
 12220      PENDING-MAILING-DATA
 12221       TO DFHEIV11
 12222*    MOVE '&& L                  %   #00011521' TO DFHEIV0
 12223     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12224     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12225     MOVE X'2020233030303131353231' TO DFHEIV0(25:11)
 12226     CALL 'kxdfhei1' USING DFHEIV0,
 12227           FILE-ID-ERPNDM,
 12228           PENDING-MAILING-DATA,
 12229           DFHEIV11,
 12230           DFHEIV99
 12231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12232
 12233
 12234 1398-EXIT.
 12235     EXIT.
 12236
 12237******************************************************************
 12238*                                                                *
 12239*          D E L E T E   I S S U E   R O U T I N E               *
 12240*                                                                *
 12241******************************************************************
 12242
 12243 1400-DELETE-ISSUE-ROUTINE.
 12244     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12245
 12246     IF BCHGL NOT = ZEROS
 12247        MOVE ER-2196             TO EMI-ERROR
 12248        MOVE AL-UABON            TO BMAINTA
 12249        MOVE -1                  TO BMAINTL
 12250        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12251        GO TO 8200-SEND-DATAONLY.
 12252
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 224
* VP6311.cbl
 12253
 12254* EXEC CICS HANDLE CONDITION
 12255*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12256*    END-EXEC.
 12257*    MOVE '"$I                   ! * #00011545' TO DFHEIV0
 12258     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12260     MOVE X'2A20233030303131353435' TO DFHEIV0(25:11)
 12261     CALL 'kxdfhei1' USING DFHEIV0
 12262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12263
 12264
 12265     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12266     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12267     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12268
 12269
 12270* EXEC CICS READ
 12271*        SET     (ADDRESS OF PENDING-BUSINESS)
 12272*        DATASET (FILE-ID-ERPNDB)
 12273*        RIDFLD  (ERPNDB-KEY)
 12274*    END-EXEC.
 12275*    MOVE '&"S        E          (   #00011553' TO DFHEIV0
 12276     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12278     MOVE X'2020233030303131353533' TO DFHEIV0(25:11)
 12279     CALL 'kxdfhei1' USING DFHEIV0,
 12280           FILE-ID-ERPNDB,
 12281           DFHEIV20,
 12282           DFHEIV99,
 12283           ERPNDB-KEY,
 12284           DFHEIV99,
 12285           DFHEIV99,
 12286           DFHEIV99
 12287     SET ADDRESS OF PENDING-BUSINESS TO
 12288         DFHEIV20
 12289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12290
 12291
 12292     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12293
 12294     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12295
 12296     IF BSUFIXL NOT = ZEROS
 12297        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12298     ELSE
 12299        MOVE SPACE               TO WS-NEW-SUFFIX.
 12300
 12301     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12302     PERFORM 8600-DEEDIT.
 12303     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12304     MOVE '4'                    TO DC-OPTION-CODE.
 12305     PERFORM 9700-DATE-LINK.
 12306     IF DATE-CONVERSION-ERROR
 12307        MOVE ER-0348             TO EMI-ERROR
 12308        MOVE -1                  TO BEFFDTL
 12309        MOVE AL-UABON            TO BEFFDTA
 12310        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 225
* VP6311.cbl
 12311        GO TO 8200-SEND-DATAONLY
 12312     ELSE
 12313        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12314        MOVE AL-UANON            TO BEFFDTA
 12315        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12316
 12317
 12318* EXEC CICS HANDLE CONDITION
 12319*         NOTFND    (1490-RECORD-NOT-FOUND)
 12320*    END-EXEC.
 12321*    MOVE '"$I                   ! + #00011584' TO DFHEIV0
 12322     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12323     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12324     MOVE X'2B20233030303131353834' TO DFHEIV0(25:11)
 12325     CALL 'kxdfhei1' USING DFHEIV0
 12326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12327
 12328
 12329
 12330* EXEC CICS READ
 12331*        SET     (ADDRESS OF PENDING-BUSINESS)
 12332*        DATASET (FILE-ID-ERPNDB)
 12333*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12334*        UPDATE
 12335*    END-EXEC.
 12336*    MOVE '&"S        EU         (   #00011588' TO DFHEIV0
 12337     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12338     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12339     MOVE X'2020233030303131353838' TO DFHEIV0(25:11)
 12340     CALL 'kxdfhei1' USING DFHEIV0,
 12341           FILE-ID-ERPNDB,
 12342           DFHEIV20,
 12343           DFHEIV99,
 12344           PI-PREV-CONTROL-PRIMARY,
 12345           DFHEIV99,
 12346           DFHEIV99,
 12347           DFHEIV99
 12348     SET ADDRESS OF PENDING-BUSINESS TO
 12349         DFHEIV20
 12350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12351
 12352
 12353     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12354        MOVE -1                 TO BMAINTL
 12355        MOVE ER-2197            TO EMI-ERROR
 12356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12357        GO TO 8200-SEND-DATAONLY.
 12358
 12359     IF PB-BILLED-DT NOT = LOW-VALUES
 12360        MOVE -1                 TO BMAINTL
 12361        MOVE ER-2129            TO EMI-ERROR
 12362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12363        GO TO 8200-SEND-DATAONLY.
 12364
 12365     IF PB-CHG-COUNT NOT = ZEROS
 12366        MOVE ER-2336            TO EMI-ERROR
 12367        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12368        MOVE AL-UABON            TO BMAINTA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 226
* VP6311.cbl
 12369        MOVE -1                  TO BMAINTL
 12370        GO TO 8200-SEND-DATAONLY.
 12371
 12372     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12373        PB-CHG-COUNT NOT = ZEROS
 12374        MOVE ER-2196             TO EMI-ERROR
 12375        MOVE AL-UABON            TO BMAINTA
 12376        MOVE -1                  TO BMAINTL
 12377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12378        GO TO 8200-SEND-DATAONLY.
 12379******************************************************************
 12380*                                                                *
 12381*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12382*                                                                *
 12383******************************************************************
 12384     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12385     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12386     MOVE +0                     TO ELCRTO-SEQ-NO
 12387
 12388* EXEC CICS READ
 12389*       DATASET   ('ELCRTO')
 12390*       INTO      (ORIGINAL-CERTIFICATE)
 12391*       RIDFLD    (ELCRTO-KEY)
 12392*       GTEQ
 12393*       RESP      (WS-RESPONSE)
 12394*    END-EXEC
 12395     MOVE LENGTH OF
 12396      ORIGINAL-CERTIFICATE
 12397       TO DFHEIV11
 12398     MOVE 'ELCRTO' TO DFHEIV1
 12399*    MOVE '&"IL       G          (  N#00011629' TO DFHEIV0
 12400     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12401     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12402     MOVE X'204E233030303131363239' TO DFHEIV0(25:11)
 12403     CALL 'kxdfhei1' USING DFHEIV0,
 12404           DFHEIV1,
 12405           ORIGINAL-CERTIFICATE,
 12406           DFHEIV11,
 12407           ELCRTO-KEY,
 12408           DFHEIV99,
 12409           DFHEIV99,
 12410           DFHEIV99
 12411     MOVE EIBRESP  TO WS-RESPONSE
 12412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12413     IF RESP-NORMAL
 12414        AND (OC-CONTROL-PRIMARY (1:33) =
 12415                 PB-CONTROL-BY-ACCOUNT (1:33))
 12416        AND (OC-RECORD-TYPE = 'I')
 12417
 12418* EXEC CICS READ
 12419*          DATASET   ('ELCRTO')
 12420*          INTO      (ORIGINAL-CERTIFICATE)
 12421*          RIDFLD    (ELCRTO-KEY)
 12422*          UPDATE
 12423*          RESP      (WS-RESPONSE)
 12424*       END-EXEC
 12425     MOVE LENGTH OF
 12426      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 227
* VP6311.cbl
 12427       TO DFHEIV11
 12428     MOVE 'ELCRTO' TO DFHEIV1
 12429*    MOVE '&"IL       EU         (  N#00011640' TO DFHEIV0
 12430     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12431     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12432     MOVE X'204E233030303131363430' TO DFHEIV0(25:11)
 12433     CALL 'kxdfhei1' USING DFHEIV0,
 12434           DFHEIV1,
 12435           ORIGINAL-CERTIFICATE,
 12436           DFHEIV11,
 12437           ELCRTO-KEY,
 12438           DFHEIV99,
 12439           DFHEIV99,
 12440           DFHEIV99
 12441     MOVE EIBRESP  TO WS-RESPONSE
 12442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12443        IF RESP-NORMAL
 12444
 12445* EXEC CICS DELETE
 12446*             DATASET   ('ELCRTO')
 12447*          END-EXEC
 12448     MOVE 'ELCRTO' TO DFHEIV1
 12449*    MOVE '&(                    &   #00011648' TO DFHEIV0
 12450     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12451     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12452     MOVE X'2020233030303131363438' TO DFHEIV0(25:11)
 12453     CALL 'kxdfhei1' USING DFHEIV0,
 12454           DFHEIV1,
 12455           DFHEIV99,
 12456           DFHEIV99,
 12457           DFHEIV99,
 12458           DFHEIV99
 12459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12460        END-IF
 12461     END-IF
 12462******************************************************************
 12463*                                                                *
 12464*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12465*                                                                *
 12466******************************************************************
 12467
 12468* EXEC CICS HANDLE CONDITION
 12469*        NOTFND    (1405-DELETE-CERTIFICATE)
 12470*    END-EXEC.
 12471*    MOVE '"$I                   ! , #00011658' TO DFHEIV0
 12472     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12474     MOVE X'2C20233030303131363538' TO DFHEIV0(25:11)
 12475     CALL 'kxdfhei1' USING DFHEIV0
 12476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12477
 12478
 12479
 12480* EXEC CICS READ
 12481*        EQUAL
 12482*        DATASET   (FILE-ID-ERPNDM)
 12483*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12484*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 228
* VP6311.cbl
 12485*        UPDATE
 12486*    END-EXEC.
 12487*    MOVE '&"S        EU         (   #00011662' TO DFHEIV0
 12488     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12489     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12490     MOVE X'2020233030303131363632' TO DFHEIV0(25:11)
 12491     CALL 'kxdfhei1' USING DFHEIV0,
 12492           FILE-ID-ERPNDM,
 12493           DFHEIV20,
 12494           DFHEIV99,
 12495           PI-PREV-CONTROL-PRIMARY,
 12496           DFHEIV99,
 12497           DFHEIV99,
 12498           DFHEIV99
 12499     SET ADDRESS OF PENDING-MAILING-DATA TO
 12500         DFHEIV20
 12501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12502
 12503
 12504     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12505     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12506     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12507
 12508     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12509
 12510
 12511* EXEC CICS DELETE
 12512*        DATASET   (FILE-ID-ERPNDM)
 12513*    END-EXEC.
 12514*    MOVE '&(                    &   #00011676' TO DFHEIV0
 12515     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12516     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12517     MOVE X'2020233030303131363736' TO DFHEIV0(25:11)
 12518     CALL 'kxdfhei1' USING DFHEIV0,
 12519           FILE-ID-ERPNDM,
 12520           DFHEIV99,
 12521           DFHEIV99,
 12522           DFHEIV99,
 12523           DFHEIV99
 12524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12525
 12526
 12527******************************************************************
 12528*                PROCESS   CERTIFICATE                           *
 12529******************************************************************
 12530
 12531 1405-DELETE-CERTIFICATE.
 12532
 12533* EXEC CICS HANDLE CONDITION
 12534*         NOTFND  (1420-CONTINUE-DELETE)
 12535*    END-EXEC.
 12536*    MOVE '"$I                   ! - #00011685' TO DFHEIV0
 12537     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12539     MOVE X'2D20233030303131363835' TO DFHEIV0(25:11)
 12540     CALL 'kxdfhei1' USING DFHEIV0
 12541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12542
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 229
* VP6311.cbl
 12543
 12544     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12545     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12546     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12547     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12548
 12549
 12550* EXEC CICS READ
 12551*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12552*        DATASET (FILE-ID-ELCERT)
 12553*        RIDFLD  (ELCERT-KEY)
 12554*        UPDATE
 12555*    END-EXEC.
 12556*    MOVE '&"S        EU         (   #00011694' TO DFHEIV0
 12557     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12558     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12559     MOVE X'2020233030303131363934' TO DFHEIV0(25:11)
 12560     CALL 'kxdfhei1' USING DFHEIV0,
 12561           FILE-ID-ELCERT,
 12562           DFHEIV20,
 12563           DFHEIV99,
 12564           ELCERT-KEY,
 12565           DFHEIV99,
 12566           DFHEIV99,
 12567           DFHEIV99
 12568     SET ADDRESS OF CERTIFICATE-MASTER TO
 12569         DFHEIV20
 12570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12571
 12572
 12573     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12574
 12575     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12576     MOVE 'B'                    TO JP-RECORD-TYPE
 12577     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12578
 12579     PERFORM 8400-LOG-JOURNAL-RECORD.
 12580
 12581     IF CERT-NOTES-ARE-NOT-PRESENT
 12582        MOVE ' '                 TO WS-CERT-NOTE-SW
 12583     ELSE
 12584        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12585
 12586     IF INSURED-ADDR-PRESENT
 12587        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12588
 12589******************************************************************
 12590******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12591******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12592******************************************************************
 12593******************************************************************
 12594
 12595     IF CERT-ADDED-BATCH AND
 12596        (NOT NO-CLAIM-ATTACHED
 12597         OR
 12598         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12599        GO TO 1410-REWRITE-CERT.
 12600
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 230
* VP6311.cbl
 12601******************************************************************
 12602******************************************************************
 12603
 12604     IF CERT-ADDED-BATCH  AND
 12605        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12606        GO TO 1410-REWRITE-CERT.
 12607
 12608     IF NO-CLAIM-ATTACHED
 12609        NEXT SENTENCE
 12610     ELSE
 12611        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12612        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12613        GO TO 1410-REWRITE-CERT.
 12614
 12615     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12616     MOVE 'D'                      TO JP-RECORD-TYPE.
 12617     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12618
 12619
 12620* EXEC CICS DELETE
 12621*         DATASET    (FILE-ID-ELCERT)
 12622*    END-EXEC.
 12623*    MOVE '&(                    &   #00011747' TO DFHEIV0
 12624     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12625     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12626     MOVE X'2020233030303131373437' TO DFHEIV0(25:11)
 12627     CALL 'kxdfhei1' USING DFHEIV0,
 12628           FILE-ID-ELCERT,
 12629           DFHEIV99,
 12630           DFHEIV99,
 12631           DFHEIV99,
 12632           DFHEIV99
 12633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12634
 12635
 12636     PERFORM 8400-LOG-JOURNAL-RECORD.
 12637
 12638******************************************************************
 12639*                                                                *
 12640*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12641*                                                                *
 12642******************************************************************
 12643
 12644     IF  CERT-NOTES-ARE-PRESENT
 12645         NEXT SENTENCE
 12646     ELSE
 12647         GO TO 1407-DELETE-MAILING.
 12648
 12649
 12650* EXEC CICS HANDLE CONDITION
 12651*         NOTFND  (1406-DELETE-ERNOTE)
 12652*    END-EXEC.
 12653*    MOVE '"$I                   ! . #00011764' TO DFHEIV0
 12654     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12655     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12656     MOVE X'2E20233030303131373634' TO DFHEIV0(25:11)
 12657     CALL 'kxdfhei1' USING DFHEIV0
 12658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 231
* VP6311.cbl
 12659
 12660
 12661     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12662     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12663     MOVE 0                     TO ERCNOT-SEQUENCE.
 12664
 12665 1406-DELETE-ERCNOT-LOOP.
 12666
 12667
 12668* EXEC CICS READ
 12669*        GTEQ
 12670*        DATASET   (FILE-ID-ERCNOT)
 12671*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12672*        RIDFLD    (ERCNOT-KEY)
 12673*    END-EXEC.
 12674*    MOVE '&"S        G          (   #00011774' TO DFHEIV0
 12675     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12677     MOVE X'2020233030303131373734' TO DFHEIV0(25:11)
 12678     CALL 'kxdfhei1' USING DFHEIV0,
 12679           FILE-ID-ERCNOT,
 12680           DFHEIV20,
 12681           DFHEIV99,
 12682           ERCNOT-KEY,
 12683           DFHEIV99,
 12684           DFHEIV99,
 12685           DFHEIV99
 12686     SET ADDRESS OF CERT-NOTE-FILE TO
 12687         DFHEIV20
 12688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12689
 12690
 12691     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12692     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12693         GO TO 1406-DELETE-ERNOTE
 12694     END-IF.
 12695
 12696     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12697     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12698     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12699
 12700     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12701
 12702
 12703* EXEC CICS DELETE
 12704*        DATASET   (FILE-ID-ERCNOT)
 12705*        RIDFLD    (ERCNOT-KEY)
 12706*        END-EXEC.
 12707*    MOVE '&(  R                 &   #00011792' TO DFHEIV0
 12708     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12709     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12710     MOVE X'2020233030303131373932' TO DFHEIV0(25:11)
 12711     CALL 'kxdfhei1' USING DFHEIV0,
 12712           FILE-ID-ERCNOT,
 12713           ERCNOT-KEY,
 12714           DFHEIV99,
 12715           DFHEIV99,
 12716           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 232
* VP6311.cbl
 12717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12718
 12719
 12720     PERFORM 8400-LOG-JOURNAL-RECORD.
 12721
 12722     GO TO 1406-DELETE-ERCNOT-LOOP.
 12723
 12724 1406-DELETE-ERNOTE.
 12725
 12726
 12727* EXEC CICS HANDLE CONDITION
 12728*         NOTFND  (1407-DELETE-MAILING)
 12729*    END-EXEC.
 12730*    MOVE '"$I                   ! / #00011803' TO DFHEIV0
 12731     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12732     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12733     MOVE X'2F20233030303131383033' TO DFHEIV0(25:11)
 12734     CALL 'kxdfhei1' USING DFHEIV0
 12735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12736
 12737
 12738
 12739* EXEC CICS READ
 12740*        EQUAL
 12741*        DATASET   (FILE-ID-ERNOTE)
 12742*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12743*        RIDFLD    (ELCERT-KEY)
 12744*        UPDATE
 12745*    END-EXEC.
 12746*    MOVE '&"S        EU         (   #00011807' TO DFHEIV0
 12747     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12748     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12749     MOVE X'2020233030303131383037' TO DFHEIV0(25:11)
 12750     CALL 'kxdfhei1' USING DFHEIV0,
 12751           FILE-ID-ERNOTE,
 12752           DFHEIV20,
 12753           DFHEIV99,
 12754           ELCERT-KEY,
 12755           DFHEIV99,
 12756           DFHEIV99,
 12757           DFHEIV99
 12758     SET ADDRESS OF CERTIFICATE-NOTE TO
 12759         DFHEIV20
 12760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12761
 12762
 12763     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12764     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12765     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12766
 12767     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12768
 12769
 12770* EXEC CICS DELETE
 12771*        DATASET   (FILE-ID-ERNOTE)
 12772*        END-EXEC.
 12773*    MOVE '&(                    &   #00011821' TO DFHEIV0
 12774     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 233
* VP6311.cbl
 12775     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12776     MOVE X'2020233030303131383231' TO DFHEIV0(25:11)
 12777     CALL 'kxdfhei1' USING DFHEIV0,
 12778           FILE-ID-ERNOTE,
 12779           DFHEIV99,
 12780           DFHEIV99,
 12781           DFHEIV99,
 12782           DFHEIV99
 12783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12784
 12785
 12786     PERFORM 8400-LOG-JOURNAL-RECORD.
 12787
 12788******************************************************************
 12789*                                                                *
 12790*                DELETE MAILING ADDRESS RECORDS                  *
 12791*                                                                *
 12792******************************************************************
 12793
 12794 1407-DELETE-MAILING.
 12795     IF CERT-ADDRESS-PRESENT
 12796        NEXT SENTENCE
 12797     ELSE
 12798        GO TO 1420-CONTINUE-DELETE.
 12799
 12800
 12801* EXEC CICS HANDLE CONDITION
 12802*         NOTFND  (1420-CONTINUE-DELETE)
 12803*    END-EXEC.
 12804*    MOVE '"$I                   ! 0 #00011839' TO DFHEIV0
 12805     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12807     MOVE X'3020233030303131383339' TO DFHEIV0(25:11)
 12808     CALL 'kxdfhei1' USING DFHEIV0
 12809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12810
 12811
 12812
 12813* EXEC CICS READ
 12814*        EQUAL
 12815*        DATASET   (FILE-ID-ERMAIL)
 12816*        SET       (ADDRESS OF MAILING-DATA)
 12817*        RIDFLD    (ELCERT-KEY)
 12818*        UPDATE
 12819*    END-EXEC.
 12820*    MOVE '&"S        EU         (   #00011843' TO DFHEIV0
 12821     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12822     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12823     MOVE X'2020233030303131383433' TO DFHEIV0(25:11)
 12824     CALL 'kxdfhei1' USING DFHEIV0,
 12825           FILE-ID-ERMAIL,
 12826           DFHEIV20,
 12827           DFHEIV99,
 12828           ELCERT-KEY,
 12829           DFHEIV99,
 12830           DFHEIV99,
 12831           DFHEIV99
 12832     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 234
* VP6311.cbl
 12833         DFHEIV20
 12834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12835
 12836
 12837     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12838     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12839     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12840
 12841     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12842
 12843
 12844* EXEC CICS DELETE
 12845*        DATASET   (FILE-ID-ERMAIL)
 12846*    END-EXEC.
 12847*    MOVE '&(                    &   #00011857' TO DFHEIV0
 12848     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12850     MOVE X'2020233030303131383537' TO DFHEIV0(25:11)
 12851     CALL 'kxdfhei1' USING DFHEIV0,
 12852           FILE-ID-ERMAIL,
 12853           DFHEIV99,
 12854           DFHEIV99,
 12855           DFHEIV99,
 12856           DFHEIV99
 12857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12858
 12859
 12860     GO TO 1420-CONTINUE-DELETE.
 12861
 12862 1410-REWRITE-CERT.
 12863     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12864     MOVE 'C'                      TO JP-RECORD-TYPE.
 12865     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12866     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12867
 12868
 12869* EXEC CICS REWRITE
 12870*         DATASET    (FILE-ID-ELCERT)
 12871*         FROM       (CERTIFICATE-MASTER)
 12872*         END-EXEC.
 12873     MOVE LENGTH OF
 12874      CERTIFICATE-MASTER
 12875       TO DFHEIV11
 12876*    MOVE '&& L                  %   #00011869' TO DFHEIV0
 12877     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12878     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12879     MOVE X'2020233030303131383639' TO DFHEIV0(25:11)
 12880     CALL 'kxdfhei1' USING DFHEIV0,
 12881           FILE-ID-ELCERT,
 12882           CERTIFICATE-MASTER,
 12883           DFHEIV11,
 12884           DFHEIV99
 12885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12886
 12887
 12888     PERFORM 8400-LOG-JOURNAL-RECORD.
 12889
 12890 1420-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 235
* VP6311.cbl
 12891     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12892     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12893
 12894     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12895     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12896
 12897     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12898
 12899 1450-DELETE-PB-RECORD.
 12900     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12901     MOVE 'D'                      TO JP-RECORD-TYPE
 12902     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12903
 12904
 12905* EXEC CICS DELETE
 12906*        DATASET    (FILE-ID-ERPNDB)
 12907*    END-EXEC.
 12908*    MOVE '&(                    &   #00011890' TO DFHEIV0
 12909     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12910     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12911     MOVE X'2020233030303131383930' TO DFHEIV0(25:11)
 12912     CALL 'kxdfhei1' USING DFHEIV0,
 12913           FILE-ID-ERPNDB,
 12914           DFHEIV99,
 12915           DFHEIV99,
 12916           DFHEIV99,
 12917           DFHEIV99
 12918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12919
 12920
 12921     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12922
 12923     PERFORM 8400-LOG-JOURNAL-RECORD.
 12924
 12925     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12926     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12927     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12928
 12929
 12930* EXEC CICS HANDLE CONDITION
 12931*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12932*    END-EXEC.
 12933*    MOVE '"$I                   ! 1 #00011902' TO DFHEIV0
 12934     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12936     MOVE X'3120233030303131393032' TO DFHEIV0(25:11)
 12937     CALL 'kxdfhei1' USING DFHEIV0
 12938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12939
 12940
 12941
 12942* EXEC CICS READ
 12943*        SET     (ADDRESS OF PENDING-BUSINESS)
 12944*        DATASET (FILE-ID-ERPNDB)
 12945*        RIDFLD  (ERPNDB-KEY)
 12946*        UPDATE
 12947*    END-EXEC.
 12948*    MOVE '&"S        EU         (   #00011906' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 236
* VP6311.cbl
 12949     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12950     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12951     MOVE X'2020233030303131393036' TO DFHEIV0(25:11)
 12952     CALL 'kxdfhei1' USING DFHEIV0,
 12953           FILE-ID-ERPNDB,
 12954           DFHEIV20,
 12955           DFHEIV99,
 12956           ERPNDB-KEY,
 12957           DFHEIV99,
 12958           DFHEIV99,
 12959           DFHEIV99
 12960     SET ADDRESS OF PENDING-BUSINESS TO
 12961         DFHEIV20
 12962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12963
 12964
 12965     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12966
 12967     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12968
 12969     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12970        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12971        MOVE 'D'                   TO JP-RECORD-TYPE
 12972        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12973
 12974* EXEC CICS DELETE
 12975*            DATASET    (FILE-ID-ERPNDB)
 12976*       END-EXEC
 12977*    MOVE '&(                    &   #00011921' TO DFHEIV0
 12978     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12979     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12980     MOVE X'2020233030303131393231' TO DFHEIV0(25:11)
 12981     CALL 'kxdfhei1' USING DFHEIV0,
 12982           FILE-ID-ERPNDB,
 12983           DFHEIV99,
 12984           DFHEIV99,
 12985           DFHEIV99,
 12986           DFHEIV99
 12987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12988        PERFORM 8400-LOG-JOURNAL-RECORD
 12989     ELSE
 12990        MOVE 'B'                 TO JP-RECORD-TYPE
 12991        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12992        PERFORM 8400-LOG-JOURNAL-RECORD
 12993        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12994        MOVE 'C'                 TO JP-RECORD-TYPE
 12995        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12996
 12997* EXEC CICS REWRITE
 12998*            DATASET    (FILE-ID-ERPNDB)
 12999*            FROM       (PENDING-BUSINESS)
 13000*       END-EXEC
 13001     MOVE LENGTH OF
 13002      PENDING-BUSINESS
 13003       TO DFHEIV11
 13004*    MOVE '&& L                  %   #00011932' TO DFHEIV0
 13005     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13006     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 237
* VP6311.cbl
 13007     MOVE X'2020233030303131393332' TO DFHEIV0(25:11)
 13008     CALL 'kxdfhei1' USING DFHEIV0,
 13009           FILE-ID-ERPNDB,
 13010           PENDING-BUSINESS,
 13011           DFHEIV11,
 13012           DFHEIV99
 13013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13014        PERFORM 8400-LOG-JOURNAL-RECORD.
 13015
 13016******************************************************************
 13017*                                                                *
 13018*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13019*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13020*                                                                *
 13021******************************************************************
 13022
 13023     IF NOT PI-AR-PROCESSING
 13024        GO TO 1475-DELETE-FINISHED.
 13025
 13026     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13027        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13028        NEXT SENTENCE
 13029     ELSE
 13030        GO TO 1475-DELETE-FINISHED.
 13031
 13032
 13033* EXEC CICS HANDLE CONDITION
 13034*         NOTFND    (1475-DELETE-FINISHED)
 13035*         END-EXEC.
 13036*    MOVE '"$I                   ! 2 #00011954' TO DFHEIV0
 13037     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13038     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13039     MOVE X'3220233030303131393534' TO DFHEIV0(25:11)
 13040     CALL 'kxdfhei1' USING DFHEIV0
 13041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13042
 13043
 13044     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13045     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13046
 13047
 13048* EXEC CICS READ
 13049*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13050*        DATASET (FILE-ID-ERRQST)
 13051*        RIDFLD  (ERRQST-KEY)
 13052*        UPDATE
 13053*    END-EXEC.
 13054*    MOVE '&"S        EU         (   #00011961' TO DFHEIV0
 13055     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13056     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13057     MOVE X'2020233030303131393631' TO DFHEIV0(25:11)
 13058     CALL 'kxdfhei1' USING DFHEIV0,
 13059           FILE-ID-ERRQST,
 13060           DFHEIV20,
 13061           DFHEIV99,
 13062           ERRQST-KEY,
 13063           DFHEIV99,
 13064           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 238
* VP6311.cbl
 13065           DFHEIV99
 13066     SET ADDRESS OF AR-REQUEST-RECORD TO
 13067         DFHEIV20
 13068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13069
 13070
 13071     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13072
 13073     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13074
 13075     MOVE 'D'                      TO JP-RECORD-TYPE.
 13076     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13077
 13078
 13079* EXEC CICS DELETE
 13080*         DATASET    (FILE-ID-ERRQST)
 13081*    END-EXEC.
 13082*    MOVE '&(                    &   #00011975' TO DFHEIV0
 13083     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13084     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13085     MOVE X'2020233030303131393735' TO DFHEIV0(25:11)
 13086     CALL 'kxdfhei1' USING DFHEIV0,
 13087           FILE-ID-ERRQST,
 13088           DFHEIV99,
 13089           DFHEIV99,
 13090           DFHEIV99,
 13091           DFHEIV99
 13092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13093
 13094
 13095     PERFORM 8400-LOG-JOURNAL-RECORD.
 13096
 13097 1475-DELETE-FINISHED.
 13098     MOVE ZEROS                  TO EMI-ERROR.
 13099     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13100     MOVE LOW-VALUES             TO VP631BI.
 13101     MOVE -1                     TO BMAINTL.
 13102     GO TO 8100-SEND-INITIAL-MAP.
 13103
 13104 1480-BATCH-HDR-NOT-FOUND.
 13105     MOVE -1                     TO BMAINTL.
 13106     MOVE ER-7450                TO EMI-ERROR.
 13107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13108     GO TO 8200-SEND-DATAONLY.
 13109
 13110 1490-RECORD-NOT-FOUND.
 13111     MOVE -1                     TO BMAINTL.
 13112     MOVE ER-7451                TO EMI-ERROR.
 13113     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13114     GO TO 8200-SEND-DATAONLY.
 13115
 13116******************************************************************
 13117*            O V E R   C H A R G E   P R O C E S S I N G         *
 13118******************************************************************
 13119 1500-UPDATE-ERNOTE.
 13120     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13121     MOVE 'A'                    TO WS-NOTE-SW
 13122     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 239
* VP6311.cbl
 13123     .
 13124 1500-EXIT.
 13125     EXIT.
 13126 1510-ADD-ERNOTE-REC.
 13127
 13128* EXEC CICS GETMAIN
 13129*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13130*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13131*        INITIMG (GETMAIN-SPACE)
 13132*    END-EXEC
 13133*    MOVE ',"IL                  $   #00012011' TO DFHEIV0
 13134     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13135     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13136     MOVE X'2020233030303132303131' TO DFHEIV0(25:11)
 13137     CALL 'kxdfhei1' USING DFHEIV0,
 13138           DFHEIV20,
 13139           ERNOTE-RECORD-LENGTH,
 13140           GETMAIN-SPACE
 13141     SET ADDRESS OF CERTIFICATE-NOTE TO
 13142         DFHEIV20
 13143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13144     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13145                                 TO ERNOTE-KEY
 13146
 13147* EXEC CICS READ
 13148*       DATASET    (FILE-ID-ERNOTE)
 13149*       RIDFLD     (ERNOTE-KEY)
 13150*       INTO       (CERTIFICATE-NOTE)
 13151*       RESP       (WS-RESPONSE)
 13152*       UPDATE
 13153*    END-EXEC
 13154     MOVE LENGTH OF
 13155      CERTIFICATE-NOTE
 13156       TO DFHEIV11
 13157*    MOVE '&"IL       EU         (  N#00012018' TO DFHEIV0
 13158     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13159     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13160     MOVE X'204E233030303132303138' TO DFHEIV0(25:11)
 13161     CALL 'kxdfhei1' USING DFHEIV0,
 13162           FILE-ID-ERNOTE,
 13163           CERTIFICATE-NOTE,
 13164           DFHEIV11,
 13165           ERNOTE-KEY,
 13166           DFHEIV99,
 13167           DFHEIV99,
 13168           DFHEIV99
 13169     MOVE EIBRESP  TO WS-RESPONSE
 13170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13171     IF RESP-NORMAL
 13172        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13173           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13174        END-IF
 13175        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13176           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13177        END-IF
 13178        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13179           (N1 > +10)
 13180           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 240
* VP6311.cbl
 13181           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13182        END-PERFORM
 13183        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13184          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13185
 13186* EXEC CICS UNLOCK
 13187*            DATASET    (FILE-ID-ERNOTE)
 13188*          END-EXEC
 13189*    MOVE '&*                    #   #00012039' TO DFHEIV0
 13190     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13191     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13192     MOVE X'2020233030303132303339' TO DFHEIV0(25:11)
 13193     CALL 'kxdfhei1' USING DFHEIV0,
 13194           FILE-ID-ERNOTE,
 13195           DFHEIV99
 13196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13197        ELSE
 13198          PERFORM VARYING N1 FROM +1 BY +1
 13199           UNTIL (N1 > +10)
 13200           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13201          END-PERFORM
 13202          IF (N1 < +11)
 13203            IF N1 >= CN-BILLING-START-LINE-NO AND
 13204              N1 <= CN-BILLING-END-LINE-NO
 13205              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13206                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13207              ELSE
 13208                 MOVE WS-VA-NO-COMM-MESS
 13209                                    TO CN-LINE (N1)
 13210              END-IF
 13211            ELSE
 13212              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13213               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13214                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13215                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13216                ELSE
 13217                  MOVE WS-VA-NO-COMM-MESS
 13218                                    TO CN-LINE (N1)
 13219                END-IF
 13220                MOVE N1             TO CN-BILLING-END-LINE-NO
 13221              ELSE
 13222                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13223                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13224                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13225                  ELSE
 13226                     MOVE WS-VA-NO-COMM-MESS
 13227                                    TO CN-LINE (N1)
 13228                  END-IF
 13229                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13230                                      CN-BILLING-START-LINE-NO
 13231                ELSE
 13232                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13233                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13234                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13235                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13236                     ELSE
 13237                       MOVE WS-VA-NO-COMM-MESS
 13238                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 241
* VP6311.cbl
 13239                     END-IF
 13240                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13241                  ELSE
 13242                     PERFORM 1700-SQUEEZE-IT-IN
 13243                                 THRU 1700-EXIT
 13244                  END-IF
 13245                END-IF
 13246              END-IF
 13247            END-IF
 13248            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13249            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13250            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13251
 13252* EXEC CICS REWRITE
 13253*              DATASET    (FILE-ID-ERNOTE)
 13254*              FROM       (CERTIFICATE-NOTE)
 13255*              RESP       (WS-RESPONSE)
 13256*           END-EXEC
 13257     MOVE LENGTH OF
 13258      CERTIFICATE-NOTE
 13259       TO DFHEIV11
 13260*    MOVE '&& L                  %  N#00012096' TO DFHEIV0
 13261     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13262     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13263     MOVE X'204E233030303132303936' TO DFHEIV0(25:11)
 13264     CALL 'kxdfhei1' USING DFHEIV0,
 13265           FILE-ID-ERNOTE,
 13266           CERTIFICATE-NOTE,
 13267           DFHEIV11,
 13268           DFHEIV99
 13269     MOVE EIBRESP  TO WS-RESPONSE
 13270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13271          END-IF
 13272        END-IF
 13273     ELSE
 13274        MOVE SPACES              TO CERTIFICATE-NOTE
 13275        MOVE 'CN'                TO CN-RECORD-ID
 13276        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13277                                 TO CN-CONTROL-PRIMARY
 13278                                    ERNOTE-KEY
 13279        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13280                                    CN-BILLING-END-LINE-NO
 13281        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13282           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13283        ELSE
 13284           MOVE WS-VA-NO-COMM-MESS
 13285                                 TO CN-LINE (1)
 13286        END-IF
 13287        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13288        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13289        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13290
 13291* EXEC CICS WRITE
 13292*          DATASET    (FILE-ID-ERNOTE)
 13293*          FROM       (CERTIFICATE-NOTE)
 13294*          RIDFLD     (ERNOTE-KEY)
 13295*          RESP       (WS-RESPONSE)
 13296*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 242
* VP6311.cbl
 13297     MOVE LENGTH OF
 13298      CERTIFICATE-NOTE
 13299       TO DFHEIV11
 13300*    MOVE '&$ L                  ''  N#00012120' TO DFHEIV0
 13301     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13302     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13303     MOVE X'204E233030303132313230' TO DFHEIV0(25:11)
 13304     CALL 'kxdfhei1' USING DFHEIV0,
 13305           FILE-ID-ERNOTE,
 13306           CERTIFICATE-NOTE,
 13307           DFHEIV11,
 13308           ERNOTE-KEY,
 13309           DFHEIV99,
 13310           DFHEIV99
 13311     MOVE EIBRESP  TO WS-RESPONSE
 13312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13313     END-IF
 13314     .
 13315 1510-EXIT.
 13316     EXIT.
 13317 1520-UPDATE-ELCERT.
 13318     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13319                                 TO ELCERT-KEY
 13320
 13321* EXEC CICS READ
 13322*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13323*        DATASET (FILE-ID-ELCERT)
 13324*        RIDFLD  (ELCERT-KEY)
 13325*        UPDATE
 13326*        RESP    (WS-RESPONSE)
 13327*    END-EXEC
 13328*    MOVE '&"S        EU         (  N#00012133' TO DFHEIV0
 13329     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13330     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13331     MOVE X'204E233030303132313333' TO DFHEIV0(25:11)
 13332     CALL 'kxdfhei1' USING DFHEIV0,
 13333           FILE-ID-ELCERT,
 13334           DFHEIV20,
 13335           DFHEIV99,
 13336           ELCERT-KEY,
 13337           DFHEIV99,
 13338           DFHEIV99,
 13339           DFHEIV99
 13340     SET ADDRESS OF CERTIFICATE-MASTER TO
 13341         DFHEIV20
 13342     MOVE EIBRESP  TO WS-RESPONSE
 13343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13344     IF RESP-NORMAL
 13345        IF WS-NOTE-SW = 'A'
 13346           IF CM-NOTE-SW = ' '
 13347              MOVE '2'             TO CM-NOTE-SW
 13348           ELSE
 13349             IF CM-NOTE-SW = '1'
 13350                MOVE '3'           TO CM-NOTE-SW
 13351             ELSE
 13352               IF CM-NOTE-SW = '4'
 13353                  MOVE '6'         TO CM-NOTE-SW
 13354               ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 243
* VP6311.cbl
 13355                 IF CM-NOTE-SW = '5'
 13356                    MOVE '7'       TO CM-NOTE-SW
 13357                 END-IF
 13358               END-IF
 13359             END-IF
 13360           END-IF
 13361        ELSE
 13362           IF CM-NOTE-SW = '2'
 13363              MOVE ' '             TO CM-NOTE-SW
 13364           ELSE
 13365             IF CM-NOTE-SW = '3'
 13366                MOVE '1'           TO CM-NOTE-SW
 13367             ELSE
 13368               IF CM-NOTE-SW = '6'
 13369                  MOVE '4'         TO CM-NOTE-SW
 13370               ELSE
 13371                 IF CM-NOTE-SW = '7'
 13372                    MOVE '5'       TO CM-NOTE-SW
 13373                 END-IF
 13374               END-IF
 13375             END-IF
 13376           END-IF
 13377        END-IF
 13378
 13379* EXEC CICS REWRITE
 13380*          DATASET    (FILE-ID-ELCERT)
 13381*          FROM       (CERTIFICATE-MASTER)
 13382*          RESP       (WS-RESPONSE)
 13383*       END-EXEC
 13384     MOVE LENGTH OF
 13385      CERTIFICATE-MASTER
 13386       TO DFHEIV11
 13387*    MOVE '&& L                  %  N#00012174' TO DFHEIV0
 13388     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13389     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13390     MOVE X'204E233030303132313734' TO DFHEIV0(25:11)
 13391     CALL 'kxdfhei1' USING DFHEIV0,
 13392           FILE-ID-ELCERT,
 13393           CERTIFICATE-MASTER,
 13394           DFHEIV11,
 13395           DFHEIV99
 13396     MOVE EIBRESP  TO WS-RESPONSE
 13397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13398        IF RESP-NORMAL
 13399           CONTINUE
 13400        ELSE
 13401           MOVE WS-RESPONSE TO EMI-ERROR
 13402           PERFORM 9900-ERROR-FORMAT
 13403                                 THRU 9900-EXIT
 13404           GO TO 8200-SEND-DATAONLY
 13405        END-IF
 13406     ELSE
 13407        MOVE -1                  TO BMAINTL
 13408        MOVE 0249                TO EMI-ERROR
 13409        PERFORM 9900-ERROR-FORMAT
 13410                                 THRU 9900-EXIT
 13411        GO TO 8200-SEND-DATAONLY
 13412     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 244
* VP6311.cbl
 13413     .
 13414 1520-EXIT.
 13415     EXIT.
 13416 1600-UPDATE-ERPYAJ.
 13417     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13418                                 THRU 1610-EXIT
 13419     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13420                                 THRU 1620-EXIT
 13421     .
 13422 1600-EXIT.
 13423     EXIT.
 13424 1610-ADD-ERPYAJ-BANK-REC.
 13425
 13426* EXEC CICS GETMAIN
 13427*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13428*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13429*        INITIMG (GETMAIN-SPACE)
 13430*    END-EXEC
 13431*    MOVE ',"IL                  $   #00012206' TO DFHEIV0
 13432     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13433     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13434     MOVE X'2020233030303132323036' TO DFHEIV0(25:11)
 13435     CALL 'kxdfhei1' USING DFHEIV0,
 13436           DFHEIV20,
 13437           ERPYAJ-RECORD-LENGTH,
 13438           GETMAIN-SPACE
 13439     SET ADDRESS OF PENDING-PAY-ADJ TO
 13440         DFHEIV20
 13441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13442     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13443     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13444     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13445     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13446     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13447     MOVE +10                    TO ERPYAJ-SEQ-NO
 13448     MOVE 'R'                    TO ERPYAJ-TYPE
 13449     IF REVERSAL
 13450        MOVE 'C'                 TO ERPYAJ-TYPE
 13451     END-IF
 13452     MOVE SPACES                 TO PENDING-PAY-ADJ
 13453     MOVE 'PY'                   TO PY-RECORD-ID
 13454     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13455     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13456     IF REVERSAL
 13457        MOVE PB-I-DCC-OVER-CHG-AMT
 13458                                 TO PY-ENTRY-AMT
 13459     END-IF
 13460     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13461                                    PY-INPUT-DT
 13462*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13463*                                   PY-INPUT-DT
 13464     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13465     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13466     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13467     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13468     IF PB-CARRIER = '2'
 13469        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13470     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 245
* VP6311.cbl
 13471        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13472     END-IF
 13473     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13474                                    PY-BILLED-DATE
 13475                                    PY-AR-DATE
 13476                                    PY-REPORTED-DT
 13477                                    PY-CHECK-WRITTEN-DT
 13478     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13479                                    PY-CHECK-QUE-SEQUENCE
 13480     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13481     PERFORM WITH TEST AFTER
 13482        UNTIL (NOT RESP-DUPKEY)
 13483           AND (NOT RESP-DUPREC)
 13484
 13485* EXEC CICS WRITE
 13486*          DATASET    (FILE-ID-ERPYAJ)
 13487*          FROM       (PENDING-PAY-ADJ)
 13488*          RIDFLD     (ERPYAJ-KEY)
 13489*          RESP       (WS-RESPONSE)
 13490*       END-EXEC
 13491     MOVE LENGTH OF
 13492      PENDING-PAY-ADJ
 13493       TO DFHEIV11
 13494*    MOVE '&$ L                  ''  N#00012253' TO DFHEIV0
 13495     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13496     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13497     MOVE X'204E233030303132323533' TO DFHEIV0(25:11)
 13498     CALL 'kxdfhei1' USING DFHEIV0,
 13499           FILE-ID-ERPYAJ,
 13500           PENDING-PAY-ADJ,
 13501           DFHEIV11,
 13502           ERPYAJ-KEY,
 13503           DFHEIV99,
 13504           DFHEIV99
 13505     MOVE EIBRESP  TO WS-RESPONSE
 13506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13507        IF RESP-DUPKEY OR RESP-DUPREC
 13508           ADD +1                TO ERPYAJ-SEQ-NO
 13509           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13510        END-IF
 13511     END-PERFORM
 13512     .
 13513 1610-EXIT.
 13514     EXIT.
 13515 1620-ADD-ERPYAJ-DLR-REC.
 13516     MOVE 'C'                    TO ERPYAJ-TYPE
 13517     IF REVERSAL
 13518        MOVE 'R'                 TO ERPYAJ-TYPE
 13519     END-IF
 13520     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13521                                    ERPYAJ-ACCOUNT
 13522     ADD +1                      TO ERPYAJ-SEQ-NO
 13523     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13524     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13525     IF PB-CARRIER = '2'
 13526        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13527     ELSE
 13528        MOVE '2725040130'        TO PY-GL-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 246
* VP6311.cbl
 13529     END-IF
 13530     PERFORM WITH TEST AFTER
 13531        UNTIL (NOT RESP-DUPKEY)
 13532           AND (NOT RESP-DUPREC)
 13533
 13534* EXEC CICS WRITE
 13535*          DATASET    (FILE-ID-ERPYAJ)
 13536*          FROM       (PENDING-PAY-ADJ)
 13537*          RIDFLD     (ERPYAJ-KEY)
 13538*          RESP       (WS-RESPONSE)
 13539*       END-EXEC
 13540     MOVE LENGTH OF
 13541      PENDING-PAY-ADJ
 13542       TO DFHEIV11
 13543*    MOVE '&$ L                  ''  N#00012285' TO DFHEIV0
 13544     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13545     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13546     MOVE X'204E233030303132323835' TO DFHEIV0(25:11)
 13547     CALL 'kxdfhei1' USING DFHEIV0,
 13548           FILE-ID-ERPYAJ,
 13549           PENDING-PAY-ADJ,
 13550           DFHEIV11,
 13551           ERPYAJ-KEY,
 13552           DFHEIV99,
 13553           DFHEIV99
 13554     MOVE EIBRESP  TO WS-RESPONSE
 13555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13556        IF RESP-DUPKEY OR RESP-DUPREC
 13557           ADD +1                TO ERPYAJ-SEQ-NO
 13558           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13559        END-IF
 13560     END-PERFORM
 13561     .
 13562 1620-EXIT.
 13563     EXIT.
 13564 1700-SQUEEZE-IT-IN.
 13565     IF (N1 > CN-BILLING-END-LINE-NO)
 13566        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13567           N1 = +1
 13568           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13569           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13570              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13571                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13572              ELSE
 13573                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13574              END-IF
 13575              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13576              MOVE +2 TO N1
 13577           END-IF
 13578        END-PERFORM
 13579     ELSE
 13580        IF (N1 < CN-BILLING-START-LINE-NO)
 13581           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13582              N1 = +10
 13583              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13584              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13585                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13586                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 247
* VP6311.cbl
 13587                 ELSE
 13588                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13589                 END-IF
 13590                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13591                 MOVE +9 TO N1
 13592              END-IF
 13593           END-PERFORM
 13594        END-IF
 13595     END-IF
 13596     .
 13597 1700-EXIT.
 13598     EXIT.
 13599 1800-REMOVE-CERT-NOTES.
 13600     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13601                                 TO ERNOTE-KEY
 13602
 13603* EXEC CICS READ
 13604*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13605*       DATASET    (FILE-ID-ERNOTE)
 13606*       RIDFLD     (ERNOTE-KEY)
 13607*       RESP       (WS-RESPONSE)
 13608*       UPDATE
 13609*    END-EXEC
 13610*    MOVE '&"S        EU         (  N#00012337' TO DFHEIV0
 13611     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13612     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13613     MOVE X'204E233030303132333337' TO DFHEIV0(25:11)
 13614     CALL 'kxdfhei1' USING DFHEIV0,
 13615           FILE-ID-ERNOTE,
 13616           DFHEIV20,
 13617           DFHEIV99,
 13618           ERNOTE-KEY,
 13619           DFHEIV99,
 13620           DFHEIV99,
 13621           DFHEIV99
 13622     SET ADDRESS OF CERTIFICATE-NOTE TO
 13623         DFHEIV20
 13624     MOVE EIBRESP  TO WS-RESPONSE
 13625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13626     IF RESP-NORMAL
 13627        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13628           (N1 > +10)
 13629           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13630           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13631        END-PERFORM
 13632        IF N1 < +11
 13633           MOVE SPACES              TO CN-LINE (N1)
 13634           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13635              N1 <= CN-BILLING-END-LINE-NO
 13636              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13637              IF CN-BILLING-END-LINE-NO <
 13638                               CN-BILLING-START-LINE-NO
 13639                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13640                                     CN-BILLING-START-LINE-NO
 13641              END-IF
 13642              PERFORM 1820-SQUEEZE-ERNOTE
 13643                                  THRU 1820-EXIT
 13644           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 248
* VP6311.cbl
 13645           IF CN-LINES = SPACES
 13646
 13647* EXEC CICS DELETE
 13648*                DATASET    (FILE-ID-ERNOTE)
 13649*                RESP       (WS-RESPONSE)
 13650*             END-EXEC
 13651*    MOVE '&(                    &  N#00012364' TO DFHEIV0
 13652     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13653     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13654     MOVE X'204E233030303132333634' TO DFHEIV0(25:11)
 13655     CALL 'kxdfhei1' USING DFHEIV0,
 13656           FILE-ID-ERNOTE,
 13657           DFHEIV99,
 13658           DFHEIV99,
 13659           DFHEIV99,
 13660           DFHEIV99
 13661     MOVE EIBRESP  TO WS-RESPONSE
 13662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13663              IF RESP-NORMAL
 13664                 MOVE 'D'        TO WS-NOTE-SW
 13665                 PERFORM 1520-UPDATE-ELCERT
 13666                                 THRU 1520-EXIT
 13667              END-IF
 13668           ELSE
 13669
 13670* EXEC CICS REWRITE
 13671*                DATASET    (FILE-ID-ERNOTE)
 13672*                FROM       (CERTIFICATE-NOTE)
 13673*                RESP       (WS-RESPONSE)
 13674*             END-EXEC
 13675     MOVE LENGTH OF
 13676      CERTIFICATE-NOTE
 13677       TO DFHEIV11
 13678*    MOVE '&& L                  %  N#00012374' TO DFHEIV0
 13679     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13680     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13681     MOVE X'204E233030303132333734' TO DFHEIV0(25:11)
 13682     CALL 'kxdfhei1' USING DFHEIV0,
 13683           FILE-ID-ERNOTE,
 13684           CERTIFICATE-NOTE,
 13685           DFHEIV11,
 13686           DFHEIV99
 13687     MOVE EIBRESP  TO WS-RESPONSE
 13688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13689           END-IF
 13690        END-IF
 13691     END-IF
 13692     .
 13693 1800-EXIT.
 13694     EXIT.
 13695 1820-SQUEEZE-ERNOTE.
 13696     MOVE CN-BILLING-START-LINE-NO TO N2
 13697     IF N2 = 0
 13698         MOVE +1                 TO N2
 13699     END-IF
 13700     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13701        (N1 > +9)
 13702        IF CN-LINE (N1) = SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 249
* VP6311.cbl
 13703           MOVE CN-LINE (N1 + +1)
 13704                                 TO CN-LINE (N1)
 13705           MOVE SPACES           TO CN-LINE (N1 + +1)
 13706        END-IF
 13707     END-PERFORM
 13708     .
 13709 1820-EXIT.
 13710     EXIT.
 13711 1900-DELETE-ERPYAJ.
 13712     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13713     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13714     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13715     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13716     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13717     MOVE +10                    TO ERPYAJ-SEQ-NO
 13718     MOVE 'R'                    TO ERPYAJ-TYPE
 13719     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13720
 13721* EXEC CICS STARTBR
 13722*       DATASET    (FILE-ID-ERPYAJ)
 13723*       RIDFLD     (ERPYAJ-KEY)
 13724*       RESP       (WS-RESPONSE)
 13725*    END-EXEC
 13726     MOVE 0
 13727       TO DFHEIV11
 13728*    MOVE '&,         G          &  N#00012410' TO DFHEIV0
 13729     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13730     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13731     MOVE X'204E233030303132343130' TO DFHEIV0(25:11)
 13732     CALL 'kxdfhei1' USING DFHEIV0,
 13733           FILE-ID-ERPYAJ,
 13734           ERPYAJ-KEY,
 13735           DFHEIV99,
 13736           DFHEIV11,
 13737           DFHEIV99
 13738     MOVE EIBRESP  TO WS-RESPONSE
 13739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13740     IF RESP-NORMAL
 13741        CONTINUE
 13742     ELSE
 13743        GO TO 1900-GET-DEALER
 13744     END-IF
 13745     .
 13746 1900-READNEXT-ERPYAJ-B.
 13747*  GET THE BANK ERPYAJ RECORD
 13748
 13749* EXEC CICS READNEXT
 13750*       DATASET    (FILE-ID-ERPYAJ)
 13751*       RIDFLD     (ERPYAJ-KEY)
 13752*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13753*       RESP       (WS-RESPONSE)
 13754*    END-EXEC
 13755     MOVE 0
 13756       TO DFHEIV11
 13757*    MOVE '&.S                   )  N#00012423' TO DFHEIV0
 13758     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13759     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13760     MOVE X'204E233030303132343233' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 250
* VP6311.cbl
 13761     CALL 'kxdfhei1' USING DFHEIV0,
 13762           FILE-ID-ERPYAJ,
 13763           DFHEIV20,
 13764           DFHEIV99,
 13765           ERPYAJ-KEY,
 13766           DFHEIV99,
 13767           DFHEIV11,
 13768           DFHEIV99,
 13769           DFHEIV99
 13770     SET ADDRESS OF PENDING-PAY-ADJ TO
 13771         DFHEIV20
 13772     MOVE EIBRESP  TO WS-RESPONSE
 13773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13774     IF RESP-NORMAL
 13775        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13776           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13777              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13778                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13779
 13780* EXEC CICS READ
 13781*                   DATASET    (FILE-ID-ERPYAJ)
 13782*                   RIDFLD     (ERPYAJ-KEY)
 13783*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13784*                   RESP       (WS-RESPONSE)
 13785*                   UPDATE
 13786*                END-EXEC
 13787*    MOVE '&"S        EU         (  N#00012434' TO DFHEIV0
 13788     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13789     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13790     MOVE X'204E233030303132343334' TO DFHEIV0(25:11)
 13791     CALL 'kxdfhei1' USING DFHEIV0,
 13792           FILE-ID-ERPYAJ,
 13793           DFHEIV20,
 13794           DFHEIV99,
 13795           ERPYAJ-KEY,
 13796           DFHEIV99,
 13797           DFHEIV99,
 13798           DFHEIV99
 13799     SET ADDRESS OF PENDING-PAY-ADJ TO
 13800         DFHEIV20
 13801     MOVE EIBRESP  TO WS-RESPONSE
 13802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13803                 IF RESP-NORMAL
 13804
 13805* EXEC CICS DELETE
 13806*                      DATASET   (FILE-ID-ERPYAJ)
 13807*                      RESP      (WS-RESPONSE)
 13808*                   END-EXEC
 13809*    MOVE '&(                    &  N#00012442' TO DFHEIV0
 13810     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13812     MOVE X'204E233030303132343432' TO DFHEIV0(25:11)
 13813     CALL 'kxdfhei1' USING DFHEIV0,
 13814           FILE-ID-ERPYAJ,
 13815           DFHEIV99,
 13816           DFHEIV99,
 13817           DFHEIV99,
 13818           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 251
* VP6311.cbl
 13819     MOVE EIBRESP  TO WS-RESPONSE
 13820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13821                 END-IF
 13822              ELSE
 13823                 SET REVERSAL    TO TRUE
 13824                 PERFORM 1600-UPDATE-ERPYAJ
 13825                                 THRU 1600-EXIT
 13826                 GO TO 1900-EXIT
 13827              END-IF
 13828           ELSE
 13829              GO TO 1900-READNEXT-ERPYAJ-B
 13830           END-IF
 13831        END-IF
 13832
 13833* EXEC CICS ENDBR
 13834*          DATASET   (FILE-ID-ERPYAJ)
 13835*       END-EXEC
 13836     MOVE 0
 13837       TO DFHEIV11
 13838*    MOVE '&2                    $   #00012457' TO DFHEIV0
 13839     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13841     MOVE X'2020233030303132343537' TO DFHEIV0(25:11)
 13842     CALL 'kxdfhei1' USING DFHEIV0,
 13843           FILE-ID-ERPYAJ,
 13844           DFHEIV11,
 13845           DFHEIV99
 13846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13847     END-IF
 13848     .
 13849 1900-GET-DEALER.
 13850     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13851     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13852     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13853     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13854     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13855     MOVE +10                    TO ERPYAJ-SEQ-NO
 13856     MOVE 'C'                    TO ERPYAJ-TYPE
 13857     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13858
 13859* EXEC CICS STARTBR
 13860*       DATASET    (FILE-ID-ERPYAJ)
 13861*       RIDFLD     (ERPYAJ-KEY)
 13862*       RESP       (WS-RESPONSE)
 13863*    END-EXEC
 13864     MOVE 0
 13865       TO DFHEIV11
 13866*    MOVE '&,         G          &  N#00012471' TO DFHEIV0
 13867     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13869     MOVE X'204E233030303132343731' TO DFHEIV0(25:11)
 13870     CALL 'kxdfhei1' USING DFHEIV0,
 13871           FILE-ID-ERPYAJ,
 13872           ERPYAJ-KEY,
 13873           DFHEIV99,
 13874           DFHEIV11,
 13875           DFHEIV99
 13876     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 252
* VP6311.cbl
 13877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13878     IF RESP-NORMAL
 13879        CONTINUE
 13880     ELSE
 13881        GO TO 1900-EXIT
 13882     END-IF
 13883     .
 13884 1900-READNEXT-ERPYAJ-D.
 13885*  GET THE DEALER ERPYAJ RECORD
 13886
 13887* EXEC CICS READNEXT
 13888*       DATASET    (FILE-ID-ERPYAJ)
 13889*       RIDFLD     (ERPYAJ-KEY)
 13890*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13891*       RESP       (WS-RESPONSE)
 13892*    END-EXEC
 13893     MOVE 0
 13894       TO DFHEIV11
 13895*    MOVE '&.S                   )  N#00012484' TO DFHEIV0
 13896     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13897     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13898     MOVE X'204E233030303132343834' TO DFHEIV0(25:11)
 13899     CALL 'kxdfhei1' USING DFHEIV0,
 13900           FILE-ID-ERPYAJ,
 13901           DFHEIV20,
 13902           DFHEIV99,
 13903           ERPYAJ-KEY,
 13904           DFHEIV99,
 13905           DFHEIV11,
 13906           DFHEIV99,
 13907           DFHEIV99
 13908     SET ADDRESS OF PENDING-PAY-ADJ TO
 13909         DFHEIV20
 13910     MOVE EIBRESP  TO WS-RESPONSE
 13911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13912     IF RESP-NORMAL
 13913        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13914           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13915              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13916                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13917
 13918* EXEC CICS READ
 13919*                   DATASET    (FILE-ID-ERPYAJ)
 13920*                   RIDFLD     (ERPYAJ-KEY)
 13921*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13922*                   RESP       (WS-RESPONSE)
 13923*                   UPDATE
 13924*                END-EXEC
 13925*    MOVE '&"S        EU         (  N#00012495' TO DFHEIV0
 13926     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13927     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13928     MOVE X'204E233030303132343935' TO DFHEIV0(25:11)
 13929     CALL 'kxdfhei1' USING DFHEIV0,
 13930           FILE-ID-ERPYAJ,
 13931           DFHEIV20,
 13932           DFHEIV99,
 13933           ERPYAJ-KEY,
 13934           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 253
* VP6311.cbl
 13935           DFHEIV99,
 13936           DFHEIV99
 13937     SET ADDRESS OF PENDING-PAY-ADJ TO
 13938         DFHEIV20
 13939     MOVE EIBRESP  TO WS-RESPONSE
 13940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13941                 IF RESP-NORMAL
 13942
 13943* EXEC CICS DELETE
 13944*                      DATASET   (FILE-ID-ERPYAJ)
 13945*                      RESP      (WS-RESPONSE)
 13946*                   END-EXEC
 13947*    MOVE '&(                    &  N#00012503' TO DFHEIV0
 13948     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13949     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13950     MOVE X'204E233030303132353033' TO DFHEIV0(25:11)
 13951     CALL 'kxdfhei1' USING DFHEIV0,
 13952           FILE-ID-ERPYAJ,
 13953           DFHEIV99,
 13954           DFHEIV99,
 13955           DFHEIV99,
 13956           DFHEIV99
 13957     MOVE EIBRESP  TO WS-RESPONSE
 13958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13959                 END-IF
 13960              ELSE
 13961                 SET REVERSAL    TO TRUE
 13962              END-IF
 13963           ELSE
 13964              GO TO 1900-READNEXT-ERPYAJ-D
 13965           END-IF
 13966        END-IF
 13967
 13968* EXEC CICS ENDBR
 13969*          DATASET   (FILE-ID-ERPYAJ)
 13970*       END-EXEC
 13971     MOVE 0
 13972       TO DFHEIV11
 13973*    MOVE '&2                    $   #00012515' TO DFHEIV0
 13974     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13975     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13976     MOVE X'2020233030303132353135' TO DFHEIV0(25:11)
 13977     CALL 'kxdfhei1' USING DFHEIV0,
 13978           FILE-ID-ERPYAJ,
 13979           DFHEIV11,
 13980           DFHEIV99
 13981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13982     END-IF
 13983     .
 13984 1900-EXIT.
 13985     EXIT.
 13986******************************************************************
 13987*            C A N C E L   M A I N L I N E                       *
 13988******************************************************************
 13989
 13990 2000-CANCEL-MAINLINE.
 13991     IF PI-DISPLAY-ORIGINAL-BATCH
 13992        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 254
* VP6311.cbl
 13993           MOVE ER-0023             TO EMI-ERROR
 13994           MOVE -1                  TO CMAINTL
 13995           MOVE AL-UABON            TO CMAINTA
 13996           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13997           GO TO 8200-SEND-DATAONLY
 13998        ELSE
 13999           NEXT SENTENCE
 14000     ELSE
 14001        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14002           MOVE ER-0023             TO EMI-ERROR
 14003           MOVE -1                  TO CMAINTL
 14004           MOVE AL-UABON            TO CMAINTA
 14005           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14006           GO TO 8200-SEND-DATAONLY.
 14007
 14008     IF CMAINTI = 'S'
 14009        GO TO 2100-SHOW-REQUEST.
 14010
 14011     IF NOT MODIFY-CAP
 14012         MOVE 'UPDATE'       TO SM-READ
 14013         PERFORM 9995-SECURITY-VIOLATION
 14014         MOVE ER-0070        TO EMI-ERROR
 14015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14016         GO TO 8100-SEND-INITIAL-MAP.
 14017
 14018     IF CMAINTL GREATER THAN ZEROS
 14019        IF PI-PF6-FUNCTION
 14020           IF CMAINTI NOT = 'A'
 14021              MOVE AL-UABON  TO CMAINTA
 14022              MOVE -1        TO CMAINTL
 14023              MOVE ER-2260   TO EMI-ERROR
 14024              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14025              GO TO 8200-SEND-DATAONLY.
 14026
 14027     IF CCERTNOL = ZEROS
 14028       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14029         NEXT SENTENCE
 14030     ELSE
 14031         IF CCERTNOL NOT = ZEROS
 14032             MOVE AL-UANON       TO CCERTNOA
 14033         ELSE
 14034             MOVE -1             TO CCERTNOL
 14035             MOVE  1             TO SET-CURSOR-SW
 14036             MOVE ER-2218       TO EMI-ERROR
 14037             MOVE AL-UABON       TO CCERTNOA
 14038             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14039
 14040     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14041        NEXT SENTENCE
 14042     ELSE
 14043        IF CEFFDTL NOT = ZEROS
 14044           MOVE AL-UNNON         TO CEFFDTA
 14045           MOVE CEFFDTI TO DEEDIT-FIELD
 14046           PERFORM 8600-DEEDIT
 14047           MOVE 4                TO DC-OPTION-CODE
 14048           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14049           PERFORM 9700-DATE-LINK
 14050           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 255
* VP6311.cbl
 14051              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14052              ELSE
 14053              MOVE -1            TO CEFFDTL
 14054              MOVE  1            TO SET-CURSOR-SW
 14055              MOVE ER-2226      TO EMI-ERROR
 14056              MOVE AL-UNBON      TO CEFFDTA
 14057              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14058          ELSE
 14059          MOVE -1                 TO CEFFDTL
 14060          MOVE  1                 TO SET-CURSOR-SW
 14061          MOVE ER-2220            TO EMI-ERROR
 14062          MOVE AL-UNBON           TO CEFFDTA
 14063          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14064
 14065     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14066
 14067     IF CCERTNOL NOT = ZEROS
 14068        MOVE CCERTNOI                TO WS-NEW-PRIME
 14069     ELSE
 14070        MOVE SPACES                  TO WS-NEW-PRIME.
 14071
 14072     IF CSUFIXL NOT = ZEROS
 14073        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14074     ELSE
 14075        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14076
 14077     IF CEFFDTL NOT = ZEROS
 14078        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14079     ELSE
 14080        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14081
 14082     IF CMAINTI = 'A' OR 'K' OR 'S'
 14083        NEXT SENTENCE
 14084     ELSE
 14085        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14086        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14087           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14088           WS-PB-RECORD-TYPE NOT = '2'
 14089           IF CMAINTI = 'C'
 14090              MOVE ER-2287          TO EMI-ERROR
 14091              MOVE -1               TO CCERTNOL
 14092              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14093              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14094              GO TO 8200-SEND-DATAONLY
 14095             ELSE
 14096              MOVE ER-2260          TO EMI-ERROR
 14097              MOVE -1               TO CCERTNOL
 14098              MOVE AL-UABON         TO CCERTNOA
 14099              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14100              GO TO 8200-SEND-DATAONLY.
 14101
 14102     IF CMAINTI = 'D'
 14103        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14104
 14105     IF CLSTNML GREATER THAN ZEROS
 14106         MOVE AL-UANON           TO CLSTNMA.
 14107
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 256
* VP6311.cbl
 14109
 14110******************************************************************
 14111*                                                                *
 14112*           E D I T   C A N C E L   C O V E R A G E S            *
 14113*                                                                *
 14114******************************************************************
 14115
 14116 2015-EDIT-COVERAGES.
 14117     IF CCANDT1L      GREATER THAN ZEROS OR
 14118        CREFND1L      GREATER THAN ZEROS OR
 14119        CCANDT2L      GREATER THAN ZEROS OR
 14120        CREFND2L      GREATER THAN ZEROS OR
 14121        CMTHD1L       GREATER THAN ZEROS OR
 14122        CMTHD2L       GREATER THAN ZEROS OR
 14123        CLIVESL       GREATER THAN ZEROS OR
 14124        CPAYEEL       GREATER THAN ZEROS OR
 14125        CFORCEL       GREATER THAN ZEROS OR
 14126        CBILCDL       GREATER THAN ZEROS OR
 14127        CCANREAL      GREATER THAN ZEROS
 14128            NEXT SENTENCE
 14129         ELSE
 14130            GO TO 2030-EDIT-COMPLETE.
 14131
 14132     IF CCANDT1L = ZEROS
 14133        AND (CMAINTI = 'C' OR 'K')
 14134        NEXT SENTENCE
 14135     ELSE
 14136        IF CCANDT1L      GREATER THAN ZEROS
 14137            MOVE AL-UNNON            TO CCANDT1A
 14138            IF CCANDT1I = SPACES
 14139               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14140            ELSE
 14141               MOVE CCANDT1I            TO DEEDIT-FIELD
 14142               PERFORM 8600-DEEDIT
 14143               IF DEEDIT-FIELD-V0   NUMERIC
 14144                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14145                  MOVE 4                TO DC-OPTION-CODE
 14146                  PERFORM 9700-DATE-LINK
 14147                  IF NO-CONVERSION-ERROR
 14148                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14149                  ELSE
 14150                      MOVE -1        TO CCANDT1L
 14151                      MOVE ER-2227   TO EMI-ERROR
 14152                      MOVE AL-UNBON  TO CCANDT1A
 14153                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14154               ELSE
 14155                  MOVE -1         TO CCANDT1L
 14156                  MOVE ER-2223    TO EMI-ERROR
 14157                  MOVE AL-UNBON   TO CCANDT1A
 14158                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14159        ELSE
 14160            IF CREFND1L GREATER THAN ZEROS
 14161               MOVE -1             TO CCANDT1L
 14162               MOVE ER-2222        TO EMI-ERROR
 14163               MOVE AL-UNBOF       TO CCANDT1A
 14164               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14165
 14166     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 257
* VP6311.cbl
 14167        AND (CMAINTI = 'C' OR 'K')
 14168         NEXT SENTENCE
 14169     ELSE
 14170         IF CREFND1L NOT = ZEROS
 14171            MOVE AL-UNNON        TO CREFND1A
 14172
 14173* EXEC CICS BIF DEEDIT
 14174*               FIELD  (CREFND1I)
 14175*               LENGTH (11)
 14176*           END-EXEC
 14177     MOVE 11
 14178       TO DFHEIV11
 14179*    MOVE '@"L                   #   #00012708' TO DFHEIV0
 14180     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14181     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14182     MOVE X'2020233030303132373038' TO DFHEIV0(25:11)
 14183     CALL 'kxdfhei1' USING DFHEIV0,
 14184           CREFND1I,
 14185           DFHEIV11
 14186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14187            MOVE CREFND1I        TO WS-CREFND1
 14188*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14189*           PERFORM 8600-DEEDIT
 14190*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14191            IF WS-CREFND1  = ZEROS
 14192               AND CMAINTI = 'A'
 14193             MOVE ER-2437        TO EMI-ERROR
 14194             MOVE -1             TO CREFND1L
 14195             MOVE AL-UNBON       TO CREFND1A
 14196             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14197
 14198     IF CCANREAL > +0
 14199        MOVE AL-UANON            TO CCANREAA
 14200        IF CCANREAI = 'R' OR ' '
 14201           CONTINUE
 14202        ELSE
 14203           MOVE ER-9841        TO EMI-ERROR
 14204           MOVE -1             TO CCANREAL
 14205           MOVE AL-UABON       TO CCANREAA
 14206           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14207        END-IF
 14208     END-IF
 14209     IF CMTHD1L EQUAL +0
 14210        NEXT SENTENCE
 14211     ELSE
 14212        IF CMTHD1L NOT = +0
 14213           MOVE AL-UNNON        TO CMTHD1A
 14214           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14215                         OR '5' OR '6' OR '8' OR '9'
 14216                         OR 'R' OR ' '
 14217              NEXT SENTENCE
 14218           ELSE
 14219              MOVE ER-0582        TO EMI-ERROR
 14220              MOVE -1             TO CMTHD1L
 14221              MOVE AL-UNBON       TO CMTHD1A
 14222              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14223
 14224     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 258
* VP6311.cbl
 14225        AND (CMAINTI = 'C' OR 'K')
 14226         NEXT SENTENCE
 14227     ELSE
 14228         IF CCANDT2L  GREATER THAN ZEROS
 14229             MOVE AL-UNNON       TO CCANDT2A
 14230             IF CCANDT2I = SPACES
 14231                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14232             ELSE
 14233                MOVE CCANDT2I       TO DEEDIT-FIELD
 14234                PERFORM 8600-DEEDIT
 14235                IF DEEDIT-FIELD-V0   NUMERIC
 14236                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14237                   MOVE 4                TO DC-OPTION-CODE
 14238                   PERFORM 9700-DATE-LINK
 14239                   IF NO-CONVERSION-ERROR
 14240                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14241                   ELSE
 14242                      MOVE -1       TO CCANDT2L
 14243                      MOVE ER-2227  TO EMI-ERROR
 14244                      MOVE AL-UNBON TO CCANDT2A
 14245                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14246                ELSE
 14247                   MOVE -1         TO CCANDT2L
 14248                   MOVE ER-2223    TO EMI-ERROR
 14249                   MOVE AL-UNBON   TO CCANDT2A
 14250                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14251         ELSE
 14252            IF CREFND2L GREATER THAN ZEROS
 14253               MOVE -1             TO CCANDT2L
 14254               MOVE ER-2222        TO EMI-ERROR
 14255               MOVE AL-UNBOF       TO CCANDT2A
 14256               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14257
 14258     IF CREFND2L = ZEROS
 14259        AND (CMAINTI = 'C' OR 'K')
 14260         NEXT SENTENCE
 14261     ELSE
 14262         IF CREFND2L NOT = ZEROS
 14263            MOVE AL-UNNON        TO CREFND2A
 14264
 14265* EXEC CICS BIF DEEDIT
 14266*               FIELD  (CREFND2I)
 14267*               LENGTH (11)
 14268*           END-EXEC
 14269     MOVE 11
 14270       TO DFHEIV11
 14271*    MOVE '@"L                   #   #00012789' TO DFHEIV0
 14272     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14273     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14274     MOVE X'2020233030303132373839' TO DFHEIV0(25:11)
 14275     CALL 'kxdfhei1' USING DFHEIV0,
 14276           CREFND2I,
 14277           DFHEIV11
 14278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14279            MOVE CREFND2I        TO WS-CREFND2
 14280*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14281*           PERFORM 8600-DEEDIT
 14282*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 259
* VP6311.cbl
 14283            IF WS-CREFND2  = ZEROS
 14284               AND CMAINTI = 'A'
 14285             MOVE ER-2437        TO EMI-ERROR
 14286             MOVE -1             TO CREFND2L
 14287             MOVE AL-UNBON       TO CREFND2A
 14288             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14289
 14290     IF CMTHD2L EQUAL +0
 14291        NEXT SENTENCE
 14292     ELSE
 14293        IF CMTHD2L NOT = +0
 14294           MOVE AL-UNNON        TO CMTHD2A
 14295           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14296                         OR '5' OR '6' OR '8' OR '9'
 14297                         OR ' ' OR 'R'
 14298              NEXT SENTENCE
 14299           ELSE
 14300              MOVE ER-0582        TO EMI-ERROR
 14301              MOVE -1             TO CMTHD2L
 14302              MOVE AL-UNBON       TO CMTHD2A
 14303              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14304
 14305     IF CLIVESL GREATER THAN ZEROS
 14306         MOVE CLIVESI            TO DEEDIT-FIELD
 14307         PERFORM 8600-DEEDIT
 14308         IF DEEDIT-FIELD-V0 NUMERIC
 14309             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14310             MOVE AL-UNNON       TO CLIVESA
 14311         ELSE
 14312             MOVE -1             TO CLIVESL
 14313             MOVE AL-UNBON       TO CLIVESA
 14314             MOVE ER-2223        TO EMI-ERROR
 14315             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14316
 14317     IF CFORCEL  NOT = ZEROS
 14318         IF FORCE-CAP
 14319            MOVE AL-UANON            TO CFORCEA
 14320         ELSE
 14321            MOVE ER-2945             TO EMI-ERROR
 14322            MOVE AL-UABON            TO CFORCEA
 14323            MOVE -1                  TO CFORCEL
 14324            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14325
 14326     IF CPAYEEL GREATER THAN ZEROS
 14327        MOVE AL-UANON            TO CPAYEEA.
 14328
 14329     IF CBILCDL NOT = ZEROS
 14330        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14331                             AND 'A' AND 'B' AND 'E'
 14332           MOVE ER-2225              TO EMI-ERROR
 14333           MOVE AL-UABON             TO CBILCDA
 14334           MOVE -1                   TO CBILCDL
 14335           MOVE  1                   TO SET-CURSOR-SW
 14336           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14337        ELSE
 14338           MOVE AL-UANON             TO CBILCDA.
 14339
 14340 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 260
* VP6311.cbl
 14341     IF EMI-ERROR = ZEROS
 14342         NEXT SENTENCE
 14343     ELSE
 14344         GO TO 8200-SEND-DATAONLY.
 14345
 14346     IF CMAINTI = 'A'
 14347        GO TO 2200-ADD-CANCEL-ROUTINE.
 14348
 14349     IF CMAINTI = 'C'
 14350        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14351
 14352     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14353
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 261
* VP6311.cbl
 14355
 14356******************************************************************
 14357*                                                                *
 14358*                   S H O W   C A N C E L                        *
 14359*                                                                *
 14360******************************************************************
 14361
 14362 2100-SHOW-REQUEST.
 14363     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14364
 14365     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14366        MOVE -1                  TO CMAINTL
 14367        GO TO 8200-SEND-DATAONLY.
 14368
 14369     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14370
 14371     IF CSUFIXL NOT = ZEROS
 14372        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14373       ELSE
 14374        MOVE SPACE            TO WS-NEW-SUFFIX.
 14375
 14376     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14377     PERFORM 8600-DEEDIT.
 14378     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14379     MOVE '4'                    TO DC-OPTION-CODE.
 14380     PERFORM 9700-DATE-LINK.
 14381     IF DATE-CONVERSION-ERROR
 14382        MOVE ER-0348             TO EMI-ERROR
 14383        MOVE -1                  TO CEFFDTL
 14384        MOVE AL-UABON            TO CEFFDTA
 14385        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14386        GO TO 8200-SEND-DATAONLY
 14387     ELSE
 14388        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14389        MOVE AL-UANON            TO CEFFDTA
 14390        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14391
 14392     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14393
 14394     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14395        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14396        MOVE 'Y'                    TO WS-SHOW-SW
 14397        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14398           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14399        ELSE
 14400           IF PI-FILE-BROWSE
 14401              GO TO 4300-BROWSE-FILE-FORWARD
 14402           ELSE
 14403              IF PI-CSR-BROWSE
 14404                 GO TO 4200-BROWSE-CSR-FORWARD
 14405              ELSE
 14406                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14407     ELSE
 14408        GO TO 3900-RE-DISPLAY-RECORD.
 14409
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 262
* VP6311.cbl
 14411
 14412
 14413******************************************************************
 14414*                                                                *
 14415*            A D D   C A N C E L   R O U T I N E                 *
 14416*                                                                *
 14417******************************************************************
 14418
 14419 2200-ADD-CANCEL-ROUTINE.
 14420     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14421
 14422
 14423* EXEC CICS GETMAIN
 14424*        SET     (ADDRESS OF PENDING-BUSINESS)
 14425*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14426*    END-EXEC.
 14427*    MOVE '," L                  $   #00012936' TO DFHEIV0
 14428     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14429     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14430     MOVE X'2020233030303132393336' TO DFHEIV0(25:11)
 14431     CALL 'kxdfhei1' USING DFHEIV0,
 14432           DFHEIV20,
 14433           ERPNDB-RECORD-LENGTH,
 14434           DFHEIV99
 14435     SET ADDRESS OF PENDING-BUSINESS TO
 14436         DFHEIV20
 14437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14438
 14439
 14440
 14441* EXEC CICS HANDLE CONDITION
 14442*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14443*    END-EXEC.
 14444*    MOVE '"$I                   ! 3 #00012941' TO DFHEIV0
 14445     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14447     MOVE X'3320233030303132393431' TO DFHEIV0(25:11)
 14448     CALL 'kxdfhei1' USING DFHEIV0
 14449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14450
 14451
 14452     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14453     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14454     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14455
 14456
 14457* EXEC CICS READ
 14458*        INTO    (PENDING-BUSINESS)
 14459*        DATASET (FILE-ID-ERPNDB)
 14460*        RIDFLD  (ERPNDB-KEY)
 14461*    END-EXEC.
 14462     MOVE LENGTH OF
 14463      PENDING-BUSINESS
 14464       TO DFHEIV11
 14465*    MOVE '&"IL       E          (   #00012949' TO DFHEIV0
 14466     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14468     MOVE X'2020233030303132393439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 263
* VP6311.cbl
 14469     CALL 'kxdfhei1' USING DFHEIV0,
 14470           FILE-ID-ERPNDB,
 14471           PENDING-BUSINESS,
 14472           DFHEIV11,
 14473           ERPNDB-KEY,
 14474           DFHEIV99,
 14475           DFHEIV99,
 14476           DFHEIV99
 14477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14478
 14479
 14480     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14481
 14482     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14483     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14484     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14485     MOVE SPACES                 TO PENDING-BUSINESS.
 14486     MOVE 'PB'                   TO PB-RECORD-ID.
 14487     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14488     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14489     MOVE SPACES                 TO PB-CERT-SFX.
 14490     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14491     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14492                                    PB-ALT-CHG-SEQ-NO.
 14493
 14494     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14495     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14496     MOVE '2'                    TO PB-RECORD-TYPE.
 14497
 14498     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14499     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14500
 14501
 14502     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14503                                    PB-ALT-CHG-SEQ-NO
 14504                                    PB-C-LF-REF-CALC
 14505                                    PB-C-AH-REF-CALC
 14506                                    PB-C-LF-RFND-CLP
 14507                                    PB-C-AH-RFND-CLP
 14508                                    PB-CI-INSURED-AGE
 14509                                    PB-CI-LF-TERM
 14510                                    PB-CI-AH-TERM
 14511                                    PB-CI-LF-BENEFIT-CD
 14512                                    PB-CI-LF-BENEFIT-AMT
 14513                                    PB-CI-LF-ALT-BENEFIT-AMT
 14514                                    PB-CI-LF-PREMIUM-AMT
 14515                                    PB-CI-LF-ALT-PREMIUM-AMT
 14516                                    PB-CI-AH-BENEFIT-CD
 14517                                    PB-CI-AH-BENEFIT-AMT
 14518                                    PB-CI-AH-PREMIUM-AMT
 14519                                    PB-CI-PAY-FREQUENCY
 14520                                    PB-CI-LOAN-APR
 14521                                    PB-CI-LOAN-TERM
 14522                                    PB-CI-LIFE-COMMISSION
 14523                                    PB-CI-AH-COMMISSION
 14524                                    PB-CI-CURR-SEQ
 14525                                    PB-CI-AH-CANCEL-AMT
 14526                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 264
* VP6311.cbl
 14527                                    PB-CI-RATE-DEV-PCT-LF
 14528                                    PB-CI-RATE-DEV-PCT-AH
 14529                                    PB-CI-EXTENTION-DAYS
 14530                                    PB-CI-TERM-IN-DAYS
 14531                                    PB-CI-LIVES
 14532                                    PB-CI-LF-CRIT-PER
 14533                                    PB-CI-AH-CRIT-PER
 14534                                    PB-C-LF-REM-TERM
 14535                                    PB-C-AH-REM-TERM
 14536                                    PB-CHG-COUNT
 14537                                    PB-LF-BILLED-AMTS
 14538                                    PB-AH-BILLED-AMTS
 14539                                    PB-C-NH-INT-ON-REFS
 14540*                                   PB-C-MICROFILM-NO
 14541                                    PB-CALC-TOLERANCE.
 14542
 14543     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14544                                    PB-CI-AH-SETTLEMENT-DT
 14545                                    PB-CI-DEATH-DT
 14546                                    PB-CI-LF-PRIOR-CANCEL-DT
 14547                                    PB-CI-AH-PRIOR-CANCEL-DT
 14548                                    PB-CI-ENTRY-DT
 14549                                    PB-CI-LF-EXPIRE-DT
 14550                                    PB-CI-AH-EXPIRE-DT
 14551                                    PB-CI-LOAN-1ST-PMT-DT
 14552                                    PB-C-LF-CANCEL-DT
 14553                                    PB-C-AH-CANCEL-DT
 14554                                    PB-CREDIT-ACCEPT-DT
 14555                                    PB-BILLED-DT
 14556                                    PB-ACCT-EFF-DT
 14557                                    PB-ACCT-EXP-DT.
 14558
 14559     MOVE 'X'                    TO PB-FATAL-FLAG.
 14560
 14561     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14562
 14563     IF CSUFIXL     GREATER THAN ZEROS
 14564        MOVE CSUFIXI             TO PB-CERT-SFX.
 14565
 14566*    IF CMICRNOL  GREATER  ZEROS
 14567*        IF CMICRNOI  NUMERIC
 14568*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14569*            MOVE AL-UNNON       TO  CMICRNOA
 14570*        ELSE
 14571*            MOVE -1             TO  CMICRNOL
 14572*            MOVE AL-UNBON       TO  CMICRNOA
 14573*            MOVE ER-2701        TO  EMI-ERROR
 14574*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14575
 14576     IF CLSTNML     GREATER THAN ZEROS
 14577        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14578
 14579     IF CCANREAL > ZEROS
 14580        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14581     END-IF
 14582     IF CPCYNL > ZEROS
 14583        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14584     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 265
* VP6311.cbl
 14585     IF CCANDT1L    GREATER THAN ZEROS
 14586        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14587
 14588     IF CCANDT2L    GREATER THAN ZEROS
 14589        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14590
 14591     IF CMTHD1L    GREATER THAN +0
 14592        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14593
 14594     IF CMTHD2L    GREATER THAN +0
 14595        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14596
 14597     IF CREFND1L    GREATER THAN ZEROS
 14598        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14599        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14600     ELSE
 14601        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14602
 14603     IF CREFND2L    GREATER THAN ZEROS
 14604        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14605        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14606     ELSE
 14607        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14608
 14609     IF CLIVESL     GREATER THAN ZEROS
 14610        MOVE WS-CLIVES           TO PB-C-LIVES
 14611     ELSE
 14612        MOVE ZEROS               TO PB-C-LIVES.
 14613
 14614     IF CPAYEEL     GREATER THAN ZEROS
 14615        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14616
 14617     IF CFORCEL     GREATER THAN ZEROS
 14618        MOVE CFORCEI             TO PB-FORCE-CODE.
 14619
 14620     IF CBILCDL     GREATER THAN ZEROS
 14621        MOVE CBILCDI             TO PB-RECORD-BILL.
 14622
 14623*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14624
 14625 2260-WRITE-PB-RECORD.
 14626     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14627                                    PB-INPUT-BY.
 14628     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14629     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14630                                    PB-INPUT-DT.
 14631
 14632     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14633     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14634                                    PB-CONTROL-BY-ORIG-BATCH.
 14635
 14636     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14637     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14638     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14639     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14640     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14641
 14642     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 266
* VP6311.cbl
 14643
 14644     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14645
 14646     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14647     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14648     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14649
 14650     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14651     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14652
 14653 2275-WRITE-PENDING-BUSINESS.
 14654     MOVE 'A'                    TO JP-RECORD-TYPE.
 14655     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14656     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14657     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14658
 14659
 14660* EXEC CICS HANDLE CONDITION
 14661*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14662*    END-EXEC.
 14663*    MOVE '"$%                   ! 4 #00013134' TO DFHEIV0
 14664     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14666     MOVE X'3420233030303133313334' TO DFHEIV0(25:11)
 14667     CALL 'kxdfhei1' USING DFHEIV0
 14668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14669
 14670
 14671
 14672* EXEC CICS WRITE
 14673*        DATASET (FILE-ID-ERPNDB)
 14674*        FROM    (PENDING-BUSINESS)
 14675*        RIDFLD  (PB-CONTROL-PRIMARY)
 14676*    END-EXEC.
 14677     MOVE LENGTH OF
 14678      PENDING-BUSINESS
 14679       TO DFHEIV11
 14680*    MOVE '&$ L                  ''   #00013138' TO DFHEIV0
 14681     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14682     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14683     MOVE X'2020233030303133313338' TO DFHEIV0(25:11)
 14684     CALL 'kxdfhei1' USING DFHEIV0,
 14685           FILE-ID-ERPNDB,
 14686           PENDING-BUSINESS,
 14687           DFHEIV11,
 14688           PB-CONTROL-PRIMARY,
 14689           DFHEIV99,
 14690           DFHEIV99
 14691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14692
 14693
 14694     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14695
 14696     PERFORM 8400-LOG-JOURNAL-RECORD.
 14697
 14698******************************************************************
 14699*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14700******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 267
* VP6311.cbl
 14701
 14702     display ' made it to add orig CANCEL cert '
 14703     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14704     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14705     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14706     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14707
 14708
 14709* EXEC CICS READ
 14710*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14711*        DATASET (FILE-ID-ELCERT)
 14712*        RIDFLD  (ELCERT-KEY)
 14713*        RESP    (WS-RESPONSE)
 14714*    END-EXEC.
 14715*    MOVE '&"S        E          (  N#00013158' TO DFHEIV0
 14716     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14718     MOVE X'204E233030303133313538' TO DFHEIV0(25:11)
 14719     CALL 'kxdfhei1' USING DFHEIV0,
 14720           FILE-ID-ELCERT,
 14721           DFHEIV20,
 14722           DFHEIV99,
 14723           ELCERT-KEY,
 14724           DFHEIV99,
 14725           DFHEIV99,
 14726           DFHEIV99
 14727     SET ADDRESS OF CERTIFICATE-MASTER TO
 14728         DFHEIV20
 14729     MOVE EIBRESP  TO WS-RESPONSE
 14730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14731
 14732
 14733     IF NOT RESP-NORMAL
 14734        GO TO 2276-BYPASS-CRTO
 14735     END-IF
 14736
 14737     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14738     MOVE ' '                    TO WS-ERMAIL-SW
 14739
 14740
 14741* EXEC CICS READ
 14742*       DATASET   (FILE-ID-ERMAIL)
 14743*       SET       (ADDRESS OF MAILING-DATA)
 14744*       RIDFLD    (ERMAIL-KEY)
 14745*       RESP      (WS-RESPONSE)
 14746*    END-EXEC
 14747*    MOVE '&"S        E          (  N#00013172' TO DFHEIV0
 14748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14750     MOVE X'204E233030303133313732' TO DFHEIV0(25:11)
 14751     CALL 'kxdfhei1' USING DFHEIV0,
 14752           FILE-ID-ERMAIL,
 14753           DFHEIV20,
 14754           DFHEIV99,
 14755           ERMAIL-KEY,
 14756           DFHEIV99,
 14757           DFHEIV99,
 14758           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 268
* VP6311.cbl
 14759     SET ADDRESS OF MAILING-DATA TO
 14760         DFHEIV20
 14761     MOVE EIBRESP  TO WS-RESPONSE
 14762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14763
 14764     IF RESP-NORMAL
 14765        SET ERMAIL-FOUND TO TRUE
 14766     END-IF
 14767
 14768     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14769
 14770     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14771     MOVE 'OC'                   TO OC-RECORD-ID
 14772     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14773                                 TO OC-CONTROL-PRIMARY (1:33)
 14774     MOVE 'I'                    TO OC-RECORD-TYPE
 14775     MOVE +4096                  TO OC-KEY-SEQ-NO
 14776     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14777     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14778     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14779
 14780     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14781     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14782     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14783     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14784     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14785     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14786     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14787     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14788     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14789     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14790     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14791     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14792     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14793     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14794     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14795     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14796     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14797     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14798     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14799     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14800     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14801     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14802     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14803     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14804     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14805     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14806     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14807     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14808     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14809     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14810     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14811     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14812
 14813     IF ERMAIL-FOUND
 14814        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14815     END-IF
 14816     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 269
* VP6311.cbl
 14817        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14818                           OC-INS-AGE-DEFAULT-FLAG
 14819        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14820                           OC-JNT-AGE-DEFAULT-FLAG
 14821     END-IF
 14822     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14823     .
 14824 2275-WRITE-ELCRTO.
 14825
 14826
 14827* EXEC CICS WRITE
 14828*       DATASET   ('ELCRTO')
 14829*       FROM      (ORIGINAL-CERTIFICATE)
 14830*       RIDFLD    (OC-CONTROL-PRIMARY)
 14831*       RESP      (WS-RESPONSE)
 14832*    END-EXEC
 14833     MOVE LENGTH OF
 14834      ORIGINAL-CERTIFICATE
 14835       TO DFHEIV11
 14836     MOVE 'ELCRTO' TO DFHEIV1
 14837*    MOVE '&$ L                  ''  N#00013241' TO DFHEIV0
 14838     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14839     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14840     MOVE X'204E233030303133323431' TO DFHEIV0(25:11)
 14841     CALL 'kxdfhei1' USING DFHEIV0,
 14842           DFHEIV1,
 14843           ORIGINAL-CERTIFICATE,
 14844           DFHEIV11,
 14845           OC-CONTROL-PRIMARY,
 14846           DFHEIV99,
 14847           DFHEIV99
 14848     MOVE EIBRESP  TO WS-RESPONSE
 14849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14850
 14851     display ' just wrote 2275 ' ws-response
 14852     IF RESP-DUPKEY
 14853        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14854        GO TO 2275-WRITE-ELCRTO
 14855     ELSE
 14856        IF NOT RESP-NORMAL
 14857           MOVE -1               TO BMAINTL
 14858           MOVE ER-7450          TO EMI-ERROR
 14859           PERFORM 9900-ERROR-FORMAT
 14860                                 THRU 9900-EXIT
 14861           GO TO 8200-SEND-DATAONLY
 14862        END-IF
 14863     END-IF.
 14864
 14865 2276-BYPASS-CRTO.
 14866******************************************************************
 14867*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14868******************************************************************
 14869
 14870
 14871* EXEC CICS READ
 14872*        INTO    (PENDING-BUSINESS)
 14873*        DATASET (FILE-ID-ERPNDB)
 14874*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 270
* VP6311.cbl
 14875*        UPDATE
 14876*    END-EXEC.
 14877     MOVE LENGTH OF
 14878      PENDING-BUSINESS
 14879       TO DFHEIV11
 14880*    MOVE '&"IL       EU         (   #00013267' TO DFHEIV0
 14881     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14882     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14883     MOVE X'2020233030303133323637' TO DFHEIV0(25:11)
 14884     CALL 'kxdfhei1' USING DFHEIV0,
 14885           FILE-ID-ERPNDB,
 14886           PENDING-BUSINESS,
 14887           DFHEIV11,
 14888           ERPNDB-KEY,
 14889           DFHEIV99,
 14890           DFHEIV99,
 14891           DFHEIV99
 14892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14893
 14894
 14895     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14896     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14897     MOVE 'B'                    TO JP-RECORD-TYPE.
 14898     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14899
 14900     PERFORM 8400-LOG-JOURNAL-RECORD.
 14901
 14902     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14903
 14904
 14905* EXEC CICS REWRITE
 14906*        DATASET (FILE-ID-ERPNDB)
 14907*        FROM    (PENDING-BUSINESS)
 14908*    END-EXEC.
 14909     MOVE LENGTH OF
 14910      PENDING-BUSINESS
 14911       TO DFHEIV11
 14912*    MOVE '&& L                  %   #00013283' TO DFHEIV0
 14913     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14914     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14915     MOVE X'2020233030303133323833' TO DFHEIV0(25:11)
 14916     CALL 'kxdfhei1' USING DFHEIV0,
 14917           FILE-ID-ERPNDB,
 14918           PENDING-BUSINESS,
 14919           DFHEIV11,
 14920           DFHEIV99
 14921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14922
 14923
 14924     MOVE 'C'                    TO JP-RECORD-TYPE.
 14925     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14926
 14927     PERFORM 8400-LOG-JOURNAL-RECORD.
 14928
 14929     IF WS-ERRORS-PRESENT
 14930        GO TO 3900-RE-DISPLAY-RECORD.
 14931
 14932     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 271
* VP6311.cbl
 14933     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14934     MOVE LOW-VALUES             TO VP631CI.
 14935     MOVE  -1                    TO CMAINTL.
 14936     GO TO 8100-SEND-INITIAL-MAP.
 14937
 14938 2280-BATCH-HDR-NOT-FOUND.
 14939     MOVE -1                     TO BMAINTL.
 14940     MOVE ER-7450                TO EMI-ERROR.
 14941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14942     GO TO 8200-SEND-DATAONLY.
 14943
 14944 2290-DUPLICATE-ALT-INDEX.
 14945
 14946******************************************************************
 14947*                                                                *
 14948*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14949*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14950*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14951*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14952*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14953*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14954*                                                                *
 14955******************************************************************
 14956
 14957     IF LCP-ONCTR-02 =  0
 14958         ADD 1 TO LCP-ONCTR-02
 14959        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14960
 14961     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14962
 14963     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14964         NEXT SENTENCE
 14965     ELSE
 14966         ADD +1 TO PB-BATCH-SEQ-NO
 14967                   PB-CSR-BATCH-SEQ-NO
 14968         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14969         GO TO 2275-WRITE-PENDING-BUSINESS.
 14970
 14971     MOVE -1                     TO CCERTNOL.
 14972     MOVE AL-UABON               TO CCERTNOA.
 14973     MOVE AL-UNBON               TO CEFFDTA.
 14974
 14975     MOVE 1                      TO EMI-SUB
 14976                                    EMI-SWITCH1
 14977                                    EMI-SWITCH-AREA-1
 14978                                    EMI-SWITCH-AREA-2.
 14979
 14980     MOVE SPACES                 TO EMI-ERROR-LINES.
 14981
 14982
 14983* EXEC CICS SYNCPOINT ROLLBACK
 14984*    END-EXEC.
 14985*    MOVE '6"R                   !   #00013346' TO DFHEIV0
 14986     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14987     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14988     MOVE X'2020233030303133333436' TO DFHEIV0(25:11)
 14989     CALL 'kxdfhei1' USING DFHEIV0
 14990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 272
* VP6311.cbl
 14991
 14992
 14993     MOVE ER-2247                TO EMI-ERROR.
 14994     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14995     GO TO 8200-SEND-DATAONLY.
 14996
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 273
* VP6311.cbl
 14998
 14999******************************************************************
 15000*                                                                *
 15001*          C H A N G E   C A N C E L   R O U T I N E             *
 15002*                                                                *
 15003******************************************************************
 15004
 15005***************************************************************
 15006*                                                             *
 15007*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15008*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15009*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15010*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15011*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15012*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15013*     5. LINK TO THE EDIT ROUTINE.                            *
 15014*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15015*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15016*              THE EDIT ROUTINE.                              *
 15017*     7. REWRITE THE NEW ISSUE                                *
 15018*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15019*                                                             *
 15020***************************************************************
 15021 2300-CHANGE-CANCEL-ROUTINE.
 15022     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15023
 15024     IF CCHGL NOT = ZEROS
 15025        MOVE ER-2196             TO EMI-ERROR
 15026        MOVE AL-UABON            TO CMAINTA
 15027        MOVE -1                  TO CMAINTL
 15028        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15029        GO TO 8200-SEND-DATAONLY.
 15030
 15031     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15032
 15033     IF CSUFIXL NOT = ZEROS
 15034        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15035     ELSE
 15036        MOVE SPACE               TO WS-NEW-SUFFIX.
 15037
 15038     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15039     PERFORM 8600-DEEDIT.
 15040     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15041     MOVE '4'                    TO DC-OPTION-CODE.
 15042
 15043     PERFORM 9700-DATE-LINK.
 15044
 15045     IF DATE-CONVERSION-ERROR
 15046        MOVE ER-0348             TO EMI-ERROR
 15047        MOVE -1                  TO CEFFDTL
 15048        MOVE AL-UABON            TO CEFFDTA
 15049        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15050        GO TO 8200-SEND-DATAONLY
 15051     ELSE
 15052        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15053        MOVE AL-UANON            TO CEFFDTA
 15054        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15055
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 274
* VP6311.cbl
 15056 2325-PROCESS-CANCEL-CHANGES.
 15057
 15058* EXEC CICS HANDLE CONDITION
 15059*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15060*    END-EXEC.
 15061*    MOVE '"$I                   ! 5 #00013413' TO DFHEIV0
 15062     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15063     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15064     MOVE X'3520233030303133343133' TO DFHEIV0(25:11)
 15065     CALL 'kxdfhei1' USING DFHEIV0
 15066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15067
 15068
 15069     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15070     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15071     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15072
 15073
 15074* EXEC CICS GETMAIN
 15075*        SET      (ADDRESS OF PENDING-BUSINESS)
 15076*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15077*        INITIMG  (GETMAIN-SPACE)
 15078*     END-EXEC.
 15079*    MOVE ',"IL                  $   #00013421' TO DFHEIV0
 15080     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15081     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15082     MOVE X'2020233030303133343231' TO DFHEIV0(25:11)
 15083     CALL 'kxdfhei1' USING DFHEIV0,
 15084           DFHEIV20,
 15085           ERPNDB-RECORD-LENGTH,
 15086           GETMAIN-SPACE
 15087     SET ADDRESS OF PENDING-BUSINESS TO
 15088         DFHEIV20
 15089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15090
 15091
 15092
 15093* EXEC CICS READ
 15094*        INTO    (PENDING-BUSINESS)
 15095*        DATASET (FILE-ID-ERPNDB)
 15096*        RIDFLD  (ERPNDB-KEY)
 15097*    END-EXEC.
 15098     MOVE LENGTH OF
 15099      PENDING-BUSINESS
 15100       TO DFHEIV11
 15101*    MOVE '&"IL       E          (   #00013427' TO DFHEIV0
 15102     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15103     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15104     MOVE X'2020233030303133343237' TO DFHEIV0(25:11)
 15105     CALL 'kxdfhei1' USING DFHEIV0,
 15106           FILE-ID-ERPNDB,
 15107           PENDING-BUSINESS,
 15108           DFHEIV11,
 15109           ERPNDB-KEY,
 15110           DFHEIV99,
 15111           DFHEIV99,
 15112           DFHEIV99
 15113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 275
* VP6311.cbl
 15114
 15115
 15116     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15117
 15118
 15119* EXEC CICS HANDLE CONDITION
 15120*         NOTFND     (2385-REC-NOT-FOUND)
 15121*    END-EXEC.
 15122*    MOVE '"$I                   ! 6 #00013435' TO DFHEIV0
 15123     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15125     MOVE X'3620233030303133343335' TO DFHEIV0(25:11)
 15126     CALL 'kxdfhei1' USING DFHEIV0
 15127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15128
 15129
 15130**********************************************************
 15131*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15132*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15133**********************************************************
 15134
 15135
 15136* EXEC CICS READ
 15137*        DATASET (FILE-ID-ERPNDB)
 15138*        INTO    (PENDING-BUSINESS)
 15139*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15140*    END-EXEC.
 15141     MOVE LENGTH OF
 15142      PENDING-BUSINESS
 15143       TO DFHEIV11
 15144*    MOVE '&"IL       E          (   #00013444' TO DFHEIV0
 15145     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15147     MOVE X'2020233030303133343434' TO DFHEIV0(25:11)
 15148     CALL 'kxdfhei1' USING DFHEIV0,
 15149           FILE-ID-ERPNDB,
 15150           PENDING-BUSINESS,
 15151           DFHEIV11,
 15152           PI-PREV-CONTROL-PRIMARY,
 15153           DFHEIV99,
 15154           DFHEIV99,
 15155           DFHEIV99
 15156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15157
 15158
 15159********** DO NOT ALLOW CHANGES IF THRU A/R
 15160     IF BMAINTI = 'C'
 15161         IF PB-EL860-INTERNAL-PROCESS
 15162             MOVE ER-4005          TO EMI-ERROR
 15163             MOVE -1               TO BMAINTL
 15164             MOVE AL-UABON         TO BMAINTA
 15165             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15166             GO TO 8200-SEND-DATAONLY.
 15167**********
 15168
 15169     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15170        MOVE -1                 TO CMAINTL
 15171        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 276
* VP6311.cbl
 15172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15173        GO TO 8200-SEND-DATAONLY.
 15174
 15175     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15176        MOVE ER-2196             TO EMI-ERROR
 15177        MOVE AL-UABON            TO CMAINTA
 15178        MOVE -1                  TO CMAINTL
 15179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15180        GO TO 8200-SEND-DATAONLY.
 15181     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15182
 15183     IF PB-BILLED-DT = LOW-VALUES AND
 15184        PB-CHG-COUNT = ZEROS
 15185        NEXT SENTENCE
 15186     ELSE
 15187        IF (CREFND1L GREATER THAN ZEROS AND
 15188            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15189           OR
 15190           (CREFND2L GREATER THAN ZEROS AND
 15191            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15192           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15193     if ((crefnd1l <> zeros)
 15194        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15195                      or
 15196        ((crefnd2l <> zeros)
 15197        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15198        continue
 15199     else
 15200        go to 2330-continue-change
 15201     end-if
 15202
 15203     move zeros                  to ws-check-amts
 15204     move ' '                    to ws-stop-sw
 15205                                    ws-check-sw
 15206                                    ws-proc-check-sw
 15207                                    ws-chek-browse-sw
 15208
 15209     perform 2500-browse-checks  thru 2500-exit
 15210
 15211     if i-have-processed-checks
 15212        or i-have-checks
 15213        continue
 15214     else
 15215        go to 2330-continue-change
 15216     end-if
 15217
 15218     if crefnd1l <> zeros
 15219        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15220        move ws-crefnd1 to ws-new-ref-total
 15221     else
 15222        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15223     end-if
 15224     if crefnd2l <> zeros
 15225        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15226        compute ws-new-ref-total = ws-new-ref-total +
 15227           ws-crefnd2
 15228     else
 15229        compute ws-new-ref-total = ws-new-ref-total +
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 277
* VP6311.cbl
 15230           pb-c-ah-cancel-amt
 15231     end-if
 15232
 15233     if zeros = (ws-lf-diff + ws-ah-diff)
 15234        move er-3449             to emi-error
 15235        perform 9900-error-format thru 9900-exit
 15236        go to 2330-continue-change
 15237     end-if
 15238
 15239     if (ws-new-ref-total < ws-check-amts)
 15240        and (pb-c-refund-sw = 'Y')
 15241        move er-3447             to emi-error
 15242        perform 9900-error-format thru 9900-exit
 15243        move al-uabon            to cmainta
 15244        move -1                  to cmaintl
 15245        go to 8200-send-dataonly
 15246     end-if
 15247
 15248     if (ws-new-ref-total > ws-check-amts)
 15249        and (ws-check-amts not = zeros)
 15250        move er-3448             to emi-error
 15251        move al-uabon            to crefnd1a
 15252                                    crefnd2a
 15253        perform 9900-error-format thru 9900-exit
 15254     end-if
 15255
 15256*     if (ws-lf-diff + ws-ah-diff) < zeros
 15257*        move er-3447             to emi-error
 15258*        perform 9900-error-format thru 9900-exit
 15259*        move al-uabon            to cmainta
 15260*        move -1                  to cmaintl
 15261*        go to 8200-send-dataonly
 15262*     end-if
 15263     .
 15264 2330-continue-change.
 15265
 15266
 15267* EXEC CICS READ
 15268*        DATASET (FILE-ID-ERPNDB)
 15269*        INTO    (PENDING-BUSINESS)
 15270*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15271*        UPDATE
 15272*    END-EXEC.
 15273     MOVE LENGTH OF
 15274      PENDING-BUSINESS
 15275       TO DFHEIV11
 15276*    MOVE '&"IL       EU         (   #00013557' TO DFHEIV0
 15277     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15278     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15279     MOVE X'2020233030303133353537' TO DFHEIV0(25:11)
 15280     CALL 'kxdfhei1' USING DFHEIV0,
 15281           FILE-ID-ERPNDB,
 15282           PENDING-BUSINESS,
 15283           DFHEIV11,
 15284           PI-PREV-CONTROL-PRIMARY,
 15285           DFHEIV99,
 15286           DFHEIV99,
 15287           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 278
* VP6311.cbl
 15288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15289
 15290
 15291     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15292     MOVE 'B'                    TO JP-RECORD-TYPE
 15293     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15294     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15295
 15296     PERFORM 8400-LOG-JOURNAL-RECORD.
 15297
 15298     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15299          PB-CHG-COUNT NOT = ZEROS
 15300        IF (CREFND1L GREATER THAN ZEROS AND
 15301            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15302           OR
 15303           (CREFND2L GREATER THAN ZEROS AND
 15304            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15305            ADD +1                      TO PB-CHG-COUNT
 15306            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15307
 15308*    IF CMICRNOL  GREATER  ZEROS
 15309*        IF CMICRNOI  NUMERIC
 15310*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15311*            MOVE AL-UNNON       TO  CMICRNOA
 15312*        ELSE
 15313*            MOVE -1             TO  CMICRNOL
 15314*            MOVE AL-UNBON       TO  CMICRNOA
 15315*            MOVE ER-2701        TO  EMI-ERROR
 15316*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15317
 15318     IF CSUFIXL GREATER THAN ZEROS
 15319        MOVE CSUFIXI             TO PB-CERT-SFX.
 15320
 15321     IF CLSTNML GREATER THAN ZEROS
 15322         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15323
 15324     IF CCANREAL > ZEROS
 15325        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15326     END-IF
 15327     IF CPCYNL > ZEROS
 15328        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15329     END-IF
 15330     IF CCANDT1L    GREATER THAN ZEROS
 15331        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15332
 15333     IF CCANDT2L    GREATER THAN ZEROS
 15334        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15335
 15336     IF CMTHD1L    GREATER THAN +0
 15337        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15338
 15339     IF CMTHD2L    GREATER THAN +0
 15340        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15341
 15342     IF CREFND1L    GREATER THAN ZEROS
 15343        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15344        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15345        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 279
* VP6311.cbl
 15346        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15347
 15348     IF CREFND2L    GREATER THAN ZEROS
 15349        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15350        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15351        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15352        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15353
 15354     IF CLIVESL     GREATER THAN ZEROS
 15355        MOVE WS-CLIVES           TO PB-C-LIVES.
 15356
 15357     IF CPAYEEL     GREATER THAN ZEROS
 15358        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15359
 15360     IF CFORCEL     GREATER THAN ZEROS
 15361        MOVE CFORCEI             TO PB-FORCE-CODE.
 15362
 15363     IF CBILCDL     GREATER THAN ZEROS
 15364        MOVE CBILCDI             TO PB-RECORD-BILL.
 15365
 15366 2360-REWRITE-PB-RECORD.
 15367     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15368     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15369     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15370     MOVE 'C'                    TO JP-RECORD-TYPE.
 15371     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15372     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15373     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15374
 15375     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15376
 15377     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15378     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15379
 15380     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15381
 15382     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15383
 15384     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15385     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15386     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15387
 15388     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15389     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15390
 15391 2375-REWRITE-PENDING-BUSINESS.
 15392     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15393     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15394     MOVE 'C'                    TO JP-RECORD-TYPE.
 15395     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15396
 15397
 15398* EXEC CICS REWRITE
 15399*        DATASET (FILE-ID-ERPNDB)
 15400*        FROM    (PENDING-BUSINESS)
 15401*    END-EXEC.
 15402     MOVE LENGTH OF
 15403      PENDING-BUSINESS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 280
* VP6311.cbl
 15404       TO DFHEIV11
 15405*    MOVE '&& L                  %   #00013670' TO DFHEIV0
 15406     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15407     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15408     MOVE X'2020233030303133363730' TO DFHEIV0(25:11)
 15409     CALL 'kxdfhei1' USING DFHEIV0,
 15410           FILE-ID-ERPNDB,
 15411           PENDING-BUSINESS,
 15412           DFHEIV11,
 15413           DFHEIV99
 15414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15415
 15416
 15417     PERFORM 8400-LOG-JOURNAL-RECORD.
 15418
 15419******************************************************************
 15420*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15421******************************************************************
 15422
 15423     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15424     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15425     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15426     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15427
 15428
 15429* EXEC CICS READ
 15430*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15431*        DATASET (FILE-ID-ELCERT)
 15432*        RIDFLD  (ELCERT-KEY)
 15433*        RESP    (WS-RESPONSE)
 15434*    END-EXEC.
 15435*    MOVE '&"S        E          (  N#00013686' TO DFHEIV0
 15436     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15438     MOVE X'204E233030303133363836' TO DFHEIV0(25:11)
 15439     CALL 'kxdfhei1' USING DFHEIV0,
 15440           FILE-ID-ELCERT,
 15441           DFHEIV20,
 15442           DFHEIV99,
 15443           ELCERT-KEY,
 15444           DFHEIV99,
 15445           DFHEIV99,
 15446           DFHEIV99
 15447     SET ADDRESS OF CERTIFICATE-MASTER TO
 15448         DFHEIV20
 15449     MOVE EIBRESP  TO WS-RESPONSE
 15450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15451
 15452
 15453     IF NOT RESP-NORMAL
 15454        GO TO 2376-BYPASS-CRTO
 15455     END-IF
 15456
 15457
 15458     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15459     MOVE ' '                    TO WS-ERMAIL-SW
 15460
 15461
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 281
* VP6311.cbl
 15462* EXEC CICS READ
 15463*       DATASET   (FILE-ID-ERMAIL)
 15464*       SET       (ADDRESS OF MAILING-DATA)
 15465*       RIDFLD    (ERMAIL-KEY)
 15466*       RESP      (WS-RESPONSE)
 15467*    END-EXEC
 15468*    MOVE '&"S        E          (  N#00013701' TO DFHEIV0
 15469     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15471     MOVE X'204E233030303133373031' TO DFHEIV0(25:11)
 15472     CALL 'kxdfhei1' USING DFHEIV0,
 15473           FILE-ID-ERMAIL,
 15474           DFHEIV20,
 15475           DFHEIV99,
 15476           ERMAIL-KEY,
 15477           DFHEIV99,
 15478           DFHEIV99,
 15479           DFHEIV99
 15480     SET ADDRESS OF MAILING-DATA TO
 15481         DFHEIV20
 15482     MOVE EIBRESP  TO WS-RESPONSE
 15483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15484
 15485     IF RESP-NORMAL
 15486        SET ERMAIL-FOUND TO TRUE
 15487     END-IF
 15488
 15489     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15490
 15491     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15492                                 TO ELCRTO-KEY
 15493     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15494     MOVE +0                     TO ELCRTO-SEQ-NO
 15495
 15496
 15497* EXEC CICS READ
 15498*       DATASET   ('ELCRTO')
 15499*       INTO      (ORIGINAL-CERTIFICATE)
 15500*       RIDFLD    (ELCRTO-KEY)
 15501*       GTEQ
 15502*       RESP      (WS-RESPONSE)
 15503*    END-EXEC
 15504     MOVE LENGTH OF
 15505      ORIGINAL-CERTIFICATE
 15506       TO DFHEIV11
 15507     MOVE 'ELCRTO' TO DFHEIV1
 15508*    MOVE '&"IL       G          (  N#00013719' TO DFHEIV0
 15509     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15510     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15511     MOVE X'204E233030303133373139' TO DFHEIV0(25:11)
 15512     CALL 'kxdfhei1' USING DFHEIV0,
 15513           DFHEIV1,
 15514           ORIGINAL-CERTIFICATE,
 15515           DFHEIV11,
 15516           ELCRTO-KEY,
 15517           DFHEIV99,
 15518           DFHEIV99,
 15519           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 282
* VP6311.cbl
 15520     MOVE EIBRESP  TO WS-RESPONSE
 15521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15522
 15523     IF RESP-NORMAL
 15524        AND (OC-CONTROL-PRIMARY (1:33) =
 15525                 PB-CONTROL-BY-ACCOUNT (1:33))
 15526        AND (OC-RECORD-TYPE = 'I')
 15527        display ' resp norm, key =, type i '
 15528        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15529           display ' end proc blank '
 15530           display ' csr edit session ' PI-CSR-SESSION-SW
 15531           IF NOT CSR-EDIT-SESSION
 15532
 15533* EXEC CICS READ
 15534*                DATASET   ('ELCRTO')
 15535*                INTO      (ORIGINAL-CERTIFICATE)
 15536*                RIDFLD    (OC-CONTROL-PRIMARY)
 15537*                UPDATE
 15538*                RESP      (WS-RESPONSE)
 15539*             END-EXEC
 15540     MOVE LENGTH OF
 15541      ORIGINAL-CERTIFICATE
 15542       TO DFHEIV11
 15543     MOVE 'ELCRTO' TO DFHEIV1
 15544*    MOVE '&"IL       EU         (  N#00013736' TO DFHEIV0
 15545     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15546     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15547     MOVE X'204E233030303133373336' TO DFHEIV0(25:11)
 15548     CALL 'kxdfhei1' USING DFHEIV0,
 15549           DFHEIV1,
 15550           ORIGINAL-CERTIFICATE,
 15551           DFHEIV11,
 15552           OC-CONTROL-PRIMARY,
 15553           DFHEIV99,
 15554           DFHEIV99,
 15555           DFHEIV99
 15556     MOVE EIBRESP  TO WS-RESPONSE
 15557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15558              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15559              IF RESP-NORMAL
 15560                 display ' good read upd '
 15561                 IF OC-ISSUE-TRAN-IND = 'N'
 15562                    MOVE CM-INSURED-LAST-NAME   TO
 15563                         OC-INS-LAST-NAME
 15564                    MOVE CM-INSURED-FIRST-NAME  TO
 15565                         OC-INS-FIRST-NAME
 15566                    MOVE CM-INSURED-INITIAL2    TO
 15567                         OC-INS-MIDDLE-INIT
 15568                    MOVE CM-INSURED-ISSUE-AGE   TO
 15569                         OC-INS-AGE
 15570                    MOVE CM-JT-LAST-NAME        TO
 15571                         OC-JNT-LAST-NAME
 15572                    MOVE CM-JT-FIRST-NAME       TO
 15573                         OC-JNT-FIRST-NAME
 15574                    MOVE CM-JT-INITIAL          TO
 15575                         OC-JNT-MIDDLE-INIT
 15576                    MOVE CM-INSURED-JOINT-AGE   TO
 15577                         OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 283
* VP6311.cbl
 15578                    MOVE CM-LF-BENEFIT-CD       TO
 15579                         OC-LF-BENCD
 15580                    MOVE CM-LF-ORIG-TERM        TO
 15581                         OC-LF-TERM
 15582                    MOVE CM-LF-BENEFIT-AMT      TO
 15583                         OC-LF-BEN-AMT
 15584                    MOVE CM-LF-PREMIUM-AMT      TO
 15585                         OC-LF-PRM-AMT
 15586                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15587                         OC-LF-ALT-BEN-AMT
 15588                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15589                         OC-LF-ALT-PRM-AMT
 15590                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15591                         OC-LF-EXP-DT
 15592                    MOVE CM-LIFE-COMM-PCT       TO
 15593                         OC-LF-COMM-PCT
 15594                    MOVE CM-AH-BENEFIT-CD       TO
 15595                         OC-AH-BENCD
 15596                    MOVE CM-AH-ORIG-TERM        TO
 15597                         OC-AH-TERM
 15598                    MOVE CM-AH-BENEFIT-AMT      TO
 15599                         OC-AH-BEN-AMT
 15600                    MOVE CM-AH-PREMIUM-AMT      TO
 15601                         OC-AH-PRM-AMT
 15602                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15603                         OC-AH-EXP-DT
 15604                    MOVE CM-AH-COMM-PCT         TO
 15605                         OC-AH-COMM-PCT
 15606                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15607                         OC-AH-CP
 15608                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15609                         OC-1ST-PMT-DT
 15610                 END-IF
 15611                 MOVE PB-C-LF-CANCEL-DT      TO
 15612                         OC-LF-CANCEL-DT
 15613                 MOVE PB-C-LF-CANCEL-AMT     TO
 15614                         OC-LF-CANCEL-AMT
 15615                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15616                         OC-LF-ITD-CANCEL-AMT
 15617                 MOVE PB-C-AH-CANCEL-DT      TO
 15618                         OC-AH-CANCEL-DT
 15619                 MOVE PB-C-AH-CANCEL-AMT     TO
 15620                         OC-AH-CANCEL-AMT
 15621                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15622                         OC-AH-ITD-CANCEL-AMT
 15623                 MOVE 'Y'                    TO
 15624                         OC-CANCEL-TRAN-IND
 15625                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15626                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15627                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15628                 IF ERMAIL-FOUND
 15629                    MOVE MA-CRED-BENE-NAME
 15630                                 TO OC-CRED-BENE-NAME
 15631                 END-IF
 15632                 IF NOT CERT-TRL-REC-NOT-FOUND
 15633                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15634                           OC-INS-AGE-DEFAULT-FLAG
 15635                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 284
* VP6311.cbl
 15636                           OC-JNT-AGE-DEFAULT-FLAG
 15637                 END-IF
 15638
 15639* EXEC CICS REWRITE
 15640*                   DATASET   ('ELCRTO')
 15641*                   FROM      (ORIGINAL-CERTIFICATE)
 15642*                   RESP      (WS-RESPONSE)
 15643*                END-EXEC
 15644     MOVE LENGTH OF
 15645      ORIGINAL-CERTIFICATE
 15646       TO DFHEIV11
 15647     MOVE 'ELCRTO' TO DFHEIV1
 15648*    MOVE '&& L                  %  N#00013823' TO DFHEIV0
 15649     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15650     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15651     MOVE X'204E233030303133383233' TO DFHEIV0(25:11)
 15652     CALL 'kxdfhei1' USING DFHEIV0,
 15653           DFHEIV1,
 15654           ORIGINAL-CERTIFICATE,
 15655           DFHEIV11,
 15656           DFHEIV99
 15657     MOVE EIBRESP  TO WS-RESPONSE
 15658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15659                 display ' just rewrote ' ws-response
 15660              END-IF
 15661           END-IF
 15662        ELSE
 15663           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15664           MOVE 'OC'             TO OC-RECORD-ID
 15665           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15666           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15667           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15668           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15669           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15670           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15671           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15672           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15673           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15674           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15675           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15676           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15677           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15678           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15679           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15680           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15681           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15682           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15683           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15684           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15685           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15686           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15687           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15688           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15689           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15690           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15691           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15692           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15693           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 285
* VP6311.cbl
 15694           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15695           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15696           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15697           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15698           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15699           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15700           IF ERMAIL-FOUND
 15701              MOVE MA-CRED-BENE-NAME
 15702                                 TO OC-CRED-BENE-NAME
 15703           END-IF
 15704           IF NOT CERT-TRL-REC-NOT-FOUND
 15705              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15706                           OC-INS-AGE-DEFAULT-FLAG
 15707              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15708                           OC-JNT-AGE-DEFAULT-FLAG
 15709           END-IF
 15710           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15711
 15712* EXEC CICS WRITE
 15713*             DATASET   ('ELCRTO')
 15714*             FROM      (ORIGINAL-CERTIFICATE)
 15715*             RIDFLD    (OC-CONTROL-PRIMARY)
 15716*             RESP      (WS-RESPONSE)
 15717*          END-EXEC
 15718     MOVE LENGTH OF
 15719      ORIGINAL-CERTIFICATE
 15720       TO DFHEIV11
 15721     MOVE 'ELCRTO' TO DFHEIV1
 15722*    MOVE '&$ L                  ''  N#00013880' TO DFHEIV0
 15723     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15724     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15725     MOVE X'204E233030303133383830' TO DFHEIV0(25:11)
 15726     CALL 'kxdfhei1' USING DFHEIV0,
 15727           DFHEIV1,
 15728           ORIGINAL-CERTIFICATE,
 15729           DFHEIV11,
 15730           OC-CONTROL-PRIMARY,
 15731           DFHEIV99,
 15732           DFHEIV99
 15733     MOVE EIBRESP  TO WS-RESPONSE
 15734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15735        END-IF
 15736     ELSE
 15737        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15738        MOVE 'OC'                TO OC-RECORD-ID
 15739        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15740                                 TO OC-CONTROL-PRIMARY (1:33)
 15741        MOVE 'I'                 TO OC-RECORD-TYPE
 15742        MOVE +4096               TO OC-KEY-SEQ-NO
 15743        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15744        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15745        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15746        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15747        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15748        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15749        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15750        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15751        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 286
* VP6311.cbl
 15752        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15753        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15754        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15755        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15756        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15757        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15758        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15759        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15760        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15761        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15762        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15763        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15764        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15765        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15766        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15767        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15768        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15769        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15770        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15771        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15772        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15773        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15774        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15775        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15776        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15777        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15778        IF ERMAIL-FOUND
 15779           MOVE MA-CRED-BENE-NAME
 15780                                 TO OC-CRED-BENE-NAME
 15781        END-IF
 15782        IF NOT CERT-TRL-REC-NOT-FOUND
 15783           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15784                           OC-INS-AGE-DEFAULT-FLAG
 15785           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15786                           OC-JNT-AGE-DEFAULT-FLAG
 15787        END-IF
 15788        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15789
 15790
 15791* EXEC CICS WRITE
 15792*          DATASET   ('ELCRTO')
 15793*          FROM      (ORIGINAL-CERTIFICATE)
 15794*          RIDFLD    (OC-CONTROL-PRIMARY)
 15795*          RESP      (WS-RESPONSE)
 15796*       END-EXEC
 15797     MOVE LENGTH OF
 15798      ORIGINAL-CERTIFICATE
 15799       TO DFHEIV11
 15800     MOVE 'ELCRTO' TO DFHEIV1
 15801*    MOVE '&$ L                  ''  N#00013941' TO DFHEIV0
 15802     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15803     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15804     MOVE X'204E233030303133393431' TO DFHEIV0(25:11)
 15805     CALL 'kxdfhei1' USING DFHEIV0,
 15806           DFHEIV1,
 15807           ORIGINAL-CERTIFICATE,
 15808           DFHEIV11,
 15809           OC-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 287
* VP6311.cbl
 15810           DFHEIV99,
 15811           DFHEIV99
 15812     MOVE EIBRESP  TO WS-RESPONSE
 15813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15814     END-IF.
 15815
 15816 2376-BYPASS-CRTO.
 15817******************************************************************
 15818*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15819******************************************************************
 15820
 15821
 15822* EXEC CICS HANDLE CONDITION
 15823*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15824*    END-EXEC.
 15825*    MOVE '"$I                   ! 7 #00013954' TO DFHEIV0
 15826     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15828     MOVE X'3720233030303133393534' TO DFHEIV0(25:11)
 15829     CALL 'kxdfhei1' USING DFHEIV0
 15830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15831
 15832
 15833
 15834* EXEC CICS READ
 15835*        INTO    (PENDING-BUSINESS)
 15836*        DATASET (FILE-ID-ERPNDB)
 15837*        RIDFLD  (ERPNDB-KEY)
 15838*        UPDATE
 15839*    END-EXEC.
 15840     MOVE LENGTH OF
 15841      PENDING-BUSINESS
 15842       TO DFHEIV11
 15843*    MOVE '&"IL       EU         (   #00013958' TO DFHEIV0
 15844     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15845     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15846     MOVE X'2020233030303133393538' TO DFHEIV0(25:11)
 15847     CALL 'kxdfhei1' USING DFHEIV0,
 15848           FILE-ID-ERPNDB,
 15849           PENDING-BUSINESS,
 15850           DFHEIV11,
 15851           ERPNDB-KEY,
 15852           DFHEIV99,
 15853           DFHEIV99,
 15854           DFHEIV99
 15855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15856
 15857
 15858     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15859     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15860     MOVE 'B'                    TO JP-RECORD-TYPE.
 15861     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15862
 15863     PERFORM 8400-LOG-JOURNAL-RECORD.
 15864
 15865     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15866
 15867
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 288
* VP6311.cbl
 15868* EXEC CICS REWRITE
 15869*        DATASET (FILE-ID-ERPNDB)
 15870*        FROM    (PENDING-BUSINESS)
 15871*    END-EXEC.
 15872     MOVE LENGTH OF
 15873      PENDING-BUSINESS
 15874       TO DFHEIV11
 15875*    MOVE '&& L                  %   #00013974' TO DFHEIV0
 15876     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15877     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15878     MOVE X'2020233030303133393734' TO DFHEIV0(25:11)
 15879     CALL 'kxdfhei1' USING DFHEIV0,
 15880           FILE-ID-ERPNDB,
 15881           PENDING-BUSINESS,
 15882           DFHEIV11,
 15883           DFHEIV99
 15884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15885
 15886
 15887     MOVE 'C'                    TO JP-RECORD-TYPE.
 15888     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15889
 15890     PERFORM 8400-LOG-JOURNAL-RECORD.
 15891
 15892     IF WS-ERRORS-PRESENT
 15893         GO TO 3900-RE-DISPLAY-RECORD.
 15894
 15895     MOVE ZEROS                  TO EMI-ERROR
 15896     MOVE -1                     TO CMAINTL
 15897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15898     GO TO 3900-RE-DISPLAY-RECORD.
 15899
 15900 2380-BATCH-HDR-NOT-FOUND.
 15901     MOVE -1                     TO BMAINTL.
 15902     MOVE ER-7450                TO EMI-ERROR.
 15903     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15904     GO TO 8200-SEND-DATAONLY.
 15905
 15906 2385-REC-NOT-FOUND.
 15907     MOVE -1                     TO BMAINTL.
 15908     MOVE ER-7451                TO EMI-ERROR.
 15909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15910     GO TO 8200-SEND-DATAONLY.
 15911
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 289
* VP6311.cbl
 15913
 15914******************************************************************
 15915*                                                                *
 15916*          D E L E T E   C A N C E L   R O U T I N E             *
 15917*                                                                *
 15918******************************************************************
 15919
 15920 2400-DELETE-CANCEL-ROUTINE.
 15921     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15922
 15923     IF CCHGL NOT = ZEROS
 15924        MOVE ER-2196             TO EMI-ERROR
 15925        MOVE AL-UABON            TO CMAINTA
 15926        MOVE -1                  TO CMAINTL
 15927        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15928        GO TO 8200-SEND-DATAONLY.
 15929
 15930
 15931* EXEC CICS HANDLE CONDITION
 15932*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15933*    END-EXEC.
 15934*    MOVE '"$I                   ! 8 #00014022' TO DFHEIV0
 15935     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15937     MOVE X'3820233030303134303232' TO DFHEIV0(25:11)
 15938     CALL 'kxdfhei1' USING DFHEIV0
 15939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15940
 15941
 15942     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15943     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15944     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15945
 15946
 15947* EXEC CICS READ
 15948*        SET     (ADDRESS OF PENDING-BUSINESS)
 15949*        DATASET (FILE-ID-ERPNDB)
 15950*        RIDFLD  (ERPNDB-KEY)
 15951*    END-EXEC.
 15952*    MOVE '&"S        E          (   #00014030' TO DFHEIV0
 15953     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15955     MOVE X'2020233030303134303330' TO DFHEIV0(25:11)
 15956     CALL 'kxdfhei1' USING DFHEIV0,
 15957           FILE-ID-ERPNDB,
 15958           DFHEIV20,
 15959           DFHEIV99,
 15960           ERPNDB-KEY,
 15961           DFHEIV99,
 15962           DFHEIV99,
 15963           DFHEIV99
 15964     SET ADDRESS OF PENDING-BUSINESS TO
 15965         DFHEIV20
 15966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15967
 15968
 15969     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15970
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 290
* VP6311.cbl
 15971     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15972
 15973     IF CSUFIXL NOT = ZEROS
 15974        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15975     ELSE
 15976        MOVE SPACE               TO WS-NEW-SUFFIX.
 15977
 15978     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15979
 15980     PERFORM 8600-DEEDIT.
 15981     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15982     MOVE '4'                    TO DC-OPTION-CODE.
 15983     PERFORM 9700-DATE-LINK.
 15984
 15985     IF DATE-CONVERSION-ERROR
 15986        MOVE ER-0348             TO EMI-ERROR
 15987        MOVE -1                  TO CEFFDTL
 15988        MOVE AL-UABON            TO CEFFDTA
 15989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15990        GO TO 8200-SEND-DATAONLY
 15991     ELSE
 15992        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15993        MOVE AL-UANON            TO CEFFDTA
 15994        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15995
 15996
 15997* EXEC CICS HANDLE CONDITION
 15998*         NOTFND    (2490-RECORD-NOT-FOUND)
 15999*    END-EXEC.
 16000*    MOVE '"$I                   ! 9 #00014063' TO DFHEIV0
 16001     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16002     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16003     MOVE X'3920233030303134303633' TO DFHEIV0(25:11)
 16004     CALL 'kxdfhei1' USING DFHEIV0
 16005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16006
 16007
 16008
 16009* EXEC CICS READ
 16010*        SET     (ADDRESS OF PENDING-BUSINESS)
 16011*        DATASET (FILE-ID-ERPNDB)
 16012*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16013*        UPDATE
 16014*    END-EXEC.
 16015*    MOVE '&"S        EU         (   #00014067' TO DFHEIV0
 16016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16017     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16018     MOVE X'2020233030303134303637' TO DFHEIV0(25:11)
 16019     CALL 'kxdfhei1' USING DFHEIV0,
 16020           FILE-ID-ERPNDB,
 16021           DFHEIV20,
 16022           DFHEIV99,
 16023           PI-PREV-CONTROL-PRIMARY,
 16024           DFHEIV99,
 16025           DFHEIV99,
 16026           DFHEIV99
 16027     SET ADDRESS OF PENDING-BUSINESS TO
 16028         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 291
* VP6311.cbl
 16029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16030
 16031
 16032     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16033        MOVE -1                 TO CMAINTL
 16034        MOVE ER-2197            TO EMI-ERROR
 16035        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16036        GO TO 8200-SEND-DATAONLY.
 16037
 16038     IF PB-BILLED-DT NOT = LOW-VALUES
 16039        MOVE -1                 TO CMAINTL
 16040        MOVE ER-2129            TO EMI-ERROR
 16041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16042        GO TO 8200-SEND-DATAONLY.
 16043
 16044     IF PB-CHG-COUNT NOT = ZEROS
 16045        MOVE ER-2336            TO EMI-ERROR
 16046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16047        MOVE AL-UABON            TO CMAINTA
 16048        MOVE -1                  TO CMAINTL
 16049        GO TO 8200-SEND-DATAONLY.
 16050
 16051     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16052        PB-CHG-COUNT NOT = ZEROS
 16053        MOVE ER-2196             TO EMI-ERROR
 16054        MOVE AL-UABON            TO CMAINTA
 16055        MOVE -1                  TO CMAINTL
 16056        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16057        GO TO 8200-SEND-DATAONLY.
 16058
 16059     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16060        MOVE ER-2900 TO EMI-ERROR
 16061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16062        MOVE AL-UABON         TO CMAINTA
 16063        MOVE -1               TO CMAINTL
 16064        GO TO 8200-SEND-DATAONLY.
 16065     move ' '                    to ws-stop-sw
 16066                                    ws-check-sw
 16067                                    ws-proc-check-sw
 16068                                    ws-chek-browse-sw
 16069
 16070     perform 2500-browse-checks  thru 2500-exit
 16071     if (i-have-processed-checks)
 16072        and (pb-c-refund-sw = 'Y')
 16073        move er-3446             to emi-error
 16074        perform 9900-error-format thru 9900-exit
 16075        move al-uabon            to cmainta
 16076        move -1                  to cmaintl
 16077        go to 8200-send-dataonly
 16078     end-if
 16079
 16080* EXEC CICS HANDLE CONDITION
 16081*         NOTFND  (2475-CONTINUE-DELETE)
 16082*    END-EXEC
 16083*    MOVE '"$I                   ! : #00014121' TO DFHEIV0
 16084     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16086     MOVE X'3A20233030303134313231' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 292
* VP6311.cbl
 16087     CALL 'kxdfhei1' USING DFHEIV0
 16088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16089
 16090     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16091     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16092     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16093     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16094
 16095
 16096* EXEC CICS READ
 16097*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16098*        DATASET (FILE-ID-ELCERT)
 16099*        RIDFLD  (ELCERT-KEY)
 16100*        UPDATE
 16101*    END-EXEC.
 16102*    MOVE '&"S        EU         (   #00014130' TO DFHEIV0
 16103     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16104     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16105     MOVE X'2020233030303134313330' TO DFHEIV0(25:11)
 16106     CALL 'kxdfhei1' USING DFHEIV0,
 16107           FILE-ID-ELCERT,
 16108           DFHEIV20,
 16109           DFHEIV99,
 16110           ELCERT-KEY,
 16111           DFHEIV99,
 16112           DFHEIV99,
 16113           DFHEIV99
 16114     SET ADDRESS OF CERTIFICATE-MASTER TO
 16115         DFHEIV20
 16116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16117
 16118
 16119     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16120
 16121     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16122     MOVE 'B'                    TO JP-RECORD-TYPE.
 16123     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16124     PERFORM 8400-LOG-JOURNAL-RECORD.
 16125
 16126     IF PB-CI-LIVES NOT NUMERIC
 16127         MOVE ZERO                    TO PB-CI-LIVES.
 16128
 16129     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16130        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16131           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16132           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16133           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16134                                            CM-LF-CANCEL-DT
 16135           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16136        ELSE
 16137           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16138           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16139           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16140           MOVE PB-CI-LIVES              TO CM-LIVES.
 16141
 16142     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16143        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16144           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 293
* VP6311.cbl
 16145               MOVE CM-LF-STATUS-AT-CANCEL
 16146                                        TO CM-LF-CURRENT-STATUS
 16147               MOVE SPACE
 16148                                        TO CM-LF-STATUS-AT-CANCEL
 16149           ELSE
 16150               MOVE PB-CI-LF-POLICY-STATUS
 16151                                        TO CM-LF-CURRENT-STATUS
 16152        ELSE
 16153           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16154
 16155
 16156     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16157        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16158           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16159           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16160           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16161                                            CM-AH-CANCEL-DT
 16162           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16163        ELSE
 16164           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16165           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16166           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16167           MOVE PB-CI-LIVES              TO CM-LIVES.
 16168
 16169     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16170        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16171           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16172               MOVE CM-AH-STATUS-AT-CANCEL
 16173                                        TO CM-AH-CURRENT-STATUS
 16174               MOVE SPACE
 16175                                        TO CM-AH-STATUS-AT-CANCEL
 16176           ELSE
 16177               MOVE PB-CI-AH-POLICY-STATUS
 16178                                        TO CM-AH-CURRENT-STATUS
 16179        ELSE
 16180           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16181
 16182 2450-REWRITE-CERT.
 16183     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16184     MOVE 'C'                      TO JP-RECORD-TYPE.
 16185     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16186
 16187
 16188* EXEC CICS REWRITE
 16189*        DATASET  (FILE-ID-ELCERT)
 16190*        FROM     (CERTIFICATE-MASTER)
 16191*    END-EXEC.
 16192     MOVE LENGTH OF
 16193      CERTIFICATE-MASTER
 16194       TO DFHEIV11
 16195*    MOVE '&& L                  %   #00014205' TO DFHEIV0
 16196     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16197     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16198     MOVE X'2020233030303134323035' TO DFHEIV0(25:11)
 16199     CALL 'kxdfhei1' USING DFHEIV0,
 16200           FILE-ID-ELCERT,
 16201           CERTIFICATE-MASTER,
 16202           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 294
* VP6311.cbl
 16203           DFHEIV99
 16204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16205
 16206
 16207     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16208
 16209     PERFORM 8400-LOG-JOURNAL-RECORD.
 16210
 16211     move ' '                    to ws-stop-sw
 16212                                    ws-proc-check-sw
 16213                                    ws-chek-browse-sw
 16214
 16215     if i-have-checks
 16216        perform until i-say-stop
 16217           perform 2510-startbr-erchek
 16218                                 thru 2510-exit
 16219           if resp-normal
 16220              perform 2520-readnext-erchek
 16221                                 thru 2520-exit
 16222           end-if
 16223           if (not resp-normal)
 16224              or (pb-control-by-account (1:33) not =
 16225                 ch-control-primary (1:33))
 16226                 set i-say-stop to true
 16227           else
 16228              perform 2530-readupd-erchek
 16229                                 thru 2530-exit
 16230              if resp-normal
 16231                 perform 2540-delete-erchek
 16232                                 thru 2540-exit
 16233              end-if
 16234              if ws-chek-browse-sw = 'Y'
 16235                 perform 2525-endbr-erchek
 16236                                 thru 2525-exit
 16237                 move ' '        to ws-chek-browse-sw
 16238              end-if
 16239           end-if
 16240        end-perform
 16241     end-if
 16242
 16243     if ws-chek-browse-sw = 'Y'
 16244        perform 2525-endbr-erchek thru 2525-exit
 16245     end-if
 16246     .
 16247 2475-CONTINUE-DELETE.
 16248     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16249     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16250
 16251     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16252     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16253
 16254     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16255
 16256     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16257     MOVE 'D'                    TO JP-RECORD-TYPE
 16258     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16259
 16260
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 295
* VP6311.cbl
 16261* EXEC CICS DELETE
 16262*        DATASET    (FILE-ID-ERPNDB)
 16263*    END-EXEC.
 16264*    MOVE '&(                    &   #00014263' TO DFHEIV0
 16265     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16266     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16267     MOVE X'2020233030303134323633' TO DFHEIV0(25:11)
 16268     CALL 'kxdfhei1' USING DFHEIV0,
 16269           FILE-ID-ERPNDB,
 16270           DFHEIV99,
 16271           DFHEIV99,
 16272           DFHEIV99,
 16273           DFHEIV99
 16274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16275
 16276
 16277     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16278
 16279     PERFORM 8400-LOG-JOURNAL-RECORD.
 16280
 16281     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16282     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16283
 16284
 16285* EXEC CICS HANDLE CONDITION
 16286*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16287*    END-EXEC.
 16288*    MOVE '"$I                   ! ; #00014274' TO DFHEIV0
 16289     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16290     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16291     MOVE X'3B20233030303134323734' TO DFHEIV0(25:11)
 16292     CALL 'kxdfhei1' USING DFHEIV0
 16293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16294
 16295
 16296
 16297* EXEC CICS READ
 16298*        SET     (ADDRESS OF PENDING-BUSINESS)
 16299*        DATASET (FILE-ID-ERPNDB)
 16300*        RIDFLD  (ERPNDB-KEY)
 16301*        UPDATE
 16302*    END-EXEC.
 16303*    MOVE '&"S        EU         (   #00014278' TO DFHEIV0
 16304     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16305     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16306     MOVE X'2020233030303134323738' TO DFHEIV0(25:11)
 16307     CALL 'kxdfhei1' USING DFHEIV0,
 16308           FILE-ID-ERPNDB,
 16309           DFHEIV20,
 16310           DFHEIV99,
 16311           ERPNDB-KEY,
 16312           DFHEIV99,
 16313           DFHEIV99,
 16314           DFHEIV99
 16315     SET ADDRESS OF PENDING-BUSINESS TO
 16316         DFHEIV20
 16317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16318
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 296
* VP6311.cbl
 16319
 16320     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16321     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16322
 16323     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16324        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16325        MOVE 'D'                 TO JP-RECORD-TYPE
 16326        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16327
 16328* EXEC CICS DELETE
 16329*            DATASET    (FILE-ID-ERPNDB)
 16330*       END-EXEC
 16331*    MOVE '&(                    &   #00014292' TO DFHEIV0
 16332     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16333     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16334     MOVE X'2020233030303134323932' TO DFHEIV0(25:11)
 16335     CALL 'kxdfhei1' USING DFHEIV0,
 16336           FILE-ID-ERPNDB,
 16337           DFHEIV99,
 16338           DFHEIV99,
 16339           DFHEIV99,
 16340           DFHEIV99
 16341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16342        PERFORM 8400-LOG-JOURNAL-RECORD
 16343     ELSE
 16344        MOVE 'B'                 TO JP-RECORD-TYPE
 16345        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16346        PERFORM 8400-LOG-JOURNAL-RECORD
 16347        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16348        MOVE 'C'                 TO JP-RECORD-TYPE
 16349        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16350
 16351* EXEC CICS REWRITE
 16352*            DATASET    (FILE-ID-ERPNDB)
 16353*            FROM       (PENDING-BUSINESS)
 16354*       END-EXEC
 16355     MOVE LENGTH OF
 16356      PENDING-BUSINESS
 16357       TO DFHEIV11
 16358*    MOVE '&& L                  %   #00014303' TO DFHEIV0
 16359     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16360     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16361     MOVE X'2020233030303134333033' TO DFHEIV0(25:11)
 16362     CALL 'kxdfhei1' USING DFHEIV0,
 16363           FILE-ID-ERPNDB,
 16364           PENDING-BUSINESS,
 16365           DFHEIV11,
 16366           DFHEIV99
 16367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16368        PERFORM 8400-LOG-JOURNAL-RECORD.
 16369
 16370******************************************************************
 16371*                                                                *
 16372*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16373*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16374*                                                                *
 16375******************************************************************
 16376
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 297
* VP6311.cbl
 16377     IF NOT PI-AR-PROCESSING
 16378        GO TO 2480-DELETE-FINISHED.
 16379
 16380     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16381        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16382        NEXT SENTENCE
 16383     ELSE
 16384        GO TO 2480-DELETE-FINISHED.
 16385
 16386
 16387* EXEC CICS HANDLE CONDITION
 16388*         NOTFND    (2480-DELETE-FINISHED)
 16389*    END-EXEC.
 16390*    MOVE '"$I                   ! < #00014325' TO DFHEIV0
 16391     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16393     MOVE X'3C20233030303134333235' TO DFHEIV0(25:11)
 16394     CALL 'kxdfhei1' USING DFHEIV0
 16395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16396
 16397
 16398     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16399     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16400
 16401
 16402* EXEC CICS READ
 16403*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16404*        DATASET (FILE-ID-ERRQST)
 16405*        RIDFLD  (ERRQST-KEY)
 16406*        UPDATE
 16407*    END-EXEC.
 16408*    MOVE '&"S        EU         (   #00014332' TO DFHEIV0
 16409     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16410     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16411     MOVE X'2020233030303134333332' TO DFHEIV0(25:11)
 16412     CALL 'kxdfhei1' USING DFHEIV0,
 16413           FILE-ID-ERRQST,
 16414           DFHEIV20,
 16415           DFHEIV99,
 16416           ERRQST-KEY,
 16417           DFHEIV99,
 16418           DFHEIV99,
 16419           DFHEIV99
 16420     SET ADDRESS OF AR-REQUEST-RECORD TO
 16421         DFHEIV20
 16422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16423
 16424
 16425     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16426
 16427     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16428
 16429     MOVE 'D'                      TO JP-RECORD-TYPE.
 16430     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16431
 16432
 16433* EXEC CICS DELETE
 16434*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 298
* VP6311.cbl
 16435*    END-EXEC.
 16436*    MOVE '&(                    &   #00014346' TO DFHEIV0
 16437     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16438     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16439     MOVE X'2020233030303134333436' TO DFHEIV0(25:11)
 16440     CALL 'kxdfhei1' USING DFHEIV0,
 16441           FILE-ID-ERRQST,
 16442           DFHEIV99,
 16443           DFHEIV99,
 16444           DFHEIV99,
 16445           DFHEIV99
 16446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16447
 16448
 16449     PERFORM 8400-LOG-JOURNAL-RECORD.
 16450
 16451 2480-DELETE-FINISHED.
 16452     MOVE ZEROS                  TO EMI-ERROR.
 16453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16454     MOVE LOW-VALUES             TO VP631CI.
 16455     MOVE -1                     TO CMAINTL.
 16456     GO TO 8100-SEND-INITIAL-MAP.
 16457
 16458 2485-BATCH-HDR-NOT-FOUND.
 16459     MOVE -1                     TO CMAINTL
 16460     MOVE AL-UABON               TO CMAINTA.
 16461     MOVE ER-7450                TO EMI-ERROR.
 16462     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16463     GO TO 8200-SEND-DATAONLY.
 16464
 16465 2490-RECORD-NOT-FOUND.
 16466     MOVE -1                     TO CMAINTL
 16467     MOVE AL-UABON               TO CMAINTA.
 16468     MOVE ER-7451                TO EMI-ERROR.
 16469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16470     GO TO 8200-SEND-DATAONLY.
 16471***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16472***                                                            ***
 16473***     2500  B R O W S E   C H E C K S                        ***
 16474***  We perform this routine from 2 different places.          ***
 16475***  1. If the user changes the refund amount on a cancel, we  ***
 16476***    want to.........                                        ***
 16477***    a. determine if prior checks have been processed        ***
 16478***    b. If the amt is larger, display message instructing    ***
 16479***     them to create another check to make up the difference.***
 16480***    c. If the amt is less, do not allow the change and      ***
 16481***     display a FATAL error suggesting they deal with check  ***
 16482***     records befor continuing.                              ***
 16483***  2. If the user wants to delete a cancel record we......   ***
 16484***    a. browse through all the checks and if there is a      ***
 16485***     processed check, send FATAL message.                   ***
 16486***    b. If there is a non-released check, then delete that   ***
 16487***     check after you delete the pending cancel record.      ***
 16488***                                                            ***
 16489***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16490
 16491 2500-browse-checks.
 16492
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 299
* VP6311.cbl
 16493     perform 2510-startbr-erchek thru 2510-exit
 16494
 16495     if not resp-normal
 16496        go to 2500-exit
 16497     end-if
 16498
 16499     perform until i-say-stop
 16500        perform 2520-readnext-erchek
 16501                                 thru 2520-exit
 16502        if (not resp-normal)
 16503           or (pb-control-by-account (1:33) not =
 16504              ch-control-primary (1:33))
 16505              set i-say-stop to true
 16506        else
 16507           if (ch-approval-status) = ' '
 16508              and (ch-void-dt = low-values)
 16509              and (ch-released-dt = low-values)
 16510              set i-have-checks to true
 16511           else
 16512              if ch-void-dt = low-values
 16513                 set i-have-processed-checks to true
 16514              end-if
 16515           end-if
 16516           if (ch-credit-accept-dt = low-values)
 16517              and (ch-void-dt = low-values)
 16518              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16519              if (ch-check-origin-sw not = 'R')
 16520                 and (pb-record-type = '2')
 16521                 continue
 16522              else
 16523                 compute ws-check-amts =
 16524                    ws-check-amts + ch-amount-paid
 16525              end-if
 16526           end-if
 16527        end-if
 16528     end-perform
 16529
 16530     if ws-chek-browse-sw = 'Y'
 16531        perform 2525-endbr-erchek thru 2525-exit
 16532     end-if
 16533
 16534    .
 16535 2500-exit.
 16536     exit.
 16537
 16538 2510-startbr-erchek.
 16539
 16540     move pb-control-by-account  to erchek-key
 16541     move +0                     to chek-record-seq
 16542
 16543
 16544* exec cics startbr
 16545*       dataset   ('ERCHEK')
 16546*       ridfld    (erchek-key)
 16547*       gteq
 16548*       resp      (ws-response)
 16549*    end-exec
 16550     MOVE 'ERCHEK' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 300
* VP6311.cbl
 16551     MOVE 0
 16552       TO DFHEIV11
 16553*    MOVE '&,         G          &  N#00014444' TO DFHEIV0
 16554     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16555     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16556     MOVE X'204E233030303134343434' TO DFHEIV0(25:11)
 16557     CALL 'kxdfhei1' USING DFHEIV0,
 16558           DFHEIV1,
 16559           erchek-key,
 16560           DFHEIV99,
 16561           DFHEIV11,
 16562           DFHEIV99
 16563     MOVE EIBRESP  TO ws-response
 16564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16565
 16566     IF RESP-NORMAL
 16567        move 'Y'                 to ws-chek-browse-sw
 16568     end-if
 16569
 16570     .
 16571 2510-exit.
 16572     exit.
 16573
 16574 2520-readnext-erchek.
 16575
 16576
 16577* EXEC CICS READNEXT
 16578*       SET     (ADDRESS OF CHECK-RECORDS)
 16579*       DATASET ('ERCHEK')
 16580*       RIDFLD  (ERCHEK-KEY)
 16581*       RESP    (WS-RESPONSE)
 16582*    END-EXEC
 16583     MOVE 'ERCHEK' TO DFHEIV1
 16584     MOVE 0
 16585       TO DFHEIV11
 16586*    MOVE '&.S                   )  N#00014461' TO DFHEIV0
 16587     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16588     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16589     MOVE X'204E233030303134343631' TO DFHEIV0(25:11)
 16590     CALL 'kxdfhei1' USING DFHEIV0,
 16591           DFHEIV1,
 16592           DFHEIV20,
 16593           DFHEIV99,
 16594           ERCHEK-KEY,
 16595           DFHEIV99,
 16596           DFHEIV11,
 16597           DFHEIV99,
 16598           DFHEIV99
 16599     SET ADDRESS OF CHECK-RECORDS TO
 16600         DFHEIV20
 16601     MOVE EIBRESP  TO WS-RESPONSE
 16602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16603
 16604     .
 16605 2520-exit.
 16606     exit.
 16607
 16608 2525-endbr-erchek.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 301
* VP6311.cbl
 16609
 16610
 16611* exec cics endbr
 16612*       dataset  ('ERCHEK')
 16613*    end-exec
 16614     MOVE 'ERCHEK' TO DFHEIV1
 16615     MOVE 0
 16616       TO DFHEIV11
 16617*    MOVE '&2                    $   #00014474' TO DFHEIV0
 16618     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16619     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16620     MOVE X'2020233030303134343734' TO DFHEIV0(25:11)
 16621     CALL 'kxdfhei1' USING DFHEIV0,
 16622           DFHEIV1,
 16623           DFHEIV11,
 16624           DFHEIV99
 16625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16626
 16627     .
 16628 2525-exit.
 16629     exit.
 16630
 16631 2530-readupd-erchek.
 16632
 16633
 16634* EXEC CICS READ
 16635*       UPDATE
 16636*       SET     (ADDRESS OF CHECK-RECORDS)
 16637*       DATASET ('ERCHEK')
 16638*       RIDFLD  (ERCHEK-KEY)
 16639*       RESP    (WS-RESPONSE)
 16640*    END-EXEC
 16641     MOVE 'ERCHEK' TO DFHEIV1
 16642*    MOVE '&"S        EU         (  N#00014484' TO DFHEIV0
 16643     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16644     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16645     MOVE X'204E233030303134343834' TO DFHEIV0(25:11)
 16646     CALL 'kxdfhei1' USING DFHEIV0,
 16647           DFHEIV1,
 16648           DFHEIV20,
 16649           DFHEIV99,
 16650           ERCHEK-KEY,
 16651           DFHEIV99,
 16652           DFHEIV99,
 16653           DFHEIV99
 16654     SET ADDRESS OF CHECK-RECORDS TO
 16655         DFHEIV20
 16656     MOVE EIBRESP  TO WS-RESPONSE
 16657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16658
 16659     .
 16660 2530-exit.
 16661     exit.
 16662
 16663 2540-delete-erchek.
 16664
 16665
 16666* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 302
* VP6311.cbl
 16667*       DATASET ('ERCHEK')
 16668*       RESP    (WS-RESPONSE)
 16669*    END-EXEC
 16670     MOVE 'ERCHEK' TO DFHEIV1
 16671*    MOVE '&(                    &  N#00014498' TO DFHEIV0
 16672     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16673     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16674     MOVE X'204E233030303134343938' TO DFHEIV0(25:11)
 16675     CALL 'kxdfhei1' USING DFHEIV0,
 16676           DFHEIV1,
 16677           DFHEIV99,
 16678           DFHEIV99,
 16679           DFHEIV99,
 16680           DFHEIV99
 16681     MOVE EIBRESP  TO WS-RESPONSE
 16682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16683
 16684     .
 16685 2540-exit.
 16686     exit.
 16687***************************************************************
 16688*                                                             *
 16689*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16690*                                                             *
 16691***************************************************************
 16692
 16693***************************************************************
 16694*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16695*     AN ALREADY BILLED RECORD.                               *
 16696***************************************************************
 16697
 16698 2700-BUILD-CORRECTION-RECORD.
 16699     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16700     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16701     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16702     MOVE '5'                    TO DC-OPTION-CODE.
 16703     PERFORM 9700-DATE-LINK.
 16704     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16705
 16706     IF PB-CHG-COUNT = ZEROS
 16707        MOVE +1                  TO WS-SEQ-SAVE
 16708     ELSE
 16709        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16710
 16711     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16712     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16713
 16714     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16715
 16716     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16717     MOVE 'A'                    TO JP-RECORD-TYPE.
 16718     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16719
 16720
 16721* EXEC CICS WRITE
 16722*        DATASET    (FILE-ID-ERPNDB)
 16723*        FROM       (PENDING-BUSINESS)
 16724*        RIDFLD     (PB-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 303
* VP6311.cbl
 16725*    END-EXEC.
 16726     MOVE LENGTH OF
 16727      PENDING-BUSINESS
 16728       TO DFHEIV11
 16729*    MOVE '&$ L                  ''   #00014539' TO DFHEIV0
 16730     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16732     MOVE X'2020233030303134353339' TO DFHEIV0(25:11)
 16733     CALL 'kxdfhei1' USING DFHEIV0,
 16734           FILE-ID-ERPNDB,
 16735           PENDING-BUSINESS,
 16736           DFHEIV11,
 16737           PB-CONTROL-PRIMARY,
 16738           DFHEIV99,
 16739           DFHEIV99
 16740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16741
 16742
 16743     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16744
 16745     PERFORM 8400-LOG-JOURNAL-RECORD.
 16746
 16747 2799-EXIT.
 16748      EXIT.
 16749
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 304
* VP6311.cbl
 16751
 16752******************************************************************
 16753*                                                                *
 16754*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16755*                                                                *
 16756******************************************************************
 16757
 16758 2800-REWRITE-ISSUE-CERT-KEY.
 16759     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16760
 16761     IF  BCERTNOL GREATER THAN ZEROS
 16762         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16763
 16764     IF  BSUFIXL  GREATER THAN ZEROS
 16765         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16766
 16767     IF  BEFFDTL  GREATER THAN ZEROS
 16768         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16769
 16770 2810-READ-BY-ACCOUNT.
 16771
 16772* EXEC CICS HANDLE CONDITION
 16773*         NOTFND    (2820-PROCESS-REWRITE)
 16774*    END-EXEC.
 16775*    MOVE '"$I                   ! = #00014573' TO DFHEIV0
 16776     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16777     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16778     MOVE X'3D20233030303134353733' TO DFHEIV0(25:11)
 16779     CALL 'kxdfhei1' USING DFHEIV0
 16780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16781
 16782
 16783***  read pndb using new key
 16784
 16785* EXEC CICS READ
 16786*        SET     (ADDRESS OF PENDING-BUSINESS)
 16787*        DATASET (FILE-ID-ERPNDB2)
 16788*        RIDFLD  (ERPNDB-ALT-KEY)
 16789*    END-EXEC.
 16790*    MOVE '&"S        E          (   #00014578' TO DFHEIV0
 16791     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16792     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16793     MOVE X'2020233030303134353738' TO DFHEIV0(25:11)
 16794     CALL 'kxdfhei1' USING DFHEIV0,
 16795           FILE-ID-ERPNDB2,
 16796           DFHEIV20,
 16797           DFHEIV99,
 16798           ERPNDB-ALT-KEY,
 16799           DFHEIV99,
 16800           DFHEIV99,
 16801           DFHEIV99
 16802     SET ADDRESS OF PENDING-BUSINESS TO
 16803         DFHEIV20
 16804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16805
 16806
 16807     GO TO 2890-DUPLICATE-RECORD.
 16808
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 305
* VP6311.cbl
 16809  2820-PROCESS-REWRITE.
 16810
 16811* EXEC CICS HANDLE CONDITION
 16812*         NOTFND    (2885-RECORD-MISSING)
 16813*    END-EXEC.
 16814*    MOVE '"$I                   ! > #00014587' TO DFHEIV0
 16815     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16817     MOVE X'3E20233030303134353837' TO DFHEIV0(25:11)
 16818     CALL 'kxdfhei1' USING DFHEIV0
 16819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16820
 16821
 16822     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16823
 16824***  read pndb using original key
 16825
 16826* EXEC CICS READ
 16827*        SET     (ADDRESS OF PENDING-BUSINESS)
 16828*        DATASET (FILE-ID-ERPNDB)
 16829*        RIDFLD  (ERPNDB-KEY)
 16830*        UPDATE
 16831*    END-EXEC.
 16832*    MOVE '&"S        EU         (   #00014594' TO DFHEIV0
 16833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16834     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16835     MOVE X'2020233030303134353934' TO DFHEIV0(25:11)
 16836     CALL 'kxdfhei1' USING DFHEIV0,
 16837           FILE-ID-ERPNDB,
 16838           DFHEIV20,
 16839           DFHEIV99,
 16840           ERPNDB-KEY,
 16841           DFHEIV99,
 16842           DFHEIV99,
 16843           DFHEIV99
 16844     SET ADDRESS OF PENDING-BUSINESS TO
 16845         DFHEIV20
 16846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16847
 16848
 16849     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16850     MOVE 'D'                    TO JP-RECORD-TYPE.
 16851     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16852     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16853
 16854     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16855
 16856     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16857     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16858     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16859
 16860***  delete pndb using original key
 16861
 16862* EXEC CICS DELETE
 16863*        DATASET    (FILE-ID-ERPNDB)
 16864*    END-EXEC.
 16865*    MOVE '&(                    &   #00014613' TO DFHEIV0
 16866     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 306
* VP6311.cbl
 16867     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16868     MOVE X'2020233030303134363133' TO DFHEIV0(25:11)
 16869     CALL 'kxdfhei1' USING DFHEIV0,
 16870           FILE-ID-ERPNDB,
 16871           DFHEIV99,
 16872           DFHEIV99,
 16873           DFHEIV99,
 16874           DFHEIV99
 16875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16876
 16877
 16878     PERFORM 8400-LOG-JOURNAL-RECORD.
 16879
 16880
 16881* EXEC CICS GETMAIN
 16882*        SET      (ADDRESS OF PENDING-BUSINESS)
 16883*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16884*        INITIMG  (GETMAIN-SPACE)
 16885*    END-EXEC.
 16886*    MOVE ',"IL                  $   #00014619' TO DFHEIV0
 16887     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16888     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16889     MOVE X'2020233030303134363139' TO DFHEIV0(25:11)
 16890     CALL 'kxdfhei1' USING DFHEIV0,
 16891           DFHEIV20,
 16892           ERPNDB-RECORD-LENGTH,
 16893           GETMAIN-SPACE
 16894     SET ADDRESS OF PENDING-BUSINESS TO
 16895         DFHEIV20
 16896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16897
 16898
 16899***  pending-business now has original record
 16900     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16901
 16902
 16903* EXEC CICS HANDLE CONDITION
 16904*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16905*    END-EXEC.
 16906*    MOVE '"$I                   ! ? #00014628' TO DFHEIV0
 16907     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16909     MOVE X'3F20233030303134363238' TO DFHEIV0(25:11)
 16910     CALL 'kxdfhei1' USING DFHEIV0
 16911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16912
 16913
 16914***  read elcert using original key
 16915
 16916* EXEC CICS READ
 16917*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16918*        DATASET (FILE-ID-ELCERT)
 16919*        RIDFLD  (ELCERT-KEY)
 16920*        UPDATE
 16921*    END-EXEC.
 16922*    MOVE '&"S        EU         (   #00014633' TO DFHEIV0
 16923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16924     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 307
* VP6311.cbl
 16925     MOVE X'2020233030303134363333' TO DFHEIV0(25:11)
 16926     CALL 'kxdfhei1' USING DFHEIV0,
 16927           FILE-ID-ELCERT,
 16928           DFHEIV20,
 16929           DFHEIV99,
 16930           ELCERT-KEY,
 16931           DFHEIV99,
 16932           DFHEIV99,
 16933           DFHEIV99
 16934     SET ADDRESS OF CERTIFICATE-MASTER TO
 16935         DFHEIV20
 16936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16937
 16938
 16939     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16940     MOVE 'B'                    TO JP-RECORD-TYPE
 16941     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16942     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16943
 16944     IF INSURED-ADDR-PRESENT
 16945        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16946
 16947     IF CERT-NOTES-ARE-NOT-PRESENT
 16948        MOVE SPACE               TO WS-CERT-NOTE-SW
 16949     ELSE
 16950        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16951
 16952     IF CERT-ADDED-BATCH      OR
 16953        CERT-AND-CLAIM-ONLINE OR
 16954        CERT-WAS-CREATED-FOR-CLAIM
 16955        NEXT SENTENCE
 16956     ELSE
 16957        GO TO 2825-DELETE-CERTIFICATE.
 16958
 16959     PERFORM 8400-LOG-JOURNAL-RECORD.
 16960
 16961*********************************************************
 16962** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16963     IF CERT-ADDED-BATCH
 16964         GO TO 2822-REWRITE-ELCERT.
 16965*********************************************************
 16966
 16967     IF NO-CLAIM-ATTACHED
 16968        NEXT SENTENCE
 16969     ELSE
 16970        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16971        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16972
 16973 2822-REWRITE-ELCERT.
 16974     MOVE 'C'                    TO JP-RECORD-TYPE
 16975     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16976
 16977     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16978
 16979
 16980* EXEC CICS REWRITE
 16981*         DATASET    (FILE-ID-ELCERT)
 16982*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 308
* VP6311.cbl
 16983*    END-EXEC.
 16984     MOVE LENGTH OF
 16985      CERTIFICATE-MASTER
 16986       TO DFHEIV11
 16987*    MOVE '&& L                  %   #00014680' TO DFHEIV0
 16988     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16989     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16990     MOVE X'2020233030303134363830' TO DFHEIV0(25:11)
 16991     CALL 'kxdfhei1' USING DFHEIV0,
 16992           FILE-ID-ELCERT,
 16993           CERTIFICATE-MASTER,
 16994           DFHEIV11,
 16995           DFHEIV99
 16996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16997
 16998
 16999     PERFORM 8400-LOG-JOURNAL-RECORD.
 17000
 17001     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17002
 17003 2825-DELETE-CERTIFICATE.
 17004     MOVE 'D'                      TO JP-RECORD-TYPE.
 17005     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17006
 17007     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17008
 17009
 17010* EXEC CICS DELETE
 17011*         DATASET    (FILE-ID-ELCERT)
 17012*    END-EXEC.
 17013*    MOVE '&(                    &   #00014695' TO DFHEIV0
 17014     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17015     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17016     MOVE X'2020233030303134363935' TO DFHEIV0(25:11)
 17017     CALL 'kxdfhei1' USING DFHEIV0,
 17018           FILE-ID-ELCERT,
 17019           DFHEIV99,
 17020           DFHEIV99,
 17021           DFHEIV99,
 17022           DFHEIV99
 17023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17024
 17025
 17026     PERFORM 8400-LOG-JOURNAL-RECORD.
 17027
 17028******************************************************************
 17029*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17030******************************************************************
 17031
 17032     IF CERT-NOTES-ARE-PRESENT
 17033        NEXT SENTENCE
 17034     ELSE
 17035        GO TO 2827-DELETE-MAILING.
 17036
 17037
 17038* EXEC CICS HANDLE CONDITION
 17039*         NOTFND  (2827-DELETE-MAILING)
 17040*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 309
* VP6311.cbl
 17041*    MOVE '"$I                   ! @ #00014710' TO DFHEIV0
 17042     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17044     MOVE X'4020233030303134373130' TO DFHEIV0(25:11)
 17045     CALL 'kxdfhei1' USING DFHEIV0
 17046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17047
 17048
 17049
 17050* EXEC CICS READ
 17051*        EQUAL
 17052*        DATASET   (FILE-ID-ERNOTE)
 17053*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17054*        RIDFLD    (ELCERT-KEY)
 17055*        UPDATE
 17056*    END-EXEC.
 17057*    MOVE '&"S        EU         (   #00014714' TO DFHEIV0
 17058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17059     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17060     MOVE X'2020233030303134373134' TO DFHEIV0(25:11)
 17061     CALL 'kxdfhei1' USING DFHEIV0,
 17062           FILE-ID-ERNOTE,
 17063           DFHEIV20,
 17064           DFHEIV99,
 17065           ELCERT-KEY,
 17066           DFHEIV99,
 17067           DFHEIV99,
 17068           DFHEIV99
 17069     SET ADDRESS OF CERTIFICATE-NOTE TO
 17070         DFHEIV20
 17071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17072
 17073
 17074     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17075     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17076     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17077
 17078     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17079
 17080
 17081* EXEC CICS DELETE
 17082*        DATASET   (FILE-ID-ERNOTE)
 17083*    END-EXEC.
 17084*    MOVE '&(                    &   #00014728' TO DFHEIV0
 17085     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17086     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17087     MOVE X'2020233030303134373238' TO DFHEIV0(25:11)
 17088     CALL 'kxdfhei1' USING DFHEIV0,
 17089           FILE-ID-ERNOTE,
 17090           DFHEIV99,
 17091           DFHEIV99,
 17092           DFHEIV99,
 17093           DFHEIV99
 17094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17095
 17096
 17097     PERFORM 8400-LOG-JOURNAL-RECORD.
 17098
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 310
* VP6311.cbl
 17099******************************************************************
 17100*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17101******************************************************************
 17102
 17103 2827-DELETE-MAILING.
 17104     IF CERT-ADDRESS-PRESENT
 17105        NEXT SENTENCE
 17106     ELSE
 17107        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17108
 17109
 17110* EXEC CICS HANDLE CONDITION
 17111*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17112*    END-EXEC.
 17113*    MOVE '"$I                   ! A #00014744' TO DFHEIV0
 17114     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17116     MOVE X'4120233030303134373434' TO DFHEIV0(25:11)
 17117     CALL 'kxdfhei1' USING DFHEIV0
 17118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17119
 17120
 17121     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17122
 17123
 17124* EXEC CICS READ
 17125*        EQUAL
 17126*        DATASET   (FILE-ID-ERMAIL)
 17127*        SET       (ADDRESS OF MAILING-DATA)
 17128*        RIDFLD    (ERMAIL-KEY)
 17129*        UPDATE
 17130*    END-EXEC.
 17131*    MOVE '&"S        EU         (   #00014750' TO DFHEIV0
 17132     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17133     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17134     MOVE X'2020233030303134373530' TO DFHEIV0(25:11)
 17135     CALL 'kxdfhei1' USING DFHEIV0,
 17136           FILE-ID-ERMAIL,
 17137           DFHEIV20,
 17138           DFHEIV99,
 17139           ERMAIL-KEY,
 17140           DFHEIV99,
 17141           DFHEIV99,
 17142           DFHEIV99
 17143     SET ADDRESS OF MAILING-DATA TO
 17144         DFHEIV20
 17145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17146
 17147
 17148     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17149     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17150     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17151
 17152     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17153
 17154
 17155* EXEC CICS DELETE
 17156*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 311
* VP6311.cbl
 17157*    END-EXEC.
 17158*    MOVE '&(                    &   #00014764' TO DFHEIV0
 17159     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17160     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17161     MOVE X'2020233030303134373634' TO DFHEIV0(25:11)
 17162     CALL 'kxdfhei1' USING DFHEIV0,
 17163           FILE-ID-ERMAIL,
 17164           DFHEIV99,
 17165           DFHEIV99,
 17166           DFHEIV99,
 17167           DFHEIV99
 17168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17169
 17170
 17171     PERFORM 8400-LOG-JOURNAL-RECORD.
 17172
 17173 2830-BUILD-NEW-ISSUE-RECORD.
 17174     MOVE SPACES                 TO ELCERT-KEY.
 17175
 17176     IF  BCERTNOL GREATER THAN ZEROS
 17177         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17178
 17179     IF  BSUFIXL  GREATER THAN ZEROS
 17180         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17181
 17182     IF BEFFDTL GREATER THAN ZEROS
 17183        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17184
 17185 2870-WRITE-PENDING-BUSINESS.
 17186     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17187     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17188     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17189     MOVE '5'                    TO DC-OPTION-CODE.
 17190     PERFORM 9700-DATE-LINK.
 17191     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17192
 17193     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17194
 17195     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17196     MOVE 'A'                    TO JP-RECORD-TYPE.
 17197     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17198
 17199
 17200* EXEC CICS WRITE
 17201*        DATASET  (FILE-ID-ERPNDB)
 17202*        FROM     (PENDING-BUSINESS)
 17203*        RIDFLD   (PB-CONTROL-PRIMARY)
 17204*    END-EXEC.
 17205     MOVE LENGTH OF
 17206      PENDING-BUSINESS
 17207       TO DFHEIV11
 17208*    MOVE '&$ L                  ''   #00014796' TO DFHEIV0
 17209     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17210     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17211     MOVE X'2020233030303134373936' TO DFHEIV0(25:11)
 17212     CALL 'kxdfhei1' USING DFHEIV0,
 17213           FILE-ID-ERPNDB,
 17214           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 312
* VP6311.cbl
 17215           DFHEIV11,
 17216           PB-CONTROL-PRIMARY,
 17217           DFHEIV99,
 17218           DFHEIV99
 17219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17220
 17221
 17222     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17223
 17224     PERFORM 8400-LOG-JOURNAL-RECORD.
 17225
 17226     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17227
 17228 2885-RECORD-MISSING.
 17229     MOVE -1                     TO BMAINTL
 17230     MOVE AL-UABON               TO BMAINTA
 17231     MOVE ER-2902                TO EMI-ERROR.
 17232     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17233     GO TO 8200-SEND-DATAONLY.
 17234
 17235 2890-DUPLICATE-RECORD.
 17236     MOVE -1                     TO BMAINTL.
 17237     MOVE AL-UABON               TO BCERTNOA.
 17238     MOVE AL-UNBON               TO BEFFDTA.
 17239     MOVE SPACE                  TO BMAINTI.
 17240
 17241     MOVE 1                      TO EMI-SUB
 17242                                    EMI-SWITCH1
 17243                                    EMI-SWITCH-AREA-1
 17244                                    EMI-SWITCH-AREA-2.
 17245
 17246     MOVE SPACES                 TO EMI-ERROR-LINES.
 17247
 17248
 17249* EXEC CICS SYNCPOINT ROLLBACK
 17250*    END-EXEC.
 17251*    MOVE '6"R                   !   #00014828' TO DFHEIV0
 17252     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17254     MOVE X'2020233030303134383238' TO DFHEIV0(25:11)
 17255     CALL 'kxdfhei1' USING DFHEIV0
 17256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17257
 17258
 17259     MOVE ER-2247                TO EMI-ERROR.
 17260     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17261     GO TO 8200-SEND-DATAONLY.
 17262
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 313
* VP6311.cbl
 17264
 17265******************************************************************
 17266*                                                                *
 17267*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17268*                                                                *
 17269******************************************************************
 17270
 17271 2900-REWRITE-CAN-CERT-KEY.
 17272     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17273
 17274     IF  CCERTNOL GREATER THAN ZEROS
 17275         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17276
 17277     IF  CSUFIXL  GREATER THAN ZEROS
 17278         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17279
 17280     IF  CEFFDTL  GREATER THAN ZEROS
 17281         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17282
 17283 2910-READ-BY-ACCOUNT.
 17284
 17285* EXEC CICS HANDLE CONDITION
 17286*         NOTFND    (2920-PROCESS-REWRITE)
 17287*    END-EXEC.
 17288*    MOVE '"$I                   ! B #00014856' TO DFHEIV0
 17289     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17290     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17291     MOVE X'4220233030303134383536' TO DFHEIV0(25:11)
 17292     CALL 'kxdfhei1' USING DFHEIV0
 17293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17294
 17295
 17296
 17297* EXEC CICS READ
 17298*        SET     (ADDRESS OF PENDING-BUSINESS)
 17299*        DATASET (FILE-ID-ERPNDB2)
 17300*        RIDFLD  (ERPNDB-ALT-KEY)
 17301*    END-EXEC.
 17302*    MOVE '&"S        E          (   #00014860' TO DFHEIV0
 17303     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17304     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17305     MOVE X'2020233030303134383630' TO DFHEIV0(25:11)
 17306     CALL 'kxdfhei1' USING DFHEIV0,
 17307           FILE-ID-ERPNDB2,
 17308           DFHEIV20,
 17309           DFHEIV99,
 17310           ERPNDB-ALT-KEY,
 17311           DFHEIV99,
 17312           DFHEIV99,
 17313           DFHEIV99
 17314     SET ADDRESS OF PENDING-BUSINESS TO
 17315         DFHEIV20
 17316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17317
 17318
 17319     GO TO 2990-DUPLICATE-RECORD.
 17320
 17321  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 314
* VP6311.cbl
 17322
 17323* EXEC CICS HANDLE CONDITION
 17324*         NOTFND    (2985-RECORD-MISSING)
 17325*    END-EXEC.
 17326*    MOVE '"$I                   ! C #00014869' TO DFHEIV0
 17327     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17329     MOVE X'4320233030303134383639' TO DFHEIV0(25:11)
 17330     CALL 'kxdfhei1' USING DFHEIV0
 17331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17332
 17333
 17334     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17335
 17336
 17337* EXEC CICS READ
 17338*        SET     (ADDRESS OF PENDING-BUSINESS)
 17339*        DATASET (FILE-ID-ERPNDB)
 17340*        RIDFLD  (ERPNDB-KEY)
 17341*        UPDATE
 17342*    END-EXEC.
 17343*    MOVE '&"S        EU         (   #00014875' TO DFHEIV0
 17344     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17345     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17346     MOVE X'2020233030303134383735' TO DFHEIV0(25:11)
 17347     CALL 'kxdfhei1' USING DFHEIV0,
 17348           FILE-ID-ERPNDB,
 17349           DFHEIV20,
 17350           DFHEIV99,
 17351           ERPNDB-KEY,
 17352           DFHEIV99,
 17353           DFHEIV99,
 17354           DFHEIV99
 17355     SET ADDRESS OF PENDING-BUSINESS TO
 17356         DFHEIV20
 17357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17358
 17359
 17360     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17361     MOVE 'D'                    TO JP-RECORD-TYPE.
 17362     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17363     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17364
 17365     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17366
 17367     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17368     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17369     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17370
 17371
 17372* EXEC CICS DELETE
 17373*        DATASET    (FILE-ID-ERPNDB)
 17374*    END-EXEC.
 17375*    MOVE '&(                    &   #00014893' TO DFHEIV0
 17376     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17377     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17378     MOVE X'2020233030303134383933' TO DFHEIV0(25:11)
 17379     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 315
* VP6311.cbl
 17380           FILE-ID-ERPNDB,
 17381           DFHEIV99,
 17382           DFHEIV99,
 17383           DFHEIV99,
 17384           DFHEIV99
 17385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17386
 17387
 17388     PERFORM 8400-LOG-JOURNAL-RECORD.
 17389
 17390
 17391* EXEC CICS GETMAIN
 17392*        SET      (ADDRESS OF PENDING-BUSINESS)
 17393*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17394*        INITIMG  (GETMAIN-SPACE)
 17395*    END-EXEC.
 17396*    MOVE ',"IL                  $   #00014899' TO DFHEIV0
 17397     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17398     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17399     MOVE X'2020233030303134383939' TO DFHEIV0(25:11)
 17400     CALL 'kxdfhei1' USING DFHEIV0,
 17401           DFHEIV20,
 17402           ERPNDB-RECORD-LENGTH,
 17403           GETMAIN-SPACE
 17404     SET ADDRESS OF PENDING-BUSINESS TO
 17405         DFHEIV20
 17406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17407
 17408
 17409     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17410
 17411 2950-PROCESS-CANCELS.
 17412
 17413
 17414* EXEC CICS HANDLE CONDITION
 17415*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17416*    END-EXEC.
 17417*    MOVE '"$I                   ! D #00014909' TO DFHEIV0
 17418     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17420     MOVE X'4420233030303134393039' TO DFHEIV0(25:11)
 17421     CALL 'kxdfhei1' USING DFHEIV0
 17422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17423
 17424
 17425
 17426* EXEC CICS READ
 17427*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17428*        DATASET (FILE-ID-ELCERT)
 17429*        RIDFLD  (ELCERT-KEY)
 17430*        UPDATE
 17431*    END-EXEC.
 17432*    MOVE '&"S        EU         (   #00014913' TO DFHEIV0
 17433     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17434     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17435     MOVE X'2020233030303134393133' TO DFHEIV0(25:11)
 17436     CALL 'kxdfhei1' USING DFHEIV0,
 17437           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 316
* VP6311.cbl
 17438           DFHEIV20,
 17439           DFHEIV99,
 17440           ELCERT-KEY,
 17441           DFHEIV99,
 17442           DFHEIV99,
 17443           DFHEIV99
 17444     SET ADDRESS OF CERTIFICATE-MASTER TO
 17445         DFHEIV20
 17446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17447
 17448
 17449     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17450
 17451     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17452     MOVE 'B'                      TO JP-RECORD-TYPE.
 17453     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17454     PERFORM 8400-LOG-JOURNAL-RECORD.
 17455
 17456     IF PB-CI-LIVES NOT NUMERIC
 17457         MOVE ZERO                    TO PB-CI-LIVES.
 17458
 17459     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17460        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17461        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17462        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17463                                         CM-LF-CANCEL-DT
 17464     ELSE
 17465        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17466        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17467        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17468        MOVE PB-CI-LIVES              TO CM-LIVES.
 17469
 17470     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17471        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17472            MOVE CM-LF-STATUS-AT-CANCEL
 17473                                     TO CM-LF-CURRENT-STATUS
 17474            MOVE SPACE
 17475                                     TO CM-LF-STATUS-AT-CANCEL
 17476        ELSE
 17477            MOVE PB-CI-LF-POLICY-STATUS
 17478                                     TO CM-LF-CURRENT-STATUS
 17479     ELSE
 17480        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17481
 17482     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17483        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17484        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17485        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17486                                         CM-AH-CANCEL-DT
 17487     ELSE
 17488        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17489        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17490        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17491        MOVE PB-CI-LIVES              TO CM-LIVES.
 17492
 17493     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17494        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17495            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 317
* VP6311.cbl
 17496                                     TO CM-AH-CURRENT-STATUS
 17497            MOVE SPACE
 17498                                     TO CM-AH-STATUS-AT-CANCEL
 17499        ELSE
 17500            MOVE PB-CI-AH-POLICY-STATUS
 17501                                     TO CM-AH-CURRENT-STATUS
 17502     ELSE
 17503        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17504
 17505 2975-REWRITE-CERT.
 17506     MOVE 'C'                      TO JP-RECORD-TYPE.
 17507     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17508
 17509
 17510* EXEC CICS REWRITE
 17511*        DATASET    (FILE-ID-ELCERT)
 17512*        FROM       (CERTIFICATE-MASTER)
 17513*    END-EXEC.
 17514     MOVE LENGTH OF
 17515      CERTIFICATE-MASTER
 17516       TO DFHEIV11
 17517*    MOVE '&& L                  %   #00014980' TO DFHEIV0
 17518     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17519     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17520     MOVE X'2020233030303134393830' TO DFHEIV0(25:11)
 17521     CALL 'kxdfhei1' USING DFHEIV0,
 17522           FILE-ID-ELCERT,
 17523           CERTIFICATE-MASTER,
 17524           DFHEIV11,
 17525           DFHEIV99
 17526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17527
 17528
 17529     PERFORM 8400-LOG-JOURNAL-RECORD.
 17530
 17531 2960-BUILD-NEW-CANCEL-RECORD.
 17532     IF  CCERTNOL GREATER THAN ZEROS
 17533         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17534
 17535     IF  CSUFIXL  GREATER THAN ZEROS
 17536         MOVE CSUFIXI             TO PB-CERT-SFX.
 17537
 17538     IF  CEFFDTL  GREATER  THAN ZEROS
 17539         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17540
 17541 2970-WRITE-PENDING-BUSINESS.
 17542     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17543     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17544     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17545     MOVE '5'                    TO DC-OPTION-CODE.
 17546     PERFORM 9700-DATE-LINK.
 17547     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17548
 17549     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17550
 17551     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17552                                    PB-CI-INSURED-SEX
 17553                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 318
* VP6311.cbl
 17554                                    PB-CI-AH-BENEFIT-CD
 17555                                    PB-CI-RATE-CLASS
 17556                                    PB-CI-RATE-DEV-LF
 17557                                    PB-CI-RATE-DEV-AH
 17558                                    PB-CI-LF-ABBR
 17559                                    PB-CI-AH-ABBR
 17560                                    PB-CI-OB-FLAG
 17561                                    PB-CI-LF-POLICY-STATUS
 17562                                    PB-CI-AH-POLICY-STATUS
 17563                                    PB-CI-INDV-GRP-CD
 17564                                    PB-CI-BENEFICIARY-NAME
 17565                                    PB-CI-NOTE-SW
 17566                                    PB-CI-SOC-SEC-NO
 17567                                    PB-CI-MEMBER-NO
 17568                                    PB-CI-INT-CODE
 17569                                    PB-CI-COMP-EXCP-SW
 17570                                    PB-CI-ENTRY-STATUS
 17571                                    PB-CI-CREDIT-INTERFACE-SW-1
 17572                                    PB-CI-CREDIT-INTERFACE-SW-2
 17573                                    PB-CI-ENTRY-BATCH.
 17574
 17575     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17576                                    PB-CI-AH-SETTLEMENT-DT
 17577                                    PB-CI-DEATH-DT
 17578                                    PB-CI-LF-PRIOR-CANCEL-DT
 17579                                    PB-CI-AH-PRIOR-CANCEL-DT
 17580                                    PB-CI-LOAN-1ST-PMT-DT
 17581                                    PB-CI-ENTRY-DT
 17582                                    PB-CI-LF-EXPIRE-DT
 17583                                    PB-CI-AH-EXPIRE-DT.
 17584
 17585     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17586                                    PB-CI-LF-TERM
 17587                                    PB-CI-LF-BENEFIT-AMT
 17588                                    PB-CI-LF-ALT-BENEFIT-AMT
 17589                                    PB-CI-LF-PREMIUM-AMT
 17590                                    PB-CI-LF-ALT-PREMIUM-AMT
 17591                                    PB-CI-AH-TERM
 17592                                    PB-CI-AH-BENEFIT-AMT
 17593                                    PB-CI-AH-PREMIUM-AMT
 17594                                    PB-CI-RATE-DEV-PCT-LF
 17595                                    PB-CI-RATE-DEV-PCT-AH
 17596                                    PB-CI-LIFE-COMMISSION
 17597                                    PB-CI-AH-COMMISSION
 17598                                    PB-CI-PAY-FREQUENCY
 17599                                    PB-CI-LOAN-APR
 17600                                    PB-CI-LOAN-TERM
 17601                                    PB-CI-CURR-SEQ
 17602                                    PB-CI-AH-CANCEL-AMT
 17603                                    PB-CI-LF-CANCEL-AMT
 17604                                    PB-CI-EXTENTION-DAYS
 17605                                    PB-CI-TERM-IN-DAYS
 17606                                    PB-CI-LOAN-OFFICER
 17607                                    PB-CI-LIVES
 17608                                    PB-CI-LF-CRIT-PER
 17609                                    PB-CI-AH-CRIT-PER
 17610                                    PB-C-LF-REM-TERM
 17611                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 319
* VP6311.cbl
 17612
 17613     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17614     MOVE 'A'                    TO JP-RECORD-TYPE.
 17615     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17616
 17617
 17618* EXEC CICS HANDLE CONDITION
 17619*        DUPREC   (2990-DUPLICATE-RECORD)
 17620*    END-EXEC.
 17621*    MOVE '"$%                   ! E #00015073' TO DFHEIV0
 17622     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17624     MOVE X'4520233030303135303733' TO DFHEIV0(25:11)
 17625     CALL 'kxdfhei1' USING DFHEIV0
 17626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17627
 17628
 17629
 17630* EXEC CICS WRITE
 17631*        DATASET  (FILE-ID-ERPNDB)
 17632*        FROM     (PENDING-BUSINESS)
 17633*        RIDFLD   (PB-CONTROL-PRIMARY)
 17634*    END-EXEC.
 17635     MOVE LENGTH OF
 17636      PENDING-BUSINESS
 17637       TO DFHEIV11
 17638*    MOVE '&$ L                  ''   #00015077' TO DFHEIV0
 17639     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17640     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17641     MOVE X'2020233030303135303737' TO DFHEIV0(25:11)
 17642     CALL 'kxdfhei1' USING DFHEIV0,
 17643           FILE-ID-ERPNDB,
 17644           PENDING-BUSINESS,
 17645           DFHEIV11,
 17646           PB-CONTROL-PRIMARY,
 17647           DFHEIV99,
 17648           DFHEIV99
 17649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17650
 17651
 17652     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17653
 17654     PERFORM 8400-LOG-JOURNAL-RECORD.
 17655
 17656     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17657
 17658 2985-RECORD-MISSING.
 17659     MOVE -1                     TO CMAINTL
 17660     MOVE AL-UABON               TO CMAINTA.
 17661
 17662     MOVE ER-2902                TO EMI-ERROR.
 17663     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17664     GO TO 8200-SEND-DATAONLY.
 17665
 17666 2990-DUPLICATE-RECORD.
 17667     MOVE SPACE                  TO CMAINTI.
 17668     MOVE -1                     TO CMAINTL.
 17669     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 320
* VP6311.cbl
 17670     MOVE AL-UNBON               TO CEFFDTA.
 17671
 17672     MOVE 1                      TO EMI-SUB
 17673                                    EMI-SWITCH1
 17674                                    EMI-SWITCH-AREA-1
 17675                                    EMI-SWITCH-AREA-2.
 17676     MOVE SPACES                 TO EMI-ERROR-LINES.
 17677
 17678
 17679* EXEC CICS SYNCPOINT ROLLBACK
 17680*    END-EXEC.
 17681*    MOVE '6"R                   !   #00015109' TO DFHEIV0
 17682     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17684     MOVE X'2020233030303135313039' TO DFHEIV0(25:11)
 17685     CALL 'kxdfhei1' USING DFHEIV0
 17686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17687
 17688
 17689     MOVE ER-2247                TO EMI-ERROR.
 17690     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17691     GO TO 8200-SEND-DATAONLY.
 17692
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 321
* VP6311.cbl
 17694
 17695***************************************************************
 17696*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17697*     PREMIUM FOR A SINGLE BATCH.                             *
 17698*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17699***************************************************************
 17700
 17701 3000-BATCH-MAINLINE.
 17702     IF PI-PREV-KEY NOT = SPACES
 17703         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17704     ELSE
 17705         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17706
 17707     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17708
 17709 3010-READNEXT.
 17710
 17711* EXEC CICS READ
 17712*         DATASET    (FILE-ID-ERPNDB)
 17713*         SET        (ADDRESS OF PENDING-BUSINESS)
 17714*         RIDFLD     (ERPNDB-KEY)
 17715*         GTEQ
 17716*    END-EXEC.
 17717*    MOVE '&"S        G          (   #00015133' TO DFHEIV0
 17718     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17719     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17720     MOVE X'2020233030303135313333' TO DFHEIV0(25:11)
 17721     CALL 'kxdfhei1' USING DFHEIV0,
 17722           FILE-ID-ERPNDB,
 17723           DFHEIV20,
 17724           DFHEIV99,
 17725           ERPNDB-KEY,
 17726           DFHEIV99,
 17727           DFHEIV99,
 17728           DFHEIV99
 17729     SET ADDRESS OF PENDING-BUSINESS TO
 17730         DFHEIV20
 17731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17732
 17733
 17734     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17735        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17736          GO TO 3030-END-BATCH.
 17737
 17738     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17739
 17740     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17741        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17742          GO TO 3020-BUMP-SEQ.
 17743
 17744     IF PB-ISSUE
 17745        ADD +1                   TO WS-ISS-TOTAL-CNT
 17746        IF PB-FATAL-ERRORS
 17747           ADD +1                      TO WS-ISS-FATAL-CNT
 17748           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17749           GO TO 3020-BUMP-SEQ
 17750        ELSE
 17751           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 322
* VP6311.cbl
 17752              ADD +1                      TO WS-ISS-FORCE-CNT
 17753              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17754              GO TO 3020-BUMP-SEQ
 17755           ELSE
 17756              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17757                 ADD +1                      TO WS-ISS-HOLD-CNT
 17758                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17759                 GO TO 3020-BUMP-SEQ
 17760              ELSE
 17761                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17762                     THRU  3299-EXIT
 17763                 GO TO 3020-BUMP-SEQ.
 17764
 17765     IF PB-CANCELLATION
 17766        ADD +1                   TO WS-CAN-TOTAL-CNT
 17767        IF PB-FATAL-ERRORS
 17768           ADD +1                 TO WS-CAN-FATAL-CNT
 17769           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17770           GO TO 3020-BUMP-SEQ
 17771        ELSE
 17772           IF PB-UNFORCED-ERRORS
 17773              ADD +1                 TO WS-CAN-FORCE-CNT
 17774              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17775              GO TO 3020-BUMP-SEQ
 17776           ELSE
 17777              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17778                 ADD +1                 TO WS-CAN-HOLD-CNT
 17779                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17780                 GO TO 3020-BUMP-SEQ
 17781              ELSE
 17782                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17783                     THRU  3499-EXIT
 17784                 GO TO 3020-BUMP-SEQ.
 17785
 17786     IF PB-BATCH-TRAILER
 17787         GO TO 3030-END-BATCH.
 17788
 17789 3020-BUMP-SEQ.
 17790     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17791     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17792     GO TO 3010-READNEXT.
 17793
 17794 3030-END-BATCH.
 17795     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17796     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17797     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17798     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17799
 17800     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17801                                          - WS-ISS-FORCE-CNT
 17802                                          - WS-ISS-HOLD-CNT).
 17803
 17804     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17805     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17806
 17807     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17808     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17809     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 323
* VP6311.cbl
 17810     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17811     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17812                                          - WS-CAN-FORCE-CNT
 17813                                          - WS-CAN-HOLD-CNT).
 17814     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17815     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17816
 17817     COMPUTE WS-NET-TOTAL-CNT
 17818         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17819     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17820     COMPUTE WS-NET-FATAL-CNT
 17821         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17822     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17823     COMPUTE WS-NET-FORCE-CNT
 17824         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17825     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17826     COMPUTE WS-NET-HOLD-CNT
 17827         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17828     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17829
 17830     COMPUTE WS-NET-AVAIL-CNT
 17831          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17832                              - WS-ISS-FORCE-CNT
 17833                              - WS-ISS-HOLD-CNT)
 17834          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17835                              - WS-CAN-FORCE-CNT
 17836                              - WS-CAN-HOLD-CNT).
 17837     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17838
 17839     COMPUTE WS-NET-GOOD-PREM
 17840         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17841     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17842     COMPUTE WS-NET-BAD-PREM
 17843         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17844     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17845
 17846     MOVE 0000                   TO EMI-ERROR.
 17847     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17848     MOVE -1                     TO DPFENTRL.
 17849     GO TO 8200-SEND-DATAONLY.
 17850
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 324
* VP6311.cbl
 17852
 17853******************************************************************
 17854*                                                                *
 17855*           A D D    B A D   I S S U E   P R E M I U M           *
 17856*                                                                *
 17857******************************************************************
 17858
 17859 3100-ADD-BAD-ISSUE-PREM.
 17860     IF PB-OVERRIDE-LIFE
 17861       OR PB-OVERRIDE-BOTH
 17862           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17863           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17864       ELSE
 17865           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17866           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17867
 17868     IF PB-OVERRIDE-AH
 17869       OR PB-OVERRIDE-BOTH
 17870           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17871       ELSE
 17872           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17873
 17874 3199-EXIT.
 17875     EXIT.
 17876
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 325
* VP6311.cbl
 17878
 17879******************************************************************
 17880*                                                                *
 17881*       A D D   G O O D   I S S U E   P R E M I U M              *
 17882*                                                                *
 17883******************************************************************
 17884
 17885 3200-ADD-GOOD-ISSUE-PREM.
 17886     IF PB-OVERRIDE-LIFE
 17887       OR PB-OVERRIDE-BOTH
 17888           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17889           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17890       ELSE
 17891           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17892           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17893
 17894     IF PB-OVERRIDE-AH
 17895       OR PB-OVERRIDE-BOTH
 17896           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17897       ELSE
 17898           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17899
 17900 3299-EXIT.
 17901     EXIT.
 17902
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 326
* VP6311.cbl
 17904
 17905
 17906******************************************************************
 17907*                                                                *
 17908*        A D D   B A D   C A N C E L   P R E M I U M             *
 17909*                                                                *
 17910******************************************************************
 17911
 17912 3300-ADD-BAD-CANCEL-PREM.
 17913     IF PB-OVERRIDE-LIFE
 17914       OR PB-OVERRIDE-BOTH
 17915           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17916       ELSE
 17917           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17918
 17919     IF PB-OVERRIDE-AH
 17920       OR PB-OVERRIDE-BOTH
 17921           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17922       ELSE
 17923           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17924
 17925 3399-EXIT.
 17926     EXIT.
 17927
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 327
* VP6311.cbl
 17929
 17930******************************************************************
 17931*                                                                *
 17932*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17933*                                                                *
 17934******************************************************************
 17935
 17936 3400-ADD-GOOD-CANCEL-PREM.
 17937     IF PB-OVERRIDE-LIFE
 17938       OR PB-OVERRIDE-BOTH
 17939           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17940       ELSE
 17941           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17942
 17943     IF PB-OVERRIDE-AH
 17944       OR PB-OVERRIDE-BOTH
 17945           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17946       ELSE
 17947           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17948
 17949 3499-EXIT.
 17950     EXIT.
 17951
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 328
* VP6311.cbl
 17953
 17954******************************************************************
 17955*                                                                *
 17956*           E D I T   B A T C H   D A T A                        *
 17957*                                                                *
 17958******************************************************************
 17959
 17960 3500-EDIT-BATCH-DATA.
 17961     IF PI-PREV-KEY NOT = SPACES
 17962        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17963     ELSE
 17964        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17965
 17966     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17967     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17968
 17969
 17970* EXEC CICS HANDLE CONDITION
 17971*         NOTFND      (3590-NOT-FOUND)
 17972*    END-EXEC.
 17973*    MOVE '"$I                   ! F #00015375' TO DFHEIV0
 17974     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17975     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17976     MOVE X'4620233030303135333735' TO DFHEIV0(25:11)
 17977     CALL 'kxdfhei1' USING DFHEIV0
 17978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17979
 17980
 17981     IF DRISSL   GREATER THAN ZEROS OR
 17982        DRISSL   GREATER THAN ZEROS OR
 17983        DRLFPRML GREATER THAN ZEROS OR
 17984        DRAHPRML GREATER THAN ZEROS OR
 17985        DRCANCL  GREATER THAN ZEROS OR
 17986        DRLFRFDL GREATER THAN ZEROS OR
 17987        DRAHRFDL GREATER THAN ZEROS
 17988              NEXT SENTENCE
 17989          ELSE
 17990              MOVE ER-3224    TO EMI-ERROR
 17991              MOVE -1         TO DPFENTRL
 17992              MOVE AL-UNBON   TO DPFENTRA
 17993              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17994              GO TO 8200-SEND-DATAONLY.
 17995
 17996     IF NOT MODIFY-CAP
 17997         MOVE 'UPDATE'       TO SM-READ
 17998         PERFORM 9995-SECURITY-VIOLATION
 17999         MOVE ER-0070        TO EMI-ERROR
 18000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18001         GO TO 8100-SEND-INITIAL-MAP.
 18002
 18003        IF DRISSL GREATER THAN ZEROS
 18004           MOVE AL-UNNON         TO DRISSA
 18005           MOVE DRISSI           TO DEEDIT-FIELD
 18006           PERFORM 8600-DEEDIT
 18007           IF DEEDIT-FIELD-V0  NUMERIC
 18008              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18009           ELSE
 18010              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 329
* VP6311.cbl
 18011              MOVE -1         TO DRISSL
 18012              MOVE AL-UNBON   TO DRISSA
 18013              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18014
 18015        IF DRLFPRML GREATER THAN ZEROS
 18016           MOVE AL-UNNON         TO DRLFPRMA
 18017
 18018* EXEC CICS BIF DEEDIT
 18019*              FIELD  (DRLFPRMI)
 18020*              LENGTH (11)
 18021*          END-EXEC
 18022     MOVE 11
 18023       TO DFHEIV11
 18024*    MOVE '@"L                   #   #00015415' TO DFHEIV0
 18025     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18026     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18027     MOVE X'2020233030303135343135' TO DFHEIV0(25:11)
 18028     CALL 'kxdfhei1' USING DFHEIV0,
 18029           DRLFPRMI,
 18030           DFHEIV11
 18031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18032           IF DRLFPRMI NUMERIC
 18033              MOVE DRLFPRMI   TO WS-DRLFPRM
 18034*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18035*          PERFORM 8600-DEEDIT
 18036*          IF DEEDIT-FIELD-V2  NUMERIC
 18037*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18038           ELSE
 18039              MOVE ER-2223    TO EMI-ERROR
 18040              MOVE -1         TO DRLFPRML
 18041              MOVE AL-UNBON   TO DRLFPRMA
 18042              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18043
 18044        IF DRAHPRML GREATER THAN ZEROS
 18045           MOVE AL-UNNON         TO DRAHPRMA
 18046
 18047* EXEC CICS BIF DEEDIT
 18048*              FIELD  (DRAHPRMI)
 18049*              LENGTH (11)
 18050*          END-EXEC
 18051     MOVE 11
 18052       TO DFHEIV11
 18053*    MOVE '@"L                   #   #00015433' TO DFHEIV0
 18054     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18055     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18056     MOVE X'2020233030303135343333' TO DFHEIV0(25:11)
 18057     CALL 'kxdfhei1' USING DFHEIV0,
 18058           DRAHPRMI,
 18059           DFHEIV11
 18060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18061           IF DRAHPRMI NUMERIC
 18062              MOVE DRAHPRMI   TO WS-DRAHPRM
 18063*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18064*          PERFORM 8600-DEEDIT
 18065*          IF DEEDIT-FIELD-V2  NUMERIC
 18066*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18067           ELSE
 18068              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 330
* VP6311.cbl
 18069              MOVE -1         TO DRAHPRML
 18070              MOVE AL-UNBON   TO DRAHPRMA
 18071              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18072
 18073        IF DRCANCL GREATER THAN ZEROS
 18074           MOVE AL-UNNON         TO DRCANCA
 18075           MOVE DRCANCI          TO DEEDIT-FIELD
 18076           PERFORM 8600-DEEDIT
 18077           IF DEEDIT-FIELD-V0  NUMERIC
 18078              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18079           ELSE
 18080              MOVE ER-2223    TO EMI-ERROR
 18081              MOVE -1         TO DRCANCL
 18082              MOVE AL-UNBON   TO DRCANCL
 18083              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18084
 18085        IF DRLFRFDL GREATER THAN ZEROS
 18086           MOVE AL-UNNON         TO DRLFRFDA
 18087
 18088* EXEC CICS BIF DEEDIT
 18089*              FIELD  (DRLFRFDI)
 18090*              LENGTH (11)
 18091*          END-EXEC
 18092     MOVE 11
 18093       TO DFHEIV11
 18094*    MOVE '@"L                   #   #00015463' TO DFHEIV0
 18095     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18096     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18097     MOVE X'2020233030303135343633' TO DFHEIV0(25:11)
 18098     CALL 'kxdfhei1' USING DFHEIV0,
 18099           DRLFRFDI,
 18100           DFHEIV11
 18101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18102           IF DRLFRFDI NUMERIC
 18103              MOVE DRLFRFDI   TO WS-DRLFRFD
 18104*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18105*          PERFORM 8600-DEEDIT
 18106*          IF DEEDIT-FIELD-V2  NUMERIC
 18107*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18108           ELSE
 18109              MOVE ER-2223    TO EMI-ERROR
 18110              MOVE -1         TO DRLFRFDL
 18111              MOVE AL-UNBON   TO DRLFRFDA
 18112              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18113
 18114        IF DRAHRFDL GREATER THAN ZEROS
 18115           MOVE AL-UNNON         TO DRAHRFDA
 18116
 18117* EXEC CICS BIF DEEDIT
 18118*              FIELD  (DRAHRFDI)
 18119*              LENGTH (11)
 18120*          END-EXEC
 18121     MOVE 11
 18122       TO DFHEIV11
 18123*    MOVE '@"L                   #   #00015481' TO DFHEIV0
 18124     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18125     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18126     MOVE X'2020233030303135343831' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 331
* VP6311.cbl
 18127     CALL 'kxdfhei1' USING DFHEIV0,
 18128           DRAHRFDI,
 18129           DFHEIV11
 18130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18131           IF DRAHRFDI NUMERIC
 18132              MOVE DRAHRFDI   TO WS-DRAHRFD
 18133*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18134*          PERFORM 8600-DEEDIT
 18135*          IF DEEDIT-FIELD-V2  NUMERIC
 18136*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18137           ELSE
 18138              MOVE ER-2223    TO EMI-ERROR
 18139              MOVE -1         TO DRAHRFDL
 18140              MOVE AL-UNBON   TO DRAHRFDA
 18141              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18142
 18143     IF EMI-ERROR = ZEROS
 18144        GO 3600-UPDATE-BATCH-HEADER.
 18145
 18146     GO TO 8200-SEND-DATAONLY.
 18147
 18148 3590-NOT-FOUND.
 18149     MOVE ER-2192                TO EMI-ERROR.
 18150     MOVE -1                     TO DPFENTRL.
 18151     MOVE AL-UNBON               TO DPFENTRA.
 18152     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18153     GO TO 8200-SEND-DATAONLY.
 18154
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 332
* VP6311.cbl
 18156
 18157******************************************************************
 18158*                                                                *
 18159*           U P D A T E   B A T C H   H E A D E R                *
 18160*                                                                *
 18161******************************************************************
 18162
 18163 3600-UPDATE-BATCH-HEADER.
 18164
 18165* EXEC CICS HANDLE CONDITION
 18166*         NOTFND      (3690-NOT-FOUND)
 18167*    END-EXEC.
 18168*    MOVE '"$I                   ! G #00015518' TO DFHEIV0
 18169     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18171     MOVE X'4720233030303135353138' TO DFHEIV0(25:11)
 18172     CALL 'kxdfhei1' USING DFHEIV0
 18173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18174
 18175
 18176
 18177* EXEC CICS READ
 18178*        DATASET (FILE-ID-ERPNDB)
 18179*        RIDFLD  (ERPNDB-KEY)
 18180*        SET     (ADDRESS OF PENDING-BUSINESS)
 18181*        UPDATE
 18182*    END-EXEC.
 18183*    MOVE '&"S        EU         (   #00015522' TO DFHEIV0
 18184     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18185     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18186     MOVE X'2020233030303135353232' TO DFHEIV0(25:11)
 18187     CALL 'kxdfhei1' USING DFHEIV0,
 18188           FILE-ID-ERPNDB,
 18189           DFHEIV20,
 18190           DFHEIV99,
 18191           ERPNDB-KEY,
 18192           DFHEIV99,
 18193           DFHEIV99,
 18194           DFHEIV99
 18195     SET ADDRESS OF PENDING-BUSINESS TO
 18196         DFHEIV20
 18197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18198
 18199
 18200     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18201     MOVE 'B'                    TO JP-RECORD-TYPE.
 18202     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18203
 18204     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18205
 18206     PERFORM 8400-LOG-JOURNAL-RECORD.
 18207
 18208     IF DRISSL GREATER THAN ZEROS
 18209        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18210
 18211     IF DRCANCL GREATER THAN ZEROS
 18212        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18213
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 333
* VP6311.cbl
 18214
 18215     IF DRLFPRML GREATER THAN ZEROS
 18216        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18217
 18218     IF DRAHPRML GREATER THAN ZEROS
 18219        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18220
 18221     IF DRLFRFDL GREATER THAN ZEROS
 18222        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18223
 18224     IF DRAHRFDL GREATER THAN ZEROS
 18225        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18226
 18227 3670-REWRITE-BATCH-HEADER.
 18228     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18229        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18230        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18231        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18232        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18233        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18234        MOVE SPACE               TO PB-OUT-BAL-CD
 18235     ELSE
 18236        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18237
 18238     MOVE 'C'                    TO JP-RECORD-TYPE.
 18239     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18240
 18241
 18242* EXEC CICS REWRITE
 18243*         DATASET      (FILE-ID-ERPNDB)
 18244*         FROM         (PENDING-BUSINESS)
 18245*    END-EXEC.
 18246     MOVE LENGTH OF
 18247      PENDING-BUSINESS
 18248       TO DFHEIV11
 18249*    MOVE '&& L                  %   #00015570' TO DFHEIV0
 18250     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18251     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18252     MOVE X'2020233030303135353730' TO DFHEIV0(25:11)
 18253     CALL 'kxdfhei1' USING DFHEIV0,
 18254           FILE-ID-ERPNDB,
 18255           PENDING-BUSINESS,
 18256           DFHEIV11,
 18257           DFHEIV99
 18258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18259
 18260
 18261     PERFORM 8400-LOG-JOURNAL-RECORD.
 18262
 18263     GO TO 7200-DISPLAY-BATCHES.
 18264
 18265 3690-NOT-FOUND.
 18266     MOVE ER-2192                TO EMI-ERROR.
 18267     MOVE -1                     TO DPFENTRL.
 18268     MOVE AL-UNBON               TO DPFENTRA.
 18269     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18270     GO TO 8200-SEND-DATAONLY.
 18271
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 334
* VP6311.cbl
 18273
 18274******************************************************************
 18275*                                                                *
 18276*           R E - D I S P L A Y   R E C O R D                    *
 18277*                                                                *
 18278******************************************************************
 18279
 18280 3900-RE-DISPLAY-RECORD.
 18281
 18282* EXEC CICS HANDLE CONDITION
 18283*         NOTFND   (3990-NOT-FOUND)
 18284*    END-EXEC.
 18285*    MOVE '"$I                   ! H #00015595' TO DFHEIV0
 18286     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18288     MOVE X'4820233030303135353935' TO DFHEIV0(25:11)
 18289     CALL 'kxdfhei1' USING DFHEIV0
 18290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18291
 18292
 18293     IF PI-DISPLAY-ORIGINAL-BATCH
 18294         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18295     ELSE
 18296         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18297
 18298
 18299* EXEC CICS READ
 18300*         DATASET   (FILE-ID)
 18301*         RIDFLD    (PI-PREV-KEY)
 18302*         SET       (ADDRESS OF PENDING-BUSINESS)
 18303*    END-EXEC.
 18304*    MOVE '&"S        E          (   #00015604' TO DFHEIV0
 18305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18307     MOVE X'2020233030303135363034' TO DFHEIV0(25:11)
 18308     CALL 'kxdfhei1' USING DFHEIV0,
 18309           FILE-ID,
 18310           DFHEIV20,
 18311           DFHEIV99,
 18312           PI-PREV-KEY,
 18313           DFHEIV99,
 18314           DFHEIV99,
 18315           DFHEIV99
 18316     SET ADDRESS OF PENDING-BUSINESS TO
 18317         DFHEIV20
 18318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18319
 18320
 18321     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18322
 18323     IF PB-ISSUE
 18324         GO TO 7000-DISPLAY-ISSUES.
 18325
 18326     IF PB-CANCELLATION
 18327         GO TO 7100-DISPLAY-CANCELS.
 18328
 18329     IF PB-BATCH-TRAILER
 18330         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 335
* VP6311.cbl
 18331
 18332 3990-NOT-FOUND.
 18333     MOVE LOW-VALUES             TO VP631BI.
 18334
 18335     IF PI-MAP-NAME = VP631B
 18336         MOVE -1                  TO BMAINTL
 18337     ELSE
 18338         MOVE -1                  TO CMAINTL.
 18339
 18340     GO TO 8100-SEND-INITIAL-MAP.
 18341
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 336
* VP6311.cbl
 18343
 18344***************************************************************
 18345*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18346*                                                             *
 18347*      1. START BROWSE WITH                                   *
 18348*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18349*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18350*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18351*                                                             *
 18352*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18353*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18354*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18355*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18356*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18357*               AND IS IT TO BE DISPLAYED.                    *
 18358*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18359*               DISPLAYED.                                    *
 18360*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18361*               DISPLAYED.                                    *
 18362*                                                             *
 18363*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18364*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18365***************************************************************
 18366
 18367 4000-BROWSE-DETAIL-FORWARD.
 18368     IF FIRST-TIME
 18369        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18370     ELSE
 18371        IF SHOW-RECORD
 18372           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18373           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18374           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18375           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18376           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18377        ELSE
 18378           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18379
 18380
 18381* EXEC CICS HANDLE CONDITION
 18382*         NOTFND   (4050-END-RECORDS)
 18383*         ENDFILE  (4050-END-RECORDS)
 18384*    END-EXEC.
 18385*    MOVE '"$I''                  ! I #00015669' TO DFHEIV0
 18386     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18388     MOVE X'4920233030303135363639' TO DFHEIV0(25:11)
 18389     CALL 'kxdfhei1' USING DFHEIV0
 18390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18391
 18392
 18393
 18394* EXEC CICS STARTBR
 18395*         DATASET   (FILE-ID-ERPNDB2)
 18396*         RIDFLD    (ERPNDB-ALT-KEY)
 18397*    END-EXEC.
 18398     MOVE 0
 18399       TO DFHEIV11
 18400*    MOVE '&,         G          &   #00015674' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 337
* VP6311.cbl
 18401     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18402     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18403     MOVE X'2020233030303135363734' TO DFHEIV0(25:11)
 18404     CALL 'kxdfhei1' USING DFHEIV0,
 18405           FILE-ID-ERPNDB2,
 18406           ERPNDB-ALT-KEY,
 18407           DFHEIV99,
 18408           DFHEIV11,
 18409           DFHEIV99
 18410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18411
 18412
 18413     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18414
 18415     IF FIRST-TIME OR SHOW-RECORD
 18416        MOVE SPACE               TO WS-FIRST-TIME-SW
 18417        GO TO 4005-READ-NEXT-RECORD.
 18418
 18419
 18420* EXEC CICS READNEXT
 18421*         DATASET    (FILE-ID-ERPNDB2)
 18422*         SET        (ADDRESS OF PENDING-BUSINESS)
 18423*         RIDFLD     (ERPNDB-ALT-KEY)
 18424*    END-EXEC.
 18425     MOVE 0
 18426       TO DFHEIV11
 18427*    MOVE '&.S                   )   #00015685' TO DFHEIV0
 18428     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18429     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18430     MOVE X'2020233030303135363835' TO DFHEIV0(25:11)
 18431     CALL 'kxdfhei1' USING DFHEIV0,
 18432           FILE-ID-ERPNDB2,
 18433           DFHEIV20,
 18434           DFHEIV99,
 18435           ERPNDB-ALT-KEY,
 18436           DFHEIV99,
 18437           DFHEIV11,
 18438           DFHEIV99,
 18439           DFHEIV99
 18440     SET ADDRESS OF PENDING-BUSINESS TO
 18441         DFHEIV20
 18442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18443
 18444
 18445 4005-READ-NEXT-RECORD.
 18446
 18447* EXEC CICS READNEXT
 18448*         DATASET    (FILE-ID-ERPNDB2)
 18449*         SET        (ADDRESS OF PENDING-BUSINESS)
 18450*         RIDFLD     (ERPNDB-ALT-KEY)
 18451*    END-EXEC.
 18452     MOVE 0
 18453       TO DFHEIV11
 18454*    MOVE '&.S                   )   #00015692' TO DFHEIV0
 18455     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18456     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18457     MOVE X'2020233030303135363932' TO DFHEIV0(25:11)
 18458     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 338
* VP6311.cbl
 18459           FILE-ID-ERPNDB2,
 18460           DFHEIV20,
 18461           DFHEIV99,
 18462           ERPNDB-ALT-KEY,
 18463           DFHEIV99,
 18464           DFHEIV11,
 18465           DFHEIV99,
 18466           DFHEIV99
 18467     SET ADDRESS OF PENDING-BUSINESS TO
 18468         DFHEIV20
 18469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18470
 18471
 18472     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18473
 18474     IF WS-BATCH-PREFIX = '#CL'
 18475        GO TO 4005-READ-NEXT-RECORD.
 18476
 18477     IF SHOW-RECORD
 18478        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18479           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18480           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18481           PB-STATE         NOT = PI-PB-STATE          OR
 18482           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18483           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18484           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18485           GO TO 4050-END-RECORDS
 18486        ELSE
 18487           GO TO 4010-CHECK-REC-TYPE.
 18488
 18489     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18490        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18491        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18492        PB-STATE            NOT = PI-PB-STATE          OR
 18493        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18494        GO TO 4050-END-RECORDS.
 18495
 18496     IF PB-BATCH-TRAILER
 18497        GO TO 4005-READ-NEXT-RECORD.
 18498
 18499     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18500        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18501           GO TO 4005-READ-NEXT-RECORD
 18502        ELSE
 18503           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18504              GO TO 4010-CHECK-REC-TYPE
 18505           ELSE
 18506              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18507                 GO TO 4010-CHECK-REC-TYPE
 18508              ELSE
 18509                 GO TO 4005-READ-NEXT-RECORD.
 18510
 18511     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18512        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18513           GO TO 4005-READ-NEXT-RECORD.
 18514
 18515 4010-CHECK-REC-TYPE.
 18516     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 339
* VP6311.cbl
 18517         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18518             NEXT SENTENCE
 18519         ELSE
 18520             GO TO 4005-READ-NEXT-RECORD.
 18521
 18522     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18523         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18524             NEXT SENTENCE
 18525        ELSE
 18526             GO TO 4005-READ-NEXT-RECORD.
 18527
 18528     IF NOT DISPLAY-CHANGE-RECORDS AND
 18529            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18530        GO TO 4005-READ-NEXT-RECORD.
 18531
 18532     IF DISPLAY-HOLD-RECORDS AND
 18533        NOT PB-RECORD-ON-HOLD
 18534          GO TO 4005-READ-NEXT-RECORD.
 18535
 18536     IF PB-ISSUE
 18537        IF DISPLAY-CHK-REQ-RECORDS
 18538            GO TO 4005-READ-NEXT-RECORD.
 18539
 18540     IF PB-ISSUE
 18541        IF ISSUE-WITH-WARNING
 18542           IF PB-WARNING-ERRORS
 18543              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18544                  GO TO 4005-READ-NEXT-RECORD
 18545              ELSE
 18546                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18547                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18548                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18549                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18550                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18551                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18552                 GO TO 7000-DISPLAY-ISSUES
 18553           ELSE
 18554              GO TO 4005-READ-NEXT-RECORD.
 18555
 18556     IF PB-ISSUE
 18557        IF (ISSUES-IN-ERROR AND
 18558            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18559            ALL-ISSUES
 18560            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18561            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18562            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18563            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18564            MOVE PB-SV-STATE            TO PI-SV-STATE
 18565            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18566            GO TO 7000-DISPLAY-ISSUES
 18567        ELSE
 18568            GO TO 4005-READ-NEXT-RECORD.
 18569
 18570     IF PB-CANCELLATION
 18571        IF DISPLAY-CHK-REQ-RECORDS
 18572           IF PB-C-REFUND-REQUESTED
 18573              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18574              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 340
* VP6311.cbl
 18575              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18576              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18577              MOVE PB-SV-STATE            TO PI-SV-STATE
 18578              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18579              GO TO 7100-DISPLAY-CANCELS
 18580           ELSE
 18581               GO TO 4005-READ-NEXT-RECORD.
 18582
 18583     IF PB-CANCELLATION
 18584        IF CANCEL-WITH-WARNING
 18585           IF PB-WARNING-ERRORS
 18586              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18587                  GO TO 4005-READ-NEXT-RECORD
 18588              ELSE
 18589                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18590                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18591                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18592                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18593                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18594                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18595                 GO TO 7100-DISPLAY-CANCELS
 18596           ELSE
 18597              GO TO 4005-READ-NEXT-RECORD.
 18598
 18599     IF PB-CANCELLATION
 18600        IF (CANCEL-IN-ERROR  AND
 18601            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18602            ALL-CANCELS
 18603            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18604            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18605            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18606            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18607            MOVE PB-SV-STATE            TO PI-SV-STATE
 18608            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18609            GO TO 7100-DISPLAY-CANCELS.
 18610
 18611     GO TO 4005-READ-NEXT-RECORD.
 18612
 18613 4050-END-RECORDS.
 18614******************************************************************
 18615*                                                                *
 18616*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18617*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING
 18618*         PROGRAM.                                               *
 18619*                                                                *
 18620******************************************************************
 18621
 18622     IF BROWSE-STARTED
 18623        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18624
 18625* EXEC CICS ENDBR
 18626*            DATASET  (FILE-ID-ERPNDB2)
 18627*       END-EXEC.
 18628     MOVE 0
 18629       TO DFHEIV11
 18630*    MOVE '&2                    $   #00015850' TO DFHEIV0
 18631     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 341
* VP6311.cbl
 18633     MOVE X'2020233030303135383530' TO DFHEIV0(25:11)
 18634     CALL 'kxdfhei1' USING DFHEIV0,
 18635           FILE-ID-ERPNDB2,
 18636           DFHEIV11,
 18637           DFHEIV99
 18638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18639
 18640
 18641     IF  EIBTRNID NOT = TRANS-EXB1
 18642         IF PENDING-BUS-RECS-FOUND
 18643             NEXT SENTENCE
 18644           ELSE
 18645             MOVE '9'            TO PI-BROWSE-SW
 18646             GO TO 9400-CLEAR.
 18647
 18648     IF SHOW-RECORD
 18649        MOVE ER-2253            TO EMI-ERROR
 18650       ELSE
 18651        MOVE ER-2254            TO EMI-ERROR.
 18652
 18653     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18654
 18655     IF PI-MAP-NAME = SPACES
 18656        MOVE -1                  TO DPFENTRL
 18657        MOVE VP631D               TO PI-MAP-NAME
 18658        GO TO 8100-SEND-INITIAL-MAP.
 18659
 18660     IF PI-MAP-NAME = VP631B
 18661        MOVE -1                  TO BMAINTL
 18662     ELSE
 18663        IF PI-MAP-NAME = VP631C
 18664           MOVE -1               TO CMAINTL
 18665        ELSE
 18666           MOVE -1               TO DPFENTRL.
 18667
 18668     GO TO 8200-SEND-DATAONLY.
 18669
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 342
* VP6311.cbl
 18671
 18672***************************************************************
 18673*                                                             *
 18674*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18675*                                                             *
 18676*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18677*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18678*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18679*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18680*                                                             *
 18681*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18682*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18683*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18684*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18685*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18686*                AND IS IT TO BE DISPLAYED.                   *
 18687*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18688*                DISPLAYED.                                   *
 18689*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18690*                DISPLAYED.                                   *
 18691*                                                             *
 18692*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18693*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18694*                                                             *
 18695*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18696*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18697*                THEY ARE NOT TO BE DISPLAYED.                *
 18698*                                                             *
 18699***************************************************************
 18700
 18701 4100-BROWSE-PRIMARY-FORWARD.
 18702     IF FIRST-TIME  OR SHOW-RECORD
 18703        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18704        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18705        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18706     ELSE
 18707        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18708        IF ERPNDB-BATCH-SEQ-NO = +9999
 18709           GO TO 4150-END-BATCH
 18710        ELSE
 18711           IF DISPLAY-CHANGE-RECORDS
 18712              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18713           ELSE
 18714              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18715              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18716
 18717     IF FIRST-TIME
 18718         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18719            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18720              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18721
 18722
 18723* EXEC CICS HANDLE CONDITION
 18724*         ENDFILE  (4150-END-BATCH)
 18725*    END-EXEC.
 18726*    MOVE '"$''                   ! J #00015935' TO DFHEIV0
 18727     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 343
* VP6311.cbl
 18729     MOVE X'4A20233030303135393335' TO DFHEIV0(25:11)
 18730     CALL 'kxdfhei1' USING DFHEIV0
 18731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18732
 18733
 18734 4105-READ-NEXT.
 18735
 18736* EXEC CICS HANDLE CONDITION
 18737*         NOTFND    (4150-END-BATCH)
 18738*    END-EXEC.
 18739*    MOVE '"$I                   ! K #00015940' TO DFHEIV0
 18740     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18742     MOVE X'4B20233030303135393430' TO DFHEIV0(25:11)
 18743     CALL 'kxdfhei1' USING DFHEIV0
 18744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18745
 18746
 18747     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18748
 18749     IF PI-DISPLAY-ORIGINAL-BATCH
 18750        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18751     ELSE
 18752        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18753
 18754
 18755* EXEC CICS READ
 18756*         DATASET   (FILE-ID)
 18757*         SET       (ADDRESS OF PENDING-BUSINESS)
 18758*         RIDFLD    (ERPNDB-KEY)
 18759*         GTEQ
 18760*    END-EXEC.
 18761*    MOVE '&"S        G          (   #00015951' TO DFHEIV0
 18762     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18764     MOVE X'2020233030303135393531' TO DFHEIV0(25:11)
 18765     CALL 'kxdfhei1' USING DFHEIV0,
 18766           FILE-ID,
 18767           DFHEIV20,
 18768           DFHEIV99,
 18769           ERPNDB-KEY,
 18770           DFHEIV99,
 18771           DFHEIV99,
 18772           DFHEIV99
 18773     SET ADDRESS OF PENDING-BUSINESS TO
 18774         DFHEIV20
 18775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18776
 18777
 18778     IF PI-DISPLAY-ORIGINAL-BATCH
 18779        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18780           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18781           GO TO 4150-END-BATCH
 18782        ELSE
 18783           IF PB-BATCH-TRAILER
 18784              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18785              GO TO 4105-READ-NEXT
 18786           ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 344
* VP6311.cbl
 18787              NEXT SENTENCE
 18788     ELSE
 18789        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18790           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18791           GO TO 4150-END-BATCH.
 18792
 18793     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18794
 18795     IF WS-BATCH-PREFIX = '#CL'
 18796         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18797         GO TO 4105-READ-NEXT.
 18798
 18799     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18800     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18801     MOVE PB-STATE               TO PI-PB-STATE.
 18802     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18803
 18804     IF PB-BATCH-TRAILER
 18805        IF SHOW-RECORD
 18806           GO TO 4150-END-BATCH
 18807        ELSE
 18808           MOVE ER-2251         TO EMI-ERROR
 18809           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18810           MOVE 1               TO PI-BROWSE-TYPE
 18811           GO TO 7200-DISPLAY-BATCHES.
 18812
 18813     IF SHOW-RECORD
 18814           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18815              GO TO 4110-BUMP-SEQ
 18816           ELSE
 18817              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18818                 GO TO 4110-BUMP-SEQ
 18819              ELSE
 18820                 GO TO 4107-CHECK-REC-TYPE.
 18821
 18822     IF NOT  PI-PRIMARY-WITH-SELECT
 18823        GO TO 4107-CHECK-REC-TYPE.
 18824
 18825     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18826        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18827           GO TO 4110-BUMP-SEQ
 18828        ELSE
 18829           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18830              GO TO 4107-CHECK-REC-TYPE
 18831           ELSE
 18832              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18833                 GO TO 4107-CHECK-REC-TYPE
 18834              ELSE
 18835                 GO TO 4110-BUMP-SEQ.
 18836
 18837     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18838        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18839           GO TO 4110-BUMP-SEQ.
 18840
 18841 4107-CHECK-REC-TYPE.
 18842     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18843         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18844             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 345
* VP6311.cbl
 18845           ELSE
 18846             GO TO 4110-BUMP-SEQ.
 18847
 18848     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18849         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18850             NEXT SENTENCE
 18851           ELSE
 18852             GO TO 4110-BUMP-SEQ.
 18853
 18854     IF NOT DISPLAY-CHANGE-RECORDS AND
 18855        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18856           GO TO 4110-BUMP-SEQ.
 18857
 18858     IF DISPLAY-HOLD-RECORDS AND
 18859        NOT PB-RECORD-ON-HOLD
 18860          GO TO 4110-BUMP-SEQ.
 18861
 18862     IF PB-ISSUE
 18863        IF DISPLAY-CHK-REQ-RECORDS
 18864            GO TO 4110-BUMP-SEQ.
 18865
 18866     IF PB-ISSUE
 18867        IF ISSUE-WITH-WARNING
 18868           IF PB-WARNING-ERRORS
 18869              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18870                  GO TO 4110-BUMP-SEQ
 18871              ELSE
 18872                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18873                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18874                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18875                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18876                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18877                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18878                 GO TO 7000-DISPLAY-ISSUES
 18879        ELSE
 18880            GO TO 4110-BUMP-SEQ.
 18881
 18882     IF PB-ISSUE
 18883        IF (ISSUES-IN-ERROR AND
 18884            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18885            ALL-ISSUES
 18886            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18887            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18888            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18889            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18890            MOVE PB-SV-STATE            TO PI-SV-STATE
 18891            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18892            GO TO 7000-DISPLAY-ISSUES
 18893        ELSE
 18894            GO TO 4110-BUMP-SEQ.
 18895
 18896     IF PB-CANCELLATION
 18897        IF DISPLAY-CHK-REQ-RECORDS
 18898           IF PB-C-REFUND-REQUESTED
 18899              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18900              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18901              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18902              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 346
* VP6311.cbl
 18903              MOVE PB-SV-STATE            TO PI-SV-STATE
 18904              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18905              GO TO 7100-DISPLAY-CANCELS
 18906           ELSE
 18907              GO TO 4110-BUMP-SEQ.
 18908
 18909     IF PB-CANCELLATION
 18910        IF CANCEL-WITH-WARNING
 18911           IF PB-WARNING-ERRORS
 18912              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18913                  GO TO 4110-BUMP-SEQ
 18914              ELSE
 18915                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18916                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18917                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18918                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18919                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18920                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18921                 GO TO 7100-DISPLAY-CANCELS
 18922           ELSE
 18923              GO TO 4110-BUMP-SEQ.
 18924
 18925     IF PB-CANCELLATION
 18926        IF (CANCEL-IN-ERROR  AND
 18927            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18928            ALL-CANCELS
 18929            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18930            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18931            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18932            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18933            MOVE PB-SV-STATE            TO PI-SV-STATE
 18934            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18935            GO TO 7100-DISPLAY-CANCELS.
 18936
 18937 4110-BUMP-SEQ.
 18938     IF NOT DISPLAY-CHANGE-RECORDS
 18939        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18940        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18941     ELSE
 18942        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18943           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18944           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18945        ELSE
 18946           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18947           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18948
 18949     GO TO 4105-READ-NEXT.
 18950
 18951 4150-END-BATCH.
 18952******************************************************************
 18953*                                                                *
 18954*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18955*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING     *
 18956*         PROGRAM.                                               *
 18957*                                                                *
 18958******************************************************************
 18959
 18960     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 347
* VP6311.cbl
 18961         IF PENDING-BUS-RECS-FOUND
 18962             NEXT SENTENCE
 18963           ELSE
 18964             MOVE '9'            TO PI-BROWSE-SW
 18965             GO TO 9400-CLEAR.
 18966
 18967     IF SHOW-RECORD
 18968        MOVE ER-2253             TO EMI-ERROR
 18969     ELSE
 18970        MOVE ER-2251             TO EMI-ERROR.
 18971
 18972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18973
 18974     IF PI-MAP-NAME = SPACES
 18975        MOVE -1                  TO BMAINTL
 18976        MOVE VP631B              TO PI-MAP-NAME
 18977        GO TO 8100-SEND-INITIAL-MAP.
 18978
 18979     IF PI-MAP-NAME = VP631B
 18980        MOVE -1                  TO BMAINTL
 18981     ELSE
 18982        IF PI-MAP-NAME = VP631C
 18983           MOVE -1               TO CMAINTL
 18984        ELSE
 18985           MOVE -1               TO DPFENTRL.
 18986
 18987     GO TO 8200-SEND-DATAONLY.
 18988
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 348
* VP6311.cbl
 18990
 18991***************************************************************
 18992*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18993*                                                             *
 18994*      1. START BROWSE WITH                                   *
 18995*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18996*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18997*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18998*                                                             *
 18999*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19000*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19001*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19002*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19003*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19004*               AND IS IT TO BE DISPLAYED.                    *
 19005*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19006*               DISPLAYED.                                    *
 19007*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19008*               DISPLAYED.                                    *
 19009*                                                             *
 19010*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19011*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19012***************************************************************
 19013
 19014 4200-BROWSE-CSR-FORWARD.
 19015
 19016     IF FIRST-TIME
 19017        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19018     ELSE
 19019        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19020
 19021
 19022* EXEC CICS HANDLE CONDITION
 19023*         NOTFND   (4250-END-RECORDS)
 19024*         ENDFILE  (4250-END-RECORDS)
 19025*    END-EXEC.
 19026*    MOVE '"$I''                  ! L #00016201' TO DFHEIV0
 19027     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19028     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19029     MOVE X'4C20233030303136323031' TO DFHEIV0(25:11)
 19030     CALL 'kxdfhei1' USING DFHEIV0
 19031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19032
 19033
 19034
 19035* EXEC CICS STARTBR
 19036*         DATASET   (FILE-ID-ERPNDB4)
 19037*         RIDFLD    (ERPNDB-CSR-KEY)
 19038*    END-EXEC.
 19039     MOVE 0
 19040       TO DFHEIV11
 19041*    MOVE '&,         G          &   #00016206' TO DFHEIV0
 19042     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19043     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19044     MOVE X'2020233030303136323036' TO DFHEIV0(25:11)
 19045     CALL 'kxdfhei1' USING DFHEIV0,
 19046           FILE-ID-ERPNDB4,
 19047           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 349
* VP6311.cbl
 19048           DFHEIV99,
 19049           DFHEIV11,
 19050           DFHEIV99
 19051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19052
 19053
 19054     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19055
 19056     IF FIRST-TIME
 19057        MOVE SPACE               TO WS-FIRST-TIME-SW
 19058        GO TO 4205-READ-NEXT-RECORD.
 19059
 19060
 19061* EXEC CICS READNEXT
 19062*         DATASET    (FILE-ID-ERPNDB4)
 19063*         SET        (ADDRESS OF PENDING-BUSINESS)
 19064*         RIDFLD     (ERPNDB-CSR-KEY)
 19065*    END-EXEC.
 19066     MOVE 0
 19067       TO DFHEIV11
 19068*    MOVE '&.S                   )   #00016217' TO DFHEIV0
 19069     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19070     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19071     MOVE X'2020233030303136323137' TO DFHEIV0(25:11)
 19072     CALL 'kxdfhei1' USING DFHEIV0,
 19073           FILE-ID-ERPNDB4,
 19074           DFHEIV20,
 19075           DFHEIV99,
 19076           ERPNDB-CSR-KEY,
 19077           DFHEIV99,
 19078           DFHEIV11,
 19079           DFHEIV99,
 19080           DFHEIV99
 19081     SET ADDRESS OF PENDING-BUSINESS TO
 19082         DFHEIV20
 19083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19084
 19085
 19086 4205-READ-NEXT-RECORD.
 19087
 19088
 19089* EXEC CICS READNEXT
 19090*         DATASET    (FILE-ID-ERPNDB4)
 19091*         SET        (ADDRESS OF PENDING-BUSINESS)
 19092*         RIDFLD     (ERPNDB-CSR-KEY)
 19093*    END-EXEC.
 19094     MOVE 0
 19095       TO DFHEIV11
 19096*    MOVE '&.S                   )   #00016225' TO DFHEIV0
 19097     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19098     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19099     MOVE X'2020233030303136323235' TO DFHEIV0(25:11)
 19100     CALL 'kxdfhei1' USING DFHEIV0,
 19101           FILE-ID-ERPNDB4,
 19102           DFHEIV20,
 19103           DFHEIV99,
 19104           ERPNDB-CSR-KEY,
 19105           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 350
* VP6311.cbl
 19106           DFHEIV11,
 19107           DFHEIV99,
 19108           DFHEIV99
 19109     SET ADDRESS OF PENDING-BUSINESS TO
 19110         DFHEIV20
 19111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19112
 19113
 19114     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19115
 19116     IF WS-BATCH-PREFIX = '#CL'
 19117        GO TO 4205-READ-NEXT-RECORD.
 19118
 19119     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19120        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19121        GO TO 4250-END-RECORDS.
 19122
 19123     IF PB-BATCH-TRAILER
 19124        GO TO 4205-READ-NEXT-RECORD.
 19125
 19126     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19127        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19128           GO TO 4205-READ-NEXT-RECORD
 19129        ELSE
 19130           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19131              GO TO 4210-CHECK-REC-TYPE
 19132           ELSE
 19133              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19134                 GO TO 4210-CHECK-REC-TYPE
 19135              ELSE
 19136                 GO TO 4205-READ-NEXT-RECORD.
 19137
 19138     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19139        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19140           GO TO 4205-READ-NEXT-RECORD.
 19141
 19142 4210-CHECK-REC-TYPE.
 19143     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19144         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19145             NEXT SENTENCE
 19146         ELSE
 19147             GO TO 4205-READ-NEXT-RECORD.
 19148
 19149     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19150         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19151             NEXT SENTENCE
 19152        ELSE
 19153             GO TO 4205-READ-NEXT-RECORD.
 19154
 19155     IF NOT DISPLAY-CHANGE-RECORDS AND
 19156            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19157        GO TO 4205-READ-NEXT-RECORD.
 19158
 19159     IF DISPLAY-HOLD-RECORDS AND
 19160        NOT PB-RECORD-ON-HOLD
 19161          GO TO 4205-READ-NEXT-RECORD.
 19162
 19163     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 351
* VP6311.cbl
 19164        IF DISPLAY-CHK-REQ-RECORDS
 19165            GO TO 4205-READ-NEXT-RECORD.
 19166
 19167     IF PB-ISSUE
 19168        IF ISSUE-WITH-WARNING
 19169           IF PB-WARNING-ERRORS
 19170              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19171                  GO TO 4205-READ-NEXT-RECORD
 19172              ELSE
 19173                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19174                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19175                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19176                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19177                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19178                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19179                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19180                 GO TO 7000-DISPLAY-ISSUES
 19181           ELSE
 19182              GO TO 4205-READ-NEXT-RECORD.
 19183
 19184     IF PB-ISSUE
 19185        IF (ISSUES-IN-ERROR AND
 19186            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19187            ALL-ISSUES
 19188            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19189            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19190            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19191            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19192            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19193            MOVE PB-SV-STATE            TO PI-SV-STATE
 19194            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19195            GO TO 7000-DISPLAY-ISSUES
 19196        ELSE
 19197            GO TO 4205-READ-NEXT-RECORD.
 19198
 19199     IF PB-CANCELLATION
 19200        IF DISPLAY-CHK-REQ-RECORDS
 19201           IF PB-C-REFUND-REQUESTED
 19202              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19203              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19204              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19205              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19206              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19207              MOVE PB-SV-STATE            TO PI-SV-STATE
 19208              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19209              GO TO 7100-DISPLAY-CANCELS
 19210           ELSE
 19211               GO TO 4205-READ-NEXT-RECORD.
 19212
 19213     IF PB-CANCELLATION
 19214        IF CANCEL-WITH-WARNING
 19215           IF PB-WARNING-ERRORS
 19216              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19217                  GO TO 4205-READ-NEXT-RECORD
 19218              ELSE
 19219                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19220                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19221                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 352
* VP6311.cbl
 19222                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19223                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19224                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19225                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19226                 GO TO 7100-DISPLAY-CANCELS
 19227           ELSE
 19228              GO TO 4205-READ-NEXT-RECORD.
 19229
 19230     IF PB-CANCELLATION
 19231        IF (CANCEL-IN-ERROR  AND
 19232            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19233            ALL-CANCELS
 19234            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19235            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19236            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19237            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19238            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19239            MOVE PB-SV-STATE            TO PI-SV-STATE
 19240            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19241            GO TO 7100-DISPLAY-CANCELS.
 19242
 19243     GO TO 4205-READ-NEXT-RECORD.
 19244
 19245 4250-END-RECORDS.
 19246******************************************************************
 19247*                                                                *
 19248*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19249*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING
 19250*         PROGRAM.                                               *
 19251*                                                                *
 19252******************************************************************
 19253
 19254     IF BROWSE-STARTED
 19255        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19256
 19257* EXEC CICS ENDBR
 19258*            DATASET  (FILE-ID-ERPNDB4)
 19259*       END-EXEC.
 19260     MOVE 0
 19261       TO DFHEIV11
 19262*    MOVE '&2                    $   #00016373' TO DFHEIV0
 19263     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19264     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19265     MOVE X'2020233030303136333733' TO DFHEIV0(25:11)
 19266     CALL 'kxdfhei1' USING DFHEIV0,
 19267           FILE-ID-ERPNDB4,
 19268           DFHEIV11,
 19269           DFHEIV99
 19270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19271
 19272
 19273     IF  EIBTRNID NOT = TRANS-EXB1
 19274         IF PENDING-BUS-RECS-FOUND
 19275             NEXT SENTENCE
 19276           ELSE
 19277             MOVE '9'            TO PI-BROWSE-SW
 19278             GO TO 9400-CLEAR.
 19279
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 353
* VP6311.cbl
 19280     IF SHOW-RECORD
 19281        MOVE ER-2253            TO EMI-ERROR
 19282       ELSE
 19283        MOVE ER-2254            TO EMI-ERROR.
 19284
 19285     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19286
 19287     IF PI-MAP-NAME = SPACES
 19288        MOVE -1                  TO DPFENTRL
 19289        MOVE VP631D               TO PI-MAP-NAME
 19290        GO TO 8100-SEND-INITIAL-MAP.
 19291
 19292     IF PI-MAP-NAME = VP631B
 19293        MOVE -1                  TO BMAINTL
 19294     ELSE
 19295        IF PI-MAP-NAME = VP631C
 19296           MOVE -1               TO CMAINTL
 19297        ELSE
 19298           MOVE -1               TO DPFENTRL.
 19299
 19300     GO TO 8200-SEND-DATAONLY.
 19301
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 354
* VP6311.cbl
 19303
 19304***************************************************************
 19305*                                                             *
 19306*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19307*                                                             *
 19308*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19309*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19310*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19311*                                                             *
 19312*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19313*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19314*          A. IS IT WITHIN THE SAME COMPANY                   *
 19315*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19316*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19317*                AND IS IT TO BE DISPLAYED.                   *
 19318*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19319*                DISPLAYED.                                   *
 19320*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19321*                DISPLAYED.                                   *
 19322*                                                             *
 19323*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19324*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19325*                                                             *
 19326*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19327*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19328*                THEY ARE NOT TO BE DISPLAYED.                *
 19329*                                                             *
 19330***************************************************************
 19331
 19332 4300-BROWSE-FILE-FORWARD.
 19333     IF FIRST-TIME OR SHOW-RECORD
 19334        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19335        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19336        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19337     ELSE
 19338        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19339        IF ERPNDB-BATCH-SEQ-NO = +9999
 19340           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19341        ELSE
 19342           IF DISPLAY-CHANGE-RECORDS
 19343              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19344           ELSE
 19345              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19346              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19347
 19348
 19349* EXEC CICS HANDLE CONDITION
 19350*         ENDFILE  (4350-END-BATCH)
 19351*         NOTFND   (4350-END-BATCH)
 19352*    END-EXEC.
 19353*    MOVE '"$''I                  ! M #00016452' TO DFHEIV0
 19354     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19356     MOVE X'4D20233030303136343532' TO DFHEIV0(25:11)
 19357     CALL 'kxdfhei1' USING DFHEIV0
 19358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19359
 19360
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 355
* VP6311.cbl
 19361 4305-READ-NEXT.
 19362     IF PI-DISPLAY-ORIGINAL-BATCH
 19363        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19364     ELSE
 19365        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19366
 19367
 19368* EXEC CICS READ
 19369*         DATASET   (FILE-ID)
 19370*         SET       (ADDRESS OF PENDING-BUSINESS)
 19371*         RIDFLD    (ERPNDB-KEY)
 19372*         GTEQ
 19373*    END-EXEC.
 19374*    MOVE '&"S        G          (   #00016463' TO DFHEIV0
 19375     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19377     MOVE X'2020233030303136343633' TO DFHEIV0(25:11)
 19378     CALL 'kxdfhei1' USING DFHEIV0,
 19379           FILE-ID,
 19380           DFHEIV20,
 19381           DFHEIV99,
 19382           ERPNDB-KEY,
 19383           DFHEIV99,
 19384           DFHEIV99,
 19385           DFHEIV99
 19386     SET ADDRESS OF PENDING-BUSINESS TO
 19387         DFHEIV20
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19389
 19390
 19391     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19392        GO TO 4350-END-BATCH.
 19393
 19394     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19395                                    WS-BATCH-NO.
 19396
 19397     IF  WS-BATCH-PREFIX = '#CL'
 19398         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19399         GO TO 4305-READ-NEXT.
 19400
 19401     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19402     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19403     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19404     MOVE PB-STATE               TO PI-PB-STATE.
 19405     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19406
 19407     IF PB-BATCH-TRAILER
 19408        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19409        GO TO 4305-READ-NEXT.
 19410
 19411     IF SHOW-RECORD
 19412           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19413              GO TO 4310-BUMP-SEQ
 19414           ELSE
 19415              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19416                 GO TO 4310-BUMP-SEQ
 19417              ELSE
 19418                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 356
* VP6311.cbl
 19419
 19420     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19421        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19422           GO TO 4310-BUMP-SEQ
 19423        ELSE
 19424           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19425              GO TO 4307-CHECK-REC-TYPE
 19426           ELSE
 19427              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19428                 GO TO 4307-CHECK-REC-TYPE
 19429              ELSE
 19430                 GO TO 4310-BUMP-SEQ.
 19431
 19432     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19433        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19434           GO TO 4310-BUMP-SEQ.
 19435
 19436 4307-CHECK-REC-TYPE.
 19437     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19438         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19439             NEXT SENTENCE
 19440         ELSE
 19441             GO TO 4310-BUMP-SEQ.
 19442
 19443     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19444         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19445             NEXT SENTENCE
 19446        ELSE
 19447             GO TO 4310-BUMP-SEQ.
 19448
 19449     IF NOT DISPLAY-CHANGE-RECORDS AND
 19450            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19451        GO TO 4310-BUMP-SEQ.
 19452
 19453     IF DISPLAY-HOLD-RECORDS AND
 19454        NOT PB-RECORD-ON-HOLD
 19455          GO TO 4310-BUMP-SEQ.
 19456
 19457     IF PB-ISSUE
 19458        IF DISPLAY-CHK-REQ-RECORDS
 19459           GO TO 4310-BUMP-SEQ.
 19460
 19461     IF PB-ISSUE
 19462        IF ISSUE-WITH-WARNING
 19463           IF PB-WARNING-ERRORS
 19464              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19465                  GO TO 4310-BUMP-SEQ
 19466              ELSE
 19467                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19468                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19469                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19470                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19471                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19472                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19473                 GO TO 7000-DISPLAY-ISSUES
 19474           ELSE
 19475              GO TO 4310-BUMP-SEQ.
 19476
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 357
* VP6311.cbl
 19477     IF PB-ISSUE
 19478        IF (ISSUES-IN-ERROR AND
 19479            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19480            ALL-ISSUES
 19481            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19482            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19483            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19484            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19485            MOVE PB-SV-STATE            TO PI-SV-STATE
 19486            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19487            GO TO 7000-DISPLAY-ISSUES
 19488        ELSE
 19489            GO TO 4310-BUMP-SEQ.
 19490
 19491     IF PB-CANCELLATION
 19492        IF DISPLAY-CHK-REQ-RECORDS
 19493           IF PB-C-REFUND-REQUESTED
 19494              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19495              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19496              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19497              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19498              MOVE PB-SV-STATE            TO PI-SV-STATE
 19499              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19500              GO TO 7100-DISPLAY-CANCELS
 19501           ELSE
 19502              GO TO 4310-BUMP-SEQ.
 19503
 19504     IF PB-CANCELLATION
 19505        IF CANCEL-WITH-WARNING
 19506           IF PB-WARNING-ERRORS
 19507              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19508                  GO TO 4310-BUMP-SEQ
 19509              ELSE
 19510                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19511                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19512                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19513                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19514                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19515                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19516                 GO TO 7100-DISPLAY-CANCELS
 19517           ELSE
 19518              GO TO 4310-BUMP-SEQ.
 19519
 19520     IF PB-CANCELLATION
 19521        IF (CANCEL-IN-ERROR  AND
 19522            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19523            ALL-CANCELS
 19524            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19525            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19526            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19527            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19528            MOVE PB-SV-STATE            TO PI-SV-STATE
 19529            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19530            GO TO 7100-DISPLAY-CANCELS.
 19531
 19532 4310-BUMP-SEQ.
 19533     IF NOT DISPLAY-CHANGE-RECORDS
 19534        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 358
* VP6311.cbl
 19535        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19536     ELSE
 19537        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19538           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19539           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19540        ELSE
 19541           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19542           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19543
 19544     GO TO 4305-READ-NEXT.
 19545
 19546 4350-END-BATCH.
 19547
 19548******************************************************************
 19549*                                                                *
 19550*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19551*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING    *
 19552*         PROGRAM.                                               *
 19553*                                                                *
 19554******************************************************************
 19555
 19556     IF  EIBTRNID NOT = TRANS-EXB1
 19557         IF PENDING-BUS-RECS-FOUND
 19558             NEXT SENTENCE
 19559           ELSE
 19560             MOVE '9'            TO PI-BROWSE-SW
 19561             GO TO 9400-CLEAR.
 19562
 19563     IF SHOW-RECORD
 19564        MOVE ER-2253            TO EMI-ERROR
 19565     ELSE
 19566        MOVE ER-2251            TO EMI-ERROR.
 19567
 19568     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19569
 19570     IF PI-MAP-NAME = SPACES
 19571        MOVE -1                  TO BMAINTL
 19572        MOVE VP631B               TO PI-MAP-NAME
 19573        GO TO 8100-SEND-INITIAL-MAP.
 19574
 19575     IF PI-MAP-NAME = VP631B
 19576        MOVE -1                  TO BMAINTL
 19577     ELSE
 19578        IF PI-MAP-NAME = VP631C
 19579           MOVE -1               TO CMAINTL
 19580        ELSE
 19581           MOVE -1               TO DPFENTRL.
 19582
 19583     GO TO 8200-SEND-DATAONLY.
 19584
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 359
* VP6311.cbl
 19586
 19587******************************************************************
 19588*                                                                *
 19589*        B R O W S E   D E T A I L   B A C K W A R D             *
 19590*                                                                *
 19591******************************************************************
 19592
 19593 4500-BROWSE-DETAIL-BACKWARD.
 19594
 19595     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19596
 19597
 19598* EXEC CICS HANDLE CONDITION
 19599*         NOTFND   (4570-NOT-FOUND)
 19600*         ENDFILE  (4550-END-RECORDS)
 19601*    END-EXEC
 19602*    MOVE '"$I''                  ! N #00016676' TO DFHEIV0
 19603     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19605     MOVE X'4E20233030303136363736' TO DFHEIV0(25:11)
 19606     CALL 'kxdfhei1' USING DFHEIV0
 19607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19608
 19609
 19610* EXEC CICS STARTBR
 19611*         DATASET   (FILE-ID-ERPNDB2)
 19612*         RIDFLD    (ERPNDB-ALT-KEY)
 19613*    END-EXEC.
 19614     MOVE 0
 19615       TO DFHEIV11
 19616*    MOVE '&,         G          &   #00016681' TO DFHEIV0
 19617     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19618     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19619     MOVE X'2020233030303136363831' TO DFHEIV0(25:11)
 19620     CALL 'kxdfhei1' USING DFHEIV0,
 19621           FILE-ID-ERPNDB2,
 19622           ERPNDB-ALT-KEY,
 19623           DFHEIV99,
 19624           DFHEIV11,
 19625           DFHEIV99
 19626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19627
 19628
 19629     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19630                                    WS-FIRST-TIME-SW.
 19631
 19632 4505-READ-PREV-RECORD.
 19633
 19634* EXEC CICS READPREV
 19635*         DATASET    (FILE-ID-ERPNDB2)
 19636*         SET        (ADDRESS OF PENDING-BUSINESS)
 19637*         RIDFLD     (ERPNDB-ALT-KEY)
 19638*    END-EXEC.
 19639     MOVE 0
 19640       TO DFHEIV11
 19641*    MOVE '&0S                   )   #00016690' TO DFHEIV0
 19642     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19643     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 360
* VP6311.cbl
 19644     MOVE X'2020233030303136363930' TO DFHEIV0(25:11)
 19645     CALL 'kxdfhei1' USING DFHEIV0,
 19646           FILE-ID-ERPNDB2,
 19647           DFHEIV20,
 19648           DFHEIV99,
 19649           ERPNDB-ALT-KEY,
 19650           DFHEIV99,
 19651           DFHEIV11,
 19652           DFHEIV99,
 19653           DFHEIV99
 19654     SET ADDRESS OF PENDING-BUSINESS TO
 19655         DFHEIV20
 19656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19657
 19658
 19659     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19660
 19661     IF WS-BATCH-PREFIX = '#CL'
 19662         GO TO 4505-READ-PREV-RECORD.
 19663
 19664     IF FIRST-TIME
 19665         MOVE SPACE               TO WS-FIRST-TIME-SW
 19666         GO TO 4505-READ-PREV-RECORD.
 19667
 19668     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19669        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19670        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19671        PB-STATE         NOT = PI-PB-STATE    OR
 19672        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19673          GO TO 4550-END-RECORDS.
 19674
 19675
 19676     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19677
 19678     IF PB-BATCH-TRAILER
 19679        GO TO 4505-READ-PREV-RECORD.
 19680
 19681     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19682
 19683     IF  WS-BATCH-PREFIX = '#CL'
 19684         GO TO 4505-READ-PREV-RECORD.
 19685
 19686     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19687        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19688           GO TO 4505-READ-PREV-RECORD
 19689        ELSE
 19690           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19691              GO TO 4510-CHECK-REC-TYPE
 19692           ELSE
 19693              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19694                 GO TO 4510-CHECK-REC-TYPE
 19695              ELSE
 19696                 GO TO 4505-READ-PREV-RECORD.
 19697
 19698     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19699        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19700           GO TO 4505-READ-PREV-RECORD.
 19701
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 361
* VP6311.cbl
 19702 4510-CHECK-REC-TYPE.
 19703     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19704         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19705             NEXT SENTENCE
 19706         ELSE
 19707             GO TO 4505-READ-PREV-RECORD.
 19708
 19709     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19710         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19711             NEXT SENTENCE
 19712        ELSE
 19713             GO TO 4505-READ-PREV-RECORD.
 19714
 19715     IF NOT DISPLAY-CHANGE-RECORDS AND
 19716            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19717        GO TO 4505-READ-PREV-RECORD.
 19718
 19719     IF DISPLAY-HOLD-RECORDS AND
 19720        NOT PB-RECORD-ON-HOLD
 19721          GO TO 4505-READ-PREV-RECORD.
 19722
 19723     IF PB-ISSUE
 19724        IF DISPLAY-CHK-REQ-RECORDS
 19725           GO TO 4505-READ-PREV-RECORD.
 19726
 19727     IF PB-ISSUE
 19728        IF ISSUE-WITH-WARNING
 19729           IF PB-WARNING-ERRORS
 19730              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19731                  GO TO 4505-READ-PREV-RECORD
 19732              ELSE
 19733                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19734                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19735                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19736                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19737                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19738                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19739                 GO TO 7000-DISPLAY-ISSUES
 19740           ELSE
 19741              GO TO 4505-READ-PREV-RECORD.
 19742
 19743     IF PB-ISSUE
 19744        IF (ISSUES-IN-ERROR AND
 19745            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19746            ALL-ISSUES
 19747            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19748            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19749            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19750            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19751            MOVE PB-SV-STATE            TO PI-SV-STATE
 19752            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19753            GO TO 7000-DISPLAY-ISSUES
 19754        ELSE
 19755            GO TO 4505-READ-PREV-RECORD.
 19756
 19757     IF PB-CANCELLATION
 19758        IF DISPLAY-CHK-REQ-RECORDS
 19759           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 362
* VP6311.cbl
 19760              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19761              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19762              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19763              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19764              MOVE PB-SV-STATE            TO PI-SV-STATE
 19765              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19766              GO TO 7100-DISPLAY-CANCELS
 19767           ELSE
 19768              GO TO 4505-READ-PREV-RECORD.
 19769
 19770     IF PB-CANCELLATION
 19771        IF CANCEL-WITH-WARNING
 19772           IF PB-WARNING-ERRORS
 19773              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19774                  GO TO 4505-READ-PREV-RECORD
 19775              ELSE
 19776                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19777                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19778                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19779                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19780                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19781                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19782                 GO TO 7100-DISPLAY-CANCELS
 19783           ELSE
 19784              GO TO 4505-READ-PREV-RECORD.
 19785
 19786     IF PB-CANCELLATION
 19787        IF (CANCEL-IN-ERROR  AND
 19788            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19789            ALL-CANCELS
 19790            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19791            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19792            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19793            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19794            MOVE PB-SV-STATE            TO PI-SV-STATE
 19795            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19796            GO TO 7100-DISPLAY-CANCELS.
 19797
 19798     GO TO 4505-READ-PREV-RECORD.
 19799
 19800 4550-END-RECORDS.
 19801     IF PI-MAP-NAME = VP631B
 19802        MOVE -1                  TO BMAINTL
 19803     ELSE
 19804        IF PI-MAP-NAME = VP631C
 19805           MOVE -1               TO CMAINTL
 19806        ELSE
 19807           MOVE -1               TO DPFENTRL.
 19808
 19809     MOVE ER-2255               TO EMI-ERROR.
 19810     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19811     GO TO 8200-SEND-DATAONLY.
 19812
 19813 4570-NOT-FOUND.
 19814
 19815******************************************************************
 19816*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19817******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 363
* VP6311.cbl
 19818
 19819
 19820* EXEC CICS RESETBR
 19821*         DATASET    (FILE-ID-ERPNDB2)
 19822*         RIDFLD     (ERPNDB-ALT-KEY)
 19823*    END-EXEC.
 19824     MOVE 0
 19825       TO DFHEIV11
 19826*    MOVE '&4         G          &   #00016856' TO DFHEIV0
 19827     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19828     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19829     MOVE X'2020233030303136383536' TO DFHEIV0(25:11)
 19830     CALL 'kxdfhei1' USING DFHEIV0,
 19831           FILE-ID-ERPNDB2,
 19832           ERPNDB-ALT-KEY,
 19833           DFHEIV99,
 19834           DFHEIV11,
 19835           DFHEIV99
 19836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19837
 19838
 19839
 19840* EXEC CICS READNEXT
 19841*         DATASET    (FILE-ID-ERPNDB2)
 19842*         SET        (ADDRESS OF PENDING-BUSINESS)
 19843*         RIDFLD     (ERPNDB-ALT-KEY)
 19844*    END-EXEC.
 19845     MOVE 0
 19846       TO DFHEIV11
 19847*    MOVE '&.S                   )   #00016861' TO DFHEIV0
 19848     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19849     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19850     MOVE X'2020233030303136383631' TO DFHEIV0(25:11)
 19851     CALL 'kxdfhei1' USING DFHEIV0,
 19852           FILE-ID-ERPNDB2,
 19853           DFHEIV20,
 19854           DFHEIV99,
 19855           ERPNDB-ALT-KEY,
 19856           DFHEIV99,
 19857           DFHEIV11,
 19858           DFHEIV99,
 19859           DFHEIV99
 19860     SET ADDRESS OF PENDING-BUSINESS TO
 19861         DFHEIV20
 19862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19863
 19864
 19865
 19866* EXEC CICS READPREV
 19867*         DATASET    (FILE-ID-ERPNDB2)
 19868*         SET        (ADDRESS OF PENDING-BUSINESS)
 19869*         RIDFLD     (ERPNDB-ALT-KEY)
 19870*    END-EXEC.
 19871     MOVE 0
 19872       TO DFHEIV11
 19873*    MOVE '&0S                   )   #00016867' TO DFHEIV0
 19874     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19875     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 364
* VP6311.cbl
 19876     MOVE X'2020233030303136383637' TO DFHEIV0(25:11)
 19877     CALL 'kxdfhei1' USING DFHEIV0,
 19878           FILE-ID-ERPNDB2,
 19879           DFHEIV20,
 19880           DFHEIV99,
 19881           ERPNDB-ALT-KEY,
 19882           DFHEIV99,
 19883           DFHEIV11,
 19884           DFHEIV99,
 19885           DFHEIV99
 19886     SET ADDRESS OF PENDING-BUSINESS TO
 19887         DFHEIV20
 19888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19889
 19890
 19891 4580-READ-PREV-RECORD.
 19892
 19893* EXEC CICS READPREV
 19894*         DATASET    (FILE-ID-ERPNDB2)
 19895*         SET        (ADDRESS OF PENDING-BUSINESS)
 19896*         RIDFLD     (ERPNDB-ALT-KEY)
 19897*    END-EXEC.
 19898     MOVE 0
 19899       TO DFHEIV11
 19900*    MOVE '&0S                   )   #00016874' TO DFHEIV0
 19901     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19902     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19903     MOVE X'2020233030303136383734' TO DFHEIV0(25:11)
 19904     CALL 'kxdfhei1' USING DFHEIV0,
 19905           FILE-ID-ERPNDB2,
 19906           DFHEIV20,
 19907           DFHEIV99,
 19908           ERPNDB-ALT-KEY,
 19909           DFHEIV99,
 19910           DFHEIV11,
 19911           DFHEIV99,
 19912           DFHEIV99
 19913     SET ADDRESS OF PENDING-BUSINESS TO
 19914         DFHEIV20
 19915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19916
 19917
 19918     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19919
 19920     IF WS-BATCH-PREFIX = '#CL'
 19921        GO TO 4580-READ-PREV-RECORD.
 19922
 19923     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19924     GO TO 4505-READ-PREV-RECORD.
 19925
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 365
* VP6311.cbl
 19927
 19928******************************************************************
 19929*                                                                *
 19930*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19931*                                                                *
 19932******************************************************************
 19933
 19934 4600-BROWSE-PRIMARY-BACKWARD.
 19935        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19936
 19937     IF ERPNDB-BATCH-SEQ-NO = +9999
 19938        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19939
 19940        IF ERPNDB-BATCH-SEQ-NO = +0000
 19941           GO TO 4650-END-BATCH
 19942        ELSE
 19943           IF PI-MAP-NAME NOT = VP631D
 19944              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19945                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19946              ELSE
 19947                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19948                 IF DISPLAY-CHANGE-RECORDS
 19949                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19950                 ELSE
 19951                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19952
 19953
 19954* EXEC CICS HANDLE CONDITION
 19955*         NOTFND    (4680-NOT-FOUND)
 19956*         ENDFILE   (4680-NOT-FOUND)
 19957*    END-EXEC.
 19958*    MOVE '"$I''                  ! O #00016915' TO DFHEIV0
 19959     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19961     MOVE X'4F20233030303136393135' TO DFHEIV0(25:11)
 19962     CALL 'kxdfhei1' USING DFHEIV0
 19963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19964
 19965
 19966 4605-READ-NEXT.
 19967     IF ERPNDB-BATCH-SEQ-NO = +0000
 19968        GO TO 4650-END-BATCH.
 19969
 19970     IF PI-DISPLAY-ORIGINAL-BATCH
 19971        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19972     ELSE
 19973        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19974
 19975
 19976* EXEC CICS READ
 19977*         DATASET   (FILE-ID)
 19978*         SET       (ADDRESS OF PENDING-BUSINESS)
 19979*         RIDFLD    (ERPNDB-KEY)
 19980*    END-EXEC.
 19981*    MOVE '&"S        E          (   #00016929' TO DFHEIV0
 19982     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19983     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19984     MOVE X'2020233030303136393239' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 366
* VP6311.cbl
 19985     CALL 'kxdfhei1' USING DFHEIV0,
 19986           FILE-ID,
 19987           DFHEIV20,
 19988           DFHEIV99,
 19989           ERPNDB-KEY,
 19990           DFHEIV99,
 19991           DFHEIV99,
 19992           DFHEIV99
 19993     SET ADDRESS OF PENDING-BUSINESS TO
 19994         DFHEIV20
 19995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19996
 19997
 19998     IF NOT  PI-PRIMARY-WITH-SELECT
 19999        GO TO 4607-CHECK-REC-TYPE.
 20000
 20001     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20002
 20003     IF  WS-BATCH-PREFIX = '#CL'
 20004         GO TO 4610-BUMP-SEQ.
 20005
 20006     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20007        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20008           GO TO 4610-BUMP-SEQ
 20009        ELSE
 20010           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20011              GO TO 4607-CHECK-REC-TYPE
 20012           ELSE
 20013              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20014                 GO TO 4607-CHECK-REC-TYPE
 20015              ELSE
 20016                 GO TO 4610-BUMP-SEQ.
 20017
 20018     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20019        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20020           GO TO 4610-BUMP-SEQ.
 20021
 20022 4607-CHECK-REC-TYPE.
 20023     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20024         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20025             NEXT SENTENCE
 20026         ELSE
 20027             GO TO 4610-BUMP-SEQ.
 20028
 20029     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20030         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20031             NEXT SENTENCE
 20032        ELSE
 20033             GO TO 4610-BUMP-SEQ.
 20034
 20035     IF NOT DISPLAY-CHANGE-RECORDS AND
 20036            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20037        GO TO 4610-BUMP-SEQ.
 20038
 20039     IF DISPLAY-HOLD-RECORDS AND
 20040        NOT PB-RECORD-ON-HOLD
 20041          GO TO 4610-BUMP-SEQ.
 20042
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 367
* VP6311.cbl
 20043     IF PB-ISSUE
 20044        IF DISPLAY-CHK-REQ-RECORDS
 20045           GO TO 4610-BUMP-SEQ.
 20046
 20047     IF PB-ISSUE
 20048        IF ISSUE-WITH-WARNING
 20049           IF PB-WARNING-ERRORS
 20050              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20051                  GO TO 4610-BUMP-SEQ
 20052              ELSE
 20053                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20054                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20055                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20056                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20057                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20058                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20059                 GO TO 7000-DISPLAY-ISSUES
 20060           ELSE
 20061              GO TO 4610-BUMP-SEQ.
 20062
 20063     IF PB-ISSUE
 20064        IF (ISSUES-IN-ERROR AND
 20065            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20066            ALL-ISSUES
 20067            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20068            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20069            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20070            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20071            MOVE PB-SV-STATE            TO PI-SV-STATE
 20072            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20073            GO TO 7000-DISPLAY-ISSUES
 20074        ELSE
 20075            GO TO 4610-BUMP-SEQ.
 20076
 20077     IF PB-CANCELLATION
 20078        IF DISPLAY-CHK-REQ-RECORDS
 20079           IF PB-C-REFUND-REQUESTED
 20080              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20081              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20082              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20083              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20084              MOVE PB-SV-STATE            TO PI-SV-STATE
 20085              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20086              GO TO 7100-DISPLAY-CANCELS
 20087           ELSE
 20088              GO TO 4610-BUMP-SEQ.
 20089
 20090     IF PB-CANCELLATION
 20091        IF CANCEL-WITH-WARNING
 20092           IF PB-WARNING-ERRORS
 20093              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20094                  GO TO 4610-BUMP-SEQ
 20095              ELSE
 20096                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20097                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20098                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20099                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20100                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 368
* VP6311.cbl
 20101                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20102                 GO TO 7100-DISPLAY-CANCELS
 20103           ELSE
 20104              GO TO 4610-BUMP-SEQ.
 20105
 20106     IF PB-CANCELLATION
 20107        IF (CANCEL-IN-ERROR  AND
 20108            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20109            ALL-CANCELS
 20110            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20111            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20112            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20113            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20114            MOVE PB-SV-STATE            TO PI-SV-STATE
 20115            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20116            GO TO 7100-DISPLAY-CANCELS.
 20117
 20118 4610-BUMP-SEQ.
 20119     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20120        GO TO 4650-END-BATCH.
 20121
 20122     IF DISPLAY-CHANGE-RECORDS
 20123        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20124           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20125        ELSE
 20126           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20127           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20128        ELSE
 20129           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20130           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20131
 20132        GO TO 4605-READ-NEXT.
 20133
 20134 4650-END-BATCH.
 20135     IF PI-MAP-NAME = VP631B
 20136        MOVE -1                  TO BMAINTL
 20137     ELSE
 20138        IF PI-MAP-NAME = VP631C
 20139           MOVE -1               TO CMAINTL
 20140        ELSE
 20141           MOVE -1               TO DPFENTRL.
 20142
 20143     MOVE ER-2252               TO EMI-ERROR.
 20144     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20145     GO TO 8200-SEND-DATAONLY.
 20146
 20147 4680-NOT-FOUND.
 20148     IF DISPLAY-CHANGE-RECORDS
 20149        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20150           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20151        ELSE
 20152           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20153           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20154     ELSE
 20155        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20156
 20157     GO TO 4605-READ-NEXT.
 20158
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 369
* VP6311.cbl
 20160
 20161******************************************************************
 20162*                                                                *
 20163*        B R O W S E   F I L E   B A C K W A R D S               *
 20164*                                                                *
 20165******************************************************************
 20166
 20167 4800-BROWSE-FILE-BACKWARD.
 20168
 20169* EXEC CICS HANDLE CONDITION
 20170*         NOTFND   (4860-NOT-FOUND)
 20171*         ENDFILE  (4850-END-RECORDS)
 20172*    END-EXEC.
 20173*    MOVE '"$I''                  ! P #00017105' TO DFHEIV0
 20174     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20176     MOVE X'5020233030303137313035' TO DFHEIV0(25:11)
 20177     CALL 'kxdfhei1' USING DFHEIV0
 20178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20179
 20180
 20181     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20182
 20183     IF PI-DISPLAY-ORIGINAL-BATCH
 20184        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20185     ELSE
 20186        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20187
 20188
 20189* EXEC CICS STARTBR
 20190*         DATASET   (FILE-ID)
 20191*         RIDFLD    (ERPNDB-KEY)
 20192*    END-EXEC.
 20193     MOVE 0
 20194       TO DFHEIV11
 20195*    MOVE '&,         G          &   #00017117' TO DFHEIV0
 20196     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20197     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20198     MOVE X'2020233030303137313137' TO DFHEIV0(25:11)
 20199     CALL 'kxdfhei1' USING DFHEIV0,
 20200           FILE-ID,
 20201           ERPNDB-KEY,
 20202           DFHEIV99,
 20203           DFHEIV11,
 20204           DFHEIV99
 20205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20206
 20207
 20208     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20209
 20210
 20211* EXEC CICS READPREV
 20212*         DATASET    (FILE-ID-ERPNDB)
 20213*         SET        (ADDRESS OF PENDING-BUSINESS)
 20214*         RIDFLD     (ERPNDB-KEY)
 20215*    END-EXEC.
 20216     MOVE 0
 20217       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 370
* VP6311.cbl
 20218*    MOVE '&0S                   )   #00017124' TO DFHEIV0
 20219     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20220     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20221     MOVE X'2020233030303137313234' TO DFHEIV0(25:11)
 20222     CALL 'kxdfhei1' USING DFHEIV0,
 20223           FILE-ID-ERPNDB,
 20224           DFHEIV20,
 20225           DFHEIV99,
 20226           ERPNDB-KEY,
 20227           DFHEIV99,
 20228           DFHEIV11,
 20229           DFHEIV99,
 20230           DFHEIV99
 20231     SET ADDRESS OF PENDING-BUSINESS TO
 20232         DFHEIV20
 20233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20234
 20235
 20236 4810-READ-PREV-RECORD.
 20237
 20238* EXEC CICS READPREV
 20239*         DATASET    (FILE-ID-ERPNDB)
 20240*         SET        (ADDRESS OF PENDING-BUSINESS)
 20241*         RIDFLD     (ERPNDB-KEY)
 20242*    END-EXEC.
 20243     MOVE 0
 20244       TO DFHEIV11
 20245*    MOVE '&0S                   )   #00017131' TO DFHEIV0
 20246     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20247     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20248     MOVE X'2020233030303137313331' TO DFHEIV0(25:11)
 20249     CALL 'kxdfhei1' USING DFHEIV0,
 20250           FILE-ID-ERPNDB,
 20251           DFHEIV20,
 20252           DFHEIV99,
 20253           ERPNDB-KEY,
 20254           DFHEIV99,
 20255           DFHEIV11,
 20256           DFHEIV99,
 20257           DFHEIV99
 20258     SET ADDRESS OF PENDING-BUSINESS TO
 20259         DFHEIV20
 20260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20261
 20262
 20263     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20264        GO TO 4850-END-RECORDS.
 20265
 20266     IF PB-BATCH-TRAILER
 20267        GO TO 4810-READ-PREV-RECORD.
 20268
 20269     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20270
 20271     IF  WS-BATCH-PREFIX = '#CL'
 20272         GO TO 4810-READ-PREV-RECORD.
 20273
 20274     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20275        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 371
* VP6311.cbl
 20276           GO TO 4810-READ-PREV-RECORD
 20277        ELSE
 20278           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20279              GO TO 4820-CHECK-REC-TYPE
 20280           ELSE
 20281              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20282                 GO TO 4820-CHECK-REC-TYPE
 20283              ELSE
 20284                 GO TO 4810-READ-PREV-RECORD.
 20285
 20286     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20287        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20288           GO TO 4810-READ-PREV-RECORD.
 20289
 20290 4820-CHECK-REC-TYPE.
 20291     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20292         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20293             NEXT SENTENCE
 20294         ELSE
 20295             GO TO 4810-READ-PREV-RECORD.
 20296
 20297     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20298         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20299             NEXT SENTENCE
 20300        ELSE
 20301             GO TO 4810-READ-PREV-RECORD.
 20302
 20303     IF NOT DISPLAY-CHANGE-RECORDS AND
 20304            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20305        GO TO 4810-READ-PREV-RECORD.
 20306
 20307     IF DISPLAY-HOLD-RECORDS AND
 20308        NOT PB-RECORD-ON-HOLD
 20309          GO TO 4810-READ-PREV-RECORD.
 20310
 20311     IF PB-ISSUE
 20312        IF DISPLAY-CHK-REQ-RECORDS
 20313           GO TO 4810-READ-PREV-RECORD.
 20314
 20315     IF PB-ISSUE
 20316        IF ISSUE-WITH-WARNING
 20317           IF PB-WARNING-ERRORS
 20318              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20319                  GO TO 4810-READ-PREV-RECORD
 20320              ELSE
 20321                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20322                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20323                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20324                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20325                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20326                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20327                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20328                 GO TO 7000-DISPLAY-ISSUES
 20329           ELSE
 20330              GO TO 4810-READ-PREV-RECORD.
 20331
 20332     IF PB-ISSUE
 20333        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 372
* VP6311.cbl
 20334            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20335            ALL-ISSUES
 20336            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20337            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20338            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20339            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20340            MOVE PB-SV-STATE            TO PI-SV-STATE
 20341            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20342            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20343            GO TO 7000-DISPLAY-ISSUES
 20344        ELSE
 20345            GO TO 4810-READ-PREV-RECORD.
 20346
 20347     IF PB-CANCELLATION
 20348        IF DISPLAY-CHK-REQ-RECORDS
 20349           IF PB-C-REFUND-REQUESTED
 20350              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20351              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20352              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20353              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20354              MOVE PB-SV-STATE            TO PI-SV-STATE
 20355              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20356              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20357              GO TO 7100-DISPLAY-CANCELS
 20358           ELSE
 20359              GO TO 4810-READ-PREV-RECORD.
 20360
 20361     IF PB-CANCELLATION
 20362        IF CANCEL-WITH-WARNING
 20363           IF PB-WARNING-ERRORS
 20364              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20365                  GO TO 4810-READ-PREV-RECORD
 20366              ELSE
 20367                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20368                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20369                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20370                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20371                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20372                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20373                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20374                 GO TO 7100-DISPLAY-CANCELS
 20375           ELSE
 20376              GO TO 4810-READ-PREV-RECORD.
 20377
 20378     IF PB-CANCELLATION
 20379        IF (CANCEL-IN-ERROR  AND
 20380            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20381            ALL-CANCELS
 20382            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20383            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20384            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20385            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20386            MOVE PB-SV-STATE            TO PI-SV-STATE
 20387            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20388            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20389            GO TO 7100-DISPLAY-CANCELS.
 20390
 20391     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 373
* VP6311.cbl
 20392
 20393 4850-END-RECORDS.
 20394     MOVE ER-2252                TO EMI-ERROR.
 20395     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20396
 20397     IF PI-MAP-NAME = VP631B
 20398        MOVE -1                  TO BPFENTRL
 20399     ELSE
 20400        MOVE -1                  TO CPFENTRL.
 20401
 20402     GO TO 8200-SEND-DATAONLY.
 20403
 20404 4860-NOT-FOUND.
 20405
 20406******************************************************************
 20407*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20408******************************************************************
 20409
 20410
 20411* EXEC CICS RESETBR
 20412*         DATASET    (FILE-ID-ERPNDB)
 20413*         RIDFLD     (ERPNDB-KEY)
 20414*     END-EXEC.
 20415     MOVE 0
 20416       TO DFHEIV11
 20417*    MOVE '&4         G          &   #00017284' TO DFHEIV0
 20418     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20419     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20420     MOVE X'2020233030303137323834' TO DFHEIV0(25:11)
 20421     CALL 'kxdfhei1' USING DFHEIV0,
 20422           FILE-ID-ERPNDB,
 20423           ERPNDB-KEY,
 20424           DFHEIV99,
 20425           DFHEIV11,
 20426           DFHEIV99
 20427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20428
 20429
 20430
 20431* EXEC CICS READNEXT
 20432*         DATASET    (FILE-ID-ERPNDB)
 20433*         SET        (ADDRESS OF PENDING-BUSINESS)
 20434*         RIDFLD     (ERPNDB-KEY)
 20435*    END-EXEC.
 20436     MOVE 0
 20437       TO DFHEIV11
 20438*    MOVE '&.S                   )   #00017289' TO DFHEIV0
 20439     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20440     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20441     MOVE X'2020233030303137323839' TO DFHEIV0(25:11)
 20442     CALL 'kxdfhei1' USING DFHEIV0,
 20443           FILE-ID-ERPNDB,
 20444           DFHEIV20,
 20445           DFHEIV99,
 20446           ERPNDB-KEY,
 20447           DFHEIV99,
 20448           DFHEIV11,
 20449           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 374
* VP6311.cbl
 20450           DFHEIV99
 20451     SET ADDRESS OF PENDING-BUSINESS TO
 20452         DFHEIV20
 20453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20454
 20455
 20456
 20457* EXEC CICS READPREV
 20458*         DATASET    (FILE-ID-ERPNDB)
 20459*         SET        (ADDRESS OF PENDING-BUSINESS)
 20460*         RIDFLD     (ERPNDB-KEY)
 20461*    END-EXEC.
 20462     MOVE 0
 20463       TO DFHEIV11
 20464*    MOVE '&0S                   )   #00017295' TO DFHEIV0
 20465     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20466     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20467     MOVE X'2020233030303137323935' TO DFHEIV0(25:11)
 20468     CALL 'kxdfhei1' USING DFHEIV0,
 20469           FILE-ID-ERPNDB,
 20470           DFHEIV20,
 20471           DFHEIV99,
 20472           ERPNDB-KEY,
 20473           DFHEIV99,
 20474           DFHEIV11,
 20475           DFHEIV99,
 20476           DFHEIV99
 20477     SET ADDRESS OF PENDING-BUSINESS TO
 20478         DFHEIV20
 20479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20480
 20481
 20482     GO TO 4810-READ-PREV-RECORD.
 20483
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 375
* VP6311.cbl
 20485
 20486******************************************************************
 20487*                                                                *
 20488*           B R O W S E   C S R   B A C K W A R D                *
 20489*                                                                *
 20490******************************************************************
 20491
 20492 4900-BROWSE-CSR-BACKWARD.
 20493
 20494     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20495
 20496
 20497* EXEC CICS HANDLE CONDITION
 20498*         NOTFND   (4970-NOT-FOUND)
 20499*         ENDFILE  (4950-END-RECORDS)
 20500*    END-EXEC
 20501*    MOVE '"$I''                  ! Q #00017315' TO DFHEIV0
 20502     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20504     MOVE X'5120233030303137333135' TO DFHEIV0(25:11)
 20505     CALL 'kxdfhei1' USING DFHEIV0
 20506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20507
 20508
 20509* EXEC CICS STARTBR
 20510*         DATASET   (FILE-ID-ERPNDB4)
 20511*         RIDFLD    (ERPNDB-CSR-KEY)
 20512*    END-EXEC.
 20513     MOVE 0
 20514       TO DFHEIV11
 20515*    MOVE '&,         G          &   #00017320' TO DFHEIV0
 20516     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20517     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20518     MOVE X'2020233030303137333230' TO DFHEIV0(25:11)
 20519     CALL 'kxdfhei1' USING DFHEIV0,
 20520           FILE-ID-ERPNDB4,
 20521           ERPNDB-CSR-KEY,
 20522           DFHEIV99,
 20523           DFHEIV11,
 20524           DFHEIV99
 20525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20526
 20527
 20528     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20529                                    WS-FIRST-TIME-SW.
 20530
 20531 4905-READ-PREV-RECORD.
 20532
 20533* EXEC CICS READPREV
 20534*         DATASET    (FILE-ID-ERPNDB4)
 20535*         SET        (ADDRESS OF PENDING-BUSINESS)
 20536*         RIDFLD     (ERPNDB-CSR-KEY)
 20537*    END-EXEC.
 20538     MOVE 0
 20539       TO DFHEIV11
 20540*    MOVE '&0S                   )   #00017329' TO DFHEIV0
 20541     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20542     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 376
* VP6311.cbl
 20543     MOVE X'2020233030303137333239' TO DFHEIV0(25:11)
 20544     CALL 'kxdfhei1' USING DFHEIV0,
 20545           FILE-ID-ERPNDB4,
 20546           DFHEIV20,
 20547           DFHEIV99,
 20548           ERPNDB-CSR-KEY,
 20549           DFHEIV99,
 20550           DFHEIV11,
 20551           DFHEIV99,
 20552           DFHEIV99
 20553     SET ADDRESS OF PENDING-BUSINESS TO
 20554         DFHEIV20
 20555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20556
 20557
 20558     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20559
 20560     IF WS-BATCH-PREFIX = '#CL'
 20561         GO TO 4905-READ-PREV-RECORD.
 20562
 20563     IF FIRST-TIME
 20564         MOVE SPACE               TO WS-FIRST-TIME-SW
 20565         GO TO 4905-READ-PREV-RECORD.
 20566
 20567     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20568        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20569        GO TO 4950-END-RECORDS.
 20570
 20571     IF PB-BATCH-TRAILER
 20572        GO TO 4905-READ-PREV-RECORD.
 20573
 20574     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20575
 20576     IF  WS-BATCH-PREFIX = '#CL'
 20577         GO TO 4905-READ-PREV-RECORD.
 20578
 20579     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20580        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20581           GO TO 4905-READ-PREV-RECORD
 20582        ELSE
 20583           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20584              GO TO 4910-CHECK-REC-TYPE
 20585           ELSE
 20586              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20587                 GO TO 4910-CHECK-REC-TYPE
 20588              ELSE
 20589                 GO TO 4905-READ-PREV-RECORD.
 20590
 20591     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20592        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20593           GO TO 4905-READ-PREV-RECORD.
 20594
 20595 4910-CHECK-REC-TYPE.
 20596     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20597         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20598             NEXT SENTENCE
 20599         ELSE
 20600             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 377
* VP6311.cbl
 20601
 20602     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20603         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20604             NEXT SENTENCE
 20605        ELSE
 20606             GO TO 4905-READ-PREV-RECORD.
 20607
 20608     IF NOT DISPLAY-CHANGE-RECORDS AND
 20609            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20610        GO TO 4905-READ-PREV-RECORD.
 20611
 20612     IF DISPLAY-HOLD-RECORDS AND
 20613        NOT PB-RECORD-ON-HOLD
 20614          GO TO 4905-READ-PREV-RECORD.
 20615
 20616     IF PB-ISSUE
 20617        IF DISPLAY-CHK-REQ-RECORDS
 20618           GO TO 4905-READ-PREV-RECORD.
 20619
 20620     IF PB-ISSUE
 20621        IF ISSUE-WITH-WARNING
 20622           IF PB-WARNING-ERRORS
 20623              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20624                  GO TO 4505-READ-PREV-RECORD
 20625              ELSE
 20626                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20627                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20628                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20629                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20630                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20631                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20632                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20633                 GO TO 7000-DISPLAY-ISSUES
 20634           ELSE
 20635              GO TO 4905-READ-PREV-RECORD.
 20636
 20637     IF PB-ISSUE
 20638        IF (ISSUES-IN-ERROR AND
 20639            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20640            ALL-ISSUES
 20641            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20642            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20643            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20644            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20645            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20646            MOVE PB-SV-STATE            TO PI-SV-STATE
 20647            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20648            GO TO 7000-DISPLAY-ISSUES
 20649        ELSE
 20650            GO TO 4905-READ-PREV-RECORD.
 20651
 20652     IF PB-CANCELLATION
 20653        IF DISPLAY-CHK-REQ-RECORDS
 20654           IF PB-C-REFUND-REQUESTED
 20655              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20656              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20657              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20658              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 378
* VP6311.cbl
 20659              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20660              MOVE PB-SV-STATE            TO PI-SV-STATE
 20661              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20662              GO TO 7100-DISPLAY-CANCELS
 20663           ELSE
 20664              GO TO 4905-READ-PREV-RECORD.
 20665
 20666     IF PB-CANCELLATION
 20667        IF CANCEL-WITH-WARNING
 20668           IF PB-WARNING-ERRORS
 20669              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20670                  GO TO 4505-READ-PREV-RECORD
 20671              ELSE
 20672                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20673                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20674                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20675                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20676                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20677                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20678                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20679                 GO TO 7100-DISPLAY-CANCELS
 20680           ELSE
 20681              GO TO 4905-READ-PREV-RECORD.
 20682
 20683     IF PB-CANCELLATION
 20684        IF (CANCEL-IN-ERROR  AND
 20685            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20686            ALL-CANCELS
 20687            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20688            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20689            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20690            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20691            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20692            MOVE PB-SV-STATE            TO PI-SV-STATE
 20693            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20694            GO TO 7100-DISPLAY-CANCELS.
 20695
 20696     GO TO 4905-READ-PREV-RECORD.
 20697
 20698 4950-END-RECORDS.
 20699     IF PI-MAP-NAME = VP631B
 20700        MOVE -1                  TO BMAINTL
 20701     ELSE
 20702        IF PI-MAP-NAME = VP631C
 20703           MOVE -1               TO CMAINTL
 20704        ELSE
 20705           MOVE -1               TO DPFENTRL.
 20706
 20707     MOVE ER-2255               TO EMI-ERROR.
 20708     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20709     GO TO 8200-SEND-DATAONLY.
 20710
 20711 4970-NOT-FOUND.
 20712
 20713******************************************************************
 20714*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20715******************************************************************
 20716
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 379
* VP6311.cbl
 20717
 20718* EXEC CICS RESETBR
 20719*         DATASET    (FILE-ID-ERPNDB4)
 20720*         RIDFLD     (ERPNDB-CSR-KEY)
 20721*    END-EXEC.
 20722     MOVE 0
 20723       TO DFHEIV11
 20724*    MOVE '&4         G          &   #00017494' TO DFHEIV0
 20725     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20726     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20727     MOVE X'2020233030303137343934' TO DFHEIV0(25:11)
 20728     CALL 'kxdfhei1' USING DFHEIV0,
 20729           FILE-ID-ERPNDB4,
 20730           ERPNDB-CSR-KEY,
 20731           DFHEIV99,
 20732           DFHEIV11,
 20733           DFHEIV99
 20734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20735
 20736
 20737
 20738* EXEC CICS READNEXT
 20739*         DATASET    (FILE-ID-ERPNDB4)
 20740*         SET        (ADDRESS OF PENDING-BUSINESS)
 20741*         RIDFLD     (ERPNDB-CSR-KEY)
 20742*    END-EXEC.
 20743     MOVE 0
 20744       TO DFHEIV11
 20745*    MOVE '&.S                   )   #00017499' TO DFHEIV0
 20746     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20747     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20748     MOVE X'2020233030303137343939' TO DFHEIV0(25:11)
 20749     CALL 'kxdfhei1' USING DFHEIV0,
 20750           FILE-ID-ERPNDB4,
 20751           DFHEIV20,
 20752           DFHEIV99,
 20753           ERPNDB-CSR-KEY,
 20754           DFHEIV99,
 20755           DFHEIV11,
 20756           DFHEIV99,
 20757           DFHEIV99
 20758     SET ADDRESS OF PENDING-BUSINESS TO
 20759         DFHEIV20
 20760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20761
 20762
 20763
 20764* EXEC CICS READPREV
 20765*         DATASET    (FILE-ID-ERPNDB4)
 20766*         SET        (ADDRESS OF PENDING-BUSINESS)
 20767*         RIDFLD     (ERPNDB-CSR-KEY)
 20768*    END-EXEC.
 20769     MOVE 0
 20770       TO DFHEIV11
 20771*    MOVE '&0S                   )   #00017505' TO DFHEIV0
 20772     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20773     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20774     MOVE X'2020233030303137353035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 380
* VP6311.cbl
 20775     CALL 'kxdfhei1' USING DFHEIV0,
 20776           FILE-ID-ERPNDB4,
 20777           DFHEIV20,
 20778           DFHEIV99,
 20779           ERPNDB-CSR-KEY,
 20780           DFHEIV99,
 20781           DFHEIV11,
 20782           DFHEIV99,
 20783           DFHEIV99
 20784     SET ADDRESS OF PENDING-BUSINESS TO
 20785         DFHEIV20
 20786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20787
 20788
 20789 4980-READ-PREV-RECORD.
 20790
 20791* EXEC CICS READPREV
 20792*         DATASET    (FILE-ID-ERPNDB4)
 20793*         SET        (ADDRESS OF PENDING-BUSINESS)
 20794*         RIDFLD     (ERPNDB-CSR-KEY)
 20795*    END-EXEC.
 20796     MOVE 0
 20797       TO DFHEIV11
 20798*    MOVE '&0S                   )   #00017512' TO DFHEIV0
 20799     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20800     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20801     MOVE X'2020233030303137353132' TO DFHEIV0(25:11)
 20802     CALL 'kxdfhei1' USING DFHEIV0,
 20803           FILE-ID-ERPNDB4,
 20804           DFHEIV20,
 20805           DFHEIV99,
 20806           ERPNDB-CSR-KEY,
 20807           DFHEIV99,
 20808           DFHEIV11,
 20809           DFHEIV99,
 20810           DFHEIV99
 20811     SET ADDRESS OF PENDING-BUSINESS TO
 20812         DFHEIV20
 20813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20814
 20815
 20816     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20817
 20818     IF WS-BATCH-PREFIX = '#CL'
 20819        GO TO 4980-READ-PREV-RECORD.
 20820
 20821     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20822     GO TO 4905-READ-PREV-RECORD.
 20823
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 381
* VP6311.cbl
 20825
 20826
 20827******************************************************************
 20828*                                                                *
 20829*        B R O W S E   B A T C H   H E A D E R S                 *
 20830*                                                                *
 20831******************************************************************
 20832
 20833 5000-BROWSE-BATCH-HEADERS.
 20834
 20835     IF EIBTRNID NOT = TRANS-EXB1
 20836        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20837        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20838        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20839        GO TO 5010-READ-NEXT-RECORD.
 20840
 20841     IF EIBAID = DFHPF4
 20842        MOVE '0'                TO PI-EDIT-SW
 20843        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20844        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20845        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20846        GO TO 5010-READ-NEXT-RECORD.
 20847
 20848     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20849     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20850     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20851
 20852
 20853* EXEC CICS HANDLE CONDITION
 20854*         ENDFILE  (5050-NOT-FOUND)
 20855*    END-EXEC.
 20856*    MOVE '"$''                   ! R #00017554' TO DFHEIV0
 20857     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20859     MOVE X'5220233030303137353534' TO DFHEIV0(25:11)
 20860     CALL 'kxdfhei1' USING DFHEIV0
 20861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20862
 20863
 20864 5010-READ-NEXT-RECORD.
 20865
 20866* EXEC CICS HANDLE CONDITION
 20867*         NOTFND    (5050-NOT-FOUND)
 20868*    END-EXEC.
 20869*    MOVE '"$I                   ! S #00017559' TO DFHEIV0
 20870     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20872     MOVE X'5320233030303137353539' TO DFHEIV0(25:11)
 20873     CALL 'kxdfhei1' USING DFHEIV0
 20874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20875
 20876
 20877
 20878* EXEC CICS READ
 20879*         DATASET   (FILE-ID-ERPNDB)
 20880*         SET       (ADDRESS OF PENDING-BUSINESS)
 20881*         RIDFLD    (ERPNDB-KEY)
 20882*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 382
* VP6311.cbl
 20883*    END-EXEC.
 20884*    MOVE '&"S        G          (   #00017563' TO DFHEIV0
 20885     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20886     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20887     MOVE X'2020233030303137353633' TO DFHEIV0(25:11)
 20888     CALL 'kxdfhei1' USING DFHEIV0,
 20889           FILE-ID-ERPNDB,
 20890           DFHEIV20,
 20891           DFHEIV99,
 20892           ERPNDB-KEY,
 20893           DFHEIV99,
 20894           DFHEIV99,
 20895           DFHEIV99
 20896     SET ADDRESS OF PENDING-BUSINESS TO
 20897         DFHEIV20
 20898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20899
 20900
 20901     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20902         GO TO 5050-NOT-FOUND.
 20903
 20904     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20905
 20906     IF WS-BATCH-PREFIX = '#CL'
 20907         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20908         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20909         GO TO 5010-READ-NEXT-RECORD.
 20910
 20911     IF NOT PB-BATCH-TRAILER
 20912         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20913         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20914         GO TO 5010-READ-NEXT-RECORD.
 20915
 20916     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20917         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20918             NEXT SENTENCE
 20919         ELSE
 20920             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20921             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20922             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20923             GO TO 5010-READ-NEXT-RECORD.
 20924
 20925     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20926         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20927             NEXT SENTENCE
 20928        ELSE
 20929             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20930             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20931             GO TO 5010-READ-NEXT-RECORD.
 20932
 20933     IF EIBAID = DFHPF4
 20934        MOVE '0'                TO PI-EDIT-SW
 20935        GO TO 7200-DISPLAY-BATCHES.
 20936
 20937     IF PI-CSR-BROWSE
 20938        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20939           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20940           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 383
* VP6311.cbl
 20941           GO TO 5010-READ-NEXT-RECORD.
 20942
 20943     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20944       IF PI-PB-CARRIER    = SPACES AND
 20945          PI-PB-GROUPING   = SPACES AND
 20946          PI-PB-STATE      = SPACES AND
 20947          PI-PB-ACCOUNT    = SPACES
 20948            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20949            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20950            GO TO 7200-DISPLAY-BATCHES
 20951         ELSE
 20952           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20953              PI-PB-GROUPING   = PB-GROUPING AND
 20954              PI-PB-STATE      = PB-STATE    AND
 20955              PI-PB-ACCOUNT    = PB-ACCOUNT
 20956              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20957              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20958              GO TO 7200-DISPLAY-BATCHES.
 20959
 20960     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20961     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20962
 20963
 20964* EXEC CICS HANDLE CONDITION
 20965*         NOTFND    (5050-NOT-FOUND)
 20966*    END-EXEC.
 20967*    MOVE '"$I                   ! T #00017632' TO DFHEIV0
 20968     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20970     MOVE X'5420233030303137363332' TO DFHEIV0(25:11)
 20971     CALL 'kxdfhei1' USING DFHEIV0
 20972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20973
 20974
 20975
 20976* EXEC CICS READ
 20977*         DATASET   (FILE-ID-ERPNDB)
 20978*         SET       (ADDRESS OF PENDING-BUSINESS)
 20979*         RIDFLD    (ERPNDB-KEY)
 20980*         GTEQ
 20981*    END-EXEC.
 20982*    MOVE '&"S        G          (   #00017636' TO DFHEIV0
 20983     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20985     MOVE X'2020233030303137363336' TO DFHEIV0(25:11)
 20986     CALL 'kxdfhei1' USING DFHEIV0,
 20987           FILE-ID-ERPNDB,
 20988           DFHEIV20,
 20989           DFHEIV99,
 20990           ERPNDB-KEY,
 20991           DFHEIV99,
 20992           DFHEIV99,
 20993           DFHEIV99
 20994     SET ADDRESS OF PENDING-BUSINESS TO
 20995         DFHEIV20
 20996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20997
 20998
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 384
* VP6311.cbl
 20999     GO TO 5010-READ-NEXT-RECORD.
 21000
 21001 5050-NOT-FOUND.
 21002
 21003******************************************************************
 21004*                                                                *
 21005*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21006*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING     *
 21007*         PROGRAM.                                               *
 21008*                                                                *
 21009******************************************************************
 21010
 21011     IF EIBTRNID NOT = TRANS-EXB1
 21012        IF PENDING-BUS-RECS-FOUND
 21013            NEXT SENTENCE
 21014          ELSE
 21015            MOVE '9'            TO PI-BROWSE-SW
 21016            GO TO 9400-CLEAR.
 21017
 21018     MOVE ER-2256                TO EMI-ERROR.
 21019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21020
 21021     IF PI-MAP-NAME = SPACES
 21022        MOVE VP631D              TO PI-MAP-NAME
 21023        MOVE -1                  TO DPFENTRL
 21024        GO TO 8100-SEND-INITIAL-MAP.
 21025
 21026     IF PI-MAP-NAME = VP631B
 21027        MOVE -1                  TO BMAINTL
 21028     ELSE
 21029        IF PI-MAP-NAME = VP631C
 21030           MOVE -1               TO CMAINTL
 21031        ELSE
 21032           MOVE -1               TO DPFENTRL
 21033           GO TO 8200-SEND-DATAONLY.
 21034
 21035     GO TO 8100-SEND-INITIAL-MAP.
 21036
 21037     .
 21038 5100-PROCESS-POL-RESC.
 21039     MOVE ZEROS                  TO CG-LF-BENCD
 21040                                    CG-AH-BENCD
 21041                                    CG-LF-CAN-AMT
 21042                                    CG-AH-CAN-AMT
 21043     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21044                                    CG-AH-CAN-DT
 21045     MOVE SPACES                 TO CG-BATCH-NO
 21046     MOVE '4'                    TO CG-OPTION-CODE
 21047     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21048     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21049     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21050     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21051     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21052     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21053     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21054     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21055     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21056     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 385
* VP6311.cbl
 21057     MOVE PI-PREV-ALT-KEY (1:33)
 21058                                 TO CG-CERT-KEY
 21059     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21060     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21061                                    CG-AH-CAN-AMT
 21062     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21063                                    CG-AH-CAN-DT
 21064     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21065     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21066      display 'about to cancel ' cg-cert-key
 21067
 21068* EXEC CICS LINK
 21069*        PROGRAM  ('ELCANC')
 21070*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21071*    END-EXEC
 21072     MOVE LENGTH OF
 21073      CANCEL-GEN-PASS-AREA
 21074       TO DFHEIV11
 21075     MOVE 'ELCANC' TO DFHEIV1
 21076*    MOVE '."C                   (   #00017711' TO DFHEIV0
 21077     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21079     MOVE X'2020233030303137373131' TO DFHEIV0(25:11)
 21080     CALL 'kxdfhei1' USING DFHEIV0,
 21081           DFHEIV1,
 21082           CANCEL-GEN-PASS-AREA,
 21083           DFHEIV11,
 21084           DFHEIV99,
 21085           DFHEIV99,
 21086           DFHEIV99,
 21087           DFHEIV99
 21088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21089     IF CG-SUCCESS
 21090        CONTINUE
 21091     ELSE
 21092        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21093        MOVE '3'                 TO EMI-SWITCH1
 21094        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21095        EVALUATE TRUE
 21096           WHEN CG-DATE-ERROR
 21097             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21098           WHEN CG-CERT-NOT-FOUND
 21099             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21100           WHEN CG-AMOUNT-ERROR
 21101             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21102           WHEN CG-OPTION-ERROR
 21103             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21104           WHEN CG-PREV-CAN
 21105             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21106           WHEN CG-INVALID-DATA
 21107             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21108           WHEN CG-NO-ACCT-MSTR
 21109             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21110           WHEN CG-SFX-A-EXIST
 21111             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21112           WHEN CG-MISC-ERROR
 21113             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21114           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 386
* VP6311.cbl
 21115             MOVE ' ERROR - ELCANC - RETURN '
 21116                                 TO EMI-ERROR-TEXT (1) (12:25)
 21117        END-EVALUATE
 21118        GO TO 8200-SEND-DATAONLY
 21119     END-IF
 21120     .
 21121 5100-EXIT.
 21122     EXIT.
 21123
 21124******************************************************************
 21125*                                                                *
 21126*        B R O W S E   B A T C H   B A C K W A R D S             *
 21127*                                                                *
 21128******************************************************************
 21129
 21130 5500-BROWSE-BATCH-BACKWARD.
 21131
 21132* EXEC CICS HANDLE CONDITION
 21133*         NOTFND   (5550-END-RECORDS)
 21134*         ENDFILE  (5550-END-RECORDS)
 21135*    END-EXEC.
 21136*    MOVE '"$I''                  ! U #00017757' TO DFHEIV0
 21137     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21139     MOVE X'5520233030303137373537' TO DFHEIV0(25:11)
 21140     CALL 'kxdfhei1' USING DFHEIV0
 21141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21142
 21143
 21144 5505-START-BROWSE.
 21145     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21146     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21147     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21148
 21149
 21150* EXEC CICS STARTBR
 21151*         DATASET   (FILE-ID-ERPNDB)
 21152*         RIDFLD    (ERPNDB-ALT-KEY)
 21153*    END-EXEC.
 21154     MOVE 0
 21155       TO DFHEIV11
 21156*    MOVE '&,         G          &   #00017767' TO DFHEIV0
 21157     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21158     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21159     MOVE X'2020233030303137373637' TO DFHEIV0(25:11)
 21160     CALL 'kxdfhei1' USING DFHEIV0,
 21161           FILE-ID-ERPNDB,
 21162           ERPNDB-ALT-KEY,
 21163           DFHEIV99,
 21164           DFHEIV11,
 21165           DFHEIV99
 21166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21167
 21168
 21169     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21170
 21171
 21172* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 387
* VP6311.cbl
 21173*         DATASET    (FILE-ID-ERPNDB)
 21174*         SET        (ADDRESS OF PENDING-BUSINESS)
 21175*         RIDFLD     (ERPNDB-KEY)
 21176*    END-EXEC.
 21177     MOVE 0
 21178       TO DFHEIV11
 21179*    MOVE '&.S                   )   #00017774' TO DFHEIV0
 21180     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21181     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21182     MOVE X'2020233030303137373734' TO DFHEIV0(25:11)
 21183     CALL 'kxdfhei1' USING DFHEIV0,
 21184           FILE-ID-ERPNDB,
 21185           DFHEIV20,
 21186           DFHEIV99,
 21187           ERPNDB-KEY,
 21188           DFHEIV99,
 21189           DFHEIV11,
 21190           DFHEIV99,
 21191           DFHEIV99
 21192     SET ADDRESS OF PENDING-BUSINESS TO
 21193         DFHEIV20
 21194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21195
 21196
 21197
 21198* EXEC CICS READPREV
 21199*         DATASET    (FILE-ID-ERPNDB)
 21200*         SET        (ADDRESS OF PENDING-BUSINESS)
 21201*         RIDFLD     (ERPNDB-KEY)
 21202*    END-EXEC.
 21203     MOVE 0
 21204       TO DFHEIV11
 21205*    MOVE '&0S                   )   #00017780' TO DFHEIV0
 21206     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21207     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21208     MOVE X'2020233030303137373830' TO DFHEIV0(25:11)
 21209     CALL 'kxdfhei1' USING DFHEIV0,
 21210           FILE-ID-ERPNDB,
 21211           DFHEIV20,
 21212           DFHEIV99,
 21213           ERPNDB-KEY,
 21214           DFHEIV99,
 21215           DFHEIV11,
 21216           DFHEIV99,
 21217           DFHEIV99
 21218     SET ADDRESS OF PENDING-BUSINESS TO
 21219         DFHEIV20
 21220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21221
 21222
 21223
 21224* EXEC CICS READPREV
 21225*         DATASET    (FILE-ID-ERPNDB)
 21226*         SET        (ADDRESS OF PENDING-BUSINESS)
 21227*         RIDFLD     (ERPNDB-KEY)
 21228*    END-EXEC.
 21229     MOVE 0
 21230       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 388
* VP6311.cbl
 21231*    MOVE '&0S                   )   #00017786' TO DFHEIV0
 21232     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21233     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21234     MOVE X'2020233030303137373836' TO DFHEIV0(25:11)
 21235     CALL 'kxdfhei1' USING DFHEIV0,
 21236           FILE-ID-ERPNDB,
 21237           DFHEIV20,
 21238           DFHEIV99,
 21239           ERPNDB-KEY,
 21240           DFHEIV99,
 21241           DFHEIV11,
 21242           DFHEIV99,
 21243           DFHEIV99
 21244     SET ADDRESS OF PENDING-BUSINESS TO
 21245         DFHEIV20
 21246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21247
 21248
 21249     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21250        GO TO 5550-END-RECORDS.
 21251
 21252     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21253
 21254     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21255
 21256     IF  WS-BATCH-PREFIX = '#CL'
 21257             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21258
 21259* EXEC CICS ENDBR
 21260*                 DATASET  (FILE-ID-ERPNDB)
 21261*            END-EXEC
 21262     MOVE 0
 21263       TO DFHEIV11
 21264*    MOVE '&2                    $   #00017801' TO DFHEIV0
 21265     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21266     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21267     MOVE X'2020233030303137383031' TO DFHEIV0(25:11)
 21268     CALL 'kxdfhei1' USING DFHEIV0,
 21269           FILE-ID-ERPNDB,
 21270           DFHEIV11,
 21271           DFHEIV99
 21272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21273         GO TO 5505-START-BROWSE.
 21274
 21275     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21276         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21277             NEXT SENTENCE
 21278         ELSE
 21279             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21280
 21281* EXEC CICS ENDBR
 21282*                 DATASET  (FILE-ID-ERPNDB)
 21283*            END-EXEC
 21284     MOVE 0
 21285       TO DFHEIV11
 21286*    MOVE '&2                    $   #00017811' TO DFHEIV0
 21287     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21288     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 389
* VP6311.cbl
 21289     MOVE X'2020233030303137383131' TO DFHEIV0(25:11)
 21290     CALL 'kxdfhei1' USING DFHEIV0,
 21291           FILE-ID-ERPNDB,
 21292           DFHEIV11,
 21293           DFHEIV99
 21294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21295             GO TO 5505-START-BROWSE.
 21296
 21297
 21298     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21299         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21300             NEXT SENTENCE
 21301        ELSE
 21302             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21303
 21304* EXEC CICS ENDBR
 21305*                 DATASET  (FILE-ID-ERPNDB)
 21306*            END-EXEC
 21307     MOVE 0
 21308       TO DFHEIV11
 21309*    MOVE '&2                    $   #00017822' TO DFHEIV0
 21310     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21311     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21312     MOVE X'2020233030303137383232' TO DFHEIV0(25:11)
 21313     CALL 'kxdfhei1' USING DFHEIV0,
 21314           FILE-ID-ERPNDB,
 21315           DFHEIV11,
 21316           DFHEIV99
 21317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21318             GO TO 5505-START-BROWSE.
 21319
 21320     IF NOT PB-BATCH-TRAILER
 21321        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21322
 21323* EXEC CICS ENDBR
 21324*            DATASET  (FILE-ID-ERPNDB)
 21325*       END-EXEC
 21326     MOVE 0
 21327       TO DFHEIV11
 21328*    MOVE '&2                    $   #00017829' TO DFHEIV0
 21329     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21330     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21331     MOVE X'2020233030303137383239' TO DFHEIV0(25:11)
 21332     CALL 'kxdfhei1' USING DFHEIV0,
 21333           FILE-ID-ERPNDB,
 21334           DFHEIV11,
 21335           DFHEIV99
 21336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21337        GO TO 5505-START-BROWSE.
 21338
 21339     IF PI-CSR-BROWSE
 21340        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21341           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21342
 21343* EXEC CICS ENDBR
 21344*               DATASET  (FILE-ID-ERPNDB)
 21345*          END-EXEC
 21346     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 390
* VP6311.cbl
 21347       TO DFHEIV11
 21348*    MOVE '&2                    $   #00017837' TO DFHEIV0
 21349     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21350     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21351     MOVE X'2020233030303137383337' TO DFHEIV0(25:11)
 21352     CALL 'kxdfhei1' USING DFHEIV0,
 21353           FILE-ID-ERPNDB,
 21354           DFHEIV11,
 21355           DFHEIV99
 21356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21357           GO TO 5505-START-BROWSE.
 21358
 21359     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21360        IF PI-PB-CARRIER    = SPACES AND
 21361           PI-PB-GROUPING   = SPACES AND
 21362           PI-PB-STATE      = SPACES AND
 21363           PI-PB-ACCOUNT    = SPACES
 21364             GO TO 7200-DISPLAY-BATCHES
 21365          ELSE
 21366            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21367               PI-PB-GROUPING   = PB-GROUPING AND
 21368               PI-PB-STATE      = PB-STATE    AND
 21369               PI-PB-ACCOUNT    = PB-ACCOUNT
 21370                 GO TO 7200-DISPLAY-BATCHES.
 21371
 21372     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21373
 21374
 21375* EXEC CICS ENDBR
 21376*         DATASET  (FILE-ID-ERPNDB)
 21377*    END-EXEC.
 21378     MOVE 0
 21379       TO DFHEIV11
 21380*    MOVE '&2                    $   #00017857' TO DFHEIV0
 21381     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21382     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21383     MOVE X'2020233030303137383537' TO DFHEIV0(25:11)
 21384     CALL 'kxdfhei1' USING DFHEIV0,
 21385           FILE-ID-ERPNDB,
 21386           DFHEIV11,
 21387           DFHEIV99
 21388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21389
 21390
 21391     GO TO 5505-START-BROWSE.
 21392
 21393 5550-END-RECORDS.
 21394     MOVE ER-2257                TO EMI-ERROR.
 21395     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21396     MOVE -1                     TO DPFENTRL.
 21397
 21398     GO TO 8200-SEND-DATAONLY.
 21399
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 391
* VP6311.cbl
 21401
 21402******************************************************************
 21403*                                                                *
 21404*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21405*                                                                *
 21406******************************************************************
 21407
 21408 6000-CREATE-TEMP-STORAGE.
 21409
 21410
 21411* EXEC CICS HANDLE CONDITION
 21412*        QIDERR  (6050-QID-ERROR)
 21413*    END-EXEC.
 21414*    MOVE '"$N                   ! V #00017880' TO DFHEIV0
 21415     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21417     MOVE X'5620233030303137383830' TO DFHEIV0(25:11)
 21418     CALL 'kxdfhei1' USING DFHEIV0
 21419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21420
 21421
 21422
 21423* EXEC CICS WRITEQ TS
 21424*        QUEUE    (QID)
 21425*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21426*        LENGTH   (WS-COMM-LENGTH)
 21427*        ITEM     (W-ONE)
 21428*    END-EXEC.
 21429*    MOVE '*" I                  ''   #00017884' TO DFHEIV0
 21430     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21431     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21432     MOVE X'2020233030303137383834' TO DFHEIV0(25:11)
 21433     CALL 'kxdfhei1' USING DFHEIV0,
 21434           QID,
 21435           PROGRAM-INTERFACE-BLOCK,
 21436           WS-COMM-LENGTH,
 21437           W-ONE,
 21438           DFHEIV99,
 21439           DFHEIV99
 21440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21441
 21442
 21443 6000-EXIT.
 21444      EXIT.
 21445
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 392
* VP6311.cbl
 21447
 21448******************************************************************
 21449*                                                                *
 21450*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21451*                                                                *
 21452******************************************************************
 21453
 21454 6050-RECOVER-TEMP-STORAGE.
 21455     IF PGM-NAME = XCTL-EL6312
 21456        GO TO 6050-EXIT.
 21457
 21458     IF PGM-NAME = XCTL-EL6313
 21459        GO TO 6050-EXIT.
 21460
 21461     IF PGM-NAME = XCTL-EL6315
 21462         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21463     END-IF
 21464
 21465     IF PGM-NAME = XCTL-EL6316
 21466         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21467     END-IF
 21468
 21469
 21470* EXEC CICS HANDLE CONDITION
 21471*        QIDERR  (6050-QID-ERROR)
 21472*    END-EXEC.
 21473*    MOVE '"$N                   ! W #00017917' TO DFHEIV0
 21474     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21476     MOVE X'5720233030303137393137' TO DFHEIV0(25:11)
 21477     CALL 'kxdfhei1' USING DFHEIV0
 21478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21479
 21480
 21481
 21482* EXEC CICS READQ TS
 21483*         QUEUE   (QID)
 21484*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21485*         LENGTH  (WS-COMM-LENGTH)
 21486*         ITEM    (W-ONE)
 21487*     END-EXEC.
 21488*    MOVE '*$II   L              ''   #00017921' TO DFHEIV0
 21489     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21490     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21491     MOVE X'2020233030303137393231' TO DFHEIV0(25:11)
 21492     CALL 'kxdfhei1' USING DFHEIV0,
 21493           QID,
 21494           PROGRAM-INTERFACE-BLOCK,
 21495           WS-COMM-LENGTH,
 21496           W-ONE,
 21497           DFHEIV99,
 21498           DFHEIV99
 21499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21500
 21501
 21502 6050-DELETE-TEMP-STORAGE.
 21503
 21504
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 393
* VP6311.cbl
 21505* EXEC CICS DELETEQ TS
 21506*        QUEUE   (QID)
 21507*    END-EXEC.
 21508*    MOVE '*&                    #   #00017930' TO DFHEIV0
 21509     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21510     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21511     MOVE X'2020233030303137393330' TO DFHEIV0(25:11)
 21512     CALL 'kxdfhei1' USING DFHEIV0,
 21513           QID,
 21514           DFHEIV99
 21515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21516
 21517
 21518     GO TO 6050-EXIT.
 21519
 21520 6050-QID-ERROR.
 21521     MOVE ER-0033                TO EMI-ERROR
 21522     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21523
 21524 6050-EXIT.
 21525      EXIT.
 21526
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 394
* VP6311.cbl
 21528
 21529******************************************************************
 21530*                                                                *
 21531*            T E R M   C O N V E R S I O N                       *
 21532*                                                                *
 21533******************************************************************
 21534
 21535 6100-TERM-CONVERSION.
 21536
 21537     IF PI-BPMTS = ZERO
 21538         GO TO 6199-EXIT.
 21539
 21540
 21541 6105-ROUND-TERM.
 21542
 21543     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21544         ADD +1                  TO WS-CALC-TERM-WHOLE
 21545         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21546
 21547     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21548         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21549
 21550     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21551         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21552                                      WS-BTERM    (WS-SUB1)
 21553         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21554
 21555
 21556 6124-CHECK-BENEFIT.
 21557
 21558     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21559        GO TO 6126-COMPUTE-BENEFIT.
 21560
 21561     GO TO 6199-EXIT.
 21562
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 395
* VP6311.cbl
 21564******************************************************************
 21565**         COMPUTE TERM AND BENEFIT
 21566******************************************************************
 21567 6125-COMPUTE-TERM-BENEFIT.
 21568
 21569     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21570        PI-BPMTAMT = ZERO
 21571         GO TO 6199-EXIT.
 21572
 21573     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21574                                     WS-BTERM  (WS-SUB1).
 21575     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21576
 21577 6126-COMPUTE-BENEFIT.
 21578
 21579
 21580     IF WS-SUB1 = +1
 21581        COMPUTE WS-BBEN (WS-SUB1) =
 21582                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21583
 21584     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21585     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21586     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21587
 21588 6199-EXIT.
 21589     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 396
* VP6311.cbl
 21591
 21592******************************************************************
 21593*                                                                *
 21594*             D I S P L A Y   I S S U E S                        *
 21595*                                                                *
 21596******************************************************************
 21597
 21598 6200-CREATE-VADS.
 21599     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21600     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21601     MOVE SPACES                 TO WS-PASS-VADS-REC
 21602
 21603* EXEC CICS GETMAIN
 21604*       SET      (ADDRESS OF PENDING-BUSINESS)
 21605*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21606*       INITIMG  (GETMAIN-SPACE)
 21607*       RESP     (WS-RESPONSE)
 21608*    END-EXEC
 21609*    MOVE ',"IL                  $  N#00018018' TO DFHEIV0
 21610     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21611     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21612     MOVE X'204E233030303138303138' TO DFHEIV0(25:11)
 21613     CALL 'kxdfhei1' USING DFHEIV0,
 21614           DFHEIV20,
 21615           ERPNDB-RECORD-LENGTH,
 21616           GETMAIN-SPACE
 21617     SET ADDRESS OF PENDING-BUSINESS TO
 21618         DFHEIV20
 21619     MOVE EIBRESP  TO WS-RESPONSE
 21620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21621
 21622* EXEC CICS READ
 21623*       INTO    (PENDING-BUSINESS)
 21624*       DATASET (FILE-ID-ERPNDB)
 21625*       RIDFLD  (ERPNDB-KEY)
 21626*       RESP    (WS-RESPONSE)
 21627*    END-EXEC
 21628     MOVE LENGTH OF
 21629      PENDING-BUSINESS
 21630       TO DFHEIV11
 21631*    MOVE '&"IL       E          (  N#00018024' TO DFHEIV0
 21632     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21633     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21634     MOVE X'204E233030303138303234' TO DFHEIV0(25:11)
 21635     CALL 'kxdfhei1' USING DFHEIV0,
 21636           FILE-ID-ERPNDB,
 21637           PENDING-BUSINESS,
 21638           DFHEIV11,
 21639           ERPNDB-KEY,
 21640           DFHEIV99,
 21641           DFHEIV99,
 21642           DFHEIV99
 21643     MOVE EIBRESP  TO WS-RESPONSE
 21644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21645     IF RESP-NORMAL
 21646        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21647        IF (RESP-NORMAL)
 21648           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 397
* VP6311.cbl
 21649              AM-CONTROL-PRIMARY (1:20))
 21650           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21651        ELSE
 21652           MOVE 'ACCOUNT NOT FOUND'
 21653                                 TO VD-ACCOUNT-NAME
 21654        END-IF
 21655        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21656                                    TO M1
 21657        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21658        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21659           (A2 > M1)
 21660           OR (WS-WORK-FIELD (A2:1) = '*')
 21661           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21662           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21663        END-PERFORM
 21664        IF A2 > M1
 21665           CONTINUE
 21666        ELSE
 21667           MOVE WS-WORK-FIELD (1:A2 - 1)
 21668                                    TO VD-ACCOUNT-NAME
 21669        END-IF
 21670        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21671        MOVE PB-CARRIER          TO VD-CARRIER
 21672        MOVE PB-GROUPING         TO VD-GROUPING
 21673        MOVE PB-STATE            TO VD-STATE
 21674        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21675        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21676        MOVE PB-CERT-NO          TO VD-CERT-NO
 21677        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21678        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21679        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21680        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21681        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21682        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21683        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21684        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21685        MOVE PB-CSR-ID           TO VD-CSR-ID
 21686        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21687        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21688        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21689        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21690        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21691        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21692        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21693        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21694        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21695        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21696        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21697        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21698        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21699     END-IF
 21700     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21701
 21702
 21703* EXEC CICS GETMAIN
 21704*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21705*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21706*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 398
* VP6311.cbl
 21707*       RESP     (WS-RESPONSE)
 21708*    END-EXEC
 21709*    MOVE ',"IL                  $  N#00018087' TO DFHEIV0
 21710     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21711     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21712     MOVE X'204E233030303138303837' TO DFHEIV0(25:11)
 21713     CALL 'kxdfhei1' USING DFHEIV0,
 21714           DFHEIV20,
 21715           ERPNDM-RECORD-LENGTH,
 21716           GETMAIN-SPACE
 21717     SET ADDRESS OF PENDING-MAILING-DATA TO
 21718         DFHEIV20
 21719     MOVE EIBRESP  TO WS-RESPONSE
 21720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21721
 21722
 21723* EXEC CICS READ
 21724*       INTO    (PENDING-MAILING-DATA)
 21725*       DATASET (FILE-ID-ERPNDM)
 21726*       RIDFLD  (ERPNDM-KEY)
 21727*       RESP    (WS-RESPONSE)
 21728*    END-EXEC
 21729     MOVE LENGTH OF
 21730      PENDING-MAILING-DATA
 21731       TO DFHEIV11
 21732*    MOVE '&"IL       E          (  N#00018094' TO DFHEIV0
 21733     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21734     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21735     MOVE X'204E233030303138303934' TO DFHEIV0(25:11)
 21736     CALL 'kxdfhei1' USING DFHEIV0,
 21737           FILE-ID-ERPNDM,
 21738           PENDING-MAILING-DATA,
 21739           DFHEIV11,
 21740           ERPNDM-KEY,
 21741           DFHEIV99,
 21742           DFHEIV99,
 21743           DFHEIV99
 21744     MOVE EIBRESP  TO WS-RESPONSE
 21745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21746
 21747     IF RESP-NORMAL
 21748        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21749        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21750        MOVE PM-CITY              TO VD-INSURED-CITY
 21751        MOVE PM-STATE             TO VD-INSURED-STATE
 21752        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21753     END-IF
 21754
 21755     MOVE 'VAC1'                  TO VD-LETTER-ID
 21756     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21757     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21758     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21759     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21760     MOVE +0                      TO VD-ARCHIVE-NO
 21761     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21762     .
 21763 6200-EXIT.
 21764     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 399
* VP6311.cbl
 21765 6210-READ-ERACCT.
 21766     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21767     MOVE LOW-VALUES             TO ERACCT-FILL
 21768
 21769* EXEC CICS READ
 21770*         DATASET   ('ERACCT')
 21771*         INTO      (ACCOUNT-MASTER)
 21772*         RIDFLD    (ERACCT-KEY)
 21773*         GTEQ
 21774*         RESP      (WS-RESPONSE)
 21775*    END-EXEC
 21776     MOVE LENGTH OF
 21777      ACCOUNT-MASTER
 21778       TO DFHEIV11
 21779     MOVE 'ERACCT' TO DFHEIV1
 21780*    MOVE '&"IL       G          (  N#00018122' TO DFHEIV0
 21781     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21783     MOVE X'204E233030303138313232' TO DFHEIV0(25:11)
 21784     CALL 'kxdfhei1' USING DFHEIV0,
 21785           DFHEIV1,
 21786           ACCOUNT-MASTER,
 21787           DFHEIV11,
 21788           ERACCT-KEY,
 21789           DFHEIV99,
 21790           DFHEIV99,
 21791           DFHEIV99
 21792     MOVE EIBRESP  TO WS-RESPONSE
 21793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21794     .
 21795 6210-EXIT.
 21796     EXIT.
 21797
 21798 6220-READ-ERMAIL.
 21799
 21800     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21801     MOVE ' '                    TO WS-ERMAIL-SW
 21802
 21803
 21804* EXEC CICS READ
 21805*       DATASET   (FILE-ID-ERMAIL)
 21806*       SET       (ADDRESS OF MAILING-DATA)
 21807*       RIDFLD    (ERMAIL-KEY)
 21808*       RESP      (WS-RESPONSE)
 21809*    END-EXEC
 21810*    MOVE '&"S        E          (  N#00018138' TO DFHEIV0
 21811     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21812     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21813     MOVE X'204E233030303138313338' TO DFHEIV0(25:11)
 21814     CALL 'kxdfhei1' USING DFHEIV0,
 21815           FILE-ID-ERMAIL,
 21816           DFHEIV20,
 21817           DFHEIV99,
 21818           ERMAIL-KEY,
 21819           DFHEIV99,
 21820           DFHEIV99,
 21821           DFHEIV99
 21822     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 400
* VP6311.cbl
 21823         DFHEIV20
 21824     MOVE EIBRESP  TO WS-RESPONSE
 21825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21826
 21827     IF RESP-NORMAL
 21828        SET ERMAIL-FOUND TO TRUE
 21829     END-IF
 21830     .
 21831 6220-EXIT.
 21832     EXIT.
 21833
 21834 6400-CHECK-FOR-RES-REF-CLAIM.
 21835     display 'made it to 6400- for ' pi-cert-no
 21836     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21837
 21838     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21839                                    W-CL-COMP-CD.
 21840     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21841                                    W-CL-CERT-NO.
 21842     MOVE SPACES                 TO MSTR-CERT-SFX.
 21843
 21844
 21845* EXEC CICS HANDLE CONDITION
 21846*        NOTFND  (6400-CONTINUE)
 21847*        ENDFILE (6400-CONTINUE)
 21848*    END-EXEC.
 21849*    MOVE '"$I''                  ! X #00018162' TO DFHEIV0
 21850     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21852     MOVE X'5820233030303138313632' TO DFHEIV0(25:11)
 21853     CALL 'kxdfhei1' USING DFHEIV0
 21854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21855
 21856
 21857
 21858* EXEC CICS IGNORE CONDITION
 21859*        DUPKEY
 21860*    END-EXEC.
 21861*    MOVE '"*$                   !   #00018167' TO DFHEIV0
 21862     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21864     MOVE X'2020233030303138313637' TO DFHEIV0(25:11)
 21865     CALL 'kxdfhei1' USING DFHEIV0
 21866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21867
 21868
 21869
 21870* EXEC CICS STARTBR
 21871*        DATASET   (CLMS-ID)
 21872*        RIDFLD    (ELMSTR-KEY)
 21873*        GENERIC   EQUAL
 21874*        KEYLENGTH (ELMSTR-LENGTH)
 21875*    END-EXEC.
 21876     MOVE 0
 21877       TO DFHEIV11
 21878*    MOVE '&,   KG    E          &   #00018171' TO DFHEIV0
 21879     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21880     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 401
* VP6311.cbl
 21881     MOVE X'2020233030303138313731' TO DFHEIV0(25:11)
 21882     CALL 'kxdfhei1' USING DFHEIV0,
 21883           CLMS-ID,
 21884           ELMSTR-KEY,
 21885           ELMSTR-LENGTH,
 21886           DFHEIV11,
 21887           DFHEIV99
 21888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21889
 21890
 21891     display 'browse started'
 21892     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21893
 21894 6400-NEXT-CLAIM.
 21895
 21896
 21897* EXEC CICS READNEXT
 21898*        DATASET   (CLMS-ID)
 21899*        RIDFLD    (ELMSTR-KEY)
 21900*        SET       (ADDRESS OF CLAIM-MASTER)
 21901*    END-EXEC.
 21902     MOVE 0
 21903       TO DFHEIV11
 21904*    MOVE '&.S                   )   #00018183' TO DFHEIV0
 21905     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21906     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21907     MOVE X'2020233030303138313833' TO DFHEIV0(25:11)
 21908     CALL 'kxdfhei1' USING DFHEIV0,
 21909           CLMS-ID,
 21910           DFHEIV20,
 21911           DFHEIV99,
 21912           ELMSTR-KEY,
 21913           DFHEIV99,
 21914           DFHEIV11,
 21915           DFHEIV99,
 21916           DFHEIV99
 21917     SET ADDRESS OF CLAIM-MASTER TO
 21918         DFHEIV20
 21919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21920
 21921
 21922     display 'read claim for ' mstr-cert-no
 21923     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21924        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21925         GO TO 6400-CONTINUE
 21926     END-IF.
 21927
 21928     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21929        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21930        PI-STATE       NOT = CL-CERT-STATE     OR
 21931        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21932        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21933         GO TO 6400-NEXT-CLAIM
 21934     END-IF.
 21935
 21936     display 'found claim ' cl-claim-no
 21937        ' with denial type ' cl-denial-type
 21938     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 402
* VP6311.cbl
 21939         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21940         GO TO 6400-CONTINUE
 21941     END-IF.
 21942
 21943     GO TO 6400-NEXT-CLAIM.
 21944
 21945 6400-CONTINUE.
 21946
 21947     IF WS-BROWSE-STARTED-SW = 'Y'
 21948
 21949* EXEC CICS ENDBR
 21950*            DATASET   (CLMS-ID)
 21951*        END-EXEC
 21952     MOVE 0
 21953       TO DFHEIV11
 21954*    MOVE '&2                    $   #00018215' TO DFHEIV0
 21955     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21956     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21957     MOVE X'2020233030303138323135' TO DFHEIV0(25:11)
 21958     CALL 'kxdfhei1' USING DFHEIV0,
 21959           CLMS-ID,
 21960           DFHEIV11,
 21961           DFHEIV99
 21962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21963         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21964     END-IF.
 21965
 21966 6400-EXIT.
 21967     EXIT.
 21968
 21969 7000-DISPLAY-ISSUES.
 21970
 21971     IF PI-DISPLAY-ORIGINAL-BATCH
 21972        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21973        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21974     ELSE
 21975        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21976
 21977     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21978
 21979     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21980     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21981
 21982     MOVE LOW-VALUES                 TO VP631BI.
 21983     MOVE ZEROS                      TO PI-BPMTAMT
 21984                                        PI-BPMTS.
 21985     MOVE SPACE                      TO PI-BMODE
 21986                                        PI-BTYPE (1)
 21987                                        PI-BTYPE (2).
 21988     MOVE VP631B                     TO PI-MAP-NAME.
 21989     MOVE 'Y'                        TO PI-BROWSE-SW.
 21990     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21991                                        PI-HIGH-SEQ-NO.
 21992
 21993     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21994        MOVE AL-SABOF                TO BCHGTA
 21995        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21996        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 403
* VP6311.cbl
 21997     ELSE
 21998        MOVE AL-SADOF                TO BCHGTA
 21999                                        BCHGA
 22000        MOVE PB-CHG-COUNT            TO BCHGO.
 22001
 22002     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22003     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22004     MOVE WS-HR-MINS                 TO BMANTATO.
 22005
 22006     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22007        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22008        MOVE SPACE                   TO DC-OPTION-CODE
 22009        PERFORM 9700-DATE-LINK
 22010        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22011        MOVE 'INACTIVE'              TO BMOENDTO
 22012     ELSE
 22013        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22014        MOVE SPACE                   TO DC-OPTION-CODE
 22015        PERFORM 9700-DATE-LINK
 22016        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22017        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22018        MOVE SPACE                   TO DC-OPTION-CODE
 22019        PERFORM 9700-DATE-LINK
 22020        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22021
 22022*    MOVE PB-I-REFERENCE             TO BREFO.
 22023
 22024*    IF PI-COMPANY-ID EQUAL 'HER'
 22025*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22026*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22027*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22028*                MOVE WS-MEMBER-NO-1-8
 22029*                                TO  BMICRNOO.
 22030
 22031*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22032*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22033*            MOVE PB-I-MICROFILM-NO
 22034*                                TO  BMICRNOO.
 22035     IF PB-I-VIN NOT = SPACES
 22036        MOVE PB-I-VIN            TO BVINO
 22037     END-IF
 22038
 22039     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22040     MOVE PB-CERT-SFX                TO BSUFIXO.
 22041     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22042     MOVE SPACE                      TO DC-OPTION-CODE.
 22043     PERFORM 9700-DATE-LINK.
 22044     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22045
 22046     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22047     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22048     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22049     MOVE PB-I-INSURED-SEX           TO BSEXO
 22050
 22051     IF PB-I-AGE NOT = ZEROS
 22052         MOVE PB-I-AGE               TO BAGEO.
 22053
 22054     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 404
* VP6311.cbl
 22055                                 TO ELCERT-KEY
 22056     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22057     IF NOT CERT-TRL-REC-NOT-FOUND
 22058         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22059             MOVE 'AGE*'             TO BAGEDEFO
 22060         ELSE
 22061             MOVE 'AGE '             TO BAGEDEFO
 22062         END-IF
 22063         if cs-year numeric
 22064            move cs-year         to byearo
 22065         end-if
 22066         move cs-make            to bmakeo
 22067         move cs-model           to bmodelo
 22068         if cs-vehicle-odometer numeric
 22069            move cs-vehicle-odometer
 22070                                 to bometero
 22071         end-if
 22072     ELSE
 22073         MOVE 'AGE '             TO BAGEDEFO
 22074     END-IF
 22075
 22076     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22077         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22078         MOVE SPACE                  TO DC-OPTION-CODE
 22079         PERFORM 9700-DATE-LINK
 22080         IF NO-CONVERSION-ERROR
 22081            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22082
 22083
 22084
 22085
 22086     MOVE PB-FORCE-CODE              TO BFORCEO.
 22087
 22088
 22089
 22090
 22091     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22092     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22093     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22094     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22095     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22096     MOVE PB-I-SIG-SW                TO BSIGO.
 22097     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22098     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22099     MOVE PB-RECORD-BILL             TO BBILCDO.
 22100     MOVE PB-FORCE-CODE              TO BFORCEO.
 22101
 22102
 22103
 22104     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22105
 22106
 22107     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22108        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22109
 22110
 22111     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22112
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 405
* VP6311.cbl
 22113     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22114        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22115
 22116     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22117        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22118                                        PI-BTYPE (1).
 22119
 22120     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22121        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22122
 22123     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22124        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22125
 22126     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22127        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22128
 22129     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22130        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22131
 22132     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22133        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22134
 22135     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22136         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22137         MOVE SPACE                  TO DC-OPTION-CODE
 22138         PERFORM 9700-DATE-LINK
 22139         IF NO-CONVERSION-ERROR
 22140            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22141
 22142     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22143        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22144        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22145        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22146        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22147                 GIVING BDIFFO (1)
 22148     ELSE
 22149        MOVE SPACES                  TO BBEN-CD     (1)
 22150                                        BBEN-ABBR   (1).
 22151
 22152     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22153        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22154        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22155                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22156
 22157     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22158       IF PB-RECORD-ON-HOLD
 22159          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22160
 22161     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22162       IF PB-RECORD-RETURNED
 22163          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22164
 22165     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22166        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22167             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22168
 22169     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22170
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 406
* VP6311.cbl
 22171     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22172        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22173
 22174     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22175        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22176                                        PI-BTYPE (2).
 22177
 22178     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22179        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22180
 22181     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22182        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22183
 22184     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22185        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22186
 22187     IF PB-I-TOT-FEES NOT NUMERIC
 22188        MOVE ZEROS               TO PB-I-TOT-FEES
 22189     END-IF
 22190     IF PB-I-TOT-FEES > ZEROS
 22191        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22192
 22193     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22194         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22195         MOVE SPACE                  TO DC-OPTION-CODE
 22196         PERFORM 9700-DATE-LINK
 22197         IF NO-CONVERSION-ERROR
 22198            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22199
 22200     IF PB-I-TOT-FEES > ZEROS
 22201        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22202        SUBTRACT PB-I-TOT-FEES FROM
 22203                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22204
 22205     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22206        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22207        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22208        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22209        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22210                 GIVING BDIFFO (2)
 22211     ELSE
 22212        MOVE SPACES                  TO BBEN-CD     (2)
 22213                                        BBEN-ABBR   (2).
 22214
 22215     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22216       IF PB-RECORD-ON-HOLD
 22217          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22218
 22219     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22220       IF PB-RECORD-RETURNED
 22221          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22222
 22223     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22224        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22225             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22226
 22227     MOVE PB-CSR-ID                  TO BCSRO.
 22228
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 407
* VP6311.cbl
 22229     IF PI-COMPANY-ID  =  'DMD'
 22230        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22231            NEXT SENTENCE
 22232        ELSE
 22233            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22234               MOVE 'NEW CERT'       TO BNCERTLI
 22235               MOVE EC-NEW-CERT      TO BNCERTO.
 22236
 22237     IF PI-COMPANY-ID  =  'DMD'
 22238        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22239            NEXT SENTENCE
 22240        ELSE
 22241           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22242               MOVE 'NEW STATE'      TO BNSTATLI
 22243               MOVE EC-NEW-STATE     TO BNSTATO.
 22244
 22245 7000-CONTINUE.
 22246     MOVE 'C'                        TO BMAINTI.
 22247     MOVE AL-UANON                   TO BMAINTA.
 22248
 22249     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22250        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22251
 22252     IF PI-6315-FINALIZED = 'Y'   AND
 22253        PB-UNFORCED-ERRORS
 22254          MOVE -1                TO BFORCEL
 22255          MOVE  1                TO SET-CURSOR-SW
 22256     END-IF
 22257
 22258     IF NO-CURSOR-SET
 22259        MOVE -1                      TO BMAINTL.
 22260
 22261     GO TO 8100-SEND-INITIAL-MAP.
 22262
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 408
* VP6311.cbl
 22264
 22265******************************************************************
 22266*                                                                *
 22267*             D I S P L A Y   C A N C E L S                      *
 22268*                                                                *
 22269******************************************************************
 22270
 22271 7100-DISPLAY-CANCELS.
 22272     IF PI-DISPLAY-ORIGINAL-BATCH
 22273        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22274        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22275     ELSE
 22276        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22277
 22278     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22279
 22280     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22281     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22282
 22283     MOVE LOW-VALUES                 TO VP631CI.
 22284     MOVE VP631C                     TO PI-MAP-NAME.
 22285     MOVE 'Y'                        TO PI-BROWSE-SW.
 22286     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22287                                        PI-HIGH-SEQ-NO.
 22288
 22289     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22290        MOVE AL-SABOF                TO CCHGTA
 22291        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22292        MOVE AL-SANON                TO CCHGA
 22293      ELSE
 22294        MOVE AL-SADOF                TO CCHGTA
 22295                                        CCHGA
 22296        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22297
 22298*    MOVE PB-C-REFERENCE             TO CREFO.
 22299
 22300*    IF PB-C-MICROFILM-NO IS NUMERIC
 22301*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22302*          MOVE PB-C-MICROFILM-NO
 22303*                                TO CMICRNOO
 22304*          MOVE AL-UNNON         TO CMICRNOA
 22305*       END-IF
 22306*    END-IF
 22307     IF PB-C-NH-INT-ON-REFS NUMERIC
 22308        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22309           MOVE PB-C-NH-INT-ON-REFS
 22310                                 TO CNHINTO
 22311           MOVE AL-SANOF         TO CNHINTA
 22312        END-IF
 22313     END-IF
 22314     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22315     MOVE PB-CERT-SFX                TO CSUFIXO.
 22316     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22317     MOVE SPACE                      TO DC-OPTION-CODE.
 22318     PERFORM 9700-DATE-LINK.
 22319     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22320
 22321     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 409
* VP6311.cbl
 22322        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22323        MOVE SPACE                   TO DC-OPTION-CODE
 22324        PERFORM 9700-DATE-LINK
 22325        IF NO-CONVERSION-ERROR
 22326           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22327
 22328     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22329        NEXT SENTENCE
 22330     ELSE
 22331        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22332
 22333     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22334        NEXT SENTENCE
 22335     ELSE
 22336        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22337
 22338     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22339        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22340        MOVE SPACE                   TO DC-OPTION-CODE
 22341        PERFORM 9700-DATE-LINK
 22342        IF NO-CONVERSION-ERROR
 22343           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22344
 22345     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22346         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22347
 22348     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22349         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22350
 22351     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22352        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22353        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22354                 GIVING CDRFND1O.
 22355
 22356     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22357        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22358        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22359                 GIVING CDRFND2O.
 22360
 22361     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22362       IF PB-RECORD-ON-HOLD
 22363          MOVE 'ON HOLD'             TO CBILIT1O.
 22364
 22365     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22366       IF PB-RECORD-RETURNED
 22367          MOVE 'RETURNED'            TO CBILIT1O.
 22368
 22369     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22370        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22371             MOVE 'OVERRIDE'         TO CBILIT1O.
 22372
 22373     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22374       IF PB-RECORD-ON-HOLD
 22375          MOVE 'ON HOLD'             TO CBILIT2O.
 22376
 22377     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22378       IF PB-RECORD-RETURNED
 22379          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 410
* VP6311.cbl
 22380
 22381     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22382        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22383             MOVE 'OVERRIDE'         TO CBILIT2O.
 22384
 22385     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22386     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22387     IF PB-C-POST-CARD-IND = 'Y'
 22388        MOVE 'Y'                     TO CPCYNO
 22389     ELSE
 22390        MOVE 'N'                     TO CPCYNO
 22391     END-IF
 22392     MOVE PB-FORCE-CODE              TO CFORCEO.
 22393     MOVE PB-RECORD-BILL             TO CBILCDO.
 22394     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22395     MOVE SPACES                     TO CINITSO.
 22396     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22397         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22398     ELSE
 22399         MOVE PB-CI-INITIALS         TO CINITSO
 22400     END-IF.
 22401
 22402     IF PB-CI-CANCEL-FEE NUMERIC
 22403        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22404        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22405     ELSE
 22406        MOVE ZEROES                  TO W-CANCEL-FEE.
 22407
 22408     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22409
 22410     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22411        ADD PB-CI-LF-PREMIUM-AMT
 22412             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22413
 22414     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22415        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22416
 22417     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22418     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22419     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22420     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22421
 22422     IF PB-C-LIVES NUMERIC
 22423        MOVE PB-C-LIVES              TO CLIVESO.
 22424
 22425     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22426        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22427
 22428     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22429        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22430        MOVE SPACE                   TO DC-OPTION-CODE
 22431        PERFORM 9700-DATE-LINK
 22432        IF NO-CONVERSION-ERROR
 22433           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22434
 22435     IF  PB-C-REFUND-CREATED
 22436         MOVE 'YES'                  TO CRFNDSWO
 22437     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 411
* VP6311.cbl
 22438         IF PB-C-REFUND-REQUESTED
 22439            MOVE 'REQ'               TO CRFNDSWO
 22440         ELSE
 22441            MOVE 'NO'                TO CRFNDSWO.
 22442
 22443     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22444     MOVE SPACE                      TO DC-OPTION-CODE.
 22445     PERFORM 9700-DATE-LINK.
 22446     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22447     MOVE PB-INPUT-BY                TO CENTBYO.
 22448
 22449     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22450        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22451        MOVE SPACE                   TO DC-OPTION-CODE
 22452        PERFORM 9700-DATE-LINK
 22453        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22454        MOVE 'INACTIVE'              TO CMOENDTO
 22455     ELSE
 22456        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22457        MOVE SPACE                   TO DC-OPTION-CODE
 22458        PERFORM 9700-DATE-LINK
 22459        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22460        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22461        MOVE SPACE                   TO DC-OPTION-CODE
 22462        PERFORM 9700-DATE-LINK
 22463        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22464
 22465     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22466
 22467     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22468     MOVE WS-HR-MINS                 TO CMANTATO.
 22469
 22470     EVALUATE PB-LF-REFUND-TYPE
 22471        WHEN '1'
 22472           MOVE 'RULE78'            TO CLFREFNO
 22473        WHEN '2'
 22474           MOVE 'PRORAT'            TO CLFREFNO
 22475        WHEN '3'
 22476           MOVE 'CALIF'             TO CLFREFNO
 22477        WHEN '4'
 22478           MOVE 'IRREG'             TO CLFREFNO
 22479        WHEN '5'
 22480           MOVE 'NETPAY'            TO CLFREFNO
 22481        WHEN '6'
 22482           MOVE 'ATCP'              TO CLFREFNO
 22483        WHEN '7'
 22484           MOVE 'UTAH'              TO CLFREFNO
 22485        WHEN '8'
 22486           MOVE 'MEAN'              TO CLFREFNO
 22487        WHEN '9'
 22488           MOVE 'SUM '              TO CLFREFNO
 22489        WHEN 'B'
 22490           MOVE 'BALN'              TO CLFREFNO
 22491     END-EVALUATE.
 22492
 22493     EVALUATE TRUE
 22494        WHEN PB-AH-REFUND-TYPE =  '1'
 22495           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 412
* VP6311.cbl
 22496        WHEN PB-AH-REFUND-TYPE =  '2'
 22497           MOVE 'PRORAT'            TO CAHREFNO
 22498        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22499           MOVE 'CALIF'             TO CAHREFNO
 22500        WHEN PB-AH-REFUND-TYPE =  '4'
 22501           MOVE 'IRREG'             TO CAHREFNO
 22502        WHEN PB-AH-REFUND-TYPE =  '5'
 22503           MOVE 'NETPAY'            TO CAHREFNO
 22504        WHEN PB-AH-REFUND-TYPE =  '6'
 22505           MOVE 'ATCP'              TO CAHREFNO
 22506        WHEN PB-AH-REFUND-TYPE =  '7'
 22507           MOVE 'UTAH'              TO CAHREFNO
 22508        WHEN PB-AH-REFUND-TYPE =  '8'
 22509           MOVE 'MEAN'              TO CAHREFNO
 22510        WHEN PB-AH-REFUND-TYPE =  '9'
 22511           MOVE 'SUM '              TO CAHREFNO
 22512        WHEN PB-AH-REFUND-TYPE =  'B'
 22513           MOVE 'BALN'              TO CAHREFNO
 22514     END-EVALUATE.
 22515
 22516     MOVE PB-REIN-CD                 TO CREINCDO.
 22517
 22518     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22519        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22520        MOVE SPACE                   TO DC-OPTION-CODE
 22521        PERFORM 9700-DATE-LINK
 22522        IF NO-CONVERSION-ERROR
 22523           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22524
 22525     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22526        MOVE 999999                  TO WS-EXP-DT-EDIT
 22527        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22528        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22529     ELSE
 22530        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22531           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22532           MOVE SPACE                   TO DC-OPTION-CODE
 22533           PERFORM 9700-DATE-LINK
 22534           IF NO-CONVERSION-ERROR
 22535              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22536
 22537     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22538        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22539           MOVE AL-SANOF                TO CORIGHDA
 22540           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22541           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22542
 22543     MOVE PB-CSR-ID              TO CCSRO.
 22544
 22545     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22546     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22547
 22548     MOVE 'C'                    TO CMAINTI.
 22549     MOVE AL-UANON               TO CMAINTA.
 22550
 22551     IF PI-6316-FINALIZED = 'Y'  AND
 22552        PB-UNFORCED-ERRORS
 22553          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 413
* VP6311.cbl
 22554          MOVE  1                TO SET-CURSOR-SW
 22555     END-IF
 22556
 22557     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22558        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22559
 22560     IF NO-CURSOR-SET
 22561        MOVE -1                  TO CMAINTL.
 22562
 22563     GO TO 8100-SEND-INITIAL-MAP.
 22564
 22565
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 414
* VP6311.cbl
 22567***************************************************************
 22568*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22569*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22570***************************************************************
 22571
 22572 7200-DISPLAY-BATCHES.
 22573     MOVE VP631D                 TO PI-MAP-NAME.
 22574     MOVE LOW-VALUES             TO VP631DI.
 22575
 22576     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22577
 22578
 22579* EXEC CICS HANDLE CONDITION
 22580*         NOTFND   (3690-NOT-FOUND)
 22581*    END-EXEC.
 22582*    MOVE '"$I                   ! Y #00018833' TO DFHEIV0
 22583     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22585     MOVE X'5920233030303138383333' TO DFHEIV0(25:11)
 22586     CALL 'kxdfhei1' USING DFHEIV0
 22587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22588
 22589
 22590     IF PI-DISPLAY-SCREEN
 22591        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22592     ELSE
 22593        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22594
 22595     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22596     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22597
 22598
 22599* EXEC CICS READ
 22600*         DATASET   (FILE-ID-ERPNDB)
 22601*         RIDFLD    (ERPNDB-KEY)
 22602*         SET       (ADDRESS OF PENDING-BUSINESS)
 22603*    END-EXEC.
 22604*    MOVE '&"S        E          (   #00018845' TO DFHEIV0
 22605     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22607     MOVE X'2020233030303138383435' TO DFHEIV0(25:11)
 22608     CALL 'kxdfhei1' USING DFHEIV0,
 22609           FILE-ID-ERPNDB,
 22610           DFHEIV20,
 22611           DFHEIV99,
 22612           ERPNDB-KEY,
 22613           DFHEIV99,
 22614           DFHEIV99,
 22615           DFHEIV99
 22616     SET ADDRESS OF PENDING-BUSINESS TO
 22617         DFHEIV20
 22618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22619
 22620
 22621     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22622     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22623     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22624     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 415
* VP6311.cbl
 22625     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22626
 22627     MOVE VP631D                 TO PI-MAP-NAME.
 22628     MOVE LOW-VALUES             TO VP631DI.
 22629     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22630
 22631*    IF PI-AR-PROCESSING
 22632*       MOVE PB-REFERENCE        TO DREFO.
 22633
 22634     MOVE PB-CSR-ID              TO DCSRO.
 22635
 22636     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22637        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22638        MOVE SPACE               TO DC-OPTION-CODE
 22639        PERFORM 9700-DATE-LINK
 22640        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22641        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22642        MOVE 'INACTIVE'          TO DLDATEO
 22643     ELSE
 22644        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22645        MOVE SPACE               TO DC-OPTION-CODE
 22646        PERFORM 9700-DATE-LINK
 22647        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22648
 22649     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22650     MOVE SPACE                  TO DC-OPTION-CODE.
 22651     PERFORM 9700-DATE-LINK.
 22652     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22653
 22654     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22655        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22656     ELSE
 22657        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22658        MOVE SPACE               TO DC-OPTION-CODE
 22659        PERFORM 9700-DATE-LINK
 22660        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22661
 22662     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22663     MOVE SPACE                  TO DC-OPTION-CODE.
 22664     PERFORM 9700-DATE-LINK.
 22665     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22666
 22667     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22668     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22669
 22670     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22671        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22672                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22673
 22674     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22675     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22676     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22677
 22678     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22679        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22680                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22681
 22682     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 416
* VP6311.cbl
 22683     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22684     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22685
 22686     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22687        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22688                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22689
 22690     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22691     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22692
 22693     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22694        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22695                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22696
 22697     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22698     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22699     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22700
 22701     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22702        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22703                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22704
 22705     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22706     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22707     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22708
 22709     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22710        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22711                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22712
 22713     MOVE -1                     TO DPFENTRL.
 22714     GO TO 8100-SEND-INITIAL-MAP.
 22715
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 417
* VP6311.cbl
 22717
 22718***************************************************************
 22719*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22720*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22721*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22722*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22723*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22724*     ARE THEN SET ACCORDINGLY.                               *
 22725*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22726*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22727*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22728***************************************************************
 22729
 22730******************************************************************
 22731*                                                                *
 22732*            E R R O R   A N A L Y S I S                         *
 22733*                                                                *
 22734******************************************************************
 22735
 22736******************************************************************
 22737*                                                                *
 22738*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22739*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22740*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22741*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22742*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22743*                                                                *
 22744*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22745*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22746*                                                                *
 22747******************************************************************
 22748
 22749 7300-FORMAT-ERRORS.
 22750     MOVE ' '                    TO PI-ERRORS-SW
 22751     IF PB-COMMON-ERRORS = LOW-VALUES
 22752        IF PB-FATAL-ERRORS
 22753           MOVE ER-2695          TO EMI-ERROR
 22754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22755           GO TO 7399-EXIT.
 22756
 22757     MOVE +0                     TO WS-SUB4.
 22758
 22759 7310-ERROR-LOOP.
 22760
 22761     ADD +1                      TO WS-SUB4.
 22762
 22763     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22764        GO TO 7350-SET-ERROR-FLAGS.
 22765
 22766     IF PI-COMPANY-ID = 'UCL'
 22767         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22768             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22769             MOVE ' '                   TO DC-OPTION-CODE
 22770             PERFORM 9700-DATE-LINK
 22771             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22772
 22773     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22774     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 418
* VP6311.cbl
 22775     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22776
 22777     GO TO 7310-ERROR-LOOP.
 22778
 22779
 22780 7350-SET-ERROR-FLAGS.
 22781
 22782     IF EMI-FATAL-CTR NOT = ZEROS
 22783        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22784        MOVE 'X'                 TO PB-FATAL-FLAG
 22785                                    PI-ERRORS-SW
 22786        GO TO 7355-SET-ERROR-FLAGS.
 22787
 22788     move ' ' to pi-unforced-sw
 22789     IF EMI-FORCABLE-CTR NOT = ZEROS
 22790        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22791        IF PB-ISSUE
 22792           IF PB-ISSUE-FORCE
 22793              MOVE 'F'           TO PB-FORCE-ER-CD
 22794              MOVE ER-2600       TO EMI-ERROR
 22795              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22796             ELSE
 22797              MOVE 'X'           TO PB-FORCE-ER-CD
 22798*                                   PI-ERRORS-SW
 22799          ELSE
 22800           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22801              MOVE 'F'           TO PB-FORCE-ER-CD
 22802                                    pi-unforced-sw
 22803              MOVE ER-2600       TO EMI-ERROR
 22804              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22805             ELSE
 22806              MOVE 'X'           TO PB-FORCE-ER-CD
 22807                                    pi-unforced-sw.
 22808*                                   PI-ERRORS-SW.
 22809
 22810     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22811     IF PB-ISSUE
 22812         MOVE 'I'                TO ENDT-RECORD-TYPE
 22813     ELSE
 22814         MOVE 'C'                TO ENDT-RECORD-TYPE
 22815     END-IF
 22816     MOVE +0                     TO ENDT-SEQ-NO
 22817
 22818
 22819* EXEC CICS READ
 22820*        DATASET   (FILE-ID-ERENDT)
 22821*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22822*        RIDFLD    (ERENDT-KEY)
 22823*        RESP      (WS-RESPONSE)
 22824*        GTEQ
 22825*    END-EXEC
 22826*    MOVE '&"S        G          (  N#00019048' TO DFHEIV0
 22827     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22828     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22829     MOVE X'204E233030303139303438' TO DFHEIV0(25:11)
 22830     CALL 'kxdfhei1' USING DFHEIV0,
 22831           FILE-ID-ERENDT,
 22832           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 419
* VP6311.cbl
 22833           DFHEIV99,
 22834           ERENDT-KEY,
 22835           DFHEIV99,
 22836           DFHEIV99,
 22837           DFHEIV99
 22838     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22839         DFHEIV20
 22840     MOVE EIBRESP  TO WS-RESPONSE
 22841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22842
 22843     IF RESP-NORMAL
 22844        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22845        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22846            MOVE ER-0280          TO EMI-ERROR
 22847            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22848            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22849            EVALUATE TRUE
 22850              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22851                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22852              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22853                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22854              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22855                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22856            END-EVALUATE
 22857        END-IF
 22858     END-IF
 22859
 22860
 22861
 22862     IF FIRST-ENTRY OR
 22863        EIBAID = DFHPF1 OR DFHPF2
 22864        MOVE '0'                TO PI-EDIT-SW
 22865        GO TO 7399-EXIT.
 22866
 22867 7355-SET-ERROR-FLAGS.
 22868
 22869     IF EMI-WARNING-CTR NOT = ZEROS
 22870        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22871        MOVE 'W'                 TO PB-WARN-ER-CD.
 22872
 22873     IF PB-UNFORCED-ERRORS OR
 22874        PB-FATAL-ERRORS    OR
 22875        PB-RECORD-ON-HOLD  OR
 22876        PB-RECORD-RETURNED OR
 22877        PB-CANCELLATION
 22878          NEXT SENTENCE
 22879        ELSE
 22880          GO TO 7399-EXIT.
 22881
 22882
 22883* EXEC CICS  HANDLE CONDITION
 22884*           NOTFND   (7399-EXIT)
 22885*    END-EXEC.
 22886*    MOVE '"$I                   ! Z #00019095' TO DFHEIV0
 22887     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22889     MOVE X'5A20233030303139303935' TO DFHEIV0(25:11)
 22890     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 420
* VP6311.cbl
 22891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22892
 22893
 22894     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22895     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22896     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22897     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22898
 22899
 22900* EXEC CICS READ
 22901*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22902*        DATASET (FILE-ID-ELCERT)
 22903*        RIDFLD  (ELCERT-KEY)
 22904*        UPDATE
 22905*    END-EXEC.
 22906*    MOVE '&"S        EU         (   #00019104' TO DFHEIV0
 22907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22908     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22909     MOVE X'2020233030303139313034' TO DFHEIV0(25:11)
 22910     CALL 'kxdfhei1' USING DFHEIV0,
 22911           FILE-ID-ELCERT,
 22912           DFHEIV20,
 22913           DFHEIV99,
 22914           ELCERT-KEY,
 22915           DFHEIV99,
 22916           DFHEIV99,
 22917           DFHEIV99
 22918     SET ADDRESS OF CERTIFICATE-MASTER TO
 22919         DFHEIV20
 22920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22921
 22922
 22923
 22924     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22925     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22926
 22927     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22928        GO TO 7360-REWRITE-CERT-MASTER.
 22929
 22930     IF PB-ISSUE
 22931        IF PB-RECORD-RETURNED
 22932            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22933            GO TO 7360-REWRITE-CERT-MASTER
 22934        ELSE
 22935            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22936            GO TO 7360-REWRITE-CERT-MASTER.
 22937
 22938     IF PB-RECORD-RETURNED
 22939         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22940         GO TO 7360-REWRITE-CERT-MASTER.
 22941
 22942     IF (PB-C-LF-CANCEL-VOIDED)
 22943        or (pb-c-ah-cancel-voided)
 22944        IF (PB-UNFORCED-ERRORS OR
 22945            PB-FATAL-ERRORS    OR
 22946            PB-RECORD-ON-HOLD)
 22947            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22948            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 421
* VP6311.cbl
 22949        ELSE
 22950            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22951            GO TO 7360-REWRITE-CERT-MASTER.
 22952
 22953     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22954                            OR PB-RECORD-ON-HOLD)
 22955        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22956     ELSE
 22957        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22958
 22959 7360-REWRITE-CERT-MASTER.
 22960
 22961     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22962        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22963
 22964* EXEC CICS UNLOCK
 22965*            DATASET    (FILE-ID-ELCERT)
 22966*       END-EXEC
 22967*    MOVE '&*                    #   #00019151' TO DFHEIV0
 22968     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22969     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22970     MOVE X'2020233030303139313531' TO DFHEIV0(25:11)
 22971     CALL 'kxdfhei1' USING DFHEIV0,
 22972           FILE-ID-ELCERT,
 22973           DFHEIV99
 22974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22975        GO TO 7399-EXIT.
 22976
 22977
 22978* EXEC CICS REWRITE
 22979*         DATASET    (FILE-ID-ELCERT)
 22980*         FROM       (CERTIFICATE-MASTER)
 22981*    END-EXEC.
 22982     MOVE LENGTH OF
 22983      CERTIFICATE-MASTER
 22984       TO DFHEIV11
 22985*    MOVE '&& L                  %   #00019156' TO DFHEIV0
 22986     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22987     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22988     MOVE X'2020233030303139313536' TO DFHEIV0(25:11)
 22989     CALL 'kxdfhei1' USING DFHEIV0,
 22990           FILE-ID-ELCERT,
 22991           CERTIFICATE-MASTER,
 22992           DFHEIV11,
 22993           DFHEIV99
 22994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22995
 22996
 22997 7399-EXIT.
 22998      EXIT.
 22999
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 422
* VP6311.cbl
 23001
 23002*************************************************************
 23003*                                                           *
 23004*              S E T   A T T R I B U T E S                  *
 23005*                                                           *
 23006*************************************************************
 23007
 23008 7400-SET-ATTRIBUTES.
 23009
 23010     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23011        GO TO 7499-EXIT.
 23012
 23013**2601**
 23014
 23015     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23016        IF PB-ISSUE
 23017           MOVE AL-UABON         TO BEFFDTA
 23018           GO TO 7499-EXIT
 23019         ELSE
 23020           MOVE AL-UABON         TO CEFFDTA
 23021           GO TO 7499-EXIT.
 23022
 23023**2604**
 23024
 23025     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23026        IF PB-ISSUE
 23027           MOVE AL-UABON         TO BTYPE1A
 23028           MOVE -1               TO BTYPE1L
 23029           MOVE  1               TO SET-CURSOR-SW
 23030           GO TO 7499-EXIT.
 23031
 23032**2605**
 23033
 23034     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23035        IF PB-ISSUE
 23036           MOVE AL-UABON         TO BTYPE2A
 23037           MOVE -1               TO BTYPE2L
 23038           MOVE  1               TO SET-CURSOR-SW
 23039           GO TO 7499-EXIT.
 23040
 23041**2606**
 23042
 23043     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23044        IF PB-ISSUE
 23045           MOVE AL-UABON         TO BSIGA
 23046           MOVE -1               TO BSIGL
 23047           MOVE  1               TO SET-CURSOR-SW
 23048           GO TO 7499-EXIT.
 23049
 23050**2607**
 23051
 23052     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23053        IF PB-ISSUE
 23054           MOVE AL-UABON         TO BSIGA
 23055           MOVE -1               TO BSIGL
 23056           MOVE  1               TO SET-CURSOR-SW
 23057           GO TO 7499-EXIT.
 23058
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 423
* VP6311.cbl
 23059**2615**
 23060
 23061     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23062        IF PB-ISSUE
 23063           MOVE AL-UABOF         TO BREINA
 23064           MOVE -1               TO BREINL
 23065           GO TO 7499-EXIT.
 23066
 23067**2622**
 23068
 23069     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23070        IF PB-ISSUE
 23071           MOVE AL-UABON         TO BEFFDTA
 23072           GO TO 7499-EXIT
 23073        ELSE
 23074           MOVE AL-UABON         TO CEFFDTA
 23075           GO TO 7499-EXIT.
 23076
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 424
* VP6311.cbl
 23078
 23079*************************************************************
 23080*                                                           *
 23081*              I S S U E   E R R O R S                      *
 23082*                                                           *
 23083*************************************************************
 23084
 23085 7420-ISSUE-ERRORS.
 23086
 23087**2626**
 23088
 23089     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23090        MOVE AL-UABON            TO BCERTNOA
 23091        GO TO 7499-EXIT.
 23092
 23093**2627**
 23094
 23095     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23096        MOVE AL-UNBON            TO BAGEA
 23097        MOVE -1                  TO BAGEL
 23098        MOVE  1                  TO SET-CURSOR-SW
 23099        GO TO 7499-EXIT.
 23100
 23101**2628**
 23102
 23103     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23104        MOVE AL-UNBON            TO BAGEA
 23105        MOVE -1                  TO BAGEL
 23106        MOVE  1                  TO SET-CURSOR-SW
 23107        GO TO 7499-EXIT.
 23108
 23109**2629**
 23110
 23111     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23112        MOVE AL-UABON            TO BSEXA
 23113        MOVE -1                  TO BSEXL
 23114        MOVE  1                  TO SET-CURSOR-SW
 23115        GO TO 7499-EXIT.
 23116
 23117**2630**
 23118
 23119     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23120        MOVE -1                  TO BTYPE1L
 23121        MOVE  1                  TO SET-CURSOR-SW
 23122        GO TO 7499-EXIT.
 23123
 23124**2631**
 23125
 23126     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23127        MOVE -1                  TO BTYPE1L
 23128        MOVE  1                  TO SET-CURSOR-SW
 23129        GO TO 7499-EXIT.
 23130
 23131**2632**
 23132
 23133     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23134        MOVE AL-UNBON            TO BBEN1A
 23135        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 425
* VP6311.cbl
 23136        MOVE  1                  TO SET-CURSOR-SW
 23137        GO TO 7499-EXIT.
 23138
 23139**2633**
 23140
 23141     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23142        MOVE AL-UNBON            TO BPREM1A
 23143        MOVE -1                  TO BPREM1L
 23144        MOVE  1                  TO SET-CURSOR-SW
 23145        GO TO 7499-EXIT.
 23146
 23147**2634**
 23148
 23149     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23150        MOVE -1                  TO BTYPE2L
 23151        MOVE  1                  TO SET-CURSOR-SW
 23152        GO TO 7499-EXIT.
 23153
 23154**2635**
 23155
 23156     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23157        MOVE AL-UNBON            TO BBEN2A
 23158        MOVE -1                  TO BBEN2L
 23159        MOVE  1                  TO SET-CURSOR-SW
 23160        GO TO 7499-EXIT.
 23161
 23162**2636**
 23163
 23164     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23165        MOVE AL-UNBON            TO BPREM2A
 23166        MOVE -1                  TO BPREM2L
 23167        MOVE  1                  TO SET-CURSOR-SW
 23168        GO TO 7499-EXIT.
 23169
 23170**2639**
 23171
 23172     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23173        MOVE AL-UNBON            TO BBEN1A
 23174        MOVE -1                  TO BBEN1L
 23175        MOVE  1                  TO SET-CURSOR-SW
 23176        GO TO 7499-EXIT.
 23177
 23178**2640**
 23179
 23180     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23181        MOVE AL-UNBON            TO BBEN2A
 23182        MOVE -1                  TO BBEN2L
 23183        MOVE  1                  TO SET-CURSOR-SW
 23184        GO TO 7499-EXIT.
 23185
 23186**2647**
 23187
 23188     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23189        MOVE AL-UNBON            TO BTERM1A
 23190        MOVE -1                  TO BTERM1L
 23191        MOVE  1                  TO SET-CURSOR-SW
 23192        GO TO 7499-EXIT.
 23193
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 426
* VP6311.cbl
 23194
 23195**2649**
 23196
 23197     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23198        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23199            MOVE AL-UNBON            TO BPREM1A
 23200            MOVE -1                  TO BPREM1L
 23201            MOVE  1                  TO SET-CURSOR-SW
 23202            GO TO 7499-EXIT
 23203     ELSE
 23204        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23205           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23206            MOVE AL-UNBON            TO BPREM2A
 23207            MOVE -1                  TO BPREM2L
 23208            MOVE  1                  TO SET-CURSOR-SW
 23209            GO TO 7499-EXIT.
 23210
 23211**2650**
 23212
 23213     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23214        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23215            MOVE AL-UNBON        TO BPREM1A
 23216            MOVE -1              TO BPREM1L
 23217            MOVE  1              TO SET-CURSOR-SW
 23218            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23219                MOVE AL-UNBON        TO BPREM2A
 23220                MOVE -1              TO BPREM2L
 23221                MOVE  1              TO SET-CURSOR-SW
 23222                GO TO 7499-EXIT
 23223            ELSE
 23224                GO TO 7499-EXIT
 23225        ELSE
 23226            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23227                MOVE AL-UNBON        TO BPREM2A
 23228                MOVE -1              TO BPREM2L
 23229                MOVE  1              TO SET-CURSOR-SW
 23230                GO TO 7499-EXIT
 23231            ELSE
 23232                GO TO 7499-EXIT.
 23233
 23234**2651**
 23235
 23236     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23237        MOVE AL-UABON            TO BSIGA
 23238        MOVE -1                  TO BSIGL
 23239        MOVE  1                  TO SET-CURSOR-SW
 23240        GO TO 7499-EXIT.
 23241
 23242
 23243
 23244
 23245**2658**
 23246
 23247     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23248        MOVE AL-UNBON            TO BTERM2A
 23249        MOVE -1                  TO BTERM2L
 23250        MOVE  1                  TO SET-CURSOR-SW
 23251        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 427
* VP6311.cbl
 23252
 23253**2660**
 23254
 23255     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23256        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23257        MOVE -1                  TO BLSTNML
 23258        MOVE  1                  TO SET-CURSOR-SW
 23259        GO TO 7499-EXIT.
 23260
 23261
 23262**2662**
 23263
 23264     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23265        MOVE AL-UNBON            TO BAGEA
 23266        MOVE -1                  TO BAGEL
 23267        MOVE  1                  TO SET-CURSOR-SW
 23268        GO TO 7499-EXIT.
 23269
 23270**2663**
 23271
 23272     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23273        MOVE AL-UNBON            TO BAGEA
 23274        MOVE -1                  TO BAGEL
 23275        MOVE  1                  TO SET-CURSOR-SW
 23276        GO TO 7499-EXIT.
 23277
 23278**2664**
 23279
 23280     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23281        MOVE AL-UABON            TO BREINA
 23282        MOVE -1                  TO BREINL
 23283        MOVE  1                  TO SET-CURSOR-SW
 23284        GO TO 7499-EXIT.
 23285
 23286**2667**
 23287
 23288     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23289        MOVE AL-UNBON            TO BBEN2A
 23290        MOVE -1                  TO BBEN2L
 23291        MOVE  1                  TO SET-CURSOR-SW
 23292        GO TO 7499-EXIT.
 23293
 23294**2668**
 23295
 23296     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23297        MOVE AL-UABON            TO BEFFDTA
 23298        GO TO 7499-EXIT.
 23299
 23300**2669**
 23301
 23302     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23303       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23304       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23305        MOVE AL-UNBON            TO BAGEA
 23306        MOVE -1                  TO BAGEL
 23307        MOVE  1                  TO SET-CURSOR-SW
 23308        GO TO 7499-EXIT.
 23309
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 428
* VP6311.cbl
 23310**2670**
 23311
 23312     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23313        MOVE AL-UABON            TO BFORCEA
 23314        MOVE -1                  TO BFORCEL
 23315        MOVE  1                  TO SET-CURSOR-SW
 23316        GO TO 7499-EXIT.
 23317
 23318**2671**
 23319
 23320     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23321        MOVE AL-UABON            TO BEFFDTA
 23322        GO TO 7499-EXIT.
 23323
 23324**2672**
 23325
 23326     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23327        MOVE AL-UABON            TO BEFFDTA
 23328        GO TO 7499-EXIT.
 23329
 23330**2673**
 23331
 23332     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23333        MOVE AL-UABON            TO BEFFDTA
 23334        GO TO 7499-EXIT.
 23335
 23336**2674**
 23337
 23338     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23339        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23340        MOVE -1                  TO BTYPE1L
 23341        MOVE  1                  TO SET-CURSOR-SW
 23342        GO TO 7499-EXIT.
 23343
 23344**2677**
 23345
 23346     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23347        MOVE AL-UNBON            TO BTERM1A
 23348        MOVE -1                  TO BTERM1L
 23349        MOVE  1                  TO SET-CURSOR-SW
 23350        GO TO 7499-EXIT.
 23351
 23352**2678**
 23353
 23354     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23355        MOVE AL-UNBON            TO BTERM2A
 23356        MOVE -1                  TO BTERM2L
 23357        MOVE  1                  TO SET-CURSOR-SW
 23358        GO TO 7499-EXIT.
 23359
 23360**2679**
 23361
 23362     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23363        MOVE AL-UABON            TO BTYPE1A
 23364        MOVE -1                  TO BTYPE1L
 23365        MOVE  1                  TO SET-CURSOR-SW
 23366        GO TO 7499-EXIT.
 23367
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 429
* VP6311.cbl
 23368
 23369
 23370**2682**
 23371
 23372     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23373        MOVE AL-UABON            TO BTERM1A
 23374        MOVE -1                  TO BTERM1L
 23375        MOVE  1                  TO SET-CURSOR-SW
 23376        GO TO 7499-EXIT.
 23377
 23378**2683**
 23379
 23380     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23381        MOVE AL-UABON            TO BSKPCDA
 23382        MOVE -1                  TO BSKPCDL
 23383        MOVE  1                  TO SET-CURSOR-SW
 23384        GO TO 7499-EXIT.
 23385
 23386**2684**
 23387
 23388     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23389        MOVE AL-UABON            TO BTYPE2A
 23390        MOVE -1                  TO BTYPE2L
 23391        MOVE  1                  TO SET-CURSOR-SW
 23392        GO TO 7499-EXIT.
 23393
 23394**2686**
 23395
 23396     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23397        MOVE AL-UABON            TO BTYPE2A
 23398        MOVE -1                  TO BTYPE2L
 23399        MOVE  1                  TO SET-CURSOR-SW
 23400        GO TO 7499-EXIT.
 23401
 23402**2689**
 23403
 23404     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23405        MOVE AL-UABON            TO BSIGA
 23406        MOVE -1                  TO BSIGL
 23407        MOVE  1                  TO SET-CURSOR-SW
 23408        GO TO 7499-EXIT.
 23409
 23410**2690**
 23411
 23412     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23413        MOVE AL-UABOF            TO BLNOFCRA
 23414        MOVE -1                  TO BLNOFCRL
 23415        MOVE  1                  TO SET-CURSOR-SW
 23416        GO TO 7499-EXIT.
 23417
 23418**2693**
 23419
 23420     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23421        MOVE AL-UABOF            TO BLNOFCRA
 23422        MOVE AL-UNBON            TO BBEN1A
 23423        MOVE -1                  TO BBEN1L
 23424        MOVE  1                  TO SET-CURSOR-SW
 23425        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 430
* VP6311.cbl
 23426
 23427**2720**
 23428
 23429     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23430        MOVE AL-UNBON            TO BBEN1A
 23431        MOVE -1                  TO BBEN1L
 23432        MOVE  1                  TO SET-CURSOR-SW
 23433        GO TO 7499-EXIT.
 23434
 23435**2709**
 23436
 23437*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23438*       MOVE AL-UNBON            TO BBEN1A
 23439*       MOVE -1                  TO BBEN1L
 23440*       MOVE  1                  TO SET-CURSOR-SW
 23441*       GO TO 7499-EXIT.
 23442
 23443*************************************************************
 23444*                                                           *
 23445*            C A N C E L   E R R O R S                      *
 23446*                                                           *
 23447*************************************************************
 23448
 23449**2726**
 23450
 23451     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23452        MOVE AL-UABON            TO CCERTNOA
 23453        GO TO 7499-EXIT.
 23454
 23455**2728**
 23456
 23457     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23458        MOVE AL-UABON            TO CCERTNOA
 23459        GO TO 7499-EXIT.
 23460
 23461**2729**
 23462
 23463     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23464        MOVE AL-UABON            TO CCERTNOA
 23465        GO TO 7499-EXIT.
 23466
 23467**2730**
 23468
 23469     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23470        MOVE AL-UABON            TO CCERTNOA
 23471        GO TO 7499-EXIT.
 23472
 23473**2731**
 23474
 23475     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23476        MOVE AL-UABON            TO CCANDT1A
 23477        MOVE -1                  TO CCANDT1L
 23478        MOVE  1                  TO SET-CURSOR-SW
 23479        GO TO 7499-EXIT.
 23480
 23481**2732**
 23482
 23483     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 431
* VP6311.cbl
 23484        MOVE AL-UABON            TO CCANDT1A
 23485        MOVE -1                  TO CCANDT1L
 23486        MOVE  1                  TO SET-CURSOR-SW
 23487        GO TO 7499-EXIT.
 23488
 23489**2733**
 23490
 23491     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23492        MOVE AL-UABON            TO CCANDT1A
 23493        MOVE -1                  TO CCANDT1L
 23494        MOVE  1                  TO SET-CURSOR-SW
 23495        GO TO 7499-EXIT.
 23496
 23497**2734**
 23498
 23499     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23500        MOVE AL-UNBON            TO CREFND1A
 23501        MOVE -1                  TO CREFND1L
 23502        MOVE  1                  TO SET-CURSOR-SW
 23503        GO TO 7499-EXIT.
 23504
 23505**2735**
 23506
 23507     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23508        MOVE AL-UABON            TO CCANDT2A
 23509        MOVE -1                  TO CCANDT2L
 23510        MOVE  1                  TO SET-CURSOR-SW
 23511        GO TO 7499-EXIT.
 23512
 23513**2736**
 23514
 23515     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23516        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23517            MOVE AL-UNBON        TO CREFND1A
 23518            MOVE -1              TO CREFND1L
 23519            MOVE  1              TO SET-CURSOR-SW
 23520            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23521                MOVE AL-UNBON        TO CREFND2A
 23522                MOVE -1              TO CREFND2L
 23523                MOVE  1              TO SET-CURSOR-SW
 23524                GO TO 7499-EXIT
 23525            ELSE
 23526                GO TO 7499-EXIT
 23527        ELSE
 23528            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23529                MOVE AL-UNBON        TO CREFND2A
 23530                MOVE -1              TO CREFND2L
 23531                MOVE  1              TO SET-CURSOR-SW
 23532                GO TO 7499-EXIT
 23533            ELSE
 23534                GO TO 7499-EXIT.
 23535
 23536**2738**
 23537
 23538     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23539        MOVE -1                  TO CREFND2L
 23540        MOVE  1                  TO SET-CURSOR-SW
 23541        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 432
* VP6311.cbl
 23542
 23543**2739**
 23544
 23545     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23546        MOVE -1                  TO CREFND1L
 23547        MOVE  1                  TO SET-CURSOR-SW
 23548        GO TO 7499-EXIT.
 23549
 23550**2741**
 23551
 23552     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23553        MOVE -1                  TO CREFND1L
 23554        MOVE  1                  TO SET-CURSOR-SW
 23555        GO TO 7499-EXIT.
 23556
 23557**2743**
 23558
 23559     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23560        MOVE AL-UNBON            TO CCANDT1A
 23561        MOVE -1                  TO CCANDT1L
 23562        MOVE  1                  TO SET-CURSOR-SW
 23563        GO TO 7499-EXIT.
 23564
 23565**2744**
 23566
 23567     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23568        MOVE AL-UNBON            TO CCANDT2A
 23569        MOVE -1                  TO CCANDT2L
 23570        MOVE  1                  TO SET-CURSOR-SW
 23571        GO TO 7499-EXIT.
 23572
 23573**2747**
 23574
 23575     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23576        MOVE AL-UABON            TO CLSTNMA
 23577        MOVE -1                  TO CLSTNML
 23578        MOVE  1                  TO SET-CURSOR-SW
 23579        GO TO 7499-EXIT.
 23580
 23581**2749**
 23582
 23583     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23584        MOVE AL-UABON            TO CFORCEA
 23585        MOVE -1                  TO CFORCEL
 23586        MOVE  1                  TO SET-CURSOR-SW
 23587        GO TO 7499-EXIT.
 23588
 23589**2753**
 23590
 23591     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23592        MOVE AL-UNBON            TO CCANDT1A
 23593        MOVE -1                  TO CCANDT1L
 23594        MOVE  1                  TO SET-CURSOR-SW
 23595        GO TO 7499-EXIT.
 23596
 23597**2755**
 23598
 23599     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 433
* VP6311.cbl
 23600        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23601            MOVE AL-UNBON        TO CREFND1A
 23602            MOVE -1              TO CREFND1L
 23603            MOVE  1              TO SET-CURSOR-SW
 23604            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23605                MOVE AL-UNBON        TO CREFND2A
 23606                MOVE -1              TO CREFND2L
 23607                MOVE  1              TO SET-CURSOR-SW
 23608                GO TO 7499-EXIT
 23609            ELSE
 23610                GO TO 7499-EXIT
 23611        ELSE
 23612            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23613                MOVE AL-UNBON        TO CREFND2A
 23614                MOVE -1              TO CREFND2L
 23615                MOVE  1              TO SET-CURSOR-SW
 23616            ELSE
 23617                GO TO 7499-EXIT.
 23618
 23619**2757**
 23620
 23621     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23622        MOVE AL-UNBON            TO CLIVESA
 23623        MOVE -1                  TO CLIVESL
 23624        MOVE  1                  TO SET-CURSOR-SW
 23625        GO TO 7499-EXIT.
 23626
 23627**2771**
 23628
 23629     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23630        MOVE AL-UABON            TO CCANDT2A
 23631        MOVE -1                  TO CCANDT2L
 23632        MOVE  1                  TO SET-CURSOR-SW
 23633        GO TO 7499-EXIT.
 23634
 23635**2774**
 23636
 23637     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23638        MOVE AL-UABON            TO CCANDT1A
 23639        MOVE -1                  TO CCANDT1L
 23640        MOVE  1                  TO SET-CURSOR-SW
 23641        GO TO 7499-EXIT.
 23642
 23643**2775**
 23644
 23645     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23646        MOVE AL-UABON            TO CCANDT2A
 23647        MOVE -1                  TO CCANDT2L
 23648        MOVE  1                  TO SET-CURSOR-SW
 23649        GO TO 7499-EXIT.
 23650
 23651**2776**
 23652
 23653     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23654        MOVE AL-UABON            TO CCANDT1A
 23655        MOVE -1                  TO CCANDT1L
 23656        MOVE  1                  TO SET-CURSOR-SW
 23657        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 434
* VP6311.cbl
 23658
 23659
 23660**2777**
 23661
 23662     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23663        MOVE AL-UABON            TO CCANDT2A
 23664        MOVE -1                  TO CCANDT2L
 23665        MOVE  1                  TO SET-CURSOR-SW
 23666        GO TO 7499-EXIT.
 23667
 23668**2794**
 23669
 23670     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23671        MOVE AL-UABON            TO CFORCEA
 23672        MOVE -1                  TO CFORCEL
 23673        MOVE  1                  TO SET-CURSOR-SW
 23674        GO TO 7499-EXIT.
 23675
 23676**2799**
 23677
 23678     IF PI-COMPANY-ID = 'UCL'
 23679         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23680             MOVE AL-UNBON            TO BEFFDTA
 23681             MOVE -1                  TO BEFFDTL
 23682             MOVE  1                  TO SET-CURSOR-SW
 23683             GO TO 7499-EXIT.
 23684
 23685 7499-EXIT.
 23686      EXIT.
 23687
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 435
* VP6311.cbl
 23689
 23690 7500-READ-ERLOFC.
 23691     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23692                                     ERLOFC-KEY.
 23693
 23694     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23695
 23696     IF ST-ACCNT-CNTL
 23697         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23698
 23699     IF CARR-GROUP-ST-ACCNT-CNTL
 23700         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23701         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23702         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23703
 23704     IF CARR-ST-ACCNT-CNTL
 23705         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23706         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23707
 23708     IF CARR-ACCNT-CNTL
 23709         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23710
 23711     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23712
 23713     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23714
 23715
 23716* EXEC CICS HANDLE CONDITION
 23717*        NOTFND   (7550-OFFICER-NOTFND)
 23718*    END-EXEC.
 23719*    MOVE '"$I                   ! [ #00019879' TO DFHEIV0
 23720     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23722     MOVE X'5B20233030303139383739' TO DFHEIV0(25:11)
 23723     CALL 'kxdfhei1' USING DFHEIV0
 23724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23725
 23726
 23727
 23728* EXEC CICS READ
 23729*        DATASET   (FILE-ID-ERLOFC)
 23730*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23731*        RIDFLD    (ERLOFC-KEY)
 23732*        EQUAL
 23733*    END-EXEC.
 23734*    MOVE '&"S        E          (   #00019883' TO DFHEIV0
 23735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23737     MOVE X'2020233030303139383833' TO DFHEIV0(25:11)
 23738     CALL 'kxdfhei1' USING DFHEIV0,
 23739           FILE-ID-ERLOFC,
 23740           DFHEIV20,
 23741           DFHEIV99,
 23742           ERLOFC-KEY,
 23743           DFHEIV99,
 23744           DFHEIV99,
 23745           DFHEIV99
 23746     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 436
* VP6311.cbl
 23747         DFHEIV20
 23748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23749
 23750
 23751     GO TO 7599-EXIT.
 23752
 23753 7550-OFFICER-NOTFND.
 23754     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23755
 23756 7599-EXIT.
 23757      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 437
* VP6311.cbl
 23759******************************************************************
 23760*                                                                *
 23761*            S  E N D    I N I T I A L   M A P                   *
 23762*                                                                *
 23763******************************************************************
 23764
 23765 8100-SEND-INITIAL-MAP.
 23766     MOVE EIBTIME                TO TIME-IN.
 23767
 23768     IF EIBAID = DFHPF11
 23769        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23770        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23771
 23772
 23773     IF PI-COMPANY-ID = CLIENT-GIC
 23774        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23775                                       BCPREM-ATTRB (2).
 23776
 23777     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23778                         CLIENT-PEM OR
 23779                         CLIENT-CSO)
 23780        AND PI-DISPLAY-ORIGINAL-BATCH
 23781          IF PI-MAP-NAME = VP631B
 23782             MOVE AL-SADOF               TO BPF5HDRA
 23783                                            BPF4HDRA
 23784          ELSE
 23785             IF PI-MAP-NAME = VP631C
 23786                MOVE AL-SADOF            TO CPF5HDRA
 23787                                            CPF4HDRA.
 23788
 23789     IF PI-MAP-NAME = VP631B
 23790        MOVE AL-SADOF               TO BPF5HDRA
 23791     ELSE
 23792        MOVE AL-SADOF               TO CPF5HDRA
 23793     END-IF
 23794
 23795
 23796     IF PI-PROCESSOR-ID = 'LGXX'
 23797        IF PI-MAP-NAME = VP631B
 23798           MOVE AL-SABOF                    TO BREFHDGA
 23799           MOVE AL-SANOF                    TO BREFA
 23800        ELSE
 23801           IF PI-MAP-NAME = VP631C
 23802              MOVE AL-SABOF                 TO CREFHDGA
 23803              MOVE AL-SANOF                 TO CREFA.
 23804
 23805     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 23806        continue
 23807     ELSE
 23808        IF PI-MAP-NAME = VP631C
 23809           MOVE AL-SADOF         TO CCANTXTA
 23810                                    CCANFEEA
 23811        end-if
 23812     end-if
 23813     IF PI-MAP-NAME = VP631D
 23814        IF PI-AR-PROCESSING
 23815           MOVE AL-SANOF            TO DREFHDGA
 23816        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 438
* VP6311.cbl
 23817           MOVE AL-SADOF            TO DREFHDGA.
 23818
 23819     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 23820        AND (PI-MAP-NAME = VP631B)
 23821        MOVE AL-SADOF            TO BVINHA
 23822                                    BVINA
 23823     END-IF
 23824     IF PI-MAP-NAME = VP631B
 23825        MOVE PI-COMPANY-ID          TO BCOMPIDO
 23826        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 23827                                 TO BREGIONO
 23828        MOVE PI-PROCESSOR-ID     TO BUSERO
 23829        IF CSR-EDIT-SESSION
 23830           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23831                                 TO BHEADO
 23832           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23833        ELSE
 23834           MOVE AL-SADOF         TO BF15HDRA
 23835           MOVE '4=B-HDR      '  TO BPF4HDRO
 23836        END-IF
 23837        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23838        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23839        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23840        MOVE WS-CURRENT-DT          TO BDATEO
 23841        MOVE TIME-OUT               TO BTIMEO
 23842        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23843        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23844        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23845        IF   WS-DISPLAY-SCREEN
 23846             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23847             MOVE PB-SV-CARRIER     TO BCARRO
 23848             MOVE PB-SV-GROUPING    TO BGROUPO
 23849             MOVE PB-SV-STATE       TO BSTATEO
 23850             MOVE PB-ACCOUNT        TO BACCTO
 23851        ELSE
 23852             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23853     ELSE
 23854        IF PI-MAP-NAME = VP631C
 23855           MOVE '4=B-HDR      '     TO CPF4HDRO
 23856           IF CSR-EDIT-SESSION
 23857              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23858                                 TO CHEADO
 23859           ELSE
 23860              MOVE AL-SADOF      TO CF15HDRA
 23861           END-IF
 23862           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23863           MOVE WS-CURRENT-DT          TO CDATEO
 23864           MOVE TIME-OUT               TO CTIMEO
 23865           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23866           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23867           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23868           MOVE WS-C-HDG               TO CLFHDGO
 23869           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23870           MOVE WS-C-HDG               TO CAHHDGO
 23871           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23872           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23873           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23874           IF   WS-DISPLAY-SCREEN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 439
* VP6311.cbl
 23875                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23876                MOVE PB-SV-CARRIER     TO CCARRO
 23877                MOVE PB-SV-GROUPING    TO CGROUPO
 23878                MOVE PB-SV-STATE       TO CSTATEO
 23879                MOVE PB-ACCOUNT        TO CACCTO
 23880           ELSE
 23881                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23882        ELSE
 23883           MOVE WS-CURRENT-DT          TO DDATEO
 23884           MOVE TIME-OUT               TO DTIMEO
 23885           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23886                                          WS-REFUND-HDG-OVERRIDE
 23887           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23888           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23889           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23890                                          WS-REFUND-HDG-OVERRIDE
 23891           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23892           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23893           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23894           IF CSR-EDIT-SESSION
 23895              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23896                                 TO DHEADO
 23897           END-IF
 23898           IF  WS-DISPLAY-SCREEN
 23899               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23900               MOVE PB-CARRIER         TO DCARRO
 23901               MOVE PB-GROUPING        TO DGROUPO
 23902               MOVE PB-STATE           TO DSTATEO
 23903               MOVE PB-ACCOUNT         TO DACCTO
 23904               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23905           ELSE
 23906               MOVE VP631D             TO PI-MAP-NAME
 23907               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23908               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23909
 23910     MOVE SPACE                        TO WS-DISPLAY-SW.
 23911
 23912
 23913* EXEC CICS SEND
 23914*        MAP      (PI-MAP-NAME)
 23915*        MAPSET   (MAPSET-VP6311S)
 23916*        FROM     (VP631BI)
 23917*        ERASE
 23918*        CURSOR
 23919*    END-EXEC.
 23920     MOVE LENGTH OF
 23921      VP631BI
 23922       TO DFHEIV12
 23923     MOVE -1
 23924       TO DFHEIV11
 23925*    MOVE '8$     CT  E    H L F ,   #00020051' TO DFHEIV0
 23926     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23927     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23928     MOVE X'2020233030303230303531' TO DFHEIV0(25:11)
 23929     CALL 'kxdfhei1' USING DFHEIV0,
 23930           PI-MAP-NAME,
 23931           VP631BI,
 23932           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 440
* VP6311.cbl
 23933           MAPSET-VP6311S,
 23934           DFHEIV99,
 23935           DFHEIV99,
 23936           DFHEIV99,
 23937           DFHEIV11,
 23938           DFHEIV99,
 23939           DFHEIV99,
 23940           DFHEIV99
 23941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23942
 23943
 23944     GO TO 9100-RETURN-TRAN.
 23945
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 441
* VP6311.cbl
 23947
 23948******************************************************************
 23949*                                                                *
 23950*              S E N D    D A T A O N L Y                        *
 23951*                                                                *
 23952******************************************************************
 23953
 23954 8200-SEND-DATAONLY.
 23955     MOVE EIBTIME                TO TIME-IN.
 23956
 23957     IF PI-COMPANY-ID = CLIENT-GIC
 23958        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23959                                       BCPREM-ATTRB (2).
 23960
 23961     IF PI-MAP-NAME = VP631B
 23962        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23963        MOVE WS-CURRENT-DT          TO BDATEO
 23964        MOVE TIME-OUT               TO BTIMEO
 23965        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23966        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23967        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23968        MOVE SPACES                 TO BPFENTRO
 23969        MOVE AL-UANOF               TO BPFENTRA
 23970
 23971     ELSE
 23972        IF PI-MAP-NAME = VP631C
 23973           MOVE WS-CURRENT-DT          TO CDATEO
 23974           MOVE TIME-OUT               TO CTIMEO
 23975           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23976           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23977           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23978           MOVE SPACES                 TO CPFENTRO
 23979           MOVE AL-UANOF               TO CPFENTRA
 23980        ELSE
 23981           MOVE WS-CURRENT-DT          TO DDATEO
 23982           MOVE TIME-OUT               TO DTIMEO
 23983           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23984
 23985
 23986* EXEC CICS SEND
 23987*        MAP      (PI-MAP-NAME)
 23988*        MAPSET   (MAPSET-VP6311S)
 23989*        FROM     (VP631BI)
 23990*        DATAONLY
 23991*        CURSOR
 23992*    END-EXEC.
 23993     MOVE LENGTH OF
 23994      VP631BI
 23995       TO DFHEIV12
 23996     MOVE -1
 23997       TO DFHEIV11
 23998*    MOVE '8$D    CT       H L F ,   #00020100' TO DFHEIV0
 23999     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24000     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24001     MOVE X'2020233030303230313030' TO DFHEIV0(25:11)
 24002     CALL 'kxdfhei1' USING DFHEIV0,
 24003           PI-MAP-NAME,
 24004           VP631BI,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 442
* VP6311.cbl
 24005           DFHEIV12,
 24006           MAPSET-VP6311S,
 24007           DFHEIV99,
 24008           DFHEIV99,
 24009           DFHEIV99,
 24010           DFHEIV11,
 24011           DFHEIV99,
 24012           DFHEIV99,
 24013           DFHEIV99
 24014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24015
 24016
 24017     GO TO 9100-RETURN-TRAN.
 24018
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 443
* VP6311.cbl
 24020
 24021******************************************************************
 24022*                                                                *
 24023*           U T I L I T Y   R O U T I N E S                      *
 24024*                                                                *
 24025******************************************************************
 24026
 24027 8300-SEND-TEXT.
 24028
 24029* EXEC CICS SEND TEXT
 24030*        FROM     (LOGOFF-TEXT)
 24031*        LENGTH   (LOGOFF-LENGTH)
 24032*        ERASE
 24033*        FREEKB
 24034*    END-EXEC.
 24035*    MOVE '8&      T  E F  H   F -   #00020119' TO DFHEIV0
 24036     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24037     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24038     MOVE X'2020233030303230313139' TO DFHEIV0(25:11)
 24039     CALL 'kxdfhei1' USING DFHEIV0,
 24040           LOGOFF-TEXT,
 24041           LOGOFF-LENGTH,
 24042           DFHEIV99,
 24043           DFHEIV99,
 24044           DFHEIV99,
 24045           DFHEIV99,
 24046           DFHEIV99,
 24047           DFHEIV99,
 24048           DFHEIV99,
 24049           DFHEIV99,
 24050           DFHEIV99,
 24051           DFHEIV99
 24052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24053
 24054
 24055
 24056* EXEC CICS RETURN
 24057*    END-EXEC.
 24058*    MOVE '.(                    ''   #00020126' TO DFHEIV0
 24059     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24060     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24061     MOVE X'2020233030303230313236' TO DFHEIV0(25:11)
 24062     CALL 'kxdfhei1' USING DFHEIV0,
 24063           DFHEIV99,
 24064           DFHEIV99,
 24065           DFHEIV99,
 24066           DFHEIV99,
 24067           DFHEIV99,
 24068           DFHEIV99
 24069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24070
 24071
 24072 8400-LOG-JOURNAL-RECORD.
 24073     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24074     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24075
 24076*    EXEC CICS JOURNAL
 24077*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 444
* VP6311.cbl
 24078*        JTYPEID     ('EL')
 24079*        FROM        (JOURNAL-RECORD)
 24080*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24081*    END-EXEC.
 24082
 24083 8600-DEEDIT.
 24084
 24085* EXEC CICS BIF DEEDIT
 24086*         FIELD   (DEEDIT-FIELD)
 24087*         LENGTH  (15)
 24088*    END-EXEC.
 24089     MOVE 15
 24090       TO DFHEIV11
 24091*    MOVE '@"L                   #   #00020141' TO DFHEIV0
 24092     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24093     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24094     MOVE X'2020233030303230313431' TO DFHEIV0(25:11)
 24095     CALL 'kxdfhei1' USING DFHEIV0,
 24096           DEEDIT-FIELD,
 24097           DFHEIV11
 24098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24099
 24100
 24101 8800-UNAUTHORIZED-ACCESS.
 24102     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24103     GO TO 8300-SEND-TEXT.
 24104
 24105 8810-PF23.
 24106     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24107     MOVE XCTL-EL005             TO PGM-NAME.
 24108     GO TO 9300-XCTL.
 24109
 24110 9100-RETURN-TRAN.
 24111     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24112
 24113     IF  PI-MAP-NAME =  VP631B
 24114         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24115
 24116     IF  PI-MAP-NAME =  VP631C
 24117         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24118
 24119     IF  PI-MAP-NAME =  VP631D
 24120         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24121
 24122
 24123* EXEC CICS RETURN
 24124*        TRANSID    (TRANS-EXB1)
 24125*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24126*        LENGTH     (1300)
 24127*    END-EXEC.
 24128     MOVE 1300
 24129       TO DFHEIV11
 24130*    MOVE '.(CT                  ''   #00020167' TO DFHEIV0
 24131     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24132     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24133     MOVE X'2020233030303230313637' TO DFHEIV0(25:11)
 24134     CALL 'kxdfhei1' USING DFHEIV0,
 24135           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 445
* VP6311.cbl
 24136           PROGRAM-INTERFACE-BLOCK,
 24137           DFHEIV11,
 24138           DFHEIV99,
 24139           DFHEIV99,
 24140           DFHEIV99
 24141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24142
 24143
 24144 9200-RETURN-MAIN-MENU.
 24145     MOVE XCTL-EL626             TO PGM-NAME.
 24146     GO TO 9300-XCTL.
 24147
 24148 9300-XCTL.
 24149
 24150* EXEC CICS XCTL
 24151*        PROGRAM    (PGM-NAME)
 24152*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24153*        LENGTH     (PI-COMM-LENGTH)
 24154*    END-EXEC.
 24155*    MOVE '.$C                   %   #00020178' TO DFHEIV0
 24156     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24157     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24158     MOVE X'2020233030303230313738' TO DFHEIV0(25:11)
 24159     CALL 'kxdfhei1' USING DFHEIV0,
 24160           PGM-NAME,
 24161           PROGRAM-INTERFACE-BLOCK,
 24162           PI-COMM-LENGTH,
 24163           DFHEIV99
 24164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24165
 24166
 24167 9400-CLEAR.
 24168     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24169     GO TO 9300-XCTL.
 24170
 24171 9500-PF12.
 24172     MOVE XCTL-EL010             TO PGM-NAME.
 24173     GO TO 9300-XCTL.
 24174
 24175 9600-PGMID-ERROR.
 24176
 24177* EXEC CICS HANDLE CONDITION
 24178*        PGMIDERR    (8300-SEND-TEXT)
 24179*    END-EXEC.
 24180*    MOVE '"$L                   ! \ #00020193' TO DFHEIV0
 24181     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24183     MOVE X'5C20233030303230313933' TO DFHEIV0(25:11)
 24184     CALL 'kxdfhei1' USING DFHEIV0
 24185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24186
 24187
 24188     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24189     MOVE ' '                    TO PI-ENTRY-CD-1.
 24190     MOVE XCTL-EL005             TO PGM-NAME.
 24191     MOVE PGM-NAME               TO LOGOFF-PGM.
 24192     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24193     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 446
* VP6311.cbl
 24194
 24195 9700-DATE-LINK.
 24196     MOVE LINK-ELDATCV           TO PGM-NAME.
 24197
 24198* EXEC CICS LINK
 24199*        PROGRAM    (PGM-NAME)
 24200*        COMMAREA   (DATE-CONVERSION-DATA)
 24201*        LENGTH     (DC-COMM-LENGTH)
 24202*    END-EXEC.
 24203*    MOVE '."C                   (   #00020206' TO DFHEIV0
 24204     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24206     MOVE X'2020233030303230323036' TO DFHEIV0(25:11)
 24207     CALL 'kxdfhei1' USING DFHEIV0,
 24208           PGM-NAME,
 24209           DATE-CONVERSION-DATA,
 24210           DC-COMM-LENGTH,
 24211           DFHEIV99,
 24212           DFHEIV99,
 24213           DFHEIV99,
 24214           DFHEIV99
 24215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24216
 24217
 24218 9800-LINK-PENDING-EDIT.
 24219     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24220     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24221
 24222     MOVE LINK-EL050             TO PGM-NAME
 24223     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24224     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24225                                    WK-CO-TOL-CLAIM
 24226                                    WK-CO-TOL-PREM
 24227                                    WK-CO-TOL-REFUND
 24228                                    WK-CO-TOL-PREM-PCT
 24229                                    WK-CO-TOL-REFUND-PCT
 24230                                    WK-REFUND-OVS-AMT
 24231                                    WK-REFUND-OVS-PCT
 24232                                    WK-ACCT-ADDR
 24233                                    WK-LIFE-EDIT-ADDR
 24234                                    WK-AH-EDIT-ADDR
 24235                                    WK-LIFE-BEN-ADDR
 24236                                    WK-AH-BEN-ADDR
 24237                                    WK-STATE-ADDR
 24238                                    WK-PLAN-ADDR
 24239                                    WK-FORM-ADDR
 24240     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24241
 24242     MOVE '6'                    TO WK-ENTRY-SW.
 24243
 24244     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24245
 24246     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24247                                    EC-AM-EXPIRATION-DT
 24248                                    EC-AM-EFFECTIVE-DT
 24249                                    EC-CM-LF-CANCEL-DT
 24250                                    EC-CM-AH-CANCEL-DT
 24251                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 447
* VP6311.cbl
 24252
 24253     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24254                                    EC-CO-TOL-REFUND
 24255                                    EC-CO-MIN-AGE
 24256                                    EC-CO-MIN-PREMIUM
 24257                                    EC-CO-MIN-TERM
 24258                                    EC-CO-MAX-TERM
 24259                                    EC-ST-TOL-PREM
 24260                                    EC-ST-TOL-REFUND
 24261                                    EC-AM-LF-TOL-PREM
 24262                                    EC-AM-AH-TOL-PREM
 24263                                    EC-AM-LF-MAX-ATT-AGE
 24264                                    EC-AM-LF-MAX-AGE
 24265                                    EC-AM-LF-MAX-TERM
 24266                                    EC-AM-LF-MAX-TOT-BEN
 24267                                    EC-AM-AH-MAX-ATT-AGE
 24268                                    EC-AM-AH-MAX-AGE
 24269                                    EC-AM-AH-MAX-TERM
 24270                                    EC-AM-AH-MAX-TOT-BEN
 24271                                    EC-AM-AH-MAX-MON-BEN
 24272                                    EC-RT-LF-MAX-ATT-AGE
 24273                                    EC-RT-LF-MAX-AGE
 24274                                    EC-RT-LF-MAX-TERM
 24275                                    EC-RT-LF-MAX-TOT-BEN
 24276                                    EC-RT-AH-MAX-ATT-AGE
 24277                                    EC-RT-AH-MAX-AGE
 24278                                    EC-RT-AH-MAX-TERM
 24279                                    EC-RT-AH-MAX-TOT-BEN
 24280                                    EC-RT-AH-MAX-MON-BEN
 24281                                    EC-RT-AH-RATE
 24282                                    EC-RT-LF-RATE
 24283                                    EC-RT-LF-NSP-RATE
 24284                                    EC-RT-AH-NSP-RATE
 24285                                    EC-CM-LF-PRIOR-REFUND
 24286                                    EC-CM-AH-PRIOR-REFUND.
 24287
 24288     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24289                                    EC-ST-TOL-PREM-PCT
 24290                                    EC-AM-LF-TOL-REFUND
 24291                                    EC-AM-LF-DEV-PERCENT
 24292                                    EC-CO-TOL-REFUND-PCT
 24293                                    EC-ST-TOL-REFUND-PCT
 24294                                    EC-AM-AH-TOL-REFUND
 24295                                    EC-AM-AH-DEV-PERCENT.
 24296
 24297
 24298* EXEC CICS LINK
 24299*         PROGRAM   (PGM-NAME)
 24300*         COMMAREA  (PASSED-RECORD)
 24301*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24302*    END-EXEC.
 24303*    MOVE '."C                   (   #00020291' TO DFHEIV0
 24304     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24306     MOVE X'2020233030303230323931' TO DFHEIV0(25:11)
 24307     CALL 'kxdfhei1' USING DFHEIV0,
 24308           PGM-NAME,
 24309           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 448
* VP6311.cbl
 24310           WS-EDIT-PASS-LENGTH,
 24311           DFHEIV99,
 24312           DFHEIV99,
 24313           DFHEIV99,
 24314           DFHEIV99
 24315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24316
 24317
 24318     MOVE '1'                    TO PI-EDIT-SW.
 24319     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24320
 24321     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24322
 24323     IF PI-COMPANY-ID = 'UCL'
 24324         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24325
 24326     IF VALID-PB-ID
 24327        GO TO 9800-EXIT.
 24328
 24329     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24330
 24331     IF PI-MAP-NAME = VP631B
 24332        MOVE -1                  TO BMAINTL
 24333       ELSE
 24334        MOVE -1                  TO CMAINTL.
 24335
 24336     GO TO 8200-SEND-DATAONLY.
 24337
 24338 9800-EXIT.
 24339      EXIT.
 24340
 24341 9900-ERROR-FORMAT.
 24342
 24343     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24344
 24345     IF NOT EMI-ERRORS-COMPLETE
 24346         MOVE LINK-EL001         TO PGM-NAME
 24347
 24348* EXEC CICS LINK
 24349*            PROGRAM    (PGM-NAME)
 24350*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24351*            LENGTH     (EMI-COMM-LENGTH)
 24352*        END-EXEC.
 24353*    MOVE '."C                   (   #00020326' TO DFHEIV0
 24354     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24355     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24356     MOVE X'2020233030303230333236' TO DFHEIV0(25:11)
 24357     CALL 'kxdfhei1' USING DFHEIV0,
 24358           PGM-NAME,
 24359           ERROR-MESSAGE-INTERFACE-BLOCK,
 24360           EMI-COMM-LENGTH,
 24361           DFHEIV99,
 24362           DFHEIV99,
 24363           DFHEIV99,
 24364           DFHEIV99
 24365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24366
 24367
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 449
* VP6311.cbl
 24368 9900-EXIT.
 24369     EXIT.
 24370
 24371 9990-ABEND.
 24372     MOVE LINK-EL004             TO PGM-NAME.
 24373     MOVE DFHEIBLK               TO EMI-LINE1.
 24374
 24375* EXEC CICS LINK
 24376*        PROGRAM   (PGM-NAME)
 24377*        COMMAREA  (EMI-LINE1)
 24378*        LENGTH    (72)
 24379*    END-EXEC.
 24380     MOVE 72
 24381       TO DFHEIV11
 24382*    MOVE '."C                   (   #00020338' TO DFHEIV0
 24383     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24384     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24385     MOVE X'2020233030303230333338' TO DFHEIV0(25:11)
 24386     CALL 'kxdfhei1' USING DFHEIV0,
 24387           PGM-NAME,
 24388           EMI-LINE1,
 24389           DFHEIV11,
 24390           DFHEIV99,
 24391           DFHEIV99,
 24392           DFHEIV99,
 24393           DFHEIV99
 24394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24395
 24396
 24397     IF PI-MAP-NAME = VP631B
 24398        MOVE -1                  TO BMAINTL
 24399       ELSE
 24400        MOVE -1                  TO CMAINTL.
 24401
 24402     IF EIBTRNID NOT = TRANS-EXB1
 24403        GO TO 8100-SEND-INITIAL-MAP
 24404       ELSE
 24405        GO TO 8200-SEND-DATAONLY.
 24406
 24407 9995-SECURITY-VIOLATION.
 24408*                            COPY ELCSCTP.
 24409******************************************************************
 24410*                                                                *
 24411*                            ELCSCTP                             *
 24412*                            VMOD=2.001                          *
 24413*                                                                *
 24414*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24415******************************************************************
 24416
 24417
 24418     MOVE EIBDATE          TO SM-JUL-DATE.
 24419     MOVE EIBTRMID         TO SM-TERMID.
 24420     MOVE THIS-PGM         TO SM-PGM.
 24421     MOVE EIBTIME          TO TIME-IN.
 24422     MOVE TIME-OUT         TO SM-TIME.
 24423     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24424
 24425
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 450
* VP6311.cbl
 24426* EXEC CICS LINK
 24427*         PROGRAM  ('EL003')
 24428*         COMMAREA (SECURITY-MESSAGE)
 24429*         LENGTH   (80)
 24430*    END-EXEC.
 24431     MOVE 'EL003' TO DFHEIV1
 24432     MOVE 80
 24433       TO DFHEIV11
 24434*    MOVE '."C                   (   #00020372' TO DFHEIV0
 24435     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24437     MOVE X'2020233030303230333732' TO DFHEIV0(25:11)
 24438     CALL 'kxdfhei1' USING DFHEIV0,
 24439           DFHEIV1,
 24440           SECURITY-MESSAGE,
 24441           DFHEIV11,
 24442           DFHEIV99,
 24443           DFHEIV99,
 24444           DFHEIV99,
 24445           DFHEIV99
 24446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24447
 24448
 24449******************************************************************
 24450
 24451
 24452 9999-DFHBACK SECTION.
 24453     MOVE '9%                    "   ' TO DFHEIV0
 24454     MOVE 'VP6311' TO DFHEIV1
 24455     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24456     GOBACK.
 24457 9999-DFHEXIT.
 24458     IF DFHEIGDJ EQUAL 0001
 24459         NEXT SENTENCE
 24460     ELSE IF DFHEIGDJ EQUAL 2
 24461         GO TO 9600-PGMID-ERROR,
 24462               9990-ABEND,
 24463               9990-ABEND,
 24464               0010-MAIN-LOGIC
 24465         DEPENDING ON DFHEIGDI
 24466     ELSE IF DFHEIGDJ EQUAL 3
 24467         GO TO 1280-BATCH-HDR-NOT-FOUND
 24468         DEPENDING ON DFHEIGDI
 24469     ELSE IF DFHEIGDJ EQUAL 4
 24470         GO TO 1290-DUPLICATE-ALT-INDEX
 24471         DEPENDING ON DFHEIGDI
 24472     ELSE IF DFHEIGDJ EQUAL 5
 24473         GO TO 1295-CERT-TRL-REC-NOTFND
 24474         DEPENDING ON DFHEIGDI
 24475     ELSE IF DFHEIGDJ EQUAL 6
 24476         GO TO 1380-BATCH-HDR-NOT-FOUND
 24477         DEPENDING ON DFHEIGDI
 24478     ELSE IF DFHEIGDJ EQUAL 7
 24479         GO TO 1385-REC-NOT-FOUND
 24480         DEPENDING ON DFHEIGDI
 24481     ELSE IF DFHEIGDJ EQUAL 8
 24482         GO TO 1386-NOTFND
 24483         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 451
* VP6311.cbl
 24484     ELSE IF DFHEIGDJ EQUAL 9
 24485         GO TO 1398-EXIT
 24486         DEPENDING ON DFHEIGDI
 24487     ELSE IF DFHEIGDJ EQUAL 10
 24488         GO TO 1480-BATCH-HDR-NOT-FOUND
 24489         DEPENDING ON DFHEIGDI
 24490     ELSE IF DFHEIGDJ EQUAL 11
 24491         GO TO 1490-RECORD-NOT-FOUND
 24492         DEPENDING ON DFHEIGDI
 24493     ELSE IF DFHEIGDJ EQUAL 12
 24494         GO TO 1405-DELETE-CERTIFICATE
 24495         DEPENDING ON DFHEIGDI
 24496     ELSE IF DFHEIGDJ EQUAL 13
 24497         GO TO 1420-CONTINUE-DELETE
 24498         DEPENDING ON DFHEIGDI
 24499     ELSE IF DFHEIGDJ EQUAL 14
 24500         GO TO 1406-DELETE-ERNOTE
 24501         DEPENDING ON DFHEIGDI
 24502     ELSE IF DFHEIGDJ EQUAL 15
 24503         GO TO 1407-DELETE-MAILING
 24504         DEPENDING ON DFHEIGDI
 24505     ELSE IF DFHEIGDJ EQUAL 16
 24506         GO TO 1420-CONTINUE-DELETE
 24507         DEPENDING ON DFHEIGDI
 24508     ELSE IF DFHEIGDJ EQUAL 17
 24509         GO TO 1480-BATCH-HDR-NOT-FOUND
 24510         DEPENDING ON DFHEIGDI
 24511     ELSE IF DFHEIGDJ EQUAL 18
 24512         GO TO 1475-DELETE-FINISHED
 24513         DEPENDING ON DFHEIGDI
 24514     ELSE IF DFHEIGDJ EQUAL 19
 24515         GO TO 2280-BATCH-HDR-NOT-FOUND
 24516         DEPENDING ON DFHEIGDI
 24517     ELSE IF DFHEIGDJ EQUAL 20
 24518         GO TO 2290-DUPLICATE-ALT-INDEX
 24519         DEPENDING ON DFHEIGDI
 24520     ELSE IF DFHEIGDJ EQUAL 21
 24521         GO TO 2380-BATCH-HDR-NOT-FOUND
 24522         DEPENDING ON DFHEIGDI
 24523     ELSE IF DFHEIGDJ EQUAL 22
 24524         GO TO 2385-REC-NOT-FOUND
 24525         DEPENDING ON DFHEIGDI
 24526     ELSE IF DFHEIGDJ EQUAL 23
 24527         GO TO 2380-BATCH-HDR-NOT-FOUND
 24528         DEPENDING ON DFHEIGDI
 24529     ELSE IF DFHEIGDJ EQUAL 24
 24530         GO TO 2485-BATCH-HDR-NOT-FOUND
 24531         DEPENDING ON DFHEIGDI
 24532     ELSE IF DFHEIGDJ EQUAL 25
 24533         GO TO 2490-RECORD-NOT-FOUND
 24534         DEPENDING ON DFHEIGDI
 24535     ELSE IF DFHEIGDJ EQUAL 26
 24536         GO TO 2475-CONTINUE-DELETE
 24537         DEPENDING ON DFHEIGDI
 24538     ELSE IF DFHEIGDJ EQUAL 27
 24539         GO TO 2485-BATCH-HDR-NOT-FOUND
 24540         DEPENDING ON DFHEIGDI
 24541     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 452
* VP6311.cbl
 24542         GO TO 2480-DELETE-FINISHED
 24543         DEPENDING ON DFHEIGDI
 24544     ELSE IF DFHEIGDJ EQUAL 29
 24545         GO TO 2820-PROCESS-REWRITE
 24546         DEPENDING ON DFHEIGDI
 24547     ELSE IF DFHEIGDJ EQUAL 30
 24548         GO TO 2885-RECORD-MISSING
 24549         DEPENDING ON DFHEIGDI
 24550     ELSE IF DFHEIGDJ EQUAL 31
 24551         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24552         DEPENDING ON DFHEIGDI
 24553     ELSE IF DFHEIGDJ EQUAL 32
 24554         GO TO 2827-DELETE-MAILING
 24555         DEPENDING ON DFHEIGDI
 24556     ELSE IF DFHEIGDJ EQUAL 33
 24557         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24558         DEPENDING ON DFHEIGDI
 24559     ELSE IF DFHEIGDJ EQUAL 34
 24560         GO TO 2920-PROCESS-REWRITE
 24561         DEPENDING ON DFHEIGDI
 24562     ELSE IF DFHEIGDJ EQUAL 35
 24563         GO TO 2985-RECORD-MISSING
 24564         DEPENDING ON DFHEIGDI
 24565     ELSE IF DFHEIGDJ EQUAL 36
 24566         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24567         DEPENDING ON DFHEIGDI
 24568     ELSE IF DFHEIGDJ EQUAL 37
 24569         GO TO 2990-DUPLICATE-RECORD
 24570         DEPENDING ON DFHEIGDI
 24571     ELSE IF DFHEIGDJ EQUAL 38
 24572         GO TO 3590-NOT-FOUND
 24573         DEPENDING ON DFHEIGDI
 24574     ELSE IF DFHEIGDJ EQUAL 39
 24575         GO TO 3690-NOT-FOUND
 24576         DEPENDING ON DFHEIGDI
 24577     ELSE IF DFHEIGDJ EQUAL 40
 24578         GO TO 3990-NOT-FOUND
 24579         DEPENDING ON DFHEIGDI
 24580     ELSE IF DFHEIGDJ EQUAL 41
 24581         GO TO 4050-END-RECORDS,
 24582               4050-END-RECORDS
 24583         DEPENDING ON DFHEIGDI
 24584     ELSE IF DFHEIGDJ EQUAL 42
 24585         GO TO 4150-END-BATCH
 24586         DEPENDING ON DFHEIGDI
 24587     ELSE IF DFHEIGDJ EQUAL 43
 24588         GO TO 4150-END-BATCH
 24589         DEPENDING ON DFHEIGDI
 24590     ELSE IF DFHEIGDJ EQUAL 44
 24591         GO TO 4250-END-RECORDS,
 24592               4250-END-RECORDS
 24593         DEPENDING ON DFHEIGDI
 24594     ELSE IF DFHEIGDJ EQUAL 45
 24595         GO TO 4350-END-BATCH,
 24596               4350-END-BATCH
 24597         DEPENDING ON DFHEIGDI
 24598     ELSE IF DFHEIGDJ EQUAL 46
 24599         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 453
* VP6311.cbl
 24600               4550-END-RECORDS
 24601         DEPENDING ON DFHEIGDI
 24602     ELSE IF DFHEIGDJ EQUAL 47
 24603         GO TO 4680-NOT-FOUND,
 24604               4680-NOT-FOUND
 24605         DEPENDING ON DFHEIGDI
 24606     ELSE IF DFHEIGDJ EQUAL 48
 24607         GO TO 4860-NOT-FOUND,
 24608               4850-END-RECORDS
 24609         DEPENDING ON DFHEIGDI
 24610     ELSE IF DFHEIGDJ EQUAL 49
 24611         GO TO 4970-NOT-FOUND,
 24612               4950-END-RECORDS
 24613         DEPENDING ON DFHEIGDI
 24614     ELSE IF DFHEIGDJ EQUAL 50
 24615         GO TO 5050-NOT-FOUND
 24616         DEPENDING ON DFHEIGDI
 24617     ELSE IF DFHEIGDJ EQUAL 51
 24618         GO TO 5050-NOT-FOUND
 24619         DEPENDING ON DFHEIGDI
 24620     ELSE IF DFHEIGDJ EQUAL 52
 24621         GO TO 5050-NOT-FOUND
 24622         DEPENDING ON DFHEIGDI
 24623     ELSE IF DFHEIGDJ EQUAL 53
 24624         GO TO 5550-END-RECORDS,
 24625               5550-END-RECORDS
 24626         DEPENDING ON DFHEIGDI
 24627     ELSE IF DFHEIGDJ EQUAL 54
 24628         GO TO 6050-QID-ERROR
 24629         DEPENDING ON DFHEIGDI
 24630     ELSE IF DFHEIGDJ EQUAL 55
 24631         GO TO 6050-QID-ERROR
 24632         DEPENDING ON DFHEIGDI
 24633     ELSE IF DFHEIGDJ EQUAL 56
 24634         GO TO 6400-CONTINUE,
 24635               6400-CONTINUE
 24636         DEPENDING ON DFHEIGDI
 24637     ELSE IF DFHEIGDJ EQUAL 57
 24638         GO TO 3690-NOT-FOUND
 24639         DEPENDING ON DFHEIGDI
 24640     ELSE IF DFHEIGDJ EQUAL 58
 24641         GO TO 7399-EXIT
 24642         DEPENDING ON DFHEIGDI
 24643     ELSE IF DFHEIGDJ EQUAL 59
 24644         GO TO 7550-OFFICER-NOTFND
 24645         DEPENDING ON DFHEIGDI
 24646     ELSE IF DFHEIGDJ EQUAL 60
 24647         GO TO 8300-SEND-TEXT
 24648         DEPENDING ON DFHEIGDI.
 24649     MOVE '9%                    "   ' TO DFHEIV0
 24650     MOVE 'VP6311' TO DFHEIV1
 24651     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24652     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15252     Code:       96350
