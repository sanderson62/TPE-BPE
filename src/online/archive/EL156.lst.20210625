* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66* 022718    2017100200004  TANA  Set hold & pays > than 30 days
    67* 031218    2018030800002  TANA  Handle offline pmts w/ hold & pay
    68* 082218  CR2018051400001  TANA  Hold and Pay
    69* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    70* 112018  CR2018102900001  TANA  REQUIRE EOB NOTE STARTING WITH F
    71* 040819  IR2019030400004  TANA  ADD EDITS FOR HOLD AND PAY
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   3
* EL156.cbl
    72* 043019  IR2019041900001  TANA  Correct total claim pymts msg
    73******************************************************************
    74
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   4
* EL156.cbl
    76 ENVIRONMENT DIVISION.
    77
    78 DATA DIVISION.
    79
    80 WORKING-STORAGE SECTION.
    81 01  DFH-START PIC X(04).
    82
    83 77  FILLER  PIC X(32)  VALUE '********************************'.
    84 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    85 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    86 77  WS-SSN  PIC X(9) VALUE ZEROS.
    87 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    88 77  C0                          PIC S999 COMP-3 VALUE +0.
    89 77  C1                          PIC S999 COMP-3 VALUE +0.
    90 77  C2                          PIC S999 COMP-3 VALUE +0.
    91 77  C3                          PIC S999 COMP-3 VALUE +0.
    92 77  s1                          PIC S999 COMP-3 VALUE +0.
    93 77  s2                          pic s999 comp-3 value +0.
    94 77  P1                          PIC S999 COMP-3 VALUE +0.
    95 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    96 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    97 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    98 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    99 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   100 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   101 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   102 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   103 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
   104 77  ws-max-bens                 pic s999 comp-3 value +0.
   105 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
   106 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   107 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   108 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   109 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   110 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   111
   112*    COPY ELCSCTM.
   113******************************************************************
   114*                                                                *
   115*                                                                *
   116*                            ELCSCTM                             *
   117*                            VMOD=2.001                          *
   118*                                                                *
   119*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   120*                                                                *
   121******************************************************************
   122 01  SECURITY-MESSAGE.
   123     12  FILLER                          PIC X(30)
   124            VALUE '** LOGIC SECURITY VIOLATION -'.
   125     12  SM-READ                         PIC X(6).
   126     12  FILLER                          PIC X(5)
   127            VALUE ' PGM='.
   128     12  SM-PGM                          PIC X(6).
   129     12  FILLER                          PIC X(5)
   130            VALUE ' OPR='.
   131     12  SM-PROCESSOR-ID                 PIC X(4).
   132     12  FILLER                          PIC X(6)
   133            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   5
* EL156.cbl
   134     12  SM-TERMID                       PIC X(4).
   135     12  FILLER                          PIC XX   VALUE SPACE.
   136     12  SM-JUL-DATE                     PIC 9(5).
   137     12  FILLER                          PIC X    VALUE SPACE.
   138     12  SM-TIME                         PIC 99.99.
   139
   140
   141*    COPY ELCSCRTY.
   142******************************************************************
   143*                                                                *
   144*                                                                *
   145*                            ELCSCRTY                            *
   146*                            VMOD=2.001                          *
   147*                                                                *
   148*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   149*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   150*        SAVED IN PI-SECURITY-ADDRESS.                           *
   151*                                                                *
   152******************************************************************
   153 01  SECURITY-CONTROL.
   154     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   155     12  FILLER                       PIC XX    VALUE 'SC'.
   156     12  SC-CREDIT-CODES.
   157         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   158             20  SC-CREDIT-DISPLAY    PIC X.
   159             20  SC-CREDIT-UPDATE     PIC X.
   160     12  SC-CLAIMS-CODES.
   161         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   162             20  SC-CLAIMS-DISPLAY    PIC X.
   163             20  SC-CLAIMS-UPDATE     PIC X.
   164
   165 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   166 01  WS-DATE-AREA.
   167     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   168     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   169     12  SAVE-DATE-CCYYMMDD.
   170         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   171         16  SAVE-DATE-YMD.
   172             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   173             20  FILLER              PIC X(04)   VALUE SPACES.
   174
   175 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   176 01  STANDARD-AREAS.
   177     12  WS-RESPONSE         PIC S9(8)   COMP.
   178         88  WS-RESP-NORMAL              VALUE +00.
   179         88  WS-RESP-ERROR               VALUE +01.
   180         88  WS-RESP-NOTFND              VALUE +13.
   181         88  WS-RESP-DUPREC              VALUE +14.
   182         88  WS-RESP-ENDFILE             VALUE +20.
   183     12  PMT-HEAD-A.
   184         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   185         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   186         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   187-        '     RESERVES  TYPE    AMOUNT'.
   188     12  PMT-HEAD-B.
   189         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   190         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   191         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   6
* EL156.cbl
   192     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   193     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   194     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   195     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   196     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   197     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   198     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   199     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   200     12  PGM-NAME            PIC X(8).
   201     12  TIME-IN             PIC S9(7).
   202     12  TIME-OUT-R  REDEFINES TIME-IN.
   203         16  FILLER          PIC X.
   204         16  TIME-OUT        PIC 99V99.
   205         16  FILLER          PIC XX.
   206     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   207     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   208     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   209     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   210     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   211     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   212     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   213     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   214     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   215     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   216     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   217     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   218     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   219     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   220     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   221     12  WS-BLANK            PIC X       VALUE ' '.
   222
   223 01  MISC-WORK-AREAS.
   224     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   225     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   226     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   227     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   228     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   229     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   230     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   231     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   232     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   233     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   234     12  W-CALLED-NAME           PIC X(08).
   235     12  W-EOB-CODES.
   236         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   237             20  W-EOB-CODE      PIC XXX.
   238             20  W-EOB-FILLER    PIC X.
   239     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   240     12  W-NAME-LAST             PIC X(15).
   241     12  W-NAME-FIRST            PIC X(15).
   242     12  W-NAME-MIDDLE.
   243         16  FILLER              PIC X.
   244         16  W-NAME-MIDDLE-2     PIC X.
   245         16  FILLER              PIC X(13).
   246     12  W-DMD-CHECK-NO.
   247         16  W-DMD-CHECK-NO-1    PIC X(4).
   248         16  W-DMD-CHECK-NO-2    PIC X.
   249         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   7
* EL156.cbl
   250
   251     12  WS-COMPUTE-FROM-DT  PIC XX.
   252     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   253     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   254     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   255     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   256     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   257     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   258         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   259         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   260     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   261         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   262     12  WS-UPDATE-SW        PIC X VALUE ' '.
   263     12  WS-GROUPING.
   264         16  WS-GROUP-1      PIC X VALUE SPACES.
   265         16  FILLER          PIC X(05) VALUE SPACES.
   266     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   267     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   268     12  WS-WORK-STATE-ACCT.
   269         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   270         16  FILLER          PIC X       VALUE '/'.
   271         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   272     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   273     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   274     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   275     12  QID.
   276         16  QID-TERM        PIC X(4)    VALUE SPACES.
   277         16  FILLER          PIC X(4)    VALUE '156A'.
   278     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   279     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   280     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   281     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   282     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   283     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   284     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   285     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   286     12  WS-STATUS           PIC X       VALUE SPACES.
   287     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   288     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   289     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   290     12  ws-extended-exp-dt  pic xx      value low-values.
   291     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   292     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   293     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   294     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   295     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   296     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   297     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   298     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   299     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   300     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   301     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   302     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   303     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   304     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   305     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   306     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   307     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   8
* EL156.cbl
   308     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   309     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   310     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   311     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   312     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   313     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   314     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   315     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   316     12  WORK-DATE-FROM.
   317         16  WDF-MONTH       PIC 99        VALUE ZERO.
   318         16  WDF-DAY         PIC 99        VALUE ZERO.
   319         16  WDF-YEAR        PIC 99        VALUE ZERO.
   320     12  WORK-DATE-THRU.
   321         16  WDT-MONTH       PIC 99        VALUE ZERO.
   322         16  WDT-DAY         PIC 99        VALUE ZERO.
   323         16  WDT-YEAR        PIC 99        VALUE ZERO.
   324     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   325     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   326     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   327     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   328     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   329     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   330     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   331     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   332     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   333     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   334     12  WS-PY-WK REDEFINES WS-PY-WORK.
   335         16  WS-PY-NUM       PIC S9(7)V99.
   336         16  WS-PY-SIGN      PIC X.
   337     12  WS-DY-WORK          PIC S9(5).
   338     12  WS-DY-WK REDEFINES WS-DY-WORK.
   339         16  WS-DY-NUM       PIC S9(4).
   340         16  WS-DY-SIGN      PIC X.
   341     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   342         88  COMP-REC-FOUND              VALUE 'Y'.
   343     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   344         88  BENEFIT-FOUND       VALUE 'Y'.
   345         88  NO-BENEFIT-FOUND    VALUE 'N'.
   346     12  WS-TERMS.
   347         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   348         16  FILLER          PIC X       VALUE '/'.
   349         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   350         16  WST-REM-DAYS-GRP.
   351             20  WST-SLASH   PIC X       VALUE '/'.
   352             20  WST-REM-DAYS
   353                             PIC --9.
   354     12  WS-ACCESS.
   355         16  FILLER          PIC XX      VALUE SPACES.
   356         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   357     12  WS-STATE-ACCESS.
   358         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   359         16  FILLER          PIC XX      VALUE SPACES.
   360     12  WS-CARR-ACCESS.
   361         16  FILLER          PIC X(3)    VALUE SPACES.
   362         16  WS-CARR         PIC X       VALUE SPACES.
   363     12  DATE-WORK.
   364         16  FILLER          PIC XX      VALUE SPACES.
   365         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page   9
* EL156.cbl
   366     12  WS-SAVE-INPUT.
   367         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   368         16  WS-PAYEE        PIC XX      VALUE SPACE.
   369         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   370         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   371         16  WS-OFFLINE      PIC X       VALUE SPACE.
   372         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   373         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   374         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   375         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   376         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   377         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   378         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   379         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   380         16  WS-ETYPE        PIC X       VALUE SPACE.
   381         16  WS-CASH         PIC X       VALUE SPACE.
   382         16  WS-GROUPED      PIC X       VALUE SPACE.
   383         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   384         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   385         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   386         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   387         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   388         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   389         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   390         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   391         16  ws-int-to-rem-borr pic x value spaces.
   392     12  LAST-ERROR-LINE.
   393         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   394         16  FILLER              PIC X(30)
   395             VALUE ' FATAL ERRORS ENCOUNTERED'.
   396         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   397         16  FILLER              PIC X(28)
   398             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   399     12  WS-CHECK-AREA.
   400         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   401         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   402     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   403     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   404         16  FILLER              PIC XX.
   405         16  WS-A-CHECK-NUM-5    PIC 9(5).
   406     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   407         16  FILLER              PIC X.
   408         16  WS-A-CHECK-NUM-6    PIC 9(6).
   409     12  OPTION-1-SAVE-AREA.
   410         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   411         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   412     12  WS-WORK-ZIP.
   413         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   414         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   415     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   416                                 PIC 9(9).
   417     12  WS-FLI-PMTNOTE.
   418         16  WS-PMTOPTION        PIC XX.
   419         16  WS-DOCNAME          PIC X(28).
   420         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   421             20  WS-AMOUNT       PIC X(8).
   422             20  FILLER          PIC X(20).
   423         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  10
* EL156.cbl
   424             20  WS-NUM-AMT      PIC 9(6)V99.
   425             20  FILLER          PIC X(20).
   426
   427     12  WS-HAN-PMTNOTE.
   428         16  WS-HAN-PMT-CODE     PIC X.
   429         16  WS-HAN-PMT-NOTE     PIC X(39).
   430
   431     12  WS-NCL-PMT-OPTION       PIC XX.
   432         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   433
   434     12  WS-CLAIM-SEQUENCE.
   435         16  FILLER              PIC X VALUE '('.
   436         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   437         16  FILLER              PIC X(04) VALUE ' OF '.
   438         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   439         16  FILLER              PIC X VALUE ')'.
   440
   441     12  WS-REFUND-AMT           PIC Z(7).99.
   442     12  WS-CALC-INT             PIC S9(7)V99.
   443     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   444
   445     12  SUB                     PIC 99 VALUE ZEROS.
   446
   447     12  WS-BOANOTE1.
   448         16  WS-BOANOTE1-DESC    PIC X(11).
   449         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   450         16  FILLER              PIC X(17).
   451     12  WS-BOANOTE2.
   452         16  WS-BOANOTE2-DESC    PIC X(11).
   453         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   454         16  FILLER              PIC X(17).
   455
   456     12  WS-NCLNOTE1.
   457         16  WS-NCLNOTE1-DESC    PIC X(11).
   458         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   459         16  FILLER              PIC X(17).
   460     12  WS-NCLNOTE2.
   461         16  WS-NCLNOTE2-DESC    PIC X(11).
   462         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   463         16  FILLER              PIC X(17).
   464
   465     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   466     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   467     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   468     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   469     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   470     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   471     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   472     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   473     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   474     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   475
   476     12  WS-AIG-WORK-AREAS.
   477         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   478             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   479         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   480             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   481         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  11
* EL156.cbl
   482             20  WS-FROM-MO      PIC 99.
   483             20  WS-FROM-DA      PIC 99.
   484             20  WS-FROM-YR      PIC 99.
   485         16  WS-TEMP-DATE-MDY.
   486             20  WS-TEMP-MO      PIC 99.
   487             20  WS-TEMP-DA      PIC 99.
   488             20  WS-TEMP-YR      PIC 99.
   489         16  WS-BIN-FROM-DT      PIC XX.
   490         16  WS-TEMP-INC-MDY.
   491             20  WS-TEMP-INC-MO  PIC 99.
   492             20  WS-TEMP-INC-DA  PIC 99.
   493             20  WS-TEMP-INC-YR  PIC 99.
   494         16  WS-PMT-DUE-MDY.
   495             20  WS-PMT-DUE-MO   PIC 99.
   496             20  WS-PMT-DUE-DA   PIC 99.
   497             20  WS-PMT-DUE-YR   PIC 99.
   498         16  WS-PMT-DUE-DT       PIC XX.
   499         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   500         16  WS-RETRO-ELIM-DT    PIC XX.
   501         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   502             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   503         16  WS-SAVE-DUE-DA      PIC 99.
   504         16  WS-CDAYS            PIC S9(05).
   505         16  WS-DAYS-OFF         PIC S9(05).
   506         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   507             88  ELIM-SATISFIED            VALUE 'Y'.
   508         16  WS-AIG-CHECKNO.
   509             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   510             20  WS-A-CHECKNO-3-7.
   511                 24  FILLER              PIC X(3)    VALUE SPACES.
   512                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   513                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   514         16  WS-AIG-GROUPING.
   515             20  WS-A-BENE               PIC XXX.
   516             20  FILLER                  PIC XXX.
   517         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   518             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   519             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   520         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   521                 VALUE 'UNEMPLOYMENT PAYMENT'.
   522         16  WS-CHK-THRU-DT              PIC XX.
   523         16  WS-HOLD-BIN-DATE-1          PIC XX.
   524
   525 01  MISC-CSO-AREA.
   526     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   527     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   528     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   529         88  APPROVAL-NEEDED                        VALUE 'Y'.
   530     12  WS-APPROV-NOTE                  PIC X(43)
   531         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   532     12  WS-3550-APPROV-NOTE             PIC X(43)
   533         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   534     12  WS-DUPE-APPROV-NOTE             PIC X(43)
   535         VALUE 'APPROVAL NEEDED - DUPLICATE PAYMENT EXISTS '.
   536     12  WS-REAUDIT-NOTE                 PIC X(43)
   537         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   538     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   539     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  12
* EL156.cbl
   540     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   541     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   542     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   543     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   544     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   545         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   546     12  WS-PAYEE-CITY-STATE     PIC X(30).
   547     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   548         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   549     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   550     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   551     12  WS-WORK-NAME            PIC X(30).
   552     12  FILLER  REDEFINES WS-WORK-NAME.
   553         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   554     12  WS-INSURED-NAME         PIC X(30).
   555     12  FILLER  REDEFINES WS-INSURED-NAME.
   556         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   557     12  WS-PAYEE-NAME           PIC X(30).
   558     12  FILLER  REDEFINES WS-PAYEE-NAME.
   559         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   560     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.
   561         88  HOLD-UNTIL-CHK            VALUE 'Y'.
   562         88  HOLD-UNTIL-PMT            VALUE 'P'.
   563     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.
   564     12  WS-UNPAID-HOLD-UNTIL-SW PIC X VALUE SPACES.
   565         88  UNPAID-HOLD-UNTIL-EXISTS  VALUE 'Y'.
   566     12  WS-DUPE-VOID-PMT-SW     PIC X VALUE SPACES.
   567         88  DUPE-VOID-PMT-EXISTS      VALUE 'Y'.
   568     12  WS-CHECK-ALL-PMTS-SW    PIC X VALUE SPACES.
   569         88  CHECK-ALL-PMTS            VALUE 'Y'.
   570     12  WS-TOT-AMOUNT-PAID      PIC S9(7)V99  COMP-3 VALUE ZERO.
   571     12  WS-UNPD-HOLD-UNTIL-DT   PIC X(02) VALUE ZERO.
   572
   573 01  ERROR-MESSAGES.
   574     12  ER-0000                 PIC X(4)  VALUE '0000'.
   575     12  ER-0004                 PIC X(4)  VALUE '0004'.
   576     12  ER-0008                 PIC X(4)  VALUE '0008'.
   577     12  ER-0019                 PIC X(4)  VALUE '0019'.
   578     12  ER-0029                 PIC X(4)  VALUE '0029'.
   579     12  ER-0042                 PIC X(4)  VALUE '0042'.
   580     12  ER-0070                 PIC X(4)  VALUE '0070'.
   581     12  ER-0130                 PIC X(4)  VALUE '0130'.
   582     12  ER-0149                 PIC X(4)  VALUE '0149'.
   583     12  ER-0154                 PIC X(4)  VALUE '0154'.
   584     12  ER-0168                 PIC X(4)  VALUE '0168'.
   585     12  ER-0169                 PIC X(4)  VALUE '0169'.
   586     12  ER-0172                 PIC X(4)  VALUE '0174'.
   587     12  ER-0198                 PIC X(4)  VALUE '0198'.
   588     12  ER-0204                 PIC X(4)  VALUE '0204'.
   589     12  ER-0206                 PIC X(4)  VALUE '0206'.
   590     12  ER-0252                 PIC X(4)  VALUE '0252'.
   591     12  ER-0254                 PIC X(4)  VALUE '0254'.
   592     12  ER-0282                 PIC X(4)  VALUE '0282'.
   593     12  ER-0283                 PIC X(4)  VALUE '0283'.
   594     12  ER-0294                 PIC X(4)  VALUE '0294'.
   595     12  ER-0338                 PIC X(4)  VALUE '0338'.
   596     12  ER-0419                 PIC X(4)  VALUE '0419'.
   597     12  ER-0420                 PIC X(4)  VALUE '0420'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  13
* EL156.cbl
   598     12  ER-0421                 PIC X(4)  VALUE '0421'.
   599     12  ER-0422                 PIC X(4)  VALUE '0422'.
   600     12  ER-0433                 PIC X(4)  VALUE '0433'.
   601     12  ER-0436                 PIC X(4)  VALUE '0436'.
   602     12  ER-0437                 PIC X(4)  VALUE '0437'.
   603     12  ER-0438                 PIC X(4)  VALUE '0438'.
   604     12  ER-0439                 PIC X(4)  VALUE '0439'.
   605     12  ER-0440                 PIC X(4)  VALUE '0440'.
   606     12  ER-0441                 PIC X(4)  VALUE '0441'.
   607     12  ER-0442                 PIC X(4)  VALUE '0442'.
   608     12  ER-0443                 PIC X(4)  VALUE '0443'.
   609     12  ER-0444                 PIC X(4)  VALUE '0444'.
   610     12  ER-0445                 PIC X(4)  VALUE '0445'.
   611     12  ER-0446                 PIC X(4)  VALUE '0446'.
   612     12  ER-0447                 PIC X(4)  VALUE '0447'.
   613     12  ER-0448                 PIC X(4)  VALUE '0448'.
   614     12  ER-0449                 PIC X(4)  VALUE '0449'.
   615     12  ER-0452                 PIC X(4)  VALUE '0452'.
   616     12  ER-0458                 PIC X(4)  VALUE '0458'.
   617     12  ER-0459                 PIC X(4)  VALUE '0459'.
   618     12  ER-0460                 PIC X(4)  VALUE '0460'.
   619     12  ER-0461                 PIC X(4)  VALUE '0461'.
   620     12  ER-0462                 PIC X(4)  VALUE '0462'.
   621     12  ER-0463                 PIC X(4)  VALUE '0463'.
   622     12  ER-0464                 PIC X(4)  VALUE '0464'.
   623     12  ER-0465                 PIC X(4)  VALUE '0465'.
   624     12  ER-0466                 PIC X(4)  VALUE '0466'.
   625     12  ER-0467                 PIC X(4)  VALUE '0467'.
   626     12  ER-0468                 PIC X(4)  VALUE '0468'.
   627     12  ER-0469                 PIC X(4)  VALUE '0469'.
   628     12  ER-0473                 PIC X(4)  VALUE '0473'.
   629     12  ER-0474                 PIC X(4)  VALUE '0474'.
   630     12  ER-0475                 PIC X(4)  VALUE '0475'.
   631     12  ER-0476                 PIC X(4)  VALUE '0476'.
   632     12  ER-0477                 PIC X(4)  VALUE '0477'.
   633     12  ER-0478                 PIC X(4)  VALUE '0478'.
   634     12  ER-0479                 PIC X(4)  VALUE '0479'.
   635     12  ER-0481                 PIC X(4)  VALUE '0481'.
   636     12  ER-0491                 PIC X(4)  VALUE '0491'.
   637     12  ER-0492                 PIC X(4)  VALUE '0492'.
   638     12  ER-0493                 PIC X(4)  VALUE '0493'.
   639     12  ER-0494                 PIC X(4)  VALUE '0494'.
   640     12  ER-0495                 PIC X(4)  VALUE '0495'.
   641     12  ER-0499                 PIC X(4)  VALUE '0499'.
   642     12  ER-0500                 PIC X(4)  VALUE '0500'.
   643     12  ER-0501                 PIC X(4)  VALUE '0501'.
   644     12  ER-0502                 PIC X(4)  VALUE '0502'.
   645     12  ER-0508                 PIC X(4)  VALUE '0508'.
   646     12  ER-0513                 PIC X(4)  VALUE '0513'.
   647     12  ER-0518                 PIC X(4)  VALUE '0518'.
   648     12  ER-0524                 PIC X(4)  VALUE '0524'.
   649     12  ER-0525                 PIC X(4)  VALUE '0525'.
   650     12  ER-0526                 PIC X(4)  VALUE '0526'.
   651     12  ER-0530                 PIC X(4)  VALUE '0530'.
   652     12  ER-0540                 PIC X(4)  VALUE '0540'.
   653     12  ER-0541                 PIC X(4)  VALUE '0541'.
   654     12  ER-0542                 PIC X(4)  VALUE '0542'.
   655     12  ER-0543                 PIC X(4)  VALUE '0543'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  14
* EL156.cbl
   656     12  ER-0545                 PIC X(4)  VALUE '0545'.
   657     12  ER-0552                 PIC X(4)  VALUE '0552'.
   658     12  ER-0555                 PIC X(4)  VALUE '0555'.
   659     12  ER-0556                 PIC X(4)  VALUE '0556'.
   660     12  ER-0557                 PIC X(4)  VALUE '0557'.
   661     12  ER-0572                 PIC X(4)  VALUE '0572'.
   662     12  ER-0573                 PIC X(4)  VALUE '0573'.
   663     12  ER-0594                 PIC X(4)  VALUE '0594'.
   664     12  ER-0616                 PIC X(4)  VALUE '0616'.
   665     12  ER-0617                 PIC X(4)  VALUE '0617'.
   666     12  ER-0618                 PIC X(4)  VALUE '0618'.
   667     12  ER-0657                 PIC X(4)  VALUE '0657'.
   668     12  ER-0658                 PIC X(4)  VALUE '0658'.
   669     12  ER-0699                 PIC X(4)  VALUE '0699'.
   670     12  ER-0730                 PIC X(4)  VALUE '0730'.
   671     12  ER-0737                 PIC X(4)  VALUE '0737'.
   672     12  ER-0760                 PIC X(4)  VALUE '0760'.
   673     12  ER-0768                 PIC X(4)  VALUE '0768'.
   674     12  ER-0769                 PIC X(4)  VALUE '0769'.
   675     12  ER-0770                 PIC X(4)  VALUE '0770'.
   676     12  ER-0802                 PIC X(4)  VALUE '0802'.
   677     12  ER-0803                 PIC X(4)  VALUE '0803'.
   678     12  ER-0819                 PIC X(4)  VALUE '0819'.
   679     12  ER-0834                 PIC X(4)  VALUE '0834'.
   680     12  ER-0836                 PIC X(4)  VALUE '0836'.
   681     12  ER-0844                 PIC X(4)  VALUE '0844'.
   682     12  ER-0845                 PIC X(4)  VALUE '0845'.
   683     12  ER-0846                 PIC X(4)  VALUE '0846'.
   684     12  ER-0849                 PIC X(4)  VALUE '0849'.
   685     12  ER-0851                 PIC X(4)  VALUE '0851'.
   686     12  ER-0872                 PIC X(4)  VALUE '0872'.
   687     12  ER-0873                 PIC X(4)  VALUE '0873'.
   688     12  ER-0874                 PIC X(4)  VALUE '0874'.
   689     12  ER-0879                 PIC X(4)  VALUE '0879'.
   690     12  ER-0919                 PIC X(4)  VALUE '0919'.
   691     12  ER-0921                 PIC X(4)  VALUE '0921'.
   692     12  ER-0923                 PIC X(4)  VALUE '0923'.
   693     12  ER-0925                 PIC X(4)  VALUE '0925'.
   694     12  ER-0944                 PIC X(4)  VALUE '0944'.
   695     12  ER-0945                 PIC X(4)  VALUE '0945'.
   696     12  ER-0946                 PIC X(4)  VALUE '0946'.
   697     12  ER-0947                 PIC X(4)  VALUE '0947'.
   698     12  ER-0948                 PIC X(4)  VALUE '0948'.
   699     12  ER-0949                 PIC X(4)  VALUE '0949'.
   700     12  ER-0950                 PIC X(4)  VALUE '0950'.
   701     12  ER-0951                 PIC X(4)  VALUE '0951'.
   702     12  ER-0954                 PIC X(4)  VALUE '0954'.
   703     12  ER-0956                 PIC X(4)  VALUE '0956'.
   704     12  ER-0967                 PIC X(4)  VALUE '0967'.
   705     12  ER-0968                 PIC X(4)  VALUE '0968'.
   706     12  ER-0974                 PIC X(4)  VALUE '0974'.
   707     12  ER-0975                 PIC X(4)  VALUE '0975'.
   708     12  ER-1561                 PIC X(4)  VALUE '1561'.
   709     12  ER-1566                 PIC X(4)  VALUE '1566'.
   710     12  ER-1567                 PIC X(4)  VALUE '1567'.
   711     12  ER-1569                 PIC X(4)  VALUE '1569'.
   712     12  er-1582                 pic x(4)  value '1582'.
   713     12  er-1657                 pic x(4)  value '1657'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  15
* EL156.cbl
   714     12  er-1658                 pic x(4)  value '1658'.
   715     12  er-1667                 pic x(4)  value '1667'.
   716     12  er-1670                 pic x(4)  value '1670'.
   717     12  er-1671                 pic x(4)  value '1671'.
   718     12  er-1672                 pic x(4)  value '1672'.
   719     12  er-1673                 pic x(4)  value '1673'.
   720     12  er-1674                 pic x(4)  value '1674'.
   721     12  er-1677                 pic x(4)  value '1677'.
   722     12  ER-1775                 PIC X(4)  VALUE '1775'.
   723     12  ER-1880                 PIC X(4)  VALUE '1880'.
   724     12  ER-1930                 PIC X(4)  VALUE '1930'.
   725     12  ER-2044                 PIC X(4)  VALUE '2044'.
   726     12  ER-3140                 PIC X(4)  VALUE '3140'.
   727     12  ER-3141                 PIC X(4)  VALUE '3141'.
   728     12  ER-3255                 PIC X(4)  VALUE '3255'.
   729     12  ER-3272                 PIC X(4)  VALUE '3272'.
   730     12  ER-3276                 PIC X(4)  VALUE '3276'.
   731     12  ER-3277                 PIC X(4)  VALUE '3277'.
   732     12  ER-3278                 PIC X(4)  VALUE '3278'.
   733     12  ER-3279                 PIC X(4)  VALUE '3279'.
   734     12  ER-3280                 PIC X(4)  VALUE '3280'.
   735     12  ER-3516                 PIC X(4)  VALUE '3516'.
   736     12  ER-3527                 PIC X(4)  VALUE '3527'.
   737     12  ER-3528                 PIC X(4)  VALUE '3528'.
   738     12  ER-3529                 PIC X(4)  VALUE '3529'.
   739     12  ER-3530                 PIC X(4)  VALUE '3530'.
   740     12  ER-3531                 PIC X(4)  VALUE '3531'.
   741     12  ER-3532                 PIC X(4)  VALUE '3532'.
   742     12  ER-3533                 PIC X(4)  VALUE '3533'.
   743     12  ER-3534                 PIC X(4)  VALUE '3534'.
   744     12  ER-3535                 PIC X(4)  VALUE '3535'.
   745     12  ER-3536                 PIC X(4)  VALUE '3536'.
   746     12  ER-3537                 PIC X(4)  VALUE '3537'.
   747     12  ER-3538                 PIC X(4)  VALUE '3538'.
   748     12  ER-3539                 PIC X(4)  VALUE '3539'.
   749     12  ER-3540                 PIC X(4)  VALUE '3540'.
   750     12  ER-3541                 PIC X(4)  VALUE '3541'.
   751     12  ER-3542                 PIC X(4)  VALUE '3542'.
   752     12  ER-3543                 PIC X(4)  VALUE '3543'.
   753     12  ER-3546                 PIC X(4)  VALUE '3546'.
   754     12  ER-3549                 PIC X(4)  VALUE '3549'.
   755     12  ER-3551                 PIC X(4)  VALUE '3551'.
   756     12  ER-3818                 PIC X(4)  VALUE '3818'.
   757     12  ER-7540                 PIC X(4)  VALUE '7540'.
   758     12  ER-7576                 PIC X(4)  VALUE '7576'.
   759     12  ER-7579                 PIC X(4)  VALUE '7579'.
   760     12  ER-7580                 PIC X(4)  VALUE '7580'.
   761     12  ER-7583                 PIC X(4)  VALUE '7583'.
   762     12  ER-7585                 PIC X(4)  VALUE '7585'.
   763     12  ER-7830                 PIC X(4)  VALUE '7830'.
   764     12  ER-7831                 PIC X(4)  VALUE '7831'.
   765     12  ER-7832                 PIC X(4)  VALUE '7832'.
   766     12  ER-7833                 PIC X(4)  VALUE '7833'.
   767     12  ER-7834                 PIC X(4)  VALUE '7834'.
   768     12  ER-7835                 PIC X(4)  VALUE '7835'.
   769     12  ER-7836                 PIC X(4)  VALUE '7836'.
   770     12  ER-7837                 PIC X(4)  VALUE '7837'.
   771     12  ER-7838                 PIC X(4)  VALUE '7838'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  16
* EL156.cbl
   772     12  ER-7841                 PIC X(4)  VALUE '7841'.
   773     12  ER-7844                 PIC X(4)  VALUE '7844'.
   774     12  ER-7845                 PIC X(4)  VALUE '7845'.
   775     12  ER-8000                 PIC X(4)  VALUE '8000'.
   776     12  ER-8051                 PIC X(4)  VALUE '8051'.
   777     12  ER-8052                 PIC X(4)  VALUE '8052'.
   778     12  ER-8053                 PIC X(4)  VALUE '8053'.
   779     12  ER-8054                 PIC X(4)  VALUE '8054'.
   780     12  ER-8055                 PIC X(4)  VALUE '8055'.
   781     12  ER-8056                 PIC X(4)  VALUE '8056'.
   782     12  ER-8057                 PIC X(4)  VALUE '8057'.
   783     12  ER-8058                 PIC X(4)  VALUE '8058'.
   784     12  ER-8059                 PIC X(4)  VALUE '8059'.
   785     12  ER-8060                 PIC X(4)  VALUE '8060'.
   786     12  ER-8061                 PIC X(4)  VALUE '8061'.
   787     12  ER-8062                 PIC X(4)  VALUE '8062'.
   788     12  ER-8063                 PIC X(4)  VALUE '8063'.
   789     12  ER-8064                 PIC X(4)  VALUE '8064'.
   790     12  ER-8065                 PIC X(4)  VALUE '8065'.
   791     12  ER-8066                 PIC X(4)  VALUE '8066'.
   792     12  ER-8146                 PIC X(4)  VALUE '8146'.
   793     12  ER-8147                 PIC X(4)  VALUE '8147'.
   794     12  ER-8152                 PIC X(4)  VALUE '8152'.
   795     12  ER-8153                 PIC X(4)  VALUE '8153'.
   796     12  ER-8154                 PIC X(4)  VALUE '8154'.
   797     12  ER-8155                 PIC X(4)  VALUE '8155'.
   798     12  ER-8310                 PIC X(4)  VALUE '8310'.
   799     12  ER-8311                 PIC X(4)  VALUE '8311'.
   800     12  ER-8312                 PIC X(4)  VALUE '8312'.
   801     12  ER-8313                 PIC X(4)  VALUE '8313'.
   802     12  ER-8314                 PIC X(4)  VALUE '8314'.
   803     12  ER-8315                 PIC X(4)  VALUE '8315'.
   804     12  ER-8316                 PIC X(4)  VALUE '8316'.
   805     12  ER-8317                 PIC X(4)  VALUE '8317'.
   806
   807 01  CSO-WORK-FIELDS.
   808     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   809       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   810
   811     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   812     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   813         88  CERT-NOTE-ADDED           VALUE 'Y'.
   814     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   815         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   816     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   817
   818     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   819
   820 01  SC-NP6-CERT-NOTE.
   821     12  FILLER                  PIC X(12)
   822               VALUE 'REM BENEFIT '.
   823     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   824     12  SC-NP6-COMM             PIC X(8)
   825               VALUE ' + 6 MO '.
   826     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   827     12  FILLER                  PIC X(12)
   828               VALUE ' = AMT PAID '.
   829     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  17
* EL156.cbl
   830
   831 01  SC-NP6-ORIG-NOTE.
   832     12  FILLER                  PIC X(63)  VALUE
   833         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   834 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   835     88  PDEF-FOUND                   VALUE 'Y'.
   836 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   837     88  ACCT-FOUND                   VALUE 'Y'.
   838 01  CTBL-KEY-SAVE               PIC X(5).
   839 01  CTBL-KEY.
   840     05  CTBL-COMPANY-CD         PIC X.
   841     05  CTBL-TABLE              PIC XXX.
   842     05  CTBL-BEN-TYPE           PIC X.
   843     05  CTBL-BEN-CODE           PIC XX.
   844 01  ERPDEF-KEY-SAVE             PIC X(18).
   845 01  ERPDEF-KEY.
   846     12  ERPDEF-COMPANY-CD       PIC X.
   847     12  ERPDEF-STATE            PIC XX.
   848     12  ERPDEF-PROD-CD          PIC XXX.
   849     12  F                       PIC X(7).
   850     12  ERPDEF-BEN-TYPE         PIC X.
   851     12  ERPDEF-BEN-CODE         PIC XX.
   852     12  ERPDEF-EXP-DT           PIC XX.
   853 01  ELCRTT-KEY.
   854     05  CTRLR-COMP-CD       PIC X.
   855     05  CTRLR-CARRIER       PIC X.
   856     05  CTRLR-GROUPING      PIC X(6).
   857     05  CTRLR-STATE         PIC X(2).
   858     05  CTRLR-ACCOUNT       PIC X(10).
   859     05  CTRLR-EFF-DT        PIC XX.
   860     05  CTRLR-CERT-NO       PIC X(11).
   861     05  CTRLR-REC-TYPE      PIC X.
   862 01  ACCESS-KEYS.
   863     12  ELARCH-KEY.
   864         16  ARCH-CO             PIC X.
   865         16  ARCH-NUMBER         PIC S9(08) COMP.
   866         16  ARCH-REC-TYPE       PIC X.
   867         16  ARCH-SEQ            PIC S9(04) COMP.
   868     12  ELMSTR-KEY.
   869         16  MSTR-COMP-CD        PIC X.
   870         16  MSTR-CARRIER        PIC X.
   871         16  MSTR-CLAIM-NO       PIC X(7).
   872         16  MSTR-CERT-NO        PIC X(11).
   873     12  ELCNTL-KEY.
   874         16  CNTL-COMP-ID        PIC X(3).
   875         16  CNTL-REC-TYPE       PIC X.
   876         16  CNTL-ACCESS         PIC X(4).
   877         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   878     12  ELCERT-KEY.
   879         16  CERT-COMP-CD        PIC X.
   880         16  CERT-CARRIER        PIC X.
   881         16  CERT-GROUPING       PIC X(6).
   882         16  CERT-STATE          PIC XX.
   883         16  CERT-ACCOUNT        PIC X(10).
   884         16  CERT-EFF-DT         PIC XX.
   885         16  CERT-CERT-NO        PIC X(11).
   886     12  ELTRLR-KEY.
   887         16  TRLR-COMP-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  18
* EL156.cbl
   888         16  TRLR-CARRIER        PIC X.
   889         16  TRLR-CLAIM-NO       PIC X(7).
   890         16  TRLR-CERT-NO        PIC X(11).
   891         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   892     12  ELACTQ-KEY.
   893         16  ACTQ-COMP-CD        PIC X.
   894         16  ACTQ-CARRIER        PIC X.
   895         16  ACTQ-CLAIM-NO       PIC X(7).
   896         16  ACTQ-CERT-NO        PIC X(11).
   897     12  W-NOTE-KEY.
   898         16  W-NOTE-COMP-CD      PIC X.
   899         16  W-NOTE-CERT-KEY.
   900             20  W-NOTE-CARRIER  PIC X.
   901             20  W-NOTE-GROUPING PIC X(6).
   902             20  W-NOTE-STATE    PIC XX.
   903             20  W-NOTE-ACCOUNT  PIC X(10).
   904             20  W-NOTE-EFF-DT   PIC XX.
   905             20  W-NOTE-CERT-NO  PIC X(11).
   906     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   907     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   908     12  ERACCT-KEY.
   909         16  ERACCT-PARTIAL-KEY.
   910             20  ACCT-COMP-CD    PIC X.
   911             20  ACCT-CARRIER    PIC X.
   912             20  ACCT-GROUPING   PIC X(6).
   913             20  ACCT-STATE      PIC XX.
   914             20  ACCT-ACCOUNT    PIC X(10).
   915         16  ACCT-EXP-DT         PIC XX.
   916         16  FILLER              PIC X(4) VALUE SPACES.
   917     12  ELCHKQ-KEY.
   918         16  CHKQ-COMP-CD        PIC X.
   919         16  CHKQ-CONTROL        PIC S9(8) COMP.
   920         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   921     12  ELBENE-KEY.
   922         16  BENE-COMP-CD         PIC X.
   923         16  BENE-RECORD-TYPE     PIC X.
   924         16  BENE-NUMBER          PIC X(10).
   925     12  ERCOMP-KEY.
   926         16  COMP-COMP-CD        PIC X.
   927         16  COMP-CARRIER        PIC X.
   928         16  COMP-GROUP          PIC X(06).
   929         16  COMP-FIN-RESP       PIC X(10).
   930         16  COMP-ACCOUNT        PIC X(10).
   931         16  COMP-TYPE           PIC X.
   932
   933     12  DLO035-KEY.
   934         16  DL35-PROCESS-TYPE   PIC X.
   935         16  DL35-CREDIT-CARD    PIC X(20).
   936         16  DL35-BEN-TYPE       PIC XX.
   937         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   938         16  DL35-RETURN-CODE    PIC XX.
   939
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  19
* EL156.cbl
   941*    COPY ELCDATE.
   942******************************************************************
   943*                                                                *
   944*                                                                *
   945*                            ELCDATE.                            *
   946*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   947*                            VMOD=2.003
   948*                                                                *
   949*                                                                *
   950*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   951*                 LENGTH = 200                                   *
   952******************************************************************
   953
   954 01  DATE-CONVERSION-DATA.
   955     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   956     12  DC-OPTION-CODE                PIC X.
   957         88  BIN-TO-GREG                VALUE ' '.
   958         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   959         88  EDIT-GREG-TO-BIN           VALUE '2'.
   960         88  YMD-GREG-TO-BIN            VALUE '3'.
   961         88  MDY-GREG-TO-BIN            VALUE '4'.
   962         88  JULIAN-TO-BIN              VALUE '5'.
   963         88  BIN-PLUS-ELAPSED           VALUE '6'.
   964         88  FIND-CENTURY               VALUE '7'.
   965         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   966         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   967         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   968         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   969         88  JULIAN-TO-BIN-3            VALUE 'C'.
   970         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   971         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   972         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   973         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   974         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   975         88  CHECK-LEAP-YEAR            VALUE 'H'.
   976         88  BIN-3-TO-GREG              VALUE 'I'.
   977         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   978         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   979         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   980         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   981         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   982         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   983         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   984         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   985         88  THREE-CHARACTER-BIN
   986                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   987         88  GREGORIAN-TO-BIN
   988                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   989         88  BIN-TO-GREGORIAN
   990                  VALUES ' ' '1' 'I' '8' 'G'.
   991         88  JULIAN-TO-BINARY
   992                  VALUES '5' 'C' 'E' 'F'.
   993     12  DC-ERROR-CODE                 PIC X.
   994         88  NO-CONVERSION-ERROR        VALUE ' '.
   995         88  DATE-CONVERSION-ERROR
   996                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   997         88  DATE-IS-ZERO               VALUE '1'.
   998         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  20
* EL156.cbl
   999         88  DATE-IS-INVALID            VALUE '3'.
  1000         88  DATE1-GREATER-DATE2        VALUE '4'.
  1001         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1002         88  DATE-INVALID-OPTION        VALUE '9'.
  1003         88  INVALID-CENTURY            VALUE 'A'.
  1004         88  ONLY-CENTURY               VALUE 'B'.
  1005         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1006         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1007     12  DC-END-OF-MONTH               PIC X.
  1008         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1009     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1010         88  USE-NORMAL-PROCESS         VALUE ' '.
  1011         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1012         88  ADJUST-UP-100-YRS          VALUE '2'.
  1013     12  FILLER                        PIC X.
  1014     12  DC-CONVERSION-DATES.
  1015         16  DC-BIN-DATE-1             PIC XX.
  1016         16  DC-BIN-DATE-2             PIC XX.
  1017         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1018         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1019                       DC-GREG-DATE-1-EDIT.
  1020             20  DC-EDIT1-MONTH        PIC 99.
  1021             20  SLASH1-1              PIC X.
  1022             20  DC-EDIT1-DAY          PIC 99.
  1023             20  SLASH1-2              PIC X.
  1024             20  DC-EDIT1-YEAR         PIC 99.
  1025         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1026         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1027                     DC-GREG-DATE-2-EDIT.
  1028             20  DC-EDIT2-MONTH        PIC 99.
  1029             20  SLASH2-1              PIC X.
  1030             20  DC-EDIT2-DAY          PIC 99.
  1031             20  SLASH2-2              PIC X.
  1032             20  DC-EDIT2-YEAR         PIC 99.
  1033         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1034         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1035                     DC-GREG-DATE-1-YMD.
  1036             20  DC-YMD-YEAR           PIC 99.
  1037             20  DC-YMD-MONTH          PIC 99.
  1038             20  DC-YMD-DAY            PIC 99.
  1039         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1040         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1041                      DC-GREG-DATE-1-MDY.
  1042             20  DC-MDY-MONTH          PIC 99.
  1043             20  DC-MDY-DAY            PIC 99.
  1044             20  DC-MDY-YEAR           PIC 99.
  1045         16  DC-GREG-DATE-1-ALPHA.
  1046             20  DC-ALPHA-MONTH        PIC X(10).
  1047             20  DC-ALPHA-DAY          PIC 99.
  1048             20  FILLER                PIC XX.
  1049             20  DC-ALPHA-CENTURY.
  1050                 24 DC-ALPHA-CEN-N     PIC 99.
  1051             20  DC-ALPHA-YEAR         PIC 99.
  1052         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1053         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1054         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1055         16  DC-JULIAN-DATE            PIC 9(05).
  1056         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  21
* EL156.cbl
  1057                                       PIC 9(05).
  1058         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1059             20  DC-JULIAN-YEAR        PIC 99.
  1060             20  DC-JULIAN-DAYS        PIC 999.
  1061         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1062         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1063         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1064     12  DATE-CONVERSION-VARIBLES.
  1065         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1066         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1067             20  FILLER                PIC 9(3).
  1068             20  HOLD-CEN-1-CCYY.
  1069                 24  HOLD-CEN-1-CC     PIC 99.
  1070                 24  HOLD-CEN-1-YY     PIC 99.
  1071             20  HOLD-CEN-1-MO         PIC 99.
  1072             20  HOLD-CEN-1-DA         PIC 99.
  1073         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1074             20  HOLD-CEN-1-R-MO       PIC 99.
  1075             20  HOLD-CEN-1-R-DA       PIC 99.
  1076             20  HOLD-CEN-1-R-CCYY.
  1077                 24  HOLD-CEN-1-R-CC   PIC 99.
  1078                 24  HOLD-CEN-1-R-YY   PIC 99.
  1079             20  FILLER                PIC 9(3).
  1080         16  HOLD-CENTURY-1-X.
  1081             20  FILLER                PIC X(3)  VALUE SPACES.
  1082             20  HOLD-CEN-1-X-CCYY.
  1083                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1084                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1085             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1086             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1087         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1088             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1089             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1090             20  HOLD-CEN-1-R-X-CCYY.
  1091                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1092                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1093             20  FILLER                PIC XXX.
  1094         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1095         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1096         16  DC-JULIAN-DATE-1          PIC 9(07).
  1097         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1098             20  DC-JULIAN-1-CCYY.
  1099                 24  DC-JULIAN-1-CC    PIC 99.
  1100                 24  DC-JULIAN-1-YR    PIC 99.
  1101             20  DC-JULIAN-DA-1        PIC 999.
  1102         16  DC-JULIAN-DATE-2          PIC 9(07).
  1103         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1104             20  DC-JULIAN-2-CCYY.
  1105                 24  DC-JULIAN-2-CC    PIC 99.
  1106                 24  DC-JULIAN-2-YR    PIC 99.
  1107             20  DC-JULIAN-DA-2        PIC 999.
  1108         16  DC-GREG-DATE-A-EDIT.
  1109             20  DC-EDITA-MONTH        PIC 99.
  1110             20  SLASHA-1              PIC X VALUE '/'.
  1111             20  DC-EDITA-DAY          PIC 99.
  1112             20  SLASHA-2              PIC X VALUE '/'.
  1113             20  DC-EDITA-CCYY.
  1114                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  22
* EL156.cbl
  1115                 24  DC-EDITA-YEAR     PIC 99.
  1116         16  DC-GREG-DATE-B-EDIT.
  1117             20  DC-EDITB-MONTH        PIC 99.
  1118             20  SLASHB-1              PIC X VALUE '/'.
  1119             20  DC-EDITB-DAY          PIC 99.
  1120             20  SLASHB-2              PIC X VALUE '/'.
  1121             20  DC-EDITB-CCYY.
  1122                 24  DC-EDITB-CENT     PIC 99.
  1123                 24  DC-EDITB-YEAR     PIC 99.
  1124         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1125         16  DC-GREG-DATE-CYMD-R REDEFINES
  1126                              DC-GREG-DATE-CYMD.
  1127             20  DC-CYMD-CEN           PIC 99.
  1128             20  DC-CYMD-YEAR          PIC 99.
  1129             20  DC-CYMD-MONTH         PIC 99.
  1130             20  DC-CYMD-DAY           PIC 99.
  1131         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1132         16  DC-GREG-DATE-MDCY-R REDEFINES
  1133                              DC-GREG-DATE-MDCY.
  1134             20  DC-MDCY-MONTH         PIC 99.
  1135             20  DC-MDCY-DAY           PIC 99.
  1136             20  DC-MDCY-CEN           PIC 99.
  1137             20  DC-MDCY-YEAR          PIC 99.
  1138    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1139        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1140    12  DC-EL310-DATE                  PIC X(21).
  1141    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  23
* EL156.cbl
  1143*    COPY ELCLOGOF.
  1144******************************************************************
  1145*                                                                *
  1146*                                                                *
  1147*                            ELCLOGOF.                           *
  1148*                            VMOD=2.001                          *
  1149*                                                                *
  1150*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1151*                                                                *
  1152******************************************************************
  1153 01  CLASIC-LOGOFF.
  1154     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1155     12  LOGOFF-TEXT.
  1156         16  FILLER          PIC X(5)    VALUE SPACES.
  1157         16  LOGOFF-MSG.
  1158             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1159             20  FILLER      PIC X       VALUE SPACES.
  1160             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1161         16  FILLER          PIC X(80)
  1162           VALUE '* YOU ARE NOW LOGGED OFF'.
  1163         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1164         16  FILLER          PIC X       VALUE QUOTE.
  1165         16  LOGOFF-SYS-MSG  PIC X(17)
  1166           VALUE 'S CLAS-IC SYSTEM '.
  1167     12  TEXT-MESSAGES.
  1168         16  UNACCESS-MSG    PIC X(29)
  1169             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1170         16  PGMIDERR-MSG    PIC X(17)
  1171             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  24
* EL156.cbl
  1173*    COPY ELCCALC.
  1174******************************************************************
  1175*                                                                *
  1176*                           ELCCALC.                            *
  1177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1178*                            VMOD=2.025                          *
  1179*                                                                *
  1180*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1181*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1182*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1183*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1184*                                                                *
  1185*  PASSED TO ELRTRM                                              *
  1186*  -----------------                                             *
  1187*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1188*  ORIGINAL TERM                                                 *
  1189*  BEGINNING DATE                                                *
  1190*  ENDING DATE                                                   *
  1191*  COMPANY I.D.                                                  *
  1192*  ACCOUNT MASTER USER FIELD                                     *
  1193*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1194*  FREE LOOK DAYS                                                *
  1195*                                                                *
  1196*  RETURNED FROM ELRTRM                                          *
  1197*  ---------------------                                         *
  1198*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1199*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1200*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1201*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1202*----------------------------------------------------------------*
  1203*  PASSED TO ELRAMT                                              *
  1204*  ----------------                                              *
  1205*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1206*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1207*  ORIGINAL AMOUNT                                               *
  1208*  ALTERNATE BENEFIT (BALLON)                                    *
  1209*  A.P.R. - NET PAY ONLY                                         *
  1210*  METHOD
  1211*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1212*  COMPANY I.D.                                                  *
  1213*  BENEFIT TYPE                                                  *
  1214*                                                                *
  1215*  RETURNED FROM ELRAMT                                          *
  1216*  --------------------                                          *
  1217*  REMAINING AMOUNT 1 - CURRENT                                  *
  1218*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1219*  REMAINING AMOUNT FACTOR
  1220*----------------------------------------------------------------*
  1221*  PASSED TO ELRESV                                              *
  1222*  -----------------                                             *
  1223*  CERTIFICATE EFFECTIVE DATE                                    *
  1224*  VALUATION DATE                                                *
  1225*  PAID THRU DATE                                                *
  1226*  BENEFIT                                                       *
  1227*  INCURRED DATE                                                 *
  1228*  REPORTED DATE                                                 *
  1229*  ISSUE AGE                                                     *
  1230*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  25
* EL156.cbl
  1231*  CDT PERCENT                                                   *
  1232*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1233* *CLAIM TYPE (LIFE, A/H)                                        *
  1234* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1235* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1236*                                                                *
  1237*  RETURNED FROM ELRESV                                          *
  1238*  --------------------                                          *
  1239*  CDT TABLE USED                                                *
  1240*  CDT FACTOR USED                                               *
  1241*  PAY TO CURRENT RESERVE                                        *
  1242*  I.B.N.R. - A/H ONLY                                           *
  1243*  FUTURE (ACCRUED) AH ONLY                                      *
  1244*----------------------------------------------------------------*
  1245*  PASSED TO ELRATE                                              *
  1246*  ----------------                                              *
  1247*  CERT ISSUE DATE                                               *
  1248*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1249*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1250*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1251*  STATE CODE (CLIENT DEFINED)                                   *
  1252*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1253*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1254*  DEVIATION CODE                                                *
  1255*  ISSUE AGE                                                     *
  1256*  ORIGINAL BENEFIT AMOUNT                                       *
  1257*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1258*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1259*  BENEFIT KIND (LIFE OR A/H)                                    *
  1260*  A.P.R.                                                        *
  1261*  METHOD
  1262*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1263*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1264*  COMPANY I.D. (3 CHARACTER)                                    *
  1265*  BENEFIT CODE                                                  *
  1266*  BENEFIT OVERRIDE CODE                                         *
  1267*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1268*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1269*  JOINT INDICATOR (CSL ONLY)                                    *
  1270*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1271*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1272*                                                                *
  1273*  RETURNED FROM ELRATE                                          *
  1274*  --------------------                                          *
  1275*  CALCULATED PREMIUM                                            *
  1276*  PREMIUM RATE                                                  *
  1277*  MORTALITY CODE                                                *
  1278*  MAX ATTAINED AGE                                              *
  1279*  MAX AGE                                                       *
  1280*  MAX TERM                                                      *
  1281*  MAX MONTHLY BENEFIT                                           *
  1282*  MAX TOTAL BENIFIT                                             *
  1283*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1284*----------------------------------------------------------------*
  1285*  PASSED TO ELRFND                                              *
  1286*  ----------------                                              *
  1287*  CERT ISSUE DATE                                               *
  1288*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  26
* EL156.cbl
  1289*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1290*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1291*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1292*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1293*  STATE CODE (CLIENT DEFINED)                                   *
  1294*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1295*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1296*  DEVIATION CODE                                                *
  1297*  ISSUE AGE                                                     *
  1298*  ORIGINAL BENEFIT AMOUNT                                       *
  1299*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1300*  PROCESS TYPE (CANCEL)                                         *
  1301*  BENEFIT KIND (LIFE OR A/H)                                    *
  1302*  A.P.R.                                                        *
  1303*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1304*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1305*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1306*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1307*  COMPANY I.D. (3 CHARACTER)                                    *
  1308*  BENEFIT CODE                                                  *
  1309*  BENEFIT OVERRIDE CODE                                         *
  1310*                                                                *
  1311*  RETURNED FROM ELRFND                                          *
  1312*  --------------------                                          *
  1313*  CALCULATED REFUND                                             *
  1314*----------------------------------------------------------------*
  1315*  PASSED TO ELEARN                                              *
  1316*  ----------------                                              *
  1317*  CERT ISSUE DATE                                               *
  1318*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1319*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1320*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1321*  STATE CODE (CLIENT DEFINED)                                   *
  1322*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1323*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1324*  DEVIATION CODE                                                *
  1325*  ISSUE AGE                                                     *
  1326*  ORIGINAL BENEFIT AMOUNT                                       *
  1327*  BENEFIT KIND (LIFE OR A/H)                                    *
  1328*  A.P.R.                                                        *
  1329*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1330*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1331*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1332*  COMPANY I.D. (3 CHARACTER)                                    *
  1333*  BENEFIT CODE                                                  *
  1334*  BENEFIT OVERRIDE CODE                                         *
  1335*                                                                *
  1336*  RETURNED FROM ELEARN                                          *
  1337*  --------------------                                          *
  1338*  INDICATED  EARNINGS                                           *
  1339*----------------------------------------------------------------*
  1340*                 LENGTH = 450                                   *
  1341*                                                                *
  1342******************************************************************
  1343******************************************************************
  1344*                   C H A N G E   L O G
  1345*
  1346* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  27
* EL156.cbl
  1347*-----------------------------------------------------------------
  1348*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1349* EFFECTIVE    NUMBER
  1350*-----------------------------------------------------------------
  1351* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1352* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1353* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1354* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1355* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1356* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1357* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1358* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1359* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1360* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1361* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1362******************************************************************
  1363
  1364 01  CALCULATION-PASS-AREA.
  1365     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1366                                     COMP.
  1367
  1368     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1369       88  NO-CP-ERROR                             VALUE ZERO.
  1370       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1371                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1372       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1373       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1374       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1375       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1376       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1377       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1378       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1379       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1380       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1381       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1382       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1383       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1384       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1385       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1386       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1387       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1388       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1389
  1390     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1391       88  NO-CP-ERROR-2                           VALUE ZERO.
  1392***********************  INPUT AREAS ****************************
  1393
  1394     12  CP-CALCULATION-AREA.
  1395         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1396         16  CP-CERT-EFF-DT        PIC XX.
  1397         16  CP-VALUATION-DT       PIC XX.
  1398         16  CP-PAID-THRU-DT       PIC XX.
  1399         16  CP-BENEFIT-TYPE       PIC X.
  1400           88  CP-AH                               VALUE 'A' 'D'
  1401                                                   'I' 'U'.
  1402           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1403           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1404         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  28
* EL156.cbl
  1405         16  CP-REPORTED-DT        PIC XX.
  1406         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1407         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1408         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1409                                     COMP-3.
  1410         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1411                                     COMP-3.
  1412         16  CP-CDT-METHOD         PIC X.
  1413           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1414           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1415           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1416         16  CP-CLAIM-TYPE         PIC X.
  1417           88  CP-AH-CLAIM                         VALUE 'A'.
  1418           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1419         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1420                                     COMP-3.
  1421         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1422                                     COMP-3.
  1423         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1424                                     COMP-3.
  1425         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1426                                     COMP-3.
  1427         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1428                                     COMP-3.
  1429         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1430                                     COMP-3.
  1431         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1432                                     COMP-3.
  1433         16  CP-REM-TERM-METHOD    PIC X.
  1434           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1435           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1436           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1437           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1438           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1439           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1440           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1441         16  CP-EARNING-METHOD     PIC X.
  1442           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1443           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1444           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1445           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1446           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1447           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1448           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1449           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1450           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1451           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1452           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1453           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1454           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1455           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1456         16  CP-PROCESS-TYPE       PIC X.
  1457           88  CP-CLAIM                            VALUE '1'.
  1458           88  CP-CANCEL                           VALUE '2'.
  1459           88  CP-ISSUE                            VALUE '3'.
  1460         16  CP-SPECIAL-CALC-CD    PIC X.
  1461           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1462           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  29
* EL156.cbl
  1463           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1464           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1465           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1466           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1467           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1468           88  CP-FARM-PLAN                    VALUE 'F'.
  1469           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1470           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1471           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1472           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1473           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1474           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1475           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1476           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1477           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1478           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1479                                                     'W' 'X'.
  1480           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1481           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1482           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1483           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1484           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1485           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1486           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1487           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1488           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1489           88  CP-CSL-METH-1                   VALUE '5'.
  1490           88  CP-CSL-METH-2                   VALUE '6'.
  1491           88  CP-CSL-METH-3                   VALUE '7'.
  1492           88  CP-CSL-METH-4                   VALUE '8'.
  1493
  1494         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1495                                     COMP-3.
  1496         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1497         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1498         16  CP-STATE              PIC XX          VALUE SPACE.
  1499         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1500         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1501           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1502               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1503         16  CP-R78-OPTION         PIC X.
  1504           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1505           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1506
  1507         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1508         16  CP-IBNR-RESERVE-SW    PIC X.
  1509         16  CP-CLAIM-STATUS       PIC X.
  1510         16  CP-RATE-FILE          PIC X.
  1511         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1512                                     COMP-3.
  1513
  1514         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1515         16  CP-AH-OVERRIDE-CODE   PIC X.
  1516
  1517         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1518                                     COMP-3.
  1519         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1520                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  30
* EL156.cbl
  1521         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1522                                     COMP-3.
  1523         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1524                                     COMP-3.
  1525         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1526                                     COMP-3.
  1527         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1528                                  PIC S9(7)V99 COMP-3.
  1529
  1530         16  CP-PAID-FROM-DATE     PIC X(02).
  1531         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1532         16  CP-EXT-DAYS-CALC      PIC X.
  1533           88  CP-EXT-NO-CHG                   VALUE ' '.
  1534           88  CP-EXT-CHG-LF                   VALUE '1'.
  1535           88  CP-EXT-CHG-AH                   VALUE '2'.
  1536           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1537         16  CP-DOMICILE-STATE     PIC XX.
  1538         16  CP-CARRIER            PIC X.
  1539         16  CP-REIN-FLAG          PIC X.
  1540         16  CP-REM-TRM-CALC-OPTION PIC X.
  1541           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1542                      '2' '3' '4' '5'.
  1543           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1544           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1545           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1546           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1547           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1548           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1549           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1550           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1551         16  CP-SIG-SWITCH         PIC X.
  1552         16  CP-RATING-METHOD      PIC X.
  1553           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1554           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1555           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1556           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1557           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1558           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1559           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1560           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1561           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1562         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1563                                     COMP-3.
  1564         16  CP-BEN-CATEGORY       PIC X.
  1565         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1566         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1567                                   PIC S99V9(5) COMP-3.
  1568         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1569         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1570                                   PIC S99V9(5) COMP-3.
  1571         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1572         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1573         16  CP-EXPIRE-DT          PIC XX.
  1574         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1575         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1576         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1577         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1578         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  31
* EL156.cbl
  1579             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1580             88  CP-CALC-CLP              VALUE 'C'.
  1581         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1582         16  CP-CANCEL-REASON      PIC X.
  1583         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1584         16  CP-PMT-MODE           PIC X.
  1585         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1586         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1587         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1588         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1589         16  FILLER                PIC X.
  1590
  1591***************    OUTPUT FROM ELRESV   ************************
  1592
  1593         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1594
  1595         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1596                                     COMP-3.
  1597         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1598                                     COMP-3.
  1599         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1600                                     COMP-3.
  1601         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1602                                     COMP-3.
  1603         16  FILLER                PIC X(09).
  1604***************    OUTPUT FROM ELRTRM   *************************
  1605
  1606         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1607                                     COMP-3.
  1608         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1609                                     COMP-3.
  1610         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1611                                     COMP-3.
  1612         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1613                                     COMP-3.
  1614         16  FILLER                PIC X(12).
  1615
  1616***************    OUTPUT FROM ELRAMT   *************************
  1617
  1618         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1619                                     COMP-3.
  1620         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1621                                     COMP-3.
  1622         16  FILLER                PIC X(12).
  1623
  1624***************    OUTPUT FROM ELRATE   *************************
  1625
  1626         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1627                                     COMP-3.
  1628         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1629                                     COMP-3.
  1630         16  CP-MORTALITY-CODE     PIC X(4).
  1631         16  CP-RATE-EDIT-FLAG     PIC X.
  1632             88  CP-RATES-NEED-APR                  VALUE '1'.
  1633         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1634                                     COMP-3.
  1635         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1636         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  32
* EL156.cbl
  1637         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1638                                   PIC S9(7)V99 COMP-3.
  1639         16  FILLER                PIC X(07).
  1640
  1641***************    OUTPUT FROM ELRFND   *************************
  1642
  1643         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1644                                     COMP-3.
  1645         16  CP-REFUND-TYPE-USED   PIC X.
  1646           88  CP-R-AS-R78                         VALUE '1'.
  1647           88  CP-R-AS-PRORATA                     VALUE '2'.
  1648           88  CP-R-AS-CALIF                       VALUE '3'.
  1649           88  CP-R-AS-TEXAS                       VALUE '4'.
  1650           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1651           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1652           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1653           88  CP-R-AS-MEAN                        VALUE '8'.
  1654           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1655           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1656           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1657           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1658           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1659           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1660         16  FILLER                PIC X(12).
  1661
  1662***************    OUTPUT FROM ELEARN   *************************
  1663
  1664         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1665                                     COMP-3.
  1666         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1667                                     COMP-3.
  1668         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1669                                     COMP-3.
  1670         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1671                                     COMP-3.
  1672         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1673                                     COMP-3.
  1674         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1675                                     COMP-3.
  1676         16  CP-EARNING-TYPE-USED  PIC X.
  1677           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1678           88  CP-E-AS-R78                         VALUE '1'.
  1679           88  CP-E-AS-PRORATA                     VALUE '2'.
  1680           88  CP-E-AS-TEXAS                       VALUE '4'.
  1681           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1682           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1683           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1684           88  CP-E-AS-MEAN                        VALUE '8'.
  1685           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1686         16  FILLER                PIC X(12).
  1687
  1688***************    OUTPUT FROM ELPMNT   *************************
  1689
  1690         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1691                                     COMP-3.
  1692         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1693                                     COMP-3.
  1694         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  33
* EL156.cbl
  1695
  1696***************   MISC WORK AREAS    *****************************
  1697         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1698                                     COMP-3.
  1699         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1700                                     COMP-3.
  1701         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1702                                     COMP-3.
  1703         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1704                                     COMP-3.
  1705         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1706                                     COMP-3.
  1707         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1708                                     COMP-3.
  1709         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1710             88  OPEN-RATE-FILE                   VALUE 'O'.
  1711             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1712             88  IO-ERROR                         VALUE 'E'.
  1713
  1714         16  CP-FIRST-PAY-DATE     PIC XX.
  1715
  1716         16  CP-JOINT-INDICATOR    PIC X.
  1717
  1718         16  CP-RESERVE-REMAINING-TERM
  1719                                   PIC S9(4)V9    VALUE ZERO
  1720                                     COMP-3.
  1721
  1722         16  CP-INSURED-BIRTH-DT   PIC XX.
  1723
  1724         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1725                                     COMP-3.
  1726
  1727         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1728                                     COMP-3.
  1729
  1730         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1731                                     COMP-3.
  1732
  1733         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1734                                     COMP-3.
  1735
  1736         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1737                                     COMP-3.
  1738
  1739         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1740                                     COMP-3.
  1741
  1742         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1743                                     COMP-3.
  1744
  1745         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1746             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1747
  1748         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1749                                     COMP-3.
  1750         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1751                                     COMP-3.
  1752         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  34
* EL156.cbl
  1753         16  cp-extra-periods      pic 9 value zeros.
  1754         16  cp-net-only-state     pic x value spaces.
  1755         16  FILLER                PIC X(13).
  1756******************************************************************
  1757*    COPY ELCICALC.
  1758******************************************************************
  1759*                                                                *
  1760*                           ELCCICALC.                           *
  1761*                            VMOD=2.001                          *
  1762*                                                                *
  1763*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1764*                 CALCULATION MODULE                             *
  1765*                                                                *
  1766*  PASSED TO ELCLMI                                              *
  1767*  -----------------                                             *
  1768*  STATE                                                         *
  1769*  PRODUCT                                                       *
  1770*  COVERAGE                                                      *
  1771*  EFFECTIVE DATE                                                *
  1772*  INCURRED DATE                                                 *
  1773*  ESTABLISHED DATE                                              *
  1774*  LAST PAID DATE                                                *
  1775*  REPORTED DATE                                                 *
  1776*  CLAIM PAYMENT AMOUNT                                          *
  1777*                                                                *
  1778*  RETURNED FROM ELRTRM                                          *
  1779*  ---------------------                                         *
  1780*  RETURN CODE                                                   *
  1781*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1782*  CLAIM INTEREST AMOUNT                                         *
  1783*----------------------------------------------------------------*
  1784*----------------------------------------------------------------*
  1785*                 LENGTH = 100                                   *
  1786*                                                                *
  1787******************************************************************
  1788******************************************************************
  1789*                   C H A N G E   L O G
  1790*
  1791* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1792*-----------------------------------------------------------------
  1793*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1794* EFFECTIVE    NUMBER
  1795*-----------------------------------------------------------------
  1796* 120905    2004040700004  PEMA  NEW COPYBOOK
  1797* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1798******************************************************************
  1799
  1800 01  CLAIM-INT-PASS-AREA.
  1801     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1802                                     COMP.
  1803
  1804     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1805       88  NO-CI-ERROR                             VALUE ZERO.
  1806       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1807       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1808       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1809       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1810       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  35
* EL156.cbl
  1811       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1812       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1813       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1814       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1815***********************  INPUT AREAS ****************************
  1816
  1817     12  CP-CALCULATION-AREA.
  1818         16  CP-COMPANY-CD         PIC X.
  1819         16  CP-STATE              PIC XX.
  1820         16  CP-PRODUCT            PIC XX.
  1821         16  CP-COVERAGE           PIC XX.
  1822         16  CP-INC-DT             PIC XX.
  1823         16  CP-EST-DT             PIC XX.
  1824         16  CP-LSTPD-DT           PIC XX.
  1825         16  CP-RPT-DT             PIC XX.
  1826         16  CP-PRF-DT             PIC XX.
  1827         16  CP-EFF-DT             PIC XX.
  1828         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1829         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1830         16  FILLER                PIC X(37).
  1831
  1832***************    OUTPUT FROM ELCLMI   ************************
  1833
  1834         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1835
  1836         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1837         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1838         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1839         16  FILLER                PIC X(19).
  1840******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  36
* EL156.cbl
  1842*    COPY ELCATTR.
  1843******************************************************************
  1844*                                                                *
  1845*                            ELCATTR.                            *
  1846*                            VMOD=2.001                          *
  1847*                                                                *
  1848*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1849*                                                                *
  1850*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1851*                                                                *
  1852*                   POS 1   P=PROTECTED                          *
  1853*                           U=UNPROTECTED                        *
  1854*                           S=ASKIP                              *
  1855*                   POS 2   A=ALPHA/NUMERIC                      *
  1856*                           N=NUMERIC                            *
  1857*                   POS 3   N=NORMAL                             *
  1858*                           B=BRIGHT                             *
  1859*                           D=DARK                               *
  1860*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1861*                           OF=MODIFIED DATA TAG OFF             *
  1862*                                                                *
  1863*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1864******************************************************************
  1865 01  ATTRIBUTE-LIST.
  1866     12  AL-PABOF            PIC X       VALUE 'Y'.
  1867     12  AL-PABON            PIC X       VALUE 'Z'.
  1868     12  AL-PADOF            PIC X       VALUE '%'.
  1869     12  AL-PADON            PIC X       VALUE '_'.
  1870     12  AL-PANOF            PIC X       VALUE '-'.
  1871     12  AL-PANON            PIC X       VALUE '/'.
  1872     12  AL-SABOF            PIC X       VALUE '8'.
  1873     12  AL-SABON            PIC X       VALUE '9'.
  1874     12  AL-SADOF            PIC X       VALUE '@'.
  1875     12  AL-SADON            PIC X       VALUE QUOTE.
  1876     12  AL-SANOF            PIC X       VALUE '0'.
  1877     12  AL-SANON            PIC X       VALUE '1'.
  1878     12  AL-UABOF            PIC X       VALUE 'H'.
  1879     12  AL-UABON            PIC X       VALUE 'I'.
  1880     12  AL-UADOF            PIC X       VALUE '<'.
  1881     12  AL-UADON            PIC X       VALUE '('.
  1882     12  AL-UANOF            PIC X       VALUE ' '.
  1883     12  AL-UANON            PIC X       VALUE 'A'.
  1884     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1885     12  AL-UNBON            PIC X       VALUE 'R'.
  1886     12  AL-UNDOF            PIC X       VALUE '*'.
  1887     12  AL-UNDON            PIC X       VALUE ')'.
  1888     12  AL-UNNOF            PIC X       VALUE '&'.
  1889     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  37
* EL156.cbl
  1891*    COPY ELCEMIB.
  1892******************************************************************
  1893*                                                                *
  1894*                                                                *
  1895*                            ELCEMIB.                            *
  1896*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1897*                            VMOD=2.005                          *
  1898*                                                                *
  1899*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1900*                                                                *
  1901******************************************************************
  1902 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1903     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1904     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1905     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1906     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1907     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1908     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1909     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1910     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1911     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1912         88  EMI-NO-ERRORS                    VALUE '1'.
  1913         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1914         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1915     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1916         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1917     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1918         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1919         88  EMI-AREA1-FULL                   VALUE '2'.
  1920     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1921         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1922         88  EMI-AREA2-FULL                   VALUE '2'.
  1923     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1924         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1925         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1926         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1927         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1928         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1929     12  EMI-ERROR-LINES.
  1930         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1931         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1932         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1933         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1934             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1935                 24  EMI-ERR-NUM         PIC X(4).
  1936                 24  EMI-FILLER          PIC X.
  1937                 24  EMI-SEV             PIC X.
  1938                 24  FILLER              PIC X.
  1939             20  FILLER                  PIC X(02).
  1940     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1941         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1942             20  EMI-ERROR-NUMBER    PIC X(4).
  1943             20  EMI-FILL            PIC X.
  1944             20  EMI-SEVERITY        PIC X.
  1945             20  FILLER              PIC X.
  1946             20  EMI-ERROR-TEXT.
  1947                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1948                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  38
* EL156.cbl
  1949     12  EMI-SEVERITY-SAVE           PIC X.
  1950         88  EMI-NOTE                    VALUE 'N'.
  1951         88  EMI-WARNING                 VALUE 'W'.
  1952         88  EMI-FORCABLE                VALUE 'F'.
  1953         88  EMI-FATAL                   VALUE 'X'.
  1954     12  EMI-MESSAGE-FLAG            PIC X.
  1955         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1956         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1957     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1958     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1959         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1960         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1961         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1962     12  emi-claim-no                pic x(7).
  1963     12  emi-claim-type              pic x(6).
  1964     12  FILLER                      PIC X(124)  VALUE SPACES.
  1965     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1966     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1967     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1968     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  39
* EL156.cbl
  1970*    COPY ELCLNKLT.
  1971******************************************************************
  1972*                                                                *
  1973*                                                                *
  1974*                           ELCLNKLT                             *
  1975*                            VMOD=2.003                          *
  1976*                                                                *
  1977*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1978*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1979*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1980*                                                                *
  1981*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1982*   COMPLETING THE REQUIRED FIELDS.                              *
  1983*                                                                *
  1984*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1985*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1986*                              9999 INDICATES AN UNKNOWN ABEND   *
  1987*                                   WAS DETECTED.                *
  1988*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1989*                              CODES FOUND IN THE ERROR FILE.    *
  1990******************************************************************
  1991 01  W-1523-LINKDATA.
  1992     12  W-1523-COMMON-PI-DATA.
  1993         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1994         16  FILLER              PIC  X(67).
  1995         16  W-1523-COMPANY-CD   PIC  X(01).
  1996         16  FILLER              PIC  X(10).
  1997         16  W-1523-CONTROL-IN-PROGRESS.
  1998             20  W-1523-CARRIER  PIC  X(01).
  1999             20  W-1523-GROUPING PIC  X(06).
  2000             20  W-1523-STATE    PIC  X(02).
  2001             20  W-1523-ACCOUNT  PIC  X(10).
  2002             20  W-1523-CLAIM-CERT-GRP.
  2003                 24  W-1523-CLAIM-NO
  2004                                 PIC  X(07).
  2005                 24  W-1523-CERT-NO.
  2006                     28  W-1523-CERT-PRIME
  2007                                 PIC  X(10).
  2008                     28  W-1523-CERT-SFX
  2009                                 PIC  X(01).
  2010                 24  W-1523-CERT-EFF-DT
  2011                                 PIC  X(02).
  2012         16  FILLER              PIC X(265).
  2013
  2014     12  W-1523-WORK-AREA.
  2015         16  W-1523-FORM-NUMBER  PIC  X(04).
  2016         16  W-1523-NUMBER-COPIES
  2017                                 PIC  9(01).
  2018         16  W-1523-ADDR-TYPE    PIC  X(02).
  2019         16  W-1523-FOLLOW-UP-DATE
  2020                                 PIC  X(02).
  2021         16  W-1523-RESEND-DATE  PIC  X(02).
  2022         16  W-1523-ERROR-CODE   PIC  9(04).
  2023             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  2024             88  W-1523-FATAL-ERROR
  2025                                    VALUES  0006 0013 0042
  2026                                            0154 0168 0169
  2027                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  40
* EL156.cbl
  2028                                            0179 0186 0281
  2029                                            0332 2055 3697
  2030                                            3698 3699 3770
  2031                                            3771 3772 7675
  2032                                            9106 9808 9883
  2033                                            9887.
  2034             88  W-1523-STOP-ERRORS
  2035                                    VALUES  0013 0042 0154
  2036                                            0168 0169 0172
  2037                                            0281 0332 2055
  2038                                            3698 3699 7675
  2039                                            9106 9808 9883
  2040                                            9999.
  2041         16  W-1523-REASON       PIC  X(70).
  2042         16  W-1523-ARCHIVE-NUMBER
  2043                                 PIC  9(08).
  2044     12  W-1523-POINTER-AREA.
  2045         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2046         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2047         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2048         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2049         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  41
* EL156.cbl
  2051*    COPY ELCNWA.
  2052*****************************************************************
  2053*                                                               *
  2054*                                                               *
  2055*                            ELCNWA.                            *
  2056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2057*                            VMOD=2.003                         *
  2058*                                                               *
  2059*            M O V E   N A M E   W O R K   A R E A.             *
  2060*                                                               *
  2061*****************************************************************.
  2062
  2063 01  WS-NAME-WORK-AREA.
  2064     05  WS-INSURED-LAST-NAME        PIC X(15).
  2065     05  WS-INSURED-1ST-NAME         PIC X(12).
  2066     05  WS-INSURED-MID-INIT         PIC X.
  2067
  2068     05  WS-NAME-WORK.
  2069         10  WS-NW                   PIC X
  2070             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2071
  2072     05  WS-NAME-WORK2.
  2073         10  WS-NW2                  PIC X
  2074             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2075                                        NWA-INDEX0.
  2076
  2077     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2078                                     COMP-3.
  2079
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  42
* EL156.cbl
  2081*    COPY ELCDMO.
  2082******************************************************************
  2083*                                                                *
  2084*                                                                *
  2085*                            ELCDMO.                             *
  2086*                            VMOD=2.004                          *
  2087*                                                                *
  2088*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2089*        COMMUNICATION AREA                                      *
  2090*   FILE TYPE = NA                                               *
  2091*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2092*                                                                *
  2093******************************************************************
  2094 01  DMO-COMMUNICATION-AREA.
  2095     12  DM-RECORD-TYPE                  PIC  X(02).
  2096             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2097             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2098             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2099     12  DM-DIST-CODE                    PIC  X(04).
  2100     12  DM-MAIL-CODE                    PIC  X(05).
  2101     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2102     12  DM-INSURED-NAME                 PIC  X(30).
  2103     12  DM-CLAIM-NO                     PIC  X(07).
  2104     12  DM-CLAIM-TYPE                   PIC  X.
  2105
  2106     12  DM-STATUS-DATA-AREA.
  2107         16  DM-CLAIM-STATUS             PIC  X.
  2108             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2109             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2110             88  DM-CLOSED                        VALUE '3'.
  2111             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2112             88  DM-DEFAULT                       VALUE '9'.
  2113         16  DM-STATUS-DATE              PIC  X(08).
  2114******YYYYMMDD
  2115         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2116             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2117             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2118             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2119             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2120             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2121             88  DM-RE-OPENED                     VALUE 'R'.
  2122             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2123             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2124             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2125         16  DM-STAT-CARRIER             PIC X.
  2126
  2127     12  DM-DRAFT-DATA-AREA.
  2128         16  DM-PAYMENT-TYPE             PIC  X.
  2129             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2130         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2131         16  DM-PAYMENT-DATE             PIC  X(08).
  2132******YYYYMMDD
  2133         16  DM-CERT-NO                  PIC  X(11).
  2134         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2135         16  DM-CARRIER                  PIC  X.
  2136
  2137     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  43
* EL156.cbl
  2139*    COPY ELCDMDCD.
  2140******************************************************************
  2141*                                                                *
  2142*                                                                *
  2143*                            ELCDMDCD.                           *
  2144*                            VMOD=2.001                          *
  2145*                                                                *
  2146*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2147*       COMMUNICATIONS AREA                                      *
  2148*                                                                *
  2149******************************************************************
  2150 01  CD-COMMUNICATION-AREA.
  2151     12  CD-SYSTEM-ID            PIC  X(02).
  2152         88 CD-CLAIMS                      VALUE 'CL'.
  2153         88 CD-CREDIT                      VALUE 'CR'.
  2154     12  CD-RECORD-TYPE          PIC  X(02).
  2155         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2156         88 CD-EOB-CODE                    VALUE 'EO'.
  2157         88 CD-ICD9-CODE                   VALUE 'I9'.
  2158         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2159         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2160         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2161         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2162         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2163     12  CD-RECORD-KEY           PIC  X(06).
  2164         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2165     12  CD-RETURN-CODE          PIC  X(02).
  2166     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2167     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2168     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2169     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  44
* EL156.cbl
  2171*    COPY ELCDCTB.
  2172******************************************************************
  2173*                                                                *
  2174*                                                                *
  2175*                            ELCDCTB.                            *
  2176*                            VMOD=2.002                          *
  2177*                                                                *
  2178*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2179*       COMMUNICATIONS AREA                                      *
  2180*                                                                *
  2181******************************************************************
  2182 01  DCT-COMMUNICATION-AREA.
  2183     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2184     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2185     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2186     12  DCT-PRODUCT-CODE         PIC  X(02).
  2187     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2188     12  DCT-RETURN-CODE          PIC  X(02).
  2189     12  DCT-MAIL-CODE            PIC  X(05).
  2190     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2191     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  45
* EL156.cbl
  2193 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2194 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2195 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2196 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  46
* EL156.cbl
  2198*    COPY ELCINTF.
  2199******************************************************************
  2200*                                                                *
  2201*                                                                *
  2202*                            ELCINTF.                            *
  2203*                            VMOD=2.017                          *
  2204*                                                                *
  2205*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2206*                                                                *
  2207*       LENGTH = 1024                                            *
  2208*                                                                *
  2209******************************************************************
  2210*                   C H A N G E   L O G
  2211*
  2212* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2213*-----------------------------------------------------------------
  2214*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2215* EFFECTIVE    NUMBER
  2216*-----------------------------------------------------------------
  2217* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2218******************************************************************
  2219 01  PROGRAM-INTERFACE-BLOCK.
  2220     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2221     12  PI-CALLING-PROGRAM              PIC X(8).
  2222     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2223     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2224     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2225     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2226     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2227     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2228     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2229     12  PI-COMPANY-ID                   PIC XXX.
  2230     12  PI-COMPANY-CD                   PIC X.
  2231
  2232     12  PI-COMPANY-PASSWORD             PIC X(8).
  2233
  2234     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2235
  2236     12  PI-CONTROL-IN-PROGRESS.
  2237         16  PI-CARRIER                  PIC X.
  2238         16  PI-GROUPING                 PIC X(6).
  2239         16  PI-STATE                    PIC XX.
  2240         16  PI-ACCOUNT                  PIC X(10).
  2241         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2242                                         PIC X(10).
  2243         16  PI-CLAIM-CERT-GRP.
  2244             20  PI-CLAIM-NO             PIC X(7).
  2245             20  PI-CERT-NO.
  2246                 25  PI-CERT-PRIME       PIC X(10).
  2247                 25  PI-CERT-SFX         PIC X.
  2248             20  PI-CERT-EFF-DT          PIC XX.
  2249         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2250             20  PI-PLAN-CODE            PIC X(2).
  2251             20  PI-REVISION-NUMBER      PIC X(3).
  2252             20  PI-PLAN-EFF-DT          PIC X(2).
  2253             20  PI-PLAN-EXP-DT          PIC X(2).
  2254             20  FILLER                  PIC X(11).
  2255         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  47
* EL156.cbl
  2256             20  PI-OE-REFERENCE-1.
  2257                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2258                 25  PI-OE-REF-1-SUFF    PIC XX.
  2259
  2260     12  PI-SESSION-IN-PROGRESS          PIC X.
  2261         88  CLAIM-SESSION                   VALUE '1'.
  2262         88  CREDIT-SESSION                  VALUE '2'.
  2263         88  WARRANTY-SESSION                VALUE '3'.
  2264         88  MORTGAGE-SESSION                VALUE '4'.
  2265         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2266
  2267
  2268*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2269
  2270     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2271     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2272
  2273     12  PI-CREDIT-USER                  PIC X.
  2274         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2275         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2276
  2277     12  PI-CLAIM-USER                   PIC X.
  2278         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2279         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2280
  2281     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2282         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2283         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2284         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2285         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2286         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2287
  2288     12  PI-PROCESSOR-ID                 PIC X(4).
  2289
  2290     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2291
  2292     12  PI-MEMBER-CAPTION               PIC X(10).
  2293
  2294     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2295         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2296
  2297     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2298     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2299     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2300     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2301
  2302     12  PI-AH-OVERRIDE-L1               PIC X.
  2303     12  PI-AH-OVERRIDE-L2               PIC XX.
  2304     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2305     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2306
  2307     12  PI-NEW-SYSTEM                   PIC X(2).
  2308
  2309     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2310     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2311         88  PI-USES-PAID-TO                 VALUE '1'.
  2312     12  PI-CRDTCRD-SYSTEM.
  2313         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  48
* EL156.cbl
  2314             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2315             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2316         16  PI-CC-MONTH-END-DT          PIC XX.
  2317     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2318
  2319     12  PI-OE-REFERENCE-2.
  2320         16  PI-OE-REF-2-PRIME           PIC X(10).
  2321         16  PI-OE-REF-2-SUFF            PIC X.
  2322
  2323     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2324
  2325     12  PI-LANGUAGE-TYPE                PIC X.
  2326             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2327             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2328             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2329
  2330     12  PI-POLICY-LINKAGE-IND           PIC X.
  2331         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2332         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2333                                                   LOW-VALUES.
  2334
  2335     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2336     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2337         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2338         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2339
  2340     12  PI-PROCESSOR-CSR-IND            PIC X.
  2341         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2342         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2343
  2344     12  FILLER                          PIC X(3).
  2345
  2346     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2347
  2348     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2349         PI-SYSTEM-LEVEL.
  2350
  2351         16  PI-ENTRY-CODES.
  2352             20  PI-ENTRY-CD-1           PIC X.
  2353             20  PI-ENTRY-CD-2           PIC X.
  2354
  2355         16  PI-RETURN-CODES.
  2356             20  PI-RETURN-CD-1          PIC X.
  2357             20  PI-RETURN-CD-2          PIC X.
  2358
  2359         16  PI-UPDATE-STATUS-SAVE.
  2360             20  PI-UPDATE-BY            PIC X(4).
  2361             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2362
  2363         16  PI-LOWER-CASE-LETTERS       PIC X.
  2364             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2365
  2366*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2367*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2368*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2369
  2370         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2371             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  49
* EL156.cbl
  2372             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2373             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2374             88  ACCNT-CNTL                  VALUE '3'.
  2375             88  CARR-ACCNT-CNTL             VALUE '4'.
  2376
  2377         16  PI-PROCESSOR-CAP-LIST.
  2378             20  PI-SYSTEM-CONTROLS.
  2379                24 PI-SYSTEM-DISPLAY     PIC X.
  2380                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2381                24 PI-SYSTEM-MODIFY      PIC X.
  2382                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2383             20  FILLER                  PIC XX.
  2384             20  PI-DISPLAY-CAP          PIC X.
  2385                 88  DISPLAY-CAP             VALUE 'Y'.
  2386             20  PI-MODIFY-CAP           PIC X.
  2387                 88  MODIFY-CAP              VALUE 'Y'.
  2388             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2389                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2390             20  PI-FORCE-CAP            PIC X.
  2391                 88  FORCE-CAP               VALUE 'Y'.
  2392
  2393         16  PI-PROGRAM-CONTROLS.
  2394             20  PI-PGM-PRINT-OPT        PIC X.
  2395             20  PI-PGM-FORMAT-OPT       PIC X.
  2396             20  PI-PGM-PROCESS-OPT      PIC X.
  2397             20  PI-PGM-TOTALS-OPT       PIC X.
  2398
  2399         16  PI-HELP-INTERFACE.
  2400             20  PI-LAST-ERROR-NO        PIC X(4).
  2401             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2402
  2403         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2404             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2405
  2406         16  PI-CR-CONTROL-IN-PROGRESS.
  2407             20  PI-CR-CARRIER           PIC X.
  2408             20  PI-CR-GROUPING          PIC X(6).
  2409             20  PI-CR-STATE             PIC XX.
  2410             20  PI-CR-ACCOUNT           PIC X(10).
  2411             20  PI-CR-FIN-RESP          PIC X(10).
  2412             20  PI-CR-TYPE              PIC X.
  2413
  2414         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2415
  2416         16  PI-CR-MONTH-END-DT          PIC XX.
  2417
  2418         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2419             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2420             88  PI-ZERO-CARRIER             VALUE '1'.
  2421             88  PI-ZERO-GROUPING            VALUE '2'.
  2422             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2423
  2424         16  PI-CARRIER-SECURITY         PIC X.
  2425             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2426
  2427         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2428             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2429             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  50
* EL156.cbl
  2430
  2431         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2432             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2433                                         INDEXED BY PI-ACCESS-NDX
  2434                                         PIC X.
  2435
  2436         16  PI-GA-BILLING-CONTROL       PIC X.
  2437             88  PI-GA-BILLING               VALUE '1'.
  2438
  2439         16  PI-MAIL-PROCESSING          PIC X.
  2440             88  PI-MAIL-YES                 VALUE 'Y'.
  2441
  2442         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2443
  2444         16  PI-AR-SYSTEM.
  2445             20  PI-AR-PROCESSING-CNTL   PIC X.
  2446                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2447             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2448             20  PI-AR-MONTH-END-DT      PIC XX.
  2449
  2450         16  PI-MP-SYSTEM.
  2451             20  PI-MORTGAGE-USER            PIC X.
  2452                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2453                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2454             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2455                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2456                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2457                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2458                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2459                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2460             20  PI-MP-MONTH-END-DT          PIC XX.
  2461             20  PI-MP-REFERENCE-NO.
  2462                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2463                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2464
  2465         16  PI-LABEL-CONTROL            PIC X(01).
  2466             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2467             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2468
  2469         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2470             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2471
  2472         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2473             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2474             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2475
  2476         16  FILLER                      PIC X(14).
  2477
  2478     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2479******************************************************************
  2480     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2481         16  PI-SAVE-FORM        PIC X(12).
  2482         16  PI-ACCT-KEY         PIC X(26).
  2483         16  PI-PAYEE-NAME       PIC X(30).
  2484         16  PI-DAILY-RATE       PIC S9(3)V99.
  2485         16  PI-MONTH-END-SAVE   PIC XX.
  2486         16  PI-BENEFIT-SAVE.
  2487             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  51
* EL156.cbl
  2488             20  PI-BEN-TYPE     PIC X.
  2489         16  PI-MANUAL-SW        PIC 9.
  2490         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2491         16  PI-PASS-SW          PIC X.
  2492         16  PI-PFKEY-USED       PIC X.
  2493         16  PI-CK-ASSIGN        PIC X.
  2494         16  PI-FATAL-COUNT      PIC 99.
  2495         16  PI-FORCE-COUNT      PIC 99.
  2496         16  PI-SAVE-INPUT.
  2497             20  PI-PMTTYPE      PIC X.
  2498             20  PI-PAYEE.
  2499                 24  PI-PAYEE-TYPE PIC X.
  2500                 24  PI-PAYEE-SEQ  PIC X.
  2501                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2502                   PI-PAYEE-SEQ    PIC S9.
  2503             20  PI-PMTNOTE1     PIC X(60).
  2504             20  PI-PMTNOTE2     PIC X(60).
  2505             20  PI-OFFLINE      PIC X.
  2506             20  PI-ECHECKNO     PIC X(7).
  2507             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2508                 28  PI-ECHECKNO-N     PIC X.
  2509                 28  PI-ECHECKNO-6     PIC X(6).
  2510             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2511                 24  PI-ECHECKNO-CR    PIC XX.
  2512                 24  PI-ECHECKNO-5     PIC X(5).
  2513             20  PI-HOLDTIL      PIC 9(6).
  2514             20  PI-EPYFROM      PIC 9(6).
  2515             20  PI-EPYTHRU      PIC 9(6).
  2516             20  PI-EDAYS        PIC S9(5).
  2517             20  PI-EPYAMT       PIC S9(7)V99.
  2518             20  PI-ERESV        PIC S9(7)V99.
  2519             20  PI-EEXPENS      PIC 9(6)V99.
  2520             20  PI-ETYPE        PIC X.
  2521             20  PI-CASH         PIC X.
  2522             20  PI-GROUPED      PIC X.
  2523             20  PI-INT-RATE     PIC S99V9(5).
  2524             20  PI-AIGFROM      PIC 9(6).
  2525             20  PI-LOAN-NO      PIC X(20).
  2526             20  PI-PROOF-DATE   PIC 9(6).
  2527             20  PI-PRINT-EOB-YN PIC X.
  2528             20  PI-PRINT-CLM-FRM-YN PIC X.
  2529             20  PI-PRINT-SURVEY-YN PIC X.
  2530             20  PI-SPECIAL-RELEASE-YN PIC X.
  2531             20  pi-int-to-rem-borr pic x.
  2532         16  PI-SAVE-COMPUTED.
  2533             20  PI-CCHECKNO     PIC X(7).
  2534             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2535                 28  PI-CCHECKNO-N     PIC X.
  2536                 28  PI-CCHECKNO-6     PIC X(6).
  2537             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2538                 24  PI-CCHECKNO-CR    PIC XX.
  2539                 24  PI-CCHECKNO-5     PIC X(5).
  2540             20  PI-CPYFROM      PIC XX.
  2541             20  PI-CPYTHRU      PIC XX.
  2542             20  PI-CDAYS        PIC S9(5).
  2543             20  PI-CPYAMT       PIC S9(7)V99.
  2544             20  PI-CRESV        PIC 9(6)V99.
  2545             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  52
* EL156.cbl
  2546             20  PI-PMT-APPR-SW  PIC X.
  2547                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2548                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2549                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2550         16  PI-PREV-CLMNO       PIC X(7).
  2551         16  PI-LF-COVERAGE-TYPE PIC X.
  2552         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2553         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2554         16  PI-PROVISIONAL-IND  PIC X.
  2555             88 PI-PROV-PMT      VALUE 'P'.
  2556         16  PI-PREV-TRLR-KEY    PIC X(22).
  2557         16  PI-SPLIT-PMT-SW     PIC X.
  2558         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2559         16  PI-ACTIVITY-CODE    PIC 99.
  2560         16  PI-RESET-SW         PIC X.
  2561         16  PI-SPECIAL-BEN-SW   PIC X.
  2562             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2563         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2564         16  PI-EXP-DT           PIC XX.
  2565         16  PI-LOAN-DUE-DAY     PIC 99.
  2566         16  PI-3RD-PARTY-SW     PIC X.
  2567         16  PI-LOAN-UPDATE-SW   PIC X.
  2568
  2569         16  PI-DMD-DATA.
  2570             20  PI-SV-CERT-KEY       PIC X(21).
  2571             20  PI-SV-CERT-NO        PIC X(11).
  2572             20  PI-SV-BEN            PIC X(10).
  2573             20  PI-SV-CCN            PIC X(16).
  2574             20  PI-INTEREST-PAID-IND PIC X.
  2575                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2576             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2577             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2578             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2579             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2580         16  PI-AT-EOB-CODES.
  2581             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2582         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2583         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2584         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2585         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2586         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2587         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2588         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2589         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2590         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2591         16  PI-LF-BENEFIT-CD         PIC X(2).
  2592         16  PI-EOB-CODES-EXIST PIC X.
  2593         16  PI-SET-NOTE2-MDT   PIC X.
  2594         16  PI-VFY-2ND-BENE          PIC X.
  2595         16  PI-CLM-TYPE              PIC X.
  2596         16  PI-APPROVAL-LEVEL        PIC X.
  2597         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2598         16  PI-REAUDIT-NEEDED        PIC X.
  2599         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2600         16  PI-AH-BENEFIT-CD         PIC XX.
  2601         16  pi-ah-term               pic s999 comp-3.
  2602         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2603         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  53
* EL156.cbl
  2604         16  pi-max-ext-used          pic x.
  2605         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2606         16  PI-JOINT-COV-IND         PIC X.
  2607             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2608             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2609         16  PI-JOINT-INSURED-IND     PIC X.
  2610             88  PI-JOINT-INSURED        VALUE 'Y'.
  2611             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2612         16  pi-int-payees-name       pic x(30).
  2613         16  PI-RB-JOINT-COV-IND      PIC X.
  2614             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2615             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2616         16  pi-ach-payment           pic x.
  2617         16  PI-DUPE-APPROVAL-NEEDED  PIC X.
  2618*00781          16  FILLER                   PIC X(176).
  2619*052506         16  FILLER                   PIC X(161).
  2620*031808         16  FILLER                   PIC X(154).
  2621*091808         16  FILLER                   PIC X(152).
  2622*041710         16  FILLER                   PIC X(94).
  2623         16  FILLER                   PIC X(33).
  2624
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  54
* EL156.cbl
  2626*    COPY ELCJPFX.
  2627******************************************************************
  2628*                                                                *
  2629*                                                                *
  2630*                            ELCJPFX.                            *
  2631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2632*                            VMOD=2.002                          *
  2633*                                                                *
  2634*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2635*                                                                *
  2636*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2637*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2638*        ELCNTL - CONTROL FILE                                   *
  2639*        ELMSTR - CLAIM MASTERS                                  *
  2640*        ELTRLR - ACTIVITY TRAILERS                              *
  2641*        ELCHKQ - CHECK QUE                                      *
  2642******************************************************************
  2643 01  JOURNAL-RECORD.
  2644     12  jp-date                     pic s9(5) comp-3.
  2645     12  jp-time                     pic s9(7) comp-3.
  2646     12  JP-USER-ID                  PIC X(4).
  2647     12  JP-FILE-ID                  PIC X(8).
  2648     12  JP-PROGRAM-ID               PIC X(8).
  2649     12  JP-RECORD-TYPE              PIC X.
  2650         88 JP-ADD              VALUE 'A'.
  2651         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2652         88 JP-AFTER-CHANGE     VALUE 'C'.
  2653         88 JP-DELETE           VALUE 'D'.
  2654         88 JP-GENERIC-DELETE   VALUE 'G'.
  2655         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2656         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2657     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2658     12  JP-RECORD-AREA
  2659
  2660
  2661                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  55
* EL156.cbl
  2663*    COPY ELCAID.
  2664******************************************************************
  2665*                                                                *
  2666*                            ELCAID.                             *
  2667*                            VMOD=2.001                          *
  2668*                                                                *
  2669*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2670*                                                                *
  2671*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2672*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2673******************************************************************
  2674
  2675 01  DFHAID.
  2676   02  DFHNULL   PIC  X  VALUE  ' '.
  2677   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2678   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2679   02  DFHPEN    PIC  X  VALUE  '='.
  2680   02  DFHOPID   PIC  X  VALUE  'W'.
  2681   02  DFHPA1    PIC  X  VALUE  '%'.
  2682   02  DFHPA2    PIC  X  VALUE  '>'.
  2683   02  DFHPA3    PIC  X  VALUE  ','.
  2684   02  DFHPF1    PIC  X  VALUE  '1'.
  2685   02  DFHPF2    PIC  X  VALUE  '2'.
  2686   02  DFHPF3    PIC  X  VALUE  '3'.
  2687   02  DFHPF4    PIC  X  VALUE  '4'.
  2688   02  DFHPF5    PIC  X  VALUE  '5'.
  2689   02  DFHPF6    PIC  X  VALUE  '6'.
  2690   02  DFHPF7    PIC  X  VALUE  '7'.
  2691   02  DFHPF8    PIC  X  VALUE  '8'.
  2692   02  DFHPF9    PIC  X  VALUE  '9'.
  2693   02  DFHPF10   PIC  X  VALUE  ':'.
  2694   02  DFHPF11   PIC  X  VALUE  '#'.
  2695   02  DFHPF12   PIC  X  VALUE  '@'.
  2696   02  DFHPF13   PIC  X  VALUE  'A'.
  2697   02  DFHPF14   PIC  X  VALUE  'B'.
  2698   02  DFHPF15   PIC  X  VALUE  'C'.
  2699   02  DFHPF16   PIC  X  VALUE  'D'.
  2700   02  DFHPF17   PIC  X  VALUE  'E'.
  2701   02  DFHPF18   PIC  X  VALUE  'F'.
  2702   02  DFHPF19   PIC  X  VALUE  'G'.
  2703   02  DFHPF20   PIC  X  VALUE  'H'.
  2704   02  DFHPF21   PIC  X  VALUE  'I'.
  2705*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2706   02  DFHPF22   PIC  X  VALUE  '['.
  2707   02  DFHPF23   PIC  X  VALUE  '.'.
  2708   02  DFHPF24   PIC  X  VALUE  '<'.
  2709   02  DFHMSRE   PIC  X  VALUE  'X'.
  2710   02  DFHSTRF   PIC  X  VALUE  'h'.
  2711   02  DFHTRIG   PIC  X  VALUE  '"'.
  2712 01  FILLER    REDEFINES DFHAID.
  2713     12  FILLER              PIC X(8).
  2714     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  56
* EL156.cbl
  2716*    COPY EL156S.
  2717 01  EL156AI.
  2718     05  FILLER            PIC  X(0012).
  2719*    -------------------------------
  2720     05  RUNDTEAL PIC S9(0004) COMP.
  2721     05  RUNDTEAF PIC  X(0001).
  2722     05  FILLER REDEFINES RUNDTEAF.
  2723         10  RUNDTEAA PIC  X(0001).
  2724     05  RUNDTEAI PIC  X(0008).
  2725*    -------------------------------
  2726     05  RUNTIMAL PIC S9(0004) COMP.
  2727     05  RUNTIMAF PIC  X(0001).
  2728     05  FILLER REDEFINES RUNTIMAF.
  2729         10  RUNTIMAA PIC  X(0001).
  2730     05  RUNTIMAI PIC  X(0005).
  2731*    -------------------------------
  2732     05  SEQUL PIC S9(0004) COMP.
  2733     05  SEQUF PIC  X(0001).
  2734     05  FILLER REDEFINES SEQUF.
  2735         10  SEQUA PIC  X(0001).
  2736     05  SEQUI PIC  X(0010).
  2737*    -------------------------------
  2738     05  CLMNOL PIC S9(0004) COMP.
  2739     05  CLMNOF PIC  X(0001).
  2740     05  FILLER REDEFINES CLMNOF.
  2741         10  CLMNOA PIC  X(0001).
  2742     05  CLMNOI PIC  X(0007).
  2743*    -------------------------------
  2744     05  CARRL PIC S9(0004) COMP.
  2745     05  CARRF PIC  X(0001).
  2746     05  FILLER REDEFINES CARRF.
  2747         10  CARRA PIC  X(0001).
  2748     05  CARRI PIC  X(0001).
  2749*    -------------------------------
  2750     05  CERTNOL PIC S9(0004) COMP.
  2751     05  CERTNOF PIC  X(0001).
  2752     05  FILLER REDEFINES CERTNOF.
  2753         10  CERTNOA PIC  X(0001).
  2754     05  CERTNOI PIC  X(0010).
  2755*    -------------------------------
  2756     05  SUFXL PIC S9(0004) COMP.
  2757     05  SUFXF PIC  X(0001).
  2758     05  FILLER REDEFINES SUFXF.
  2759         10  SUFXA PIC  X(0001).
  2760     05  SUFXI PIC  X(0001).
  2761*    -------------------------------
  2762     05  CLMTYPL PIC S9(0004) COMP.
  2763     05  CLMTYPF PIC  X(0001).
  2764     05  FILLER REDEFINES CLMTYPF.
  2765         10  CLMTYPA PIC  X(0001).
  2766     05  CLMTYPI PIC  X(0006).
  2767*    -------------------------------
  2768     05  CLMSTATL PIC S9(0004) COMP.
  2769     05  CLMSTATF PIC  X(0001).
  2770     05  FILLER REDEFINES CLMSTATF.
  2771         10  CLMSTATA PIC  X(0001).
  2772     05  CLMSTATI PIC  X(0006).
  2773*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  57
* EL156.cbl
  2774     05  LSTNMEL PIC S9(0004) COMP.
  2775     05  LSTNMEF PIC  X(0001).
  2776     05  FILLER REDEFINES LSTNMEF.
  2777         10  LSTNMEA PIC  X(0001).
  2778     05  LSTNMEI PIC  X(0015).
  2779*    -------------------------------
  2780     05  FSTNMEL PIC S9(0004) COMP.
  2781     05  FSTNMEF PIC  X(0001).
  2782     05  FILLER REDEFINES FSTNMEF.
  2783         10  FSTNMEA PIC  X(0001).
  2784     05  FSTNMEI PIC  X(0012).
  2785*    -------------------------------
  2786     05  MINITL PIC S9(0004) COMP.
  2787     05  MINITF PIC  X(0001).
  2788     05  FILLER REDEFINES MINITF.
  2789         10  MINITA PIC  X(0001).
  2790     05  MINITI PIC  X(0001).
  2791*    -------------------------------
  2792     05  PRIMHDGL PIC S9(0004) COMP.
  2793     05  PRIMHDGF PIC  X(0001).
  2794     05  FILLER REDEFINES PRIMHDGF.
  2795         10  PRIMHDGA PIC  X(0001).
  2796     05  PRIMHDGI PIC  X(0012).
  2797*    -------------------------------
  2798     05  PCERTNOL PIC S9(0004) COMP.
  2799     05  PCERTNOF PIC  X(0001).
  2800     05  FILLER REDEFINES PCERTNOF.
  2801         10  PCERTNOA PIC  X(0001).
  2802     05  PCERTNOI PIC  X(0010).
  2803*    -------------------------------
  2804     05  PSUFXL PIC S9(0004) COMP.
  2805     05  PSUFXF PIC  X(0001).
  2806     05  FILLER REDEFINES PSUFXF.
  2807         10  PSUFXA PIC  X(0001).
  2808     05  PSUFXI PIC  X(0001).
  2809*    -------------------------------
  2810     05  STATUSL PIC S9(0004) COMP.
  2811     05  STATUSF PIC  X(0001).
  2812     05  FILLER REDEFINES STATUSF.
  2813         10  STATUSA PIC  X(0001).
  2814     05  STATUSI PIC  X(0010).
  2815*    -------------------------------
  2816     05  LOANHL PIC S9(0004) COMP.
  2817     05  LOANHF PIC  X(0001).
  2818     05  FILLER REDEFINES LOANHF.
  2819         10  LOANHA PIC  X(0001).
  2820     05  LOANHI PIC  X(0014).
  2821*    -------------------------------
  2822     05  LOANNOL PIC S9(0004) COMP.
  2823     05  LOANNOF PIC  X(0001).
  2824     05  FILLER REDEFINES LOANNOF.
  2825         10  LOANNOA PIC  X(0001).
  2826     05  LOANNOI PIC  X(0025).
  2827*    -------------------------------
  2828     05  DUEDAYHL PIC S9(0004) COMP.
  2829     05  DUEDAYHF PIC  X(0001).
  2830     05  FILLER REDEFINES DUEDAYHF.
  2831         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  58
* EL156.cbl
  2832     05  DUEDAYHI PIC  X(0008).
  2833*    -------------------------------
  2834     05  DUEDAYL PIC S9(0004) COMP.
  2835     05  DUEDAYF PIC  X(0001).
  2836     05  FILLER REDEFINES DUEDAYF.
  2837         10  DUEDAYA PIC  X(0001).
  2838     05  DUEDAYI PIC  X(0002).
  2839*    -------------------------------
  2840     05  ZINTHL PIC S9(0004) COMP.
  2841     05  ZINTHF PIC  X(0001).
  2842     05  FILLER REDEFINES ZINTHF.
  2843         10  ZINTHA PIC  X(0001).
  2844     05  ZINTHI PIC  X(0009).
  2845*    -------------------------------
  2846     05  ZINTL PIC S9(0004) COMP.
  2847     05  ZINTF PIC  X(0001).
  2848     05  FILLER REDEFINES ZINTF.
  2849         10  ZINTA PIC  X(0001).
  2850     05  ZINTI PIC  99V99999.
  2851*    -------------------------------
  2852     05  PTHRHDGL PIC S9(0004) COMP.
  2853     05  PTHRHDGF PIC  X(0001).
  2854     05  FILLER REDEFINES PTHRHDGF.
  2855         10  PTHRHDGA PIC  X(0001).
  2856     05  PTHRHDGI PIC  X(0014).
  2857*    -------------------------------
  2858     05  PDTHRUL PIC S9(0004) COMP.
  2859     05  PDTHRUF PIC  X(0001).
  2860     05  FILLER REDEFINES PDTHRUF.
  2861         10  PDTHRUA PIC  X(0001).
  2862     05  PDTHRUI PIC  X(0008).
  2863*    -------------------------------
  2864     05  TOTPAIDL PIC S9(0004) COMP.
  2865     05  TOTPAIDF PIC  X(0001).
  2866     05  FILLER REDEFINES TOTPAIDF.
  2867         10  TOTPAIDA PIC  X(0001).
  2868     05  TOTPAIDI PIC  X(0010).
  2869*    -------------------------------
  2870     05  COVERL PIC S9(0004) COMP.
  2871     05  COVERF PIC  X(0001).
  2872     05  FILLER REDEFINES COVERF.
  2873         10  COVERA PIC  X(0001).
  2874     05  COVERI PIC  X(0010).
  2875*    -------------------------------
  2876     05  INCURL PIC S9(0004) COMP.
  2877     05  INCURF PIC  X(0001).
  2878     05  FILLER REDEFINES INCURF.
  2879         10  INCURA PIC  X(0001).
  2880     05  INCURI PIC  X(0008).
  2881*    -------------------------------
  2882     05  LSTDTEL PIC S9(0004) COMP.
  2883     05  LSTDTEF PIC  X(0001).
  2884     05  FILLER REDEFINES LSTDTEF.
  2885         10  LSTDTEA PIC  X(0001).
  2886     05  LSTDTEI PIC  X(0008).
  2887*    -------------------------------
  2888     05  CRTSTATL PIC S9(0004) COMP.
  2889     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  59
* EL156.cbl
  2890     05  FILLER REDEFINES CRTSTATF.
  2891         10  CRTSTATA PIC  X(0001).
  2892     05  CRTSTATI PIC  X(0010).
  2893*    -------------------------------
  2894     05  EFFECTL PIC S9(0004) COMP.
  2895     05  EFFECTF PIC  X(0001).
  2896     05  FILLER REDEFINES EFFECTF.
  2897         10  EFFECTA PIC  X(0001).
  2898     05  EFFECTI PIC  X(0008).
  2899*    -------------------------------
  2900     05  TERMSL PIC S9(0004) COMP.
  2901     05  TERMSF PIC  X(0001).
  2902     05  FILLER REDEFINES TERMSF.
  2903         10  TERMSA PIC  X(0001).
  2904     05  TERMSI PIC  X(0011).
  2905*    -------------------------------
  2906     05  STACCTL PIC S9(0004) COMP.
  2907     05  STACCTF PIC  X(0001).
  2908     05  FILLER REDEFINES STACCTF.
  2909         10  STACCTA PIC  X(0001).
  2910     05  STACCTI PIC  X(0013).
  2911*    -------------------------------
  2912     05  EXPDTEHL PIC S9(0004) COMP.
  2913     05  EXPDTEHF PIC  X(0001).
  2914     05  FILLER REDEFINES EXPDTEHF.
  2915         10  EXPDTEHA PIC  X(0001).
  2916     05  EXPDTEHI PIC  X(0014).
  2917*    -------------------------------
  2918     05  EXPDTEL PIC S9(0004) COMP.
  2919     05  EXPDTEF PIC  X(0001).
  2920     05  FILLER REDEFINES EXPDTEF.
  2921         10  EXPDTEA PIC  X(0001).
  2922     05  EXPDTEI PIC  X(0008).
  2923*    -------------------------------
  2924     05  BENECAPL PIC S9(0004) COMP.
  2925     05  BENECAPF PIC  X(0001).
  2926     05  FILLER REDEFINES BENECAPF.
  2927         10  BENECAPA PIC  X(0001).
  2928     05  BENECAPI PIC  X(0013).
  2929*    -------------------------------
  2930     05  BENEL PIC S9(0004) COMP.
  2931     05  BENEF PIC  X(0001).
  2932     05  FILLER REDEFINES BENEF.
  2933         10  BENEA PIC  X(0001).
  2934     05  BENEI PIC  X(0009).
  2935*    -------------------------------
  2936     05  FORMTYPL PIC S9(0004) COMP.
  2937     05  FORMTYPF PIC  X(0001).
  2938     05  FILLER REDEFINES FORMTYPF.
  2939         10  FORMTYPA PIC  X(0001).
  2940     05  FORMTYPI PIC  X(0001).
  2941*    -------------------------------
  2942     05  PMTTYPEL PIC S9(0004) COMP.
  2943     05  PMTTYPEF PIC  X(0001).
  2944     05  FILLER REDEFINES PMTTYPEF.
  2945         10  PMTTYPEA PIC  X(0001).
  2946     05  PMTTYPEI PIC  X(0001).
  2947*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  60
* EL156.cbl
  2948     05  PAYEEL PIC S9(0004) COMP.
  2949     05  PAYEEF PIC  X(0001).
  2950     05  FILLER REDEFINES PAYEEF.
  2951         10  PAYEEA PIC  X(0001).
  2952     05  PAYEEI PIC  X(0002).
  2953*    -------------------------------
  2954     05  CHECKNOL PIC S9(0004) COMP.
  2955     05  CHECKNOF PIC  X(0001).
  2956     05  FILLER REDEFINES CHECKNOF.
  2957         10  CHECKNOA PIC  X(0001).
  2958     05  CHECKNOI PIC  X(0007).
  2959*    -------------------------------
  2960     05  OFFLINEL PIC S9(0004) COMP.
  2961     05  OFFLINEF PIC  X(0001).
  2962     05  FILLER REDEFINES OFFLINEF.
  2963         10  OFFLINEA PIC  X(0001).
  2964     05  OFFLINEI PIC  X(0001).
  2965*    -------------------------------
  2966     05  HOLDTILL PIC S9(0004) COMP.
  2967     05  HOLDTILF PIC  X(0001).
  2968     05  FILLER REDEFINES HOLDTILF.
  2969         10  HOLDTILA PIC  X(0001).
  2970     05  HOLDTILI PIC  X(0008).
  2971*    -------------------------------
  2972     05  NOTE1L PIC S9(0004) COMP.
  2973     05  NOTE1F PIC  X(0001).
  2974     05  FILLER REDEFINES NOTE1F.
  2975         10  NOTE1A PIC  X(0001).
  2976     05  NOTE1I PIC  X(0060).
  2977*    -------------------------------
  2978     05  ITRB1L PIC S9(0004) COMP.
  2979     05  ITRB1F PIC  X(0001).
  2980     05  FILLER REDEFINES ITRB1F.
  2981         10  ITRB1A PIC  X(0001).
  2982     05  ITRB1I PIC  X(0008).
  2983*    -------------------------------
  2984     05  NOTE2L PIC S9(0004) COMP.
  2985     05  NOTE2F PIC  X(0001).
  2986     05  FILLER REDEFINES NOTE2F.
  2987         10  NOTE2A PIC  X(0001).
  2988     05  NOTE2I PIC  X(0060).
  2989*    -------------------------------
  2990     05  ITRB2L PIC S9(0004) COMP.
  2991     05  ITRB2F PIC  X(0001).
  2992     05  FILLER REDEFINES ITRB2F.
  2993         10  ITRB2A PIC  X(0001).
  2994     05  ITRB2I PIC  X(0010).
  2995*    -------------------------------
  2996     05  EOBYNL PIC S9(0004) COMP.
  2997     05  EOBYNF PIC  X(0001).
  2998     05  FILLER REDEFINES EOBYNF.
  2999         10  EOBYNA PIC  X(0001).
  3000     05  EOBYNI PIC  X(0001).
  3001*    -------------------------------
  3002     05  CLMFMYNL PIC S9(0004) COMP.
  3003     05  CLMFMYNF PIC  X(0001).
  3004     05  FILLER REDEFINES CLMFMYNF.
  3005         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  61
* EL156.cbl
  3006     05  CLMFMYNI PIC  X(0001).
  3007*    -------------------------------
  3008     05  SURVYYNL PIC S9(0004) COMP.
  3009     05  SURVYYNF PIC  X(0001).
  3010     05  FILLER REDEFINES SURVYYNF.
  3011         10  SURVYYNA PIC  X(0001).
  3012     05  SURVYYNI PIC  X(0001).
  3013*    -------------------------------
  3014     05  SPRELYNL PIC S9(0004) COMP.
  3015     05  SPRELYNF PIC  X(0001).
  3016     05  FILLER REDEFINES SPRELYNF.
  3017         10  SPRELYNA PIC  X(0001).
  3018     05  SPRELYNI PIC  X(0001).
  3019*    -------------------------------
  3020     05  PINTHL PIC S9(0004) COMP.
  3021     05  PINTHF PIC  X(0001).
  3022     05  FILLER REDEFINES PINTHF.
  3023         10  PINTHA PIC  X(0001).
  3024     05  PINTHI PIC  X(0004).
  3025*    -------------------------------
  3026     05  PINTL PIC S9(0004) COMP.
  3027     05  PINTF PIC  X(0001).
  3028     05  FILLER REDEFINES PINTF.
  3029         10  PINTA PIC  X(0001).
  3030     05  PINTI PIC  X(0008).
  3031*    -------------------------------
  3032     05  ITRBYNL PIC S9(0004) COMP.
  3033     05  ITRBYNF PIC  X(0001).
  3034     05  FILLER REDEFINES ITRBYNF.
  3035         10  ITRBYNA PIC  X(0001).
  3036     05  ITRBYNI PIC  X(0001).
  3037*    -------------------------------
  3038     05  PROOFDTL PIC S9(0004) COMP.
  3039     05  PROOFDTF PIC  X(0001).
  3040     05  FILLER REDEFINES PROOFDTF.
  3041         10  PROOFDTA PIC  X(0001).
  3042     05  PROOFDTI PIC  X(0008).
  3043*    -------------------------------
  3044     05  AIGFRMHL PIC S9(0004) COMP.
  3045     05  AIGFRMHF PIC  X(0001).
  3046     05  FILLER REDEFINES AIGFRMHF.
  3047         10  AIGFRMHA PIC  X(0001).
  3048     05  AIGFRMHI PIC  X(0012).
  3049*    -------------------------------
  3050     05  AIGFROML PIC S9(0004) COMP.
  3051     05  AIGFROMF PIC  X(0001).
  3052     05  FILLER REDEFINES AIGFROMF.
  3053         10  AIGFROMA PIC  X(0001).
  3054     05  AIGFROMI PIC  X(0008).
  3055*    -------------------------------
  3056     05  PMTHDGAL PIC S9(0004) COMP.
  3057     05  PMTHDGAF PIC  X(0001).
  3058     05  FILLER REDEFINES PMTHDGAF.
  3059         10  PMTHDGAA PIC  X(0001).
  3060     05  PMTHDGAI PIC  X(0066).
  3061*    -------------------------------
  3062     05  EPYFROML PIC S9(0004) COMP.
  3063     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  62
* EL156.cbl
  3064     05  FILLER REDEFINES EPYFROMF.
  3065         10  EPYFROMA PIC  X(0001).
  3066     05  EPYFROMI PIC  X(0008).
  3067*    -------------------------------
  3068     05  EPYTHRUL PIC S9(0004) COMP.
  3069     05  EPYTHRUF PIC  X(0001).
  3070     05  FILLER REDEFINES EPYTHRUF.
  3071         10  EPYTHRUA PIC  X(0001).
  3072     05  EPYTHRUI PIC  X(0008).
  3073*    -------------------------------
  3074     05  EDAYSL PIC S9(0004) COMP.
  3075     05  EDAYSF PIC  X(0001).
  3076     05  FILLER REDEFINES EDAYSF.
  3077         10  EDAYSA PIC  X(0001).
  3078     05  EDAYSI PIC  S9(6).
  3079*    -------------------------------
  3080     05  EPYAMTL PIC S9(0004) COMP.
  3081     05  EPYAMTF PIC  X(0001).
  3082     05  FILLER REDEFINES EPYAMTF.
  3083         10  EPYAMTA PIC  X(0001).
  3084     05  EPYAMTI PIC  S9(8)V99.
  3085*    -------------------------------
  3086     05  ERESVL PIC S9(0004) COMP.
  3087     05  ERESVF PIC  X(0001).
  3088     05  FILLER REDEFINES ERESVF.
  3089         10  ERESVA PIC  X(0001).
  3090     05  ERESVI PIC  S9(7)V99.
  3091*    -------------------------------
  3092     05  ETYPEL PIC S9(0004) COMP.
  3093     05  ETYPEF PIC  X(0001).
  3094     05  FILLER REDEFINES ETYPEF.
  3095         10  ETYPEA PIC  X(0001).
  3096     05  ETYPEI PIC  X(0001).
  3097*    -------------------------------
  3098     05  EEXPENSL PIC S9(0004) COMP.
  3099     05  EEXPENSF PIC  X(0001).
  3100     05  FILLER REDEFINES EEXPENSF.
  3101         10  EEXPENSA PIC  X(0001).
  3102     05  EEXPENSI PIC  9(6)V99.
  3103*    -------------------------------
  3104     05  CPYFROML PIC S9(0004) COMP.
  3105     05  CPYFROMF PIC  X(0001).
  3106     05  FILLER REDEFINES CPYFROMF.
  3107         10  CPYFROMA PIC  X(0001).
  3108     05  CPYFROMI PIC  X(0008).
  3109*    -------------------------------
  3110     05  CPYTHRUL PIC S9(0004) COMP.
  3111     05  CPYTHRUF PIC  X(0001).
  3112     05  FILLER REDEFINES CPYTHRUF.
  3113         10  CPYTHRUA PIC  X(0001).
  3114     05  CPYTHRUI PIC  X(0008).
  3115*    -------------------------------
  3116     05  CDAYSL PIC S9(0004) COMP.
  3117     05  CDAYSF PIC  X(0001).
  3118     05  FILLER REDEFINES CDAYSF.
  3119         10  CDAYSA PIC  X(0001).
  3120     05  CDAYSI PIC  9(6).
  3121*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  63
* EL156.cbl
  3122     05  CPYAMTL PIC S9(0004) COMP.
  3123     05  CPYAMTF PIC  X(0001).
  3124     05  FILLER REDEFINES CPYAMTF.
  3125         10  CPYAMTA PIC  X(0001).
  3126     05  CPYAMTI PIC  S9(8)V99.
  3127*    -------------------------------
  3128     05  CRESVL PIC S9(0004) COMP.
  3129     05  CRESVF PIC  X(0001).
  3130     05  FILLER REDEFINES CRESVF.
  3131         10  CRESVA PIC  X(0001).
  3132     05  CRESVI PIC  9(6)V99.
  3133*    -------------------------------
  3134     05  CEXPENSL PIC S9(0004) COMP.
  3135     05  CEXPENSF PIC  X(0001).
  3136     05  FILLER REDEFINES CEXPENSF.
  3137         10  CEXPENSA PIC  X(0001).
  3138     05  CEXPENSI PIC  9(6)V99.
  3139*    -------------------------------
  3140     05  ERRMSG0L PIC S9(0004) COMP.
  3141     05  ERRMSG0F PIC  X(0001).
  3142     05  FILLER REDEFINES ERRMSG0F.
  3143         10  ERRMSG0A PIC  X(0001).
  3144     05  ERRMSG0I PIC  X(0072).
  3145*    -------------------------------
  3146     05  ERRMSG1L PIC S9(0004) COMP.
  3147     05  ERRMSG1F PIC  X(0001).
  3148     05  FILLER REDEFINES ERRMSG1F.
  3149         10  ERRMSG1A PIC  X(0001).
  3150     05  ERRMSG1I PIC  X(0072).
  3151*    -------------------------------
  3152     05  ERRMSG2L PIC S9(0004) COMP.
  3153     05  ERRMSG2F PIC  X(0001).
  3154     05  FILLER REDEFINES ERRMSG2F.
  3155         10  ERRMSG2A PIC  X(0001).
  3156     05  ERRMSG2I PIC  X(0072).
  3157*    -------------------------------
  3158     05  ENTERPFL PIC S9(0004) COMP.
  3159     05  ENTERPFF PIC  X(0001).
  3160     05  FILLER REDEFINES ENTERPFF.
  3161         10  ENTERPFA PIC  X(0001).
  3162     05  ENTERPFI PIC  99.
  3163*    -------------------------------
  3164     05  PF6TITL PIC S9(0004) COMP.
  3165     05  PF6TITF PIC  X(0001).
  3166     05  FILLER REDEFINES PF6TITF.
  3167         10  PF6TITA PIC  X(0001).
  3168     05  PF6TITI PIC  X(0016).
  3169 01  EL156AO REDEFINES EL156AI.
  3170     05  FILLER            PIC  X(0012).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  RUNDTEAO PIC  X(0008).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  RUNTIMAO PIC  99.99.
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  64
* EL156.cbl
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  CLMNOO PIC  X(0007).
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  CARRO PIC  X(0001).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  CERTNOO PIC  X(0010).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  SUFXO PIC  X(0001).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  CLMTYPO PIC  X(0006).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  CLMSTATO PIC  X(0006).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  LSTNMEO PIC  X(0015).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  FSTNMEO PIC  X(0012).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  MINITO PIC  X(0001).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  PRIMHDGO PIC  X(0012).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  PCERTNOO PIC  X(0010).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  PSUFXO PIC  X(0001).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  STATUSO PIC  X(0010).
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  LOANHO PIC  X(0014).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  LOANNOO PIC  X(0025).
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  DUEDAYHO PIC  X(0008).
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  DUEDAYO PIC  X(0002).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  ZINTHO PIC  X(0009).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  ZINTO PIC  9.99999.
  3237*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  65
* EL156.cbl
  3238     05  FILLER            PIC  X(0003).
  3239     05  PTHRHDGO PIC  X(0014).
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
  3242     05  PDTHRUO PIC  X(0008).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  TOTPAIDO PIC  Z(6).99-.
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  COVERO PIC  X(0010).
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  INCURO PIC  X(0008).
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  LSTDTEO PIC  X(0008).
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  CRTSTATO PIC  X(0010).
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  EFFECTO PIC  X(0008).
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  TERMSO PIC  X(0011).
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  STACCTO PIC  X(0013).
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  EXPDTEHO PIC  X(0014).
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  EXPDTEO PIC  X(0008).
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  BENECAPO PIC  X(0013).
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  BENEO PIC  Z(6).99.
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  FORMTYPO PIC  X(0001).
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  PMTTYPEO PIC  X(0001).
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  PAYEEO PIC  X(0002).
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  CHECKNOO PIC  X(0007).
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  OFFLINEO PIC  X(0001).
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  66
* EL156.cbl
  3296     05  HOLDTILO PIC  99B99B99.
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
  3299     05  NOTE1O PIC  X(0060).
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  ITRB1O PIC  X(0008).
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  NOTE2O PIC  X(0060).
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  ITRB2O PIC  X(0010).
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  EOBYNO PIC  X(0001).
  3312*    -------------------------------
  3313     05  FILLER            PIC  X(0003).
  3314     05  CLMFMYNO PIC  X(0001).
  3315*    -------------------------------
  3316     05  FILLER            PIC  X(0003).
  3317     05  SURVYYNO PIC  X(0001).
  3318*    -------------------------------
  3319     05  FILLER            PIC  X(0003).
  3320     05  SPRELYNO PIC  X(0001).
  3321*    -------------------------------
  3322     05  FILLER            PIC  X(0003).
  3323     05  PINTHO PIC  X(0004).
  3324*    -------------------------------
  3325     05  FILLER            PIC  X(0003).
  3326     05  PINTO PIC  Z,ZZ9.99.
  3327*    -------------------------------
  3328     05  FILLER            PIC  X(0003).
  3329     05  ITRBYNO PIC  X(0001).
  3330*    -------------------------------
  3331     05  FILLER            PIC  X(0003).
  3332     05  PROOFDTO PIC  99B99B99.
  3333*    -------------------------------
  3334     05  FILLER            PIC  X(0003).
  3335     05  AIGFRMHO PIC  X(0012).
  3336*    -------------------------------
  3337     05  FILLER            PIC  X(0003).
  3338     05  AIGFROMO PIC  99B99B99.
  3339*    -------------------------------
  3340     05  FILLER            PIC  X(0003).
  3341     05  PMTHDGAO PIC  X(0066).
  3342*    -------------------------------
  3343     05  FILLER            PIC  X(0003).
  3344     05  EPYFROMO PIC  99B99B99.
  3345*    -------------------------------
  3346     05  FILLER            PIC  X(0003).
  3347     05  EPYTHRUO PIC  99B99B99.
  3348*    -------------------------------
  3349     05  FILLER            PIC  X(0003).
  3350     05  EDAYSO PIC  Z(4)9-.
  3351*    -------------------------------
  3352     05  FILLER            PIC  X(0003).
  3353     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  67
* EL156.cbl
  3354*    -------------------------------
  3355     05  FILLER            PIC  X(0003).
  3356     05  ERESVO PIC  Z(5).99-.
  3357*    -------------------------------
  3358     05  FILLER            PIC  X(0003).
  3359     05  ETYPEO PIC  X(0001).
  3360*    -------------------------------
  3361     05  FILLER            PIC  X(0003).
  3362     05  EEXPENSO PIC  Z(5).99.
  3363*    -------------------------------
  3364     05  FILLER            PIC  X(0003).
  3365     05  CPYFROMO PIC  99B99B99.
  3366*    -------------------------------
  3367     05  FILLER            PIC  X(0003).
  3368     05  CPYTHRUO PIC  99B99B99.
  3369*    -------------------------------
  3370     05  FILLER            PIC  X(0003).
  3371     05  CDAYSO PIC  Z(4)9-.
  3372*    -------------------------------
  3373     05  FILLER            PIC  X(0003).
  3374     05  CPYAMTO PIC  Z(6).99-.
  3375*    -------------------------------
  3376     05  FILLER            PIC  X(0003).
  3377     05  CRESVO PIC  Z(5).99.
  3378*    -------------------------------
  3379     05  FILLER            PIC  X(0003).
  3380     05  CEXPENSO PIC  Z(5).99.
  3381*    -------------------------------
  3382     05  FILLER            PIC  X(0003).
  3383     05  ERRMSG0O PIC  X(0072).
  3384*    -------------------------------
  3385     05  FILLER            PIC  X(0003).
  3386     05  ERRMSG1O PIC  X(0072).
  3387*    -------------------------------
  3388     05  FILLER            PIC  X(0003).
  3389     05  ERRMSG2O PIC  X(0072).
  3390*    -------------------------------
  3391     05  FILLER            PIC  X(0003).
  3392     05  ENTERPFO PIC  X(0002).
  3393*    -------------------------------
  3394     05  FILLER            PIC  X(0003).
  3395     05  PF6TITO PIC  X(0016).
  3396*    -------------------------------
  3397 01  EL156BI REDEFINES EL156AI.
  3398     05  FILLER            PIC  X(0012).
  3399*    -------------------------------
  3400     05  RUNDTEBL PIC S9(0004) COMP.
  3401     05  RUNDTEBF PIC  X(0001).
  3402     05  FILLER REDEFINES RUNDTEBF.
  3403         10  RUNDTEBA PIC  X(0001).
  3404     05  RUNDTEBI PIC  X(0008).
  3405*    -------------------------------
  3406     05  RUNTIMBL PIC S9(0004) COMP.
  3407     05  RUNTIMBF PIC  X(0001).
  3408     05  FILLER REDEFINES RUNTIMBF.
  3409         10  RUNTIMBA PIC  X(0001).
  3410     05  RUNTIMBI PIC  X(0005).
  3411*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  68
* EL156.cbl
  3412     05  PAYDTBL PIC S9(0004) COMP.
  3413     05  PAYDTBF PIC  X(0001).
  3414     05  FILLER REDEFINES PAYDTBF.
  3415         10  PAYDTBA PIC  X(0001).
  3416     05  PAYDTBI PIC  X(0008).
  3417*    -------------------------------
  3418     05  PAYTYPBL PIC S9(0004) COMP.
  3419     05  PAYTYPBF PIC  X(0001).
  3420     05  FILLER REDEFINES PAYTYPBF.
  3421         10  PAYTYPBA PIC  X(0001).
  3422     05  PAYTYPBI PIC  X(0015).
  3423*    -------------------------------
  3424     05  PAYAMTBL PIC S9(0004) COMP.
  3425     05  PAYAMTBF PIC  X(0001).
  3426     05  FILLER REDEFINES PAYAMTBF.
  3427         10  PAYAMTBA PIC  X(0001).
  3428     05  PAYAMTBI PIC  X(0011).
  3429*    -------------------------------
  3430     05  LOANHBL PIC S9(0004) COMP.
  3431     05  LOANHBF PIC  X(0001).
  3432     05  FILLER REDEFINES LOANHBF.
  3433         10  LOANHBA PIC  X(0001).
  3434     05  LOANHBI PIC  X(0012).
  3435*    -------------------------------
  3436     05  LOANNBL PIC S9(0004) COMP.
  3437     05  LOANNBF PIC  X(0001).
  3438     05  FILLER REDEFINES LOANNBF.
  3439         10  LOANNBA PIC  X(0001).
  3440     05  LOANNBI PIC  X(0025).
  3441*    -------------------------------
  3442     05  CKNUMHDL PIC S9(0004) COMP.
  3443     05  CKNUMHDF PIC  X(0001).
  3444     05  FILLER REDEFINES CKNUMHDF.
  3445         10  CKNUMHDA PIC  X(0001).
  3446     05  CKNUMHDI PIC  X(0012).
  3447*    -------------------------------
  3448     05  CKNUMBL PIC S9(0004) COMP.
  3449     05  CKNUMBF PIC  X(0001).
  3450     05  FILLER REDEFINES CKNUMBF.
  3451         10  CKNUMBA PIC  X(0001).
  3452     05  CKNUMBI PIC  X(0007).
  3453*    -------------------------------
  3454     05  AGTHDGL PIC S9(0004) COMP.
  3455     05  AGTHDGF PIC  X(0001).
  3456     05  FILLER REDEFINES AGTHDGF.
  3457         10  AGTHDGA PIC  X(0001).
  3458     05  AGTHDGI PIC  X(0016).
  3459*    -------------------------------
  3460     05  NAMEBL PIC S9(0004) COMP.
  3461     05  NAMEBF PIC  X(0001).
  3462     05  FILLER REDEFINES NAMEBF.
  3463         10  NAMEBA PIC  X(0001).
  3464     05  NAMEBI PIC  X(0030).
  3465*    -------------------------------
  3466     05  NAMEB2L PIC S9(0004) COMP.
  3467     05  NAMEB2F PIC  X(0001).
  3468     05  FILLER REDEFINES NAMEB2F.
  3469         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  69
* EL156.cbl
  3470     05  NAMEB2I PIC  X(0030).
  3471*    -------------------------------
  3472     05  ADDR1BL PIC S9(0004) COMP.
  3473     05  ADDR1BF PIC  X(0001).
  3474     05  FILLER REDEFINES ADDR1BF.
  3475         10  ADDR1BA PIC  X(0001).
  3476     05  ADDR1BI PIC  X(0030).
  3477*    -------------------------------
  3478     05  ADDR1B2L PIC S9(0004) COMP.
  3479     05  ADDR1B2F PIC  X(0001).
  3480     05  FILLER REDEFINES ADDR1B2F.
  3481         10  ADDR1B2A PIC  X(0001).
  3482     05  ADDR1B2I PIC  X(0030).
  3483*    -------------------------------
  3484     05  ADDR2BL PIC S9(0004) COMP.
  3485     05  ADDR2BF PIC  X(0001).
  3486     05  FILLER REDEFINES ADDR2BF.
  3487         10  ADDR2BA PIC  X(0001).
  3488     05  ADDR2BI PIC  X(0030).
  3489*    -------------------------------
  3490     05  ADDR2B2L PIC S9(0004) COMP.
  3491     05  ADDR2B2F PIC  X(0001).
  3492     05  FILLER REDEFINES ADDR2B2F.
  3493         10  ADDR2B2A PIC  X(0001).
  3494     05  ADDR2B2I PIC  X(0030).
  3495*    -------------------------------
  3496     05  CITYSTBL PIC S9(0004) COMP.
  3497     05  CITYSTBF PIC  X(0001).
  3498     05  FILLER REDEFINES CITYSTBF.
  3499         10  CITYSTBA PIC  X(0001).
  3500     05  CITYSTBI PIC  X(0030).
  3501*    -------------------------------
  3502     05  CITYST2L PIC S9(0004) COMP.
  3503     05  CITYST2F PIC  X(0001).
  3504     05  FILLER REDEFINES CITYST2F.
  3505         10  CITYST2A PIC  X(0001).
  3506     05  CITYST2I PIC  X(0030).
  3507*    -------------------------------
  3508     05  ZIPBL PIC S9(0004) COMP.
  3509     05  ZIPBF PIC  X(0001).
  3510     05  FILLER REDEFINES ZIPBF.
  3511         10  ZIPBA PIC  X(0001).
  3512     05  ZIPBI PIC  X(0009).
  3513*    -------------------------------
  3514     05  ZIPB2L PIC S9(0004) COMP.
  3515     05  ZIPB2F PIC  X(0001).
  3516     05  FILLER REDEFINES ZIPB2F.
  3517         10  ZIPB2A PIC  X(0001).
  3518     05  ZIPB2I PIC  X(0009).
  3519*    -------------------------------
  3520     05  INTHDBL PIC S9(0004) COMP.
  3521     05  INTHDBF PIC  X(0001).
  3522     05  FILLER REDEFINES INTHDBF.
  3523         10  INTHDBA PIC  X(0001).
  3524     05  INTHDBI PIC  X(0012).
  3525*    -------------------------------
  3526     05  INTAMTBL PIC S9(0004) COMP.
  3527     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  70
* EL156.cbl
  3528     05  FILLER REDEFINES INTAMTBF.
  3529         10  INTAMTBA PIC  X(0001).
  3530     05  INTAMTBI PIC  X(0011).
  3531*    -------------------------------
  3532     05  PMTHDGBL PIC S9(0004) COMP.
  3533     05  PMTHDGBF PIC  X(0001).
  3534     05  FILLER REDEFINES PMTHDGBF.
  3535         10  PMTHDGBA PIC  X(0001).
  3536     05  PMTHDGBI PIC  X(0034).
  3537*    -------------------------------
  3538     05  CLMNOBL PIC S9(0004) COMP.
  3539     05  CLMNOBF PIC  X(0001).
  3540     05  FILLER REDEFINES CLMNOBF.
  3541         10  CLMNOBA PIC  X(0001).
  3542     05  CLMNOBI PIC  X(0007).
  3543*    -------------------------------
  3544     05  CARRBL PIC S9(0004) COMP.
  3545     05  CARRBF PIC  X(0001).
  3546     05  FILLER REDEFINES CARRBF.
  3547         10  CARRBA PIC  X(0001).
  3548     05  CARRBI PIC  X(0001).
  3549*    -------------------------------
  3550     05  CERTNOBL PIC S9(0004) COMP.
  3551     05  CERTNOBF PIC  X(0001).
  3552     05  FILLER REDEFINES CERTNOBF.
  3553         10  CERTNOBA PIC  X(0001).
  3554     05  CERTNOBI PIC  X(0010).
  3555*    -------------------------------
  3556     05  SUFXBL PIC S9(0004) COMP.
  3557     05  SUFXBF PIC  X(0001).
  3558     05  FILLER REDEFINES SUFXBF.
  3559         10  SUFXBA PIC  X(0001).
  3560     05  SUFXBI PIC  X(0001).
  3561*    -------------------------------
  3562     05  CLMTYPBL PIC S9(0004) COMP.
  3563     05  CLMTYPBF PIC  X(0001).
  3564     05  FILLER REDEFINES CLMTYPBF.
  3565         10  CLMTYPBA PIC  X(0001).
  3566     05  CLMTYPBI PIC  X(0006).
  3567*    -------------------------------
  3568     05  INCURBL PIC S9(0004) COMP.
  3569     05  INCURBF PIC  X(0001).
  3570     05  FILLER REDEFINES INCURBF.
  3571         10  INCURBA PIC  X(0001).
  3572     05  INCURBI PIC  X(0008).
  3573*    -------------------------------
  3574     05  PYFROMBL PIC S9(0004) COMP.
  3575     05  PYFROMBF PIC  X(0001).
  3576     05  FILLER REDEFINES PYFROMBF.
  3577         10  PYFROMBA PIC  X(0001).
  3578     05  PYFROMBI PIC  X(0008).
  3579*    -------------------------------
  3580     05  PYTHRUBL PIC S9(0004) COMP.
  3581     05  PYTHRUBF PIC  X(0001).
  3582     05  FILLER REDEFINES PYTHRUBF.
  3583         10  PYTHRUBA PIC  X(0001).
  3584     05  PYTHRUBI PIC  X(0008).
  3585*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  71
* EL156.cbl
  3586     05  DAYSBL PIC S9(0004) COMP.
  3587     05  DAYSBF PIC  X(0001).
  3588     05  FILLER REDEFINES DAYSBF.
  3589         10  DAYSBA PIC  X(0001).
  3590     05  DAYSBI PIC  X(0005).
  3591*    -------------------------------
  3592     05  BYBL PIC S9(0004) COMP.
  3593     05  BYBF PIC  X(0001).
  3594     05  FILLER REDEFINES BYBF.
  3595         10  BYBA PIC  X(0001).
  3596     05  BYBI PIC  X(0004).
  3597*    -------------------------------
  3598     05  PROOFDBL PIC S9(0004) COMP.
  3599     05  PROOFDBF PIC  X(0001).
  3600     05  FILLER REDEFINES PROOFDBF.
  3601         10  PROOFDBA PIC  X(0001).
  3602     05  PROOFDBI PIC  X(0008).
  3603*    -------------------------------
  3604     05  ACCTBL PIC S9(0004) COMP.
  3605     05  ACCTBF PIC  X(0001).
  3606     05  FILLER REDEFINES ACCTBF.
  3607         10  ACCTBA PIC  X(0001).
  3608     05  ACCTBI PIC  X(0010).
  3609*    -------------------------------
  3610     05  STATEBL PIC S9(0004) COMP.
  3611     05  STATEBF PIC  X(0001).
  3612     05  FILLER REDEFINES STATEBF.
  3613         10  STATEBA PIC  X(0001).
  3614     05  STATEBI PIC  X(0002).
  3615*    -------------------------------
  3616     05  GROUPBL PIC S9(0004) COMP.
  3617     05  GROUPBF PIC  X(0001).
  3618     05  FILLER REDEFINES GROUPBF.
  3619         10  GROUPBA PIC  X(0001).
  3620     05  GROUPBI PIC  X(0006).
  3621*    -------------------------------
  3622     05  ACARRBL PIC S9(0004) COMP.
  3623     05  ACARRBF PIC  X(0001).
  3624     05  FILLER REDEFINES ACARRBF.
  3625         10  ACARRBA PIC  X(0001).
  3626     05  ACARRBI PIC  X(0001).
  3627*    -------------------------------
  3628     05  ACCTNMBL PIC S9(0004) COMP.
  3629     05  ACCTNMBF PIC  X(0001).
  3630     05  FILLER REDEFINES ACCTNMBF.
  3631         10  ACCTNMBA PIC  X(0001).
  3632     05  ACCTNMBI PIC  X(0030).
  3633*    -------------------------------
  3634     05  UNDISBL PIC S9(0004) COMP.
  3635     05  UNDISBF PIC  X(0001).
  3636     05  FILLER REDEFINES UNDISBF.
  3637         10  UNDISBA PIC  X(0001).
  3638     05  UNDISBI PIC  X(0010).
  3639*    -------------------------------
  3640     05  RATEBL PIC S9(0004) COMP.
  3641     05  RATEBF PIC  X(0001).
  3642     05  FILLER REDEFINES RATEBF.
  3643         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  72
* EL156.cbl
  3644     05  RATEBI PIC  X(0006).
  3645*    -------------------------------
  3646     05  ERMSG1BL PIC S9(0004) COMP.
  3647     05  ERMSG1BF PIC  X(0001).
  3648     05  FILLER REDEFINES ERMSG1BF.
  3649         10  ERMSG1BA PIC  X(0001).
  3650     05  ERMSG1BI PIC  X(0072).
  3651*    -------------------------------
  3652     05  ENTPFBL PIC S9(0004) COMP.
  3653     05  ENTPFBF PIC  X(0001).
  3654     05  FILLER REDEFINES ENTPFBF.
  3655         10  ENTPFBA PIC  X(0001).
  3656     05  ENTPFBI PIC  99.
  3657 01  EL156BO REDEFINES EL156AI.
  3658     05  FILLER            PIC  X(0012).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  RUNDTEBO PIC  X(0008).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  RUNTIMBO PIC  99.99.
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  PAYDTBO PIC  99B99B99.
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  PAYTYPBO PIC  X(0015).
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3674*    -------------------------------
  3675     05  FILLER            PIC  X(0003).
  3676     05  LOANHBO PIC  X(0012).
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  LOANNBO PIC  X(0025).
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  CKNUMHDO PIC  X(0012).
  3683*    -------------------------------
  3684     05  FILLER            PIC  X(0003).
  3685     05  CKNUMBO PIC  X(0007).
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  AGTHDGO PIC  X(0016).
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  NAMEBO PIC  X(0030).
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  NAMEB2O PIC  X(0030).
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  ADDR1BO PIC  X(0030).
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  ADDR1B2O PIC  X(0030).
  3701*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  73
* EL156.cbl
  3702     05  FILLER            PIC  X(0003).
  3703     05  ADDR2BO PIC  X(0030).
  3704*    -------------------------------
  3705     05  FILLER            PIC  X(0003).
  3706     05  ADDR2B2O PIC  X(0030).
  3707*    -------------------------------
  3708     05  FILLER            PIC  X(0003).
  3709     05  CITYSTBO PIC  X(0030).
  3710*    -------------------------------
  3711     05  FILLER            PIC  X(0003).
  3712     05  CITYST2O PIC  X(0030).
  3713*    -------------------------------
  3714     05  FILLER            PIC  X(0003).
  3715     05  ZIPBO PIC  ZZZZ99999.
  3716*    -------------------------------
  3717     05  FILLER            PIC  X(0003).
  3718     05  ZIPB2O PIC  ZZZZZZZZZ.
  3719*    -------------------------------
  3720     05  FILLER            PIC  X(0003).
  3721     05  INTHDBO PIC  X(0012).
  3722*    -------------------------------
  3723     05  FILLER            PIC  X(0003).
  3724     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3725*    -------------------------------
  3726     05  FILLER            PIC  X(0003).
  3727     05  PMTHDGBO PIC  X(0034).
  3728*    -------------------------------
  3729     05  FILLER            PIC  X(0003).
  3730     05  CLMNOBO PIC  X(0007).
  3731*    -------------------------------
  3732     05  FILLER            PIC  X(0003).
  3733     05  CARRBO PIC  X(0001).
  3734*    -------------------------------
  3735     05  FILLER            PIC  X(0003).
  3736     05  CERTNOBO PIC  X(0010).
  3737*    -------------------------------
  3738     05  FILLER            PIC  X(0003).
  3739     05  SUFXBO PIC  X(0001).
  3740*    -------------------------------
  3741     05  FILLER            PIC  X(0003).
  3742     05  CLMTYPBO PIC  X(0006).
  3743*    -------------------------------
  3744     05  FILLER            PIC  X(0003).
  3745     05  INCURBO PIC  X(0008).
  3746*    -------------------------------
  3747     05  FILLER            PIC  X(0003).
  3748     05  PYFROMBO PIC  99B99B99.
  3749*    -------------------------------
  3750     05  FILLER            PIC  X(0003).
  3751     05  PYTHRUBO PIC  99B99B99.
  3752*    -------------------------------
  3753     05  FILLER            PIC  X(0003).
  3754     05  DAYSBO PIC  X(0005).
  3755*    -------------------------------
  3756     05  FILLER            PIC  X(0003).
  3757     05  BYBO PIC  X(0004).
  3758*    -------------------------------
  3759     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  74
* EL156.cbl
  3760     05  PROOFDBO PIC  99B99B99.
  3761*    -------------------------------
  3762     05  FILLER            PIC  X(0003).
  3763     05  ACCTBO PIC  X(0010).
  3764*    -------------------------------
  3765     05  FILLER            PIC  X(0003).
  3766     05  STATEBO PIC  X(0002).
  3767*    -------------------------------
  3768     05  FILLER            PIC  X(0003).
  3769     05  GROUPBO PIC  X(0006).
  3770*    -------------------------------
  3771     05  FILLER            PIC  X(0003).
  3772     05  ACARRBO PIC  X(0001).
  3773*    -------------------------------
  3774     05  FILLER            PIC  X(0003).
  3775     05  ACCTNMBO PIC  X(0030).
  3776*    -------------------------------
  3777     05  FILLER            PIC  X(0003).
  3778     05  UNDISBO PIC  ZZZ,Z99.99.
  3779*    -------------------------------
  3780     05  FILLER            PIC  X(0003).
  3781     05  RATEBO PIC  ZZZ.99.
  3782*    -------------------------------
  3783     05  FILLER            PIC  X(0003).
  3784     05  ERMSG1BO PIC  X(0072).
  3785*    -------------------------------
  3786     05  FILLER            PIC  X(0003).
  3787     05  ENTPFBO PIC  X(0002).
  3788*    -------------------------------
  3789****************************************************************
  3790*
  3791* Copyright (c) 2007-2013 Dell Inc.
  3792* All rights reserved.
  3793*
  3794****************************************************************
  3795 01  DFHEIV.
  3796   02  DFHEIV0               PIC X(35).
  3797   02  DFHEIV1               PIC X(08).
  3798   02  DFHEIV2               PIC X(08).
  3799   02  DFHEIV3               PIC X(08).
  3800   02  DFHEIV4               PIC X(06).
  3801   02  DFHEIV5               PIC X(04).
  3802   02  DFHEIV6               PIC X(04).
  3803   02  DFHEIV7               PIC X(02).
  3804   02  DFHEIV8               PIC X(02).
  3805   02  DFHEIV9               PIC X(01).
  3806   02  DFHEIV10              PIC S9(7) COMP-3.
  3807   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3808   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3809   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3810   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3811   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3812   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3813   02  DFHEIV17              PIC X(04).
  3814   02  DFHEIV18              PIC X(04).
  3815   02  DFHEIV19              PIC X(04).
  3816   02  DFHEIV20              USAGE IS POINTER.
  3817   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  75
* EL156.cbl
  3818   02  DFHEIV22              USAGE IS POINTER.
  3819   02  DFHEIV23              USAGE IS POINTER.
  3820   02  DFHEIV24              USAGE IS POINTER.
  3821   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3822   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3823   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3824   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3825   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3826   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3827   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3828   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3829   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3830   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3831   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3832   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3833   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3834   02  FILLER                PIC X(02).
  3835   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3836   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3837   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3838   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3839   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3840   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3841   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3842 LINKAGE  SECTION.
  3843*****************************************************************
  3844*                                                               *
  3845* Copyright (c) 2007-2013 Dell Inc.                             *
  3846* All rights reserved.                                          *
  3847*                                                               *
  3848*****************************************************************
  3849 01  dfheiblk.
  3850     02  eibtime          pic s9(7) comp-3.
  3851     02  eibdate          pic s9(7) comp-3.
  3852     02  eibtrnid         pic x(4).
  3853     02  eibtaskn         pic s9(7) comp-3.
  3854     02  eibtrmid         pic x(4).
  3855     02  dfheigdi         pic s9(4) comp.
  3856     02  eibcposn         pic s9(4) comp.
  3857     02  eibcalen         pic s9(4) comp.
  3858     02  eibaid           pic x(1).
  3859     02  eibfiller1       pic x(1).
  3860     02  eibfn            pic x(2).
  3861     02  eibfiller2       pic x(2).
  3862     02  eibrcode         pic x(6).
  3863     02  eibfiller3       pic x(2).
  3864     02  eibds            pic x(8).
  3865     02  eibreqid         pic x(8).
  3866     02  eibrsrce         pic x(8).
  3867     02  eibsync          pic x(1).
  3868     02  eibfree          pic x(1).
  3869     02  eibrecv          pic x(1).
  3870     02  eibsend          pic x(1).
  3871     02  eibatt           pic x(1).
  3872     02  eibeoc           pic x(1).
  3873     02  eibfmh           pic x(1).
  3874     02  eibcompl         pic x(1).
  3875     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  76
* EL156.cbl
  3876     02  eibconf          pic x(1).
  3877     02  eiberr           pic x(1).
  3878     02  eibrldbk         pic x(1).
  3879     02  eiberrcd         pic x(4).
  3880     02  eibsynrb         pic x(1).
  3881     02  eibnodat         pic x(1).
  3882     02  eibfiller5       pic x(2).
  3883     02  eibresp          pic s9(8) comp.
  3884     02  eibresp2         pic s9(8) comp.
  3885     02  dfheigdj         pic s9(4) comp.
  3886     02  dfheigdk         pic s9(4) comp.
  3887 01  DFHCOMMAREA             PIC X(1024).
  3888
  3889*    COPY ELCMSTR.
  3890******************************************************************
  3891*                                                                *
  3892*                            ELCMSTR.                            *
  3893*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3894*                            VMOD=2.012                          *
  3895*                                                                *
  3896*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3897*                                                                *
  3898*   FILE TYPE = VSAM,KSDS                                        *
  3899*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3900*                                                                *
  3901*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3902*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3903*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3904*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3905*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3906*                                                 RKP=75,LEN=21  *
  3907*                                                                *
  3908*   **** NOTE ****                                               *
  3909*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3910*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3911*                                                                *
  3912*   LOG = YES                                                    *
  3913*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3914******************************************************************
  3915*                   C H A N G E   L O G
  3916*
  3917* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3918*-----------------------------------------------------------------
  3919*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3920* EFFECTIVE    NUMBER
  3921*-----------------------------------------------------------------
  3922* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3923* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3924* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3925* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3926* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3927* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3928* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3929******************************************************************
  3930 01  CLAIM-MASTER.
  3931     12  CL-RECORD-ID                PIC XX.
  3932         88  VALID-CL-ID         VALUE 'CL'.
  3933
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  77
* EL156.cbl
  3934     12  CL-CONTROL-PRIMARY.
  3935         16  CL-COMPANY-CD           PIC X.
  3936         16  CL-CARRIER              PIC X.
  3937         16  CL-CLAIM-NO             PIC X(7).
  3938         16  CL-CERT-NO.
  3939             20  CL-CERT-PRIME       PIC X(10).
  3940             20  CL-CERT-SFX         PIC X.
  3941
  3942     12  CL-CONTROL-BY-NAME.
  3943         16  CL-COMPANY-CD-A1        PIC X.
  3944         16  CL-INSURED-LAST-NAME    PIC X(15).
  3945         16  CL-INSURED-NAME.
  3946             20  CL-INSURED-1ST-NAME PIC X(12).
  3947             20  CL-INSURED-MID-INIT PIC X.
  3948
  3949     12  CL-CONTROL-BY-SSN.
  3950         16  CL-COMPANY-CD-A2        PIC X.
  3951         16  CL-SOC-SEC-NO.
  3952             20  CL-SSN-STATE        PIC XX.
  3953             20  CL-SSN-ACCOUNT      PIC X(6).
  3954             20  CL-SSN-LN3          PIC X(3).
  3955
  3956     12  CL-CONTROL-BY-CERT-NO.
  3957         16  CL-COMPANY-CD-A4        PIC X.
  3958         16  CL-CERT-NO-A4.
  3959             20  CL-CERT-A4-PRIME    PIC X(10).
  3960             20  CL-CERT-A4-SFX      PIC X.
  3961
  3962     12  CL-CONTROL-BY-CCN.
  3963         16  CL-COMPANY-CD-A5        PIC X.
  3964         16  CL-CCN-A5.
  3965             20  CL-CCN.
  3966                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3967                 24  CL-CCN-PRIME-A5 PIC X(12).
  3968             20  CL-CCN-FILLER-A5    PIC X(4).
  3969
  3970     12  CL-INSURED-PROFILE-DATA.
  3971         16  CL-INSURED-BIRTH-DT     PIC XX.
  3972         16  CL-INSURED-SEX-CD       PIC X.
  3973             88  INSURED-IS-MALE        VALUE 'M'.
  3974             88  INSURED-IS-FEMALE      VALUE 'F'.
  3975             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3976         16  CL-INSURED-OCC-CD       PIC X(6).
  3977         16  FILLER                  PIC X(5).
  3978
  3979     12  CL-PROCESSING-INFO.
  3980         16  CL-PROCESSOR-ID         PIC X(4).
  3981         16  CL-CLAIM-STATUS         PIC X.
  3982             88  CLAIM-IS-OPEN          VALUE 'O'.
  3983             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3984         16  CL-CLAIM-TYPE           PIC X.
  3985*            88  AH-CLAIM               VALUE 'A'.
  3986*            88  LIFE-CLAIM             VALUE 'L'.
  3987*            88  PROPERTY-CLAIM         VALUE 'P'.
  3988*            88  IUI-CLAIM              VALUE 'I'.
  3989*            88  GAP-CLAIM              VALUE 'G'.
  3990*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3991*            88  OTHER-CLAIM            VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  78
* EL156.cbl
  3992         16  CL-CLAIM-PREM-TYPE      PIC X.
  3993             88  SINGLE-PREMIUM         VALUE '1'.
  3994             88  O-B-COVERAGE           VALUE '2'.
  3995             88  OPEN-END-COVERAGE      VALUE '3'.
  3996         16  CL-INCURRED-DT          PIC XX.
  3997         16  CL-REPORTED-DT          PIC XX.
  3998         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3999         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  4000         16  CL-LAST-PMT-DT          PIC XX.
  4001         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  4002         16  CL-PAID-THRU-DT         PIC XX.
  4003         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  4004         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  4005         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  4006         16  CL-PMT-CALC-METHOD      PIC X.
  4007             88  CL-360-DAY-YR          VALUE '1'.
  4008             88  CL-365-DAY-YR          VALUE '2'.
  4009             88  CL-FULL-MONTHS         VALUE '3'.
  4010         16  CL-CAUSE-CD             PIC X(6).
  4011
  4012         16  CL-PRIME-CERT-NO.
  4013             20  CL-PRIME-CERT-PRIME PIC X(10).
  4014             20  CL-PRIME-CERT-SFX   PIC X.
  4015
  4016         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  4017             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  4018             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  4019
  4020         16  CL-MICROFILM-NO         PIC X(10).
  4021         16  FILLER REDEFINES CL-MICROFILM-NO.
  4022             20  CL-BENEFIT-PERIOD   PIC 99.
  4023             20  FILLER              PIC X(8).
  4024         16  CL-PROG-FORM-TYPE       PIC X.
  4025         16  CL-LAST-ADD-ON-DT       PIC XX.
  4026
  4027         16  CL-LAST-REOPEN-DT       PIC XX.
  4028         16  CL-LAST-CLOSE-DT        PIC XX.
  4029         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4030             88  FINAL-PAID             VALUE '1'.
  4031             88  CLAIM-DENIED           VALUE '2'.
  4032             88  AUTO-CLOSE             VALUE '3'.
  4033             88  MANUAL-CLOSE           VALUE '4'.
  4034             88  BENEFITS-CHANGED       VALUE 'C'.
  4035             88  SETUP-ERRORS           VALUE 'E'.
  4036         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4037         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4038         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4039             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4040         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4041         16  FILLER                  PIC X.
  4042
  4043     12  CL-CERTIFICATE-DATA.
  4044         16  CL-CERT-ORIGIN          PIC X.
  4045             88  CERT-WAS-ONLINE        VALUE '1'.
  4046             88  CERT-WAS-CREATED       VALUE '2'.
  4047             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4048         16  CL-CERT-KEY-DATA.
  4049             20  CL-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  79
* EL156.cbl
  4050             20  CL-CERT-GROUPING    PIC X(6).
  4051             20  CL-CERT-STATE       PIC XX.
  4052             20  CL-CERT-ACCOUNT.
  4053                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4054                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4055             20  CL-CERT-EFF-DT      PIC XX.
  4056
  4057     12  CL-STATUS-CONTROLS.
  4058         16  CL-PRIORITY-CD          PIC X.
  4059             88  CONFIDENTIAL-DATA      VALUE '8'.
  4060             88  HIGHEST-PRIORITY       VALUE '9'.
  4061         16  CL-SUPV-ATTN-CD         PIC X.
  4062             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4063             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4064         16  CL-PURGED-DT            PIC XX.
  4065         16  CL-RESTORED-DT          PIC XX.
  4066         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4067         16  CL-NEXT-RESEND-DT       PIC XX.
  4068         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4069         16  CL-CRITICAL-PERIOD      PIC 99.
  4070*        16  FILLER                  PIC XX.
  4071         16  CL-LAST-MAINT-DT        PIC XX.
  4072         16  CL-LAST-MAINT-USER      PIC X(4).
  4073         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4074         16  CL-LAST-MAINT-TYPE      PIC X.
  4075             88  CLAIM-SET-UP           VALUE ' '.
  4076             88  PAYMENT-MADE           VALUE '1'.
  4077             88  LETTER-SENT            VALUE '2'.
  4078             88  MASTER-WAS-ALTERED     VALUE '3'.
  4079             88  MASTER-WAS-RESTORED    VALUE '4'.
  4080             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4081             88  FILE-CONVERTED         VALUE '6'.
  4082             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4083             88  ERROR-CORRECTION       VALUE 'E'.
  4084         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4085         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4086         16  CL-BENEFICIARY          PIC X(10).
  4087         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4088         16  CL-DENIAL-TYPE          PIC X.
  4089             88  CL-TYPE-DENIAL          VALUE '1'.
  4090             88  CL-TYPE-RESCISSION      VALUE '2'.
  4091             88  CL-TYPE-REFORMATION     VALUE '3'.
  4092             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4093             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4094         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4095         16  filler                  pic x(3).
  4096*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4097*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4098*        16  CL-RTW-DT               PIC XX.
  4099
  4100     12  CL-TRAILER-CONTROLS.
  4101         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4102             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4103             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4104             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4105         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4106         16  FILLER                  PIC XX.
  4107         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  80
* EL156.cbl
  4108         16  CL-ADDRESS-TRAILER-CNT.
  4109             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4110                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4111             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4112                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4113             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4114                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4115             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4116                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4117             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4118                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4119             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4120                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4121             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4122                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4123
  4124     12  CL-CV-REFERENCE-NO.
  4125         16  CL-CV-REFNO-PRIME       PIC X(18).
  4126         16  CL-CV-REFNO-SFX         PIC XX.
  4127
  4128     12  CL-FILE-LOCATION            PIC X(4).
  4129
  4130     12  CL-PROCESS-ERRORS.
  4131         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4132             88  NO-FATAL-ERRORS        VALUE ZERO.
  4133         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4134             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4135
  4136     12  CL-PRODUCT-CD               PIC X.
  4137
  4138     12  CL-CURRENT-KEY-DATA.
  4139         16  CL-CURRENT-CARRIER      PIC X.
  4140         16  CL-CURRENT-GROUPING     PIC X(6).
  4141         16  CL-CURRENT-STATE        PIC XX.
  4142         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4143
  4144     12  CL-ASSOCIATES               PIC X.
  4145         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4146         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4147         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4148         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4149
  4150     12  CL-ACTIVITY-CODE            PIC 99.
  4151     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4152     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4153
  4154     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4155     12  CL-LAG-REPORT-CODE          PIC 9.
  4156     12  CL-LOAN-TYPE                PIC XX.
  4157     12  CL-LEGAL-STATE              PIC XX.
  4158
  4159     12  CL-YESNOSW                  PIC X.
  4160     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4161         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4162         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4163         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4164     12  cl-insured-type             pic x.
  4165         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  81
* EL156.cbl
  4166         88  cl-claim-on-co-borrower     value 'C'.
  4167     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  82
* EL156.cbl
  4169*    COPY ELCCNTL.
  4170******************************************************************
  4171*                                                                *
  4172*                                                                *
  4173*                            ELCCNTL.                            *
  4174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4175*                            VMOD=2.059                          *
  4176*                                                                *
  4177*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4178*                                                                *
  4179*   FILE TYPE = VSAM,KSDS                                        *
  4180*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4181*                                                                *
  4182*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4183*       ALTERNATE INDEX = NONE                                   *
  4184*                                                                *
  4185*   LOG = YES                                                    *
  4186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4187******************************************************************
  4188*                   C H A N G E   L O G
  4189*
  4190* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4191*-----------------------------------------------------------------
  4192*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4193* EFFECTIVE    NUMBER
  4194*-----------------------------------------------------------------
  4195* 082503                   PEMA  ADD BENEFIT GROUP
  4196* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4197* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4198* 092705    2005050300006  PEMA  ADD SPP LEASES
  4199* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4200* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4201* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4202* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4203* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4204* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4205* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4206* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4207* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4208* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4209* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4210******************************************************************
  4211*
  4212 01  CONTROL-FILE.
  4213     12  CF-RECORD-ID                       PIC XX.
  4214         88  VALID-CF-ID                        VALUE 'CF'.
  4215
  4216     12  CF-CONTROL-PRIMARY.
  4217         16  CF-COMPANY-ID                  PIC XXX.
  4218         16  CF-RECORD-TYPE                 PIC X.
  4219             88  CF-COMPANY-MASTER              VALUE '1'.
  4220             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4221             88  CF-STATE-MASTER                VALUE '3'.
  4222             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4223             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4224             88  CF-CARRIER-MASTER              VALUE '6'.
  4225             88  CF-MORTALITY-MASTER            VALUE '7'.
  4226             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  83
* EL156.cbl
  4227             88  CF-TERMINAL-MASTER             VALUE '9'.
  4228             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4229             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4230             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4231             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4232             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4233             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4234             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4235             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4236             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4237         16  CF-ACCESS-CD-GENL              PIC X(4).
  4238         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4239             20  CF-PROCESSOR               PIC X(4).
  4240         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4241             20  CF-STATE-CODE              PIC XX.
  4242             20  FILLER                     PIC XX.
  4243         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4244             20  FILLER                     PIC XX.
  4245             20  CF-HI-BEN-IN-REC           PIC XX.
  4246         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4247             20  FILLER                     PIC XXX.
  4248             20  CF-CARRIER-CNTL            PIC X.
  4249         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4250             20  FILLER                     PIC XX.
  4251             20  CF-HI-TYPE-IN-REC          PIC 99.
  4252         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4253             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4254                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4255             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4256             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4257         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4258             20  FILLER                     PIC X.
  4259             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4260         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4261             20  FILLER                     PIC XX.
  4262             20  CF-MORTGAGE-PLAN           PIC XX.
  4263         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4264
  4265     12  CF-LAST-MAINT-DT                   PIC XX.
  4266     12  CF-LAST-MAINT-BY                   PIC X(4).
  4267     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4268
  4269     12  CF-RECORD-BODY                     PIC X(728).
  4270
  4271
  4272****************************************************************
  4273*             COMPANY MASTER RECORD                            *
  4274****************************************************************
  4275
  4276     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4277         16  CF-COMPANY-ADDRESS.
  4278             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4279             20  CF-CL-IN-CARE-OF           PIC X(30).
  4280             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4281             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4282             20  CF-CL-CITY-STATE           PIC X(30).
  4283             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4284             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  84
* EL156.cbl
  4285         16  CF-COMPANY-CD                  PIC X.
  4286         16  CF-COMPANY-PASSWORD            PIC X(8).
  4287         16  CF-SECURITY-OPTION             PIC X.
  4288             88  ALL-SECURITY                   VALUE '1'.
  4289             88  COMPANY-VERIFY                 VALUE '2'.
  4290             88  PROCESSOR-VERIFY               VALUE '3'.
  4291             88  NO-SECURITY                    VALUE '4'.
  4292             88  ALL-BUT-TERM                   VALUE '5'.
  4293         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4294             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4295         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4296             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4297         16  CF-INFORCE-LOCATION            PIC X.
  4298             88  CERTS-ARE-ONLINE               VALUE '1'.
  4299             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4300             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4301         16  CF-LOWER-CASE-LETTERS          PIC X.
  4302         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4303             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4304             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4305             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4306             88  CF-ACCNT-CNTL                  VALUE '3'.
  4307             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4308
  4309         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4310         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4311
  4312         16  CF-LGX-CREDIT-USER             PIC X.
  4313             88  CO-IS-NOT-USER                 VALUE 'N'.
  4314             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4315
  4316         16 CF-CREDIT-CALC-CODES.
  4317             20  CF-CR-REM-TERM-CALC PIC X.
  4318               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4319               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4320               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4321               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4322               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4323               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4324               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4325             20  CF-CR-R78-METHOD           PIC X.
  4326               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4327               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4328
  4329         16  CF-CLAIM-CONTROL-COUNTS.
  4330             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4331                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4332
  4333             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4334                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4335
  4336             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4337                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4338
  4339             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4340                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4341
  4342         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  85
* EL156.cbl
  4343
  4344         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4345             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4346             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4347             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4348             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4349                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4350                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4351             20  CF-CO-PREM-REJECT-SW       PIC X.
  4352                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4353                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4354             20  CF-CO-REF-REJECT-SW        PIC X.
  4355                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4356                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4357
  4358         16  CF-CO-REPORTING-DT             PIC XX.
  4359         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4360         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4361           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4362           88  CF-CO-MONTH-END                  VALUE '1'.
  4363
  4364         16  CF-LGX-CLAIM-USER              PIC X.
  4365             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4366             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4367
  4368         16  CF-CREDIT-EDIT-CONTROLS.
  4369             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4370             20  CF-MIN-AGE                 PIC 99.
  4371             20  CF-DEFAULT-AGE             PIC 99.
  4372             20  CF-MIN-TERM                PIC S999      COMP-3.
  4373             20  CF-MAX-TERM                PIC S999      COMP-3.
  4374             20  CF-DEFAULT-SEX             PIC X.
  4375             20  CF-JOINT-AGE-INPUT         PIC X.
  4376                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4377             20  CF-BIRTH-DATE-INPUT        PIC X.
  4378                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4379             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4380                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4381                 88  CF-ZERO-CARRIER            VALUE '1'.
  4382                 88  CF-ZERO-GROUPING           VALUE '2'.
  4383                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4384             20  CF-EDIT-SW                 PIC X.
  4385                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4386             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4387             20  CF-CR-PR-METHOD            PIC X.
  4388               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4389               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4390             20  FILLER                     PIC X.
  4391
  4392         16  CF-CREDIT-MISC-CONTROLS.
  4393             20  CF-REIN-TABLE-SW           PIC X.
  4394                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4395             20  CF-COMP-TABLE-SW           PIC X.
  4396                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4397             20  CF-EXPERIENCE-RETENTION-AGE
  4398                                            PIC S9        COMP-3.
  4399             20  CF-CONVERSION-DT           PIC XX.
  4400             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  86
* EL156.cbl
  4401             20  CF-RUN-FREQUENCY-SW        PIC X.
  4402                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4403                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4404
  4405             20  CF-CR-CHECK-NO-CONTROL.
  4406                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4407                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4408                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4409                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4410                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4411                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4412
  4413                 24  CF-CR-CHECK-COUNT       REDEFINES
  4414                     CF-CR-CHECK-COUNTER      PIC X(4).
  4415
  4416                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4417                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4418
  4419                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4420                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4421                 24  CF-MAIL-PROCESSING       PIC X.
  4422                     88  MAIL-PROCESSING          VALUE 'Y'.
  4423
  4424         16  CF-MISC-SYSTEM-CONTROL.
  4425             20  CF-SYSTEM-C                 PIC X.
  4426                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4427             20  CF-SYSTEM-D                 PIC X.
  4428                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4429             20  CF-SOC-SEC-NO-SW            PIC X.
  4430                 88  SOC-SEC-NO-USED             VALUE '1'.
  4431             20  CF-MEMBER-NO-SW             PIC X.
  4432                 88  MEMBER-NO-USED              VALUE '1'.
  4433             20  CF-TAX-ID-NUMBER            PIC X(11).
  4434             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4435             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4436                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4437                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4438                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4439                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4440             20  CF-SYSTEM-E                 PIC X.
  4441                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4442
  4443         16  CF-LGX-LIFE-USER               PIC X.
  4444             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4445             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4446
  4447         16  CF-CR-MONTH-END-DT             PIC XX.
  4448
  4449         16  CF-FILE-MAINT-DATES.
  4450             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4451                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4452             20  CF-LAST-BATCH       REDEFINES
  4453                 CF-LAST-BATCH-NO               PIC X(4).
  4454             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4455             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4456             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4457             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4458             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  87
* EL156.cbl
  4459             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4460             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4461             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4462             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4463             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4464
  4465         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4466         16  FILLER                         PIC X.
  4467
  4468         16  CF-ALT-MORT-CODE               PIC X(4).
  4469         16  CF-MEMBER-CAPTION              PIC X(10).
  4470
  4471         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4472             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4473             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4474             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4475             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4476             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4477
  4478         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4479
  4480         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4481         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4482         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4483         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4484
  4485         16  CF-AH-OVERRIDE-L1              PIC X.
  4486         16  CF-AH-OVERRIDE-L2              PIC XX.
  4487         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4488         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4489
  4490         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4491         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4492
  4493         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4494         16  CF-AR-LAST-EL860-DT            PIC XX.
  4495         16  CF-MP-MONTH-END-DT             PIC XX.
  4496
  4497         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4498         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4499             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4500
  4501         16  CF-AR-MONTH-END-DT             PIC XX.
  4502
  4503         16  CF-CRDTCRD-USER                PIC X.
  4504             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4505             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4506
  4507         16  CF-CC-MONTH-END-DT             PIC XX.
  4508
  4509         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4510
  4511         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4512             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4513             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4514             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4515         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4516         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  88
* EL156.cbl
  4517         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4518         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4519             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4520             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4521         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4522         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4523         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4524             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4525         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4526
  4527         16  CF-CL-ZIP-CODE.
  4528             20  CF-CL-ZIP-PRIME.
  4529                 24  CF-CL-ZIP-1ST          PIC X.
  4530                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4531                 24  FILLER                 PIC X(4).
  4532             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4533         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4534             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4535             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4536             20  FILLER                     PIC XXX.
  4537
  4538         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4539         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4540         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4541         16  CF-CO-OPTION-START-DATE        PIC XX.
  4542         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4543           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4544                                                      '3' '4'.
  4545           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4546           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4547           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4548           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4549           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4550           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4551
  4552         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4553
  4554         16  CF-PAYMENT-APPROVAL-LEVELS.
  4555             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4556             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4557             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4558             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4559             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4560             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4561
  4562         16  CF-END-USER-REPORTING-USER     PIC X.
  4563             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4564             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4565
  4566         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4567             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4568             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4569
  4570         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4571
  4572         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4573         16  FILLER                         PIC X.
  4574
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  89
* EL156.cbl
  4575         16  CF-CREDIT-ARCHIVE-CNTL.
  4576             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4577             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4578             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4579
  4580         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4581
  4582         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4583             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4584             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4585
  4586         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4587             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4588             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4589
  4590         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4591
  4592         16  CF-CO-ACH-ID-CODE              PIC  X.
  4593             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4594             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4595             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4596         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4597         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4598         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4599         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4600         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4601         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4602         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4603         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4604         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4605                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4606         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4607                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4608
  4609         16  CF-CO-OVER-SHORT.
  4610             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4611             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4612
  4613*         16  FILLER                         PIC X(102).
  4614         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4615             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4616             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4617
  4618         16  CF-AH-APPROVAL-DAYS.
  4619             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4620             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4621             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4622             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4623
  4624         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4625
  4626         16  CF-APPROV-LEV-5.
  4627             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4628             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4629             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4630
  4631         16  FILLER                         PIC X(68).
  4632****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  90
* EL156.cbl
  4633*             PROCESSOR/USER RECORD                            *
  4634****************************************************************
  4635
  4636     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4637         16  CF-PROCESSOR-NAME              PIC X(30).
  4638         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4639         16  CF-PROCESSOR-TITLE             PIC X(26).
  4640         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4641                 88  MESSAGE-YES                VALUE 'Y'.
  4642                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4643
  4644*****************************************************
  4645****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4646****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4647****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4648****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4649*****************************************************
  4650
  4651         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4652             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4653             20  CF-APPLICATION-FORCE       PIC X.
  4654             20  CF-INDIVIDUAL-APP.
  4655                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4656                     28  CF-BROWSE-APP      PIC X.
  4657                     28  CF-UPDATE-APP      PIC X.
  4658
  4659         16  CF-CURRENT-TERM-ON             PIC X(4).
  4660         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4661             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4662             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4663             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4664             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4665             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4666             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4667             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4668         16  CF-PROCESSOR-CARRIER           PIC X.
  4669             88  NO-CARRIER-SECURITY            VALUE ' '.
  4670         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4671             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4672         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4673             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4674         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4675             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4676
  4677         16  CF-PROC-SYS-ACCESS-SW.
  4678             20  CF-PROC-CREDIT-CLAIMS-SW.
  4679                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4680                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4681                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4682                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4683             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4684                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4685                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4686             20  CF-PROC-LIFE-GNRLDGR-SW.
  4687                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4688                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4689                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4690                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  91
* EL156.cbl
  4691             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4692                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4693                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4694         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4695             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4696             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4697         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4698
  4699         16  CF-APPROVAL-LEVEL                  PIC X.
  4700             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4701             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4702             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4703             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4704             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4705
  4706         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4707
  4708         16  CF-LANGUAGE-TYPE                   PIC X.
  4709             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4710             88  CF-LANG-IS-FR                      VALUE 'F'.
  4711
  4712         16  CF-CSR-IND                         PIC X.
  4713         16  FILLER                             PIC X(239).
  4714
  4715****************************************************************
  4716*             PROCESSOR/REMINDERS RECORD                       *
  4717****************************************************************
  4718
  4719     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4720         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4721             20  CF-START-REMIND-DT         PIC XX.
  4722             20  CF-END-REMIND-DT           PIC XX.
  4723             20  CF-REMINDER-TEXT           PIC X(50).
  4724         16  FILLER                         PIC X(296).
  4725
  4726
  4727****************************************************************
  4728*             STATE MASTER RECORD                              *
  4729****************************************************************
  4730
  4731     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4732         16  CF-STATE-ABBREVIATION          PIC XX.
  4733         16  CF-STATE-NAME                  PIC X(25).
  4734         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4735         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4736             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4737             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4738             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4739             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4740                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4741                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4742             20  CF-ST-PREM-REJECT-SW       PIC X.
  4743                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4744                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4745             20  CF-ST-REF-REJECT-SW        PIC X.
  4746                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4747                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4748         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  92
* EL156.cbl
  4749         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4750         16  CF-ST-REFUND-RULES.
  4751             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4752             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4753             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4754         16  CF-ST-FST-PMT-EXTENSION.
  4755             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4756             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4757                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4758                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4759                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4760                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4761         16  CF-ST-STATE-CALL.
  4762             20  CF-ST-CALL-UNEARNED        PIC X.
  4763             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4764             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4765         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4766             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4767             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4768         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4769         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4770         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4771         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4772         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4773         16  FILLER                         PIC X.
  4774         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4775             20  CF-ST-BENEFIT-CD           PIC XX.
  4776             20  CF-ST-BENEFIT-KIND         PIC X.
  4777                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4778                 88  CF-ST-AH-KIND              VALUE 'A'.
  4779             20  CF-ST-REM-TERM-CALC        PIC X.
  4780                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4781                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4782                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4783                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4784                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4785                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4786                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4787                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4788
  4789             20  CF-ST-REFUND-CALC          PIC X.
  4790                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4791                 88  ST-REFD-BY-R78             VALUE '1'.
  4792                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4793                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4794                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4795                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4796                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4797                 88  ST-REFD-UTAH               VALUE '7'.
  4798                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4799                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4800                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4801
  4802             20  CF-ST-EARNING-CALC         PIC X.
  4803                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4804                 88  ST-EARN-BY-R78             VALUE '1'.
  4805                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4806                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  93
* EL156.cbl
  4807                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4808                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4809                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4810                 88  ST-EARN-MEAN               VALUE '8'.
  4811                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4812
  4813             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4814                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4815                 88  ST-OVRD-BY-R78             VALUE '1'.
  4816                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4817                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4818                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4819                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4820                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4821                 88  ST-OVRD-MEAN               VALUE '8'.
  4822                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4823             20  cf-st-extra-periods        pic 9.
  4824*            20  FILLER                     PIC X.
  4825
  4826         16  CF-ST-COMMISSION-CAPS.
  4827             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4828             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4829             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4830             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4831         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4832                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4833                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4834                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4835
  4836         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4837
  4838         16  CF-ST-STATUTORY-INTEREST.
  4839             20  CF-ST-STAT-DATE-FROM       PIC X.
  4840                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4841                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4842             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4843             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4844             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4845             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4846             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4847
  4848         16  CF-ST-OVER-SHORT.
  4849             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4850             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4851
  4852         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4853
  4854         16  CF-ST-RT-CALC                  PIC X.
  4855
  4856         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4857         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4858         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4859         16  CF-ST-RF-LR-CALC               PIC X.
  4860         16  CF-ST-RF-LL-CALC               PIC X.
  4861         16  CF-ST-RF-LN-CALC               PIC X.
  4862         16  CF-ST-RF-AH-CALC               PIC X.
  4863         16  CF-ST-RF-CP-CALC               PIC X.
  4864*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  94
* EL156.cbl
  4865*CIDMOD         16  FILLER                         PIC X(192).
  4866         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4867             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4868         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4869         16  CF-ST-VFY-2ND-BENE             PIC X.
  4870         16  CF-ST-CAUSAL-STATE             PIC X.
  4871         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4872         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4873         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4874             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4875         16  CF-ST-NET-ONLY-STATE           PIC X.
  4876             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4877         16  cf-commission-cap-required     pic x.
  4878         16  CF-ST-GA-COMMISSION-CAPS.
  4879             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4880             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4881             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4882             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4883         16  CF-ST-TOT-COMMISSION-CAPS.
  4884             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4885             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4886             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4887             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4888         16  FILLER                         PIC X(156).
  4889
  4890****************************************************************
  4891*             BENEFIT MASTER RECORD                            *
  4892****************************************************************
  4893
  4894     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4895         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4896             20  CF-BENEFIT-CODE            PIC XX.
  4897             20  CF-BENEFIT-NUMERIC  REDEFINES
  4898                 CF-BENEFIT-CODE            PIC XX.
  4899             20  CF-BENEFIT-ALPHA           PIC XXX.
  4900             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4901             20  CF-BENEFIT-COMMENT         PIC X(10).
  4902
  4903             20  CF-LF-COVERAGE-TYPE        PIC X.
  4904                 88  CF-REDUCING                VALUE 'R'.
  4905                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4906
  4907             20  CF-SPECIAL-CALC-CD         PIC X.
  4908                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4909                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4910                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4911                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4912                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4913                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4914                 88  CF-FARM-PLAN               VALUE 'F'.
  4915                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4916                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4917                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4918                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4919                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4920                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4921                 88  CF-PRUDENTIAL              VALUE 'P'.
  4922                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  95
* EL156.cbl
  4923                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4924                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4925                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4926                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4927                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4928
  4929             20  CF-JOINT-INDICATOR         PIC X.
  4930                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4931
  4932*            20  FILLER                     PIC X(12).
  4933             20  cf-maximum-benefits        pic s999 comp-3.
  4934             20  FILLER                     PIC X(09).
  4935             20  CF-BENEFIT-CATEGORY        PIC X.
  4936             20  CF-LOAN-TYPE               PIC X(8).
  4937
  4938             20  CF-CO-REM-TERM-CALC        PIC X.
  4939                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4940                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4941                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4942                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4943                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4944
  4945             20  CF-CO-EARNINGS-CALC        PIC X.
  4946                 88  CO-EARN-BY-R78             VALUE '1'.
  4947                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4948                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4949                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4950                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4951                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4952                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4953                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4954
  4955             20  CF-CO-REFUND-CALC          PIC X.
  4956                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4957                 88  CO-REFD-BY-R78             VALUE '1'.
  4958                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4959                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4960                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4961                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4962                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4963                 88  CO-REFD-MEAN               VALUE '8'.
  4964                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4965                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4966                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4967
  4968             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4969                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4970                 88  CO-OVRD-BY-R78             VALUE '1'.
  4971                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4972                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4973                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4974                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4975                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4976                 88  CO-OVRD-MEAN               VALUE '8'.
  4977                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4978
  4979             20  CF-CO-BEN-I-G-CD           PIC X.
  4980                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  96
* EL156.cbl
  4981                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4982                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4983
  4984         16  FILLER                         PIC X(304).
  4985
  4986
  4987****************************************************************
  4988*             CARRIER MASTER RECORD                            *
  4989****************************************************************
  4990
  4991     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4992         16  CF-ADDRESS-DATA.
  4993             20  CF-MAIL-TO-NAME            PIC X(30).
  4994             20  CF-IN-CARE-OF              PIC X(30).
  4995             20  CF-ADDRESS-LINE-1          PIC X(30).
  4996             20  CF-ADDRESS-LINE-2          PIC X(30).
  4997             20  CF-CITY-STATE              PIC X(30).
  4998             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4999             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5000
  5001         16  CF-CLAIM-NO-CONTROL.
  5002             20  CF-CLAIM-NO-METHOD         PIC X.
  5003                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5004                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5005                 88  CLAIM-NO-SEQ               VALUE '3'.
  5006                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5007             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5008                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5009                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5010                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5011
  5012         16  CF-CHECK-NO-CONTROL.
  5013             20  CF-CHECK-NO-METHOD         PIC X.
  5014                 88  CHECK-NO-MANUAL            VALUE '1'.
  5015                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5016                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5017                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5018             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5019                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5020
  5021         16  CF-DOMICILE-STATE              PIC XX.
  5022
  5023         16  CF-EXPENSE-CONTROLS.
  5024             20  CF-EXPENSE-METHOD          PIC X.
  5025                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5026                 88  DOLLARS-PER-PMT            VALUE '2'.
  5027                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5028                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5029             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5030             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5031
  5032         16  CF-CORRESPONDENCE-CONTROL.
  5033             20  CF-LETTER-RESEND-OPT       PIC X.
  5034                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5035                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5036             20  FILLER                     PIC X(4).
  5037
  5038         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  97
* EL156.cbl
  5039             20  CF-MANUAL-SW               PIC X.
  5040                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5041             20  CF-FUTURE-SW               PIC X.
  5042                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5043             20  CF-PTC-SW                  PIC X.
  5044                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5045             20  CF-IBNR-SW                 PIC X.
  5046                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5047             20  CF-PTC-LF-SW               PIC X.
  5048                 88  CF-LF-PTC-USED             VALUE '1'.
  5049             20  CF-CDT-ACCESS-METHOD       PIC X.
  5050                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5051                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5052                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5053             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5054
  5055         16  CF-CLAIM-CALC-METHOD           PIC X.
  5056             88  360-PLUS-MONTHS                VALUE '1'.
  5057             88  365-PLUS-MONTHS                VALUE '2'.
  5058             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5059             88  360-DAILY                      VALUE '4'.
  5060             88  365-DAILY                      VALUE '5'.
  5061
  5062         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5063         16  FILLER                         PIC X(11).
  5064
  5065         16  CF-LIMIT-AMOUNTS.
  5066             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5067             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5068             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5069             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5070             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5071             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5072             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5073             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5074             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5075             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5076
  5077         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5078         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5079         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5080
  5081         16  CF-ZIP-CODE.
  5082             20  CF-ZIP-PRIME.
  5083                 24  CF-ZIP-1ST             PIC X.
  5084                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5085                 24  FILLER                 PIC X(4).
  5086             20  CF-ZIP-PLUS4               PIC X(4).
  5087         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5088             20  CF-CAN-POSTAL-1            PIC XXX.
  5089             20  CF-CAN-POSTAL-2            PIC XXX.
  5090             20  FILLER                     PIC XXX.
  5091
  5092         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5093         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5094         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5095
  5096         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  98
* EL156.cbl
  5097             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5098             88  CF-NO-RATING                   VALUE 'N'.
  5099
  5100         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5101
  5102         16  CF-CARRIER-OVER-SHORT.
  5103             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5104             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5105
  5106         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5107         16  CF-SECPAY-SWITCH               PIC X.
  5108             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5109             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5110         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5111         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5112         16  FILLER                         PIC X(444).
  5113*        16  FILLER                         PIC X(452).
  5114
  5115
  5116****************************************************************
  5117*             MORTALITY MASTER RECORD                          *
  5118****************************************************************
  5119
  5120     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5121         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5122                                INDEXED BY CF-MORT-NDX.
  5123             20  CF-MORT-TABLE              PIC X(5).
  5124             20  CF-MORT-TABLE-TYPE         PIC X.
  5125                 88  CF-MORT-JOINT              VALUE 'J'.
  5126                 88  CF-MORT-SINGLE             VALUE 'S'.
  5127                 88  CF-MORT-COMBINED           VALUE 'C'.
  5128                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5129                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5130             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5131             20  CF-MORT-AGE-METHOD         PIC XX.
  5132                 88  CF-AGE-LAST                VALUE 'AL'.
  5133                 88  CF-AGE-NEAR                VALUE 'AN'.
  5134             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5135             20  CF-MORT-ADJUSTMENT-DIRECTION
  5136                                            PIC X.
  5137                 88  CF-MINUS                   VALUE '-'.
  5138                 88  CF-PLUS                    VALUE '+'.
  5139             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5140             20  CF-MORT-JOINT-CODE         PIC X.
  5141                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5142             20  CF-MORT-PC-Q               PIC X.
  5143                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5144             20  CF-MORT-TABLE-CODE         PIC X(4).
  5145             20  CF-MORT-COMMENTS           PIC X(15).
  5146             20  FILLER                     PIC X(14).
  5147
  5148         16  FILLER                         PIC X(251).
  5149
  5150
  5151****************************************************************
  5152*             BUSSINESS TYPE MASTER RECORD                     *
  5153****************************************************************
  5154
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page  99
* EL156.cbl
  5155     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5156* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5157* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5158* AND RECORD 05 IS TYPES 81-99
  5159         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5160             20  CF-BUSINESS-TITLE          PIC  X(19).
  5161             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5162                                            PIC S9V9(4) COMP-3.
  5163             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5164             20  FILLER                     PIC  X.
  5165         16  FILLER                         PIC  X(248).
  5166
  5167
  5168****************************************************************
  5169*             TERMINAL MASTER RECORD                           *
  5170****************************************************************
  5171
  5172     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5173
  5174         16  CF-COMPANY-TERMINALS.
  5175             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5176                                  PIC X(4).
  5177         16  FILLER               PIC X(248).
  5178
  5179
  5180****************************************************************
  5181*             LIFE EDIT MASTER RECORD                          *
  5182****************************************************************
  5183
  5184     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5185         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5186             20  CF-LIFE-CODE-IN            PIC XX.
  5187             20  CF-LIFE-CODE-OUT           PIC XX.
  5188         16  FILLER                         PIC X(248).
  5189
  5190
  5191****************************************************************
  5192*             AH EDIT MASTER RECORD                            *
  5193****************************************************************
  5194
  5195     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5196         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5197             20  CF-AH-CODE-IN              PIC XXX.
  5198             20  CF-AH-CODE-OUT             PIC XX.
  5199         16  FILLER                         PIC X(248).
  5200
  5201
  5202****************************************************************
  5203*             CREDIBILITY TABLES                               *
  5204****************************************************************
  5205
  5206     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5207         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5208                             INDEXED BY CF-CRDB-NDX.
  5209             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5210             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5211             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5212         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 100
* EL156.cbl
  5213
  5214
  5215****************************************************************
  5216*             REPORT CUSTOMIZATION RECORD                      *
  5217****************************************************************
  5218
  5219     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5220         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5221             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5222             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5223             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5224**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5225****       A T-TRANSFER.                                   ****
  5226             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5227
  5228         16  FILLER                         PIC XX.
  5229
  5230         16  CF-CARRIER-CNTL-OPT.
  5231             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5232                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5233                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5234             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5235                                            PIC X.
  5236         16  CF-GROUP-CNTL-OPT.
  5237             20  CF-GROUP-OPT-SEQ           PIC 9.
  5238                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5239                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5240             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5241                                            PIC X(6).
  5242         16  CF-STATE-CNTL-OPT.
  5243             20  CF-STATE-OPT-SEQ           PIC 9.
  5244                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5245                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5246             20  CF-STATE-SELECT OCCURS 3 TIMES
  5247                                            PIC XX.
  5248         16  CF-ACCOUNT-CNTL-OPT.
  5249             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5250                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5251                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5252             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5253                                            PIC X(10).
  5254         16  CF-BUS-TYP-CNTL-OPT.
  5255             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5256                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5257                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5258             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5259                                            PIC XX.
  5260         16  CF-LF-TYP-CNTL-OPT.
  5261             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5262                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5263                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5264             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5265                                            PIC XX.
  5266         16  CF-AH-TYP-CNTL-OPT.
  5267             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5268                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5269                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5270             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 101
* EL156.cbl
  5271                                            PIC XX.
  5272         16  CF-REPTCD1-CNTL-OPT.
  5273             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5274                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5275                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5276             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5277                                            PIC X(10).
  5278         16  CF-REPTCD2-CNTL-OPT.
  5279             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5280                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5281                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5282             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5283                                            PIC X(10).
  5284         16  CF-USER1-CNTL-OPT.
  5285             20  CF-USER1-OPT-SEQ           PIC 9.
  5286                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5287                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5288             20  CF-USER1-SELECT OCCURS 3 TIMES
  5289                                            PIC X(10).
  5290         16  CF-USER2-CNTL-OPT.
  5291             20  CF-USER2-OPT-SEQ           PIC 9.
  5292                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5293                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5294             20  CF-USER2-SELECT OCCURS 3 TIMES
  5295                                            PIC X(10).
  5296         16  CF-USER3-CNTL-OPT.
  5297             20  CF-USER3-OPT-SEQ           PIC 9.
  5298                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5299                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5300             20  CF-USER3-SELECT OCCURS 3 TIMES
  5301                                            PIC X(10).
  5302         16  CF-USER4-CNTL-OPT.
  5303             20  CF-USER4-OPT-SEQ           PIC 9.
  5304                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5305                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5306             20  CF-USER4-SELECT OCCURS 3 TIMES
  5307                                            PIC X(10).
  5308         16  CF-USER5-CNTL-OPT.
  5309             20  CF-USER5-OPT-SEQ           PIC 9.
  5310                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5311                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5312             20  CF-USER5-SELECT OCCURS 3 TIMES
  5313                                            PIC X(10).
  5314         16  CF-REINS-CNTL-OPT.
  5315             20  CF-REINS-OPT-SEQ           PIC 9.
  5316                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5317                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5318             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5319                 24  CF-REINS-PRIME         PIC XXX.
  5320                 24  CF-REINS-SUB           PIC XXX.
  5321
  5322         16  CF-AGENT-CNTL-OPT.
  5323             20  CF-AGENT-OPT-SEQ           PIC 9.
  5324                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5325                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5326             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5327                                            PIC X(10).
  5328
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 102
* EL156.cbl
  5329         16  FILLER                         PIC X(43).
  5330
  5331         16  CF-LOSS-RATIO-SELECT.
  5332             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5333             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5334         16  CF-ENTRY-DATE-SELECT.
  5335             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5336             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5337         16  CF-EFFECTIVE-DATE-SELECT.
  5338             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5339             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5340
  5341         16  CF-EXCEPTION-LIST-IND          PIC X.
  5342             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5343
  5344         16  FILLER                         PIC X(318).
  5345
  5346****************************************************************
  5347*                  EXCEPTION REPORTING RECORD                  *
  5348****************************************************************
  5349
  5350     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5351         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5352             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5353
  5354         16  CF-COMBINED-LIFE-AH-OPT.
  5355             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5356             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5357             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5358             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5359
  5360         16  CF-LIFE-OPT.
  5361             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5362             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5363             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5364             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5365             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5366             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5367             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5368             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5369             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5370             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5371
  5372         16  CF-AH-OPT.
  5373             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5374             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5375             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5376             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5377             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5378             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5379             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5380             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5381             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5382             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5383
  5384         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5385             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5386             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 103
* EL156.cbl
  5387             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5388
  5389         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5390
  5391         16  FILLER                         PIC X(673).
  5392
  5393
  5394****************************************************************
  5395*             MORTGAGE SYSTEM PLAN RECORD                      *
  5396****************************************************************
  5397
  5398     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5399         16  CF-PLAN-TYPE                   PIC X.
  5400             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5401             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5402             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5403         16  CF-PLAN-ABBREV                 PIC XXX.
  5404         16  CF-PLAN-DESCRIPT               PIC X(10).
  5405         16  CF-PLAN-NOTES                  PIC X(20).
  5406         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5407         16  CF-PLAN-UNDERWRITING.
  5408             20  CF-PLAN-TERM-DATA.
  5409                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5410                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5411             20  CF-PLAN-AGE-DATA.
  5412                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5413                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5414                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5415             20  CF-PLAN-BENEFIT-DATA.
  5416                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5417                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5418                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5419                                            PIC S9(7)V99  COMP-3.
  5420         16  CF-PLAN-POLICY-FORMS.
  5421             20  CF-POLICY-FORM             PIC X(12).
  5422             20  CF-MASTER-APPLICATION      PIC X(12).
  5423             20  CF-MASTER-POLICY           PIC X(12).
  5424         16  CF-PLAN-RATING.
  5425             20  CF-RATE-CODE               PIC X(5).
  5426             20  CF-SEX-RATING              PIC X.
  5427                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5428                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5429             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5430             20  CF-SUB-STD-TYPE            PIC X.
  5431                 88  CF-PCT-OF-PREM            VALUE '1'.
  5432                 88  CF-PCT-OF-BENE            VALUE '2'.
  5433         16  CF-PLAN-PREM-TOLERANCES.
  5434             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5435             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5436         16  CF-PLAN-PYMT-TOLERANCES.
  5437             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5438             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5439         16  CF-PLAN-MISC-DATA.
  5440             20  FILLER                     PIC X.
  5441             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5442             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5443         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5444         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 104
* EL156.cbl
  5445             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5446                                                     '1'.
  5447             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5448                                                     '2'.
  5449         16  CF-MIB-SEARCH-SW               PIC X.
  5450             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5451             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5452             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5453             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5454         16  CF-ALPHA-SEARCH-SW             PIC X.
  5455             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5456             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5457             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5458             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5459             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5460             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5461             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5462             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5463             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5464             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5465                                                     'A' 'B' 'C'
  5466                                                     'X' 'Y' 'Z'.
  5467         16  CF-EFF-DT-RULE-SW              PIC X.
  5468             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5469             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5470             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5471             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5472             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5473         16  FILLER                         PIC X(4).
  5474         16  CF-HEALTH-QUESTIONS            PIC X.
  5475             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5476         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5477         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5478         16  CF-PLAN-SNGL-JNT               PIC X.
  5479             88  CF-COMBINED-PLAN              VALUE 'C'.
  5480             88  CF-JNT-PLAN                   VALUE 'J'.
  5481             88  CF-SNGL-PLAN                  VALUE 'S'.
  5482         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5483         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5484         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5485         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5486         16  CF-RERATE-CNTL                 PIC  X.
  5487             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5488             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5489             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5490             88  CF-AUTO-RECALC                 VALUE '4'.
  5491         16  CF-BENEFIT-TYPE                PIC  X.
  5492             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5493             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5494         16  CF-POLICY-FEE                  PIC S999V99
  5495                                                    COMP-3.
  5496         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5497         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5498         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5499         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5500         16  FILLER                         PIC  X(32).
  5501         16  CF-TERMINATION-FORM            PIC  X(04).
  5502         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 105
* EL156.cbl
  5503         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5504                                                       COMP-3.
  5505         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5506         16  CF-ISSUE-LETTER                PIC  X(4).
  5507         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5508         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5509             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5510             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5511         16  CF-MP-REFUND-CALC              PIC X.
  5512             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5513             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5514             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5515             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5516             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5517             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5518             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5519             88  CF-MP-REFD-MEAN                VALUE '8'.
  5520         16  CF-ALT-RATE-CODE               PIC  X(5).
  5521
  5522
  5523         16  FILLER                         PIC X(498).
  5524****************************************************************
  5525*             MORTGAGE COMPANY MASTER RECORD                   *
  5526****************************************************************
  5527
  5528     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5529         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5530         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5531             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5532             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5533             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5534             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5535             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5536
  5537         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5538         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5539         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5540         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5541         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5542
  5543         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5544             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5545         16  CF-MP-RECON-USE-IND            PIC X(1).
  5546             88  CF-MP-USE-RECON             VALUE 'Y'.
  5547         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5548             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5549         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5550             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5551             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5552         16  FILLER                         PIC X(1).
  5553         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5554             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5555         16  CF-MORTG-MIB-VERSION           PIC X.
  5556             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5557             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5558             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5559         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5560             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 106
* EL156.cbl
  5561                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5562             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5563                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5564             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5565                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5566             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5567                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5568             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5569                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5570             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5571                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5572         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5573         16  FILLER                         PIC X(7).
  5574         16  CF-MORTG-DESTINATION-SYMBOL.
  5575             20  CF-MORTG-MIB-COMM          PIC X(5).
  5576             20  CF-MORTG-MIB-TERM          PIC X(5).
  5577         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5578             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5579         16  FILLER                         PIC X(03).
  5580         16  CF-MP-CHECK-NO-CONTROL.
  5581             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5582                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5583                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5584                                                ' ' LOW-VALUES.
  5585                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5586                                               VALUE '3'.
  5587         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5588         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5589         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5590             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5591                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5592             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5593                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5594             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5595                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5596             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5597                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5598             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5599                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5600             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5601                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5602         16  CF-MORTG-BILLING-AREA.
  5603             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5604                                            PIC X.
  5605         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5606         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5607         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5608         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5609             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5610             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5611         16  FILLER                         PIC X.
  5612         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5613             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5614             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5615         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5616         16  FILLER                         PIC X(8).
  5617         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5618         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 107
* EL156.cbl
  5619         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5620         16  CF-ACH-COMPANY-ID.
  5621             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5622                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5623                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5624                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5625             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5626         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5627             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5628         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5629             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5630             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5631         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5632         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5633         16  FILLER                         PIC X(536).
  5634
  5635****************************************************************
  5636*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5637****************************************************************
  5638
  5639     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5640         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5641             20  CF-FEMALE-HEIGHT.
  5642                 24  CF-FEMALE-FT           PIC 99.
  5643                 24  CF-FEMALE-IN           PIC 99.
  5644             20  CF-FEMALE-MIN-WT           PIC 999.
  5645             20  CF-FEMALE-MAX-WT           PIC 999.
  5646         16  FILLER                         PIC X(428).
  5647
  5648     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5649         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5650             20  CF-MALE-HEIGHT.
  5651                 24  CF-MALE-FT             PIC 99.
  5652                 24  CF-MALE-IN             PIC 99.
  5653             20  CF-MALE-MIN-WT             PIC 999.
  5654             20  CF-MALE-MAX-WT             PIC 999.
  5655         16  FILLER                         PIC X(428).
  5656******************************************************************
  5657*             AUTOMATIC ACTIVITY RECORD                          *
  5658******************************************************************
  5659     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5660         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5661             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5662             20  CF-SYS-LETTER-ID           PIC X(04).
  5663             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5664             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5665             20  CF-SYS-RESET-SW            PIC X(01).
  5666             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5667             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5668
  5669         16  FILLER                         PIC X(50).
  5670
  5671         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5672             20  CF-USER-ACTIVE-SW          PIC X(01).
  5673             20  CF-USER-LETTER-ID          PIC X(04).
  5674             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5675             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5676             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 108
* EL156.cbl
  5677             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5678             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5679             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5680
  5681         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 109
* EL156.cbl
  5683*    COPY ELCCERT.
  5684******************************************************************
  5685*                                                                *
  5686*                            ELCCERT.                            *
  5687*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5688*                            VMOD=2.013                          *
  5689*                                                                *
  5690*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5691*                                                                *
  5692*   FILE TYPE = VSAM,KSDS                                        *
  5693*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5694*                                                                *
  5695*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5696*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5697*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5698*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5699*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5700*                                                                *
  5701*   LOG = YES                                                    *
  5702*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5703******************************************************************
  5704*                   C H A N G E   L O G
  5705*
  5706* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5707*-----------------------------------------------------------------
  5708*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5709* EFFECTIVE    NUMBER
  5710*-----------------------------------------------------------------
  5711* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5712* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5713* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5714* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5715* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5716* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5717* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5718* 032612  CR2011110200001  PEMA  AHL CHANGES
  5719* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5720* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5721* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5722******************************************************************
  5723
  5724 01  CERTIFICATE-MASTER.
  5725     12  CM-RECORD-ID                      PIC XX.
  5726         88  VALID-CM-ID                      VALUE 'CM'.
  5727
  5728     12  CM-CONTROL-PRIMARY.
  5729         16  CM-COMPANY-CD                 PIC X.
  5730         16  CM-CARRIER                    PIC X.
  5731         16  CM-GROUPING.
  5732             20  CM-GROUPING-PREFIX        PIC X(3).
  5733             20  CM-GROUPING-PRIME         PIC X(3).
  5734         16  CM-STATE                      PIC XX.
  5735         16  CM-ACCOUNT.
  5736             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5737             20  CM-ACCOUNT-PRIME          PIC X(6).
  5738         16  CM-CERT-EFF-DT                PIC XX.
  5739         16  CM-CERT-NO.
  5740             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 110
* EL156.cbl
  5741             20  CM-CERT-SFX               PIC X.
  5742
  5743     12  CM-CONTROL-BY-NAME.
  5744         16  CM-COMPANY-CD-A1              PIC X.
  5745         16  CM-INSURED-LAST-NAME          PIC X(15).
  5746         16  CM-INSURED-INITIALS.
  5747             20  CM-INSURED-INITIAL1       PIC X.
  5748             20  CM-INSURED-INITIAL2       PIC X.
  5749
  5750     12  CM-CONTROL-BY-SSN.
  5751         16  CM-COMPANY-CD-A2              PIC X.
  5752         16  CM-SOC-SEC-NO.
  5753             20  CM-SSN-STATE              PIC XX.
  5754             20  CM-SSN-ACCOUNT            PIC X(6).
  5755             20  CM-SSN-LN3.
  5756                 25  CM-INSURED-INITIALS-A2.
  5757                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5758                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5759                 25 CM-PART-LAST-NAME-A2         PIC X.
  5760
  5761     12  CM-CONTROL-BY-CERT-NO.
  5762         16  CM-COMPANY-CD-A4              PIC X.
  5763         16  CM-CERT-NO-A4                 PIC X(11).
  5764
  5765     12  CM-CONTROL-BY-MEMB.
  5766         16  CM-COMPANY-CD-A5              PIC X.
  5767         16  CM-MEMBER-NO.
  5768             20  CM-MEMB-STATE             PIC XX.
  5769             20  CM-MEMB-ACCOUNT           PIC X(6).
  5770             20  CM-MEMB-LN4.
  5771                 25  CM-INSURED-INITIALS-A5.
  5772                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5773                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5774                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5775
  5776     12  CM-INSURED-PROFILE-DATA.
  5777         16  CM-INSURED-FIRST-NAME.
  5778             20  CM-INSURED-1ST-INIT       PIC X.
  5779             20  FILLER                    PIC X(9).
  5780         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5781         16  CM-INSURED-SEX                PIC X.
  5782             88  CM-SEX-MALE                  VALUE 'M'.
  5783             88  CM-SEX-FEMAL                 VALUE 'F'.
  5784         16  CM-INSURED-JOINT-AGE          PIC 99.
  5785         16  CM-JOINT-INSURED-NAME.
  5786             20  CM-JT-LAST-NAME           PIC X(15).
  5787             20  CM-JT-FIRST-NAME.
  5788                 24  CM-JT-1ST-INIT        PIC X.
  5789                 24  FILLER                PIC X(9).
  5790             20  CM-JT-INITIAL             PIC X.
  5791
  5792     12  CM-LIFE-DATA.
  5793         16  CM-LF-BENEFIT-CD              PIC XX.
  5794         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5795         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5796         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5797         16  CM-LF-DEV-CODE                PIC XXX.
  5798         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 111
* EL156.cbl
  5799         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5800         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5801         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5802         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5803         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5804         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5805         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5806         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5807         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5808         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5809         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5810         16  cm-temp-epiq                  pic xx.
  5811             88  EPIQ-CLASS                  value 'EQ'.
  5812*        16  FILLER                        PIC XX.
  5813
  5814     12  CM-AH-DATA.
  5815         16  CM-AH-BENEFIT-CD              PIC XX.
  5816         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5817         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5818         16  CM-AH-DEV-CODE                PIC XXX.
  5819         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5820         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5821         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5822         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5823         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5824         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5825         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5826         16  CM-AH-PAID-THRU-DT            PIC XX.
  5827             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5828         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5829         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5830         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5831         16  FILLER                        PIC X.
  5832
  5833     12  CM-LOAN-INFORMATION.
  5834         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5835         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5836                                           PIC S9(5)V99  COMP-3.
  5837         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5838         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5839         16  CM-PAY-FREQUENCY              PIC S99.
  5840         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5841         16  CM-RATE-CLASS                 PIC XX.
  5842         16  CM-BENEFICIARY                PIC X(25).
  5843         16  CM-POLICY-FORM-NO             PIC X(12).
  5844         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5845         16  CM-LAST-ADD-ON-DT             PIC XX.
  5846         16  CM-DEDUCTIBLE-AMOUNTS.
  5847             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5848             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5849         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5850             20  CM-RESIDENT-STATE         PIC XX.
  5851             20  CM-RATE-CODE              PIC X(4).
  5852             20  FILLER                    PIC XX.
  5853         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5854             20  CM-LOAN-OFFICER           PIC X(5).
  5855             20  FILLER                    PIC XXX.
  5856         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 112
* EL156.cbl
  5857         16  CM-UNDERWRITING-CODE          PIC X.
  5858             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5859         16  CM-POST-CARD-IND              PIC X.
  5860         16  CM-REF-INTERFACE-SW           PIC X.
  5861         16  CM-PREMIUM-TYPE               PIC X.
  5862             88  CM-SING-PRM                  VALUE '1'.
  5863             88  CM-O-B-COVERAGE              VALUE '2'.
  5864             88  CM-OPEN-END                  VALUE '3'.
  5865         16  CM-IND-GRP-TYPE               PIC X.
  5866             88  CM-INDIVIDUAL                VALUE 'I'.
  5867             88  CM-GROUP                     VALUE 'G'.
  5868         16  CM-SKIP-CODE                  PIC X.
  5869             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5870             88  SKIP-JULY                    VALUE '1'.
  5871             88  SKIP-AUGUST                  VALUE '2'.
  5872             88  SKIP-SEPTEMBER               VALUE '3'.
  5873             88  SKIP-JULY-AUG                VALUE '4'.
  5874             88  SKIP-AUG-SEPT                VALUE '5'.
  5875             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5876             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5877             88  SKIP-JUNE                    VALUE '8'.
  5878             88  SKIP-JUNE-JULY               VALUE '9'.
  5879             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5880             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5881         16  CM-PAYMENT-MODE               PIC X.
  5882             88  PAY-MONTHLY                  VALUE SPACE.
  5883             88  PAY-WEEKLY                   VALUE '1'.
  5884             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5885             88  PAY-BI-WEEKLY                VALUE '3'.
  5886             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5887         16  CM-LOAN-NUMBER                PIC X(8).
  5888         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5889         16  CM-OLD-LOF                    PIC XXX.
  5890*        16  CM-LOAN-OFFICER               PIC XXX.
  5891         16  CM-REIN-TABLE                 PIC XXX.
  5892         16  CM-SPECIAL-REIN-CODE          PIC X.
  5893         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5894         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5895         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5896
  5897     12  CM-STATUS-DATA.
  5898         16  CM-ENTRY-STATUS               PIC X.
  5899         16  CM-ENTRY-DT                   PIC XX.
  5900
  5901         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5902         16  CM-LF-CANCEL-DT               PIC XX.
  5903         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5904
  5905         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5906         16  CM-LF-DEATH-DT                PIC XX.
  5907         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5908
  5909         16  CM-LF-CURRENT-STATUS          PIC X.
  5910             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5911                                                'M' '4' '5' '9'.
  5912             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5913             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5914             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 113
* EL156.cbl
  5915             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5916             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5917             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5918             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5919             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5920             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5921             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5922             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5923             88  CM-LF-DECLINED               VALUE 'D'.
  5924             88  CM-LF-VOIDED                 VALUE 'V'.
  5925
  5926         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5927         16  CM-AH-CANCEL-DT               PIC XX.
  5928         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5929
  5930         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5931         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5932         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5933
  5934         16  CM-AH-CURRENT-STATUS          PIC X.
  5935             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5936                                                'M' '4' '5' '9'.
  5937             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5938             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5939             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5940             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5941             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5942             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5943             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5944             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5945             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5946             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5947             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5948             88  CM-AH-DECLINED               VALUE 'D'.
  5949             88  CM-AH-VOIDED                 VALUE 'V'.
  5950
  5951         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5952             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5953             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5954             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5955         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5956
  5957         16  CM-ENTRY-BATCH                PIC X(6).
  5958         16  CM-LF-EXIT-BATCH              PIC X(6).
  5959         16  CM-AH-EXIT-BATCH              PIC X(6).
  5960         16  CM-LAST-MONTH-END             PIC XX.
  5961
  5962     12  CM-NOTE-SW                        PIC X.
  5963         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5964         88  CERT-NOTES-PRESENT               VALUE '1'.
  5965         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5966         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5967         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5968         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5969         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5970         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5971     12  CM-COMP-EXCP-SW                   PIC X.
  5972         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 114
* EL156.cbl
  5973         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5974     12  CM-INSURED-ADDRESS-SW             PIC X.
  5975         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5976         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5977
  5978*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5979     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5980     12  FILLER                            PIC X.
  5981
  5982*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5983     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5984     12  FILLER                            PIC X.
  5985*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5986     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5987
  5988     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5989         88  CERT-ADDED-BATCH                 VALUE ' '.
  5990         88  CERT-ADDED-ONLINE                VALUE '1'.
  5991         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5992         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5993         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5994     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5995         88  CERT-AS-LOADED                   VALUE ' '.
  5996         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5997         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5998         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5999         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6000         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6001         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6002         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6003
  6004     12  CM-ACCOUNT-COMM-PCTS.
  6005         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6006         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6007
  6008     12  CM-USER-FIELD                     PIC X.
  6009     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6010     12  CM-CLP-STATE                      PIC XX.
  6011     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6012     12  CM-USER-RESERVED                  PIC XXX.
  6013     12  FILLER REDEFINES CM-USER-RESERVED.
  6014         16  CM-AH-CLASS-CD                PIC XX.
  6015         16  F                             PIC X.
  6016******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 115
* EL156.cbl
  6018*    COPY ELCTRLR.
  6019******************************************************************
  6020*                                                                *
  6021*                            ELCTRLR.                            *
  6022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6023*                            VMOD=2.014                          *
  6024*                                                                *
  6025*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  6026*                                                                *
  6027*   FILE TYPE = VSAM,KSDS                                        *
  6028*   RECORD SIZE = 200    RECFORM = FIXED                         *
  6029*                                                                *
  6030*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  6031*       ALTERNATE INDEX = NONE                                   *
  6032*                                                                *
  6033*   LOG = YES                                                    *
  6034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6035******************************************************************
  6036*                   C H A N G E   L O G
  6037*
  6038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6039*-----------------------------------------------------------------
  6040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6041* EFFECTIVE    NUMBER
  6042*-----------------------------------------------------------------
  6043* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6044* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  6045* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  6046* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  6047* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6048* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6049* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6050* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6051* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6052* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6053* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6054* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6055* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6056* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6057* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6058* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6059* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6060* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6061* 040814    2014030500002  AJRA  ADD ICD CODES
  6062* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6063* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6064* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6065* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  6066* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  6067******************************************************************
  6068 01  ACTIVITY-TRAILERS.
  6069     12  AT-RECORD-ID                    PIC XX.
  6070         88  VALID-AT-ID                       VALUE 'AT'.
  6071
  6072     12  AT-CONTROL-PRIMARY.
  6073         16  AT-COMPANY-CD               PIC X.
  6074         16  AT-CARRIER                  PIC X.
  6075         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 116
* EL156.cbl
  6076         16  AT-CERT-NO.
  6077             20  AT-CERT-PRIME           PIC X(10).
  6078             20  AT-CERT-SFX             PIC X.
  6079         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6080             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6081             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6082             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6083             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6084             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6085             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6086             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6087             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6088             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6089             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6090             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6091             88  AT-BENEFICIARY-TRL           VALUE +91.
  6092             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6093             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6094             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6095             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6096
  6097     12  AT-TRAILER-TYPE                 PIC X.
  6098         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6099         88  PAYMENT-TR                       VALUE '2'.
  6100         88  AUTO-PAY-TR                      VALUE '3'.
  6101         88  CORRESPONDENCE-TR                VALUE '4'.
  6102         88  ADDRESS-TR                       VALUE '5'.
  6103         88  GENERAL-INFO-TR                  VALUE '6'.
  6104         88  AUTO-PROMPT-TR                   VALUE '7'.
  6105         88  DENIAL-TR                        VALUE '8'.
  6106         88  INCURRED-CHG-TR                  VALUE '9'.
  6107         88  FORM-CONTROL-TR                  VALUE 'A'.
  6108
  6109     12  AT-RECORDED-DT                  PIC XX.
  6110     12  AT-RECORDED-BY                  PIC X(4).
  6111     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6112
  6113     12  AT-TRAILER-BODY                 PIC X(165).
  6114
  6115     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6116         16  AT-RESERVE-CONTROLS.
  6117             20  AT-MANUAL-SW            PIC X.
  6118                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6119             20  AT-FUTURE-SW            PIC X.
  6120                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6121             20  AT-PTC-SW               PIC X.
  6122                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6123             20  AT-IBNR-SW              PIC X.
  6124                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6125             20  AT-PTC-LF-SW            PIC X.
  6126                 88  AT-LF-PTC-USED          VALUE '1'.
  6127             20  AT-CDT-ACCESS-METHOD    PIC X.
  6128                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6129                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6130                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6131             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6132         16  AT-LAST-COMPUTED-DT         PIC XX.
  6133         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 117
* EL156.cbl
  6134         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6135         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6136         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6137         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6138         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6139         16  AT-EXPENSE-CONTROLS.
  6140             20  AT-EXPENSE-METHOD       PIC X.
  6141                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6142                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6143                 88  PERCENT-OF-PMT           VALUE '3'.
  6144                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6145             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6146             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6147         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6148         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6149
  6150         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6151         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6152
  6153*        16  FILLER                      PIC X(53).
  6154         16  FILLER                      PIC X(47).
  6155
  6156         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6157         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6158
  6159         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6160             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6161             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6162*                    C = CLOSED
  6163*                    O = OPEN
  6164             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6165*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6166
  6167     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6168         16  AT-PAYMENT-TYPE             PIC X.
  6169             88  PARTIAL-PAYMENT                VALUE '1'.
  6170             88  FINAL-PAYMENT                  VALUE '2'.
  6171             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6172             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6173             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6174             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6175             88  VOIDED-PAYMENT                 VALUE '9'.
  6176             88  TRANSFER                       VALUE 'T'.
  6177             88  LIFE-INTEREST                  VALUE 'I'.
  6178
  6179         16  AT-CLAIM-TYPE               PIC X.
  6180             88  PAID-FOR-AH                    VALUE 'A'.
  6181             88  PAID-FOR-LIFE                  VALUE 'L'.
  6182             88  PAID-FOR-IUI                   VALUE 'I'.
  6183             88  PAID-FOR-GAP                   VALUE 'G'.
  6184             88  PAID-FOR-FAM                   VALUE 'F'.
  6185             88  PAID-FOR-OTH                   VALUE 'O'.
  6186         16  AT-CLAIM-PREM-TYPE          PIC X.
  6187             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6188             88  AT-O-B-COVERAGE                VALUE '2'.
  6189             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6190         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6191         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 118
* EL156.cbl
  6192         16  AT-PAID-FROM-DT             PIC XX.
  6193         16  AT-PAID-THRU-DT             PIC XX.
  6194         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6195         16  AT-ACH-PAYMENT              PIC X.
  6196*        16  FILLER                      PIC X.
  6197         16  AT-PAYEES-NAME              PIC X(30).
  6198         16  AT-PAYMENT-ORIGIN           PIC X.
  6199             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6200             88  ONLINE-AUTO-PMT                VALUE '2'.
  6201             88  OFFLINE-PMT                    VALUE '3'.
  6202         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6203         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6204         16  AT-VOID-DATA.
  6205             20  AT-VOID-DT              PIC XX.
  6206*00144       20  AT-VOID-REASON          PIC X(30).
  6207             20  AT-VOID-REASON          PIC X(26).
  6208         16  AT-PMT-APPROVED-BY          PIC X(04).
  6209         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6210         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6211         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6212                                         PIC S99V9(5)  COMP-3.
  6213         16  AT-CREDIT-INTERFACE.
  6214             20  AT-PMT-SELECT-DT        PIC XX.
  6215                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6216             20  AT-PMT-ACCEPT-DT        PIC XX.
  6217                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6218             20  AT-VOID-SELECT-DT       PIC XX.
  6219                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6220             20  AT-VOID-ACCEPT-DT       PIC XX.
  6221                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6222
  6223         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6224                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6225                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6226         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6227
  6228         16  AT-FORCE-CONTROL            PIC X.
  6229             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6230         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6231         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6232         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6233         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6234         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6235         16  AT-BENEFIT-TYPE             PIC X.
  6236
  6237         16  AT-EXPENSE-TYPE             PIC X.
  6238         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6239
  6240         16  AT-PAYEE-TYPE-CD.
  6241             20  AT-PAYEE-TYPE           PIC X.
  6242                 88  INSURED-PAID           VALUE 'I'.
  6243                 88  BENEFICIARY-PAID       VALUE 'B'.
  6244                 88  ACCOUNT-PAID           VALUE 'A'.
  6245                 88  OTHER-1-PAID           VALUE 'O'.
  6246                 88  OTHER-2-PAID           VALUE 'Q'.
  6247                 88  DOCTOR-PAID            VALUE 'P'.
  6248                 88  EMPLOYER-PAID          VALUE 'E'.
  6249             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 119
* EL156.cbl
  6250
  6251         16  AT-CASH-PAYMENT             PIC X.
  6252         16  AT-GROUPED-PAYMENT          PIC X.
  6253         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6254         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6255         16  AT-APPROVED-LEVEL           PIC X.
  6256         16  AT-VOID-TYPE                PIC X.
  6257             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6258             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6259         16  AT-AIG-UNEMP-IND            PIC X.
  6260             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6261         16  AT-ASSOCIATES               PIC X.
  6262             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6263             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6264
  6265         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6266         16  AT-CV-PMT-CODE              PIC X.
  6267             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6268             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6269             88  FULL-ADD-PAYMENT           VALUE '3'.
  6270             88  HALF-ADD-PAYMENT           VALUE '4'.
  6271             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6272             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6273             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6274             88  ADDL-PAYMENT               VALUE '8'.
  6275
  6276         16  AT-EOB-CODE1                PIC XXX.
  6277         16  AT-EOB-CODE2                PIC XXX.
  6278         16  AT-EOB-CODE3                PIC XXX.
  6279         16  FILLER REDEFINES AT-EOB-CODE3.
  6280             20  AT-PRINT-CLM-FORM       PIC X.
  6281             20  AT-PRINT-SURVEY         PIC X.
  6282             20  AT-SPECIAL-RELEASE      PIC X.
  6283         16  AT-EOB-CODE4                PIC XXX.
  6284         16  FILLER REDEFINES AT-EOB-CODE4.
  6285             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6286             20  FILLER                  PIC X.
  6287         16  AT-EOB-CODE5                PIC XXX.
  6288         16  FILLER REDEFINES AT-EOB-CODE5.
  6289             20  AT-PMT-PROOF-DT         PIC XX.
  6290             20  FILLER                  PIC X.
  6291
  6292         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6293             88  AT-PRINT-EOB            VALUE 'Y'.
  6294
  6295         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6296         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6297
  6298     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6299         16  AT-SCHEDULE-START-DT        PIC XX.
  6300         16  AT-SCHEDULE-END-DT          PIC XX.
  6301         16  AT-TERMINATED-DT            PIC XX.
  6302         16  AT-LAST-PMT-TYPE            PIC X.
  6303             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6304             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6305         16  AT-FIRST-PMT-DATA.
  6306             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6307             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 120
* EL156.cbl
  6308             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6309         16  AT-REGULAR-PMT-DATA.
  6310             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6311             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6312             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6313         16  AT-AUTO-PAYEE-CD.
  6314             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6315                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6316                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6317                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6318                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6319                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6320             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6321         16  AT-AUTO-PAY-DAY             PIC 99.
  6322         16  AT-AUTO-CASH                PIC X.
  6323             88  AT-CASH                      VALUE 'Y'.
  6324             88  AT-NON-CASH                  VALUE 'N'.
  6325*        16  FILLER                      PIC X(129).
  6326         16  AT-AUTO-END-LETTER          PIC X(4).
  6327         16  FILLER                      PIC X(125).
  6328
  6329         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6330         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6331
  6332     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6333         16  AT-LETTER-SENT-DT           PIC XX.
  6334         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6335         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6336         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6337         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6338         16  AT-LETTER-ORIGIN            PIC X.
  6339             88  ONLINE-CREATION              VALUE '1' '3'.
  6340             88  OFFLINE-CREATION             VALUE '2' '4'.
  6341             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6342             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6343         16  AT-STD-LETTER-FORM          PIC X(4).
  6344         16  AT-REASON-TEXT              PIC X(70).
  6345         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6346         16  AT-ADDRESEE-TYPE            PIC X.
  6347              88  INSURED-ADDRESEE            VALUE 'I'.
  6348              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6349              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6350              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6351              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6352              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6353              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6354         16  AT-ADDRESSEE-NAME           PIC X(30).
  6355         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6356         16  AT-RESEND-PRINT-DATE        PIC XX.
  6357         16  AT-CORR-SOL-UNSOL           PIC X.
  6358         16  AT-LETTER-PURGED-DT         PIC XX.
  6359*
  6360*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6361*
  6362         16  AT-CSO-REDEFINITION.
  6363             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6364             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6365             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 121
* EL156.cbl
  6366             20  AT-STOP-LETTER-DT       PIC X(2).
  6367             20  AT-AUTH-RCVD            PIC X(1).
  6368             20  FILLER                  PIC X(18).
  6369*             20  FILLER                  PIC X(27).
  6370             20  AT-CSO-LETTER-STATUS    PIC X.
  6371                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6372                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6373                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6374             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6375             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6376*
  6377*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6378*
  6379*        16  FILLER                      PIC X(26).
  6380*
  6381*        16  AT-DMD-BSR-CODE             PIC X.
  6382*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6383*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6384*
  6385*        16  AT-DMD-LETTER-STATUS        PIC X.
  6386*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6387*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6388*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6389*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6390*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6391
  6392         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6393         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6394
  6395     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6396         16  AT-ADDRESS-TYPE             PIC X.
  6397             88  INSURED-ADDRESS               VALUE 'I'.
  6398             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6399             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6400             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6401             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6402             88  OTHER-ADDRESS-1               VALUE 'O'.
  6403             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6404         16  AT-MAIL-TO-NAME             PIC X(30).
  6405         16  AT-ADDRESS-LINE-1           PIC X(30).
  6406         16  AT-ADDRESS-LINE-2           PIC X(30).
  6407         16  AT-CITY-STATE.
  6408             20  AT-CITY                 PIC X(28).
  6409             20  AT-STATE                PIC XX.
  6410         16  AT-ZIP.
  6411             20  AT-ZIP-CODE.
  6412                 24  AT-ZIP-1ST          PIC X.
  6413                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6414                 24  FILLER              PIC X(4).
  6415             20  AT-ZIP-PLUS4            PIC X(4).
  6416         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6417             20  AT-CAN-POSTAL-1         PIC XXX.
  6418             20  AT-CAN-POSTAL-2         PIC XXX.
  6419             20  FILLER                  PIC XXX.
  6420         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6421*         16  FILLER                      PIC X(23).
  6422         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6423         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 122
* EL156.cbl
  6424         16  FILLER                      PIC X(13).
  6425         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6426         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6427
  6428     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6429         16  AT-INFO-LINE-1              PIC X(60).
  6430         16  FILLER REDEFINES AT-INFO-LINE-1.
  6431             20  AT-NOTE-ERROR-NO OCCURS 15
  6432                                         PIC X(4).
  6433         16  AT-INFO-LINE-2              PIC X(60).
  6434         16  FILLER REDEFINES AT-INFO-LINE-2.
  6435             20  AT-ICD-CODE-1           PIC X(8).
  6436             20  AT-ICD-CODE-2           PIC X(8).
  6437             20  FILLER                  PIC X(44).
  6438         16  AT-INFO-TRAILER-TYPE        PIC X.
  6439             88  AT-ERRORS-NOTE          VALUE 'E'.
  6440             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6441             88  AT-CALL-NOTE            VALUE 'C'.
  6442             88  AT-MAINT-NOTE           VALUE 'M'.
  6443             88  AT-CERT-CHANGE          VALUE 'X'.
  6444             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6445             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6446             88  AT-CERT-CANCELLED       VALUE 'T'.
  6447         16  AT-CALL-TYPE                PIC X.
  6448             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6449             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  6450             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6451         16  AT-NOTE-CONTINUATION        PIC X.
  6452             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6453         16  AT-EOB-CODES-EXIST          PIC X.
  6454             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6455         16  FILLER                      PIC X(35).
  6456         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6457         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6458
  6459     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6460         16  AT-PROMPT-LINE-1            PIC X(60).
  6461         16  AT-PROMPT-LINE-2            PIC X(60).
  6462         16  AT-PROMPT-START-DT          PIC XX.
  6463         16  AT-PROMPT-END-DT            PIC XX.
  6464         16  FILLER                      PIC X(35).
  6465         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6466         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6467
  6468     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6469         16  AT-DENIAL-INFO-1            PIC X(60).
  6470         16  AT-DENIAL-INFO-2            PIC X(60).
  6471         16  AT-DENIAL-DT                PIC XX.
  6472         16  AT-RETRACTION-DT            PIC XX.
  6473         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6474*         16  FILLER                      PIC X(31).
  6475         16  AT-DENIAL-PROOF-DT          PIC XX.
  6476         16  FILLER                      PIC X(29).
  6477         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6478         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6479
  6480     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6481         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 123
* EL156.cbl
  6482         16  AT-OLD-REPORTED-DT          PIC XX.
  6483         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6484         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6485         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6486         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6487         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6488         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6489         16  FILLER                      PIC X(26).
  6490         16  AT-OLD-DIAG-CODE            PIC X(6).
  6491         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6492         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6493         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6494         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6495         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6496         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6497         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6498         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6499         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6500         16  FILLER                      PIC X(9).
  6501         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6502
  6503     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6504         16  AT-FORM-SEND-ON-DT          PIC XX.
  6505         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6506         16  AT-FORM-RE-SEND-DT          PIC XX.
  6507         16  AT-FORM-ANSWERED-DT         PIC XX.
  6508         16  AT-FORM-PRINTED-DT          PIC XX.
  6509         16  AT-FORM-REPRINT-DT          PIC XX.
  6510         16  AT-FORM-TYPE                PIC X.
  6511             88  INITIAL-FORM                  VALUE '1'.
  6512             88  PROGRESS-FORM                 VALUE '2'.
  6513         16  AT-INSTRUCT-LN-1            PIC X(28).
  6514         16  AT-INSTRUCT-LN-2            PIC X(28).
  6515         16  AT-INSTRUCT-LN-3            PIC X(28).
  6516         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6517         16  AT-FORM-ADDRESS             PIC X.
  6518             88  FORM-TO-INSURED              VALUE 'I'.
  6519             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6520             88  FORM-TO-OTHER-1              VALUE 'O'.
  6521             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6522         16  AT-RELATED-1.
  6523             20 AT-REL-CARR-1            PIC X.
  6524             20 AT-REL-CLAIM-1           PIC X(7).
  6525             20 AT-REL-CERT-1            PIC X(11).
  6526         16  AT-RELATED-2.
  6527             20 AT-REL-CARR-2            PIC X.
  6528             20 AT-REL-CLAIM-2           PIC X(7).
  6529             20 AT-REL-CERT-2            PIC X(11).
  6530         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6531         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6532         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6533         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6534         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6535         16  AT-STOP-FORM-DT             PIC X(2).
  6536
  6537         16  FILLER                      PIC X(09).
  6538         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6539         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 124
* EL156.cbl
  6540******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 125
* EL156.cbl
  6542*    COPY ELCACTQ.
  6543******************************************************************
  6544*                                                                *
  6545*                            ELCACTQ.                            *
  6546*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6547*                            VMOD=2.004                          *
  6548*                                                                *
  6549*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6550*                                                                *
  6551*   FILE TYPE = VSAM,KSDS                                        *
  6552*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6553*                                                                *
  6554*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6555*       ALTERNATE INDEX = NONE                                   *
  6556*                                                                *
  6557*   LOG = YES                                                    *
  6558*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6559*                                                                *
  6560*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6561******************************************************************
  6562
  6563 01  ACTIVITY-QUE.
  6564     12  AQ-RECORD-ID                PIC XX.
  6565         88  VALID-AQ-ID                VALUE 'AQ'.
  6566
  6567     12  AQ-CONTROL-PRIMARY.
  6568         16  AQ-COMPANY-CD           PIC X.
  6569         16  AQ-CARRIER              PIC X.
  6570         16  AQ-CLAIM-NO             PIC X(7).
  6571         16  AQ-CERT-NO.
  6572             20  AQ-CERT-PRIME       PIC X(10).
  6573             20  AQ-CERT-SFX         PIC X.
  6574
  6575     12  AQ-PENDING-ACTIVITY-FLAGS.
  6576         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6577         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6578             88  PENDING-PAYMENTS       VALUE '1'.
  6579         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6580             88  PENDING-FULL-PRINT     VALUE '1'.
  6581             88  PENDING-PART-PRINT     VALUE '2'.
  6582         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6583             88  PENDING-LETTERS        VALUE '1'.
  6584         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6585             88  PENDING-RESTORE        VALUE 'C'.
  6586             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6587
  6588     12  FILLER                      PIC X(20).
  6589
  6590     12  AQ-RESEND-DATE              PIC XX.
  6591     12  AQ-FOLLOWUP-DATE            PIC XX.
  6592     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6593     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6594     12  AQ-AUTO-LETTER              PIC X(4).
  6595     12  FILLER                      PIC XX.
  6596     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6597*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 126
* EL156.cbl
  6599*    COPY ERCACCT.
  6600******************************************************************
  6601*                                                                *
  6602*                                                                *
  6603*                            ERCACCT                             *
  6604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6605*                            VMOD=2.031                          *
  6606*                                                                *
  6607*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6608*                                                                *
  6609*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6610*   VSAM ACCOUNT MASTER FILES.                                   *
  6611*                                                                *
  6612*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6613*                                                                *
  6614*   FILE TYPE = VSAM,KSDS                                        *
  6615*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6616*                                                                *
  6617*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6618*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6619*                                                                *
  6620*   LOG = NO                                                     *
  6621*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6622*                                                                *
  6623*                                                                *
  6624******************************************************************
  6625*                   C H A N G E   L O G
  6626*
  6627* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6628*-----------------------------------------------------------------
  6629*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6630* EFFECTIVE    NUMBER
  6631*-----------------------------------------------------------------
  6632* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6633* 092705    2005050300006  PEMA  ADD SPP LEASES
  6634* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6635* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6636* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6637* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6638* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6639* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6640******************************************************************
  6641
  6642 01  ACCOUNT-MASTER.
  6643     12  AM-RECORD-ID                      PIC XX.
  6644         88  VALID-AM-ID                      VALUE 'AM'.
  6645
  6646     12  AM-CONTROL-PRIMARY.
  6647         16  AM-COMPANY-CD                 PIC X.
  6648         16  AM-MSTR-CNTRL.
  6649             20  AM-CONTROL-A.
  6650                 24  AM-CARRIER            PIC X.
  6651                 24  AM-GROUPING.
  6652                     28 AM-GROUPING-PREFIX PIC XXX.
  6653                     28 AM-GROUPING-PRIME  PIC XXX.
  6654                 24  AM-STATE              PIC XX.
  6655                 24  AM-ACCOUNT.
  6656                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 127
* EL156.cbl
  6657                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6658             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6659                                           PIC X(19).
  6660             20  AM-CNTRL-B.
  6661                 24  AM-EXPIRATION-DT      PIC XX.
  6662                 24  FILLER                PIC X(4).
  6663             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6664                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6665
  6666     12  AM-CONTROL-BY-VAR-GRP.
  6667         16  AM-COMPANY-CD-A1              PIC X.
  6668         16  AM-VG-CARRIER                 PIC X.
  6669         16  AM-VG-GROUPING                PIC X(6).
  6670         16  AM-VG-STATE                   PIC XX.
  6671         16  AM-VG-ACCOUNT                 PIC X(10).
  6672         16  AM-VG-DATE.
  6673             20  AM-VG-EXPIRATION-DT       PIC XX.
  6674             20  FILLER                    PIC X(4).
  6675         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6676                                           PIC 9(11)      COMP-3.
  6677     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6678         16  FILLER                        PIC X(10).
  6679         16  AM-VG-KEY3.
  6680             20  AM-VG3-ACCOUNT            PIC X(10).
  6681             20  AM-VG3-EXP-DT             PIC XX.
  6682         16  FILLER                        PIC X(4).
  6683     12  AM-MAINT-INFORMATION.
  6684         16  AM-LAST-MAINT-DT              PIC XX.
  6685         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6686         16  AM-LAST-MAINT-USER            PIC X(4).
  6687         16  FILLER                        PIC XX.
  6688
  6689     12  AM-EFFECTIVE-DT                   PIC XX.
  6690     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6691
  6692     12  AM-PREV-DATES  COMP-3.
  6693         16  AM-PREV-EXP-DT                PIC 9(11).
  6694         16  AM-PREV-EFF-DT                PIC 9(11).
  6695
  6696     12  AM-REPORT-CODE-1                  PIC X(10).
  6697     12  AM-REPORT-CODE-2                  PIC X(10).
  6698
  6699     12  AM-CITY-CODE                      PIC X(4).
  6700     12  AM-COUNTY-PARISH                  PIC X(6).
  6701
  6702     12  AM-NAME                           PIC X(30).
  6703     12  AM-PERSON                         PIC X(30).
  6704     12  AM-ADDRS                          PIC X(30).
  6705     12  AM-CITY.
  6706         16  AM-ADDR-CITY                  PIC X(28).
  6707         16  AM-ADDR-STATE                 PIC XX.
  6708     12  AM-ZIP.
  6709         16  AM-ZIP-PRIME.
  6710             20  AM-ZIP-PRI-1ST            PIC X.
  6711                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6712             20  FILLER                    PIC X(4).
  6713         16  AM-ZIP-PLUS4                  PIC X(4).
  6714     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 128
* EL156.cbl
  6715         16  AM-CAN-POSTAL-1               PIC XXX.
  6716         16  AM-CAN-POSTAL-2               PIC XXX.
  6717         16  FILLER                        PIC XXX.
  6718     12  AM-TEL-NO.
  6719         16  AM-AREA-CODE                  PIC 999.
  6720         16  AM-TEL-PRE                    PIC 999.
  6721         16  AM-TEL-NBR                    PIC 9(4).
  6722     12  AM-TEL-LOC                        PIC X.
  6723         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6724         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6725
  6726     12  AM-COMM-STRUCTURE.
  6727         16  AM-DEFN-1.
  6728             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6729                 24  AM-AGT.
  6730                     28  AM-AGT-PREFIX     PIC X(4).
  6731                     28  AM-AGT-PRIME      PIC X(6).
  6732                 24  AM-COM-TYP            PIC X.
  6733                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6734                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6735                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6736                 24  AM-RECALC-LV-INDIC    PIC X.
  6737                 24  AM-RETRO-LV-INDIC     PIC X.
  6738                 24  AM-GL-CODES           PIC X.
  6739                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6740                 24  FILLER                PIC X(01).
  6741         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6742             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6743                 24  FILLER                PIC X(11).
  6744                 24  AM-L-COMA             PIC XXX.
  6745                 24  AM-J-COMA             PIC XXX.
  6746                 24  AM-A-COMA             PIC XXX.
  6747                 24  FILLER                PIC X(6).
  6748
  6749     12  AM-COMM-CHANGE-STATUS             PIC X.
  6750         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6751
  6752     12  AM-CSR-CODE                       PIC X(4).
  6753
  6754     12  AM-BILLING-STATUS                 PIC X.
  6755         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6756         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6757     12  AM-AUTO-REFUND-SW                 PIC X.
  6758         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6759         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6760     12  AM-GPCD                           PIC 99.
  6761     12  AM-IG                             PIC X.
  6762         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6763         88  AM-HAS-GROUP                     VALUE '2'.
  6764     12  AM-STATUS                         PIC X.
  6765         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6766         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6767         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6768         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6769         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6770         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6771         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6772         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 129
* EL156.cbl
  6773         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6774         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6775     12  AM-REMIT-TO                       PIC 99.
  6776     12  AM-ID-NO                          PIC X(11).
  6777
  6778     12  AM-CAL-TABLE                      PIC XX.
  6779     12  AM-LF-DEVIATION                   PIC XXX.
  6780     12  AM-AH-DEVIATION                   PIC XXX.
  6781     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6782     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6783     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6784     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6785     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6786     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6787
  6788     12  AM-USER-FIELDS.
  6789         16  AM-FLD-1                      PIC XX.
  6790         16  AM-FLD-2                      PIC XX.
  6791         16  AM-FLD-3                      PIC XX.
  6792         16  AM-FLD-4                      PIC XX.
  6793         16  AM-FLD-5                      PIC XX.
  6794
  6795     12  AM-1ST-PROD-DATE.
  6796         16  AM-1ST-PROD-YR                PIC XX.
  6797         16  AM-1ST-PROD-MO                PIC XX.
  6798         16  AM-1ST-PROD-DA                PIC XX.
  6799     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6800     12  AM-CERTS-PURGED-DATE.
  6801         16  AM-PUR-YR                     PIC XX.
  6802         16  AM-PUR-MO                     PIC XX.
  6803         16  AM-PUR-DA                     PIC XX.
  6804     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6805     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6806     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6807     12  AM-INACTIVE-DATE.
  6808         16  AM-INA-MO                     PIC 99.
  6809         16  AM-INA-DA                     PIC 99.
  6810         16  AM-INA-YR                     PIC 99.
  6811     12  AM-AR-HI-CERT-DATE                PIC XX.
  6812
  6813     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6814     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6815
  6816     12  AM-OB-PAYMENT-MODE                PIC X.
  6817         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6818         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6819         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6820         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6821
  6822     12  AM-AH-ONLY-INDICATOR              PIC X.
  6823         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6824         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6825
  6826     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6827
  6828     12  AM-OVER-SHORT.
  6829         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6830         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 130
* EL156.cbl
  6831
  6832     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6833     12  AM-DCC-CLP-STATE                  PIC XX.
  6834
  6835     12  AM-RECALC-COMM                    PIC X.
  6836     12  AM-RECALC-REIN                    PIC X.
  6837
  6838     12  AM-REI-TABLE                      PIC XXX.
  6839     12  AM-REI-ET-LF                      PIC X.
  6840     12  AM-REI-ET-AH                      PIC X.
  6841     12  AM-REI-PE-LF                      PIC X.
  6842     12  AM-REI-PE-AH                      PIC X.
  6843     12  AM-REI-PRT-ST                     PIC X.
  6844     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6845     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6846     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6847     12  AM-REI-GROUP-A                    PIC X(6).
  6848     12  AM-REI-MORT                       PIC X(4).
  6849     12  AM-REI-PRT-OW                     PIC X.
  6850     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6851     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6852     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6853     12  AM-REI-GROUP-B                    PIC X(6).
  6854
  6855     12  AM-TRUST-TYPE                     PIC X(2).
  6856
  6857     12  AM-EMPLOYER-STMT-USED             PIC X.
  6858     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6859
  6860     12  AM-STD-AH-TYPE                    PIC XX.
  6861     12  AM-EARN-METHODS.
  6862         16  AM-EARN-METHOD-R              PIC X.
  6863             88 AM-REF-RL-R78                 VALUE 'R'.
  6864             88 AM-REF-RL-PR                  VALUE 'P'.
  6865             88 AM-REF-RL-MEAN                VALUE 'M'.
  6866             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6867         16  AM-EARN-METHOD-L              PIC X.
  6868             88 AM-REF-LL-R78                 VALUE 'R'.
  6869             88 AM-REF-LL-PR                  VALUE 'P'.
  6870             88 AM-REF-LL-MEAN                VALUE 'M'.
  6871             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6872         16  AM-EARN-METHOD-A              PIC X.
  6873             88 AM-REF-AH-R78                 VALUE 'R'.
  6874             88 AM-REF-AH-PR                  VALUE 'P'.
  6875             88 AM-REF-AH-MEAN                VALUE 'M'.
  6876             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6877             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6878             88 AM-REF-AH-NET                 VALUE 'N'.
  6879
  6880     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6881     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6882     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6883
  6884     12  AM-RET-Y-N                        PIC X.
  6885     12  AM-RET-P-E                        PIC X.
  6886     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6887     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6888     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 131
* EL156.cbl
  6889     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6890         16  AM-POOL-PRIME                 PIC XXX.
  6891         16  AM-POOL-SUB                   PIC XXX.
  6892     12  AM-RETRO-EARNINGS.
  6893         16  AM-RET-EARN-R                 PIC X.
  6894         16  AM-RET-EARN-L                 PIC X.
  6895         16  AM-RET-EARN-A                 PIC X.
  6896     12  AM-RET-ST-TAX-USE                 PIC X.
  6897         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6898         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6899     12  AM-RETRO-BEG-EARNINGS.
  6900         16  AM-RET-BEG-EARN-R             PIC X.
  6901         16  AM-RET-BEG-EARN-L             PIC X.
  6902         16  AM-RET-BEG-EARN-A             PIC X.
  6903     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6904     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6905
  6906     12  AM-USER-SELECT-OPTIONS.
  6907         16  AM-USER-SELECT-1              PIC X(10).
  6908         16  AM-USER-SELECT-2              PIC X(10).
  6909         16  AM-USER-SELECT-3              PIC X(10).
  6910         16  AM-USER-SELECT-4              PIC X(10).
  6911         16  AM-USER-SELECT-5              PIC X(10).
  6912
  6913     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6914
  6915     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6916
  6917     12  AM-RPT045A-SWITCH                 PIC X.
  6918         88  RPT045A-OFF                   VALUE 'N'.
  6919
  6920     12  AM-INSURANCE-LIMITS.
  6921         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6922         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6923
  6924     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6925         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6926
  6927     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6928         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6929         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6930
  6931     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6932
  6933     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6934     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6935     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6936     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6937     12  AM-DCC-UEF-STATE                  PIC XX.
  6938     12  FILLER                            PIC XXX.
  6939     12  AM-REPORT-CODE-3                  PIC X(10).
  6940*    12  FILLER                            PIC X(22).
  6941
  6942     12  AM-RESERVE-DATE.
  6943         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6944         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6945         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6946
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 132
* EL156.cbl
  6947     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6948     12  AM-NOTIFICATION-TYPES.
  6949         16  AM-NOTIF-OF-LETTERS           PIC X.
  6950         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6951         16  AM-NOTIF-OF-REPORTS           PIC X.
  6952         16  AM-NOTIF-OF-STATUS            PIC X.
  6953
  6954     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6955         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6956         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6957         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6958         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6959
  6960     12  AM-BENEFIT-CONTROLS.
  6961         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6962             20  AM-BENEFIT-CODE           PIC XX.
  6963             20  AM-BENEFIT-TYPE           PIC X.
  6964             20  AM-BENEFIT-REVISION       PIC XXX.
  6965             20  AM-BENEFIT-REM-TERM       PIC X.
  6966             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6967             20  FILLER                    PIC XX.
  6968         16  FILLER                        PIC X(80).
  6969
  6970     12  AM-TRANSFER-DATA.
  6971         16  AM-TRANSFERRED-FROM.
  6972             20  AM-TRNFROM-CARRIER        PIC X.
  6973             20  AM-TRNFROM-GROUPING.
  6974                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6975                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6976             20  AM-TRNFROM-STATE          PIC XX.
  6977             20  AM-TRNFROM-ACCOUNT.
  6978                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6979                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6980             20  AM-TRNFROM-DTE            PIC XX.
  6981         16  AM-TRANSFERRED-TO.
  6982             20  AM-TRNTO-CARRIER          PIC X.
  6983             20  AM-TRNTO-GROUPING.
  6984                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6985                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6986             20  AM-TRNTO-STATE            PIC XX.
  6987             20  AM-TRNTO-ACCOUNT.
  6988                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6989                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6990             20  AM-TRNTO-DTE              PIC XX.
  6991         16  FILLER                        PIC X(10).
  6992
  6993     12  AM-SAVED-REMIT-TO                 PIC 99.
  6994
  6995     12  AM-COMM-STRUCTURE-SAVED.
  6996         16  AM-DEFN-1-SAVED.
  6997             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6998                 24  AM-AGT-SV             PIC X(10).
  6999                 24  AM-COM-TYP-SV         PIC X.
  7000                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7001                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7002                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7003                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7004                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 133
* EL156.cbl
  7005                 24  AM-GL-CODES-SV        PIC X.
  7006                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7007                 24  FILLER                PIC X.
  7008         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7009             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7010                 24  FILLER                PIC X(11).
  7011                 24  AM-L-COMA-SV          PIC XXX.
  7012                 24  AM-J-COMA-SV          PIC XXX.
  7013                 24  AM-A-COMA-SV          PIC XXX.
  7014                 24  FILLER                PIC X(6).
  7015
  7016     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7017         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7018            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7019            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7020            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7021
  7022     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7023     12  FILLER                            PIC X(120).
  7024
  7025     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7026         16  AM-CONTROL-NAME               PIC X(30).
  7027         16  AM-EXECUTIVE-ONE.
  7028             20  AM-EXEC1-NAME             PIC X(15).
  7029             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7030                                                          COMP-3.
  7031             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7032                                                          COMP-3.
  7033         16  AM-EXECUTIVE-TWO.
  7034             20  AM-EXEC2-NAME             PIC X(15).
  7035             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7036                                                          COMP-3.
  7037             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7038                                                          COMP-3.
  7039
  7040     12  AM-RETRO-ADDITIONAL-DATA.
  7041         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7042         16  AM-RETRO-PREM-P-E             PIC X.
  7043         16  AM-RETRO-CLMS-P-I             PIC X.
  7044         16  AM-RETRO-RET-BRACKET-LF.
  7045             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7046                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7047                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7048             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7049                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7050                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7051             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7052                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7053                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7054         16  AM-RETRO-RET-BRACKET-AH.
  7055             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7056                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7057                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7058                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7059             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7060                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7061                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7062             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 134
* EL156.cbl
  7063                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7064                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7065
  7066     12  AM-COMMENTS.
  7067         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7068
  7069     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7070         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7071         16  AM-FLI-BILLING-CODE           PIC X.
  7072         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7073         16  AM-FLI-UNITED-IDENT           PIC X.
  7074         16  AM-FLI-INTEREST-LOST-DATA.
  7075             20  AM-FLI-BANK-NO            PIC X(5).
  7076             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7077             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7078             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7079         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7080             20  AM-FLI-AGT                PIC X(9).
  7081             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7082             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7083         16  FILLER                        PIC X(102).
  7084
  7085     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7086         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7087             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7088             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7089             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7090             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7091             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7092         16  FILLER                          PIC X(10).
  7093******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 135
* EL156.cbl
  7095*    COPY ELCCHKQ.
  7096******************************************************************
  7097*                                                                *
  7098*                                                                *
  7099*                            ELCCHKQ.                            *
  7100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7101*                            VMOD=2.007                          *
  7102*                                                                *
  7103*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7104*                                                                *
  7105*   FILE TYPE = VSAM,KSDS                                        *
  7106*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7107*                                                                *
  7108*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7109*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7110*                                                                *
  7111*   LOG = YES                                                    *
  7112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7113******************************************************************
  7114 01  CHECK-QUE.
  7115     12  CQ-RECORD-ID                PIC XX.
  7116         88  VALID-CQ-ID         VALUE 'CQ'.
  7117
  7118     12  CQ-CONTROL-PRIMARY.
  7119         16  CQ-COMPANY-CD           PIC X.
  7120         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7121         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7122
  7123     12  CQ-CONTROL-BY-PAYEE.
  7124         16  CQ-CONTROL-BY-NUMBER.
  7125             20  CQ-COMPANY-CD-A1     PIC X.
  7126             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7127         16  CQ-PAYEE-CARRIER        PIC X.
  7128         16  CQ-PAYEE-GROUPING       PIC X(6).
  7129         16  CQ-PAYEE-STATE          PIC XX.
  7130         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7131         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7132
  7133     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7134         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7135         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7136         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7137         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7138         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7139         16  FILLER                  PIC X(3).
  7140
  7141     12  CQ-ENTRY-TYPE               PIC X.
  7142             88  CHECK-ON-QUE           VALUE 'Q'.
  7143             88  ALIGNMENT-CHECK        VALUE 'A'.
  7144             88  SPOILED-CHECK          VALUE 'S'.
  7145             88  PAYMENT-ABORTED        VALUE 'X'.
  7146
  7147     12  CQ-CLAIM-MAST-CNTL.
  7148         16  CQ-CARRIER              PIC X.
  7149         16  CQ-CLAIM-NO             PIC X(7).
  7150         16  CQ-CERT-NO.
  7151             20  CQ-CERT-PRIME       PIC X(10).
  7152             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 136
* EL156.cbl
  7153         16  CQ-CLAIM-TYPE           PIC X.
  7154             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7155             88  CQ-AH-CLAIM            VALUE 'A'.
  7156         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7157             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7158             88  CQ-O-B-COVERAGE        VALUE '2'.
  7159             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7160
  7161     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7162     12  CQ-CHECK-NUMBER             PIC X(7).
  7163     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7164     12  CQ-PAYMENT-TYPE             PIC X.
  7165             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7166             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7167             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7168             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7169             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7170             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7171             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7172             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7173     12  CQ-VOID-INDICATOR           PIC X.
  7174             88  CHECK-IS-STOPPED          VALUE 'S'.
  7175             88  CHECK-IS-VOID             VALUE 'V'.
  7176     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7177     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7178     12  CQ-CHECK-BY-USER            PIC X(4).
  7179     12  CQ-PRE-NUMBERING-SW         PIC X.
  7180       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7181       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7182
  7183     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7184     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7185     12  CQ-LEDGER-FLAG              PIC X(01).
  7186     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7187     12  CQ-LAST-UPDATED-DT          PIC XX.
  7188     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7189     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7190
  7191     12  FILLER                      PIC X(04).
  7192
  7193******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 137
* EL156.cbl
  7195*    COPY ELCBENE.
  7196******************************************************************
  7197*                                                                *
  7198*                            ELCBENE.                            *
  7199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7200*                            VMOD=2.006                          *
  7201*                                                                *
  7202*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7203*                                                                *
  7204*   FILE TYPE = VSAM,KSDS                                        *
  7205*   RECORD SIZE = 500   RECFORM = FIX                            *
  7206*                                                                *
  7207*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7208*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7209*                                                                *
  7210*   LOG = YES                                                    *
  7211*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7212*                                                                *
  7213*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7214******************************************************************
  7215*                   C H A N G E   L O G
  7216*
  7217* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7218*-----------------------------------------------------------------
  7219*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7220* EFFECTIVE    NUMBER
  7221*-----------------------------------------------------------------
  7222* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7223* 082317  CR2017082100003  PEMA  Add sub type
  7224* 032019  CR2019011400002  PEMA  Add email address for ach report
  7225******************************************************************
  7226
  7227 01  BENEFICIARY-MASTER.
  7228     12  BE-RECORD-ID                PIC XX.
  7229         88  VALID-BE-ID                VALUE 'BE'.
  7230
  7231     12  BE-CONTROL-PRIMARY.
  7232         16  BE-COMPANY-CD           PIC X.
  7233         16  BE-RECORD-TYPE          PIC X.
  7234             88  BENEFICIARY-RECORD  VALUE 'B'.
  7235             88  ADJUSTOR-RECORD     VALUE 'A'.
  7236         16  BE-BENEFICIARY          PIC X(10).
  7237     12  BE-CONTROL-BY-NAME.
  7238         16  BE-COMPANY-CD-A1        PIC X.
  7239         16  BE-RECORD-TYPE-A1       PIC X.
  7240         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7241         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7242
  7243     12  BE-LAST-MAINT-DT            PIC XX.
  7244     12  BE-LAST-MAINT-BY            PIC X(4).
  7245     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7246
  7247     12  BE-ADDRESS-DATA.
  7248         16  BE-MAIL-TO-NAME         PIC X(30).
  7249         16  BE-ADDRESS-LINE-1       PIC X(30).
  7250         16  BE-ADDRESS-LINE-2       PIC X(30).
  7251         16  BE-ADDRESS-LINE-3       PIC X(30).
  7252         16  BE-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 138
* EL156.cbl
  7253             20  BE-CITY             PIC X(28).
  7254             20  BE-STATE            PIC XX.
  7255         16  BE-ZIP-CODE.
  7256             20  BE-ZIP-PRIME.
  7257                 24  BE-ZIP-1ST      PIC X.
  7258                     88  BE-CANADIAN-POST-CODE
  7259                                         VALUE 'A' THRU 'Z'.
  7260                 24  FILLER          PIC X(4).
  7261             20  BE-ZIP-PLUS4        PIC X(4).
  7262         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7263             20  BE-CAN-POSTAL-1     PIC XXX.
  7264             20  BE-CAN-POSTAL-2     PIC XXX.
  7265             20  FILLER              PIC XXX.
  7266         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7267         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7268
  7269******************************************************************
  7270*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7271*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7272******************************************************************
  7273     12  BE-CARRIER                  PIC X.
  7274
  7275     12  BE-ADDRESS-DATA2.
  7276         16  BE-MAIL-TO-NAME2        PIC X(30).
  7277         16  BE-ADDRESS-LINE-12      PIC X(30).
  7278         16  BE-ADDRESS-LINE-22      PIC X(30).
  7279         16  BE-ADDRESS-LINE-32      PIC X(30).
  7280         16  BE-CITY-STATE2.
  7281             20  BE-CITY2            PIC X(28).
  7282             20  BE-STATE2           PIC XX.
  7283         16  BE-ZIP-CODE2.
  7284             20  BE-ZIP-PRIME2.
  7285                 24  BE-ZIP-1ST2     PIC X.
  7286                     88  BE-CANADIAN-POST-CODE2
  7287                                         VALUE 'A' THRU 'Z'.
  7288                 24  FILLER          PIC X(4).
  7289             20  BE-ZIP-PLUS42       PIC X(4).
  7290         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7291             20  BE-CAN-POSTAL-12    PIC XXX.
  7292             20  BE-CAN-POSTAL-22    PIC XXX.
  7293             20  FILLER              PIC XXX.
  7294         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7295         16  BE-ACH-DATA.
  7296             20  BE-ACH-YES-OR-NO    PIC X.
  7297                 88  BE-ON-ACH       VALUE 'Y'.
  7298                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7299             20  BE-ACH-ABA-ROUTING-NUMBER
  7300                                     PIC X(15).
  7301             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7302                                     PIC X(20).
  7303             20  BE-ACH-SUB-TYPE     PIC XX.
  7304             20  BE-ACH-EMAIL-YN     PIC X.
  7305                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  7306             20  be-ach-email-addr   PIC X(40).
  7307         16  BE-BILLING-STMT-DATA.
  7308*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7309             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7310             20  BE-OUTPUT-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 139
* EL156.cbl
  7311                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7312                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7313
  7314     12  filler                      PIC X(16).
  7315******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 140
* EL156.cbl
  7317*    COPY ELCARCH.
  7318******************************************************************
  7319*                                                                *
  7320*                            ELCARCH.                            *
  7321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7322*                            VMOD=2.007                          *
  7323*                                                                *
  7324*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7325*                                                                *
  7326*   FILE TYPE = VSAM,KSDS                                        *
  7327*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7328*                                                                *
  7329*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7330*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7331*                                                                *
  7332*   LOG = NO                                                     *
  7333*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7334*                                                                *
  7335*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7336******************************************************************
  7337 01  LETTER-ARCHIVE.
  7338     12  LA-RECORD-ID                PIC XX.
  7339         88  VALID-LA-ID                VALUE 'LA'.
  7340
  7341     12  LA-CONTROL-PRIMARY.
  7342         16  LA-COMPANY-CD           PIC X.
  7343         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7344         16  LA-RECORD-TYPE          PIC X.
  7345             88  LA-HEADER-DATA         VALUE '1'.
  7346             88  LA-ADDRESS-DATA        VALUE '2'.
  7347             88  LA-TEXT-DATA           VALUE '3'.
  7348             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7349         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7350
  7351     12  LA-CONTROL-BY-TYPE.
  7352         16  LA-COMPANY-CD-A1        PIC X.
  7353         16  LA-RECORD-TYPE-A1       PIC X.
  7354         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7355         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7356
  7357     12  LA-TEXT-RECORD.
  7358         16  LA-SKIP-CONTROL         PIC XX.
  7359             88  NO-LINES-SKIPPED       VALUE SPACES.
  7360             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7361         16  LA-TEXT-LINE            PIC X(70).
  7362
  7363     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7364         16  FILLER                  PIC XX.
  7365         16  LA-ADDRESS-LINE         PIC X(30).
  7366         16  FILLER                  PIC X(40).
  7367
  7368     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7369         16  FILLER                  PIC XX.
  7370         16  LA-CARRIER              PIC X.
  7371         16  LA-CLAIM-NO             PIC X(7).
  7372         16  LA-CERT-NO.
  7373             20  LA-CERT-PRIME       PIC X(10).
  7374             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 141
* EL156.cbl
  7375         16  LA-NO-OF-COPIES         PIC S9.
  7376         16  LA-RESEND-DATE          PIC XX.
  7377         16  LA-PROCESSOR-CD         PIC X(4).
  7378         16  LA-CREATION-DT          PIC XX.
  7379         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7380         16  LA-RESEND-PRINT-DATE    PIC XX.
  7381         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7382         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7383*
  7384* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7385*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7386*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7387*   I        20  LA-DMD-RES-ST           PIC XX.
  7388*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7389*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7390*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7391*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7392*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7393*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7394*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7395*   I        20  LA-DMD-UND-CODE         PIC XX.
  7396*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7397*   V    16  FILLER                  PIC X(15).
  7398* -----
  7399*
  7400* REINSERTED  CSO  MODS
  7401*
  7402         16  FILLER.
  7403             20  FILLER                  PIC X(29).
  7404             20  LA-CSO-LETTER-STATUS    PIC X.
  7405                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7406                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7407                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7408             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7409             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7410*
  7411
  7412     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7413         16  FILLER                  PIC XX.
  7414         16  LA4-CARRIER             PIC X.
  7415         16  LA4-CLAIM-NO            PIC X(7).
  7416         16  LA4-CERT-NO.
  7417             20  LA4-CERT-PRIME      PIC X(10).
  7418             20  LA4-CERT-SFX        PIC X.
  7419         16  LA4-NO-OF-COPIES        PIC S9.
  7420         16  LA4-RESEND-DATE         PIC XX.
  7421         16  LA4-PROCESSOR-CD        PIC X(4).
  7422         16  LA4-CREATION-DT         PIC XX.
  7423         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7424         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7425         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7426         16  LA4-FORM-TYPE           PIC X.
  7427             88  LA4-INITIAL-FORM    VALUE '1'.
  7428             88  LA4-PROGRESS-FORM   VALUE '2'.
  7429         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7430         16  LA4-STATE               PIC X(02).
  7431         16  FILLER                  PIC X(31).
  7432******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 142
* EL156.cbl
  7434*    COPY ELCDAR.
  7435******************************************************************
  7436*                                                                *
  7437*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7438*   FILE TYPE = VSAM,KSDS                                        *
  7439*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7440*   BASE CLUSTER = DLYACTV                                       *
  7441*   LOG = YES                                                    *
  7442*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7443*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7444*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7445*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7446*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7447*               BY PROGRAM "LGINFCE".                            *
  7448*                                                                *
  7449******************************************************************
  7450 01  DAILY-ACTIVITY-RECORD.
  7451     05  DA-KEY.
  7452         10  DA-COMP-CD          PIC X.
  7453         10  DA-CARRIER          PIC X.
  7454         10  DA-CLAIM-NO         PIC X(7).
  7455         10  DA-CERT-NO.
  7456             15  DA-CERT-PRIME   PIC X(10).
  7457             15  DA-CERT-SFX     PIC X.
  7458     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7459     05  DA-RECORD-TYPE          PIC X.
  7460     05  FILLER                  PIC X(2).
  7461******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 143
* EL156.cbl
  7463*    COPY ERCCOMP.
  7464******************************************************************
  7465*                                                                *
  7466*                                                                *
  7467*                            ERCCOMP                             *
  7468*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7469*                            VMOD=2.019                          *
  7470*                                                                *
  7471*   ONLINE CREDIT SYSTEM                                         *
  7472*                                                                *
  7473*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7474*                                                                *
  7475*   FILE TYPE = VSAM,KSDS                                        *
  7476*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7477*                                                                *
  7478*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7479*       ALTERNATE PATH = NONE                                    *
  7480*                                                                *
  7481*   LOG = NO                                                     *
  7482*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7483*                                                                *
  7484******************************************************************
  7485*                   C H A N G E   L O G
  7486*
  7487* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7488*-----------------------------------------------------------------
  7489*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7490* EFFECTIVE    NUMBER
  7491*-----------------------------------------------------------------
  7492* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7493* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7494* 092205    2005050300006  PEMA  ADD LEASE FEE
  7495* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7496* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7497* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7498* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7499* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7500* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7501******************************************************************
  7502
  7503 01  COMPENSATION-MASTER.
  7504     12  CO-RECORD-ID                          PIC XX.
  7505         88  VALID-CO-ID                          VALUE 'CO'.
  7506
  7507     12  CO-CONTROL-PRIMARY.
  7508         16  CO-COMPANY-CD                     PIC X.
  7509         16  CO-CONTROL.
  7510             20  CO-CTL-1.
  7511                 24  CO-CARR-GROUP.
  7512                     28  CO-CARRIER            PIC X.
  7513                     28  CO-GROUPING.
  7514                         32  CO-GROUP-PREFIX   PIC XXX.
  7515                         32  CO-GROUP-PRIME    PIC XXX.
  7516                 24  CO-RESP-NO.
  7517                     28  CO-RESP-PREFIX        PIC X(4).
  7518                     28  CO-RESP-PRIME         PIC X(6).
  7519             20  CO-CTL-2.
  7520                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 144
* EL156.cbl
  7521                     28  CO-ACCT-PREFIX        PIC X(4).
  7522                     28  CO-ACCT-PRIME         PIC X(6).
  7523         16  CO-TYPE                           PIC X.
  7524             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7525             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7526             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7527
  7528     12  CO-MAINT-INFORMATION.
  7529         16  CO-LAST-MAINT-DT                  PIC XX.
  7530         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7531         16  CO-LAST-MAINT-USER                PIC X(4).
  7532     12  FILLER                                PIC XX.
  7533     12  CO-STMT-TYPE                          PIC XXX.
  7534     12  CO-COMP-TYPE                          PIC X.
  7535         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7536     12  CO-STMT-OWNER                         PIC X(4).
  7537     12  CO-BALANCE-CONTROL                    PIC X.
  7538         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7539         88  CO-NO-BALANCE                        VALUE 'N'.
  7540
  7541     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7542         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7543         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7544         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7545
  7546     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7547         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7548         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7549
  7550     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7551     12  CO-GA-DIRECT-DEP                      PIC X.
  7552     12  CO-FUTURE-SPACE                       PIC X.
  7553         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7554
  7555     12  CO-ACCT-NAME                          PIC X(30).
  7556     12  CO-MAIL-NAME                          PIC X(30).
  7557     12  CO-ADDR-1                             PIC X(30).
  7558     12  CO-ADDR-2                             PIC X(30).
  7559     12  CO-ADDR-3.
  7560         16  CO-ADDR-CITY                      PIC X(27).
  7561         16  CO-ADDR-STATE                     PIC XX.
  7562     12  CO-CSO-1099                           PIC X.
  7563     12  CO-ZIP.
  7564         16  CO-ZIP-PRIME.
  7565             20  CO-ZIP-PRI-1ST                PIC X.
  7566                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7567             20  FILLER                        PIC X(4).
  7568         16  CO-ZIP-PLUS4                      PIC X(4).
  7569     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7570         16  CO-CAN-POSTAL-1                   PIC XXX.
  7571         16  CO-CAN-POSTAL-2                   PIC XXX.
  7572         16  FILLER                            PIC XXX.
  7573     12  CO-SOC-SEC                            PIC X(13).
  7574     12  CO-TELEPHONE.
  7575         16  CO-AREA-CODE                      PIC XXX.
  7576         16  CO-PREFIX                         PIC XXX.
  7577         16  CO-PHONE                          PIC X(4).
  7578
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 145
* EL156.cbl
  7579     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7580
  7581     12  CO-AR-BAL-LEVEL                       PIC X.
  7582         88  CO-AR-REF-LVL                        VALUE '1'.
  7583         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7584         88  CO-AR-BILL-LVL                       VALUE '2'.
  7585         88  CO-AR-AGT-LVL                        VALUE '3'.
  7586         88  CO-AR-FR-LVL                         VALUE '4'.
  7587
  7588     12  CO-AR-NORMAL-PRINT                    PIC X.
  7589         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7590         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7591
  7592     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7593
  7594     12  CO-AR-REPORTING                       PIC X.
  7595         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7596         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7597
  7598     12  CO-AR-PULL-CHECK                      PIC X.
  7599         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7600         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7601
  7602     12  CO-AR-BALANCE-PRINT                   PIC X.
  7603         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7604
  7605     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7606         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7607         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7608         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7609
  7610     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7611
  7612     12  CO-USER-CODE                          PIC X.
  7613     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7614
  7615******************************************************************
  7616*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7617*    THE LAST MONTH END RUN.
  7618******************************************************************
  7619
  7620     12  CO-LAST-ACTIVITY-DATE.
  7621         16  CO-ACT-YEAR                       PIC 99.
  7622         16  CO-ACT-MONTH                      PIC 99.
  7623         16  CO-ACT-DAY                        PIC 99.
  7624
  7625     12  CO-LAST-STMT-DT.
  7626         16  CO-LAST-STMT-YEAR                 PIC 99.
  7627         16  CO-LAST-STMT-MONTH                PIC 99.
  7628         16  CO-LAST-STMT-DAY                  PIC 99.
  7629
  7630     12  CO-MO-END-TOTALS.
  7631         16  CO-MONTHLY-TOTALS.
  7632             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7633             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7634             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7635             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7636             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 146
* EL156.cbl
  7637
  7638         16  CO-AGING-TOTALS.
  7639             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7640             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7641             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7642             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7643
  7644         16  CO-YTD-TOTALS.
  7645             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7646             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7647
  7648         16  CO-OVER-UNDER-TOTALS.
  7649             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7650             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7651
  7652     12  CO-MISCELLANEOUS-TOTALS.
  7653         16  CO-FICA-TOTALS.
  7654             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7655             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7656
  7657         16  CO-CLAIM-TOTALS.
  7658             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7659             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7660
  7661******************************************************************
  7662*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7663*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7664******************************************************************
  7665
  7666     12  CO-CURRENT-TOTALS.
  7667         16  CO-CURRENT-LAST-STMT-DT.
  7668             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7669             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7670             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7671
  7672         16  CO-CURRENT-MONTHLY-TOTALS.
  7673             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7674             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7675             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7676             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7677             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7678
  7679         16  CO-CURRENT-AGING-TOTALS.
  7680             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7681             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7682             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7683             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7684
  7685         16  CO-CURRENT-YTD-TOTALS.
  7686             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7687             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7688
  7689     12  CO-PAID-COMM-TOTALS.
  7690         16  CO-YTD-PAID-COMMS.
  7691             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7692             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7693
  7694     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 147
* EL156.cbl
  7695         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7696         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7697
  7698     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7699         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7700         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7701         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7702         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7703         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7704         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7705         88  CO-FINAL-LETTER                  VALUE 'F'.
  7706         88  CO-RECONCILING                   VALUE 'R'.
  7707         88  CO-PHONE-CALL                    VALUE 'P'.
  7708         88  CO-LEGAL                         VALUE 'L'.
  7709         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7710         88  CO-WRITE-OFF                     VALUE 'W'.
  7711         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7712
  7713     12  CO-CSR-CODE                       PIC X(4).
  7714
  7715     12  CO-GA-STATUS-INFO.
  7716         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7717         16  CO-GA-TERMINATION-DT          PIC XX.
  7718         16  CO-GA-STATUS-CODE             PIC X.
  7719             88  CO-GA-ACTIVE                 VALUE 'A'.
  7720             88  CO-GA-INACTIVE               VALUE 'I'.
  7721             88  CO-GA-PENDING                VALUE 'P'.
  7722         16  CO-GA-COMMENTS.
  7723             20  CO-GA-COMMENT-1           PIC X(40).
  7724             20  CO-GA-COMMENT-2           PIC X(40).
  7725             20  CO-GA-COMMENT-3           PIC X(40).
  7726             20  CO-GA-COMMENT-4           PIC X(40).
  7727
  7728     12  CO-RPTCD2                         PIC X(10).
  7729     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7730         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7731         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7732
  7733     12  CO-TYPE-AGENT                     PIC X(01).
  7734         88  CO-CORPORATION                   VALUE 'C'.
  7735         88  CO-PARTNERSHIP                   VALUE 'P'.
  7736         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7737         88  CO-TRUST                         VALUE 'T'.
  7738         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7739
  7740     12  CO-FAXNO.
  7741         16  CO-FAX-AREA-CODE                  PIC XXX.
  7742         16  CO-FAX-PREFIX                     PIC XXX.
  7743         16  CO-FAX-PHONE                      PIC X(4).
  7744
  7745     12  CO-BANK-INFORMATION.
  7746         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7747         16  CO-BANK-TRANSIT-NON REDEFINES
  7748             CO-BANK-TRANSIT-NO                PIC 9(8).
  7749
  7750         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7751     12  CO-MISC-DEDUCT-INFO REDEFINES
  7752                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 148
* EL156.cbl
  7753         16  CO-MD-GL-ACCT                     PIC X(10).
  7754         16  CO-MD-DIV                         PIC XX.
  7755         16  CO-MD-CENTER                      PIC X(4).
  7756         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7757         16  CO-CREATE-AP-CHECK                PIC X.
  7758         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7759         16  FILLER                            PIC XXX.
  7760     12  CO-ACH-STATUS                         PIC X.
  7761         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7762         88  CO-ACH-PENDING                        VALUE 'P'.
  7763
  7764     12  CO-BILL-SW                            PIC X.
  7765     12  CO-CONTROL-NAME                       PIC X(30).
  7766     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7767     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7768     12  CO-CLP-STATE                          PIC XX.
  7769     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7770     12  CO-SPP-REFUND-EDIT                    PIC X.
  7771
  7772******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 149
* EL156.cbl
  7774*    COPY ERCDMDNT.
  7775******************************************************************
  7776*                                                                *
  7777*                            ERCDMDNT                            *
  7778*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7779*                            VMOD=2.005                          *
  7780*                                                                *
  7781*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7782*                                                                *
  7783*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7784*                                                                *
  7785*        FILE TYPE= VSAM,KSDS                                    *
  7786*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7787*                                                                *
  7788*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7789*                                                                *
  7790*        LOG = YES                                               *
  7791*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7792*                                                                *
  7793******************************************************************
  7794
  7795 01  CERTIFICATE-NOTE.
  7796     12  CN-RECORD-ID                     PIC  XX.
  7797         88  VALID-CN-ID                      VALUE 'CN'.
  7798
  7799     12  CN-CONTROL-PRIMARY.
  7800         16  CN-COMPANY-CD                PIC X.
  7801         16  CN-CERT-KEY.
  7802             20  CN-CARRIER               PIC X.
  7803             20  CN-GROUPING.
  7804                 24  CN-GROUPING-PREFIX   PIC XXX.
  7805                 24  CN-GROUPING-PRIME    PIC XXX.
  7806             20  CN-STATE                 PIC XX.
  7807             20  CN-ACCOUNT.
  7808                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7809                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7810             20  CN-CERT-EFF-DT           PIC XX.
  7811             20  CN-CERT-NO.
  7812                 24  CN-CERT-PRIME        PIC X(10).
  7813                 24  CN-CERT-SFX          PIC X.
  7814
  7815     12  CN-BILLING-START-LINE-NO         PIC 99.
  7816     12  CN-BILLING-END-LINE-NO           PIC 99.
  7817
  7818     12  CN-LINES.
  7819         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7820
  7821     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7822         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7823         16  CN-CSI-GENERAL-DATA-AREA.
  7824             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7825
  7826         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7827             CN-CSI-GENERAL-DATA-AREA.
  7828             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7829             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7830             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7831             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 150
* EL156.cbl
  7832             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7833             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7834             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7835             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7836             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7837             20  FILLER                       PIC XX.
  7838             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7839             20  FILLER                       PIC X(38).
  7840
  7841         16  CN-CSI-PRODUCT-DATA-AREA.
  7842             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7843
  7844         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7845             CN-CSI-PRODUCT-DATA-AREA.
  7846             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7847             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7848             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7849             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7850             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7851             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7852             20  FILLER                   PIC XX.
  7853             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7854             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7855             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7856             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7857             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7858             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7859             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7860             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7861             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7862             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7863             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7864             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7865             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7866             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7867             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7868             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7869             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7870             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7871             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7872             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7873             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7874             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7875             20  FILLER                   PIC X(25).
  7876
  7877         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7878             CN-CSI-CREDIT-CARD-DATA.
  7879             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7880             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7881             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7882             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7883             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7884             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7885             20  FILLER                   PIC XX.
  7886             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7887             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7888             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7889             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 151
* EL156.cbl
  7890             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7891             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7892             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7893             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7894             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7895             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7896             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7897             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7898             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7899             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7900             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7901             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7902             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7903             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7904             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7905             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7906             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7907             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7908             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7909             20  FILLER                   PIC X(17).
  7910
  7911         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7912             CN-CSI-FAMILY-LEAVE-DATA.
  7913             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7914             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7915             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7916             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7917             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7918             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7919             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7920             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7921             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7922             20  CN-CSI-SL-INT-ON-PROCEEDS
  7923                                          PIC S9(5)V99  COMP-3.
  7924             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7925             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7926             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7927             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7928             20  CN-CSI-SL-POLICY-BENEFITS
  7929                                          PIC S9(5)V99  COMP-3.
  7930             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7931             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7932             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7933             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7934             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7935             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7936             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7937             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7938             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7939             20  CN-CSI-SL-STATE-NOT      PIC X.
  7940             20  FILLER                   PIC XX.
  7941
  7942         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7943             CN-CSI-SENIOR-LIFE-DATA.
  7944             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7945             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7946             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7947                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 152
* EL156.cbl
  7948             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7949             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7950             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7951             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7952             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7953             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7954             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7955             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7956             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7957             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7958             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7959             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7960             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7961             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7962             20  CN-CSI-PP-REPAIR         PIC X.
  7963             20  CN-CSI-PP-REPLACE        PIC X.
  7964             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7965             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7966             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7967             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7968             20  FILLER                   PIC X(5).
  7969
  7970         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7971             CN-CSI-PURCH-PROP-DATA.
  7972             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7973             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7974             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7975             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7976             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7977             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7978             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7979             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7980             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7981             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7982             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7983             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7984             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7985             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7986             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7987             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7988             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7989             20  CN-CSI-EW-REPLACE        PIC X.
  7990             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7991             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7992             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7993             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7994             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7995             20  FILLER                   PIC X(4).
  7996
  7997     12  CN-LAST-MAINT-DT                 PIC XX.
  7998     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7999     12  CN-LAST-MAINT-USER               PIC X(4).
  8000     12  FILLER                           PIC X(6).
  8001
  8002******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 153
* EL156.cbl
  8004*    COPY ERCCNOT.
  8005******************************************************************
  8006*                                                                *
  8007*                            ERCCNOT                             *
  8008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8009*                            VMOD=2.003                          *
  8010*                                                                *
  8011*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  8012*                                                                *
  8013*        FILE TYPE= VSAM,KSDS                                    *
  8014*        RECORD SIZE = 150    RECFORM = FIXED                    *
  8015*                                                                *
  8016*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  8017*                                                                *
  8018*        LOG = YES                                               *
  8019*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8020*                                                                *
  8021******************************************************************
  8022*                   C H A N G E   L O G
  8023*
  8024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8025*-----------------------------------------------------------------
  8026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8027* EFFECTIVE    NUMBER
  8028*-----------------------------------------------------------------
  8029* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  8030******************************************************************
  8031
  8032 01  CERT-NOTE-FILE.
  8033     12  CZ-RECORD-ID                PIC  XX.
  8034         88  VALID-CZ-ID                  VALUE 'CZ'.
  8035
  8036     12  CZ-CONTROL-PRIMARY.
  8037         16  CZ-COMPANY-CD           PIC X.
  8038         16  CZ-CARRIER              PIC X.
  8039         16  CZ-GROUPING.
  8040             20 CZ-GROUPING-PREFIX   PIC XXX.
  8041             20 CZ-GROUPING-PRIME    PIC XXX.
  8042         16  CZ-STATE                PIC XX.
  8043         16  CZ-ACCOUNT.
  8044             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  8045             20 CZ-ACCOUNT-PRIME     PIC X(6).
  8046         16  CZ-CERT-EFF-DT          PIC XX.
  8047         16  CZ-CERT-NO.
  8048             20  CZ-CERT-PRIME       PIC X(10).
  8049             20  CZ-CERT-SFX         PIC X.
  8050         16  CZ-RECORD-TYPE          PIC X.
  8051             88  CERT-NOTE           VALUE '1'.
  8052             88  CLAIM-CERT-NOTE     VALUE '2'.
  8053         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8054
  8055     12  CZ-LAST-MAINT-DT            PIC XX.
  8056     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8057     12  CZ-LAST-MAINT-USER          PIC X(4).
  8058
  8059     12  CZ-NOTE-INFORMATION.
  8060         16  CZ-NOTE                 PIC X(63).
  8061         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 154
* EL156.cbl
  8062******************************************************************
  8063*                            COPY ERCPDEF.
  8064******************************************************************
  8065*                                                                *
  8066*                                                                *
  8067*                            ERCPDEF.                            *
  8068*                                                                *
  8069*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8070*                                                                *
  8071*    FILE TYPE = VSAM,KSDS                                       *
  8072*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8073*                                                                *
  8074*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8075*                                                                *
  8076*    LOG = YES                                                   *
  8077*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8078******************************************************************
  8079*                   C H A N G E   L O G
  8080*
  8081* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8082*-----------------------------------------------------------------
  8083*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8084* EFFECTIVE    NUMBER
  8085*-----------------------------------------------------------------
  8086* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8087* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8088* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8089* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8090******************************************************************
  8091 01  PRODUCT-MASTER.
  8092    12  PD-RECORD-ID                 PIC X(02).
  8093        88  VALID-PD-ID                  VALUE 'PD'.
  8094    12  PD-CONTROL-PRIMARY.
  8095        16  PD-COMPANY-CD            PIC X.
  8096        16  PD-STATE                 PIC XX.
  8097        16  PD-PRODUCT-CD            PIC XXX.
  8098        16  PD-FILLER                PIC X(7).
  8099        16  PD-BEN-TYPE              PIC X.
  8100        16  PD-BEN-CODE              PIC XX.
  8101        16  PD-PROD-EXP-DT           PIC XX.
  8102    12  FILLER                       PIC X(50).
  8103    12  PD-PRODUCT-DATA OCCURS 8.
  8104        16  PD-PROD-CODE             PIC X.
  8105            88  PD-PROD-LIFE           VALUE 'L'.
  8106            88  PD-PROD-PROP           VALUE 'P'.
  8107            88  PD-PROD-AH             VALUE 'A'.
  8108            88  PD-PROD-IU             VALUE 'I'.
  8109            88  PD-PROD-GAP            VALUE 'G'.
  8110            88  PD-PROD-FAML           VALUE 'F'.
  8111            88  PD-PROD-OTH            VALUE 'O'.
  8112        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8113        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8114        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8115        16  PD-MAX-TERM              PIC S999        COMP-3.
  8116        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8117        16  FILLER                   PIC X.
  8118        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8119        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 155
* EL156.cbl
  8120        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8121        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  8122        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8123        16  PD-REC-CRIT-PERIOD       PIC 99.
  8124        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8125            20  PD-RECURRING-YN      PIC X.
  8126            20  FILLER               PIC X.
  8127        16  PD-RTW-MOS               PIC 99.
  8128        16  PD-MAX-EXTENSION         PIC 99.
  8129        16  pd-ben-pct               pic sv999 comp-3.
  8130*       16  FILLER                   PIC XX.
  8131    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8132    12  PD-TERM-LIMITS OCCURS 15.
  8133        16  PD-LOW-TERM              PIC S999        COMP-3.
  8134        16  PD-HI-TERM               PIC S999        COMP-3.
  8135*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8136    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8137        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8138        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8139    12  PD-EARN-FACTORS.
  8140        16  FILLER OCCURS 15.
  8141            20  FILLER OCCURS 15.
  8142                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8143    12  PD-PRODUCT-DESC              PIC X(80).
  8144    12  PD-TRUNCATED                 PIC X.
  8145    12  FILLER                       PIC X(59).
  8146    12  PD-MAINT-INFORMATION.
  8147        16  PD-LAST-MAINT-DT         PIC X(02).
  8148        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8149        16  PD-LAST-MAINT-BY         PIC X(04).
  8150*                            COPY ELCCRTT.
  8151******************************************************************
  8152*                                                                *
  8153*                            ELCCRTT.                            *
  8154*                                                                *
  8155*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8156*                                                                *
  8157*   FILE TYPE = VSAM,KSDS                                        *
  8158*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8159*                                                                *
  8160*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8161*                                                                *
  8162*   LOG = YES                                                    *
  8163*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8164******************************************************************
  8165*                   C H A N G E   L O G
  8166*
  8167* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8168*-----------------------------------------------------------------
  8169*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8170* EFFECTIVE    NUMBER
  8171*-----------------------------------------------------------------
  8172* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8173* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8174* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8175* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8176* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8177* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 156
* EL156.cbl
  8178* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8179* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8180* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8181* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8182* 091318  CR2018073000001  PEMA  ADD Refund methods
  8183* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8184******************************************************************
  8185
  8186 01  CERTIFICATE-TRAILERS.
  8187     12  CS-RECORD-ID                      PIC XX.
  8188         88  VALID-CS-ID                      VALUE 'CS'.
  8189
  8190     12  CS-CONTROL-PRIMARY.
  8191         16  CS-COMPANY-CD                 PIC X.
  8192         16  CS-CARRIER                    PIC X.
  8193         16  CS-GROUPING                   PIC X(6).
  8194         16  CS-STATE                      PIC XX.
  8195         16  CS-ACCOUNT                    PIC X(10).
  8196         16  CS-CERT-EFF-DT                PIC XX.
  8197         16  CS-CERT-NO.
  8198             20  CS-CERT-PRIME             PIC X(10).
  8199             20  CS-CERT-SFX               PIC X.
  8200         16  CS-TRAILER-TYPE               PIC X.
  8201             88  COMM-TRLR           VALUE 'A'.
  8202             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8203             88  CERT-DATA-TRLR      VALUE 'C'.
  8204
  8205     12  CS-DATA-AREA                      PIC X(516).
  8206
  8207     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8208         16  CS-BANK-COMMISSION-AREA.
  8209             20  CS-BANK-COMMS       OCCURS 10.
  8210                 24  CS-AGT                PIC X(10).
  8211                 24  CS-COM-TYP            PIC X.
  8212                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8213                 24  CS-RECALC-LV-INDIC    PIC X.
  8214                 24  FILLER                PIC X(10).
  8215         16  FILLER                        PIC X(256).
  8216
  8217     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8218****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8219         16  CS-MB-CLAIM-DATA OCCURS 24.
  8220             20  CS-CLAIM-NO               PIC X(7).
  8221             20  CS-CLAIM-TYPE             PIC X.
  8222                 88  CS-AH-CLM               VALUE 'A'.
  8223                 88  CS-IU-CLM               VALUE 'I'.
  8224                 88  CS-GP-CLM               VALUE 'G'.
  8225                 88  CS-LF-CLM               VALUE 'L'.
  8226                 88  CS-PR-CLM               VALUE 'P'.
  8227                 88  CS-FL-CLM               VALUE 'F'.
  8228                 88  CS-OT-CLM               VALUE 'O'.
  8229             20  CS-INSURED-TYPE           PIC X.
  8230                 88  CS-PRIM-INSURED          VALUE 'P'.
  8231                 88  CS-CO-BORROWER           VALUE 'C'.
  8232             20  CS-BENEFIT-PERIOD         PIC 99.
  8233             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8234             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8235             20  CS-REMAINING-BENS         PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 157
* EL156.cbl
  8236         16  FILLER                        PIC X(12).
  8237     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8238         16  CS-VIN-NUMBER                 PIC X(17).
  8239         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8240         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8241         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8242         16  cs-agent-name.
  8243             20  cs-agent-fname            pic x(20).
  8244             20  cs-agent-mi               pic x.
  8245             20  cs-agent-lname            pic x(25).
  8246         16  cs-license-no                 pic x(15).
  8247         16  cs-npn-number                 pic x(10).
  8248         16  cs-agent-edit-status          pic x.
  8249             88  cs-ae-refer-to-manager      value 'M'.
  8250             88  cs-ae-cover-sheet           value 'C'.
  8251             88  cs-ae-sig-form              value 'S'.
  8252             88  cs-ae-verified              value 'V'.
  8253             88  cs-unidentified-signature   value 'U'.
  8254             88  cs-cert-returned            value 'R'.
  8255             88  cs-accept-no-commission     value 'N'.
  8256         16  cs-year                       pic 9999.
  8257         16  cs-make                       pic x(20).
  8258         16  cs-model                      pic x(20).
  8259         16  cs-future                     pic x(20).
  8260         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8261         16  cs-claim-verification-status  pic x.
  8262             88  cs-clm-ver-eligible         value 'A'.
  8263             88  cs-clm-ver-partial-elig     value 'B'.
  8264             88  cs-clm-ver-not-eligible     value 'C'.
  8265             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8266             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8267             88  cs-clm-ver-ND-CERT          value 'F'.
  8268             88  cs-clm-ver-spec-other       value 'G'.
  8269             88  cs-clam-ver-pratial-corrected
  8270                                             value 'H'.
  8271             88  cs-clm-ver-no-matches       value 'I'.
  8272             88  cs-clm-ver-not-elig-corrected
  8273                                             value 'J'.
  8274             88  cs-clm-ver-needs-review     value 'R'.
  8275             88  cs-clm-ver-sent-to-claims   value 'W'.
  8276         16  CS-LF-REFUND-METHOD           PIC X.
  8277         16  CS-AH-REFUND-METHOD           PIC X.
  8278         16  FILLER                        PIC X(353). *> was 420
  8279*        16  FILLER                        PIC X(496).
  8280 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8281                          CONTROL-FILE CERTIFICATE-MASTER
  8282                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8283                          ACCOUNT-MASTER CHECK-QUE
  8284                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8285                          DAILY-ACTIVITY-RECORD
  8286                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8287                          CERT-NOTE-FILE PRODUCT-MASTER
  8288                          CERTIFICATE-TRAILERS.
  8289 0000-DFHEXIT SECTION.
  8290     MOVE '9#                    $   ' TO DFHEIV0.
  8291     MOVE 'EL156' TO DFHEIV1.
  8292     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8293
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 158
* EL156.cbl
  8294     IF EIBCALEN = 0
  8295         GO TO 8800-UNAUTHORIZED-ACCESS.
  8296
  8297     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8298     MOVE EIBTRMID               TO QID-TERM.
  8299     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8300     MOVE '2'                    TO EMI-SWITCH2.
  8301     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8302     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8303
  8304     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8305     MOVE '5'                    TO DC-OPTION-CODE.
  8306     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8307     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8308                                    SAVE-BIN-DATE.
  8309     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8310     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8311
  8312     IF SAVE-DATE-YY > 70
  8313         MOVE 19                 TO SAVE-DATE-CC
  8314     ELSE
  8315         MOVE 20                 TO SAVE-DATE-CC.
  8316
  8317     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8318         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8319     END-IF.
  8320
  8321     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8322        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8323     ELSE
  8324        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8325     END-IF
  8326
  8327     IF PI-PRINT-CLM-FRM-YN = 'N'
  8328         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8329     ELSE
  8330         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8331     END-IF
  8332
  8333     IF PI-PRINT-SURVEY-YN = 'N'
  8334         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8335     ELSE
  8336         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8337     END-IF
  8338
  8339     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8340         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8341     ELSE
  8342         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8343     END-IF
  8344
  8345* EXEC CICS HANDLE CONDITION
  8346*        NOTOPEN   (9990-ABEND)
  8347*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8348*        MAPFAIL   (0400-FIRST-TIME)
  8349*        DUPREC    (6180-DUPREC)
  8350*        ERROR     (9990-ABEND)
  8351*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 159
* EL156.cbl
  8352*    MOVE '"$JL?%.               ! " #00008340' TO DFHEIV0
  8353     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8355     MOVE X'2220233030303038333430' TO DFHEIV0(25:11)
  8356     CALL 'kxdfhei1' USING DFHEIV0
  8357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8358
  8359
  8360     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8361         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8362
  8363     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8364         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8365             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8366             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8367             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8368             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8369             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8370             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8371             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8372             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8373             MOVE LOW-VALUES           TO EL156AI
  8374             MOVE 'Y'                  TO FIRST-ENTRY
  8375         ELSE
  8376             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8377             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8378             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8379             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8380             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8381             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8382             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8383             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8384
  8385     IF RETURNED-FROM NOT = SPACES
  8386        IF (RETURNED-FROM = 'EL614')
  8387           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8388           IF WS-SAVED-EOB-CODES NOT = SPACES
  8389              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8390           ELSE
  8391              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8392           END-IF
  8393        END-IF
  8394         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8395            MOVE 'Y'             TO FIRST-ENTRY
  8396            IF RETURNED-FROM = 'EL614'
  8397               AND (PI-PASS-SW NOT = 'C')
  8398               IF WS-SAVED-EOB-CODES NOT = SPACES
  8399                  MOVE WS-SAVED-EOB-CODES
  8400                                 TO PI-PMTNOTE2
  8401                                    WS-PMTNOTE2
  8402                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8403               ELSE
  8404                  MOVE SPACES    TO PI-PMTNOTE2
  8405                                    WS-PMTNOTE2
  8406                                    PI-EOB-CODES-EXIST
  8407               END-IF
  8408            END-IF
  8409            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 160
* EL156.cbl
  8410            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8411            IF RETURNED-FROM = 'EL614'
  8412               GO TO 1000-EDIT-DATA
  8413            END-IF
  8414            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8415               (PAYEEI   = LOW-VALUES OR SPACES)
  8416               GO TO 8100-SEND-INITIAL-MAP
  8417            ELSE
  8418               GO TO 1000-EDIT-DATA.
  8419
  8420     IF EIBTRNID NOT = TRANS-ID
  8421         GO TO 0400-FIRST-TIME.
  8422
  8423     IF EIBAID = DFHCLEAR
  8424        IF PI-PASS-SW = 'C'
  8425           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8426           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8427           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8428           MOVE 'Y'            TO RETURNED-FROM-B
  8429           GO TO 1000-EDIT-DATA
  8430        ELSE
  8431           GO TO 9400-CLEAR.
  8432
  8433     IF PI-PASS-SW = 'C'
  8434         MOVE MAP-NAMEB          TO MAP-NAME
  8435         IF EIBAID = DFHPF1 OR DFHPF13
  8436             GO TO 5000-UPDATE
  8437           ELSE
  8438             IF EIBAID NOT = DFHENTER
  8439                 MOVE LOW-VALUES TO EL156BI
  8440                 MOVE MAP-NAMEB  TO MAP-NAME
  8441                 MOVE ER-0029    TO EMI-ERROR
  8442                 MOVE -1         TO  ENTPFBL
  8443                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8444                 GO TO 8200-SEND-DATAONLY.
  8445
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 161
* EL156.cbl
  8447 0200-RECEIVE.
  8448     MOVE LOW-VALUES             TO EL156AI.
  8449     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8450         MOVE ER-0008            TO EMI-ERROR
  8451         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8452         IF PI-PASS-SW = 'C'
  8453             MOVE -1             TO ENTPFBL
  8454             GO TO 8200-SEND-DATAONLY
  8455         ELSE
  8456             MOVE -1             TO PMTTYPEL
  8457             GO TO 8200-SEND-DATAONLY.
  8458
  8459     IF PI-COMPANY-ID = 'DMD'
  8460         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8461
  8462     IF PI-PASS-SW = 'C'
  8463         MOVE MAP-NAMEB          TO MAP-NAME.
  8464
  8465
  8466* EXEC CICS RECEIVE
  8467*        MAP   (MAP-NAME)
  8468*        MAPSET(MAPSET-NAME)
  8469*        ASIS
  8470*        INTO  (EL156AI)
  8471*    END-EXEC.
  8472     MOVE LENGTH OF
  8473      EL156AI
  8474       TO DFHEIV11
  8475*    MOVE '8"TAI  L              ''   #00008453' TO DFHEIV0
  8476     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8477     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8478     MOVE X'2020233030303038343533' TO DFHEIV0(25:11)
  8479     CALL 'kxdfhei1' USING DFHEIV0,
  8480           MAP-NAME,
  8481           EL156AI,
  8482           DFHEIV11,
  8483           MAPSET-NAME,
  8484           DFHEIV99,
  8485           DFHEIV99
  8486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8487
  8488
  8489     IF PI-PASS-SW NOT = 'C'
  8490         GO TO 0250-MAPA.
  8491
  8492     IF ENTPFBL NOT > ZERO
  8493         MOVE MAP-NAMEB          TO MAP-NAME
  8494         MOVE ER-0029            TO EMI-ERROR
  8495         MOVE -1                 TO  ENTPFBL
  8496         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8497         GO TO 8200-SEND-DATAONLY.
  8498
  8499     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8500         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8501       ELSE
  8502         MOVE MAP-NAMEB           TO MAP-NAME
  8503         MOVE ER-0029             TO EMI-ERROR
  8504         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 162
* EL156.cbl
  8505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8506         GO TO 8200-SEND-DATAONLY.
  8507
  8508     IF EIBAID = DFHPF1 OR DFHPF13
  8509         IF MODIFY-CAP
  8510            GO TO 5000-UPDATE
  8511          ELSE
  8512            MOVE 'UPDATE'           TO SM-READ
  8513            PERFORM 9995-SECURITY-VIOLATION
  8514            MOVE MAP-NAMEB          TO MAP-NAME
  8515            MOVE ER-0070            TO EMI-ERROR
  8516            MOVE -1                 TO  ENTPFBL
  8517            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8518            GO TO 8200-SEND-DATAONLY.
  8519
  8520 0250-MAPA.
  8521     IF ENTERPFL = 0
  8522         GO TO 0300-CHECK-PFKEYS.
  8523
  8524     IF EIBAID NOT = DFHENTER
  8525         MOVE ER-0004            TO EMI-ERROR
  8526         GO TO 0320-INPUT-ERROR.
  8527
  8528     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8529         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8530     ELSE
  8531         MOVE ER-0029            TO EMI-ERROR
  8532         GO TO 0320-INPUT-ERROR.
  8533
  8534 0300-CHECK-PFKEYS.
  8535     IF EIBAID = DFHPF7 OR DFHPF8
  8536         GO TO 8820-PF7-8.
  8537
  8538     IF EIBAID = DFHPF23
  8539         GO TO 8810-PF23.
  8540
  8541     IF EIBAID = DFHPF24
  8542         GO TO 9200-RETURN-MAIN-MENU.
  8543
  8544     IF EIBAID = DFHPF12
  8545         GO TO 9500-PF12.
  8546
  8547     IF EIBAID = DFHPF1
  8548        IF PI-PASS-SW = 'A' OR 'B'
  8549          GO TO 0330-BROWSE-FORWARD.
  8550
  8551     IF EIBAID = DFHPF2
  8552        IF PI-PASS-SW = 'A' OR 'B'
  8553          GO TO 0350-BROWSE-BACKWARD.
  8554
  8555     IF EIBAID = DFHPF6
  8556        IF PI-EOB-CODES-EXIST = 'Y'
  8557           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8558        ELSE
  8559           MOVE SPACES              TO WS-PMTNOTE2
  8560        END-IF
  8561         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8562         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 163
* EL156.cbl
  8563            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8564         END-IF
  8565         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8566         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  8567             MOVE 'EL614'        TO PGM-NAME
  8568             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8569             GO TO 9300-XCTL
  8570         ELSE
  8571             MOVE XCTL-157       TO PGM-NAME
  8572             GO TO 9300-XCTL.
  8573
  8574     IF EIBAID = DFHPF9
  8575        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8576        MOVE XCTL-141            TO PGM-NAME
  8577        GO TO 9300-XCTL.
  8578
  8579     IF EIBAID = DFHPF10
  8580        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8581        MOVE XCTL-155            TO PGM-NAME
  8582        GO TO 9300-XCTL.
  8583
  8584     MOVE SPACES                 TO ERRMSG0O
  8585                                    ERRMSG1O
  8586                                    ERRMSG2O.
  8587
  8588     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8589         IF PI-PASS-SW NOT = 'B'
  8590             MOVE ER-0422        TO EMI-ERROR
  8591             GO TO 0320-INPUT-ERROR
  8592           ELSE
  8593             GO TO 0700-TEST-FOR-CHANGES.
  8594
  8595     IF EIBAID = DFHPF11
  8596        IF PI-PASS-SW = 'C'
  8597           MOVE ER-0029          TO EMI-ERROR
  8598           GO TO 0320-INPUT-ERROR.
  8599
  8600     IF EIBAID = DFHENTER OR DFHPF11
  8601        NEXT SENTENCE
  8602     ELSE
  8603        MOVE ER-0029             TO EMI-ERROR
  8604        GO TO 0320-INPUT-ERROR.
  8605
  8606     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8607
  8608     if pi-epyfrom not = zeros
  8609        if pi-epyfrom not = ws-epyfrom
  8610           move zeros        to ws-edays
  8611        end-if
  8612     end-if
  8613
  8614     if pi-epythru not = zeros
  8615        if pi-epythru not = ws-epythru
  8616           move zeros        to ws-edays
  8617        end-if
  8618     end-if
  8619
  8620     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 164
* EL156.cbl
  8621         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8622         GO TO 1000-EDIT-DATA
  8623     ELSE
  8624         IF PI-FATAL-COUNT NOT = 0 OR
  8625            PI-FORCE-COUNT NOT = 0
  8626             GO TO 1000-EDIT-DATA
  8627         ELSE
  8628             GO TO 2000-EDIT-DONE.
  8629
  8630 0320-INPUT-ERROR.
  8631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8632
  8633     IF ENTERPFL = 0
  8634         MOVE -1                 TO PMTTYPEL
  8635     ELSE
  8636         MOVE AL-UNBON           TO ENTERPFA
  8637         MOVE -1                 TO ENTERPFL.
  8638
  8639     GO TO 8200-SEND-DATAONLY.
  8640
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 165
* EL156.cbl
  8642 0330-BROWSE-FORWARD.
  8643
  8644     MOVE CLMNOI            TO PI-CLAIM-NO.
  8645     MOVE CARRI             TO PI-CARRIER.
  8646     MOVE CERTNOI           TO PI-CERT-PRIME.
  8647     MOVE SUFXI             TO PI-CERT-SFX.
  8648
  8649     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8650     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8651     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8652     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8653
  8654     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8655
  8656
  8657* EXEC CICS HANDLE CONDITION
  8658*         NOTFND   (0380-CLAIM-END-FILE)
  8659*         ENDFILE  (0380-CLAIM-END-FILE)
  8660*    END-EXEC.
  8661*    MOVE '"$I''                  ! # #00008627' TO DFHEIV0
  8662     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8664     MOVE X'2320233030303038363237' TO DFHEIV0(25:11)
  8665     CALL 'kxdfhei1' USING DFHEIV0
  8666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8667
  8668
  8669
  8670* EXEC CICS STARTBR
  8671*         DATASET    ('ELMSTR')
  8672*         RIDFLD     (ELMSTR-KEY)
  8673*         GTEQ
  8674*    END-EXEC.
  8675     MOVE 'ELMSTR' TO DFHEIV1
  8676     MOVE 0
  8677       TO DFHEIV11
  8678*    MOVE '&,         G          &   #00008632' TO DFHEIV0
  8679     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8680     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8681     MOVE X'2020233030303038363332' TO DFHEIV0(25:11)
  8682     CALL 'kxdfhei1' USING DFHEIV0,
  8683           DFHEIV1,
  8684           ELMSTR-KEY,
  8685           DFHEIV99,
  8686           DFHEIV11,
  8687           DFHEIV99
  8688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8689
  8690
  8691     MOVE 'Y' TO WS-BROWSE-START-SW.
  8692
  8693 0335-READNEXT.
  8694
  8695
  8696* EXEC CICS READNEXT
  8697*         DATASET    ('ELMSTR')
  8698*         RIDFLD     (ELMSTR-KEY)
  8699*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 166
* EL156.cbl
  8700*    END-EXEC.
  8701     MOVE 'ELMSTR' TO DFHEIV1
  8702     MOVE 0
  8703       TO DFHEIV11
  8704*    MOVE '&.S                   )   #00008642' TO DFHEIV0
  8705     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8706     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8707     MOVE X'2020233030303038363432' TO DFHEIV0(25:11)
  8708     CALL 'kxdfhei1' USING DFHEIV0,
  8709           DFHEIV1,
  8710           DFHEIV20,
  8711           DFHEIV99,
  8712           ELMSTR-KEY,
  8713           DFHEIV99,
  8714           DFHEIV11,
  8715           DFHEIV99,
  8716           DFHEIV99
  8717     SET ADDRESS OF CLAIM-MASTER TO
  8718         DFHEIV20
  8719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8720
  8721
  8722     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8723        GO TO 0380-CLAIM-END-FILE.
  8724
  8725     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8726        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8727        GO TO 0335-READNEXT.
  8728
  8729     IF PI-COMPANY-ID = 'CRI'
  8730         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8731            GO TO 0380-CLAIM-END-FILE.
  8732
  8733     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8734         GO TO 0335-READNEXT.
  8735
  8736     IF PI-CARRIER-SECURITY > SPACES
  8737         IF CL-CARRIER = PI-CARRIER-SECURITY
  8738             NEXT SENTENCE
  8739         ELSE
  8740             GO TO 0335-READNEXT.
  8741
  8742     IF PI-ACCOUNT-SECURITY > SPACES
  8743         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8744             NEXT SENTENCE
  8745         ELSE
  8746             GO TO 0335-READNEXT.
  8747
  8748     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8749     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8750     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8751
  8752     GO TO 0400-FIRST-TIME.
  8753
  8754 0350-BROWSE-BACKWARD.
  8755
  8756     MOVE CLMNOI            TO PI-CLAIM-NO
  8757                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 167
* EL156.cbl
  8758     MOVE CARRI             TO PI-CARRIER.
  8759     MOVE CERTNOI           TO PI-CERT-PRIME.
  8760     MOVE SUFXI             TO PI-CERT-SFX.
  8761
  8762     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8763
  8764     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8765     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8766     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8767
  8768
  8769* EXEC CICS HANDLE CONDITION
  8770*         NOTFND   (0380-CLAIM-END-FILE)
  8771*         ENDFILE  (0380-CLAIM-END-FILE)
  8772*    END-EXEC.
  8773*    MOVE '"$I''                  ! $ #00008694' TO DFHEIV0
  8774     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8775     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8776     MOVE X'2420233030303038363934' TO DFHEIV0(25:11)
  8777     CALL 'kxdfhei1' USING DFHEIV0
  8778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8779
  8780
  8781
  8782* EXEC CICS STARTBR
  8783*         DATASET    ('ELMSTR')
  8784*         RIDFLD     (ELMSTR-KEY)
  8785*         GTEQ
  8786*    END-EXEC.
  8787     MOVE 'ELMSTR' TO DFHEIV1
  8788     MOVE 0
  8789       TO DFHEIV11
  8790*    MOVE '&,         G          &   #00008699' TO DFHEIV0
  8791     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8792     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8793     MOVE X'2020233030303038363939' TO DFHEIV0(25:11)
  8794     CALL 'kxdfhei1' USING DFHEIV0,
  8795           DFHEIV1,
  8796           ELMSTR-KEY,
  8797           DFHEIV99,
  8798           DFHEIV11,
  8799           DFHEIV99
  8800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8801
  8802
  8803     MOVE 'Y' TO WS-BROWSE-START-SW.
  8804
  8805
  8806* EXEC CICS READNEXT
  8807*         DATASET    ('ELMSTR')
  8808*         RIDFLD     (ELMSTR-KEY)
  8809*         SET        (ADDRESS OF CLAIM-MASTER)
  8810*    END-EXEC.
  8811     MOVE 'ELMSTR' TO DFHEIV1
  8812     MOVE 0
  8813       TO DFHEIV11
  8814*    MOVE '&.S                   )   #00008707' TO DFHEIV0
  8815     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 168
* EL156.cbl
  8816     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8817     MOVE X'2020233030303038373037' TO DFHEIV0(25:11)
  8818     CALL 'kxdfhei1' USING DFHEIV0,
  8819           DFHEIV1,
  8820           DFHEIV20,
  8821           DFHEIV99,
  8822           ELMSTR-KEY,
  8823           DFHEIV99,
  8824           DFHEIV11,
  8825           DFHEIV99,
  8826           DFHEIV99
  8827     SET ADDRESS OF CLAIM-MASTER TO
  8828         DFHEIV20
  8829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8830
  8831
  8832
  8833* EXEC CICS READPREV
  8834*         DATASET    ('ELMSTR')
  8835*         RIDFLD     (ELMSTR-KEY)
  8836*         SET        (ADDRESS OF CLAIM-MASTER)
  8837*    END-EXEC.
  8838     MOVE 'ELMSTR' TO DFHEIV1
  8839     MOVE 0
  8840       TO DFHEIV11
  8841*    MOVE '&0S                   )   #00008713' TO DFHEIV0
  8842     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8843     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8844     MOVE X'2020233030303038373133' TO DFHEIV0(25:11)
  8845     CALL 'kxdfhei1' USING DFHEIV0,
  8846           DFHEIV1,
  8847           DFHEIV20,
  8848           DFHEIV99,
  8849           ELMSTR-KEY,
  8850           DFHEIV99,
  8851           DFHEIV11,
  8852           DFHEIV99,
  8853           DFHEIV99
  8854     SET ADDRESS OF CLAIM-MASTER TO
  8855         DFHEIV20
  8856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8857
  8858
  8859 0360-BROWSE-BACKWARD.
  8860
  8861
  8862* EXEC CICS READPREV
  8863*         DATASET    ('ELMSTR')
  8864*         RIDFLD     (ELMSTR-KEY)
  8865*         SET        (ADDRESS OF CLAIM-MASTER)
  8866*    END-EXEC.
  8867     MOVE 'ELMSTR' TO DFHEIV1
  8868     MOVE 0
  8869       TO DFHEIV11
  8870*    MOVE '&0S                   )   #00008721' TO DFHEIV0
  8871     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8872     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8873     MOVE X'2020233030303038373231' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 169
* EL156.cbl
  8874     CALL 'kxdfhei1' USING DFHEIV0,
  8875           DFHEIV1,
  8876           DFHEIV20,
  8877           DFHEIV99,
  8878           ELMSTR-KEY,
  8879           DFHEIV99,
  8880           DFHEIV11,
  8881           DFHEIV99,
  8882           DFHEIV99
  8883     SET ADDRESS OF CLAIM-MASTER TO
  8884         DFHEIV20
  8885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8886
  8887
  8888     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8889        GO TO 0380-CLAIM-END-FILE.
  8890
  8891     IF PI-COMPANY-ID = 'CRI'
  8892         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8893            GO TO 0380-CLAIM-END-FILE.
  8894
  8895     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8896         GO TO 0360-BROWSE-BACKWARD.
  8897
  8898     IF PI-CARRIER-SECURITY > SPACES
  8899         IF CL-CARRIER = PI-CARRIER-SECURITY
  8900             NEXT SENTENCE
  8901         ELSE
  8902             GO TO 0360-BROWSE-BACKWARD.
  8903
  8904     IF PI-ACCOUNT-SECURITY > SPACES
  8905         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8906             NEXT SENTENCE
  8907         ELSE
  8908             GO TO 0360-BROWSE-BACKWARD.
  8909
  8910     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8911     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8912     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8913
  8914     GO TO 0400-FIRST-TIME.
  8915
  8916 0380-CLAIM-END-FILE.
  8917
  8918     MOVE ER-0130     TO EMI-ERROR.
  8919     MOVE -1          TO CLMNOL.
  8920     MOVE AL-UABON    TO CARRA
  8921                         CLMNOA
  8922                         CERTNOA
  8923                         SUFXA.
  8924
  8925     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8926
  8927     GO TO 8200-SEND-DATAONLY.
  8928
  8929 0400-FIRST-TIME.
  8930
  8931     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 170
* EL156.cbl
  8932        MOVE 'N'         TO WS-BROWSE-START-SW
  8933
  8934* EXEC CICS ENDBR
  8935*            DATASET    ('ELMSTR')
  8936*       END-EXEC.
  8937     MOVE 'ELMSTR' TO DFHEIV1
  8938     MOVE 0
  8939       TO DFHEIV11
  8940*    MOVE '&2                    $   #00008772' TO DFHEIV0
  8941     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8942     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8943     MOVE X'2020233030303038373732' TO DFHEIV0(25:11)
  8944     CALL 'kxdfhei1' USING DFHEIV0,
  8945           DFHEIV1,
  8946           DFHEIV11,
  8947           DFHEIV99
  8948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8949
  8950
  8951     IF PI-PROCESSOR-ID = 'LGXX'
  8952         NEXT SENTENCE
  8953     ELSE
  8954
  8955* EXEC CICS READQ TS
  8956*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8957*            INTO    (SECURITY-CONTROL)
  8958*            LENGTH  (SC-COMM-LENGTH)
  8959*            ITEM    (SC-ITEM)
  8960*        END-EXEC
  8961*    MOVE '*$II   L              ''   #00008779' TO DFHEIV0
  8962     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8963     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8964     MOVE X'2020233030303038373739' TO DFHEIV0(25:11)
  8965     CALL 'kxdfhei1' USING DFHEIV0,
  8966           PI-SECURITY-TEMP-STORE-ID,
  8967           SECURITY-CONTROL,
  8968           SC-COMM-LENGTH,
  8969           SC-ITEM,
  8970           DFHEIV99,
  8971           DFHEIV99
  8972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8973         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8974         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8975
  8976     MOVE LOW-VALUES             TO EL156AI.
  8977     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8978     MOVE 'Y'                    TO FIRST-ENTRY.
  8979     GO TO 7000-SHOW-CLAIM.
  8980
  8981 0500-CREATE-TEMP-STORAGE.
  8982     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8983
  8984
  8985* EXEC CICS WRITEQ TS
  8986*        QUEUE (QID)
  8987*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8988*        LENGTH(PI-COMM-LENGTH)
  8989*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 171
* EL156.cbl
  8990*    MOVE '*"     L              ''   #00008796' TO DFHEIV0
  8991     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8992     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8993     MOVE X'2020233030303038373936' TO DFHEIV0(25:11)
  8994     CALL 'kxdfhei1' USING DFHEIV0,
  8995           QID,
  8996           PROGRAM-INTERFACE-BLOCK,
  8997           PI-COMM-LENGTH,
  8998           DFHEIV99,
  8999           DFHEIV99,
  9000           DFHEIV99
  9001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9002
  9003
  9004
  9005* EXEC CICS WRITEQ TS
  9006*        QUEUE (QID)
  9007*        FROM  (EL156AI)
  9008*        LENGTH(MAP-LENGTH)
  9009*    END-EXEC.
  9010*    MOVE '*"     L              ''   #00008802' TO DFHEIV0
  9011     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  9012     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9013     MOVE X'2020233030303038383032' TO DFHEIV0(25:11)
  9014     CALL 'kxdfhei1' USING DFHEIV0,
  9015           QID,
  9016           EL156AI,
  9017           MAP-LENGTH,
  9018           DFHEIV99,
  9019           DFHEIV99,
  9020           DFHEIV99
  9021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9022
  9023
  9024 0599-EXIT.
  9025      EXIT.
  9026
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 172
* EL156.cbl
  9028 0600-RECOVER-TEMP-STORAGE.
  9029
  9030* EXEC CICS READQ TS
  9031*        QUEUE (QID)
  9032*        INTO  (PROGRAM-INTERFACE-BLOCK)
  9033*        LENGTH(PI-COMM-LENGTH)
  9034*    END-EXEC.
  9035*    MOVE '*$I    L              ''   #00008813' TO DFHEIV0
  9036     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9037     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9038     MOVE X'2020233030303038383133' TO DFHEIV0(25:11)
  9039     CALL 'kxdfhei1' USING DFHEIV0,
  9040           QID,
  9041           PROGRAM-INTERFACE-BLOCK,
  9042           PI-COMM-LENGTH,
  9043           DFHEIV99,
  9044           DFHEIV99,
  9045           DFHEIV99
  9046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9047
  9048
  9049
  9050* EXEC CICS READQ TS
  9051*        QUEUE (QID)
  9052*        INTO  (EL156AI)
  9053*        LENGTH(MAP-LENGTH)
  9054*    END-EXEC.
  9055*    MOVE '*$I    L              ''   #00008819' TO DFHEIV0
  9056     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9057     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9058     MOVE X'2020233030303038383139' TO DFHEIV0(25:11)
  9059     CALL 'kxdfhei1' USING DFHEIV0,
  9060           QID,
  9061           EL156AI,
  9062           MAP-LENGTH,
  9063           DFHEIV99,
  9064           DFHEIV99,
  9065           DFHEIV99
  9066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9067
  9068
  9069     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  9070
  9071     IF PMTTYPEI NOT = LOW-VALUES
  9072         MOVE AL-UANON           TO PMTTYPEA.
  9073
  9074     IF PAYEEI NOT = LOW-VALUES
  9075         MOVE AL-UANON           TO PAYEEA.
  9076
  9077     IF NOTE1I NOT = LOW-VALUES
  9078         MOVE AL-UANON           TO NOTE1A.
  9079
  9080     IF (RETURNED-FROM = 'EL614')
  9081        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9082     END-IF
  9083*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9084*       AND (PI-EOB-CODES-EXIST = 'Y')
  9085*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 173
* EL156.cbl
  9086*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9087     IF PI-SET-NOTE2-MDT = 'Y'
  9088         MOVE AL-SANON           TO NOTE2A
  9089     END-IF
  9090
  9091     IF OFFLINEI NOT = LOW-VALUES
  9092         MOVE AL-UANON           TO OFFLINEA.
  9093
  9094*    IF GROUPEDI NOT = LOW-VALUES
  9095*        MOVE AL-UANON           TO GROUPEDA.
  9096
  9097*    IF CASHI NOT = LOW-VALUES
  9098*        MOVE AL-UANON           TO CASHA.
  9099
  9100     IF CHECKNOI NOT = LOW-VALUES
  9101         MOVE AL-UANON           TO CHECKNOA.
  9102
  9103     IF HOLDTILI NOT = LOW-VALUES
  9104         MOVE AL-UANON           TO HOLDTILA.
  9105
  9106     IF EPYFROMI NOT = LOW-VALUES
  9107         MOVE AL-UANON           TO EPYFROMA.
  9108
  9109     IF AIGFROMI NOT = LOW-VALUES
  9110         MOVE AL-UANON           TO AIGFROMA.
  9111
  9112     IF EPYTHRUI NOT = LOW-VALUES
  9113         MOVE AL-UANON           TO EPYTHRUA.
  9114
  9115     IF EDAYSI NOT = LOW-VALUES
  9116         MOVE AL-UNNON           TO EDAYSA.
  9117
  9118     IF EPYAMTL NOT = +0
  9119         MOVE AL-UNNON           TO EPYAMTA.
  9120
  9121     IF ERESVL NOT = +0
  9122         MOVE AL-UNNON           TO ERESVA.
  9123
  9124     IF EEXPENSL NOT = +0
  9125         MOVE AL-UNNON           TO EEXPENSA.
  9126
  9127     IF ETYPEI NOT = LOW-VALUES
  9128         MOVE AL-UNNON           TO ETYPEA.
  9129
  9130     IF PROOFDTI NOT = 0
  9131         MOVE AL-UNNON           TO PROOFDTA.
  9132
  9133     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9134        MOVE AL-UANON            TO EOBYNA
  9135     END-IF
  9136     IF CLMFMYNI = 'Y' OR 'N'
  9137        MOVE AL-UANON            TO CLMFMYNA
  9138     END-IF
  9139
  9140     IF SURVYYNI = 'Y' OR 'N'
  9141        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9142           MOVE AL-UANON         TO SURVYYNA
  9143        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 174
* EL156.cbl
  9144     END-IF
  9145
  9146     IF SPRELYNI = 'Y' OR 'N'
  9147        MOVE AL-UANON            TO SPRELYNA
  9148     END-IF
  9149
  9150     .
  9151 0699-EXIT.
  9152      EXIT.
  9153
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 175
* EL156.cbl
  9155 0700-TEST-FOR-CHANGES.
  9156     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9157         MOVE ER-0433            TO EMI-ERROR
  9158         GO TO 0750-FUNCTION-ERROR.
  9159
  9160     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9161
  9162     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9163         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9164         MOVE 'A'                TO PI-PASS-SW
  9165         GO TO 1000-EDIT-DATA.
  9166
  9167     IF PI-FATAL-COUNT NOT = 0
  9168         MOVE ER-0499            TO EMI-ERROR
  9169         GO TO 0750-FUNCTION-ERROR.
  9170
  9171     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9172         MOVE ER-0500            TO EMI-ERROR
  9173         GO TO 0750-FUNCTION-ERROR.
  9174
  9175     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9176        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9177           MOVE ER-0542          TO EMI-ERROR
  9178           MOVE -1               TO EPYAMTL
  9179           GO TO 0750-FUNCTION-ERROR.
  9180
  9181     IF PI-OFFLINE = 'Y'  OR
  9182        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9183        MOVE EIBAID              TO PI-PFKEY-USED
  9184        GO TO 5000-UPDATE.
  9185
  9186     GO TO 6000-BUILD-SCREEN-B.
  9187
  9188 0750-FUNCTION-ERROR.
  9189     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9190
  9191     IF ENTERPFL > 0
  9192         MOVE -1                 TO ENTERPFL
  9193         MOVE AL-UNBON           TO ENTERPFA
  9194         GO TO 8200-SEND-DATAONLY
  9195     ELSE
  9196         MOVE -1                 TO ENTERPFL
  9197         MOVE AL-UNNOF           TO ENTERPFA
  9198         GO TO 8200-SEND-DATAONLY.
  9199
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 176
* EL156.cbl
  9201 0800-DELETE-TS.
  9202
  9203* EXEC CICS HANDLE CONDITION
  9204*        QIDERR(0800-EXIT)
  9205*    END-EXEC.
  9206*    MOVE '"$N                   ! % #00008958' TO DFHEIV0
  9207     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9209     MOVE X'2520233030303038393538' TO DFHEIV0(25:11)
  9210     CALL 'kxdfhei1' USING DFHEIV0
  9211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9212
  9213
  9214
  9215* EXEC CICS DELETEQ TS
  9216*        QUEUE(QID)
  9217*    END-EXEC.
  9218*    MOVE '*&                    #   #00008962' TO DFHEIV0
  9219     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9220     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9221     MOVE X'2020233030303038393632' TO DFHEIV0(25:11)
  9222     CALL 'kxdfhei1' USING DFHEIV0,
  9223           QID,
  9224           DFHEIV99
  9225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9226
  9227
  9228 0800-EXIT.
  9229      EXIT.
  9230 0900-GET-DDF-LIMITS.
  9231
  9232     if cm-clp-state = zeros or spaces or low-values
  9233        move cm-state            to cm-clp-state
  9234     end-if
  9235     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9236     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9237     MOVE cm-clp-state           TO ERPDEF-STATE
  9238     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9239     evaluate true
  9240        when (cl-claim-type = 'L' or 'P')
  9241           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9242             and 'CU')
  9243           move 'L'              to erpdef-ben-type
  9244           move pi-lf-benefit-cd to erpdef-ben-code
  9245        when (cl-claim-type not = 'L' and 'P')
  9246           and (pi-ah-benefit-cd not = '00' and '  ')
  9247           move 'A'              to erpdef-ben-type
  9248           move pi-ah-benefit-cd to erpdef-ben-code
  9249        when (cl-claim-type not = 'L' and 'P')
  9250           and (pi-ah-benefit-cd = '00' or '  ')
  9251           move 'L'              to erpdef-ben-type
  9252           move pi-lf-benefit-cd to erpdef-ben-code
  9253        when (cl-claim-type = 'L' or 'P')
  9254           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9255           move 'A'              to erpdef-ben-type
  9256           move pi-ah-benefit-cd to erpdef-ben-code
  9257        when other
  9258           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 177
* EL156.cbl
  9259           move pi-ah-benefit-cd to erpdef-ben-code
  9260     end-evaluate
  9261*    if (cl-claim-type = 'L' or 'P')
  9262*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9263*          and 'CU')
  9264*       move 'L'                 to erpdef-ben-type
  9265*       move pi-lf-benefit-cd    to erpdef-ben-code
  9266*    else
  9267*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9268*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9269*    end-if
  9270     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9271
  9272     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9273
  9274
  9275* EXEC CICS STARTBR
  9276*        DATASET  ('ERPDEF')
  9277*        RIDFLD   (ERPDEF-KEY)
  9278*        GTEQ
  9279*        RESP     (WS-RESPONSE)
  9280*    END-EXEC
  9281     MOVE 'ERPDEF' TO DFHEIV1
  9282     MOVE 0
  9283       TO DFHEIV11
  9284*    MOVE '&,         G          &  N#00009012' TO DFHEIV0
  9285     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9286     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9287     MOVE X'204E233030303039303132' TO DFHEIV0(25:11)
  9288     CALL 'kxdfhei1' USING DFHEIV0,
  9289           DFHEIV1,
  9290           ERPDEF-KEY,
  9291           DFHEIV99,
  9292           DFHEIV11,
  9293           DFHEIV99
  9294     MOVE EIBRESP  TO WS-RESPONSE
  9295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9296
  9297     IF NOT WS-RESP-NORMAL
  9298        GO TO 0900-EXIT
  9299     END-IF
  9300
  9301     .
  9302 0900-READNEXT.
  9303
  9304
  9305* EXEC CICS READNEXT
  9306*       DATASET  ('ERPDEF')
  9307*       SET      (ADDRESS OF PRODUCT-MASTER)
  9308*       RIDFLD   (ERPDEF-KEY)
  9309*       RESP     (WS-RESPONSE)
  9310*    END-EXEC
  9311     MOVE 'ERPDEF' TO DFHEIV1
  9312     MOVE 0
  9313       TO DFHEIV11
  9314*    MOVE '&.S                   )  N#00009026' TO DFHEIV0
  9315     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9316     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 178
* EL156.cbl
  9317     MOVE X'204E233030303039303236' TO DFHEIV0(25:11)
  9318     CALL 'kxdfhei1' USING DFHEIV0,
  9319           DFHEIV1,
  9320           DFHEIV20,
  9321           DFHEIV99,
  9322           ERPDEF-KEY,
  9323           DFHEIV99,
  9324           DFHEIV11,
  9325           DFHEIV99,
  9326           DFHEIV99
  9327     SET ADDRESS OF PRODUCT-MASTER TO
  9328         DFHEIV20
  9329     MOVE EIBRESP  TO WS-RESPONSE
  9330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9331
  9332     IF NOT WS-RESP-NORMAL
  9333        GO TO 0900-ENDBR
  9334     END-IF
  9335
  9336     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9337        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9338           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9339        ELSE
  9340           GO TO 0900-READNEXT
  9341        END-IF
  9342     ELSE
  9343        GO TO 0900-ENDBR
  9344     END-IF
  9345
  9346     IF CM-LOAN-TERM = ZEROS
  9347        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9348     END-IF
  9349
  9350     .
  9351 0900-ENDBR.
  9352
  9353
  9354* EXEC CICS ENDBR
  9355*       DATASET  ('ERPDEF')
  9356*    END-EXEC
  9357     MOVE 'ERPDEF' TO DFHEIV1
  9358     MOVE 0
  9359       TO DFHEIV11
  9360*    MOVE '&2                    $   #00009054' TO DFHEIV0
  9361     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9362     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9363     MOVE X'2020233030303039303534' TO DFHEIV0(25:11)
  9364     CALL 'kxdfhei1' USING DFHEIV0,
  9365           DFHEIV1,
  9366           DFHEIV11,
  9367           DFHEIV99
  9368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9369
  9370     .
  9371 0900-EXIT.
  9372     EXIT.
  9373 1000-EDIT-DATA.
  9374
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 179
* EL156.cbl
  9375     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9376         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9377         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9378
  9379     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9380
  9381     IF NOT MODIFY-CAP
  9382         MOVE ER-0070            TO EMI-ERROR
  9383         MOVE -1                 TO PMTTYPEL
  9384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9385         GO TO 2000-EDIT-DONE.
  9386
  9387     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9388                         '5' AND '6'
  9389         MOVE ER-0420            TO EMI-ERROR
  9390         MOVE -1                 TO PMTTYPEL
  9391         MOVE AL-UABON           TO PMTTYPEA
  9392         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9393     ELSE
  9394         MOVE AL-UANON           TO PMTTYPEA.
  9395
  9396*    IF PI-OFFLINE = 'Y'
  9397*       IF PI-GROUPED = 'Y'
  9398*          MOVE ER-1880         TO EMI-ERROR
  9399*          MOVE -1              TO GROUPEDL
  9400*          MOVE AL-UABON        TO GROUPEDA
  9401*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9402*
  9403*    IF GROUPEDL > +0
  9404*       IF PI-GROUPED = 'Y' OR 'N'
  9405*          MOVE AL-UANON TO GROUPEDA
  9406*       ELSE
  9407*          MOVE ER-3140            TO EMI-ERROR
  9408*          MOVE -1                 TO GROUPEDL
  9409*          MOVE AL-UABON           TO GROUPEDA
  9410*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9411*
  9412*    IF CASHL > +0
  9413*       IF PI-CASH = 'Y' OR 'N'
  9414*          MOVE AL-UANON           TO CASHA
  9415*       ELSE
  9416*          MOVE ER-3141            TO EMI-ERROR
  9417*          MOVE -1                 TO CASHL
  9418*          MOVE AL-UABON           TO CASHA
  9419*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9420
  9421     IF LOANNOL > +0
  9422         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9423
  9424 1000-EDIT-PAYEE.
  9425
  9426     IF PI-PAYEE-SEQ NOT NUMERIC
  9427         MOVE ER-0294            TO  EMI-ERROR
  9428         MOVE -1                 TO  PAYEEL
  9429         MOVE AL-UABON           TO  PAYEEA
  9430         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9431         GO TO 1000-CONT-EDIT.
  9432
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 180
* EL156.cbl
  9433     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9434                         'E' OR 'O' OR 'Q'
  9435         NEXT SENTENCE
  9436     ELSE
  9437         MOVE ER-0294            TO  EMI-ERROR
  9438         MOVE -1                 TO  PAYEEL
  9439         MOVE AL-UABON           TO  PAYEEA
  9440         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9441         GO TO 1000-CONT-EDIT.
  9442
  9443     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9444        (PI-PAYEE-SEQ NOT < '1' AND
  9445         PI-PAYEE-SEQ NOT > '9'))
  9446      OR
  9447        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9448         (PI-PAYEE-SEQ NOT > '9'))
  9449         MOVE AL-UANON            TO PAYEEA
  9450     ELSE
  9451         MOVE ER-0294            TO EMI-ERROR
  9452         MOVE -1                 TO PAYEEL
  9453         MOVE AL-UABON           TO PAYEEA
  9454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9455
  9456     IF PI-COMPANY-ID = 'DMD'
  9457         IF PI-PAYEE-TYPE = 'B' AND
  9458            PI-PAYEE-SEQ NOT = '0'
  9459               MOVE ER-7841            TO EMI-ERROR
  9460               MOVE -1                 TO PAYEEL
  9461               MOVE AL-UABON           TO PAYEEA
  9462               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9463
  9464     IF PI-COMPANY-ID = 'JHL'
  9465         IF PI-PAYEE = 'B0'
  9466             NEXT SENTENCE
  9467           ELSE
  9468
  9469* EXEC CICS HANDLE CONDITION
  9470*            ENDFILE(1950-NOT-FOUND)
  9471*            NOTFND (1950-NOT-FOUND)
  9472*        END-EXEC
  9473*    MOVE '"$''I                  ! & #00009156' TO DFHEIV0
  9474     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9476     MOVE X'2620233030303039313536' TO DFHEIV0(25:11)
  9477     CALL 'kxdfhei1' USING DFHEIV0
  9478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9479         MOVE 'N'                    TO FOUND-TOL-SW
  9480         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9481         MOVE '2'                    TO CNTL-REC-TYPE
  9482         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9483         MOVE +0                     TO CNTL-SEQ-NO
  9484         MOVE 'PROC'                 TO FILE-SWITCH
  9485         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9486         IF PI-PAYEE = 'I1' AND
  9487            APPROVAL-LEVEL-2
  9488             NEXT SENTENCE
  9489           ELSE
  9490         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 181
* EL156.cbl
  9491             MOVE ER-3546        TO EMI-ERROR
  9492             MOVE -1             TO PAYEEL
  9493             MOVE AL-UABON       TO PAYEEA
  9494             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9495
  9496     IF PI-PAYEE-TYPE = 'E'
  9497        IF PI-PMTTYPE = '5' OR '6'
  9498            NEXT SENTENCE
  9499        ELSE
  9500            MOVE ER-3539            TO EMI-ERROR
  9501            MOVE -1                 TO PAYEEL
  9502            MOVE AL-UABON           TO PAYEEA
  9503            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9504
  9505 1000-CONT-EDIT.
  9506
  9507     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9508        IF PI-EPYAMT NOT NEGATIVE
  9509            MOVE ER-0421         TO EMI-ERROR
  9510            MOVE -1              TO OFFLINEL
  9511            MOVE AL-UABON        TO OFFLINEA
  9512            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9513        ELSE
  9514            MOVE AL-UANON        TO OFFLINEA.
  9515
  9516     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  9517        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9518           CONTINUE
  9519        ELSE
  9520           IF PI-PRINT-EOB-YN = 'S' AND
  9521              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
  9522                CONTINUE
  9523           ELSE
  9524              MOVE ER-1561       TO EMI-ERROR
  9525              MOVE -1            TO EOBYNL
  9526              MOVE AL-UABON      TO EOBYNA
  9527              PERFORM 9900-ERROR-FORMAT
  9528                                 THRU 9900-EXIT
  9529           END-IF
  9530        END-IF
  9531
  9532        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9533            MOVE ER-1566        TO EMI-ERROR
  9534            MOVE -1             TO CLMFMYNL
  9535            MOVE AL-UABON       TO CLMFMYNA
  9536            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9537        END-IF
  9538
  9539        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9540            MOVE ER-1567        TO EMI-ERROR
  9541            MOVE -1             TO SURVYYNL
  9542            MOVE AL-UABON       TO SURVYYNA
  9543            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9544        END-IF
  9545
  9546        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9547            MOVE ER-1569        TO EMI-ERROR
  9548            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 182
* EL156.cbl
  9549            MOVE AL-UABON       TO SPRELYNA
  9550            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9551        END-IF
  9552
  9553     END-IF
  9554     IF PI-EPYAMT IS NEGATIVE
  9555         IF PI-OFFLINE NOT = 'Y'
  9556             MOVE ER-0836        TO  EMI-ERROR
  9557             MOVE -1             TO  OFFLINEL
  9558             MOVE AL-UABON       TO  OFFLINEA
  9559             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9560
  9561     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9562        MOVE ER-0872             TO EMI-ERROR
  9563        MOVE -1                  TO PROOFDTL
  9564        MOVE AL-UABON            TO PROOFDTA
  9565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9566     ELSE
  9567        MOVE '4'                TO DC-OPTION-CODE
  9568        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9569        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9570        IF DATE-CONVERSION-ERROR
  9571            MOVE ER-0873        TO EMI-ERROR
  9572            MOVE -1                  TO PROOFDTL
  9573            MOVE AL-UABON            TO PROOFDTA
  9574            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9575        ELSE
  9576            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9577            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9578                MOVE ER-0873    TO EMI-ERROR
  9579                MOVE -1                  TO PROOFDTL
  9580                MOVE AL-UABON            TO PROOFDTA
  9581                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9582            END-IF
  9583        END-IF
  9584     END-IF.
  9585
  9586     IF PI-COMPANY-ID = 'DMD'
  9587        IF NOTE1L NOT = ZEROS
  9588            MOVE ER-7844        TO  EMI-ERROR
  9589            MOVE -1             TO  NOTE1L
  9590            MOVE AL-UABON       TO  NOTE1A
  9591            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9592
  9593     IF PI-COMPANY-ID = 'DMD'
  9594        IF NOTE2L NOT = ZEROS
  9595          GO TO 1004-DMD-EOB-CHECKS.
  9596
  9597     IF NOTE1L NOT > +0
  9598         GO TO 1005-CHECK-ERRORS.
  9599
  9600     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9601         GO TO 1005-CHECK-ERRORS.
  9602
  9603     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9604         GO TO 1003-HAN-PMT-NOTES.
  9605
  9606     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 183
* EL156.cbl
  9607
  9608     IF WS-PMTOPTION NUMERIC
  9609        IF WS-PMTOPTION > '00' AND < '17'
  9610           NEXT SENTENCE
  9611        ELSE
  9612           MOVE ER-0618          TO EMI-ERROR
  9613           MOVE -1               TO NOTE1L
  9614           MOVE AL-UABON         TO NOTE1A
  9615           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9616     ELSE
  9617        GO TO 1005-CHECK-ERRORS.
  9618
  9619     IF WS-PMTOPTION = '05' AND
  9620        WS-DOCNAME = SPACES
  9621          MOVE ER-0616             TO EMI-ERROR
  9622          MOVE -1                  TO NOTE1L
  9623          MOVE AL-UABON            TO NOTE1A
  9624          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9625
  9626     IF WS-PMTOPTION = '15' OR '16'
  9627
  9628* EXEC CICS BIF DEEDIT
  9629*            FIELD (WS-AMOUNT)
  9630*            LENGTH(08)
  9631*        END-EXEC
  9632     MOVE 08
  9633       TO DFHEIV11
  9634*    MOVE '@"L                   #   #00009308' TO DFHEIV0
  9635     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9636     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9637     MOVE X'2020233030303039333038' TO DFHEIV0(25:11)
  9638     CALL 'kxdfhei1' USING DFHEIV0,
  9639           WS-AMOUNT,
  9640           DFHEIV11
  9641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9642        IF (WS-NUM-AMT = ZEROS) OR
  9643           (WS-AMOUNT NOT NUMERIC)
  9644           MOVE ER-0617          TO EMI-ERROR
  9645           MOVE -1               TO NOTE1L
  9646           MOVE AL-UABON         TO NOTE1A
  9647           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9648
  9649     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9650
  9651     GO TO 1005-CHECK-ERRORS.
  9652
  9653 1003-HAN-PMT-NOTES.
  9654
  9655     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9656
  9657     IF WS-HAN-PMT-CODE = SPACE
  9658         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9659     ELSE
  9660     IF WS-HAN-PMT-CODE = 'A'
  9661         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9662                                 TO WS-HAN-PMT-NOTE
  9663     ELSE
  9664     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 184
* EL156.cbl
  9665         MOVE ':FINAL PAYMENT / DECEASED'
  9666                                 TO WS-HAN-PMT-NOTE
  9667     ELSE
  9668     IF WS-HAN-PMT-CODE = 'C'
  9669         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9670                                 TO WS-HAN-PMT-NOTE
  9671     ELSE
  9672     IF WS-HAN-PMT-CODE = 'D'
  9673         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9674                                 TO WS-HAN-PMT-NOTE
  9675     ELSE
  9676     IF WS-HAN-PMT-CODE = 'E'
  9677         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9678                                 TO WS-HAN-PMT-NOTE
  9679     ELSE
  9680     IF WS-HAN-PMT-CODE = 'F'
  9681         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9682                                 TO WS-HAN-PMT-NOTE
  9683     ELSE
  9684     IF WS-HAN-PMT-CODE = 'P'
  9685         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9686
  9687     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9688     GO TO 1005-CHECK-ERRORS.
  9689
  9690 1004-DMD-EOB-CHECKS.
  9691
  9692     INITIALIZE PI-AT-EOB-CODES.
  9693
  9694     IF NOTE2I (20:21) > SPACES
  9695         MOVE ER-7845          TO EMI-ERROR
  9696         MOVE -1               TO NOTE2L
  9697         MOVE AL-UABON         TO NOTE2A
  9698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9699         GO TO 1005-CHECK-ERRORS
  9700      ELSE
  9701         MOVE NOTE2I             TO W-EOB-CODES.
  9702
  9703     MOVE +1                     TO W-EOB-NDX.
  9704
  9705 1004-CHECK-EACH-EOB.
  9706
  9707     IF W-EOB-NDX > +5
  9708             OR
  9709        W-EOB-CODE (W-EOB-NDX) = SPACES
  9710         GO TO 1004-CHECK-DUP-EOB.
  9711
  9712     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9713         MOVE ER-0956            TO EMI-ERROR
  9714         MOVE -1                 TO NOTE2L
  9715         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9716         GO TO 1005-CHECK-ERRORS.
  9717
  9718     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9719     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9720     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9721     MOVE 'DLO023'               TO PGM-NAME.
  9722
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 185
* EL156.cbl
  9723
  9724* EXEC CICS LINK
  9725*        PROGRAM    (PGM-NAME)
  9726*        COMMAREA   (CD-COMMUNICATION-AREA)
  9727*        LENGTH     (CD-RCRD-LENGTH)
  9728*    END-EXEC.
  9729*    MOVE '."C                   (   #00009393' TO DFHEIV0
  9730     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9732     MOVE X'2020233030303039333933' TO DFHEIV0(25:11)
  9733     CALL 'kxdfhei1' USING DFHEIV0,
  9734           PGM-NAME,
  9735           CD-COMMUNICATION-AREA,
  9736           CD-RCRD-LENGTH,
  9737           DFHEIV99,
  9738           DFHEIV99,
  9739           DFHEIV99,
  9740           DFHEIV99
  9741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9742
  9743
  9744     IF CD-RETURN-CODE = 'OK'
  9745         GO TO 1004-CONT.
  9746
  9747     MOVE -1                     TO NOTE2L.
  9748
  9749     IF CD-RETURN-CODE = '01'
  9750         MOVE ER-8310            TO EMI-ERROR
  9751         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9752         GO TO 1005-CHECK-ERRORS.
  9753
  9754     IF CD-RETURN-CODE = '02'
  9755         MOVE ER-8311            TO EMI-ERROR
  9756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9757         GO TO 1005-CHECK-ERRORS.
  9758
  9759     IF CD-RETURN-CODE = '03'
  9760         MOVE ER-8312            TO EMI-ERROR
  9761         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9762         GO TO 1005-CHECK-ERRORS.
  9763
  9764     IF CD-RETURN-CODE = '04'
  9765         MOVE ER-8313            TO EMI-ERROR
  9766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9767         GO TO 1005-CHECK-ERRORS.
  9768
  9769     IF CD-RETURN-CODE = '05'
  9770         MOVE ER-8314            TO EMI-ERROR
  9771         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9772         GO TO 1005-CHECK-ERRORS.
  9773
  9774     IF CD-RETURN-CODE = '06'
  9775         MOVE ER-8315            TO EMI-ERROR
  9776         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9777         GO TO 1005-CHECK-ERRORS.
  9778
  9779     IF CD-RETURN-CODE = 'E1'
  9780         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 186
* EL156.cbl
  9781         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9782         GO TO 1005-CHECK-ERRORS.
  9783
  9784     IF CD-RETURN-CODE = 'N1'
  9785         MOVE ER-8317            TO EMI-ERROR
  9786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9787         GO TO 1005-CHECK-ERRORS.
  9788
  9789 1004-CONT.
  9790     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9791
  9792     ADD +1 TO W-EOB-NDX.
  9793     GO TO 1004-CHECK-EACH-EOB.
  9794
  9795 1004-CHECK-DUP-EOB.
  9796     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9797         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9798                               PI-AT-EOB-CODE (3) OR
  9799                               PI-AT-EOB-CODE (4) OR
  9800                               PI-AT-EOB-CODE (5)))
  9801                  OR
  9802        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9803         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9804                               PI-AT-EOB-CODE (4) OR
  9805                               PI-AT-EOB-CODE (5)))
  9806                  OR
  9807        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9808         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9809                               PI-AT-EOB-CODE (5)))
  9810                  OR
  9811        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9812         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9813            MOVE ER-8000            TO EMI-ERROR
  9814            MOVE AL-UABON           TO NOTE2A
  9815            MOVE -1                 TO NOTE2L
  9816            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9817            GO TO 1005-CHECK-ERRORS.
  9818
  9819 1005-CHECK-ERRORS.
  9820*    IF PI-COMPANY-ID NOT = 'DMD'
  9821        GO TO 1006-CHECK-ERRORS.
  9822
  9823*********  DMD CODE START ******************
  9824*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9825*       GO TO 1006-CHECK-ERRORS.
  9826*
  9827*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9828*
  9829*    COMPUTE W-PAYMENT-TOTAL
  9830*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9831*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9832*               AND
  9833*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9834*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9835*          MOVE ER-0967    TO EMI-ERROR
  9836*          MOVE -1         TO PMTTYPEL
  9837*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9838*
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 187
* EL156.cbl
  9839*    GO TO 1006-CHECK-ERRORS.
  9840*********  DMD CODE END ******************
  9841
  9842 1006-CHECK-ERRORS.
  9843     if emi-forcable-ctr = zeros
  9844        and emi-fatal-ctr = zeros
  9845        continue
  9846     else
  9847        IF NOT EMI-NO-ERRORS
  9848           GO TO 2000-EDIT-DONE
  9849        end-if
  9850     end-if
  9851
  9852* EXEC CICS HANDLE CONDITION
  9853*        NOTFND(1950-NOT-FOUND)
  9854*    END-EXEC.
  9855*    MOVE '"$I                   ! '' #00009506' TO DFHEIV0
  9856     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9858     MOVE X'2720233030303039353036' TO DFHEIV0(25:11)
  9859     CALL 'kxdfhei1' USING DFHEIV0
  9860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9861
  9862
  9863     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9864     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9865     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9866     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9867     MOVE 'MSTR'                 TO FILE-SWITCH.
  9868
  9869     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9870
  9871     IF PI-COMPANY-ID = 'DMD'
  9872         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9873
  9874     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9875        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9876           MOVE ER-0873    TO EMI-ERROR
  9877           MOVE -1                  TO PROOFDTL
  9878           MOVE AL-UABON            TO PROOFDTA
  9879           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9880        END-IF
  9881     END-IF
  9882     if cl-benefit-period = zeros
  9883        move er-1667             to emi-error
  9884        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9885     end-if
  9886     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9887     MOVE +95                    TO TRLR-SEQ-NO
  9888
  9889* EXEC CICS READ
  9890*       DATASET  ('ELTRLR')
  9891*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9892*       RIDFLD   (ELTRLR-KEY)
  9893*       RESP     (WS-RESPONSE)
  9894*    END-EXEC
  9895     MOVE 'ELTRLR' TO DFHEIV1
  9896*    MOVE '&"S        E          (  N#00009535' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 188
* EL156.cbl
  9897     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9898     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9899     MOVE X'204E233030303039353335' TO DFHEIV0(25:11)
  9900     CALL 'kxdfhei1' USING DFHEIV0,
  9901           DFHEIV1,
  9902           DFHEIV20,
  9903           DFHEIV99,
  9904           ELTRLR-KEY,
  9905           DFHEIV99,
  9906           DFHEIV99,
  9907           DFHEIV99
  9908     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9909         DFHEIV20
  9910     MOVE EIBRESP  TO WS-RESPONSE
  9911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9912
  9913     if ws-resp-normal
  9914        perform varying s1 from +1 by +1 until
  9915           at-note-error-no (s1) = spaces
  9916           if at-note-error-no (s1) = '1662'
  9917              continue
  9918           else
  9919              move at-note-error-no (s1)
  9920                                 to emi-error
  9921              if at-note-error-no (s1) = '1653'
  9922                 evaluate true
  9923                    when cl-claim-type = 'L'
  9924                       move '  LF  '
  9925                                 to emi-claim-type
  9926                    when cl-claim-type = 'I'
  9927                       move '  IU  '
  9928                                 to emi-claim-type
  9929                    when cl-claim-type = 'A'
  9930                       move '  AH  '
  9931                                 to emi-claim-type
  9932                    when cl-claim-type = 'O'
  9933                       move '  OT  '
  9934                                 to emi-claim-type
  9935                    when other
  9936                       move ' FMLA '
  9937                                 to emi-claim-type
  9938                 end-evaluate
  9939              end-if
  9940              PERFORM 9900-ERROR-FORMAT
  9941                                 THRU 9900-EXIT
  9942           end-if
  9943        end-perform
  9944     end-if
  9945     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9946         IF PI-PMTTYPE = '5' OR '6'
  9947             NEXT SENTENCE
  9948         ELSE
  9949             MOVE ER-0555             TO EMI-ERROR
  9950             MOVE -1                  TO PMTTYPEL
  9951             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9952
  9953     IF CL-LAST-CLOSE-REASON = '2'
  9954         IF CL-CLAIM-STATUS = 'C'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 189
* EL156.cbl
  9955             MOVE ER-0760        TO  EMI-ERROR
  9956             MOVE -1             TO  PMTTYPEL
  9957             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9958
  9959     IF PI-ACTIVITY-CODE = 9
  9960         MOVE ER-3538            TO  EMI-ERROR
  9961         MOVE -1                 TO  PMTTYPEL
  9962         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9963
  9964     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9965         GO TO 1008-READ-CERT.
  9966**********************AIG LOGIC STARTS *********************
  9967     IF CL-CERT-PRIME = 'INCOMPLETE'
  9968         MOVE ER-3540            TO  EMI-ERROR
  9969         MOVE -1                 TO  PMTTYPEL
  9970         MOVE AL-UABON           TO  PMTTYPEA
  9971         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9972         GO TO 2000-EDIT-DONE.
  9973
  9974     IF PI-PMTTYPE = '4'
  9975         IF PI-EPYAMT IS NEGATIVE
  9976             IF PI-ECHECKNO-CR = 'CR'
  9977                 NEXT SENTENCE
  9978             ELSE
  9979                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9980
  9981     IF PI-PMTTYPE = '4'
  9982         IF PI-ECHECKNO-CR = 'CR'
  9983             IF PI-EPYAMT IS NEGATIVE
  9984                 NEXT SENTENCE
  9985             ELSE
  9986                 MOVE ER-0834    TO  EMI-ERROR
  9987                 MOVE -1         TO  EPYAMTL
  9988                 MOVE AL-UNBON   TO  EPYAMTA
  9989                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9990
  9991     IF PI-PMTTYPE = '4'
  9992         IF PI-EPYAMT IS NEGATIVE
  9993             IF PI-OFFLINE = 'Y'
  9994                 NEXT SENTENCE
  9995             ELSE
  9996                 MOVE 'Y'        TO  PI-OFFLINE
  9997                                     WS-OFFLINE
  9998                                     OFFLINEO
  9999                 MOVE AL-UANON   TO  OFFLINEA.
 10000
 10001*    IF PI-PMTTYPE = '4'
 10002*        IF PI-EPYAMT IS NEGATIVE
 10003*            IF PI-CASH = 'Y'
 10004*                NEXT SENTENCE
 10005*            ELSE
 10006*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
 10007*                MOVE AL-UANON   TO  CASHA
 10008*                GO TO 1007-DEFAULT-AIG-CHECKNO.
 10009*
 10010*    IF PI-CASH NOT = 'Y' AND 'N'
 10011*         IF PI-OFFLINE = 'Y'  AND
 10012*            PI-ECHECKNO-CR = 'CR'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 190
* EL156.cbl
 10013*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
 10014*              MOVE AL-UANON     TO  CASHA
 10015*              GO TO 1007-DEFAULT-AIG-CHECKNO.
 10016*
 10017*    IF PI-CASH NOT = 'Y' AND 'N'
 10018*        IF PI-PMTTYPE = '5' OR '6'
 10019*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
 10020*            MOVE AL-UANON       TO  CASHA
 10021*            GO TO 1007-DEFAULT-AIG-CHECKNO.
 10022*
 10023*    IF PI-CASH NOT = 'Y' AND 'N'
 10024*       IF CL-ASSOCIATES = 'N' OR 'A'
 10025*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
 10026*           MOVE AL-UANON        TO  CASHA
 10027*       ELSE
 10028*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
 10029*           MOVE AL-UANON        TO  CASHA.
 10030*
 10031*    IF PI-PMTTYPE = '5' OR '6'
 10032*        IF PI-CASH = 'N'
 10033*            MOVE ER-0819        TO  EMI-ERROR
 10034*            MOVE AL-UANON       TO  CASHA
 10035*            MOVE -1             TO  CASHL
 10036*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10037*
 10038*    IF CL-ASSOCIATES = 'N' OR 'A'
 10039*       IF CASHI = 'N'
 10040*        MOVE ER-3537            TO  EMI-ERROR
 10041*        MOVE AL-UANON           TO  CASHA
 10042*        MOVE -1                 TO  CASHL
 10043*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10044
 10045 1007-DEFAULT-AIG-CHECKNO.
 10046
 10047     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
 10048         MOVE ER-3532            TO  EMI-ERROR
 10049         MOVE -1                 TO  PMTTYPEL
 10050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10051**********************AIG LOGIC ENDS ***********************
 10052
 10053 1008-READ-CERT.
 10054
 10055     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 10056     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 10057     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 10058     MOVE CL-CERT-STATE          TO CERT-STATE.
 10059     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 10060     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 10061     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 10062     MOVE 'CERT'                 TO FILE-SWITCH.
 10063
 10064     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 10065
 10066     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10067        MOVE CM-LF-LOAN-EXPIRE-DT
 10068                                 TO WS-EXP-DT PI-EXP-DT
 10069                                    ws-extended-exp-dt
 10070     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 191
* EL156.cbl
 10071        MOVE CM-AH-LOAN-EXPIRE-DT
 10072                                 TO WS-EXP-DT PI-EXP-DT
 10073                                    ws-extended-exp-dt
 10074     end-if
 10075     MOVE '6'           TO DC-OPTION-CODE
 10076     if pi-dcc-product-code not = spaces
 10077        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10078        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10079        PERFORM 0900-GET-DDF-limits
 10080                                 THRU 0900-EXIT
 10081        IF PDEF-FOUND
 10082         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 10083           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10084              (P1 > +8)
 10085              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10086           END-PERFORM
 10087           IF P1 < +9
 10088              MOVE '6'           TO DC-OPTION-CODE
 10089              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10090              IF CL-NO-OF-EXTENSIONS NUMERIC
 10091               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10092                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10093                                             PI-MAX-EXT
 10094              ELSE
 10095                 MOVE PD-MAX-EXTENSION (P1)
 10096                                 TO DC-ELAPSED-MONTHS
 10097              END-IF
 10098              PERFORM 9700-LINK-DATE-CONVERT
 10099                                 THRU 9700-EXIT
 10100              if no-conversion-error
 10101                 move dc-bin-date-2 to ws-extended-exp-dt
 10102              end-if
 10103           else
 10104              move er-1674       to emi-error
 10105              PERFORM 9900-ERROR-FORMAT
 10106                                 THRU 9900-EXIT
 10107           end-if
 10108        ELSE
 10109           IF CL-NO-OF-EXTENSIONS NUMERIC
 10110              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10111                                          PI-MAX-EXT
 10112           ELSE
 10113              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10114           END-IF
 10115           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10116           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10117           if no-conversion-error
 10118              move dc-bin-date-2 to ws-extended-exp-dt
 10119           end-if
 10120        end-if
 10121     ELSE
 10122        IF CL-NO-OF-EXTENSIONS NUMERIC
 10123           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10124                                       PI-MAX-EXT
 10125        ELSE
 10126           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10127        END-IF
 10128        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 192
* EL156.cbl
 10129        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10130        if no-conversion-error
 10131           move dc-bin-date-2 to ws-extended-exp-dt
 10132        end-if
 10133     end-if
 10134*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10135*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10136
 10137     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10138         MOVE ER-0458            TO EMI-ERROR
 10139         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10140
 10141     IF (CL-INCURRED-DT > WS-EXP-DT)
 10142        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10143        MOVE ER-1677             TO EMI-ERROR
 10144        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10145     END-IF
 10146     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10147     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10148         MOVE ER-0459            TO EMI-ERROR
 10149         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10150
 10151     IF CL-REPORTED-DT = LOW-VALUES
 10152        MOVE ER-0530             TO EMI-ERROR
 10153        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10154
 10155     IF PI-COMPANY-ID = 'NCL'
 10156        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10157            MOVE ER-0770            TO EMI-ERROR
 10158            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10159
 10160     IF PI-COMPANY-ID = 'NCL'
 10161        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10162            MOVE ER-0737            TO EMI-ERROR
 10163            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10164
 10165     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10166         MOVE ER-0768            TO  EMI-ERROR
 10167         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10168
 10169     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10170         MOVE ER-0769            TO  EMI-ERROR
 10171         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10172
 10173     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10174         GO TO 1020-DO-LIFE-EDITS
 10175     ELSE
 10176         GO TO 1030-DO-AH-EDITS.
 10177
 10178 1010-GENERAL-ERROR.
 10179     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10180
 10181     IF EMI-MESSAGE-FORMATTED
 10182         MOVE -1                 TO PMTTYPEL.
 10183
 10184 1010-EXIT.
 10185     EXIT.
 10186
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 193
* EL156.cbl
 10188 1020-DO-LIFE-EDITS.
 10189     IF CM-LF-BENEFIT-CD = '00'
 10190         IF PI-PMTTYPE = '5' OR '6'
 10191             MOVE ER-0658        TO EMI-ERROR
 10192             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10193         ELSE
 10194            if (pi-company-id = 'DCC' or 'VPP')
 10195               and (pi-dcc-product-code not = spaces)
 10196               continue
 10197            else
 10198               MOVE ER-1775      TO EMI-ERROR
 10199               PERFORM 1040-PMTTYPE-ERROR
 10200                                 THRU 1040-EXIT
 10201            end-if
 10202         end-if
 10203     end-if
 10204
 10205     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10206     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10207         MOVE ER-0460            TO EMI-ERROR
 10208         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10209
 10210     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10211     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10212     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10213     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10214     MOVE '4'                    TO  CNTL-REC-TYPE.
 10215     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10216     MOVE 'BENE'                 TO  FILE-SWITCH.
 10217     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10218     IF NO-BENEFIT-FOUND
 10219         GO TO 1950-NOT-FOUND.
 10220
 10221     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10222
 10223     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10224       AND NOT CM-LF-LUMP-SUM-DISAB
 10225         IF PI-PMTTYPE = '4'
 10226             IF (PI-LIFE-OVERRIDE-L1 = 'P' OR
 10227                PI-LF-COVERAGE-TYPE = 'P')
 10228               AND NOT CM-LF-LUMP-SUM-DISAB
 10229                 NEXT SENTENCE
 10230             ELSE
 10231                 MOVE ER-0461        TO EMI-ERROR
 10232                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10233         ELSE
 10234            NEXT SENTENCE
 10235     ELSE
 10236         IF PI-PMTTYPE = '2'
 10237            IF NOT CM-O-B-COVERAGE
 10238              AND CM-LF-CURRENT-STATUS = '7'
 10239                MOVE ER-0462     TO EMI-ERROR
 10240                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10241
 10242     IF PI-PMTTYPE = '2'
 10243         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10244            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10245             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 194
* EL156.cbl
 10246             MOVE ER-0730            TO  EMI-ERROR
 10247             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10248             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10249
 10250     IF PI-PMTTYPE = '2'
 10251         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10252            PI-LF-COVERAGE-TYPE = 'P'
 10253             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10254                 MOVE ER-0462    TO  EMI-ERROR
 10255                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10256
 10257     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10258       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10259         MOVE ER-0466            TO EMI-ERROR
 10260         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10261
 10262     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10263         IF PI-PMTTYPE = '3'
 10264             MOVE 0436           TO EMI-ERROR
 10265             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10266             GO TO 1045-EDIT-PAYEE-ADDR
 10267         ELSE
 10268             GO TO 1045-EDIT-PAYEE-ADDR.
 10269
 10270     IF CL-CLAIM-TYPE = 'O'
 10271         IF PI-PMTTYPE = '1' OR '2'
 10272             MOVE ER-1930          TO EMI-ERROR
 10273             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10274         END-IF
 10275     ELSE
 10276     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10277        PI-LF-COVERAGE-TYPE = 'P'
 10278         IF PI-PMTTYPE = '3'
 10279             MOVE ER-0436          TO  EMI-ERROR
 10280             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10281         ELSE
 10282             NEXT SENTENCE
 10283     ELSE
 10284         IF PI-PMTTYPE = '1' OR '3'
 10285             MOVE ER-0436            TO EMI-ERROR
 10286             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10287*
 10288     IF PI-COMPANY-ID = 'CID' AND
 10289        CL-CERT-STATE = 'SC'  AND
 10290        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10291           MOVE ER-0879    TO  EMI-ERROR
 10292           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10293           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10294     END-IF.
 10295     IF PI-COMPANY-ID = 'AHL'
 10296        evaluate true
 10297           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10298              MOVE ER-0879       TO  EMI-ERROR
 10299              PERFORM 1040-PMTTYPE-ERROR
 10300                                 THRU 1040-EXIT
 10301              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10302           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10303                 '6D' OR '6H' OR '6R'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 195
* EL156.cbl
 10304              MOVE ER-0879       TO  EMI-ERROR
 10305              PERFORM 1040-PMTTYPE-ERROR
 10306                                 THRU 1040-EXIT
 10307              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10308           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10309              MOVE ER-0879       TO  EMI-ERROR
 10310              PERFORM 1040-PMTTYPE-ERROR
 10311                                 THRU 1040-EXIT
 10312              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10313        end-evaluate
 10314     END-IF
 10315     GO TO 1045-EDIT-PAYEE-ADDR.
 10316
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 196
* EL156.cbl
 10318 1030-DO-AH-EDITS.
 10319     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10320     IF CM-AH-BENEFIT-CD = '00'
 10321         IF PI-PMTTYPE = '5' OR '6'
 10322             MOVE ER-0658        TO EMI-ERROR
 10323             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10324         ELSE
 10325             MOVE ER-1775        TO EMI-ERROR
 10326             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10327
 10328     IF CL-TOTAL-PAID-AMT = ZEROS
 10329         IF PI-PMTTYPE = '4'
 10330             MOVE ER-0438        TO EMI-ERROR
 10331             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10332
 10333     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10334         IF PI-PMTTYPE = '3'
 10335             MOVE ER-0463        TO EMI-ERROR
 10336             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10337         ELSE
 10338             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10339              AND CM-LF-CURRENT-STATUS = '7'
 10340                 MOVE ER-0465    TO EMI-ERROR
 10341                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10342
 10343     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10344         IF PI-PMTTYPE = '3'
 10345             MOVE ER-0464        TO EMI-ERROR
 10346             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10347         ELSE
 10348             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10349                 MOVE ER-0469    TO EMI-ERROR
 10350                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10351
 10352     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10353         IF PI-PMTTYPE = '3'
 10354             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10355                 MOVE ER-0467    TO EMI-ERROR
 10356                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10357             ELSE
 10358                 NEXT SENTENCE
 10359         ELSE
 10360             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10361                 MOVE ER-0468    TO EMI-ERROR
 10362                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10363
 10364     IF PI-PMTTYPE = '2'
 10365        PERFORM WITH TEST AFTER
 10366         VARYING SUB FROM +1 BY +5
 10367          UNTIL SUB > +60
 10368            OR PI-PMTNOTE2(SUB:1) = 'F'
 10369            OR PI-PMTNOTE2(SUB:1) NOT > SPACES
 10370        END-PERFORM
 10371        IF PI-PMTNOTE2(SUB:1) NOT = 'F'
 10372           MOVE ER-3551    TO EMI-ERROR
 10373           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10374        END-IF
 10375     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 197
* EL156.cbl
 10376     GO TO 1045-EDIT-PAYEE-ADDR.
 10377
 10378 1040-PMTTYPE-ERROR.
 10379     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10380
 10381     IF EMI-MESSAGE-FORMATTED
 10382         MOVE -1                 TO PMTTYPEL
 10383         MOVE AL-UABON           TO PMTTYPEA.
 10384
 10385 1040-EXIT.
 10386     EXIT.
 10387
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 198
* EL156.cbl
 10389 1045-EDIT-PAYEE-ADDR.
 10390
 10391     IF PI-OFFLINE = 'N' AND
 10392        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10393           < PI-PAYEE-SEQ-NUM)
 10394        OR
 10395         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10396         (PI-PAYEE-TYPE = 'B')                 AND
 10397         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10398        OR
 10399         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10400           < PI-PAYEE-SEQ-NUM)
 10401        OR
 10402         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10403           < PI-PAYEE-SEQ-NUM)
 10404        OR
 10405         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10406           < PI-PAYEE-SEQ-NUM)
 10407        OR
 10408         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10409           < PI-PAYEE-SEQ-NUM)
 10410        OR
 10411         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10412           < PI-PAYEE-SEQ-NUM))
 10413             MOVE ER-0437        TO EMI-ERROR
 10414             MOVE -1             TO PAYEEL
 10415             MOVE AL-UABON       TO PAYEEA
 10416             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10417
 10418     IF PI-OFFLINE    = 'N' AND
 10419        PI-PAYEE-TYPE = 'B' AND
 10420        PI-PAYEE-SEQ  = '0'
 10421         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10422         IF BENE-FOUND-SW = 'N'
 10423             MOVE ER-0437        TO EMI-ERROR
 10424             MOVE -1             TO PAYEEL
 10425             MOVE AL-UABON       TO PAYEEA
 10426             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10427
 10428     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10429        IF PI-OFFLINE    = 'N'  AND
 10430           PI-PAYEE-TYPE = 'B'  AND
 10431           PI-PAYEE-SEQ  = '9'
 10432             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10433             IF BENE-FOUND-SW = 'N'
 10434                MOVE ER-0437        TO EMI-ERROR
 10435                MOVE -1             TO PAYEEL
 10436                MOVE AL-UABON       TO PAYEEA
 10437                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10438
 10439*    IF PI-COMPANY-ID = 'CRI'
 10440*        IF CL-CLAIM-TYPE = 'L'
 10441*            MOVE 'N'                TO  WS-GROUPED
 10442*                                        PI-GROUPED
 10443*                                        GROUPEDI
 10444*            MOVE AL-UANON           TO  GROUPEDA
 10445*            GO TO 1050-EDIT-CHECK-NO
 10446*        ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 199
* EL156.cbl
 10447*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10448*            IF WS-GROUP-1 = 'C'
 10449*                NEXT SENTENCE
 10450*            ELSE
 10451*                MOVE 'N'            TO  WS-GROUPED
 10452*                                        PI-GROUPED
 10453*                                        GROUPEDI
 10454*                MOVE AL-UANON       TO  GROUPEDA
 10455*                GO TO 1050-EDIT-CHECK-NO.
 10456
 10457*     IF PI-GROUPED = 'Y'
 10458*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10459*           NEXT SENTENCE
 10460*        ELSE
 10461*           MOVE ER-0437        TO EMI-ERROR
 10462*           MOVE -1             TO PAYEEL
 10463**02180            MOVE AL-UABON       TO PAYEEA
 10464*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10465*
 10466*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10467*        (PI-GROUPED    = ' ')
 10468*        NEXT SENTENCE
 10469*     ELSE
 10470*
 10471     GO TO 1050-EDIT-CHECK-NO.
 10472*     IF PI-COMPANY-ID = 'CRI'
 10473*        MOVE 'N'           TO GROUPEDI
 10474*                              PI-GROUPED
 10475*                              WS-GROUPED
 10476*        MOVE AL-UANON      TO GROUPEDA.
 10477*
 10478*     IF PI-COMPANY-ID = 'CRI'
 10479*        IF PI-PAYEE-TYPE = 'B'
 10480*           IF BENE-FOUND-SW = 'Y'
 10481*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10482*                 MOVE 'Y'           TO GROUPEDI
 10483*                                       PI-GROUPED
 10484*                                       WS-GROUPED
 10485*                 MOVE AL-UANON      TO GROUPEDA
 10486*              ELSE
 10487*                 NEXT SENTENCE
 10488*           ELSE
 10489*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10490*              IF BENE-FOUND-SW = 'Y'
 10491*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10492*                    MOVE 'Y'      TO GROUPEDI
 10493*                                     PI-GROUPED
 10494*                                     WS-GROUPED
 10495*                    MOVE AL-UANON TO GROUPEDA.
 10496*
 10497
 10498     IF PI-COMPANY-ID NOT = 'CRI'
 10499        GO TO 1050-EDIT-CHECK-NO.
 10500
 10501*************** CRI CODE START ******************
 10502     IF PI-PAYEE-TYPE NOT = 'A'
 10503        GO TO 1050-EDIT-CHECK-NO.
 10504
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 200
* EL156.cbl
 10505     MOVE LOW-VALUES             TO ERACCT-KEY.
 10506     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10507     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10508     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10509     MOVE PI-STATE               TO ACCT-STATE.
 10510     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10511     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10512     MOVE 'ACCT'                 TO FILE-SWITCH.
 10513
 10514     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10515     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10516
 10517
 10518* EXEC CICS HANDLE CONDITION
 10519*         NOTFND   (1950-NOT-FOUND)
 10520*         ENDFILE  (1950-NOT-FOUND)
 10521*    END-EXEC.
 10522*    MOVE '"$I''                  ! ( #00010146' TO DFHEIV0
 10523     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10525     MOVE X'2820233030303130313436' TO DFHEIV0(25:11)
 10526     CALL 'kxdfhei1' USING DFHEIV0
 10527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10528
 10529
 10530
 10531* EXEC CICS STARTBR
 10532*         DATASET   ('ERACCT')
 10533*         RIDFLD    (ERACCT-KEY)
 10534*         GTEQ
 10535*    END-EXEC.
 10536     MOVE 'ERACCT' TO DFHEIV1
 10537     MOVE 0
 10538       TO DFHEIV11
 10539*    MOVE '&,         G          &   #00010151' TO DFHEIV0
 10540     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10542     MOVE X'2020233030303130313531' TO DFHEIV0(25:11)
 10543     CALL 'kxdfhei1' USING DFHEIV0,
 10544           DFHEIV1,
 10545           ERACCT-KEY,
 10546           DFHEIV99,
 10547           DFHEIV11,
 10548           DFHEIV99
 10549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10550
 10551
 10552 1046-READNEXT-ERACCT.
 10553
 10554
 10555* EXEC CICS READNEXT
 10556*         DATASET   ('ERACCT')
 10557*         RIDFLD    (ERACCT-KEY)
 10558*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10559*    END-EXEC.
 10560     MOVE 'ERACCT' TO DFHEIV1
 10561     MOVE 0
 10562       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 201
* EL156.cbl
 10563*    MOVE '&.S                   )   #00010159' TO DFHEIV0
 10564     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10565     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10566     MOVE X'2020233030303130313539' TO DFHEIV0(25:11)
 10567     CALL 'kxdfhei1' USING DFHEIV0,
 10568           DFHEIV1,
 10569           DFHEIV20,
 10570           DFHEIV99,
 10571           ERACCT-KEY,
 10572           DFHEIV99,
 10573           DFHEIV11,
 10574           DFHEIV99,
 10575           DFHEIV99
 10576     SET ADDRESS OF ACCOUNT-MASTER TO
 10577         DFHEIV20
 10578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10579
 10580
 10581     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10582        IF WS-ERACCT-HOLD-RECORD = SPACES
 10583           GO TO 1950-NOT-FOUND
 10584        ELSE
 10585           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10586           GO TO 1048-CONTINUE.
 10587
 10588     IF ACCT-EXP-DT = HIGH-VALUES
 10589        NEXT SENTENCE
 10590     ELSE
 10591        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10592        GO TO 1046-READNEXT-ERACCT.
 10593
 10594 1048-CONTINUE.
 10595
 10596*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10597*       MOVE 'Y'                 TO GROUPEDI
 10598*                                   PI-GROUPED
 10599*                                   WS-GROUPED
 10600*       MOVE AL-UANON            TO GROUPEDA.
 10601*************** CRI CODE END ******************
 10602
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 202
* EL156.cbl
 10604 1050-EDIT-CHECK-NO.
 10605
 10606     IF PI-OFFLINE = 'Y'
 10607         IF PI-ECHECKNO = SPACES
 10608              MOVE ER-0439        TO EMI-ERROR
 10609              GO TO 1090-CHECK-NO-ERROR
 10610           ELSE
 10611*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10612*           IF PI-ECHECKNO-N = 'N' AND
 10613*              PI-CASH       = 'Y'
 10614*                MOVE ER-3535        TO EMI-ERROR
 10615*                GO TO 1090-CHECK-NO-ERROR
 10616*             ELSE
 10617*                MOVE AL-UANON    TO CHECKNOA
 10618*                GO TO 1100-EDIT-HOLDTIL
 10619*         ELSE
 10620            MOVE AL-UANON    TO CHECKNOA
 10621            GO TO 1100-EDIT-HOLDTIL.
 10622
 10623     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10624     MOVE '6'                    TO CNTL-REC-TYPE.
 10625
 10626     IF CONTROL-IS-ACTUAL-CARRIER
 10627         MOVE PI-CARRIER         TO WS-CARR
 10628     ELSE
 10629         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10630
 10631     IF PI-COMPANY-ID = 'FIA'
 10632         MOVE PI-CARRIER         TO WS-CARR.
 10633
 10634     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10635     MOVE 0                      TO CNTL-SEQ-NO.
 10636     MOVE 'CARR'                 TO FILE-SWITCH.
 10637
 10638     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10639
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 203
* EL156.cbl
 10641     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10642         GO TO 1051-EDIT-CHECKNO-CONT.
 10643
 10644**********************AIG LOGIC STARTS**********************
 10645     IF PI-ECHECKNO = SPACES
 10646         IF CHECK-NO-MANUAL
 10647             MOVE ER-0441        TO EMI-ERROR
 10648             GO TO 1090-CHECK-NO-ERROR
 10649         ELSE
 10650             MOVE AL-UANOF       TO CHECKNOA
 10651             GO TO 1100-EDIT-HOLDTIL.
 10652
 10653     IF PI-ECHECKNO NOT = SPACES
 10654         IF CHECK-NO-MANUAL
 10655             MOVE AL-UANON       TO CHECKNOA
 10656             GO TO 1100-EDIT-HOLDTIL.
 10657
 10658     IF PI-ECHECKNO-CR = 'CR'
 10659        IF PI-OFFLINE = 'Y'
 10660            MOVE AL-UANON       TO CHECKNOA
 10661            GO TO 1100-EDIT-HOLDTIL
 10662        ELSE
 10663            MOVE ER-3534        TO EMI-ERROR
 10664            GO TO 1090-CHECK-NO-ERROR.
 10665
 10666     IF PI-ECHECKNO-N = 'N'
 10667        IF PI-CASH = 'N'
 10668            MOVE AL-UANON       TO CHECKNOA
 10669            GO TO 1100-EDIT-HOLDTIL
 10670        ELSE
 10671            MOVE ER-3535          TO EMI-ERROR
 10672            GO TO 1090-CHECK-NO-ERROR.
 10673
 10674     MOVE ER-0442        TO EMI-ERROR
 10675     GO TO 1090-CHECK-NO-ERROR.
 10676**********************AIG LOGIC ENDS************************
 10677
 10678 1051-EDIT-CHECKNO-CONT.
 10679
 10680     IF PI-COMPANY-ID = 'DMD'
 10681        IF PI-ECHECKNO NOT = SPACES
 10682           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10683              MOVE ER-0442        TO EMI-ERROR
 10684              GO TO 1090-CHECK-NO-ERROR
 10685            ELSE
 10686              GO TO 1100-EDIT-HOLDTIL
 10687          ELSE
 10688           GO TO 1100-EDIT-HOLDTIL.
 10689
 10690     IF PI-ECHECKNO = SPACES
 10691         IF CHECK-NO-MANUAL
 10692             MOVE ER-0441        TO EMI-ERROR
 10693             GO TO 1090-CHECK-NO-ERROR
 10694         ELSE
 10695             MOVE AL-UANOF       TO CHECKNOA
 10696             GO TO 1100-EDIT-HOLDTIL
 10697     ELSE
 10698         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 204
* EL156.cbl
 10699             MOVE AL-UANON       TO CHECKNOA
 10700             GO TO 1100-EDIT-HOLDTIL
 10701         ELSE
 10702             MOVE ER-0442        TO EMI-ERROR
 10703             GO TO 1090-CHECK-NO-ERROR.
 10704
 10705 1090-CHECK-NO-ERROR.
 10706     MOVE -1                     TO CHECKNOL.
 10707     MOVE AL-UABON               TO CHECKNOA.
 10708     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10709
 10710     GO TO 2000-EDIT-DONE.
 10711
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 205
* EL156.cbl
 10713 1100-EDIT-HOLDTIL.
 10714     MOVE ZERO TO WS-TOT-AMOUNT-PAID
 10715                  WS-UNPD-HOLD-UNTIL-DT
 10716     SET HOLD-UNTIL-CHK TO TRUE
 10717     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 10718     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10719     IF CL-TOTAL-PAID-AMT NOT = WS-TOT-AMOUNT-PAID
 10720         MOVE ER-3277            TO EMI-ERROR
 10721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10722     END-IF
 10723
 10724     MOVE SPACE TO WS-HOLD-UNTIL-SW
 10725
 10726     MOVE AL-UANON               TO HOLDTILA.
 10727
 10728     IF PI-HOLDTIL = ZEROS
 10729        IF PI-OFFLINE = 'Y'
 10730           MOVE ER-0572          TO EMI-ERROR
 10731           GO TO 1105-HOLDTIL-ERROR
 10732        ELSE
 10733           GO TO 1110-EDIT-PAID-FROM.
 10734
 10735     MOVE '4'                    TO DC-OPTION-CODE.
 10736     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10737     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10738
 10739     IF DATE-CONVERSION-ERROR
 10740         MOVE ER-0446            TO EMI-ERROR
 10741         GO TO 1105-HOLDTIL-ERROR
 10742     END-IF
 10743     IF PI-OFFLINE = 'Y'
 10744        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10745           MOVE ER-0446            TO EMI-ERROR
 10746           GO TO 1105-HOLDTIL-ERROR
 10747        END-IF
 10748     END-IF
 10749
 10750     IF DC-BIN-DATE-1 < WS-UNPD-HOLD-UNTIL-DT
 10751        MOVE ER-3278          TO EMI-ERROR
 10752        GO TO 1105-HOLDTIL-ERROR
 10753     END-IF
 10754
 10755     IF PI-OFFLINE = 'Y'
 10756        GO TO 1110-EDIT-PAID-FROM.
 10757
 10758     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10759     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10760     MOVE '1'                    TO DC-OPTION-CODE.
 10761     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10762
 10763*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10764     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR
 10765         MOVE ER-0447            TO EMI-ERROR
 10766         GO TO 1105-HOLDTIL-ERROR.
 10767
 10768     GO TO 1110-EDIT-PAID-FROM.
 10769
 10770 1105-HOLDTIL-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 206
* EL156.cbl
 10771     MOVE -1                     TO HOLDTILL.
 10772     MOVE AL-UNBON               TO HOLDTILA.
 10773     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10774
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 207
* EL156.cbl
 10776 1110-EDIT-PAID-FROM.
 10777     MOVE AL-UANON               TO EPYFROMA.
 10778
 10779     IF PI-EPYFROM = ZEROS
 10780         GO TO 1120-CALCULATE-PAID-FROM.
 10781
 10782     IF PI-PMTTYPE = '5' OR '6'
 10783         MOVE ER-0448            TO EMI-ERROR
 10784         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10785         MOVE AL-UNBON           TO EPYFROMA
 10786         MOVE -1                 TO EPYFROML
 10787         GO TO 1150-EDIT-PAID-THRU.
 10788
 10789     MOVE '4'                    TO DC-OPTION-CODE.
 10790     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10791     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10792
 10793     IF DATE-CONVERSION-ERROR
 10794         MOVE ER-0449            TO EMI-ERROR
 10795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10796         MOVE AL-UNBON           TO EPYFROMA
 10797         MOVE -1                 TO EPYFROML
 10798     ELSE
 10799         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10800
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 208
* EL156.cbl
 10802 1120-CALCULATE-PAID-FROM.
 10803     IF PI-PMTTYPE = '5' OR '6'
 10804         GO TO 1150-EDIT-PAID-THRU.
 10805
 10806*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10807*       IF PI-PMTTYPE = '4'
 10808*         GO TO 1150-EDIT-PAID-THRU.
 10809
 10810     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10811         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10812         MOVE ' '                TO DC-OPTION-CODE
 10813         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10814         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10815         GO TO 1145-TEST-PAID-FROM.
 10816
 10817     IF PI-PMTTYPE = '4'
 10818        GO TO 1150-EDIT-PAID-THRU.
 10819
 10820     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10821     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10822     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10823     MOVE '5'                    TO CNTL-REC-TYPE.
 10824     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10825     MOVE 'BENE'                 TO FILE-SWITCH.
 10826
 10827     IF WS-BEN-CD = ZEROS
 10828         GO TO 1950-NOT-FOUND.
 10829
 10830     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10831
 10832     IF NO-BENEFIT-FOUND
 10833         GO TO 1950-NOT-FOUND.
 10834
 10835     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10836     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10837
 10838     IF PI-BEN-DAYS NOT NUMERIC
 10839        MOVE ZEROS               TO PI-BEN-DAYS.
 10840
 10841     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10842
 10843     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT
 10844         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1
 10845         MOVE '6'                 TO DC-OPTION-CODE
 10846         MOVE +0                  TO DC-ELAPSED-MONTHS
 10847         MOVE +1                  TO DC-ELAPSED-DAYS
 10848         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10849         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10850         GO TO 1145-TEST-PAID-FROM.
 10851
 10852     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10853        (CL-TOTAL-PAID-AMT > ZEROS)
 10854         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10855         MOVE '6'                 TO DC-OPTION-CODE
 10856         MOVE +0                  TO DC-ELAPSED-MONTHS
 10857         MOVE +1                  TO DC-ELAPSED-DAYS
 10858         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10859         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 209
* EL156.cbl
 10860         GO TO 1145-TEST-PAID-FROM.
 10861
 10862******************************************************************
 10863****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10864****** SPECIAL ENTERED DATE.
 10865******************************************************************
 10866
 10867     IF PI-AIGFROM = ZEROS
 10868         GO TO 1130-CONTINUE-PAID-FROM.
 10869
 10870     MOVE AL-UANON TO AIGFROMA.
 10871
 10872     MOVE '4'                    TO DC-OPTION-CODE.
 10873     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10874     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10875
 10876     IF DATE-CONVERSION-ERROR
 10877         MOVE ER-0449            TO EMI-ERROR
 10878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10879         MOVE AL-UNBON           TO AIGFROMA
 10880         MOVE -1                 TO AIGFROML
 10881         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10882     ELSE
 10883         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10884         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10885
 10886     GO TO 1140-CONTINUE-PAID-FROM.
 10887
 10888 1130-CONTINUE-PAID-FROM.
 10889
 10890     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10891        (CL-TOTAL-PAID-AMT = ZEROS)
 10892           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10893
 10894 1140-CONTINUE-PAID-FROM.
 10895
 10896     IF PI-BEN-TYPE = 'R'
 10897         IF PI-BEN-DAYS = ZEROS
 10898             NEXT SENTENCE
 10899         ELSE
 10900         IF PI-COMPANY-ID NOT = 'DMD'
 10901             SUBTRACT 1 FROM PI-BEN-DAYS.
 10902
 10903     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10904
 10905     IF PI-COMPANY-ID = 'DMD'
 10906         MOVE -1                 TO DC-ELAPSED-DAYS
 10907         MOVE +0                 TO DC-ELAPSED-MONTHS
 10908         MOVE '6'                TO DC-OPTION-CODE
 10909         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10910         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10911         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10912                               REMAINDER DC-ELAPSED-DAYS
 10913      ELSE
 10914         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10915         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10916
 10917     MOVE '6'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 210
* EL156.cbl
 10918     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10919     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10920
 10921     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10922
 10923     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10924         MOVE ER-0541            TO EMI-ERROR
 10925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10926         MOVE -1                 TO EPYFROML
 10927         MOVE AL-UNBON           TO EPYFROMA.
 10928
 10929     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10930        (PI-BENEFIT-SAVE = '60E')
 10931        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10932           (CL-TOTAL-PAID-AMT = ZEROS)
 10933             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10934             MOVE 30                  TO DC-ELAPSED-DAYS
 10935             MOVE +0                  TO DC-ELAPSED-MONTHS
 10936             MOVE '6'                 TO DC-OPTION-CODE
 10937             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10938
 10939     IF PI-BEN-TYPE = 'R'
 10940         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10941     ELSE
 10942         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10943         IF WS-SV-EPYFROM = LOW-VALUES
 10944            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10945
 10946     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10947         IF WS-USE-AIG-PAYFROM   OR
 10948            WS-AIG-RECALC-PAYFROM
 10949              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10950                                      DC-BIN-DATE-1
 10951              MOVE ' '            TO  DC-OPTION-CODE
 10952              MOVE +0             TO  DC-ELAPSED-MONTHS
 10953                                      DC-ELAPSED-DAYS
 10954              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10955              IF NO-CONVERSION-ERROR
 10956                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10957
 10958     IF PI-CPYFROM < CL-INCURRED-DT
 10959        MOVE -1                  TO EPYFROML
 10960        MOVE ER-3542             TO EMI-ERROR
 10961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10962
 10963     IF CM-ENTRY-DT < CL-INCURRED-DT
 10964        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10965        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10966        MOVE +0                     TO DC-ELAPSED-DAYS
 10967        MOVE +0                     TO DC-ELAPSED-MONTHS
 10968        MOVE '1'                    TO DC-OPTION-CODE
 10969        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10970        ELSE
 10971        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10972
 10973     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10974         NEXT SENTENCE
 10975     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 211
* EL156.cbl
 10976         IF DC-ELAPSED-MONTHS < 2
 10977             MOVE ER-3255        TO EMI-ERROR
 10978             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10979
 10980 1145-TEST-PAID-FROM.
 10981     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10982         GO TO 1150-EDIT-PAID-THRU.
 10983
 10984     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10985         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10986         MOVE ' '                TO DC-OPTION-CODE
 10987         MOVE +0                 TO DC-ELAPSED-MONTHS
 10988                                    DC-ELAPSED-DAYS
 10989         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10990         IF NO-CONVERSION-ERROR
 10991             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10992         ELSE
 10993             MOVE SPACES             TO EMI-DATE-FIELD.
 10994
 10995     IF PI-HOLDTIL NOT = ZEROS
 10996        CONTINUE
 10997     ELSE
 10998     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10999         IF CL-TOTAL-PAID-AMT = ZEROS
 11000             MOVE ER-3543            TO EMI-ERROR
 11001             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 11002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11003             IF EMI-MESSAGE-FORMATTED
 11004                MOVE -1             TO EPYFROML
 11005                MOVE AL-UNBON       TO EPYFROMA
 11006             ELSE
 11007                NEXT SENTENCE
 11008         ELSE
 11009             MOVE ER-0452            TO EMI-ERROR
 11010             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 11011             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11012             IF EMI-MESSAGE-FORMATTED
 11013                MOVE -1             TO EPYFROML
 11014                MOVE AL-UNBON       TO EPYFROMA.
 11015
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 212
* EL156.cbl
 11017 1150-EDIT-PAID-THRU.
 11018
 11019     MOVE AL-UANON               TO EPYTHRUA.
 11020
 11021     IF PI-EPYTHRU = ZEROS
 11022*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 11023         IF PI-PMTTYPE = '5' OR '6'
 11024           OR (CL-CLAIM-TYPE NOT = 'L' AND 'O'
 11025             AND PI-PMTTYPE = '4')
 11026             GO TO 1200-EDIT-FIND-TOLERANCES
 11027         ELSE
 11028            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 11029               (PI-PMTTYPE = '2' AND
 11030                 CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 11031               GO TO 1152-CHECK-TYPE
 11032            ELSE
 11033               MOVE ER-0473      TO EMI-ERROR
 11034               GO TO 1170-PAID-THRU-FATAL-ERROR
 11035     ELSE
 11036         IF PI-PMTTYPE = '5' OR '6'
 11037             MOVE ER-0474        TO EMI-ERROR
 11038             GO TO 1170-PAID-THRU-FATAL-ERROR.
 11039
 11040     MOVE '4'                    TO DC-OPTION-CODE.
 11041     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 11042     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11043
 11044     IF DATE-CONVERSION-ERROR
 11045         MOVE ER-0475            TO EMI-ERROR
 11046         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11047
 11048     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 11049
 11050     IF PI-COMPANY-ID = 'DMD'
 11051         IF PI-PMTTYPE NOT = '2'
 11052                 AND
 11053            WS-EXP-DT > WS-SV-EPYTHRU
 11054             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 11055             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 11056             MOVE '1'              TO DC-OPTION-CODE
 11057             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11058             IF DATE-CONVERSION-ERROR
 11059                 MOVE ER-0944      TO EMI-ERROR
 11060                 GO TO 1170-PAID-THRU-FATAL-ERROR
 11061             ELSE
 11062                 IF DC-ELAPSED-MONTHS = ZEROS AND
 11063                    DC-ELAPSED-DAYS   = 1
 11064                     MOVE ER-0945  TO EMI-ERROR
 11065                     MOVE -1       TO EPYTHRUL
 11066                     MOVE AL-UABON TO EPYTHRUA
 11067                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11068
 11069     IF PI-PMTTYPE = '4'
 11070         NEXT SENTENCE
 11071     ELSE
 11072         IF WS-SV-EPYTHRU = WS-EXP-DT
 11073             IF PI-PMTTYPE NOT = '2' AND '3'
 11074                 MOVE ER-3541    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 213
* EL156.cbl
 11075                 MOVE -1         TO PMTTYPEL
 11076                 MOVE AL-UABON   TO PMTTYPEA
 11077                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11078
 11079     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 11080         MOVE ER-0501            TO EMI-ERROR
 11081         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11082
 11083     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 11084        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 11085*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11086*              MOVE ER-0540         TO EMI-ERROR
 11087*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11088*              MOVE -1              TO EPYTHRUL
 11089*              MOVE AL-UNBON        TO EPYTHRUA
 11090*          ELSE
 11091*          IF PI-COMPANY-ID = 'DMD'
 11092*              MOVE ER-7540         TO EMI-ERROR
 11093*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11094*              MOVE -1              TO EPYTHRUL
 11095*              MOVE AL-UNBON        TO EPYTHRUA
 11096*          ELSE
 11097               IF PI-PMTTYPE NOT = '2' AND '3'
 11098                  IF PI-COMPANY-ID = '???'
 11099                      MOVE ER-7540  TO EMI-ERROR
 11100                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11101                      MOVE -1       TO EPYTHRUL
 11102                      MOVE AL-UNBON TO EPYTHRUA
 11103                  ELSE
 11104                      MOVE ER-0540  TO EMI-ERROR
 11105                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11106                      MOVE -1       TO EPYTHRUL
 11107                      MOVE AL-UNBON TO EPYTHRUA.
 11108
 11109     MOVE 'N' TO PI-DUPE-APPROVAL-NEEDED
 11110     IF ((WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11111            OR
 11112        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 11113         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11114            OR
 11115        (PI-CPYFROM NOT = LOW-VALUES AND
 11116         PI-CPYFROM < CL-PAID-THRU-DT))
 11117       AND NOT PI-PMTTYPE = '4'
 11118        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT
 11119     ELSE
 11120     IF WS-SV-EPYTHRU NOT = LOW-VALUES
 11121       AND WS-SV-EPYFROM NOT = LOW-VALUES
 11122        SET CHECK-ALL-PMTS TO TRUE
 11123        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 11124
 11125     IF PI-HOLDTIL = ZEROS
 11126       AND UNPAID-HOLD-UNTIL-EXISTS
 11127       AND NOT DUPE-VOID-PMT-EXISTS
 11128        MOVE ER-3276    TO EMI-ERROR
 11129        MOVE -1         TO HOLDTILL
 11130        MOVE AL-UABON   TO HOLDTILA
 11131        GO TO 1170-PAID-THRU-FATAL-ERROR
 11132     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 214
* EL156.cbl
 11133
 11134 1152-CHECK-TYPE.
 11135     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11136        OR (PI-PMTTYPE = '5' OR '6')
 11137         GO TO 1160-EDIT-PAID-THRU-AH.
 11138
 11139 1155-EDIT-PAID-THRU-LIFE.
 11140     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11141     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11142     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11143     MOVE '4'                    TO CNTL-REC-TYPE.
 11144     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11145     MOVE 'BENE'                 TO FILE-SWITCH.
 11146
 11147     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11148
 11149     IF NO-BENEFIT-FOUND
 11150         GO TO 1950-NOT-FOUND.
 11151
 11152     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11153
 11154     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11155
 11156     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11157        PI-LF-COVERAGE-TYPE = 'P'
 11158         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11159         GO TO 1200-EDIT-FIND-TOLERANCES.
 11160
 11161     IF PI-EPYTHRU = ZEROS
 11162        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11163
 11164     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11165         MOVE ER-0476            TO EMI-ERROR
 11166         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11167
 11168     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11169*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11170     move cl-critical-period    to dc-elapsed-months
 11171     MOVE +0                    TO DC-ELAPSED-DAYS.
 11172     MOVE '6'                   TO DC-OPTION-CODE.
 11173     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11174
 11175     IF (NO-CONVERSION-ERROR AND
 11176         WS-SPECIAL-CALC-CD = 'C')
 11177        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11178            MOVE ER-0657 TO EMI-ERROR
 11179            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11180
 11181     IF PI-COMPANY-ID = 'NCL'
 11182         IF WS-SPECIAL-CALC-CD = 'C' AND
 11183            cl-critical-period = zeros
 11184*           CM-LF-CRITICAL-PERIOD = +0
 11185             MOVE ER-0844       TO EMI-ERROR
 11186             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11187
 11188     GO TO 1200-EDIT-FIND-TOLERANCES.
 11189
 11190 1160-EDIT-PAID-THRU-AH.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 215
* EL156.cbl
 11191     IF PI-EPYTHRU = ZEROS
 11192        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11193                                    WS-SV-EPYTHRU
 11194     ELSE
 11195        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11196
 11197     IF WS-SV-EPYTHRU < PI-CPYFROM
 11198         MOVE ER-0508            TO EMI-ERROR
 11199         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11200
 11201     perform 7975-read-acct      thru 7975-exit
 11202     move zeros                  to pi-max-ext
 11203     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11204        PERFORM 0900-GET-DDF-LIMITS
 11205                                 THRU 0900-EXIT
 11206        IF PDEF-FOUND
 11207           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11208              (P1 > +8)
 11209              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11210           END-PERFORM
 11211           IF P1 < +9
 11212              MOVE PD-MAX-extension (P1)
 11213                                 TO pi-max-ext
 11214           else
 11215              move er-1674       to emi-error
 11216              PERFORM 9900-ERROR-FORMAT
 11217                                 THRU 9900-EXIT
 11218           END-IF
 11219        else
 11220           move er-1672          to emi-error
 11221           PERFORM 9900-ERROR-FORMAT
 11222                                 THRU 9900-EXIT
 11223        END-IF
 11224     end-if
 11225     move spaces                 to pi-max-ext-used
 11226     IF PI-PMTTYPE = '3'
 11227        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11228        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11229           MOVE ER-0477          TO EMI-ERROR
 11230           PERFORM 1165-PAID-THRU-ERROR
 11231                                 THRU 1165-EXIT
 11232        ELSE
 11233           continue
 11234        end-if
 11235     ELSE
 11236        IF WS-SV-EPYTHRU > WS-EXP-DT
 11237         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11238           move ws-exp-dt        to dc-bin-date-1
 11239           move ws-sv-epythru    to dc-bin-date-2
 11240           MOVE '1'              TO DC-OPTION-CODE
 11241           MOVE +0               TO DC-ELAPSED-DAYS
 11242                                    DC-ELAPSED-MONTHS
 11243           PERFORM 9700-LINK-DATE-CONVERT
 11244                                 THRU 9700-EXIT
 11245           if no-conversion-error
 11246              if dc-elapsed-days > zeros
 11247                 add +1 to dc-elapsed-months
 11248              end-if
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 216
* EL156.cbl
 11249              if dc-elapsed-months > pi-max-ext
 11250                 MOVE ER-0557    TO EMI-ERROR
 11251                 PERFORM 1165-PAID-THRU-ERROR
 11252                                 THRU 1165-EXIT
 11253              else
 11254                 move 'Y'        to pi-max-ext-used
 11255                 move er-1670    to emi-error
 11256                 perform 9900-error-format
 11257                                 thru 9900-exit
 11258              end-if
 11259           end-if
 11260         ELSE
 11261            MOVE ER-0557    TO EMI-ERROR
 11262            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11263         END-IF
 11264        end-if
 11265     end-if
 11266
 11267     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11268         PI-PMTTYPE NOT = '3'
 11269         MOVE ER-0541        TO EMI-ERROR
 11270         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11271
 11272     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11273        (PI-PMTTYPE NOT = '3')
 11274         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11275             MOVE ER-0478        TO EMI-ERROR
 11276             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11277
 11278     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11279        (PI-PMTTYPE NOT = '4')
 11280         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11281             MOVE ER-0479        TO EMI-ERROR
 11282             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11283
 11284     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11285         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11286             MOVE ER-0545        TO EMI-ERROR
 11287             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11288
 11289     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11290         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11291             MOVE ER-0481        TO EMI-ERROR
 11292             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11293
 11294*    IF PI-COMPANY-ID = 'NCL'
 11295*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11296*           CM-AH-CRITICAL-PERIOD = +0
 11297*            MOVE ER-0844        TO  EMI-ERROR
 11298*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11299
 11300*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11301     if (cl-critical-period = zeros)
 11302        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11303          GO TO 1200-EDIT-FIND-TOLERANCES.
 11304
 11305     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11306     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 217
* EL156.cbl
 11307     MOVE '1'        TO DC-OPTION-CODE.
 11308     MOVE +0         TO DC-ELAPSED-DAYS
 11309                        DC-ELAPSED-MONTHS.
 11310     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11311
 11312*    IF NO-CONVERSION-ERROR
 11313*       COMPUTE ws-benefits-paid =
 11314*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11315*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11316*           MOVE ER-0657 TO EMI-ERROR
 11317*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11318
 11319     GO TO 1200-EDIT-FIND-TOLERANCES.
 11320
 11321 1165-PAID-THRU-ERROR.
 11322     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11323
 11324     IF EMI-MESSAGE-FORMATTED
 11325         MOVE -1                 TO EPYTHRUL
 11326         MOVE AL-UNBON           TO EPYTHRUA.
 11327
 11328 1165-EXIT.
 11329     EXIT.
 11330
 11331 1166-CHECK-ALL-TRLRS.
 11332
 11333     IF PI-PMTTYPE = '4'
 11334       AND NOT HOLD-UNTIL-CHK
 11335       AND NOT CHECK-ALL-PMTS
 11336        GO TO 1166-TRLR-EXIT.
 11337
 11338     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11339
 11340     IF HOLD-UNTIL-CHK
 11341        CONTINUE
 11342     ELSE
 11343     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11344        WS-SV-EPYFROM = LOW-VALUES
 11345          GO TO 1166-END-CHECK.
 11346
 11347
 11348* EXEC CICS HANDLE CONDITION
 11349*        ENDFILE   (1166-END-CHECK)
 11350*        NOTFND    (1166-END-CHECK)
 11351*    END-EXEC.
 11352*    MOVE '"$''I                  ! ) #00010931' TO DFHEIV0
 11353     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11355     MOVE X'2920233030303130393331' TO DFHEIV0(25:11)
 11356     CALL 'kxdfhei1' USING DFHEIV0
 11357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11358
 11359
 11360     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11361     MOVE +100                   TO TRLR-SEQ-NO.
 11362
 11363
 11364* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 218
* EL156.cbl
 11365*         DATASET    ('ELTRLR')
 11366*         RIDFLD     (ELTRLR-KEY)
 11367*         GTEQ
 11368*    END-EXEC.
 11369     MOVE 'ELTRLR' TO DFHEIV1
 11370     MOVE 0
 11371       TO DFHEIV11
 11372*    MOVE '&,         G          &   #00010939' TO DFHEIV0
 11373     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11375     MOVE X'2020233030303130393339' TO DFHEIV0(25:11)
 11376     CALL 'kxdfhei1' USING DFHEIV0,
 11377           DFHEIV1,
 11378           ELTRLR-KEY,
 11379           DFHEIV99,
 11380           DFHEIV11,
 11381           DFHEIV99
 11382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11383
 11384
 11385     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11386
 11387 1166-READ-TRLR-NEXT.
 11388
 11389
 11390* EXEC CICS READNEXT
 11391*         DATASET    ('ELTRLR')
 11392*         RIDFLD     (ELTRLR-KEY)
 11393*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11394*    END-EXEC.
 11395     MOVE 'ELTRLR' TO DFHEIV1
 11396     MOVE 0
 11397       TO DFHEIV11
 11398*    MOVE '&.S                   )   #00010949' TO DFHEIV0
 11399     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11400     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11401     MOVE X'2020233030303130393439' TO DFHEIV0(25:11)
 11402     CALL 'kxdfhei1' USING DFHEIV0,
 11403           DFHEIV1,
 11404           DFHEIV20,
 11405           DFHEIV99,
 11406           ELTRLR-KEY,
 11407           DFHEIV99,
 11408           DFHEIV11,
 11409           DFHEIV99,
 11410           DFHEIV99
 11411     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11412         DFHEIV20
 11413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11414
 11415
 11416     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11417        TRLR-CARRIER  = MSTR-CARRIER  AND
 11418        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11419        TRLR-CERT-NO  = MSTR-CERT-NO
 11420          NEXT SENTENCE
 11421      ELSE
 11422          GO TO 1166-END-CHECK.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 219
* EL156.cbl
 11423
 11424* **  BYPASS ALL NON-PAYMENT TRAILERS
 11425
 11426     IF AT-TRAILER-TYPE = '2'
 11427        NEXT SENTENCE
 11428     ELSE
 11429        GO TO 1166-READ-TRLR-NEXT.
 11430
 11431* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11432
 11433     IF (HOLD-UNTIL-CHK
 11434       OR CHECK-ALL-PMTS)
 11435       AND AT-PAYMENT-TYPE <= '4'
 11436        NEXT SENTENCE
 11437     ELSE
 11438     IF AT-PAYMENT-TYPE = '1' OR '2'
 11439        NEXT SENTENCE
 11440     ELSE
 11441        GO TO 1166-READ-TRLR-NEXT.
 11442
 11443     IF ((AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11444        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES))
 11445        AND NOT HOLD-UNTIL-CHK
 11446          GO TO 1166-READ-TRLR-NEXT.
 11447* **  BYPASS ALL VOID PAYMENTS
 11448
 11449     IF AT-VOID-DT NOT = LOW-VALUES
 11450        IF WS-SV-EPYTHRU = AT-PAID-THRU-DT
 11451          AND WS-SV-EPYFROM = AT-PAID-FROM-DT
 11452            SET DUPE-VOID-PMT-EXISTS TO TRUE
 11453        END-IF
 11454        GO TO 1166-READ-TRLR-NEXT.
 11455
 11456     IF HOLD-UNTIL-CHK
 11457        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT
 11458          AND AT-TO-BE-WRITTEN-DT > ZERO
 11459           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 11460        END-IF
 11461        IF AT-TO-BE-WRITTEN-DT > ZERO
 11462          AND AT-CHECK-WRITTEN-DT = LOW-VALUES
 11463           SET UNPAID-HOLD-UNTIL-EXISTS TO TRUE
 11464           IF AT-TO-BE-WRITTEN-DT > WS-UNPD-HOLD-UNTIL-DT
 11465              MOVE AT-TO-BE-WRITTEN-DT TO WS-UNPD-HOLD-UNTIL-DT
 11466           END-IF
 11467        END-IF
 11468        IF AT-AMOUNT-PAID NUMERIC
 11469          AND (AT-CHECK-WRITTEN-DT > LOW-VALUES
 11470             OR AT-TO-BE-WRITTEN-DT < ZERO)
 11471          AND AT-PAYMENT-TYPE  <= '4'
 11472           ADD AT-AMOUNT-PAID TO WS-TOT-AMOUNT-PAID
 11473        END-IF
 11474     END-IF
 11475
 11476     IF HOLD-UNTIL-CHK
 11477        CONTINUE
 11478     ELSE
 11479     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11480         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 220
* EL156.cbl
 11481            OR
 11482        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11483         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11484        NEXT SENTENCE
 11485     ELSE
 11486         IF WS-SV-EPYTHRU = AT-PAID-THRU-DT
 11487          AND WS-SV-EPYFROM = AT-PAID-FROM-DT
 11488          AND (PI-OFFLINE NOT EQUAL 'Y')
 11489          AND (CL-CLAIM-TYPE NOT = 'L' AND 'O')
 11490            IF PI-PMTTYPE = '4'
 11491               MOVE 'Y' TO PI-DUPE-APPROVAL-NEEDED
 11492               MOVE ER-3280            TO EMI-ERROR
 11493               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11494               MOVE -1                 TO EPYTHRUL
 11495               MOVE AL-UNBON           TO EPYTHRUA
 11496            ELSE
 11497               MOVE ER-3279            TO EMI-ERROR
 11498               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11499               MOVE -1                 TO EPYTHRUL
 11500               MOVE AL-UNBON           TO EPYTHRUA
 11501         ELSE
 11502         IF CL-TOTAL-PAID-AMT > ZEROS
 11503           AND NOT CHECK-ALL-PMTS
 11504             MOVE ER-0502            TO EMI-ERROR
 11505             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11506             MOVE -1                 TO EPYTHRUL
 11507             MOVE AL-UNBON           TO EPYTHRUA.
 11508
 11509     GO TO 1166-READ-TRLR-NEXT.
 11510
 11511 1166-END-CHECK.
 11512
 11513     IF WS-BROWSE-TRLR-SW = 'Y'
 11514
 11515* EXEC CICS ENDBR
 11516*            DATASET   ('ELTRLR')
 11517*       END-EXEC.
 11518     MOVE 'ELTRLR' TO DFHEIV1
 11519     MOVE 0
 11520       TO DFHEIV11
 11521*    MOVE '&2                    $   #00011053' TO DFHEIV0
 11522     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11524     MOVE X'2020233030303131303533' TO DFHEIV0(25:11)
 11525     CALL 'kxdfhei1' USING DFHEIV0,
 11526           DFHEIV1,
 11527           DFHEIV11,
 11528           DFHEIV99
 11529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11530
 11531
 11532     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11533
 11534 1166-TRLR-EXIT.
 11535     EXIT.
 11536
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 221
* EL156.cbl
 11538 1170-PAID-THRU-FATAL-ERROR.
 11539     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11540
 11541     MOVE -1                     TO EPYTHRUL.
 11542     MOVE AL-UNBON               TO EPYTHRUA.
 11543
 11544 1200-EDIT-FIND-TOLERANCES.
 11545
 11546* EXEC CICS HANDLE CONDITION
 11547*        ENDFILE(1950-NOT-FOUND)
 11548*        NOTFND (1950-NOT-FOUND)
 11549*    END-EXEC.
 11550*    MOVE '"$''I                  ! * #00011070' TO DFHEIV0
 11551     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11553     MOVE X'2A20233030303131303730' TO DFHEIV0(25:11)
 11554     CALL 'kxdfhei1' USING DFHEIV0
 11555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11556
 11557
 11558     IF PI-PROCESSOR-ID = 'LGXX'
 11559        GO TO 1240-FIND-ACCT-TOLERANCES.
 11560
 11561     MOVE 'N'                    TO FOUND-TOL-SW.
 11562     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11563     MOVE '2'                    TO CNTL-REC-TYPE.
 11564     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11565     MOVE +0                     TO CNTL-SEQ-NO.
 11566     MOVE 'PROC'                 TO FILE-SWITCH.
 11567
 11568     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11569
 11570     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11571     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11572                                    PI-MAX-PMT-TOL.
 11573     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11574
 11575     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11576         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11577
 11578     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11579     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11580                                    PI-MAX-LF-PMT-TOL.
 11581
 11582     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11583         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11584
 11585     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11586                                    PI-MAX-EXP-PMT.
 11587
 11588 1240-FIND-ACCT-TOLERANCES.
 11589
 11590     IF WS-PMT-TOL NOT = +0
 11591         MOVE 'Y'                TO FOUND-TOL-SW.
 11592
 11593     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11594         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11595         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 222
* EL156.cbl
 11596         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11597         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11598         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11599         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11600     ELSE
 11601         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11602         MOVE PI-CARRIER             TO ACCT-CARRIER
 11603         MOVE PI-GROUPING            TO ACCT-GROUPING
 11604         MOVE PI-STATE               TO ACCT-STATE
 11605         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11606         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11607
 11608     MOVE 'ACCT'                 TO FILE-SWITCH.
 11609
 11610     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11611     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11612
 11613
 11614* EXEC CICS HANDLE CONDITION
 11615*         NOTFND   (1950-NOT-FOUND)
 11616*         ENDFILE  (1950-NOT-FOUND)
 11617*    END-EXEC.
 11618*    MOVE '"$I''                  ! + #00011130' TO DFHEIV0
 11619     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11621     MOVE X'2B20233030303131313330' TO DFHEIV0(25:11)
 11622     CALL 'kxdfhei1' USING DFHEIV0
 11623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11624
 11625
 11626
 11627* EXEC CICS STARTBR
 11628*        DATASET('ERACCT')
 11629*        RIDFLD (ERACCT-KEY)
 11630*        GTEQ
 11631*    END-EXEC.
 11632     MOVE 'ERACCT' TO DFHEIV1
 11633     MOVE 0
 11634       TO DFHEIV11
 11635*    MOVE '&,         G          &   #00011135' TO DFHEIV0
 11636     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11637     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11638     MOVE X'2020233030303131313335' TO DFHEIV0(25:11)
 11639     CALL 'kxdfhei1' USING DFHEIV0,
 11640           DFHEIV1,
 11641           ERACCT-KEY,
 11642           DFHEIV99,
 11643           DFHEIV11,
 11644           DFHEIV99
 11645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11646
 11647
 11648 1245-FIND-ACCT-TOLERANCES-LOOP.
 11649
 11650
 11651* EXEC CICS READNEXT
 11652*        DATASET('ERACCT')
 11653*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 223
* EL156.cbl
 11654*        RIDFLD (ERACCT-KEY)
 11655*    END-EXEC.
 11656     MOVE 'ERACCT' TO DFHEIV1
 11657     MOVE 0
 11658       TO DFHEIV11
 11659*    MOVE '&.S                   )   #00011143' TO DFHEIV0
 11660     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11661     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11662     MOVE X'2020233030303131313433' TO DFHEIV0(25:11)
 11663     CALL 'kxdfhei1' USING DFHEIV0,
 11664           DFHEIV1,
 11665           DFHEIV20,
 11666           DFHEIV99,
 11667           ERACCT-KEY,
 11668           DFHEIV99,
 11669           DFHEIV11,
 11670           DFHEIV99,
 11671           DFHEIV99
 11672     SET ADDRESS OF ACCOUNT-MASTER TO
 11673         DFHEIV20
 11674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11675
 11676
 11677     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11678        IF WS-ERACCT-HOLD-RECORD = SPACES
 11679           GO TO 1950-NOT-FOUND
 11680        ELSE
 11681           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11682           GO TO 1250-CONTINUE.
 11683
 11684     IF ACCT-EXP-DT = HIGH-VALUES
 11685        NEXT SENTENCE
 11686     ELSE
 11687        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11688        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11689
 11690 1250-CONTINUE.
 11691
 11692     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11693
 11694     IF FOUND-TOL-SW = 'N'
 11695         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11696
 11697********* 1260-FIND-STATE-TOLERANCES.
 11698
 11699     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11700     MOVE PI-STATE               TO WS-ST-ACCESS.
 11701     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11702     MOVE '3'                    TO CNTL-REC-TYPE.
 11703     MOVE +0                     TO CNTL-SEQ-NO.
 11704     MOVE 'STAT'                 TO FILE-SWITCH.
 11705
 11706     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11707
 11708     IF WS-PMT-TOL = +0
 11709         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11710
 11711     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 224
* EL156.cbl
 11712     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11713     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11714     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11715     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11716
 11717****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11718****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11719     IF PI-PAYEE-TYPE <> 'B'
 11720           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11721     END-IF.
 11722
 11723     IF PI-PMTTYPE      = '2'  AND
 11724        PI-SPLIT-PMT-SW = 'Y'  AND
 11725        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 11726          MOVE ER-3530                TO EMI-ERROR
 11727          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11728
 11729********* 1280-FIND-BENEFIT-TOLERANCES.
 11730
 11731     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11732        OR (PI-PMTTYPE = '5' OR '6')
 11733         GO TO 1300-FIND-CARR-TOLERANCES.
 11734
 11735     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11736     MOVE '4'                    TO CNTL-REC-TYPE.
 11737     MOVE +0                     TO CNTL-SEQ-NO.
 11738     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11739     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11740     MOVE 'BENE'                 TO FILE-SWITCH.
 11741
 11742     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11743
 11744     IF NO-BENEFIT-FOUND
 11745         GO TO 1950-NOT-FOUND.
 11746
 11747     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11748     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11749     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11750
 11751
 11752* EXEC CICS HANDLE CONDITION
 11753*        NOTFND(1950-NOT-FOUND)
 11754*    END-EXEC.
 11755*    MOVE '"$I                   ! , #00011223' TO DFHEIV0
 11756     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11758     MOVE X'2C20233030303131323233' TO DFHEIV0(25:11)
 11759     CALL 'kxdfhei1' USING DFHEIV0
 11760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11761
 11762
 11763 1300-FIND-CARR-TOLERANCES.
 11764     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11765     MOVE '6'                    TO CNTL-REC-TYPE.
 11766
 11767     IF CONTROL-IS-ACTUAL-CARRIER
 11768         MOVE PI-CARRIER               TO WS-CARR
 11769     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 225
* EL156.cbl
 11770         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11771
 11772     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11773     MOVE +0                     TO CNTL-SEQ-NO.
 11774     MOVE 'CARR'                 TO FILE-SWITCH.
 11775
 11776     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11777
 11778     IF WS-DAYS-TOL = +0
 11779         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11780
 11781     IF WS-PMT-TOL = +0
 11782         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11783
 11784     IF WS-MAX-DAYS-TOL = +0
 11785         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11786
 11787     IF WS-MAX-PMT-TOL = +0
 11788         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11789                                    PI-MAX-PMT-TOL.
 11790
 11791     IF WS-MAX-LF-PMT-TOL = +0
 11792        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11793                                    PI-MAX-LF-PMT-TOL.
 11794
 11795     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11796
 11797********* 1320-FIND-COMP-TOLERANCES.
 11798
 11799     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11800     MOVE '1'                    TO CNTL-REC-TYPE.
 11801     MOVE SPACES                 TO CNTL-ACCESS.
 11802     MOVE +0                     TO CNTL-SEQ-NO.
 11803     MOVE 'COMP'                 TO FILE-SWITCH.
 11804
 11805     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11806
 11807     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11808     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11809
 11810     IF WS-PMT-TOL NOT = +0
 11811        IF WS-TOL-SEVERITY NOT = ' '
 11812         GO TO 1360-EDIT-DAYS.
 11813
 11814     IF WS-PMT-TOL = +0
 11815         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11816
 11817     IF WS-TOL-SEVERITY = ' '
 11818         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11819
 11820 1360-EDIT-DAYS.
 11821     IF PI-PMTTYPE NOT = '4'
 11822        IF PI-EDAYS NEGATIVE OR
 11823           PI-EPYAMT NEGATIVE
 11824          MOVE ER-0513             TO EMI-ERROR
 11825          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11826          MOVE -1                  TO PMTTYPEL.
 11827
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 226
* EL156.cbl
 11828     IF PI-PMTTYPE = '5' OR '6'
 11829        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11830
 11831     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11832        IF PI-PMTTYPE = '4'
 11833          MOVE PI-EDAYS          TO PI-CDAYS.
 11834
 11835     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 11836         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11837
 11838     IF PI-PMTTYPE = '4'
 11839        MOVE PI-EDAYS            TO PI-CDAYS
 11840        GO TO 1400-EDIT-PAYMENT.
 11841
 11842     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11843        GO TO 1500-EDIT-EXPENSES.
 11844
 11845*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11846*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11847*          CM-AH-BENEFIT-CD = '23'              AND
 11848*          CL-CERT-STATE    = '04'              AND
 11849*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11850*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11851*            GO TO 1362-CHECK-MAX-DAYS.
 11852
 11853     IF PI-EDAYS = ZEROS
 11854*        IF PI-COMPANY-ID = 'DMD'
 11855*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11856*            MOVE -1             TO DC-ELAPSED-DAYS
 11857*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11858*            MOVE '6'            TO DC-OPTION-CODE
 11859*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11860*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11861*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11862*            MOVE '1'            TO DC-OPTION-CODE
 11863*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11864*            IF NO-CONVERSION-ERROR
 11865*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11866*                                 + DC-ODD-DAYS-OVER
 11867*               MOVE 6           TO EDAYSL
 11868*               MOVE AL-UNNON    TO EDAYSA
 11869*            ELSE
 11870*                NEXT SENTENCE
 11871*       ELSE
 11872            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11873            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11874            MOVE '1'             TO DC-OPTION-CODE
 11875            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11876            IF NO-CONVERSION-ERROR
 11877                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11878                ADD 1                 TO PI-EDAYS
 11879                MOVE AL-UNNON         TO EDAYSA.
 11880
 11881*    IF PI-COMPANY-ID = 'DMD'
 11882*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11883*        MOVE -1                 TO DC-ELAPSED-DAYS
 11884*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11885*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 227
* EL156.cbl
 11886*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11887*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11888*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11889*        MOVE '1'                TO DC-OPTION-CODE
 11890*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11891*    ELSE
 11892         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11893         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11894         MOVE '1'                TO DC-OPTION-CODE.
 11895         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11896
 11897     IF NO-CONVERSION-ERROR
 11898        IF PI-COMPANY-ID = 'DMD'
 11899            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11900                             + DC-ODD-DAYS-OVER
 11901        ELSE
 11902            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11903            ADD 1                TO PI-CDAYS.
 11904
 11905     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11906        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11907        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11908
 11909     IF PI-EDAYS NOT NUMERIC
 11910         MOVE ER-0491            TO EMI-ERROR
 11911         GO TO 1370-DAYS-ERROR.
 11912
 11913     IF CL-NO-OF-PMTS-MADE = 0
 11914        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11915        AND CL-CERT-STATE = 'MI'
 11916        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11917            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11918     END-IF.
 11919
 11920 1362-CHECK-MAX-DAYS.
 11921
 11922     IF WS-MAX-DAYS-TOL = +999
 11923         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11924
 11925     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11926         IF PI-EDAYS = ZEROS
 11927             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11928         ELSE
 11929             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11930
 11931     IF WS-MAX-DAYS-TOL NOT = ZERO
 11932        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11933           PI-CDAYS > WS-MAX-DAYS-TOL
 11934             MOVE ER-0492          TO EMI-ERROR
 11935             GO TO 1370-DAYS-ERROR.
 11936
 11937 1365-SKIP-MAX-DAYS-EDIT.
 11938     IF PI-EDAYS = ZEROS
 11939        GO TO 1400-EDIT-PAYMENT.
 11940
 11941     IF WS-DAYS-TOL NOT = ZERO
 11942        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11943           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 228
* EL156.cbl
 11944                MOVE ER-0493     TO EMI-ERROR
 11945                GO TO 1370-DAYS-ERROR.
 11946
 11947     GO TO 1400-EDIT-PAYMENT.
 11948
 11949 1370-DAYS-ERROR.
 11950     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11951
 11952     IF EMI-MESSAGE-FORMATTED
 11953         MOVE -1                 TO EDAYSL
 11954         MOVE AL-UABON           TO EDAYSA.
 11955
 11956     GO TO 1400-EDIT-PAYMENT.
 11957
 11958 1380-EDIT-EXPENSE-PMT-AMT.
 11959     IF PI-PMTTYPE = '5' OR '6'
 11960         NEXT SENTENCE
 11961     ELSE
 11962         GO TO 1400-EDIT-PAYMENT.
 11963
 11964     IF WS-MAX-EXP-PMT NOT = ZEROS
 11965        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11966            MOVE ER-3529            TO EMI-ERROR
 11967            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11968
 11969     GO TO 1500-EDIT-EXPENSES.
 11970
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 229
* EL156.cbl
 11972
 11973 1390-CHECK-PAYMENT-DAYS.
 11974
 11975     IF PI-EDAYS = 0
 11976         MOVE PI-CDAYS TO WS-PD-DAYS
 11977     ELSE
 11978         MOVE PI-EDAYS TO WS-PD-DAYS
 11979     END-IF.
 11980
 11981     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11982         IF WS-PD-DAYS = 14
 11983            GO TO 1390-EXIT
 11984         END-IF
 11985     END-IF.
 11986
 11987     IF PI-COMPANY-ID = 'AHL'  AND
 11988        CM-AH-BENEFIT-CD = '1K'
 11989         IF WS-PD-DAYS = 14
 11990            GO TO 1390-EXIT
 11991         END-IF
 11992     END-IF.
 11993
 11994     IF WS-PD-DAYS < 30
 11995         MOVE ER-3549              TO EMI-ERROR
 11996         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11997     END-IF.
 11998
 11999 1390-EXIT.
 12000      EXIT.
 12001
 12002 1400-EDIT-PAYMENT.
 12003*    IF PI-COMPANY-ID = 'DMD'
 12004*       IF CL-CERT-NO (5:2) = '69' OR '70'
 12005*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 12006
 12007     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12008        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12009        MOVE PI-CARRIER          TO ACCT-CARRIER
 12010        MOVE PI-GROUPING         TO ACCT-GROUPING
 12011        MOVE PI-STATE            TO ACCT-STATE
 12012        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12013        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12014        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12015        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12016
 12017
 12018* EXEC CICS READ
 12019*          DATASET ('ERACCT')
 12020*          RIDFLD  (ERACCT-KEY)
 12021*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12022*          GTEQ
 12023*          resp    (WS-RESPONSE)
 12024*       END-EXEC
 12025     MOVE 'ERACCT' TO DFHEIV1
 12026*    MOVE '&"S        G          (  N#00011481' TO DFHEIV0
 12027     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12029     MOVE X'204E233030303131343831' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 230
* EL156.cbl
 12030     CALL 'kxdfhei1' USING DFHEIV0,
 12031           DFHEIV1,
 12032           DFHEIV20,
 12033           DFHEIV99,
 12034           ERACCT-KEY,
 12035           DFHEIV99,
 12036           DFHEIV99,
 12037           DFHEIV99
 12038     SET ADDRESS OF ACCOUNT-MASTER TO
 12039         DFHEIV20
 12040     MOVE EIBRESP  TO WS-RESPONSE
 12041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12042        IF WS-RESP-NORMAL
 12043           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 12044           and pi-cert-eff-dt < am-expiration-dt
 12045           and pi-cert-eff-dt >= am-effective-dt
 12046           move am-dcc-product-code to pi-dcc-product-code
 12047        else
 12048           move spaces           to pi-dcc-product-code
 12049        end-if
 12050        if PI-DCC-PRODUCT-CODE NOT = SPACES
 12051           PERFORM 0900-GET-DDF-LIMITS
 12052                                 THRU 0900-EXIT
 12053           IF PDEF-FOUND
 12054              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12055                 (P1 > +8)
 12056                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 12057              END-PERFORM
 12058              IF P1 < +9
 12059                 if pd-ben-pct (p1) not numeric
 12060                    move zeros   to pd-ben-pct (p1)
 12061                 end-if
 12062                 if pd-ben-pct (p1) = zeros
 12063                    move +1      to ws-work-ben-pct
 12064                 else
 12065                    move pd-ben-pct (p1)
 12066                                 to ws-work-ben-pct
 12067                 end-if
 12068                 compute cm-ah-benefit-amt =
 12069                    cm-ah-benefit-amt * ws-work-ben-pct
 12070                 if cm-ah-benefit-amt > pd-max-amt (p1)
 12071                    move pd-max-amt (p1) to cm-ah-benefit-amt
 12072                 end-if
 12073              else
 12074                 move er-1674    to emi-error
 12075                 PERFORM 9900-ERROR-FORMAT
 12076                                 THRU 9900-EXIT
 12077              END-IF
 12078           else
 12079              move er-1672       to emi-error
 12080              PERFORM 9900-ERROR-FORMAT
 12081                                 THRU 9900-EXIT
 12082           END-IF
 12083        end-if
 12084     END-IF
 12085     IF PI-PMTTYPE NOT = '4'
 12086        GO TO 1405-CALC-PAYMENT.
 12087     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 231
* EL156.cbl
 12088         MOVE PI-EPYAMT           TO PI-CPYAMT
 12089         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 12090         GO TO 1430-CHECK-AH-TOLERANCE.
 12091
 12092*    IF PI-COMPANY-ID = 'FIA'
 12093*       IF CERT-ACCOUNT = '0000011043'
 12094*        COMPUTE PI-DAILY-RATE ROUNDED =
 12095*                      (CM-AH-BENEFIT-AMT * 13) / 365
 12096*        COMPUTE PI-CPYAMT ROUNDED =
 12097*                          PI-DAILY-RATE * PI-EDAYS
 12098*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 12099*        GO TO 1430-CHECK-AH-TOLERANCE.
 12100
 12101     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 12102         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12103         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 12104         GO TO 1420-CHECK-AIG-BENEFIT.
 12105
 12106     IF WS-CALC-METHOD = '2' OR  '5'
 12107         COMPUTE PI-DAILY-RATE ROUNDED =
 12108                        (CM-AH-BENEFIT-AMT * 12) / 365
 12109         COMPUTE PI-CPYAMT ROUNDED =
 12110                           PI-DAILY-RATE * PI-EDAYS
 12111        GO TO 1420-CHECK-AIG-BENEFIT.
 12112
 12113     IF WS-CALC-METHOD = '3'
 12114         COMPUTE PI-DAILY-RATE =
 12115                         (CM-AH-BENEFIT-AMT * 12) / 365
 12116         COMPUTE PI-CPYAMT ROUNDED =
 12117                           PI-DAILY-RATE * PI-EDAYS
 12118        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 232
* EL156.cbl
 12120*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 12121
 12122****************************************************************
 12123****************************************************************
 12124*                  CALCULATED FROM      PAYMENT      PAYMENT
 12125*   DATES           DATE ROUTINE        OPT  1       OPT  6
 12126* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 12127*1-01-83  1-15-83    0    15     15        15           15
 12128*1-01-83  1-30-83    0    30     30        30           30
 12129*1-01-83  1-31-83    1     0     31        30           30
 12130*1-01-83  2-01-83    1     1     32        31           31
 12131*1-01-83  2-15-83    1    15     46        45           45
 12132*1-01-83  2-28-83    2     0     59        60           60
 12133*1-01-83  3-01-83    2     1     60        61           61
 12134*1-01-83  3-31-83    3     0     90        90           90
 12135*1-15-83  1-31-83    0    17     17        17           16
 12136*1-15-83  2-01-83    0    18     18        18           17
 12137*1-15-83  2-28-83    1    14     45        44           46
 12138*1-21-83  3-09-83    1    20     48        50           49
 12139*2-05-83  3-06-83    1     2     30        32           32
 12140*2-05-83  3-23-83    1    19     47        49           49
 12141*2-15-83  2-28-83    0    14     14        14           16
 12142*2-15-83  3-01-83    0    15     15        15           17
 12143*2-21-83  3-19-83    0    27     27        27           29
 12144*2-21-83  3-20-83    1     0     28        30           30
 12145*2-21-83  4-10-83    1    18     49        30           50
 12146*2-21-83  5-19-83    2    27     88        87           89
 12147*2-21-83  5-22-83    3     2     91        92           92
 12148*3-21-83  5-19-83    1    30     60        60           59
 12149****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 233
* EL156.cbl
 12151 1405-CALC-PAYMENT.
 12152     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12153     MOVE ' '                    TO DC-OPTION-CODE.
 12154     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12155     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 12156     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 12157
 12158     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12159     MOVE ' '                    TO DC-OPTION-CODE.
 12160     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12161     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 12162     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 12163
 12164     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12165     MOVE -1                     TO DC-ELAPSED-DAYS.
 12166     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12167     MOVE '6'                    TO DC-OPTION-CODE.
 12168     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12169     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 12170
 12171     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 12172     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 12173     MOVE '1'                    TO DC-OPTION-CODE.
 12174     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12175
 12176     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 12177     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 12178     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 12179
 12180******************************************************************
 12181*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 12182*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 12183*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 12184******************************************************************
 12185
 12186     IF WS-CALC-METHOD = '1'           AND
 12187        DC-ELAPSED-MONTHS > ZERO AND
 12188        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 12189        WDF-DAY > WDT-DAY
 12190          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12191          MOVE ZEROS               TO DC-ELAPSED-DAYS
 12192          MOVE -1                  TO DC-ELAPSED-MONTHS
 12193          MOVE '6'                 TO DC-OPTION-CODE
 12194          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12195          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 12196          COMPUTE WS-SAVE-ODD-DAYS =
 12197          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12198          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12199
 12200     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12201     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12202     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12203
 12204     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12205     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12206
 12207*    IF PI-COMPANY-ID = 'FIA'
 12208*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 234
* EL156.cbl
 12209*        COMPUTE PI-DAILY-RATE ROUNDED =
 12210*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12211*        COMPUTE PI-CPYAMT ROUNDED =
 12212*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12213*        GO TO 1420-CHECK-AIG-BENEFIT.
 12214
 12215*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12216*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12217*          CM-AH-BENEFIT-CD = '23'               AND
 12218*          CL-CERT-STATE    = '04'               AND
 12219*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12220*            COMPUTE WS-DAILY-RATE ROUNDED =
 12221*                               CM-AH-BENEFIT-AMT / 30
 12222*            COMPUTE PI-CPYAMT ROUNDED =
 12223*                               (WS-DAILY-RATE * PI-CDAYS)
 12224*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12225*            GO TO 1420-CHECK-AIG-BENEFIT.
 12226
 12227     IF WS-CALC-METHOD = '1'
 12228         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12229         COMPUTE PI-CPYAMT ROUNDED =
 12230             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12231             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12232         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12233         GO TO 1420-CHECK-AIG-BENEFIT.
 12234
 12235     IF WS-CALC-METHOD = '2'
 12236         COMPUTE PI-DAILY-RATE ROUNDED =
 12237                          (CM-AH-BENEFIT-AMT * 12) / 365
 12238         COMPUTE PI-CPYAMT ROUNDED =
 12239             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12240             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12241         GO TO 1420-CHECK-AIG-BENEFIT.
 12242
 12243     IF WS-CALC-METHOD = '4'
 12244         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12245         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12246         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12247         COMPUTE PI-CPYAMT ROUNDED =
 12248                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12249         GO TO 1420-CHECK-AIG-BENEFIT.
 12250
 12251     IF WS-CALC-METHOD = '5'
 12252         COMPUTE PI-DAILY-RATE ROUNDED =
 12253                            (CM-AH-BENEFIT-AMT * 12) / 365
 12254         COMPUTE PI-CPYAMT ROUNDED =
 12255                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12256         GO TO 1420-CHECK-AIG-BENEFIT.
 12257
 12258     IF WS-CALC-METHOD NOT = '3'
 12259        GO TO 1410-CHECK-PAYMENT.
 12260
 12261******   CALCULATION METHOD  3  ROUTINE
 12262     COMPUTE PI-DAILY-RATE =
 12263                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12264
 12265******CHECK TO SEE IF WITHIN SAME MONTH
 12266     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 235
* EL156.cbl
 12267        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12268                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12269         GO TO 1420-CHECK-AIG-BENEFIT.
 12270
 12271******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12272     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12273             SAVE-ODD-DAYS-OVER = ZEROS
 12274      COMPUTE PI-CPYAMT  ROUNDED =
 12275                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12276      GO TO 1420-CHECK-AIG-BENEFIT.
 12277
 12278******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12279******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12280     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12281        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12282        IF WDF-MONTH > 12
 12283           ADD 1                 TO WDF-YEAR
 12284           SUBTRACT 12         FROM WDF-MONTH.
 12285
 12286******CONVERT THE NEW FROM MONTH TO BINARY
 12287     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12288        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12289        MOVE '4'              TO DC-OPTION-CODE
 12290        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12291        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12292
 12293     IF WDF-MONTH = WDT-MONTH AND
 12294        WDF-YEAR  = WDT-YEAR
 12295          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12296                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12297                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12298        ELSE
 12299          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12300          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12301          COMPUTE PI-CPYAMT ROUNDED =
 12302       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12303       +
 12304       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12305       +
 12306       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12307
 12308     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 236
* EL156.cbl
 12310 1410-CHECK-PAYMENT.
 12311******PAYMENT OPTION 6
 12312******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12313     IF SAVE-ELAPSED-MONTHS > ZERO
 12314        IF SAVE-ODD-DAYS-OVER = ZEROS
 12315           GO TO 1412-CHECK-TO-DAY
 12316        ELSE
 12317           IF WDF-DAY > WDT-DAY
 12318              IF WDF-MONTH = 02
 12319                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12320                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12321                  GO TO 1412-CHECK-TO-DAY
 12322              ELSE
 12323                  IF FROM-DAYS-IN-MONTH = 31
 12324                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12325                     GO TO 1412-CHECK-TO-DAY
 12326                  ELSE
 12327                     GO TO 1412-CHECK-TO-DAY
 12328           ELSE
 12329               GO TO 1412-CHECK-TO-DAY.
 12330
 12331     IF WDF-MONTH NOT = WDT-MONTH
 12332        IF WDF-MONTH = 02
 12333           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12334           IF WDF-DAY = 29
 12335              ADD 1              TO SAVE-ODD-DAYS-OVER
 12336           ELSE
 12337              ADD 2              TO SAVE-ODD-DAYS-OVER
 12338        ELSE
 12339           IF FROM-DAYS-IN-MONTH = 31
 12340              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12341
 12342 1412-CHECK-TO-DAY.
 12343        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12344           IF WDT-DAY = 28
 12345              ADD 2              TO SAVE-ODD-DAYS-OVER
 12346           ELSE
 12347              IF WDT-DAY = 29
 12348                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12349              ELSE
 12350                 NEXT SENTENCE
 12351        ELSE
 12352           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12353              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12354
 12355     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12356     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12357     COMPUTE PI-CPYAMT ROUNDED =
 12358         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12359         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12360
 12361     GO TO 1420-CHECK-AIG-BENEFIT.
 12362
 12363 1415-CHECK-LEAP-YEAR.
 12364     IF FROM-DAYS-IN-MONTH = 29
 12365        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12366
 12367 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 237
* EL156.cbl
 12368     EXIT.
 12369
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 238
* EL156.cbl
 12371 1420-CHECK-AIG-BENEFIT.
 12372
 12373     IF WS-SPECIAL-CALC-CD = 'Q'
 12374         GO TO 1425-CHECK-WHOLE-MONTH.
 12375
 12376*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12377*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12378*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12379*       (PI-PMTTYPE = '1' OR '2')
 12380*        NEXT SENTENCE
 12381*    ELSE
 12382         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12383         GO TO 1430-CHECK-AH-TOLERANCE.
 12384
 12385******************AIG LOGIC STARTS**********************
 12386*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12387*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12388*    MOVE ER-3533      TO EMI-ERROR.
 12389*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12390*    GO TO 1430-CHECK-AH-TOLERANCE.
 12391******************AIG LOGIC ENDS************************
 12392
 12393 1425-CHECK-WHOLE-MONTH.
 12394******************************************************************
 12395****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12396****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12397****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12398****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12399****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12400****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12401****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12402****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12403****          PAID * MONTHLY BENEFIT.                         ****
 12404******************************************************************
 12405
 12406     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12407
 12408     IF CL-NO-OF-PMTS-MADE > +0
 12409         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12410
 12411     IF PI-CDAYS < WS-BEN-DAYS
 12412         GO TO 1430-CHECK-AH-TOLERANCE.
 12413
 12414     IF PI-CDAYS = WS-BEN-DAYS
 12415         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12416         GO TO 1430-CHECK-AH-TOLERANCE.
 12417
 12418*    IF PI-COMPANY-ID = 'ACM'
 12419*       NEXT SENTENCE
 12420*    ELSE
 12421        GO TO 1425-NOT-ACM-W15C.
 12422
 12423*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12424*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12425*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12426*    MOVE '6'                    TO  DC-OPTION-CODE.
 12427*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12428*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 239
* EL156.cbl
 12429*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12430*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12431*       MOVE '1'                 TO  DC-OPTION-CODE
 12432*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12433*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12434*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12435*       IF NO-CONVERSION-ERROR
 12436*          IF (DC-ELAPSED-MONTHS > +0) OR
 12437*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12438*             NEXT SENTENCE
 12439*          ELSE
 12440*             MOVE +0            TO  PI-CPYAMT
 12441*             MOVE ER-0846       TO  EMI-ERROR
 12442*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12443*             GO TO 1430-CHECK-AH-TOLERANCE
 12444*       ELSE
 12445*           MOVE ER-0846         TO  EMI-ERROR
 12446*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12447*           GO TO 1430-CHECK-AH-TOLERANCE.
 12448*
 12449*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12450*       ADD +1 TO DC-ELAPSED-MONTHS.
 12451*
 12452*    COMPUTE PI-CPYAMT ROUNDED =
 12453*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12454*
 12455*    GO TO 1430-CHECK-AH-TOLERANCE.
 12456
 12457 1425-NOT-ACM-W15C.
 12458
 12459     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12460     MOVE '6'                        TO  DC-OPTION-CODE.
 12461     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12462     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12463
 12464     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12465     IF NO-CONVERSION-ERROR
 12466         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12467     ELSE
 12468         MOVE ER-0846                TO  EMI-ERROR
 12469         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12470         GO TO 1430-CHECK-AH-TOLERANCE.
 12471
 12472     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12473     MOVE '1'                        TO  DC-OPTION-CODE.
 12474     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12475     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12476     IF NO-CONVERSION-ERROR
 12477         IF DC-ODD-DAYS-OVER = +0
 12478             NEXT SENTENCE
 12479         ELSE
 12480             MOVE ER-0846            TO  EMI-ERROR
 12481             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12482             GO TO 1430-CHECK-AH-TOLERANCE
 12483     ELSE
 12484         MOVE ER-0846                TO  EMI-ERROR
 12485         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12486         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 240
* EL156.cbl
 12487
 12488     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12489         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12490
 12491     GO TO 1430-CHECK-AH-TOLERANCE.
 12492
 12493 1425-CONT-WHOLE-MONTH-PMTS.
 12494******************************************************************
 12495****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12496****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12497****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12498******************************************************************
 12499
 12500     IF PI-COMPANY-ID = 'ACM'
 12501        NEXT SENTENCE
 12502     ELSE
 12503        IF DC-ODD-DAYS-OVER = +0
 12504            NEXT SENTENCE
 12505        ELSE
 12506            MOVE ER-0845            TO  EMI-ERROR
 12507            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12508            GO TO 1430-CHECK-AH-TOLERANCE.
 12509
 12510     COMPUTE PI-CPYAMT ROUNDED =
 12511                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12512
 12513 1430-CHECK-AH-TOLERANCE.
 12514     IF PI-PMT-APPR-SW = 'G'
 12515         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12516
 12517*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12518*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12519*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12520*
 12521*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12522*      IF WDF-MONTH = 02
 12523*        IF SAVE-ELAPSED-MONTHS = 0
 12524*          NEXT SENTENCE
 12525*        ELSE
 12526*          IF SAVE-ODD-DAYS-OVER > 0
 12527*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12528*            COMPUTE WS-PMT-MOS ROUNDED =
 12529*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12530*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12531*                                     WS-PMT-MOS
 12532*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12533*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12534*          ELSE
 12535*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12536*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12537*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12538*                                     WS-PMT-MOS.
 12539
 12540     IF WS-MAX-PMT-TOL NOT = ZERO
 12541        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12542           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12543            MOVE ER-0494         TO  EMI-ERROR
 12544            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 241
* EL156.cbl
 12545            GO TO 1500-EDIT-EXPENSES.
 12546
 12547 1430-CONT-CHECK-AH-TOLERANCE.
 12548
 12549     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12550        GO TO 1500-EDIT-EXPENSES.
 12551
 12552     IF CM-O-B-COVERAGE
 12553        GO TO 1500-EDIT-EXPENSES.
 12554
 12555     IF PI-COMPANY-ID = 'NCL'
 12556       IF FOUND-TOL-SW = 'Y'
 12557         IF WS-PMT-TOL NOT = ZERO
 12558           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12559              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12560                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12561                  IF WS-NCL-PMT-OPTION = SPACES
 12562                      MOVE ER-0699 TO EMI-ERROR
 12563                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12564                  ELSE
 12565                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12566                      NEXT SENTENCE
 12567                  ELSE
 12568                  IF NOT WS-VALID-NCL-OPTION
 12569                      MOVE ER-0699 TO EMI-ERROR
 12570                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12571
 12572     IF WS-PMT-TOL NOT = ZERO
 12573        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12574           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12575           MOVE ER-0495          TO EMI-ERROR
 12576           PERFORM 1490-PAYMENT-ERROR
 12577                                 THRU 1490-EXIT
 12578        end-if
 12579     end-if
 12580
 12581     GO TO 1500-EDIT-EXPENSES.
 12582
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 242
* EL156.cbl
 12584 1440-COMPUTE-LIFE-REMAINING.
 12585
 12586     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12587        IF PI-PMTTYPE = '4'
 12588          MOVE PI-EPYAMT TO PI-CPYAMT
 12589          GO TO 1460-TEST-TYPE.
 12590
 12591     IF WS-LF-COVERAGE-TYPE = 'L'
 12592        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12593                          - CL-TOTAL-PAID-AMT
 12594        GO TO 1450-CHECK-MAX.
 12595
 12596     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12597        PI-LF-COVERAGE-TYPE = 'P'
 12598          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12599                              CM-LF-ITD-DEATH-AMT
 12600          GO TO 1450-CHECK-MAX.
 12601
 12602     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12603     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12604     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12605     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12606     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12607     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12608     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12609     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12610     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12611
 12612     PERFORM 9800-LINK-REM-TERM.
 12613
 12614     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12615     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12616     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12617     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12618     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12619     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12620     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12621     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12622     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12623     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12624     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12625     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12626     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12627     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12628     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12629     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12630     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12631        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12632        MOVE PI-CARRIER          TO ACCT-CARRIER
 12633        MOVE PI-GROUPING         TO ACCT-GROUPING
 12634        MOVE PI-STATE            TO ACCT-STATE
 12635        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12636        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12637        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12638        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12639
 12640
 12641* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 243
* EL156.cbl
 12642*          DATASET ('ERACCT')
 12643*          RIDFLD  (ERACCT-KEY)
 12644*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12645*          GTEQ
 12646*          resp    (WS-RESPONSE)
 12647*       END-EXEC
 12648     MOVE 'ERACCT' TO DFHEIV1
 12649*    MOVE '&"S        G          (  N#00012086' TO DFHEIV0
 12650     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12651     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12652     MOVE X'204E233030303132303836' TO DFHEIV0(25:11)
 12653     CALL 'kxdfhei1' USING DFHEIV0,
 12654           DFHEIV1,
 12655           DFHEIV20,
 12656           DFHEIV99,
 12657           ERACCT-KEY,
 12658           DFHEIV99,
 12659           DFHEIV99,
 12660           DFHEIV99
 12661     SET ADDRESS OF ACCOUNT-MASTER TO
 12662         DFHEIV20
 12663     MOVE EIBRESP  TO WS-RESPONSE
 12664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12665        IF WS-RESP-NORMAL
 12666           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12667           and (pi-cert-eff-dt < am-expiration-dt)
 12668           and (pi-cert-eff-dt >= am-effective-dt)
 12669           move am-dcc-product-code to pi-dcc-product-code
 12670        else
 12671           move spaces           to pi-dcc-product-code
 12672        end-if
 12673        if pi-dcc-product-code not = spaces
 12674           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12675           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12676           PERFORM 0900-GET-DDF-limits
 12677                                 THRU 0900-EXIT
 12678           IF PDEF-FOUND
 12679              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12680                 (P1 > +8)
 12681                 OR (PD-PROD-CODE (P1) = 'L')
 12682              END-PERFORM
 12683              IF P1 < +9
 12684                 MOVE PD-MAX-AMT (P1)
 12685                                 TO CP-R-MAX-TOT-BEN
 12686              else
 12687                 move er-1674    to emi-error
 12688                 PERFORM 9900-ERROR-FORMAT
 12689                                 THRU 9900-EXIT
 12690              END-IF
 12691           else
 12692              move er-1672       to emi-error
 12693              PERFORM 9900-ERROR-FORMAT
 12694                                 THRU 9900-EXIT
 12695           END-IF
 12696        end-if
 12697     END-IF
 12698
 12699* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 244
* EL156.cbl
 12700*       PROGRAM  (LINK-REMAMT)
 12701*       COMMAREA (CALCULATION-PASS-AREA)
 12702*       LENGTH   (CP-COMM-LENGTH)
 12703*    END-EXEC.
 12704*    MOVE '."C                   (   #00012126' TO DFHEIV0
 12705     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12706     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12707     MOVE X'2020233030303132313236' TO DFHEIV0(25:11)
 12708     CALL 'kxdfhei1' USING DFHEIV0,
 12709           LINK-REMAMT,
 12710           CALCULATION-PASS-AREA,
 12711           CP-COMM-LENGTH,
 12712           DFHEIV99,
 12713           DFHEIV99,
 12714           DFHEIV99,
 12715           DFHEIV99
 12716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12717
 12718
 12719     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12720
 12721     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12722     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12723
 12724     IF PI-COMPANY-ID = 'BOA' AND
 12725        PI-PMTTYPE    = '2'   AND
 12726        PI-OFFLINE    = 'N'
 12727           GO TO 1441-COMPUTE-BOA-INTEREST.
 12728
 12729     IF PI-COMPANY-ID = 'NCL' AND
 12730        PI-PMTTYPE    = '2'   AND
 12731        PI-OFFLINE    = 'N'
 12732          GO TO 1442-COMPUTE-NCL-INTEREST
 12733       ELSE
 12734          GO TO 1445-CONTINUE.
 12735
 12736 1441-COMPUTE-BOA-INTEREST.
 12737     MOVE +0             TO WS-CALC-INT.
 12738
 12739     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12740     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12741     MOVE +0             TO DC-ELAPSED-MONTHS
 12742                            DC-ELAPSED-DAYS.
 12743     MOVE '1'            TO DC-OPTION-CODE.
 12744     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12745     IF NO-CONVERSION-ERROR
 12746         NEXT SENTENCE
 12747     ELSE
 12748         GO TO 1445-CONTINUE.
 12749
 12750     IF (PI-INT-RATE NOT > ZEROS)  AND
 12751        (DC-ELAPSED-DAYS > +30)
 12752         MOVE ER-3531            TO EMI-ERROR
 12753         MOVE -1                 TO PINTL
 12754         MOVE AL-UNBON           TO PINTA
 12755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12756
 12757     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 245
* EL156.cbl
 12758         GO TO 1445-CONTINUE.
 12759
 12760     IF (PI-INT-RATE NOT > ZEROS)  OR
 12761        (DC-ELAPSED-DAYS NOT > +30)
 12762         MOVE PI-EPYAMT TO PI-CPYAMT
 12763         GO TO 1441-FORMAT-NOTE.
 12764
 12765     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12766                                 *  PI-INT-RATE
 12767                                 *  DC-ELAPSED-DAYS
 12768                                 /  365
 12769                                 /  100.
 12770
 12771     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12772
 12773 1441-FORMAT-NOTE.
 12774
 12775     MOVE SPACES        TO WS-BOANOTE1.
 12776     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12777     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12778     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12779     MOVE AL-UANON      TO NOTE1A.
 12780
 12781     IF WS-CALC-INT > ZEROS
 12782         MOVE SPACES        TO WS-BOANOTE2
 12783         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12784         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12785         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12786         MOVE AL-UANON      TO NOTE2A.
 12787
 12788     GO TO 1445-CONTINUE.
 12789
 12790 1442-COMPUTE-NCL-INTEREST.
 12791     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12792     MOVE PI-STATE               TO WS-ST-ACCESS.
 12793     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12794     MOVE '3'                    TO CNTL-REC-TYPE.
 12795     MOVE +0                     TO CNTL-SEQ-NO.
 12796     MOVE 'STAT'                 TO FILE-SWITCH.
 12797
 12798     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12799
 12800     MOVE +0                 TO WS-CALC-INT.
 12801
 12802     IF ST-STAT-FROM-INCURRED
 12803         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12804       ELSE
 12805     IF ST-STAT-FROM-REPORTED
 12806         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12807       ELSE
 12808         GO TO 1445-CONTINUE.
 12809
 12810     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12811     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12812     MOVE +0                 TO DC-ELAPSED-MONTHS
 12813                                DC-ELAPSED-DAYS.
 12814     MOVE '1'                TO DC-OPTION-CODE.
 12815     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 246
* EL156.cbl
 12816     IF NO-CONVERSION-ERROR
 12817         NEXT SENTENCE
 12818     ELSE
 12819         GO TO 1445-CONTINUE.
 12820
 12821     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12822        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12823         GO TO 1445-CONTINUE.
 12824
 12825     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12826                                 *  CF-ST-STAT-INTEREST.
 12827
 12828     MOVE SPACES              TO WS-NCLNOTE1.
 12829     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12830     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12831     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12832                                 PI-PMTNOTE1
 12833                                 NOTE1I.
 12834     MOVE AL-UANON            TO NOTE1A.
 12835
 12836     IF WS-CALC-INT > ZEROS
 12837         MOVE SPACES          TO WS-NCLNOTE2
 12838         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12839         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12840         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12841                                 PI-PMTNOTE2
 12842                                 NOTE2I
 12843         MOVE AL-UANON        TO NOTE2A.
 12844
 12845     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12846
 12847 1445-CONTINUE.
 12848
 12849     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12850        GO TO 1460-TEST-TYPE.
 12851
 12852     IF CM-O-B-COVERAGE
 12853        GO TO 1460-TEST-TYPE.
 12854
 12855     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12856         GO TO 1450-CHECK-MAX.
 12857
 12858     if (pi-company-id = 'DCC' or 'VPP')
 12859        and (pdef-found)
 12860        if pi-epyamt > pd-max-amt (p1)
 12861           move er-1657          to emi-error
 12862           perform 1490-payment-error
 12863                                 thru 1490-exit
 12864           go to 1460-test-type
 12865        end-if
 12866     else
 12867        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12868           > PI-EPYAMT)
 12869                         OR
 12870           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12871           < PI-EPYAMT)
 12872           MOVE ER-0594          TO EMI-ERROR
 12873           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 247
* EL156.cbl
 12874                                 THRU 1490-EXIT
 12875           GO TO 1460-TEST-TYPE
 12876        end-if
 12877     end-if
 12878     .
 12879 1450-CHECK-MAX.
 12880
 12881     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12882        PI-LF-COVERAGE-TYPE = 'P'
 12883         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12884                                   CM-LF-ITD-DEATH-AMT
 12885     ELSE
 12886         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12887                                   CL-TOTAL-PAID-AMT.
 12888
 12889     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12890          MOVE ER-0543           TO EMI-ERROR
 12891          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12892
 12893 1460-TEST-TYPE.
 12894
 12895     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12896        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 12897           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12898                                   CM-LF-ALT-BENEFIT-AMT -
 12899                                   CL-TOTAL-PAID-AMT
 12900           IF PI-EPYAMT > WS-LF-BEN-AMT
 12901               MOVE ER-0543      TO EMI-ERROR
 12902               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12903           END-IF
 12904        END-IF
 12905     END-IF
 12906
 12907     IF PI-PMT-APPR-SW = 'G'
 12908       NEXT SENTENCE
 12909     ELSE
 12910       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12911         IF PI-EPYAMT = ZERO
 12912             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12913                 MOVE ER-0494    TO  EMI-ERROR
 12914                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12915                 GO TO 1500-EDIT-EXPENSES
 12916             ELSE
 12917                 NEXT SENTENCE
 12918         ELSE
 12919             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12920                 MOVE ER-0494    TO  EMI-ERROR
 12921                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12922                 GO TO 1500-EDIT-EXPENSES.
 12923
 12924     IF PI-PMTTYPE NOT = '2' OR
 12925        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12926         GO TO 1500-EDIT-EXPENSES.
 12927
 12928     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12929     MOVE ER-0526                TO EMI-ERROR.
 12930     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12931
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 248
* EL156.cbl
 12932     IF EMI-ERROR-NUMBER (1) = '0526'
 12933        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12934
 12935     IF EMI-ERROR-NUMBER (2) = '0526'
 12936        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12937
 12938     GO TO 1500-EDIT-EXPENSES.
 12939
 12940 1490-PAYMENT-ERROR.
 12941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12942
 12943     IF EMI-MESSAGE-FORMATTED
 12944         MOVE -1                 TO EPYAMTL
 12945         MOVE AL-UNBON           TO EPYAMTA.
 12946
 12947 1490-EXIT.
 12948      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 249
* EL156.cbl
 12950 1500-EDIT-EXPENSES.
 12951     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12952         GO TO 1500-SKIP-ERROR-0556.
 12953
 12954 1500-CONTINUE-ON.
 12955
 12956     IF CM-O-B-COVERAGE
 12957        MOVE ER-0556             TO EMI-ERROR
 12958        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12959
 12960 1500-SKIP-ERROR-0556.
 12961     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12962        IF PI-EEXPENS NOT = ZEROS
 12963           MOVE ER-0524          TO EMI-ERROR
 12964           GO TO 1590-EXPENSE-ERROR
 12965        ELSE
 12966           GO TO 1600-EDIT-RESERVES.
 12967
 12968     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12969     MOVE '6'                    TO CNTL-REC-TYPE.
 12970
 12971     IF CONTROL-IS-ACTUAL-CARRIER
 12972         MOVE PI-CARRIER         TO WS-CARR
 12973     ELSE
 12974         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12975
 12976     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12977     MOVE +0                     TO CNTL-SEQ-NO.
 12978     MOVE 'CARR'                 TO FILE-SWITCH.
 12979
 12980     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12981
 12982     IF EXPENSE-CALC-MANUAL
 12983        GO TO 1600-EDIT-RESERVES.
 12984
 12985     IF DOLLARS-PER-PMT
 12986        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12987        GO TO 1600-EDIT-RESERVES.
 12988
 12989     IF DOLLARS-PER-MONTH AND
 12990        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12991       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12992       GO TO 1600-EDIT-RESERVES.
 12993
 12994     IF PERCENT-OF-PAYMENT
 12995        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12996
 12997     GO TO 1600-EDIT-RESERVES.
 12998
 12999 1590-EXPENSE-ERROR.
 13000     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13001
 13002     IF EMI-MESSAGE-FORMATTED
 13003        MOVE -1                  TO EEXPENSL
 13004        MOVE AL-UNBON            TO EEXPENSA.
 13005
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 250
* EL156.cbl
 13007 1600-EDIT-RESERVES.
 13008     IF PI-PMTTYPE = '4' OR '5' OR '6'
 13009        IF PI-ERESV = ZEROS
 13010           GO TO 1700-EDIT-EXPENSE-TYPE
 13011        ELSE
 13012           MOVE ER-0525          TO EMI-ERROR
 13013           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 13014           GO TO 1700-EDIT-EXPENSE-TYPE.
 13015
 13016     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13017     MOVE ZEROS                  TO TRLR-SEQ-NO.
 13018     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13019
 13020     IF NOT AT-MANUAL-RESERVES-USED
 13021        IF PI-ERESV NOT = ZEROS
 13022           MOVE ER-0518          TO EMI-ERROR
 13023           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 13024
 13025     IF AT-MANUAL-RESERVES-USED
 13026        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 13027        GO TO 1700-EDIT-EXPENSE-TYPE.
 13028
 13029     IF AT-FUTURE-RESERVES-USED
 13030        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 13031
 13032     IF AT-FUTURE-RESERVES-USED
 13033        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 13034
 13035     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 13036        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 13037
 13038     IF AT-IBNR-RESERVES-USED
 13039        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 13040
 13041     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 13042     GO TO 1700-EDIT-EXPENSE-TYPE.
 13043
 13044 1690-RESERVE-ERROR.
 13045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13046
 13047     IF EMI-MESSAGE-FORMATTED
 13048        MOVE AL-UNBON            TO ERESVA
 13049        MOVE -1                  TO ERESVL.
 13050
 13051 1690-EXIT.
 13052      EXIT.
 13053
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 251
* EL156.cbl
 13055 1700-EDIT-EXPENSE-TYPE.
 13056     IF PI-PMTTYPE NOT = '5' AND '6'
 13057        GO TO 2000-EDIT-DONE.
 13058
 13059     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 13060                   '6' OR '7' OR '8' OR '9'
 13061        GO TO 2000-EDIT-DONE.
 13062
 13063 1705-EXPENSE-ERROR.
 13064     MOVE ER-0573                TO EMI-ERROR.
 13065     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13066
 13067     IF EMI-MESSAGE-FORMATTED
 13068        MOVE AL-UABON            TO ETYPEA
 13069        MOVE -1                  TO ETYPEL.
 13070
 13071     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 252
* EL156.cbl
 13073 1950-NOT-FOUND.
 13074     IF FILE-SWITCH = 'MSTR'
 13075        MOVE ER-0204             TO EMI-ERROR.
 13076
 13077     IF FILE-SWITCH = 'CARR'
 13078        MOVE ER-0252             TO EMI-ERROR.
 13079
 13080     IF FILE-SWITCH = 'COMP'
 13081        MOVE ER-0254             TO EMI-ERROR.
 13082
 13083     IF FILE-SWITCH = 'STAT'
 13084        MOVE ER-0149             TO EMI-ERROR.
 13085
 13086     IF FILE-SWITCH = 'PROC'
 13087        MOVE ER-0019             TO EMI-ERROR.
 13088
 13089     IF FILE-SWITCH = 'ACCT'
 13090        MOVE ER-0198             TO EMI-ERROR.
 13091
 13092     IF FILE-SWITCH = 'BENE'
 13093        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 13094           MOVE ER-0282          TO EMI-ERROR
 13095        ELSE
 13096           MOVE ER-0283          TO EMI-ERROR.
 13097
 13098     MOVE -1                     TO PMTTYPEL.
 13099     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13100
 13101     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 13102                                     WS-FORCE-CTR.
 13103
 13104     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 13105                                     WS-FATAL-CTR.
 13106
 13107     GO TO 8200-SEND-DATAONLY.
 13108
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 253
* EL156.cbl
 13110 2000-EDIT-DONE.
 13111     perform 2210-dcc-max-benes thru 2210-exit
 13112     if pi-company-id not = 'DCC' and 'VPP'
 13113        IF (WS-SPECIAL-CALC-CD = 'C')
 13114           and (cl-critical-period > 0)
 13115           IF CM-AH-BENEFIT-AMT NOT = ZERO
 13116              IF PI-EPYAMT > ZEROS
 13117                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13118                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 13119              ELSE
 13120                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13121                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 13122              END-IF
 13123              if ws-benefits-paid > cl-critical-period
 13124                 MOVE ER-0657          TO EMI-ERROR
 13125                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13126              END-IF
 13127           END-IF
 13128        END-IF
 13129     end-if
 13130     IF PI-HOLDTIL NOT = ZEROS
 13131        MOVE PI-HOLDTIL          TO HOLDTILO
 13132        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'
 13133        MOVE ER-3272          TO EMI-ERROR
 13134        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13135     END-IF
 13136
 13137     IF PI-EPYFROM NOT = ZEROS
 13138        MOVE PI-EPYFROM          TO EPYFROMO
 13139        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 13140
 13141     IF PI-EPYTHRU NOT = ZEROS
 13142        MOVE PI-EPYTHRU            TO EPYTHRUO
 13143        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 13144        IF PI-USES-PAID-TO
 13145           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13146           MOVE '4'                TO DC-OPTION-CODE
 13147           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13148           IF NO-CONVERSION-ERROR
 13149              MOVE +1              TO DC-ELAPSED-DAYS
 13150              MOVE +0              TO DC-ELAPSED-MONTHS
 13151              MOVE '6'             TO DC-OPTION-CODE
 13152              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13153              IF NO-CONVERSION-ERROR
 13154                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13155
 13156     MOVE PI-EDAYS               TO EDAYSO.
 13157
 13158     IF PI-AIGFROM NOT = ZEROS
 13159        MOVE PI-AIGFROM          TO AIGFROMO
 13160        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13161
 13162     MOVE PI-EPYAMT              TO EPYAMTO.
 13163     MOVE PI-ERESV               TO ERESVO.
 13164     MOVE PI-EEXPENS             TO EEXPENSO.
 13165
 13166     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13167     MOVE SPACES                 TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 254
* EL156.cbl
 13168     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13169
 13170     IF DATE-CONVERSION-ERROR
 13171        MOVE SPACES              TO CPYFROMI
 13172     ELSE
 13173        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 13174        IF PI-EPYFROM = ZEROS
 13175           MOVE AL-UANON             TO EPYFROMA
 13176           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 13177           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 13178
 13179     IF PI-USES-PAID-TO
 13180        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 13181        MOVE +1                            TO DC-ELAPSED-DAYS
 13182        MOVE +0                            TO DC-ELAPSED-MONTHS
 13183        MOVE '6'                           TO DC-OPTION-CODE
 13184        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13185        IF NO-CONVERSION-ERROR
 13186           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 13187           IF PI-EPYTHRU = ZEROS
 13188              MOVE AL-UANON                TO EPYTHRUA
 13189              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 13190              MOVE ' '                     TO DC-OPTION-CODE
 13191              MOVE +0                      TO DC-ELAPSED-DAYS
 13192                                              DC-ELAPSED-MONTHS
 13193              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13194              IF NO-CONVERSION-ERROR
 13195                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 13196                  GO TO 2001-CONTINUE
 13197              ELSE
 13198                  GO TO 2001-CONTINUE
 13199           ELSE
 13200              GO TO 2001-CONTINUE.
 13201
 13202     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13203     MOVE SPACES                 TO DC-OPTION-CODE.
 13204     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13205
 13206     IF DATE-CONVERSION-ERROR
 13207        MOVE SPACES              TO CPYTHRUI
 13208     ELSE
 13209        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13210        IF PI-EPYTHRU = ZEROS
 13211           MOVE AL-UANON TO EPYTHRUA
 13212           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13213           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13214
 13215 2001-CONTINUE.
 13216
 13217     MOVE PI-CDAYS               TO CDAYSO.
 13218
 13219     IF PI-EDAYS = ZEROS
 13220        MOVE AL-UNNON TO EDAYSA
 13221        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13222
 13223     MOVE PI-CPYAMT              TO CPYAMTO.
 13224
 13225     IF PI-EPYAMT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 255
* EL156.cbl
 13226        MOVE AL-UNNON            TO EPYAMTA
 13227        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13228
 13229     MOVE PI-CRESV               TO CRESVO.
 13230     MOVE PI-CEXPENS             TO CEXPENSO.
 13231
 13232     IF PI-EEXPENS = ZEROS
 13233        MOVE AL-UNNON TO EEXPENSA
 13234        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13235
 13236     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13237        AND (CL-CLAIM-TYPE = 'L')
 13238        AND (PI-OFFLINE NOT EQUAL 'Y')
 13239        IF PI-PMTTYPE = '2' OR '4'
 13240           PERFORM 2200-CALC-INTEREST
 13241                                 THRU 2200-EXIT
 13242        END-IF
 13243     END-IF
 13244     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13245     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13246     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13247
 13248     IF EMI-FATAL-CTR = ZEROS
 13249        MOVE 'B'                 TO PI-PASS-SW.
 13250
 13251     IF NOT EMI-MESSAGE-FORMATTED
 13252         MOVE -1                 TO EPYFROML
 13253     ELSE
 13254         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13255            EMI-ERROR-NUMBER (2) = SPACES
 13256             MOVE -1             TO EPYFROML.
 13257
 13258     GO TO 8200-SEND-DATAONLY.
 13259
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 256
* EL156.cbl
 13261 2200-CALC-INTEREST.
 13262     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13263        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13264        MOVE '4'                 TO DC-OPTION-CODE
 13265        PERFORM 9700-LINK-DATE-CONVERT
 13266        IF DATE-CONVERSION-ERROR
 13267            MOVE LOW-VALUES      TO CP-PRF-DT
 13268        ELSE
 13269           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13270        END-IF
 13271     END-IF
 13272     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13273        if pi-rb-joint-coverage
 13274           move 'Y'              to pi-int-to-rem-borr
 13275        end-if
 13276     end-if
 13277     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13278        IN CLAIM-INT-PASS-AREA
 13279     MOVE CL-CERT-STATE          TO CP-STATE
 13280        IN CLAIM-INT-PASS-AREA
 13281     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13282     MOVE 'LF'                   TO CP-COVERAGE
 13283     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13284     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13285     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13286     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13287     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13288     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13289
 13290* EXEC CICS LINK
 13291*       PROGRAM   ('ELCLMI')
 13292*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13293*       LENGTH    (CP-CLAIM-LENGTH)
 13294*    END-EXEC
 13295     MOVE 'ELCLMI' TO DFHEIV1
 13296*    MOVE '."C                   (   #00012702' TO DFHEIV0
 13297     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13298     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13299     MOVE X'2020233030303132373032' TO DFHEIV0(25:11)
 13300     CALL 'kxdfhei1' USING DFHEIV0,
 13301           DFHEIV1,
 13302           CLAIM-INT-PASS-AREA,
 13303           CP-CLAIM-LENGTH,
 13304           DFHEIV99,
 13305           DFHEIV99,
 13306           DFHEIV99,
 13307           DFHEIV99
 13308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13309     MOVE AL-PANOF               TO PINTHA
 13310                                    PINTA
 13311     if cp-clm-int-amt = zeros
 13312        move ' ' to pi-int-to-rem-borr
 13313     end-if
 13314     IF NO-CI-ERROR
 13315        MOVE CP-CLM-INT-AMT      TO PINTO
 13316                                    PI-INT-AMT
 13317        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13318        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 257
* EL156.cbl
 13319        MOVE AL-PANOF            TO PINTHA
 13320                                    PINTA
 13321        if pi-rb-joint-coverage
 13322           and pi-int-amt > zeros
 13323           move '  INT TO'       to itrb1o
 13324           move ' REM BORR?'     to itrb2o
 13325           move pi-int-to-rem-borr
 13326                                 to itrbyno
 13327           move al-uanon         to itrbyna
 13328           move +1               to itrbynl
 13329        else
 13330           move ' '              to pi-int-to-rem-borr
 13331        end-if
 13332     ELSE
 13333        IF CI-RETURN-CODE = '8'
 13334           MOVE ER-3818          TO EMI-ERROR
 13335           MOVE -1               TO ZINTL
 13336           PERFORM 9900-ERROR-FORMAT
 13337                                 THRU 9900-EXIT
 13338           GO TO 2200-EXIT
 13339        ELSE
 13340           MOVE ZEROS            TO PINTO
 13341                                    PI-INT-AMT
 13342                                    PI-INT-DAYS
 13343                                    PI-INT-RATE-USED
 13344        END-IF
 13345     END-IF
 13346     IF PI-INT-AMT NOT = ZEROS
 13347        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13348           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13349           CONTINUE
 13350        ELSE
 13351           MOVE CL-SOC-SEC-NO (1:3)
 13352                                 TO WS-SSN (1:3)
 13353           MOVE CL-SOC-SEC-NO (5:2)
 13354                                 TO WS-SSN (4:2)
 13355           MOVE CL-SOC-SEC-NO (8:4)
 13356                                 TO WS-SSN (6:4)
 13357           IF (WS-SSN NUMERIC)
 13358              AND (WS-SSN NOT = ZEROS)
 13359              CONTINUE
 13360           ELSE
 13361              MOVE ER-2044       TO EMI-ERROR
 13362              PERFORM 9900-ERROR-FORMAT
 13363                                 THRU 9900-EXIT
 13364           END-IF
 13365        END-IF
 13366        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13367        if pi-int-to-rem-borr = 'Y'
 13368           move +61              to trlr-seq-no
 13369        else
 13370           MOVE +51              TO TRLR-SEQ-NO
 13371        end-if
 13372
 13373* EXEC CICS READ
 13374*          DATASET  ('ELTRLR')
 13375*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13376*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 258
* EL156.cbl
 13377*          RESP     (WS-RESPONSE)
 13378*       END-EXEC
 13379     MOVE 'ELTRLR' TO DFHEIV1
 13380*    MOVE '&"S        E          (  N#00012770' TO DFHEIV0
 13381     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13382     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13383     MOVE X'204E233030303132373730' TO DFHEIV0(25:11)
 13384     CALL 'kxdfhei1' USING DFHEIV0,
 13385           DFHEIV1,
 13386           DFHEIV20,
 13387           DFHEIV99,
 13388           ELTRLR-KEY,
 13389           DFHEIV99,
 13390           DFHEIV99,
 13391           DFHEIV99
 13392     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13393         DFHEIV20
 13394     MOVE EIBRESP  TO WS-RESPONSE
 13395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13396        IF (NOT WS-RESP-NORMAL)
 13397                    OR
 13398           ((WS-RESP-NORMAL)
 13399           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13400           OR (AT-CITY-STATE = SPACES)))
 13401           MOVE ER-0874          TO EMI-ERROR
 13402           if pi-rb-joint-coverage
 13403              move -1            to itrbynl
 13404           end-if
 13405           PERFORM 9900-ERROR-FORMAT
 13406                                 THRU 9900-EXIT
 13407        else
 13408           move at-mail-to-name  to pi-int-payees-name
 13409        END-IF
 13410     END-IF
 13411     .
 13412 2200-EXIT.
 13413     EXIT.
 13414 2210-dcc-max-benes.
 13415
 13416     move pi-ah-term             to ws-max-bens
 13417     if cl-critical-period not = zeros and spaces
 13418        move cl-critical-period  to ws-max-bens
 13419     end-if
 13420     move cm-ah-benefit-amt      to ws-monthly-benefit
 13421     if pdef-found
 13422        and (pd-max-amt (p1) not = zeros)
 13423        if pd-ben-pct (p1) not numeric
 13424           move zeros            to pd-ben-pct (p1)
 13425        end-if
 13426        if pd-ben-pct (p1) = zeros
 13427           move +1               to ws-work-ben-pct
 13428        else
 13429           move pd-ben-pct (p1)  to ws-work-ben-pct
 13430        end-if
 13431*       compute ws-monthly-benefit =
 13432*          ws-monthly-benefit * ws-work-ben-pct
 13433*       if ws-monthly-benefit > pd-max-amt (p1)
 13434*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 259
* EL156.cbl
 13435*       end-if
 13436     end-if
 13437
 13438     move cl-cert-key-data       to elcrtt-key (2:21)
 13439     move cl-company-cd          to ctrlr-comp-cd
 13440     move cl-cert-no             to ctrlr-cert-no
 13441     move 'B'                    to ctrlr-rec-type
 13442
 13443
 13444* EXEC CICS READ
 13445*       DATASET  ('ELCRTT')
 13446*       set      (address of CERTIFICATE-TRAILERS)
 13447*       RIDFLD   (ELCRTT-KEY)
 13448*       RESP     (WS-RESPONSE)
 13449*    END-EXEC
 13450     MOVE 'ELCRTT' TO DFHEIV1
 13451*    MOVE '&"S        E          (  N#00012823' TO DFHEIV0
 13452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13454     MOVE X'204E233030303132383233' TO DFHEIV0(25:11)
 13455     CALL 'kxdfhei1' USING DFHEIV0,
 13456           DFHEIV1,
 13457           DFHEIV20,
 13458           DFHEIV99,
 13459           ELCRTT-KEY,
 13460           DFHEIV99,
 13461           DFHEIV99,
 13462           DFHEIV99
 13463     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13464         DFHEIV20
 13465     MOVE EIBRESP  TO WS-RESPONSE
 13466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13467     IF not WS-RESP-NORMAL
 13468        go to 2210-exit
 13469     end-if
 13470
 13471*    if instypei = 'P'
 13472*       move +1 to s1
 13473*    else
 13474*       MOVE +2 to s1
 13475*    end-if
 13476
 13477*    move +1 to s1
 13478*    evaluate cl-claim-type
 13479*       when 'A'
 13480*          move +1 to s2
 13481*       when 'I'
 13482*          move +2 to s2
 13483*       when 'G'
 13484*          move +3 to s2
 13485*       when 'L'
 13486*          move +4 to s2
 13487*       when 'P'
 13488*          move +5 to s2
 13489*    end-evaluate
 13490
 13491     move zeros                  to ws-prev-days-paid
 13492                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 260
* EL156.cbl
 13493                                    ws-prev-amt-paid
 13494     perform varying s1 from +1 by +1 until
 13495        (s1 > +24)
 13496        or (cs-claim-type (s1) = spaces)
 13497        if pi-company-id not = 'DCC' and 'VPP'
 13498           if cs-claim-type (s1) = cl-claim-type
 13499              compute ws-prev-days-paid =
 13500                 ws-prev-days-paid + cs-days-paid (s1)
 13501              compute ws-prev-amt-paid =
 13502                 ws-prev-amt-paid + cs-total-paid (s1)
 13503           end-if
 13504        else
 13505           if (cs-claim-type (s1) = cl-claim-type)
 13506              and (cs-benefit-period (s1) = cl-benefit-period)
 13507              and (cs-insured-type (s1) = cl-insured-type)
 13508              compute ws-prev-days-paid =
 13509                 ws-prev-days-paid + cs-days-paid (s1)
 13510              compute ws-prev-amt-paid =
 13511                 ws-prev-amt-paid + cs-total-paid (s1)
 13512           end-if
 13513        end-if
 13514     end-perform
 13515     if pi-epyamt > zeros
 13516        compute ws-benefits-paid =
 13517           (ws-prev-amt-paid + pi-epyamt)
 13518           / ws-monthly-benefit
 13519     else
 13520        compute ws-benefits-paid =
 13521           (ws-prev-amt-paid + pi-cpyamt)
 13522           / ws-monthly-benefit
 13523     end-if
 13524*    if pi-company-id = 'DCC'
 13525     if cl-claim-type not = 'L' and 'O' and 'P'
 13526        if ws-benefits-paid > ws-max-bens
 13527           move er-1658          to emi-error
 13528           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13529        end-if
 13530     end-if
 13531*    end-if
 13532*     if s1 < +25
 13533*        if pi-epyamt > zeros
 13534*           compute ws-benefits-paid =
 13535*              (cs-total-paid (s1) + PI-EPYAMT)
 13536*              / ws-monthly-benefit
 13537*        else
 13538*           compute ws-benefits-paid =
 13539*              (cs-total-paid (s1) + PI-CPYAMT)
 13540*              / ws-monthly-benefit
 13541*        end-if
 13542
 13543*       if ws-benefits-paid > pd-crit-period (p1)
 13544*        if ws-benefits-paid > ws-max-bens
 13545*           move er-1658          to emi-error
 13546*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13547*        end-if
 13548*     end-if
 13549     .
 13550 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 261
* EL156.cbl
 13551     exit.
 13552
 13553 2220-update-elcrtt.
 13554
 13555
 13556* EXEC CICS GETMAIN
 13557*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13558*       LENGTH   (ELCRTT-LENGTH)
 13559*       INITIMG  (GETMAIN-SPACE)
 13560*    END-EXEC
 13561*    MOVE ',"IL                  $   #00012917' TO DFHEIV0
 13562     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13563     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13564     MOVE X'2020233030303132393137' TO DFHEIV0(25:11)
 13565     CALL 'kxdfhei1' USING DFHEIV0,
 13566           DFHEIV20,
 13567           ELCRTT-LENGTH,
 13568           GETMAIN-SPACE
 13569     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13570         DFHEIV20
 13571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13572
 13573     move cl-cert-key-data       to elcrtt-key (2:21)
 13574     move cl-company-cd          to ctrlr-comp-cd
 13575     move cl-cert-no             to ctrlr-cert-no
 13576     move 'B'                    to ctrlr-rec-type
 13577
 13578
 13579* EXEC CICS READ
 13580*       UPDATE
 13581*       DATASET  (ELCRTT-DSID)
 13582*       into     (CERTIFICATE-TRAILERS)
 13583*       RIDFLD   (ELCRTT-KEY)
 13584*       RESP     (WS-RESPONSE)
 13585*    END-EXEC
 13586     MOVE LENGTH OF
 13587      CERTIFICATE-TRAILERS
 13588       TO DFHEIV11
 13589*    MOVE '&"IL       EU         (  N#00012928' TO DFHEIV0
 13590     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13591     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13592     MOVE X'204E233030303132393238' TO DFHEIV0(25:11)
 13593     CALL 'kxdfhei1' USING DFHEIV0,
 13594           ELCRTT-DSID,
 13595           CERTIFICATE-TRAILERS,
 13596           DFHEIV11,
 13597           ELCRTT-KEY,
 13598           DFHEIV99,
 13599           DFHEIV99,
 13600           DFHEIV99
 13601     MOVE EIBRESP  TO WS-RESPONSE
 13602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13603
 13604     IF WS-RESP-NORMAL
 13605        perform 2225-upd-crt-trlr thru 2225-exit
 13606
 13607* EXEC CICS REWRITE
 13608*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 262
* EL156.cbl
 13609*          from     (CERTIFICATE-TRAILERS)
 13610*          RESP     (WS-RESPONSE)
 13611*       END-EXEC
 13612     MOVE LENGTH OF
 13613      CERTIFICATE-TRAILERS
 13614       TO DFHEIV11
 13615*    MOVE '&& L                  %  N#00012938' TO DFHEIV0
 13616     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13617     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13618     MOVE X'204E233030303132393338' TO DFHEIV0(25:11)
 13619     CALL 'kxdfhei1' USING DFHEIV0,
 13620           ELCRTT-DSID,
 13621           CERTIFICATE-TRAILERS,
 13622           DFHEIV11,
 13623           DFHEIV99
 13624     MOVE EIBRESP  TO WS-RESPONSE
 13625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13626     else
 13627        if ws-resp-notfnd
 13628           move 'CS'             to certificate-trailers
 13629           move cl-company-cd    to cs-company-cd
 13630           move cl-cert-key-data to cs-control-primary (2:21)
 13631           move cl-cert-no       to cs-cert-no
 13632           move 'B'              to cs-trailer-type
 13633           perform varying s1 from +1 by +1 until s1 > +24
 13634              move zeros         to cs-benefit-period (s1)
 13635                                    cs-days-paid (s1)
 13636                                    cs-total-paid (s1)
 13637                                    cs-remaining-bens (s1)
 13638           end-perform
 13639           perform 2225-upd-crt-trlr
 13640                                 thru 2225-exit
 13641
 13642* EXEC CICS WRITE
 13643*             DATASET  (ELCRTT-DSID)
 13644*             from     (CERTIFICATE-TRAILERS)
 13645*             RIDFLD   (cs-control-primary)
 13646*             RESP     (WS-RESPONSE)
 13647*          END-EXEC
 13648     MOVE LENGTH OF
 13649      CERTIFICATE-TRAILERS
 13650       TO DFHEIV11
 13651*    MOVE '&$ L                  ''  N#00012958' TO DFHEIV0
 13652     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13653     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13654     MOVE X'204E233030303132393538' TO DFHEIV0(25:11)
 13655     CALL 'kxdfhei1' USING DFHEIV0,
 13656           ELCRTT-DSID,
 13657           CERTIFICATE-TRAILERS,
 13658           DFHEIV11,
 13659           cs-control-primary,
 13660           DFHEIV99,
 13661           DFHEIV99
 13662     MOVE EIBRESP  TO WS-RESPONSE
 13663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13664        end-if
 13665     END-IF
 13666
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 263
* EL156.cbl
 13667     .
 13668 2220-exit.
 13669     exit.
 13670
 13671 2225-upd-crt-trlr.
 13672
 13673*    if instypei = 'P'
 13674*       move +1 to s1
 13675*    else
 13676*       MOVE +2 to s1
 13677*    end-if
 13678
 13679*    move +1 to s1
 13680*    evaluate cl-claim-type
 13681*       when 'A'
 13682*          move +1 to s2
 13683*       when 'I'
 13684*          move +2 to s2
 13685*       when 'G'
 13686*          move +3 to s2
 13687*       when 'L'
 13688*          move +4 to s2
 13689*       when 'P'
 13690*          move +5 to s2
 13691*    end-evaluate
 13692     perform varying s1 from +1 by +1 until
 13693        (s1 > +24)
 13694        or (cl-claim-no = cs-claim-no (s1))
 13695     end-perform
 13696     if s1 < +25
 13697        compute cs-total-paid (s1) =
 13698           cs-total-paid (s1) + at-amount-paid
 13699        compute cs-days-paid (s1) =
 13700           cs-days-paid (s1) +  at-days-in-period
 13701*       compute cs-remaining-bens (s1) =
 13702*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13703        perform 2230-accum-bens-paid thru 2230-exit
 13704     end-if
 13705
 13706     .
 13707 2225-exit.
 13708     exit.
 13709 2230-accum-bens-paid.
 13710     if cl-claim-type not = 'L' and 'O' and 'P'
 13711        move pi-ah-term          to ws-max-bens
 13712        if cl-critical-period not = zeros and spaces
 13713           move cl-critical-period
 13714                                 to ws-max-bens
 13715        end-if
 13716     else
 13717        move 01                  to ws-max-bens
 13718     end-if
 13719     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13720     perform varying s2 from +1 by +1 until
 13721        (s2 > +24)
 13722        or (cs-claim-no (s2) = spaces)
 13723        if pi-company-id not = 'DCC' and 'VPP'
 13724           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 264
* EL156.cbl
 13725              compute ws-tot-days-paid =
 13726                 ws-tot-days-paid + cs-days-paid (s2)
 13727              compute ws-tot-amt-paid =
 13728                 ws-tot-amt-paid + cs-total-paid (s2)
 13729           end-if
 13730        else
 13731           if (cs-benefit-period (s2) = cl-benefit-period)
 13732              and (cs-claim-type (s2) = cl-claim-type)
 13733              and (cs-insured-type (s2) = cl-insured-type)
 13734              compute ws-tot-days-paid =
 13735                 ws-tot-days-paid + cs-days-paid (s2)
 13736              compute ws-tot-amt-paid =
 13737                 ws-tot-amt-paid + cs-total-paid (s2)
 13738           end-if
 13739        end-if
 13740     end-perform
 13741     if cl-claim-type = 'L' or 'P' or 'O'
 13742        if ws-tot-amt-paid > zeros
 13743           move zeros            to cs-remaining-bens (s1)
 13744        else
 13745           move 01               to cs-remaining-bens (s1)
 13746        end-if
 13747     else
 13748        compute ws-pd-bens rounded =
 13749           ws-tot-amt-paid / pi-ah-benefit-amt
 13750        compute cs-remaining-bens (s1) =
 13751           ws-max-bens - ws-pd-bens
 13752        if cs-remaining-bens (s1) < zeros
 13753           move zeros            to cs-remaining-bens (s1)
 13754        end-if
 13755     end-if
 13756     .
 13757 2230-exit.
 13758     exit.
 13759 3000-MOVE-INPUT-TO-SAVE-AREA.
 13760     IF PMTTYPEL > 0
 13761         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13762
 13763     if ws-pmttype = '4'
 13764        if pi-rb-joint-coverage
 13765           if payeel = +0
 13766              move +2            to payeel
 13767              move al-uanon      to payeea
 13768              move 'Q1'          to payeeo
 13769           else
 13770              if payeei not = 'Q1' and 'q1'
 13771                 move er-1582    to emi-error
 13772                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13773              end-if
 13774           end-if
 13775        end-if
 13776     end-if
 13777     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13778
 13779     IF WS-PMTTYPE = '9'
 13780         MOVE 'P'                TO PI-PROVISIONAL-IND
 13781         MOVE '1'                TO WS-PMTTYPE.
 13782
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 265
* EL156.cbl
 13783     IF PAYEEL > 0
 13784         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13785         MOVE PAYEEI             TO WS-PAYEE.
 13786
 13787     IF NOTE1L > +0
 13788         MOVE NOTE1I             TO WS-PMTNOTE1
 13789                                    WS-FLI-PMTNOTE
 13790                                    WS-HAN-PMTNOTE.
 13791
 13792     IF NOTE2L > +0
 13793         MOVE NOTE2I             TO WS-PMTNOTE2.
 13794
 13795     IF OFFLINEL > 0
 13796         MOVE OFFLINEI           TO WS-OFFLINE.
 13797
 13798     IF PROOFDTL > 0
 13799         MOVE PROOFDTI            TO DATE-WORK
 13800         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13801         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13802         MOVE '4'                 TO DC-OPTION-CODE
 13803         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13804         IF NO-CONVERSION-ERROR
 13805            MOVE NUM-WORK         TO PROOFDTO
 13806            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13807            MOVE NUM-WORK         TO WS-PROOF-DATE
 13808         ELSE
 13809            MOVE ZEROS            TO WS-PROOF-DATE
 13810         END-IF
 13811     END-IF.
 13812
 13813     IF EOBYNL > +0
 13814         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13815         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13816     END-IF
 13817
 13818     IF CLMFMYNL > +0
 13819         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13820         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13821     END-IF
 13822
 13823     IF SURVYYNL > +0
 13824         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13825         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13826     END-IF
 13827
 13828     IF SPRELYNL > +0
 13829         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13830         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13831     END-IF
 13832     if itrbynl <> +0
 13833        move function upper-case(itrbyni) to itrbyni
 13834        move itrbyni             to ws-int-to-rem-borr
 13835     end-if
 13836*    IF GROUPEDL > +0
 13837*        MOVE GROUPEDI           TO WS-GROUPED.
 13838*
 13839*    IF CASHL > +0
 13840*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 266
* EL156.cbl
 13841     IF LOANNOL > +0
 13842         MOVE LOANNOI            TO WS-LOAN-NO.
 13843
 13844     IF CHECKNOL > 0
 13845         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13846
 13847     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13848         IF WS-AIG-CREDIT-ENTERED
 13849             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13850             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13851             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13852             MOVE AL-UANON         TO CHECKNOA.
 13853
 13854     IF HOLDTILL > 0
 13855         MOVE HOLDTILI           TO DATE-WORK
 13856         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13857         MOVE NUM-WORK           TO WS-HOLDTIL.
 13858
 13859     IF ZINTL > +0
 13860
 13861* EXEC CICS BIF DEEDIT
 13862*           FIELD   (ZINTI)
 13863*           LENGTH  (07)
 13864*       END-EXEC
 13865     MOVE 07
 13866       TO DFHEIV11
 13867*    MOVE '@"L                   #   #00013160' TO DFHEIV0
 13868     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13869     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13870     MOVE X'2020233030303133313630' TO DFHEIV0(25:11)
 13871     CALL 'kxdfhei1' USING DFHEIV0,
 13872           ZINTI,
 13873           DFHEIV11
 13874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13875        IF ZINTI NOT NUMERIC
 13876           MOVE ER-0419          TO EMI-ERROR
 13877           PERFORM 9900-ERROR-FORMAT
 13878           MOVE AL-UABON         TO ZINTA
 13879           MOVE -1               TO ZINTL
 13880        ELSE
 13881           MOVE ZINTI            TO CP-INT-RATE
 13882                                    WS-INT-RATE
 13883           MOVE CP-INT-RATE      TO ZINTO
 13884           MOVE AL-UNNON         TO ZINTA
 13885        END-IF
 13886     ELSE
 13887        MOVE ZEROS               TO CP-INT-RATE
 13888     END-IF
 13889     IF EPYFROML > 0
 13890         MOVE EPYFROMI           TO DATE-WORK
 13891         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13892         MOVE NUM-WORK           TO WS-EPYFROM.
 13893
 13894     IF AIGFROML > 0
 13895         MOVE AIGFROMI           TO DATE-WORK
 13896         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13897         MOVE NUM-WORK           TO WS-AIGFROM
 13898     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 267
* EL156.cbl
 13899         IF (AIGFROMI = LOW-VALUES) AND
 13900            (PI-AIGFROM NOT = ZEROS)
 13901              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13902
 13903     IF EPYTHRUL > +0
 13904        MOVE EPYTHRUI           TO DATE-WORK
 13905        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13906        MOVE NUM-WORK           TO WS-EPYTHRU
 13907        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13908        MOVE '4'                TO DC-OPTION-CODE
 13909        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13910        IF NO-CONVERSION-ERROR
 13911           IF PI-USES-PAID-TO
 13912              MOVE '6'                TO DC-OPTION-CODE
 13913              MOVE -1                 TO DC-ELAPSED-DAYS
 13914              MOVE +0                 TO DC-ELAPSED-MONTHS
 13915              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13916              IF NO-CONVERSION-ERROR
 13917                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13918                 MOVE ' '             TO DC-OPTION-CODE
 13919                 MOVE +0              TO DC-ELAPSED-DAYS
 13920                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13921              IF NO-CONVERSION-ERROR
 13922                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13923
 13924*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13925*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13926     IF EDAYSL > 0
 13927
 13928* EXEC CICS BIF DEEDIT
 13929*            FIELD(EDAYSI)
 13930*            LENGTH(6)
 13931*        END-EXEC
 13932     MOVE 6
 13933       TO DFHEIV11
 13934*    MOVE '@"L                   #   #00013216' TO DFHEIV0
 13935     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13936     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13937     MOVE X'2020233030303133323136' TO DFHEIV0(25:11)
 13938     CALL 'kxdfhei1' USING DFHEIV0,
 13939           EDAYSI,
 13940           DFHEIV11
 13941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13942         MOVE EDAYSI             TO WS-DY-WORK
 13943         IF WS-DY-SIGN = SPACES
 13944            MOVE WS-DY-NUM       TO WS-EDAYS
 13945            ADD 0                TO WS-EDAYS
 13946         ELSE
 13947            MOVE EDAYSI          TO WS-EDAYS
 13948            ADD 0                TO WS-EDAYS.
 13949
 13950*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13951*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13952     IF EPYAMTL > 0
 13953
 13954* EXEC CICS BIF DEEDIT
 13955*            FIELD(EPYAMTI)
 13956*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 268
* EL156.cbl
 13957*        END-EXEC
 13958     MOVE 10
 13959       TO DFHEIV11
 13960*    MOVE '@"L                   #   #00013231' TO DFHEIV0
 13961     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13962     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13963     MOVE X'2020233030303133323331' TO DFHEIV0(25:11)
 13964     CALL 'kxdfhei1' USING DFHEIV0,
 13965           EPYAMTI,
 13966           DFHEIV11
 13967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13968         MOVE EPYAMTI            TO WS-PY-WORK
 13969         IF WS-PY-SIGN = SPACES
 13970            MOVE WS-PY-NUM       TO WS-EPYAMT
 13971            ADD 0                TO WS-EPYAMT
 13972         ELSE
 13973            MOVE EPYAMTI         TO WS-EPYAMT
 13974            ADD 0                TO WS-EPYAMT.
 13975
 13976     IF ERESVL > 0
 13977
 13978* EXEC CICS BIF DEEDIT
 13979*            FIELD(ERESVI)
 13980*            LENGTH(9)
 13981*        END-EXEC
 13982     MOVE 9
 13983       TO DFHEIV11
 13984*    MOVE '@"L                   #   #00013244' TO DFHEIV0
 13985     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13986     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13987     MOVE X'2020233030303133323434' TO DFHEIV0(25:11)
 13988     CALL 'kxdfhei1' USING DFHEIV0,
 13989           ERESVI,
 13990           DFHEIV11
 13991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13992         MOVE ERESVI TO WS-ERESV.
 13993
 13994     IF EEXPENSL > 0
 13995
 13996* EXEC CICS BIF DEEDIT
 13997*            FIELD(EEXPENSI)
 13998*            LENGTH(8)
 13999*        END-EXEC
 14000     MOVE 8
 14001       TO DFHEIV11
 14002*    MOVE '@"L                   #   #00013251' TO DFHEIV0
 14003     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14004     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14005     MOVE X'2020233030303133323531' TO DFHEIV0(25:11)
 14006     CALL 'kxdfhei1' USING DFHEIV0,
 14007           EEXPENSI,
 14008           DFHEIV11
 14009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14010         MOVE EEXPENSI           TO WS-EEXPENS.
 14011
 14012     IF ETYPEL > ZEROS
 14013         MOVE ETYPEI             TO WS-ETYPE.
 14014
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 269
* EL156.cbl
 14015     IF PI-COMPANY-ID = 'BOA'
 14016        IF PINTL > ZEROS
 14017
 14018* EXEC CICS BIF DEEDIT
 14019*            FIELD (PINTI)
 14020*            LENGTH(05)
 14021*          END-EXEC
 14022     MOVE 05
 14023       TO DFHEIV11
 14024*    MOVE '@"L                   #   #00013262' TO DFHEIV0
 14025     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14026     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14027     MOVE X'2020233030303133323632' TO DFHEIV0(25:11)
 14028     CALL 'kxdfhei1' USING DFHEIV0,
 14029           PINTI,
 14030           DFHEIV11
 14031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14032           IF PINTI NUMERIC
 14033               MOVE AL-UNNON     TO PINTA
 14034               MOVE PINTI        TO WS-INT-RATE
 14035               MOVE WS-INT-RATE  TO PINTO.
 14036
 14037 3000-EXIT.
 14038     EXIT.
 14039
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 270
* EL156.cbl
 14041 3050-REBUILD-ENTERED.
 14042
 14043     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 14044
 14045     IF PI-PROV-PMT
 14046         MOVE '9'           TO PMTTYPEO
 14047     ELSE
 14048         MOVE PI-PMTTYPE    TO PMTTYPEO.
 14049
 14050     MOVE PI-PAYEE          TO PAYEEO.
 14051     MOVE PI-PMTNOTE1       TO NOTE1O.
 14052     MOVE PI-PMTNOTE2       TO NOTE2O.
 14053     MOVE PI-OFFLINE        TO OFFLINEO.
 14054     IF PI-PROOF-DATE NOT = ZEROS
 14055         MOVE PI-PROOF-DATE TO PROOFDTO
 14056         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 14057     END-IF.
 14058*    MOVE PI-GROUPED        TO GROUPEDO.
 14059
 14060*    MOVE PI-CASH           TO CASHO.
 14061
 14062     IF PI-INT-RATE > ZEROS
 14063        MOVE PI-INT-RATE         TO PINTO
 14064     end-if
 14065     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14066        IF PI-INT-AMT > ZEROS
 14067           MOVE PI-INT-AMT       TO PINTO
 14068           MOVE AL-PANOF         TO PINTA
 14069                                    PINTHA
 14070           if pi-rb-joint-coverage
 14071              move '  INT TO'    to itrb1o
 14072              move ' REM BORR?'  to itrb2o
 14073              move 'Y'           to itrbyno
 14074              move al-uanon      to itrbyna
 14075              move +1            to itrbynl
 14076           end-if
 14077        END-IF
 14078     END-IF
 14079     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 14080     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 14081     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 14082     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 14083     IF PI-HOLDTIL NOT = ZEROS
 14084        MOVE PI-HOLDTIL          TO HOLDTILO
 14085        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 14086
 14087     IF PI-EPYFROM NOT = ZEROS
 14088        MOVE PI-EPYFROM          TO EPYFROMO
 14089        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 14090
 14091     IF PI-AIGFROM NOT = ZEROS
 14092        MOVE PI-AIGFROM          TO AIGFROMO
 14093        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 14094
 14095     IF PI-EPYTHRU NOT = ZEROS
 14096        MOVE PI-EPYTHRU          TO EPYTHRUO
 14097        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 14098        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 271
* EL156.cbl
 14099           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 14100           MOVE '4'                TO DC-OPTION-CODE
 14101           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14102           IF NO-CONVERSION-ERROR
 14103              MOVE +1 TO DC-ELAPSED-DAYS
 14104              MOVE +0 TO DC-ELAPSED-MONTHS
 14105              MOVE '6' TO DC-OPTION-CODE
 14106              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14107              IF NO-CONVERSION-ERROR
 14108                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 14109
 14110     IF PI-EDAYS NOT = ZEROS
 14111        MOVE PI-EDAYS TO EDAYSO.
 14112
 14113     IF PI-EPYAMT NOT = ZEROS
 14114        MOVE PI-EPYAMT TO EPYAMTO.
 14115
 14116     IF PI-ERESV NOT = ZEROS
 14117        MOVE PI-ERESV TO ERESVO.
 14118
 14119     IF PI-EEXPENS NOT = ZEROS
 14120        MOVE PI-EEXPENS TO EEXPENSO.
 14121
 14122     MOVE PI-ETYPE TO ETYPEO.
 14123
 14124     IF PI-ECHECKNO NOT = SPACES
 14125        MOVE PI-ECHECKNO         TO CHECKNOO
 14126     ELSE
 14127        MOVE PI-CCHECKNO         TO CHECKNOO.
 14128
 14129     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 14130     MOVE SPACES                 TO DC-OPTION-CODE.
 14131     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14132
 14133     IF DATE-CONVERSION-ERROR
 14134        MOVE SPACES              TO CPYFROMI
 14135     ELSE
 14136        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 14137
 14138     IF PI-USES-PAID-TO
 14139        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 14140        MOVE +1                  TO DC-ELAPSED-DAYS
 14141        MOVE +0                  TO DC-ELAPSED-MONTHS
 14142        MOVE '6'                 TO DC-OPTION-CODE
 14143        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14144        IF NO-CONVERSION-ERROR
 14145           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 14146           GO TO 3051-CONTINUE.
 14147
 14148     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 14149     MOVE SPACES                 TO DC-OPTION-CODE.
 14150     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14151
 14152     IF DATE-CONVERSION-ERROR
 14153        MOVE SPACES              TO CPYTHRUI
 14154     ELSE
 14155        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 14156
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 272
* EL156.cbl
 14157 3051-CONTINUE.
 14158
 14159     IF PI-CDAYS NOT = ZEROS
 14160        MOVE PI-CDAYS TO CDAYSO.
 14161
 14162     IF PI-CPYAMT NOT = ZEROS
 14163        MOVE PI-CPYAMT TO CPYAMTO.
 14164
 14165     IF PI-CRESV NOT = ZEROS
 14166        MOVE PI-CRESV TO CRESVO.
 14167
 14168     IF PI-CEXPENS NOT = ZEROS
 14169        MOVE PI-CEXPENS TO CEXPENSO.
 14170
 14171 3059-EXIT.
 14172     EXIT.
 14173
 14174 3100-DEEDIT-DATE.
 14175
 14176* EXEC CICS BIF DEEDIT
 14177*        FIELD(DATE-WORK)
 14178*        LENGTH(8)
 14179*    END-EXEC.
 14180     MOVE 8
 14181       TO DFHEIV11
 14182*    MOVE '@"L                   #   #00013409' TO DFHEIV0
 14183     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14184     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14185     MOVE X'2020233030303133343039' TO DFHEIV0(25:11)
 14186     CALL 'kxdfhei1' USING DFHEIV0,
 14187           DATE-WORK,
 14188           DFHEIV11
 14189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14190
 14191
 14192 3100-EXIT.
 14193     EXIT.
 14194
 14195 3200-CALC-AIG-DAYS.
 14196
 14197     MOVE 'N'                    TO WS-DUE-DAY-SW.
 14198
 14199     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14200     MOVE ' '                    TO DC-OPTION-CODE.
 14201     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14202     IF NO-CONVERSION-ERROR
 14203         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14204     ELSE
 14205         GO TO 3290-ERROR.
 14206
 14207     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14208         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14209                                WS-BIN-FROM-DT
 14210     ELSE
 14211         IF CL-TOTAL-PAID-AMT > ZEROS
 14212             IF WS-SV-EPYFROM = LOW-VALUES
 14213                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14214                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 273
* EL156.cbl
 14215             ELSE
 14216                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14217                                        WS-BIN-FROM-DT
 14218         ELSE
 14219             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14220                                        WS-BIN-FROM-DT.
 14221
 14222 3210-CONTINUE.
 14223
 14224     MOVE ' '                    TO DC-OPTION-CODE.
 14225     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14226     IF DATE-CONVERSION-ERROR
 14227         GO TO 3290-ERROR.
 14228
 14229     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14230
 14231     IF PI-LOAN-DUE-DAY = 31
 14232         MOVE 30              TO WS-PMT-DUE-DA
 14233                                 WS-SAVE-DUE-DA
 14234     ELSE
 14235         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14236                                 WS-SAVE-DUE-DA.
 14237
 14238     IF (PI-LOAN-DUE-DAY > 28) AND
 14239        (WS-PMT-DUE-MO = 2)
 14240         MOVE 'Y'                TO WS-DUE-DAY-SW
 14241         MOVE 28                 TO WS-PMT-DUE-DA.
 14242
 14243     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14244     MOVE '4'                    TO DC-OPTION-CODE.
 14245     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14246     IF NO-CONVERSION-ERROR
 14247         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14248     ELSE
 14249         GO TO 3290-ERROR.
 14250
 14251*--------------------------------------------------------------*
 14252*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14253*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14254*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14255*                                                              *
 14256*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14257*             INCURRED DATE      - 04/15/91                    *
 14258*             PMT DUE DATE       - 04/03/91                    *
 14259*             PMT DUE DATE       - 05/03/91                    *
 14260*--------------------------------------------------------------*
 14261
 14262     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14263        (WS-SV-AIGFROM = LOW-VALUES)
 14264         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14265            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14266             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14267             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14268             IF NO-CONVERSION-ERROR
 14269                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14270                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14271             ELSE
 14272                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 274
* EL156.cbl
 14273
 14274     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14275        (WS-SV-AIGFROM = LOW-VALUES)
 14276         GO TO 3205-CONT-CALC-PMT.
 14277
 14278     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14279     MOVE ' '                    TO DC-OPTION-CODE.
 14280     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14281     IF NO-CONVERSION-ERROR
 14282         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14283     ELSE
 14284         GO TO 3290-ERROR.
 14285
 14286     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14287        (WS-PMT-DUE-DA < WS-FROM-DA)
 14288          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14289          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14290          IF NO-CONVERSION-ERROR
 14291              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14292              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14293          ELSE
 14294              GO TO 3290-ERROR.
 14295
 14296 3205-CONT-CALC-PMT.
 14297
 14298*--------------------------------------------------------------*
 14299*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14300*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14301*--------------------------------------------------------------*
 14302
 14303     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14304        PI-PMTTYPE = '2'
 14305          NEXT SENTENCE
 14306     ELSE
 14307        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14308           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14309             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14310             MOVE ER-3527            TO EMI-ERROR
 14311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14312             MOVE -1                 TO EPYTHRUL
 14313             MOVE AL-UNBON           TO EPYTHRUA
 14314                                        EPYFROMA
 14315             GO TO 3299-EXIT.
 14316
 14317*--------------------------------------------------------------*
 14318*    CALCULATE RETRO ELIMINATION DATE                          *
 14319*--------------------------------------------------------------*
 14320
 14321     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14322         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14323     ELSE
 14324         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14325
 14326     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14327     MOVE +0             TO DC-ELAPSED-MONTHS.
 14328     MOVE '6'            TO DC-OPTION-CODE.
 14329     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14330     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 275
* EL156.cbl
 14331         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14332     ELSE
 14333         GO TO 3290-ERROR.
 14334
 14335 3210-CHECK-PMT-DATE.
 14336
 14337*--------------------------------------------------------------*
 14338*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14339*    THE ENTERED PAY FROM DATE                                 *
 14340*--------------------------------------------------------------*
 14341
 14342     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14343         NEXT SENTENCE
 14344     ELSE
 14345         GO TO 3220-COMPUTE-DAYS.
 14346
 14347     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14348     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14349     IF NO-CONVERSION-ERROR
 14350         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14351         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14352         GO TO 3210-CHECK-PMT-DATE
 14353     ELSE
 14354         GO TO 3290-ERROR.
 14355
 14356 3220-COMPUTE-DAYS.
 14357
 14358     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14359     MOVE ZEROS         TO WS-CDAYS.
 14360     MOVE 'N'           TO WS-ELIMINATION-SW.
 14361
 14362*--------------------------------------------------------------*
 14363*    COMPUTE CALIFORNIA DUE DAYS                               *
 14364*--------------------------------------------------------------*
 14365
 14366     IF CL-TOTAL-PAID-AMT > ZEROS
 14367         MOVE 'Y' TO WS-ELIMINATION-SW
 14368         GO TO 3240-FIRST-PMT-DUE
 14369     ELSE
 14370        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14371            NEXT SENTENCE
 14372        ELSE
 14373            GO TO 3240-FIRST-PMT-DUE.
 14374
 14375 3230-NEXT-PMT-DUE.
 14376
 14377     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14378     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14379     IF NO-CONVERSION-ERROR
 14380         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14381         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14382     ELSE
 14383         GO TO 3290-ERROR.
 14384
 14385 3240-FIRST-PMT-DUE.
 14386
 14387     IF CL-TOTAL-PAID-AMT > ZEROS
 14388         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 276
* EL156.cbl
 14389     ELSE
 14390        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14391            GO TO 3230-NEXT-PMT-DUE.
 14392
 14393     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14394         GO TO 3250-VERIFY-ELIMINATION.
 14395
 14396     ADD +30 TO WS-CDAYS.
 14397     MOVE 'Y' TO WS-ELIMINATION-SW.
 14398     GO TO 3230-NEXT-PMT-DUE.
 14399
 14400 3250-VERIFY-ELIMINATION.
 14401
 14402     IF ELIM-SATISFIED
 14403         GO TO 3260-END-CALC.
 14404
 14405     IF PI-PMTTYPE = '1'
 14406         MOVE ZEROS TO WS-CDAYS
 14407         GO TO 3260-END-CALC.
 14408
 14409     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14410         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14411     ELSE
 14412         IF CL-TOTAL-PAID-AMT > ZEROS
 14413             IF WS-SV-EPYFROM = LOW-VALUES
 14414                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14415             ELSE
 14416                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14417         ELSE
 14418             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14419
 14420     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14421     MOVE '1'                    TO DC-OPTION-CODE.
 14422     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14423     IF NO-CONVERSION-ERROR
 14424         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14425     ELSE
 14426         GO TO 3290-ERROR.
 14427
 14428     IF CL-TOTAL-PAID-AMT > ZEROS
 14429         MOVE WS-DAYS-OFF TO WS-CDAYS
 14430     ELSE
 14431         IF PI-BEN-DAYS > WS-DAYS-OFF
 14432             MOVE ZEROS TO WS-CDAYS
 14433         ELSE
 14434             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14435
 14436 3260-END-CALC.
 14437
 14438     MOVE WS-CDAYS TO PI-CDAYS.
 14439
 14440     IF PI-EDAYS = ZEROS
 14441         MOVE PI-CDAYS TO PI-EDAYS
 14442         MOVE AL-UNNON TO EDAYSA.
 14443
 14444     GO TO 3299-EXIT.
 14445
 14446 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 277
* EL156.cbl
 14447
 14448     MOVE ER-3528            TO EMI-ERROR.
 14449     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14450     MOVE -1                 TO CDAYSL.
 14451     MOVE AL-UNBON           TO CDAYSA.
 14452
 14453 3299-EXIT.
 14454     EXIT.
 14455
 14456 3300-BUMP-DATE.
 14457
 14458     IF WS-RESTORE-DUE-DAY
 14459         MOVE 'N'              TO WS-DUE-DAY-SW
 14460         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14461         ADD 1                 TO WS-PMT-DUE-MO
 14462         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14463         MOVE '4'              TO DC-OPTION-CODE
 14464         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14465         IF NO-CONVERSION-ERROR
 14466             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14467             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14468             GO TO 3399-EXIT
 14469         ELSE
 14470             MOVE '9'          TO DC-ERROR-CODE
 14471             GO TO 3399-EXIT.
 14472
 14473     IF (WS-PMT-DUE-MO = 1) AND
 14474        (WS-SAVE-DUE-DA > 28)
 14475           MOVE 'Y' TO WS-DUE-DAY-SW.
 14476
 14477     MOVE +0                 TO DC-ELAPSED-DAYS.
 14478     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14479     MOVE '6'                TO DC-OPTION-CODE.
 14480     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14481
 14482 3399-EXIT.
 14483     EXIT.
 14484
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 278
* EL156.cbl
 14486 3400-COMPUTE-EXPIRY.
 14487
 14488     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14489     MOVE +0                    TO DC-ELAPSED-DAYS
 14490                                   DC-ODD-DAYS-OVER.
 14491     MOVE '1'                   TO DC-END-OF-MONTH.
 14492     MOVE '6'                   TO DC-OPTION-CODE.
 14493
 14494     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 14495         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14496     ELSE
 14497         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14498
 14499     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14500     IF NO-CONVERSION-ERROR
 14501         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14502     ELSE
 14503         GO TO 3390-CONTINUE.
 14504
 14505     IF CL-CLAIM-TYPE NOT = (PI-LIFE-OVERRIDE-L1 OR 'O')
 14506         GO TO 3390-CONTINUE.
 14507
 14508     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14509     MOVE '4'                    TO CNTL-REC-TYPE.
 14510     MOVE +0                     TO CNTL-SEQ-NO.
 14511     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14512     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14513     MOVE 'BENE'                 TO FILE-SWITCH.
 14514
 14515     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14516
 14517     IF NO-BENEFIT-FOUND
 14518         GO TO 3390-CONTINUE.
 14519
 14520     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 14521        IF (PI-OFFLINE = 'Y') OR
 14522           (PI-PMTTYPE = '7')
 14523           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14524                                     THRU 9870-EXIT
 14525           IF ERROR-ON-OUTPUT
 14526             MOVE -1                 TO ENTERPFL
 14527             MOVE AL-UANON           TO ENTERPFA
 14528             MOVE MAP-NAMEA          TO MAP-NAME
 14529             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14530             GO TO 8200-SEND-DATAONLY.
 14531
 14532     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')  AND
 14533        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14534        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14535          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14536          MOVE +0        TO DC-ELAPSED-DAYS
 14537          MOVE +1        TO DC-ELAPSED-MONTHS
 14538          MOVE 6         TO DC-OPTION-CODE
 14539          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14540          IF NO-CONVERSION-ERROR
 14541              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14542
 14543 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 279
* EL156.cbl
 14544
 14545      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14546         MOVE CM-AH-LOAN-EXPIRE-DT
 14547                                 TO DC-BIN-DATE-1
 14548      ELSE
 14549         MOVE CM-LF-LOAN-EXPIRE-DT
 14550                                 TO DC-BIN-DATE-1
 14551      END-IF
 14552
 14553      MOVE ' '                    TO DC-OPTION-CODE.
 14554      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14555      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14556      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14557
 14558 3499-EXIT.
 14559     EXIT.
 14560
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 280
* EL156.cbl
 14562
 14563 3600-CHECK-VERIFICATION.
 14564
 14565     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14566
 14567     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14568
 14569     IF PI-PAYEE-TYPE = 'I'
 14570        GO TO 3600-READ-TRAILER.
 14571
 14572     IF PI-PAYEE-TYPE = 'B'
 14573        ADD +10                  TO TRLR-SEQ-NO
 14574        GO TO 3600-READ-TRAILER.
 14575
 14576     IF PI-PAYEE-TYPE = 'A'
 14577        ADD +20                  TO TRLR-SEQ-NO
 14578        GO TO 3600-READ-TRAILER.
 14579
 14580     IF PI-PAYEE-TYPE = 'O'
 14581        ADD +50                  TO TRLR-SEQ-NO
 14582        GO TO 3600-READ-TRAILER.
 14583
 14584     IF PI-PAYEE-TYPE = 'Q'
 14585        ADD +60                  TO TRLR-SEQ-NO
 14586        GO TO 3600-READ-TRAILER.
 14587
 14588     IF PI-PAYEE-TYPE = 'P'
 14589        ADD +30                  TO TRLR-SEQ-NO
 14590        GO TO 3600-READ-TRAILER.
 14591
 14592     IF PI-PAYEE-TYPE = 'E'
 14593        ADD +40                  TO TRLR-SEQ-NO.
 14594
 14595 3600-READ-TRAILER.
 14596
 14597
 14598* EXEC CICS HANDLE CONDITION
 14599*         NOTFND(3600-CONTINUE)
 14600*    END-EXEC.
 14601*    MOVE '"$I                   ! - #00013819' TO DFHEIV0
 14602     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14604     MOVE X'2D20233030303133383139' TO DFHEIV0(25:11)
 14605     CALL 'kxdfhei1' USING DFHEIV0
 14606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14607
 14608
 14609     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14610
 14611 3600-CONTINUE.
 14612
 14613     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 14614         GO TO 3600-AH-VERIFY
 14615     END-IF.
 14616
 14617     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14618       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14619         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 281
* EL156.cbl
 14620           MOVE ER-7576            TO EMI-ERROR
 14621           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14622           MOVE -1                 TO PAYEEL
 14623           MOVE AL-UABON           TO PAYEEA
 14624           GO TO 3600-EXIT
 14625         END-IF
 14626       END-IF
 14627     END-IF.
 14628
 14629     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14630     MOVE 1 TO WS-SUB2
 14631     MOVE SPACES TO WS-PAYEE-NAME
 14632     PERFORM VARYING WS-SUB FROM 1 BY 1
 14633             UNTIL WS-SUB > 30
 14634         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14635            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14636                 WS-PAYEE-NAME-X (WS-SUB2)
 14637            ADD +1 TO WS-SUB2
 14638         END-IF
 14639     END-PERFORM.
 14640
 14641     STRING CL-INSURED-1ST-NAME
 14642            CL-INSURED-MID-INIT
 14643            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14644     MOVE 1 TO WS-SUB2
 14645     MOVE SPACES TO WS-INSURED-NAME
 14646     PERFORM VARYING WS-SUB FROM 1 BY 1
 14647             UNTIL WS-SUB > 30
 14648         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14649            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14650                 WS-INSURED-NAME-X (WS-SUB2)
 14651            ADD +1 TO WS-SUB2
 14652         END-IF
 14653     END-PERFORM.
 14654
 14655     IF CL-CLAIM-TYPE = 'O'
 14656        IF WS-PAYEE-NAME (1:6) = 'ESTATE'
 14657           MOVE ER-7585            TO EMI-ERROR
 14658           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14659           MOVE -1                 TO PAYEEL
 14660           MOVE AL-UABON           TO PAYEEA
 14661        ELSE
 14662           GO TO 3600-EXIT
 14663        END-IF
 14664     END-IF.
 14665     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14666        MOVE ER-7579            TO EMI-ERROR
 14667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14668        MOVE -1                 TO PAYEEL
 14669        MOVE AL-UABON           TO PAYEEA
 14670     END-IF.
 14671
 14672     IF PI-PMTTYPE = '4'  AND
 14673        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14674        PI-PAYEE-TYPE <> 'I'
 14675          MOVE ER-7580          TO EMI-ERROR
 14676          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14677          MOVE -1               TO PAYEEL
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 282
* EL156.cbl
 14678          MOVE AL-UABON         TO PAYEEA
 14679     END-IF.
 14680
 14681     GO TO 3600-EXIT.
 14682
 14683 3600-AH-VERIFY.
 14684
 14685     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14686        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14687           MOVE ER-7583            TO EMI-ERROR
 14688           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14689           MOVE -1                 TO PAYEEL
 14690           MOVE AL-UABON           TO PAYEEA
 14691        END-IF
 14692     END-IF.
 14693
 14694
 14695 3600-EXIT.
 14696     EXIT.
 14697
 14698 5000-UPDATE.
 14699
 14700     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14701
 14702     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14703
 14704     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14705        PI-OFFLINE = 'Y'
 14706        NEXT SENTENCE
 14707     ELSE
 14708        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14709
 14710*    IF PI-COMPANY-ID = 'CRI'
 14711*       IF PI-PMTTYPE = '1' OR  '2'
 14712*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14713*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14714*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14715
 14716*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14717*       IF PI-PMTTYPE = '1'
 14718*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14719*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14720
 14721     IF PI-PMTTYPE      = '2' AND
 14722        PI-SPLIT-PMT-SW = 'Y' AND
 14723        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 14724          MOVE ER-3530                TO EMI-ERROR
 14725          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14726
 14727     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14728        AND (CL-CLAIM-TYPE = 'L' OR 'O')
 14729        IF PI-PMTTYPE = '2' OR '4'
 14730           IF PI-INT-AMT NOT = ZEROS
 14731              PERFORM 7110-BUILD-PMT-TRLR
 14732                                 THRU 7130-EXIT
 14733           ELSE
 14734              IF PI-PMTTYPE = '2'
 14735                 PERFORM 7140-BUILD-NOTE-TRLR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 283
* EL156.cbl
 14736                                 THRU 7170-EXIT
 14737              END-IF
 14738           END-IF
 14739        END-IF
 14740     END-IF
 14741*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14742*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14743*            MOVE 'N'                 TO  WS-LETTER-SW.
 14744
 14745*    IF PI-COMPANY-ID = 'DMD'
 14746*        IF CL-NO-OF-PMTS-MADE = +1
 14747*                OR
 14748*           PI-PMTTYPE = '2'
 14749*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14750
 14751     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14752
 14753*    IF PI-COMPANY-ID = 'DMD'
 14754*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14755*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14756
 14757
 14758* EXEC CICS REWRITE
 14759*         DATASET('ELMSTR')
 14760*         FROM(CLAIM-MASTER)
 14761*     END-EXEC.
 14762     MOVE LENGTH OF
 14763      CLAIM-MASTER
 14764       TO DFHEIV11
 14765     MOVE 'ELMSTR' TO DFHEIV1
 14766*    MOVE '&& L                  %   #00013971' TO DFHEIV0
 14767     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14768     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14769     MOVE X'2020233030303133393731' TO DFHEIV0(25:11)
 14770     CALL 'kxdfhei1' USING DFHEIV0,
 14771           DFHEIV1,
 14772           CLAIM-MASTER,
 14773           DFHEIV11,
 14774           DFHEIV99
 14775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14776
 14777
 14778     IF WS-LETTER-SW = 'N'
 14779         GO TO 5000-END-UPDATE.
 14780
 14781 5000-GENERATE-AUTO-LETTER.
 14782
 14783
 14784* EXEC CICS LINK
 14785*        PROGRAM    (LINK-1523)
 14786*        COMMAREA   (W-1523-LINKDATA)
 14787*        LENGTH     (W-1523-COMM-LENGTH)
 14788*    END-EXEC.
 14789*    MOVE '."C                   (   #00013981' TO DFHEIV0
 14790     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14791     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14792     MOVE X'2020233030303133393831' TO DFHEIV0(25:11)
 14793     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 284
* EL156.cbl
 14794           LINK-1523,
 14795           W-1523-LINKDATA,
 14796           W-1523-COMM-LENGTH,
 14797           DFHEIV99,
 14798           DFHEIV99,
 14799           DFHEIV99,
 14800           DFHEIV99
 14801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14802
 14803
 14804     IF W-1523-FATAL-ERROR
 14805         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14806         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14807         MOVE ER-0802                TO  EMI-ERROR
 14808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14809
 14810     IF W-1523-ERROR-CODE = 0191
 14811         MOVE ER-0803                TO  EMI-ERROR
 14812         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14813
 14814     IF PI-COMPANY-ID      = 'HAN' AND
 14815        PI-PMTTYPE         = '1'   AND
 14816        PI-3RD-PARTY-SW    = 'Y'   AND
 14817        W-1523-FORM-NUMBER = 'EOB1'
 14818           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14819           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14820           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14821           GO TO 5000-GENERATE-AUTO-LETTER.
 14822
 14823 5000-END-UPDATE.
 14824
 14825     MOVE ER-0000                TO EMI-ERROR.
 14826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14827     GO TO 7000-SHOW-CLAIM.
 14828
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 285
* EL156.cbl
 14830 5000-MOVE-NAME.
 14831     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14832     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14833     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14834
 14835 5000-EXIT.
 14836     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 286
* EL156.cbl
 14838 5300-CREATE-DMO.
 14839
 14840     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14841     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14842     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14843
 14844
 14845* EXEC CICS HANDLE CONDITION
 14846*         NOTFND   (5300-NOTE-NOT-FOUND)
 14847*    END-EXEC.
 14848*    MOVE '"$I                   ! . #00014027' TO DFHEIV0
 14849     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14851     MOVE X'2E20233030303134303237' TO DFHEIV0(25:11)
 14852     CALL 'kxdfhei1' USING DFHEIV0
 14853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14854
 14855
 14856
 14857* EXEC CICS READ
 14858*         DATASET('ERNOTE')
 14859*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14860*         RIDFLD (W-NOTE-KEY)
 14861*    END-EXEC.
 14862     MOVE 'ERNOTE' TO DFHEIV1
 14863*    MOVE '&"S        E          (   #00014031' TO DFHEIV0
 14864     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14866     MOVE X'2020233030303134303331' TO DFHEIV0(25:11)
 14867     CALL 'kxdfhei1' USING DFHEIV0,
 14868           DFHEIV1,
 14869           DFHEIV20,
 14870           DFHEIV99,
 14871           W-NOTE-KEY,
 14872           DFHEIV99,
 14873           DFHEIV99,
 14874           DFHEIV99
 14875     SET ADDRESS OF CERTIFICATE-NOTE TO
 14876         DFHEIV20
 14877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14878
 14879
 14880     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14881     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14882     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14883
 14884     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14885         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14886     ELSE
 14887         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14888
 14889     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14890     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14891     MOVE 'DLO006'               TO PGM-NAME.
 14892
 14893
 14894* EXEC CICS LINK
 14895*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 287
* EL156.cbl
 14896*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14897*        LENGTH     (DCT-RCRD-LENGTH)
 14898*    END-EXEC.
 14899*    MOVE '."C                   (   #00014050' TO DFHEIV0
 14900     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14901     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14902     MOVE X'2020233030303134303530' TO DFHEIV0(25:11)
 14903     CALL 'kxdfhei1' USING DFHEIV0,
 14904           PGM-NAME,
 14905           DCT-COMMUNICATION-AREA,
 14906           DCT-RCRD-LENGTH,
 14907           DFHEIV99,
 14908           DFHEIV99,
 14909           DFHEIV99,
 14910           DFHEIV99
 14911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14912
 14913
 14914     IF DCT-RETURN-CODE = 'OK'
 14915         GO TO 5300-CONT.
 14916
 14917     IF DCT-RETURN-CODE = '01' OR '02'
 14918         GO TO 5300-EXIT.
 14919
 14920     IF DCT-RETURN-CODE = '03'
 14921         MOVE ER-0951            TO EMI-ERROR
 14922         GO TO 5300-BAD-EXIT.
 14923
 14924     IF DCT-RETURN-CODE = '04'
 14925         MOVE ER-0946            TO EMI-ERROR
 14926         GO TO 5300-BAD-EXIT.
 14927
 14928     IF DCT-RETURN-CODE = '05'
 14929         MOVE ER-0947            TO EMI-ERROR
 14930         GO TO 5300-BAD-EXIT.
 14931
 14932     IF DCT-RETURN-CODE = '06'
 14933         MOVE ER-0921            TO EMI-ERROR
 14934         GO TO 5300-BAD-EXIT.
 14935
 14936     IF DCT-RETURN-CODE = '07'
 14937         MOVE ER-0849            TO EMI-ERROR
 14938         GO TO 5300-BAD-EXIT.
 14939
 14940     IF DCT-RETURN-CODE = '08'
 14941         MOVE ER-0948            TO EMI-ERROR
 14942         GO TO 5300-BAD-EXIT.
 14943
 14944     IF DCT-RETURN-CODE = 'N1'
 14945         MOVE ER-0950            TO EMI-ERROR
 14946         GO TO 5300-BAD-EXIT.
 14947
 14948     IF DCT-RETURN-CODE = 'E1'
 14949         MOVE ER-0974            TO EMI-ERROR
 14950         GO TO 5300-BAD-EXIT.
 14951
 14952     IF DCT-RETURN-CODE = 'E2'
 14953         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 288
* EL156.cbl
 14954         GO TO 5300-BAD-EXIT.
 14955
 14956     IF DCT-RETURN-CODE NOT = 'OK'
 14957         MOVE ER-0949            TO EMI-ERROR
 14958         GO TO 5300-BAD-EXIT.
 14959
 14960 5300-CONT.
 14961
 14962     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14963     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14964     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14965     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14966     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14967     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14968     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14969     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14970
 14971     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14972     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14973     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14974     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14975     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14976
 14977     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14978
 14979     IF PI-PMTTYPE = '2'
 14980         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14981         MOVE '4'                TO DM-CLAIM-STATUS
 14982     ELSE
 14983         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14984         MOVE '2'                TO DM-CLAIM-STATUS.
 14985
 14986     MOVE 'DLO025'               TO PGM-NAME.
 14987
 14988
 14989* EXEC CICS LINK
 14990*        PROGRAM    (PGM-NAME)
 14991*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14992*        LENGTH     (DM-DMO-LENGTH)
 14993*    END-EXEC.
 14994*    MOVE '."C                   (   #00014130' TO DFHEIV0
 14995     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14997     MOVE X'2020233030303134313330' TO DFHEIV0(25:11)
 14998     CALL 'kxdfhei1' USING DFHEIV0,
 14999           PGM-NAME,
 15000           DMO-COMMUNICATION-AREA,
 15001           DM-DMO-LENGTH,
 15002           DFHEIV99,
 15003           DFHEIV99,
 15004           DFHEIV99,
 15005           DFHEIV99
 15006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15007
 15008
 15009     IF DM-RETURN-CODE = 'OK'
 15010         GO TO 5300-EXIT.
 15011
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 289
* EL156.cbl
 15012     IF DM-RETURN-CODE = '01'
 15013         MOVE ER-8051            TO EMI-ERROR
 15014         GO TO 5300-BAD-EXIT.
 15015
 15016     IF DM-RETURN-CODE = '02'
 15017         MOVE ER-8052            TO EMI-ERROR
 15018         GO TO 5300-BAD-EXIT.
 15019
 15020     IF DM-RETURN-CODE = '03'
 15021         MOVE ER-8053            TO EMI-ERROR
 15022         GO TO 5300-BAD-EXIT.
 15023
 15024     IF DM-RETURN-CODE = '04'
 15025         MOVE ER-8054            TO EMI-ERROR
 15026         GO TO 5300-BAD-EXIT.
 15027
 15028     IF DM-RETURN-CODE = '05'
 15029         MOVE ER-8055            TO EMI-ERROR
 15030         GO TO 5300-BAD-EXIT.
 15031
 15032     IF DM-RETURN-CODE = '06'
 15033         MOVE ER-8056            TO EMI-ERROR
 15034         GO TO 5300-BAD-EXIT.
 15035
 15036     IF DM-RETURN-CODE = '07'
 15037         MOVE ER-8057            TO EMI-ERROR
 15038         GO TO 5300-BAD-EXIT.
 15039
 15040     IF DM-RETURN-CODE = '08'
 15041         MOVE ER-8058            TO EMI-ERROR
 15042         GO TO 5300-BAD-EXIT.
 15043
 15044     IF DM-RETURN-CODE = '09'
 15045         MOVE ER-8059            TO EMI-ERROR
 15046         GO TO 5300-BAD-EXIT.
 15047
 15048     IF DM-RETURN-CODE = '10'
 15049         MOVE ER-8060            TO EMI-ERROR
 15050         GO TO 5300-BAD-EXIT.
 15051
 15052     IF DM-RETURN-CODE = '11'
 15053         MOVE ER-8061            TO EMI-ERROR
 15054         GO TO 5300-BAD-EXIT.
 15055
 15056     IF DM-RETURN-CODE = '12'
 15057         MOVE ER-8062            TO EMI-ERROR
 15058         GO TO 5300-BAD-EXIT.
 15059
 15060     IF DM-RETURN-CODE = '13'
 15061         MOVE ER-8063            TO EMI-ERROR
 15062         GO TO 5300-BAD-EXIT.
 15063
 15064     IF DM-RETURN-CODE = '14'
 15065         MOVE ER-8064            TO EMI-ERROR
 15066         GO TO 5300-BAD-EXIT.
 15067
 15068     IF DM-RETURN-CODE = '15'
 15069         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 290
* EL156.cbl
 15070         GO TO 5300-BAD-EXIT.
 15071
 15072     IF DM-RETURN-CODE = '16'
 15073         MOVE ER-8154            TO EMI-ERROR
 15074         GO TO 5300-BAD-EXIT.
 15075
 15076     IF DM-RETURN-CODE = '17'
 15077         MOVE ER-8155            TO EMI-ERROR
 15078         GO TO 5300-BAD-EXIT.
 15079
 15080     IF DM-RETURN-CODE = 'N1'
 15081         MOVE ER-8152            TO EMI-ERROR
 15082         GO TO 5300-BAD-EXIT.
 15083
 15084     IF DM-RETURN-CODE = 'E1'
 15085         MOVE ER-8153            TO EMI-ERROR
 15086         GO TO 5300-BAD-EXIT.
 15087
 15088     MOVE ER-8066            TO EMI-ERROR.
 15089     GO TO 5300-BAD-EXIT.
 15090
 15091 5300-NOTE-NOT-FOUND.
 15092
 15093     MOVE ER-0954                TO EMI-ERROR.
 15094     GO TO 5300-BAD-EXIT.
 15095
 15096 5300-BAD-EXIT.
 15097
 15098* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15099*    MOVE '6"R                   !   #00014224' TO DFHEIV0
 15100     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15102     MOVE X'2020233030303134323234' TO DFHEIV0(25:11)
 15103     CALL 'kxdfhei1' USING DFHEIV0
 15104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15105
 15106     IF MAP-NAME = 'EL156A'
 15107         MOVE -1             TO ENTERPFL
 15108       ELSE
 15109         MOVE LOW-VALUES     TO EL156BI
 15110         MOVE -1             TO ENTPFBL.
 15111
 15112     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15113     GO TO 8200-SEND-DATAONLY.
 15114
 15115 5300-EXIT.
 15116     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 291
* EL156.cbl
 15118 5350-FORMAT-LAST-NAME-1ST.
 15119*****************************************************************
 15120*             M O V E   N A M E   R O U T I N E                 *
 15121*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15122*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15123*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15124*                  FIELD                   VALUE                *
 15125*           W-NAME-LAST    (CL15)      SMITH                    *
 15126*           W-NAME-FIRST   (CL15)      JOHN                     *
 15127*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 15128*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15129*     CONTAIN                                                   *
 15130*                SMITH, JOHN ALLEN                              *
 15131*     OR                                                        *
 15132*                SMITH, JOHN A.                                 *
 15133*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15134*     COPYBOOK, ELCNWA.                                         *
 15135*****************************************************************.
 15136
 15137     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 15138     MOVE ZERO                   TO  WS-NAME-SW.
 15139     SET NWA-INDEX               TO +1.
 15140
 15141     IF W-NAME-LAST   = SPACES AND
 15142        W-NAME-MIDDLE = SPACES
 15143         MOVE +1                 TO WS-NAME-SW.
 15144
 15145     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15146     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15147
 15148     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15149     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15150
 15151     SET NWA-INDEX UP BY +1.
 15152
 15153     IF W-NAME-MIDDLE NOT = SPACES
 15154         IF W-NAME-MIDDLE-2 = SPACES
 15155             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15156             SET NWA-INDEX UP BY +1
 15157             MOVE '.'            TO WS-NW (NWA-INDEX)
 15158             SET NWA-INDEX UP BY +2
 15159         ELSE
 15160             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15161             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15162
 15163 5350-EXIT.
 15164     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 292
* EL156.cbl
 15166 5360-MOVE-NAME.
 15167
 15168     IF WS-NAME-SW > +1
 15169         GO TO 5360-EXIT.
 15170
 15171     IF WS-NAME-WORK2 = SPACES
 15172         GO TO 5360-EXIT.
 15173
 15174     SET NWA-INDEX2            TO +1.
 15175     SET NWA-INDEX3            TO +2.
 15176
 15177 5360-MOVE-NAME-CYCLE.
 15178
 15179     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 15180
 15181     IF NWA-INDEX < +30
 15182         SET NWA-INDEX UP BY +1
 15183     ELSE
 15184         ADD +2                TO  WS-NAME-SW
 15185         GO TO 5360-EXIT.
 15186
 15187     IF NWA-INDEX2 < +20
 15188         SET NWA-INDEX3 UP BY +1
 15189         SET NWA-INDEX2 UP BY +1.
 15190
 15191     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 15192        WS-NW2 (NWA-INDEX3) = SPACES
 15193         IF WS-NAME-SW = ZERO
 15194             MOVE ','            TO  WS-NW (NWA-INDEX)
 15195             SET NWA-INDEX UP BY +2
 15196             MOVE +1             TO  WS-NAME-SW
 15197             GO TO 5360-EXIT
 15198         ELSE
 15199             GO TO 5360-EXIT.
 15200
 15201     GO TO 5360-MOVE-NAME-CYCLE.
 15202
 15203 5360-EXIT.
 15204     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 293
* EL156.cbl
 15206 6000-BUILD-SCREEN-B.
 15207     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15208     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15209     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15210     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15211
 15212     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15213
 15214 6050-BUILD-SCREEN.
 15215     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15216     MOVE LOW-VALUES             TO EL156BI.
 15217     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15218
 15219     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15220
 15221     IF PI-PAYEE-TYPE = 'I'
 15222        GO TO 6060-READ-TRAILER.
 15223
 15224     IF PI-PAYEE-TYPE = 'B'
 15225        ADD +10                  TO TRLR-SEQ-NO
 15226        GO TO 6060-READ-TRAILER.
 15227
 15228     IF PI-PAYEE-TYPE = 'A'
 15229        ADD +20                  TO TRLR-SEQ-NO
 15230        GO TO 6060-READ-TRAILER.
 15231
 15232     IF PI-PAYEE-TYPE = 'O'
 15233        ADD +50                  TO TRLR-SEQ-NO
 15234        GO TO 6060-READ-TRAILER.
 15235
 15236     IF PI-PAYEE-TYPE = 'Q'
 15237        ADD +60                  TO TRLR-SEQ-NO
 15238        GO TO 6060-READ-TRAILER.
 15239
 15240     IF PI-PAYEE-TYPE = 'P'
 15241        ADD +30                  TO TRLR-SEQ-NO
 15242        GO TO 6060-READ-TRAILER.
 15243
 15244     IF PI-PAYEE-TYPE = 'E'
 15245        ADD +40                  TO TRLR-SEQ-NO.
 15246
 15247 6060-READ-TRAILER.
 15248
 15249     IF PI-PAYEE-TYPE    = 'A' AND
 15250        PI-PAYEE-SEQ-NUM = 0
 15251          GO TO 6061-READ-ACCOUNT.
 15252
 15253     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15254        (PI-PAYEE-TYPE    = 'B')             AND
 15255        (PI-PAYEE-SEQ-NUM = 9)
 15256          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15257          IF BENE-FOUND-SW = 'N'
 15258            GO TO 6065-NOT-FOUND
 15259          ELSE
 15260            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15261            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15262            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15263*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 294
* EL156.cbl
 15264            STRING BE-CITY ' ' BE-STATE
 15265               DELIMITED BY '  ' INTO CITYSTBO
 15266            END-STRING
 15267            MOVE BE-ZIP-CODE       TO ZIPBO
 15268            GO TO 6061-READ-ACCOUNT.
 15269
 15270     IF PI-PAYEE-TYPE    = 'B' AND
 15271        PI-PAYEE-SEQ-NUM = 0
 15272          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15273          IF BENE-FOUND-SW = 'N'
 15274            GO TO 6065-NOT-FOUND
 15275          ELSE
 15276            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15277            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15278            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15279*           MOVE BE-CITY-STATE     TO CITYSTBO
 15280            STRING BE-CITY ' ' BE-STATE
 15281               DELIMITED BY '  ' INTO CITYSTBO
 15282            END-STRING
 15283            MOVE BE-ZIP-CODE       TO ZIPBO
 15284            if be-ach-yes-or-no = 'Y'
 15285               move 'Y'          to pi-ach-payment
 15286            else
 15287               move 'N'          to pi-ach-payment
 15288            end-if
 15289            GO TO 6061-READ-ACCOUNT.
 15290
 15291
 15292* EXEC CICS HANDLE CONDITION
 15293*         NOTFND(6065-NOT-FOUND)
 15294*     END-EXEC.
 15295*    MOVE '"$I                   ! / #00014410' TO DFHEIV0
 15296     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15298     MOVE X'2F20233030303134343130' TO DFHEIV0(25:11)
 15299     CALL 'kxdfhei1' USING DFHEIV0
 15300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15301
 15302
 15303     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15304
 15305     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15306     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15307     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15308     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15309*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15310     STRING AT-CITY ' ' AT-STATE
 15311        DELIMITED BY '  ' INTO CITYSTBO
 15312     END-STRING
 15313     MOVE AT-ZIP-CODE            TO ZIPBO.
 15314
 15315 6061-READ-ACCOUNT.
 15316
 15317* EXEC CICS HANDLE CONDITION
 15318*         NOTFND(6068-ACCT-NOT-FND)
 15319*     END-EXEC.
 15320*    MOVE '"$I                   ! 0 #00014427' TO DFHEIV0
 15321     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 295
* EL156.cbl
 15322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15323     MOVE X'3020233030303134343237' TO DFHEIV0(25:11)
 15324     CALL 'kxdfhei1' USING DFHEIV0
 15325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15326
 15327
 15328
 15329* EXEC CICS READ
 15330*         DATASET('ERACCT')
 15331*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15332*         RIDFLD (PI-ACCT-KEY)
 15333*     END-EXEC.
 15334     MOVE 'ERACCT' TO DFHEIV1
 15335*    MOVE '&"S        E          (   #00014431' TO DFHEIV0
 15336     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15338     MOVE X'2020233030303134343331' TO DFHEIV0(25:11)
 15339     CALL 'kxdfhei1' USING DFHEIV0,
 15340           DFHEIV1,
 15341           DFHEIV20,
 15342           DFHEIV99,
 15343           PI-ACCT-KEY,
 15344           DFHEIV99,
 15345           DFHEIV99,
 15346           DFHEIV99
 15347     SET ADDRESS OF ACCOUNT-MASTER TO
 15348         DFHEIV20
 15349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15350
 15351
 15352     MOVE AM-CARRIER             TO ACARRBO.
 15353     MOVE AM-GROUPING            TO GROUPBO.
 15354     MOVE AM-STATE               TO STATEBO.
 15355     MOVE AM-ACCOUNT             TO ACCTBO.
 15356     MOVE AM-NAME                TO ACCTNMBO.
 15357
 15358     IF PI-PAYEE-TYPE = 'A' AND
 15359        PI-PAYEE-SEQ-NUM = 0
 15360          MOVE AM-NAME             TO NAMEBO
 15361                                      PI-PAYEE-NAME
 15362          MOVE AM-ADDRS            TO ADDR1BO
 15363          MOVE SPACES              TO ADDR2BO
 15364*         MOVE AM-CITY             TO CITYSTBO
 15365          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15366             DELIMITED BY '  ' INTO CITYSTBO
 15367          END-STRING
 15368          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15369          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15370          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15371          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15372
 15373***  We don't really need the code below because we don't do the
 15374***  AK thing anymore.  However, we may have a state special
 15375***  of some sort in the future so why not just leave it??
 15376     IF CITYSTBO EQUAL SPACES
 15377         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15378         GO TO 6070-FORMAT-DATA
 15379     END-IF.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 296
* EL156.cbl
 15380
 15381     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15382     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15383     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15384     PERFORM VARYING WS-SUB FROM 30 BY -1
 15385          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15386        IF WS-END-SUB = 0  AND
 15387           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15388              OR LOW-VALUES  OR '.')
 15389            CONTINUE
 15390        ELSE
 15391            IF WS-END-SUB = 0
 15392                MOVE WS-SUB TO WS-END-SUB
 15393            ELSE
 15394                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15395                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15396                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15397                END-IF
 15398            END-IF
 15399        END-IF
 15400        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15401            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15402            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15403        END-IF
 15404     END-PERFORM.
 15405
 15406     IF WS-BEG-SUB > 0
 15407         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15408         IF WS-STATE-LENGTH = 2
 15409             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15410                  TO PI-CHECK-STATE-FOR-AK
 15411         ELSE
 15412             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15413                'ALASKA'
 15414                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15415             ELSE
 15416                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15417             END-IF
 15418         END-IF
 15419     ELSE
 15420         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15421     END-IF.
 15422
 15423     GO TO 6070-FORMAT-DATA.
 15424
 15425 6065-NOT-FOUND.
 15426     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15427     GO TO 6061-READ-ACCOUNT.
 15428
 15429 6068-ACCT-NOT-FND.
 15430     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15431
 15432 6070-FORMAT-DATA.
 15433     IF PI-HOLDTIL = ZEROS
 15434        MOVE SAVE-DATE           TO PAYDTBI
 15435       ELSE
 15436        MOVE PI-HOLDTIL          TO PAYDTBO
 15437        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 297
* EL156.cbl
 15438
 15439     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15440     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15441
 15442     IF EIBAID = DFHPF3 OR DFHPF4
 15443        NEXT SENTENCE
 15444     ELSE
 15445       GO TO 6071-CONTINUE.
 15446
 15447     MOVE PI-EPYFROM          TO PYFROMBO.
 15448     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15449
 15450     IF NOT PI-USES-PAID-TO
 15451        MOVE PI-EPYTHRU          TO PYTHRUBO
 15452        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15453     ELSE
 15454        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15455        MOVE '4'              TO DC-OPTION-CODE
 15456        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15457        IF NO-CONVERSION-ERROR
 15458           MOVE +1            TO DC-ELAPSED-DAYS
 15459           MOVE +0            TO DC-ELAPSED-MONTHS
 15460           MOVE '6'           TO DC-OPTION-CODE
 15461           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15462           IF NO-CONVERSION-ERROR
 15463              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15464
 15465     MOVE PI-EDAYS            TO DAYSBO.
 15466     MOVE PI-EPYAMT           TO PAYAMTBO.
 15467     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15468        IF PI-INT-AMT > ZEROS
 15469           MOVE PI-INT-AMT       TO INTAMTBO
 15470        END-IF
 15471     END-IF
 15472     GO TO 6072-SET-TYPE.
 15473
 15474 6071-CONTINUE.
 15475
 15476     IF PI-CPYFROM NOT = LOW-VALUES
 15477        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15478        MOVE SPACES              TO DC-OPTION-CODE
 15479        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15480        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15481
 15482     IF PI-CPYTHRU NOT = LOW-VALUES
 15483        IF NOT PI-USES-PAID-TO
 15484           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15485           MOVE SPACES             TO DC-OPTION-CODE
 15486           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15487           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15488        ELSE
 15489           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15490           MOVE '6'                TO DC-OPTION-CODE
 15491           MOVE +1                 TO DC-ELAPSED-DAYS
 15492           MOVE +0                 TO DC-ELAPSED-MONTHS
 15493           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15494           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15495
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 298
* EL156.cbl
 15496     MOVE PI-CDAYS               TO DAYSBO.
 15497     MOVE PI-CPYAMT              TO PAYAMTBO.
 15498     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15499        IF PI-INT-AMT > ZEROS
 15500           MOVE PI-INT-AMT       TO INTAMTBO
 15501        END-IF
 15502     END-IF
 15503     .
 15504 6072-SET-TYPE.
 15505     IF PI-PMTTYPE = '1'
 15506        MOVE 'PARTIAL'           TO PAYTYPBO.
 15507
 15508     IF PI-PMTTYPE = '2'
 15509        MOVE 'FINAL'             TO PAYTYPBO.
 15510
 15511     IF PI-PMTTYPE = '3'
 15512        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15513
 15514     IF PI-PMTTYPE = '4'
 15515        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15516
 15517     IF PI-PMTTYPE = '5'
 15518        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15519
 15520     IF PI-PMTTYPE = '6'
 15521        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15522
 15523     IF PI-PROV-PMT
 15524        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15525
 15526     IF PI-ECHECKNO NOT = SPACES
 15527        MOVE PI-ECHECKNO         TO CKNUMBO
 15528     ELSE
 15529        MOVE PI-CCHECKNO         TO CKNUMBO.
 15530
 15531     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 15532        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15533        MOVE +91                 TO  TRLR-SEQ-NO
 15534
 15535* EXEC CICS READ
 15536*           DATASET  ('ELTRLR')
 15537*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15538*           RIDFLD   (ELTRLR-KEY)
 15539*           RESP     (WS-RESPONSE)
 15540*       END-EXEC
 15541     MOVE 'ELTRLR' TO DFHEIV1
 15542*    MOVE '&"S        E          (  N#00014619' TO DFHEIV0
 15543     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15545     MOVE X'204E233030303134363139' TO DFHEIV0(25:11)
 15546     CALL 'kxdfhei1' USING DFHEIV0,
 15547           DFHEIV1,
 15548           DFHEIV20,
 15549           DFHEIV99,
 15550           ELTRLR-KEY,
 15551           DFHEIV99,
 15552           DFHEIV99,
 15553           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 299
* EL156.cbl
 15554     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15555         DFHEIV20
 15556     MOVE EIBRESP  TO WS-RESPONSE
 15557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15558
 15559        IF WS-RESP-NORMAL
 15560           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15561        ELSE
 15562           MOVE SPACES           TO  LOANNBO
 15563        END-IF
 15564     END-IF
 15565
 15566*       MOVE PI-LOAN-NO          TO LOANNBO
 15567
 15568     IF CKNUMBO = SPACES
 15569         MOVE SPACES             TO CKNUMHDO.
 15570
 15571     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15572     MOVE CL-CARRIER             TO CARRBO.
 15573     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15574     MOVE CL-CERT-SFX            TO SUFXBO.
 15575
 15576     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15577        EVALUATE CL-CLAIM-TYPE
 15578           WHEN 'I'
 15579              MOVE '  IU  '      TO CLMTYPBO
 15580           WHEN 'G'
 15581              MOVE ' GAP  '      TO CLMTYPBO
 15582           WHEN 'F'
 15583              MOVE ' FMLA '      TO CLMTYPBO
 15584           WHEN OTHER
 15585              MOVE PI-AH-OVERRIDE-L6
 15586                                 TO CLMTYPBO
 15587        END-EVALUATE
 15588        MOVE ZEROS               TO UNDISBO
 15589*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15590        IF PI-PMTTYPE = '5' OR '6'
 15591           GO TO 6073-GET-NOTIFY-DATA
 15592        ELSE
 15593           MOVE PI-DAILY-RATE    TO RATEBO
 15594           GO TO 6073-GET-NOTIFY-DATA.
 15595
 15596     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15597
 15598     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15599        MOVE ZEROS               TO UNDISBO
 15600     ELSE
 15601        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15602
 15603 6073-GET-NOTIFY-DATA.
 15604
 15605     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15606
 15607     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15608         MOVE SPACES             TO  NAMEB2O
 15609                                     ADDR1B2O
 15610                                     ADDR2B2O
 15611                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 300
* EL156.cbl
 15612                                     AGTHDGO
 15613         MOVE ZEROS              TO  ZIPB2O
 15614         GO TO 6080-SET-INCURRED.
 15615
 15616     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15617     MOVE +29                    TO  TRLR-SEQ-NO.
 15618
 15619
 15620* EXEC CICS HANDLE CONDITION
 15621*        NOTFND   (6074-GET-COMP-DATA)
 15622*    END-EXEC.
 15623*    MOVE '"$I                   ! 1 #00014686' TO DFHEIV0
 15624     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15626     MOVE X'3120233030303134363836' TO DFHEIV0(25:11)
 15627     CALL 'kxdfhei1' USING DFHEIV0
 15628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15629
 15630
 15631     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15632
 15633     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15634     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15635     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15636*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15637     STRING AT-CITY ' ' AT-STATE
 15638        DELIMITED BY '  ' INTO CITYST2O
 15639     END-STRING
 15640     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15641     GO TO 6080-SET-INCURRED.
 15642
 15643 6074-GET-COMP-DATA.
 15644
 15645     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15646         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15647
 15648     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15649         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15650                                         ADDR1B2O
 15651                                         ADDR2B2O
 15652                                         CITYST2O
 15653         MOVE ZEROS                  TO  ZIPB2O
 15654         GO TO 6080-SET-INCURRED.
 15655
 15656     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15657     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15658     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15659     MOVE AM-GROUPING            TO  COMP-GROUP.
 15660     MOVE 'A'                    TO  COMP-TYPE.
 15661     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15662                                 TO  COMP-FIN-RESP.
 15663
 15664     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15665         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15666                                       'G' OR 'B' or 'S'
 15667             MOVE 'G'            TO  COMP-TYPE
 15668             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15669         ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 301
* EL156.cbl
 15670             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15671                                 TO  COMP-ACCOUNT
 15672     ELSE
 15673         MOVE 'G'                TO  COMP-TYPE
 15674         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15675
 15676     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15677
 15678     IF COMP-REC-FOUND
 15679         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15680         MOVE CO-ADDR-1          TO  ADDR1B2O
 15681         MOVE CO-ADDR-2          TO  ADDR2B2O
 15682*        MOVE CO-ADDR-3          TO  CITYST2O
 15683         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15684            DELIMITED BY '  ' INTO CITYST2O
 15685         END-STRING
 15686         MOVE CO-ZIP             TO  ZIPB2O
 15687     ELSE
 15688         MOVE 'NO COMP ADDRESS AVAILABLE'
 15689                                 TO  NAMEB2O
 15690                                     ADDR1B2O
 15691                                     ADDR2B2O
 15692                                     CITYST2O
 15693         MOVE ZEROS               TO ZIPB2O.
 15694
 15695 6080-SET-INCURRED.
 15696     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15697     MOVE SPACES                 TO DC-OPTION-CODE.
 15698     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15699     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15700     MOVE PI-PROCESSOR-ID        TO BYBO.
 15701     MOVE MAP-NAMEB              TO MAP-NAME.
 15702     MOVE 'C'                    TO PI-PASS-SW.
 15703     MOVE EIBAID                 TO PI-PFKEY-USED.
 15704     MOVE -1                     TO ENTPFBL.
 15705     GO TO 8100-SEND-INITIAL-MAP.
 15706
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 302
* EL156.cbl
 15708 6100-BUILD-PAYMENT-TRAILER.
 15709
 15710     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15711     MOVE '6'                    TO CNTL-REC-TYPE.
 15712
 15713     IF CONTROL-IS-ACTUAL-CARRIER
 15714         MOVE PI-CARRIER         TO WS-CARR
 15715     ELSE
 15716         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15717
 15718     IF PI-COMPANY-ID = 'FIA'
 15719         MOVE PI-CARRIER         TO  WS-CARR.
 15720
 15721     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15722     MOVE 0                      TO CNTL-SEQ-NO.
 15723     MOVE 'CARR'                 TO FILE-SWITCH.
 15724
 15725     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15726
 15727     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15728         IF PI-OFFLINE     = 'Y' AND
 15729            PI-ECHECKNO-CR = 'CR'
 15730              GO TO 6110-READ-CONTROL
 15731         ELSE
 15732            IF PI-CASH = 'N'
 15733                GO TO 6110-READ-CONTROL.
 15734
 15735     IF CHECK-NO-MANUAL    OR
 15736        CHECK-NO-AT-PRINT  OR
 15737        PI-OFFLINE = 'Y'
 15738          GO TO 6130-BUILD-TRAILER.
 15739     IF PI-COMPANY-ID = 'FIA'
 15740         NEXT SENTENCE
 15741     ELSE
 15742         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15743             GO TO 6110-READ-CONTROL.
 15744
 15745     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15746
 15747     IF CHECK-CNT-RESET-VALUE
 15748        MOVE +1                  TO CF-CHECK-COUNTER
 15749     ELSE
 15750        ADD +1                   TO CF-CHECK-COUNTER.
 15751
 15752     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15753
 15754     IF CHECK-NO-CARR-SEQ
 15755        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15756
 15757     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15758
 15759     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15760     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15761        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15762         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15763         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15764            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15765         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 303
* EL156.cbl
 15766                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15767     END-IF.
 15768
 15769     GO TO 6120-REWRITE.
 15770
 15771 6105-STATE-CHECK-NUMBER.
 15772     IF CHECK-NO-MANUAL    OR
 15773        CHECK-NO-AT-PRINT  OR
 15774        PI-OFFLINE = 'Y'
 15775           GO TO 6130-BUILD-TRAILER
 15776     END-IF.
 15777
 15778     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15779     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15780     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15781     MOVE '3'                TO CNTL-REC-TYPE.
 15782     MOVE +0                 TO CNTL-SEQ-NO.
 15783     MOVE 'STAT'             TO FILE-SWITCH.
 15784     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15785
 15786     IF CF-ST-CHECK-CNT-RESET
 15787         MOVE +1             TO CF-ST-CHECK-COUNTER
 15788     ELSE
 15789         ADD +1              TO CF-ST-CHECK-COUNTER
 15790     END-IF.
 15791
 15792     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15793     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15794     GO TO 6120-REWRITE.
 15795
 15796 6110-READ-CONTROL.
 15797     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15798     MOVE '1'                    TO CNTL-REC-TYPE.
 15799     MOVE SPACES                 TO CNTL-ACCESS.
 15800     MOVE 0                      TO CNTL-SEQ-NO.
 15801
 15802     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15803
 15804     IF CO-CHECK-COUNT-RESET
 15805        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15806     ELSE
 15807        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15808
 15809     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15810
 15811     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15812         IF PI-OFFLINE     = 'Y'  AND
 15813            PI-ECHECKNO-CR = 'CR'
 15814              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15815              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15816              MOVE AL-UANON           TO CHECKNOA
 15817              GO TO 6120-REWRITE
 15818         ELSE
 15819         IF PI-CASH = 'N'
 15820             MOVE 'N'                TO PI-ECHECKNO-N
 15821             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15822             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15823             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 304
* EL156.cbl
 15824             GO TO 6120-REWRITE.
 15825
 15826     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15827
 15828 6120-REWRITE.
 15829
 15830* EXEC CICS REWRITE
 15831*         DATASET('ELCNTL')
 15832*         FROM(CONTROL-FILE)
 15833*     END-EXEC.
 15834     MOVE LENGTH OF
 15835      CONTROL-FILE
 15836       TO DFHEIV11
 15837     MOVE 'ELCNTL' TO DFHEIV1
 15838*    MOVE '&& L                  %   #00014888' TO DFHEIV0
 15839     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15840     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15841     MOVE X'2020233030303134383838' TO DFHEIV0(25:11)
 15842     CALL 'kxdfhei1' USING DFHEIV0,
 15843           DFHEIV1,
 15844           CONTROL-FILE,
 15845           DFHEIV11,
 15846           DFHEIV99
 15847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15848
 15849
 15850     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15851
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 305
* EL156.cbl
 15853 6130-BUILD-TRAILER.
 15854
 15855
 15856* EXEC CICS GETMAIN
 15857*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15858*         LENGTH    (200)
 15859*         INITIMG   (GETMAIN-SPACE)
 15860*     END-EXEC.
 15861     MOVE 200
 15862       TO DFHEIV11
 15863*    MOVE ',"IL                  $   #00014898' TO DFHEIV0
 15864     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15865     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15866     MOVE X'2020233030303134383938' TO DFHEIV0(25:11)
 15867     CALL 'kxdfhei1' USING DFHEIV0,
 15868           DFHEIV20,
 15869           DFHEIV11,
 15870           GETMAIN-SPACE
 15871     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15872         DFHEIV20
 15873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15874
 15875
 15876     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15877                                    AT-PREV-PAID-THRU-DT.
 15878     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15879     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15880     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15881     MOVE 'AT'                   TO AT-RECORD-ID.
 15882     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15883
 15884     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15885        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15886           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15887     ELSE
 15888           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15889           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15890
 15891     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15892         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15893             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15894             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15895           ELSE
 15896             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15897             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15898
 15899     MOVE '2'                    TO AT-TRAILER-TYPE.
 15900     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15901                                    AT-PAYMENT-LAST-MAINT-DT.
 15902     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15903                                    AT-PAYMENT-LAST-UPDATED-BY.
 15904     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15905     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15906     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15907     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15908
 15909     IF PI-PMT-APPROVED
 15910        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 306
* EL156.cbl
 15911           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15912
 15913     IF PI-PFKEY-USED = DFHPF5
 15914        GO TO 6140-PF5-ENTERED.
 15915
 15916     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15917     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15918
 15919     IF PI-AIG-SPECIAL-BENEFIT
 15920         IF WS-1ST-SPECIAL-PMT
 15921             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15922             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15923                                        AT-AMOUNT-PAID
 15924         ELSE
 15925             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15926
 15927     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15928
 15929     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15930     MOVE '4'                    TO DC-OPTION-CODE.
 15931     PERFORM 9700-LINK-DATE-CONVERT.
 15932
 15933     IF DATE-CONVERSION-ERROR
 15934        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15935     ELSE
 15936        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15937
 15938     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15939     MOVE '4'                    TO DC-OPTION-CODE.
 15940     PERFORM 9700-LINK-DATE-CONVERT.
 15941
 15942     IF DATE-CONVERSION-ERROR
 15943        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15944     ELSE
 15945        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15946
 15947     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15948     move pi-ach-payment         to at-ach-payment
 15949     GO TO 6150-FINISH-MOVE.
 15950
 15951 6140-PF5-ENTERED.
 15952     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15953     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15954
 15955     IF PI-AIG-SPECIAL-BENEFIT
 15956         IF WS-1ST-SPECIAL-PMT
 15957             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15958             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15959                                        AT-AMOUNT-PAID
 15960         ELSE
 15961             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15962
 15963     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15964     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15965     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15966
 15967 6150-FINISH-MOVE.
 15968
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 307
* EL156.cbl
 15969     IF PI-ECHECKNO = SPACES
 15970         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15971     ELSE
 15972         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15973
 15974     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15975     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15976
 15977*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15978*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15979
 15980     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15981         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15982
 15983     IF PI-OFFLINE = 'N'
 15984        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15985        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15986     ELSE
 15987        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15988        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15989
 15990     move pi-ach-payment         to at-ach-payment
 15991     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15992
 15993     IF WS-2ND-SPECIAL-PMT
 15994         MOVE 'Y'                TO AT-CASH-PAYMENT
 15995         MOVE SPACES             TO AT-CHECK-NO
 15996         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15997         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15998         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15999         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 16000
 16001     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 16002                                    AT-TO-BE-WRITTEN-DT.
 16003
 16004     IF PI-HOLDTIL NOT = ZEROS
 16005        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 16006        MOVE '4'                 TO DC-OPTION-CODE
 16007        PERFORM 9700-LINK-DATE-CONVERT
 16008        IF PI-OFFLINE = 'N'
 16009           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 16010           MOVE 'P'              TO WS-HOLD-UNTIL-SW
 16011        ELSE
 16012           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 16013
 16014     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 16015     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 16016                                    AT-CHECK-QUE-SEQUENCE.
 16017
 16018     IF PI-PFKEY-USED = DFHPF4
 16019        MOVE '1'                 TO AT-FORCE-CONTROL.
 16020
 16021     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 16022        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 16023        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 16024        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 16025
 16026     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 308
* EL156.cbl
 16027                                    AT-VOID-SELECT-DT
 16028                                    AT-VOID-ACCEPT-DT
 16029                                    AT-VOID-DT.
 16030     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 16031        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 16032        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 16033        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 16034        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 16035     ELSE
 16036        MOVE ZEROS               TO AT-DAILY-RATE
 16037                                    AT-ELIMINATION-DAYS
 16038        MOVE SPACES              TO AT-BENEFIT-TYPE
 16039     END-IF
 16040     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 16041     MOVE '4'                    TO DC-OPTION-CODE.
 16042     PERFORM 9700-LINK-DATE-CONVERT.
 16043     IF DATE-CONVERSION-ERROR
 16044         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 16045     ELSE
 16046         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 16047     END-IF.
 16048     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 16049     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 16050     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 16051     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 16052     IF (PI-REAUDIT-NEEDED = 'Y')
 16053        or (pi-max-ext-used = 'Y')
 16054        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 16055        OR PI-DUPE-APPROVAL-NEEDED = 'Y'
 16056         PERFORM 6155-READ-CONTROL
 16057         PERFORM 6157-SET-APP-LEVEL
 16058         IF AT-APPROVAL-LEVEL-REQD < '4'
 16059            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 16060         END-IF
 16061         MOVE 'Y' TO WS-NEED-APPROVAL
 16062         GO TO 6170-WRITE
 16063     END-IF.
 16064*******************************************************
 16065     IF NOT PI-PMT-GRADUATED
 16066         GO TO 6170-WRITE.
 16067     PERFORM 6155-READ-CONTROL.
 16068
 16069     IF PAID-FOR-LIFE
 16070         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 16071             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16072                                     WS-PMT-APPROVAL-SW
 16073             GO TO 6170-WRITE.
 16074
 16075*05999      IF PAID-FOR-AH
 16076     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 16077         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 16078             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16079                                     WS-PMT-APPROVAL-SW
 16080             GO TO 6170-WRITE.
 16081
 16082     MOVE '1'                    TO AT-APPROVED-LEVEL.
 16083
 16084     PERFORM 6157-SET-APP-LEVEL.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 309
* EL156.cbl
 16085
 16086     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 16087
 16088     IF NOT PI-PMT-GRADUATED
 16089         GO TO 6170-WRITE.
 16090
 16091
 16092* EXEC CICS HANDLE CONDITION
 16093*        NOTFND   (6170-WRITE)
 16094*    END-EXEC.
 16095*    MOVE '"$I                   ! 2 #00015119' TO DFHEIV0
 16096     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16098     MOVE X'3220233030303135313139' TO DFHEIV0(25:11)
 16099     CALL 'kxdfhei1' USING DFHEIV0
 16100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16101
 16102
 16103     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16104     MOVE '2'                    TO CNTL-REC-TYPE.
 16105     MOVE +0                     TO CNTL-SEQ-NO.
 16106     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16107
 16108
 16109* EXEC CICS READ
 16110*         DATASET  ('ELCNTL')
 16111*         SET      (ADDRESS OF CONTROL-FILE)
 16112*         RIDFLD   (ELCNTL-KEY)
 16113*    END-EXEC.
 16114     MOVE 'ELCNTL' TO DFHEIV1
 16115*    MOVE '&"S        E          (   #00015128' TO DFHEIV0
 16116     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16118     MOVE X'2020233030303135313238' TO DFHEIV0(25:11)
 16119     CALL 'kxdfhei1' USING DFHEIV0,
 16120           DFHEIV1,
 16121           DFHEIV20,
 16122           DFHEIV99,
 16123           ELCNTL-KEY,
 16124           DFHEIV99,
 16125           DFHEIV99,
 16126           DFHEIV99
 16127     SET ADDRESS OF CONTROL-FILE TO
 16128         DFHEIV20
 16129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16130
 16131
 16132     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 16133
 16134     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 16135                         OR '4' OR '5'
 16136         NEXT SENTENCE
 16137     ELSE
 16138         MOVE 'Y' TO WS-NEED-APPROVAL
 16139         GO TO 6170-WRITE.
 16140
 16141     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 16142         MOVE 'Y' TO WS-NEED-APPROVAL
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 310
* EL156.cbl
 16143         IF WS-APPROVAL-LEVEL = '1'
 16144             MOVE '2'        TO  AT-APPROVED-LEVEL
 16145                            WS-SAVE-APPROVED-LEVEL
 16146             GO TO 6170-WRITE
 16147         ELSE
 16148             IF WS-APPROVAL-LEVEL = '2'
 16149                 MOVE '3'        TO  AT-APPROVED-LEVEL
 16150                                WS-SAVE-APPROVED-LEVEL
 16151                 GO TO 6170-WRITE
 16152             ELSE IF WS-APPROVAL-LEVEL = '3'
 16153                 MOVE '4'        TO  AT-APPROVED-LEVEL
 16154                                WS-SAVE-APPROVED-LEVEL
 16155                 GO TO 6170-WRITE
 16156             ELSE IF WS-APPROVAL-LEVEL = '4'
 16157                 MOVE '5'        TO  AT-APPROVED-LEVEL
 16158                                WS-SAVE-APPROVED-LEVEL
 16159                 GO TO 6170-WRITE.
 16160
 16161     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16162                             WS-PMT-APPROVAL-SW.
 16163     MOVE SPACES         TO  AT-APPROVED-LEVEL
 16164                             AT-APPROVAL-LEVEL-REQD.
 16165
 16166*******************************************************
 16167 6155-READ-CONTROL.
 16168     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16169     MOVE '1'                    TO CNTL-REC-TYPE.
 16170     MOVE SPACES                 TO CNTL-ACCESS.
 16171     MOVE +0                     TO CNTL-SEQ-NO.
 16172     MOVE 'COMP'                 TO FILE-SWITCH.
 16173
 16174     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16175 6157-SET-APP-LEVEL.
 16176******A&H Limits are set as a monthly payment.  Calculate the mont
 16177******equivalent of the amount paid today
 16178     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 16179        PI-SAVE-ODD-DAYS-OVER > 0
 16180           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 16181                               / 30) + PI-SAVE-ELAPSED-MONTHS
 16182           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 16183                                  WS-CALC-PMT-MONTHS
 16184     ELSE
 16185           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 16186     END-IF.
 16187*06007      IF ((PAID-FOR-AH) AND
 16188     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16189           OR PAID-FOR-FAM) AND
 16190*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16191        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 16192              OR
 16193        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16194        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16195            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16196       ELSE
 16197*06014      IF ((PAID-FOR-AH)  AND
 16198         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16199           OR PAID-FOR-FAM) AND
 16200*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 311
* EL156.cbl
 16201           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 16202              OR
 16203        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16204        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16205            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16206         ELSE
 16207*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 16208           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16209                OR PAID-FOR-FAM) AND
 16210               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 16211              OR
 16212          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16213          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16214            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16215       ELSE
 16216           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16217                OR PAID-FOR-FAM) AND
 16218               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16219              OR
 16220          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16221          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16222            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16223       ELSE
 16224            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16225
 16226     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16227           OR PAID-FOR-FAM) AND
 16228        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16229        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16230            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16231        END-IF
 16232     ELSE
 16233     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16234           OR PAID-FOR-FAM) AND
 16235        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16236        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16237            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16238        END-IF
 16239     ELSE
 16240     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16241           OR PAID-FOR-FAM) AND
 16242        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16243        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16244            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16245        END-IF
 16246     ELSE
 16247     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16248           OR PAID-FOR-FAM) AND
 16249        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16250        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16251            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16252        END-IF
 16253     ELSE
 16254     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16255           OR PAID-FOR-FAM)
 16256            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16257
 16258 6170-WRITE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 312
* EL156.cbl
 16259
 16260     if pi-company-id = 'DCC' or 'VPP'
 16261        PERFORM 0900-GET-DDF-limits
 16262                                 THRU 0900-EXIT
 16263     end-if
 16264     perform 2220-update-elcrtt  thru 2220-exit
 16265     IF PI-COMPANY-ID = 'DMD'
 16266        IF PI-AT-EOB-CODES NOT = SPACES
 16267           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16268           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16269           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16270           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16271           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16272
 16273
 16274* EXEC CICS HANDLE CONDITION
 16275*        DUPREC    (6180-DUPREC)
 16276*    END-EXEC.
 16277*    MOVE '"$%                   ! 3 #00015275' TO DFHEIV0
 16278     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16280     MOVE X'3320233030303135323735' TO DFHEIV0(25:11)
 16281     CALL 'kxdfhei1' USING DFHEIV0
 16282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16283
 16284
 16285
 16286* EXEC CICS WRITE
 16287*         DATASET       ('ELTRLR')
 16288*         FROM          (ACTIVITY-TRAILERS)
 16289*         RIDFLD        (AT-CONTROL-PRIMARY)
 16290*     END-EXEC.
 16291     MOVE LENGTH OF
 16292      ACTIVITY-TRAILERS
 16293       TO DFHEIV11
 16294     MOVE 'ELTRLR' TO DFHEIV1
 16295*    MOVE '&$ L                  ''   #00015279' TO DFHEIV0
 16296     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16297     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16298     MOVE X'2020233030303135323739' TO DFHEIV0(25:11)
 16299     CALL 'kxdfhei1' USING DFHEIV0,
 16300           DFHEIV1,
 16301           ACTIVITY-TRAILERS,
 16302           DFHEIV11,
 16303           AT-CONTROL-PRIMARY,
 16304           DFHEIV99,
 16305           DFHEIV99
 16306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16307
 16308
 16309     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16310        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16311*06088           GO TO 6199-EXIT.
 16312           GO TO 6176-APPROVAL-NOTE.
 16313
 16314
 16315* EXEC CICS GETMAIN
 16316*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 313
* EL156.cbl
 16317*         LENGTH    (200)
 16318*         INITIMG   (GETMAIN-SPACE)
 16319*     END-EXEC.
 16320     MOVE 200
 16321       TO DFHEIV11
 16322*    MOVE ',"IL                  $   #00015290' TO DFHEIV0
 16323     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16324     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16325     MOVE X'2020233030303135323930' TO DFHEIV0(25:11)
 16326     CALL 'kxdfhei1' USING DFHEIV0,
 16327           DFHEIV20,
 16328           DFHEIV11,
 16329           GETMAIN-SPACE
 16330     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16331         DFHEIV20
 16332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16333
 16334
 16335     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16336
 16337     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16338     MOVE 'AT'                   TO AT-RECORD-ID.
 16339     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16340     MOVE '6'                    TO AT-TRAILER-TYPE.
 16341     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16342                                    AT-GEN-INFO-LAST-MAINT-DT
 16343     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16344                                    AT-GEN-INFO-LAST-UPDATED-BY
 16345     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16346
 16347     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16348     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16349     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16350
 16351     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16352
 16353 6175-WRITE.
 16354
 16355
 16356* EXEC CICS HANDLE CONDITION
 16357*        DUPREC    (6190-DUPREC)
 16358*    END-EXEC.
 16359*    MOVE '"$%                   ! 4 #00015316' TO DFHEIV0
 16360     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16362     MOVE X'3420233030303135333136' TO DFHEIV0(25:11)
 16363     CALL 'kxdfhei1' USING DFHEIV0
 16364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16365
 16366
 16367
 16368* EXEC CICS WRITE
 16369*         DATASET     ('ELTRLR')
 16370*         FROM        (ACTIVITY-TRAILERS)
 16371*         RIDFLD      (AT-CONTROL-PRIMARY)
 16372*     END-EXEC.
 16373     MOVE LENGTH OF
 16374      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 314
* EL156.cbl
 16375       TO DFHEIV11
 16376     MOVE 'ELTRLR' TO DFHEIV1
 16377*    MOVE '&$ L                  ''   #00015320' TO DFHEIV0
 16378     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16379     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16380     MOVE X'2020233030303135333230' TO DFHEIV0(25:11)
 16381     CALL 'kxdfhei1' USING DFHEIV0,
 16382           DFHEIV1,
 16383           ACTIVITY-TRAILERS,
 16384           DFHEIV11,
 16385           AT-CONTROL-PRIMARY,
 16386           DFHEIV99,
 16387           DFHEIV99
 16388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16389
 16390
 16391 6176-APPROVAL-NOTE.
 16392
 16393     IF NOT APPROVAL-NEEDED
 16394         GO TO 6199-EXIT.
 16395
 16396
 16397* EXEC CICS GETMAIN
 16398*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16399*        LENGTH    (200)
 16400*        INITIMG   (GETMAIN-SPACE)
 16401*    END-EXEC.
 16402     MOVE 200
 16403       TO DFHEIV11
 16404*    MOVE ',"IL                  $   #00015331' TO DFHEIV0
 16405     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16406     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16407     MOVE X'2020233030303135333331' TO DFHEIV0(25:11)
 16408     CALL 'kxdfhei1' USING DFHEIV0,
 16409           DFHEIV20,
 16410           DFHEIV11,
 16411           GETMAIN-SPACE
 16412     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16413         DFHEIV20
 16414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16415
 16416
 16417     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16418
 16419     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16420     MOVE 'AT'               TO AT-RECORD-ID
 16421     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16422     MOVE '6'                TO AT-TRAILER-TYPE
 16423     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16424                                AT-GEN-INFO-LAST-MAINT-DT
 16425     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16426                                AT-GEN-INFO-LAST-UPDATED-BY
 16427     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16428
 16429     IF PI-REAUDIT-NEEDED = 'Y'
 16430         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16431     ELSE
 16432         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 315
* EL156.cbl
 16433     END-IF
 16434     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16435         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16436     END-IF
 16437     IF PI-DUPE-APPROVAL-NEEDED = 'Y'
 16438         MOVE WS-DUPE-APPROV-NOTE TO AT-INFO-LINE-1
 16439     END-IF
 16440
 16441     MOVE SPACES             TO AT-INFO-LINE-2
 16442
 16443     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16444 6177-WRITE.
 16445
 16446
 16447* EXEC CICS HANDLE CONDITION
 16448*        DUPREC    (6185-DUPREC)
 16449*    END-EXEC.
 16450*    MOVE '"$%                   ! 5 #00015366' TO DFHEIV0
 16451     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16453     MOVE X'3520233030303135333636' TO DFHEIV0(25:11)
 16454     CALL 'kxdfhei1' USING DFHEIV0
 16455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16456
 16457
 16458
 16459* EXEC CICS WRITE
 16460*         DATASET     ('ELTRLR')
 16461*         FROM        (ACTIVITY-TRAILERS)
 16462*         RIDFLD      (AT-CONTROL-PRIMARY)
 16463*     END-EXEC.
 16464     MOVE LENGTH OF
 16465      ACTIVITY-TRAILERS
 16466       TO DFHEIV11
 16467     MOVE 'ELTRLR' TO DFHEIV1
 16468*    MOVE '&$ L                  ''   #00015370' TO DFHEIV0
 16469     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16470     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16471     MOVE X'2020233030303135333730' TO DFHEIV0(25:11)
 16472     CALL 'kxdfhei1' USING DFHEIV0,
 16473           DFHEIV1,
 16474           ACTIVITY-TRAILERS,
 16475           DFHEIV11,
 16476           AT-CONTROL-PRIMARY,
 16477           DFHEIV99,
 16478           DFHEIV99
 16479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16480
 16481
 16482
 16483     GO TO 6199-EXIT.
 16484
 16485 6180-DUPREC.
 16486
 16487     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16488     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16489     GO TO 6170-WRITE.
 16490
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 316
* EL156.cbl
 16491 6185-DUPREC.
 16492     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16493     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16494     GO TO 6177-WRITE.
 16495
 16496 6190-DUPREC.
 16497     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16498     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16499     GO TO 6175-WRITE.
 16500
 16501 6199-EXIT.
 16502      EXIT.
 16503
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 317
* EL156.cbl
 16505 6200-UPDATE-CLAIM-MSTR.
 16506     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16507     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16508     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16509     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16510
 16511     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16512
 16513     MOVE ZEROS                  TO W-INTEREST.
 16514
 16515     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 16516        IF (PI-OFFLINE = 'Y') OR
 16517           (PI-PMTTYPE = '7')
 16518           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16519                                 THRU 9870-EXIT
 16520        END-IF
 16521     END-IF
 16522     IF NOT ERROR-ON-OUTPUT
 16523        CONTINUE
 16524     ELSE
 16525
 16526* EXEC CICS REWRITE
 16527*          DATASET('ELMSTR')
 16528*          FROM(CLAIM-MASTER)
 16529*       END-EXEC
 16530     MOVE LENGTH OF
 16531      CLAIM-MASTER
 16532       TO DFHEIV11
 16533     MOVE 'ELMSTR' TO DFHEIV1
 16534*    MOVE '&& L                  %   #00015419' TO DFHEIV0
 16535     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16536     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16537     MOVE X'2020233030303135343139' TO DFHEIV0(25:11)
 16538     CALL 'kxdfhei1' USING DFHEIV0,
 16539           DFHEIV1,
 16540           CLAIM-MASTER,
 16541           DFHEIV11,
 16542           DFHEIV99
 16543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16544
 16545        MOVE -1                  TO ENTPFBL
 16546        MOVE AL-UANON            TO ENTPFBA
 16547        MOVE MAP-NAMEB           TO MAP-NAME
 16548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16549        GO TO 8200-SEND-DATAONLY
 16550     END-IF
 16551
 16552     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16553
 16554     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16555
 16556     IF PI-AIG-SPECIAL-BENEFIT
 16557         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16558
 16559     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16560
 16561     IF PI-SPECIAL-BEN-SW = 'Y'
 16562         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 318
* EL156.cbl
 16563         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16564
 16565     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16566         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16567     ELSE
 16568         IF PI-PMTTYPE NOT = '4'
 16569            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16570
 16571     IF PI-PMTTYPE = '5' OR '6'
 16572        GO TO  6250-SET-MAINT.
 16573
 16574     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16575                                         CL-LAG-REPORT-CODE.
 16576
 16577     IF CL-ACTIVITY-CODE = 09
 16578         GO TO 6200-CONT-UPDATE.
 16579
 16580     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16581         IF CL-ACTIVITY-CODE = 11
 16582             GO TO 6200-CONT-UPDATE.
 16583
 16584     IF WS-ACT-REC-FOUND-SW = 'N'
 16585         GO TO 6200-CONT-UPDATE.
 16586
 16587     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16588         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16589         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16590         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16591
 16592     IF WS-UPDATE-SW = 'Y'
 16593         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16594                                         CL-NEXT-FOLLOWUP-DT.
 16595
 16596 6200-CONT-UPDATE.
 16597
 16598     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16599       IF CLAIM-IS-CLOSED
 16600         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16601           IF WS-OPEN-CLOSE-SW = '2'
 16602             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16603                                        CL-LAST-CLOSE-DT.
 16604
 16605     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16606        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16607        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16608
 16609     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16610        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16611        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16612        MOVE 'C'                 TO CL-CLAIM-STATUS
 16613        IF PI-PMTTYPE = '2'
 16614           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16615              or 'F')
 16616           CONTINUE
 16617        ELSE
 16618           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16619        END-IF
 16620     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 319
* EL156.cbl
 16621        IF PI-PMTTYPE = '2' OR '3'
 16622           IF PI-PMTTYPE = '2' AND
 16623              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16624                 or 'F')
 16625              CONTINUE
 16626           ELSE
 16627              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16628           END-IF
 16629        END-IF
 16630     END-IF
 16631
 16632     IF PI-PMTTYPE = '4'
 16633        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16634
 16635     IF PI-COMPANY-ID = 'CVL'
 16636         IF PI-LOAN-UPDATE-SW = 'Y'
 16637             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16638             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16639             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16640             MOVE CL-CERT-STATE      TO  CERT-STATE
 16641             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16642             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16643             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16644             MOVE 'CERT'             TO  FILE-SWITCH
 16645             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16646             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16647             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16648
 16649     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16650        GO TO 6220-USE-COMPUTED.
 16651
 16652     IF (PI-PMTTYPE = '4')  AND
 16653        (PI-EPYAMT < ZEROS)
 16654          COMPUTE CL-NO-OF-DAYS-PAID =
 16655                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16656          IF CL-NO-OF-DAYS-PAID < +0
 16657              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16658          ELSE
 16659              NEXT SENTENCE
 16660     ELSE
 16661          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16662
 16663     IF HOLD-UNTIL-PMT
 16664        CONTINUE
 16665     ELSE
 16666     IF PI-PROCESSOR-ID = 'FIX '
 16667        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16668           NEXT SENTENCE
 16669        ELSE
 16670           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16671     ELSE
 16672        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16673
 16674     IF PI-PMTTYPE = '4'
 16675        GO TO 6250-SET-MAINT.
 16676
 16677     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16678     MOVE '4'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 320
* EL156.cbl
 16679     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16680     IF HOLD-UNTIL-PMT
 16681        CONTINUE
 16682     ELSE
 16683     IF DATE-CONVERSION-ERROR
 16684        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16685     ELSE
 16686        ADD 1                 TO CL-NO-OF-PMTS-MADE
 16687        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16688           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16689           IF PI-AIG-SPECIAL-BENEFIT
 16690               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16691           ELSE
 16692               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16693
 16694     GO TO 6250-SET-MAINT.
 16695
 16696 6220-USE-COMPUTED.
 16697
 16698     IF (PI-PMTTYPE = '4')  AND
 16699        (PI-CPYAMT < ZEROS)
 16700          COMPUTE CL-NO-OF-DAYS-PAID =
 16701                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16702          IF CL-NO-OF-DAYS-PAID < +0
 16703              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16704          ELSE
 16705              NEXT SENTENCE
 16706     ELSE
 16707          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16708
 16709     IF NOT HOLD-UNTIL-PMT
 16710        ADD 1                    TO CL-NO-OF-PMTS-MADE
 16711        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.
 16712
 16713     IF PI-PMTTYPE = '4'
 16714        GO TO 6250-SET-MAINT.
 16715
 16716     IF PI-AIG-SPECIAL-BENEFIT
 16717         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16718     ELSE
 16719         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16720
 16721     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16722       AND NOT HOLD-UNTIL-PMT
 16723        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16724
 16725 6250-SET-MAINT.
 16726     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16727
 16728     IF PI-PROCESSOR-ID = 'FIX '
 16729        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16730           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16731        ELSE
 16732           NEXT SENTENCE
 16733     ELSE
 16734        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16735
 16736     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 321
* EL156.cbl
 16737     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16738     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16739
 16740 6299-EXIT.
 16741      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 322
* EL156.cbl
 16743 6300-UPDATE-CERT.
 16744
 16745*  ADD CERTNOTE FOR SC NP+6
 16746     IF PI-COMPANY-ID = 'CID' AND
 16747       (PI-PMTTYPE = '2' OR '3') AND
 16748        CL-CERT-STATE = 'SC'  AND
 16749        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16750           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16751     END-IF.
 16752
 16753     IF PI-COMPANY-ID = 'AHL' AND
 16754       (PI-PMTTYPE = '2' OR '3') AND
 16755        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16756           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16757           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16758     END-IF.
 16759
 16760     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16761     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16762     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16763     MOVE CL-CERT-STATE    TO CERT-STATE.
 16764     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16765     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16766     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16767     MOVE 'CERT'           TO FILE-SWITCH.
 16768
 16769     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16770
 16771     IF CERT-NOTE-ADDED
 16772        IF CM-NOTE-SW = ' '
 16773           MOVE '4'             TO CM-NOTE-SW
 16774        ELSE
 16775           IF CM-NOTE-SW = '1'
 16776               MOVE '5'           TO CM-NOTE-SW
 16777           ELSE
 16778              IF CM-NOTE-SW = '2'
 16779                 MOVE '6'         TO CM-NOTE-SW
 16780              ELSE
 16781                 IF CM-NOTE-SW = '3'
 16782                    MOVE '7'      TO CM-NOTE-SW
 16783                 END-IF
 16784              END-IF
 16785           END-IF
 16786        END-IF
 16787     END-IF.
 16788
 16789     IF PI-COMPANY-ID = 'CVL'
 16790         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16791         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16792
 16793     IF PI-PMTTYPE NOT = '4'
 16794        GO TO 6340-UPDATE-CERT.
 16795
 16796     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16797        IF PI-PFKEY-USED = DFHPF5
 16798           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16799        ELSE
 16800           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 323
* EL156.cbl
 16801
 16802*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16803*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16804*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16805*               PI-LF-COVERAGE-TYPE = 'P'
 16806*                GO TO 6350-REWRITE-CERT.
 16807
 16808     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16809       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16810          PI-LF-COVERAGE-TYPE = 'P'
 16811           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16812                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16813                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16814                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16815                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16816                GO TO 6350-REWRITE-CERT
 16817            ELSE
 16818                GO TO 6350-REWRITE-CERT.
 16819
 16820     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16821         GO TO 6350-REWRITE-CERT.
 16822
 16823     IF NOT CM-AH-LUMP-SUM-DISAB
 16824        GO TO 6380-UNLOCK-CERT.
 16825
 16826     IF PI-PFKEY-USED = DFHPF5
 16827        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16828                                    CM-AH-ITD-AH-PMT
 16829        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16830        GO TO 6350-REWRITE-CERT
 16831     ELSE
 16832        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16833                                    CM-AH-ITD-AH-PMT
 16834        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16835        GO TO 6350-REWRITE-CERT.
 16836
 16837 6340-UPDATE-CERT.
 16838
 16839     IF CL-CLAIM-TYPE = 'L' OR 'O'
 16840         IF PI-PFKEY-USED = DFHPF5
 16841             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16842         ELSE
 16843             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16844
 16845     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16846         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16847             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16848                PI-LF-COVERAGE-TYPE = 'P'
 16849                 GO TO 6350-REWRITE-CERT.
 16850
 16851     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16852       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16853          PI-LF-COVERAGE-TYPE = 'P'
 16854           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16855                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16856                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16857                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16858                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 324
* EL156.cbl
 16859                GO TO 6350-REWRITE-CERT.
 16860
 16861     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16862         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16863            PI-LF-COVERAGE-TYPE NOT = 'P'
 16864             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16865             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16866             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16867             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16868             GO TO 6350-REWRITE-CERT.
 16869
 16870     IF CL-CLAIM-TYPE = 'O'
 16871         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16872            PI-LF-COVERAGE-TYPE NOT = 'P'
 16873             MOVE CL-INCURRED-DT         TO CM-LF-CANCEL-DT
 16874             MOVE PI-MONTH-END-SAVE      TO CM-LF-CANCEL-EXIT-DT
 16875             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-CANCEL
 16876             MOVE '6'            TO CM-LF-CURRENT-STATUS
 16877             GO TO 6350-REWRITE-CERT.
 16878
 16879     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16880         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16881         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16882         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16883         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16884         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16885         IF PI-PFKEY-USED = DFHPF5
 16886             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16887                                        CM-AH-ITD-AH-PMT
 16888             GO TO 6350-REWRITE-CERT
 16889         ELSE
 16890             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16891                                        CM-AH-ITD-AH-PMT
 16892             GO TO 6350-REWRITE-CERT.
 16893
 16894 6350-REWRITE-CERT.
 16895
 16896
 16897* EXEC CICS REWRITE
 16898*         DATASET  ('ELCERT')
 16899*         FROM(CERTIFICATE-MASTER)
 16900*     END-EXEC.
 16901     MOVE LENGTH OF
 16902      CERTIFICATE-MASTER
 16903       TO DFHEIV11
 16904     MOVE 'ELCERT' TO DFHEIV1
 16905*    MOVE '&& L                  %   #00015775' TO DFHEIV0
 16906     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16907     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16908     MOVE X'2020233030303135373735' TO DFHEIV0(25:11)
 16909     CALL 'kxdfhei1' USING DFHEIV0,
 16910           DFHEIV1,
 16911           CERTIFICATE-MASTER,
 16912           DFHEIV11,
 16913           DFHEIV99
 16914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16915
 16916
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 325
* EL156.cbl
 16917     GO TO 6399-EXIT.
 16918
 16919 6380-UNLOCK-CERT.
 16920
 16921* EXEC CICS UNLOCK
 16922*         DATASET  ('ELCERT')
 16923*     END-EXEC.
 16924     MOVE 'ELCERT' TO DFHEIV1
 16925*    MOVE '&*                    #   #00015783' TO DFHEIV0
 16926     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16927     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16928     MOVE X'2020233030303135373833' TO DFHEIV0(25:11)
 16929     CALL 'kxdfhei1' USING DFHEIV0,
 16930           DFHEIV1,
 16931           DFHEIV99
 16932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16933
 16934
 16935 6399-EXIT.
 16936      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 326
* EL156.cbl
 16938 6400-UPDATE-ZERO-TRAILER.
 16939     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16940     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16941
 16942     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16943
 16944     IF PI-EPYAMT NOT = ZEROS
 16945         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16946     ELSE
 16947         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16948
 16949     IF PI-ERESV NOT = ZEROS
 16950        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16951
 16952     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16953        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16954
 16955     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16956        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16957     ELSE
 16958        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16959
 16960     IF PI-PMTTYPE = '5'
 16961        IF PI-EPYAMT = ZEROS
 16962           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16963        ELSE
 16964           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16965
 16966     IF PI-PMTTYPE = '6'
 16967        IF PI-EPYAMT = ZEROS
 16968           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16969        ELSE
 16970           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16971
 16972 6420-CHECK-OPEN-CLOSE.
 16973     IF PI-PMTTYPE = '5' OR '6'
 16974        GO TO 6450-REWRITE.
 16975
 16976     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16977         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16978             IF CLAIM-IS-CLOSED
 16979                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16980                 MOVE 1          TO  SUB-1
 16981                 GO TO 6440-AIG-LOOP.
 16982
 16983     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16984        GO TO 6450-REWRITE.
 16985
 16986     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16987        GO TO 6450-REWRITE.
 16988
 16989     MOVE 1                      TO SUB-1.
 16990
 16991 6430-LOOP.
 16992     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16993        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16994        IF PI-PMTTYPE = '1' OR '4'
 16995           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 327
* EL156.cbl
 16996           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16997           GO TO 6450-REWRITE
 16998        ELSE
 16999           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 17000           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 17001           GO TO 6450-REWRITE.
 17002
 17003     IF SUB-1 = 6
 17004      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 17005      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 17006      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 17007      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 17008      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 17009      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 17010      GO TO 6430-LOOP.
 17011
 17012     ADD 1                       TO SUB-1.
 17013     GO TO 6430-LOOP.
 17014
 17015
 17016 6440-AIG-LOOP.
 17017
 17018     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 17019       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 17020       IF WS-OPEN-CLOSE-SW = '1'
 17021         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 17022         IF PI-PMTTYPE = '2'
 17023           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17024           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 17025         ELSE
 17026           IF PI-PMTTYPE = '3'
 17027             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17028             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 17029           ELSE
 17030             IF PI-PMTTYPE = '4'
 17031               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17032               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 17033             ELSE
 17034               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17035               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 17036       ELSE
 17037         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 17038         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17039         GO TO 6450-REWRITE.
 17040
 17041     IF SUB-1 = 6
 17042      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 17043      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 17044      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 17045      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 17046      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 17047      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 17048      GO TO 6440-AIG-LOOP.
 17049
 17050     ADD 1                       TO SUB-1.
 17051     GO TO 6440-AIG-LOOP.
 17052
 17053 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 328
* EL156.cbl
 17054     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 17055     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 17056     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 17057
 17058     IF PI-COMPANY-ID = 'DMD'
 17059         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 17060         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 17061         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 17062         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 17063         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 17064
 17065
 17066* EXEC CICS REWRITE
 17067*         DATASET  ('ELTRLR')
 17068*         FROM     (ACTIVITY-TRAILERS)
 17069*     END-EXEC.
 17070     MOVE LENGTH OF
 17071      ACTIVITY-TRAILERS
 17072       TO DFHEIV11
 17073     MOVE 'ELTRLR' TO DFHEIV1
 17074*    MOVE '&& L                  %   #00015917' TO DFHEIV0
 17075     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17076     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17077     MOVE X'2020233030303135393137' TO DFHEIV0(25:11)
 17078     CALL 'kxdfhei1' USING DFHEIV0,
 17079           DFHEIV1,
 17080           ACTIVITY-TRAILERS,
 17081           DFHEIV11,
 17082           DFHEIV99
 17083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17084
 17085
 17086 6499-EXIT.
 17087      EXIT.
 17088
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 329
* EL156.cbl
 17090 6500-READ-DLO035.
 17091     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 17092     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17093     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17094     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17095
 17096
 17097* EXEC CICS LINK
 17098*        PROGRAM    ('DLO035')
 17099*        COMMAREA   (DLO035-KEY)
 17100*        LENGTH     (DL35-LENGTH)
 17101*    END-EXEC.
 17102     MOVE 'DLO035' TO DFHEIV1
 17103*    MOVE '."C                   (   #00015932' TO DFHEIV0
 17104     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17106     MOVE X'2020233030303135393332' TO DFHEIV0(25:11)
 17107     CALL 'kxdfhei1' USING DFHEIV0,
 17108           DFHEIV1,
 17109           DLO035-KEY,
 17110           DL35-LENGTH,
 17111           DFHEIV99,
 17112           DFHEIV99,
 17113           DFHEIV99,
 17114           DFHEIV99
 17115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17116
 17117
 17118     IF DL35-RETURN-CODE = 'OK'
 17119         GO TO 6500-EXIT.
 17120
 17121     IF DL35-RETURN-CODE = '01'
 17122         MOVE ER-7830            TO EMI-ERROR
 17123         GO TO 6500-BAD-EXIT.
 17124
 17125     IF DL35-RETURN-CODE = '02'
 17126         MOVE ER-7831            TO EMI-ERROR
 17127         GO TO 6500-BAD-EXIT.
 17128
 17129     IF DL35-RETURN-CODE = '03'
 17130         MOVE ER-7832            TO EMI-ERROR
 17131         GO TO 6500-BAD-EXIT.
 17132
 17133     IF DL35-RETURN-CODE = '04'
 17134         MOVE ER-7833            TO EMI-ERROR
 17135         GO TO 6500-BAD-EXIT.
 17136
 17137     IF DL35-RETURN-CODE = '05'
 17138         MOVE ER-7834            TO EMI-ERROR
 17139         GO TO 6500-BAD-EXIT.
 17140
 17141     IF DL35-RETURN-CODE = '06'
 17142         MOVE ER-7835            TO EMI-ERROR
 17143         GO TO 6500-BAD-EXIT.
 17144
 17145     IF DL35-RETURN-CODE = '07'
 17146         MOVE ER-7836            TO EMI-ERROR
 17147         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 330
* EL156.cbl
 17148
 17149     IF DL35-RETURN-CODE = 'E1'
 17150         MOVE ER-7837            TO EMI-ERROR
 17151         GO TO 6500-BAD-EXIT.
 17152
 17153     IF DL35-RETURN-CODE NOT = 'OK'
 17154         MOVE ER-7838            TO EMI-ERROR
 17155         GO TO 6500-BAD-EXIT.
 17156
 17157 6500-EXIT.
 17158      EXIT.
 17159
 17160 6500-BAD-EXIT.
 17161
 17162* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17163*    MOVE '6"R                   !   #00015981' TO DFHEIV0
 17164     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17166     MOVE X'2020233030303135393831' TO DFHEIV0(25:11)
 17167     CALL 'kxdfhei1' USING DFHEIV0
 17168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17169
 17170     MOVE -1                 TO PMTTYPEL.
 17171     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17172     GO TO 8200-SEND-DATAONLY.
 17173
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 331
* EL156.cbl
 17175 6600-UPDATE-DLO035.
 17176     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 17177     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17178     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17179     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17180
 17181
 17182* EXEC CICS LINK
 17183*        PROGRAM    ('DLO035')
 17184*        COMMAREA   (DLO035-KEY)
 17185*        LENGTH     (DL35-LENGTH)
 17186*    END-EXEC.
 17187     MOVE 'DLO035' TO DFHEIV1
 17188*    MOVE '."C                   (   #00015993' TO DFHEIV0
 17189     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17191     MOVE X'2020233030303135393933' TO DFHEIV0(25:11)
 17192     CALL 'kxdfhei1' USING DFHEIV0,
 17193           DFHEIV1,
 17194           DLO035-KEY,
 17195           DL35-LENGTH,
 17196           DFHEIV99,
 17197           DFHEIV99,
 17198           DFHEIV99,
 17199           DFHEIV99
 17200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17201
 17202
 17203     IF DL35-RETURN-CODE = 'OK'
 17204         GO TO 6600-EXIT.
 17205
 17206     IF DL35-RETURN-CODE = '01'
 17207         MOVE ER-7830            TO EMI-ERROR
 17208         GO TO 6500-BAD-EXIT.
 17209
 17210     IF DL35-RETURN-CODE = '02'
 17211         MOVE ER-7831            TO EMI-ERROR
 17212         GO TO 6500-BAD-EXIT.
 17213
 17214     IF DL35-RETURN-CODE = '03'
 17215         MOVE ER-7832            TO EMI-ERROR
 17216         GO TO 6500-BAD-EXIT.
 17217
 17218     IF DL35-RETURN-CODE = '04'
 17219         MOVE ER-7833            TO EMI-ERROR
 17220         GO TO 6500-BAD-EXIT.
 17221
 17222     IF DL35-RETURN-CODE = '05'
 17223         MOVE ER-7834            TO EMI-ERROR
 17224         GO TO 6500-BAD-EXIT.
 17225
 17226     IF DL35-RETURN-CODE = '06'
 17227         MOVE ER-7835            TO EMI-ERROR
 17228         GO TO 6500-BAD-EXIT.
 17229
 17230     IF DL35-RETURN-CODE = '07'
 17231         MOVE ER-7836            TO EMI-ERROR
 17232         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 332
* EL156.cbl
 17233
 17234     IF DL35-RETURN-CODE = 'E1'
 17235         MOVE ER-7837            TO EMI-ERROR
 17236         GO TO 6500-BAD-EXIT.
 17237
 17238     IF DL35-RETURN-CODE NOT = 'OK'
 17239         MOVE ER-7838            TO EMI-ERROR
 17240         GO TO 6500-BAD-EXIT.
 17241
 17242 6600-EXIT.
 17243      EXIT.
 17244
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 333
* EL156.cbl
 17246 6700-UPDATE-ACTQ.
 17247***************************************************************
 17248*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17249*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17250*    ONE ALREADY THERE.                                       *
 17251***************************************************************
 17252
 17253
 17254* EXEC CICS HANDLE CONDITION
 17255*         NOTFND(6720-BUILD-NEW-RECORD)
 17256*     END-EXEC.
 17257*    MOVE '"$I                   ! 6 #00016049' TO DFHEIV0
 17258     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17260     MOVE X'3620233030303136303439' TO DFHEIV0(25:11)
 17261     CALL 'kxdfhei1' USING DFHEIV0
 17262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17263
 17264
 17265
 17266* EXEC CICS READ
 17267*         DATASET('ELACTQ')
 17268*         RIDFLD (ELMSTR-KEY)
 17269*         SET    (ADDRESS OF ACTIVITY-QUE)
 17270*         UPDATE
 17271*     END-EXEC.
 17272     MOVE 'ELACTQ' TO DFHEIV1
 17273*    MOVE '&"S        EU         (   #00016053' TO DFHEIV0
 17274     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17275     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17276     MOVE X'2020233030303136303533' TO DFHEIV0(25:11)
 17277     CALL 'kxdfhei1' USING DFHEIV0,
 17278           DFHEIV1,
 17279           DFHEIV20,
 17280           DFHEIV99,
 17281           ELMSTR-KEY,
 17282           DFHEIV99,
 17283           DFHEIV99,
 17284           DFHEIV99
 17285     SET ADDRESS OF ACTIVITY-QUE TO
 17286         DFHEIV20
 17287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17288
 17289
 17290     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17291
 17292     IF PI-AIG-SPECIAL-BENEFIT AND
 17293        PI-CASH = 'Y'
 17294         ADD 2                   TO AQ-PAYMENT-COUNTER
 17295     ELSE
 17296         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17297
 17298     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17299         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17300
 17301     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17302
 17303     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 334
* EL156.cbl
 17304         IF WS-PMT-APPROVAL-SW = 'A'
 17305             NEXT SENTENCE
 17306         ELSE
 17307            IF PI-AIG-SPECIAL-BENEFIT AND
 17308               PI-CASH = 'Y'
 17309                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17310                                     WS-PMT-UNAPPROVED-CNT
 17311            ELSE
 17312                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17313                                     WS-PMT-UNAPPROVED-CNT
 17314     ELSE
 17315         IF PI-PMT-APPR-SW = 'Y'
 17316            IF PI-AIG-SPECIAL-BENEFIT AND
 17317               PI-CASH = 'Y'
 17318                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17319                                     WS-PMT-UNAPPROVED-CNT
 17320            ELSE
 17321                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17322                                     WS-PMT-UNAPPROVED-CNT.
 17323
 17324     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17325         MOVE ER-3536 TO EMI-ERROR
 17326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17327
 17328     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17329
 17330
 17331* EXEC CICS REWRITE
 17332*         DATASET('ELACTQ')
 17333*         FROM   (ACTIVITY-QUE)
 17334*     END-EXEC.
 17335     MOVE LENGTH OF
 17336      ACTIVITY-QUE
 17337       TO DFHEIV11
 17338     MOVE 'ELACTQ' TO DFHEIV1
 17339*    MOVE '&& L                  %   #00016100' TO DFHEIV0
 17340     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17341     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17342     MOVE X'2020233030303136313030' TO DFHEIV0(25:11)
 17343     CALL 'kxdfhei1' USING DFHEIV0,
 17344           DFHEIV1,
 17345           ACTIVITY-QUE,
 17346           DFHEIV11,
 17347           DFHEIV99
 17348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17349
 17350
 17351     GO TO 6799-EXIT.
 17352
 17353 6720-BUILD-NEW-RECORD.
 17354
 17355* EXEC CICS GETMAIN
 17356*         SET    (ADDRESS OF ACTIVITY-QUE)
 17357*         LENGTH (60)
 17358*         INITIMG(GETMAIN-SPACE)
 17359*     END-EXEC.
 17360     MOVE 60
 17361       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 335
* EL156.cbl
 17362*    MOVE ',"IL                  $   #00016108' TO DFHEIV0
 17363     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17365     MOVE X'2020233030303136313038' TO DFHEIV0(25:11)
 17366     CALL 'kxdfhei1' USING DFHEIV0,
 17367           DFHEIV20,
 17368           DFHEIV11,
 17369           GETMAIN-SPACE
 17370     SET ADDRESS OF ACTIVITY-QUE TO
 17371         DFHEIV20
 17372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17373
 17374
 17375     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17376
 17377     IF PI-AIG-SPECIAL-BENEFIT AND
 17378        PI-CASH = 'Y'
 17379         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17380     ELSE
 17381         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17382
 17383     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17384     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17385     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17386     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17387                                    AQ-FOLLOWUP-DATE.
 17388     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17389     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17390
 17391     IF PI-PMT-GRADUATED
 17392         IF WS-PMT-APPROVAL-SW = 'A'
 17393             NEXT SENTENCE
 17394         ELSE
 17395            IF PI-AIG-SPECIAL-BENEFIT AND
 17396               PI-CASH = 'Y'
 17397                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17398            ELSE
 17399                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17400     ELSE
 17401         IF PI-PMT-APPR-SW = 'Y'
 17402            IF PI-AIG-SPECIAL-BENEFIT AND
 17403               PI-CASH = 'Y'
 17404                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17405            ELSE
 17406                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17407
 17408     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17409         MOVE ER-3536 TO EMI-ERROR
 17410         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17411
 17412
 17413* EXEC CICS WRITE
 17414*         DATASET('ELACTQ')
 17415*         RIDFLD (ELMSTR-KEY)
 17416*         FROM   (ACTIVITY-QUE)
 17417*     END-EXEC.
 17418     MOVE LENGTH OF
 17419      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 336
* EL156.cbl
 17420       TO DFHEIV11
 17421     MOVE 'ELACTQ' TO DFHEIV1
 17422*    MOVE '&$ L                  ''   #00016151' TO DFHEIV0
 17423     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17424     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17425     MOVE X'2020233030303136313531' TO DFHEIV0(25:11)
 17426     CALL 'kxdfhei1' USING DFHEIV0,
 17427           DFHEIV1,
 17428           ACTIVITY-QUE,
 17429           DFHEIV11,
 17430           ELMSTR-KEY,
 17431           DFHEIV99,
 17432           DFHEIV99
 17433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17434
 17435
 17436 6799-EXIT.
 17437      EXIT.
 17438
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 337
* EL156.cbl
 17440 6800-BUILD-FORM-TRAILER.
 17441
 17442
 17443* EXEC CICS GETMAIN
 17444*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17445*         LENGTH   (200)
 17446*         INITIMG  (GETMAIN-SPACE)
 17447*    END-EXEC.
 17448     MOVE 200
 17449       TO DFHEIV11
 17450*    MOVE ',"IL                  $   #00016163' TO DFHEIV0
 17451     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17452     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17453     MOVE X'2020233030303136313633' TO DFHEIV0(25:11)
 17454     CALL 'kxdfhei1' USING DFHEIV0,
 17455           DFHEIV20,
 17456           DFHEIV11,
 17457           GETMAIN-SPACE
 17458     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17459         DFHEIV20
 17460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17461
 17462
 17463     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17464
 17465     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17466     MOVE 'AT'                   TO AT-RECORD-ID.
 17467     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17468
 17469     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17470     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17471                                    AT-FORM-LAST-MAINT-DT
 17472                                    AT-FORM-SEND-ON-DT.
 17473     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17474                                    AT-FORM-LAST-UPDATED-BY.
 17475     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17476     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17477     MOVE '6'                    TO DC-OPTION-CODE.
 17478     MOVE +29                    TO DC-ELAPSED-DAYS.
 17479     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17480     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17481     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17482
 17483     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17484         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17485
 17486     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17487                                    AT-FORM-RE-SEND-DT
 17488                                    AT-EMP-FORM-ANSWERED-DT
 17489                                    AT-PHY-FORM-ANSWERED-DT
 17490                                    AT-EMP-FORM-SEND-ON-DT
 17491                                    AT-PHY-FORM-SEND-ON-DT
 17492                                    AT-FORM-PRINTED-DT
 17493                                    AT-FORM-REPRINT-DT.
 17494     MOVE '2'                    TO AT-FORM-TYPE.
 17495
 17496     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17497     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 338
* EL156.cbl
 17498
 17499     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17500         NEXT SENTENCE
 17501     ELSE
 17502         IF CL-PROG-FORM-TYPE NOT = 'S'
 17503            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17504
 17505
 17506* EXEC CICS WRITE
 17507*         DATASET  ('ELTRLR')
 17508*         FROM     (ACTIVITY-TRAILERS)
 17509*         RIDFLD   (AT-CONTROL-PRIMARY)
 17510*     END-EXEC.
 17511     MOVE LENGTH OF
 17512      ACTIVITY-TRAILERS
 17513       TO DFHEIV11
 17514     MOVE 'ELTRLR' TO DFHEIV1
 17515*    MOVE '&$ L                  ''   #00016211' TO DFHEIV0
 17516     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17517     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17518     MOVE X'2020233030303136323131' TO DFHEIV0(25:11)
 17519     CALL 'kxdfhei1' USING DFHEIV0,
 17520           DFHEIV1,
 17521           ACTIVITY-TRAILERS,
 17522           DFHEIV11,
 17523           AT-CONTROL-PRIMARY,
 17524           DFHEIV99,
 17525           DFHEIV99
 17526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17527
 17528
 17529 6899-EXIT.
 17530      EXIT.
 17531
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 339
* EL156.cbl
 17533 6900-BUILD-ARCHIVE-HEADER.
 17534
 17535     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17536     MOVE '1'                    TO CNTL-REC-TYPE.
 17537     MOVE +0                     TO CNTL-SEQ-NO.
 17538     MOVE SPACES                 TO CNTL-ACCESS.
 17539
 17540
 17541* EXEC CICS READ
 17542*         DATASET  ('ELCNTL')
 17543*         SET      (ADDRESS OF CONTROL-FILE)
 17544*         RIDFLD   (ELCNTL-KEY)
 17545*         UPDATE
 17546*    END-EXEC.
 17547     MOVE 'ELCNTL' TO DFHEIV1
 17548*    MOVE '&"S        EU         (   #00016228' TO DFHEIV0
 17549     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17550     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17551     MOVE X'2020233030303136323238' TO DFHEIV0(25:11)
 17552     CALL 'kxdfhei1' USING DFHEIV0,
 17553           DFHEIV1,
 17554           DFHEIV20,
 17555           DFHEIV99,
 17556           ELCNTL-KEY,
 17557           DFHEIV99,
 17558           DFHEIV99,
 17559           DFHEIV99
 17560     SET ADDRESS OF CONTROL-FILE TO
 17561         DFHEIV20
 17562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17563
 17564
 17565     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17566     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17567
 17568
 17569* EXEC CICS REWRITE
 17570*         FROM     (CONTROL-FILE)
 17571*         DATASET  ('ELCNTL')
 17572*    END-EXEC.
 17573     MOVE LENGTH OF
 17574      CONTROL-FILE
 17575       TO DFHEIV11
 17576     MOVE 'ELCNTL' TO DFHEIV1
 17577*    MOVE '&& L                  %   #00016238' TO DFHEIV0
 17578     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17579     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17580     MOVE X'2020233030303136323338' TO DFHEIV0(25:11)
 17581     CALL 'kxdfhei1' USING DFHEIV0,
 17582           DFHEIV1,
 17583           CONTROL-FILE,
 17584           DFHEIV11,
 17585           DFHEIV99
 17586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17587
 17588
 17589
 17590* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 340
* EL156.cbl
 17591*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17592*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17593*    END-EXEC.
 17594*    MOVE '"$$%                  ! 7 #00016243' TO DFHEIV0
 17595     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17597     MOVE X'3720233030303136323433' TO DFHEIV0(25:11)
 17598     CALL 'kxdfhei1' USING DFHEIV0
 17599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17600
 17601
 17602
 17603* EXEC CICS GETMAIN
 17604*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17605*         LENGTH  (ELARCH-LENGTH)
 17606*         INITIMG (GETMAIN-SPACE)
 17607*    END-EXEC.
 17608*    MOVE ',"IL                  $   #00016248' TO DFHEIV0
 17609     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17610     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17611     MOVE X'2020233030303136323438' TO DFHEIV0(25:11)
 17612     CALL 'kxdfhei1' USING DFHEIV0,
 17613           DFHEIV20,
 17614           ELARCH-LENGTH,
 17615           GETMAIN-SPACE
 17616     SET ADDRESS OF LETTER-ARCHIVE TO
 17617         DFHEIV20
 17618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17619
 17620
 17621     MOVE 'LA'                   TO LA-RECORD-ID.
 17622     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17623                                    LA-ARCHIVE-NO-A1.
 17624     MOVE '4'                    TO LA-RECORD-TYPE
 17625                                    LA-RECORD-TYPE-A1.
 17626     MOVE +0                     TO LA-LINE-SEQ-NO
 17627                                    LA-LINE-SEQ-NO-A1.
 17628     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17629                                    LA-COMPANY-CD-A1.
 17630     MOVE CL-CARRIER             TO LA4-CARRIER.
 17631     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17632     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17633     MOVE CL-CERT-STATE          TO LA4-STATE.
 17634     MOVE +0                     TO LA4-NO-OF-COPIES.
 17635     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17636     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17637     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17638                                    LA4-INITIAL-PRINT-DATE
 17639                                    LA4-RESEND-PRINT-DATE
 17640                                    LA4-FORM-REM-PRINT-DT.
 17641     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17642     MOVE '2'                    TO LA4-FORM-TYPE.
 17643
 17644
 17645* EXEC CICS WRITE
 17646*         DATASET  ('ELARCH')
 17647*         FROM     (LETTER-ARCHIVE)
 17648*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 341
* EL156.cbl
 17649*    END-EXEC.
 17650     MOVE LENGTH OF
 17651      LETTER-ARCHIVE
 17652       TO DFHEIV11
 17653     MOVE 'ELARCH' TO DFHEIV1
 17654*    MOVE '&$ L                  ''   #00016277' TO DFHEIV0
 17655     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17656     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17657     MOVE X'2020233030303136323737' TO DFHEIV0(25:11)
 17658     CALL 'kxdfhei1' USING DFHEIV0,
 17659           DFHEIV1,
 17660           LETTER-ARCHIVE,
 17661           DFHEIV11,
 17662           LA-CONTROL-PRIMARY,
 17663           DFHEIV99,
 17664           DFHEIV99
 17665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17666
 17667
 17668 6999-EXIT.
 17669      EXIT.
 17670
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 342
* EL156.cbl
 17672 7000-SHOW-CLAIM.
 17673     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17674     MOVE 'A'                    TO PI-PASS-SW.
 17675     MOVE LOW-VALUES             TO PI-CPYFROM
 17676                                    PI-MONTH-END-SAVE
 17677                                    PI-CPYTHRU.
 17678
 17679     MOVE ZEROS                  TO PI-FATAL-COUNT
 17680                                    PI-DAILY-RATE
 17681                                    PI-BEN-DAYS
 17682                                    PI-MANUAL-SW
 17683                                    PI-SAVE-CURSOR
 17684                                    PI-FORCE-COUNT
 17685                                    PI-HOLDTIL
 17686                                    PI-EPYFROM
 17687                                    PI-EPYTHRU
 17688                                    PI-EDAYS
 17689                                    PI-EPYAMT
 17690                                    PI-ERESV
 17691                                    PI-EEXPENS
 17692                                    PI-CDAYS
 17693                                    PI-CPYAMT
 17694                                    PI-CRESV
 17695                                    PI-CEXPENS
 17696                                    PI-INT-RATE
 17697                                    PI-AIGFROM.
 17698     MOVE ZEROS                  TO PI-PROOF-DATE.
 17699     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17700                                    PI-REM-BEN-AMT
 17701                                    PI-MO-BEN-AMT
 17702                                    pi-ah-term.
 17703
 17704     MOVE LOW-VALUES             TO EL156AI.
 17705     MOVE MAP-NAMEA              TO MAP-NAME.
 17706
 17707* EXEC CICS HANDLE CONDITION
 17708*        NOTFND   (7010-BUILD-MAP)
 17709*    END-EXEC.
 17710*    MOVE '"$I                   ! 8 #00016321' TO DFHEIV0
 17711     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17713     MOVE X'3820233030303136333231' TO DFHEIV0(25:11)
 17714     CALL 'kxdfhei1' USING DFHEIV0
 17715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17716
 17717
 17718     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17719     MOVE '2'                    TO CNTL-REC-TYPE.
 17720     MOVE +0                     TO CNTL-SEQ-NO.
 17721     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17722
 17723
 17724* EXEC CICS READ
 17725*         DATASET  ('ELCNTL')
 17726*         SET      (ADDRESS OF CONTROL-FILE)
 17727*         RIDFLD   (ELCNTL-KEY)
 17728*    END-EXEC.
 17729     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 343
* EL156.cbl
 17730*    MOVE '&"S        E          (   #00016330' TO DFHEIV0
 17731     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17733     MOVE X'2020233030303136333330' TO DFHEIV0(25:11)
 17734     CALL 'kxdfhei1' USING DFHEIV0,
 17735           DFHEIV1,
 17736           DFHEIV20,
 17737           DFHEIV99,
 17738           ELCNTL-KEY,
 17739           DFHEIV99,
 17740           DFHEIV99,
 17741           DFHEIV99
 17742     SET ADDRESS OF CONTROL-FILE TO
 17743         DFHEIV20
 17744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17745
 17746
 17747     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17748
 17749     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17750         MOVE AL-UANON      TO SURVYYNA
 17751     END-IF.
 17752
 17753
 17754     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17755     MOVE '1'                    TO CNTL-REC-TYPE.
 17756     MOVE SPACES                 TO CNTL-ACCESS.
 17757     MOVE +0                     TO CNTL-SEQ-NO.
 17758
 17759
 17760* EXEC CICS READ
 17761*         DATASET  ('ELCNTL')
 17762*         SET      (ADDRESS OF CONTROL-FILE)
 17763*         RIDFLD   (ELCNTL-KEY)
 17764*    END-EXEC.
 17765     MOVE 'ELCNTL' TO DFHEIV1
 17766*    MOVE '&"S        E          (   #00016348' TO DFHEIV0
 17767     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17769     MOVE X'2020233030303136333438' TO DFHEIV0(25:11)
 17770     CALL 'kxdfhei1' USING DFHEIV0,
 17771           DFHEIV1,
 17772           DFHEIV20,
 17773           DFHEIV99,
 17774           ELCNTL-KEY,
 17775           DFHEIV99,
 17776           DFHEIV99,
 17777           DFHEIV99
 17778     SET ADDRESS OF CONTROL-FILE TO
 17779         DFHEIV20
 17780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17781
 17782
 17783     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17784
 17785 7010-BUILD-MAP.
 17786
 17787
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 344
* EL156.cbl
 17788* EXEC CICS HANDLE CONDITION
 17789*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17790*    END-EXEC.
 17791*    MOVE '"$I                   ! 9 #00016358' TO DFHEIV0
 17792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17794     MOVE X'3920233030303136333538' TO DFHEIV0(25:11)
 17795     CALL 'kxdfhei1' USING DFHEIV0
 17796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17797
 17798
 17799     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17800     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17801     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17802     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17803     MOVE 'MSTR'                 TO FILE-SWITCH.
 17804
 17805     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17806
 17807     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17808     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17809     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17810     MOVE CL-CCN                 TO PI-SV-CCN.
 17811
 17812     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17813     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17814     MOVE CL-CLAIM-NO            TO CLMNOO.
 17815     MOVE CL-CARRIER             TO CARRO.
 17816     MOVE CL-CERT-PRIME          TO CERTNOO.
 17817     MOVE CL-CERT-SFX            TO SUFXO.
 17818
 17819     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17820        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 17821        CONTINUE
 17822     ELSE
 17823        MOVE AL-SADOF            TO ZINTHA
 17824                                    ZINTA
 17825                                    PINTHA
 17826                                    PINTA
 17827     END-IF
 17828     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17829     EVALUATE TRUE
 17830     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17831         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17832     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17833         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17834
 17835     WHEN CL-CLAIM-TYPE = 'I'
 17836         MOVE '  IU  '           TO CLMTYPO
 17837     WHEN CL-CLAIM-TYPE = 'G'
 17838         MOVE ' GAP  '           TO CLMTYPO
 17839     WHEN CL-CLAIM-TYPE = 'F'
 17840         MOVE ' FMLA '           TO CLMTYPO
 17841     WHEN CL-CLAIM-TYPE = 'O'
 17842         MOVE ' OTH '           TO CLMTYPO
 17843     END-EVALUATE.
 17844     IF CL-CLAIM-TYPE = 'O'
 17845        MOVE 'S' TO EOBYNO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 345
* EL156.cbl
 17846                    PI-PRINT-EOB-YN
 17847                    WS-PRINT-EOB-YN
 17848     END-IF
 17849     IF CLAIM-IS-OPEN
 17850         MOVE ' OPEN'            TO CLMSTATO
 17851     ELSE
 17852         MOVE 'CLOSED'           TO CLMSTATO.
 17853
 17854     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17855
 17856     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17857         MOVE SPACES             TO  PCERTNOO
 17858                                     PSUFXO
 17859                                     PRIMHDGO
 17860                                     SEQUO
 17861         MOVE AL-SADOF           TO  PCERTNOA
 17862                                     PSUFXA
 17863                                     PRIMHDGA
 17864                                     SEQUA
 17865     ELSE
 17866         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17867         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17868         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17869         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17870         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17871         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17872         MOVE AL-SANON               TO  PCERTNOA
 17873                                         PSUFXA
 17874                                         PRIMHDGA
 17875         MOVE AL-SABON               TO  SEQUA.
 17876
 17877     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17878
 17879     IF CL-NO-OF-PMTS-MADE = 0 AND
 17880        CL-TOTAL-PAID-AMT = 0
 17881         NEXT SENTENCE
 17882     ELSE
 17883         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17884             IF NOT PI-USES-PAID-TO
 17885                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17886                 MOVE ' '                 TO DC-OPTION-CODE
 17887                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17888                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17889             ELSE
 17890                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17891                 MOVE '6'                 TO DC-OPTION-CODE
 17892                 MOVE +1                  TO DC-ELAPSED-DAYS
 17893                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17894                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17895                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17896
 17897     IF MAP-NAME = 'EL156A'
 17898        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17899           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17900             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17901           end-if
 17902        end-if
 17903     end-if
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 346
* EL156.cbl
 17904     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17905         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17906         MOVE ' '                TO DC-OPTION-CODE
 17907         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17908         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17909
 17910     IF CL-INCURRED-DT NOT = LOW-VALUES
 17911         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17912         MOVE ' '                TO DC-OPTION-CODE
 17913         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17914         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17915
 17916     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17917
 17918     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17919         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17920         MOVE ' '                TO DC-OPTION-CODE
 17921         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17922         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17923
 17924     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17925         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17926         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17927     ELSE
 17928         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17929         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17930
 17931     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17932     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17933     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17934     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17935                                    PI-GROUPING.
 17936     MOVE CL-CERT-STATE          TO CERT-STATE
 17937                                    PI-STATE.
 17938     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17939                                    PI-ACCOUNT.
 17940     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17941     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17942     MOVE 'CERT'                 TO FILE-SWITCH.
 17943
 17944     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17945     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17946        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17947        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17948            MOVE 'N' TO PI-JOINT-INSURED-IND
 17949     ELSE
 17950            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17951     END-IF.
 17952
 17953     perform 7975-read-acct      thru 7975-exit
 17954     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17955     MOVE PI-STATE               TO WS-ST-ACCESS.
 17956     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17957     MOVE '3'                    TO CNTL-REC-TYPE.
 17958     MOVE +0                     TO CNTL-SEQ-NO.
 17959     MOVE 'STAT'                 TO FILE-SWITCH.
 17960
 17961     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 347
* EL156.cbl
 17962
 17963     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17964     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17965
 17966     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17967        GO TO 7020-BYPASS-BENEFIT.
 17968
 17969     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17970     MOVE '4'                    TO CNTL-REC-TYPE.
 17971     MOVE +0                     TO CNTL-SEQ-NO.
 17972     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17973     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17974     MOVE 'BENE'                 TO FILE-SWITCH.
 17975
 17976     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17977
 17978     IF NO-BENEFIT-FOUND
 17979        GO TO 7020-BYPASS-BENEFIT.
 17980
 17981     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17982     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17983     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17984
 17985 7020-BYPASS-BENEFIT.
 17986
 17987*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17988*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17989*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17990
 17991     move zeros                  to PI-MAX-BENEFIT-AMT
 17992     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17993     move cm-ah-orig-term        to pi-ah-term
 17994     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17995     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17996          'G' and 'F'
 17997         GO TO 7021-GO-TO-LIFE.
 17998
 17999     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 18000        and (acct-found)
 18001        AND (PI-DCC-PRODUCT-CODE not = '   ')
 18002        PERFORM 0900-GET-DDF-limits
 18003                                 THRU 0900-EXIT
 18004        IF PDEF-FOUND
 18005           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 18006              (P1 > +8)
 18007              OR (PD-PROD-CODE (P1) = cl-claim-type)
 18008           END-PERFORM
 18009           IF P1 < +9
 18010              if pd-ben-pct (p1) not numeric
 18011                 move zeros      to pd-ben-pct (p1)
 18012              end-if
 18013              if pd-ben-pct (p1) = zeros
 18014                 move +1         to ws-work-ben-pct
 18015              else
 18016                 move pd-ben-pct (p1)
 18017                                 to ws-work-ben-pct
 18018              end-if
 18019              compute cm-ah-benefit-amt =
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 348
* EL156.cbl
 18020                 cm-ah-benefit-amt * ws-work-ben-pct
 18021              move pd-max-amt (p1) to pi-max-benefit-amt
 18022           END-IF
 18023        END-IF
 18024     end-if
 18025     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 18026     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 18027     if (pi-max-benefit-amt not = zeros)
 18028        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 18029        move pi-max-benefit-amt  to beneo
 18030     else
 18031        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 18032     end-if
 18033     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 18034     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 18035                                    CP-ORIGINAL-TERM.
 18036     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 18037
 18038*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18039*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 18040*    ELSE
 18041         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 18042
 18043     MOVE ' '                    TO DC-OPTION-CODE.
 18044     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18045     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 18046
 18047     IF PI-COMPANY-ID = 'DMD'
 18048         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 18049         GO TO 7023-BYPASS-REMAINING-TERM.
 18050
 18051     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 18052     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 18053     GO TO 7022-AROUND-LIFE.
 18054
 18055 7021-GO-TO-LIFE.
 18056
 18057     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 18058     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 18059     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 18060                                    CP-ORIGINAL-TERM.
 18061     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 18062     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 18063     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 18064     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 18065
 18066     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18067         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 18068     ELSE
 18069         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 18070
 18071     MOVE ' '                    TO DC-OPTION-CODE.
 18072     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18073     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 18074
 18075 7022-AROUND-LIFE.
 18076
 18077     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 349
* EL156.cbl
 18078     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 18079     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 18080     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 18081     MOVE '4'                    TO CP-REM-TERM-METHOD.
 18082     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 18083     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 18084
 18085     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 18086
 18087     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 18088        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 18089           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 18090
 18091     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18092        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 18093           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 18094
 18095 7023-BYPASS-REMAINING-TERM.
 18096     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18097       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 18098          MOVE ZEROS                  TO BENEO
 18099       ELSE
 18100          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 18101          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 18102          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 18103          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 18104          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 18105          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 18106          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 18107          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 18108          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 18109          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 18110          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 18111          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 18112          IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 18113             AND (PI-DCC-PRODUCT-CODE not = '   ')
 18114             PERFORM 0900-GET-DDF-limits
 18115                                 THRU 0900-EXIT
 18116             IF PDEF-FOUND
 18117                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 18118                   (P1 > +8)
 18119                   OR (PD-PROD-CODE (P1) = 'L')
 18120                END-PERFORM
 18121                IF P1 < +9
 18122                   MOVE PD-MAX-AMT (P1)
 18123                                 TO CP-R-MAX-TOT-BEN
 18124                END-IF
 18125             END-IF
 18126          END-IF
 18127
 18128* EXEC CICS LINK
 18129*            PROGRAM  (LINK-REMAMT)
 18130*            COMMAREA (CALCULATION-PASS-AREA)
 18131*            LENGTH   (CP-COMM-LENGTH)
 18132*         END-EXEC
 18133*    MOVE '."C                   (   #00016690' TO DFHEIV0
 18134     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18135     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 350
* EL156.cbl
 18136     MOVE X'2020233030303136363930' TO DFHEIV0(25:11)
 18137     CALL 'kxdfhei1' USING DFHEIV0,
 18138           LINK-REMAMT,
 18139           CALCULATION-PASS-AREA,
 18140           CP-COMM-LENGTH,
 18141           DFHEIV99,
 18142           DFHEIV99,
 18143           DFHEIV99,
 18144           DFHEIV99
 18145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18146          MOVE CP-REMAINING-AMT       TO BENEO
 18147       end-if
 18148     end-if
 18149     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18150     MOVE +95                    TO TRLR-SEQ-NO
 18151
 18152* EXEC CICS READ
 18153*       DATASET  ('ELTRLR')
 18154*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18155*       RIDFLD   (ELTRLR-KEY)
 18156*       RESP     (WS-RESPONSE)
 18157*    END-EXEC
 18158     MOVE 'ELTRLR' TO DFHEIV1
 18159*    MOVE '&"S        E          (  N#00016700' TO DFHEIV0
 18160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18162     MOVE X'204E233030303136373030' TO DFHEIV0(25:11)
 18163     CALL 'kxdfhei1' USING DFHEIV0,
 18164           DFHEIV1,
 18165           DFHEIV20,
 18166           DFHEIV99,
 18167           ELTRLR-KEY,
 18168           DFHEIV99,
 18169           DFHEIV99,
 18170           DFHEIV99
 18171     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18172         DFHEIV20
 18173     MOVE EIBRESP  TO WS-RESPONSE
 18174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18175
 18176     if ws-resp-normal
 18177        perform varying s1 from +1 by +1 until
 18178           at-note-error-no (s1) = spaces
 18179           move at-note-error-no (s1)
 18180                                 to emi-error
 18181           if at-note-error-no (s1) = '1653'
 18182              evaluate true
 18183                 when cl-claim-type = 'L'
 18184                    move '  LF  '
 18185                                 to emi-claim-type
 18186                 when cl-claim-type = 'I'
 18187                    move '  IU  '
 18188                                 to emi-claim-type
 18189                 when cl-claim-type = 'F'
 18190                    move ' FMLA '
 18191                                 to emi-claim-type
 18192                 when cl-claim-type = 'O'
 18193                    move ' OTH '
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 351
* EL156.cbl
 18194                                 to emi-claim-type
 18195                 when other
 18196                    move '  AH  '
 18197                                 to emi-claim-type
 18198              end-evaluate
 18199           end-if
 18200           PERFORM 9900-ERROR-FORMAT
 18201                                 THRU 9900-EXIT
 18202        end-perform
 18203     end-if
 18204    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18205         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 18206            WS-LF-COVERAGE-TYPE = 'P'
 18207             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 18208                                        CM-LF-ITD-DEATH-AMT
 18209             MOVE WS-REMAINING-AMT  TO  BENEO.
 18210
 18211     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 18212     MOVE BENEO                  TO PI-REM-BEN-AMT.
 18213     MOVE WS-TERMS               TO TERMSO.
 18214
 18215     IF WS-STATUS = '6' OR '7' OR '8'
 18216         MOVE AL-SABOF           TO CRTSTATA.
 18217
 18218     IF WS-STATUS = '1' OR '4'
 18219        IF CP-REMAINING-TERM-3 = ZEROS
 18220           MOVE 'EXPIRED'        TO CRTSTATO
 18221        ELSE
 18222           MOVE 'ACTIVE  '       TO CRTSTATO.
 18223
 18224     IF WS-STATUS = '2'
 18225         MOVE 'PEND    '         TO CRTSTATO.
 18226
 18227     IF WS-STATUS = '3'
 18228         MOVE 'RESTORE '         TO CRTSTATO.
 18229
 18230     IF WS-STATUS = '5'
 18231         MOVE 'REISSUE '         TO CRTSTATO.
 18232
 18233     IF WS-STATUS = '6'
 18234         MOVE 'LMP DIS'          TO CRTSTATO.
 18235
 18236     IF WS-STATUS = '7'
 18237         MOVE 'DEATH'            TO CRTSTATO.
 18238
 18239     IF WS-STATUS = '8'
 18240         MOVE 'CANCEL'           TO CRTSTATO.
 18241
 18242     IF WS-STATUS = '9'
 18243         MOVE 'RE-ONLY '         TO CRTSTATO.
 18244
 18245     IF WS-STATUS = 'V'
 18246         MOVE 'VOID  '           TO CRTSTATO.
 18247
 18248     IF WS-STATUS = 'D'
 18249         MOVE 'DECLINE '         TO CRTSTATO.
 18250
 18251     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 352
* EL156.cbl
 18252         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18253         MOVE '5'                TO CNTL-REC-TYPE
 18254     ELSE
 18255         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18256         MOVE '4'                TO CNTL-REC-TYPE.
 18257
 18258     MOVE '** NONE **'           TO COVERO.
 18259     MOVE AL-SABON               TO COVERA.
 18260
 18261     IF PI-COMPANY-ID = 'CVL'
 18262         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18263             MOVE CM-BENEFICIARY TO LOANNOO
 18264             MOVE AL-UANON       TO LOANNOA.
 18265
 18266     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 18267        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18268        MOVE +91                 TO  TRLR-SEQ-NO
 18269
 18270* EXEC CICS READ
 18271*           DATASET  ('ELTRLR')
 18272*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18273*           RIDFLD   (ELTRLR-KEY)
 18274*           RESP     (WS-RESPONSE)
 18275*       END-EXEC
 18276     MOVE 'ELTRLR' TO DFHEIV1
 18277*    MOVE '&"S        E          (  N#00016800' TO DFHEIV0
 18278     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18279     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18280     MOVE X'204E233030303136383030' TO DFHEIV0(25:11)
 18281     CALL 'kxdfhei1' USING DFHEIV0,
 18282           DFHEIV1,
 18283           DFHEIV20,
 18284           DFHEIV99,
 18285           ELTRLR-KEY,
 18286           DFHEIV99,
 18287           DFHEIV99,
 18288           DFHEIV99
 18289     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18290         DFHEIV20
 18291     MOVE EIBRESP  TO WS-RESPONSE
 18292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18293
 18294        IF WS-RESP-NORMAL
 18295           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18296        ELSE
 18297           MOVE SPACES           TO  LOANNOO
 18298        END-IF
 18299*052506
 18300*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18301*052506
 18302     END-IF
 18303
 18304     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18305        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18306
 18307     IF WS-BEN-CD = ZEROS
 18308         GO TO 7050-SHOW-CONTINUE.
 18309
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 353
* EL156.cbl
 18310     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18311     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18312     MOVE +0                     TO CNTL-SEQ-NO.
 18313     MOVE 'BENE'                 TO FILE-SWITCH.
 18314
 18315     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18316     IF BENEFIT-FOUND
 18317        MOVE CF-JOINT-INDICATOR (SUB-1)
 18318                                 TO PI-JOINT-COV-IND
 18319                                    PI-RB-JOINT-COV-IND
 18320        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18321                                 TO COVERO
 18322        MOVE AL-SANON            TO COVERA
 18323     END-IF
 18324     if (cntl-rec-type = '4')   *> Life claim
 18325        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18326        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18327        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18328        MOVE '5'              TO CNTL-REC-TYPE
 18329        MOVE WS-ACCESS        TO CNTL-ACCESS
 18330        MOVE +0               TO CNTL-SEQ-NO
 18331        MOVE 'BENE'           TO FILE-SWITCH
 18332        PERFORM 7200-FIND-BENEFIT
 18333                              THRU 7200-EXIT
 18334        IF (BENEFIT-FOUND)
 18335           and (pi-rb-joint-cov-ind) not = 'J'
 18336           MOVE CF-JOINT-INDICATOR (SUB-1)
 18337                              TO PI-rb-JOINT-COV-IND
 18338        end-if
 18339     end-if
 18340     .
 18341 7050-SHOW-CONTINUE.
 18342
 18343     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18344        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18345            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18346     END-IF
 18347
 18348     IF PI-COMPANY-ID = 'DMD'
 18349         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18350
 18351     MOVE -1                     TO PMTTYPEL.
 18352     GO TO 8100-SEND-INITIAL-MAP.
 18353
 18354 7100-SHOW-RECORD-NOT-FOUND.
 18355     IF FILE-SWITCH = 'MSTR'
 18356         MOVE ER-0204            TO EMI-ERROR.
 18357
 18358     IF FILE-SWITCH = 'CERT'
 18359         MOVE ER-0206            TO EMI-ERROR.
 18360
 18361     IF FILE-SWITCH = 'STAT'
 18362         MOVE ER-0149            TO EMI-ERROR.
 18363
 18364     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18365
 18366     MOVE -1                     TO PMTTYPEL.
 18367     GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 354
* EL156.cbl
 18368
 18369     .
 18370 7110-BUILD-PMT-TRLR.
 18371     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18372     MOVE +51                    TO TRLR-SEQ-NO
 18373
 18374* EXEC CICS READ
 18375*        DATASET  ('ELTRLR')
 18376*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18377*        RIDFLD   (ELTRLR-KEY)
 18378*        RESP     (WS-RESPONSE)
 18379*    END-EXEC
 18380     MOVE 'ELTRLR' TO DFHEIV1
 18381*    MOVE '&"S        E          (  N#00016886' TO DFHEIV0
 18382     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18384     MOVE X'204E233030303136383836' TO DFHEIV0(25:11)
 18385     CALL 'kxdfhei1' USING DFHEIV0,
 18386           DFHEIV1,
 18387           DFHEIV20,
 18388           DFHEIV99,
 18389           ELTRLR-KEY,
 18390           DFHEIV99,
 18391           DFHEIV99,
 18392           DFHEIV99
 18393     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18394         DFHEIV20
 18395     MOVE EIBRESP  TO WS-RESPONSE
 18396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18397     IF WS-RESP-NORMAL
 18398        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18399     END-IF
 18400     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18401
 18402* EXEC CICS GETMAIN
 18403*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18404*         LENGTH    (200)
 18405*         INITIMG   (GETMAIN-SPACE)
 18406*     END-EXEC
 18407     MOVE 200
 18408       TO DFHEIV11
 18409*    MOVE ',"IL                  $   #00016896' TO DFHEIV0
 18410     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18412     MOVE X'2020233030303136383936' TO DFHEIV0(25:11)
 18413     CALL 'kxdfhei1' USING DFHEIV0,
 18414           DFHEIV20,
 18415           DFHEIV11,
 18416           GETMAIN-SPACE
 18417     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18418         DFHEIV20
 18419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18420     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18421                                    AT-PREV-PAID-THRU-DT
 18422     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18423     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18424     MOVE 'AT'                   TO AT-RECORD-ID
 18425     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 355
* EL156.cbl
 18426     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18427     MOVE '2'                    TO AT-TRAILER-TYPE
 18428     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18429                                    AT-PAYMENT-LAST-MAINT-DT
 18430     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18431                                    AT-PAYMENT-LAST-UPDATED-BY
 18432     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18433     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18434     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18435     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 18436     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18437     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18438     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18439     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18440     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18441     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18442     if pi-int-to-rem-borr = 'Y'
 18443        move 'Q1'                to at-payee-type-cd
 18444     else
 18445        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18446     end-if
 18447     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18448     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18449     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18450     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18451     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18452                                    AT-TO-BE-WRITTEN-DT
 18453     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18454                                    AT-CHECK-QUE-SEQUENCE
 18455                                    AT-ADDL-RESERVE
 18456     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18457                                    AT-VOID-SELECT-DT
 18458                                    AT-VOID-ACCEPT-DT
 18459                                    AT-VOID-DT
 18460                                    AT-PMT-PROOF-DT
 18461                                    AT-INT-PMT-SELECT-DT
 18462     MOVE ZEROS                  TO AT-DAILY-RATE
 18463                                    AT-ELIMINATION-DAYS
 18464     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18465*    EXEC CICS HANDLE CONDITION
 18466*        DUPREC    (7120-DUPREC)
 18467*    END-EXEC
 18468     .
 18469 7115-WRITE-INT-TRLR.
 18470
 18471* EXEC CICS WRITE
 18472*         DATASET       ('ELTRLR')
 18473*         FROM          (ACTIVITY-TRAILERS)
 18474*         RIDFLD        (AT-CONTROL-PRIMARY)
 18475*         RESP          (WS-RESPONSE)
 18476*     END-EXEC
 18477     MOVE LENGTH OF
 18478      ACTIVITY-TRAILERS
 18479       TO DFHEIV11
 18480     MOVE 'ELTRLR' TO DFHEIV1
 18481*    MOVE '&$ L                  ''  N#00016951' TO DFHEIV0
 18482     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18483     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 356
* EL156.cbl
 18484     MOVE X'204E233030303136393531' TO DFHEIV0(25:11)
 18485     CALL 'kxdfhei1' USING DFHEIV0,
 18486           DFHEIV1,
 18487           ACTIVITY-TRAILERS,
 18488           DFHEIV11,
 18489           AT-CONTROL-PRIMARY,
 18490           DFHEIV99,
 18491           DFHEIV99
 18492     MOVE EIBRESP  TO WS-RESPONSE
 18493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18494      IF WS-RESP-DUPREC
 18495         GO TO 7120-DUPREC
 18496      END-IF
 18497     GO TO 7130-EXIT
 18498     .
 18499 7120-DUPREC.
 18500     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18501     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18502     GO TO 7115-WRITE-INT-TRLR
 18503     .
 18504 7130-EXIT.
 18505      EXIT.
 18506 7140-BUILD-NOTE-TRLR.
 18507
 18508
 18509* EXEC CICS GETMAIN
 18510*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18511*         LENGTH    (200)
 18512*         INITIMG   (GETMAIN-SPACE)
 18513*     END-EXEC
 18514     MOVE 200
 18515       TO DFHEIV11
 18516*    MOVE ',"IL                  $   #00016971' TO DFHEIV0
 18517     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18518     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18519     MOVE X'2020233030303136393731' TO DFHEIV0(25:11)
 18520     CALL 'kxdfhei1' USING DFHEIV0,
 18521           DFHEIV20,
 18522           DFHEIV11,
 18523           GETMAIN-SPACE
 18524     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18525         DFHEIV20
 18526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18527     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18528     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18529     MOVE 'AT'                   TO AT-RECORD-ID
 18530     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18531     MOVE '6'                    TO AT-TRAILER-TYPE
 18532     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18533                                    AT-GEN-INFO-LAST-MAINT-DT
 18534     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18535                                    AT-GEN-INFO-LAST-UPDATED-BY
 18536     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18537     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18538     .
 18539 7150-WRITE.
 18540
 18541* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 357
* EL156.cbl
 18542*        DUPREC    (7160-DUPREC)
 18543*    END-EXEC
 18544*    MOVE '"$%                   ! : #00016989' TO DFHEIV0
 18545     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18547     MOVE X'3A20233030303136393839' TO DFHEIV0(25:11)
 18548     CALL 'kxdfhei1' USING DFHEIV0
 18549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18550
 18551* EXEC CICS WRITE
 18552*         DATASET     ('ELTRLR')
 18553*         FROM        (ACTIVITY-TRAILERS)
 18554*         RIDFLD      (AT-CONTROL-PRIMARY)
 18555*         RESP        (WS-RESPONSE)
 18556*     END-EXEC
 18557     MOVE LENGTH OF
 18558      ACTIVITY-TRAILERS
 18559       TO DFHEIV11
 18560     MOVE 'ELTRLR' TO DFHEIV1
 18561*    MOVE '&$ L                  ''  N#00016992' TO DFHEIV0
 18562     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18563     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18564     MOVE X'204E233030303136393932' TO DFHEIV0(25:11)
 18565     CALL 'kxdfhei1' USING DFHEIV0,
 18566           DFHEIV1,
 18567           ACTIVITY-TRAILERS,
 18568           DFHEIV11,
 18569           AT-CONTROL-PRIMARY,
 18570           DFHEIV99,
 18571           DFHEIV99
 18572     MOVE EIBRESP  TO WS-RESPONSE
 18573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18574      IF WS-RESP-DUPREC
 18575         GO TO 7160-DUPREC
 18576      END-IF
 18577     GO TO 7170-EXIT
 18578     .
 18579 7160-DUPREC.
 18580     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18581     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18582     GO TO 7150-WRITE
 18583     .
 18584 7170-EXIT.
 18585      EXIT.
 18586
 18587 7180-ADD-CERT-NOTE.
 18588*ADD CERT NOTE FOR SC NP+6
 18589
 18590
 18591* EXEC CICS GETMAIN
 18592*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18593*         LENGTH    (150)
 18594*         INITIMG   (GETMAIN-SPACE)
 18595*     END-EXEC.
 18596     MOVE 150
 18597       TO DFHEIV11
 18598*    MOVE ',"IL                  $   #00017014' TO DFHEIV0
 18599     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 358
* EL156.cbl
 18600     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18601     MOVE X'2020233030303137303134' TO DFHEIV0(25:11)
 18602     CALL 'kxdfhei1' USING DFHEIV0,
 18603           DFHEIV20,
 18604           DFHEIV11,
 18605           GETMAIN-SPACE
 18606     SET ADDRESS OF CERT-NOTE-FILE TO
 18607         DFHEIV20
 18608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18609
 18610
 18611     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18612     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18613     MOVE +1                     TO WRK-NOTE-SEQ.
 18614     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18615     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18616     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18617     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18618     MOVE CL-CERT-STATE          TO CZ-STATE.
 18619     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18620     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18621     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18622     MOVE '2'                    TO CZ-RECORD-TYPE.
 18623     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18624     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18625     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18626     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18627     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18628     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18629     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18630     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18631     IF PI-COMPANY-ID = 'AHL'
 18632        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18633           CONTINUE
 18634        ELSE
 18635           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18636              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18637           ELSE
 18638              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18639           END-IF
 18640        END-IF
 18641     END-IF
 18642     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18643     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18644
 18645 7181-WRITE.
 18646
 18647
 18648* EXEC CICS WRITE
 18649*         DATASET     ('ERCNOT')
 18650*         FROM        (CERT-NOTE-FILE)
 18651*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18652*         RESP        (WS-RESPONSE)
 18653*    END-EXEC.
 18654     MOVE LENGTH OF
 18655      CERT-NOTE-FILE
 18656       TO DFHEIV11
 18657     MOVE 'ERCNOT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 359
* EL156.cbl
 18658*    MOVE '&$ L                  ''  N#00017056' TO DFHEIV0
 18659     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18660     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18661     MOVE X'204E233030303137303536' TO DFHEIV0(25:11)
 18662     CALL 'kxdfhei1' USING DFHEIV0,
 18663           DFHEIV1,
 18664           CERT-NOTE-FILE,
 18665           DFHEIV11,
 18666           CZ-CONTROL-PRIMARY,
 18667           DFHEIV99,
 18668           DFHEIV99
 18669     MOVE EIBRESP  TO WS-RESPONSE
 18670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18671
 18672
 18673     IF WS-RESP-DUPREC
 18674         GO TO 7182-DUPREC
 18675     END-IF.
 18676
 18677     SET CERT-NOTE-ADDED TO TRUE.
 18678
 18679     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18680         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18681     END-IF.
 18682
 18683     GO TO 7189-EXIT.
 18684
 18685 7182-DUPREC.
 18686
 18687     ADD +1                      TO  WRK-NOTE-SEQ.
 18688     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18689     GO TO 7181-WRITE.
 18690
 18691 7189-EXIT.
 18692      EXIT.
 18693
 18694 7190-ADD-ORIG-NOTE.
 18695
 18696
 18697* EXEC CICS GETMAIN
 18698*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18699*         LENGTH    (150)
 18700*         INITIMG   (GETMAIN-SPACE)
 18701*     END-EXEC.
 18702     MOVE 150
 18703       TO DFHEIV11
 18704*    MOVE ',"IL                  $   #00017086' TO DFHEIV0
 18705     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18706     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18707     MOVE X'2020233030303137303836' TO DFHEIV0(25:11)
 18708     CALL 'kxdfhei1' USING DFHEIV0,
 18709           DFHEIV20,
 18710           DFHEIV11,
 18711           GETMAIN-SPACE
 18712     SET ADDRESS OF CERT-NOTE-FILE TO
 18713         DFHEIV20
 18714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18715
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 360
* EL156.cbl
 18716
 18717     ADD +1                      TO WRK-NOTE-SEQ.
 18718     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18719     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18720     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18721     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18722     MOVE CL-CERT-STATE          TO CZ-STATE.
 18723     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18724     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18725     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18726     MOVE '2'                    TO CZ-RECORD-TYPE.
 18727     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18728     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18729     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18730     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18731     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18732     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18733
 18734 7191-WRITE.
 18735
 18736
 18737* EXEC CICS WRITE
 18738*         DATASET     ('ERCNOT')
 18739*         FROM        (CERT-NOTE-FILE)
 18740*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18741*         RESP        (WS-RESPONSE)
 18742*    END-EXEC.
 18743     MOVE LENGTH OF
 18744      CERT-NOTE-FILE
 18745       TO DFHEIV11
 18746     MOVE 'ERCNOT' TO DFHEIV1
 18747*    MOVE '&$ L                  ''  N#00017111' TO DFHEIV0
 18748     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18749     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18750     MOVE X'204E233030303137313131' TO DFHEIV0(25:11)
 18751     CALL 'kxdfhei1' USING DFHEIV0,
 18752           DFHEIV1,
 18753           CERT-NOTE-FILE,
 18754           DFHEIV11,
 18755           CZ-CONTROL-PRIMARY,
 18756           DFHEIV99,
 18757           DFHEIV99
 18758     MOVE EIBRESP  TO WS-RESPONSE
 18759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18760
 18761
 18762     IF WS-RESP-DUPREC
 18763         GO TO 7192-DUPREC
 18764     END-IF.
 18765
 18766     GO TO 7199-EXIT.
 18767
 18768 7192-DUPREC.
 18769
 18770     ADD +1                      TO  WRK-NOTE-SEQ.
 18771     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18772     GO TO 7191-WRITE.
 18773
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 361
* EL156.cbl
 18774 7199-EXIT.
 18775      EXIT.
 18776 7200-FIND-BENEFIT.
 18777     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18778
 18779
 18780* EXEC CICS HANDLE CONDITION
 18781*        ENDFILE(7200-EXIT)
 18782*        NOTFND(7200-EXIT)
 18783*    END-EXEC.
 18784*    MOVE '"$''I                  ! ; #00017135' TO DFHEIV0
 18785     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18786     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18787     MOVE X'3B20233030303137313335' TO DFHEIV0(25:11)
 18788     CALL 'kxdfhei1' USING DFHEIV0
 18789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18790
 18791
 18792
 18793* EXEC CICS READ
 18794*        DATASET('ELCNTL')
 18795*        SET(ADDRESS OF CONTROL-FILE)
 18796*        RIDFLD(ELCNTL-KEY)
 18797*        GTEQ
 18798*    END-EXEC.
 18799     MOVE 'ELCNTL' TO DFHEIV1
 18800*    MOVE '&"S        G          (   #00017140' TO DFHEIV0
 18801     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18803     MOVE X'2020233030303137313430' TO DFHEIV0(25:11)
 18804     CALL 'kxdfhei1' USING DFHEIV0,
 18805           DFHEIV1,
 18806           DFHEIV20,
 18807           DFHEIV99,
 18808           ELCNTL-KEY,
 18809           DFHEIV99,
 18810           DFHEIV99,
 18811           DFHEIV99
 18812     SET ADDRESS OF CONTROL-FILE TO
 18813         DFHEIV20
 18814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18815
 18816
 18817     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18818        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18819           GO TO 7200-EXIT.
 18820
 18821     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18822         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18823            ((SUB-1 > 8) OR
 18824            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18825
 18826     IF SUB-1 NOT = 9
 18827         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18828
 18829     GO TO 7200-EXIT.
 18830
 18831 7200-BENEFIT-DUMMY.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 362
* EL156.cbl
 18832
 18833 7200-DUMMY-EXIT.
 18834     EXIT.
 18835
 18836 7200-EXIT.
 18837     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 363
* EL156.cbl
 18839*052506
 18840*052506 7250-FIND-LETTER-TRLR.
 18841*052506     EXEC CICS HANDLE CONDITION
 18842*052506         ENDFILE  (7250-END)
 18843*052506         NOTFND   (7250-END)
 18844*052506     END-EXEC.
 18845*052506
 18846*052506     EXEC CICS STARTBR
 18847*052506         DATASET   ('ELTRLR')
 18848*052506         RIDFLD    (ELTRLR-KEY)
 18849*052506         GTEQ
 18850*052506     END-EXEC.
 18851*052506
 18852*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18853*052506
 18854*052506 7250-FIND-LOOP.
 18855*052506     EXEC CICS READNEXT
 18856*052506         DATASET   ('ELTRLR')
 18857*052506         RIDFLD    (ELTRLR-KEY)
 18858*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18859*052506     END-EXEC.
 18860*052506
 18861*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18862*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18863*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18864*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18865*052506        GO TO 7250-END
 18866*052506     END-IF.
 18867*052506
 18868*052506     IF AT-TRAILER-TYPE NOT = '4'
 18869*052506         GO TO 7250-FIND-LOOP
 18870*052506     END-IF.
 18871*052506
 18872*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18873*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18874*052506     END-IF.
 18875*052506
 18876*052506     GO TO 7250-FIND-LOOP.
 18877*052506
 18878*052506 7250-END.
 18879*052506
 18880*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18881*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18882*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18883*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18884*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18885*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18886*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18887*052506     END-IF.
 18888*052506
 18889*052506     EXEC CICS ENDBR
 18890*052506          DATASET    ('ELTRLR')
 18891*052506     END-EXEC.
 18892*052506
 18893*052506 7250-EXIT.
 18894*052506     EXIT.
 18895*052506     EJECT
 18896*052506
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 364
* EL156.cbl
 18897 7300-CHECK-AUTO-ACTIVITY.
 18898
 18899     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18900         NEXT SENTENCE
 18901     ELSE
 18902         GO TO 7399-EXIT.
 18903
 18904     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18905
 18906     IF WS-ACT-REC-FOUND-SW = 'N'
 18907         GO TO 7399-EXIT.
 18908
 18909     IF PI-ACTIVITY-CODE = 09
 18910         GO TO 7300-CONT-AUTO-ACTIVITY.
 18911
 18912     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18913        (PI-ACTIVITY-CODE = 11)
 18914         GO TO 7300-CONT-AUTO-ACTIVITY.
 18915
 18916     IF PI-PROVISIONAL-IND = 'P'
 18917         IF PI-PMTTYPE = '1'
 18918             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18919                 MOVE 'N'    TO  PI-RESET-SW
 18920                 GO TO 7399-EXIT.
 18921
 18922     IF PI-PMTTYPE = '1'
 18923         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18924             MOVE 'N'        TO  PI-RESET-SW
 18925             GO TO 7399-EXIT.
 18926
 18927     IF PI-PMTTYPE = '2' OR '3'
 18928         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18929             MOVE 'N'        TO  PI-RESET-SW
 18930             GO TO 7399-EXIT.
 18931
 18932     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18933         IF PI-PROVISIONAL-IND = 'P'
 18934             NEXT SENTENCE
 18935         ELSE
 18936             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18937
 18938 7300-CONT-AUTO-ACTIVITY.
 18939
 18940     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18941         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18942         MOVE '4'            TO DC-OPTION-CODE
 18943         MOVE +0             TO DC-ELAPSED-DAYS
 18944                                DC-ELAPSED-MONTHS
 18945         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18946         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18947         IF PI-USES-PAID-TO
 18948             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18949             IF NO-CONVERSION-ERROR
 18950                 MOVE +1     TO DC-ELAPSED-DAYS
 18951                 MOVE +0     TO DC-ELAPSED-MONTHS
 18952                 MOVE '6'    TO DC-OPTION-CODE
 18953                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18954                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 365
* EL156.cbl
 18955                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18956
 18957     IF PI-PFKEY-USED = DFHPF5
 18958         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18959         IF PI-USES-PAID-TO
 18960             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18961             MOVE +1                  TO DC-ELAPSED-DAYS
 18962             MOVE +0                  TO DC-ELAPSED-MONTHS
 18963             MOVE '6'                 TO DC-OPTION-CODE
 18964             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18965             IF NO-CONVERSION-ERROR
 18966                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18967
 18968     IF WS-CHK-THRU-DT < PI-EXP-DT
 18969         NEXT SENTENCE
 18970     ELSE
 18971         MOVE 03                     TO  WS-ACTIVITY-CODE
 18972         GO TO 7390-PROCESS-ACTIVITY.
 18973
 18974     IF PI-PROV-PMT
 18975         MOVE 09                     TO  WS-ACTIVITY-CODE
 18976     ELSE
 18977        IF PI-PMTTYPE = '1'
 18978            MOVE 02                  TO  WS-ACTIVITY-CODE
 18979        ELSE
 18980        IF PI-PMTTYPE = '2' OR '3'
 18981            MOVE 07                  TO  WS-ACTIVITY-CODE
 18982        ELSE
 18983        IF PI-PMTTYPE = '4'
 18984            MOVE 00                  TO  WS-ACTIVITY-CODE
 18985        ELSE
 18986            MOVE 'N'                 TO  PI-RESET-SW
 18987            GO TO 7399-EXIT.
 18988
 18989 7390-PROCESS-ACTIVITY.
 18990
 18991     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18992
 18993 7399-EXIT.
 18994     EXIT.
 18995
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 366
* EL156.cbl
 18997 7400-CHECK-AUTO-ACTIVITY.
 18998
 18999
 19000* EXEC CICS HANDLE CONDITION
 19001*        NOTFND   (7400-NOT-FOUND)
 19002*    END-EXEC.
 19003*    MOVE '"$I                   ! < #00017329' TO DFHEIV0
 19004     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19006     MOVE X'3C20233030303137333239' TO DFHEIV0(25:11)
 19007     CALL 'kxdfhei1' USING DFHEIV0
 19008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19009
 19010
 19011     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 19012     MOVE 'T'                    TO  CNTL-REC-TYPE.
 19013     MOVE SPACES                 TO  CNTL-ACCESS.
 19014     MOVE +0                     TO  CNTL-SEQ-NO.
 19015
 19016
 19017* EXEC CICS READ
 19018*        DATASET   ('ELCNTL')
 19019*        RIDFLD    (ELCNTL-KEY)
 19020*        SET       (ADDRESS OF CONTROL-FILE)
 19021*    END-EXEC.
 19022     MOVE 'ELCNTL' TO DFHEIV1
 19023*    MOVE '&"S        E          (   #00017338' TO DFHEIV0
 19024     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19025     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19026     MOVE X'2020233030303137333338' TO DFHEIV0(25:11)
 19027     CALL 'kxdfhei1' USING DFHEIV0,
 19028           DFHEIV1,
 19029           DFHEIV20,
 19030           DFHEIV99,
 19031           ELCNTL-KEY,
 19032           DFHEIV99,
 19033           DFHEIV99,
 19034           DFHEIV99
 19035     SET ADDRESS OF CONTROL-FILE TO
 19036         DFHEIV20
 19037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19038
 19039
 19040     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 19041     GO TO 7400-EXIT.
 19042
 19043 7400-NOT-FOUND.
 19044     MOVE 'N'                        TO  PI-RESET-SW
 19045                                         WS-LETTER-SW
 19046                                         WS-ACT-REC-FOUND-SW.
 19047
 19048     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19049
 19050 7400-EXIT.
 19051     EXIT.
 19052
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 367
* EL156.cbl
 19054 7450-FORMAT-AUTO-LETTER.
 19055
 19056     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 19057         MOVE 'Y'                    TO PI-RESET-SW
 19058         GO TO 7450-CONTINUE-PROCESS.
 19059
 19060     MOVE PI-ACTIVITY-CODE           TO  SUB.
 19061
 19062     IF SUB > 9
 19063         SUBTRACT 9 FROM SUB
 19064         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 19065     ELSE
 19066         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 19067
 19068 7450-CONTINUE-PROCESS.
 19069
 19070     IF WS-ACTIVITY-CODE = ZEROS
 19071         MOVE 'N'                    TO  WS-LETTER-SW
 19072         GO TO 7450-EXIT.
 19073
 19074     MOVE WS-ACTIVITY-CODE           TO  SUB.
 19075
 19076     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 19077         MOVE 'N'                    TO  PI-RESET-SW
 19078                                         WS-LETTER-SW
 19079         GO TO 7450-EXIT.
 19080
 19081     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 19082         MOVE 'N'                    TO  WS-LETTER-SW
 19083         GO TO 7450-EXIT.
 19084
 19085     MOVE 'Y'                        TO  WS-LETTER-SW.
 19086     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 19087     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 19088
 19089     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 19090
 19091     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 19092         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19093         MOVE '6'                    TO  DC-OPTION-CODE
 19094         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 19095         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19096         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19097         IF NO-CONVERSION-ERROR
 19098             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 19099         ELSE
 19100              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 19101
 19102     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 19103         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19104         MOVE '6'                    TO  DC-OPTION-CODE
 19105         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 19106         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19107         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19108         IF NO-CONVERSION-ERROR
 19109             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 19110         ELSE
 19111             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 368
* EL156.cbl
 19112
 19113 7450-EXIT.
 19114     EXIT.
 19115
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 369
* EL156.cbl
 19117 7500-RESET-AUTO-ACTIVITY.
 19118
 19119     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 19120     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 19121     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 19122     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 19123     MOVE +100                   TO  TRLR-SEQ-NO.
 19124
 19125 7500-STARTBR-TRLR.
 19126
 19127
 19128* EXEC CICS HANDLE CONDITION
 19129*        ENDFILE  (7590-END)
 19130*        NOTFND   (7590-END)
 19131*    END-EXEC.
 19132*    MOVE '"$''I                  ! = #00017431' TO DFHEIV0
 19133     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19135     MOVE X'3D20233030303137343331' TO DFHEIV0(25:11)
 19136     CALL 'kxdfhei1' USING DFHEIV0
 19137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19138
 19139
 19140
 19141* EXEC CICS STARTBR
 19142*        DATASET   ('ELTRLR')
 19143*        RIDFLD    (ELTRLR-KEY)
 19144*        GTEQ
 19145*    END-EXEC.
 19146     MOVE 'ELTRLR' TO DFHEIV1
 19147     MOVE 0
 19148       TO DFHEIV11
 19149*    MOVE '&,         G          &   #00017436' TO DFHEIV0
 19150     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19151     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19152     MOVE X'2020233030303137343336' TO DFHEIV0(25:11)
 19153     CALL 'kxdfhei1' USING DFHEIV0,
 19154           DFHEIV1,
 19155           ELTRLR-KEY,
 19156           DFHEIV99,
 19157           DFHEIV11,
 19158           DFHEIV99
 19159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19160
 19161
 19162     MOVE 'Y'                        TO  WS-BROWSE-SW.
 19163
 19164 7500-READ-NEXT.
 19165
 19166
 19167* EXEC CICS READNEXT
 19168*        DATASET   ('ELTRLR')
 19169*        RIDFLD    (ELTRLR-KEY)
 19170*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19171*    END-EXEC.
 19172     MOVE 'ELTRLR' TO DFHEIV1
 19173     MOVE 0
 19174       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 370
* EL156.cbl
 19175*    MOVE '&.S                   )   #00017446' TO DFHEIV0
 19176     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19177     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19178     MOVE X'2020233030303137343436' TO DFHEIV0(25:11)
 19179     CALL 'kxdfhei1' USING DFHEIV0,
 19180           DFHEIV1,
 19181           DFHEIV20,
 19182           DFHEIV99,
 19183           ELTRLR-KEY,
 19184           DFHEIV99,
 19185           DFHEIV11,
 19186           DFHEIV99,
 19187           DFHEIV99
 19188     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19189         DFHEIV20
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19191
 19192
 19193     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 19194        PI-CARRIER    NOT = TRLR-CARRIER  OR
 19195        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 19196        PI-CERT-NO    NOT = TRLR-CERT-NO
 19197         GO TO 7590-END.
 19198
 19199     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 19200         GO TO 7500-READ-NEXT.
 19201
 19202     IF AT-TRAILER-TYPE NOT = '4'
 19203         GO TO 7500-READ-NEXT.
 19204
 19205     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 19206         GO TO 7500-READ-NEXT.
 19207
 19208     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 19209        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 19210         GO TO 7500-READ-NEXT.
 19211
 19212     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 19213        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 19214        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 19215         GO TO 7500-READ-NEXT.
 19216
 19217     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 19218                         AND
 19219        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 19220                         AND
 19221        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 19222            GO TO 7500-READ-NEXT.
 19223
 19224     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 19225
 19226
 19227* EXEC CICS ENDBR
 19228*        DATASET   ('ELTRLR')
 19229*    END-EXEC.
 19230     MOVE 'ELTRLR' TO DFHEIV1
 19231     MOVE 0
 19232       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 371
* EL156.cbl
 19233*    MOVE '&2                    $   #00017485' TO DFHEIV0
 19234     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19235     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19236     MOVE X'2020233030303137343835' TO DFHEIV0(25:11)
 19237     CALL 'kxdfhei1' USING DFHEIV0,
 19238           DFHEIV1,
 19239           DFHEIV11,
 19240           DFHEIV99
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244     MOVE 'N'                        TO  WS-BROWSE-SW.
 19245
 19246
 19247* EXEC CICS READ
 19248*        DATASET   ('ELTRLR')
 19249*        RIDFLD    (ELTRLR-KEY)
 19250*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19251*        UPDATE
 19252*    END-EXEC.
 19253     MOVE 'ELTRLR' TO DFHEIV1
 19254*    MOVE '&"S        EU         (   #00017491' TO DFHEIV0
 19255     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19256     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19257     MOVE X'2020233030303137343931' TO DFHEIV0(25:11)
 19258     CALL 'kxdfhei1' USING DFHEIV0,
 19259           DFHEIV1,
 19260           DFHEIV20,
 19261           DFHEIV99,
 19262           ELTRLR-KEY,
 19263           DFHEIV99,
 19264           DFHEIV99,
 19265           DFHEIV99
 19266     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19267         DFHEIV20
 19268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19269
 19270
 19271     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19272
 19273     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19274         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19275     ELSE
 19276         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19277             NEXT SENTENCE
 19278         ELSE
 19279             GO TO 7500-REWRITE-TRLR.
 19280
 19281     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19282
 19283     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19284     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19285     MOVE '1'                        TO  ARCH-REC-TYPE.
 19286     MOVE +0                         TO  ARCH-SEQ.
 19287
 19288     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19289
 19290 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 372
* EL156.cbl
 19291
 19292
 19293* EXEC CICS REWRITE
 19294*        DATASET   ('ELTRLR')
 19295*        FROM      (ACTIVITY-TRAILERS)
 19296*    END-EXEC.
 19297     MOVE LENGTH OF
 19298      ACTIVITY-TRAILERS
 19299       TO DFHEIV11
 19300     MOVE 'ELTRLR' TO DFHEIV1
 19301*    MOVE '&& L                  %   #00017519' TO DFHEIV0
 19302     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19303     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19304     MOVE X'2020233030303137353139' TO DFHEIV0(25:11)
 19305     CALL 'kxdfhei1' USING DFHEIV0,
 19306           DFHEIV1,
 19307           ACTIVITY-TRAILERS,
 19308           DFHEIV11,
 19309           DFHEIV99
 19310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19311
 19312
 19313     GO TO 7500-STARTBR-TRLR.
 19314
 19315 7590-END.
 19316
 19317     IF WS-BROWSE-SW = 'Y'
 19318         MOVE 'N'                    TO  WS-BROWSE-SW
 19319
 19320* EXEC CICS ENDBR
 19321*            DATASET   ('ELTRLR')
 19322*        END-EXEC.
 19323     MOVE 'ELTRLR' TO DFHEIV1
 19324     MOVE 0
 19325       TO DFHEIV11
 19326*    MOVE '&2                    $   #00017530' TO DFHEIV0
 19327     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19328     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19329     MOVE X'2020233030303137353330' TO DFHEIV0(25:11)
 19330     CALL 'kxdfhei1' USING DFHEIV0,
 19331           DFHEIV1,
 19332           DFHEIV11,
 19333           DFHEIV99
 19334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19335
 19336
 19337 7599-EXIT.
 19338     EXIT.
 19339
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 373
* EL156.cbl
 19341 7600-READ-ARCH-UPDATE.
 19342
 19343
 19344* EXEC CICS HANDLE CONDITION
 19345*        NOTFND   (7699-EXIT)
 19346*    END-EXEC.
 19347*    MOVE '"$I                   ! > #00017540' TO DFHEIV0
 19348     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19350     MOVE X'3E20233030303137353430' TO DFHEIV0(25:11)
 19351     CALL 'kxdfhei1' USING DFHEIV0
 19352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19353
 19354
 19355
 19356* EXEC CICS READ
 19357*        DATASET   ('ELARCH')
 19358*        RIDFLD    (ELARCH-KEY)
 19359*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19360*        UPDATE
 19361*    END-EXEC.
 19362     MOVE 'ELARCH' TO DFHEIV1
 19363*    MOVE '&"S        EU         (   #00017544' TO DFHEIV0
 19364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19365     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19366     MOVE X'2020233030303137353434' TO DFHEIV0(25:11)
 19367     CALL 'kxdfhei1' USING DFHEIV0,
 19368           DFHEIV1,
 19369           DFHEIV20,
 19370           DFHEIV99,
 19371           ELARCH-KEY,
 19372           DFHEIV99,
 19373           DFHEIV99,
 19374           DFHEIV99
 19375     SET ADDRESS OF LETTER-ARCHIVE TO
 19376         DFHEIV20
 19377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19378
 19379
 19380     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19381
 19382
 19383* EXEC CICS REWRITE
 19384*        DATASET   ('ELARCH')
 19385*        FROM      (LETTER-ARCHIVE)
 19386*    END-EXEC.
 19387     MOVE LENGTH OF
 19388      LETTER-ARCHIVE
 19389       TO DFHEIV11
 19390     MOVE 'ELARCH' TO DFHEIV1
 19391*    MOVE '&& L                  %   #00017553' TO DFHEIV0
 19392     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19393     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19394     MOVE X'2020233030303137353533' TO DFHEIV0(25:11)
 19395     CALL 'kxdfhei1' USING DFHEIV0,
 19396           DFHEIV1,
 19397           LETTER-ARCHIVE,
 19398           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 374
* EL156.cbl
 19399           DFHEIV99
 19400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19401
 19402
 19403 7699-EXIT.
 19404     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 375
* EL156.cbl
 19406 7700-GET-DCT.
 19407
 19408     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19409     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19410     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19411     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19412                                    PI-MAX-BENEFIT-AMT
 19413                                    PI-MAX-BENEFIT-PYMT
 19414                                    PI-MIN-PAYMENT-AMT
 19415                                    PI-TIME-OF-LOSS-BAL.
 19416
 19417
 19418* EXEC CICS HANDLE CONDITION
 19419*         NOTFND (5300-NOTE-NOT-FOUND)
 19420*     END-EXEC.
 19421*    MOVE '"$I                   ! ? #00017572' TO DFHEIV0
 19422     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19424     MOVE X'3F20233030303137353732' TO DFHEIV0(25:11)
 19425     CALL 'kxdfhei1' USING DFHEIV0
 19426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19427
 19428
 19429
 19430* EXEC CICS READ
 19431*         DATASET('ERNOTE')
 19432*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19433*         RIDFLD (W-NOTE-KEY)
 19434*     END-EXEC.
 19435     MOVE 'ERNOTE' TO DFHEIV1
 19436*    MOVE '&"S        E          (   #00017576' TO DFHEIV0
 19437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19439     MOVE X'2020233030303137353736' TO DFHEIV0(25:11)
 19440     CALL 'kxdfhei1' USING DFHEIV0,
 19441           DFHEIV1,
 19442           DFHEIV20,
 19443           DFHEIV99,
 19444           W-NOTE-KEY,
 19445           DFHEIV99,
 19446           DFHEIV99,
 19447           DFHEIV99
 19448     SET ADDRESS OF CERTIFICATE-NOTE TO
 19449         DFHEIV20
 19450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19451
 19452
 19453     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19454     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19455     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19456     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19457     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19458
 19459     IF PI-PAYEE-TYPE NOT = 'B'
 19460         GO TO 7700-EXIT.
 19461
 19462     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19463     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 376
* EL156.cbl
 19464     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19465
 19466     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19467         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19468     ELSE
 19469         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19470
 19471     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19472     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19473     MOVE 'DLO006'               TO PGM-NAME.
 19474
 19475
 19476* EXEC CICS LINK
 19477*        PROGRAM    (PGM-NAME)
 19478*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19479*        LENGTH     (DCT-RCRD-LENGTH)
 19480*    END-EXEC.
 19481*    MOVE '."C                   (   #00017604' TO DFHEIV0
 19482     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19484     MOVE X'2020233030303137363034' TO DFHEIV0(25:11)
 19485     CALL 'kxdfhei1' USING DFHEIV0,
 19486           PGM-NAME,
 19487           DCT-COMMUNICATION-AREA,
 19488           DCT-RCRD-LENGTH,
 19489           DFHEIV99,
 19490           DFHEIV99,
 19491           DFHEIV99,
 19492           DFHEIV99
 19493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19494
 19495
 19496     IF DCT-RETURN-CODE = 'OK'
 19497         GO TO 7700-CONT.
 19498
 19499     IF DCT-RETURN-CODE = '01' OR '02'
 19500         GO TO 7700-SET-TO-YES.
 19501
 19502     IF DCT-RETURN-CODE = '03'
 19503
 19504* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19505*    MOVE '6"R                   !   #00017617' TO DFHEIV0
 19506     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19507     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19508     MOVE X'2020233030303137363137' TO DFHEIV0(25:11)
 19509     CALL 'kxdfhei1' USING DFHEIV0
 19510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19511         MOVE ER-0951            TO EMI-ERROR
 19512         MOVE -1                 TO PMTTYPEL
 19513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19514         GO TO 8200-SEND-DATAONLY.
 19515
 19516     IF DCT-RETURN-CODE = '04'
 19517
 19518* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19519*    MOVE '6"R                   !   #00017624' TO DFHEIV0
 19520     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 377
* EL156.cbl
 19522     MOVE X'2020233030303137363234' TO DFHEIV0(25:11)
 19523     CALL 'kxdfhei1' USING DFHEIV0
 19524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19525         MOVE ER-0946            TO EMI-ERROR
 19526         MOVE -1                 TO PMTTYPEL
 19527         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19528         GO TO 8200-SEND-DATAONLY.
 19529
 19530     IF DCT-RETURN-CODE = '05'
 19531
 19532* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19533*    MOVE '6"R                   !   #00017631' TO DFHEIV0
 19534     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19536     MOVE X'2020233030303137363331' TO DFHEIV0(25:11)
 19537     CALL 'kxdfhei1' USING DFHEIV0
 19538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19539         MOVE ER-0947            TO EMI-ERROR
 19540         MOVE -1                 TO PMTTYPEL
 19541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19542         GO TO 8200-SEND-DATAONLY.
 19543
 19544     IF DCT-RETURN-CODE = '06'
 19545
 19546* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19547*    MOVE '6"R                   !   #00017638' TO DFHEIV0
 19548     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19550     MOVE X'2020233030303137363338' TO DFHEIV0(25:11)
 19551     CALL 'kxdfhei1' USING DFHEIV0
 19552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19553         MOVE ER-0921            TO EMI-ERROR
 19554         MOVE -1                 TO PMTTYPEL
 19555         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19556         GO TO 8200-SEND-DATAONLY.
 19557
 19558     IF DCT-RETURN-CODE = '07'
 19559
 19560* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19561*    MOVE '6"R                   !   #00017645' TO DFHEIV0
 19562     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19564     MOVE X'2020233030303137363435' TO DFHEIV0(25:11)
 19565     CALL 'kxdfhei1' USING DFHEIV0
 19566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19567         MOVE ER-0919            TO EMI-ERROR
 19568         MOVE -1                 TO PMTTYPEL
 19569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19570         GO TO 8200-SEND-DATAONLY.
 19571
 19572     IF DCT-RETURN-CODE = '08'
 19573
 19574* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19575*    MOVE '6"R                   !   #00017652' TO DFHEIV0
 19576     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19578     MOVE X'2020233030303137363532' TO DFHEIV0(25:11)
 19579     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 378
* EL156.cbl
 19580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19581         MOVE ER-0948            TO EMI-ERROR
 19582         MOVE -1                 TO PMTTYPEL
 19583         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19584         GO TO 8200-SEND-DATAONLY.
 19585
 19586     IF DCT-RETURN-CODE = 'N1'
 19587
 19588* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19589*    MOVE '6"R                   !   #00017659' TO DFHEIV0
 19590     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19592     MOVE X'2020233030303137363539' TO DFHEIV0(25:11)
 19593     CALL 'kxdfhei1' USING DFHEIV0
 19594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19595         MOVE ER-0950            TO EMI-ERROR
 19596         MOVE -1                 TO PMTTYPEL
 19597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19598         GO TO 8200-SEND-DATAONLY.
 19599
 19600     IF DCT-RETURN-CODE = 'E1'
 19601
 19602* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19603*    MOVE '6"R                   !   #00017666' TO DFHEIV0
 19604     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19606     MOVE X'2020233030303137363636' TO DFHEIV0(25:11)
 19607     CALL 'kxdfhei1' USING DFHEIV0
 19608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19609         MOVE ER-0974            TO EMI-ERROR
 19610         MOVE -1                 TO PMTTYPEL
 19611         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19612         GO TO 8200-SEND-DATAONLY.
 19613
 19614     IF DCT-RETURN-CODE = 'E2'
 19615
 19616* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19617*    MOVE '6"R                   !   #00017673' TO DFHEIV0
 19618     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19619     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19620     MOVE X'2020233030303137363733' TO DFHEIV0(25:11)
 19621     CALL 'kxdfhei1' USING DFHEIV0
 19622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19623         MOVE ER-0975            TO EMI-ERROR
 19624         MOVE -1                 TO PMTTYPEL
 19625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19626         GO TO 8200-SEND-DATAONLY.
 19627
 19628     IF DCT-RETURN-CODE NOT = 'OK'
 19629
 19630* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19631*    MOVE '6"R                   !   #00017680' TO DFHEIV0
 19632     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19633     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19634     MOVE X'2020233030303137363830' TO DFHEIV0(25:11)
 19635     CALL 'kxdfhei1' USING DFHEIV0
 19636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19637         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 379
* EL156.cbl
 19638         MOVE -1                 TO PMTTYPEL
 19639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19640         GO TO 8200-SEND-DATAONLY.
 19641
 19642 7700-CONT.
 19643
 19644*    MOVE 'N'                    TO CASHO.
 19645*    MOVE +1                     TO CASHL.
 19646*    MOVE AL-UANON               TO CASHA.
 19647
 19648     IF PI-OFFLINE = 'Y'
 19649         GO TO 7700-EXIT.
 19650
 19651     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19652     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19653     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19654     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19655     MOVE +7                     TO CHECKNOL.
 19656     MOVE AL-UANON               TO CHECKNOA.
 19657     GO TO 7700-EXIT.
 19658
 19659 7700-SET-TO-YES.
 19660
 19661*    MOVE 'Y'                    TO CASHO.
 19662*    MOVE +1                     TO CASHL.
 19663*    MOVE AL-UANON               TO CASHA.
 19664
 19665 7700-EXIT.
 19666     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 380
* EL156.cbl
 19668 7800-READ-COMP-MSTR.
 19669
 19670
 19671* EXEC CICS HANDLE CONDITION
 19672*        NOTFND   (7800-COMP-NOTFND)
 19673*    END-EXEC.
 19674*    MOVE '"$I                   ! @ #00017714' TO DFHEIV0
 19675     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19677     MOVE X'4020233030303137373134' TO DFHEIV0(25:11)
 19678     CALL 'kxdfhei1' USING DFHEIV0
 19679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19680
 19681
 19682
 19683* EXEC CICS READ
 19684*        DATASET   ('ERCOMP')
 19685*        RIDFLD    (ERCOMP-KEY)
 19686*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19687*    END-EXEC.
 19688     MOVE 'ERCOMP' TO DFHEIV1
 19689*    MOVE '&"S        E          (   #00017718' TO DFHEIV0
 19690     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19691     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19692     MOVE X'2020233030303137373138' TO DFHEIV0(25:11)
 19693     CALL 'kxdfhei1' USING DFHEIV0,
 19694           DFHEIV1,
 19695           DFHEIV20,
 19696           DFHEIV99,
 19697           ERCOMP-KEY,
 19698           DFHEIV99,
 19699           DFHEIV99,
 19700           DFHEIV99
 19701     SET ADDRESS OF COMPENSATION-MASTER TO
 19702         DFHEIV20
 19703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19704
 19705
 19706     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19707     GO TO 7800-COMP-EXIT.
 19708
 19709 7800-COMP-NOTFND.
 19710     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19711
 19712 7800-COMP-EXIT.
 19713     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 381
* EL156.cbl
 19715 7900-READ-CLAIM.
 19716
 19717* EXEC CICS READ
 19718*        DATASET  ('ELMSTR')
 19719*        SET      (ADDRESS OF CLAIM-MASTER)
 19720*        RIDFLD   (ELMSTR-KEY)
 19721*    END-EXEC.
 19722     MOVE 'ELMSTR' TO DFHEIV1
 19723*    MOVE '&"S        E          (   #00017734' TO DFHEIV0
 19724     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19725     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19726     MOVE X'2020233030303137373334' TO DFHEIV0(25:11)
 19727     CALL 'kxdfhei1' USING DFHEIV0,
 19728           DFHEIV1,
 19729           DFHEIV20,
 19730           DFHEIV99,
 19731           ELMSTR-KEY,
 19732           DFHEIV99,
 19733           DFHEIV99,
 19734           DFHEIV99
 19735     SET ADDRESS OF CLAIM-MASTER TO
 19736         DFHEIV20
 19737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19738
 19739
 19740 7900-EXIT.
 19741      EXIT.
 19742
 19743 7910-READ-CLAIM-UPDATE.
 19744
 19745* EXEC CICS READ
 19746*        DATASET  ('ELMSTR')
 19747*        SET      (ADDRESS OF CLAIM-MASTER)
 19748*        RIDFLD   (ELMSTR-KEY)
 19749*        UPDATE
 19750*    END-EXEC.
 19751     MOVE 'ELMSTR' TO DFHEIV1
 19752*    MOVE '&"S        EU         (   #00017744' TO DFHEIV0
 19753     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19754     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19755     MOVE X'2020233030303137373434' TO DFHEIV0(25:11)
 19756     CALL 'kxdfhei1' USING DFHEIV0,
 19757           DFHEIV1,
 19758           DFHEIV20,
 19759           DFHEIV99,
 19760           ELMSTR-KEY,
 19761           DFHEIV99,
 19762           DFHEIV99,
 19763           DFHEIV99
 19764     SET ADDRESS OF CLAIM-MASTER TO
 19765         DFHEIV20
 19766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19767
 19768
 19769 7910-EXIT.
 19770      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 382
* EL156.cbl
 19772 7920-READ-BENE.
 19773     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19774     MOVE 'B'                TO BENE-RECORD-TYPE.
 19775     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19776
 19777     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19778        IF PI-PAYEE-TYPE    = 'B' AND
 19779           PI-PAYEE-SEQ-NUM = 9
 19780             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19781             MOVE WS-A-BENE           TO BENE-NUMBER.
 19782
 19783
 19784* EXEC CICS HANDLE CONDITION
 19785*        NOTFND   (7920-NOT-FOUND)
 19786*    END-EXEC.
 19787*    MOVE '"$I                   ! A #00017765' TO DFHEIV0
 19788     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19790     MOVE X'4120233030303137373635' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0
 19792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19793
 19794
 19795
 19796* EXEC CICS READ
 19797*        DATASET  ('ELBENE')
 19798*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19799*        RIDFLD   (ELBENE-KEY)
 19800*    END-EXEC.
 19801     MOVE 'ELBENE' TO DFHEIV1
 19802*    MOVE '&"S        E          (   #00017769' TO DFHEIV0
 19803     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19805     MOVE X'2020233030303137373639' TO DFHEIV0(25:11)
 19806     CALL 'kxdfhei1' USING DFHEIV0,
 19807           DFHEIV1,
 19808           DFHEIV20,
 19809           DFHEIV99,
 19810           ELBENE-KEY,
 19811           DFHEIV99,
 19812           DFHEIV99,
 19813           DFHEIV99
 19814     SET ADDRESS OF BENEFICIARY-MASTER TO
 19815         DFHEIV20
 19816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19817
 19818
 19819     MOVE 'Y' TO BENE-FOUND-SW.
 19820     GO TO 7920-EXIT.
 19821
 19822 7920-NOT-FOUND.
 19823     MOVE 'N'                    TO BENE-FOUND-SW.
 19824
 19825 7920-EXIT.
 19826      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 383
* EL156.cbl
 19828 7930-READ-CONTROL.
 19829
 19830* EXEC CICS READ
 19831*        DATASET  ('ELCNTL')
 19832*        SET      (ADDRESS OF CONTROL-FILE)
 19833*        RIDFLD   (ELCNTL-KEY)
 19834*    END-EXEC.
 19835     MOVE 'ELCNTL' TO DFHEIV1
 19836*    MOVE '&"S        E          (   #00017785' TO DFHEIV0
 19837     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19838     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19839     MOVE X'2020233030303137373835' TO DFHEIV0(25:11)
 19840     CALL 'kxdfhei1' USING DFHEIV0,
 19841           DFHEIV1,
 19842           DFHEIV20,
 19843           DFHEIV99,
 19844           ELCNTL-KEY,
 19845           DFHEIV99,
 19846           DFHEIV99,
 19847           DFHEIV99
 19848     SET ADDRESS OF CONTROL-FILE TO
 19849         DFHEIV20
 19850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19851
 19852
 19853 7930-EXIT.
 19854      EXIT.
 19855
 19856 7940-READ-CONTROL-UPDATE.
 19857
 19858* EXEC CICS READ
 19859*        DATASET  ('ELCNTL')
 19860*        SET      (ADDRESS OF CONTROL-FILE)
 19861*        RIDFLD   (ELCNTL-KEY)
 19862*        UPDATE
 19863*    END-EXEC.
 19864     MOVE 'ELCNTL' TO DFHEIV1
 19865*    MOVE '&"S        EU         (   #00017795' TO DFHEIV0
 19866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19867     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19868     MOVE X'2020233030303137373935' TO DFHEIV0(25:11)
 19869     CALL 'kxdfhei1' USING DFHEIV0,
 19870           DFHEIV1,
 19871           DFHEIV20,
 19872           DFHEIV99,
 19873           ELCNTL-KEY,
 19874           DFHEIV99,
 19875           DFHEIV99,
 19876           DFHEIV99
 19877     SET ADDRESS OF CONTROL-FILE TO
 19878         DFHEIV20
 19879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19880
 19881
 19882 7940-EXIT.
 19883      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 384
* EL156.cbl
 19885 7950-READ-TRAILER.
 19886
 19887* EXEC CICS READ
 19888*        DATASET  ('ELTRLR')
 19889*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19890*        RIDFLD   (ELTRLR-KEY)
 19891*    END-EXEC.
 19892     MOVE 'ELTRLR' TO DFHEIV1
 19893*    MOVE '&"S        E          (   #00017806' TO DFHEIV0
 19894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19896     MOVE X'2020233030303137383036' TO DFHEIV0(25:11)
 19897     CALL 'kxdfhei1' USING DFHEIV0,
 19898           DFHEIV1,
 19899           DFHEIV20,
 19900           DFHEIV99,
 19901           ELTRLR-KEY,
 19902           DFHEIV99,
 19903           DFHEIV99,
 19904           DFHEIV99
 19905     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19906         DFHEIV20
 19907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19908
 19909
 19910 7950-EXIT.
 19911      EXIT.
 19912
 19913 7960-READ-TRAILER-UPDATE.
 19914
 19915* EXEC CICS READ
 19916*        DATASET  ('ELTRLR')
 19917*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19918*        RIDFLD   (ELTRLR-KEY)
 19919*        UPDATE
 19920*    END-EXEC.
 19921     MOVE 'ELTRLR' TO DFHEIV1
 19922*    MOVE '&"S        EU         (   #00017816' TO DFHEIV0
 19923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19924     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19925     MOVE X'2020233030303137383136' TO DFHEIV0(25:11)
 19926     CALL 'kxdfhei1' USING DFHEIV0,
 19927           DFHEIV1,
 19928           DFHEIV20,
 19929           DFHEIV99,
 19930           ELTRLR-KEY,
 19931           DFHEIV99,
 19932           DFHEIV99,
 19933           DFHEIV99
 19934     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19935         DFHEIV20
 19936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19937
 19938
 19939 7960-EXIT.
 19940      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 385
* EL156.cbl
 19942 7970-READ-CERT.
 19943
 19944* EXEC CICS READ
 19945*        DATASET  ('ELCERT')
 19946*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19947*        RIDFLD   (ELCERT-KEY)
 19948*    END-EXEC.
 19949     MOVE 'ELCERT' TO DFHEIV1
 19950*    MOVE '&"S        E          (   #00017827' TO DFHEIV0
 19951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19953     MOVE X'2020233030303137383237' TO DFHEIV0(25:11)
 19954     CALL 'kxdfhei1' USING DFHEIV0,
 19955           DFHEIV1,
 19956           DFHEIV20,
 19957           DFHEIV99,
 19958           ELCERT-KEY,
 19959           DFHEIV99,
 19960           DFHEIV99,
 19961           DFHEIV99
 19962     SET ADDRESS OF CERTIFICATE-MASTER TO
 19963         DFHEIV20
 19964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19965
 19966
 19967 7970-EXIT.
 19968      EXIT.
 19969 7975-read-acct.
 19970
 19971     move spaces              to WS-ACCT-RECORD-SW
 19972                                 pi-dcc-product-code
 19973
 19974     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19975     MOVE PI-CARRIER          TO ACCT-CARRIER
 19976     MOVE PI-GROUPING         TO ACCT-GROUPING
 19977     MOVE PI-STATE            TO ACCT-STATE
 19978     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19979     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19980     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19981     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19982
 19983
 19984* EXEC CICS READ
 19985*       DATASET ('ERACCT')
 19986*       RIDFLD  (ERACCT-KEY)
 19987*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19988*       GTEQ
 19989*       resp    (WS-RESPONSE)
 19990*    END-EXEC
 19991     MOVE 'ERACCT' TO DFHEIV1
 19992*    MOVE '&"S        G          (  N#00017849' TO DFHEIV0
 19993     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19995     MOVE X'204E233030303137383439' TO DFHEIV0(25:11)
 19996     CALL 'kxdfhei1' USING DFHEIV0,
 19997           DFHEIV1,
 19998           DFHEIV20,
 19999           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 386
* EL156.cbl
 20000           ERACCT-KEY,
 20001           DFHEIV99,
 20002           DFHEIV99,
 20003           DFHEIV99
 20004     SET ADDRESS OF ACCOUNT-MASTER TO
 20005         DFHEIV20
 20006     MOVE EIBRESP  TO WS-RESPONSE
 20007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20008     IF WS-RESP-NORMAL
 20009        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 20010        and pi-cert-eff-dt < am-expiration-dt
 20011        and pi-cert-eff-dt >= am-effective-dt
 20012        move am-dcc-product-code to pi-dcc-product-code
 20013        set acct-found to true
 20014     end-if
 20015
 20016     .
 20017 7975-exit.
 20018     exit.
 20019 7980-READ-CERT-UPDATE.
 20020
 20021* EXEC CICS READ
 20022*        DATASET  ('ELCERT')
 20023*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 20024*        RIDFLD   (ELCERT-KEY)
 20025*        UPDATE
 20026*    END-EXEC.
 20027     MOVE 'ELCERT' TO DFHEIV1
 20028*    MOVE '&"S        EU         (   #00017868' TO DFHEIV0
 20029     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20030     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20031     MOVE X'2020233030303137383638' TO DFHEIV0(25:11)
 20032     CALL 'kxdfhei1' USING DFHEIV0,
 20033           DFHEIV1,
 20034           DFHEIV20,
 20035           DFHEIV99,
 20036           ELCERT-KEY,
 20037           DFHEIV99,
 20038           DFHEIV99,
 20039           DFHEIV99
 20040     SET ADDRESS OF CERTIFICATE-MASTER TO
 20041         DFHEIV20
 20042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20043
 20044
 20045 7980-EXIT.
 20046      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 387
* EL156.cbl
 20048 8000-LOAD-ERROR-MESSAGES.
 20049     IF PI-PASS-SW = 'C'
 20050        MOVE EMI-LINE1           TO ERMSG1BO
 20051     ELSE
 20052        MOVE EMI-LINE1           TO ERRMSG1O
 20053        MOVE EMI-LINE2           TO ERRMSG2O.
 20054
 20055 8000-EXIT.
 20056     EXIT.
 20057
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 388
* EL156.cbl
 20059
 20060 8010-DMD-ERROR-CHECKS.
 20061     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 20062
 20063     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 20064         GO TO 8051-ISSUE-ERROR.
 20065
 20066     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 20067     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 20068     MOVE '3'                    TO DC-OPTION-CODE.
 20069     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 20070     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 20071         GO TO 8051-ISSUE-ERROR.
 20072
 20073     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 20074       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 20075                           OR
 20076          (CL-SSN-STATE   = CL-CERT-STATE  AND
 20077           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 20078             MOVE ER-0851         TO EMI-ERROR
 20079             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20080       END-IF
 20081       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 20082             MOVE ER-8147         TO EMI-ERROR
 20083             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20084
 20085     GO TO 8090-EXIT.
 20086
 20087 8051-ISSUE-ERROR.
 20088     MOVE ER-8146            TO EMI-ERROR.
 20089     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20090     GO TO 8090-EXIT.
 20091
 20092 8090-EXIT.
 20093      EXIT.
 20094
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 389
* EL156.cbl
 20096 8100-SEND-INITIAL-MAP.
 20097
 20098     MOVE SAVE-DATE              TO RUNDTEAO.
 20099     MOVE EIBTIME                TO TIME-IN.
 20100     MOVE TIME-OUT               TO RUNTIMAO.
 20101     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 20102
 20103     IF MAP-NAME = 'EL156A'
 20104        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20105           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20106        END-IF
 20107        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 20108           MOVE 'N'     TO SURVYYNO
 20109        END-IF
 20110     END-IF
 20111*    IF MAP-NAME = 'EL156A'
 20112*       IF PI-COMPANY-ID = 'CRI'
 20113*          NEXT SENTENCE
 20114*       ELSE
 20115*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 20116
 20117     IF MAP-NAME = 'EL156A'
 20118        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 20119           NEXT SENTENCE
 20120        ELSE
 20121           MOVE AL-SADOF TO  PINTA    PINTHA.
 20122
 20123     IF MAP-NAME = 'EL156A'
 20124        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 20125            NEXT SENTENCE
 20126        ELSE
 20127           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 20128
 20129*    IF MAP-NAME = 'EL156A'
 20130*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 20131*          NEXT SENTENCE
 20132*       ELSE
 20133*          MOVE AL-SADOF TO CASHHA CASHA.
 20134
 20135     IF MAP-NAME = 'EL156A'
 20136        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 20137                        or 'VPP'
 20138           NEXT SENTENCE
 20139        ELSE
 20140           MOVE AL-SADOF        TO  LOANHA
 20141                                    LOANNOA.
 20142
 20143     IF MAP-NAME = 'EL156A'
 20144        MOVE -1                 TO  ENTERPFL
 20145        IF PI-USES-PAID-TO
 20146           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20147           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20148           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20149        ELSE
 20150           NEXT SENTENCE
 20151     ELSE
 20152        IF MAP-NAME = 'EL156B'
 20153           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 390
* EL156.cbl
 20154              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20155              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20156
 20157
 20158* EXEC CICS SEND
 20159*        MAP   (MAP-NAME)
 20160*        MAPSET(MAPSET-NAME)
 20161*        FROM  (EL156AI)
 20162*        ERASE
 20163*        CURSOR
 20164*    END-EXEC.
 20165     MOVE LENGTH OF
 20166      EL156AI
 20167       TO DFHEIV12
 20168     MOVE -1
 20169       TO DFHEIV11
 20170*    MOVE '8$     CT  E    H L F ,   #00017987' TO DFHEIV0
 20171     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 20172     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20173     MOVE X'2020233030303137393837' TO DFHEIV0(25:11)
 20174     CALL 'kxdfhei1' USING DFHEIV0,
 20175           MAP-NAME,
 20176           EL156AI,
 20177           DFHEIV12,
 20178           MAPSET-NAME,
 20179           DFHEIV99,
 20180           DFHEIV99,
 20181           DFHEIV99,
 20182           DFHEIV11,
 20183           DFHEIV99,
 20184           DFHEIV99,
 20185           DFHEIV99
 20186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20187
 20188
 20189     GO TO 9100-RETURN-TRAN.
 20190
 20191 8200-SEND-DATAONLY.
 20192
 20193     IF FIRST-ENTRY = 'Y'
 20194         GO TO 8100-SEND-INITIAL-MAP.
 20195
 20196     IF RETURNED-FROM-B = 'Y'
 20197         GO TO 8100-SEND-INITIAL-MAP.
 20198
 20199     MOVE SAVE-DATE              TO RUNDTEAO.
 20200     MOVE EIBTIME                TO TIME-IN.
 20201     MOVE TIME-OUT               TO RUNTIMAO.
 20202
 20203     IF EIBAID = DFHPF11
 20204        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20206        MOVE 'EL001   '          TO RETURNED-FROM
 20207        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 20208        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 20209        GO TO 8100-SEND-INITIAL-MAP.
 20210
 20211     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 391
* EL156.cbl
 20212
 20213     IF MAP-NAME =  'EL156A'
 20214        MOVE -1                 TO  ENTERPFL
 20215        IF PI-USES-PAID-TO
 20216           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20217           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20218           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20219        ELSE
 20220           NEXT SENTENCE
 20221     ELSE
 20222        IF MAP-NAME = 'EL156B'
 20223           IF PI-USES-PAID-TO
 20224              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20225              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20226
 20227     IF MAP-NAME =  'EL156A'
 20228        IF PI-COMPANY-ID = 'BOA'
 20229            IF PI-INT-RATE NUMERIC
 20230                MOVE PI-INT-RATE TO PINTO.
 20231     IF MAP-NAME = 'EL156A'
 20232        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20233           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20234*          MOVE 'Y'              TO EOBYNO
 20235        END-IF
 20236     END-IF
 20237
 20238
 20239* EXEC CICS SEND
 20240*        MAP   (MAP-NAME)
 20241*        MAPSET(MAPSET-NAME)
 20242*        FROM  (EL156AI)
 20243*        DATAONLY
 20244*        CURSOR
 20245*    END-EXEC.
 20246     MOVE LENGTH OF
 20247      EL156AI
 20248       TO DFHEIV12
 20249     MOVE -1
 20250       TO DFHEIV11
 20251*    MOVE '8$D    CT       H L F ,   #00018044' TO DFHEIV0
 20252     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20253     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20254     MOVE X'2020233030303138303434' TO DFHEIV0(25:11)
 20255     CALL 'kxdfhei1' USING DFHEIV0,
 20256           MAP-NAME,
 20257           EL156AI,
 20258           DFHEIV12,
 20259           MAPSET-NAME,
 20260           DFHEIV99,
 20261           DFHEIV99,
 20262           DFHEIV99,
 20263           DFHEIV11,
 20264           DFHEIV99,
 20265           DFHEIV99,
 20266           DFHEIV99
 20267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20268
 20269
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 392
* EL156.cbl
 20270     GO TO 9100-RETURN-TRAN.
 20271
 20272 8300-SEND-TEXT.
 20273
 20274* EXEC CICS SEND TEXT
 20275*        FROM(LOGOFF-TEXT)
 20276*        LENGTH(LOGOFF-LENGTH)
 20277*        ERASE
 20278*        FREEKB
 20279*    END-EXEC.
 20280*    MOVE '8&      T  E F  H   F -   #00018055' TO DFHEIV0
 20281     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20282     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20283     MOVE X'2020233030303138303535' TO DFHEIV0(25:11)
 20284     CALL 'kxdfhei1' USING DFHEIV0,
 20285           LOGOFF-TEXT,
 20286           LOGOFF-LENGTH,
 20287           DFHEIV99,
 20288           DFHEIV99,
 20289           DFHEIV99,
 20290           DFHEIV99,
 20291           DFHEIV99,
 20292           DFHEIV99,
 20293           DFHEIV99,
 20294           DFHEIV99,
 20295           DFHEIV99,
 20296           DFHEIV99
 20297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20298
 20299
 20300
 20301* EXEC CICS RETURN
 20302*    END-EXEC.
 20303*    MOVE '.(                    ''   #00018062' TO DFHEIV0
 20304     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20305     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20306     MOVE X'2020233030303138303632' TO DFHEIV0(25:11)
 20307     CALL 'kxdfhei1' USING DFHEIV0,
 20308           DFHEIV99,
 20309           DFHEIV99,
 20310           DFHEIV99,
 20311           DFHEIV99,
 20312           DFHEIV99,
 20313           DFHEIV99
 20314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20315
 20316
 20317 8500-FILE-NOTOPEN.
 20318     IF FILE-SWITCH = 'MSTR'
 20319         MOVE ER-0154            TO EMI-ERROR.
 20320     IF FILE-SWITCH = 'TRLR'
 20321         MOVE ER-0172            TO EMI-ERROR.
 20322     IF FILE-SWITCH = 'CERT'
 20323         MOVE ER-0169            TO EMI-ERROR.
 20324     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20325                      'PROC' OR 'STAT'
 20326         MOVE ER-0042            TO EMI-ERROR.
 20327     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 393
* EL156.cbl
 20328         MOVE ER-0338            TO EMI-ERROR.
 20329     IF FILE-SWITCH = 'ACCT'
 20330         MOVE ER-0168            TO EMI-ERROR.
 20331
 20332     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20333     MOVE -1                     TO PMTTYPEL.
 20334
 20335     IF FIRST-ENTRY = 'Y'
 20336         GO TO 8100-SEND-INITIAL-MAP.
 20337
 20338     GO TO 8200-SEND-DATAONLY.
 20339
 20340 8600-PGRM-NOT-FOUND.
 20341
 20342     MOVE ER-0923                TO EMI-ERROR.
 20343     MOVE -1                     TO ENTPFBL.
 20344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20345
 20346     IF FIRST-ENTRY = 'Y'
 20347         GO TO 8100-SEND-INITIAL-MAP
 20348     ELSE
 20349         GO TO 8200-SEND-DATAONLY.
 20350
 20351 8800-UNAUTHORIZED-ACCESS.
 20352     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20353     GO TO 8300-SEND-TEXT.
 20354
 20355 8810-PF23.
 20356     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20357     MOVE XCTL-005               TO PGM-NAME.
 20358     GO TO 9300-XCTL.
 20359
 20360 8820-PF7-8.
 20361     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20362     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20363                                    PI-SAVED-PROGRAM-2
 20364                                    PI-SAVED-PROGRAM-3
 20365                                    PI-SAVED-PROGRAM-4
 20366                                    PI-SAVED-PROGRAM-5
 20367                                    PI-SAVED-PROGRAM-6
 20368                                    PI-RETURN-TO-PROGRAM.
 20369     IF EIBAID = DFHPF8
 20370        MOVE XCTL-132            TO PGM-NAME
 20371     ELSE
 20372        MOVE XCTL-130            TO PGM-NAME.
 20373
 20374     GO TO 9300-XCTL.
 20375
 20376 9100-RETURN-TRAN.
 20377     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20378     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20379
 20380
 20381* EXEC CICS RETURN
 20382*        TRANSID(TRANS-ID)
 20383*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20384*        LENGTH(PI-COMM-LENGTH)
 20385*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 394
* EL156.cbl
 20386*    MOVE '.(CT                  ''   #00018128' TO DFHEIV0
 20387     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20389     MOVE X'2020233030303138313238' TO DFHEIV0(25:11)
 20390     CALL 'kxdfhei1' USING DFHEIV0,
 20391           TRANS-ID,
 20392           PROGRAM-INTERFACE-BLOCK,
 20393           PI-COMM-LENGTH,
 20394           DFHEIV99,
 20395           DFHEIV99,
 20396           DFHEIV99
 20397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20398
 20399
 20400 9200-RETURN-MAIN-MENU.
 20401     MOVE XCTL-126               TO PGM-NAME.
 20402     GO TO 9300-XCTL.
 20403
 20404 9300-XCTL.
 20405
 20406* EXEC CICS XCTL
 20407*        PROGRAM(PGM-NAME)
 20408*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20409*        LENGTH(PI-COMM-LENGTH)
 20410*    END-EXEC.
 20411*    MOVE '.$C                   %   #00018139' TO DFHEIV0
 20412     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20413     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20414     MOVE X'2020233030303138313339' TO DFHEIV0(25:11)
 20415     CALL 'kxdfhei1' USING DFHEIV0,
 20416           PGM-NAME,
 20417           PROGRAM-INTERFACE-BLOCK,
 20418           PI-COMM-LENGTH,
 20419           DFHEIV99
 20420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20421
 20422
 20423 9400-CLEAR.
 20424     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20425     GO TO 9300-XCTL.
 20426
 20427 9500-PF12.
 20428     MOVE XCTL-010               TO PGM-NAME.
 20429     GO TO 9300-XCTL.
 20430
 20431 9700-LINK-DATE-CONVERT.
 20432     MOVE LINK-ELDATCV           TO PGM-NAME.
 20433
 20434* EXEC CICS LINK
 20435*        PROGRAM   (PGM-NAME)
 20436*        COMMAREA  (DATE-CONVERSION-DATA)
 20437*        LENGTH    (DC-COMM-LENGTH)
 20438*    END-EXEC.
 20439*    MOVE '."C                   (   #00018155' TO DFHEIV0
 20440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20442     MOVE X'2020233030303138313535' TO DFHEIV0(25:11)
 20443     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 395
* EL156.cbl
 20444           PGM-NAME,
 20445           DATE-CONVERSION-DATA,
 20446           DC-COMM-LENGTH,
 20447           DFHEIV99,
 20448           DFHEIV99,
 20449           DFHEIV99,
 20450           DFHEIV99
 20451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20452
 20453
 20454 9700-EXIT.
 20455     EXIT.
 20456
 20457 9800-LINK-REM-TERM.
 20458     MOVE LINK-REMTERM TO PGM-NAME.
 20459
 20460
 20461* EXEC CICS LINK
 20462*        PROGRAM   (PGM-NAME)
 20463*        COMMAREA  (CALCULATION-PASS-AREA)
 20464*        LENGTH    (CP-COMM-LENGTH)
 20465*    END-EXEC.
 20466*    MOVE '."C                   (   #00018167' TO DFHEIV0
 20467     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20469     MOVE X'2020233030303138313637' TO DFHEIV0(25:11)
 20470     CALL 'kxdfhei1' USING DFHEIV0,
 20471           PGM-NAME,
 20472           CALCULATION-PASS-AREA,
 20473           CP-COMM-LENGTH,
 20474           DFHEIV99,
 20475           DFHEIV99,
 20476           DFHEIV99,
 20477           DFHEIV99
 20478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20479
 20480
 20481 9800-EXIT.
 20482     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 396
* EL156.cbl
 20484 9830-DMD-REMAINING-TERM.
 20485
 20486     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20487         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20488
 20489     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20490                              CM-PMT-EXTENSION-DAYS.
 20491
 20492     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20493                                  CL-NO-OF-DAYS-PAID.
 20494
 20495     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20496         GIVING W-REM REMAINDER W-REM-DAYS.
 20497
 20498     MOVE W-REM                  TO WST-REM.
 20499
 20500     IF W-REM-DAYS > ZEROS
 20501         MOVE '/'                TO WST-SLASH
 20502         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20503     ELSE
 20504         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20505
 20506 9830-EXIT.
 20507     EXIT.
 20508
 20509 9870-OUTPUT-ACTIVITY-RECORD.
 20510
 20511
 20512* EXEC CICS GETMAIN
 20513*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20514*         LENGTH(25)
 20515*         INITIMG(WS-BLANK)
 20516*    END-EXEC.
 20517     MOVE 25
 20518       TO DFHEIV11
 20519*    MOVE ',"IL                  $   #00018203' TO DFHEIV0
 20520     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20521     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20522     MOVE X'2020233030303138323033' TO DFHEIV0(25:11)
 20523     CALL 'kxdfhei1' USING DFHEIV0,
 20524           DFHEIV20,
 20525           DFHEIV11,
 20526           WS-BLANK
 20527     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20528         DFHEIV20
 20529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20530
 20531
 20532     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20533     MOVE ELMSTR-KEY             TO DA-KEY.
 20534     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20535
 20536     IF PI-PMTTYPE EQUAL '7'
 20537         MOVE 'V'                TO DA-RECORD-TYPE
 20538     ELSE
 20539         MOVE 'P'                TO DA-RECORD-TYPE.
 20540
 20541
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 397
* EL156.cbl
 20542* EXEC CICS HANDLE CONDITION
 20543*         NOTOPEN(9870-NOTOPEN)
 20544*         DUPREC(9870-EXIT)
 20545*    END-EXEC.
 20546*    MOVE '"$J%                  ! B #00018218' TO DFHEIV0
 20547     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20549     MOVE X'4220233030303138323138' TO DFHEIV0(25:11)
 20550     CALL 'kxdfhei1' USING DFHEIV0
 20551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20552
 20553
 20554
 20555* EXEC CICS WRITE
 20556*         DATASET('DLYACTV')
 20557*         RIDFLD(DA-KEY)
 20558*         FROM(DAILY-ACTIVITY-RECORD)
 20559*         LENGTH(25)
 20560*    END-EXEC.
 20561     MOVE 'DLYACTV' TO DFHEIV1
 20562     MOVE 25
 20563       TO DFHEIV11
 20564*    MOVE '&$ L                  ''   #00018223' TO DFHEIV0
 20565     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20566     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20567     MOVE X'2020233030303138323233' TO DFHEIV0(25:11)
 20568     CALL 'kxdfhei1' USING DFHEIV0,
 20569           DFHEIV1,
 20570           DAILY-ACTIVITY-RECORD,
 20571           DFHEIV11,
 20572           DA-KEY,
 20573           DFHEIV99,
 20574           DFHEIV99
 20575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20576
 20577     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20578     GO TO 9870-EXIT.
 20579
 20580 9870-NOTOPEN.
 20581
 20582     MOVE '2955'                 TO EMI-ERROR.
 20583     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20584
 20585 9870-EXIT.
 20586     EXIT.
 20587
 20588 9900-ERROR-FORMAT.
 20589
 20590     IF EMI-ERROR = ER-0923
 20591         MOVE PGM-NAME           TO W-CALLED-NAME.
 20592
 20593     MOVE LINK-001      TO PGM-NAME.
 20594     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20595
 20596
 20597* EXEC CICS LINK
 20598*        PROGRAM (PGM-NAME)
 20599*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 398
* EL156.cbl
 20600*        LENGTH  (EMI-COMM-LENGTH)
 20601*    END-EXEC.
 20602*    MOVE '."C                   (   #00018248' TO DFHEIV0
 20603     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20605     MOVE X'2020233030303138323438' TO DFHEIV0(25:11)
 20606     CALL 'kxdfhei1' USING DFHEIV0,
 20607           PGM-NAME,
 20608           ERROR-MESSAGE-INTERFACE-BLOCK,
 20609           EMI-COMM-LENGTH,
 20610           DFHEIV99,
 20611           DFHEIV99,
 20612           DFHEIV99,
 20613           DFHEIV99
 20614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20615
 20616
 20617     IF EMI-ERROR = ER-0923
 20618         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20619
 20620 9900-EXIT.
 20621     EXIT.
 20622
 20623 9990-ABEND.
 20624     MOVE LINK-004               TO PGM-NAME.
 20625     MOVE DFHEIBLK               TO EMI-LINE1.
 20626
 20627* EXEC CICS LINK
 20628*        PROGRAM   (PGM-NAME)
 20629*        COMMAREA  (EMI-LINE1)
 20630*        LENGTH    (64)
 20631*    END-EXEC.
 20632     MOVE 64
 20633       TO DFHEIV11
 20634*    MOVE '."C                   (   #00018263' TO DFHEIV0
 20635     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20636     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20637     MOVE X'2020233030303138323633' TO DFHEIV0(25:11)
 20638     CALL 'kxdfhei1' USING DFHEIV0,
 20639           PGM-NAME,
 20640           EMI-LINE1,
 20641           DFHEIV11,
 20642           DFHEIV99,
 20643           DFHEIV99,
 20644           DFHEIV99,
 20645           DFHEIV99
 20646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20647
 20648
 20649     MOVE 'EL156A'               TO  MAP-NAME.
 20650     MOVE LOW-VALUES             TO  EL156AO.
 20651     GO TO 8100-SEND-INITIAL-MAP.
 20652
 20653 9995-SECURITY-VIOLATION.
 20654*    COPY ELCSCTP.
 20655******************************************************************
 20656*                                                                *
 20657*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 399
* EL156.cbl
 20658*                            VMOD=2.001                          *
 20659*                                                                *
 20660*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20661******************************************************************
 20662
 20663
 20664     MOVE EIBDATE          TO SM-JUL-DATE.
 20665     MOVE EIBTRMID         TO SM-TERMID.
 20666     MOVE THIS-PGM         TO SM-PGM.
 20667     MOVE EIBTIME          TO TIME-IN.
 20668     MOVE TIME-OUT         TO SM-TIME.
 20669     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20670
 20671
 20672* EXEC CICS LINK
 20673*         PROGRAM  ('EL003')
 20674*         COMMAREA (SECURITY-MESSAGE)
 20675*         LENGTH   (80)
 20676*    END-EXEC.
 20677     MOVE 'EL003' TO DFHEIV1
 20678     MOVE 80
 20679       TO DFHEIV11
 20680*    MOVE '."C                   (   #00018291' TO DFHEIV0
 20681     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20683     MOVE X'2020233030303138323931' TO DFHEIV0(25:11)
 20684     CALL 'kxdfhei1' USING DFHEIV0,
 20685           DFHEIV1,
 20686           SECURITY-MESSAGE,
 20687           DFHEIV11,
 20688           DFHEIV99,
 20689           DFHEIV99,
 20690           DFHEIV99,
 20691           DFHEIV99
 20692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20693
 20694
 20695******************************************************************
 20696
 20697
 20698
 20699 9999-DFHBACK SECTION.
 20700     MOVE '9%                    "   ' TO DFHEIV0
 20701     MOVE 'EL156' TO DFHEIV1
 20702     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20703     GOBACK.
 20704 9999-DFHEXIT.
 20705     IF DFHEIGDJ EQUAL 0001
 20706         NEXT SENTENCE
 20707     ELSE IF DFHEIGDJ EQUAL 2
 20708         GO TO 9990-ABEND,
 20709               8600-PGRM-NOT-FOUND,
 20710               0400-FIRST-TIME,
 20711               6180-DUPREC,
 20712               9990-ABEND
 20713         DEPENDING ON DFHEIGDI
 20714     ELSE IF DFHEIGDJ EQUAL 3
 20715         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 400
* EL156.cbl
 20716               0380-CLAIM-END-FILE
 20717         DEPENDING ON DFHEIGDI
 20718     ELSE IF DFHEIGDJ EQUAL 4
 20719         GO TO 0380-CLAIM-END-FILE,
 20720               0380-CLAIM-END-FILE
 20721         DEPENDING ON DFHEIGDI
 20722     ELSE IF DFHEIGDJ EQUAL 5
 20723         GO TO 0800-EXIT
 20724         DEPENDING ON DFHEIGDI
 20725     ELSE IF DFHEIGDJ EQUAL 6
 20726         GO TO 1950-NOT-FOUND,
 20727               1950-NOT-FOUND
 20728         DEPENDING ON DFHEIGDI
 20729     ELSE IF DFHEIGDJ EQUAL 7
 20730         GO TO 1950-NOT-FOUND
 20731         DEPENDING ON DFHEIGDI
 20732     ELSE IF DFHEIGDJ EQUAL 8
 20733         GO TO 1950-NOT-FOUND,
 20734               1950-NOT-FOUND
 20735         DEPENDING ON DFHEIGDI
 20736     ELSE IF DFHEIGDJ EQUAL 9
 20737         GO TO 1166-END-CHECK,
 20738               1166-END-CHECK
 20739         DEPENDING ON DFHEIGDI
 20740     ELSE IF DFHEIGDJ EQUAL 10
 20741         GO TO 1950-NOT-FOUND,
 20742               1950-NOT-FOUND
 20743         DEPENDING ON DFHEIGDI
 20744     ELSE IF DFHEIGDJ EQUAL 11
 20745         GO TO 1950-NOT-FOUND,
 20746               1950-NOT-FOUND
 20747         DEPENDING ON DFHEIGDI
 20748     ELSE IF DFHEIGDJ EQUAL 12
 20749         GO TO 1950-NOT-FOUND
 20750         DEPENDING ON DFHEIGDI
 20751     ELSE IF DFHEIGDJ EQUAL 13
 20752         GO TO 3600-CONTINUE
 20753         DEPENDING ON DFHEIGDI
 20754     ELSE IF DFHEIGDJ EQUAL 14
 20755         GO TO 5300-NOTE-NOT-FOUND
 20756         DEPENDING ON DFHEIGDI
 20757     ELSE IF DFHEIGDJ EQUAL 15
 20758         GO TO 6065-NOT-FOUND
 20759         DEPENDING ON DFHEIGDI
 20760     ELSE IF DFHEIGDJ EQUAL 16
 20761         GO TO 6068-ACCT-NOT-FND
 20762         DEPENDING ON DFHEIGDI
 20763     ELSE IF DFHEIGDJ EQUAL 17
 20764         GO TO 6074-GET-COMP-DATA
 20765         DEPENDING ON DFHEIGDI
 20766     ELSE IF DFHEIGDJ EQUAL 18
 20767         GO TO 6170-WRITE
 20768         DEPENDING ON DFHEIGDI
 20769     ELSE IF DFHEIGDJ EQUAL 19
 20770         GO TO 6180-DUPREC
 20771         DEPENDING ON DFHEIGDI
 20772     ELSE IF DFHEIGDJ EQUAL 20
 20773         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 11-Sep-19 15:41 Page 401
* EL156.cbl
 20774         DEPENDING ON DFHEIGDI
 20775     ELSE IF DFHEIGDJ EQUAL 21
 20776         GO TO 6185-DUPREC
 20777         DEPENDING ON DFHEIGDI
 20778     ELSE IF DFHEIGDJ EQUAL 22
 20779         GO TO 6720-BUILD-NEW-RECORD
 20780         DEPENDING ON DFHEIGDI
 20781     ELSE IF DFHEIGDJ EQUAL 23
 20782         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20783               6900-BUILD-ARCHIVE-HEADER
 20784         DEPENDING ON DFHEIGDI
 20785     ELSE IF DFHEIGDJ EQUAL 24
 20786         GO TO 7010-BUILD-MAP
 20787         DEPENDING ON DFHEIGDI
 20788     ELSE IF DFHEIGDJ EQUAL 25
 20789         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20790         DEPENDING ON DFHEIGDI
 20791     ELSE IF DFHEIGDJ EQUAL 26
 20792         GO TO 7160-DUPREC
 20793         DEPENDING ON DFHEIGDI
 20794     ELSE IF DFHEIGDJ EQUAL 27
 20795         GO TO 7200-EXIT,
 20796               7200-EXIT
 20797         DEPENDING ON DFHEIGDI
 20798     ELSE IF DFHEIGDJ EQUAL 28
 20799         GO TO 7400-NOT-FOUND
 20800         DEPENDING ON DFHEIGDI
 20801     ELSE IF DFHEIGDJ EQUAL 29
 20802         GO TO 7590-END,
 20803               7590-END
 20804         DEPENDING ON DFHEIGDI
 20805     ELSE IF DFHEIGDJ EQUAL 30
 20806         GO TO 7699-EXIT
 20807         DEPENDING ON DFHEIGDI
 20808     ELSE IF DFHEIGDJ EQUAL 31
 20809         GO TO 5300-NOTE-NOT-FOUND
 20810         DEPENDING ON DFHEIGDI
 20811     ELSE IF DFHEIGDJ EQUAL 32
 20812         GO TO 7800-COMP-NOTFND
 20813         DEPENDING ON DFHEIGDI
 20814     ELSE IF DFHEIGDJ EQUAL 33
 20815         GO TO 7920-NOT-FOUND
 20816         DEPENDING ON DFHEIGDI
 20817     ELSE IF DFHEIGDJ EQUAL 34
 20818         GO TO 9870-NOTOPEN,
 20819               9870-EXIT
 20820         DEPENDING ON DFHEIGDI.
 20821     MOVE '9%                    "   ' TO DFHEIV0
 20822     MOVE 'EL156' TO DFHEIV1
 20823     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20824     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12852     Code:       77851
